      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCGK09.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ¿ÇÎÅ¹Ô°ÙÆþÎÏ
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ¿ÇÎÅ¹Ô°ÙÁªÂò¡Ê£Ä£Ï¡Ë¡Ê£Ë£°£¹¡Ë
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  01/05/25    MCC¡ÝÂ¿¡¹Ç¼   ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      * 01.00.01     NACL-Â¿¡¹Ç¼  03/04/11  ÍúÎò¤Ë²ÊÉ½¼¨ÄÉ²Ã
      * 01.00.02     NACL-Â¿¡¹Ç¼  04/01/23  ²ó¿ôÊÑ¹¹ÄÉ²Ã
      * 01.00.03     NACL-Â¿¡¹Ç¼  05/11/17  MONFUNC ÂÐ±þ
      * 01.00.04     NACL-Â¿¡¹Ç¼  06/01/23  ÍÑÎÌ³ä¹ç¡¦Êñ³ç¸¡ºº¿ôÄÉ²Ã
      * 03.04.00     NACL-Â¿¡¹Ç¼  06/11/14  ¸¡ººÀµ¼°Ì¾¾ÎÉ½¼¨ÄÉ²ÃÂ¾
      * 03.05.00     NACL-Â¿¡¹Ç¼  07/04/XX  ¥°¥ë¡¼¥×¿ÇÎÅÂÐ±þ
      * 03.05.00     NACL-Â¿¡¹Ç¼  07/06/14  ÅêÌô¡¦Ãí¼ÍÄÉ²Ã
      * 04.01.00     NACL-Â¿¡¹Ç¼  07/10/XX  ¥Æ¡¼¥Ö¥ë£´£°£°ÂÐ±þ
      *****************************************************************
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *    ¥Ñ¥é¥á¥¿¥Ç¡¼¥¿
           SELECT  PARA-FILE       ASSIGN  FILE-NAME2
                                   ORGANIZATION    IS  LINE SEQUENTIAL
                                   FILE    STATUS  IS  STS-PARA.
      *
      *    £Ó£Ð£Á¥Ç¡¼¥¿
           SELECT  SPASCR-FILE     ASSIGN  FILE-NAME1
                                   ORGANIZATION    IS  LINE SEQUENTIAL
                                   FILE    STATUS  IS  STS-SPASCR.
      *
      *
       DATA                        DIVISION.
       FILE                        SECTION.
      *    ¥Ñ¥é¥á¥¿¥Ç¡¼¥¿
       FD  PARA-FILE.
       01  PARA-REC.
           03  PARA-KEY.
               05  PARA-FILEMEI         PIC X(08).
               05  PARA-EDANUM          PIC 9(03).
           03  PARA-DATA-REC            PIC X(60000).
      *
      *    £Ó£Ð£Á¥Ñ¥é¥á¥¿¥Ç¡¼¥¿
       FD  SPASCR-FILE.
       01  SPA-DATA-REC            PIC X(60000).
      *
       WORKING-STORAGE             SECTION.
      *
      * £Ó£Ð£Á¥Ç¡¼¥¿
       01  FILE-NAME1.
           03  FILLER              PIC X(09)   VALUE   "/var/tmp/".
           03  FILLER              PIC X(09)   VALUE   "K09SPASCR".
           03  FILE-HOSPNUM1       PIC 9(02)   VALUE   ZERO.
           03  FILE-TERMID1        PIC X(64)   VALUE   SPACE.
           03  FILLER              PIC X(06)   VALUE   ".TXT".
      *    ¥Ñ¥é¥á¥¿¥Õ¥¡¥¤¥ëÌ¾
       01  FILE-NAME2.
           03  FILLER              PIC X(09)   VALUE   "/var/tmp/".
           03  FILLER              PIC X(07)   VALUE   "K01PARA".
           03  FILE-HOSPNUM2       PIC 9(02)   VALUE   ZERO.
           03  FILE-TERMID2        PIC X(64)   VALUE   SPACE.
           03  FILLER              PIC X(06)   VALUE   ".TXT".
      *
      *
       01  WRK-DATA-REC.
           03  WRK-DATA            PIC X(60000)
                                   OCCURS  10.
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *
      *    ¿ÇÎÅ¹Ô°ÙÍÑ¶¦ÄÌ¥Ñ¥é¥á¥¿
           COPY    "K01COMMON-SPA".
      *
      *    ²èÌÌÍÑ¶¦ÄÌ¥¹¥ÑÎÎ°è
           COPY    "K02SCR-SPA".
      *
      *    ²èÌÌ¥¹¥ÑÎÎ°è
       01  SPA-K09.
           03  SPA-K09-AREA.
      *********05  SPA-K09GMN-CUR                PIC 9(02).
      *
      ****     05  SPA-GMN-NYUGAIKBN-G.
      *            07  SPA-GMN-NYUGAIKBN           PIC X(01).
      *            07  SPA-GMN-NYUGAIKBN-F1        PIC X(01).
      *            07  SPA-GMN-NYUGAIKBN-MEI       PIC X(08).
      *        05  SPA-GMN-NYUGAIKBN-LIST.
      *            07  SPA-GMN-NYUGAIKBN-LST       PIC X(10)
      *                                            OCCURS   2.
      *****        07  SPA-NYUGAIKBN-MAX           PIC 9(02).
      *
      *        05  SPA-GMN-SRYKBN-G.
      *            07  SPA-GMN-SRYKBN              PIC X(02).
      *            07  SPA-GMN-SRYKBN-F1           PIC X(01).
      *            07  SPA-GMN-SRYKBN-MEI          PIC X(20).
      *        05  SPA-GMN-SRYKBN-LIST.
      *            07  SPA-GMN-SRYKBN-LST          PIC X(23)
      *                                            OCCURS  20.
      *********    07  SPA-SRYKBN-MAX              PIC 9(03).
      *
               05  SPA-GMN-TBL.
                   07  SPA-GMN-TBLREC-G  OCCURS  800.
                       09  SPA-GMN-TBANGO      PIC 9(03).
                       09  SPA-GMN-TMEISYO     PIC X(200).
                       09  SPA-GMN-TMEISYO-1   REDEFINES
                                                   SPA-GMN-TMEISYO.
                           11  SPA-GMN-TYOBI0      PIC X(02).
                           11  SPA-GMN-TMEISYO1    PIC X(196).
                       09  SPA-GMN-TMEISYO-2   REDEFINES
                                               SPA-GMN-TMEISYO.
                           11  SPA-GMN-TMEISYO2    PIC X(44).
                           11  SPA-GMN-HEN1.
                               13  SPA-GMN-TSURYOU     PIC X(18).
                               13  SPA-GMN-TTANI1      PIC X(08).
                               13  SPA-GMN-TTANMEI     PIC X(06).
                               13  SPA-GMN-TTANI2      PIC X(04).
                               13  SPA-GMN-TYOBI1      PIC X(14).
                           11  SPA-GMN-HEN2    REDEFINES
                                               SPA-GMN-HEN1.
                               13  SPA-GMN-TZAIKEI     PIC X(40).
      *
                       09  SPA-NAI-TBANGO        PIC  9(03).
               05  SPA-GMN-MAX2                  PIC 9(04).
               05  SPA-NAI-MAX2                  PIC 9(04).
      *
               05  SPA-GMN-DOSEL             PIC X(40).
               05  SPA-NAI-DOSEL-G.
                   07  SPA-NAI-DOSEL         PIC 9(03)
                                             OCCURS   135.
                   07  SPA-NAI-DOSEL-MAX     PIC 9(03).
      *
               05  SPA-NAI-AREA.
      *
                   07  SPA-NAI-TBL.
                       09  SPA-NAI-TBLREC            OCCURS   800.
                           11  SPA-NAI-ZAINUM        PIC  9(08).
                           11  SPA-NAI-SRYKBN        PIC  X(02).
                       09  SPA-SEL-IDX               PIC  9(02).
                       09  SPA-SEL-RENNUM            PIC  9(01).
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  STS-AREA.
           03  STS-PARA            PIC X(02).
           03  STS-SRYKBN          PIC X(02).
           03  STS-SPASCR          PIC X(02).
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-END             PIC 9(01).
           03  FLG-END2            PIC 9(01).
           03  FLG-SPASCR          PIC 9(01).
           03  FLG-SRYKBN          PIC 9(01).
           03  FLG-WKSRYACT        PIC 9(01).
           03  FLG-SRYACT          PIC 9(01).
           03  FLG-PTCOM           PIC 9(01).
           03  FLG-SRYACCT         PIC 9(01).
           03  FLG-JYURRK          PIC 9(01).
           03  FLG-TENSU           PIC 9(01).
           03  FLG-PARA            PIC 9(01).
           03  FLG-INPUTCD         PIC 9(01).
      *
           03  FLG-OK              PIC 9(01).
           03  FLG-OK2             PIC 9(01).
           03  FLG-SP              PIC 9(01).
           03  FLG-ERR             PIC 9(01).
           03  FLG-ARI             PIC 9(01).
           03  FLG-SINKI           PIC 9(01).
           03  FLG-YAKUSOKU        PIC 9(01).
           03  FLG-CHK             PIC 9(01).
      *
           03  FLG-KAI             PIC 9(01).
           03  FLG-DOALL           PIC 9(01).
           03  FLG-WRITE           PIC 9(01).
           03  FLG-HEN             PIC 9(01).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX                 PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDZ                 PIC 9(04).
           03  IDG                 PIC 9(04).
           03  IDG3                PIC 9(04).
           03  IDM                 PIC 9(04).
           03  IDK1                PIC 9(04).
           03  IDK2                PIC 9(04).
           03  IDX1                PIC 9(04).
           03  IDX2                PIC 9(04).
           03  IDX-P               PIC 9(04).
           03  IDX-KOUI            PIC 9(04).
           03  IDX-SIN             PIC 9(04).
           03  IDX-ATO             PIC 9(04).
           03  IDX-YAKUZAI         PIC 9(04).
           03  IDX-Y2              PIC 9(02).
      *
           03  IDX-R                   PIC 9(04).
           03  IDX-W                   PIC 9(04).
           03  IDX-KAI                 PIC 9(04).
           03  IDX-STR                 PIC 9(02).
           03  IDX-H                   PIC 9(04).
      *
           03  IDX-S                   PIC 9(04).
           03  IDX-D1                  PIC 9(04).
           03  IDX-D2                  PIC 9(04).
           03  IDX-D3                  PIC 9(04).
           03  IDX-Z                   PIC 9(04).
           03  IDX-ZAI                 PIC 9(04).
      *
           03  IDX-S1              PIC 9(04).
           03  IDX-S2              PIC 9(06).
           03  IDX-SP              PIC 9(06).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-SYSYMD.
               05  WRK-SYSYY       PIC 9(04).
               05  WRK-SYSMM       PIC 9(02).
               05  WRK-SYSDD       PIC 9(02).
      *
           03  WRK-WYMD.
               05  WRK-WGO         PIC X(01).
               05  WRK-WYY         PIC 9(02).
               05  WRK-WFIL1       PIC X(01).
               05  WRK-WMM         PIC 9(02).
               05  WRK-WFIL2       PIC X(01).
               05  WRK-WDD         PIC 9(02).
           03  WRK-SYMD.
               05  WRK-SYY         PIC 9(04).
               05  WRK-SMM         PIC 9(02).
               05  WRK-SDD         PIC 9(02).
      *
           03  WRK-BANGO               PIC 9(03).
           03  WRK-BANGO-X             PIC X(03).
           03  WRK-DOSELNUM            PIC 9(04).
           03  WRK-IDXNUM              PIC 9(04).
           03  WRK-MAE-NYUGAIKBN       PIC X(01).
      *
           03  WRK-SELNUM-CHK-G.
               05  WRK-SELNUM-CHK  PIC 9(03)   OCCURS  135.
           03  WRK-HEN-SELNUM      PIC X(40).
           03  WRK-HEN-SELNUM-2    PIC X(40).
           03  WRK-HEN-SELNUM-HZN  PIC X(40).
           03  WRK-SELNUM-AREA.
               05  WRK-SELNUM-OCC    OCCURS   135.
                   07  WRK-SEL9        PIC 9(01).
      *
           03  WRK-DOSEL.
               05  WRK-DOSEL-OCC   OCCURS   135.
                   07  WRK-DO          PIC X(03).
                   07  WRK-DONUM       PIC 9(03).
                   07  WRK-KAI         PIC X(03).
                   07  WRK-KAINUM      PIC 9(03).
                   07  WRK-SEL         PIC X(01).
      *
           03  WRK-DOZAINUM-AREA.
               05  WRK-DOZAINUM-OCC    OCCURS   135.
                   07  WRK-DOZAINUM    PIC 9(08).
                   07  WRK-DOKAI       PIC 9(03).
      *
           03  HZN-DOZAINUM-AREA.
               05  HZN-DOZAINUM-OCC    OCCURS   135.
                   07  HZN-DOZAINUM    PIC 9(08).
                   07  HZN-DOKAI       PIC 9(03).
      *
           03  WRK-DOKAISU             PIC 9(03).
      *
           03  WRK-ZAINUM          PIC 9(08).
           03  WRK-ZAIKAISU        PIC 9(08).
           03  WRK-EDANUM          PIC 9(02).
      *
           03  WRK-TENSU-X.
               05  WRK-TENSU       PIC Z(08).
           03  WRK-KAISU-X.
               05  WRK-KAISU       PIC Z(08).
           03  WRK-KEI-X.
               05  WRK-KEI         PIC Z(08).
           03  WRK-KEI-G           PIC 9(08).
      *
      *    ¿ÇÎÅ¹Ô°ÙÌ¾¾Î
           03  WRK-SRYSYUMEI       PIC X(40).
      *
           03  WRK-SRYSYUMEI-H     PIC X(400).
      *
           03  WRK-MEISYO          PIC X(40).
      *    ¿ôÎÌÉ½¼¨ÍÑ
           03  WRK-SURYO           PIC 9(05)V9(03).
           03  WRK-SURYO-R         REDEFINES   WRK-SURYO.
               05  WRK-SURYO-S1    PIC 9(05).
               05  WRK-SURYO-S2    PIC 9(03).
           03  WRK-SURYO-X.
               05  WRK-SURYO-Z1    PIC ZZZZZ.
               05  WRK-SURYO-Z1-9  REDEFINES   WRK-SURYO-Z1
                                   PIC ZZZZ9.
               05  WRK-SURYO-Z2    PIC X(01).
               05  WRK-SURYO-Z3    PIC ZZZ.
           03  WRK-SURYO-J         PIC X(18).
      *    Ê¬²è¿ô²èÌÌÊÔ½¸ÍÑ
           03  WRK-BUNGSU-X.
               05  WRK-BUNGSU-Z    PIC ZZZ.
           03  WRK-BUNGSU-J        PIC X(06).
      *    ºÞ²ó¿ôÅù²èÌÌÊÔ½¸ÍÑ
           03  WRK-KAISU-H         PIC X(08).
           03  WRK-KEI-H           PIC X(08).
           03  WRK-ZAIKEI          PIC X(40).
           03  WRK-IDG             PIC 9(04).
           03  WRK-ZAIKEIJ         PIC X(80).
           03  IDJ                 PIC 9(04).
           03  IDJ1                PIC 9(01).
           03  IDJ2                PIC 9(04).
      *
           03  WRK-Z9              PIC Z,ZZZ,ZZZ.
           03  WRK-Z92             PIC --,---,---.
           03  WRK-ZZ              PIC ZZZ.
           03  WRK-ZZZ             PIC ZZZZ.
      *
           03  WRK-KIN             PIC 9(07).
      *
           03  WRK-ZAITEN              PIC 9(08).
           03  WRK-SRYKAISUKEI         PIC 9(03).
           03  WRK-SRYSURYOKEI         PIC 9(07)V9(03).
           03  WRK-MEISAISU            PIC 9(07).
           03  WRK-JIHIMONEY           PIC 9(07).
      *
           03  WRK-SEIKYU              PIC S9(07).
      *
           03  WRK-DENPNUM         PIC 9(07).
           03  WRK-MEIBAN          PIC 9(03).
      *
           03  WRK-HOUKNS-CNT          PIC 9(02).
           03  WRK-HOUKNS-IDX          PIC 9(04).
           03  WRK-HOUKNS-NAME         PIC X(100).
      *
           03  WRK-ERRMSG          PIC X(40).
      *
           03  WRK-GOKEI-X2.
               05  WRK-GOKEI-Z2    PIC ZZZ,ZZZ,ZZZ.
      *
           03  WRK-PATH                    PIC X(64).
      *
      *    ¥³¥é¥à¥ê¥¹¥È°ÌÃÖ
           03  WRK-K09-RRKLIST-ROW     PIC S9(09).
           03  WRK-K09-MEILIST-ROW     PIC S9(09).
           03  FLG-GMN-INIT1           PIC  9(01).
           03  FLG-GMN-INIT2           PIC  9(01).
      *
       01  WRK-HEN-AREA.
           03  WRK-HENYMDG         PIC X(09).
           03  WRK-HENYMD.
               05  WRK-HGO         PIC X(01).
               05  WRK-HYY         PIC 9(02).
               05  FILLER          PIC X(01)   VALUE   ".".
               05  WRK-HMM         PIC 9(02).
               05  FILLER          PIC X(01)   VALUE   ".".
               05  WRK-HDD         PIC 9(02).
      *
      *²èÌÌºÇÂç¹Ô
       01  MAX-LINE                PIC 9(04)   VALUE   800.
      *ÁªÂò¿ô£Í£Á£Ø¡Ê£±¼õ¿ÇºÇÂçºÞ¿ô¡Ë
       01  MAX-SEL                 PIC 9(04)   VALUE   135.
      *
      *    ¿ÇÎÅ¼ïÊÌÌ¾¥Æ¡¼¥Ö¥ë
           COPY    "CPORCSSRYSYU.INC".
      *
      *   ÆüËÜ¸ì¿ô»ú
       01  TBL-SUJI-AREA.
           03  FILLER          PIC X(20)   VALUE
              "£±£²£³£´£µ£¶£·£¸£¹£°".
       01  TBL-SUJI-R          REDEFINES   TBL-SUJI-AREA.
           03  TBL-SUJI        PIC X(02)   OCCURS   10.
      *
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿
           COPY    "CPSYSKANRI.INC".
      *
      *    ¥ï¡¼¥¯¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡Ý
       01  WKSRYACT-REC.
           COPY    "CPWKSRYACT.INC".
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¡Ý
      *01  TENSU-REC.
           COPY    "CPTENSU.INC".
      *
      *    ÆþÎÏ¥³¡¼¥É¥Þ¥¹¥¿¡Ý
       01  INPUTCD-REC.
           COPY    "CPINPUTCD.INC".
      *
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡Ý
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    ¿ÇÎÅ²ñ·×¥Þ¥¹¥¿¡Ý
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    ¼õ¿ÇÍúÎò
       01  JYURRK-REC.
           COPY    "CPJYURRK.INC".
      *
      *    ´µ¼Ô¥³¥á¥ó¥È
       01  PTCOM-REC.
           COPY    "CPPTCOM.INC".
      *
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¥ï¡¼¥¯
       01  LNK-WKSRYACT-AREA.
           02  LNK-WKSRYACT-REC      OCCURS   300.
           COPY    "CPWKSRYACT.INC"  REPLACING
                                     //WKSRY-// BY //LNK-WKSRY-//.
       01  LNK-WKSRYACT-MAX           PIC 9(04).
      *
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¥ï¡¼¥¯
       01  WRK-WKSRYACT-REC.
           COPY    "CPWKSRYACT.INC"  REPLACING
                                    //WKSRY-// BY //WRK-WKSRY-//.
      *    ¼õ¿ÇÍúÎò
       01  HZN-JYURRK-REC.
           COPY    "CPJYURRK.INC"    REPLACING
                                     //JYURRK-// BY //HZN-JYURRK-//.
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    ¿ô»úÊÑ´¹ÎÎ°è
           COPY    "CPORCSNUM.INC".
      *
      *    ¥Õ¥¡¥¤¥ëºï½ü¥Ñ¥é¥á¥¿
           COPY    "CPORCSFDEL.INC".
      *    É½¼¨Ì¾¾ÎÊÔ½¸¥Ñ¥é¥á¥¿ÎÎ°è
           COPY    "CPORCSMEIHEN.INC".
      *
      *    £Ä£Â¸¡º÷
      *01  MCPDATA-REC                 PIC X(5000).
           COPY    "MCPDATA.INC".
      **** COPY    "CPORCMCP.INC".
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
        LINKAGE                     SECTION.
      *
           COPY    "MCPAREA".
           COPY    "ORCA-SPA".
      *
           COPY    "LINKAREA".
      *
       01  SCRAREA.
           COPY    "K01.INC".
           COPY    "K02.INC".
           COPY    "K02N.INC".
           COPY    "K021.INC".
           COPY    "K022.INC".
           COPY    "K023.INC".
           COPY    "K03.INC".
           COPY    "K04.INC".
           COPY    "K05.INC".
           COPY    "K051.INC".
           COPY    "K052.INC".
           COPY    "K06.INC".
           COPY    "K07.INC".
           COPY    "K08.INC".
           COPY    "K081.INC".
           COPY    "K09.INC".
           COPY    "K10.INC".
           COPY    "K97.INC".
           COPY    "K98.INC".
           COPY    "K99.INC".
           COPY    "K03X.INC".
           COPY    "KERR.INC".
           COPY    "KERR2.INC".
           COPY    "KID1.INC".
           COPY    "KID2.INC".
           COPY    "KHELP.INC".
      *
       PROCEDURE                   DIVISION    USING
           MCPAREA
           SPAAREA
           LINKAREA
           SCRAREA.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  STS-AREA
           INITIALIZE                  WRK-AREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-K02
           MOVE    SPA-WORK        TO  SPA-K01KYOUTU
      *
      *    ¿ÇÎÅ¼ïÊÌ¥Æ¡¼¥Ö¥ë¥»¥Ã¥È
           PERFORM 1001-SRYKBN-SET-SEC
      *
      *    ²èÌÌ£Ó£Ð£ÁÆÉ¤ß¹þ¤ß
           PERFORM 1002-K09SPA-SET-SEC
      *
           MOVE    SPACE           TO  SPA-ERRCD
           MOVE    ZERO            TO  FLG-END
           EVALUATE    MCP-STATUS      ALSO    MCP-EVENT
               WHEN    "LINK"          ALSO    ANY
                   PERFORM 100-INIT-SEC
      *    ²èÌÌÁ«°Ü
               WHEN     "PUTG"           ALSO   "CLICKED"
                   PERFORM 200-GMNSENI
      *    ÆþÎÏ
               WHEN      OTHER
                   PERFORM 200-ENTRY
           END-EVALUATE.
      *
      *    ²èÌÌÁ«°Ü¤¬¤Ê¤¤»þ¡¢²èÌÌÉ½¼¨¤Ø
           IF      FLG-END             =   ZERO
               PERFORM 500-SET-SCREEN
           END-IF
      *
      *    ²èÌÌ£Ó£Ð£Á½ñ¹þ¤ß
           IF      FLG-END2            =   ZERO
               PERFORM 1003-K09SPA-OUT-SEC
           END-IF
      *
           MOVE    SPA-K01KYOUTU   TO  SPA-WORK
           MOVE    SPA-AREA        TO  SPA-COMMON
           MOVE    SPA-K02         TO  SPA-FREE
      *
           .
           EXIT    PROGRAM
           .
      *
      *****************************************************************
      *    ¿ÇÎÅ¼ïÊÌ¥Æ¡¼¥Ö¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       1001-SRYKBN-SET-SEC             SECTION.
      * 
      *    ¿ÇÎÅ¼ïÊÌ¥Æ¡¼¥Ö¥ë¥»¥Ã¥È
           CALL    "ORCSSRYSYU"        USING
                                       MSYU-DATA-REC
           .
       1001-SRYKBN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ó£Ð£Á¥Ç¡¼¥¿£Ò£Å£Á£Ä½èÍý
      *****************************************************************
       1002-K09SPA-SET-SEC             SECTION.
      *
           MOVE    SPA-TERMID          TO  FILE-TERMID1
           MOVE    SPA-HOSPNUM         TO  FILE-HOSPNUM1
      *
           OPEN    INPUT               SPASCR-FILE
           IF      STS-SPASCR     NOT =   ZERO
               GO      TO      1002-K09SPA-SET-EXT
           END-IF
      *
           MOVE    SPACE               TO  SPA-K09
           INITIALIZE                  SPA-K09
           MOVE    SPACE               TO  WRK-DATA-REC
           INITIALIZE          WRK-DATA-REC
           MOVE    ZERO                TO  FLG-SPASCR
           MOVE    ZERO                TO  IDX
           PERFORM UNTIL       FLG-SPASCR  =   1
               READ    SPASCR-FILE
                   AT  END
                       MOVE   1            TO  FLG-SPASCR
                   NOT AT  END
                       ADD    1            TO  IDX
                       MOVE   SPA-DATA-REC     TO  WRK-DATA (IDX)
               END-READ
           END-PERFORM
      *
           MOVE    WRK-DATA-REC        TO  SPA-K09
      *
           CLOSE                       SPASCR-FILE
           .
       1002-K09SPA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ó£Ð£Á¥Ç¡¼¥¿£×£Ò£É£Ô£Å½èÍý
      *****************************************************************
       1003-K09SPA-OUT-SEC             SECTION.
      *
           MOVE    SPA-TERMID          TO  FILE-TERMID1
           MOVE    SPA-HOSPNUM         TO  FILE-HOSPNUM1
      *
           OPEN    OUTPUT              SPASCR-FILE
           IF      STS-SPASCR     NOT =   ZERO
               DISPLAY "K09SPASCR OUT OPEN ERR:"   STS-SPASCR "."
           END-IF
      *
           MOVE    SPA-K09             TO  WRK-DATA-REC
           PERFORM VARYING     IDX     FROM   1   BY  1
                   UNTIL      (IDX     >   10  )  OR
                              (WRK-DATA (IDX)     =   SPACE)
      *
               MOVE    WRK-DATA (IDX)      TO  SPA-DATA-REC
               WRITE                       SPA-DATA-REC
               IF      STS-SPASCR     NOT =   ZERO
                   DISPLAY "K09SPASCR OUT WRITE ERR:"   STS-SPASCR "."
                END-IF
           END-PERFORM
      *
           CLOSE                       SPASCR-FILE
           .
       1003-K09SPA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
      *    DISPLAY "*** ORCSNPL    START  ***"
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  STS-AREA
           INITIALIZE                  WRK-AREA
      *
      *    ¥¨¥é¡¼²èÌÌ¤è¤ê
           IF      SPA-MOTOPG          =   "KERR"
               MOVE    SPACE               TO  SPA-MOTOPG
               PERFORM 5001-MAPCUR-SEC
           ELSE
      *
      *        ½é´ü²èÌÌÊÔ½¸
               PERFORM 300-SCREEN-SEC
      *
      *        ²èÌÌÊÔ½¸
               PERFORM 500-GMNHEN-SEC
           END-IF
      *
           MOVE   "NEW"                TO  MCP-PUTTYPE.
           MOVE   "K09"                TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
           .
      *
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é´ü²èÌÌ½èÍý
      *****************************************************************
       300-SCREEN-SEC             SECTION.
      *
      *    ÆâÉô²èÌÌ¤è¤ê
           EVALUATE    SPA-MOTOPG
               WHEN    "K07"
                   IF      SPA-K09-DOSELNUM    >   ZERO
      *                ¿Ç»¡ÆâÍÆÊÔ½¸
                       PERFORM 4101-JYURRK-HEN-SEC
                   ELSE
                       MOVE    1               TO  SPA-K09GMN-CUR
                   END-IF
      *
               WHEN    OTHER
                   PERFORM 3001-INIT-SPA-SEC
           END-EVALUATE
           .
      *
       300-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       3001-INIT-SPA-SEC                  SECTION.
      *
           MOVE    1                   TO  FLG-GMN-INIT1
           MOVE    1                   TO  FLG-GMN-INIT2
           INITIALIZE                  SPA-K09-AREA
           INITIALIZE                  SPA-K09KYOU-AREA
           MOVE    ZERO                TO  SPA-K09-SELOK
           MOVE    SPA-RRK-PAGE        TO  SPA-K09-RRK-PAGE
           MOVE    SPA-RRK-NEXT        TO  SPA-K09-RRK-NEXT
      *
           PERFORM                     310-SPA-SET-SEC
      *    ÁªÂò
           MOVE    SPA-NAI-DOSELNUM    TO  SPA-K09-DOSELNUM
           MOVE    SPA-NAI-SELNUM      TO  SPA-K09-SELNUM
           IF      SPA-K09-DOSELNUM    >   ZERO
      *        ¿Ç»¡ÆâÍÆÊÔ½¸
               PERFORM 4101-JYURRK-HEN-SEC
           ELSE
               MOVE    1               TO  SPA-K09GMN-CUR
           END-IF
      *
           .
       3001-INIT-SPA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       310-SPA-SET-SEC                  SECTION.
      *
      *    Æþ³°¶èÊ¬ÀßÄê
           MOVE    SPA-NYUGAIKBN       TO  SPA-K09-NYUGAIKBN
           IF      SPA-K02N-TAIINYMD   =   SPACE
               MOVE    "2 ³°Íè"            TO  SPA-K09-NYUGAIKBN-LST (1)
               MOVE    1                   TO  SPA-K09-NYUGAIKBN-MAX
           ELSE
               MOVE    "1 Æþ±¡"            TO  SPA-K09-NYUGAIKBN-LST (1)
               MOVE    "2 ³°Íè"            TO  SPA-K09-NYUGAIKBN-LST (2)
               MOVE    2                   TO  SPA-K09-NYUGAIKBN-MAX
           END-IF
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-K09-NYUGAIKBN-MAX
               IF      SPA-K09-NYUGAIKBN   =   SPA-K09-NYUGAIKBN-LST
                                                           (IDX)(1:1)
                   MOVE    SPA-K09-NYUGAIKBN-LST (IDX)
                                           TO  SPA-K09-NYUGAIKBN-G
               END-IF
           END-PERFORM
      *
      *    ¿ÇÎÅ¶èÊ¬
           INITIALIZE                  SPA-K09-SRYKBN-LIST
           MOVE    "00 Á´ÂÎ"           TO  SPA-K09-SRYKBN-LST (01)
           MOVE    "10 °å³Ø´ÉÍý¡¦ºßÂð" TO  SPA-K09-SRYKBN-LST (02)
           MOVE    "20 ÅêÌô"           TO  SPA-K09-SRYKBN-LST (03)
           MOVE    "30 Ãí¼Í"           TO  SPA-K09-SRYKBN-LST (04)
           MOVE    "40 ½èÃÖ"           TO  SPA-K09-SRYKBN-LST (05)
           MOVE    "50 ¼ê½Ñ¡¦Ëã¿ì"     TO  SPA-K09-SRYKBN-LST (06)
           MOVE    "60 ¸¡ºº"           TO  SPA-K09-SRYKBN-LST (07)
           MOVE    "70 ²èÁü¿ÇÃÇ"       TO  SPA-K09-SRYKBN-LST (08)
           MOVE    "80 ¥ê¥Ï¥Ó¥ê¡¦¤½¤ÎÂ¾"
                                       TO  SPA-K09-SRYKBN-LST (09)
           MOVE    "90 ¼«Èñ¡¦¤½¤ÎÂ¾"   TO  SPA-K09-SRYKBN-LST (10)
           MOVE    "29 ÅêÌô¡¦Ãí¼Í"     TO  SPA-K09-SRYKBN-LST (11)
      *
           MOVE    11                  TO  SPA-K09-SRYKBN-MAX
           MOVE    SPA-DOSRYKBNFLG     TO  SPA-K09-SRYKBN
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-K09-SRYKBN-MAX )  OR
                              (FLG-OK  =   1        )
               IF      SPA-K09-SRYKBN  =   SPA-K09-SRYKBN-LST
                                                           (IDX)(1:2)
                   MOVE    SPA-K09-SRYKBN-LST (IDX)
                                           TO  SPA-K09-SRYKBN-G
                   MOVE    1               TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    SPA-K09-SRYKBN-LST (01) TO  SPA-K09-SRYKBN-G
           END-IF
      *
      *    ¼õ¿ÇÍúÎòÊÔ½¸
           IF     (SPA-K09-NYUGAIKBN   =   SPA-NYUGAIKBN ) AND
                  (SPA-K09-RRK-PAGE    =   SPA-RRK-PAGE  )
               PERFORM 3102-JYURRK-SPAHEN-SEC
           ELSE
               PERFORM 3101-JYURRK-DBHEN-SEC
           END-IF
           .
       310-SPA-SET-EXT.
           EXIT.
      *****************************************************************
      *    £Ó£Ð£Á¤«¤éÊÔ½¸½èÍý
      *****************************************************************
       3102-JYURRK-SPAHEN-SEC             SECTION.
      *
           INITIALIZE                  SPA-K09GMN-RRKTBL
           INITIALIZE                  SPA-K09NAI-RRKTBL
           PERFORM   VARYING   IDX     FROM    1   BY  1
                     UNTIL     IDX         >   SPA-GMN-MAX1
               MOVE    SPA-GMN-NO (IDX)    TO  SPA-K09GMN-NO (IDX)
               MOVE    SPA-GMN-RRKYMD(IDX) TO  SPA-K09GMN-RRKYMD (IDX)
               MOVE    SPA-GMN-RRKHKNCOMBI (IDX)
                                           TO  SPA-K09GMN-RRKHKNCOMBI
                                                                 (IDX)
               MOVE    SPA-GMN-RRKSRYKA (IDX)
                                           TO  SPA-K09GMN-RRKSRYKA
                                                                 (IDX)
               MOVE    IDX                 TO  SPA-K09GMN-MAX1
               MOVE    SPA-NAI-RRKTBLREC (IDX)
                                           TO  SPA-K09NAI-RRKTBLREC(IDX)
           END-PERFORM
           .
       3102-JYURRK-SPAHEN-EXT.
           EXIT.
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¤«¤éÊÔ½¸½èÍý
      *****************************************************************
       3101-JYURRK-DBHEN-SEC             SECTION.
      *
           MOVE    ZERO                TO  SPA-K09-DOSELNUM
           MOVE    ZERO                TO  SPA-K09-SELNUM
      *
           INITIALIZE                  SPA-K09GMN-RRKTBL
           INITIALIZE                  SPA-K09NAI-RRKTBL
           INITIALIZE                  HZN-JYURRK-REC
      *    ¼õ¿ÇÎò¤ò¸¡º÷¤¹¤ë  °åÎÅµ¡´Ø¡¢´µ¼Ô£É£Ä
           INITIALIZE                  JYURRK-REC
           MOVE    SPA-HOSPNUM         TO  JYURRK-HOSPNUM
           MOVE    SPA-PTID            TO  JYURRK-PTID
           MOVE    SPA-K09-NYUGAIKBN   TO  JYURRK-NYUGAIKBN
      *
           MOVE    JYURRK-REC          TO  MCPDATA-REC
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           ELSE
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
      *
      *    ³«»Ï°ÌÃÖ»ØÄê
           IF      SPA-RRK-PAGE        =   ZERO
               MOVE    1               TO  SPA-K09-RRK-PAGE
           END-IF
           COMPUTE IDX-SP              =  ((SPA-K09-RRK-PAGE  -   1  )
                                       *   150  )
                                       +   1
           MOVE    ZERO                TO  IDX-S1
           MOVE    ZERO                TO  IDX-S2
           MOVE    ZERO                TO  SPA-K09-RRK-NEXT
      *
           MOVE    ZERO                TO  IDX
           PERFORM
               UNTIL   (FLG-JYURRK         =   1   )  OR
                       (SPA-K09-RRK-NEXT   =   1   )
      *DDD             (SPA-K09GMN-MAX1    >=  150 )
      *TEST
      *        ¿ÇÎÅÆü¡¢Ï¢ÈÖ¤Ç£±¹Ô¤È¤¹¤ë
      *        MOVE    ZERO            TO  IDX-S
      *        PERFORM VARYING     IDX2    FROM    1   BY  1
      *                UNTIL       IDX2    >   SPA-K09GMN-MAX1
      *            IF     (JYURRK-RENNUM       =   SPA-K09NAI-RENNUM
      *                                                (IDX2))  AND
      *                   (JYURRK-DOUJI-RENNUM =
      *                                        SPA-K09NAI-DOUJI-RENNUM
      *                                                (IDX2))  AND
      *                   (JYURRK-SRYYMD       =   SPA-K09NAI-RRKYMD
      *                                                (IDX2))
      *              AND  (JYURRK-SRYKA        =   SPA-K09NAI-RRK-SRYKA
      *                                                (IDX2))
      *                MOVE    IDX2            TO  IDX-S
      *                MOVE    SPA-K09GMN-MAX1 TO  IDX2
      *            END-IF
      *        END-PERFORM
      *
      *        IF      IDX-S           =   ZERO
      *            ADD     1               TO  SPA-K09GMN-MAX1
      *            MOVE    SPA-K09GMN-MAX1 TO  IDX
      *        ELSE
      *            MOVE    IDX-S           TO  IDX
      ******** END-IF
      *TEST
               MOVE    ZERO                TO  IDX-S
               IF      JYURRK-EDANUM       =   1
                   ADD     1                   TO  IDX-S2
                   IF      IDX-S1              =   9999
                       MOVE    ZERO            TO  IDX-S1
                   END-IF
                   ADD     1                   TO  IDX-S1
               ELSE
                   IF     (JYURRK-SRYYMD       =   HZN-JYURRK-SRYYMD)
                     AND  (JYURRK-SRYKA        =   HZN-JYURRK-SRYKA )
                     AND  (JYURRK-HKNCOMBINUM  =
                                               HZN-JYURRK-HKNCOMBINUM )
                     AND  (JYURRK-RENNUM       =   HZN-JYURRK-RENNUM)
                     AND  (JYURRK-DOUJI-RENNUM =
                                               HZN-JYURRK-DOUJI-RENNUM)
                       MOVE    IDX-S1              TO  IDX-S
                   ELSE
                       ADD     1                   TO  IDX-S2
                       IF      IDX-S1              =   9999
                           MOVE    ZERO            TO  IDX-S1
                       END-IF
                       ADD     1                   TO  IDX-S1
                       DISPLAY "K09 JYURRK EDANUM ERR??:"
                                                    JYURRK-KEY
                   END-IF
               END-IF
               IF      IDX-SP          <=   IDX-S2
      *            ÊÔ½¸ÂÐ¾Ý
                   IF      IDX-S           =   ZERO
                       ADD     1               TO  IDX
                       IF      IDX             >   150
                           MOVE    1           TO  SPA-K09-RRK-NEXT
                       ELSE
                           MOVE    IDX         TO  SPA-K09GMN-MAX1
                       END-IF
                   END-IF
                   IF      SPA-K09-RRK-NEXT    =   ZERO
      *                ÌÀºÙ¹àÌÜÂàÈò
                       PERFORM 31011-JYURRK-SPAHEN-SEC
                   END-IF
               END-IF
      *
      **       ÌÀºÙ¹àÌÜÂàÈò
      **       PERFORM 31011-JYURRK-SPAHEN-SEC
      *
               MOVE    JYURRK-REC          TO  HZN-JYURRK-REC
      *
               MOVE    "tbl_jyurrk"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           END-PERFORM
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *    ¿Ç»¡Æü¤ÎºÆÊÔ½¸
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-K09GMN-MAX1
               MOVE    ZERO            TO  FLG-HEN
               PERFORM VARYING     IDX2    FROM    IDX BY  1
                       UNTIL       IDX2    >   SPA-K09GMN-MAX1
                   IF     (IDX2            NOT =   IDX )  AND
                          (SPA-K09NAI-RRKYMD  (IDX)
                                               =   SPA-K09NAI-RRKYMD 
                                                          (IDX2)) AND
                          (SPA-K09NAI-RRK-SRYKA(IDX)
                                               =   SPA-K09NAI-RRK-SRYKA
                                                          (IDX2))
                       MOVE    1                   TO  FLG-HEN
                       MOVE    SPA-K09GMN-MAX1     TO  IDX2
                   ELSE
                       IF     (SPA-K09NAI-RRKYMD(IDX)
                                           NOT =   SPA-K09NAI-RRKYMD
                                                       (IDX2))
                           MOVE    SPA-K09GMN-MAX1 TO  IDX2
                       END-IF
                   END-IF
               END-PERFORM
               IF     (SPA-K09NAI-RENNUM (IDX)        >   1 ) OR
                      (SPA-K09NAI-DOUJI-RENNUM (IDX)  >  ZERO )
                   MOVE    1                   TO  FLG-HEN
               END-IF
               IF      FLG-HEN             =   1
                   MOVE    "("             TO  SPA-K09GMN-RRKYMD (IDX)
                                                               (10:1)
                   MOVE    SPA-K09NAI-RENNUM (IDX) 
                                           TO  SPA-K09GMN-RRKYMD (IDX)
                                                              (11:1)
                   MOVE    ")"             TO  SPA-K09GMN-RRKYMD (IDX)
                                                              (12:1)
                   IF      SPA-K09NAI-DOUJI-RENNUM (IDX)  NOT =   ZERO
                       MOVE    SPA-K09NAI-DOUJI-RENNUM (IDX) 
                                           TO  SPA-K09GMN-RRKYMD (IDX)
                                                              (13:1)
                   END-IF
               END-IF
      *        Ê£¿ô¿ÇÎÅ²Ê
               IF      SPA-K09NAI-RRK-FUKU-KBN (IDX)  =   "1"  OR  "2"
                   MOVE    "F"             TO  SPA-K09GMN-RRKYMD (IDX)
                                                              (13:1)
               END-IF
      *
               MOVE    SPA-K09NAI-RRK-HKNCOMBI(IDX)
                                             TO  SPA-K09GMN-RRKHKNCOMBI
                                                                  (IDX)
               IF      SPA-K09NAI-RRK-HKNKBN  (IDX)  =   "1"
                                                     OR  "5"
                   MOVE    "Ï«"              TO  SPA-K09GMN-RRKHKNCOMBI
                                                                  (IDX)
               END-IF
               IF      SPA-K09NAI-RRK-HKNKBN  (IDX)  =   "2"
                                                     OR  "4"
                   MOVE    "¼«"              TO  SPA-K09GMN-RRKHKNCOMBI
                                                                  (IDX)
               END-IF
      *        ²ÊÌ¾
               PERFORM VARYING IDY     FROM    1   BY  1
                       UNTIL   IDY         >   SPA-SRYKA-MAX
                   IF      SPA-K09NAI-RRK-SRYKA (IDX)
                                           =   SPA-GMN-SRYKAL(IDY)
                       MOVE    SPA-GMN-SRYKAMEIL(IDY)(1:2)
                                           TO  SPA-K09GMN-RRKSRYKA(IDX)
                       MOVE    SPA-SRYKA-MAX   TO  IDY
                   END-IF
               END-PERFORM
           END-PERFORM
      *
           .
       3101-JYURRK-DBHEN-EXT.
           EXIT.
      *****************************************************************
      *    ²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       31011-JYURRK-SPAHEN-SEC             SECTION.
      *
      **** MOVE    IDX                 TO  SPA-K09GMN-NO    (IDX)
           MOVE    IDX-S1              TO  SPA-K09GMN-NO (IDX)
      *    Ï¢ÈÖ
           MOVE    JYURRK-RENNUM       TO  SPA-K09NAI-RENNUM(IDX)
      *    Ï¢ÈÖ
           MOVE    JYURRK-DOUJI-RENNUM TO  SPA-K09NAI-DOUJI-RENNUM(IDX)
      *    ÅÁÉ¼ÈÖ¹æ
           MOVE    JYURRK-DENPNUM      TO  SPA-K09NAI-RRK-DENPNUM(IDX)
      *    ¿Ç»¡Æü
           MOVE    JYURRK-SRYYMD       TO  SPA-K09NAI-RRKYMD(IDX)
           MOVE    JYURRK-SRYYMD       TO  WRK-SYMD
           PERFORM 520-SEIWA-HEN-SEC
           MOVE    WRK-HENYMDG         TO  SPA-K09GMN-RRKYMD (IDX)
      *    ÊÝ¸±¶èÊ¬
           MOVE    JYURRK-HKNKBN       TO  SPA-K09NAI-RRK-HKNKBN (IDX)
      *    ÊÝ¸±ÁÈ¹ç¤»
           MOVE    JYURRK-HKNCOMBINUM  TO  SPA-K09NAI-RRK-HKNCOMBI (IDX)
      *    ¥É¥¯¥¿¡¼
           MOVE    JYURRK-DRCD         TO  SPA-K09NAI-RRK-DRCD  (IDX)
      *    ¿ÇÎÅ²Ê
           MOVE    JYURRK-SRYKA        TO  SPA-K09NAI-RRK-SRYKA  (IDX)
      *    Ê£¿ô¿ÇÎÅ²Ê¡¦ÊÝ¸±
           MOVE    JYURRK-GRP-DENPNUM TO  SPA-K09NAI-GRP-DENPNUM (IDX)
           MOVE    JYURRK-GRP-RENNUM  TO  SPA-K09NAI-GRP-RENNUM (IDX)
           MOVE    JYURRK-SYU-UPDKBN  TO  SPA-K09NAI-SYU-UPDKBN (IDX)
      *
           MOVE    IDX                 TO  SPA-K09GMN-MAX1
      *
           .
       31011-JYURRK-SPAHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       200-GMNSENI                   SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *        Ìá¤ë
               WHEN    "CLICKED"       ALSO    "B01"
                   PERFORM 210-BACK
      *        ¥¯¥ê¥¢
               WHEN    "CLICKED"       ALSO    "B02"
                   PERFORM 220-CLEAR-SEC
      *        ¼õ¿ÇÍúÎò¤Ø
               WHEN    "CLICKED"       ALSO    "B05"
                   PERFORM 450-RIREKI-SEC
      *        Æþ³°¶èÊ¬ÊÑ¹¹
               WHEN    "CLICKED"       ALSO    "B06"
                   PERFORM 460-NYUGAIKBN-HEN-SEC
      *        ¿ÇÎÅ¶èÊ¬ÊÑ¹¹
               WHEN    "CLICKED"       ALSO    "B07"
                   PERFORM 470-SRYKBN-HEN-SEC
      *        ÅÐÏ¿
               WHEN    "CLICKED"       ALSO    "B12"
                    PERFORM 450-TOROKU-SEC
      *        ¼õ¿ÇÍúÎò Á°ÊÇ
               WHEN    "CLICKED"       ALSO    "BC06"
                   PERFORM 4109-BC06-SYORI-SEC
      *        ¼õ¿ÇÍúÎò ¼¡ÊÇ
               WHEN    "CLICKED"       ALSO    "BC07"
                   PERFORM 4109-BC07-SYORI-SEC
           END-EVALUATE
          .
      *
           .
       200-GMNSENI-EXT.
           EXIT.
      *****************************************************************
      *    ²ñÏÃ¡¡½èÍý
      *****************************************************************
       200-ENTRY                   SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *        ¿ÇÎÅÆüÁªÂòÈÖ¹æ
               WHEN    "ACTIVATE"      ALSO    "SELNUM"
                   PERFORM 410-SELNUM-CHK-SEC
      *        ¿ÇÎÅÆüÁªÂò
               WHEN    ANY             ALSO    "RRKLIST"
                   PERFORM 430-RRKLIST-CHK-SEC
      *        ÌÀºÙÁªÂò
               WHEN    ANY             ALSO    "MEILIST"
                   PERFORM 440-MEILIST-CHK-SEC
      *        ºÞÈÖ¹æÁªÂò
               WHEN    "ACTIVATE"      ALSO    "DOSEL"
                   PERFORM 420-DOSEL-CHK-SEC
      *        Æþ³°¶èÊ¬
               WHEN    "ACTIVATE"      ALSO    "NYUGAIKBN"
                   PERFORM 450-NYUGAIKBN-CHK-SEC
      *        ¿ÇÎÅ¶èÊ¬
               WHEN    "ACTIVATE"      ALSO    "SRYKBN"
                   PERFORM 460-SRYKBNN-CHK-SEC
           END-EVALUATE
           .
       200-ENTRY-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅÆüÁªÂòÈÖ¹æÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       410-SELNUM-CHK-SEC              SECTION.
      *
           MOVE    1                   TO  SPA-K09GMN-CUR
      *
           MOVE    K09-SELNUM          TO  SPA-K09-SELNUM
           MOVE    ZERO                TO  SPA-K09-DOSELNUM
           PERFORM VARYING     IDX     FROM   1   BY  1
                   UNTIL       IDX     >   SPA-K09GMN-MAX1
              IF      SPA-K09GMN-NO (IDX)      =   SPA-K09-SELNUM
                  MOVE    IDX                  TO  SPA-K09-DOSELNUM
                  MOVE    SPA-K09GMN-MAX1      TO  IDX
              END-IF
           END-PERFORM
      *
           IF      SPA-K09-DOSELNUM    <   01   OR
                                       >   SPA-K09GMN-MAX1
               MOVE    "0001"              TO  SPA-ERRCD
           ELSE
      *        ¿Ç»¡ÆâÍÆÊÔ½¸
               PERFORM 4101-JYURRK-HEN-SEC
           END-IF
      *
           .
       410-SELNUM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅÆüÁªÂò½èÍý
      *****************************************************************
       430-RRKLIST-CHK-SEC           SECTION.
      *
           MOVE    ZERO                TO  WRK-DOSELNUM
           MOVE    ZERO                TO  WRK-IDXNUM
      *
           PERFORM VARYING     IDX   FROM   1   BY  1
                   UNTIL       IDX   >   SPA-K09GMN-MAX1
              IF      K09-RRKLIST-SELECT(IDX)  =  "T"
                  IF      IDX                  =   SPA-K09-DOSELNUM
                      CONTINUE
                  ELSE
                      MOVE    SPA-K09GMN-NO (IDX)  TO  WRK-IDXNUM
                      MOVE    IDX                  TO  WRK-DOSELNUM
                  END-IF
              END-IF
           END-PERFORM
      *
           IF      WRK-DOSELNUM        >   ZERO
               MOVE    WRK-DOSELNUM        TO  SPA-K09-DOSELNUM
           END-IF
      *
           IF      SPA-K09-DOSELNUM    <   01   OR
                                       >   SPA-K09GMN-MAX1
               CONTINUE
           ELSE
               MOVE    K09-NO  (SPA-K09-DOSELNUM)
                                           TO  SPA-K09-SELNUM
      *        ¿Ç»¡ÆâÍÆÊÔ½¸
               PERFORM 4101-JYURRK-HEN-SEC
           END-IF
      *
           .
       430-RRKLIST-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙÁªÂòÁªÂò½èÍý
      *****************************************************************
       440-MEILIST-CHK-SEC           SECTION.
      *
           MOVE    ZERO                TO  WRK-BANGO
           MOVE    ZERO                TO  WRK-SELNUM-CHK-G
           MOVE    ZERO                TO  IDX2
      *
           PERFORM VARYING     IDX   FROM   1   BY  1
                   UNTIL       IDX   >   SPA-GMN-MAX2
              IF      K09-MEILIST-SELECT(IDX)  =  "T"
                  MOVE    SPA-NAI-TBANGO (IDX) TO  WRK-BANGO
      *           Æ±¤¸ºÞÁªÂò¤Ïºï½ü¤È¤¹¤ë
                  MOVE    ZERO             TO  FLG-CHK
                  PERFORM VARYING  IDY     FROM   1   BY  1
                          UNTIL   (IDY     >   MAX-SEL )  OR
                                  (WRK-SELNUM-CHK (IDY)   =   ZERO)
                      IF      WRK-SELNUM-CHK (IDY)
                                           =   WRK-BANGO
                          MOVE    1        TO  FLG-CHK
                          MOVE    ZERO     TO  WRK-SELNUM-CHK (IDY)
                      END-IF
                  END-PERFORM
                  IF      FLG-CHK          =   ZERO
                      ADD     1                TO  IDX2
                      MOVE    SPA-NAI-TBANGO (IDX)
                                           TO  WRK-SELNUM-CHK (IDX2)
                  END-IF
              END-IF
           END-PERFORM
      *
           MOVE    SPACE               TO  WRK-HEN-SELNUM
           MOVE    ZERO                TO  IDX2
           PERFORM VARYING     IDX     FROM   1   BY  1
                   UNTIL      (IDX     >   MAX-SEL )  OR
                              (SPA-ERRCD   NOT =   SPACE )
               IF      (WRK-SELNUM-CHK (IDX)   NOT =   ZERO) 
                   MOVE    WRK-SELNUM-CHK (IDX)    TO  WRK-BANGO
                   PERFORM 4401-SELNUM-CHK-HEN-SEC
               END-IF
           END-PERFORM
      *
           MOVE    WRK-HEN-SELNUM      TO  SPA-GMN-DOSEL
      *
           IF      SPA-GMN-DOSEL       =   SPACE
               INITIALIZE                  SPA-NAI-DOSEL-G
           ELSE
               MOVE    SPACE               TO  SPA-ERRCD
      *        ÁªÂòÈÖ¹æ¥Á¥§¥Ã¥¯
               PERFORM 4201-DOSEL-CHECK-SEC
           END-IF
      *
           .
       440-MEILIST-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÁªÂòÈÖ¹æÊÔ½¸½èÍý
      *****************************************************************
       4401-SELNUM-CHK-HEN-SEC             SECTION.
      *
           MOVE    WRK-BANGO           TO  WRK-ZZ
           MOVE    SPACE               TO  WRK-BANGO-X
           MOVE    ZERO                TO  IDX-D1
           PERFORM VARYING     IDX-D2  FROM    1   BY  1
                   UNTIL       IDX-D2  >   3
               IF      WRK-ZZ (IDX-D2:1)   NOT =   SPACE
                   ADD     1                   TO  IDX-D1
                   MOVE    WRK-ZZ (IDX-D2:1)   TO  WRK-BANGO-X(IDX-D1:1)
               END-IF
           END-PERFORM
           COMPUTE IDX-D2              =   40  -  IDX-D1
           IF      WRK-HEN-SELNUM (IDX-D2:)    NOT =   SPACE
               MOVE    "0037"              TO  SPA-ERRCD
               MOVE    SPACE               TO  WRK-BANGO-X
           END-IF
      *
           MOVE    WRK-HEN-SELNUM      TO  WRK-HEN-SELNUM-2
           MOVE    SPACE               TO  WRK-HEN-SELNUM
           IF      WRK-HEN-SELNUM-2    =   SPACE
               STRING  WRK-BANGO-X         DELIMITED   BY  SPACE
                       INTO                WRK-HEN-SELNUM
               END-STRING
           ELSE
               IF      WRK-BANGO-X         =   SPACE
                   MOVE    WRK-HEN-SELNUM-2    TO  WRK-HEN-SELNUM
               ELSE
                   STRING  WRK-HEN-SELNUM-2    DELIMITED   BY  SPACE
                           ","                 DELIMITED   BY  SIZE
                           WRK-BANGO-X         DELIMITED   BY  SPACE
                           INTO                WRK-HEN-SELNUM
                   END-STRING
               END-IF
           END-IF
      *
           .
       4401-SELNUM-CHK-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÞÈÖ¹æÁªÂòÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       420-DOSEL-CHK-SEC              SECTION.
      *
           MOVE    2                   TO  SPA-K09GMN-CUR
           MOVE    K09-DOSEL           TO  SPA-GMN-DOSEL
      *    ÁªÂòÈÖ¹æ¥Á¥§¥Ã¥¯
           PERFORM 4201-DOSEL-CHECK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      420-DOSEL-CHK-EXT
           END-IF
      *
      *
           INITIALIZE                      WRK-DOZAINUM-AREA
           MOVE    ZERO                TO  IDX
           PERFORM VARYING     IDX-D2      FROM    1   BY  1
                   UNTIL      (IDX-D2      >   MAX-SEL  )  OR
                              (WRK-DO(IDX-D2)  =   SPACE  )
               IF     (IDX-D2                  >   1   )  AND
                      (WRK-SEL  (IDX-D2 - 1)   =   "-" )
                   COMPUTE IDX-Z           =   WRK-DONUM (IDX-D2 - 1)
                                           +   1
                   PERFORM VARYING     IDX2    FROM    IDX-Z  BY  1
                           UNTIL       IDX2    >=  WRK-DONUM(IDX-D2)
                       MOVE    IDX2                TO  IDX-ZAI
                       ADD     1                   TO  IDX
                       MOVE    SPA-NAI-ZAINUM (IDX-ZAI)
                                               TO  WRK-DOZAINUM (IDX)
                       MOVE    WRK-KAINUM(IDX-D2)  TO  WRK-DOKAI (IDX)
      *                ÅêÌô°Ê³°¤Î²ó¿ô¤Ï¥¨¥é¡¼
                       IF     (WRK-KAINUM(IDX-D2)  >   1  )  AND
                              (SPA-NAI-SRYKBN(IDX-ZAI) NOT =   "21"
                                                           AND "22"
                                                           AND "23")
                           MOVE    "0004"              TO  SPA-ERRCD
                       END-IF
                   END-PERFORM
               END-IF
               MOVE    WRK-DONUM(IDX-D2)       TO  IDX-ZAI
               ADD     1                       TO  IDX
               MOVE    SPA-NAI-ZAINUM (IDX-ZAI)
                                               TO  WRK-DOZAINUM (IDX)
               MOVE    WRK-KAINUM(IDX-D2)      TO  WRK-DOKAI (IDX)
      *        '-'¤¬¤¢¤ê¡¢²ó¿ô¤¬Ìµ¤¤»þ¸å¤Î²ó¿ô
               IF     (WRK-SEL  (IDX-D2)       =   "-" )  AND
                      (WRK-KAINUM(IDX-D2)      =   ZERO)
                   MOVE    WRK-KAINUM(IDX-D2 + 1)  TO  WRK-DOKAI (IDX)
               END-IF
      *
      *        ÅêÌô°Ê³°¤Î²ó¿ô¤Ï¥¨¥é¡¼
               IF     (WRK-KAINUM(IDX-D2)      >   1  )  AND
                      (SPA-NAI-SRYKBN(IDX-ZAI) NOT =   "21"
                                                   AND "22"
                                                   AND "23")
                   MOVE    "0004"              TO  SPA-ERRCD
               END-IF
           END-PERFORM
      *
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      420-DOSEL-CHK-EXT
           END-IF
      *
      *
      *    Æ±°ìºÞ¤òºï½ü
           INITIALIZE                      HZN-DOZAINUM-AREA
           MOVE    WRK-DOZAINUM-AREA   TO  HZN-DOZAINUM-AREA
           INITIALIZE                      WRK-DOZAINUM-AREA
           MOVE    ZERO                TO  IDX-H
           PERFORM VARYING     IDX1    FROM    1   BY  1
                   UNTIL       IDX1    >   IDX
               IF      HZN-DOZAINUM (IDX1) NOT =   ZERO
                   MOVE    ZERO                TO  FLG-CHK
                   PERFORM VARYING     IDX2    FROM    1   BY  1
                           UNTIL  (IDX2        >   MAX-SEL)    OR
                                  (WRK-DOZAINUM (IDX2) =   ZERO ) OR
                                  (FLG-CHK             =   1    )
                       IF       HZN-DOZAINUM (IDX1)    =   WRK-DOZAINUM
                                                                (IDX2)
                           MOVE    1                   TO  FLG-CHK
                       END-IF
                   END-PERFORM
                   IF      FLG-CHK             =   ZERO
                       ADD     1               TO  IDX-H
                       MOVE    HZN-DOZAINUM-OCC (IDX1)
                                               TO  WRK-DOZAINUM-OCC
                                                                (IDX-H)
                   END-IF
               END-IF
           END-PERFORM
      *
           IF      IDX-H               =   ZERO
               CONTINUE
           ELSE
      *        ÂÐ¾Ý¿ÇÎÅ¹Ô°ÙÆâÍÆÊÔ½¸
               PERFORM 4201-WKSRYACT-SET-SEC
      *        Ìá¤ë
               PERFORM 210-BACK
           END-IF
      *
           .
       420-DOSEL-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ÁªÂòÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4201-DOSEL-CHECK-SEC              SECTION.
      *
           INITIALIZE                      WRK-DOSEL
           MOVE    ZERO                TO  FLG-KAI
           MOVE    ZERO                TO  IDX-D1
           MOVE    ZERO                TO  IDX-D3
           MOVE    1                   TO  IDX-D2
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   40  )   OR
                              (SPA-ERRCD   NOT =   SPACE )
               EVALUATE    SPA-GMN-DOSEL(IDX:1)
                   WHEN    ","
                   WHEN    "."
                       IF      IDX-D1          >   ZERO
                           ADD     1               TO  IDX-D2
                           MOVE    ZERO            TO  IDX-D1
                           MOVE    ZERO            TO  IDX-D3
                           MOVE    ZERO            TO  FLG-KAI
                       END-IF
                   WHEN    "*"
      *                £±·åÌÜ¤Î¡ö¤ÏÁ´ÂÎ
                       IF     (IDX-D2          =   1  ) AND
                              (IDX-D1          =   ZERO)
                           ADD     1               TO  IDX-D1
                           MOVE    SPA-GMN-DOSEL(IDX:1)
                                               TO  WRK-DO(IDX-D2)
                                                            (IDX-D1:1)
                       ELSE
                           IF     (IDX-D1      =   ZERO) OR
                                  (FLG-KAI     =   1   )
      *                        £±·åÌÜ¤Î¡ö¤Ï¥¨¥é¡¼
                               MOVE    "0003"          TO  SPA-ERRCD
                           ELSE
      *                        ²ó¿ô
                               MOVE    1               TO  FLG-KAI
                           END-IF
                       END-IF
                   WHEN    "0"  THRU  "9" 
                     IF      FLG-KAI         =   ZERO
      *
                       ADD     1               TO  IDX-D1
                       IF      IDX-D1          >   3
                           MOVE    "0002"          TO  SPA-ERRCD
                       ELSE
                           MOVE    SPA-GMN-DOSEL(IDX:1)
                                               TO  WRK-DO(IDX-D2)
                                                            (IDX-D1:1)
                       END-IF
      *
                     ELSE
      *
                       ADD     1               TO  IDX-D3
                       IF      IDX-D3         >   3
                           MOVE    "0002"          TO  SPA-ERRCD
                       ELSE
                           MOVE    SPA-GMN-DOSEL(IDX:1)
                                               TO  WRK-KAI(IDX-D2)
                                                            (IDX-D3:1)
                       END-IF
                     END-IF
                   WHEN    "-"
                       MOVE    "-"             TO  WRK-SEL(IDX-D2)
                       IF      IDX-D1          >   ZERO
                           ADD     1               TO  IDX-D2
                           MOVE    ZERO            TO  IDX-D1
                           MOVE    ZERO            TO  IDX-D3
                           MOVE    ZERO            TO  FLG-KAI
                       END-IF
                   WHEN    SPACE
                       CONTINUE
                   WHEN    OTHER
                       MOVE    "0002"          TO  SPA-ERRCD
               END-EVALUATE
           END-PERFORM
      *    Á´·ï¥³¥Ô¡¼
           IF     (IDX-D2              =   1  )  AND
                  (IDX-D1              =   1  )  AND
                  (WRK-DO(IDX-D2)(1:1) =   "*")
               MOVE    "1"                 TO  WRK-DO(IDX-D2)
               MOVE    "-"                 TO  WRK-SEL(IDX-D2)
               MOVE    SPA-NAI-MAX2(2:3)   TO  WRK-DO(IDX-D2 + 1)
               MOVE    1                   TO  FLG-DOALL
           ELSE
               MOVE    ZERO                TO  FLG-DOALL
           END-IF
      *
           PERFORM VARYING     IDX-D2      FROM    1   BY  1
                   UNTIL      (IDX-D2      >   MAX-SEL  )  OR
                              (WRK-DO(IDX-D2)  =   SPACE  )  OR
                              (SPA-ERRCD   NOT =   SPACE  )
               INITIALIZE                      ORCSNUMAREA
               MOVE    WRK-DO (IDX-D2)     TO  SNUM-INX
               CALL    "ORCSNUM"           USING
                                           ORCSNUMAREA
               IF     (SNUM-RC         NOT =   ZERO  )   OR
                      (SNUM-MINKBN     NOT =   SPACE )   OR
                      (SNUM-SYOKBN     NOT =   SPACE )
                   MOVE    "0002"              TO  SPA-ERRCD
               ELSE
                   MOVE    SNUM-OUTNUM         TO  WRK-DONUM (IDX-D2)
                   IF      WRK-DONUM (IDX-D2)  >=  01  AND
                                               <=  SPA-NAI-MAX2
                       CONTINUE
                   ELSE
                       MOVE    "0002"          TO  SPA-ERRCD
                   END-IF
      *
                   IF     (IDX-D2          >   1   )  AND
                          (WRK-SEL (IDX-D2 - 1 )   =   "-" )
                       IF      WRK-DONUM (IDX-D2 - 1)  >
                                                   WRK-DONUM(IDX-D2)
                           MOVE    "0002"              TO  SPA-ERRCD
                       END-IF
                   END-IF
               END-IF
      *        ²ó¿ô
               IF     WRK-KAI(IDX-D2)      =   SPACE
                   MOVE    ZERO            TO  WRK-KAINUM(IDX-D2)
               ELSE
                   INITIALIZE                      ORCSNUMAREA
                   MOVE    WRK-KAI(IDX-D2)     TO  SNUM-INX
                   CALL    "ORCSNUM"           USING
                                               ORCSNUMAREA
                   IF     (SNUM-RC         NOT =   ZERO  )   OR
                          (SNUM-MINKBN     NOT =   SPACE )   OR
                          (SNUM-SYOKBN     NOT =   SPACE )
                       MOVE    "0002"          TO  SPA-ERRCD
                   ELSE
                       MOVE    SNUM-OUTNUM     TO  WRK-KAINUM(IDX-D2)
                   END-IF
               END-IF
           END-PERFORM
      *    ²èÌÌÉ½¼¨ÍÑ
           INITIALIZE                      SPA-NAI-DOSEL-G
           INITIALIZE                      WRK-SELNUM-AREA
           MOVE    ZERO                TO  IDX
           PERFORM VARYING     IDX-D2      FROM    1   BY  1
                   UNTIL      (IDX-D2      >   MAX-SEL  )  OR
                              (WRK-DO (IDX-D2)
                                               =   SPACE  )
                          OR  (SPA-ERRCD   NOT =   SPACE )
               IF     (IDX-D2                  >   1   )  AND
                      (WRK-SEL (IDX-D2 - 1)    =   "-" )
                   COMPUTE IDX-Z           =   WRK-DONUM(IDX-D2 - 1)
                                           +   1
                   PERFORM VARYING     IDX2    FROM    IDX-Z  BY  1
                           UNTIL       IDX2    >=  WRK-DONUM(IDX-D2)
                       MOVE    1               TO  WRK-SEL9(IDX2)
                   END-PERFORM
               END-IF
               MOVE    WRK-DONUM(IDX-D2)       TO  IDX2
               MOVE    1                       TO  WRK-SEL9(IDX2)
           END-PERFORM
           MOVE    ZERO                TO  IDX
           PERFORM VARYING     IDX-D2  FROM    1   BY  1
                   UNTIL      (IDX-D2  >   MAX-SEL  )  OR
                              (SPA-ERRCD   NOT =   SPACE )
               IF      WRK-SEL9(IDX-D2)    =   1
                   ADD     1               TO  IDX
                   IF      IDX             >   MAX-SEL
                       MOVE    "0008"          TO  SPA-ERRCD
                   ELSE
                       MOVE    IDX-D2          TO  SPA-NAI-DOSEL(IDX)
                       MOVE    IDX             TO  SPA-NAI-DOSEL-MAX
                   END-IF
               END-IF
           END-PERFORM
           .
       4201-DOSEL-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *     Æþ³°¶èÊ¬½èÍý
      *****************************************************************
       450-NYUGAIKBN-CHK-SEC              SECTION.
      *
           MOVE    SPA-K09-NYUGAIKBN   TO  WRK-MAE-NYUGAIKBN
      *
           MOVE    K09-NYUGAIKBN       TO  SPA-K09-NYUGAIKBN-G
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-K09-NYUGAIKBN-MAX
               IF      SPA-K09-NYUGAIKBN   =   SPA-K09-NYUGAIKBN-LST
                                                           (IDX)(1:1)
                   MOVE    SPA-K09-NYUGAIKBN-LST (IDX)
                                           TO  SPA-K09-NYUGAIKBN-G
                   MOVE    1               TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0005"              TO  SPA-ERRCD
               MOVE    10                  TO  SPA-K09GMN-CUR
           ELSE
             IF      SPA-K09-NYUGAIKBN   =   WRK-MAE-NYUGAIKBN
               CONTINUE
             ELSE
      *        Æþ³°¶èÊ¬ÊÑ¹¹¼¡¤Ï¡¢£±ÊÇ¤«¤éÉ½¼¨
               MOVE    1                   TO  SPA-K09-RRK-PAGE
               MOVE    ZERO                TO  SPA-K09-RRK-NEXT
      *        ¼õ¿ÇÍúÎòÊÔ½¸
               PERFORM 3101-JYURRK-DBHEN-SEC
      *****    IF      SPA-K09-NYUGAIKBN   =   SPA-NYUGAIKBN
      *            PERFORM 3102-JYURRK-SPAHEN-SEC
      *        ELSE
      *            PERFORM 3101-JYURRK-DBHEN-SEC
      ******** END-IF
               INITIALIZE                  SPA-GMN-TBL
               INITIALIZE                  SPA-NAI-TBL
               MOVE    ZERO                TO  SPA-GMN-MAX2
               MOVE    ZERO                TO  SPA-NAI-MAX2
               IF      SPA-K09GMN-MAX1     >   ZERO
                   MOVE    1                   TO  SPA-K09-DOSELNUM
                   MOVE    SPA-K09GMN-NO(1)    TO  SPA-K09-SELNUM
      *            ¿Ç»¡ÆâÍÆÊÔ½¸
                   PERFORM 4101-JYURRK-HEN-SEC
               ELSE
                   MOVE    10              TO  SPA-K09GMN-CUR
               END-IF
             END-IF
      *
           END-IF
           .
       450-NYUGAIKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ¿ÇÎÅ¶èÊ¬½èÍý
      *****************************************************************
       460-SRYKBNN-CHK-SEC              SECTION.
      *
           MOVE    K09-SRYKBN          TO  SPA-K09-SRYKBN-G
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-K09-SRYKBN-MAX
               IF      SPA-K09-SRYKBN   =   SPA-K09-SRYKBN-LST
                                                           (IDX)(1:2)
                   MOVE    SPA-K09-SRYKBN-LST (IDX)
                                           TO  SPA-K09-SRYKBN-G
                   MOVE    1               TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
               MOVE    11                  TO  SPA-K09GMN-CUR
           ELSE
               IF      SPA-K09-DOSELNUM    >   ZERO
                   PERFORM 4101-JYURRK-HEN-SEC
               ELSE
                   MOVE    1                   TO  SPA-K09GMN-CUR
               END-IF
           END-IF
           .
       460-SRYKBNN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ¿Ç»¡ÆâÍÆÊÔ½¸½èÍý
      *****************************************************************
       4101-JYURRK-HEN-SEC              SECTION.
      *
           MOVE    1                   TO  FLG-GMN-INIT2
      *
      *    ¥Ñ¥é¥á¥¿¥Õ¥¡¥¤¥ë¤è¤ê¡¢¿ÇÎÅ²ñ·×¥Þ¥¹¥¿¡¼¤òÊÔ½¸
           MOVE    ZERO                TO  IDX
           MOVE    ZERO                TO  IDG
      *
           INITIALIZE                  SPA-GMN-DOSEL
           INITIALIZE                  SPA-NAI-DOSEL-G
           MOVE    SPACE               TO  SPA-GMN-TBL
           INITIALIZE                  SPA-GMN-TBL
           INITIALIZE                  SPA-NAI-TBL
           MOVE    ZERO                TO  SPA-GMN-MAX2
           MOVE    ZERO                TO  SPA-NAI-MAX2
      *
      *    ¼õ¿ÇÎò¤ò¸¡º÷¤¹¤ë
           INITIALIZE                  JYURRK-KEY
           MOVE    SPA-HOSPNUM         TO  JYURRK-HOSPNUM
           MOVE    SPA-PTID            TO  JYURRK-PTID
           MOVE    SPA-K09-NYUGAIKBN   TO  JYURRK-NYUGAIKBN
      *****MOVE    SPA-SRYKA           TO  JYURRK-SRYKA
           MOVE    SPA-K09NAI-RRK-SRYKA(SPA-K09-DOSELNUM)
                                       TO  JYURRK-SRYKA
           MOVE    SPA-K09NAI-RRKYMD(SPA-K09-DOSELNUM)
                                       TO  JYURRK-SRYYMD
           MOVE    SPA-K09NAI-RENNUM(SPA-K09-DOSELNUM)
                                       TO  JYURRK-RENNUM
      *
           MOVE    JYURRK-REC          TO  MCPDATA-REC
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_jyurrk"        TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           ELSE
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK2
           PERFORM
                   UNTIL    FLG-JYURRK     =   1
               IF      SPA-K09NAI-DOUJI-RENNUM (SPA-K09-DOSELNUM)
                                           =   JYURRK-DOUJI-RENNUM
      *            ¿ÇÎÅ¶èÊ¬¤ÎÈ½Äê
      ****         IF      JYURRK-EDANUM       =   1
      *                MOVE    ZERO                TO  FLG-OK2
      *                IF      SPA-K09-SRYKBN      =   "00"
      *                                            OR  "90"
      *                     MOVE    1              TO  FLG-OK2
      *                ELSE
      *                     PERFORM 41012-SRYKBN-CHK-SEC
      *                END-IF
      ****         END-IF
      *
                   PERFORM VARYING     IDX-R   FROM    1   BY  1
                           UNTIL      (IDG             >   MAX-LINE ) OR
                                      (IDX-R           >   15  )
      *************                OR (FLG-OK2         =   ZERO)
                       IF      JYURRK-ZAINUM (IDX-R)   NOT =   ZERO
                           PERFORM 41011-ZAISET-HEN-SEC
                       END-IF
                   END-PERFORM
               END-IF
      *
               MOVE    "tbl_jyurrk"        TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *    ºÇÂç·ï¿ô
           MOVE    IDG                 TO  SPA-GMN-MAX2
      *
           IF      SPA-GMN-MAX2        >   ZERO
               MOVE    2                   TO  SPA-K09GMN-CUR
           ELSE
               MOVE
                   "¡á¡á¡á¡á¡á¡á¡á¡á¡¡É½¼¨ÆâÍÆ¤Ê¤·¡¡¡á¡á¡á¡á¡á¡á¡á¡á"
                                           TO  SPA-GMN-TMEISYO (01)
               MOVE    1                   TO  SPA-GMN-MAX2
               MOVE    1                   TO  SPA-K09GMN-CUR
           END-IF
      *
           .
       4101-JYURRK-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ¶èÊ¬¤ÎÈ½Äê½èÍý
      *****************************************************************
       41012-SRYKBN-CHK-SEC           SECTION.
      *
           EVALUATE    SPA-K09-SRYKBN
               WHEN    "10"
                   IF      (JYURRK-SRYKBN1     =   "01" )
                       MOVE    1                   TO  FLG-OK2
                   END-IF
               WHEN    "20"
                   IF      (JYURRK-SRYKBN2     =   "01" )  OR
                           (JYURRK-SRYKBN3     =   "01" )  OR
                           (JYURRK-SRYKBN4     =   "01" )
                       MOVE    1                   TO  FLG-OK2
                   END-IF
               WHEN    "29"
      *            ÅêÌô¡¦Ãí¼Í
                   IF     ((JYURRK-SRYKBN2     =   "01" )  OR
                           (JYURRK-SRYKBN3     =   "01" )  OR
                           (JYURRK-SRYKBN4     =   "01" ) )  OR
                          ( JYURRK-SRYKBN5     =   "01"   )
                       MOVE    1                   TO  FLG-OK2
                   END-IF
               WHEN    "30"
                   IF      (JYURRK-SRYKBN5     =   "01" )
                       MOVE    1                   TO  FLG-OK2
                   END-IF
               WHEN    "40"
                   IF      (JYURRK-SRYKBN6     =   "01" )
                       MOVE    1                   TO  FLG-OK2
                   END-IF
               WHEN    "50"
                   IF      (JYURRK-SRYKBN7     =   "01" )  OR
                           (JYURRK-SRYKBN8     =   "01" )
                       MOVE    1                   TO  FLG-OK2
                   END-IF
               WHEN    "60"
                   IF      (JYURRK-SRYKBN9     =   "01" )
                       MOVE    1                   TO  FLG-OK2
                   END-IF
               WHEN    "70"
                   IF      (JYURRK-SRYKBN10    =   "01" )
                       MOVE    1                   TO  FLG-OK2
                   END-IF
               WHEN    "80"
                   IF      (JYURRK-SRYKBN11    =   "01" )
                       MOVE    1                   TO  FLG-OK2
                   END-IF
           END-EVALUATE
           .
       41012-SRYKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¸¡º÷½èÍý
      *****************************************************************
       41011-ZAISET-HEN-SEC           SECTION.
      *    ¥ï¡¼¥¯¿ÇÎÅ¹Ô°Ù¤Î¥ì¥¤¥¢¥¦¥È¤ØÊÔ½¸¸å¡¢²èÌÌÍÑÊÔ½¸¤Ø
           MOVE    SPACE               TO  LNK-WKSRYACT-AREA
           MOVE    ZERO                TO  IDX-KOUI
           MOVE    ZERO                TO  IDX-KAI
      *    ÂÐ¾ÝÆü¤Î°ÌÃÖ¥»¥Ã¥È
           MOVE    JYURRK-SRYYMD(7:2)  TO  IDX-STR
           MOVE    IDX-STR             TO  SPA-SEL-IDX
           MOVE    JYURRK-RENNUM       TO  SPA-SEL-RENNUM
      *
           INITIALIZE                  SRYACT-REC
           MOVE    SPA-HOSPNUM         TO  SRY-HOSPNUM
           MOVE    JYURRK-NYUGAIKBN    TO  SRY-NYUGAIKBN
           MOVE    SPA-PTID            TO  SRY-PTID
           MOVE    JYURRK-SRYKA        TO  SRY-SRYKA
           MOVE    JYURRK-SRYYMD(1:6)  TO  SRY-SRYYM
           MOVE    JYURRK-ZAINUM(IDX-R)
                                       TO  SRY-ZAINUM
      *
           MOVE    SRYACT-REC          TO  MCPDATA-REC
           MOVE    "tbl_sryact"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 930-SRYACT-READ-SEC
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           MOVE    ZERO                TO  WRK-ZAINUM
           PERFORM
                   UNTIL   FLG-SRYACT      =   1
      *
               MOVE    ZERO                TO  FLG-OK
      *        ½éºÆ¿Ç¤òÂÐ¾Ý³°¤È¤¹¤ë
               IF      SRY-SRYKBN          =   "11"  OR  "12"
      *            Ï«ºÒ¤ÎºÆ¿Ç»þÎÅÍÜ»ØÆ³´ÉÍýÎÁ¤ÏÂÐ¾Ý
                   IF     (SRY-SRYCD (01)      =   "101120030" )  OR
                          (SRY-SRYCD (02)      =   "101120030" )  OR
                          (SRY-SRYCD (03)      =   "101120030" )  OR
                          (SRY-SRYCD (04)      =   "101120030" )  OR
                          (SRY-SRYCD (05)      =   "101120030" )
                       MOVE    1               TO  FLG-OK
                   END-IF
               ELSE
                   MOVE    1                   TO  FLG-OK
               END-IF
      *        ÁªÂò¿ÇÎÅ¶èÊ¬È½Äê
               EVALUATE    SPA-K09-SRYKBN
                   WHEN    "10"
                       IF      SRY-SRYKBN(1:1)     =   "1"
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
                   WHEN    "20"
                       IF     (SRY-SRYKBN(1:1)     =   "2" )  OR
                              (SRY-SRYKBN          =   "98")
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
                   WHEN    "29"
                       IF     (SRY-SRYKBN(1:1)     =   "2" )  OR
                              (SRY-SRYKBN          =   "98")  OR
                              (SRY-SRYKBN(1:1)     =   "3" )
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
                   WHEN    "30"
                       IF      SRY-SRYKBN(1:1)     =   "3"
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
                   WHEN    "40"
                       IF      SRY-SRYKBN(1:1)     =   "4"
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
                   WHEN    "50"
                       IF      SRY-SRYKBN(1:1)     =   "5"
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
                   WHEN    "60"
                       IF      SRY-SRYKBN(1:1)     =   "6"
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
                   WHEN    "70"
                       IF      SRY-SRYKBN(1:1)     =   "7"
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
                   WHEN    "80"
                       IF      SRY-SRYKBN(1:1)     =   "8"
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
                   WHEN    "90"
                       IF     (SRY-SRYKBN (1:1)    =   "9" )  AND
                              (SRY-SRYKBN      NOT =   "98")
                           CONTINUE
                       ELSE
                           MOVE    ZERO            TO  FLG-OK
                       END-IF
               END-EVALUATE
      *
               IF      FLG-OK                  =   1
                   MOVE    ZERO                TO  WRK-DOKAISU
      *            ¿ÇÎÅ²ñ·×¸¡º÷ÊÔ½¸
                   PERFORM 41012-SRYACT-HEN-SEC
      *
                   IF      IDY                 >   ZERO
                       ADD     1               TO  IDX-KOUI
                       MOVE    WKSRYACT-REC    TO  LNK-WKSRYACT-REC
                                                          (IDX-KOUI)
                   END-IF
               END-IF
      *
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 930-SRYACT-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_sryact"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      IDX-KOUI        >   ZERO
      *        ºÞËè¤Ë½èÍý¤ò¹Ô¤¦
               ADD     1               TO  SPA-NAI-MAX2
               MOVE    JYURRK-ZAINUM(IDX-R)    TO  SPA-NAI-ZAINUM
                                                        (SPA-NAI-MAX2)
               PERFORM 3101-WKSRYACT-HEN-SEC
           END-IF
      *
           .
       490111-ZAISET-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¤òºîÀ®¤¹¤ë 
      *****************************************************************
       41012-SRYACT-HEN-SEC           SECTION.
      *
           MOVE    ZERO                TO  IDY
           MOVE    ZERO                TO  WRK-ZAIKAISU
      *    ºÞ²ó¿ô¼èÆÀ
           INITIALIZE                      SRYACCT-REC
           MOVE    SRY-HOSPNUM         TO  ACCT-HOSPNUM
           MOVE    SRY-NYUGAIKBN       TO  ACCT-NYUGAIKBN
           MOVE    SRY-PTID            TO  ACCT-PTID
           MOVE    SRY-SRYKA           TO  ACCT-SRYKA
           MOVE    SRY-SRYYM           TO  ACCT-SRYYM
           MOVE    SRY-SRYKBN          TO  ACCT-SRYKBN
           MOVE    SRY-ZAINUM          TO  ACCT-ZAINUM
      *    ¼ç¥­¡¼ÆÉ¤ß
           PERFORM 940-SRYACCT-READ-SEC
           IF      FLG-SRYACCT         =   ZERO
      *    ²ó¿ô·èÄê
      *        Æ±ÆüºÆ¿Ç¤ÎºÇ½ª²ó¥»¥Ã¥È
               EVALUATE    SPA-SEL-RENNUM
                   WHEN    1
                       MOVE    ACCT-DAY (2 IDX-STR)    TO  WRK-ZAIKAISU
                   WHEN    2
                       MOVE    ACCT-DAY (3 IDX-STR)    TO  WRK-ZAIKAISU
                   WHEN    OTHER
                       MOVE    ACCT-DAY (4 IDX-STR)    TO  WRK-ZAIKAISU
               END-EVALUATE
           END-IF
      *
           INITIALIZE                  WKSRYACT-REC
      *
      *    ²ó¿ô¥¼¥í¤ÏÂÐ¾Ý³°¤È¤¹¤ë
           IF      WRK-ZAIKAISU        =   ZERO
               GO      TO      41012-SRYACT-HEN-EXT
           END-IF
      *
      **** IF      WRK-ZAINUM      NOT =   SRY-ZAINUM
      *        MOVE    ZERO                TO  IDX-KAI
      **** END-IF
      *
           INITIALIZE                  WKSRYACT-REC
           MOVE    SRY-HOSPNUM         TO  WKSRY-HOSPNUM
           MOVE    SRY-NYUGAIKBN       TO  WKSRY-NYUGAIKBN
           MOVE    SRY-PTID            TO  WKSRY-PTID
           MOVE    SRY-SRYKA           TO  WKSRY-SRYKA
           MOVE    SRY-SRYYM           TO  WKSRY-SRYYMD(1:6)
           MOVE    SRY-SRYKBN          TO  WKSRY-SRYKBN
           MOVE    SRY-ZAINUM          TO  WKSRY-ZAINUM
           MOVE    SRY-RENNUM          TO  WKSRY-RENNUM
           MOVE    SRY-SRYSYUKBN       TO  WKSRY-SRYSYUKBN
           MOVE    SRY-JIHIMONEYTOTAL  TO  WKSRY-JIHIMONEYTOTAL
      *ºÞ²ó¿ô·×
           MOVE    WRK-ZAIKAISU        TO  WKSRY-ZAIKAIKEI
      *
           IF     (SRY-SRYKBN          =   "21"  OR  "22"  OR  "23") AND
                  (WRK-DOKAISU     NOT =   ZERO                    )
               MOVE    WRK-DOKAISU     TO  WKSRY-ZAIKAIKEI
           END-IF
      *    ºÞÅÀ¿ô·×
           MOVE    ACCT-ZAITEN         TO  WKSRY-ZAITENKEI
      *ÊÝ¸±ÁÈ¹ç
           MOVE    ACCT-HKNCOMBI       TO  WKSRY-HKNCOMBI
      *
           MOVE    ZERO                TO  IDX-W
           MOVE    ZERO                TO  IDY
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   5   )   OR
                              (SRY-SRYCD (IDX)     =   SPACE )
      *        ÅÐÏ¿»þ¤Î¼«Æ°»»ÄêÊ¬¤ÏÂÐ¾Ý³°¡ÊÅÀÅ©°Ê³°¡Ë
      ******** IF     (SRY-AUTOKBN (IDX)   =   "4"  OR
      *                                        "5"  OR
      *******                                  "6" ) OR
               IF    ((SRY-AUTOKBN (IDX)   =   "3" ) AND
                      (SRY-SRYSYUKBN   NOT =   "330" AND
                                               "340" ))
                   CONTINUE
               ELSE
                   ADD     1                   TO  IDY
                   MOVE    SRY-SRYCD (IDX)     TO  WKSRY-SRYCD    (IDY)
                   MOVE    SRY-SRYSURYO (IDX)  TO  WKSRY-SRYSURYO (IDY)
                   MOVE    SRY-SRYKAISU (IDX)  TO  WKSRY-SRYKAISU (IDY)
                   MOVE    SRY-AUTOKBN  (IDX)  TO  WKSRY-AUTOKBN  (IDY)
      *            ¼«Æ°È¯À¸¤ÎÃæ¿´ÀÅÌ®Ãí¼Í¤Î¤ßÁªÂò²ÄÇ½¤È¤¹¤ë
                   IF     (SRY-AUTOKBN (IDX)   =   "3" )  AND
                          (SRY-SRYSYUKBN       =   "340")
                       MOVE    SPACE           TO  WKSRY-AUTOKBN (IDY)
                   END-IF
      *            ¼«Æ°È¯À¸ÁªÂò²ÄÇ½¤È¤¹¤ë
                   IF     (FLG-WRITE           =   1   )  AND
                          (SRY-AUTOKBN (IDX)   =   "4"
                                               OR  "5"
                                               OR  "6"  )
                       MOVE    SPACE           TO  WKSRY-AUTOKBN (IDY)
                   END-IF
                   MOVE    SRY-INPUTNUM (IDX)  TO  WKSRY-INPUTNUM (IDY)
                   MOVE    SRY-JIHIMONEY(IDX)  TO  WKSRY-JIHIMONEY(IDY)
                   IF      SRY-INPUTNUM (IDX)  NOT =   ZERO
                       PERFORM 490111-PTCOM-SET-SEC
                   END-IF
                   MOVE    IDY                 TO  IDX-W
               END-IF
               ADD     1                   TO  IDX-KAI
           END-PERFORM
      *
           IF     (ACCT-MEISAISU       =   IDX-KAI )  AND
                  (IDX-W               >   ZERO    )
               MOVE    WRK-ZAIKAISU        TO  WKSRY-ZAIKAISU (IDX-W)
           END-IF
      *
           .
       41012-SRYACT-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼Ô¥³¥á¥ó¥È¤«¤éÊÔ½¸¤¹¤ë 
      *****************************************************************
       490111-PTCOM-SET-SEC              SECTION.
      *
           MOVE    SRY-HOSPNUM         TO  PTCOM-HOSPNUM
           MOVE    SRY-PTID            TO  PTCOM-PTID
           MOVE    SRY-ZAINUM          TO  PTCOM-ZAINUM
           MOVE    SRY-SRYCD (IDX)     TO  PTCOM-SRYCD
           MOVE    SRY-INPUTNUM(IDX)   TO  PTCOM-RENNUM
      *¼ç¥­¡¼¤Ç¸¡º÷
           PERFORM 950-PTCOM-READ-SEC
           IF      FLG-PTCOM           =   ZERO
               MOVE    PTCOM-INPUTCOMENT   TO  WKSRY-INPUTCOMENT (IDY)
               MOVE    PTCOM-INPUTCHI (1)  TO  WKSRY-INPUTCHI (IDY 1)
               MOVE    PTCOM-INPUTCHI (2)  TO  WKSRY-INPUTCHI (IDY 2)
               MOVE    PTCOM-INPUTCHI (3)  TO  WKSRY-INPUTCHI (IDY 3)
               MOVE    PTCOM-INPUTCHI (4)  TO  WKSRY-INPUTCHI (IDY 4)
           END-IF
           .
       490111-PTCOM-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *     ¿ÇÎÅ¹Ô°ÙÆâÍÆÊÔ½¸½èÍý
      *****************************************************************
       3101-WKSRYACT-HEN-SEC              SECTION.
      *
      *    ¿ÇÎÅ¥³¡¼¥É·×·×»»
           MOVE    ZERO                TO  IDZ
           MOVE    ZERO                TO  FLG-YAKUSOKU
           MOVE    ZERO                TO  WRK-MEISAISU
           MOVE    ZERO                TO  WRK-ZAITEN
           MOVE    ZERO                TO  WRK-SRYKAISUKEI
           MOVE    ZERO                TO  WRK-JIHIMONEY
           MOVE    ZERO                TO  WRK-HOUKNS-CNT
           MOVE    ZERO                TO  WRK-HOUKNS-IDX
           MOVE    SPACE               TO  WRK-HOUKNS-NAME
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   IDX-KOUI
      *
      *        ¿ÇÎÅ¼ïÊÌ
               MOVE    LNK-WKSRY-SRYKBN   (IDX)    TO  SPA-NAI-SRYKBN
                                                        (SPA-NAI-MAX2)
      *
      *        ºÞÅÀ¿ô·×
               MOVE    LNK-WKSRY-ZAITENKEI(IDX)    TO  WRK-ZAITEN
      *        ²ó¿ô·×
               MOVE    LNK-WKSRY-ZAIKAIKEI(IDX)    TO  WRK-SRYKAISUKEI
      **       ¼«Èñ
               IF      LNK-WKSRY-JIHIMONEYTOTAL (IDX)   NOT =   ZERO
                   MOVE    LNK-WKSRY-JIHIMONEYTOTAL (IDX)
                                                   TO  WRK-JIHIMONEY
               END-IF
      *
      *        ºÞÆâ£±¹ÔÌÜ
               IF      IDX                 =   1
                   ADD     1               TO  IDG
                   PERFORM 31011-GYO1-HEN-SEC
               END-IF
      *
      *        ºÞÌÀºÙÊÔ½¸
               PERFORM VARYING     IDZ     FROM    1   BY  1
                       UNTIL      (IDZ         >   5   )  OR
                                  (IDG         >   MAX-LINE )  OR
                                  (LNK-WKSRY-SRYCD (IDX IDZ) =  SPACE)
                   ADD     1                   TO  WRK-MEISAISU
      *            ¼«Èñ¤Î»þ¡¢¶â³Û¤òÉ½¼¨
                   IF      LNK-WKSRY-SRYKBN (IDX)  =   "95"  OR
                                                       "96"
                       PERFORM 31013-JIHIMEI-HEN-SEC
                   ELSE
                       PERFORM 31012-ZAIMEI-HEN-SEC
                   END-IF
      *            ÌóÂ«¥»¥Ã¥È¤Î»þ
                   IF      LNK-WKSRY-SRYCD (IDX IDZ)(1:1)   =   "S"
                       MOVE    1                  TO  FLG-YAKUSOKU
                   END-IF
               END-PERFORM
           END-PERFORM
      *
      *    ºÞÅÀ¿ô¤¬¥¼¥í¤Î»þ¡¢¼«Èñ¤òÅÀ¿ô¤Ø
      *    IF      WRK-ZAITEN          =   ZERO
      *        MOVE   WRK-JIHIMONEY        TO  WRK-ZAITEN
      *    END-IF
      *
      *    ¿ÇÎÅ¥³¡¼¥É¤¬¤Ê¤¤»þ¡¢½èÍý¤ò¤·¤Ê¤¤
           IF      WRK-MEISAISU        =   ZERO
               COMPUTE IDZ             =   IDZ     -   1
               GO      TO      3101-WKSRYACT-HEN-EXT
           END-IF
      *!
      *    Êñ³ç¸¡ºº¿ô
           IF      WRK-HOUKNS-CNT      >   1
               PERFORM 3009-INPUT-MEISYO-SEC
           END-IF
      *
      *    ¼«Èñ¤Î»þ¡¢·×¤òÉ½¼¨¤·¤Ê¤¤
           IF      WRK-JIHIMONEY       >   ZERO
               CONTINUE
           ELSE
      *
      *        ºÞ¡¡ÅÀ¿ô¡öÆü¿ô¡¡·×¡¡ÊÔ½¸ ¡ÊºÇ½ª¹Ô¤ËÄÉ²Ã¡Ë
               IF      SPA-GMN-HEN1 (IDG)      =   SPACE  OR  ALL "¡¡"
                   CONTINUE
               ELSE
                   ADD    1                    TO  IDG
               END-IF
               PERFORM 31013-INPUTCD-HEN-SEC
               MOVE    WRK-ZAIKEIJ         TO  SPA-GMN-TZAIKEI (IDG)
      *
               INSPECT SPA-GMN-TMEISYO2(IDG)   REPLACING
                                               ALL "  "  BY  "¡¡"
      *        INSPECT SPA-GMN-TYOBI   (IDG)   REPLACING
      *                                        ALL "  "  BY  "¡¡"
               INSPECT SPA-GMN-TZAIKEI (IDG)   REPLACING
                                               ALL "  "  BY  "¡¡"
      *
               MOVE    SPA-NAI-MAX2        TO  SPA-NAI-TBANGO    (IDG)
           END-IF
      *
      *    ºÞ½ªÎ»ÊÔ½¸
           ADD     1                   TO  IDG
           IF      IDG                 >   MAX-LINE
               CONTINUE
           ELSE
               MOVE    ALL "-"             TO  SPA-GMN-TMEISYO (IDG)
           END-IF
      *
            .
       3101-WKSRYACT-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *     Êñ³ç¸¡ºº¿ôºÆÊÔ½¸½èÍý
      *****************************************************************
       3009-INPUT-MEISYO-SEC        SECTION.
      *
           INITIALIZE                  ORCSMEIHENAREA
           MOVE    "2"                 TO  ORCSMEIHEN-KBN
           MOVE    WRK-HOUKNS-CNT      TO  ORCSMEIHEN-SURYO
           MOVE    WRK-HOUKNS-NAME     TO  ORCSMEIHEN-TNS-NAME
           CALL    "ORCSMEIHEN"        USING
                                       SPA-AREA
                                       ORCSMEIHENAREA
           IF      WRK-HOUKNS-NAME(29:)    =   SPACE
               MOVE    ORCSMEIHEN-MEISYO   TO  SPA-GMN-TMEISYO2
                                                  (WRK-HOUKNS-IDX)
           ELSE
               IF      IDG             =   WRK-HOUKNS-IDX
                   ADD     1               TO  IDG
                   MOVE    IDG             TO  WRK-HOUKNS-IDX
               ELSE
                   PERFORM VARYING     IDG3    FROM    IDG   BY  -1
                           UNTIL       IDG3    <=  WRK-HOUKNS-IDX
                       MOVE    SPA-GMN-TBLREC-G (IDG3)
                                               TO  SPA-GMN-TBLREC-G
                                                           (IDG3 + 1)
                   END-PERFORM
                   COMPUTE WRK-HOUKNS-IDX  =   WRK-HOUKNS-IDX  +  1
                   INITIALIZE                  SPA-GMN-TBLREC-G
                                                        (WRK-HOUKNS-IDX)
                   MOVE    SPA-NAI-MAX2        TO  SPA-NAI-TBANGO
                                                        (WRK-HOUKNS-IDX)
                   ADD     1               TO  IDG
               END-IF
               IF      WRK-HOUKNS-IDX      <=   MAX-LINE
                   MOVE    ORCSMEIHEN-MEISYO2
                                       TO  SPA-GMN-TMEISYO2
                                                  (WRK-HOUKNS-IDX)
                                                  (29:)
                   INSPECT SPA-GMN-TMEISYO2(WRK-HOUKNS-IDX)   REPLACING
                                               ALL "  "  BY  "¡¡"
                   INSPECT SPA-GMN-TZAIKEI (WRK-HOUKNS-IDX)   REPLACING
                                               ALL "  "  BY  "¡¡"
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  WRK-HOUKNS-CNT
           MOVE    ZERO                TO  WRK-HOUKNS-IDX
           MOVE    SPACE               TO  WRK-HOUKNS-NAME
           .
       3009-INPUT-MEISYO-EXT.
           EXIT.
      *
      *****************************************************************
      *   ºÞÆâ£±¹ÔÌÜ  ÊÔ½¸½èÍý
      *****************************************************************
       31011-GYO1-HEN-SEC                  SECTION.
      *
      *    ¿ÇÎÅ¼ïÊÌ¶èÊ¬Ì¾¾Î¡¢¿ÇÎÅ¹Ô°Ù¶èÊ¬¥»¥Ã¥È
           SET     MSYU-IDX            TO  1
           SEARCH      MSYU-TBL-OCC    VARYING   MSYU-IDX
                   AT   END
                       MOVE    SPACE       TO  WRK-SRYSYUMEI
                   WHEN    LNK-WKSRY-SRYSYUKBN (IDX) =   MSYU-SRYSYUKBN
                                                      (MSYU-IDX)
                       MOVE    MSYU-SRYMEI (MSYU-IDX)
                                                TO  WRK-SRYSYUMEI
           END-SEARCH
      *
      *    ¿ÇÎÅ¼ïÊÌ¤¬¤Ê¤¤»þ¡¢¿ÇÎÅ¹Ô°Ù¶èÊ¬¤è¤ê
           IF      LNK-WKSRY-SRYSYUKBN (IDX)   =   SPACE
               SET     MSYU-IDX            TO  1
               SEARCH      MSYU-TBL-OCC    VARYING   MSYU-IDX
                   AT   END
                       MOVE    SPACE           TO  WRK-SRYSYUMEI
                   WHEN    LNK-WKSRY-SRYKBN(IDX)
                                           =   MSYU-SRYKBN(MSYU-IDX)
                       MOVE    MSYU-SRYMEI (MSYU-IDX)
                                               TO  WRK-SRYSYUMEI
               END-SEARCH
           END-IF
      *
           IF      LNK-WKSRY-SRYSYUKBN (IDX)   =   SPACE
               MOVE    SPACE           TO  SPA-GMN-TMEISYO (IDG)
               MOVE    WRK-SRYSYUMEI   TO  SPA-GMN-TMEISYO (IDG)(7:)
           ELSE
               MOVE    "."             TO  SPA-GMN-TMEISYO (IDG)(1:1)
               MOVE    LNK-WKSRY-SRYSYUKBN (IDX)
                                       TO  SPA-GMN-TMEISYO (IDG)(2:3)
               MOVE    WRK-SRYSYUMEI   TO  SPA-GMN-TMEISYO (IDG)(7:)
           END-IF
      *    ¼«Æ°È¯À¸Ê¬
           IF      LNK-WKSRY-AUTOKBN(IDX 1)    =   "4"
                                               OR  "5"
                                               OR  "6"
               MOVE    SPACE           TO  WRK-SRYSYUMEI-H
               MOVE    "¡ý"            TO  WRK-SRYSYUMEI-H
               MOVE    SPA-GMN-TMEISYO (IDG)
                                       TO  WRK-SRYSYUMEI-H(3:)
               MOVE    WRK-SRYSYUMEI-H TO  SPA-GMN-TMEISYO (IDG)
           END-IF
      *
           INSPECT SPA-GMN-TMEISYO  (IDG)   REPLACING
                                            ALL "  "  BY  "¡¡"
           INSPECT SPA-GMN-TYOBI0   (IDG)   REPLACING
                                            ALL "  "  BY  "¡¡"
      *
      *    ÈÖ¹æ
           MOVE    SPA-NAI-MAX2        TO  SPA-GMN-TBANGO    (IDG)
           MOVE    SPA-NAI-MAX2        TO  SPA-NAI-TBANGO    (IDG)
      *
           .
       31011-GYO1-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *   ºÞÆâÌÀºÙ  ÊÔ½¸½èÍý
      *****************************************************************
       31012-ZAIMEI-HEN-SEC                  SECTION.
      *
           ADD     1                   TO  IDG
           IF      IDG                 >   MAX-LINE
               GO      TO      31012-ZAIMEI-HEN-EXT
           END-IF
           MOVE    SPA-NAI-MAX2        TO  SPA-NAI-TBANGO    (IDG)
      *
      *    ÌóÂ«¥»¥Ã¥ÈÊÔ½¸
           IF      LNK-WKSRY-SRYCD (IDX IDZ)(1:1)   =   "S"
               PERFORM 310120-YAKUSOKU-SET-SEC
               GO      TO      31012-ZAIMEI-HEN-EXT
           END-IF
      *
      *    ¿ÇÎÅ¥³¡¼¥É¤è¤ê¿ÇÎÅ¹Ô°ÙÌ¾¾Î¤ò¼èÆÀ
           MOVE    LNK-WKSRY-SRYCD (IDX IDZ)   TO  TNS-SRYCD
           PERFORM 910-TENSU-READ-SEC
           IF      FLG-TENSU       NOT =   ZERO
               MOVE    LNK-WKSRY-SRYCD (IDX IDZ)   TO  TNS-NAME
           END-IF
      *    ¹Ô°ÙÌ¾¾Î
           MOVE    TNS-NAME            TO  SPA-GMN-TMEISYO2(IDG)
      *    ÌôºÞÉþÍÑ¥³¥á¥ó¥È¤Î»þ¡¢ºÆÊÔ½¸
           IF      LNK-WKSRY-SRYCD (IDX IDZ)(1:3)  =   "001"
                PERFORM 3100121-FUKIYO-MEISYO-SEC
                MOVE    WRK-MEISYO    TO  SPA-GMN-TMEISYO2(IDG)
           END-IF
      *!
      *    ¸åÈ¯°åÌôÉÊÊÑ¹¹ºÆÊÔ½¸
           IF      LNK-WKSRY-SRYCD (IDX IDZ)   =   "099209903"
                PERFORM 3100122-KOUHATU-MEISYO-SEC
                MOVE    WRK-MEISYO    TO  SPA-GMN-TMEISYO2(IDG)
           END-IF
      *    ÍÑÎÌ³ä¹çºÆÊÔ½¸
           IF     (LNK-WKSRY-SRYCD(IDX IDZ)(1:7)   =   "0992000")  AND
                  (LNK-WKSRY-SRYSURYO(IDX IDZ) NOT =   ZERO     )
                PERFORM 3005-INPUT-MEISYO3-SEC
                MOVE    WRK-MEISYO    TO  SPA-GMN-TMEISYO2(IDG)
           END-IF
      *!
      *
      *    ÌóÂ«¤ÎÆâÍÆ¤Î»þ¡¢ºÆÊÔ½¸
           IF      FLG-YAKUSOKU        =   1
               MOVE    SPA-GMN-TMEISYO2(IDG)   TO  WRK-MEISYO
               MOVE    SPACE               TO  SPA-GMN-TMEISYO2(IDG)
               STRING     "¡ä"             DELIMITED   BY  SIZE
                          WRK-MEISYO       DELIMITED   BY  SIZE
                          INTO             SPA-GMN-TMEISYO2(IDG)
               END-STRING
           END-IF
      *
      *    ¥³¥á¥ó¥È¤Î»þ¡¢ÆâÍÆÀßÄê
           IF    ((LNK-WKSRY-SRYCD   (IDX IDZ)(1:1)  =   "8"   ) OR
                  (LNK-WKSRY-SRYCD   (IDX IDZ)(1:3)  =   "008" ))  AND
      *DDDDDDDDDD (LNK-WKSRY-INPUTNUM(IDX IDZ)    NOT =   ZERO OR
                  (LNK-WKSRY-INPUTCOMENT(IDX IDZ) NOT =  SPACE )
               MOVE    LNK-WKSRY-INPUTCOMENT(IDX IDZ)
                                           TO  SPA-GMN-TMEISYO2(IDG)
           END-IF
      *
      *    ¿ôÎÌ¡ÊÌôºÞ¡¢´ïºà¤Î¤È¤­¡Ë
           IF      LNK-WKSRY-SRYCD (IDX IDZ)(1:1)   =   "6"  OR  "7"
               MOVE    LNK-WKSRY-SRYSURYO (IDX IDZ)  TO  WRK-SURYO
               PERFORM 310121-SURYO-HEN-SEC
               MOVE    WRK-SURYO-J         TO  SPA-GMN-TSURYOU (IDG)
               MOVE    TNS-TANINAME        TO  SPA-GMN-TTANI1  (IDG)
           END-IF
      *    Ã±°Ì
           IF     (LNK-WKSRY-SRYCD (IDX IDZ)(1:1) =   "1" )  AND
                  (TNS-TANICD                 NOT =   ZERO ) AND
                 ((LNK-WKSRY-SRYKBN   (IDX)   NOT =   "70" )  OR
                  (LNK-WKSRY-AUTOKBN (IDX IDZ)    =   "S"  ))
      ****     IF      LNK-WKSRY-SRYSURYO (IDX IDZ)   >   1
                   MOVE    LNK-WKSRY-SRYSURYO (IDX IDZ)  TO  WRK-SURYO
                   PERFORM 310121-SURYO-HEN-SEC
                   MOVE    WRK-SURYO-J         TO  SPA-GMN-TSURYOU (IDG)
      ****     END-IF
               MOVE    TNS-TANINAME        TO  SPA-GMN-TTANI1  (IDG)
           END-IF
      *    Ê¬²è¿ô
           IF     (LNK-WKSRY-SRYCD (IDX IDZ)(1:1)   =   "7"  )  AND
                  (TNS-DATAKBN             =   3    )  AND
                  (LNK-WKSRY-SRYKAISU (IDX IDZ)      >   ZERO )
               MOVE    LNK-WKSRY-SRYKAISU (IDX IDZ)
                                           TO  WRK-BUNGSU-Z
               PERFORM 310122-BUNGSU-HEN-SEC
               MOVE    WRK-BUNGSU-J        TO  SPA-GMN-TTANMEI (IDG)
               MOVE    "Ê¬²è"              TO  SPA-GMN-TTANI2  (IDG)
           END-IF
      *!
      *    Êñ³ç¸¡ºº¤ÎÈ½Äê
           IF     (LNK-WKSRY-SRYCD (IDX IDZ)(1:1) =   "1" )  AND
                  (LNK-WKSRY-SRYKBN (IDX)      =   "60" ) AND
                  (TNS-DATAKBN                 =   1    ) AND
                  (TNS-HOUKNSKBN           NOT =   ZERO )
               ADD     1                   TO  WRK-HOUKNS-CNT
               MOVE    IDG                 TO  WRK-HOUKNS-IDX
               MOVE    SPA-GMN-TMEISYO2(IDG)   TO  WRK-HOUKNS-NAME
           END-IF
      *!
      *
           INSPECT SPA-GMN-TMEISYO2(IDG) REPLACING  ALL "  "  BY  "¡¡"
           INSPECT SPA-GMN-TSURYOU (IDG) REPLACING  ALL "  "  BY  "¡¡"
           INSPECT SPA-GMN-TTANMEI (IDG) REPLACING  ALL "  "  BY  "¡¡"
           INSPECT SPA-GMN-TTANI1  (IDG) REPLACING  ALL "  "  BY  "¡¡"
           INSPECT SPA-GMN-TTANI2  (IDG) REPLACING  ALL "  "  BY  "¡¡"
           INSPECT SPA-GMN-TYOBI1  (IDG) REPLACING  ALL "  "  BY  "¡¡"
      *
      *    ¥³¥á¥ó¥È°Ê³°¤ÎºÇ½ª¹Ô¥»¥Ã¥È
           IF      LNK-WKSRY-SRYCD (IDX IDZ)(1:1)   =   "0"  OR  "8"
               CONTINUE
           ELSE
               MOVE    IDG             TO  WRK-IDG
           END-IF
      *
           .
       31012-ZAIMEI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *   ºÞÆâÌÀºÙ¡Ê¼«Èñ¡Ë  ÊÔ½¸½èÍý
      *****************************************************************
       31013-JIHIMEI-HEN-SEC           SECTION.
      *
           ADD     1                   TO  IDG
           IF      IDG                 >   MAX-LINE
               GO      TO      31013-JIHIMEI-HEN-EXT
           END-IF
           MOVE    SPA-NAI-MAX2        TO  SPA-NAI-TBANGO    (IDG)
      *
      *    ÌóÂ«¥»¥Ã¥ÈÊÔ½¸
           IF      LNK-WKSRY-SRYCD (IDX IDZ)(1:1)   =   "S"
               PERFORM 310120-YAKUSOKU-SET-SEC
               GO      TO      31013-JIHIMEI-HEN-EXT
           END-IF
      *
      *    ¿ÇÎÅ¥³¡¼¥É¤è¤ê¿ÇÎÅ¹Ô°ÙÌ¾¾Î¤ò¼èÆÀ
           MOVE    LNK-WKSRY-SRYCD (IDX IDZ)   TO  TNS-SRYCD
           PERFORM 910-TENSU-READ-SEC
           IF      FLG-TENSU       NOT =   ZERO
               MOVE    LNK-WKSRY-SRYCD (IDX IDZ)   TO  TNS-NAME
           END-IF
      *    ¹Ô°ÙÌ¾¾Î
           MOVE    TNS-NAME            TO  SPA-GMN-TMEISYO2(IDG)
      *
      *    ÌóÂ«¤ÎÆâÍÆ¤Î»þ¡¢ºÆÊÔ½¸
           IF      FLG-YAKUSOKU        =   1
               MOVE    SPA-GMN-TMEISYO2(IDG)   TO  WRK-MEISYO
               MOVE    SPACE               TO  SPA-GMN-TMEISYO2(IDG)
               STRING     "¡ä"             DELIMITED   BY  SIZE
                          WRK-MEISYO       DELIMITED   BY  SIZE
                          INTO             SPA-GMN-TMEISYO2(IDG)
               END-STRING
           END-IF
      *
      *    ¥³¥á¥ó¥È¤Î»þ¡¢ÆâÍÆÀßÄê
           IF    ((LNK-WKSRY-SRYCD   (IDX IDZ)(1:1)  =   "8"   ) OR
                  (LNK-WKSRY-SRYCD   (IDX IDZ)(1:3)  =   "008"))  AND
                  (LNK-WKSRY-INPUTCOMENT(IDX IDZ) NOT =  SPACE )
               MOVE    LNK-WKSRY-INPUTCOMENT(IDX IDZ)
                                           TO  SPA-GMN-TMEISYO2(IDG)
           END-IF
      *
      *    ·×
           MOVE    LNK-WKSRY-JIHIMONEY(IDX IDZ)
                                       TO  WRK-KEI
           MOVE    WRK-KEI                 TO  WRK-ZAIKEI
      *
      *    ÆüËÜ¸ìÊÑ´¹
           MOVE    SPACE               TO  WRK-ZAIKEIJ
           MOVE    1                   TO  IDJ2
           PERFORM VARYING     IDJ     FROM    1  BY  1
                   UNTIL       IDJ     >   40
              EVALUATE     WRK-ZAIKEI (IDJ:1)
                   WHEN    SPACE
                       MOVE    "¡¡"            TO  WRK-ZAIKEIJ (IDJ2:2)
                       ADD     2               TO  IDJ2
                   WHEN    "X"
                       MOVE    "¡ß"            TO  WRK-ZAIKEIJ (IDJ2:2)
                       ADD     2               TO  IDJ2
                   WHEN    "1"  THRU  "9"
                       MOVE    WRK-ZAIKEI (IDJ:1)  TO  IDJ1
                       MOVE    TBL-SUJI (IDJ1)     TO  WRK-ZAIKEIJ
                                                              (IDJ2:2)
                       ADD     2                   TO  IDJ2
                   WHEN    "0"
                       MOVE    TBL-SUJI (10)       TO  WRK-ZAIKEIJ
                                                              (IDJ2:2)
                       ADD     2                   TO  IDJ2
               END-EVALUATE
           END-PERFORM
      *
           IF      LNK-WKSRY-JIHIMONEY(IDX IDZ)    =   ZERO
               MOVE    SPACE               TO  SPA-GMN-TZAIKEI (IDG)
           ELSE
               MOVE    "±ß"                TO  WRK-ZAIKEIJ(21:2)
               MOVE    WRK-ZAIKEIJ         TO  SPA-GMN-TZAIKEI (IDG)
           END-IF
      *
           INSPECT SPA-GMN-TMEISYO2(IDG) REPLACING  ALL "  "  BY  "¡¡"
      **** INSPECT SPA-GMN-TYOBI   (IDG) REPLACING  ALL "  "  BY  "¡¡"
           INSPECT SPA-GMN-TZAIKEI (IDG) REPLACING  ALL "  "  BY  "¡¡"
      *
      *    ¥³¥á¥ó¥È°Ê³°¤ÎºÇ½ª¹Ô¥»¥Ã¥È
           IF      LNK-WKSRY-SRYCD (IDX IDZ)(1:1)   =   "0"  OR  "8"
               CONTINUE
           ELSE
               MOVE    IDG             TO  WRK-IDG
           END-IF
      *
           .
       31013-JIHIMEI-HEN-EXT.
           EXIT.
      *****************************************************************
      *     ÌóÂ«¥»¥Ã¥È¤Î»þ¡¢ºÆÊÔ½¸½èÍý
      *****************************************************************
       310120-YAKUSOKU-SET-SEC        SECTION.
      *
           MOVE    SPACE               TO  INPUTCD-REC
           MOVE    SPA-HOSPNUM         TO  ICD-HOSPNUM
      *    ¥»¥Ã¥È¤Î·å¿ô¤Ï£¶¤È¤¹¤ë
           MOVE    "6"                 TO  ICD-CDSYU
           MOVE    LNK-WKSRY-SRYCD (IDX IDZ)(1:6)
                                       TO  ICD-INPUTCD
      *
           PERFORM 930-INPUTCD-READ-SEC
      *
           IF      FLG-INPUTCD         =   ZERO
               MOVE    ICD-DSPNAME         TO  SPA-GMN-TMEISYO2(IDG)
           ELSE
               MOVE    LNK-WKSRY-SRYCD (IDX IDZ)
                                           TO  SPA-GMN-TMEISYO2(IDG)
           END-IF
      *
      *    ¿ôÎÌ¡ÊÌôºÞ¡¢´ïºà¤Î¤È¤­¡Ë
           MOVE    LNK-WKSRY-SRYSURYO (IDX IDZ)  TO  WRK-SURYO
           PERFORM 310121-SURYO-HEN-SEC
           MOVE    WRK-SURYO-J         TO  SPA-GMN-TSURYOU (IDG)
      *
           .
       310120-YAKUSOKU-SET-EXT.
           EXIT.
      *****************************************************************
      *     ÌôºÞÉþÍÑ¥³¥á¥ó¥È¤Î»þ¡¢ºÆÊÔ½¸½èÍý
      *****************************************************************
       3100121-FUKIYO-MEISYO-SEC        SECTION.
      *
           MOVE    SPACE               TO  WRK-MEISYO
      *
           STRING     "¡Ú"             DELIMITED   BY  SIZE
                      TNS-NAME         DELIMITED   BY  "    "
                      "¡Û"             DELIMITED   BY  SIZE
                      INTO             WRK-MEISYO
           END-STRING
           .
       3100121-FUKIYO-MEISYO-EXT.
           EXIT.
      *****************************************************************
      *     ¸åÈ¯°åÌôÉÊÊÑ¹¹ºÆÊÔ½¸½èÍý
      *****************************************************************
       3100122-KOUHATU-MEISYO-SEC        SECTION.
      *
           MOVE    SPACE               TO  WRK-MEISYO
      *
           STRING     "¡Ú"             DELIMITED   BY  SIZE
                      TNS-NAME         DELIMITED   BY  "    "
                      "¡Û"             DELIMITED   BY  SIZE
                      INTO             WRK-MEISYO
           END-STRING
           .
       3100122-KOUHATU-MEISYO-EXT.
           EXIT.
      *
      *****************************************************************
      *     ÍÑÎÌ³ä¹çºÆÊÔ½¸½èÍý
      *****************************************************************
       3005-INPUT-MEISYO3-SEC        SECTION.
      *
           INITIALIZE                  ORCSMEIHENAREA
           MOVE    "1"                 TO  ORCSMEIHEN-KBN
           MOVE    LNK-WKSRY-SRYSURYO(IDX IDZ)
                                       TO  ORCSMEIHEN-SURYO
           MOVE    LNK-WKSRY-SRYCD(IDX IDZ)
                                       TO  ORCSMEIHEN-SRYCD
           MOVE    TNS-NAME            TO  ORCSMEIHEN-TNS-NAME
           CALL    "ORCSMEIHEN"        USING
                                       SPA-AREA
                                       ORCSMEIHENAREA
           MOVE    ORCSMEIHEN-MEISYO   TO  WRK-MEISYO
           .
       3005-INPUT-MEISYO3-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ôÎÌÉ½¼¨ÍÑÊÔ½¸½èÍý
      *****************************************************************
       310121-SURYO-HEN-SEC            SECTION.
      *
           MOVE    SPACE               TO  WRK-SURYO-X
           MOVE    WRK-SURYO-S1        TO  WRK-SURYO-Z1
      *
           MOVE    ZERO                TO  FLG-SP
           PERFORM VARYING     IDM     FROM    3  BY  -1
                   UNTIL       IDM     <   1
               IF      WRK-SURYO-S2(IDM:1) NOT =   ZERO
                   MOVE    1               TO  FLG-SP
               END-IF
               IF      FLG-SP          =   1
                   MOVE    WRK-SURYO-S2(IDM:1) TO  WRK-SURYO-Z3(IDM:1)
               END-IF
           END-PERFORM
      *
           IF      WRK-SURYO-Z3        NOT =   SPACE
               MOVE    "."                 TO  WRK-SURYO-Z2
               MOVE    WRK-SURYO-S1        TO  WRK-SURYO-Z1-9
           END-IF
      *
      *    ÆüËÜ¸ìÊÑ´¹
           MOVE    SPACE               TO  WRK-SURYO-J
           MOVE    1                   TO  IDJ2
           PERFORM VARYING     IDJ     FROM    1  BY  1
                   UNTIL       IDJ     >   9
              EVALUATE     WRK-SURYO-X (IDJ:1)
                   WHEN    SPACE
                       MOVE    "¡¡"            TO  WRK-SURYO-J (IDJ2:2)
                       ADD     2               TO  IDJ2
                   WHEN    "."
                       MOVE    "¡¥"            TO  WRK-SURYO-J (IDJ2:2)
                       ADD     2               TO  IDJ2
                   WHEN    "1"  THRU  "9"
                       MOVE    WRK-SURYO-X (IDJ:1) TO  IDJ1
                       MOVE    TBL-SUJI (IDJ1)     TO  WRK-SURYO-J
                                                            (IDJ2:2)
                       ADD     2                   TO  IDJ2
                   WHEN    "0"
                       MOVE    TBL-SUJI (10)       TO  WRK-SURYO-J
                                                          (IDJ2:2)
                       ADD     2                   TO  IDJ2
               END-EVALUATE
           END-PERFORM
           .
       310121-SURYO-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ôÎÌÉ½¼¨ÍÑÊÔ½¸½èÍý
      *****************************************************************
       310122-BUNGSU-HEN-SEC           SECTION.
      *
      *    ÆüËÜ¸ìÊÑ´¹
           MOVE    SPACE               TO  WRK-BUNGSU-J
           MOVE    1                   TO  IDJ2
           PERFORM VARYING     IDJ     FROM    1  BY  1
                   UNTIL       IDJ     >   3
              EVALUATE     WRK-BUNGSU-X (IDJ:1)
                   WHEN    SPACE
                       MOVE    "¡¡"            TO  WRK-BUNGSU-J(IDJ2:2)
                       ADD     2               TO  IDJ2
                   WHEN    "."
                       MOVE    "¡¥"            TO  WRK-BUNGSU-J(IDJ2:2)
                       ADD     2               TO  IDJ2
                   WHEN    "1"  THRU  "9"
                       MOVE    WRK-BUNGSU-X (IDJ:1)    TO  IDJ1
                       MOVE    TBL-SUJI (IDJ1)     TO  WRK-BUNGSU-J
                                                               (IDJ2:2)
                       ADD     2                   TO  IDJ2
                   WHEN    "0"
                       MOVE    TBL-SUJI (10)       TO  WRK-BUNGSU-J
                                                               (IDJ2:2)
                       ADD     2                   TO  IDJ2
               END-EVALUATE
           END-PERFORM
           .
       310122-BUNSU-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *   ÆþÎÏ¥³¡¼¥É¤Î²èÌÌÍÑºÆÊÔ½¸½èÍý
      *****************************************************************
       31013-INPUTCD-HEN-SEC                  SECTION.
      *
      *    ÅÀ¿ô¡ö²ó¿ô¡¡·×
      *    ÅÀ¿ô
           MOVE    WRK-ZAITEN          TO  WRK-TENSU
      *
           IF      WRK-SRYKAISUKEI     =   ZERO
               MOVE   1                    TO  WRK-SRYKAISUKEI
           END-IF
           COMPUTE WRK-KEI-G           =   WRK-ZAITEN
                                       *   WRK-SRYKAISUKEI
           MOVE    WRK-KEI-G           TO  WRK-KEI
      *    ²ó¿ô
           MOVE    WRK-SRYKAISUKEI     TO  WRK-KAISU
           MOVE    ZERO                TO  IDK2
           MOVE    SPACE               TO  WRK-ZAIKEI 
           MOVE    SPACE               TO  WRK-KAISU-H 
           MOVE    SPACE               TO  WRK-KEI-H 
           PERFORM VARYING     IDK1    FROM    1   BY  1
                   UNTIL       IDK1    >   8
               IF      WRK-KAISU-X (IDK1:1)    NOT =   SPACE
                   ADD     1           TO  IDK2
                   MOVE    WRK-KAISU-X (IDK1:1)
                                       TO  WRK-KAISU-H (IDK2:1)
               END-IF
           END-PERFORM
      *    ·×
           MOVE    ZERO                TO  IDK2
           PERFORM VARYING     IDK1    FROM    1   BY  1
                   UNTIL       IDK1    >   8
               IF      WRK-KEI-X   (IDK1:1)    NOT =   SPACE
                   ADD     1           TO  IDK2
                   MOVE    WRK-KEI-X   (IDK1:1)
                                       TO  WRK-KEI-H   (IDK2:1)
               END-IF
           END-PERFORM
      *
           STRING  WRK-TENSU               DELIMITED   BY  SIZE
                   "X"                     DELIMITED   BY  SIZE
                   WRK-KAISU-H             DELIMITED   BY  SPACE
      *DDDDDD      "  "                    DELIMITED   BY  SIZE
      *DDDDDD      WRK-KEI-H               DELIMITED   BY  SPACE
                   INTO                    WRK-ZAIKEI
           END-STRING
      *
      *    ÆüËÜ¸ìÊÑ´¹
           MOVE    SPACE               TO  WRK-ZAIKEIJ
           MOVE    1                   TO  IDJ2
           PERFORM VARYING     IDJ     FROM    1  BY  1
                   UNTIL       IDJ     >   40
              EVALUATE     WRK-ZAIKEI (IDJ:1)
                   WHEN    SPACE
                       MOVE    "¡¡"            TO  WRK-ZAIKEIJ (IDJ2:2)
                       ADD     2               TO  IDJ2
                   WHEN    "X"
                       MOVE    "¡ß"            TO  WRK-ZAIKEIJ (IDJ2:2)
                       ADD     2               TO  IDJ2
                   WHEN    "1"  THRU  "9"
                       MOVE    WRK-ZAIKEI (IDJ:1)  TO  IDJ1
                       MOVE    TBL-SUJI (IDJ1)     TO  WRK-ZAIKEIJ
                                                               (IDJ2:2)
                       ADD     2                   TO  IDJ2
                   WHEN    "0"
                       MOVE    TBL-SUJI (10)       TO  WRK-ZAIKEIJ
                                                               (IDJ2:2)
                       ADD     2                   TO  IDJ2
               END-EVALUATE
           END-PERFORM
      *
      *
           .
       31013-INPUTCD-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÂÐ¾Ý¿ÇÎÅ¹Ô°ÙÆâÍÆÊÔ½¸½èÍý
      *****************************************************************
       4201-WKSRYACT-SET-SEC             SECTION.
      *
      *    ¥Ñ¥é¥á¥¿ºï½ü
      *     OPEN    I-O                 PARA-FILE
      *    IF      STS-PARA        NOT =   ZERO
      *        MOVE    2                   TO  FLG-PARA
      *    ELSE
      *        MOVE    ZERO                TO  FLG-PARA
      *    END-IF
      *    PERFORM
      *            UNTIL   FLG-PARA    NOT =   ZERO
      *        INITIALIZE                      PARA-REC
      *        MOVE    SPA-TERMID          TO  PARA-TERMID
      *        MOVE    "WKSRYACT"          TO  PARA-FILEMEI
      *        START   PARA-FILE
      *            KEY IS    >=   PARA-KEY
      *            INVALID
      *                MOVE    1               TO  FLG-PARA
      *            NOT INVALID
      *                PERFORM 990-PARA-NEXT-SEC
      *        END-START
      *        IF      (FLG-PARA            =   ZERO       )  AND
      *                (PARA-TERMID         =   SPA-TERMID )  AND
      *                (PARA-FILEMEI        =   "WKSRYACT" )
      *            DELETE                   PARA-FILE    RECORD
      *        ELSE
      *            MOVE    1                TO  FLG-PARA
      *        END-IF
      *    END-PERFORM
      *    CLOSE                       PARA-FILE
      *
      *****OPEN    I-O                 PARA-FILE
      *
           MOVE    SPA-TERMID          TO  FILE-TERMID2
           MOVE    SPA-HOSPNUM         TO  FILE-HOSPNUM2
           OPEN    OUTPUT              PARA-FILE
      *
           MOVE    ZERO                TO  WRK-EDANUM
      *
           PERFORM VARYING     IDX-R   FROM    1   BY  1
                   UNTIL      (IDX-R           >   MAX-SEL  )  OR
                              (WRK-DOZAINUM (IDX-R)    =   ZERO  )
               PERFORM 42011-PARA-HEN-SEC
           END-PERFORM
      *
           MOVE    1                   TO  SPA-K09-SELOK
      *
           CLOSE                       PARA-FILE
      *
           .
       4201-WKSRYACT-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°ÙºîÀ®½èÍý
      *****************************************************************
       42011-PARA-HEN-SEC           SECTION.
      *
           MOVE    1                   TO  FLG-WRITE
      *
      *     ¥ï¡¼¥¯¿ÇÎÅ¹Ô°Ù¤Î¥ì¥¤¥¢¥¦¥È¤ØÊÔ½¸¸å¡¢²èÌÌÍÑÊÔ½¸¤Ø
           MOVE    SPACE               TO  LNK-WKSRYACT-AREA
           MOVE    ZERO                TO  IDX-KOUI
           MOVE    ZERO                TO  IDX-KAI
      *    ÂÐ¾ÝÆü
           MOVE    SPA-SEL-IDX         TO  IDX-STR
      *
           INITIALIZE                  SRYACT-REC
           MOVE    SPA-HOSPNUM         TO  SRY-HOSPNUM
           MOVE    SPA-K09-NYUGAIKBN   TO  SRY-NYUGAIKBN
           MOVE    SPA-PTID            TO  SRY-PTID
      *****MOVE    SPA-SRYKA           TO  SRY-SRYKA
           MOVE    SPA-K09NAI-RRK-SRYKA(SPA-K09-DOSELNUM)
                                       TO  SRY-SRYKA
           MOVE    SPA-K09NAI-RRKYMD(SPA-K09-DOSELNUM)(1:6)
                                       TO  SRY-SRYYM
           MOVE    WRK-DOZAINUM (IDX-R)
                                       TO  SRY-ZAINUM
      *
           MOVE    SRYACT-REC          TO  MCPDATA-REC
           MOVE    "tbl_sryact"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 930-SRYACT-READ-SEC
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           MOVE    ZERO                TO  WRK-ZAINUM
           PERFORM
                   UNTIL   FLG-SRYACT      =   1
      *
      ***      ½éºÆ¿Ç¤òÂÐ¾Ý³°¤È¤¹¤ë
      *        IF      SRY-SRYKBN          =   "11"  OR  "12"
      *            CONTINUE
      ****     ELSE
      *        ¡É¡ö¡É¤Î»þ¡¢¼«Æ°È¯À¸Ê¬¤ÏÂÐ¾Ý³°
               IF     (FLG-DOALL           =   1  )  AND
                      (SRY-AUTOKBN (1)     =   "4"
                                           OR  "5"
                                           OR  "6" )
                   CONTINUE
               ELSE
      *        ¤¹¤Ù¤Æ¤òÂÐ¾Ý¤È¤¹¤ë
                   MOVE    WRK-DOKAI (IDX-R)   TO  WRK-DOKAISU
      *            ¿ÇÎÅ²ñ·×¸¡º÷ÊÔ½¸
                   PERFORM 41012-SRYACT-HEN-SEC
      *
      *            ¥Ñ¥é¥á¥¿¥Õ¥¡¥¤¥ëºîÀ®
      ***********  MOVE    SRY-ZAINUM          TO  WRK-ZAINUM
                   MOVE    SPACE               TO  PARA-REC
      *************MOVE    SPA-TERMID          TO  PARA-TERMID
                   MOVE    "WKSRYACT"          TO  PARA-FILEMEI
                   ADD     1                   TO  WRK-EDANUM
                   MOVE    WRK-EDANUM          TO  PARA-EDANUM
                   MOVE    WKSRYACT-REC        TO  PARA-DATA-REC
      *
                   WRITE                       PARA-REC
               END-IF
      *
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 930-SRYACT-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_sryact"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       42011-PARA-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼õ¿ÇÍúÎò½èÍý¤Ø
      *****************************************************************
       450-RIREKI-SEC            SECTION.
      *
      *    ½é´ü²èÌÌ¥»¥Ã¥È
           MOVE    SPACE               TO  LINKAREA
           MOVE    SPA-K01KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-K09-NYUGAIKBN   TO  SPA-K07-NYUGAIKBN
           MOVE    SPA-K02             TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGK07"           USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA.
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-K02
           MOVE    SPA-WORK        TO  SPA-K01KYOUTU
      *
           MOVE    "K07"               TO  SPA-SAKIPG
           MOVE    "K09"               TO  SPA-MOTOPG
      *
           MOVE    SPA-K01KYOUTU       TO  SPA-WORK
      *
           MOVE    SPACE               TO  LINKAREA
      *
      *****MOVE    "CHANGE"            TO  MCP-PUTTYPE
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    "K07"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
       450-RIREKI-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    Ìá¤ë¡¡½èÍý
      *****************************************************************
       210-BACK                        SECTION.
      *
      *    Ãæ´Ö¥Õ¥¡¥¤¥ëºï½ü
           MOVE    ZERO                TO  IF-RESULT
           MOVE    FILE-NAME1          TO  IF-FILENAME
           CALL    "orcfiledel"        USING
                                       ORCSFDELAREA
      *
           MOVE    1                   TO  FLG-END2
      *
      *
           MOVE    ZERO                TO  SPA-NAI-SELNUM
           MOVE    ZERO                TO  SPA-NAI-DOSELNUM
           MOVE    SPACE               TO  SPA-GMN-DOSELNUM
      *
           MOVE    SPA-HZN-MOTOPG      TO  SPA-SAKIPG
           MOVE    "K09"               TO  SPA-MOTOPG
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    SPA-K01KYOUTU       TO  SPA-WORK
      *
      *****MOVE    "BACK"              TO  MCP-PUTTYPE
      ** **MOVE   "CHANGE"             TO  MCP-PUTTYPE
           MOVE    "JOIN"              TO  MCP-PUTTYPE.
           MOVE    SPA-SAKIPG          TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
           .
       210-BACK-EXT.
           EXIT.
      *****************************************************************
      *    ¥¯¥ê¥¢½èÍý
      *****************************************************************
       220-CLEAR-SEC             SECTION.
      *
           IF      SPA-GMN-DOSEL       =   SPACE
               MOVE    1                   TO  SPA-K09GMN-CUR
           ELSE
               MOVE    SPACE               TO  SPA-GMN-DOSEL
               INITIALIZE                  SPA-NAI-DOSEL-G
               MOVE    2                   TO  SPA-K09GMN-CUR
           END-IF
           .
       220-CLEAR-EXT.
           EXIT.
      *****************************************************************
      *    Æþ³°¶èÊ¬ÊÑ¹¹½èÍý
      *****************************************************************
       460-NYUGAIKBN-HEN-SEC             SECTION.
      *
           IF      SPA-K09-NYUGAIKBN-MAX   >   1
               EVALUATE    SPA-K09-NYUGAIKBN
                   WHEN    "1"
                       MOVE    SPA-K09-NYUGAIKBN-LST (2)
                                               TO  SPA-K09-NYUGAIKBN-G
                   WHEN    "2"
                       MOVE    SPA-K09-NYUGAIKBN-LST (1)
                                               TO  SPA-K09-NYUGAIKBN-G
               END-EVALUATE
      *        ¼õ¿ÇÍúÎòÊÔ½¸
      ******** IF      SPA-K09-NYUGAIKBN   =   SPA-NYUGAIKBN
      *            PERFORM 3102-JYURRK-SPAHEN-SEC
      *        ELSE
      *            PERFORM 3101-JYURRK-DBHEN-SEC
      *******  END-IF
      *        Æþ³°¶èÊ¬ÊÑ¹¹¼¡¤Ï¡¢£±ÊÇ¤«¤éÉ½¼¨
               MOVE    1                   TO  SPA-K09-RRK-PAGE
               MOVE    ZERO                TO  SPA-K09-RRK-NEXT
               PERFORM 3101-JYURRK-DBHEN-SEC
      *
               IF      SPA-K09GMN-MAX1     >   ZERO
                   MOVE    1                   TO  SPA-K09-DOSELNUM
                   MOVE    SPA-K09GMN-NO(1)    TO  SPA-K09-SELNUM
      *            ¿Ç»¡ÆâÍÆÊÔ½¸
                   PERFORM 4101-JYURRK-HEN-SEC
               ELSE
                   INITIALIZE                  SPA-GMN-TBL
                   INITIALIZE                  SPA-NAI-TBL
                   MOVE    ZERO                TO  SPA-GMN-MAX2
                   MOVE    ZERO                TO  SPA-NAI-MAX2
               END-IF
           END-IF
           .
       460-NYUGAIKBN-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ¶èÊ¬ÊÑ¹¹½èÍý
      *****************************************************************
       470-SRYKBN-HEN-SEC             SECTION.
      *
           PERFORM 4701-SRYKBN-HENKOU-SEC
      *
           IF      SPA-K09-DOSELNUM    >   ZERO
               PERFORM 4101-JYURRK-HEN-SEC
      *
               PERFORM UNTIL  (SPA-K09-SRYKBN  =   "00" )
                       OR     (SPA-GMN-MAX2    >   1    )
                   PERFORM 4701-SRYKBN-HENKOU-SEC
                   PERFORM 4101-JYURRK-HEN-SEC
               END-PERFORM
           ELSE
               MOVE    1                   TO  SPA-K09GMN-CUR
           END-IF
           .
       470-SRYKBN-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ¶èÊ¬ÊÑ¹¹½èÍý
      *****************************************************************
       4701-SRYKBN-HENKOU-SEC             SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-K09-SRYKBN-MAX
               IF      SPA-K09-SRYKBN  =   SPA-K09-SRYKBN-LST
                                                           (IDX)(1:2)
                   IF      IDX             =   SPA-K09-SRYKBN-MAX
                       MOVE    SPA-K09-SRYKBN-LST (1)
                                           TO  SPA-K09-SRYKBN-G
                   ELSE
                       MOVE    SPA-K09-SRYKBN-LST (IDX + 1)
                                           TO  SPA-K09-SRYKBN-G
                   END-IF
                   MOVE    SPA-K09-SRYKBN-MAX  TO  IDX
               END-IF
           END-PERFORM
           .
       4701-SRYKBN-HENKOU-EXT.
           EXIT.
      *****************************************************************
      *    ³ÎÄê¡¡½èÍý
      *****************************************************************
       450-TOROKU-SEC             SECTION.
      *
           PERFORM 420-DOSEL-CHK-SEC
      *
           IF      IDX-H               =   ZERO
      *        Ìá¤ë
               PERFORM 210-BACK
           END-IF
      *
      *    MOVE    SPA-HZN-MOTOPG      TO  SPA-SAKIPG
      *    MOVE    "K09"               TO  SPA-MOTOPG
      *
      *    MOVE    SPACE               TO  LINKAREA
      *
      *    MOVE    SPA-K01KYOUTU       TO  SPA-WORK
      *
      *    MOVE    "CHANGE"            TO  MCP-PUTTYPE
      *    MOVE    SPA-SAKIPG          TO  MCP-WINDOW
      *
      *    PERFORM 900-PUT-WINDOW
      *
      *    MOVE    1                   TO  FLG-END
           .
       450-TOROKU-EXT.
           EXIT.
      *****************************************************************
      *    ¼õ¿ÇÍúÎò Á°ÊÇ¡¡½èÍý
      *****************************************************************
       4109-BC06-SYORI-SEC             SECTION.
      *
           IF      SPA-K09-RRK-PAGE        =   1
               CONTINUE
           ELSE
               COMPUTE SPA-K09-RRK-PAGE    =   SPA-K09-RRK-PAGE  -  1
      *
               PERFORM 3101-JYURRK-DBHEN-SEC
      *
               INITIALIZE                  SPA-GMN-TBL
               INITIALIZE                  SPA-NAI-TBL
               MOVE    ZERO                TO  SPA-GMN-MAX2
               MOVE    ZERO                TO  SPA-NAI-MAX2
               IF      SPA-K09GMN-MAX1     >   ZERO
                   MOVE    1                   TO  SPA-K09-DOSELNUM
                   MOVE    SPA-K09GMN-NO(1)    TO  SPA-K09-SELNUM
      *            ¿Ç»¡ÆâÍÆÊÔ½¸
                   PERFORM 4101-JYURRK-HEN-SEC
               ELSE
                   MOVE    10              TO  SPA-K09GMN-CUR
               END-IF
           END-IF
           .
       4109-BC06-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼õ¿ÇÍúÎò ¼¡ÊÇ¡¡½èÍý
      *****************************************************************
       4109-BC07-SYORI-SEC             SECTION.
      *
           IF      SPA-K09-RRK-NEXT        =   ZERO
               MOVE    "0008"              TO  SPA-ERRCD
           ELSE
               COMPUTE SPA-K09-RRK-PAGE    =   SPA-K09-RRK-PAGE  +  1
      *
               PERFORM 3101-JYURRK-DBHEN-SEC
      *
               INITIALIZE                  SPA-GMN-TBL
               INITIALIZE                  SPA-NAI-TBL
               MOVE    ZERO                TO  SPA-GMN-MAX2
               MOVE    ZERO                TO  SPA-NAI-MAX2
               IF      SPA-K09GMN-MAX1     >   ZERO
                   MOVE    1                   TO  SPA-K09-DOSELNUM
                   MOVE    SPA-K09GMN-NO(1)    TO  SPA-K09-SELNUM
      *            ¿Ç»¡ÆâÍÆÊÔ½¸
                   PERFORM 4101-JYURRK-HEN-SEC
               ELSE
                   MOVE    10              TO  SPA-K09GMN-CUR
               END-IF
           END-IF
      *
           .
       4109-BC07-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    À¾ÎñÏÂÎñÊÔ½¸½èÍý
      *****************************************************************
       520-SEIWA-HEN-SEC             SECTION.
      *
           IF      WRK-SYMD            =   ALL "9"  OR   SPACE
               MOVE    SPACE               TO  WRK-HGO
               MOVE    WRK-SYMD(3:2)       TO  WRK-HYY
               MOVE    WRK-SYMD(5:2)       TO  WRK-HMM
               MOVE    WRK-SYMD(7:2)       TO  WRK-HDD
               MOVE    WRK-HENYMD          TO  WRK-HENYMDG
           ELSE
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY2-AREA
               MOVE    "21"                TO  LNK-DAY2-IRAI
               MOVE    WRK-SYMD            TO  LNK-DAY2-YMD
               CALL    "ORCSDAY"            USING   STS-AREA-DAY
                                                   LNK-DAY2-AREA
               MOVE    LNK-DAY2-EDTYMD1    TO  WRK-HENYMDG
           END-IF
           .
       520-SEIWA-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼«²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-SET-SCREEN              SECTION.
      *
           PERFORM 500-GMNHEN-SEC
      *
           IF      SPA-ERRCD       NOT =   SPACE
               PERFORM 510-ERRSET-SEC
               GO      TO      500-SET-SCREEN-EXT
           END-IF
      *
           MOVE    "CURRENT"           TO  MCP-PUTTYPE.
           MOVE    "K09"               TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
           .
       500-SET-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-GMNHEN-SEC                  SECTION.
      *
           IF      FLG-GMN-INIT1       =   1
               MOVE    ZERO            TO  WRK-K09-RRKLIST-ROW
               MOVE    ZERO            TO  WRK-K09-MEILIST-ROW
           ELSE
               MOVE    K09-RRKLIST-ROW     TO  WRK-K09-RRKLIST-ROW
               IF      FLG-GMN-INIT2       =   1
                   MOVE    ZERO            TO  WRK-K09-MEILIST-ROW
               ELSE
                   MOVE    K09-MEILIST-ROW TO  WRK-K09-MEILIST-ROW
               END-IF
           END-IF
      *
           MOVE    SPACE               TO  K09
      *
      *    ¥³¥é¥à¥ê¥¹¥È¤Î°ÌÃÖ»ØÄê
           MOVE    ZERO                TO  K09-RRKLIST-ROW
           MOVE    ZERO                TO  K09-RRKLIST-ROWATTR
           MOVE    ZERO                TO  K09-MEILIST-ROW
           MOVE    ZERO                TO  K09-MEILIST-ROWATTR
           IF      WRK-K09-RRKLIST-ROW NOT =   ZERO
               MOVE    WRK-K09-RRKLIST-ROW TO  K09-RRKLIST-ROW
           END-IF
           IF      WRK-K09-MEILIST-ROW NOT =   ZERO
               MOVE    WRK-K09-MEILIST-ROW TO  K09-MEILIST-ROW
           END-IF
      *
           PERFORM   VARYING   IDX     FROM    1   BY  1
                     UNTIL     IDX         >   SPA-K09-NYUGAIKBN-MAX
               MOVE    SPA-K09-NYUGAIKBN-LST (IDX)
                                           TO  K09-NYUGAIKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-K09-NYUGAIKBN-MAX   TO  K09-NYUGAIKBN-COUNT
           MOVE    SPA-K09-NYUGAIKBN-G TO  K09-NYUGAIKBN
      *
           PERFORM   VARYING   IDX     FROM    1   BY  1
                     UNTIL     IDX         >   SPA-K09-SRYKBN-MAX
               MOVE    SPA-K09-SRYKBN-LST (IDX)
                                           TO  K09-SRYKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-K09-SRYKBN-MAX  TO  K09-SRYKBN-COUNT
           MOVE    SPA-K09-SRYKBN-G    TO  K09-SRYKBN
      *
           PERFORM   VARYING   IDX     FROM    1   BY  1
                     UNTIL     IDX         >   SPA-K09GMN-MAX1
               MOVE    SPA-K09GMN-NO  (IDX)    TO  WRK-ZZZ
               MOVE    WRK-ZZZ                 TO  K09-NO  (IDX)
               MOVE    SPA-K09GMN-RRKYMD (IDX) TO  K09-RRKYMD(IDX)
               MOVE    SPA-K09GMN-RRKSRYKA (IDX)
                                               TO  K09-RRKSRYKA(IDX)
               MOVE    SPA-K09GMN-RRKHKNCOMBI(IDX)
                                               TO  K09-RRKHKNCOMBI
                                                               (IDX)
               IF      SPA-K09GMN-NO (IDX)     =   SPA-K09-SELNUM
                   MOVE    "T"             TO  K09-RRKLIST-SELECT (IDX)
      *DDD         ½é´üÉ½¼¨¤ÇÁªÂò¤¬¤¢¤ë¾ì¹ç¡¢ÁªÂò¹Ô¤òÃæ±û¤Ø
      *DDD         IF      FLG-GMN-INIT1   =   1
                       MOVE    IDX             TO  K09-RRKLIST-ROW
                       MOVE    2               TO  K09-RRKLIST-ROWATTR
      *DDDDD       END-IF
               ELSE
                   MOVE    "F"             TO  K09-RRKLIST-SELECT (IDX)
               END-IF
           END-PERFORM
           MOVE    SPA-K09GMN-MAX1     TO  K09-RRKLIST-COUNT
      *
           PERFORM   VARYING   IDX     FROM    1   BY  1
                     UNTIL     IDX         >   SPA-GMN-MAX2
               MOVE    "F"             TO  K09-MEILIST-SELECT  (IDX)
               IF      SPA-GMN-TMEISYO(IDX)(1:1)   =   "-"
                   MOVE    ALL "-"             TO  K09-MNO (IDX)
                   MOVE    ALL "¡Ý"            TO  K09-MEISAI (IDX)
               ELSE
                   IF      SPA-GMN-TBANGO (IDX)    NOT =   ZERO
                       MOVE    SPA-GMN-TBANGO (IDX)    TO  WRK-ZZ
                       MOVE    WRK-ZZ                  TO  K09-MNO (IDX)
                       PERFORM VARYING   IDX2  FROM    1   BY  1
                               UNTIL     IDX2  >   SPA-NAI-DOSEL-MAX
                           IF      SPA-NAI-DOSEL (IDX2) 
                                               =   SPA-GMN-TBANGO (IDX)
                               MOVE    "T"     TO  K09-MEILIST-SELECT
                                                                 (IDX)
                               MOVE    SPA-NAI-DOSEL-MAX  TO  IDX2
                           END-IF
                       END-PERFORM
                   END-IF
                   MOVE    SPA-GMN-TMEISYO (IDX)   TO  K09-MEISAI (IDX)
               END-IF
           END-PERFORM
           MOVE    SPA-GMN-MAX2        TO  K09-MEILIST-COUNT
      *
           MOVE    SPA-K09-SELNUM      TO  K09-SELNUM
      *
           MOVE    SPA-GMN-DOSEL       TO  K09-DOSEL
      *
           PERFORM 5001-MAPCUR-SEC
           .
       500-GMNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ¥«¡¼¥½¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       5001-MAPCUR-SEC             SECTION.
      *
           EVALUATE    SPA-K09GMN-CUR
               WHEN    01
                   MOVE    "SELNUM"          TO  MCP-WIDGET
               WHEN    02
                   MOVE    "DOSEL"           TO  MCP-WIDGET
               WHEN    10
                   MOVE    "NYUGAIKBN"       TO  MCP-WIDGET
               WHEN    11
                   MOVE    "SRYKBN"          TO  MCP-WIDGET
           END-EVALUATE
      *
           .
       5001-MAPCUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸É½¼¨Íý
      *****************************************************************
       510-ERRSET-SEC              SECTION.
           MOVE    SPACE               TO  SPA-ERRMSG
      *
           EVALUATE    SPA-ERRCD
               WHEN    "0001"
                   MOVE    "¿ÇÎÅÆüÁªÂòÆþÎÏ¥¨¥é¡¼"
                                       TO  SPA-ERRMSG
               WHEN    "0002"
                   MOVE    "ÈÖ¹æÁªÂòÆþÎÏ¥¨¥é¡¼"
                                       TO  SPA-ERRMSG
               WHEN    "0003"
                   MOVE    "¡ö¤Ï£±Ê¸»ú¤À¤±¤Ç¤¹"
                                       TO  SPA-ERRMSG
               WHEN    "0004"
                   MOVE    "²ó¿ôÊÑ¹¹¤ÏÅêÌô¤Î¤ß²ÄÇ½¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
                   MOVE    "ÅêÌô°Ê³°¤Ë²ó¿ôÊÑ¹¹¤¬¤¢¤ê¤Þ¤¹¡£"
                                       TO  SPA-ERRMSG(29:)
               WHEN    "0005"
                   MOVE    "Æþ³°¶èÊ¬¤¬¤¢¤ê¤Þ¤»¤ó¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0006"
                   MOVE    "¿ÇÎÅ¶èÊ¬¤¬¤¢¤ê¤Þ¤»¤ó¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0007"
                   MOVE    "ÁªÂò¤Ï£±£°£°¹Ô¤Þ¤Ç¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0008"
                   MOVE    "¼¡¥Ú¡¼¥¸¤Ï¤¢¤ê¤Þ¤»¤ó¡£"
                                       TO  SPA-ERRMSG
           END-EVALUATE
      *
           MOVE    SPACE               TO  KERR
           MOVE    SPA-ERRCD           TO  KERR-ERRCODE
           MOVE    SPA-ERRMSG          TO  KERR-ERRMSG
           MOVE    "B01"               TO  MCP-WIDGET
      *
           MOVE    "K09"               TO  SPA-MOTOPG
           MOVE    "KERR"              TO  SPA-SAKIPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE.
           MOVE    "KERR"              TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
      *
      *
           .
       510-ERRSET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       910-TENSU-READ-SEC         SECTION.
      *
           MOVE    SPA-K09NAI-RRKYMD(SPA-K09-DOSELNUM)
                                       TO  TNS-YUKOSTYMD
           MOVE    SPA-K09NAI-RRKYMD(SPA-K09-DOSELNUM)
                                       TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
                   MOVE    ZERO                TO  FLG-TENSU
               ELSE
                   INITIALIZE                  TNS-TENSU-REC
                   MOVE    1                   TO  FLG-TENSU
               END-IF
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1                   TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *!
      *    ¸¡ººÀµ¼°Ì¾¾Î
           IF      SPA-FORMALFLG       =   "1"
               IF     (TNS-SRYCD(1:1)      =   "1") AND
                      (TNS-SRYKBN          =   "60")  AND
                      (TNS-FORMALNAME  NOT =   SPACE )  AND
                      (TNS-FORMALNAME  NOT =   TNS-NAME )
                   MOVE    TNS-FORMALNAME  TO  TNS-NAME
               END-IF
           END-IF
      *
           .
       910-TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       930-SRYACT-READ-SEC         SECTION.
      *
           MOVE    "tbl_sryact"        TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       930-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¥Þ¥¹¥¿¡¼ÆÉ¹þ¡Ê¼ç¥­¡¼¡Ë
      *****************************************************************
       940-SRYACCT-READ-SEC           SECTION.
      *
           MOVE    SRYACCT-REC         TO  MCPDATA-REC
           MOVE    "tbl_sryacct"       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_sryacct"       TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  SRYACCT-REC
                   MOVE    ZERO                TO  FLG-SRYACCT
               ELSE
                   MOVE    1                   TO  FLG-SRYACCT
                   INITIALIZE                  SRYACCT-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-SRYACCT
               INITIALIZE                  SRYACCT-REC
           END-IF
      *
           MOVE    "tbl_sryacct"       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       940-SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼Ô¥³¥á¥ó¥È¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß
      *****************************************************************
       950-PTCOM-READ-SEC           SECTION.
      *
           MOVE    PTCOM-REC           TO  MCPDATA-REC
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptcom"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  PTCOM-REC
                   MOVE    ZERO                TO  FLG-PTCOM
               ELSE
                   MOVE    1                   TO  FLG-PTCOM
                   INITIALIZE                  PTCOM-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTCOM
               INITIALIZE                  PTCOM-REC
           END-IF
      *
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       950-PTCOM-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       970-JYURRK-READ-SEC         SECTION.
      *
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  JYURRK-REC
               MOVE    ZERO            TO  FLG-JYURRK
           ELSE
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
      *
           .
       970-JYURRK-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¥Ñ¥é¥á¥¿¥Ç¡¼¥¿½çÆÉ¤ß
      *****************************************************************
       980-PARA-READ-SEC         SECTION.
      *
           READ    PARA-FILE 
               AT  END
                   MOVE    1           TO  FLG-PARA
               NOT AT  END
                   MOVE    ZERO        TO  FLG-PARA
           END-READ
      *
           .
       980-PARA-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Ñ¥é¥á¥¿¥Ç¡¼¥¿½çÆÉ¤ß
      *****************************************************************
      *990-PARA-NEXT-SEC           SECTION.
      *
      *    READ    PARA-FILE       NEXT
      *        AT  END
      *            MOVE    1           TO  FLG-PARA
      *        NOT AT  END
      *            MOVE    ZERO        TO  FLG-PARA
      *    END-READ
      *
      *    .
      *990-PARA-NEXT-EXT.
      *    EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¥³¡¼¥É¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       930-INPUTCD-READ-SEC         SECTION.
      *
           MOVE    INPUTCD-REC         TO  MCPDATA-REC
           MOVE    "tbl_inputcd"       TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_inputcd"       TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  INPUTCD-REC
                   MOVE    ZERO                TO  FLG-INPUTCD
               ELSE
                   INITIALIZE                  INPUTCD-REC
                   MOVE    1                   TO  FLG-INPUTCD
               END-IF
           ELSE
               INITIALIZE                  INPUTCD-REC
               MOVE    1                   TO  FLG-INPUTCD
           END-IF
      *
           MOVE    "tbl_inputcd"       TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       930-INPUTCD-NEXT-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â£Ã£Ì£Ï£Ó£Å½èÍý
      *****************************************************************
       990-DBCLOSE-SEC                  SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ð£Õ£Ô¡¡½èÍý
      *****************************************************************
       900-PUT-WINDOW              SECTION.
      *
           MOVE   "PUTWINDOW"       TO  MCP-FUNC.
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       900-PUT-WINDOW-EXT.
           EXIT.
      *
