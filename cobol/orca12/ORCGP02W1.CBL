      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCGP02W1.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ´µ¼ÔÅÐÏ¿
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ´µ¼Ô´ðËÜ¾ðÊó¡Ê£Ð£°£²¡Ë
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  00/12/01    MCC-ÂÀÅÄ      ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  01.00.01    MCC-ÂÀÅÄ     01/04/12  ÊÝ¸±ÈÖ¹æ¥Þ¥¹¥¿³ÎÇ§¤ÎÊýË¡
      *  01.00.02    MCC-ÂÀÅÄ     01/04/16  ÁÈ¹ç¤»ºîÀ®¤Î¥Ñ¥é¥á¡¼¥¿ÊÑ¹¹
      *  01.00.03    MCC-ÂÀÅÄ     01/04/18  À¸Ç¯·îÆüÌ¤ÍèÆü¥Á¥§¥Ã¥¯ÄÉ²Ã
      *  01.00.04    MCC-ÂÀÅÄ     01/05/02  À­ÊÌÉ¬¿ÜÆþÎÏºï½ü
      *  01.00.05    MCC-ÂÀÅÄ     01/05/10  ÊÝ¸±ºï½üÉÔÇ½¤ÎÂÐ±þ/¥¿¥¤¥È¥ë
      *  01.00.06    MCC-ÂÀÅÄ     01/05/10  ÆüÉÕÊÑ´¹¸å¥¼¥íÉ½¼¨ÊÑ¹¹
      *  01.00.07    MCC-ÂÀÅÄ     01/05/16  ¸ºÌÈ»öÍ³Ì¤Â¸ºß»þ¤ÎÂÐ±þ
      *  01.00.08    MCC-ÂÀÅÄ     01/05/23  ´µ¼ÔÈÖ¹æ¹½À®´ÉÍý¤ÎÄÉ²Ã
      *  01.00.09    MCC-ÂÀÅÄ     01/05/23  ¥¹¥ÑÎÎ°èÅ¾Á÷ÄÉ²Ã
      *  01.00.10    MCC-ÂÀÅÄ     01/05/24  HOKENJANAME 
      *  01.00.11    MCC-Â¿¡¹Ç¼   01/06/13  ÅÐÏ¿¸å¡¢¿ÇÎÅ¹Ô°ÙÁ«°Ü¤òÄÉ²Ã
      *  01.00.12    MCC-Â¿¡¹Ç¼   01/07/02  ÆüÉÕ·å¿ôÊÑ¹¹¡¦Ç¯ÎðÄÉ²Ã
      *  01.00.13    MCC-Â¿¡¹Ç¼   02/04/05  Ï«ºÒÊÝ¸±¤ÎÄÉ²Ã
      *  01.00.14    MCC-Â¿¡¹Ç¼   02/05/02  È¾³Ñ¥Á¥§¥Ã¥¯¤ÎÄÉ²Ã
      *  01.00.15    MCC-ÂÀÅÄ     02/05/31  ¥«¥Ê»áÌ¾¸õÊä²èÌÌ¤òÄÉ²Ã
      *  02.00.00    MCC-Â¿¡¹Ç¼   02/06/20  ²èÌÌ¥ì¥¤¥¢¥¦¥ÈÊÑ¹¹¤Ë¤è¤ë½¤Àµ
      *  02.00.01    NACL-Â¿¡¹Ç¼  02/07/31  ¥Ñ¥é¥á¥¿¥Õ¥¡¥¤¥ë¤ò£Ä£Â¤Ø
      *  02.00.02    NACL-Â¿¡¹Ç¼  02/09/09  Ê¿À®£±£´Ç¯£±£°·î²þÀµÂÐ±þ
      *                                     ¼«ÇåÀÕÊÝ¸±¤ÎÄÉ²Ã
      *  02.00.03    NACL-Â¿¡¹Ç¼  02/10/07  Á¥°÷¤ÎÏ·¿ÍÊä½õ¶èÊ¬¤Î½é´üÉ½¼¨½¤Àµ
      *  02.00.04    NACL-Â¿¡¹Ç¼  02/10/31  Á¥°÷ÊÝ¸±Êä½õ¶èÊ¬ÄÉ²Ã
      *  02.00.05    NACL-Â¿¡¹Ç¼  02/11/06  ÊÝ¸±¡¦¸øÈñ¤Î³ÎÇ§Æü½¤Àµ
      *  02.00.06    NACL-Â¿¡¹Ç¼  02/11/14  Á¥°÷ÊÝ¸±¤ÎÊÑ¹¹½é´üÉ½¼¨½¤Àµ
      *  02.00.07    NACL-Â¿¡¹Ç¼  02/11/21  ¶¦ºÑ²¼Á¥£³·îÄÉ²Ã
      *  02.00.08    NACL-Â¿¡¹Ç¼  03/03/24  £È£±£µÇ¯£´·î²þÀµÂÐ±þÄÉ²Ã
      *                                     ¸øÈñÉéÃ´³ÛÄÉ²Ã
      *  02.00.09    NACL-Â¿¡¹Ç¼  03/07/08  ÊÝ¸±¼Ô°ÛÆ°Æü¥Á¥§¥Ã¥¯ÄÉ²Ã
      *  02.00.10    NACL-Â¿¡¹Ç¼  03/08/28  ¸øÈñÉéÃ´³Û¤Ë¡Ç£°£±£²¡Ç¤È
      *                                     ¡Ç£°£µ£±¡Ç¤òÄÉ²Ã
      *  02.00.11    NACL-Â¿¡¹Ç¼  03/10/04  ¸øÈñÉéÃ´³Û¤Ë
      *                                     Åìµþ¤ÎÆÃÄê¼À´µ¸øÈñÄÉ²Ã
      *  02.00.12    NACL-Â¿¡¹Ç¼  03/10/09  ¸øÈñÉéÃ´³Û¤ËÅìµþ¤Î'451'ÄÉ²Ã
      *  02.00.13    NACL-Â¿¡¹Ç¼  03/10/27  ¿ÍÌ¾¼­½ñ»ÈÍÑ¶èÊ¬ÄÉ²Ã
      *                                     ¼«ÈñÊÝ¸±¤Î½é´ü¶èÊ¬ÄÉ²Ã
      *                                     ¥«¥ë¥ÆÈ¯¹Ô½é´ü¶èÊ¬ÄÉ²Ã
      *  02.00.14    NACL-Â¿¡¹Ç¼  04/08/20  ¸øÈñÉéÃ´³Û¤Ë
      *                                     Ê¼¸Ë¤Î£±£¸£¶¸øÈñÄÉ²Ã
      *  02.00.15    NACL-Â¿¡¹Ç¼  05/03/23  Ê¿À®£±£·Ç¯£´·î²þÀµÂÐ±þ
      *                                     ¡Ê¸øÈñÉéÃ´³Û¤Ë'025'ÄÉ²Ã¡Ë
      *  02.00.16    NACL-Â¿¡¹Ç¼  05/10/07  ¥æ¡¼¥¶¥×¥í¥°¥é¥àµ¯Æ°ÄÉ²Ã
      *  02.00.17    NACL-Â¿¡¹Ç¼  05/10/19  ÆÃÊÌÎÅÍÜÈñÄÉ²Ã
      *  02.00.18    NACL-Â¿¡¹Ç¼  05/10/20  ¸øÈñºï½ü½¤Àµ
      *  02.00.19    NACL-Â¿¡¹Ç¼  05/11/14  MONFUNC ÂÐ±þ Â¾
      *  02.00.20    NACL-Â¿¡¹Ç¼  06/05/18  ÀÁµá½ñÈ¯¹Ô¶èÊ¬ÄÉ²Ã
      *  02.00.21    NACL-Â¿¡¹Ç¼  06/05/19  Âà¿¦¹ñÊÝ¡¦Ï·¿Í¸øÈñ¥Á¥§¥Ã¥¯ÄÉ²Ã
      *  03.00.01    NACL-Â¿¡¹Ç¼  06/08/25  Ê¿À®£±£¸Ç¯£±£°·î²þÀµÂÐ±þ
      *                                     ¡ÊÏ·¿Í³ä¹çÊÑ¹¹¡Ë
      *  03.03.00    NACL-Â¿¡¹Ç¼  06/10/17  ¸ºÌÈ³ä¹ç¡¦¶â³ÛÄÉ²Ã
      *  03.04.00    NACL-Â¿¡¹Ç¼  06/11/14  ¹â³Û°ÑÇ¤Ê§¤¤ÄÉ²Ã
      *  03.04.01    NACL-Â¿¡¹Ç¼  07/02/16  £Ñ£Ò¼õÉÕÂÐ±þ
      *  03.05.00    NACL-Â¿¡¹Ç¼  07/05/XX  ¥°¥ë¡¼¥×¿ÇÎÅÂÐ±þ
      *  03.05.00    NACL-Â¿¡¹Ç¼  07/06/12  ÊÝ¸±Ê£¼Ìµ¡Ç½ÄÉ²Ã
      *  03.05.01    NACL-Â¿¡¹Ç¼  07/08/28  ¸øÈñ´ü¸ÂÀÚ¤ì¶èÊ¬ÄÉ²Ã
      *  04.01.00    NACL-Â¿¡¹Ç¼  07/11/XX  ¸ø³²ÊÝ¸±ÂÐ±þ
      *  04.00.00    NACL-Â¿¡¹Ç¼  08/01/25  ¸øÈñÉéÃ´³Û¤Ë·ë³ËÆþ½ê'011'ÄÉ²Ã
      *  04.02.00    NACL-Â¿¡¹Ç¼  08/03/XX  Ê¿À®£²£°Ç¯£´·î²þÀµÂÐ±þ
      *  04.03.00    NACL-Â¿¡¹Ç¼  08/10/03  ¸øÈñÉéÃ´³Û¤ËËÌ³¤Æ»¤Î'183'ÄÉ²Ã
      *  04.04.00    NACL-Â¿¡¹Ç¼  08/12/03  ½»½ê¤«¤éÍ¹ÊØÈÖ¹æÀßÄêÄÉ²Ã
      *  04.05.00    NACL-Â¿¡¹Ç¼  09/08/11  Âà¿¦¹ñÊÝÇ¯Îð¥Á¥§¥Ã¥¯ÄÉ²Ã
      *                                     ¹ñÊÝÅù£·£°ºÐÅþÃ£·Ù¹ðÄÉ²Ã
      *  04.05.00    NACL-Â¿¡¹Ç¼  09/09/08  ¸øÈñÉéÃ´³Û¤Ë°¦ÃÎ¸©¤Î'191'ÄÉ²Ã
      *  04.05.00    NACL-Â¿¡¹Ç¼  09/11/20  Í¹ÊØÈÖ¹æ¼«Æ°µ­ºÜ¶èÊ¬ÄÉ²Ã
      *                                     ÅÔÆ»ÉÜ¸©Ì¾µ­ºÜ¤Ê¤·ÂÐ±þ
      * 04.06.00     NACL-Â¿¡¹Ç¼  10/06/30  ËÜ¿Í²ÈÂ²¶èÊ¬¡¢Êä½õ¶èÊ¬ÊÑ¹¹ÂÐ±þ
      * 04.06.00     NACL-Â¿¡¹Ç¼  11/02/10  µþÅÔÉÜÄÌ¤êÌ¾¾ÎÊÔ½¸ÂÐ±þ
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *    ¥Ñ¥é¥á¥¿¥Ç¡¼¥¿
      *    SELECT  PARA-FILE       ASSIGN  FILE-NAME1
      *                            ORGANIZATION    IS  INDEXED
      *                            ACCESS  MODE    IS  DYNAMIC
      *                            RECORD  KEY     IS  PAR-KEY
      *                            FILE    STATUS  IS  STS-PARA.
      *
       DATA                    DIVISION.
      *FILE                        SECTION.
      *
      *    ¥Ñ¥é¥á¥¿¥Ç¡¼¥¿
      *FD  PARA-FILE.
      *01  PARA-REC.
      *    03  PAR-KEY.
      *        05  PAR-FILEMEI         PIC X(08).
      *        05  PAR-EDANUM          PIC 9(04).
      *    03  PAR-DATA-REC            PIC X(3000).
      *
       WORKING-STORAGE             SECTION.
      *    ¥Ñ¥é¥á¥¿¥Õ¥¡¥¤¥ëÌ¾
      *01  FILE-NAME1.
      *    03  FILLER              PIC X(09)   VALUE   "/var/tmp/".
      *    03  FILLER              PIC X(07)   VALUE   "P01PARA".
      *    03  FILE-TERMID1        PIC X(64)   VALUE   SPACE.
      *
      *    ²èÌÌÈóÉ½¼¨
           COPY    "ENUM-VALUE".
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *    ´µ¼ÔÅÐÏ¿¥¹¥ÑÎÎ°è
           COPY    "P02COMMON-SPA".
      **    ´µ¼Ô²èÌÌ¥¹¥ÑÎÎ°è
           COPY    "P02SCR-SPA".
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  STS-AREA.
           03  STS-PARA            PIC X(02).
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-END             PIC 9(01).
           03  FLG-PTINF           PIC 9(01).
           03  FLG-HKNNUM          PIC 9(01).
           03  FLG-PARA            PIC 9(01).
           03  FLG-UKETUKE         PIC 9(01).
           03  FLG-LNKPARA         PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
           03  FLG-PTRSIINF        PIC 9(01).
           03  FLG-HKNCOMBI        PIC 9(01).
           03  FLG-HKNJAINF        PIC 9(01).
           03  FLG-ADRS            PIC 9(01).
      *
      *    ÆþÎÏ¤ÎÍ­Ìµ
           03  FLG-IN-KANANAME        PIC 9(01).
           03  FLG-IN-NAME            PIC 9(01).
           03  FLG-IN-SEX             PIC 9(01).
           03  FLG-IN-BIRTHDAY        PIC 9(01).
           03  FLG-IN-POST            PIC 9(01).
           03  FLG-IN-DISCOUNTKBN     PIC 9(01).
      *    Æó½ÅÅÐÏ¿µ¿¤¤ÍÑ
           03  FLG-P02A-SYORI         PIC 9(01).
           03  FLG-CHK                PIC 9(01).
           03  FLG-ERR                PIC 9(01).
           03  FLG-OK                 PIC 9(01).
      *    ÅÐÏ¿¥Õ¥é¥°
           03  FLG-TOUROKU            PIC 9(01).
      *    ÅÐÏ¿¥Õ¥é¥°
           03  FLG-TOUROKU2           PIC 9(01).
      *
      *    ÊÝ¸±ÆþÎÏ
           03  FLG-IN-HKN             PIC 9(01).
      *    ÊÝ¸±ºï½ü
           03  FLG-HKN-DEL            PIC 9(01).
      *    ¸øÈñºï½ü
           03  FLG-KOH-DEL            PIC 9(01).
      *    ¸øÈñÄÉ²Ã
           03  FLG-KOH-ADD            PIC 9(01).
      *    ¸øÈñÄÉ²Ã
           03  FLG-KOH-ADD2           PIC 9(01).
      *
      *----(01.00.01) LINE ADD START ---------------------------------
           03  FLG-RJN             PIC 9(01).
      *----(01.00.15) LINE ADD START ---------------------------------
           03  FLG-JINMEI          PIC 9(01).
      *    ¥«¥Ê»áÌ¾¸¡º÷ÍÑ¥Õ¥é¥°
      *    0:ÂÐ¾Ý£±·ï/1:ÂÐ¾Ý¤Ê¤·/2:Ê£¿ô·ï³ºÅö
           03  FLG-NAME            PIC 9(01)   OCCURS 2.
      *----(01.00.15) LINE ADD END   ---------------------------------
      *
           03  FLG-RJNCHK          PIC 9(01).
           03  FLG-HKNCHK          PIC 9(01).
           03  FLG-HKNCHK2         PIC 9(01).
           03  FLG-SEIHOGO         PIC 9(01).
           03  FLG-HKNCHK3         PIC 9(01).
      *
           03  FLG-P02A-CHK       PIC 9(01).
      *    ¸øÈñÃ±ÆÈ¥Á¥§¥Ã¥¯
           03  FLG-KOHCHK         PIC 9(01).
      *
      *    ½ÅÊ£¥¨¥é¡¼¤Ê¤·
           03  FLG-ERRCHK         PIC 9(01).
      *    £È£±£¸¡¥£±£°²þÀµÂÐ±þ
           03  FLG-RJNCHK2             PIC 9(01).
           03  FLG-RJNCHK3             PIC 9(01).
           03  FLG-RJNERR              PIC 9(01).
           03  FLG-KOKUHO              PIC 9(01).
           03  FLG-RJNKOHERR           PIC 9(01).
           03  FLG-KOH27               PIC 9(01).
      *
           03  FLG-KANA                PIC 9(01).
           03  FLG-HKN-ADD2            PIC 9(01).
           03  FLG-27KOH-OK            PIC 9(01).
      *    ¹âÎð¼ÔÈó³ºÅö¡ÊH22.9)
           03  FLG-RJNCHK4             PIC 9(01).
      *    API½èÍý
           03  FLG-APICHK              PIC 9(01).
      *
      *    ¥«¥¦¥ó¥ÈÎÎ°è
       01  CNT-AREA.
           03  CNT-ERR             PIC 9(06).
      *----(01.00.15) LINE ADD START ---------------------------------
           03  CNT-JINMEI          PIC 9(06).
           03  CNT-KANANAME        PIC 9(06).
      *----(01.00.15) LINE ADD END   ---------------------------------
      *
      *    ¥·¥¹¥Æ¥àÎÎ°è
       01  SYS-AREA.
           03  SYS-YMD.
               05  SYS-YY          PIC 9(02).
               05  SYS-MM          PIC 9(02).
               05  SYS-DD          PIC 9(02).
           03  SYS-TIME.
               05  SYS-THH         PIC 9(02).
               05  SYS-TMM         PIC 9(02).
               05  SYS-TSS         PIC 9(02).
               05  SYS-TDD         PIC 9(02).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX                 PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDZ                 PIC 9(04).
           03  IDA                 PIC 9(04).
      *----(01.00.15) LINE ADD START ---------------------------------
           03  IDX1                PIC 9(05).
      *----(01.00.15) LINE ADD END   ---------------------------------
           03  IDX2                PIC 9(04).
           03  IDX-H               PIC 9(04).
           03  IDXH                PIC 9(04).
      *
           03  IDT                 PIC 9(04).
      *
           03  IDX-R               PIC 9(04).
           03  IDX-R2              PIC 9(04).
      *
           03  IDX-K               PIC 9(04).
           03  IDX-K2              PIC 9(04).
           03  IDX-KOH             PIC 9(04).
      *
           03  IDXK                PIC 9(04).
           03  IDX5                PIC 9(04).
      *
           03  IDX-API             PIC 9(04).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-SYMD.
               05  WRK-SYY         PIC 9(04).
               05  WRK-SMM         PIC 9(02).
               05  WRK-SDD         PIC 9(02).
           03  WRK-SYMD6           PIC 9(08).
           03  WRK-WYMD.
               05  WRK-WGO         PIC X(01).
               05  WRK-WYY         PIC 9(02).
               05  WRK-WMM         PIC 9(02).
               05  WRK-WDD         PIC 9(02).
           03  WRK-SAKIPG          PIC X(08).
           03  WRK-RENNUMZ         PIC ZZZZ.
      *    ´ð½àÆü
           03  WRK-BASEYMD.
               05  WRK-BYY         PIC 9(04).
               05  WRK-BMM         PIC 9(02).
               05  WRK-BDD         PIC 9(02).
      *    ÊÝÂ¸Ç¯Îð
           03  WRK-MAE-NENREI.
               05  WRK-MAE-NENREI-YY       PIC 9(03).
               05  WRK-MAE-NENREI-MM       PIC 9(02).
      *    ÆþÎÏ¹àÌÜÌ¾
      *****03  WRK-MCP-WIDGET          PIC X(64).
      *    ÊÝ¸±³«»Ï°ÌÃÖ
           03  WRK-HKNSTR              PIC 9(04).
      *    ¸øÈñ³«»Ï°ÌÃÖ
           03  WRK-KOHSTR              PIC 9(04).
      *
           03  WRK-SELNUM              PIC X(04).
           03  WRK-GMN-SELNUM          PIC 9(04).
      *
           03  WRK-HKNCOMBI        PIC X(100).
           03  WRK-HKNKBN-MEI      PIC X(02).
      *
           03  WRK-NAIBU-IDX-AREA.
               05  WRK-G-IDX       PIC 9(04).
               05  WRK-N-IDX       PIC 9(04).
      *        1:ÊÝ¸±¥Æ¡¼¥Ö¥ë /2:¸øÈñ¥Æ¡¼¥Ö¥ë
               05  WRK-W-TBL       PIC 9(01).
      *
           03  WRK-KENSAKU-AREA.
               05  WRK-KEN-HKNNUM      PIC X(03).
      *----(01.00.01) LINE MOD START ---------------------------------
      *         05  WRK-KEN-TEKYMD      PIC X(08).
               05  WRK-KEN-TEKSTYMD    PIC X(08).
               05  WRK-KEN-TEKEDYMD    PIC X(08).
      *----(01.00.01) LINE MOD END   ---------------------------------
               05  WRK-KEN-ERFLG       PIC X(01).
               05  WRK-KEN-SBTKBN      PIC X(01).
      *
           03  WRK-PARACNT-AREA.
               05  WRK-PCNT-HKN        PIC 9(04).
               05  WRK-PCNT-KOH        PIC 9(04).
      *
           03  WRK-SYSKAN-AREA.
               05  WRK-SYSKAN-KANRICD  PIC X(04).
               05  WRK-SYSKAN-KBNCD    PIC X(08).
               05  WRK-SYSKAN-STYUKYMD PIC X(08).
               05  WRK-SYSKAN-EDYUKYMD PIC X(08).
      *
           03  WRK-HKNKOH-FLG          PIC 9(01).
      *
           03  WRK-MEISAI1             PIC 9(06).
           03  WRK-MEISAI2             PIC 9(06).
           03  WRK-MEISAI3             PIC 9(06).
           03  WRK-HST                 PIC 9(04).
           03  WRK-HED                 PIC 9(04).
           03  WRK-KST                 PIC 9(04).
           03  WRK-KED                 PIC 9(04).
           03  WRK-DISCOUNT            PIC Z9.
           03  WRK-KYUSEI              PIC 9(01).
           03  WRK-RATEKBN             PIC X(02).
           03  WRK-KBNCD               PIC X(02).
           03  WRK-OK                  PIC 9(01).
      *----(01.00.06) LINE MOD START ---------------------------------
           03  WRK-WWYMD               PIC X(10).
      *----(01.00.06) LINE MOD END   ---------------------------------
      *
      *    Ï«ºÒÊÝ¸±£É£Ä
           03  WRK-PTRSI-HKNID         PIC 9(10).
      *
      *----(01.00.15) LINE ADD START ---------------------------------
           03  WRK-NAME-AREA.
               05  WRK-NAME-X-AREA.
                   07  WRK-NAME-X  PIC X(02)   OCCURS 25.
               05  WRK-NAME-VAL    PIC X(50)   OCCURS  3.
               05  WRK-NAME-KANJI  PIC X(50)   OCCURS  2.
               05  WRK-NAME-KANA   PIC X(50)   OCCURS  2.
               05  WRK-KANJINAME-AREA.
                   07  WRK-KANJINAME-OCC       OCCURS  50
                                               INDEXED BY  IDX-NAME.
                       09  WRK-KANJINAME-T
                                   PIC X(50).
               05  WRK-KANJINAME   PIC X(50).
      *----(01.00.15) LINE ADD END   ---------------------------------
      *
      *    ÊÝ¸±¸øÈñ¼ïÊÌ
           03  WRK-HKNNUM              PIC X(03).
           03  WRK-PAYKBN              PIC X(02).
           03  WRK-HKNKOHSBTKBN        PIC X(01).
           03  WRK-TANSEIDONAME        PIC X(20).
           03  WRK-TEKSTYMD            PIC X(08).
           03  WRK-TEKEDYMD            PIC X(08).
      *
           03  WRK-NAI-HKNSTR       PIC 9(04).
           03  WRK-NAI-KOHSTR       PIC 9(04).
      *
      *    É½¼¨ÍÑÊÝ¸±
           03  WRK-IDXH                PIC 9(04).
           03  WRK-CNT-HKN             PIC 9(04).
           03  WRK-CNT-HKN2            PIC 9(04).
      *    ÉÂ±¡¼ïÊÌ
           03  WRK-HOSPSBT             PIC 9(01).
      *    Ï·¿Í»ÙÊ§¶èÊ¬
           03  WRK-ROUPAYKBN           PIC X(01).
      *
      *    Á´³Ñ¥Á¥§¥Ã¥¯·å¿ô
           03  WRK-LEN                 PIC 9(04).
      *
           03  WRK-EDANUM              PIC 9(04).
      *
      *!!!!
      *    £·£°ºÐ¥Á¥§¥Ã¥¯
           03  FLG-KOKUHO-CHK          PIC 9(01).
           03  WRK-KOKUHO-CHK          PIC 9(04).
      *!!!!
      *
      *    ¸øÈñ£Ó£Ï£Ò£ÔÍÑ¡Ê£Ó£Ð£Á¤ÈÆ±¤¸ÎÎ°è¡Ë
       01  WRK-KOUHI-AREA.
      *    ¸øÈñ¾ðÊó
           03  WRK-GMN-KOH-AREA.
               05  WRK-GMN-KOH-TBL         OCCURS   3.
                   07  WRK-GMN-HOK-G.
                       09  WRK-GMN-KOHNUM-G.
                          11  WRK-GMN-KOHNUM      PIC X(03).
                          11  WRK-GMN-KOHKBN      PIC X(01).
      ****************    11  WRK-GMN-H1          PIC X(01).
                          11  WRK-GMN-KOHNUMMEI   PIC X(16).
      *
                       09  WRK-GMN-KTEKSTYMD        PIC X(10).
                       09  WRK-GMN-KTEKEDYMD        PIC X(10).
                       09  WRK-GMN-KKAKUNINYMD      PIC X(10).
                       09  WRK-GMN-FTNJANUM         PIC X(08).
                       09  WRK-GMN-JKYSNUM          PIC X(20).
      *
                   07  WRK-NAI-KTEKSTYMD        PIC X(08).
                   07  WRK-NAI-KTEKEDYMD        PIC X(08).
                   07  WRK-NAI-KKAKUNINYMD      PIC X(08).
      *            ´ü¸ÂÀÚ¤ì¶èÊ¬
                   07  WRK-NAI-TEKEDCHKKBN      PIC X(01).
      *
                   07  WRK-NAI-PTKOH-EDANUM       PIC 9(04).
                   07  WRK-NAI-PTKOH-KOHID        PIC 9(10).
                   07  WRK-NAI-PTKOH-SBTKBN       PIC X(01).
                   07  WRK-NAI-PTKOH-PAYKBN       PIC X(02).
      *
      *                ÅÐÏ¿»þ¤ÎÉéÃ´¼ÔÈÖ¹æ¡¦¸øÈñ¼ïÎà
                   07  WRK-MAE-KOHNUM-G.
                       09  WRK-MAE-KOHNUM      PIC X(03).
                       09  WRK-MAE-KOHKBN      PIC X(01).
      **************** 09  WRK-MAE-H1          PIC X(01).
                       09  WRK-MAE-KOHNUMMEI   PIC X(16).
                   07  WRK-MAE-FTNJANUM            PIC X(08).
                   07  WRK-MAE-KKAKUNINYMD         PIC X(08).
                   07  WRK-MAE-KKAKUNINYMDW        PIC X(09).
      *            £¶£µºÐ°Ê¾å·Ù¹ð
                   07  WRK-NAI-AGE65               PIC 9(01).
      *            Ç¯Îð·Ù¹ð
                   07  WRK-NAI-AGECHK              PIC 9(01).
      *            ÉéÃ´¼ÔÈÖ¹æ·Ù¹ð
                   07  WRK-NAI-FTNCHK              PIC 9(01).
      *            ÊÝ¸±¼Ô°ÛÆ°Æü·Ù¹ð
                   07  WRK-PTKOH-IDOYMD            PIC X(08).
                   07  WRK-NAI-PTKOH-KEIFLG        PIC X(01).
      *            ¼õµë¼ÔÈÖ¹æ·Ù¹ð
                   07  WRK-NAI-JYUCHK              PIC 9(01).
      *            ³ÎÇ§Ç¯·îÆü·Ù¹ð
                   07  WRK-KOH-KAKUINFLG        PIC 9(01).
               05  WRK-KOH-MAX             PIC 9(04).
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¡Ê£Ó£Ð£Á¤ÈÆ±¤¸¡Ë
       01  WRK-HKNCOBMI-SORT-AREA.
           03  WRK-HKNCOMBI-AREA.
               05  WRK-GMN-HKNCOMBI-LIST       OCCURS   15.
                       09  WRK-GMN-THKNCOMBINUM    PIC 9(04).
                       09  WRK-GMN-THKNCOMBIMEI    PIC X(40).
                       09  WRK-GMN-TTEKSTYMD       PIC X(09).
                       09  WRK-GMN-TTEKEDYMD       PIC X(09).
                       09  WRK-GMN-THKNNUM         PIC X(03).
                       09  WRK-GMN-THKNID          PIC 9(10).
      *
                       09  WRK-NAI-TTEKSTYMD       PIC X(08).
                       09  WRK-NAI-TTEKEDYMD       PIC X(08).
                       09  WRK-NAI-TKOH1HKNNUM     PIC X(03).
                       09  WRK-NAI-TKOH2HKNNUM     PIC X(03).
                       09  WRK-NAI-TKOH3HKNNUM     PIC X(03).
                       09  WRK-NAI-TKOH4HKNNUM     PIC X(03).
                       09  WRK-NAI-THYOJIKBN       PIC X(01).
               05  WRK-HKNCOMBI-MAX            PIC 9(04).
      *
           03  WRK-SORT-KEY.
               05  WRK-SRT-TEKISTYMD      PIC X(08).
               05  WRK-SRT-HKNCOMBINUM    PIC X(04).
               05  WRK-SRT-IDX            PIC 9(04).
      *
           03  WRK-HKNCOMBI02-AREA.
               05  WRK-GMN-HKNCOMBI02-LIST       OCCURS   15.
                       09  WRK-GMN02-THKNCOMBINUM    PIC 9(04).
                       09  WRK-GMN02-THKNCOMBIMEI    PIC X(40).
                       09  WRK-GMN02-TTEKSTYMD       PIC X(09).
                       09  WRK-GMN02-TTEKEDYMD       PIC X(09).
                       09  WRK-GMN02-THKNNUM         PIC X(03).
                       09  WRK-GMN02-THKNID          PIC 9(10).
      *
                       09  WRK-NAI02-TTEKSTYMD       PIC X(08).
                       09  WRK-NAI02-TTEKEDYMD       PIC X(08).
                       09  WRK-NAI02-TKOH1HKNNUM     PIC X(03).
                       09  WRK-NAI02-TKOH2HKNNUM     PIC X(03).
                       09  WRK-NAI02-TKOH3HKNNUM     PIC X(03).
                       09  WRK-NAI02-TKOH4HKNNUM     PIC X(03).
                       09  WRK-NAI02-THYOJIKBN       PIC X(01).
      *
       01  WRK-HENSYU-AREA.
      *
           03  WRK-HONKA-TBL.
               05  WRK-HONKA-REC-G.
                   07  FILLER          PIC X(06) VALUE "1 ËÜ¿Í".
                   07  FILLER          PIC X(06) VALUE "2 ²ÈÂ²".
               05  WRK-HONKA-REC-R     REDEFINES   WRK-HONKA-REC-G.
                   07  WRK-HONKA-REC   PIC X(06) OCCURS  2.
      *
           03  WRK-HJO-TBL.
               05  WRK-HJO-MAX         PIC 9(04).
               05  WRK-HJO-REC-G1.
                   07  FILLER          PIC X(10) VALUE "1 ¿¦Ì³".
                   07  FILLER          PIC X(10) VALUE "2 ²¼Á¥".
                   07  FILLER          PIC X(10) VALUE "3 ÄÌ¶Ð".
                   07  FILLER          PIC X(10) VALUE "8 £²³ä".
                   07  FILLER          PIC X(10) VALUE "9 £±³ä".
                   07  FILLER          PIC X(10) VALUE "A £±³ä¿¦Ì³".
                   07  FILLER          PIC X(10) VALUE "B £±³ä²¼Á¥".
                   07  FILLER          PIC X(10) VALUE "C £±³äÄÌ¶Ð".
                   07  FILLER          PIC X(10) VALUE "D £²³ä¿¦Ì³".
                   07  FILLER          PIC X(10) VALUE "E £²³ä²¼Á¥".
                   07  FILLER          PIC X(10) VALUE "F £²³äÄÌ¶Ð".
               05  WRK-HJO-REC-R1      REDEFINES   WRK-HJO-REC-G1.
                   07  WRK-HJO-REC1    PIC X(10) OCCURS  11.
               05  WRK-HJO-REC-G2.
                   07  FILLER          PIC X(16) VALUE "0 Ìµ¤·".
                   07  FILLER          PIC X(16) VALUE "1 £±³ä".
                   07  FILLER          PIC X(16) VALUE "2 £²³ä".
                   07  FILLER          PIC X(16) VALUE "3 £³³ä".
                   07  FILLER          PIC X(16) VALUE
                                                 "4 ³°£±³ä Æþ£°³ä".
                   07  FILLER          PIC X(16) VALUE
                                                 "5 ³°£²³ä Æþ£±³ä".
                   07  FILLER          PIC X(16) VALUE
                                                 "6 ³°£³³ä Æþ£²³ä".
               05  WRK-HJO-REC-R2      REDEFINES   WRK-HJO-REC-G2.
                   07  WRK-HJO-REC2    PIC X(16) OCCURS  7.
               05  WRK-HJO-REC-G3.
                   07  FILLER          PIC X(06) VALUE "1 ²ÝÀÇ".
                   07  FILLER          PIC X(06) VALUE "2 Èó²Ý".
               05  WRK-HJO-REC-R3      REDEFINES   WRK-HJO-REC-G3.
                   07  WRK-HJO-REC3    PIC X(06) OCCURS  2.
      *        Ï·¿Í¤ÎÊä½õ¶èÊ¬ÄÉ²Ã
               05  WRK-HJO-REC-G4.
                   07  FILLER          PIC X(06) VALUE "8 £²³ä".
                   07  FILLER          PIC X(06) VALUE "9 £±³ä".
               05  WRK-HJO-REC-R4      REDEFINES   WRK-HJO-REC-G4.
                   07  WRK-HJO-REC4    PIC X(06) OCCURS  2.
      *        ¶¦ºÑ¤Î²¼Á¥¸åÊä½õ¶èÊ¬ÄÉ²Ã
               05  WRK-HJO-REC-G5.
                   07  FILLER          PIC X(10) VALUE "2 ²¼Á¥£³·î".
                   07  FILLER          PIC X(10) VALUE "8 £²³ä".
                   07  FILLER          PIC X(10) VALUE "9 £±³ä".
                   07  FILLER          PIC X(10) VALUE "B £±³ä²¼Á¥".
                   07  FILLER          PIC X(10) VALUE "E £²³ä²¼Á¥".
               05  WRK-HJO-REC-R5      REDEFINES   WRK-HJO-REC-G5.
                   07  WRK-HJO-REC5    PIC X(10) OCCURS  5.
      *        Á¥°÷¡Ê£È£±£¸¡¥£±£°°Ê¹ß¡Ë
               05  WRK-HJO-REC-G1-2.
                   07  FILLER          PIC X(10) VALUE "1 ¿¦Ì³".
                   07  FILLER          PIC X(10) VALUE "2 ²¼Á¥".
                   07  FILLER          PIC X(10) VALUE "3 ÄÌ¶Ð".
                   07  FILLER          PIC X(10) VALUE "7 £³³ä".
                   07  FILLER          PIC X(10) VALUE "9 £±³ä".
                   07  FILLER          PIC X(10) VALUE "A £±³ä¿¦Ì³".
                   07  FILLER          PIC X(10) VALUE "B £±³ä²¼Á¥".
                   07  FILLER          PIC X(10) VALUE "C £±³äÄÌ¶Ð".
                   07  FILLER          PIC X(10) VALUE "G £³³ä¿¦Ì³".
                   07  FILLER          PIC X(10) VALUE "H £³³ä²¼Á¥".
                   07  FILLER          PIC X(10) VALUE "I £³³äÄÌ¶Ð".
               05  WRK-HJO-REC-R1-2    REDEFINES   WRK-HJO-REC-G1-2.
                   07  WRK-HJO-REC1-2  PIC X(10) OCCURS  11.
      *        Ï·¿Í¤ÎÊä½õ¶èÊ¬ÄÉ²Ã¡Ê£È£±£¸¡¥£±£°°Ê¹ß¡Ë
               05  WRK-HJO-REC-G4-2.
                   07  FILLER          PIC X(06) VALUE "7 £³³ä".
                   07  FILLER          PIC X(06) VALUE "9 £±³ä".
               05  WRK-HJO-REC-R4-2    REDEFINES   WRK-HJO-REC-G4-2.
                   07  WRK-HJO-REC4-2  PIC X(06) OCCURS  2.
      *        ¶¦ºÑ¤Î²¼Á¥¸åÊä½õ¶èÊ¬ÄÉ²Ã¡Ê£È£±£¸¡¥£±£°°Ê¹ß¡Ë
               05  WRK-HJO-REC-G5-2.
                   07  FILLER          PIC X(10) VALUE "2 ²¼Á¥£³·î".
                   07  FILLER          PIC X(10) VALUE "7 £³³ä".
                   07  FILLER          PIC X(10) VALUE "9 £±³ä".
                   07  FILLER          PIC X(10) VALUE "B £±³ä²¼Á¥".
                   07  FILLER          PIC X(10) VALUE "H £³³ä²¼Á¥".
               05  WRK-HJO-REC-R5-2      REDEFINES   WRK-HJO-REC-G5-2.
                   07  WRK-HJO-REC5-2    PIC X(10) OCCURS  5.
      *
      *        ¸å´ü¹âÎð¼Ô¤ÎÊä½õ¶èÊ¬¡Ê£È£²£°¡¥£´°Ê¹ß¡Ë
               05  WRK-HJO-REC-G6.
                   07  FILLER          PIC X(10) VALUE "1 £±³ä".
                   07  FILLER          PIC X(10) VALUE "3 £³³ä".
               05  WRK-HJO-REC-R6        REDEFINES   WRK-HJO-REC-G6.
                   07  WRK-HJO-REC6      PIC X(10) OCCURS  2.
      *
           03  WRK-KEI-TBL.
               05  WRK-KEI-REC-G.
                   07  FILLER          PIC X(06) VALUE "1 ·ÑÂ³".
                   07  FILLER          PIC X(06) VALUE "2 Ç¤·Ñ".
                   07  FILLER          PIC X(06) VALUE "3 ÆÃÊÌ".
               05  WRK-KEI-REC-R       REDEFINES   WRK-KEI-REC-G.
                   07  WRK-KEI-REC     PIC X(06) OCCURS  3.
               05  WRK-CONT-MAX        PIC 9(04).
      *
           03  WRK-HENYMD.
               05  WRK-HGO             PIC X(01).
               05  WRK-HYY             PIC Z9.
               05  FILLER              PIC X(01)   VALUE  ".".
               05  WRK-HMM             PIC Z9.
               05  FILLER              PIC X(01)   VALUE  ".".
               05  WRK-HDD             PIC Z9.
      *
           03  WRK-HENTIME.
               05  WRK-THH             PIC 99.
               05  FILLER              PIC X(01)   VALUE  ":".
               05  WRK-TMM             PIC 99.
      *
           03  WRK-KEI1                PIC X(06)   VALUE  "¡Ê·Ñ¡Ë".
           03  WRK-KEI2                PIC X(06)   VALUE  "¡ÊÇ¤¡Ë".
      *
           03  WRK-RATE-AREA.
               05  WRK-RATE-KBN        PIC X(02).
               05  WRK-RATE-SP         PIC X(01).
               05  WRK-RATE-EDIT.
                   07  WRK-RATE-EDITZ  PIC ZZZZZZZ.
                   07  WRK-RATE-TANI   PIC X(04).
               05  WRK-RATE-EDIT-R  REDEFINES    WRK-RATE-EDIT.
                   07  WRK-RATE-EDITR  PIC X(11).
      *
           03  TBL-MAX-KOH             PIC 9(02)  VALUE    60.
           03  TBL-MAX-HKN             PIC 9(02)  VALUE    40.
      *
       01  WRK-NENREI-AREA.
           03  WRK-YMDS1.
               05  WRK-YYS1        PIC 9(04).
               05  WRK-MMS1        PIC 9(02).
               05  WRK-DDS1        PIC 9(02).
           03  WRK-YMDS2.
               05  WRK-YYS2        PIC 9(04).
               05  WRK-MMS2        PIC 9(02).
               05  WRK-DDS2        PIC 9(02).
           03  WRK-NENREI.
               05  WRK-NENREI-YY       PIC 9(04).
               05  WRK-NENREI-MM       PIC 9(02).
               05  WRK-NENREI-DD       PIC 9(02).
      *   Ç¯ÎðÉ½¼¨
       01  WRK-NENREI-G.
           03  WRK-NENREI-Z        PIC ZZ9.
           03  WRK-NENREI-MEI      PIC X(04).
       01  WRK-NENREI-GR           REDEFINES   WRK-NENREI-G.
           03  WRK-NENREI-ZN       PIC Z9.
           03  WRK-NENREI-MEIN     PIC X(08).
      *----(01.00.12) LINE ADD END   ---------------------------------
      *    È¾³ÑÁ´³ÑÊÑ´¹
       01  WRK-HENKAN-AREA.
           03  WRK-MAE-INPUT       PIC X(100).
           03  WRK-ATO-INPUT       PIC X(100).
           03  WRK-MAX             PIC 9(04).
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿
           COPY    "CPSYSKANRI.INC".
      *    ¾õÂÖ¾ðÊó
      *    COPY    "CPSK1018.INC".
      *    ¸ºÌÈ»öÍ³¾ðÊó
      *    COPY    "CPSK1026.INC".
      *    ³ä°úÎ¨¾ðÊó
      *****COPY    "CPSK1027.INC".
      *    ¼þÊÕ½»½ê
           COPY    "CPSK1015.INC".
      *
      *    ½»½ê¥Þ¥¹¥¿
       01  ADRS-REC.
           COPY    "CPADRS.INC".
      *
      *    ÊÝ¸±ÈÖ¹æ¾ðÊó  *
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *
      *    ¼õÉÕ   *
       01  UKETUKE-REC.
           COPY    "CPUKETUKE.INC".
      *
      *    ÊÝ¸±¼Ô¹æ¥Þ¥¹¥¿
       01  HKNJAINF-REC.
           COPY    "CPHKNJAINF.INC".
      *
      *    ´µ¼ÔÊÝ¸±¾ðÊó  *
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *    ÁÈ¹ç¤»ºîÀ®»þ»ÈÍÑ¹àÌÜ
           03  PTHKN-SBT          PIC X(01).
           03  PTHKN-SEIDO        PIC X(10).
      *
      *    ´µ¼Ô¸øÈñ¾ðÊó  *
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *    ÁÈ¹ç¤»ºîÀ®»þ»ÈÍÑ¹àÌÜ
           03  PTKOH-SBT          PIC X(01).
           03  PTKOH-SEIDO        PIC X(10).
           03  PTKOH-HKNKOHKBN    PIC X(01).
           03  PTKOH-GENHKNNUM1   PIC X(03).
           03  PTKOH-GENHKNNUM2   PIC X(03).
           03  PTKOH-GENHKNNUM3   PIC X(03).
      *    ´µ¼Ô¾ðÊó  *
       01  PTINF-REC.
           COPY "CPPTINF.INC".
      *
      *    ´µ¼Ô¾ðÊó  *
      *01  LNK-PTINF-REC.
      *    COPY "CPPTINF.INC" REPLACING  //PTINF-// BY //LNK-PTINF-//.
      *
      *    µìÀ«ÍúÎò   *
      *01  LNK-KYUSEIRRK-AREA.
      *    02  LNK-KYUSEIRRK-REC.
      *    COPY  "CPKYUSEIRRK.INC" REPLACING  //KYUSEI-//
      *                                    BY //LNK-KYU-//.
      *    ´µ¼ÔÈÖ¹æÊÑ´¹  *
      *01  LNK-PTNUM-AREA.
      *    02  LNK-PTNUM-REC.
      *    COPY "CPPTNUM.INC" REPLACING //PTNUM-// BY //LNK-PTNUM-//.
      *
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    ´µ¼ÔÏ«ºÒÊÝ¸±¾ðÊó
       01  PTRSIINF-REC.
           COPY    "CPPTRSIINF.INC".
      *----(01.00.15) LINE ADD START ---------------------------------
      *    ¿ÍÌ¾
       01  JINMEI-REC.
           COPY    "CPJINMEI.INC".
      *----(01.00.15) LINE ADD END   ---------------------------------
      *
      *    ¥Ñ¥é¥á¥¿¥Æ¡¼¥Ö¥ë
       01  PARA-REC.
           COPY    "CPPARA.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    ¿ô»úÊÑ´¹ÎÎ°è
           COPY    "CPORCSNUM.INC".
      *   ´µ¼ÔÈÖ¹æÊÑ´¹¥µ¥Ö
           COPY    "CPORCSPTID.INC".
      *----(01.00.12) LINE ADD START ----------------------------------
      *
      *   ²èÌÌÆüÉÕÊÑ´¹¥µ¥Ö
          COPY    "CPORCSGDAY.INC".
      *----(01.00.12) LINE ADD END   ----------------------------------
      *
      *    Á´³Ñ¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿
           COPY    "CPORCSKANACHK.INC".
      *    Á´³Ñ¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿¡Ê³ÈÄ¥´Á»ú¡Ë
           COPY    "CPORCSKANACHK2.INC".
      *
           COPY    "CPORCXKANACONV.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
      *****COPY    "CPORCMCP.INC".
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
        LINKAGE                     SECTION.
      *
           COPY    "MCPAREA".
           COPY    "ORCA-SPA".
      *
           COPY    "LINKAREA".
      *
       01  SCRAREA.
           COPY    "P02.INC".
           COPY    "P02A.INC".
      *****COPY    "P02B.INC".
      *****COPY    "P02C.INC".
           COPY    "P02D.INC".
           COPY    "P02E.INC".
           COPY    "P02F.INC".
           COPY    "P014.INC".
           COPY    "P015.INC".
           COPY    "P98.INC".
           COPY    "P981.INC".
      *****COPY    "P99.INC".
           COPY    "P0201.INC".
           COPY    "P982.INC".
           COPY    "P100.INC".
           COPY    "P02X.INC".
           COPY    "P02S.INC".
           COPY    "P02Q.INC".
           COPY    "P02Q1.INC".
           COPY    "P02Y.INC".
           COPY    "P02Y1.INC".
           COPY    "P02G.INC".
           COPY    "P02G2.INC".
           COPY    "P02K.INC".
           COPY    "PERR.INC".
           COPY    "PID1.INC".
           COPY    "CPAPIMOD.INC".
      *
       PROCEDURE                   DIVISION    USING
           MCPAREA
           SPAAREA
           LINKAREA
           SCRAREA.
      *
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  STS-AREA
           INITIALIZE                  CNT-AREA
           INITIALIZE                  WRK-AREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           MOVE    SPACE           TO  SPA-ERRCD
           MOVE    ZERO            TO  SPA-FLG-END
           MOVE    SPACE           TO  SPA-MCP-WIDGET
      *
           EVALUATE    MCP-STATUS      ALSO    MCP-EVENT
               WHEN    "LINK"          ALSO    ANY
                   PERFORM 100-INIT-SEC
      *    ²èÌÌÁ«°Ü
               WHEN     "PUTG"           ALSO   "CLICKED"
                   PERFORM 200-GMNSENI
      *    ÆþÎÏ
               WHEN      OTHER
                   PERFORM 200-ENTRY
           END-EVALUATE.
      *
      *    ²èÌÌÊÔ½¸¸å¡¢É½¼¨¤Ø
           IF      SPA-FLG-END             =   ZERO
      ******** PERFORM 500-GMNHEN-SEC
               PERFORM 5001-MAPCUR-SEC
      *
           END-IF
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           .
           EXIT    PROGRAM
           .
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                    SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  STS-AREA
           INITIALIZE                  CNT-AREA
           INITIALIZE                  WRK-AREA
      *
      *    ½é´ü²èÌÌ¥»¥Ã¥È
           PERFORM 300-SCREEN-SEC
      *
           .
       100-INIT-EXT.
           EXIT.
      *****************************************************************
      *    ½é´ü²èÌÌ½èÍý
      *****************************************************************
       300-SCREEN-SEC              SECTION.
      *
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
           MOVE    ZERO            TO  SPA-FLG-END
      *
           EVALUATE    SPA-MOTOPG
      ****     ½»½ê¸¡º÷¤è¤ê
      *        WHEN    "P99"
      *            IF      JPAR-POST     NOT =   SPACE
      *                MOVE    JPAR-POST   TO  SPA-GMN-POST
      *                MOVE    JPAR-EDITADRS-NAME
      *                                    TO  SPA-GMN-EDITADRS-NAME
      *                MOVE    42          TO  SPA-GMN-CUR
      *            ELSE
      *                MOVE    SPACE       TO  SPA-GMN-POST
      *                MOVE    40          TO  SPA-GMN-CUR
      ***********  END-IF
      *        ½»½ê¸¡º÷¤è¤ê
               WHEN    "P98" 
                   IF      JPAR-POST   NOT =   SPACE
                       MOVE    JPAR-POST   TO  SPA-GMN-POST
                       IF      SPA-NAI-KENMEIKBN-FLG   =   "0"
      *                    ÅÔÆ»ÉÜ¸©Ì¾¤Ê¤·
                           MOVE    JPAR-CITYNAME-NAME
                                           TO  SPA-GMN-EDITADRS-NAME
                       ELSE
                           MOVE    JPAR-EDITADRS-NAME
                                           TO  SPA-GMN-EDITADRS-NAME
                       END-IF
                       MOVE    SPA-GMN-EDITADRS-NAME
                                           TO  SPA-MAE-ADRS
                       MOVE    SPA-GMN-POST
                                           TO  SPA-MAE-POST
                       MOVE    42          TO  SPA-GMN-CUR
                   ELSE
                       MOVE    SPACE       TO  SPA-GMN-POST
                       MOVE    40          TO  SPA-GMN-CUR
                   END-IF
      *        ½»½ê°ìÍ÷¤è¤ê
               WHEN    "P982"
                   IF     (SPA-GMN982-POST         =   SPACE )
                   AND    (SPA-GMN982-TOWNNAME     =   SPACE )
      *                ÁªÂò¤Ê¤·
                       IF      SPA-GMN982-KBN      =   2
                           MOVE    41              TO  SPA-GMN-CUR
                       ELSE
                           MOVE    40              TO  SPA-GMN-CUR
                       END-IF
                   ELSE
                       PERFORM 30011-P982SET-SEC
                       MOVE    42              TO  SPA-GMN-CUR
                   END-IF
                   MOVE    SPA-GMN-EDITADRS-NAME
                                               TO  SPA-MAE-ADRS
                   MOVE    ZERO                TO  SPA-GMN982-KBN
      *        Æó½ÅÅÐÏ¿³ÎÇ§²èÌÌ½èÍý
               WHEN    "P02A"
      *             ¿·µ¬¤Ç¥ê¥¹¥ÈÉ½¼¨»þ¤Î¤ß
                   IF      (SPA-P02G-FLG       =   2 )
                       PERFORM 41013-GRPPTNAME-CHK-SEC
                   END-IF
                   CONTINUE
      *        Ï«ºÒÊÝ¸±¹¹¿·²èÌÌ½èÍý
               WHEN    "P02D"
                   PERFORM 4910-RSKOH-PARAOUT-SEC
      *        ¥«¥Ê»áÌ¾¸¡º÷
               WHEN    "P100"
                   PERFORM 3010-P100-HEN-SEC
      *        ´µ¼ÔÊ£¼Ì
               WHEN    "P02E"
      *            ÊÝ¸±ÁÈ¹ç¤»ºîÀ®
                   PERFORM 4503-HKNCOMBI-SYORI-SEC
                   PERFORM 310-SPASET-SEC
                   MOVE    1                  TO  SPA-GMN-CUR
      *        ´µ¼ÔÊ£¼Ì
               WHEN    "P02G"
      *            ÊÝ¸±ÁÈ¹ç¤»ºîÀ®
                   PERFORM 4503-HKNCOMBI-SYORI-SEC
                   PERFORM 310-SPASET-SEC
                   MOVE    1                  TO  SPA-GMN-CUR
      *        ³ÎÇ§¥á¥Ã¥»¡¼¥¸
               WHEN    "PID1"
                   PERFORM 3001-PID1-SYORI-SEC
      *
      *        ½é´ü²èÌÌÊÔ½¸
               WHEN    OTHER
      *            ÊÝ¸±¡¦¸øÈñÊÔ½¸½èÍý
                   PERFORM 310-SPASET-SEC
                   MOVE    1                  TO  SPA-GMN-CUR
           END-EVALUATE
      *
           .
       300-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥«¥Ê»áÌ¾¸¡º÷²èÌÌ¤è¤ê½èÍý
      *****************************************************************
       3010-P100-HEN-SEC              SECTION.
      *
           IF    ( SPA-GMN-P100-FLG-BTN  NOT =   ZERO )
               MOVE    SPA-GMN-P100-KAKUTEI-NAME
                                           TO  SPA-GMN-NAME
                                               SPA-GMN-OLD-NAME
                                               SPA-GMN-NAMEH
      *        À¤ÂÓ¼çÌ¾
               IF  SPA-GMN-SETAINUSI      =   SPACE
                   IF      SPA-NAI-SETAIKBN-FLG    =   "1"
                       MOVE    SPA-GMN-NAME    TO  SPA-GMN-SETAINUSI
                   END-IF
               END-IF
           END-IF
      *
           MOVE    2                   TO  SPA-GMN-CUR
           .
       3010-P100-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³ÎÇ§²èÌÌ¤è¤ê½èÍý
      *****************************************************************
       3001-PID1-SYORI-SEC              SECTION.
      *
           EVALUATE    SPA-PIDCD
               WHEN    "0104"
               WHEN    "0105"
               WHEN    "0110"
      *            ÊÝ¸±½ÅÊ£½èÍý
                   CALL    "ORCSP03A"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
               WHEN    "0111"
      *            Ï·¿Í¸øÈñ£²³ä¤ò£³³ä¤Ø
               IF      (SPA-PTKOH-MAX      >=  TBL-MAX-KOH )
                   MOVE    "0106"          TO  SPA-ERRCD
               ELSE
                   MOVE    ZERO                TO  SPA-KOH-ADD
                   CALL    "ORCSP03B"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
               END-IF
               WHEN    "0106"
               WHEN    "0107"
      *            ¸øÈñ½ÅÊ£½èÍý
               IF      (SPA-PTKOH-MAX      >=  TBL-MAX-KOH )
                   MOVE    "0106"          TO  SPA-ERRCD
               ELSE
                   MOVE    ZERO                TO  SPA-KOH-ADD
                   CALL    "ORCSP03B"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
      *            Ï·¿Í¸øÈñÄÉ²Ã¡Ê£È£±£´¡¥£±£°²þÀµÂÐ±þ¡Ë
                   IF       SPA-KOH-ADD        =   1
      *                ºÇ½é¤Î£±¹Ô¤òÄÉ²Ã¤¹¤ë
                       MOVE    ZERO            TO  SPA-HKNKOH-FLG
                       PERFORM 4104-KOH-ADD-SEC
      *                ¸øÈñ½ÅÊ£½èÍý
                       CALL    "ORCSP03B"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
                   END-IF
               END-IF
      *        ÊÝ¸±½ªÎ»½èÍý
               WHEN    "0201"
               WHEN    "0203"
                   CALL    "ORCSP03A"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
               WHEN    "0202"
               WHEN    "0204"
                   IF      SPA-HKN-IDX1        =   ZERO
      *                ¿·µ¬¤Î»þ¡¢£±¹Ô³«¤±¤ë
                       PERFORM 410311-HKNTBL-INS-SEC
                       MOVE    1                   TO  IDX
                   ELSE
                       MOVE    SPA-HKN-IDX1        TO  IDX
                   END-IF
                   PERFORM 410312-HKN-SPATBL-SET-SEC
                   CALL    "ORCSP03A"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
      *        ½»½ê³ÎÇ§
               WHEN    "1098"
                   PERFORM 30011-P982SET-SEC
           END-EVALUATE
      *
           MOVE    SPACE               TO  SPA-PIDCD
      *
           .
       3001-PID1-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½»½ê³ÎÇ§ÊÔ½¸½èÍý
      *****************************************************************
       30011-P982SET-SEC              SECTION.
      *
           IF      SPA-GMN982-POST     NOT =   SPACE
               MOVE    SPA-GMN982-POST     TO  SPA-GMN-POST
           END-IF
      *
           IF      SPA-GMN982-TOWNNAME NOT =   SPACE
               IF      SPA-NAI-KENMEIKBN-FLG   =   "0"
      *        ÅÔÆ»ÉÜ¸©Ì¾¤Ê¤·
                   MOVE    SPA-GMN982-CITYNAMET
                                           TO  SPA-GMN-EDITADRS-NAME
               ELSE
      *        ÅÔÆ»ÉÜ¸©Ì¾¤¢¤ê
                   MOVE    SPA-GMN982-TOWNNAME
                                           TO  SPA-GMN-EDITADRS-NAME
               END-IF
           END-IF
           MOVE    SPA-GMN-EDITADRS-NAME   TO  SPA-MAE-ADRS
           MOVE    SPA-GMN-POST            TO  SPA-MAE-POST
           .
       30011-P982SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¹¥Ñ½é´üÊÔ½¸½èÍý
      *****************************************************************
       310-SPASET-SEC              SECTION.
      *
      *    Ç¯Îð·×»»
           IF     (SPA-NAI-BIRTHDAY    =   SPACE  OR  ZERO )  OR
                  (SPA-BYMD-70     NOT =   ZERO            )
               CONTINUE
           ELSE
               PERFORM 410121-NENREI-SET-SEC
           END-IF
      *
      *    ¥Æ¡¼¥Ö¥ëÆâ¤ÎÊÝ¸±¾ðÊó¤ËÌ¾¾Î¤òÊÔ½¸¤¹¤ë
           PERFORM 3100-HKNTBL-KBNHEN-SEC
      *    ÊÝ¸±É½¼¨Ï¢ÈÖ
           MOVE    1                   TO  SPA-NAI-HKNSTR
      *    ÊÝ¸±¾ðÊó£Ô£Â£Ì¤«¤éÊÔ½¸
           PERFORM 3101-HKN-TBL-SPA-SEC
      *
      *    ¸øÈñÉ½¼¨Ï¢ÈÖ³«»Ï
           MOVE    1                   TO  SPA-NAI-KOHSTR
      *    ¸øÈñ£Ô£Â£Ì¤«¤éÊÔ½¸
           PERFORM 3101-KOH-TBL-SPA-SEC
      *
      *    ÊÝ¸±ÁÈ¹ç¤»É½¼¨¡Ê¸½ºßÂÐ¾ÝÊ¬¤Î¤ß¡Ë
           PERFORM 3103-HKNCOMB-PARA-SEC
      *
      *
           .
       310-SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ËÜ¿Í²ÈÂ²¶èÊ¬Åù¤ÎÌ¾¾ÎÊÔ½¸½èÍý
      *****************************************************************
       3100-HKNTBL-KBNHEN-SEC            SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX         >   SPA-PTHKN-MAX
      *
      *        ËÜ¿Í²ÈÂ²
               PERFORM VARYING     IDT     FROM    1  BY  1
                       UNTIL       IDT     >   2
                   IF      WRK-HONKA-REC (IDT)(1:1)
                                           =   SPA-PTHKN-HONKZKKBN(IDX)
                       MOVE    WRK-HONKA-REC (IDT)(3:)
                                           TO  SPA-PTHKN-HONKZKKBN-MEI
                                                                  (IDX)
                   END-IF
               END-PERFORM
      *
      *        ·ÑÂ³¶èÊ¬
               IF      SPA-PTHKN-HKNNUM (IDX)  =   "003"
                   MOVE    3                   TO  WRK-CONT-MAX
               ELSE
                   MOVE    2                   TO  WRK-CONT-MAX
               END-IF
               PERFORM VARYING IDT     FROM    1  BY  1
                       UNTIL   IDT     >   WRK-CONT-MAX
                   IF      WRK-KEI-REC (IDT)(1:1)
                                           =   SPA-PTHKN-CONTKBN (IDX)
                       MOVE    WRK-KEI-REC (IDT)(3:)
                                               TO  SPA-PTHKN-CONTKBN-MEI
                                                                  (IDX)
                   END-IF
               END-PERFORM
      *
      *        ÉéÃ´³ä¹ç
               EVALUATE    SPA-PTHKN-HKNNUM (IDX)
      *        Á¥°÷
               WHEN    "002"
                   IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20021001") AND
                          (SPA-BYMD-70             >   ZERO      )  AND
                          (SPA-PTHKN-TEKSTYMD(IDX) >=  SPA-BYMD-70)
                       MOVE    4               TO  IDY
                       MOVE    11              TO  WRK-HJO-MAX
                   ELSE
                       MOVE    1               TO  IDY
                       MOVE    3               TO  WRK-HJO-MAX
                   END-IF
      *************MOVE    ZERO                TO  SPA-GMN-HOJO-MAX
                   PERFORM VARYING     IDT     FROM    IDY BY  1
                           UNTIL       IDT     >   WRK-HJO-MAX
      *              £È£±£¸¡¥£±£° ²þÀµ
                     IF    ((SPA-PTHKN-TEKSTYMD(IDX) =   SPACE )  AND
                            (SPA-SYSYMD              >=  "20061001")) OR
                            (SPA-PTHKN-TEKSTYMD(IDX) >=  "20061001")
                       IF      WRK-HJO-REC1-2 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC1-2 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    WRK-HJO-MAX     TO  IDT
                       END-IF
                     ELSE
                       IF      WRK-HJO-REC1 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC1 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    WRK-HJO-MAX     TO  IDT
                       END-IF
                     END-IF
                   END-PERFORM
      *        ¹ñÊÝ
               WHEN    "060"
               WHEN    "068"
                   PERFORM VARYING     IDT     FROM    1  BY  1
                           UNTIL       IDT     >   7
                       IF      WRK-HJO-REC2 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC2 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    7           TO  IDT
                       END-IF
                   END-PERFORM
      *        ¶¦ºÑ
               WHEN    "031"
               WHEN    "032"
               WHEN    "033"
               WHEN    "034"
                   IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20021001") AND
                          (SPA-BYMD-70             >   ZERO      )  AND
                          (SPA-PTHKN-TEKSTYMD(IDX) >=  SPA-BYMD-70)
                       MOVE    2               TO  IDY
                       MOVE    5               TO  WRK-HJO-MAX
                   ELSE
                       MOVE    1               TO  IDY
                       MOVE    1               TO  WRK-HJO-MAX
                   END-IF
                   PERFORM VARYING     IDT     FROM    IDY BY  1
                           UNTIL       IDT     >   WRK-HJO-MAX
      *              £È£±£¸¡¥£±£° ²þÀµ
                     IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20061001")
                        OR ((SPA-PTHKN-TEKSTYMD(IDX) =   SPACE  )  AND
                            (SPA-SYSYMD              >=  "20061001"))
                       IF      WRK-HJO-REC5-2 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC5-2 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    WRK-HJO-MAX     TO  IDT
                       END-IF
                     ELSE
                       IF      WRK-HJO-REC5 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC5 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    WRK-HJO-MAX     TO  IDT
                       END-IF
                     END-IF
                   END-PERFORM
      *£È£²£°¡¥£´²þÀµ
      *        ¸å´ü¹âÎð¼Ô
               WHEN    "039"
               WHEN    "040"
                   PERFORM VARYING     IDT     FROM    1  BY  1
                           UNTIL       IDT     >   2
                       IF      WRK-HJO-REC6 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC6 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    2           TO  IDT
                       END-IF
                   END-PERFORM
      *        ¤½¤ÎÂ¾
               WHEN    OTHER
                   EVALUATE    SPA-PTHKN-HKNNUM (IDX)(1:2)
      *            ¼«Èñ
                   WHEN    "98"
                       PERFORM VARYING     IDT     FROM    1  BY  1
                               UNTIL       IDT     >   2
                           IF      WRK-HJO-REC3 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                               MOVE    WRK-HJO-REC3 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                               MOVE    2           TO  IDT
                           END-IF
                       END-PERFORM
      *            ¼£¸³
                   WHEN    "90"
                   WHEN    "91"
                       PERFORM VARYING     IDT     FROM    1  BY  1
                               UNTIL       IDT     >   2
                           IF      WRK-HJO-REC3 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                               MOVE    WRK-HJO-REC3 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                               MOVE    2           TO  IDT
                           END-IF
                       END-PERFORM
                   WHEN    OTHER
      *                £È£±£´¡¥£±£° ²þÀµ¤è¤ê
                       IF      SPA-PTHKN-TEKSTYMD(IDX) >=  "20021001"
                           PERFORM 31001-HKNTBL-RJNHEN-SEC
                       END-IF
                   END-EVALUATE
               END-EVALUATE
           END-PERFORM
      *
           .
       3100-HKNTBL-KBNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï·¿ÍÊä½õ¶èÊ¬ÊÔ½¸½èÍý
      *****************************************************************
       31001-HKNTBL-RJNHEN-SEC            SECTION.
      *
      *    Å¬ÍÑ³«»ÏÆü¤¬£·£°ºÐ°Ê¾å¤Ç¡¢Ï«ºÒ¡¦¼£¸³¡¦¼«Èñ
           IF      (SPA-PTHKN-TEKSTYMD(IDX)    >=  SPA-BYMD-70)  AND
                   (SPA-BYMD-70                >   ZERO      )  AND
                   (SPA-PTHKN-HKNNUM(IDX)(1:1) NOT =   "9")
               PERFORM VARYING     IDT     FROM    1  BY  1
                       UNTIL       IDT     >   2
      *          £È£±£¸¡¥£±£° ²þÀµ¤è¤ê
                 IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20061001")
                    OR ((SPA-PTHKN-TEKSTYMD(IDX) =   SPACE  )  AND
                        (SPA-SYSYMD              >=  "20061001"))
                   IF      WRK-HJO-REC4-2 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                       MOVE    WRK-HJO-REC4-2 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                       MOVE    2               TO  IDT
                   END-IF
                 ELSE
                   IF      WRK-HJO-REC4 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                       MOVE    WRK-HJO-REC4 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                       MOVE    2               TO  IDT
                   END-IF
                 END-IF
               END-PERFORM
           END-IF
           .
       31001-HKNTBL-RJNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±¾ðÊó¥Ñ¥é¥á¥¿¥Õ¥¡¥¤¥ë¸¡º÷½èÍý
      *****************************************************************
       3101-HKN-TBL-SPA-SEC            SECTION.
      *
           INITIALIZE                  SPA-GMN-HKN-AREA
           MOVE    ZERO                TO  FLG-CHK
           IF      SPA-NAI-HKNSTR      =   ZERO
               CONTINUE
           ELSE
               PERFORM VARYING IDX     FROM    SPA-NAI-HKNSTR   BY  1
                   UNTIL      (IDX         >   SPA-PTHKN-MAX )  OR
                              (FLG-CHK NOT =   ZERO )
                   IF      SPA-PTHKN-SAKJOKBN (IDX)    =   SPACE
      *                £Ñ£Ò¥Ç¡¼¥¿¤ÎÉ½¼¨
                       IF     (SPA-QR-FLG          =   1   )  AND
                              (SPA-QR-HKNID    NOT =   ZERO )  AND
                              (SPA-QR-HKNID    NOT =   SPA-PTHKN-HKNID
                                                               (IDX))
                           CONTINUE
                       ELSE
                           MOVE    IDX             TO  SPA-NAI-HKNSTR
                           PERFORM 3101-HOKEN-HEN-SEC
                           MOVE    1               TO  FLG-CHK
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *    ÂÐ¾Ý¤ÎÊÝ¸±¤¬¤Ê¤¤»þ¡¢¿·µ¬¤È¤¹¤ë
           IF      FLG-CHK             =   ZERO
               MOVE    ZERO                TO  SPA-NAI-HKNSTR
           END-IF
      *
           .
       3101-HKN-TBL-SPA-EXT.
           EXIT.
      *****************************************************************
      *    ¸øÈñ¾ðÊó¥Ñ¥é¥á¥¿¥Õ¥¡¥¤¥ë¸¡º÷½èÍý
      *****************************************************************
       3101-KOH-TBL-SPA-SEC        SECTION.
      *
           INITIALIZE                  SPA-GMN-KOH-AREA
           MOVE    ZERO                TO  IDY
           MOVE    ZERO                TO  FLG-CHK
           MOVE    ZERO                TO  SPA-NAI-KOHEND
           IF      SPA-NAI-KOHSTR      =   ZERO
               CONTINUE
           ELSE
      *
           PERFORM VARYING     IDX     FROM    SPA-NAI-KOHSTR BY  1
                   UNTIL      (IDX         >   SPA-PTKOH-MAX )  OR
                              (IDY         >=  3    )
               IF      SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE
                   IF      IDY             =   ZERO
                       MOVE    IDX             TO  SPA-NAI-KOHSTR
                   END-IF
                   MOVE    IDX                 TO  SPA-NAI-KOHEND
                   ADD     1                   TO  IDY
                   MOVE    1                   TO  FLG-CHK
                   PERFORM 3102-KOUHI-HEN-SEC
               END-IF
           END-PERFORM
           END-IF
      *
      *    ÂÐ¾Ý¤ÎÊÝ¸±¤¬¤Ê¤¤»þ¡¢¿·µ¬¤È¤¹¤ë
           IF      FLG-CHK             =   ZERO
               MOVE    ZERO                TO  SPA-NAI-KOHSTR
               MOVE    ZERO                TO  SPA-NAI-KOHEND
           END-IF
      *
           .
       3101-KOH-TBL-SPA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÊÔ½¸½èÍý
      *****************************************************************
       3101-HOKEN-HEN-SEC              SECTION.
      *
           MOVE    SPA-PTHKN-HKNNUM (IDX)  TO  SPA-GMN-HKNNUM
      *    ÊÝ¸±£É£Ä¡ÊÏ«ºÒÊÝ¸±¤Î¤È¤Î´ØÏ¢¡Ë
           MOVE    SPA-PTHKN-HKNID  (IDX)  TO  SPA-NAI-HKNID
      *
           MOVE    SPA-PTHKN-HKNJANUM(IDX) TO  SPA-GMN-HKNJANUM
           MOVE    SPA-PTHKN-HIHKNJANAME (IDX)
                                           TO  SPA-GMN-HIHKNJANAME
           MOVE    SPA-PTHKN-HONKZKKBN (IDX)
                                           TO  SPA-GMN-HONKZKKBN
           MOVE    SPA-GMN-HONKZKKBN       TO  SPA-MAE-HONKZKKBN
           MOVE    SPA-PTHKN-HOJOKBN (IDX) TO  SPA-GMN-HOJOKBN
           MOVE    SPA-PTHKN-CONTKBN (IDX) TO  SPA-GMN-CONTKBN
           MOVE    SPA-PTHKN-KIGO    (IDX) TO  SPA-GMN-KIGO
           MOVE    SPA-PTHKN-NUM     (IDX) TO  SPA-GMN-NUM
      *
           MOVE    SPA-PTHKN-HKN-SBTKBN(IDX)
                                           TO  SPA-NAI-PTHKN-SBTKBN
           MOVE    SPA-PTHKN-SAKJOKBN(IDX) TO  SPA-NAI-SAKJOKBN
           MOVE    SPA-PTHKN-SKKGETYMD  (IDX)
                                           TO  SPA-NAI-SKKGETYMD
           MOVE    SPA-PTHKN-TEKSTYMD(IDX) TO  SPA-NAI-HTEKSTYMD
           MOVE    SPA-PTHKN-TEKEDYMD(IDX) TO  SPA-NAI-HTEKEDYMD
           MOVE    SPA-PTHKN-KAKUNINYMD (IDX)
                                           TO  SPA-NAI-HKAKUNINYMD
      *
           MOVE    SPA-PTHKN-SKKGETYMDW (IDX)
                                           TO  SPA-GMN-SKKGETYMD
           MOVE    SPA-PTHKN-TEKSTYMDW (IDX)
                                           TO  SPA-GMN-HTEKSTYMD
           MOVE    SPA-PTHKN-TEKEDYMDW (IDX)
                                           TO  SPA-GMN-HTEKEDYMD
           MOVE    SPA-PTHKN-KAKUNINYMDW (IDX)
                                           TO  SPA-GMN-HKAKUNINYMD
      *
      *    Á°ÊÝÂ¸
           MOVE    SPA-PTHKN-HKNNUM  (IDX) TO  SPA-MAE-HKNNUM
           MOVE    SPA-PTHKN-HKNJANUM(IDX) TO  SPA-MAE-HKNJANUM
           MOVE    SPA-PTHKN-HOJOKBN (IDX) TO  SPA-MAE-HOJOKBN
           MOVE    SPA-PTHKN-MAEKAKUNINYMD (IDX)
                                           TO  SPA-MAE-HKAKUNINYMD
           MOVE    SPA-PTHKN-MAEKAKUNINYMDW(IDX)
                                           TO  SPA-MAE-HKAKUNINYMDW
           MOVE    SPA-PTHKN-KIGO    (IDX) TO  SPA-OLD-KIGO
           MOVE    SPA-PTHKN-NUM     (IDX) TO  SPA-OLD-NUM
      *
           MOVE    SPA-PTHKN-KIGO    (IDX) TO  SPA-MAE-KIGO
           MOVE    SPA-PTHKN-NUM     (IDX) TO  SPA-MAE-NUM
           MOVE    SPA-PTHKN-KIGO-KEIFLG (IDX)
                                           TO  SPA-KIGO-KEIFLG
           MOVE    SPA-PTHKN-NUM-KEIFLG (IDX)
                                           TO  SPA-NUM-KEIFLG
      *    ËÜ¿Í²ÈÂ²·Ù¹ð
           MOVE    SPA-PTHKN-HONKZKKBN (IDX)
                                           TO  SPA-OLD-HONKZKKBN
           MOVE    SPA-PTHKN-HONKZKFLG (IDX)
                                           TO  SPA-HONKZK-KEIFLG
      *    Êä½õ¶èÊ¬·Ù¹ð
           MOVE    SPA-PTHKN-HOJOKBN (IDX)
                                           TO  SPA-OLD-HOJOKBN
           MOVE    SPA-PTHKN-HOJOKEIFLG (IDX)
                                           TO  SPA-HOJOKBN-KEIFLG
      *!API
      *    API½èÍý¡Ê¿·µ¬ÆþÎÏ¤È¤¹¤ë¡Ë
           IF      FLG-APICHK              =   1
               MOVE    SPACE               TO  SPA-OLD-KIGO
               MOVE    SPACE               TO  SPA-OLD-NUM
               MOVE    SPACE               TO  SPA-MAE-HKNNUM
               MOVE    SPACE               TO  SPA-MAE-HKNJANUM
      ***      MOVE    SPACE               TO  SPA-MAE-HONKZKKBN
      ****     MOVE    SPACE               TO  SPA-MAE-HOJOKBN
           END-IF
      *!API
      *
      *    ¹¹¿·Á°¤Îµ­¹æ¶õÇò¥Á¥§¥Ã¥¯¤ÏÅöÆüÍ­¸ú¤Î¤â¤Î
           IF      FLG-TOUROKU     NOT =   ZERO
               IF      (SPA-PTHKN-TEKEDYMD(IDX)  <=  SPA-SYSYMD )
                   MOVE    1               TO  SPA-KIGO-KEIFLG
                   MOVE    1               TO  SPA-NUM-KEIFLG
               END-IF
           END-IF
      *    ¸å´ü¹âÎð¼Ô·Ù¹ð
           MOVE    SPA-PTHKN-ROU-KEIFLG (IDX)
                                       TO  SPA-ROU-KEIFLG
      *    ¿·µ¬°Ê³°¤Ï¥Á¥§¥Ã¥¯ºÑ¤ß¤È¤¹¤ë
           IF      SPA-PTHKN-SINKIKBN (IDX)    =   SPACE
               MOVE    1                   TO  SPA-ROU-KEIFLG
           END-IF
      *!!
           MOVE    SPA-PTHKN-KEIFLG(IDX)   TO  SPA-HKNJA-KEIFLG
      *    ³ÎÇ§Ç¯·îÆü
           MOVE    SPA-PTHKN-KAKUINFLG(IDX) TO  SPA-HKN-KAKUINFLG
      *
      *    ÊÝ¸±¼ÔÈÖ¹æ¡¡¸¡º÷¥Á¥§¥Ã¥¯
           INITIALIZE                    HKNJAINF-REC
           MOVE    SPA-HOSPNUM           TO  HKNJA-HOSPNUM
           MOVE    SPA-GMN-HKNJANUM      TO  HKNJA-HKNJANUM
      *
           MOVE    HKNJAINF-REC          TO  MCPDATA-REC
           MOVE    "tbl_hknjainf"        TO  MCP-TABLE
           MOVE    "key"                 TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknjainf"        TO  MCP-TABLE
               MOVE    "key"                 TO  MCP-PATHNAME
               PERFORM 900-HKNJAINF-READ-SEC
           ELSE
               INITIALIZE                  HKNJAINF-REC
               MOVE    1               TO  FLG-HKNJAINF
           END-IF
           MOVE    "tbl_hknjainf"        TO  MCP-TABLE
           MOVE    "key"                 TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *    ÊÝ¸±¼ÔÈÖ¹æ¤¢¤ê
           IF      FLG-HKNJAINF        =   ZERO
               MOVE    HKNJA-HKNJANAME     TO  SPA-HKNJA-HKNJANAME
               MOVE    HKNJA-ADRS          TO  SPA-HKNJA-ADRS
               MOVE    HKNJA-BANTI         TO  SPA-HKNJA-BANTI
               MOVE    HKNJA-TEL           TO  SPA-HKNJA-TEL
      *
               MOVE    HKNJA-IDOYMD        TO  SPA-HKNJA-IDOYMD
      *!       MOVE    SPA-PTHKN-KEIFLG(IDX)
      *!                                   TO  SPA-HKNJA-KEIFLG
           ELSE
               MOVE    SPACE               TO  SPA-HKNJA-HKNJANAME
               MOVE    SPACE               TO  SPA-HKNJA-ADRS
               MOVE    SPACE               TO  SPA-HKNJA-BANTI
               MOVE    SPACE               TO  SPA-HKNJA-TEL
      *
               MOVE    SPACE               TO  SPA-HKNJA-IDOYMD
      *!!      MOVE    SPACE               TO  SPA-HKNJA-KEIFLG
           END-IF
      *
      *    ÊÝ¸±¾ðÊó
           MOVE    SPA-GMN-HKNNUM      TO  WRK-HKNNUM
           MOVE    SPA-NAI-HTEKSTYMD   TO  WRK-TEKSTYMD
           MOVE    SPA-NAI-HTEKEDYMD   TO  WRK-TEKEDYMD
           MOVE    ZERO                TO  WRK-PAYKBN
           PERFORM 31012-HKNNUM-SET-SEC
           IF      WRK-HKNKOHSBTKBN    NOT =   SPACE
               MOVE    WRK-TANSEIDONAME    TO  SPA-GMN-HKNNUMMEI
               MOVE    WRK-HKNKOHSBTKBN    TO  SPA-NAI-PTHKN-SBTKBN
           END-IF
      *****PERFORM VARYING     IDX     FROM    1   BY  1
      *            UNTIL       IDX     >   SPA-GMN-HKNMAX
      *        IF      SPA-GMN-HKNNUML (IDX)   =   SPA-GMN-HKNNUM
      *            MOVE    SPA-GMN-HKNNUMLST (IDX)
      *                                        TO  SPA-GMN-HKNNUM-G
      *            ¼±ÊÌ
      *            MOVE    SPA-NAI-HKNSBTKBN (IDX)
      *                                        TO  SPA-NAI-PTHKN-SBTKBN
      *            MOVE    SPA-GMN-HKNMAX      TO  IDX
      *        END-IF
      *****END-PERFORM
      *
      *!API
      *    API½èÍý¡ÊÊÝ¸±¼ïÎàÀßÄê¤Ê¤·¡Ë
           IF     (FLG-APICHK          =   1   )
               GO      TO      3101-HOKEN-HEN-EXT
           END-IF
      *!API
      *    ËÜ¿Í²ÈÂ²¶èÊ¬Åù
           PERFORM 31011-HKN-HEN-SEC
      *
      *    Ï«ºÒÊÝ¸±¤ÎÈÖ¹æÀßÄê
           IF      SPA-GMN-HKNNUM      =   "971"
                                       OR  "973"
               PERFORM 310111-PARA-RSIHKN-SET-SEC
           END-IF
      *
           .
       3101-HOKEN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±¸øÈñ¶èÊ¬ÊÔ½¸½èÍý
      *****************************************************************
       31012-HKNNUM-SET-SEC           SECTION.
      *
           INITIALIZE                  HKNNUM-REC
           MOVE    SPA-HOSPNUM         TO  HKN-HOSPNUM
           MOVE    WRK-HKNNUM          TO  HKN-HKNNUM
           IF      WRK-PAYKBN          =   SPACE
               MOVE    ZERO                TO  HKN-PAYKBN
           ELSE
               MOVE    WRK-PAYKBN          TO  HKN-PAYKBN
           END-IF
           MOVE    WRK-TEKSTYMD        TO  HKN-TEKSTYMD
           MOVE    WRK-TEKEDYMD        TO  HKN-TEKEDYMD
      *
           MOVE    HKNNUM-REC          TO  MCPDATA-REC
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknnum"        TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 921-HKNNUM-NEXT-SEC
           ELSE
               INITIALIZE              HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           MOVE    SPACE               TO  WRK-HKNKOHSBTKBN
           MOVE    SPACE               TO  WRK-TANSEIDONAME
           IF      FLG-HKNNUM          =   ZERO
               IF     (WRK-TEKSTYMD        >=  HKN-TEKSTYMD )  AND
                      (WRK-TEKEDYMD        <=  HKN-TEKEDYMD )
                   MOVE    HKN-HKNKOHSBTKBN    TO  WRK-HKNKOHSBTKBN
                   MOVE    HKN-TANSEIDONAME    TO  WRK-TANSEIDONAME
               END-IF
           END-IF
      *
           .
       31012-HKNNUM-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ËÜ¿Í²ÈÂ²¶èÊ¬ÅùÊÔ½¸½èÍý
      *****************************************************************
       31011-HKN-HEN-SEC      SECTION.
      *
      *    ËÜ¿Í²ÈÂ²
           MOVE    ZERO                TO  SPA-GMN-HONKZK-MAX
           PERFORM VARYING     IDT     FROM    1  BY  1
                   UNTIL       IDT     >   2
               MOVE    WRK-HONKA-REC (IDT)
                                       TO  SPA-GMN-HONKZKKBNL (IDT)
               MOVE    IDT             TO  SPA-GMN-HONKZK-MAX
               IF      SPA-GMN-HONKZKKBNL (IDT)(1:1)
                                           =   SPA-GMN-HONKZKKBN
                   MOVE    SPA-GMN-HONKZKKBNL (IDT)
                                           TO  SPA-GMN-HONKZKKBN-G
               END-IF
      *        ¼«´±¤ÏËÜ¿Í¤Î¤ß
               IF      SPA-GMN-HKNNUM      =   "007"
      *        ¸ø³²ÊÝ¸±¤ÏËÜ¿Í¤Î¤ß
                                           OR  "975"
      *        ¸å´ü¹âÎð¼Ô¤ÏËÜ¿Í¤Î¤ß
                                           OR  "040"
                                           OR  "039"
                   MOVE    2               TO  IDT
               END-IF
           END-PERFORM
           IF      SPA-GMN-HONKZKKBN   =   SPACE
               MOVE    SPACE           TO  SPA-GMN-HONKZKKBN-G
           END-IF
      *
      *    ·ÑÂ³¶èÊ¬
           IF    ( SPA-NAI-PTHKN-SBTKBN    NOT =   "1"  ) OR
                 ( SPA-GMN-HKNNUM          =   "060"
                                           OR  "067"
      *              ÆÃÊÌÎÅÍÜÈñÄÉ²Ã
                                           OR  "068"
                                           OR  "069"
      *              ¸å´ü¹âÎð¼ÔÄÉ²Ã
                                           OR  "039"
                                           OR  "040" )
               MOVE    ZERO                TO  SPA-GMN-CONT-MAX
               MOVE    SPACE               TO  SPA-GMN-CONTKBN-G
           ELSE
               IF      SPA-GMN-HKNNUM      =   "002"
                   MOVE    3               TO  WRK-CONT-MAX
               ELSE
                   MOVE    2               TO  WRK-CONT-MAX
               END-IF
               PERFORM VARYING IDT     FROM    1  BY  1
                       UNTIL   IDT     >   WRK-CONT-MAX
                   MOVE    WRK-KEI-REC (IDT)
                                           TO  SPA-GMN-CONTKBNL (IDT)
                   IF      WRK-KEI-REC (IDT)(1:1)
                                           =   SPA-GMN-CONTKBN
                       MOVE    SPA-GMN-CONTKBNL (IDT)
                                               TO  SPA-GMN-CONTKBN-G
                   END-IF
                   MOVE    IDT             TO  SPA-GMN-CONT-MAX
               END-PERFORM
           END-IF
      *
      *    ÉéÃ´³ä¹ç
           EVALUATE    SPA-GMN-HKNNUM
      *        Á¥°÷
               WHEN    "002"
                   IF     (SPA-NAI-HTEKSTYMD       >=  "20021001") AND
                          (SPA-BYMD-70             >   ZERO      )  AND
                          (SPA-NAI-HTEKSTYMD       >=  SPA-BYMD-70)
                       MOVE    4               TO  IDY
                       MOVE    11              TO  WRK-HJO-MAX
                   ELSE
                       MOVE    1               TO  IDY
                       MOVE    3               TO  WRK-HJO-MAX
                   END-IF
                   MOVE    ZERO                TO  SPA-GMN-HOJO-MAX
                   PERFORM VARYING     IDT     FROM    IDY BY  1
                           UNTIL       IDT     >   WRK-HJO-MAX
                       ADD     1           TO  SPA-GMN-HOJO-MAX
      *            £È£±£¸¡¥£±£° ²þÀµ¤è¤ê
                       IF     (SPA-NAI-HTEKSTYMD   >=  "20061001" )
                          OR ((SPA-NAI-HTEKSTYMD   =   SPACE  )  AND
                              (SPA-SYSYMD          >=  "20061001"))
                           MOVE    WRK-HJO-REC1-2 (IDT)
                                           TO  SPA-GMN-HOJOKBNL
                                                    (SPA-GMN-HOJO-MAX)
                       ELSE
                           MOVE    WRK-HJO-REC1 (IDT)
                                           TO  SPA-GMN-HOJOKBNL
                                                    (SPA-GMN-HOJO-MAX)
                       END-IF
                   END-PERFORM
      *        ¹ñÊÝ
               WHEN    "060"
               WHEN    "068"
                   PERFORM VARYING   IDT     FROM    1  BY  1
                         UNTIL       IDT     >   7
                       MOVE    WRK-HJO-REC2 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                       MOVE    IDT         TO  SPA-GMN-HOJO-MAX
                   END-PERFORM
      *        ¶¦ºÑ
               WHEN    "031"
               WHEN    "032"
               WHEN    "033"
               WHEN    "034"
                   IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20021001") AND
                          (SPA-BYMD-70             >   ZERO      )  AND
                          (SPA-PTHKN-TEKSTYMD(IDX) >=  SPA-BYMD-70)
                       MOVE    2               TO  IDY
                       MOVE    5               TO  WRK-HJO-MAX
                   ELSE
                       MOVE    1               TO  IDY
                       MOVE    1               TO  WRK-HJO-MAX
                   END-IF
                   MOVE    ZERO                TO  SPA-GMN-HOJO-MAX
                   PERFORM VARYING     IDT     FROM    IDY BY  1
                           UNTIL       IDT     >   WRK-HJO-MAX
                       ADD     1           TO  SPA-GMN-HOJO-MAX
      *            £È£±£¸¡¥£±£° ²þÀµ¤è¤ê
                       IF     (SPA-NAI-HTEKSTYMD   >=  "20061001"  )
                          OR ((SPA-NAI-HTEKSTYMD   =   SPACE  )  AND
                              (SPA-SYSYMD          >=  "20061001"))
                           MOVE    WRK-HJO-REC5-2 (IDT)
                                           TO  SPA-GMN-HOJOKBNL
                                                    (SPA-GMN-HOJO-MAX)
                       ELSE
                           MOVE    WRK-HJO-REC5   (IDT)
                                           TO  SPA-GMN-HOJOKBNL
                                                    (SPA-GMN-HOJO-MAX)
                       END-IF
                   END-PERFORM
      *£È£²£°¡¥£´²þÀµ
      *        ¸å´ü¹âÎð¼Ô
               WHEN    "039"
               WHEN    "040"
                   PERFORM VARYING   IDT     FROM    1  BY  1
                         UNTIL       IDT     >   2
                       MOVE    WRK-HJO-REC6 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                       MOVE    IDT         TO  SPA-GMN-HOJO-MAX
                   END-PERFORM
      *        ¤½¤ÎÂ¾
               WHEN    OTHER
      *            ¼«Èñ¡¦¼£¸³
                   IF     (SPA-GMN-HKNNUM (1:2)    =   "98" )
                    OR    (SPA-GMN-HKNNUM (1:2)    =   "90"
                                                   OR  "91" )
                       PERFORM VARYING     IDT     FROM    1  BY  1
                               UNTIL       IDT     >   2
                           MOVE    WRK-HJO-REC3 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                           MOVE    IDT         TO  SPA-GMN-HOJO-MAX
                       END-PERFORM
                   ELSE
                       MOVE    ZERO        TO  SPA-GMN-HOJO-MAX
      *                £È£±£´¡¥£±£° ²þÀµ¤è¤ê
                       IF      SPA-NAI-HTEKSTYMD   >=  "20021001"
                           PERFORM 310111-HKN-RJNHEN-SEC
                       END-IF
                   END-IF
           END-EVALUATE
      *
           IF      SPA-GMN-HOJO-MAX    =   ZERO
               MOVE    SPACE           TO  SPA-GMN-HOJOKBN-G
           END-IF
           PERFORM VARYING     IDT     FROM    1  BY  1
                   UNTIL       IDT     >   SPA-GMN-HOJO-MAX
               IF      SPA-GMN-HOJOKBNL (IDT)(1:1)
                                           =   SPA-GMN-HOJOKBN
                   MOVE    SPA-GMN-HOJOKBNL (IDT)
                                           TO  SPA-GMN-HOJOKBN-G
               END-IF
           END-PERFORM
      *
           .
       31011-HKN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï·¿ÍÊä½õ¶èÊ¬ÊÔ½¸½èÍý
      *****************************************************************
       310111-HKN-RJNHEN-SEC            SECTION.
      *
      *    Å¬ÍÑ³«»ÏÆü¤¬£·£°ºÐ°Ê¾å¤Ç¡¢Ï«ºÒ¡¦¼£¸³¡¦¼«Èñ
           IF      (SPA-NAI-HTEKSTYMD      >=  SPA-BYMD-70)  AND
                   (SPA-BYMD-70            >   ZERO       )  AND
                   (SPA-GMN-HKNNUM(1:1) NOT =   "9")
               PERFORM VARYING     IDT     FROM    1  BY  1
                       UNTIL       IDT     >   2
      *            £È£±£¸¡¥£±£° ²þÀµ¤è¤ê
                   IF     (SPA-NAI-HTEKSTYMD       >=  "20061001" )
                      OR ((SPA-NAI-HTEKSTYMD       =   SPACE  )  AND
                          (SPA-SYSYMD              >=  "20061001"))
                       MOVE    WRK-HJO-REC4-2 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                   ELSE
                       MOVE    WRK-HJO-REC4 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                   END-IF
                   MOVE    IDT             TO  SPA-GMN-HOJO-MAX
               END-PERFORM
           END-IF
           .
       310111-HKN-RJNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÊÝ¸±ÊÔ½¸½èÍý
      *****************************************************************
       310111-PARA-RSIHKN-SET-SEC      SECTION.
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTRSIINF"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           PERFORM
               UNTIL   FLG-PARA            =   1
      *
               MOVE    PARA-DATA-REC       TO  PTRSIINF-REC
               IF      PTRSI-HKNID         =   SPA-NAI-HKNID
                   MOVE    PARA-EDANUM     TO  SPA-NAI-RSHKN-EDANUM
                   MOVE    1               TO  FLG-PARA
               ELSE
                   MOVE    "tbl_para"          TO  MCP-TABLE
                   MOVE    "key5"              TO  MCP-PATHNAME
                   PERFORM 990-PARA-READ-SEC
               END-IF
           END-PERFORM
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       310111-PARA-RSIHKN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñÊÔ½¸½èÍý
      *****************************************************************
       3102-KOUHI-HEN-SEC              SECTION.
      *
           MOVE    IDY                 TO  SPA-KOH-MAX
           MOVE    IDX                 TO  SPA-NAI-PTKOH-EDANUM (IDY)
      *
           MOVE    SPA-PTKOH-KOHNUM (IDX)  TO  SPA-GMN-KOHNUM  (IDY)
           MOVE    SPA-PTKOH-FTNJANUM(IDX) TO  SPA-GMN-FTNJANUM (IDY)
           MOVE    SPA-PTKOH-JKYSNUM (IDX) TO  SPA-GMN-JKYSNUM   (IDY)
      *
           IF      SPA-PTKOH-PAYKBN (IDX)  NOT =   ZERO
               MOVE    SPA-PTKOH-PAYKBN (IDX)(2:1)
                                           TO  SPA-GMN-KOHKBN  (IDY)
           ELSE
               MOVE    SPACE               TO  SPA-GMN-KOHKBN  (IDY)
           END-IF
           MOVE    SPA-PTKOH-PAYKBN (IDX)  TO  SPA-NAI-PTKOH-PAYKBN(IDY)
      *
           MOVE    SPA-PTKOH-TEKSTYMD(IDX) TO  SPA-NAI-KTEKSTYMD(IDY)
           MOVE    SPA-PTKOH-TEKEDYMD(IDX) TO  SPA-NAI-KTEKEDYMD (IDY)
           MOVE    SPA-PTKOH-KAKUNINYMD (IDX)
                                           TO  SPA-NAI-KKAKUNINYMD(IDY)
      *
           MOVE    SPA-PTKOH-TEKSTYMDW (IDX)
                                           TO  SPA-GMN-KTEKSTYMD (IDY)
           MOVE    SPA-PTKOH-TEKEDYMDW (IDX)
                                           TO  SPA-GMN-KTEKEDYMD (IDY)
           MOVE    SPA-PTKOH-KAKUNINYMDW (IDX)
                                           TO  SPA-GMN-KKAKUNINYMD (IDY)
      *
           MOVE    SPA-PTKOH-KOHID (IDX)   TO SPA-NAI-PTKOH-KOHID (IDY)
      *    ´ü¸ÂÀÚ¤ì¶èÊ¬
           MOVE    SPA-PTKOH-TEKEDCHKKBN(IDX)
                                           TO  SPA-NAI-TEKEDCHKKBN(IDY)
      *
           MOVE    SPA-PTKOH-KOHNUM(IDX)   TO  SPA-MAE-KOHNUM  (IDY)
           IF      SPA-PTKOH-PAYKBN(IDX)   NOT =   ZERO
               MOVE    SPA-PTKOH-PAYKBN(IDX)(2:1)
                                           TO  SPA-MAE-KOHKBN  (IDY)
           END-IF
           MOVE    SPA-PTKOH-FTNJANUM (IDX)
                                           TO  SPA-MAE-FTNJANUM   (IDY)
           MOVE    SPA-PTKOH-MAEKAKUNINYMD (IDX)
                                           TO  SPA-MAE-KKAKUNINYMD(IDY)
           MOVE    SPA-PTKOH-MAEKAKUNINYMDW(IDX)
                                           TO  SPA-MAE-KKAKUNINYMDW(IDY)
      *    ¿·µ¬°Ê³°¤Î»þÏ·¿Í¥Á¥§¥Ã¥¯ºÑ¤ß¤È¤¹¤ë
           IF      SPA-MAE-KOHNUM (IDY)    NOT =   SPACE
               MOVE    1                   TO  SPA-NAI-AGE65 (IDY)
               MOVE    1                   TO  SPA-NAI-AGECHK(IDY)
               MOVE    1                   TO  SPA-NAI-FTNCHK(IDY)
      *        ¼õµë¼ÔÈÖ¹æ·Ù¹ð
               MOVE    1                   TO  SPA-NAI-JYUCHK(IDY)
           END-IF
           MOVE    SPA-PTKOH-KAKUINFLG (IDX)
                                           TO  SPA-KOH-KAKUINFLG(IDY)
      *
      *    ¸øÈñ¾ðÊó
           MOVE    SPA-GMN-KOHNUM (IDY)    TO  WRK-HKNNUM
           MOVE    SPA-NAI-KTEKSTYMD(IDY)  TO  WRK-TEKSTYMD
           MOVE    SPA-NAI-KTEKEDYMD(IDY)  TO  WRK-TEKEDYMD
           MOVE    SPA-NAI-PTKOH-PAYKBN(IDY)
                                           TO  WRK-PAYKBN
           IF     (WRK-HKNNUM          =   "027"  )  AND
                  (WRK-PAYKBN          =   ZERO  OR  SPACE )
      *        £È£±£²¡¥£±£²¡¥£³£±¤Þ¤Ç¤Î»ÙÊ§¶èÊ¬¤Ï£°£°
               IF      WRK-TEKEDYMD        >=  "20010101"
                   MOVE    SPA-NAI-HOSPSBT         TO  WRK-PAYKBN(1:1)
                   MOVE    SPA-NAI-ROUPAYKBN       TO  WRK-PAYKBN(2:1)
               END-IF
           END-IF
           PERFORM 31012-HKNNUM-SET-SEC
           IF     (SPA-GMN-KOHNUM (IDY)        =   "027" )  AND
                  (SPA-NAI-PTKOH-PAYKBN(IDY)   =   ZERO  )
               MOVE    "Ï·¿ÍÊÝ·ò"          TO  WRK-TANSEIDONAME
               MOVE    "3"                 TO  WRK-HKNKOHSBTKBN
           END-IF
           MOVE    WRK-TANSEIDONAME    TO  SPA-GMN-KOHNUMMEI(IDY)
           MOVE    WRK-TANSEIDONAME    TO  SPA-MAE-KOHNUMMEI(IDY)
           MOVE    WRK-HKNKOHSBTKBN    TO  SPA-NAI-PTKOH-SBTKBN(IDY)
      *
      *    ÊÝ¸±¼ÔÈÖ¹æ¡¡¸¡º÷¥Á¥§¥Ã¥¯
           INITIALIZE                    HKNJAINF-REC
           MOVE    SPA-HOSPNUM            TO  HKNJA-HOSPNUM
           MOVE    SPA-PTKOH-FTNJANUM(IDX)
                                         TO  HKNJA-HKNJANUM
      *
           MOVE    HKNJAINF-REC        TO  MCPDATA-REC
           MOVE    "tbl_hknjainf"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknjainf"      TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-HKNJAINF-READ-SEC
           ELSE
               INITIALIZE                  HKNJAINF-REC
               MOVE    1               TO  FLG-HKNJAINF
           END-IF
           MOVE    "tbl_hknjainf"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           IF      FLG-HKNJAINF        =   ZERO
      *        ÊÝ¸±¼ÔÈÖ¹æ¤Î¸øÈñ¼ïÊÌ¤¬°ã¤¦»þ
               IF      HKNJA-HKNNUM    NOT =   SPA-GMN-KOHNUM (IDY)
                   MOVE    1               TO  FLG-HKNJAINF
               END-IF
           END-IF
      *
      *    ÊÝ¸±¼ÔÈÖ¹æ¤¢¤ê
           IF      FLG-HKNJAINF        =   ZERO
               MOVE    HKNJA-IDOYMD        TO  SPA-PTKOH-IDOYMD(IDY)
               MOVE    SPA-PTKOH-KEIFLG(IDX)
                                           TO  SPA-NAI-PTKOH-KEIFLG(IDY)
           ELSE
               MOVE    SPACE               TO  SPA-PTKOH-IDOYMD(IDY)
               MOVE    "1"                 TO  SPA-NAI-PTKOH-KEIFLG(IDY)
           END-IF
      *
      *!API
      *    API½èÍý¡Ê¿·µ¬ÆþÎÏ¤È¤¹¤ë¡Ë
           IF      FLG-APICHK          =   1
               MOVE    SPACE               TO  SPA-MAE-KOHNUM  (IDY)
               MOVE    SPACE               TO  SPA-MAE-FTNJANUM(IDY)
               MOVE    SPACE               TO  SPA-NAI-PTKOH-KEIFLG(IDY)
      *        ·Ù¹ð¥Á¥§¥Ã¥¯ºÑ¤ß¤È¤¹¤ë
               MOVE    1                   TO  SPA-NAI-AGE65 (IDY)
               MOVE    1                   TO  SPA-NAI-AGECHK(IDY)
               MOVE    1                   TO  SPA-NAI-FTNCHK(IDY)
      *        ¼õµë¼ÔÈÖ¹æ·Ù¹ð
               MOVE    1                   TO  SPA-NAI-JYUCHK(IDY)
           END-IF
      *!API
      *
           .
       3102-KOUHI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»É½¼¨¡Ê¸½ºßÂÐ¾ÝÊ¬¤Î¤ß¡Ë½èÍý
      *****************************************************************
       3103-HKNCOMB-PARA-SEC        SECTION.
      *
           INITIALIZE                  SPA-HKNCOMBI-AREA
           MOVE    ZERO                TO  IDX
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "HKNCOMBI"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           PERFORM
               UNTIL   (FLG-PARA       NOT =   ZERO      )  OR
                       (IDX                >=  15        )
               MOVE    PARA-DATA-REC       TO  HKNCOMBI-REC
      *
               IF     (COMB-DELKBN     NOT =   "1"       )  AND
                      (SPA-SYSYMD          >=  COMB-TEKSTYMD  AND
                       SPA-SYSYMD          <=  COMB-TEKEDYMD )
                   ADD     1               TO  SPA-HKNCOMBI-MAX
                   ADD     1               TO  IDX
      *
                   MOVE    COMB-HKNCOMBINUM    TO  SPA-GMN-THKNCOMBINUM
                                                              (IDX)
                   MOVE    COMB-HKNNUM         TO  SPA-GMN-THKNNUM
                                                              (IDX)
                   MOVE    COMB-HKNID          TO  SPA-GMN-THKNID
                                                              (IDX)
      *
                   MOVE    COMB-TEKSTYMD       TO  WRK-SYMD
                   PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
                   MOVE    WRK-HENYMD          TO  SPA-GMN-TTEKSTYMD
                                                              (IDX)
                   MOVE    COMB-TEKEDYMD       TO  WRK-SYMD
                   PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
                   MOVE    WRK-HENYMD          TO  SPA-GMN-TTEKEDYMD
                                                              (IDX)
      *
                   PERFORM 31031-HKNCOMBI-HEN-SEC
                   MOVE    WRK-HKNCOMBI        TO  SPA-GMN-THKNCOMBIMEI
                                                              (IDX)
      *            ÆâÉô
                   MOVE    COMB-TEKSTYMD       TO  SPA-NAI-TTEKSTYMD
                                                              (IDX)
                   MOVE    COMB-TEKEDYMD       TO  SPA-NAI-TTEKEDYMD
                                                              (IDX)
      *            ¥«¥ë¥ÆÍÑÊÝ¸±»ØÄê
                   MOVE    COMB-KOH1HKNNUM     TO  SPA-NAI-TKOH1HKNNUM
                                                              (IDX)
                   MOVE    COMB-KOH2HKNNUM     TO  SPA-NAI-TKOH2HKNNUM
                                                              (IDX)
                   MOVE    COMB-KOH3HKNNUM     TO  SPA-NAI-TKOH3HKNNUM
                                                              (IDX)
                   MOVE    COMB-KOH4HKNNUM     TO  SPA-NAI-TKOH4HKNNUM
                                                              (IDX)
               END-IF
      *
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *    Ï«ºÒÊÝ¸±¤Î»þ¥³¥á¥ó¥È¤òÉ½¼¨¤¹¤ë
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HKNCOMBI-MAX
      *        ÈóÉ½¼¨¶èÊ¬ÀßÄê
               PERFORM 3134-HKNCOMBI-HYOJI-SEC
      *
               IF      SPA-GMN-THKNNUM (IDX)   =   "971"
                                               OR  "973"
                   PERFORM 31032-RSI-HKNCOMBI-HEN-SEC
               END-IF
           END-PERFORM
      *
      *    ÊÝ¸±Å¬ÍÑÆü½ç¤Ë¥½¡¼¥È¤¹¤ë
           PERFORM 30133-HKNCOMBI-SORT-SEC
      *
           .
       3103-HKNCOMB-PARA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¥½¡¼¥È½èÍý
      *****************************************************************
       3134-HKNCOMBI-HYOJI-SEC             SECTION.
      *
           PERFORM VARYING     IDX5    FROM    1   BY  1
                   UNTIL      (IDX5        >   SPA-HYO-MAX )
               IF     (SPA-GMN-THKNCOMBINUM (IDX)
                                       =   SPA-HYO-HKNCOMBINUM(IDX5))
               AND    (SPA-GMN-THKNNUM  (IDX)
                                       =   SPA-HYO-HKNNUM     (IDX5))
               AND    (SPA-NAI-TKOH1HKNNUM (IDX)
                                       =   SPA-HYO-KOH1HKNNUM (IDX5))
               AND    (SPA-NAI-TKOH2HKNNUM (IDX)
                                       =   SPA-HYO-KOH2HKNNUM (IDX5))
               AND    (SPA-NAI-TKOH3HKNNUM (IDX)
                                       =   SPA-HYO-KOH3HKNNUM (IDX5))
               AND    (SPA-NAI-TKOH4HKNNUM (IDX)
                                       =   SPA-HYO-KOH4HKNNUM (IDX5))
                   MOVE    SPA-HYO-HYOJIKBN (IDX5)
                                           TO  SPA-NAI-THYOJIKBN (IDX)
                   MOVE    SPA-HYO-MAX     TO  IDX5
               END-IF
           END-PERFORM
      *
           .
       3134-HKNCOMBI-HYOJI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¥½¡¼¥È½èÍý
      *****************************************************************
       30133-HKNCOMBI-SORT-SEC             SECTION.
      *
      *    É½¼¨Ê¬¤Î¤ß¹Ô¤¦
           INITIALIZE                  WRK-HKNCOBMI-SORT-AREA
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   15
               MOVE    ALL "9"         TO  WRK-SRT-TEKISTYMD
               MOVE    ALL "9"         TO  WRK-SRT-HKNCOMBINUM
               MOVE    ZERO            TO  WRK-SRT-IDX
               PERFORM VARYING     IDX2    FROM    1   BY  1
                       UNTIL       IDX2     >   SPA-HKNCOMBI-MAX
                   IF      SPA-GMN-THKNCOMBINUM (IDX2) =   ZERO
                       OR (SPA-NAI-THYOJIKBN    (IDX2) =   "1"
                                                       OR  "2"
                                                       OR  "3"  )
                       CONTINUE
                   ELSE
                       PERFORM 301331-SORTSYORI-SEC
                   END-IF
               END-PERFORM
               IF      WRK-SRT-IDX     NOT =   ZERO
                   MOVE    SPA-GMN-HKNCOMBI-LIST (WRK-SRT-IDX)
                                       TO  WRK-GMN-HKNCOMBI-LIST(IDX)
                   INITIALIZE              SPA-GMN-HKNCOMBI-LIST
                                                         (WRK-SRT-IDX)
               END-IF
           END-PERFORM
      *
      *    ÈóÉ½¼¨Ê¬¤Î¤ß¹Ô¤¦
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   15
               MOVE    ALL "9"         TO  WRK-SRT-TEKISTYMD
               MOVE    ALL "9"         TO  WRK-SRT-HKNCOMBINUM
               MOVE    ZERO            TO  WRK-SRT-IDX
               PERFORM VARYING     IDX2    FROM    1   BY  1
                       UNTIL       IDX2     >   SPA-HKNCOMBI-MAX
                   IF      SPA-GMN-THKNCOMBINUM (IDX2) =   ZERO
                      AND (SPA-NAI-THYOJIKBN    (IDX2) =   SPACE )
                       CONTINUE
                   ELSE
                       PERFORM 301331-SORTSYORI-SEC
                   END-IF
               END-PERFORM
               IF      WRK-SRT-IDX     NOT =   ZERO
                   MOVE    SPA-GMN-HKNCOMBI-LIST (WRK-SRT-IDX)
                                       TO  WRK-GMN-HKNCOMBI02-LIST(IDX)
                   INITIALIZE              SPA-GMN-HKNCOMBI-LIST
                                                         (WRK-SRT-IDX)
               END-IF
           END-PERFORM
      *
      *    £Ó£Ð£ÁÊÔ½¸¡ÊÉ½¼¨Ê¬¡Ë
           MOVE    ZERO                TO   SPA-HKNCOMBI-MAX
           INITIALIZE                  SPA-HKNCOMBI-AREA
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   15
               IF      WRK-GMN-THKNCOMBINUM (IDX) NOT =   ZERO
                   ADD     1           TO   SPA-HKNCOMBI-MAX
                   MOVE    WRK-GMN-HKNCOMBI-LIST (IDX)
                                       TO  SPA-GMN-HKNCOMBI-LIST
                                                  (SPA-HKNCOMBI-MAX)
               END-IF
           END-PERFORM
      *    £Ó£Ð£ÁÊÔ½¸¡ÊÈóÉ½¼¨Ê¬¡Ë
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   15
               IF      WRK-GMN02-THKNCOMBINUM (IDX) NOT =   ZERO
                   ADD     1           TO   SPA-HKNCOMBI-MAX
                   MOVE    WRK-GMN-HKNCOMBI02-LIST (IDX)
                                       TO  SPA-GMN-HKNCOMBI-LIST
                                                  (SPA-HKNCOMBI-MAX)
               END-IF
           END-PERFORM
      *
           .
       30133-HKNCOMBI-SORT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»ÊÔ½¸½èÍý
      *****************************************************************
       301331-SORTSYORI-SEC             SECTION.
      *
           IF      WRK-SRT-TEKISTYMD   >   SPA-NAI-TTEKSTYMD  (IDX2)
               MOVE    IDX2                    TO  WRK-SRT-IDX
               MOVE    SPA-NAI-TTEKSTYMD (IDX2) TO  WRK-SRT-TEKISTYMD
               MOVE    SPA-GMN-THKNCOMBINUM(IDX2)
                                               TO  WRK-SRT-HKNCOMBINUM
           ELSE
               IF      WRK-SRT-TEKISTYMD   =   SPA-NAI-TTEKSTYMD(IDX2)
                   IF      WRK-SRT-HKNCOMBINUM
                                               >   SPA-GMN-THKNCOMBINUM
                                                              (IDX2)
                       MOVE    IDX2                TO  WRK-SRT-IDX
                       MOVE    SPA-NAI-TTEKSTYMD (IDX2)
                                                   TO  WRK-SRT-TEKISTYMD
                       MOVE    SPA-GMN-THKNCOMBINUM(IDX2)
                                                   TO
                                                   WRK-SRT-HKNCOMBINUM
                   END-IF
               END-IF
           END-IF
           .
       301331-SORTSYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»ÊÔ½¸½èÍý
      *****************************************************************
       31031-HKNCOMBI-HEN-SEC             SECTION.
      *
           MOVE    SPACE               TO  WRK-HKNCOMBI
      *
           STRING  COMB-SYU-TANSEIDONAME   DELIMITED  BY  SPACE
                   " "                     DELIMITED  BY  SIZE
                   COMB-KOH1-TANSEIDONAME  DELIMITED  BY  SPACE
                   " "                     DELIMITED  BY  SIZE
                   COMB-KOH2-TANSEIDONAME  DELIMITED  BY  SPACE
                   " "                     DELIMITED  BY  SIZE
                   COMB-KOH3-TANSEIDONAME  DELIMITED  BY  SPACE
                   " "                     DELIMITED  BY  SIZE
                   COMB-KOH4-TANSEIDONAME  DELIMITED  BY  SPACE
                         INTO              WRK-HKNCOMBI
           END-STRING
      *    ¼çÊÝ¸±¤¬¤Ê¤¤»þ
           IF      COMB-SYU-TANSEIDONAME   =   SPACE
               MOVE    SPACE               TO  WRK-HKNCOMBI
               STRING  COMB-KOH1-TANSEIDONAME  DELIMITED  BY  SPACE
                       " "                     DELIMITED  BY  SIZE
                       COMB-KOH2-TANSEIDONAME  DELIMITED  BY  SPACE
                       " "                     DELIMITED  BY  SIZE
                       COMB-KOH3-TANSEIDONAME  DELIMITED  BY  SPACE
                       " "                     DELIMITED  BY  SIZE
                       COMB-KOH4-TANSEIDONAME  DELIMITED  BY  SPACE
                         INTO              WRK-HKNCOMBI
               END-STRING
           END-IF
           .
       31031-HKNCOMBI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÊÝ¸±ÁÈ¹ç¤»ÊÔ½¸½èÍý
      *****************************************************************
       31032-RSI-HKNCOMBI-HEN-SEC      SECTION.
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTRSIINF"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           MOVE    SPACE               TO  WRK-HKNCOMBI
           PERFORM
               UNTIL   FLG-PARA            =   1
      *
               MOVE    PARA-DATA-REC       TO  PTRSIINF-REC
               IF      PTRSI-HKNID         =   SPA-GMN-THKNID (IDX)
                   IF      PTRSI-COMMENT       =   SPACE
                       MOVE    SPACE               TO  WRK-HKNCOMBI
                       MOVE    SPACE               TO  WRK-HKNKBN-MEI
                       EVALUATE    PTRSI-HKNKBN
                           WHEN    "1"
                               MOVE    "Ã»"        TO  WRK-HKNKBN-MEI
                           WHEN    "2"
                               MOVE    "½ý"        TO  WRK-HKNKBN-MEI
                           WHEN    "3"
                               MOVE    "¥¢"        TO  WRK-HKNKBN-MEI
                           WHEN    "5"
                               MOVE    "¸ø"        TO  WRK-HKNKBN-MEI
                       END-EVALUATE
                       STRING  SPA-GMN-THKNCOMBIMEI (IDX)
                                                   DELIMITED  BY  SPACE
                           " "                     DELIMITED  BY  SIZE
                           WRK-HKNKBN-MEI          DELIMITED  BY  SPACE
                           INTO              WRK-HKNCOMBI
                       END-STRING
                   ELSE
                       MOVE    SPACE               TO  WRK-HKNCOMBI
                       MOVE    SPACE               TO  WRK-HKNKBN-MEI
                       EVALUATE    PTRSI-HKNKBN
                           WHEN    "1"
                               MOVE    "Ã»"        TO  WRK-HKNKBN-MEI
                           WHEN    "2"
                               MOVE    "½ý"        TO  WRK-HKNKBN-MEI
                           WHEN    "3"
                               MOVE    "¥¢"        TO  WRK-HKNKBN-MEI
                           WHEN    "5"
                               MOVE    "¸ø"        TO  WRK-HKNKBN-MEI
                       END-EVALUATE
                       STRING  SPA-GMN-THKNCOMBIMEI (IDX)
                                                   DELIMITED  BY  SPACE
                           " "                     DELIMITED  BY  SIZE
                           WRK-HKNKBN-MEI          DELIMITED  BY  SPACE
                           "¡Ê"                    DELIMITED  BY  SIZE
                           PTRSI-COMMENT           DELIMITED  BY  SPACE
                           "¡Ë"                    DELIMITED  BY  SIZE
                           INTO              WRK-HKNCOMBI
                       END-STRING
                   END-IF
                   MOVE    WRK-HKNCOMBI    TO  SPA-GMN-THKNCOMBIMEI
                                                                   (IDX)
                   MOVE    1               TO  FLG-PARA
               END-IF
      *
               IF      FLG-PARA         =   ZERO
                   MOVE    "tbl_para"          TO  MCP-TABLE
                   MOVE    "key5"              TO  MCP-PATHNAME
                   PERFORM 990-PARA-READ-SEC
               END-IF
           END-PERFORM
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      WRK-HKNCOMBI        =   SPACE
               IF      SPA-NAI-RSIONLY     =   ZERO
                   MOVE    1               TO  SPA-NAI-RSIONLY
                   MOVE    "K120"          TO  SPA-ERRCD
               END-IF
           END-IF
           .
       31032-RSI-HKNCOMBI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÊÝ¸±¹¹¿·²èÌÌ½èÍý
      *****************************************************************
       4910-RSKOH-PARAOUT-SEC         SECTION.
      *    ½èÍý¤Ê¤·
           IF      SPA-RSPAR-FLG      =   "1"
               MOVE    8              TO  SPA-GMN-CUR
               GO      TO      4910-RSKOH-PARAOUT-EXT
           END-IF
      *
      *    ºï½ü½èÍý
           IF      SPA-NAI-SAKJOKBN    =   "1"
               MOVE    "/D"            TO  SPA-GMN-HKNJANUM(1:2)
               PERFORM 4101-KHNJANUM-CHK-SEC
           END-IF
      *    ÊÝ¸±²èÌÌ¤ÎÆâÍÆ¤ò£Ô£Â£Ì¤ØÊÔ½¸¤¹¤ë
           PERFORM 41031-HKN-SPA-TBL-SET-SEC
      *    ÅÐÏ¿¥Ü¥¿¥ó¤Ø
           MOVE    60                  TO  SPA-GMN-CUR
      *
           .
       4910-RSKOH-PARAOUT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       200-GMNSENI                   SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *    »àË´¶èÊ¬
               WHEN    "CLICKED"       ALSO    "P02_DEATHKBN"
                   PERFORM 490-DEATHKBN-SEC
      *    ÊÝ¸±ÁÈ¹ç¤»
               WHEN    "CLICKED"       ALSO    "B05"
                   MOVE    ZERO        TO  FLG-TOUROKU 
                   MOVE    1           TO  FLG-TOUROKU2
                   PERFORM 450-HKNCOMBI-SEC
      *    ÊÝ¸±ÄÉ²Ã
               WHEN    "CLICKED"       ALSO    "B06S"
                   PERFORM 460-HKN-TUIKA-SEC
      *    ¸øÈñÄÉ²Ã
               WHEN    "CLICKED"       ALSO    "B07S"
                   PERFORM 470-KOH-TUIKA-SEC
      *    ³ÎÄê
               WHEN    "CLICKED"       ALSO    "B12"
                   PERFORM 490-TOUROKU-SEC
      *    [Á°¢¬]²¡²¼
               WHEN    "CLICKED"       ALSO    "B06"
                   PERFORM 440-ZEN-GMNHYOUJI-SEC
      *    [¼¡¢­]²¡²¼
               WHEN    "CLICKED"       ALSO    "B07"
                   PERFORM 450-TUGI-GMNHYOUJI-SEC
      *    ÊÝ¸±¥Á¥§¥Ã¥¯
               WHEN    "CLICKED"       ALSO    "BH1"
                   PERFORM 450-HKNKAKUNINYMD-ZUMI-SEC
      *    Ï«ºÒ¡¦¼«ÇåÀÕÆþÎÏ²èÌÌ¤Ø
               WHEN    "CLICKED"       ALSO    "B09S"
                   PERFORM 481-ROUSAI-SEC
      *    ¸øÈñ¥Á¥§¥Ã¥¯
               WHEN    "CLICKED"       ALSO    "BK1"
               WHEN    "CLICKED"       ALSO    "BK2"
               WHEN    "CLICKED"       ALSO    "BK3"
                   PERFORM 460-KOHKAKUNINYMD-ZUMI-SEC
      *    ´ü¸ÂÀÚ¤ì¥Á¥§¥Ã¥¯
               WHEN    "CLICKED"       ALSO    "CK1"
               WHEN    "CLICKED"       ALSO    "CK2"
               WHEN    "CLICKED"       ALSO    "CK3"
                   PERFORM 460-TEKEDCHKKBN-CHK-SEC
      *!API
      *!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      *   APIÊÝ¸±¾ðÊó½èÍý
               WHEN    "CLICKED"       ALSO    "API"
                   MOVE    2           TO  FLG-TOUROKU 
                   MOVE    1           TO  FLG-TOUROKU2
                   PERFORM 4199-API-SYORI-SEC
      *!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      *!API
      *    ÊÌ²èÌÌ
               WHEN    "CLICKED"       ALSO     ANY
                   PERFORM 4101-BETUGAMEN-SEC
           END-EVALUATE
      *
           .
       200-GMNSENI-EXT.
           EXIT.
      *****************************************************************
      *    ²ñÏÃ¡¡½èÍý
      *****************************************************************
       200-ENTRY                   SECTION.
      *
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È
           PERFORM 400-GMN-INPUT-SEC
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *
           .
      *
       200-ENTRY-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È½èÍý
      *****************************************************************
       400-GMN-INPUT-SEC          SECTION.
      *
      *****MOVE    MCP-WIDGET          TO  WRK-MCP-WIDGET
           MOVE    MCP-WIDGET          TO  SPA-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN-CUR
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *    ÊÝ¸±ÁÈ¹ç¤»ÁªÂò
               WHEN    ANY             ALSO    "HKNLIST"
                   PERFORM 4001-HKNLIST-SEL-SEC
           END-EVALUATE
           .
      *
       400-GMN-INPUT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»ÁªÂò½èÍý
      *****************************************************************
       4001-HKNLIST-SEL-SEC          SECTION.
      *
      *    ¹ÔÁªÂò
           MOVE    ZERO                TO  WRK-SELNUM
           MOVE    ZERO                TO  WRK-GMN-SELNUM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   30
               IF      P02-HKNLIST-SELECT (IDX)    =   "T"
                   IF     (P02-HKNCOBNUM (IDX)     =   SPACE ) AND
                          (IDX                     >   1     )
                       MOVE    P02-HKNCOBNUM (IDX - 1) TO  WRK-SELNUM
                   ELSE
                       MOVE    P02-HKNCOBNUM (IDX)     TO  WRK-SELNUM
                   END-IF
                   IF     (WRK-SELNUM          NUMERIC   )  AND
                          (WRK-SELNUM      NOT =   SPA-GMN-SELNUM )
                       MOVE    WRK-SELNUM      TO  WRK-GMN-SELNUM
                   END-IF
               END-IF
           END-PERFORM
      *
           IF      WRK-GMN-SELNUM      >   ZERO
               MOVE    WRK-GMN-SELNUM      TO  P02-P02-SELNUM
               MOVE    38                  TO  SPA-GMN-CUR
           END-IF
      *
           .
      *
       4001-HKNLIST-SEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       410-INPUT-CHK-SEC          SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *    ´ðËÜ¥Á¥§¥Ã¥¯¤ÈÊÌ²èÌÌ½èÍý
           PERFORM 4102-KIHON-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               CONTINUE
           ELSE
               PERFORM 410-INPUT-CHK2-SEC
      *        ¥¿¥°ÀÚ¤êÂØ¤¨¤Î»þ¡¢´ü´Ö½ÅÊ£¤Ï¥¯¥ê¥¢¤¹¤ë
               IF     (SPA-TAGU-FLG        =   1 )
                   OR (FLG-ERRCHK          =   1 )
                   IF      SPA-ERRCD       =   "0064"  OR
                                               "0089"
                       MOVE   SPACE            TO  SPA-ERRCD
                   END-IF
               END-IF
           END-IF
      *
           .
      *
       410-INPUT-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ£Ó£Ð£ÁÊÔ½¸½èÍý
      *****************************************************************
       410-INPUT-CHK2-SEC          SECTION.
      *
      *    ÅÐÏ¿»þ¡¢É¬¿ÜÆþÎÏ¥Á¥§¥Ã¥¯
           IF      FLG-TOUROKU         =   1
               PERFORM 4109-TOUROKU-CHK-SEC
           END-IF
      *    ÊÝ¸±¡¦¸øÈñ¤Î¥Æ¡¼¥Ö¥ë¥»¥Ã¥È¤È¥Á¥§¥Ã¥¯
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-HKNKOH-FLG      =   1
                   PERFORM 4103-HKNKOH-TBL-SEC
               END-IF
           END-IF
      *
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )
               CONTINUE
           ELSE
      *
      *        ¸øÈñ¤ËÄÉ²Ã¤¬¤¢¤Ã¤¿»þ¡¢ºÇ½é¤Î£±¹Ô¤òÄÉ²Ã¤¹¤ë
               IF      FLG-KOH-ADD         =   1
                   PERFORM 4104-KOH-ADD-SEC
               END-IF
           END-IF
           .
      *
       410-INPUT-CHK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ£Ó£Ð£ÁÊÔ½¸½èÍý
      *****************************************************************
       4101-GMN-SPA-SET-SEC          SECTION.
      *
           MOVE    1                   TO  SPA-P02A-FLG1
           MOVE    1                   TO  SPA-P02A-FLG2
           MOVE    1                   TO  SPA-P02G-FLG
      *
      *    ¤«¤Ê»áÌ¾
           IF      P02-P02-KANANAME    =   SPA-MAE-KANANAME
               MOVE    ZERO                TO  FLG-IN-KANANAME
           ELSE
               MOVE    1                   TO  FLG-IN-KANANAME
               MOVE    ZERO                TO  SPA-NAI-KANAFLG
               MOVE    ZERO                TO  SPA-P02A-FLG1
               MOVE    ZERO                TO  SPA-P02A-FLG2
               MOVE    ZERO                TO  SPA-P02G-FLG
           END-IF
           MOVE    P02-P02-KANANAME    TO  SPA-GMN-KANANAME
      *    ´Á»ú»áÌ¾
           IF      P02-P02-NAME        =   SPA-MAE-NAME
               MOVE    ZERO                TO  FLG-IN-NAME
           ELSE
               MOVE    1                   TO  FLG-IN-NAME
               MOVE    ZERO                TO  SPA-P02A-FLG1
               MOVE    ZERO                TO  SPA-P02A-FLG2
               MOVE    ZERO                TO  SPA-P02G-FLG
           END-IF
           MOVE    P02-P02-NAME        TO  SPA-GMN-NAME
      *    »áÌ¾ÊÑ¹¹
           IF      SPA-GMN-NAME    NOT =   SPA-HZN-NAME
               MOVE    1                   TO  SPA-HEN-FLG
           END-IF
      *
           MOVE    P02-P02-NICKNAME    TO  SPA-GMN-NICKNAME
      *
           IF      P02-P02-SEX(1:1)    =   SPA-MAE-SEX
               MOVE    ZERO                TO  FLG-IN-SEX
           ELSE
               MOVE    1                   TO  FLG-IN-SEX
               MOVE    ZERO                TO  SPA-P02A-FLG2
               MOVE    ZERO                TO  SPA-P02G-FLG
           END-IF
           MOVE    P02-P02-SEX         TO  SPA-GMN-SEX-G
      *
           IF      P02-P02-BIRTHDAY    =   SPA-MAE-BIRTHDAY
               MOVE    ZERO                TO  FLG-IN-BIRTHDAY
           ELSE
               MOVE    1                   TO  FLG-IN-BIRTHDAY
               MOVE    ZERO                TO  SPA-P02A-FLG2
               MOVE    ZERO                TO  SPA-P02G-FLG
           END-IF
           MOVE    P02-P02-BIRTHDAY    TO  SPA-GMN-BIRTHDAYW
      *
           MOVE    P02-TSTPTNUMKBN     TO  SPA-GMN-TSTPTNUMKBN-G
           MOVE    P02-P02-HAKKO       TO  SPA-GMN-HAKKO-G
           MOVE    P02-P02-USERPG      TO  SPA-GMN-USERPG-G
      *
           IF      P02-P02-POST        =   SPA-MAE-POST
               MOVE    ZERO                TO  FLG-IN-POST
           ELSE
               MOVE    1                   TO  FLG-IN-POST
           END-IF
      *
           IF      P02-P02-DISCOUNTKBN(1:2)
                                           =   SPA-MAE-DISCOUNTKBN
               MOVE    ZERO                TO  FLG-IN-DISCOUNTKBN
           ELSE
               MOVE    1                   TO  FLG-IN-DISCOUNTKBN
           END-IF
      *
           MOVE    P02-P02-POST        TO  SPA-GMN-POST
           MOVE    P02-P02-ADRS        TO  SPA-GMN-EDITADRS-NAME
           MOVE    P02-P02-TEL2        TO  SPA-GMN-TEL2
           MOVE    P02-P02-BANTI       TO  SPA-GMN-BANTI
           MOVE    P02-P02-TEL1        TO  SPA-GMN-TEL1
           MOVE    P02-P02-SETAINUSI   TO  SPA-GMN-SETAINUSI
           MOVE    P02-P02-ZOKUGARA    TO  SPA-GMN-ZOKUGARA
           MOVE    P02-P02-DISCOUNTKBN TO  SPA-GMN-DISCOUNTKBN-G
           MOVE    P02-P02-DISCOUNT    TO  SPA-GMN-DISCOUNT
           MOVE    P02-P02-CONDITION1  TO  SPA-GMN-CONDITION(1)
           MOVE    P02-P02-CONDITION2  TO  SPA-GMN-CONDITION(2)
           MOVE    P02-P02-CONDITION3  TO  SPA-GMN-CONDITION(3)
           MOVE    P02-P02-NYUKIN      TO  SPA-GMN-NYUKIN-HOHO-G
           MOVE    P02-P02-SKYPRTFLG   TO  SPA-GMN-SKYPRTFLG-G
           MOVE    P02-P02-COMMENT1    TO  SPA-GMN-COMMENT-1
           MOVE    P02-P02-COMMENT2    TO  SPA-GMN-COMMENT-2
           MOVE    P02-P02-TABOO1      TO  SPA-GMN-TABOO-1
           MOVE    P02-P02-TABOO2      TO  SPA-GMN-TABOO-2
           MOVE    P02-P02-ALLERGY1    TO  SPA-GMN-ALLERGY-1
           MOVE    P02-P02-ALLERGY2    TO  SPA-GMN-ALLERGY-2
           MOVE    P02-P02-KANSENSYO1  TO  SPA-GMN-KANSENSYO-1
           MOVE    P02-P02-KANSENSYO2  TO  SPA-GMN-KANSENSYO-2
      *
           MOVE    P02-P02-SELNUM      TO  SPA-GMN-SELNUM
           MOVE    P02-P02-SRYKA       TO  SPA-GMN-SRYKA-G
      *    ÊÝ¸±¾ðÊó
           IF      SPA-MAE-HKNNUM      =   "971"
                                       OR  "973"
      *        Ï«ºÒ¤Î»þ¡¢ÊÝ¸±¾ðÊó¤ËÆþÎÏ¤¬¤Ê¤¤¤³¤È
               PERFORM 41011-ROUSAI-CHK-SEC
           ELSE
      *        ÊÝ¸±¼ÔÈÖ¹æÊÑ¹¹»þ¤Ë°ÛÆ°¥Á¥§¥Ã¥¯¤ò¥¯¥ê¥¢¤¹¤ë
               IF      P02-P02-HKNJANUM    NOT =   SPA-GMN-HKNJANUM
                   MOVE    SPACE               TO  SPA-HKNJA-KEIFLG
               END-IF
               IF      P02-P02-HONKZKBN(1:1)   NOT = SPA-GMN-HONKZKKBN
                   MOVE    SPA-GMN-HONKZKKBN   TO  SPA-MAE-HONKZKKBN
               END-IF
               MOVE    P02-P02-HKNJANUM    TO  SPA-GMN-HKNJANUM
               MOVE    P02-P02-HKNNUM      TO  SPA-GMN-HKNNUM-G
               MOVE    P02-P02-HONKZKBN    TO  SPA-GMN-HONKZKKBN-G
               MOVE    P02-P02-HOJOKBN     TO  SPA-GMN-HOJOKBN-G
               MOVE    P02-P02-CONTKBN     TO  SPA-GMN-CONTKBN-G
               MOVE    P02-P02-KIGO        TO  SPA-GMN-KIGO
               MOVE    P02-P02-NUM         TO  SPA-GMN-NUM
               MOVE    P02-P02-SKKGETYMD   TO  SPA-GMN-SKKGETYMD
      *        ³«»ÏÆüÊÑ¹¹¤Ç·Ù¹ð¥¯¥ê¥¢
               IF      P02-P02-HTEKSTYMD   NOT =   SPA-GMN-HTEKSTYMD
                   MOVE    ZERO                TO  SPA-ROU-KEIFLG
               END-IF
               MOVE    P02-P02-HTEKSTYMD   TO  SPA-GMN-HTEKSTYMD
               MOVE    P02-P02-HTEKEDYMD   TO  SPA-GMN-HTEKEDYMD
               MOVE    P02-P02-HIHKNJANAME TO  SPA-GMN-HIHKNJANAME
      *        ³ÎÇ§ÆüÊÑ¹¹¤Ç·Ù¹ð¥¯¥ê¥¢
               IF      P02-P02-HKAKUNINYMD NOT =   SPA-GMN-HKAKUNINYMD
                   MOVE    ZERO                TO  SPA-HKN-KAKUINFLG
               END-IF
               MOVE    P02-P02-HKAKUNINYMD TO  SPA-GMN-HKAKUNINYMD
      *
           END-IF
      *
      *    ÊÝ¸±¼ÔÈÖ¹æÊÑ¹¹»þ¤Ë°ÛÆ°¥Á¥§¥Ã¥¯¤ò¥¯¥ê¥¢¤¹¤ë
           IF      P02-P02-FTNJANUM1   NOT =   SPA-GMN-FTNJANUM (1)
               MOVE    SPACE               TO  SPA-NAI-PTKOH-KEIFLG(1)
           END-IF
           IF      P02-P02-FTNJANUM2   NOT =   SPA-GMN-FTNJANUM (2)
               MOVE    SPACE               TO  SPA-NAI-PTKOH-KEIFLG(2)
           END-IF
           IF      P02-P02-FTNJANUM3   NOT =   SPA-GMN-FTNJANUM (3)
               MOVE    SPACE               TO  SPA-NAI-PTKOH-KEIFLG(3)
           END-IF
      *    Ç¯Îð¥Á¥§¥Ã¥¯¤ò¥¯¥ê¥¢¤¹¤ë
           IF     (P02-P02-FTNJANUM1   NOT =   SPA-GMN-FTNJANUM (1)) OR
                  (P02-P02-KOHNUM1     NOT =   SPA-GMN-KOHNUM-G (1)) OR
                  (P02-P02-KTEKSTYMD1  NOT =   SPA-GMN-KTEKSTYMD(1)) OR
                  (P02-P02-KTEKEDYMD1  NOT =   SPA-GMN-KTEKEDYMD(1))
               MOVE    ZERO                TO  SPA-NAI-AGECHK   (1)
           END-IF
           IF     (P02-P02-FTNJANUM2   NOT =   SPA-GMN-FTNJANUM (2)) OR
                  (P02-P02-KOHNUM2     NOT =   SPA-GMN-KOHNUM-G (2)) OR
                  (P02-P02-KTEKSTYMD2  NOT =   SPA-GMN-KTEKSTYMD(2)) OR
                  (P02-P02-KTEKEDYMD2  NOT =   SPA-GMN-KTEKEDYMD(2))
               MOVE    ZERO                TO  SPA-NAI-AGECHK   (2)
           END-IF
           IF     (P02-P02-FTNJANUM3   NOT =   SPA-GMN-FTNJANUM (3)) OR
                  (P02-P02-KOHNUM3     NOT =   SPA-GMN-KOHNUM-G (3)) OR
                  (P02-P02-KTEKSTYMD3  NOT =   SPA-GMN-KTEKSTYMD(3)) OR
                  (P02-P02-KTEKEDYMD3  NOT =   SPA-GMN-KTEKEDYMD(3))
               MOVE    ZERO                TO  SPA-NAI-AGECHK   (3)
           END-IF
      *    ÉéÃ´¼ÔÈÖ¹æ·Ù¹ð¥¯¥ê¥¢¤¹¤ë
           IF     (P02-P02-FTNJANUM1   NOT =   SPA-GMN-FTNJANUM (1))
               MOVE    ZERO                TO  SPA-NAI-FTNCHK   (1)
           END-IF
           IF     (P02-P02-FTNJANUM2   NOT =   SPA-GMN-FTNJANUM (2))
               MOVE    ZERO                TO  SPA-NAI-FTNCHK   (2)
           END-IF
           IF     (P02-P02-FTNJANUM3   NOT =   SPA-GMN-FTNJANUM (3))
               MOVE    ZERO                TO  SPA-NAI-FTNCHK   (3)
           END-IF
      *    ¼õµë¼Ô¼ÔÈÖ¹æ·Ù¹ð¥¯¥ê¥¢¤¹¤ë
           IF     (P02-P02-JKYSNUM1    NOT =   SPA-GMN-JKYSNUM (1))
               MOVE    ZERO                TO  SPA-NAI-JYUCHK  (1)
           END-IF
           IF     (P02-P02-JKYSNUM2    NOT =   SPA-GMN-JKYSNUM (2))
               MOVE    ZERO                TO  SPA-NAI-JYUCHK  (2)
           END-IF
           IF     (P02-P02-JKYSNUM3    NOT =   SPA-GMN-JKYSNUM (3))
               MOVE    ZERO                TO  SPA-NAI-JYUCHK  (3)
           END-IF
      *    ¸øÈñ£±
           MOVE    P02-P02-FTNJANUM1   TO  SPA-GMN-FTNJANUM (1)
           MOVE    P02-P02-KOHNUM1     TO  SPA-GMN-KOHNUM-G (1)
           MOVE    P02-P02-JKYSNUM1    TO  SPA-GMN-JKYSNUM  (1)
           IF      P02-P02-KTEKSTYMD1  NOT =   SPA-GMN-KTEKSTYMD (1)
               MOVE    ZERO             TO  SPA-NAI-AGE65    (1)
           END-IF
           MOVE    P02-P02-KTEKSTYMD1  TO  SPA-GMN-KTEKSTYMD (1)
           MOVE    P02-P02-KTEKEDYMD1  TO  SPA-GMN-KTEKEDYMD (1)
           IF      P02-P02-KKAKUNINYMD1
                                   NOT =   SPA-GMN-KKAKUNINYMD(1)
               MOVE    ZERO            TO  SPA-KOH-KAKUINFLG (1)
           END-IF
           MOVE    P02-P02-KKAKUNINYMD1
                                       TO  SPA-GMN-KKAKUNINYMD(1)
      *    ¸øÈñ£²
           MOVE    P02-P02-FTNJANUM2   TO  SPA-GMN-FTNJANUM (2)
           MOVE    P02-P02-KOHNUM2     TO  SPA-GMN-KOHNUM-G (2)
           MOVE    P02-P02-JKYSNUM2    TO  SPA-GMN-JKYSNUM  (2)
           IF      P02-P02-KTEKSTYMD2  NOT =   SPA-GMN-KTEKSTYMD (2)
               MOVE    ZERO             TO  SPA-NAI-AGE65    (2)
           END-IF
           MOVE    P02-P02-KTEKSTYMD2  TO  SPA-GMN-KTEKSTYMD (2)
           MOVE    P02-P02-KTEKEDYMD2  TO  SPA-GMN-KTEKEDYMD (2)
           IF      P02-P02-KKAKUNINYMD2
                                   NOT =   SPA-GMN-KKAKUNINYMD(2)
               MOVE    ZERO            TO  SPA-KOH-KAKUINFLG (2)
           END-IF
           MOVE    P02-P02-KKAKUNINYMD2
                                       TO  SPA-GMN-KKAKUNINYMD(2)
      *    ¸øÈñ£³
           MOVE    P02-P02-FTNJANUM3   TO  SPA-GMN-FTNJANUM (3)
           MOVE    P02-P02-KOHNUM3     TO  SPA-GMN-KOHNUM-G (3)
           MOVE    P02-P02-JKYSNUM3    TO  SPA-GMN-JKYSNUM  (3)
           IF      P02-P02-KTEKSTYMD3  NOT =   SPA-GMN-KTEKSTYMD (3)
               MOVE    ZERO             TO  SPA-NAI-AGE65    (3)
               MOVE    ZERO             TO  SPA-NAI-AGECHK   (3)
           END-IF
           MOVE    P02-P02-KTEKSTYMD3  TO  SPA-GMN-KTEKSTYMD (3)
           MOVE    P02-P02-KTEKEDYMD3  TO  SPA-GMN-KTEKEDYMD (3)
           IF      P02-P02-KKAKUNINYMD3
                                   NOT =   SPA-GMN-KKAKUNINYMD(3)
               MOVE    ZERO            TO  SPA-KOH-KAKUINFLG (3)
           END-IF
           MOVE    P02-P02-KKAKUNINYMD3
                                       TO  SPA-GMN-KKAKUNINYMD(3)
           .
      *
       4101-GMN-SPA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒ¤ÎÊÝ¸±¾ðÊóÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       41011-ROUSAI-CHK-SEC          SECTION.
      *
           IF     (P02-P02-HKNJANUM    =   SPA-GMN-HKNJANUM ) AND
                  (P02-P02-HKNNUM      =   SPA-GMN-HKNNUM-G ) AND
                  (P02-P02-HONKZKBN    =   SPA-GMN-HONKZKKBN-G) AND
                  (P02-P02-HOJOKBN     =   SPA-GMN-HOJOKBN-G) AND
                  (P02-P02-CONTKBN     =   SPA-GMN-CONTKBN-G) AND
                  (P02-P02-KIGO        =   SPA-GMN-KIGO     ) AND
                  (P02-P02-NUM         =   SPA-GMN-NUM      ) AND
                  (P02-P02-SKKGETYMD   =   SPA-GMN-SKKGETYMD) AND
                  (P02-P02-HTEKSTYMD   =   SPA-GMN-HTEKSTYMD) AND
                  (P02-P02-HTEKEDYMD   =   SPA-GMN-HTEKEDYMD) AND
                  (P02-P02-HIHKNJANAME =   SPA-GMN-HIHKNJANAME) AND
                  (P02-P02-HKAKUNINYMD =   SPA-GMN-HKAKUNINYMD)
               MOVE    ZERO                TO  FLG-IN-HKN
           ELSE
               MOVE    P02-P02-HKNJANUM    TO  SPA-GMN-HKNJANUM
               MOVE    1                   TO  FLG-IN-HKN
           END-IF
           .
      *
       41011-ROUSAI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´ðËÜ¥Á¥§¥Ã¥¯¤ÈÊÌ²èÌÌ½èÍý
      *****************************************************************
       4102-KIHON-CHK-SEC          SECTION.
      *
      *    ¥«¥Ê»áÌ¾
           PERFORM 4101-KANANAME-CHK-SEC
      *
      *    ´Á»ú»áÌ¾
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-NAME-CHK-SEC
           END-IF
      *
      *    À­ÊÌ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SEX-CHK-SEC
           END-IF
      *    À¸Ç¯·îÆü
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-BIRTHDAY-CHK-SEC
           END-IF
      *    ÄÌ¾Î
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-NICKNAME-CHK-SEC
           END-IF
      *    ¥Æ¥¹¥È´µ¼Ô
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-TSTPTNUMKBN-CHK-SEC
           END-IF
      *    ¥«¥ë¥ÆÈ¯¹Ô
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-HAKKO-CHK-SEC
           END-IF
      *    £Õ¡¦£Ð¥Á¥§¥Ã¥¯½èÍý
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-USERPG-CHK-SEC
           END-IF
      *    ÊÝ¸±¼ÔÈÖ¹æ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-KHNJANUM-CHK-SEC
           END-IF
      *
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               IF      FLG-HKN-DEL         =   ZERO
      *            ÊÝ¸±¾ðÊó¥Á¥§¥Ã¥¯¥µ¥Ö
                   CALL    "ORCSP03A"      USING   SPA-AREA
                                                   SPA-P02SCRAREA
                                                   SPA-P02KYOUTU
      *            ¥¿¥°ÀÚ¤êÂØ¤¨¤Î»þ¡¢´ü´Ö½ÅÊ£¤Ï¥¯¥ê¥¢¤¹¤ë
                   IF     (SPA-TAGU-FLG        =   1 )
                       OR (FLG-ERRCHK          =   1 )
                       IF      SPA-ERRCD       =   "0064"  OR
                                                   "0089"
                           MOVE   SPACE            TO  SPA-ERRCD
                       END-IF
                       IF      SPA-PIDCD   NOT =   SPACE
                           MOVE   SPACE            TO  SPA-PIDCD
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
      *    ¸øÈñ
           PERFORM 4102-KOH-CHKALL-SEC
      *
      *    ¸øÈñ¾ðÊó¥Á¥§¥Ã¥¯¥µ¥Ö
           CALL    "ORCSP03B"          USING   SPA-AREA
                                               SPA-P02SCRAREA
                                               SPA-P02KYOUTU
      *    ¥¿¥°ÀÚ¤êÂØ¤¨¤Î»þ¡¢´ü´Ö½ÅÊ£¤Ï¥¯¥ê¥¢¤¹¤ë
           IF      SPA-TAGU-FLG        =   1
               OR (FLG-ERRCHK          =   1 )
               IF      SPA-ERRCD       =   "0088"  OR
                                           "0089"
                   MOVE   SPACE            TO  SPA-ERRCD
               END-IF
               IF      SPA-PIDCD   NOT =   SPACE
                   MOVE   SPACE            TO  SPA-PIDCD
               END-IF
           END-IF
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
      *    Í¹ÊØÈÖ¹æ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-POST-CHK-SEC
           END-IF
      *    ½»½ê
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-ADRS-CHK-SEC
           END-IF
      *    ÈÖÃÏÊý½ñ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-BANTI-CHK-SEC
           END-IF
      *    À¤ÂÓ¼ç
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SETAINUSI-CHK-SEC
           END-IF
      *    Â³ÊÁ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-ZOKUGARA-CHK-SEC
           END-IF
      *    ¸ºÌÈ»öÍ³
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-DISCOUNTKBN-CHK-SEC
           END-IF
      *    ³ä°úÎ¨
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-DISCOUNT-CHK-SEC
           END-IF
      *    Æþ¶âÊýË¡
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-NYUKIN-HOHO-CHK-SEC
           END-IF
      *    ¾õÂÖ£±¤«¤é£³
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-CONDITIONH-SET-SEC
           END-IF
      *    ¾õÂÖ£±¤«¤é£³
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-CONDITIONH-SET-SEC
           END-IF
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SKYPRTFLG-CHK-SEC
           END-IF
      *    ¶Ø´÷Â¾
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-COMMENT-CHK-SEC
           END-IF
      *    ÊÝ¸±ÁÈ¹ç¤»ÁªÂò
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SELNUM-CHK-SEC
           END-IF
      *    ¿ÇÎÅ²ÊÁªÂò
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SRYKA-CHK-SEC
           END-IF
           .
      *
       4102-KIHON-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±¼ÔÈÖ¹æÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-KHNJANUM-CHK-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-HKN-DEL
      *    Ï«ºÒ¤ÇÆþÎÏ¤¬¤¢¤Ã¤¿»þ¡¢¥¨¥é¡¼
           IF      FLG-IN-HKN          =   1
      *
               EVALUATE    SPA-GMN-HKNJANUM(1:2)
                   WHEN    "/A"
                   WHEN    "/a"
      *                ÄÉ²Ã¤Ï£Ï£Ë
                       INITIALIZE                  SPA-GMN-HKN-AREA
                       MOVE    ZERO                TO  SPA-NAI-HKNSTR
                       MOVE    8                   TO  SPA-GMN-CUR
                       MOVE    1                   TO  FLG-HKN-DEL
                   WHEN    "/D"
                   WHEN    "/d"
      *                ºï½ü¤ÏÏ«ºÒÊÝ¸±²èÌÌ¤Ø
                       MOVE    SPACE               TO  SPA-GMN-HKNJANUM
                       MOVE    "0043"              TO  SPA-ERRCD
                       MOVE    61                  TO  SPA-GMN-CUR
                   WHEN    OTHER
                       MOVE    SPACE               TO  SPA-GMN-HKNJANUM
                       MOVE    "0043"              TO  SPA-ERRCD
                       MOVE    61                  TO  SPA-GMN-CUR
               END-EVALUATE
               GO      TO      4101-KHNJANUM-CHK-EXT
           END-IF
      *    ºï½ü¤ÎÈ½Äê
           IF      SPA-GMN-HKNJANUM(1:2)   =   "/D"  OR  "/d"
      *D       Ï«ºÒ¤Î»þ¡¢Ï«ºÒÊÝ¸±²èÌÌ¤Ø
      *        IF      SPA-GMN-HKNNUM      =   "971"
      *                                    OR  "973"
      *            MOVE    "0043"          TO  SPA-ERRCD
      *            MOVE    61              TO  SPA-GMN-CUR
      *            GO      TO      4101-KHNJANUM-CHK-EXT
      *D       END-IF
      *        ¿·µ¬¤Î»þ¡¢£Ô£Â£Ì¤âºï½ü
               IF     (SPA-NAI-HKNSTR      >   ZERO      ) AND
                      (SPA-PTHKN-SINKIKBN (SPA-NAI-HKNSTR)
                                           =    "1"           )
                   MOVE    SPACE           TO  SPA-PTHKNINF-TBL
                                                     (SPA-NAI-HKNSTR)
                   INITIALIZE                  SPA-PTHKNINF-TBL
                                                     (SPA-NAI-HKNSTR)
      *            ÊÝ¸±¥Æ¡¼¥Ö¥ë¶õÇò¹Ôºï½ü½èÍý
                   PERFORM 410311-HKNTBL-DEL-SEC
               ELSE
                   IF      SPA-NAI-HKNSTR      >   ZERO
                       MOVE    "1"             TO  SPA-PTHKN-SAKJOKBN
                                                       (SPA-NAI-HKNSTR)
                       MOVE    "1"             TO  SPA-NAI-SAKJOKBN
                   END-IF
               END-IF
               MOVE    1                   TO  FLG-HKN-DEL
               INITIALIZE                  SPA-GMN-HKN-AREA
               IF      SPA-NAI-HKNSTR      =   ZERO
                   MOVE    1               TO  SPA-NAI-HKNSTR
               END-IF
      *        ¼¡¤ÎÂÐ¾Ý¤òÉ½¼¨¤¹¤ë
      *        ÊÝ¸±¾ðÊó£Ô£Â£Ì¤«¤éÊÔ½¸
               PERFORM 3101-HKN-TBL-SPA-SEC
               MOVE    8                   TO  SPA-GMN-CUR
               GO      TO      4101-KHNJANUM-CHK-EXT
           END-IF
      *
      *    ÄÉ²Ã¤ÎÈ½Äê
           IF      SPA-GMN-HKNJANUM(1:2)   =   "/A"  OR  "/a"
               INITIALIZE                  SPA-GMN-HKN-AREA
               MOVE    ZERO                TO  SPA-NAI-HKNSTR
               MOVE    8                   TO  SPA-GMN-CUR
               MOVE    1                   TO  FLG-HKN-DEL
           END-IF
      *    Ê£¼Ì¤ÎÈ½Äê
           IF      SPA-GMN-HKNJANUM(1:2)   =   "/C"  OR  "/c"
      *        Êä½õ¶èÊ¬¡¢Í­¸ú´ü´Ö¤ÏÊ£¼Ì¤·¤Ê¤¤
               MOVE    SPA-NAI-HKNSTR      TO  IDX
               MOVE    SPA-PTHKN-HKNJANUM(IDX) TO  SPA-GMN-HKNJANUM
               MOVE    SPACE               TO  SPA-GMN-HTEKSTYMD
               MOVE    SPACE               TO  SPA-GMN-HTEKEDYMD
               MOVE    SPACE               TO  SPA-GMN-HOJOKBN-G
               MOVE    SPACE               TO  SPA-GMN-HKAKUNINYMD
               MOVE    ZERO                TO  SPA-NAI-HKNID
               MOVE    SPACE               TO  SPA-NAI-HTEKSTYMD
               MOVE    SPACE               TO  SPA-NAI-HTEKEDYMD
               MOVE    SPACE               TO  SPA-NAI-HKAKUNINYMD
               INITIALIZE                  SPA-MAE-HKN-AREA
               MOVE    ZERO                TO  SPA-NAI-HKNSTR
               MOVE    8                   TO  SPA-GMN-CUR
               MOVE    1                   TO  FLG-HKN-DEL
           END-IF
      *
           .
       4101-KHNJANUM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4102-KOH-CHKALL-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-KOH-ADD
           MOVE    ZERO                TO  FLG-KOH-DEL
      *    ºï½ü¤ÎÈ½Äê
           PERFORM VARYING     IDX-K   FROM    1   BY  1
                   UNTIL       IDX-K   >   3
               PERFORM 41021-KOH-DEL-CHK-SEC
           END-PERFORM
      *    £Â£°£·£Ó²¡²¼»þ¡¢ºÇ¸å¤Î¹Ô¤¬ÆþÎÏºÑ¤ß¤Ç¤¢¤ë¤³¤È
           IF      FLG-KOH-ADD2        =   1
               IF     (SPA-GMN-KOHNUM(3)    NOT =   SPACE ) AND
                      (SPA-GMN-KTEKSTYMD(3) NOT =   SPACE )
                   MOVE    1                TO  FLG-KOH-ADD
               END-IF
           END-IF
      *
      *    ²èÌÌ¤Î¶õÇò¹Ô¤ò¤Ä¤á¤ë
           PERFORM 41022-PTKOH-TBL-SET-SEC
      *    ¼¡¤Î¥Ç¡¼¥¿¤òÊÔ½¸¤¹¤ë
      **** IF      FLG-KOH-DEL         =   1
           IF      SPA-KOH-MAX         <   3
               PERFORM 41023-PTKOH-SAI-SET-SEC
           END-IF
      **** END-IF
           .
      *
       4102-KOH-CHKALL-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¸øÈñºï½ü½èÍý
      ****************************************************************
       41021-KOH-DEL-CHK-SEC      SECTION.
      *
      *    ºï½ü¤ÎÈ½Äê
           IF      SPA-GMN-FTNJANUM(IDX-K)(1:2)
                                        =   "/D"  OR  "/d"
               MOVE    SPA-NAI-PTKOH-EDANUM(IDX-K)  TO  IDX-KOH
      *        ¿·µ¬¤Î»þ¡¢£Ô£Â£Ì¤âºï½ü
               IF     (IDX-KOH             >   ZERO      ) AND
                      (SPA-PTKOH-SINKIKBN (IDX-KOH)
                                           =    "1"      )
                   MOVE    SPACE           TO  SPA-PTKOHINF-TBL
                                                     (IDX-KOH)
                   INITIALIZE                  SPA-PTKOHINF-TBL
                                                     (IDX-KOH)
               ELSE
                   IF      IDX-KOH         >   ZERO
                       MOVE    "1"             TO  SPA-PTKOH-SAKJOKBN
                                                       (IDX-KOH)
                   END-IF
               END-IF
               MOVE    1                   TO  FLG-KOH-DEL
               INITIALIZE                  SPA-GMN-KOH-TBL(IDX-K)
               EVALUATE    IDX-K
                   WHEN    1
                       MOVE    20          TO  SPA-GMN-CUR
                   WHEN    2
                       MOVE    26          TO  SPA-GMN-CUR
                   WHEN    3
                        MOVE    32          TO  SPA-GMN-CUR
               END-EVALUATE
           END-IF
      *    ÄÉ²Ã¤ÎÈ½Äê¡Ê¤É¤Î¹Ô¤ÇÆþÎÏ¤µ¤ì¤Æ¤â¡¢ºÇ½é¤Î1¹Ô¤Î¤ß¤ò³«¤±¤ë¡Ë
           IF      SPA-GMN-FTNJANUM(IDX-K)(1:2)
                                        =   "/A"  OR  "/a"
      *        ºÇ¸å¤Î¹Ô¤¬ÆþÎÏºÑ¤ß¤Ç¤¢¤ë¤³¤È
               IF     (SPA-GMN-KOHNUM(3)    NOT =   SPACE ) AND
                      (SPA-GMN-KTEKSTYMD(3) NOT =   SPACE )
                   MOVE    1                TO  FLG-KOH-ADD
               END-IF
               MOVE    SPA-MAE-FTNJANUM(IDX-K)
                                        TO  SPA-GMN-FTNJANUM(IDX-K)
               EVALUATE    IDX-K
                   WHEN    1
                       MOVE    20          TO  SPA-GMN-CUR
                   WHEN    2
                       MOVE    26          TO  SPA-GMN-CUR
                   WHEN    3
                       MOVE    32          TO  SPA-GMN-CUR
               END-EVALUATE
           END-IF
           .
      *
       41021-KOH-DEL-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¸øÈñ¶õÇòºï½üÊÔ½¸½èÍý
      ****************************************************************
       41022-PTKOH-TBL-SET-SEC      SECTION.
      *
           MOVE    SPA-GMN-KOH-AREA    TO  WRK-GMN-KOH-AREA
           INITIALIZE                      SPA-GMN-KOH-AREA
           MOVE    ZERO                TO  IDX-K
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   3
              IF      WRK-GMN-HOK-G (IDX)  NOT =   SPACE
                   ADD     1               TO  IDX-K
                   MOVE    WRK-GMN-KOH-TBL (IDX)
                                           TO  SPA-GMN-KOH-TBL (IDX-K)
               END-IF
           END-PERFORM
      *    ºÇÂç¤òÊÔ½¸¤¹¤ë
           MOVE    IDX-K               TO  SPA-KOH-MAX
           .
      *
       41022-PTKOH-TBL-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¸øÈñºï½üÊÔ½¸½èÍý
      ****************************************************************
       41023-PTKOH-SAI-SET-SEC      SECTION.
      *
      *    ¶õ¤¤¤¿¹Ô¤Ø¼¡¤®¤Î¥Ç¡¼¥¿¤òÊÔ½¸¤¹¤ë
           MOVE    SPA-KOH-MAX         TO  IDX-K
           IF      IDX-K               =   ZERO
               MOVE    1                   TO  IDX-K2
           ELSE
               IF      (SPA-NAI-PTKOH-EDANUM(IDX-K) NOT =   ZERO)
                   MOVE    SPA-NAI-PTKOH-EDANUM(IDX-K) TO  IDX-K2
                   ADD     1                   TO  IDX-K2
               ELSE
      *********    MOVE    4                   TO  IDX-K2
                   COMPUTE IDX-K2              =   SPA-PTKOH-MAX + 1
               END-IF
           END-IF
           MOVE    IDX-K               TO  IDY
           PERFORM VARYING     IDX     FROM    IDX-K2 BY  1
                   UNTIL      (IDX     >   SPA-PTKOH-MAX )  OR
                              (IDY     >=  3    )
               IF     (SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE) AND
                      (SPA-PTKOH-KOHNUM (IDX)  NOT =   SPACE )
                   ADD     1                   TO  IDY
                   MOVE    IDY                 TO  SPA-KOH-MAX
                   PERFORM 3102-KOUHI-HEN-SEC
               END-IF
           END-PERFORM
      *
           .
      *
       41023-PTKOH-SAI-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¥«¥Ê»áÌ¾¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4101-KANANAME-CHK-SEC      SECTION.
      *
           IF      SPA-GMN-KANANAME    =   SPACE
               MOVE    SPA-GMN-KANANAME    TO  SPA-MAE-KANANAME
               GO      TO      4101-KANANAME-CHK-EXT
           END-IF
      *
      *    È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤Ø
           MOVE    SPA-GMN-KANANAME    TO  WRK-MAE-INPUT
           MOVE    50                  TO  WRK-LEN
           PERFORM 890-HALF-ZEN-SEC
           MOVE    WRK-ATO-INPUT       TO  SPA-GMN-KANANAME
           IF      FLG-ERR             =   1
               MOVE    "0025"              TO  SPA-ERRCD
               MOVE    1                   TO  SPA-GMN-CUR
               GO      TO      4101-KANANAME-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-KANANAME    TO  SPA-MAE-KANANAME
      *    ¥«¥¿¥«¥Ê¤Î¤ß¤ÎÈ½Äê
           MOVE    ZERO                TO  FLG-KANA
           PERFORM VARYING     IDX     FROM    1   BY  2
                   UNTIL      (IDX     >=   50  )  OR
                              (SPA-GMN-KANANAME(IDX:1) =  SPACE)
               IF     (SPA-GMN-KANANAME (IDX:2)
                                       =   "¡¡" 
                                       OR  "¡¼" 
                                       OR  "¡Ý"  )  OR
                      (SPA-GMN-KANANAME (IDX:2)
                                       >=  "¥¡"  AND
                                       <=  "¥ö"   )  OR
                      (SPA-GMN-KANANAME (IDX:2)
                                       >=  "£°"  AND
                                       <=  "£ú"   )
                   CONTINUE
               ELSE
                   MOVE    1               TO  FLG-KANA
               END-IF
           END-PERFORM
           IF      FLG-KANA            =   1
               IF      SPA-NAI-KANAFLG     =   ZERO
                   MOVE    "K101"              TO  SPA-ERRCD
                   MOVE    1                   TO  SPA-GMN-CUR
                   MOVE    1                   TO  SPA-NAI-KANAFLG
                   GO      TO      4101-KANANAME-CHK-EXT
               END-IF
           END-IF
      *
      *    ´Á»ú»áÌ¾¸¡º÷½èÍý
           IF     (FLG-IN-KANANAME         =   1    )  AND
                  (SPA-GMN-KANANAME    NOT =   SPA-GMN-OLD-KANANAME)
      *        ¿ÍÌ¾¼­½ñÉÔ»ÈÍÑ¤Î¾ì¹ç
               IF      SPA-NAI-JINMEI-USE  =   "1"
                   MOVE    SPA-GMN-KANANAME
                                           TO  SPA-GMN-OLD-KANANAME
                   MOVE    SPA-GMN-NAME    TO  SPA-GMN-OLD-NAME
               ELSE
      *            £Ñ£Ò¤«¤é¤Î½é´üÉ½¼¨
                   IF      SPA-QR-FLG          =   2
                       MOVE    SPACE               TO  SPA-MAE-KANANAME
                   ELSE
                       PERFORM 4101-KANJI-NAME-EDIT-SEC
                   END-IF
               END-IF
           END-IF
      *
           .
       4101-KANANAME-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ´Á»ú»áÌ¾¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4101-NAME-CHK-SEC      SECTION.
      *
           IF      SPA-GMN-NAME    NOT =   SPACE
      *        È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤Ø
               MOVE    SPA-GMN-NAME        TO  WRK-MAE-INPUT
               MOVE    50                  TO  WRK-LEN
               PERFORM 891-HALF-ZEN2-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-NAME
               IF      FLG-ERR             =   1
                   MOVE    "0026"              TO  SPA-ERRCD
                   MOVE    2                   TO  SPA-GMN-CUR
                   GO      TO      4101-NAME-CHK-EXT
               END-IF
           END-IF
      *
      *    »áÌ¾ÊÑ¹¹»þ¡¢ÊÝ¸±ËÜ¿Í¤òÉ½¼¨Ãæ¤Î¾ì¹ç
           IF     (SPA-HEN-FLG         =   1   )    AND
                  (SPA-GMN-HKNNUM  NOT =   SPACE )  AND
                  (SPA-GMN-HONKZKKBN   =   "1"   )  AND
                  (SPA-GMN-HIHKNJANAME NOT =   SPACE )
      *        ËÜ¿Í¤Î¾ì¹ç¡¢»áÌ¾¤òÊÔ½¸¤¹¤ë
               IF      (SPA-HZN-NAME       =   SPA-GMN-HIHKNJANAME) OR
                       (SPA-MAE-NAME       =   SPA-GMN-HIHKNJANAME)
                   MOVE    SPA-GMN-NAME    TO  SPA-GMN-HIHKNJANAME
               END-IF
           END-IF
      *
      *
           MOVE    SPA-GMN-NAME        TO  SPA-MAE-NAME
      *    ¸«½Ð¤·¤Ø
           MOVE    SPA-GMN-NAME        TO  SPA-GMN-NAMEH
      *    À¤ÂÓ¼ç¤Ø
           IF      SPA-GMN-SETAINUSI   =   SPACE
               IF      SPA-NAI-SETAIKBN-FLG    =   "1"
                   MOVE    SPA-GMN-NAME        TO  SPA-GMN-SETAINUSI
               END-IF
           END-IF
      *
      *    Æ±À«Æ±Ì¾
           IF      (SPA-P02A-FLG1      =   ZERO  )  AND
                  ((SPA-MCP-WIDGET NOT =   "P02_KANANAME" ) OR
                   (SPA-NAI-JINMEI-USE NOT =   "1"   ))
               MOVE    1               TO  FLG-P02A-SYORI
               MOVE    1               TO  SPA-P02A-FLG1
      *        Æ±À«Æ±Ì¾¥Á¥§¥Ã¥¯¤¢¤ê
               IF      SPA-NAI-DOUMEI-CHKFLG   =   ZERO
                   PERFORM 41012-NIJYU-TRKGMN-SEC
               END-IF
           END-IF
      *
           .
       4101-NAME-CHK-EXT.
           EXIT.
      ****************************************************************
      *    À­ÊÌ¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4101-SEX-CHK-SEC      SECTION.
      *
           EVALUATE    SPA-GMN-SEX
               WHEN    "1"
                   MOVE    "ÃË"            TO  SPA-GMN-SEXH
                   MOVE    SPA-GMN-SEX     TO  SPA-MAE-SEX
               WHEN    "2"
                   MOVE    "½÷"            TO  SPA-GMN-SEXH
                   MOVE    SPA-GMN-SEX     TO  SPA-MAE-SEX
               WHEN    SPACE
                   CONTINUE
               WHEN    OTHER
                   MOVE    "0021"          TO  SPA-ERRCD
                   MOVE    3               TO  SPA-GMN-CUR
           END-EVALUATE
      *
           .
       4101-SEX-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    À¸Ç¯·îÆü¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4101-BIRTHDAY-CHK-SEC           SECTION.
      *
           IF      SPA-GMN-BIRTHDAYW   =   SPACE
               GO      TO      4101-BIRTHDAY-CHK-EXT
           END-IF
      *
      *    ÆüÉÕ²èÌÌ¥Á¥§¥Ã¥¯¥µ¥Ö
           INITIALIZE                      ORCSGDAYAREA
           MOVE    SPA-GMN-BIRTHDAYW   TO  SGDAY-INDAY
      *!!
           MOVE    SPA-SYSYMD          TO  SGDAY-SYSYMD
           MOVE    "2"                 TO  SGDAY-SYSKBN
           CALL    "ORCSGDAY"          USING
                                       ORCSGDAYAREA
           IF      SGDAY-RC            =   ZERO
               MOVE    SGDAY-OTDAY         TO  SPA-GMN-BIRTHDAYW
               MOVE    SGDAY-SDAY          TO  SPA-NAI-BIRTHDAY
               MOVE    SGDAY-SDAY          TO  WRK-SYMD
           ELSE
               MOVE    "0028"              TO  SPA-ERRCD
               MOVE    4                   TO  SPA-GMN-CUR
               GO      TO      4101-BIRTHDAY-CHK-EXT
           END-IF
      *
      *    ¥·¥¹¥Æ¥àÆüÉÕ¤È¤Î¥Á¥§¥Ã¥¯
           IF      SPA-NAI-BIRTHDAY    >   SPA-SYSYMD
               MOVE    SPACE           TO  SPA-NAI-BIRTHDAY
               MOVE    "0020"          TO  SPA-ERRCD
               MOVE    4               TO  SPA-GMN-CUR
               GO      TO      4101-BIRTHDAY-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-BIRTHDAYW   TO  SPA-MAE-BIRTHDAY
      *
      *    Ç¯Îð·×»»
           PERFORM 410121-NENREI-SET-SEC
      *    ¸«½Ð¤·¤ËÊÔ½¸
           MOVE    SPA-GMN-BIRTHDAYW   TO  SPA-GMN-BIRTHDAYH
      *
      *    Æó½ÅÅÐÏ¿µ¿¤¤¥Á¥§¥Ã¥¯
      *    £Ñ£Ò¤«¤é¤Î½é´üÉ½¼¨
           IF      SPA-QR-FLG          =   2
               CONTINUE
           ELSE
             IF      SPA-P02A-FLG2       =   ZERO
               MOVE    2               TO  FLG-P02A-SYORI
               MOVE    1               TO  SPA-P02A-FLG2
               PERFORM 41012-NIJYU-TRKGMN-SEC
             END-IF
           END-IF
      *
      *!!
      *    ¥°¥ë¡¼¥×°åÎÅµ¡´Ø¤ÎÆ±À«Æ±Ì¾¥ê¥¹¥È
           IF     (SPA-P02-SYORI       =   1    )  AND
                  (SPA-NAI-GRPPTLST-FLG    NOT =   "0" )  AND
                  (SPA-P02G-FLG        =   ZERO   )
      *        ¿·µ¬¤Ç¥ê¥¹¥ÈÉ½¼¨»þ¤Î¤ß
               IF     (SPA-FLG-END         =   ZERO )
                   PERFORM 41013-GRPPTNAME-CHK-SEC
               ELSE
                   MOVE    2               TO  SPA-P02G-FLG
               END-IF
           END-IF
      *!!
           .
       4101-BIRTHDAY-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Ç¯Îð·×»»½èÍý
      *****************************************************************
       410121-NENREI-SET-SEC             SECTION.
      *
           IF      SPA-NAI-BIRTHDAY    =   SPACE  OR  ZERO
               MOVE    SPACE               TO  SPA-GMN-NENREI
               MOVE    ZERO                TO  SPA-NAI-NENREI
               GO      TO      410121-NENREI-SET-EXT
           END-IF
      *
           MOVE    SPA-NAI-NENREI      TO  WRK-MAE-NENREI
      *
           MOVE    SPA-NAI-BIRTHDAY    TO  WRK-YMDS1
           MOVE    SPA-SYSYMD          TO  WRK-YMDS2
           COMPUTE WRK-NENREI-YY       =   WRK-YYS2
                                       -   WRK-YYS1
           IF      WRK-YMDS1(5:4)      >   WRK-YMDS2(5:4)
               COMPUTE WRK-NENREI-YY   =   WRK-NENREI-YY
                                           -   1
               COMPUTE WRK-NENREI-MM   =  (WRK-MMS2  +  12 )
                                           -   WRK-MMS1
           ELSE
               COMPUTE WRK-NENREI-MM   =   WRK-MMS2
                                           -   WRK-MMS1
           END-IF
           IF      WRK-DDS1            >   WRK-DDS2
               COMPUTE WRK-NENREI-MM   =   WRK-NENREI-MM
                                           -   1
           END-IF
      *
           MOVE    WRK-NENREI-YY       TO  SPA-NAI-NENREI-YY
           MOVE    WRK-NENREI-MM       TO  SPA-NAI-NENREI-MM
      *    ²èÌÌÉ½¼¨ÍÑ
           IF      WRK-NENREI-YY       =   ZERO
               MOVE    WRK-NENREI-MM       TO  WRK-NENREI-ZN
               MOVE    "¥ö·î"              TO  WRK-NENREI-MEIN
           ELSE
               MOVE    WRK-NENREI-YY       TO  WRK-NENREI-Z
               MOVE    "ºÍ"                TO  WRK-NENREI-MEI
           END-IF
           MOVE    WRK-NENREI-G        TO  SPA-GMN-NENREI
      *
      *    £·£°ºÐÅþÃ£Æü
      *    À¸Ç¯·îÆü¤«¤é´ð½àÆü¤òµá¤á¤ë
      *    £±Æü¤Ê¤é¤ÐÀ¸Ç¯·îÆü¡¢£±Æü°Ê³°¤Ê¤é¤ÐÀ¸Ç¯·îÆü¤ÎÍâ·î£±Æü
           MOVE    SPA-NAI-BIRTHDAY    TO  WRK-BASEYMD
           IF      WRK-BDD         NOT =   01
               COMPUTE WRK-BMM         =   WRK-BMM     +   1
               IF      WRK-BMM         >   12
                   COMPUTE WRK-BYY     =   WRK-BYY     +   1
                   MOVE    01              TO  WRK-BMM
               END-IF
               MOVE    01                  TO  WRK-BDD
           END-IF
      *    £¶£µºÐ¤ò·Þ¤¨¤ëÆü
           MOVE    WRK-BASEYMD         TO  SPA-BYMD-65
           COMPUTE SPA-B65-YY          =   SPA-B65-YY  +   65
      *    £·£°ºÐ¤ò·Þ¤¨¤ëÆü
           MOVE    WRK-BASEYMD         TO  SPA-BYMD-70
           COMPUTE SPA-B70-YY          =   SPA-B70-YY  +   70
      *    £·£µºÐ¤ò·Þ¤¨¤ëÆü
           MOVE    WRK-BASEYMD         TO  SPA-BYMD-75
           COMPUTE SPA-B75-YY          =   SPA-B75-YY  +   75
      *
      *    £·£µºÐ¤ÎÃÂÀ¸Æü¡Ê£È£²£°¡¥£´¤«¤é¡Ë
           MOVE    SPA-NAI-BIRTHDAY    TO  WRK-BASEYMD
           MOVE    WRK-BASEYMD         TO  SPA-BYMD-75-2
           COMPUTE SPA-B75-YY2         =   SPA-B75-YY2  +   75
           IF      WRK-BASEYMD(5:4)    =   "0229"
               MOVE    "0301"              TO  SPA-BYMD-75-2(5:4)
           END-IF
      *
      *    ¿·µ¬Ê£¼Ì¸å¡¢À¸Ç¯·îÆüÊÑ¹¹»þ¤ËÊä½õ¶èÊ¬¤ÎºÆÊÔ½¸¤ò¤ª¤³¤Ê¤¦
           IF     (SPA-P02-SYORI       =   1    )  AND
                  (WRK-MAE-NENREI      =   ZERO )
               PERFORM 31011-HKN-HEN-SEC
           END-IF
           .
       410121-NENREI-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÄÌ¾Î¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-NICKNAME-CHK-SEC          SECTION.
      *
           IF      SPA-GMN-NICKNAME    NOT =   SPACE
      *        È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤Ø
               MOVE    SPA-GMN-NICKNAME    TO  WRK-MAE-INPUT
               MOVE    50                  TO  WRK-LEN
               PERFORM 891-HALF-ZEN2-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-NICKNAME
               IF      FLG-ERR             =   1
                   MOVE    "0027"              TO  SPA-ERRCD
                   MOVE    5                   TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4101-NICKNAME-CHK-EXT.
           EXIT.
      *
      ***************************************************************
      *    ¥Æ¥¹¥È´µ¼Ô½èÍý
      ***************************************************************
       4101-TSTPTNUMKBN-CHK-SEC         SECTION.
      *
      *    ¥Æ¥¹¥È´µ¼Ô
           IF      SPA-GMN-TSTPTNUMKBN =   "0"  OR  "1"
               CONTINUE
           ELSE
      *        ¥¨¥é¡¼¤Î»þ¤¹¤Ù¤Æ¡¢´µ¼Ô¤Ø
               MOVE    SPA-GMN-TSTPTNUMKBN-LST(1)
                                       TO  SPA-GMN-TSTPTNUMKBN-G
           END-IF
      *
           .
       4101-TSTPTNUMKBN-CHK-EXT.
           EXIT.
      *
      ***************************************************************
      *    ¥«¥ë¥ÆÈ¯¹Ô¥Á¥§¥Ã¥¯½èÍý
      ***************************************************************
       4101-HAKKO-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   2
               IF      SPA-GMN-HAKKO   =   SPA-GMN-HAKKO-LST(IDX)(1:1)
                   MOVE    SPA-GMN-HAKKO-LST (IDX)
                                           TO  SPA-GMN-HAKKO-G
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0029"              TO  SPA-ERRCD
               MOVE    6                   TO  SPA-GMN-CUR
           END-IF
      *
           .
       4101-HAKKO-CHK-EXT.
           EXIT.
      *
      ***************************************************************
      *    £Õ¡¦£Ð¥Á¥§¥Ã¥¯½èÍý
      ***************************************************************
       4101-USERPG-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-USERPG-MAX
               IF      SPA-GMN-USERPG  =   SPA-GMN-USERPG-LST(IDX)(1:1)
                   MOVE    SPA-GMN-USERPG-LST (IDX)
                                           TO  SPA-GMN-USERPG-G
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0901"              TO  SPA-ERRCD
               MOVE    70                  TO  SPA-GMN-CUR
           END-IF
      *
           .
       4101-USERPG-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Í¹ÊØÈÖ¹æ ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-POST-CHK-SEC             SECTION.
      *
           IF      SPA-GMN-POST        =   SPACE
               MOVE    SPA-GMN-POST        TO  SPA-MAE-POST
               GO      TO      4101-POST-CHK-EXT
           END-IF
      *
      *    ¼þÊÕ½»½ê°ìÍ÷¤Ø
           IF      SPA-GMN-POST (1:1)  =   "/"
               IF      SPA-GMN-POST (2:3)  NUMERIC
                   PERFORM 41011-SYUHEN-JYUSYO-SEC
               ELSE
                   PERFORM 440-JYUSYO-SEC
               END-IF
               GO      TO      4101-POST-CHK-EXT
           END-IF
      *
      *    ÆþÎÏ¤¬¤¢¤Ã¤¿»þ¤Î¤ß¡¢¹Ô¤¦
           IF      FLG-IN-POST         =   ZERO
               GO      TO      4101-POST-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-POST        TO  SPA-MAE-POST
      *
      *    Í¹ÊØÈÖ¹æ¤è¤ê¡¢½»½ê°ìÍ÷¤òÉ½¼¨¤¹¤ë
           INITIALIZE                  SPA-P982-AREA
           MOVE    SPA-GMN-POST        TO  SPA-GMN982-POST
           MOVE    "P02"               TO  SPA-GMN982-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP982"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *    ÂÐ¾Ý¤Ê¤·¡Ê·Ù¹ð¤È¤¹¤ë¡Ë
           IF      SPA-GMN982-MAX      =   ZERO
               MOVE    "0031"              TO  SPA-ERRCD
               MOVE     40                 TO  SPA-GMN-CUR
               GO  TO  4101-POST-CHK-EXT
           END-IF
      *    £±·ï¤Î»þ¡¢ÂÐ¾Ý
           IF      SPA-GMN982-MAX      =   1
      *        ½»½ê¸¡º÷ÊÔ½¸
               PERFORM 30011-P982SET-SEC
           ELSE
      *        ½»½ê°ìÍ÷²èÌÌ¤Ø
               PERFORM 41012-P982-SYORI-SEC
           END-IF
      *
           .
       4101-POST-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼þÊÕ½»½ê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       41011-SYUHEN-JYUSYO-SEC         SECTION.
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¤è¤ê¼þÊÕ½»½ê¤ò¸¡º÷
           INITIALIZE                  SYS-1015-REC
           MOVE    "1015"              TO  SYS-1015-KANRICD
           MOVE    SPA-GMN-POST (2:3)  TO  SYS-1015-KBNCD
           MOVE    SPA-SYSYMD          TO  SYS-1015-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-1015-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-1015-HOSPNUM
           MOVE    SYS-1015-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
               PERFORM 900-SYSTEM-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1015-REC
           ELSE
      *        ¼þÊÕ½»½ê°ìÍ÷¤Ø
               PERFORM 440-JYUSYO-SEC
               GO      TO      41011-SYUHEN-JYUSYO-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
      *    ½»½ê¥Ç¡¼¥¿ÆÉ¤ß½Ð¤·
           INITIALIZE                      ADRS-REC
      **** MOVE    SYS-1015-LPUBCD     TO  ADRS-LPUBCD
           MOVE    SYS-1015-POST       TO  ADRS-POST
           MOVE    SYS-1015-RENNUM     TO  ADRS-EDANUM
           MOVE    SPA-HOSPNUM         TO  ADRS-HOSPNUM
           MOVE    ADRS-REC            TO  MCPDATA-REC
           MOVE    "tbl_adrs"          TO  MCP-TABLE
           MOVE    "key9"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_adrs"          TO  MCP-TABLE
               MOVE    "key9"              TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  ADRS-REC
                   MOVE    ADRS-POST           TO  SPA-GMN-POST
                   PERFORM 41011-ADRS-HENSYU-SEC
                   MOVE    SPA-GMN-EDITADRS-NAME
                                               TO  SPA-MAE-ADRS
                   MOVE    SPA-GMN-POST        TO  SPA-MAE-POST
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-IF
           MOVE    "tbl_adrs"          TO  MCP-TABLE
           MOVE    "key9"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      FLG-OK              =   ZERO
      *        ¼þÊÕ½»½ê°ìÍ÷¤Ø
               PERFORM 440-JYUSYO-SEC
           END-IF
           .
       41011-SYUHEN-JYUSYO-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½»½êÊÔ½¸½èÍý
      *****************************************************************
       41011-ADRS-HENSYU-SEC         SECTION.
      *
           IF      SPA-NAI-KENMEIKBN-FLG   =   "0"
      *    ÅÔÆ»ÉÜ¸©Ì¾¤Ê¤·
               MOVE    SPACE               TO  SPA-GMN-EDITADRS-NAME
      *        »ÔÄ®Â¼Ì¾¡ÜÄ®°èÌ¾
               STRING  ADRS-CITYNAME
                       ADRS-TOWNNAME       DELIMITED  BY  SPACE
                                           INTO    SPA-GMN-EDITADRS-NAME
               END-STRING
               IF      ADRS-TOWNNAME       =   "°Ê²¼¤Ë·ÇºÜ¤¬¤Ê¤¤¾ì¹ç"
                   MOVE    ADRS-CITYNAME       TO  SPA-GMN-EDITADRS-NAME
               END-IF
           ELSE
               MOVE    ADRS-EDITADRS-NAME  TO  SPA-GMN-EDITADRS-NAME
           END-IF
      *    µþÅÔ¤ÇÄÌ¤êÌ¾¾Î¤òÊÔ½¸¤¹¤ë»þ
           IF     (ADRS-LPUBCD(1:2)    =   "26"  )
             AND  (ADRS-TOWNNAME2  NOT =   SPACE )
             AND  (SPA-NAI-TOWNNAME2KBN-FLG    =   "1" )
               IF     (ADRS-TOWNNAME2(1:2)     =   "¡Ê"  )
                   CONTINUE
               ELSE
                   PERFORM 41011-ADRS-KYOTOHEN-SEC
               END-IF
           END-IF
           .
       41011-ADRS-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    µþÅÔÄÌ¤êÌ¾¾ÎÊÔ½¸½èÍý
      *****************************************************************
       41011-ADRS-KYOTOHEN-SEC         SECTION.
      *
           IF      SPA-NAI-KENMEIKBN-FLG   =   "0"
      *    ÅÔÆ»ÉÜ¸©Ì¾¤Ê¤·
               MOVE    SPACE               TO  SPA-GMN-EDITADRS-NAME
      *        »ÔÄ®Â¼Ì¾¡ÜÄÌ¤êÌ¾¾Î
               STRING  ADRS-CITYNAME
                       ADRS-TOWNNAME2
                       ADRS-TOWNNAME
                                           DELIMITED  BY  SPACE
                                           INTO    SPA-GMN-EDITADRS-NAME
               END-STRING
           ELSE
      *        ÅÔÆ»ÉÜ¸©Ì¾¡Ü»ÔÄ®Â¼Ì¾¡ÜÄÌ¤êÌ¾¾Î
               MOVE    SPACE               TO  SPA-GMN-EDITADRS-NAME
               STRING  ADRS-PREFNAME
                       ADRS-CITYNAME
                       ADRS-TOWNNAME2
                       ADRS-TOWNNAME
                                           DELIMITED  BY  SPACE
                                           INTO    SPA-GMN-EDITADRS-NAME
               END-STRING
           END-IF
           .
       41011-ADRS-KYOTOHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½»½ê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-ADRS-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-EDITADRS-NAME       =   SPACE
               MOVE    SPA-GMN-EDITADRS-NAME   TO  SPA-MAE-ADRS
           ELSE
      *        È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤Ø
               MOVE    SPA-GMN-EDITADRS-NAME   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-EDITADRS-NAME
               IF      FLG-ERR             =   1
                   MOVE    "0032"              TO  SPA-ERRCD
                   MOVE    41                  TO  SPA-GMN-CUR
               ELSE
      *            Í¹ÊØÈÖ¹æ¼«Æ°ÀßÄê
                   IF     (SPA-GMN-EDITADRS-NAME
                                           NOT =   SPA-MAE-ADRS )
                      AND (SPA-MCP-WIDGET      =   "P02_ADRS"   )
                       PERFORM 41012-ADRS-POSTCHK-SEC
                   ELSE
                       MOVE    SPA-GMN-EDITADRS-NAME   TO  SPA-MAE-ADRS
                   END-IF
               END-IF
           END-IF
           .
       4101-ADRS-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ½»½ê¤«¤éÍ¹ÊØÈÖ¹æÊÔ½¸½èÍý
      *****************************************************************
       41012-ADRS-POSTCHK-SEC         SECTION.
      *
           EVALUATE    SPA-NAI-POSTKBN-FLG
               WHEN     "0"
                   MOVE    SPA-GMN-EDITADRS-NAME   TO  SPA-MAE-ADRS
               WHEN     "1"
                   PERFORM 410121-ADRS-POST-SEC
               WHEN     "2"
                   IF      SPA-GMN-POST        =   SPACE
                       PERFORM 410121-ADRS-POST-SEC
                   ELSE
                       MOVE    SPA-GMN-EDITADRS-NAME   TO  SPA-MAE-ADRS
                   END-IF
           END-EVALUATE
           .
       41012-ADRS-POSTCHK-EXT.
           EXIT.
      *****************************************************************
      *    ½»½ê¤«¤éÍ¹ÊØÈÖ¹æÊÔ½¸½èÍý
      *****************************************************************
       410121-ADRS-POST-SEC         SECTION.
      *
      *    Í¹ÊØÈÖ¹æ¤è¤ê¡¢½»½ê°ìÍ÷¤òÉ½¼¨¤¹¤ë
           INITIALIZE                  SPA-P982-AREA
           MOVE    2                   TO  SPA-GMN982-KBN
           MOVE    SPA-GMN-EDITADRS-NAME
                                       TO  SPA-GMN982-TOWNNAME
           MOVE    "P02"               TO  SPA-GMN982-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP982"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
      *    £±·ï¤Î»þ¡¢ÂÐ¾Ý
           IF      SPA-GMN982-MAX      =   1
               IF      SPA-GMN982-POST     NOT =   SPA-GMN-POST
      *            ½»½ê¸¡º÷ÊÔ½¸
                   PERFORM 30011-P982SET-SEC
               ELSE
                   IF      SPA-NAI-KENMEIKBN-FLG   =   "0"
      *                ÅÔÆ»ÉÜ¸©Ì¾¤Ê¤·
                       IF      SPA-GMN982-CITYNAMET
                                           NOT =   SPA-GMN-EDITADRS-NAME
                           MOVE    "1098"          TO  SPA-PIDCD
                       END-IF
                   ELSE
                       IF      SPA-GMN982-TOWNNAME
                                           NOT =   SPA-GMN-EDITADRS-NAME
                           MOVE    "1098"          TO  SPA-PIDCD
                       END-IF
                   END-IF
               END-IF
               MOVE    SPA-GMN-POST            TO  SPA-MAE-POST
               MOVE    SPA-GMN-EDITADRS-NAME   TO  SPA-MAE-ADRS
           ELSE
               IF      SPA-GMN982-MAX      >   1
                   PERFORM 41012-P982-SYORI-SEC
               END-IF
           END-IF
      *
           .
       410121-ADRS-POST-EXT.
           EXIT.
      *****************************************************************
      *    ½»½ê°ìÍ÷Á«°Ü½èÍý
      *****************************************************************
       41012-P982-SYORI-SEC         SECTION.
      *
      *    ½»½ê°ìÍ÷²èÌÌ¤Ø
           MOVE    "SELNUM"            TO  MCP-WIDGET
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
      *
      *    °ìÍ÷¤Ø
           MOVE    "P982"              TO  SPA-SAKIPG
           MOVE    "P02"               TO  SPA-MOTOPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    "P982"              TO  MCP-WINDOW
           PERFORM 900-PUT-WINDOW
           MOVE    1                   TO  SPA-FLG-END
      *
           .
       41012-P982-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    ÈÖÃÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-BANTI-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-BANTI   NOT =   SPACE
      *        È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤Ø
               MOVE    SPA-GMN-BANTI       TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-BANTI
               IF      FLG-ERR             =   1
                   MOVE    "0032"              TO  SPA-ERRCD
                   MOVE    42                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4101-BANTI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    À¤ÂÓ¼ç¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SETAINUSI-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-SETAINUSI   NOT =   SPACE
      *        È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤Ø
               MOVE    SPA-GMN-SETAINUSI   TO  WRK-MAE-INPUT
               MOVE    50                  TO  WRK-LEN
               PERFORM 891-HALF-ZEN2-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-SETAINUSI
               IF      FLG-ERR             =   1
                   MOVE    "0033"              TO  SPA-ERRCD
                   MOVE    47                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4101-SETAINUSI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Â³ÊÁ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-ZOKUGARA-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-ZOKUGARA    NOT =   SPACE
      *        È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤Ø
               MOVE    SPA-GMN-ZOKUGARA    TO  WRK-MAE-INPUT
               MOVE    30                  TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-ZOKUGARA
               IF      FLG-ERR             =   1
                   MOVE    "0034"              TO  SPA-ERRCD
                   MOVE    48                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4101-ZOKUGARA-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸ºÌÈ»öÍ³¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-DISCOUNTKBN-CHK-SEC        SECTION.
      *
      *    ¸ºÌÈ»öÍ³¤¬Ì¤ÆþÎÏ
      *    IF      SPA-GMN-DISCOUNTKBN =   SPACE
      *        MOVE    ZERO            TO  SPA-GMN-DISCOUNTKBN
      ******** GO  TO                  4101-DISCOUNTKBN-CHK-EXT
      *    END-IF
      *    ¸ºÌÈ»öÍ³¤è¤ê³ä°úÎ¨¶èÊ¬¤ò¼èÆÀ
           MOVE    SPACE               TO  WRK-RATEKBN
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING   IDX   FROM    1   BY  1
                   UNTIL   ( IDX       >   SPA-DISCOUNTKBN-MAX )
                   OR      ( SPA-GMN-DISCOUNTKBN-KBNCD (IDX)
                                             =   SPACE )
               IF      SPA-GMN-DISCOUNTKBN
                                   =   SPA-GMN-DISCOUNTKBN-KBNCD (IDX)
                   MOVE    1               TO  FLG-CHK
                   MOVE    SPA-GMN-DISCOUNTKBN-RATEKBN (IDX)
                                           TO  WRK-RATEKBN
                   MOVE    SPA-DISCOUNTKBN-MAX TO  IDX
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0019"              TO  SPA-ERRCD
               MOVE    45                  TO  SPA-GMN-CUR
               GO  TO                  4101-DISCOUNTKBN-CHK-EXT
           END-IF
      *
      *    ¸«¤Ä¤«¤é¤Ê¤¤¾ì¹ç¡¢¥»¥Ã¥È¤·¤Ê¤¤
           IF      WRK-RATEKBN             =   SPACE
               GO  TO                  4101-DISCOUNTKBN-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-DISCOUNTKBN     TO  SPA-MAE-DISCOUNTKBN
      *    ¸ºÌÈ»öÍ³¤òÆþÎÏ»þ¤Î¤ß¡¢³ä°úÎ¨ÀßÄê
           IF      FLG-IN-DISCOUNTKBN  =   ZERO
               GO  TO                  4101-DISCOUNTKBN-CHK-EXT
           END-IF
      *
           MOVE    SPACE               TO  WRK-RATE-AREA
           PERFORM   VARYING   IDX   FROM    1   BY  1
                     UNTIL  ( IDX     >     SPA-DISCOUNT-MAX )
                     OR     ( SPA-GMN-DISCOUNT-KBNCD (IDX)  =   SPACE )
      *
             IF  WRK-RATEKBN           =   SPA-GMN-DISCOUNT-KBNCD (IDX)
                 MOVE    SPA-GMN-DISCOUNT-KBNCD(IDX)
                                       TO  WRK-RATE-KBN
                 MOVE    SPA-GMN-DISCOUNT-RITU (IDX)
                                       TO  WRK-RATE-EDITZ
                 EVALUATE    SPA-GMN-DISCOUNT-TEIRITU (IDX)
                 WHEN    "0"
                     MOVE    "³ºÅö¤Ê¤·"    TO  WRK-RATE-EDIT-R
                 WHEN    "1"
                     MOVE    "(%)"         TO  WRK-RATE-TANI
                 WHEN    "2"
                     MOVE    "(±ß)"        TO  WRK-RATE-TANI
                 END-EVALUATE
                 MOVE    SPA-DISCOUNT-MAX  TO  IDX
             END-IF
           END-PERFORM
           MOVE    WRK-RATE-AREA       TO  SPA-GMN-DISCOUNT
      *
           .
       4101-DISCOUNTKBN-CHK-EXT.
           EXIT.
      *
      ***************************************************************
      *    ³ä°úÎ¨¥Á¥§¥Ã¥¯½èÍý
      ***************************************************************
       4101-DISCOUNT-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-DISCOUNT-MAX)  OR
                              (SPA-GMN-DISCOUNT-KBNCD(IDX)
                                           =   SPACE  )
               IF      SPA-GMN-DISCOUNT(1:2)
                                       =   SPA-GMN-DISCOUNT-KBNCD
                                                              (IDX)
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0035"              TO  SPA-ERRCD
               MOVE    46                  TO  SPA-GMN-CUR
           END-IF
      *
           .
       4101-DISCOUNT-CHK-EXT.
           EXIT.
      ***************************************************************
      *    Æþ¶âÊýË¡¥Á¥§¥Ã¥¯½èÍý
      ***************************************************************
       4101-NYUKIN-HOHO-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-NYUKIN-MAX)
                          OR  (FLG-CHK     =   1   )
               IF      SPA-GMN-NYUKIN-HOHO
                                           =   SPA-GMN-NYUKIN-HOHOL
                                                              (IDX)
                   MOVE    SPA-GMN-NYUKIN-LST (IDX)
                                           TO  SPA-GMN-NYUKIN-HOHO-G
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0166"              TO  SPA-ERRCD
               MOVE    66                  TO  SPA-GMN-CUR
           END-IF
      *
           .
       4101-NYUKIN-HOHO-CHK-EXT.
           EXIT.
      ***************************************************************
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      ***************************************************************
       4101-SKYPRTFLG-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-SKYPRTFLG   =   SPACE
               MOVE    SPACE               TO  SPA-GMN-SKYPRTFLG-G
           ELSE
               MOVE    ZERO                TO  FLG-CHK
               PERFORM VARYING     IDX     FROM    1   BY  1
                       UNTIL      (IDX         >   SPA-SKYPRTFLG-MAX)
                              OR  (FLG-CHK     =   1   )
                   IF      SPA-GMN-SKYPRTFLG
                                           =   SPA-GMN-SKYPRTFLG-LST
                                                         (IDX)(1:1)
                       MOVE    SPA-GMN-SKYPRTFLG-LST (IDX)
                                           TO  SPA-GMN-SKYPRTFLG-G
                       MOVE    1               TO  FLG-CHK
                   END-IF
               END-PERFORM
               IF      FLG-CHK             =   ZERO
                   MOVE    "0167"              TO  SPA-ERRCD
                   MOVE    67                  TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
           .
       4101-SKYPRTFLG-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¾õÂÖÌ¾¾Î¥»¥Ã¥È½èÍý
      ****************************************************************
       4101-CONDITIONH-SET-SEC         SECTION.
      *
           PERFORM VARYING   IDX       FROM    1   BY  1
                   UNTIL    (IDX       >  3    )  OR
                            (SPA-ERRCD NOT =   SPACE )
               MOVE    ZERO                TO  FLG-CHK
               PERFORM VARYING   IDY       FROM    1   BY  1
                       UNTIL   ( IDY       >   SPA-CONDITION-MAX(IDX))
                       OR      ( SPA-GMN-CONDITION-KBNCD (IDX IDY)
                                           =   SPACE )
                   IF      SPA-GMN-CONDITION (IDX)(1:2)
                                           =   SPA-GMN-CONDITION-KBNCD
                                                            (IDX IDY)
                       MOVE    SPA-GMN-CONDITION-WORD (IDX IDY)
                                           TO  SPA-GMN-CONDITIONH (IDX)
                       MOVE    1           TO  FLG-CHK
                   END-IF
               END-PERFORM
               IF      FLG-CHK         =   ZERO
                   MOVE    "0036"          TO  SPA-ERRCD
                   EVALUATE    IDX
                       WHEN    1
                           MOVE    49          TO  SPA-GMN-CUR
                       WHEN    2
                           MOVE    50          TO  SPA-GMN-CUR
                       WHEN    3
                           MOVE    51          TO  SPA-GMN-CUR
                   END-EVALUATE
               END-IF
           END-PERFORM
      *
           .
       4101-CONDITIONH-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¶Ø´÷Â¾¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-COMMENT-CHK-SEC          SECTION.
      *
           IF      SPA-GMN-TABOO-1     NOT =   SPACE
               MOVE    SPA-GMN-TABOO-1     TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-TABOO-1
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    52                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-TABOO-2     NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-TABOO-2     TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-TABOO-2
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    53                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-ALLERGY-1     NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-ALLERGY-1   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-ALLERGY-1
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    54                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-ALLERGY-2     NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-ALLERGY-2   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-ALLERGY-2
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    55                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-KANSENSYO-1 NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-KANSENSYO-1 TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-KANSENSYO-1
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    56                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-KANSENSYO-2 NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-KANSENSYO-2 TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-KANSENSYO-2
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    57                  TO  SPA-GMN-CUR
               END-IF
           END-IF
      *    ¥³¥á¥ó¥È
           IF     (SPA-GMN-COMMENT-1   NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-COMMENT-1   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-MAE-INPUT       TO  SPA-GMN-COMMENT-1
           END-IF
           IF     (SPA-GMN-COMMENT-2   NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-COMMENT-2   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-MAE-INPUT       TO  SPA-GMN-COMMENT-2
           END-IF
           .
       4101-COMMENT-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÁªÂòÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4101-SELNUM-CHK-SEC      SECTION.
      *
           IF      SPA-GMN-SELNUM  NOT =   ZERO
               MOVE    ZERO                TO  FLG-CHK
               PERFORM VARYING   IDX       FROM    1   BY  1
                       UNTIL     IDX       >  SPA-HKNCOMBI-MAX
                   IF      SPA-GMN-SELNUM  =   SPA-GMN-THKNCOMBINUM(IDX)
                       IF      SPA-NAI-THYOJIKBN (IDX)  =   "1"
                           MOVE    "0137"          TO  SPA-ERRCD
                           MOVE    38              TO  SPA-GMN-CUR
                       END-IF
                       MOVE    1               TO  FLG-CHK
                   END-IF
               END-PERFORM
               IF      FLG-CHK             =   ZERO
                   MOVE    "0037"              TO  SPA-ERRCD
                   MOVE    38                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
      *
       4101-SELNUM-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¿ÇÎÅ²Ê¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4101-SRYKA-CHK-SEC      SECTION.
      *
           IF      SPA-GMN-SRYKA   NOT =   SPACE
               MOVE    ZERO                TO  FLG-CHK
               PERFORM VARYING   IDX       FROM    1   BY  1
                       UNTIL     IDX       >   SPA-SRYKA-MAX
                   IF      SPA-GMN-SRYKA   =   SPA-GMN-SRYKA-LST (IDX)
                                                              (1:2)
                       MOVE    1               TO  FLG-CHK
                   END-IF
               END-PERFORM
               IF      FLG-CHK             =   ZERO
                   MOVE    "0038"              TO  SPA-ERRCD
                   MOVE    39                  TO  SPA-GMN-CUR
               END-IF
           ELSE
      *        ¥«¥ë¥ÆÈ¯¹Ô»þ¤Ï¡¢É¬¿Ü¤È¤¹¤ë
               IF      SPA-GMN-HAKKO       =   "1"
                   MOVE    "0039"              TO  SPA-ERRCD
                   MOVE    39                  TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
           .
      *
       4101-SRYKA-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÅÐÏ¿Á°¡¢É¬¿ÜÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4109-TOUROKU-CHK-SEC      SECTION.
      *
      *    ÅÐÏ¿»þ¡¢É¬¿ÜÆþÎÏ¥Á¥§¥Ã¥¯
           IF      SPA-GMN-KANANAME    =   SPACE
               MOVE    "0100"              TO  SPA-ERRCD
               MOVE    1                   TO  SPA-GMN-CUR
               GO      TO      4109-TOUROKU-CHK-EXT
           END-IF
           IF      SPA-GMN-NAME        =   SPACE
               MOVE    "0101"              TO  SPA-ERRCD
               MOVE    2                   TO  SPA-GMN-CUR
               GO      TO      4109-TOUROKU-CHK-EXT
           END-IF
           IF      SPA-GMN-SEX         =   SPACE
               MOVE    "0103"              TO  SPA-ERRCD
               MOVE    3                   TO  SPA-GMN-CUR
               GO      TO      4109-TOUROKU-CHK-EXT
           END-IF
           IF      SPA-GMN-BIRTHDAYW   =   SPACE
               MOVE    "0102"              TO  SPA-ERRCD
               MOVE    4                   TO  SPA-GMN-CUR
               GO      TO      4109-TOUROKU-CHK-EXT
           END-IF
      *
      *    µìÀ«ÍúÎò¤Î¹¹¿·
           PERFORM 41091-KYUSEI-KOU-SEC
      *
           .
      *
       4109-TOUROKU-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    µìÀ«ÍúÎò¤Î¹¹¿·½èÍý
      ****************************************************************
       41091-KYUSEI-KOU-SEC      SECTION.
      *
      *    ¿·µ¬¤Î»þ¡¢µìÀ«ÍúÎò¤Ï½ÐÎÏ¤·¤Ê¤¤
           IF      SPA-P02-SYORI       =   1
               GO      TO      41091-KYUSEI-KOU-EXT
           END-IF
      *
           MOVE    ZERO                TO  IDX
           IF     (SPA-OLD-NAME    NOT =   SPACE   )  AND
                  (SPA-GMN-NAME    NOT =   SPACE   )  AND
                  (SPA-GMN-NAME    NOT =   SPA-OLD-NAME)
               MOVE    SPA-NAI25-KYU-MAX   TO  IDX
               IF    ( IDX                         >   ZERO      ) AND
                     ((SPA-GMN25-KYU-CHGYMD(IDX)   =   SPA-SYSYMD) OR
                      (SPA-GMN25-KYU-NAME  (IDX)   =   SPA-OLD-NAME
                  AND  SPA-GMN25-KYU-KANANAME(IDX) =   SPA-OLD-KANANAME
                  AND  SPA-GMN25-KYU-NICKNAME(IDX) =  SPA-OLD-NICKNAME))
                   CONTINUE
               ELSE
                   ADD     1               TO  IDX
                   IF      IDX             >   20
                      MOVE    "2510"           TO  SPA-ERRCD
                      MOVE    1                TO  SPA-GMN-CUR
                      GO      TO      41091-KYUSEI-KOU-EXT
                   END-IF
                   ADD     1               TO  SPA-NAI25-KYU-MAX
      *
                   MOVE    SPA-OLD-NAME    TO  SPA-GMN25-KYU-NAME
                                                               (IDX)
                   MOVE    SPA-OLD-KANANAME
                                           TO  SPA-GMN25-KYU-KANANAME
                                                                (IDX)
                   MOVE    SPA-OLD-NICKNAME
                                           TO  SPA-GMN25-KYU-NICKNAME
                                                                (IDX)
                   MOVE    SPA-SYSYMD      TO  SPA-GMN25-KYU-CHGYMD
                                                               (IDX)
                   MOVE    SPA-SYSYMDWH    TO  SPA-GMN25-KYU-CHGYMDW
                                                              (IDX)
                   MOVE    SPA-SYSYMD      TO  SPA-GMN25-KYU-UPYMD(IDX)
               END-IF
           END-IF
      *
           .
      *
       41091-KYUSEI-KOU-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÊÝ¸±¡¦¸øÈñ¤Î¥Æ¡¼¥Ö¥ë¥»¥Ã¥È½èÍý
      ****************************************************************
       4103-HKNKOH-TBL-SEC      SECTION.
      *
           IF      FLG-APICHK          =   ZERO
      *
      *    ÊÝ¸±²èÌÌ¤ÎÆâÍÆ¤ò£Ô£Â£Ì¤ØÊÔ½¸¤¹¤ë
           PERFORM 41031-HKN-SPA-TBL-SET-SEC
      *
      *    ¸øÈñ²èÌÌ¤ÎÆâÍÆ¤ò£Ô£Â£Ì¤ØÊÔ½¸¤¹¤ë
           PERFORM 41032-KOH-SPA-TBL-SET-SEC
      *
           END-IF
      *
      *    ÊÝ¸±¤È¸øÈñ¤Î´ü´Ö½ÅÊ£¥Á¥§¥Ã¥¯
           PERFORM 41033-HKNKOH-CHK-SEC
      *
      *!!
      *TEST
      *    Âà¿¦¹ñÊÝ¤ÎÇ¯Îð¥Á¥§¥Ã¥¯¡Ê£È£²£°¡¥£´ ²þÀµ¡Ë
           IF     (FLG-KOH-ADD2         =   ZERO  )
              AND (FLG-ERRCHK           =   ZERO  )
              AND (FLG-HKN-ADD2         =   ZERO  )
              AND (SPA-ERRCD            =   SPACE )
               IF     (SPA-SYSYMD          >=  "20080401" )  AND
                      (SPA-BYMD-65         >   ZERO       )  AND
                      (SPA-SYSYMD          >=  SPA-BYMD-65)
                   PERFORM 410334-TAIKOKUHO-CHK-SEC
               END-IF
           END-IF
      *    £È£±£´¡¥£±£° ²þÀµ
      *!   IF      FLG-TOUROKU2         =   1
      *    ¸øÈñÄÉ²Ã°Ê³°
           IF      FLG-KOH-ADD2         =   ZERO
              AND  FLG-ERRCHK           =   ZERO
              AND  FLG-HKN-ADD2         =   ZERO
              AND (SPA-ERRCD            =   SPACE )
              AND (SPA-PIDCD            =   SPACE )
      *!!
      *        £·£°ºÐ°Ê¾å¤Î»þ¡¢Ï·¿Í³ä¹ç¤¬ÀßÄê¤µ¤ì¤Æ¤¤¤ë¤³¤È
               IF     (SPA-SYSYMD          >=  "20021001" )  AND
                      (SPA-BYMD-70         >   ZERO       )  AND
                      (SPA-SYSYMD          >=  SPA-BYMD-70)
                   PERFORM 410331-RJN-HKNCHK-SEC
               ELSE
      *        £È£±£¸¡¥£±£° ²þÀµ
      *        Ï·¿Í¸øÈñ£²³ä¥Á¥§¥Ã¥¯
                   PERFORM 410332-RJN27-CHK-SEC
               END-IF
           END-IF
      *    £È£²£°¡¥£´ ²þÀµ
           IF     (FLG-TOUROKU2         =   1   )
             AND  (SPA-ERRCD            =   SPACE )
             AND  (SPA-PIDCD            =   SPACE )
      *        Ï·¿Í¸øÈñ½ªÎ»¥Á¥§¥Ã¥¯
               PERFORM 410333-RJN27-ENDCHK-SEC
           END-IF
           .
      *
       4103-HKNKOH-TBL-EXT.
           EXIT.
      *
      *
      ****************************************************************
      *    ÊÝ¸±²èÌÌ¤ÎÆâÍÆ¤ò£Ô£Â£Ì¤ØÊÔ½¸½èÍý
      ****************************************************************
       41031-HKN-SPA-TBL-SET-SEC      SECTION.
      *
           IF      SPA-GMN-HKNNUM      =   SPACE
      *        ¶õÇò¹Ôºï½ü
               PERFORM 410311-HKNTBL-DEL-SEC
               GO      TO      41031-HKN-SPA-TBL-SET-EXT
           END-IF
      *
           IF      SPA-NAI-HKNSTR      =   ZERO
      *        ¿·µ¬¤Î»þ¡¢£±¹Ô³«¤±¤ë
               PERFORM 410311-HKNTBL-INS-SEC
               MOVE    1                   TO  IDX
           ELSE
               MOVE    SPA-NAI-HKNSTR      TO  IDX
           END-IF
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      41031-HKN-SPA-TBL-SET-EXT
           END-IF
           PERFORM 410312-HKN-SPATBL-SET-SEC
      *
      *    ¶õÇò¹Ôºï½ü
           PERFORM 410311-HKNTBL-DEL-SEC
      *
      *    ÊÝ¸±¾ðÊó£Ô£Â£Ì¤«¤éÊÔ½¸
           IF      SPA-NAI-HKNSTR      =   ZERO
               MOVE    1               TO  SPA-NAI-HKNSTR
           END-IF
           PERFORM 3101-HKN-TBL-SPA-SEC
           .
      *
       41031-HKN-SPA-TBL-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÊÝ¸±¥Æ¡¼¥Ö¥ë¶õÇò¹Ôºï½ü½èÍý
      ****************************************************************
       410311-HKNTBL-DEL-SEC      SECTION.
      *
      *    ¶õÇò¹Ô¤ò¤Ä¤á¤ë
           MOVE    ZERO                TO  IDY
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               IF     (IDX                 <   40  )  AND
                      (SPA-PTHKN-HKNNUM (IDX)  =   SPACE)
                   MOVE    SPA-PTHKNINF-TBL (IDX + 1)
                                           TO  SPA-PTHKNINF-TBL (IDX)
                   INITIALIZE              SPA-PTHKNINF-TBL (IDX + 1)
               END-IF
               IF      SPA-PTHKN-HKNNUM (IDX)  NOT =   SPACE
                   MOVE    IDX             TO  IDY
               END-IF
           END-PERFORM
           MOVE    IDY                 TO  SPA-PTHKN-MAX
      *
           .
      *
       410311-HKNTBL-DEL-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÊÝ¸±¥Æ¡¼¥Ö¥ë£±¹ÔÁÞÆþ½èÍý
      ****************************************************************
       410311-HKNTBL-INS-SEC           SECTION.
      *
           IF      (SPA-PTHKN-MAX       >=  TBL-MAX-HKN )
               MOVE    "0107"          TO  SPA-ERRCD
           ELSE
      *
      *    £±¹Ô³«¤±¤ë
           MOVE    ZERO                TO  IDX
           PERFORM VARYING     IDX     FROM    SPA-PTHKN-MAX BY -1
                   UNTIL       IDX     <   1
               MOVE    SPA-PTHKNINF-TBL (IDX)
                                       TO  SPA-PTHKNINF-TBL (IDX + 1)
           END-PERFORM
           INITIALIZE                  SPA-PTHKNINF-TBL (01)
           ADD     1                   TO  SPA-PTHKN-MAX
      *
           END-IF
           .
       410311-HKNTBL-INS-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±²èÌÌ¢ª£Ó£Ð£Á£Ô£Â£ÌÊÔ½¸½èÍý
      *****************************************************************
       410312-HKN-SPATBL-SET-SEC              SECTION.
      *
           MOVE    SPA-GMN-HKNNUM      TO  SPA-PTHKN-HKNNUM (IDX)
           MOVE    SPA-GMN-HKNJANUM    TO  SPA-PTHKN-HKNJANUM (IDX)
           MOVE    SPA-GMN-HONKZKKBN   TO  SPA-PTHKN-HONKZKKBN (IDX)
           MOVE    SPA-GMN-HOJOKBN     TO  SPA-PTHKN-HOJOKBN (IDX)
           MOVE    SPA-GMN-CONTKBN     TO  SPA-PTHKN-CONTKBN (IDX)
           MOVE    SPA-GMN-KIGO        TO  SPA-PTHKN-KIGO    (IDX)
           MOVE    SPA-GMN-NUM         TO  SPA-PTHKN-NUM     (IDX)
           MOVE    SPA-GMN-HIHKNJANAME TO  SPA-PTHKN-HIHKNJANAME (IDX)
           MOVE    SPA-NAI-SKKGETYMD   TO  SPA-PTHKN-SKKGETYMD (IDX)
           MOVE    SPA-NAI-HTEKSTYMD   TO  SPA-PTHKN-TEKSTYMD (IDX)
           MOVE    SPA-NAI-HTEKEDYMD   TO  SPA-PTHKN-TEKEDYMD (IDX)
           MOVE    SPA-NAI-HKAKUNINYMD TO  SPA-PTHKN-KAKUNINYMD (IDX)
      *
           MOVE    SPA-NAI-SAKJOKBN    TO  SPA-PTHKN-SAKJOKBN (IDX)
           MOVE    SPA-NAI-PTHKN-SBTKBN
                                       TO  SPA-PTHKN-HKN-SBTKBN(IDX)
      *
           MOVE    SPA-HKNJA-KEIFLG    TO  SPA-PTHKN-KEIFLG  (IDX)
           MOVE    SPA-KIGO-KEIFLG     TO  SPA-PTHKN-KIGO-KEIFLG (IDX)
           MOVE    SPA-NUM-KEIFLG      TO  SPA-PTHKN-NUM-KEIFLG (IDX)
      *    ¸å´ü¹âÎð¼Ô·Ù¹ð
           MOVE    SPA-ROU-KEIFLG      TO  SPA-PTHKN-ROU-KEIFLG (IDX)
      *    ³ÎÇ§Ç¯·îÆü
           MOVE    SPA-HKN-KAKUINFLG   TO  SPA-PTHKN-KAKUINFLG (IDX)
      *    ËÜ¿Í²ÈÂ²·Ù¹ð
           MOVE    SPA-HONKZK-KEIFLG   TO  SPA-PTHKN-HONKZKFLG (IDX)
      *    Êä½õ¶èÊ¬·Ù¹ð
           MOVE    SPA-HOJOKBN-KEIFLG  TO  SPA-PTHKN-HOJOKEIFLG (IDX)
      *
      *    ¿·µ¬¤Î»þÊÝ¸±£É£Ä¼èÆÀ¡ÊÏ«ºÒ¤ÏÏ«ºÒ²èÌÌ¤Ç¼èÆÀ¤¹¤ë¡Ë
           IF      SPA-NAI-HKNID       =   ZERO
               ADD     1                   TO  SPA-PTNUM-HKNID
               MOVE    SPA-PTNUM-HKNID     TO  SPA-NAI-HKNID
           END-IF
           MOVE    SPA-NAI-HKNID       TO  SPA-PTHKN-HKNID (IDX)
      *
           IF      SPA-NAI-HKNSTR      =   ZERO
               MOVE    "1"             TO  SPA-PTHKN-SINKIKBN (IDX)
           END-IF
      *
           MOVE    SPA-GMN-HKNNUMMEI   TO  SPA-PTHKN-HKNNUM-MEI(IDX)
           MOVE    SPA-GMN-HONKZKKBNMEI
                                       TO  SPA-PTHKN-HONKZKKBN-MEI(IDX)
           MOVE    SPA-GMN-HOJOKBNMEI  TO  SPA-PTHKN-HOJOKBN-MEI(IDX)
           MOVE    SPA-GMN-CONTKBNMEI  TO  SPA-PTHKN-CONTKBN-MEI(IDX)
           MOVE    SPA-GMN-SKKGETYMD   TO  SPA-PTHKN-SKKGETYMDW(IDX)
           MOVE    SPA-GMN-HTEKSTYMD   TO  SPA-PTHKN-TEKSTYMDW(IDX)
           MOVE    SPA-GMN-HTEKEDYMD   TO  SPA-PTHKN-TEKEDYMDW(IDX)
           MOVE    SPA-GMN-HKAKUNINYMD TO  SPA-PTHKN-KAKUNINYMDW(IDX)
      *
      *
           .
       410312-HKN-SPATBL-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¸øÈñ²èÌÌ¤ÎÆâÍÆ¤ò£Ô£Â£Ì¤ØÊÔ½¸½èÍý
      ****************************************************************
       41032-KOH-SPA-TBL-SET-SEC      SECTION.
      *
      *    ÊÑ¹¹Ê¬¤Î¤ß
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   3
              IF     (SPA-GMN-KOHNUM      (IDX)  NOT =   SPACE ) AND
                     (SPA-NAI-PTKOH-EDANUM(IDX)  NOT =   ZERO  )
                   MOVE    SPA-NAI-PTKOH-EDANUM(IDX)   TO  IDY
                   PERFORM 3102-KOH-SPATBL-HEN-SEC
              END-IF
           END-PERFORM
      *    ¿·µ¬Ê¬¤Î¤ß
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   3
              IF     (SPA-GMN-KOHNUM      (IDX)  NOT =   SPACE ) AND
                     (SPA-NAI-PTKOH-EDANUM(IDX)      =   ZERO  )
                   IF     (IDX             =   1  )  AND
                          (SPA-PTKOH-MAX   >   ZERO )
      *                ºÇ½é¤Î¹ÔÄÉ²Ã¤Î»þ¡¢£±¹ÔÌÜ¤ò¤¢¤±¤ë
                       PERFORM 410321-KOHTBL-INS-SEC
                       MOVE    1               TO  IDY
                   ELSE
                       ADD     1               TO  SPA-PTKOH-MAX
                       MOVE    SPA-PTKOH-MAX   TO  IDY
                   END-IF
                   PERFORM 3102-KOH-SPATBL-HEN-SEC
              END-IF
           END-PERFORM
      *    ¶õÇò¹Ôºï½ü
           PERFORM 410323-KOHTBL-DEL-SEC
      *    ¸øÈñ¾ðÊó£Ô£Â£Ì¤«¤éÊÔ½¸
           IF      SPA-NAI-KOHSTR      =   ZERO
               MOVE    1                   TO  SPA-NAI-KOHSTR
           END-IF
           PERFORM 3101-KOH-TBL-SPA-SEC
           .
      *
       41032-KOH-SPA-TBL-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¸øÈñ¥Æ¡¼¥Ö¥ë£±¹ÔÁÞÆþ½èÍý
      ****************************************************************
       410321-KOHTBL-INS-SEC      SECTION.
      *
           MOVE    ZERO                TO  IDX2
           PERFORM VARYING     IDX2    FROM    SPA-PTKOH-MAX BY -1
                   UNTIL       IDX2    <   1
               MOVE    SPA-PTKOHINF-TBL (IDX2)
                                       TO  SPA-PTKOHINF-TBL (IDX2 + 1)
           END-PERFORM
           INITIALIZE                  SPA-PTKOHINF-TBL (01)
           ADD     1                   TO  SPA-PTKOH-MAX
      *
           .
       410321-KOHTBL-INS-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñ²èÌÌ¢ª£Ó£Ð£Á£Ô£Â£ÌÊÔ½¸½èÍý
      *****************************************************************
       3102-KOH-SPATBL-HEN-SEC              SECTION.
      *
           MOVE    SPA-GMN-KOHNUM   (IDX)  TO  SPA-PTKOH-KOHNUM (IDY)
           MOVE    SPA-GMN-FTNJANUM (IDX)  TO  SPA-PTKOH-FTNJANUM (IDY)
           MOVE    SPA-GMN-JKYSNUM  (IDX)  TO  SPA-PTKOH-JKYSNUM (IDY)
           MOVE    SPA-NAI-KTEKSTYMD(IDX)  TO  SPA-PTKOH-TEKSTYMD (IDY)
           MOVE    SPA-NAI-KTEKEDYMD(IDX)  TO  SPA-PTKOH-TEKEDYMD (IDY)
           MOVE    SPA-NAI-KKAKUNINYMD(IDX)
                                           TO  SPA-PTKOH-KAKUNINYMD(IDY)
           MOVE    SPA-NAI-PTKOH-PAYKBN(IDX)
                                           TO  SPA-PTKOH-PAYKBN (IDY)
      *
      ****MOVE    SPA-NAI-KSAKJOKBN (IDX) TO  SPA-PTKOH-SAKJOKBN(IDY)
      *
      *    ¿·µ¬¤Î»þ¸øÈñ£É£Ä¼èÆÀ
           IF      SPA-NAI-PTKOH-KOHID (IDX)   =   ZERO
               ADD     1                   TO  SPA-PTNUM-KOHID
               MOVE    SPA-PTNUM-KOHID     TO  SPA-NAI-PTKOH-KOHID(IDX)
      *
               MOVE    "1"                 TO  SPA-PTKOH-SINKIKBN (IDY)
           END-IF
           MOVE    SPA-NAI-PTKOH-KOHID (IDX)   TO  SPA-PTKOH-KOHID (IDY)
      *    ÊÝ¸±¸øÈñ¼ïÊÌ¶èÊ¬
           MOVE   SPA-NAI-PTKOH-SBTKBN (IDX)   TO  SPA-PTKOH-HKN-SBTKBN
                                                                 (IDY)
      *    ´ü¸ÂÀÚ¤ì¶èÊ¬
           MOVE    SPA-NAI-TEKEDCHKKBN (IDX)
                                       TO  SPA-PTKOH-TEKEDCHKKBN(IDY)
           MOVE   SPA-GMN-KOHNUMMEI (IDX)  TO  SPA-PTKOH-KOHNUM-MEI(IDY)
           MOVE   SPA-GMN-KTEKSTYMD (IDX)  TO  SPA-PTKOH-TEKSTYMDW(IDY)
           MOVE   SPA-GMN-KTEKEDYMD (IDX)  TO  SPA-PTKOH-TEKEDYMDW(IDY)
           MOVE   SPA-GMN-KKAKUNINYMD(IDX) TO  SPA-PTKOH-KAKUNINYMDW
                                                                  (IDY)
      *
           MOVE   SPA-NAI-PTKOH-KEIFLG(IDX)    TO  SPA-PTKOH-KEIFLG
                                                                  (IDY)
      *
           MOVE    SPA-KOH-KAKUINFLG (IDX) TO  SPA-PTKOH-KAKUINFLG (IDY)
      *
           .
       3102-KOH-SPATBL-HEN-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¸øÈñ¥Æ¡¼¥Ö¥ë¶õÇò¹Ôºï½ü½èÍý
      ****************************************************************
       410323-KOHTBL-DEL-SEC      SECTION.
      *
      *    ¶õÇò¹Ô¤ò¤Ä¤á¤ë
           MOVE    ZERO                TO  IDY
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
               IF      SPA-PTKOH-KOHNUM (IDX)  =   SPACE
                   MOVE    SPA-PTKOHINF-TBL (IDX + 1)
                                           TO  SPA-PTKOHINF-TBL (IDX)
                   INITIALIZE              SPA-PTKOHINF-TBL (IDX + 1)
               END-IF
               IF      SPA-PTKOH-KOHNUM (IDX)  NOT =   SPACE
                   MOVE    IDX             TO  IDY
               END-IF
           END-PERFORM
           MOVE    IDY                 TO  SPA-PTKOH-MAX
      *
           .
      *
       410323-KOHTBL-DEL-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÊÝ¸±¤È¸øÈñ¤Î´ü´Ö½ÅÊ£¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       41033-HKNKOH-CHK-SEC      SECTION.
      *
      *    ¹ñÊÝ¡ÊÂà¿¦¼Ô´Þ¤à¡Ë¡¦À¸³èÊÝ¸î ½ÅÊ£¥Á¥§¥Ã¥¯
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL      (IDX     >   SPA-PTHKN-MAX )  OR
                              (SPA-ERRCD   NOT =   SPACE )
               IF     (SPA-PTHKN-SAKJOKBN(IDX) =   SPACE    )  AND
                      (SPA-PTHKN-HKNNUM  (IDX) =   "060" OR "067"
      *              ÆÃÊÌÎÅÍÜÈñÄÉ²Ã
                                               OR  "068"
                                               OR  "069"
      *              ¸å´ü¹âÎð¼Ô
                                               OR  "039"
                                               OR  "040" )
                   PERFORM VARYING  IDY     FROM    1   BY  1
                           UNTIL   (IDY     >   SPA-PTKOH-MAX )  OR
                                   (SPA-ERRCD   NOT =   SPACE )
                      IF       SPA-PTKOH-SAKJOKBN (IDY)    =   SPACE
                           PERFORM 410331-HKNKOH-JYUFUKU-SEC
                      END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
           IF      SPA-GMN-HKNNUM      =   "060" OR "067"
      *        ÆÃÊÌÎÅÍÜÈñÄÉ²Ã
                                       OR  "068"
                                       OR  "069"
               MOVE    16              TO  SPA-GMN-CUR
           ELSE
               PERFORM VARYING     IDY     FROM    1   BY  1
                       UNTIL       IDY     >   SPA-KOH-MAX
                   IF      SPA-NAI-PTKOH-SBTKBN (IDY)  =   "5"
                       EVALUATE    IDY
                           WHEN    1
                               MOVE    23          TO  SPA-GMN-CUR
                           WHEN    2
                               MOVE    29          TO  SPA-GMN-CUR
                           WHEN    3
                               MOVE    35          TO  SPA-GMN-CUR
                       END-EVALUATE
                       MOVE    SPA-KOH-MAX         TO  IDY
                   END-IF
               END-PERFORM
           END-IF
      **** IF      SPA-ERRCD           =   SPACE
      *        ¸ºÌÈ½ÅÊ£¥Á¥§¥Ã¥¯
      *        PERFORM 4909-960JYUFUKU-CHK-SEC
      **** END-IF
      *
           .
       41033-HKNKOH-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    £·£°ºÐ°Ê¾å¤ÎÏ·¿ÍÊÝ¸±¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       410331-RJN-HKNCHK-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-RJNCHK
           MOVE    ZERO                TO  FLG-RJNCHK2
           MOVE    ZERO                TO  FLG-HKNCHK
           MOVE    ZERO                TO  FLG-HKNCHK2
           MOVE    ZERO                TO  FLG-SEIHOGO
           MOVE    ZERO                TO  SPA-HKN-IDX1
           MOVE    ZERO                TO  FLG-RJNERR
           MOVE    ZERO                TO  FLG-RJNKOHERR
           MOVE    ZERO                TO  FLG-KOKUHO
      *!!
           MOVE    ZERO                TO  FLG-KOKUHO-CHK
           MOVE    ZERO                TO  WRK-KOKUHO-CHK
      *!!
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               IF     (SPA-PTHKN-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-SAKJOKBN (IDX) NOT =  "1"        )
                   IF      SPA-PTHKN-HKNNUM(IDX)(1:1)  NOT =   "9"
      *                Á°´ü¹âÎð¼Ô¡¦¸å´ü¹âÎð¼Ô¶èÊ¬È½Äê
                       PERFORM 4103311-HKNKBN-CHK-SEC
                   END-IF
      *            ÊÝ¸±¤¬Â¸ºß¤¹¤ë¤³¤È
                   IF      SPA-PTHKN-HKN-SBTKBN (IDX)   =   "1"
                       MOVE    1               TO  FLG-HKNCHK
                       IF      SPA-HKN-IDX1    =   ZERO
                           MOVE    IDX             TO  SPA-HKN-IDX1
                       END-IF
                   ELSE
      *            Â¾¤Î¼«ÈñÅù¤¬Â¸ºß¤¹¤ë¤³¤È
                       MOVE    1               TO  FLG-HKNCHK2
                   END-IF
               END-IF
           END-PERFORM
      *
      *    ¸øÈñ
           MOVE    ZERO                TO  SPA-KOH-IDX2
           MOVE    ZERO                TO  FLG-27KOH-OK
           MOVE    ZERO                TO  FLG-RJNCHK3
           MOVE    ZERO                TO  FLG-RJNCHK4
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
               IF     (SPA-PTKOH-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
                      (SPA-PTKOH-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"        )
      *            Ï·¿Í
                   IF     (SPA-PTKOH-KOHNUM  (IDX) =   "027" )  OR
                          (SPA-PTKOH-HKN-SBTKBN (IDX)  =   "3" )
      *             £È£²£°¡¥£´ ¸å´ü¹âÎð¼Ô³ºÅö
                       OR (SPA-PTKOH-KOHNUM  (IDX) =   "968" )
                       MOVE    1                   TO  FLG-RJNCHK2
                   END-IF
      *            À¸³èÊÝ¸î
                   IF      SPA-PTKOH-KOHNUM  (IDX) =   "012"
                       MOVE    1                   TO  FLG-SEIHOGO
                   END-IF
      *!!          ¸å´ü¹âÎð¼ÔÈó³ºÅö(H21.3)
                   IF      SPA-PTKOH-KOHNUM  (IDX) =   "977"
                       MOVE    1                   TO  FLG-RJNCHK3
                   END-IF
      *!!
      *!!          ¹âÎð¼ÔÈó³ºÅö(H22.9)
                   IF      SPA-PTKOH-KOHNUM  (IDX) =   "976"
                       MOVE    1                   TO  FLG-RJNCHK3
                       MOVE    1                   TO  FLG-RJNCHK4
                   END-IF
      *!!
               END-IF
      *        £È£±£¸¡¥£±£°²þÀµ Ï·¿Í£²³ä¤ò£³³ä¤Ø
               IF     (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"        )
                   IF     (SPA-PTKOH-KOHNUM  (IDX) =   "027" )  AND
                          (SPA-PTKOH-TEKEDYMD(IDX) >=  "20061001") AND
                          (SPA-PTKOH-PAYKBN(IDX)(2:1)  =   "2"   )
      *                ÀÚÂØ¤¨¸å¤Î£³³ä¤¬¤¢¤ë¤³¤È
                       PERFORM 4103319-RJNKOH-CHK-SEC
                       IF      FLG-KOH27           =   1
                           MOVE    1                   TO  FLG-RJNKOHERR
                           MOVE    IDX                 TO  SPA-KOH-IDX2
                       END-IF
                   END-IF
               END-IF
      *        £È£²£°¡¥£´²þÀµ Ï·¿Í¸øÈñ
               IF     (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"  )   AND
                      (SPA-PTKOH-KOHNUM   (IDX)     =  "027" )  AND
                      (SPA-PTKOH-TEKEDYMD (IDX)     =  "20080331")
                   MOVE    1                   TO  FLG-27KOH-OK
               END-IF
           END-PERFORM
           IF      SPA-SYSYMD          <   "20080401"
      *        Á°´ü¹âÎð¼Ô¶èÊ¬¤¬¤¢¤ê¡¢Ï·¿Í¸øÈñ¤¬¤Ê¤¤»þ
               IF     (FLG-RJNCHK          =   1   )
                 AND  (FLG-RJNCHK2         =   ZERO)
                 AND  (FLG-RJNERR          =   ZERO)
                 AND  (FLG-RJNKOHERR       =   ZERO)
                   CONTINUE
               ELSE
                   PERFORM 4103311-RJN-CHEK02-SEC
               END-IF
           ELSE
      *        £È£²£°¡¥£´¤«¤é
               IF      SPA-SYSYMD          >=  SPA-BYMD-75-2
      *            £·£µºÐ°Ê¾å¤Ç¸å´ü¹âÎð¼Ô¤¬¤Ê¤¤»þ
                   IF     (FLG-RJNCHK          =   2   )
                       OR (FLG-RJNCHK2         =   1   )
                       IF      (FLG-RJNCHK2        =   1   )
                           AND (FLG-RJNCHK     NOT =   2   )
                           AND (FLG-HKNCHK         =   1   )
      *                ÊÝ¸±¤¬¤¢¤ê¡¢¸å´üÈó³ºÅö¤¬¤Ê¤¤»þ
                           AND (FLG-RJNCHK3        =   ZERO )
                           MOVE    "0121"              TO  SPA-ERRCD
                           MOVE    10                  TO  SPA-GMN-CUR
                       END-IF
                   ELSE
                       IF     (FLG-HKNCHK         =   1   )
      *                ÊÝ¸±¤¬¤¢¤ê¡¢¸å´üÈó³ºÅö¤¬¤Ê¤¤»þ
                       AND    (FLG-RJNCHK3        =   ZERO )
                           IF      FLG-HKNCHK2        =    ZERO
                               MOVE    "0120"              TO  SPA-ERRCD
                           ELSE
                               MOVE    "0121"              TO  SPA-ERRCD
                           END-IF
                           MOVE    10                  TO  SPA-GMN-CUR
                       END-IF
                   END-IF
      *!!
      *            ¸å´üÈó³ºÅö¤¬¤¢¤ê¡¢Á°´ü¹âÎð¼ÔÊÝ¸±¤¬¤Ê¤¤»þ
                   IF     (FLG-RJNCHK3         =   1 )
                   AND    (FLG-HKNCHK          =   1 )
                   AND    (FLG-RJNCHK          =   ZERO )
      *            ¹âÎð¼ÔÈó³ºÅö°Ê³°
                   AND    (FLG-RJNCHK4         =   ZERO )
                       MOVE    "0128"              TO  SPA-ERRCD
                       MOVE    11                  TO  SPA-GMN-CUR
                   END-IF
      *!!
      *            ½ªÎ»¤¹¤ëÊÝ¸±¤òºÆÉ½¼¨
                   IF     (SPA-ERRCD           =   "0121" )
                      AND (SPA-HKN-IDX1    NOT =   ZERO   )
                      AND (SPA-NAI-HKNSTR  NOT =   SPA-HKN-IDX1)
                       INITIALIZE                  SPA-GMN-HKN-AREA
                       MOVE    SPA-HKN-IDX1    TO  IDX
                       MOVE    IDX             TO  SPA-NAI-HKNSTR
                       PERFORM 3101-HOKEN-HEN-SEC
                   END-IF
               ELSE
      *            £·£°ºÐ¤«¤é£·£µºÐ¤Þ¤Ç
      *            Á°´ü¹âÎð¼Ô¶èÊ¬¤¬¤¢¤ê¡¢Ï·¿Í¸øÈñ¤¬¤Ê¤¤»þ
                   IF     (FLG-RJNCHK          =   1   )
                     AND  (FLG-RJNCHK2         =   ZERO)
                     AND  (FLG-RJNERR          =   ZERO)
                     AND  (FLG-RJNKOHERR       =   ZERO)
                       CONTINUE
                   ELSE
      *              ¹âÎð¼ÔÈó³ºÅö°Ê³°
                     IF   (FLG-RJNCHK4         =   ZERO   )
                       PERFORM 4103311-RJN-CHEK02-SEC
                   END-IF
                   END-IF
               END-IF
           END-IF
      *!!!
      *    Á°´ü¹âÎð¼Ô¡Ê£·£°ºÐ¡Ë¤ÇÊÝ¸±¤Î´ü´ÖÊÑ¹¹¤¬¤Ê¤¤¾ì¹ç¡¢³ÎÇ§Ç¯·îÆü¥Á¥§¥Ã¥¯
           IF      (SPA-ERRCD          =   SPACE )
              AND  (SPA-PIDCD          =   SPACE )
              AND  (FLG-KOKUHO-CHK     =   1     )
               MOVE    WRK-KOKUHO-CHK      TO  IDX
               IF     (SPA-PTHKN-KAKUNINYMD (IDX)
                                           >=  SPA-BYMD-70 )
                 OR   (SPA-PTHKN-KAKUNINYMD (IDX)
                                           >=  SPA-SYSYMD  )
                    CONTINUE
               ELSE
                   IF      SPA-KEI-KOUKI3      =   ZERO
                       MOVE    "K151"              TO  SPA-ERRCD
                       MOVE    17                  TO  SPA-GMN-CUR
                       MOVE    1                   TO  SPA-KEI-KOUKI3
                       INITIALIZE                  SPA-GMN-HKN-AREA
                       MOVE    IDX             TO  SPA-NAI-HKNSTR
                       MOVE    IDX             TO  SPA-HKN-IDX1
                       PERFORM 3101-HOKEN-HEN-SEC
                   END-IF
               END-IF
           END-IF
      *
      *
           .
       410331-RJN-HKNCHK-EXT.
           EXIT.
      ****************************************************************
      *    Á°´ü¹âÎð¼Ô¡¦Ï·¿Í¸øÈñ¤ÎÀÚÂØ¤¨¡¦¥¨¥é¡¼½èÍý
      ****************************************************************
       4103311-RJN-CHEK02-SEC     SECTION.
      *
      *    Ï·¿ÍÊÝ¸±¤¬¤Ê¤¯¡¢ÊÝ¸±¤¬Â¸ºß¤¹¤ë»þ
           IF     (FLG-RJNCHK          =   ZERO  )  AND
                  (FLG-RJNCHK2         =   ZERO  )  AND
                  (FLG-HKNCHK          =   1     )
             AND  (FLG-27KOH-OK        =   ZERO )
      *        £Ó£·¡¥£¹¡¥£³£°°ÊÁ°¤Î»þÏ·¿Í¸øÈñ¤¬¤¢¤ë¤³¤È¤È¤¹¤ë
               IF     (SPA-NAI-BIRTHDAY    <=  "19320930" )  OR
                      (SPA-SYSYMD          >=  SPA-BYMD-75)
                   MOVE    "0105"              TO  SPA-ERRCD
                   MOVE    20                  TO  SPA-GMN-CUR
               ELSE
      *        ¹âÎð¼ÔÊÝ¸±¤ò¼«Æ°ÊÑ´¹¤Ø
      *            ³«»ÏÆü¤¬£·£°ºÐ°Ê¾å
                   IF      SPA-PTHKN-TEKSTYMD(SPA-HKN-IDX1)
                                               >=  SPA-BYMD-70
                       MOVE    "1066"              TO  SPA-ERRCD
                       MOVE    11                  TO  SPA-GMN-CUR
                   ELSE
                       MOVE    SPA-PTHKN-HKNNUM-MEI(SPA-HKN-IDX1)
                                                   TO  SPA-PIDMSG
                       MOVE    "0104"              TO  SPA-PIDCD
                       MOVE    8                   TO  SPA-GMN-CUR
                  END-IF
               END-IF
           END-IF
      *    Ï·¿Í¸øÈñ¤¬¤Ê¤¯¡¢£²³ä¤ÎÊÝ¸±¤¬Â¸ºß¤¹¤ë»þ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PIDCD           =   SPACE )
               IF     (FLG-RJNCHK          =   1     )  AND
                      (FLG-RJNERR          =   1     )  AND
                      (FLG-RJNCHK2         =   ZERO  )
                 AND  (FLG-27KOH-OK        =   ZERO )
                   MOVE    SPA-PTHKN-HKNNUM-MEI(SPA-HKN-IDX1)
                                                   TO  SPA-PIDMSG
                   MOVE    "0110"              TO  SPA-PIDCD
                   MOVE    8                   TO  SPA-GMN-CUR
               END-IF
      *        Êä½õ¶èÊ¬ÁªÂò¥¨¥é¡¼
               IF      FLG-RJNERR          =   2
                   MOVE    "1067"              TO  SPA-ERRCD
                   MOVE    11                  TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
      *    Ï·¿Í¸øÈñ£²³ä¤ÎÊÝ¸±¤¬Â¸ºß¤¹¤ë»þ¡ÊVER.3.2.0¤«¤é¡Ë
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PIDCD           =   SPACE )
               IF     (FLG-RJNKOHERR       =   1     )
      *            ²èÌÌ°ÌÃÖ
                   IF      SPA-KOH-MAX         >=  3
      *                ¹ÔÁÞÆþ
                       MOVE    ZERO                TO  SPA-HKNKOH-FLG
                       PERFORM 4104-KOH-ADD-SEC
                       MOVE    1                   TO  SPA-KOH-GMN2
                   ELSE
                       COMPUTE SPA-KOH-GMN2   =   SPA-KOH-MAX
                                              +   1
                   END-IF
      *
                   IF      SPA-ERRCD           =   SPACE
      *
                   MOVE    ZERO                TO  SPA-KOH-GMN1
                   MOVE    ZERO                TO  FLG-KOH27
                   PERFORM VARYING     IDX-K   FROM    1   BY  1
                           UNTIL       IDX-K   >   3
                       IF     (SPA-NAI-PTKOH-EDANUM(IDX-K)
                                               =   SPA-KOH-IDX2 )
                         AND  (SPA-GMN-KOHNUM (IDX-K)  =   "027" )
                           MOVE    IDX-K           TO  SPA-KOH-GMN1
                       END-IF
                   END-PERFORM
                   MOVE    "0111"              TO  SPA-PIDCD
                   MOVE    21                  TO  SPA-GMN-CUR
      *
               END-IF
      *
               END-IF
           END-IF
      *
           .
       4103311-RJN-CHEK02-EXT.
           EXIT.
      ****************************************************************
      *    Á°´ü¹âÎð¼Ô¡¦¸å´ü¹âÎð¼Ô¶èÊ¬½èÍý
      ****************************************************************
       4103311-HKNKBN-CHK-SEC     SECTION.
      *
           EVALUATE    SPA-PTHKN-HKNNUM  (IDX)
      *        ¹ñÊÝ
               WHEN    "060"
               WHEN    "068"
      *            £È£±£¸¡¥£±£°¤Þ¤Ç
                   IF     (SPA-PTHKN-TEKEDYMD (IDX) <  "20061001")
                       IF    (SPA-PTHKN-HOJOKBN (IDX)  =   "1"
                                                       OR  "2"
                                                       OR  "4"
                                                       OR  "5")
                           MOVE    1               TO  FLG-RJNCHK
                       END-IF
                   ELSE
                       IF    (SPA-BYMD-70          <  "20061001")
                         AND (SPA-PTHKN-TEKSTYMD (IDX)
                                                   <= SPA-BYMD-70)
                         AND (SPA-SYSYMD           <  "20061001")
                           IF    (SPA-PTHKN-HOJOKBN (IDX)
                                                       =   "1"
                                                       OR  "2"
                                                       OR  "4"
                                                       OR  "5")
                               MOVE    1           TO  FLG-RJNCHK
                           END-IF
                       ELSE
      *                £È£±£¸¡¥£±£°°Ê¹ß
                           IF      SPA-PTHKN-HOJOKBN (IDX)  NOT =   "0"
                               MOVE    1               TO  FLG-RJNCHK
                           END-IF
                       END-IF
      *                ÁÈ¹ç¹ñÊÝ°Ê³°¤Ï£²³ä¥¨¥é¡¼
                       IF    (SPA-PTHKN-HKNJANUM(IDX)(3:1)
                                                   NOT =  "3" ) AND
                             (SPA-PTHKN-HOJOKBN (IDX)  =   "2")
                           IF      SPA-PTHKN-TEKSTYMD (IDX)
                                                       <  "20061001"
                               MOVE    1           TO  FLG-RJNERR
                               MOVE    IDX         TO  SPA-HKN-IDX1
                           ELSE
                               MOVE    2           TO  FLG-RJNERR
                               MOVE    IDX         TO  SPA-HKN-IDX1
                           END-IF
                       END-IF
      *                ÁÈ¹ç¹ñÊÝ
                       IF    (SPA-PTHKN-HKNJANUM(IDX)(3:1)
                                                   =  "3" )
                           MOVE    1               TO  FLG-KOKUHO
                       END-IF
      *!!
      *                ³«»ÏÆü¤¬£·£°ºÐÌ¤Ëþ¤Ç½ªÎ»Æü¤¬£·£°ºÐ°Ê¾å
                       IF     (SPA-PTHKN-TEKSTYMD (IDX)
                                                   <   SPA-BYMD-70 ) AND
                              (SPA-PTHKN-TEKEDYMD (IDX)
                                                   >   SPA-BYMD-70 )
                           MOVE    1               TO  FLG-KOKUHO-CHK
                           MOVE    IDX             TO  WRK-KOKUHO-CHK
                       END-IF
      *!!
                   END-IF
      *        Á¥°÷¤ÇÊä½õ¶èÊ¬¤¢¤ê
               WHEN    "002"
                   IF     (SPA-PTHKN-HOJOKBN (IDX)     =   "8" OR "9"
                                                       OR  "A" OR "B"
                                                       OR  "C" OR "D"
                                                       OR  "E" OR "F"
                                                       OR  "7"
                                                       OR  "G" OR "H"
                                                       OR  "I"        )
                       MOVE    1                   TO  FLG-RJNCHK
      *                £È£±£¸¡¥£±£°²þÀµ¡ÊÏ·¿Í£²³ä¤ÏÊÑ¹¹¡Ë
                       IF     (SPA-PTHKN-TEKSTYMD (IDX) <   "20061001")
                          AND (SPA-PTHKN-TEKEDYMD (IDX) >=  "20061001")
                           IF     (SPA-PTHKN-HOJOKBN (IDX) =   "8"
                                                           OR  "D"
                                                           OR  "E"
                                                           OR  "F"  )
                              AND (SPA-PTHKN-CONTKBN (IDX) =   SPACE)
                               MOVE    1               TO  FLG-RJNERR
                               MOVE    IDX             TO  SPA-HKN-IDX1
                           END-IF
                       END-IF
                   END-IF
      *            ËÜ¿Í¤Ç²¼Á¥¸å¤Ê¤é¸å´ü¹âÎð¼Ô°·¤¤¤È¤¹¤ë
                   IF      (SPA-PTHKN-HOJOKBN (IDX)    =   "A"
                                                       OR  "B"
                                                       OR  "C"
                                                       OR  "D"
                                                       OR  "E"
                                                       OR  "F"
                                                       OR  "G"
                                                       OR  "H"
                                                       OR  "I" )
                       AND (SPA-PTHKN-HONKZKKBN(IDX)   =   "1" )
                       AND (SPA-PTHKN-TEKEDYMD (IDX)   >=  "20080401")
                       MOVE    2                   TO  FLG-RJNCHK
                   END-IF
      *!!
      *                ³«»ÏÆü¤¬£·£°ºÐÌ¤Ëþ¤Ç½ªÎ»Æü¤¬£·£°ºÐ°Ê¾å
                       IF     (SPA-PTHKN-TEKSTYMD (IDX)
                                                   <   SPA-BYMD-70 ) AND
                              (SPA-PTHKN-TEKEDYMD (IDX)
                                                   >   SPA-BYMD-70 )
                           MOVE    1               TO  FLG-KOKUHO-CHK
                           MOVE    IDX             TO  WRK-KOKUHO-CHK
                       END-IF
      *!!
      *        ¶¦ºÑ
               WHEN    "031"
               WHEN    "032"
               WHEN    "033"
               WHEN    "034"
                   IF     (SPA-PTHKN-HOJOKBN (IDX)     =   "8" OR "9"
                                                       OR  "7"
                                                       OR  "B" OR "E"
                                                       OR  "H"       )
      *                £È£±£¸¡¥£±£°²þÀµ¡ÊÏ·¿Í£²³ä¤ÏÊÑ¹¹¡Ë
                       IF     (SPA-PTHKN-TEKSTYMD (IDX) <   "20061001")
                          AND (SPA-PTHKN-TEKEDYMD (IDX) >=  "20061001")
                           IF     (SPA-PTHKN-HOJOKBN (IDX) =   "8"
                                                           OR  "E"  )
                              AND (SPA-PTHKN-CONTKBN (IDX) =   SPACE)
                               MOVE    1               TO  FLG-RJNERR
                               MOVE    IDX             TO  SPA-HKN-IDX1
                           END-IF
                       END-IF
                       MOVE    1                   TO  FLG-RJNCHK
                   END-IF
      *        ¸å´ü¹âÎð¼Ô
               WHEN    "039"
               WHEN    "040"
                   MOVE    2                   TO  FLG-RJNCHK
      *        ¤½¤ÎÂ¾
               WHEN    OTHER
                   IF      SPA-PTHKN-HOJOKBN (IDX) =   "8"  OR  "9"
                                                   OR  "7"
                       MOVE    1                   TO  FLG-RJNCHK
                   END-IF
      *            £È£±£¸¡¥£±£°²þÀµ¡ÊÏ·¿Í£²³ä¤ÏÊÑ¹¹¡Ë
                   IF     (SPA-PTHKN-TEKSTYMD (IDX) <   "20061001")
                      AND (SPA-PTHKN-TEKEDYMD (IDX) >=  "20061001")
                       IF     (SPA-PTHKN-HOJOKBN (IDX) =   "8" )
                          AND (SPA-PTHKN-CONTKBN (IDX) =   SPACE)
                           MOVE    1               TO  FLG-RJNERR
                           MOVE    IDX             TO  SPA-HKN-IDX1
                        END-IF
                   END-IF
           END-EVALUATE
      *
           .
       4103311-HKNKBN-CHK-EXT.
           EXIT.
      ****************************************************************
      *    Ï·¿Í¸øÈñ£²³ä¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       410332-RJN27-CHK-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-RJNKOHERR
      *DDD MOVE    ZERO                TO  FLG-KOKUHO
      *    PERFORM VARYING     IDX     FROM    1  BY  1
      *            UNTIL       IDX     >   SPA-PTHKN-MAX
      *        IF     (SPA-PTHKN-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
      *               (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
      *               (SPA-PTHKN-SAKJOKBN (IDX) NOT =  "1"        )
      *            ÁÈ¹ç¹ñÊÝ¤ÎÍ­Ìµ
      *            IF     (SPA-PTHKN-HKNNUM  (IDX) =   "060"
      *                                            OR  "068" )  AND
      *                   (SPA-PTHKN-TEKEDYMD (IDX) <   "20061001")
      *                ÁÈ¹ç¹ñÊÝ
      *                IF    (SPA-PTHKN-HKNJANUM(IDX)(3:1)
      *                                            =  "3" )
      *                    MOVE    1               TO  FLG-KOKUHO
      *                END-IF
      *            END-IF
      *        END-IF
      *DDD END-PERFORM
      *
      *    ¸øÈñ
           MOVE    ZERO                TO  SPA-KOH-IDX2
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
      ******** IF     (SPA-PTKOH-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
               IF     (SPA-PTKOH-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"        )
      *            £È£±£¸¡¥£±£°²þÀµ Ï·¿Í£²³ä¤ò£³³ä¤Ø
                   IF     (SPA-PTKOH-KOHNUM  (IDX) =   "027" )  AND
                          (SPA-PTKOH-TEKEDYMD(IDX) >=  "20061001") AND
                          (SPA-PTKOH-PAYKBN(IDX)(2:1)  =   "2"   )
      *                ÀÚÂØ¤¨¸å¤Î£³³ä¤¬¤¢¤ë¤³¤È
                       PERFORM 4103319-RJNKOH-CHK-SEC
                       IF      FLG-KOH27           =   1
                           MOVE    1                   TO  FLG-RJNKOHERR
                           MOVE    IDX                 TO  SPA-KOH-IDX2
                       END-IF
                   END-IF
               END-IF
           END-PERFORM
      *
      *    Ï·¿Í¸øÈñ£²³ä¤ÎÊÝ¸±¤¬Â¸ºß¤¹¤ë»þ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PIDCD           =   SPACE )
               IF     (FLG-RJNKOHERR       =   1     )
      *            ²èÌÌ°ÌÃÖ
                   IF      SPA-KOH-MAX         >=  3
      *                ¹ÔÁÞÆþ
                       MOVE    ZERO                TO  SPA-HKNKOH-FLG
                       PERFORM 4104-KOH-ADD-SEC
                       MOVE    1                   TO  SPA-KOH-GMN2
                   ELSE
                       COMPUTE SPA-KOH-GMN2   =   SPA-KOH-MAX
                                              +   1
                   END-IF
      *
                   IF      SPA-ERRCD           =   SPACE
      *
                   MOVE    ZERO                TO  SPA-KOH-GMN1
                   MOVE    ZERO                TO  FLG-KOH27
                   PERFORM VARYING     IDX-K   FROM    1   BY  1
                           UNTIL       IDX-K   >   3
                       IF     (SPA-NAI-PTKOH-EDANUM(IDX-K)
                                               =   SPA-KOH-IDX2 )
                         AND  (SPA-GMN-KOHNUM (IDX-K)  =   "027" )
                           MOVE    IDX-K           TO  SPA-KOH-GMN1
                       END-IF
                   END-PERFORM
                   MOVE    "0111"              TO  SPA-PIDCD
                   MOVE    21                  TO  SPA-GMN-CUR
               END-IF
      *
               END-IF
      *
           END-IF
           .
       410332-RJN27-CHK-EXT.
           EXIT.
      ****************************************************************
      *    Ï·¿Í¸øÈñ½ªÎ»¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       410333-RJN27-ENDCHK-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-RJNCHK
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               IF     (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-SAKJOKBN (IDX) NOT =  "1"        )
                   IF      SPA-PTHKN-HKNNUM(IDX)    =   "039"
                                                    OR  "040"
      *                ¸å´ü¹âÎð¼Ô¶èÊ¬È½Äê
                       MOVE    1               TO  FLG-RJNCHK
                   END-IF
               END-IF
           END-PERFORM
      *    ¸øÈñ
           MOVE    ZERO                TO  FLG-RJNCHK2
           MOVE    ZERO                TO  FLG-27KOH-OK
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
               IF     (SPA-PTKOH-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"        )
      *             £È£²£°¡¥£´ ¸å´ü¹âÎð¼Ô³ºÅö
                   IF     (SPA-PTKOH-KOHNUM  (IDX) =   "968" )
      *!!               ¸å´ü¹âÎð¼ÔÈó³ºÅö(H21.3)
                       OR (SPA-PTKOH-KOHNUM  (IDX) =   "977" )
      *!!               ¹âÎð¼ÔÈó³ºÅö(H22.9)
                       OR (SPA-PTKOH-KOHNUM  (IDX) =   "976" )
                       MOVE    1                   TO  FLG-RJNCHK2
                   END-IF
               END-IF
      *        £È£²£°¡¥£´²þÀµ Ï·¿Í¸øÈñ
               IF     (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"  )   AND
                      (SPA-PTKOH-KOHNUM   (IDX)     =  "027" )  AND
                      (SPA-PTKOH-TEKEDYMD (IDX)     =  "20080331")
                  IF     (SPA-PTKOH-KAKUNINYMD (IDX)   <  "20080401")
      *            £´·î°Ê¹ß¤ÏÅöÆü
                  OR    ((SPA-PTKOH-KAKUNINYMD (IDX)   >=  "20080401")
                     AND (SPA-PTKOH-KAKUNINYMD (IDX)   =   SPA-SYSYMD))
                       MOVE    1                   TO  FLG-27KOH-OK
                   END-IF
               END-IF
           END-PERFORM
      *    £²£·Ï·¿Í¸øÈñ¤¬£È£²£°¡¥£³¡¥£³£±¤Ç½ªÎ»¡¢¤«¤Ä¡¢¸å´ü¤¬¤Ê¤¤»þ
           IF     (FLG-27KOH-OK        =   1     )
               IF     (FLG-RJNCHK          =   1    )  OR
                      (FLG-RJNCHK2         =   1    )
                   CONTINUE
               ELSE
                   IF      SPA-KEI-KOUKI2       =   ZERO
                       MOVE    1                   TO  SPA-KEI-KOUKI2
                       MOVE    "K123"              TO  SPA-ERRCD
                       MOVE    10                  TO  SPA-GMN-CUR
                   END-IF
               END-IF
           END-IF
           .
       410333-RJN27-ENDCHK-EXT.
           EXIT.
      *!!
      *TEST
      ****************************************************************
      *    Âà¿¦¹ñÊÝ¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       410334-TAIKOKUHO-CHK-SEC     SECTION.
      *
           MOVE    ZERO                TO  WRK-NAI-HKNSTR
           MOVE    ZERO                TO  FLG-HKNCHK3
           MOVE    ZERO                TO  FLG-HKNCHK2
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               IF     (SPA-PTHKN-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-SAKJOKBN (IDX) NOT =  "1"        )
                   IF     (SPA-PTHKN-HKNNUM   (IDX)    =   "067"  ) AND
                          (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-BYMD-65)
                       MOVE    IDX             TO  WRK-NAI-HKNSTR
                       MOVE    1                   TO  FLG-HKNCHK3
                   END-IF
      *            Â¾ÊÝ¸±
                   IF     (SPA-PTHKN-HKNNUM (IDX)  NOT =   "067"  )
                       MOVE    1                   TO  FLG-HKNCHK2
                   END-IF
               END-IF
           END-PERFORM
      *
           IF      WRK-NAI-HKNSTR      >   ZERO
               MOVE    "1051"              TO  SPA-ERRCD
               MOVE    17                  TO  SPA-GMN-CUR
               IF      WRK-NAI-HKNSTR      NOT =   SPA-NAI-HKNSTR
                   INITIALIZE                  SPA-GMN-HKN-AREA
                   MOVE    WRK-NAI-HKNSTR      TO  SPA-NAI-HKNSTR
                   MOVE    SPA-NAI-HKNSTR      TO  IDX
                   PERFORM 3101-HOKEN-HEN-SEC
               END-IF
           END-IF
           .
       410334-TAIKOKUHO-CHK-EXT.
           EXIT.
      *!!
      *TEST
      *
      ****************************************************************
      *    ÊÝ¸±¤È¸øÈñ¤Î´ü´Ö½ÅÊ£¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4103319-RJNKOH-CHK-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-KOH27
           PERFORM VARYING     IDXK    FROM    1   BY  1
                   UNTIL       IDXK    >   SPA-GMN-KOHMAX
               IF     (SPA-GMN-KOHNUML (IDXK)   =   "027" )  AND
                      (SPA-GMN-KOHKBNL (IDXK)   =   "3"   )
                   MOVE    1               TO  FLG-KOH27
                   MOVE    SPA-GMN-KOHMAX  TO  IDXK
               END-IF
           END-PERFORM
      *
           .
       4103319-RJNKOH-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÊÝ¸±¤È¸øÈñ¤Î´ü´Ö½ÅÊ£¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       410331-HKNKOH-JYUFUKU-SEC      SECTION.
      *
          IF     (SPA-PTKOH-TEKEDYMD (IDY)
                                       <   SPA-PTHKN-TEKSTYMD (IDX)) OR
                  (SPA-PTKOH-TEKSTYMD (IDY)
                                       >   SPA-PTHKN-TEKEDYMD (IDX))
               CONTINUE
           ELSE
      *        À¸³èÊÝ¸î¤Î¾ì¹ç¥¨¥é¡¼
               IF      SPA-PTKOH-HKN-SBTKBN (IDY)  =   "5"
                   MOVE    "0089"              TO  SPA-ERRCD
      *
                   IF      SPA-PTHKN-HKNNUM(IDX)    =   "039"
                                                    OR  "040"
                       MOVE    "0124"          TO  SPA-ERRCD
                   END-IF
               END-IF
      *        »ÄÎ±Ë®¿Í¤Î¾ì¹ç¥¨¥é¡¼
               IF      SPA-PTKOH-KOHNUM (IDY)  =   "025"
                   MOVE    "0126"              TO  SPA-ERRCD
      *
                   IF      SPA-PTHKN-HKNNUM(IDX)    =   "039"
                                                    OR  "040"
                       MOVE    "0125"          TO  SPA-ERRCD
                   END-IF
               END-IF
           END-IF
      *
           .
       410331-HKNKOH-JYUFUKU-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¸øÈñÄÉ²Ã½èÍý
      ****************************************************************
       4104-KOH-ADD-SEC      SECTION.
      *
           IF      SPA-HKNKOH-FLG  NOT =   1
      *        ¸øÈñ²èÌÌ¤ÎÆâÍÆ¤ò£Ô£Â£Ì¤ØÊÔ½¸¤¹¤ë
               PERFORM 41032-KOH-SPA-TBL-SET-SEC
           END-IF
      *    ¥Æ¡¼¥Ö¥ë·ï¿ô
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PTKOH-MAX       >=  TBL-MAX-KOH )
               MOVE    "0106"          TO  SPA-ERRCD
               GO      TO      4104-KOH-ADD-EXT
           END-IF
      *
      *    ºÇ½é¤Î£±¹Ô¤ò³«¤±¤ë
           IF      SPA-NAI-PTKOH-EDANUM(1) NOT =   ZERO
               MOVE    SPA-NAI-PTKOH-EDANUM(1) TO  IDX-K2
               INITIALIZE                  SPA-GMN-KOH-AREA
               MOVE    1                   TO  IDY
               PERFORM VARYING     IDX     FROM    IDX-K2 BY  1
                       UNTIL      (IDX     >   SPA-PTKOH-MAX )  OR
                                  (IDY     >=  3    )
                   IF      SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE
                       ADD     1                   TO  IDY
                       MOVE    IDY                 TO  SPA-KOH-MAX
                       PERFORM 3102-KOUHI-HEN-SEC
                   END-IF
               END-PERFORM
           ELSE
               INITIALIZE                  SPA-GMN-KOH-AREA
           END-IF
           MOVE    20                  TO  SPA-GMN-CUR
      *
           .
       4104-KOH-ADD-EXT.
           EXIT.
      *
      *
      ****************************************************************
      *    ´Á»ú»áÌ¾ÊÔ½¸½èÍý
      ****************************************************************
       4101-KANJI-NAME-EDIT-SEC     SECTION.
      *
           MOVE    SPA-GMN-KANANAME
                                   TO  SPA-GMN-OLD-KANANAME
           MOVE    SPA-GMN-NAME
                                   TO  SPA-GMN-OLD-NAME
      *
      **** ¿ÍÌ¾¼­½ñÉÔ»ÈÍÑ¤Î¾ì¹ç
      *    IF      SPA-NAI-JINMEI-USE  =   "1"
      *        GO      TO      4101-KANJI-NAME-EDIT-EXT
      **** END-IF
      *
           MOVE    SPACE           TO  WRK-NAME-AREA
      *
           MOVE    SPACE           TO  SPA-P100-AREA
           INITIALIZE              SPA-P100-AREA
      *
      *    Á´³Ñ¥¹¥Ú¡¼¥¹¤ò"@@"¤ËÃÖ¤­´¹¤¨¤ë
      *    ¡Ê¤³¤ì¤ò¤·¤Æ¤ª¤«¤Ê¤¤¤È"¥¡¡¼"¤ò´Þ¤àÊ¸»úÎó¤¬
      *    ¤¦¤Þ¤¯Ê¬²ò¤Ç¤­¤Ê¤¤¡£¡Ë
           MOVE    SPA-GMN-KANANAME
                                   TO  WRK-NAME-X-AREA
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   25 )
                OR       ( WRK-NAME-X (IDX1) = SPACE )
      *
               IF  ( WRK-NAME-X (IDX1) =   "¡¡" )
                   MOVE    "@@"    TO  WRK-NAME-X (IDX1)
               END-IF
      *
           END-PERFORM
      *
      *    ¥ß¥É¥ë¥Í¡¼¥à¤¬¤¢¤ë¿Í¤ò¹ÍÎ¸¤·¤ÆÊÔ½¸¤ò¹Ô¤¦
           UNSTRING    WRK-NAME-X-AREA
                                   DELIMITED BY    "@@" OR SPACE
           INTO    WRK-NAME-VAL (1)
                   WRK-NAME-VAL (2)
                   WRK-NAME-VAL (3)
           END-UNSTRING
      *
           IF ( WRK-NAME-VAL (3)   NOT =   SPACE )
               MOVE    WRK-NAME-VAL (1)
                                   TO  WRK-NAME-KANA (1)
               MOVE    WRK-NAME-VAL (3)
                                   TO  WRK-NAME-KANA (2)
           ELSE
               MOVE    WRK-NAME-VAL (1)
                                   TO  WRK-NAME-KANA (1)
               MOVE    WRK-NAME-VAL (2)
                                   TO  WRK-NAME-KANA (2)
           END-IF
      *
      *    »áÊÔ½¸
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >       2 )
      *
               PERFORM 4101-KANJI-NAME-SELECT-SEC
      *
               MOVE    WRK-KANJINAME-T (1)
                                   TO  WRK-NAME-KANJI (IDX1)
               MOVE    WRK-KANJINAME-AREA
                                   TO  SPA-GMN-P100-KANJILST-ITM-AREA
                                                                (IDX1)
               MOVE    CNT-JINMEI  TO  SPA-GMN-P100-KANJILST-COUNT
                                                                (IDX1)
      *
           END-PERFORM
      *
      *    ´Á»ú»áÌ¾¸¡º÷²èÌÌ¸Æ½Ð
           PERFORM SPA-GMN-P100-CALL-SEC
      *
           .
      *
       4101-KANJI-NAME-EDIT-EXT.
           EXIT.
      ****************************************************************
      *    ´Á»ú»áÌ¾¸¡º÷½èÍý
      ****************************************************************
       4101-KANJI-NAME-SELECT-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-NAME (IDX1)
      *
           MOVE    SPACE               TO  WRK-KANJINAME-AREA
           MOVE    ZERO                TO  FLG-JINMEI
                                           CNT-JINMEI
      *
           IF  ( WRK-NAME-KANA (IDX1)  =   SPACE )
               MOVE    1               TO  FLG-NAME (IDX1)
               GO  TO  4101-KANJI-NAME-SELECT-EXT
           END-IF
      *
           MOVE    WRK-NAME-KANA (IDX1)
                                       TO  JINMEI-KANA
      *
      *    ¿ÍÌ¾¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
           PERFORM 941-JINMEI-SELECT-SEC
      *
           PERFORM UNTIL ( FLG-JINMEI  =   1 )
                    OR   ( CNT-JINMEI >=   50 )
      *
      *        ¿ÍÌ¾¥Æ¡¼¥Ö¥ëÆÉ¹þ½èÍý
               PERFORM 941-JINMEI-NEXT-SEC
               IF  ( FLG-JINMEI        =   ZERO )
                   COMPUTE CNT-JINMEI  =   CNT-JINMEI  +   1
                   MOVE    JINMEI-KANJI
                                       TO  WRK-KANJINAME-T (CNT-JINMEI)
               END-IF
      *
           END-PERFORM
      *
           PERFORM 941-JINMEI-CLOSE-SEC
      *
           IF  ( CNT-JINMEI   >=   50 )
               GO  TO  4101-KANJI-NAME-SELECT-EXT
           END-IF
      *
      *    ¥«¥¿¥«¥Ê¤ò°ìÍ÷¤ÎºÇ¸å¤ËºÜ¤»¤ë
      *    ¡Ê´û¤Ë¥ê¥¹¥È¤ËÂ¸ºß¤·¤Æ¤¤¤ë¾ì¹ç¤ÏºÜ¤»¤Ê¤¤¡Ë
           SET     IDX-NAME    TO  1
           SEARCH  WRK-KANJINAME-OCC   VARYING  IDX-NAME
           AT  END
               COMPUTE CNT-JINMEI  =   CNT-JINMEI  +   1
               MOVE    WRK-NAME-KANA (IDX1)
                                   TO  WRK-KANJINAME-T (CNT-JINMEI)
           WHEN    WRK-KANJINAME-T (IDX-NAME)
                                   =   WRK-NAME-KANA (IDX1)
               CONTINUE
           END-SEARCH
           .
      *
       4101-KANJI-NAME-SELECT-EXT.
           EXIT.
      ****************************************************************
      *    ¥«¥Ê»áÌ¾¸¡º÷²èÌÌ¸Æ½Ð½èÍý
      ****************************************************************
       SPA-GMN-P100-CALL-SEC           SECTION.
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >       2 )
               MOVE    "¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡"
                                   TO  SPA-GMN-P100-KANANAME (IDX1)
      *
               STRING  WRK-NAME-KANA (IDX1)
                                   DELIMITED   BY  SPACE
               INTO    SPA-GMN-P100-KANANAME (IDX1)
               END-STRING
      *
      *
               IF  ( FLG-NAME (IDX1)   =   ZERO )
                   MOVE    WIDGET-NORMAL
                               TO  SPA-GMN-P100-SELNUM-STATE  (IDX1)
                   MOVE   1        TO  SPA-GMN-P100-SELNUM (IDX1)
                   MOVE   SPA-GMN-P100-KANJILST-KANJI (IDX1 1)
                               TO  SPA-GMN-P100-KANJINAME (IDX1)
               ELSE
                   MOVE    WIDGET-INSENSITIVE
                               TO  SPA-GMN-P100-SELNUM-STATE (IDX1)
                   MOVE    1   TO  SPA-GMN-P100-KANJILST-COUNT (IDX1)
                   MOVE    "³ºÅö¤Ê¤·"
                               TO  SPA-GMN-P100-KANJILST-KANJI(IDX1 1)
               END-IF
      *
           END-PERFORM
      *
           MOVE    SPACE               TO  SPA-MOTOPG
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP100"          USING
                                           MCPAREA
                                           SPAAREA
                                           LINKAREA
                                           SCRAREA
      *
      *
           MOVE    SPA-COMMON          TO  SPA-AREA
           MOVE    SPA-FREE            TO  SPA-P02SCRAREA
           MOVE    SPA-WORK            TO  SPA-P02KYOUTU
      *
           IF (SPA-GMN-P100-SELNUM-STATE (1)
                                       =   WIDGET-NORMAL )
               MOVE  "SELNUM1"         TO  MCP-WIDGET
           ELSE
               MOVE  "SELNUM2"         TO  MCP-WIDGET
           END-IF
      *
           MOVE  "P02"                 TO  SPA-MOTOPG
           MOVE  "P100"                TO  SPA-SAKIPG
      *
           MOVE  "NEW"                 TO  MCP-PUTTYPE
           MOVE  "P100"                TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE  1             TO  SPA-FLG-END
      *
           .
       SPA-GMN-P100-CALL-EXT.
           EXIT.
      *----(01.00.15) LINE ADD END   ---------------------------------
      ****************************************************************
      *    »àË´¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       490-DEATHKBN-SEC                 SECTION.
      *
           EVALUATE    SPA-GMN-DEATHKBN
               WHEN    "1"
                   MOVE    SPACE           TO  SPA-GMN-DEATHKBN
               WHEN    SPACE
               WHEN    "0"
                   MOVE    "1"             TO  SPA-GMN-DEATHKBN
           END-EVALUATE
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-GMN-DEATHKBN    =   "1"
      *            ÅÐÏ¿¥Ü¥¿¥ó¤Ø
                   MOVE    60                  TO  SPA-GMN-CUR
               ELSE
      *            ÊÝ¸±¤Ø
                   MOVE    8                   TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
           .
       490-DEATHKBN-EXT.
           EXIT.
      *
      ***************************************************************
      *    ÊÝ¸±³ÎÇ§Ç¯·îÆüÆþÎÏºÑ¤ß½èÍý
      ***************************************************************
       450-HKNKAKUNINYMD-ZUMI-SEC      SECTION.
      *
      *    Ï«ºÒ¤Î»þ¡¢Ï«ºÒÊÝ¸±²èÌÌ¤Ø
           IF      SPA-GMN-HKNNUM      =   "971"
                                       OR  "973"
              GO      TO      450-HKNKAKUNINYMD-ZUMI-EXT
           END-IF
      *
           IF      P02-P02-HKNNUM  NOT =   SPACE
               IF     (SPA-SYSYMD          =   SPA-NAI-HKAKUNINYMD) AND
                      (SPA-MAE-HKAKUNINYMD NOT =   SPACE         )
                   MOVE    SPA-MAE-HKAKUNINYMDW
                                               TO  P02-P02-HKAKUNINYMD
               ELSE
                   MOVE    SPA-SYSYMDWH        TO  P02-P02-HKAKUNINYMD
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *
           .
       450-HKNKAKUNINYMD-ZUMI-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¸øÈñ³ÎÇ§Ç¯·îÆüÆþÎÏºÑ¤ß½èÍý
      *****************************************************************
       460-KOHKAKUNINYMD-ZUMI-SEC             SECTION.
      *
           EVALUATE    MCP-WIDGET
               WHEN    "BK1"
                   IF       SPA-GMN-KOHNUM (1) NOT =   SPACE
                       IF     (SPA-SYSYMD      =   SPA-NAI-KKAKUNINYMD
                                                             (1) ) AND
                              (SPA-MAE-KKAKUNINYMD (1)
                                               NOT =   SPACE )
                           MOVE    SPA-MAE-KKAKUNINYMDW (1)
                                               TO  P02-P02-KKAKUNINYMD1
                           MOVE    SPA-MAE-KKAKUNINYMDW (1)
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (1)
                           MOVE    SPA-MAE-KKAKUNINYMD (1)
                                               TO  SPA-NAI-KKAKUNINYMD
                                                                    (1)
                       ELSE
                           MOVE    SPA-SYSYMDWH
                                               TO  P02-P02-KKAKUNINYMD1
                           MOVE    SPA-SYSYMDWH
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (1)
                           MOVE    SPA-SYSYMD  TO  SPA-NAI-KKAKUNINYMD
                                                                    (1)
                       END-IF
                   END-IF
               WHEN    "BK2"
                   IF       SPA-GMN-KOHNUM (2) NOT =   SPACE
                       IF     (SPA-SYSYMD      =   SPA-NAI-KKAKUNINYMD
                                                             (2) ) AND
                              (SPA-MAE-KKAKUNINYMD (2)
                                               NOT =   SPACE )
                           MOVE    SPA-MAE-KKAKUNINYMDW (2)
                                               TO  P02-P02-KKAKUNINYMD2
                           MOVE    SPA-MAE-KKAKUNINYMDW (2)
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (2)
                           MOVE    SPA-MAE-KKAKUNINYMD (2)
                                               TO  SPA-NAI-KKAKUNINYMD
                                                                    (2)
                       ELSE
                           MOVE    SPA-SYSYMDWH
                                               TO  P02-P02-KKAKUNINYMD2
                           MOVE    SPA-SYSYMDWH
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (2)
                           MOVE    SPA-SYSYMD  TO  SPA-NAI-KKAKUNINYMD
                                                                    (2)
                       END-IF
                   END-IF
               WHEN    "BK3"
                   IF       SPA-GMN-KOHNUM (3) NOT =   SPACE
                       IF     (SPA-SYSYMD      =   SPA-NAI-KKAKUNINYMD
                                                             (3) ) AND
                              (SPA-MAE-KKAKUNINYMD (3)
                                               NOT =   SPACE )
                           MOVE    SPA-MAE-KKAKUNINYMDW (3)
                                               TO  P02-P02-KKAKUNINYMD3
                           MOVE    SPA-MAE-KKAKUNINYMDW (3)
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (3)
                           MOVE    SPA-MAE-KKAKUNINYMD (3)
                                               TO  SPA-NAI-KKAKUNINYMD
                                                                    (3)
                       ELSE
                           MOVE    SPA-SYSYMDWH
                                               TO  P02-P02-KKAKUNINYMD3
                           MOVE    SPA-SYSYMDWH
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (3)
                           MOVE    SPA-SYSYMD  TO  SPA-NAI-KKAKUNINYMD
                                                                    (3)
                       END-IF
                   END-IF
           END-EVALUATE
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *
           .
       460-KOHKAKUNINYMD-ZUMI-EXT.
           EXIT.
      ****************************************************************
      *    ¸øÈñ´ü¸ÂÀÚ¤ì¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       460-TEKEDCHKKBN-CHK-SEC             SECTION.
      *
           EVALUATE    MCP-WIDGET
               WHEN    "CK1"
                   IF       SPA-GMN-KOHNUM (1) NOT =   SPACE
                       IF     (SPA-NAI-TEKEDCHKKBN (1)
                                                   =   "1"    )
                           MOVE    SPACE       TO  SPA-NAI-TEKEDCHKKBN
                                                                  (1)
                       ELSE
                           MOVE    "1"         TO  SPA-NAI-TEKEDCHKKBN
                                                                  (1)
                       END-IF
                   END-IF
               WHEN    "CK2"
                   IF       SPA-GMN-KOHNUM (2) NOT =   SPACE
                       IF     (SPA-NAI-TEKEDCHKKBN (2)
                                                   =   "1"    )
                           MOVE    SPACE       TO  SPA-NAI-TEKEDCHKKBN
                                                                  (2)
                       ELSE
                           MOVE    "1"         TO  SPA-NAI-TEKEDCHKKBN
                                                                  (2)
                       END-IF
                   END-IF
               WHEN    "CK3"
                   IF       SPA-GMN-KOHNUM (3) NOT =   SPACE
                       IF     (SPA-NAI-TEKEDCHKKBN (3)
                                                   =   "1"    )
                           MOVE    SPACE       TO  SPA-NAI-TEKEDCHKKBN
                                                                  (3)
                       ELSE
                           MOVE    "1"         TO  SPA-NAI-TEKEDCHKKBN
                                                                  (3)
                       END-IF
                   END-IF
           END-EVALUATE
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *
           .
       460-TEKEDCHKKBN-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    Æó½ÅÅÐÏ¿µ¿¤¤²èÌÌ½èÍý
      ****************************************************************
       41012-NIJYU-TRKGMN-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-P02A-CHK
           IF      FLG-P02A-SYORI      =   1
               IF     (SPA-GMN-KANANAME    =   SPACE )  OR
                      (SPA-GMN-NAME        =   SPACE )
                   MOVE    1               TO  FLG-P02A-CHK
               END-IF
           ELSE
               IF  ( SPA-GMN-KANANAME      =   SPACE )  OR
                   ( SPA-NAI-BIRTHDAY      =   SPACE )  OR
                   ( SPA-GMN-SEX           =   SPACE )
                   MOVE    1               TO  FLG-P02A-CHK
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  SPA-GMN2A-MAX
           IF      FLG-P02A-CHK        =   ZERO
               PERFORM 41013-NIJYU-GMN-SET-SEC
           END-IF
      *
           IF      SPA-GMN2A-MAX       >   ZERO
      *        Æó½ÅÅÐÏ¿µ¿¤¤²èÌÌ¤Ø
               MOVE    "P02"               TO  SPA-MOTOPG
               MOVE    "P02A"              TO  SPA-SAKIPG
      *
               MOVE    "NEW"               TO  MCP-PUTTYPE
               MOVE    "P02A"              TO  MCP-WINDOW
               MOVE    "B01"               TO  MCP-WIDGET
      *
               PERFORM 900-PUT-WINDOW
               MOVE    1                   TO  SPA-FLG-END
           END-IF
           .
       41012-NIJYU-TRKGMN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æó½ÅÅÐÏ¿²èÌÌ¡¡´µ¼Ô¥Þ¥¹¥¿¸¡º÷½èÍý
      *****************************************************************
       41013-NIJYU-GMN-SET-SEC   SECTION.
      *
           INITIALIZE                  SPA-P02A-AREA
           MOVE    FLG-P02A-SYORI      TO  SPA-P02A-SYORI
      *
           MOVE    SPACE               TO  SPA-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP02A"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           .
       41013-NIJYU-GMN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥°¥ë¡¼¥×°åÎÅµ¡´Ø¤ÎÆ±À«Æ±Ì¾¥ê¥¹¥È½èÍý
      *****************************************************************
       41013-GRPPTNAME-CHK-SEC          SECTION.
      *
           IF     (SPA-GMN-KANANAME    =   SPACE )  OR
                  (SPA-NAI-BIRTHDAY    =   SPACE )  OR
                  (SPA-GMN-SEX         =   SPACE )
               CONTINUE
           ELSE
               MOVE    1               TO  SPA-P02G-FLG
               PERFORM 410131-P02G-SYORI-SEC
           END-IF
           .
       41013-GRPPTNAME-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥°¥ë¡¼¥×°åÎÅµ¡´Ø¤ÎÆ±À«Æ±Ì¾¥ê¥¹¥È½èÍý
      *****************************************************************
       410131-P02G-SYORI-SEC          SECTION.
      *
           INITIALIZE                  SPA-P02G-AREA
      *
           MOVE    SPACE               TO  SPA-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP02G"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           IF      SPA-P02G-MAX    >   ZERO
      *        ¥°¥ë¡¼¥×°åÎÅµ¡´ØÆ±°ì´µ¼Ô°ìÍ÷¤Ø
               MOVE    "P02"               TO  SPA-MOTOPG
               MOVE    "P02G"              TO  SPA-SAKIPG
      *
               MOVE    "NEW"               TO  MCP-PUTTYPE
               MOVE    "P02G"              TO  MCP-WINDOW
               MOVE    "SELNUM"            TO  MCP-WIDGET
      *
               PERFORM 900-PUT-WINDOW
               MOVE    1                   TO  SPA-FLG-END
           END-IF
           .
       410131-P02G-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»½èÍý
      *****************************************************************
       450-HKNCOMBI-SEC          SECTION.
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    ZERO                TO  FLG-ERRCHK
           IF      FLG-TOUROKU2        =   2
               CONTINUE
           ELSE
      *        ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
               PERFORM 410-INPUT-CHK-SEC
               IF     (SPA-ERRCD       NOT =   SPACE )  OR
                      (SPA-PIDCD       NOT =   SPACE )  OR
                      (SPA-FLG-END     NOT =   ZERO  )
                   GO      TO      450-HKNCOMBI-EXT
               END-IF
           END-IF
      *
      *    ÅÐÏ¿¤Î»þ¡¢¿·µ¬´µ¼Ô¤Î»þ¤¹¤Ù¤Æ¤ÎÊÝ¸±¡¦¸øÈñ¤ò¥Á¥§¥Ã¥¯¤¹¤ë
      *    £È£±£µ¡¥£´²þÀµÂÐ±þ¤Î¤¿¤á¡¢Ëè²ó¡¢¤¹¤Ù¤Æ¤Î¥Á¥§¥Ã¥¯¤ò¹Ô¤¦
      *!   IF    ( SPA-P02-SYORI       =   1     )  AND
      *!         ( FLG-TOUROKU2    NOT =   ZERO  )
           IF     (FLG-TOUROKU     NOT =   ZERO )
            OR    (FLG-TOUROKU2        =   1    )
               PERFORM 4501-ALLHKN-CHK-SEC
               IF     (SPA-ERRCD       NOT =   SPACE )  OR
                      (SPA-PIDCD       NOT =   SPACE )  OR
                      (SPA-FLG-END     NOT =   ZERO  )
                   GO      TO      450-HKNCOMBI-EXT
               END-IF
           END-IF
      *
      *
      *    ÊÝ¸±£Ô£Â£Ì¤«¤é£Ð£Á£Ò£Á¥Õ¥¡¥¤¥ë¤ØÊÔ½¸
           PERFORM 4501-PTHKNINF-LNK-SEC
      *    ¸øÈñ£Ô£Â£Ì¤«¤é£Ð£Á£Ò£Á¥Õ¥¡¥¤¥ë¤ØÊÔ½¸
           PERFORM 4502-PTKOHINF-LNK-SEC
      *    ¸øÈñ£Ô£Â£Ì¤«¤é¸øÈñÉéÃ´¤ØÊÔ½¸
           PERFORM 4504-PTKOHFTN-HEN-SEC
      *
      *    ÊÝ¸±ÁÈ¹ç¤»ºîÀ®
           PERFORM 4503-HKNCOMBI-SYORI-SEC
      *
           IF      SPA-GMN-CUR         =   ZERO
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
           .
       450-HKNCOMBI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±¡¦¸øÈñ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4501-ALLHKN-CHK-SEC          SECTION.
      *
      *    ¥¨¥é¡¼¤¬¤Ê¤¤»þ¤Ï¡¢¸µ¤Ø¤â¤É¤¹
           MOVE    ZERO                TO  FLG-CHK
           MOVE    SPA-NAI-HKNSTR      TO  WRK-NAI-HKNSTR
           IF      SPA-PTHKN-MAX       >   ZERO
               PERFORM VARYING     IDX     FROM    1   BY  1
                       UNTIL      (IDX         >   SPA-PTHKN-MAX )  OR
                              (SPA-PIDCD   NOT =   SPACE )  OR
                              (SPA-ERRCD   NOT =   SPACE )
                   INITIALIZE                  SPA-GMN-HKN-AREA
      *            ÈïÊÝ¸±¼ÔÌ¾¤Î¼«Æ°ÊÑ¹¹¤Ï¤·¤Ê¤¤
                   MOVE    1               TO  SPA-NAI-HIHKNFLG
                   IF      SPA-PTHKN-SAKJOKBN (IDX)    =   SPACE
                       IF      WRK-NAI-HKNSTR      =   ZERO
                           MOVE    IDX             TO  WRK-NAI-HKNSTR
                       END-IF
                       MOVE    IDX             TO  SPA-NAI-HKNSTR
                       PERFORM 3101-HOKEN-HEN-SEC
      *                ÊÝ¸±¾ðÊó¥Á¥§¥Ã¥¯¥µ¥Ö
                       CALL    "ORCSP03A"          USING
                                                   SPA-AREA
                                                   SPA-P02SCRAREA
                                                   SPA-P02KYOUTU
                       PERFORM 410312-HKN-SPATBL-SET-SEC
                   END-IF
               END-PERFORM
               IF     (SPA-ERRCD       NOT =   SPACE )  OR
                      (SPA-PIDCD       NOT =   SPACE )
                   GO      TO      4501-ALLHKN-CHK-EXT
               END-IF
               MOVE    WRK-NAI-HKNSTR      TO  SPA-NAI-HKNSTR
               MOVE    SPA-NAI-HKNSTR      TO  IDX
               IF      IDX                 =   ZERO
                   MOVE    1               TO  IDX
               END-IF
               INITIALIZE                  SPA-GMN-HKN-AREA
               PERFORM 3101-HOKEN-HEN-SEC
           END-IF
      *
      *    ¸øÈñ¤Ï£³·ï°Ê¾å¤Î»þ¹Ô¤¦
           IF     (SPA-PTKOH-MAX       =   ZERO )  OR
                  (SPA-NAI-KOHEND      =   SPA-PTKOH-MAX )
               GO      TO      4501-ALLHKN-CHK-EXT
           END-IF
      *
           MOVE    SPA-NAI-KOHSTR      TO  WRK-NAI-KOHSTR
           MOVE    ZERO                TO  IDY
           MOVE    SPA-GMN-KOH-AREA    TO  WRK-GMN-KOH-AREA
           IF      WRK-NAI-KOHSTR      =   ZERO
               MOVE    1                   TO  WRK-NAI-KOHSTR
           END-IF
      *
           PERFORM VARYING     IDX     FROM    WRK-NAI-KOHSTR BY  1
                   UNTIL      (IDX         >   SPA-PTKOH-MAX )  OR
                              (SPA-PIDCD   NOT =   SPACE )  OR
                              (SPA-ERRCD   NOT =   SPACE )
               IF      IDY                 =   ZERO
                   INITIALIZE                  SPA-GMN-KOH-AREA
                   MOVE    ZERO                TO  SPA-NAI-KOHEND
               END-IF
               IF      SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE
                   IF      IDY             =   ZERO
                       MOVE    IDX             TO  SPA-NAI-KOHSTR
                   END-IF
                   MOVE    IDX                 TO  SPA-NAI-KOHEND
                   ADD     1                   TO  IDY
                   MOVE    1                   TO  FLG-CHK
                   PERFORM 3102-KOUHI-HEN-SEC
               END-IF
               IF      IDY                 >=  3
      *            ¸øÈñ¾ðÊó¥Á¥§¥Ã¥¯¥µ¥Ö
                   CALL    "ORCSP03B"          USING   SPA-AREA
                                               SPA-P02SCRAREA
                                               SPA-P02KYOUTU
                   IF      SPA-ERRCD           =   SPACE
      *!API
                       IF      FLG-APICHK          =   1
      *                    ¸øÈñ²èÌÌ¤ÎÆâÍÆ¤ò£Ô£Â£Ì¤ØÊÔ½¸¤¹¤ë
                           PERFORM 4509-API-KOHSPA-TBL-SEC
                       END-IF
      *!API
                       MOVE    ZERO                TO  IDY
                   END-IF
               END-IF
           END-PERFORM
      *
           IF     (SPA-PIDCD           =   SPACE )
              AND (SPA-ERRCD           =   SPACE )
               IF      IDY                 >   ZERO
      *            ¸øÈñ¾ðÊó¥Á¥§¥Ã¥¯¥µ¥Ö
                   CALL    "ORCSP03B"          USING   SPA-AREA
                                                   SPA-P02SCRAREA
                                                   SPA-P02KYOUTU
      *!API
                   IF      FLG-APICHK          =   1
      *                ¸øÈñ²èÌÌ¤ÎÆâÍÆ¤ò£Ô£Â£Ì¤ØÊÔ½¸¤¹¤ë
                       PERFORM 4509-API-KOHSPA-TBL-SEC
                   END-IF
      *!API
               END-IF
           END-IF
      *    ¸µ¤ØÌá¤¹
           IF     (SPA-ERRCD           =   SPACE  )
           AND    (SPA-PIDCD           =   SPACE  )
               MOVE    WRK-GMN-KOH-AREA    TO  SPA-GMN-KOH-AREA
           END-IF
           .
       4501-ALLHKN-CHK-EXT.
           EXIT.
      *
      *!API
      *****************************************************************
      *    API¸øÈñÊÑ¹¹ÆâÍÆÊÔ½¸½èÍý
      *****************************************************************
       4509-API-KOHSPA-TBL-SEC          SECTION.
      *
           MOVE    IDX                 TO  IDX-API
      *    ÊÑ¹¹Ê¬¤Î¤ß
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   3
              IF     (SPA-GMN-KOHNUM      (IDX)  NOT =   SPACE ) AND
                     (SPA-NAI-PTKOH-EDANUM(IDX)  NOT =   ZERO  )
                   MOVE    SPA-NAI-PTKOH-EDANUM(IDX)   TO  IDY
                   IF      SPA-GMN-KOHNUM (IDX)
                                           NOT = SPA-PTKOH-KOHNUM (IDY)
                       PERFORM 3102-KOH-SPATBL-HEN-SEC
                   END-IF
               END-IF
           END-PERFORM
      *
           MOVE    IDX-API             TO  IDX
           .
       4509-API-KOHSPA-TBL-EXT.
           EXIT.
      *!API
      *
      *****************************************************************
      *    ÊÝ¸±ÄÉ²Ã½èÍý
      *****************************************************************
       4501-PTHKNINF-LNK-SEC          SECTION.
      *
      *    ºï½ü¤¹¤ë
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTHKNINF"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "DBDELETE"          TO  MCP-FUNC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "del3"              TO  MCP-PATHNAME
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               PERFORM 45011-HKN-SPA-PARA-SEC
      *        ÄÉ²Ã
               INITIALIZE                      PARA-REC
               MOVE    "P02"               TO  PARA-GYOUMUID
               MOVE    SPA-TERMID          TO  PARA-TERMID
               MOVE    "PTHKNINF"          TO  PARA-FILEMEI
               MOVE    IDX                 TO  PARA-EDANUM
               MOVE    PTHKNINF-REC        TO  PARA-DATA-REC
      *
               MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
               MOVE    PARA-REC            TO  MCPDATA-REC
               MOVE    "DBINSERT"          TO  MCP-FUNC
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         CALL    "ORCDBMAIN"         USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
      *
               IF      MCP-RC          NOT =   ZERO
                   DISPLAY "P02W1 PARA HKNINF INS ERR:"  MCP-RC
                           ",PARA-KEY;" PARA-KEY "@"
               END-IF
           END-PERFORM
      *
           .
       4501-PTHKNINF-LNK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±£Ó£Ð£Á¢ª¥Ñ¥é¥á¥¿ÊÔ½¸½èÍý
      *****************************************************************
       45011-HKN-SPA-PARA-SEC          SECTION.
      *
           MOVE    SPACE               TO  PTHKNINF-REC
           INITIALIZE                      PTHKNINF-REC
      *
           MOVE    SPA-HOSPNUM         TO  PTHKN-HOSPNUM
           MOVE    SPA-GMN-PTID        TO  PTHKN-PTID
           MOVE    SPA-PTHKN-HKNID     (IDX)   TO  PTHKN-HKNID
           MOVE    SPA-PTHKN-HKNNUM    (IDX)   TO  PTHKN-HKNNUM
           MOVE    SPA-PTHKN-HKNJANUM  (IDX)   TO  PTHKN-HKNJANUM
           MOVE    SPA-PTHKN-HIHKNJANAME(IDX)  TO  PTHKN-HIHKNJANAME
           MOVE    SPA-PTHKN-HONKZKKBN  (IDX)  TO  PTHKN-HONKZKKBN
           MOVE    SPA-PTHKN-HOJOKBN    (IDX)  TO  PTHKN-HOJOKBN
           MOVE    SPA-PTHKN-CONTKBN    (IDX)  TO  PTHKN-CONTKBN
           MOVE    SPA-PTHKN-KIGO       (IDX)  TO  PTHKN-KIGO
           MOVE    SPA-PTHKN-NUM        (IDX)  TO  PTHKN-NUM
           MOVE    SPA-PTHKN-SKKGETYMD  (IDX)  TO  PTHKN-SKKGETYMD
           MOVE    SPA-PTHKN-TEKSTYMD   (IDX)  TO  PTHKN-TEKSTYMD
           MOVE    SPA-PTHKN-TEKEDYMD   (IDX)  TO  PTHKN-TEKEDYMD
           MOVE    SPA-PTHKN-KAKUNINYMD (IDX)  TO  PTHKN-KAKUNINYMD
           MOVE    SPA-PTHKN-SAKJOKBN   (IDX)  TO  PTHKN-SAKJOKBN
      *
           .
       45011-HKN-SPA-PARA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñÄÉ²Ã½èÍý
      *****************************************************************
       4502-PTKOHINF-LNK-SEC          SECTION.
      *
      *    ºï½ü¤¹¤ë
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTKOHINF"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "DBDELETE"          TO  MCP-FUNC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "del3"              TO  MCP-PATHNAME
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           MOVE    ZERO                TO  WRK-EDANUM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
      *
               PERFORM 45021-KOH-SPA-PARA-SEC
      *
               ADD     1                   TO  WRK-EDANUM
      *        ÄÉ²Ã
               INITIALIZE                      PARA-REC
               MOVE    "P02"               TO  PARA-GYOUMUID
               MOVE    SPA-TERMID          TO  PARA-TERMID
               MOVE    "PTKOHINF"          TO  PARA-FILEMEI
               MOVE    WRK-EDANUM          TO  PARA-EDANUM
               MOVE    PTKOHINF-REC        TO  PARA-DATA-REC
      *
               MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
               MOVE    PARA-REC            TO  MCPDATA-REC
               MOVE    "DBINSERT"          TO  MCP-FUNC
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         CALL    "ORCDBMAIN"         USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
      *
               IF      MCP-RC          NOT =   ZERO
                   DISPLAY "P02W1 PARA PTKOHINF INS ERR:"  MCP-RC
               END-IF
           END-PERFORM
      *
           .
       4502-PTKOHINF-LNK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±£Ó£Ð£Á¢ª¥Ñ¥é¥á¥¿ÊÔ½¸½èÍý
      *****************************************************************
       45021-KOH-SPA-PARA-SEC          SECTION.
      *
           MOVE    SPACE               TO  PTKOHINF-REC
           INITIALIZE                      PTKOHINF-REC
      *
           MOVE    SPA-HOSPNUM         TO  PTKOH-HOSPNUM
           MOVE    SPA-GMN-PTID        TO  PTKOH-PTID
           MOVE    SPA-PTKOH-KOHID     (IDX)   TO  PTKOH-KOHID
           MOVE    SPA-PTKOH-KOHNUM    (IDX)   TO  PTKOH-KOHNUM
           MOVE    SPA-PTKOH-PAYKBN    (IDX)   TO  PTKOH-PAYKBN
           MOVE    SPA-PTKOH-FTNJANUM  (IDX)   TO  PTKOH-FTNJANUM
           MOVE    SPA-PTKOH-JKYSNUM   (IDX)   TO  PTKOH-JKYSNUM
           MOVE    SPA-PTKOH-TEKSTYMD  (IDX)   TO  PTKOH-TEKSTYMD
           MOVE    SPA-PTKOH-TEKEDYMD  (IDX)   TO  PTKOH-TEKEDYMD
           MOVE    SPA-PTKOH-KAKUNINYMD(IDX)   TO  PTKOH-KAKUNINYMD
           MOVE    SPA-PTKOH-SAKJOKBN  (IDX)   TO  PTKOH-SAKJOKBN
           MOVE    SPA-PTKOH-TEKEDCHKKBN (IDX) TO  PTKOH-TEKEDCHKKBN
      *
           .
       45021-KOH-SPA-PARA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñ£Ô£Â£Ì¤«¤é¸øÈñÉéÃ´¤ØÊÔ½¸½èÍý
      *****************************************************************
       4504-PTKOHFTN-HEN-SEC          SECTION.
      *
      *    ¤¹¤Ù¤Æ¤òºï½ü¤È¤·¤Æ¤ª¤¯
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-FTN1-MAX
               MOVE    "1"             TO  SPA-NAI24-FTNDELKBN (IDX)
           END-PERFORM
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
      *        ¹¹Àµ¡¢°éÀ®
               IF     (SPA-PTKOH-KOHNUM(IDX)   =   "015"
                                               OR  "016"
      *            À¸³èÊÝ¸î
                                               OR  "012" )
      *            ÆÃÄêÉéÍ­¡Ê£È£±£µ¡¥£±£°°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "051" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20031001"))
      *            Åìµþ¤ÎÆÃÄê¼À´µ¸øÈñ¡Ê£È£±£µ¡¥£±£°°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "151" )  AND
                      (SPA-PREFNUM             =   13    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20031001"))
      *            Åìµþ¤Î£´£µ£±¸øÈñ¡Ê£È£±£µ¡¥£±£°°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "451" )  AND
                      (SPA-PREFNUM             =   13    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20031001"))
      *            Ê¼¸Ë¸©¤Î£±£¸£¶¸øÈñ¡Ê£È£±£µ¡¥£±£°°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "186" )  AND
                      (SPA-PREFNUM             =   28    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20031001"))
      *            ¾®»ùÆÃÄê¡Ê£°£µ£²¡Ë¡Ê£È£±£·¡¥£°£´°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "052" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20050401"))
      *
      *            Àº¿ÀÄÌ±¡¡Ê£°£²£±¡Ë¡Ê£È£±£¸¡¥£°£´°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "021" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20060401"))
      *
      *            ¸ºÌÈ¡Ê£¹£¶£°¡¢£¹£¶£±¡Ë¡Ê£È£±£¸¡¥£±£°°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "960"
                                               OR  "961"  )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20061001"))
      *
      *           ÎÅÍÜ²ð¸î°åÎÅ¡Ê£°£²£´¡Ë¡¢¾ã³²»ù¡Ê£°£·£¹¡Ë¡Ê£È£±£¸¡¥£±£°°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "079"
                                               OR  "024"  )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20061001"))
      *
      *           ¹â³Û°ÑÇ¤Ê§¤¤¡Ê£¹£¶£´¡Ë
                 OR   (SPA-PTKOH-KOHNUM(IDX)   =   "964"  )
      *
      *            Ê¡Åç¤ÎÃÏÊý¸øÈñ¡Ê£È£±£¹¡¥£²°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "281" )  AND
                      (SPA-PREFNUM             =   07    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20070201"))
      *
      *            ·ë³ËÆþ½ê¡Ê£°£±£±¡Ë¡Ê£È£±£¹¡¥£´°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "011" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20070401"))
      *
      *            ´Î±ê¼£ÎÅ¡Ê£°£³£¸¡Ë¡Ê£È£²£°¡¥£´°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "038" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20080401"))
      *            »ÄÎ±Ë®¿Í¡Ê£°£²£µ¡Ë¡Ê£È£²£°¡¥£´°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "025" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20080401"))
      *            ËÌ³¤Æ»¤ÎÃÏÊý¸øÈñ¡Ê£È£²£°¡¥£±£°°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "183" )  AND
                      (SPA-PREFNUM             =   01    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20081001"))
      *
      *            Àº¿ÀÆþ±¡¡Ê£°£²£°¡Ë¡Ê£È£±£¹¡¥£´°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "020" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20070401"))
      *            °¦ÃÎ¸©¤ÎÃÏÊý¸øÈñ¡Ê£È£²£±¡¥£±£°°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "191" )  AND
                      (SPA-PREFNUM             =   23    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20091001"))
      *            °ñ¾ë¸©¤ÎÃÏÊý¸øÈñ¡Ê£È£²£±¡¥£´°Ê¹ß¡Ë
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "152" )  AND
                      (SPA-PREFNUM             =   08    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20090401"))
      *
                   MOVE    ZERO                TO  IDY
                   PERFORM VARYING     IDX2    FROM    1   BY  1
                           UNTIL       IDX2    >   SPA-FTN1-MAX
                       IF      SPA-PTKOH-KOHID(IDX)
                                               =   SPA-NAI24-KOHID(IDX2)
                           MOVE    IDX2            TO  IDY
                           MOVE    SPA-FTN1-MAX    TO  IDX2
                       END-IF
                   END-PERFORM
                   IF      IDY             =   ZERO
                       COMPUTE IDY         =   SPA-FTN1-MAX     +  1
                       IF      IDY         >   60
                           MOVE    "0097"          TO  SPA-ERRCD
                       ELSE
                           MOVE    IDY         TO  SPA-FTN1-MAX
                           INITIALIZE          SPA-GMN24-FTNTBLO (IDY)
                       END-IF
                   END-IF
      *
                   IF      SPA-ERRCD           =   SPACE
                       PERFORM 45041-PTKOHFTN-TBLHEN-SEC
                   END-IF
               END-IF
           END-PERFORM
      *
           .
       4504-PTKOHFTN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñÉéÃ´¤ØÊÔ½¸½èÍý
      *****************************************************************
       45041-PTKOHFTN-TBLHEN-SEC          SECTION.
      *
           MOVE    SPA-PTKOH-KOHID     (IDX)   TO  SPA-NAI24-KOHID (IDY)
           MOVE    SPA-PTKOH-KOHNUM    (IDX)   TO  SPA-NAI24-KOHNUM(IDY)
           MOVE    SPA-PTKOH-JKYSNUM   (IDX)   TO  SPA-NAI24-TJKYSNUM
                                                                 (IDY)
           MOVE    SPA-PTKOH-PAYKBN    (IDX)   TO  SPA-NAI24-PAYKBN(IDY)
           MOVE    SPA-PTKOH-TEKSTYMD  (IDX)   TO  SPA-NAI24-TKOHSTYMD
                                                                   (IDY)
           MOVE    SPA-PTKOH-TEKEDYMD  (IDX)   TO  SPA-NAI24-TKOHEDYMD
                                                                   (IDY)
           MOVE    SPA-PTKOH-SAKJOKBN  (IDX)   TO  SPA-NAI24-FTNDELKBN
                                                                   (IDY)
      *
           MOVE    SPA-PTKOH-KOHNUM-MEI(IDX)   TO  SPA-GMN24-TFTNKOHMEI
                                                                   (IDY)
           MOVE    SPA-PTKOH-TEKSTYMDW (IDX)   TO  SPA-GMN24-TKOHSTYMD
                                                                   (IDY)
           MOVE    SPA-PTKOH-TEKEDYMDW (IDX)   TO  SPA-GMN24-TKOHEDYMD
                                                                   (IDY)
           .
       45041-PTKOHFTN-TBLHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»ºîÀ®½èÍý
      *****************************************************************
       4503-HKNCOMBI-SYORI-SEC          SECTION.
      *
           MOVE    SPA-HOSPSBT         TO  WRK-HOSPSBT
           MOVE    SPA-ROUPAYKBN       TO  WRK-ROUPAYKBN
           MOVE    SPA-NAI-HOSPSBT     TO  SPA-HOSPSBT
           MOVE    SPA-NAI-ROUPAYKBN   TO  SPA-ROUPAYKBN
      *    ÊÝ¸±ÁÈ¹ç¤»ºîÀ®
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-GMN-PTID        TO  SPA-PTID
           CALL    "ORCGP02W2"         USING    SPA-AREA
           MOVE    WRK-HOSPSBT         TO  SPA-HOSPSBT
           MOVE    WRK-ROUPAYKBN       TO  SPA-ROUPAYKBN
      *    ÊÝ¸±ÁÈ¹ç£É£ÄÀßÄê½èÍý
           IF      SPA-ERRCD           =   SPACE
               CALL    "ORCGP02W3"     USING    SPA-AREA
                                                SPA-P02KYOUTU
           END-IF
      *
      *    ÊÝ¸±ÁÈ¹ç¤»É½¼¨¡Ê¸½ºßÂÐ¾ÝÊ¬¤Î¤ß¡Ë
           IF      SPA-ERRCD           =   SPACE
               PERFORM 3103-HKNCOMB-PARA-SEC
           END-IF
      *
           .
       4503-HKNCOMBI-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÄÉ²Ã½èÍý
      *****************************************************************
       460-HKN-TUIKA-SEC          SECTION.
      *
      *    ÄÉ²Ã¤ÎÈ½Äê
           MOVE    1                   TO  FLG-HKN-ADD2
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      460-HKN-TUIKA-EXT
           END-IF
      *
      *    ÄÉ²Ã¤ÎÈ½Äê
           INITIALIZE                  SPA-GMN-HKN-AREA
           MOVE    ZERO                TO  SPA-NAI-HKNSTR
           MOVE    8                   TO  SPA-GMN-CUR
      *
           .
       460-HKN-TUIKA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñÄÉ²Ã½èÍý
      *****************************************************************
       470-KOH-TUIKA-SEC          SECTION.
      *
      *    ÄÉ²Ã¤ÎÈ½Äê
           MOVE    1                   TO  FLG-KOH-ADD2
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      470-KOH-TUIKA-EXT
           END-IF
      *
           IF      FLG-KOH-ADD         =   ZERO
               MOVE    "0090"          TO  SPA-ERRCD
           END-IF
      *    ¥Æ¡¼¥Ö¥ë·ï¿ô
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PTKOH-MAX       >=  TBL-MAX-KOH )
               MOVE    "0106"          TO  SPA-ERRCD
               GO      TO      470-KOH-TUIKA-EXT
           END-IF
      *
           EVALUATE    TRUE
               WHEN    SPA-GMN-KOHNUM(1)   =   SPACE
                   MOVE    20                  TO  SPA-GMN-CUR
               WHEN    SPA-GMN-KOHNUM(2)   =   SPACE
                   MOVE    26                  TO  SPA-GMN-CUR
               WHEN    SPA-GMN-KOHNUM(3)   =   SPACE
                   MOVE    32                  TO  SPA-GMN-CUR
           END-EVALUATE
      *
           .
       470-KOH-TUIKA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¿¥°ÊÑ¹¹¡¦ÊÌ²èÌÌÀÚÂØ¡¡É½¼¨½èÍý
      *****************************************************************
       4101-BETUGAMEN-SEC          SECTION.
      *
           MOVE    1                   TO  FLG-TOUROKU 
           MOVE    ZERO                TO  FLG-TOUROKU2
      *    ÊÝ¸±ÁÈ¹ç¤»¤òºîÀ®¤¹¤ë¡ÊÆþÎÏ¥Á¥§¥Ã¥¯¹þ¤ß¡Ë
           PERFORM 450-HKNCOMBI-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      4101-BETUGAMEN-EXT
           END-IF
           .
       4101-BETUGAMEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Á°É½¼¨¡Ê´ðËÜ¡§ÊÝ¸±¸øÈñ¾ðÊó¡Ë½èÍý
      *****************************************************************
       440-ZEN-GMNHYOUJI-SEC           SECTION.
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    1                   TO  FLG-ERRCHK
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      440-ZEN-GMNHYOUJI-EXT
           END-IF
      *
      *    ÊÝ¸±¾ðÊó
           IF      SPA-NAI-HKNSTR      >   1
               MOVE    SPA-NAI-HKNSTR      TO  WRK-HKNSTR
      *        ÊÝ¸±¾ðÊó£Ô£Â£Ì¤«¤éÊÔ½¸
               COMPUTE SPA-NAI-HKNSTR      =   SPA-NAI-HKNSTR  -  1
               PERFORM 4401-ZENHKN-TBL-SPA-SEC
      *        ÂÐ¾Ý¤¬¤Ê¤¤»þ¸µ¤Ø
               IF      SPA-NAI-HKNSTR      =   ZERO
                   MOVE    WRK-HKNSTR          TO  SPA-NAI-HKNSTR
                   PERFORM 3101-HKN-TBL-SPA-SEC
               END-IF
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
      *    ¸øÈñ¾ðÊó
           IF      SPA-NAI-KOHSTR      >   1
      *        ÂÐ¾Ý³«»Ï°ÌÃÖ¤òµá¤á¤ë
               MOVE    ZERO                TO  WRK-KOHSTR
               MOVE    ZERO                TO  IDY
               PERFORM VARYING     IDX     FROM    1  BY  1
                       UNTIL      (IDX     >   SPA-PTKOH-MAX) OR
                                  (IDX     =   SPA-NAI-KOHSTR)
                   IF      SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE
                       ADD     1               TO  IDY
                       IF      IDY             >   3
                           MOVE   1                TO  IDY
                       END-IF
                       IF      IDY             =   1
                           MOVE    IDX             TO  WRK-KOHSTR
                       END-IF
                   END-IF
               END-PERFORM
      *        ¸øÈñ¾ðÊó£Ô£Â£Ì¤«¤éÊÔ½¸
               IF      WRK-KOHSTR          >   ZERO
                   MOVE    WRK-KOHSTR          TO  SPA-NAI-KOHSTR
                   PERFORM 3101-KOH-TBL-SPA-SEC
               END-IF
               MOVE    20              TO  SPA-GMN-CUR
           END-IF
      *
           IF      SPA-GMN-CUR         =   ZERO
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
           .
       440-ZEN-GMNHYOUJI-EXT.
           EXIT.
      *****************************************************************
      *    ÊÝ¸±¾ðÊó¥Ñ¥é¥á¥¿¥Õ¥¡¥¤¥ë¸¡º÷½èÍý
      *****************************************************************
       4401-ZENHKN-TBL-SPA-SEC            SECTION.
      *
           INITIALIZE                  SPA-GMN-HKN-AREA
           MOVE    ZERO                TO  FLG-CHK
           IF      SPA-NAI-HKNSTR      =   ZERO
               CONTINUE
           ELSE
               PERFORM VARYING IDX     FROM    SPA-NAI-HKNSTR   BY  -1
                   UNTIL      (IDX         <   1             )  OR
                              (FLG-CHK NOT =   ZERO )
                   IF      SPA-PTHKN-SAKJOKBN (IDX)    =   SPACE
      *                £Ñ£Ò¥Ç¡¼¥¿¤ÎÉ½¼¨
                       IF     (SPA-QR-FLG          =   1   )  AND
                              (SPA-QR-HKNID    NOT =   ZERO )  AND
                              (SPA-QR-HKNID    NOT =   SPA-PTHKN-HKNID
                                                               (IDX))
                           CONTINUE
                       ELSE
                           MOVE    IDX             TO  SPA-NAI-HKNSTR
                           PERFORM 3101-HOKEN-HEN-SEC
                           MOVE    1               TO  FLG-CHK
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *    ÂÐ¾Ý¤ÎÊÝ¸±¤¬¤Ê¤¤»þ¡¢¿·µ¬¤È¤¹¤ë
           IF      FLG-CHK             =   ZERO
               MOVE    ZERO                TO  SPA-NAI-HKNSTR
           END-IF
           .
       4401-ZENHKN-TBL-SPA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼¡É½¼¨¡Ê´ðËÜ¡§ÊÝ¸±¸øÈñ¾ðÊó¡Ë½èÍý
      *****************************************************************
       450-TUGI-GMNHYOUJI-SEC          SECTION.
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    1                   TO  FLG-ERRCHK
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      450-TUGI-GMNHYOUJI-EXT
           END-IF
           MOVE    ZERO                TO  SPA-GMN-CUR
      *    ÊÝ¸±¾ðÊó
           IF      SPA-NAI-HKNSTR      <   SPA-PTHKN-MAX
               MOVE    SPA-NAI-HKNSTR      TO  WRK-HKNSTR
      *        ÊÝ¸±¾ðÊó£Ô£Â£Ì¤«¤éÊÔ½¸
               ADD     1                   TO  SPA-NAI-HKNSTR
               PERFORM 3101-HKN-TBL-SPA-SEC
      *        ÂÐ¾Ý¤¬¤Ê¤¤»þ¸µ¤Ø
               IF     (SPA-NAI-HKNSTR      =   ZERO )  AND
                      (WRK-HKNSTR          >   ZERO )
                   MOVE    WRK-HKNSTR          TO  SPA-NAI-HKNSTR
                   PERFORM 3101-HKN-TBL-SPA-SEC
               END-IF
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
      *    ¸øÈñ¾ðÊó
           IF     (SPA-NAI-KOHEND      <   SPA-PTKOH-MAX )  AND
                  (SPA-GMN-KOHNUM(3)   NOT =   SPACE )
               MOVE    SPA-NAI-KOHSTR      TO  WRK-KOHSTR
               MOVE    SPA-NAI-KOHEND      TO  SPA-NAI-KOHSTR
      *        ÊÝ¸±¾ðÊó£Ô£Â£Ì¤«¤éÊÔ½¸
               ADD     1                   TO  SPA-NAI-KOHSTR
               PERFORM 3101-KOH-TBL-SPA-SEC
      *        ÂÐ¾Ý¤¬¤Ê¤¤»þ¸µ¤Ø
               IF      SPA-NAI-KOHSTR      =   ZERO
                   MOVE    WRK-KOHSTR          TO  SPA-NAI-KOHSTR
                   PERFORM 3101-KOH-TBL-SPA-SEC
               END-IF
               MOVE    20                  TO  SPA-GMN-CUR
           END-IF
      *
           IF      SPA-GMN-CUR         =   ZERO
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
           .
       450-TUGI-GMNHYOUJI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½»½ê¸¡º÷¤Ø
      *****************************************************************
       440-JYUSYO-SEC             SECTION.
      *
      ***  INITIALIZE                            P98
      *    INITIALIZE                            P99
      ***  INITIALIZE                            JPARA-REC
      *    INITIALIZE                            SPA-GMN98-TABLE
      *    MOVE  ZERO                        TO  SPA-GMN98-MAX
      *    MOVE  ZERO                        TO  SPA-GMN98-PAGE
     ****  CALL  "ORCSADR"                       USING
      *                                          SPA-P02KYOUTU
      *                                          SPA-P02SCRAREA
      *                                          P98
      *                                          P99
      ****                                       SPA-SYSYMD
      *
           MOVE    SPACE               TO  SPA-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP98"           USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           MOVE    "P02"               TO  SPA-GMN98-MOTOPG
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
      *
      *    °ìÍ÷¤Ø
           MOVE    "P98"               TO  SPA-SAKIPG
           MOVE    "P02"               TO  SPA-MOTOPG
      *
           MOVE    "SELNUM"            TO  MCP-WIDGET
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    "P98"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  SPA-FLG-END
      *
           .
       440-JYUSYO-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÆþÎÏ²èÌÌ½èÍý
      *****************************************************************
       481-ROUSAI-SEC             SECTION.
      *
           IF      SPA-GMN-PTNUM       =   SPACE
               MOVE    "1001"              TO  SPA-ERRCD
               MOVE    ZERO                TO  SPA-GMN-CUR
               GO      TO      481-ROUSAI-EXT
           END-IF
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      481-ROUSAI-EXT
           END-IF
      *
      *    Ï«ºÒ¤«¼«ÇåÀÕ¤¬ÅÐÏ¿¤µ¤ì¤Æ¤¤¤ë¤³¤È
           INITIALIZE                  HKNNUM-REC
           MOVE    SPA-HOSPNUM         TO  HKN-HOSPNUM
           MOVE    SPA-SYSYMD          TO  HKN-TEKSTYMD
           MOVE    SPA-SYSYMD          TO  HKN-TEKEDYMD
           MOVE    "971"               TO  HKN-HKNNUM
           MOVE    ZERO                TO  HKN-PAYKBN
      *
           MOVE    HKNNUM-REC          TO  MCPDATA-REC
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknnum"        TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 921-HKNNUM-NEXT-SEC
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           IF      FLG-HKNNUM          =   ZERO
               MOVE    1               TO  SPA-ROSAI-FLG
           ELSE
               MOVE    ZERO            TO  SPA-ROSAI-FLG
           END-IF
      *
      *    ¼«ÇåÀÕ¤¬ÅÐÏ¿¤µ¤ì¤Æ¤¤¤ë¤³¤È
           INITIALIZE                  HKNNUM-REC
           MOVE    SPA-HOSPNUM          TO  HKN-HOSPNUM
           MOVE    SPA-SYSYMD          TO  HKN-TEKSTYMD
           MOVE    SPA-SYSYMD          TO  HKN-TEKEDYMD
           MOVE    "973"               TO  HKN-HKNNUM
           MOVE    ZERO                TO  HKN-PAYKBN
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknnum"        TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 921-HKNNUM-NEXT-SEC
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           IF      FLG-HKNNUM          =   ZERO
               MOVE    1               TO  SPA-JIBAI-FLG
           ELSE
               MOVE    ZERO            TO  SPA-JIBAI-FLG
           END-IF
      *
           IF     (SPA-ROSAI-FLG       =   ZERO )  AND
                  (SPA-JIBAI-FLG       =   ZERO )
               MOVE    "0024"          TO  SPA-ERRCD
               MOVE    8               TO  SPA-GMN-CUR
               GO      TO              481-ROUSAI-EXT
           END-IF
      *
      *    ¸½ºßÉ½¼¨¤µ¤ì¤Æ¤¤¤ë¤«¤ÎÈ½Äê
           IF      SPA-GMN-HKNNUM      =   "971"  OR
                                           "973"  OR
                                           SPACE
               CONTINUE
           ELSE
      *        ºÇ½é¤ÎÏ«ºÒ¡¦¼«ÇåÀÕ¤È¤¹¤ë
               PERFORM 4811-RSIHKN-SET-SEC
      *?       MOVE    "0022"        TO  SPA-ERRCD
      *?       MOVE    8             TO  SPA-GMN-CUR
               IF      SPA-ERRCD     NOT =   SPACE
                    GO      TO            481-ROUSAI-EXT
               END-IF
           END-IF
      *
      *    ÊÝ¸±¡¡Á«°Ü¥Ñ¥é¥á¡¼¥¿¥»¥Ã¥È
           MOVE    SPA-P02KYOUTU         TO  SPA-WORK
      *
      *    ÊÝ¸±¡¡²èÌÌ¾ðÊó¥»¥Ã¥È½èÍý
           PERFORM 481-RSIHKNGMN-SET-SEC
      *
           MOVE    "P02"                 TO  SPA-MOTOPG
           MOVE    "P02D"                TO  SPA-SAKIPG
      *
      *    ÊÝ¸±ÆþÎÏ²èÌÌ¤Ø
           MOVE   "NEW"                  TO  MCP-PUTTYPE.
           MOVE   "P02D"                 TO  MCP-WINDOW.
      *    ¥«¡¼¥½¥ë°ÌÃÖ»ØÄê
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
                   MOVE   3                    TO  SPA-GMN2D-CUR
                   MOVE   "KOHNUM1"            TO  MCP-WIDGET
               WHEN    "2"
                   MOVE   4                    TO  SPA-GMN2D-CUR
                   MOVE   "KOHNUM2"            TO  MCP-WIDGET
               WHEN    "3"
                   MOVE   16                   TO  SPA-GMN2D-CUR
                   MOVE   "KOHNUM3"            TO  MCP-WIDGET
               WHEN    OTHER
                   MOVE   1                    TO  SPA-GMN2D-CUR
                   MOVE   "HKNKBN"             TO  MCP-WIDGET
           END-EVALUATE
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                     TO  SPA-FLG-END
      *
           .
       481-ROUSAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÊÝ¸±½é´ü²èÌÌ¥»¥Ã¥È½èÍý
      *****************************************************************
       4811-RSIHKN-SET-SEC           SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           MOVE    ZERO                TO  IDX-R2
           PERFORM VARYING IDX-R       FROM    1   BY  1
                   UNTIL   IDX-R       >   SPA-PTHKN-MAX
              IF      (SPA-PTHKN-HKNNUM (IDX-R)    =   "971"  OR
                                                       "973" )  AND
                      (SPA-PTHKN-SAKJOKBN(IDX-R)   =   SPACE )
                   IF      SPA-PTHKN-TEKEDYMD(IDX-R)
                                                   =    "99999999"
                       IF      FLG-CHK             =   ZERO
                           MOVE    IDX-R           TO  IDX-R2
                           MOVE    1               TO  FLG-CHK
                       ELSE
                           MOVE    ZERO            TO  IDX-R2
                       END-IF
                   END-IF
               END-IF
           END-PERFORM
      *    Í­¸ú¤ÊÏ«ºÒ¡¦¼«ÇåÀÕ¤¬£±·ï¤Î»þ¡¢ÂÐ¾Ý¤È¤¹¤ë
           IF     (FLG-CHK             =   1  )  AND
                  (IDX-R2              >   ZERO)
               MOVE    IDX-R2          TO  SPA-NAI-HKNSTR
               MOVE    IDX-R2          TO  IDX
               PERFORM 3101-HOKEN-HEN-SEC
      *        ËÜ¿Í²ÈÂ²
               MOVE    SPACE           TO  SPA-GMN-HONKZKKBN-G
      *        Êä½õ¶èÊ¬
               MOVE    SPACE           TO  SPA-GMN-HOJOKBN-G
               MOVE    SPACE           TO  SPA-GMN-HOJOKBN-LIST
               MOVE    ZERO            TO  SPA-GMN-HOJO-MAX
      *
               MOVE    SPACE           TO  SPA-GMN-CONTKBN-G
               MOVE    SPACE           TO  SPA-GMN-CONTKBN-LIST
               MOVE    ZERO            TO  SPA-GMN-CONT-MAX
           ELSE
      *        Í­¸ú¤ÊÏ«ºÒ¡¦¼«ÇåÀÕ¤¬¤Ê¤¤»þ¡¢¿·µ¬ÄÉ²Ã
               IF      FLG-CHK             =   ZERO
                   INITIALIZE                  SPA-GMN-HKN-AREA
                   MOVE    ZERO                TO  SPA-NAI-HKNSTR
               ELSE
                   MOVE    "0022"        TO  SPA-ERRCD
                   MOVE    8             TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4811-RSIHKN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÊÝ¸±¡¡²èÌÌ¾ðÊó¥»¥Ã¥È½èÍý
      *****************************************************************
       481-RSIHKNGMN-SET-SEC           SECTION.
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP02D"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA.
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           .
       481-RSIHKNGMN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       490-TOUROKU-SEC             SECTION.
      *
           MOVE    1                   TO  FLG-TOUROKU 
           MOVE    1                   TO  FLG-TOUROKU2
      *
           EVALUATE    SPA-P02-GAMEN
      *        ÊÝ¸±ÁÈ¹ç¤»ÍúÎò
               WHEN    "P027"
                   MOVE    2               TO  FLG-TOUROKU2
           END-EVALUATE
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¤òºîÀ®¤¹¤ë¡ÊÆþÎÏ¥Á¥§¥Ã¥¯¹þ¤ß¡Ë
           PERFORM 450-HKNCOMBI-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
              OR  (SPA-PIDCD       NOT =   SPACE )
               GO      TO      490-TOUROKU-EXT
           END-IF
      *    ÊÝ¸±ÁÈ¹ç¤»¸øÈñÃ±ÆÈ¥Á¥§¥Ã¥¯
      **** IF     (SPA-NAI-KOHONLY     =   ZERO ) AND
      *           (SPA-TAGU-FLG        =   ZERO )
      *       AND (SPA-NAI-KOHONLY-CHKFLG  =   "1"  )
      *        PERFORM 4901-KOHONLY-CHK-SEC
      *****END-IF
      *
           IF     (SPA-TAGU-FLG        =   ZERO )  AND
                  (SPA-ERRCD           =   SPACE)
               PERFORM 4901-KOHONLY-CHK-SEC
           END-IF
      *
      *    ¥«¥ë¥ÆÈ¯¹Ô¤¢¤ê¤Î»þ¡¢ÊÝ¸±ÁÈ¹ç¤»¤Î¥Á¥§¥Ã¥¯
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-GMN-HAKKO       =   "1"
                   IF      SPA-NAI-KARUTE-HAKKO    =   "2"
                       IF      SPA-GMN-SELNUM      =   ZERO
                           PERFORM 4901-KARUTE-CHEK-SEC
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
      *
           .
       490-TOUROKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸ºÌÈ½ÅÊ£¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4909-960JYUFUKU-CHK-SEC             SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-PTKOH-MAX )  OR
                              (SPA-ERRCD   NOT =   SPACE )
               IF      (SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE )  AND
                       (SPA-PTKOH-KOHNUM   (IDX)    =   "027" )
                   PERFORM VARYING  IDY     FROM    1   BY  1
                           UNTIL   (IDY     >   SPA-PTKOH-MAX )  OR
                                   (SPA-ERRCD   NOT =   SPACE )
                      IF      (SPA-PTKOH-SAKJOKBN (IDY)    =   SPACE )
                        AND   (SPA-PTKOH-KOHNUM   (IDY)    =   "960"
                                                           OR  "961"
                                                           OR  "962"
                                                           OR  "963" )
                           IF     (SPA-PTKOH-TEKEDYMD (IDY)
                                       <   SPA-PTKOH-TEKSTYMD (IDX)) OR
                                  (SPA-PTKOH-TEKSTYMD (IDY)
                                       >   SPA-PTKOH-TEKEDYMD (IDX))
                               CONTINUE
                           ELSE
                               MOVE    "0112"      TO  SPA-ERRCD
      *                        ¸øÈñ¤Î£±ÈÖÌÜ¤Ë¥«¡¼¥½¥ë°ÜÆ°
                               MOVE    21          TO  SPA-GMN-CUR
                           END-IF
                      END-IF
                   END-PERFORM
              END-IF
           END-PERFORM
           .
       4909-960JYUFUKU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¸øÈñÃ±ÆÈ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4901-KOHONLY-CHK-SEC             SECTION.
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "HKNCOMBI"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           PERFORM
               UNTIL  (FLG-PARA        NOT =   ZERO )  OR
                      (SPA-ERRCD       NOT =   SPACE )
               MOVE    PARA-DATA-REC       TO  HKNCOMBI-REC
               IF     (COMB-DELKBN         =   "1"       )  OR
                      (SPA-SYSYMD          >   COMB-TEKEDYMD)
                   CONTINUE
               ELSE
      *            ÃÏÊý¸øÈñÃ±ÆÈÈ½Äê
                   IF     (SPA-NAI-KOHONLY     =   ZERO ) AND
                          (SPA-NAI-KOHONLY-CHKFLG  =   "1" )
                       PERFORM 49011-KOHONLY-CHKSYORI-SEC
                   END-IF
      *            Âà¿¦¹ñÊÝ¤ÈÏ·¿Í¸øÈñ¤ÎÁÈ¹ç¤»
                   IF      (COMB-HKNNUM        =   "067" ) AND
                          ((COMB-KOH1HKNNUM    =   "027" ) OR
                           (COMB-KOH2HKNNUM    =   "027" ) OR
                           (COMB-KOH3HKNNUM    =   "027" ) OR
                           (COMB-KOH4HKNNUM    =   "027" ))
                       IF      SPA-NAI-TAICHK      =   ZERO
                           MOVE    "K011"          TO  SPA-ERRCD
                           MOVE    1               TO  SPA-NAI-TAICHK
                       END-IF
                   END-IF
               END-IF
      *
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           .
       4901-KOHONLY-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Ã±ÆÈ¸øÈñ¤ÎÈ½Äê½èÍý
      *****************************************************************
       49011-KOHONLY-CHKSYORI-SEC             SECTION.
      *
      *    Ä¹ºê¸©¤ÎÈïÇú¼Ô°åÎÅ¡Ê£±£¸£¶¡Ë¤ÏÃ±ÆÈ²ÄÇ½
           IF      (COMB-HKNNUM         =   SPACE )  AND
                   (COMB-KOH1HKNNUM     =   "186" )  AND
                   (COMB-KOH2HKNNUM     =   SPACE )  AND
                   (COMB-KOH3HKNNUM     =   SPACE )  AND
                   (COMB-KOH4HKNNUM     =   SPACE )  AND
                   (SPA-PREFNUM         =   "42"  )
               MOVE    ZERO             TO  FLG-KOHCHK
           ELSE
               MOVE    ZERO             TO  FLG-KOHCHK
               IF      (COMB-HKNNUM         =   SPACE )  AND
                       (COMB-KOH1HKNNUM     >=  "100"  AND
                                            <=  "899"  )  AND
                       ((COMB-KOH2HKNNUM     =   SPACE  ) OR
                        (COMB-KOH2HKNNUM     >=  "100"  AND
                                             <=  "899"  )) AND
                       ((COMB-KOH3HKNNUM     =   SPACE  ) OR
                        (COMB-KOH3HKNNUM     >=  "100"  AND
                                             <=  "899"  )) AND
                       ((COMB-KOH4HKNNUM     =   SPACE  ) OR
                        (COMB-KOH4HKNNUM     >=  "100"  AND
                                             <=  "899"  ))
                   PERFORM 49011-KOHONLY-HKNCHK-SEC
               END-IF
           END-IF
           IF      FLG-KOHCHK      =   1
               MOVE    "K010"          TO  SPA-ERRCD
               MOVE    1               TO  SPA-NAI-KOHONLY
           END-IF
           .
       49011-KOHONLY-CHKSYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ã±ÆÈ¸øÈñ¤ÎÈ½Äê½èÍý
      *****************************************************************
       49011-KOHONLY-HKNCHK-SEC             SECTION.
      *
           MOVE    ZERO                TO  FLG-KOHCHK
      *
           IF      COMB-KOH1HKNNUM NOT =   SPACE
               MOVE    COMB-KOH1HKNNUM     TO  WRK-HKNNUM
               MOVE    COMB-KOH1PAYKBN     TO  WRK-PAYKBN
               PERFORM 49011-KOHHKNNUM-CHK-SEC
           END-IF
      *
           IF      COMB-KOH2HKNNUM NOT =   SPACE
               MOVE    COMB-KOH2HKNNUM     TO  WRK-HKNNUM
               MOVE    COMB-KOH2PAYKBN     TO  WRK-PAYKBN
               PERFORM 49011-KOHHKNNUM-CHK-SEC
           END-IF
      *
           IF      COMB-KOH3HKNNUM NOT =   SPACE
               MOVE    COMB-KOH3HKNNUM     TO  WRK-HKNNUM
               MOVE    COMB-KOH3PAYKBN     TO  WRK-PAYKBN
               PERFORM 49011-KOHHKNNUM-CHK-SEC
           END-IF
      *
           IF      COMB-KOH4HKNNUM NOT =   SPACE
               MOVE    COMB-KOH4HKNNUM     TO  WRK-HKNNUM
               MOVE    COMB-KOH4PAYKBN     TO  WRK-PAYKBN
               PERFORM 49011-KOHHKNNUM-CHK-SEC
           END-IF
           .
       49011-KOHONLY-HKNCHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ã±ÆÈ¸øÈñ¤ÎÈ½Äê½èÍý
      *****************************************************************
       49011-KOHHKNNUM-CHK-SEC             SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN-KOHMAX
               IF     (WRK-HKNNUM      =   SPA-GMN-KOHNUML (IDX))
      *            Ã±ÆÈ¸øÈñ°Ê³°
                   IF      SPA-NAI-KOHSBTKBN (IDX) =   "6"
                       CONTINUE
                   ELSE
                       MOVE    1               TO  FLG-KOHCHK
                   END-IF
               END-IF
           END-PERFORM
           .
       49011-KOHHKNNUM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥«¥ë¥ÆÈ¯¹Ô¤ÎÊÝ¸±ÁÈ¹ç·èÄê½èÍý
      *****************************************************************
       4901-KARUTE-CHEK-SEC             SECTION.
      *
           MOVE    ZERO                TO  WRK-CNT-HKN
           MOVE    ZERO                TO  WRK-CNT-HKN2
           MOVE    ZERO                TO  WRK-IDXH
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HKNCOMBI-MAX
               MOVE    ZERO                TO  WRK-CNT-HKN2
      *
               IF      SPA-GMN-THKNNUM (IDX)       NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      SPA-NAI-TKOH1HKNNUM(IDX)    NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      SPA-NAI-TKOH2HKNNUM(IDX)    NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      SPA-NAI-TKOH3HKNNUM(IDX)    NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      SPA-NAI-TKOH4HKNNUM(IDX)    NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      WRK-CNT-HKN         <=  WRK-CNT-HKN2
                   MOVE    IDX                 TO  WRK-IDXH
                   MOVE    WRK-CNT-HKN2        TO  WRK-CNT-HKN
               END-IF
      *        Ï«ºÒ¡¦¼«ÇåÀÕ¤¬¤¢¤ì¤ÐÂÐ¾Ý¤È¤¹¤ë
               IF      SPA-GMN-THKNNUM (IDX)       =   "971"
                                                   OR  "973"
                   MOVE    IDX                 TO  WRK-IDXH
                   MOVE    SPA-HKNCOMBI-MAX    TO  IDX
               END-IF
           END-PERFORM
      *
           IF      WRK-IDXH            =   ZERO
               MOVE    1               TO  WRK-IDXH
           END-IF
           MOVE    SPA-GMN-THKNCOMBINUM (WRK-IDXH)
                                       TO  SPA-GMN-SELNUM
      *
           .
       4901-KARUTE-CHEK-EXT.
           EXIT.
      *
      *!API
      *****************************************************************
      *   APIÊÝ¸±¾ðÊó½èÍý
      *****************************************************************
       4199-API-SYORI-SEC             SECTION.
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-ERRCHK
           MOVE    ZERO                TO  SPA-KOH-ERRIDX
           MOVE    1                   TO  FLG-APICHK
      *
      *    ÊÝ¸±¡¦¸øÈñ°ì³ç¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4501-ALLHKN-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )
               GO      TO      4199-API-SYORI-EXT
           END-IF
      *    ÊÝ¸±¡¦¸øÈñ¤Î¥Æ¡¼¥Ö¥ë¥»¥Ã¥È¤È¥Á¥§¥Ã¥¯
           PERFORM 4103-HKNKOH-TBL-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )
               GO      TO      4199-API-SYORI-EXT
           END-IF
      *
      *    ÊÝ¸±£Ô£Â£Ì¤«¤é£Ð£Á£Ò£Á¥Õ¥¡¥¤¥ë¤ØÊÔ½¸
           PERFORM 4501-PTHKNINF-LNK-SEC
      *    ¸øÈñ£Ô£Â£Ì¤«¤é£Ð£Á£Ò£Á¥Õ¥¡¥¤¥ë¤ØÊÔ½¸
           PERFORM 4502-PTKOHINF-LNK-SEC
      *    ¸øÈñ£Ô£Â£Ì¤«¤é¸øÈñÉéÃ´¤ØÊÔ½¸
           PERFORM 4504-PTKOHFTN-HEN-SEC
      *
      *    ÊÝ¸±ÁÈ¹ç¤»ºîÀ®
           PERFORM 4503-HKNCOMBI-SYORI-SEC
      *
           .
       4199-API-SYORI-EXT.
           EXIT.
      *!API
      *
      *****************************************************************
      *    ²èÌÌ¥«¡¼¥½¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       5001-MAPCUR-SEC             SECTION.
      *
      *    ¥«¡¼¥½¥ë»ØÄê¤Î¤Ê¤¤»þ¡¢ÆþÎÏ¤·¤¿¹àÌÜ¤Î¼¡¤®¤Ø
           IF     (SPA-ERRCD           =   SPACE)  AND
                  (SPA-GMN-CUR         =   ZERO )
               PERFORM 50011-INPUT-CUR-SEC
               ADD     1               TO  SPA-GMN-CUR
           END-IF
      *
           EVALUATE   SPA-GMN-CUR
              WHEN    01
                  MOVE    "P02_KANANAME"         TO  MCP-WIDGET
              WHEN    02
                  MOVE    "P02_NAME"             TO  MCP-WIDGET
              WHEN    03
                  MOVE    "P02_SEX"              TO  MCP-WIDGET
              WHEN    04
                  MOVE    "P02_BIRTHDAY"         TO  MCP-WIDGET
              WHEN    05
                  MOVE    "P02_NICKNAME"         TO  MCP-WIDGET
              WHEN    06
                  MOVE    "P02_HAKKO"            TO  MCP-WIDGET
              WHEN    70
                  MOVE    "P02_USERPG"           TO  MCP-WIDGET
              WHEN    07
                  MOVE    "TSTPTNUMKBN"          TO  MCP-WIDGET
      *       ÊÝ¸±¾ðÊó
              WHEN    08
                  MOVE    "P02_HKNJANUM"         TO  MCP-WIDGET
              WHEN    09
                  MOVE    "P02_HKNNUM"         TO  MCP-WIDGET
              WHEN    10
                  MOVE    "P02_HONKZKBN"         TO  MCP-WIDGET
              WHEN    11
                  MOVE    "P02_HOJOKBN"         TO  MCP-WIDGET
              WHEN    12
                  MOVE    "P02_CONTKBN"         TO  MCP-WIDGET
              WHEN    13
                  MOVE    "P02_KIGO"             TO  MCP-WIDGET
              WHEN    14
                  MOVE    "P02_NUM"              TO  MCP-WIDGET
              WHEN    15
                  MOVE    "P02_SKKGETYMD"        TO  MCP-WIDGET
              WHEN    16
                  MOVE    "P02_HTEKSTYMD"        TO  MCP-WIDGET
              WHEN    17
                  MOVE    "P02_HTEKEDYMD"        TO  MCP-WIDGET
              WHEN    18
                  MOVE    "P02_HIHKNJANAME"      TO  MCP-WIDGET
              WHEN    19
                  MOVE    "P02_HKAKUNINYMD"      TO  MCP-WIDGET
      *    ¸øÈñ£±
              WHEN    20
                  MOVE    "P02_FTNJANUM1"        TO  MCP-WIDGET
              WHEN    21
                  MOVE    "P02_KOHNUM1"          TO  MCP-WIDGET
              WHEN    22
                  MOVE    "P02_JKYSNUM1"         TO  MCP-WIDGET
              WHEN    23
                  MOVE    "P02_KTEKSTYMD1"       TO  MCP-WIDGET
              WHEN    24
                  MOVE    "P02_KTEKEDYMD1"       TO  MCP-WIDGET
              WHEN    25
                  MOVE    "P02_KKAKUNINYMD1"     TO  MCP-WIDGET
      *    ¸øÈñ£±
              WHEN    26
                  MOVE    "P02_FTNJANUM2"        TO  MCP-WIDGET
              WHEN    27
                  MOVE    "P02_KOHNUM2"          TO  MCP-WIDGET
              WHEN    28
                  MOVE    "P02_JKYSNUM2"         TO  MCP-WIDGET
              WHEN    29
                  MOVE    "P02_KTEKSTYMD2"       TO  MCP-WIDGET
              WHEN    30
                  MOVE    "P02_KTEKEDYMD2"       TO  MCP-WIDGET
              WHEN    31
                  MOVE    "P02_KKAKUNINYMD2"     TO  MCP-WIDGET
      *    ¸øÈñ£³
              WHEN    32
                  MOVE    "P02_FTNJANUM3"        TO  MCP-WIDGET
              WHEN    33
                  MOVE    "P02_KOHNUM3"          TO  MCP-WIDGET
              WHEN    34
                  MOVE    "P02_JKYSNUM3"         TO  MCP-WIDGET
              WHEN    35
                  MOVE    "P02_KTEKSTYMD3"       TO  MCP-WIDGET
              WHEN    36
                  MOVE    "P02_KTEKEDYMD3"       TO  MCP-WIDGET
              WHEN    37
                  MOVE    "P02_KKAKUNINYMD3"     TO  MCP-WIDGET
      *    
              WHEN    38
                  MOVE    "P02_SELNUM"           TO  MCP-WIDGET
              WHEN    39
                  MOVE    "P02_SRYKA"            TO  MCP-WIDGET
      *
              WHEN    40
                  MOVE    "P02_POST"             TO  MCP-WIDGET
              WHEN    41
                  MOVE    "P02_ADRS"            TO  MCP-WIDGET
              WHEN    42
                  MOVE    "P02_BANTI"            TO  MCP-WIDGET
              WHEN    43
                  MOVE    "P02_TEL1"             TO  MCP-WIDGET
              WHEN    44
                  MOVE    "P02_TEL2"             TO  MCP-WIDGET
              WHEN    45
                  MOVE    "P02_DISCOUNTKBN"     TO  MCP-WIDGET
              WHEN    46
                  MOVE    "P02_DISCOUNT"        TO  MCP-WIDGET
              WHEN    66
                  MOVE    "P02_NYUKIN"          TO  MCP-WIDGET
              WHEN    67
                  MOVE    "P02_SKYPRTFLG"        TO  MCP-WIDGET
              WHEN    47
                  MOVE    "P02_SETAINUSI"        TO  MCP-WIDGET
              WHEN    48
                  MOVE    "P02_ZOKUGARA"        TO  MCP-WIDGET
              WHEN    49
                  MOVE    "P02_CONDITION1"      TO  MCP-WIDGET
              WHEN    50
                  MOVE    "P02_CONDITION2"      TO  MCP-WIDGET
              WHEN    51
                  MOVE    "P02_CONDITION3"      TO  MCP-WIDGET
              WHEN    52
                  MOVE    "P02_TABOO1"          TO  MCP-WIDGET
              WHEN    53
                  MOVE    "P02_TABOO2"          TO  MCP-WIDGET
              WHEN    54
                  MOVE    "P02_ALLERGY1"        TO  MCP-WIDGET
              WHEN    55
                  MOVE    "P02_ALLERGY2"        TO  MCP-WIDGET
              WHEN    56
                  MOVE    "P02_KANSENSYO1"      TO  MCP-WIDGET
              WHEN    57
                  MOVE    "P02_KANSENSYO2"      TO  MCP-WIDGET
              WHEN    58
                  MOVE    "P02_COMMENT1"        TO  MCP-WIDGET
              WHEN    59
                  MOVE    "P02_COMMENT2"        TO  MCP-WIDGET
      *       ÅÐÏ¿
              WHEN    60
                  MOVE    "B12"                 TO  MCP-WIDGET
      *       Ï«ºÒ¡¦¼«ÇåÀÕ
              WHEN    61
                  MOVE    "B09S"                TO  MCP-WIDGET
           END-EVALUATE
      *
           .
       5001-MAPCUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È½èÍý
      *****************************************************************
       50011-INPUT-CUR-SEC          SECTION.
      *
      *
           EVALUATE    SPA-MCP-WIDGET
      *    ÊÝ¸±ÁÈ¹ç¤»ÁªÂò
               WHEN    "HKNLIST"
                   MOVE    38          TO  SPA-GMN-CUR
      *    ¤«¤Ê»áÌ¾
               WHEN    "P02_KANANAME"
                   MOVE    1           TO  SPA-GMN-CUR
      *    ´Á»ú»áÌ¾
               WHEN    "P02_NAME"
                   MOVE    2           TO  SPA-GMN-CUR
      *    À­ÊÌ
               WHEN    "P02_SEX"
                   MOVE    3           TO  SPA-GMN-CUR
      *    À¸Ç¯·îÆü
               WHEN    "P02_BIRTHDAY"
      *            ¥«¥ë¥ÆÈ¯¹Ô¤Ø
      ***********  MOVE    5           TO  SPA-GMN-CUR
      *            ÊÝ¸±¾ðÊó¤Ø
                   MOVE    7           TO  SPA-GMN-CUR
      *    ÄÌ¾Î
               WHEN    "P02_NICKNAME"
      *************MOVE    5           TO  SPA-GMN-CUR
      *            ÊÝ¸±¾ðÊó¤Ø
                   MOVE    7           TO  SPA-GMN-CUR
      *    ¥«¥ë¥ÆÈ¯¹Ô
               WHEN    "P02_HAKKO"
      *            ÊÝ¸±¾ðÊó¤Ø
                   MOVE    7           TO  SPA-GMN-CUR
      *    £Õ¡¦£Ð
               WHEN    "P02_USERPG"
      *            ÊÝ¸±¾ðÊó¤Ø
                   MOVE    7           TO  SPA-GMN-CUR
      *    ¥Æ¥¹¥È´µ¼Ô
               WHEN    "TSTPTNUMKBN"
                   MOVE    7           TO  SPA-GMN-CUR
      *    ÊÝ¸±¾ðÊó
               WHEN    "P02_HKNJANUM"
                   MOVE    8           TO  SPA-GMN-CUR
               WHEN    "P02_HKNNUM"
                   MOVE    9           TO  SPA-GMN-CUR
               WHEN    "P02_HONKZKBN"
                   MOVE    10          TO  SPA-GMN-CUR
      *            Êä½õ¤¬¤Ê¤¤»þ¡¢·ÑÂ³¤Ø
                   IF      SPA-GMN-HOJO-MAX    =   ZERO
                       MOVE    11              TO  SPA-GMN-CUR
      *                ·ÑÂ³¤¬¤Ê¤¤»þ¡¢µ­¹æ¤Ø
                       IF      SPA-GMN-CONT-MAX    =   ZERO
                           MOVE    12              TO  SPA-GMN-CUR
                       END-IF
                   END-IF
               WHEN    "P02_HOJOKBN"
                   MOVE    11          TO  SPA-GMN-CUR
      *            ·ÑÂ³¤¬¤Ê¤¤»þ¡¢µ­¹æ¤Ø
                   IF      SPA-GMN-CONT-MAX    =   ZERO
                       MOVE    12              TO  SPA-GMN-CUR
                   END-IF
      *!!!         ¸å´ü¹âÎð¼Ô¤Ï¡¢ÈÖ¹æ¤Ø
                   IF      SPA-GMN-HKNNUM      =   "039"
                       MOVE    13              TO  SPA-GMN-CUR
                   END-IF
               WHEN    "P02_CONTKBN"
                   MOVE    12          TO  SPA-GMN-CUR
               WHEN    "P02_KIGO"
                   MOVE    13          TO  SPA-GMN-CUR
               WHEN    "P02_NUM"
                   MOVE    14          TO  SPA-GMN-CUR
               WHEN    "P02_SKKGETYMD"
                   MOVE    15          TO  SPA-GMN-CUR
               WHEN    "P02_HTEKSTYMD"
                   MOVE    16          TO  SPA-GMN-CUR
               WHEN    "P02_HTEKEDYMD"
                   MOVE    17          TO  SPA-GMN-CUR
               WHEN    "P02_HIHKNJANAME"
                   MOVE    18          TO  SPA-GMN-CUR
               WHEN    "P02_HKAKUNINYMD"
                   MOVE    19          TO  SPA-GMN-CUR
      *    ¸øÈñ£±
               WHEN    "P02_FTNJANUM1"
                   MOVE    20          TO  SPA-GMN-CUR
                   IF     (SPA-GMN-FTNJANUM(1) =   SPACE) AND
                          (SPA-GMN-KOHNUM (1)  =   SPACE)
                       MOVE    39          TO  SPA-GMN-CUR
                   END-IF
               WHEN    "P02_KOHNUM1"
                   MOVE    21          TO  SPA-GMN-CUR
               WHEN    "P02_JKYSNUM1"
                   MOVE    22          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKSTYMD1"
                   MOVE    23          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKEDYMD1"
                   MOVE    24          TO  SPA-GMN-CUR
               WHEN    "P02_KKAKUNINYMD1"
                   MOVE    25          TO  SPA-GMN-CUR
      *    ¸øÈñ£²
               WHEN    "P02_FTNJANUM2"
                   MOVE    26          TO  SPA-GMN-CUR
                   IF     (SPA-GMN-FTNJANUM(2) =   SPACE) AND
                          (SPA-GMN-KOHNUM (2)  =   SPACE)
                       MOVE    39          TO  SPA-GMN-CUR
                   END-IF
               WHEN    "P02_KOHNUM2"
                   MOVE    27          TO  SPA-GMN-CUR
               WHEN    "P02_JKYSNUM2"
                   MOVE    28          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKSTYMD2"
                   MOVE    29          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKEDYMD2"
                   MOVE    30          TO  SPA-GMN-CUR
               WHEN    "P02_KKAKUNINYMD2"
                   MOVE    31          TO  SPA-GMN-CUR
      *    ¸øÈñ£³
               WHEN    "P02_FTNJANUM3"
                   MOVE    32          TO  SPA-GMN-CUR
                   IF     (SPA-GMN-FTNJANUM(3) =   SPACE) AND
                          (SPA-GMN-KOHNUM (3)  =   SPACE)
                       MOVE    39          TO  SPA-GMN-CUR
                   END-IF
               WHEN    "P02_KOHNUM3"
                   MOVE    33          TO  SPA-GMN-CUR
               WHEN    "P02_JKYSNUM3"
                   MOVE    34          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKSTYMD3"
                   MOVE    35          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKEDYMD3"
                   MOVE    36          TO  SPA-GMN-CUR
               WHEN    "P02_KKAKUNINYMD3"
                   MOVE    37          TO  SPA-GMN-CUR
      *    ÁªÂòÈÖ¹æ
               WHEN    "P02_SELNUM"
                   MOVE    38          TO  SPA-GMN-CUR
      *    ¿ÇÎÅ²Ê
               WHEN    "P02_SRYKA"
                   MOVE    39          TO  SPA-GMN-CUR
      *    Í¹ÊØÈÖ¹æ
               WHEN    "P02_POST"
                   MOVE    40          TO  SPA-GMN-CUR
      *            ½»½ê¤¬¤¢¤ì¤Ð¼¡¤®¤Ø
                   IF      SPA-GMN-EDITADRS-NAME   NOT =   SPACE
                       MOVE    41          TO  SPA-GMN-CUR
                   END-IF
      *    ½»½ê
               WHEN    "P02_ADRS"
                   MOVE    41          TO  SPA-GMN-CUR
      *    ÈÖÃÏÊý½ñ
               WHEN    "P02_BANTI"
                   MOVE    42          TO  SPA-GMN-CUR
      *    ÅÅÏÃÃë
               WHEN    "P02_TEL1"
                   MOVE    43          TO  SPA-GMN-CUR
      *    ÅÅÏÃÌë
               WHEN    "P02_TEL2"
                   MOVE    44          TO  SPA-GMN-CUR
      *    ¸ºÌÈ»öÍ³
               WHEN    "P02_DISCOUNTKBN"
                   MOVE    45          TO  SPA-GMN-CUR
      *    ³ä°úÎ¨
               WHEN    "P02_DISCOUNT"
      ************ MOVE    46          TO  SPA-GMN-CUR
                   MOVE    65          TO  SPA-GMN-CUR
      *    Æþ¶âÊýË¡
               WHEN    "P02_NYUKIN"
                   MOVE    46          TO  SPA-GMN-CUR
      *    À¤ÂÓ¼ç
               WHEN    "P02_SETAINUSI"
                   MOVE    47          TO  SPA-GMN-CUR
      *    Â³ÊÁ
               WHEN    "P02_ZOKUGARA"
                   MOVE    48          TO  SPA-GMN-CUR
      *    ¾õÂÖ£±
               WHEN    "P02_CONDITION1"
                   MOVE    49          TO  SPA-GMN-CUR
      *    ¾õÂÖ£²
               WHEN    "P02_CONDITION2"
                   MOVE    50          TO  SPA-GMN-CUR
      *    ¾õÂÖ£³
               WHEN    "P02_CONDITION3"
      *******      MOVE    51                  TO  SPA-GMN-CUR
                   MOVE    66                  TO  SPA-GMN-CUR
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬
               WHEN    "P02_SKYPRTFLG"
                   MOVE    51                  TO  SPA-GMN-CUR
      *    ¶Ø´÷
               WHEN    "P02_TABOO1"
                   MOVE    52                  TO  SPA-GMN-CUR
               WHEN    "P02_TABOO2"
                   MOVE    53                  TO  SPA-GMN-CUR
      *    ¥¢¥ì¥ë¥®¡¼
               WHEN    "P02_ALLERGY1"
                   MOVE    54                  TO  SPA-GMN-CUR
               WHEN    "P02_ALLERGY2"
                   MOVE    55                  TO  SPA-GMN-CUR
      *    ´¶À÷¾É
               WHEN    "P02_KANSENSYO1"
                   MOVE    56                  TO  SPA-GMN-CUR
               WHEN    "P02_KANSENSYO2"
                   MOVE    57                  TO  SPA-GMN-CUR
      *    ¥³¥á¥ó¥È
               WHEN    "P02_COMMENT1"
                   MOVE    58                  TO  SPA-GMN-CUR
      *    ¥³¥á¥ó¥È£²
               WHEN    "P02_COMMENT2"
                   MOVE    59                  TO  SPA-GMN-CUR
           END-EVALUATE
           .
      *
       50011-INPUT-CUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    À¾Îñ¢ªÏÂÎñFORMATÆüÉÕÊÔ½¸
      *****************************************************************
       410112-SE-WAFORMAT-YMDEDIT-SEC  SECTION.
      *
           EVALUATE    WRK-SYMD
               WHEN    SPACE
                   MOVE    SPACE           TO  WRK-HENYMD
               WHEN    ZERO
                   MOVE    "0000000"       TO  WRK-HENYMD
               WHEN    "99999999"
                   MOVE    "9999999"       TO  WRK-HENYMD
               WHEN    OTHER
      *
                   MOVE    SPACE               TO  STS-AREA-DAY
                   INITIALIZE                      STS-AREA-DAY
                   MOVE    SPACE               TO  LNK-DAY2-AREA
                   MOVE    "21"                TO  LNK-DAY2-IRAI
                   MOVE    WRK-SYMD            TO  LNK-DAY2-YMD
                   CALL    "ORCSDAY"           USING
                                               STS-AREA-DAY
                                               LNK-DAY2-AREA
                   IF      STS-DAY-RC1         =   ZERO
                       MOVE    LNK-DAY2-EDTYMD1    TO  WRK-HENYMD
                   ELSE
                       MOVE    SPACE               TO  WRK-HENYMD
                   END-IF
           END-EVALUATE
           .
       410112-SE-WAFORMAT-YMDEDIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤ØÊÑ´¹½èÍý
      *****************************************************************
       890-HALF-ZEN-SEC         SECTION.
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    WRK-MAE-INPUT       TO  KANACHK-MAE-INPUT
           MOVE    WRK-LEN             TO  KANACHK-MAX-CNT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           MOVE    KANACHK-MAE-INPUT   TO  WRK-MAE-INPUT
           IF     (KANACHK-RC      NOT =   ZERO  )  OR
                  (KANACHK-SYUBETU     =   1     )
               MOVE    1                   TO  FLG-ERR
               MOVE    KANACHK-MAE-INPUT   TO  WRK-ATO-INPUT
           ELSE
               MOVE    ZERO                TO  FLG-ERR
               MOVE    KANACHK-OUT-INPUT   TO  WRK-ATO-INPUT
           END-IF
      *
           .
       890-HALF-ZEN-EXT.
           EXIT.
      *****************************************************************
      *    È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤ØÊÑ´¹½èÍý¡Ê³°»ú¤¢¤ê¡Ë
      *****************************************************************
       891-HALF-ZEN2-SEC         SECTION.
      *
           IF     SPA-ENCODING         =   2
      *        ³ÈÄ¥´Á»úÂÐ±þ
               PERFORM 8910-HALF-ZENC2-SEC
           ELSE
      *        ³ÈÄ¥´Á»úÉÔ²Ä
               PERFORM 890-HALF-ZEN-SEC
           END-IF
      *
           .
       891-HALF-ZEN2-EXT.
           EXIT.
      *****************************************************************
      *    È¾³Ñ¶õÇò¤òÁ´³Ñ¶õÇò¤ØÊÑ´¹½èÍý¡Ê³°»ú¤¢¤ê¡Ë
      *****************************************************************
       8910-HALF-ZENC2-SEC         SECTION.
      *
           INITIALIZE                  ORCSKANACHK2AREA
           MOVE    "1"                 TO  KANACHK2-SYORI
           MOVE    WRK-MAE-INPUT       TO  KANACHK2-MAE-INPUT
           MOVE    WRK-LEN             TO  KANACHK2-MAX-CNT
           CALL    "ORCSKANACHK2"      USING
                                       ORCSKANACHK2AREA
           MOVE    KANACHK2-MAE-INPUT  TO  WRK-MAE-INPUT
           IF     (KANACHK2-RC     NOT =   ZERO  )  OR
                  (KANACHK2-SYUBETU    =   1     )
               MOVE    1                   TO  FLG-ERR
               MOVE    KANACHK2-MAE-INPUT  TO  WRK-ATO-INPUT
           ELSE
               MOVE    ZERO                TO  FLG-ERR
               MOVE    KANACHK2-OUT-INPUT  TO  WRK-ATO-INPUT
           END-IF
      *
           .
       8910-HALF-ZENC2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¡¡£Ò£Å£Á£Ä
      *****************************************************************
       900-SYSTEM-READ-SEC         SECTION.
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       900-SYSTEM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      **    ´µ¼Ô¥Þ¥¹¥¿¡¼ÆÉ¤ß¹þ¤ß
      *****************************************************************
       900-PTINF-READ-SEC         SECTION.
      *
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTINF-REC
               MOVE    ZERO            TO  FLG-PTINF
           ELSE
               INITIALIZE                  PTINF-REC
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           .
       900-PTINF-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÊÝ¸±ÈÖ¹æ¥Þ¥¹¥¿¼¡¸¡º÷½èÍý
      ****************************************************************
       921-HKNNUM-NEXT-SEC              SECTION.
      *
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNNUM-REC
               MOVE    ZERO            TO  FLG-HKNNUM
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           .
       921-HKNNUM-NEXT-EXT.
           EXIT.
      *
      *----(01.00.15) LINE ADD START ---------------------------------
      *****************************************************************
      *    ¿ÍÌ¾¥Æ¡¼¥Ö¥ë¸¡º÷
      *****************************************************************
       941-JINMEI-SELECT-SEC           SECTION.
      *
           MOVE    SPA-HOSPNUM         TO  JINMEI-HOSPNUM
           MOVE    JINMEI-REC          TO  MCPDATA-REC
      *
           MOVE    "tbl_jinmei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  JINMEI-REC
           ELSE
               INITIALIZE                  JINMEI-REC
               MOVE    1               TO  FLG-JINMEI
           END-IF
           .
      *
       941-JINMEI-SELECT-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÍÌ¾¥Æ¡¼¥Ö¥ëÆÉ¤ß¹þ¤ß
      *****************************************************************
       941-JINMEI-NEXT-SEC           SECTION.
      *
           MOVE    "tbl_jinmei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  JINMEI-REC
           ELSE
               INITIALIZE                  JINMEI-REC
               MOVE    1               TO  FLG-JINMEI
           END-IF
           .
      *
       941-JINMEI-NEXT-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÍÌ¾¥Æ¡¼¥Ö¥ë¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       941-JINMEI-CLOSE-SEC           SECTION.
      *
           MOVE    "tbl_jinmei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           .
      *
       941-JINMEI-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±¼ÔÈÖ¹æ¥Þ¥¹¥¿¼¡¸¡º÷½èÍý
      *****************************************************************
       900-HKNJAINF-READ-SEC              SECTION.
      *
           MOVE    "tbl_hknjainf"      TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  HKNJAINF-REC
               MOVE    ZERO                TO  FLG-HKNJAINF
           ELSE
               INITIALIZE               HKNJAINF-REC
               MOVE    1               TO  FLG-HKNJAINF
           END-IF
           .
       900-HKNJAINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Ñ¥é¥á¥¿¾ðÊóÆÉ¤ß¹þ¤ß
      *****************************************************************
       990-PARA-READ-SEC        SECTION.
      *
           MOVE    "tbl_para"          TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PARA-REC
               MOVE    ZERO            TO  FLG-PARA
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           .
       990-PARA-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       990-DBCLOSE-SEC         SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
      *----(01.00.15) LINE ADD END   ---------------------------------
      *****************************************************************
      *    £Ð£Õ£Ô¡¡½èÍý
      *****************************************************************
       900-PUT-WINDOW           SECTION.
      *
           MOVE    "PUTWINDOW"      TO  MCP-FUNC.
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
       900-PUT-WINDOW-EXT.
           EXIT.
      *
