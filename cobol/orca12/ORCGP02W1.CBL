      *******************************************************************
      * Project code name "ORCA"
      * ∆¸∞Â…∏Ω‡•Ï•ª•◊•»•Ω•’•»° JMA standard receipt software°À
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCGP02W1.
      *****************************************************************
      *  •∑•π•∆•‡Ãæ        : £œ£“£√£¡
      *  •µ•÷•∑•π•∆•‡Ãæ    : ¥µº‘≈–œø
      *  •≥•Û•›°º•Õ•Û•»Ãæ  : ¥µº‘¥À‹æ Û° £–£∞£≤°À
      *  ¥…Õ˝º‘            : 
      *  ∫Ó¿Æ∆¸…’    ∫Ó∂»º‘        µ≠Ω“
      *  00/12/01    MCC-¬¿≈ƒ      ø∑µ¨∫Ó¿Æ
      *****************************************************************
      *  •◊•Ì•∞•È•‡Ω§¿µÕ˙ŒÚ
      * Maj/Min/Rev  Ω§¿µº‘       ∆¸…’      ∆‚Õ∆
      *  01.00.01    MCC-¬¿≈ƒ     01/04/12   ›∏±»÷πÊ•ﬁ•π•ø≥Œ«ß§Œ ˝À°
      *  01.00.02    MCC-¬¿≈ƒ     01/04/16  ¡»πÁ§ª∫Ó¿Æ§Œ•—•È•·°º•ø —ππ
      *  01.00.03    MCC-¬¿≈ƒ     01/04/18  ¿∏«Ø∑Ó∆¸Ã§ÕË∆¸•¡•ß•√•Øƒ…≤√
      *  01.00.04    MCC-¬¿≈ƒ     01/05/02  ¿≠ Ã…¨ø‹∆˛Œœ∫ÔΩ¸
      *  01.00.05    MCC-¬¿≈ƒ     01/05/10   ›∏±∫ÔΩ¸…‘«Ω§Œ¬–±˛/•ø•§•»•Î
      *  01.00.06    MCC-¬¿≈ƒ     01/05/10  ∆¸…’ —¥π∏Â•º•Ì…Ωº® —ππ
      *  01.00.07    MCC-¬¿≈ƒ     01/05/16  ∏∫Ã»ªˆÕ≥Ã§¬∏∫ﬂª˛§Œ¬–±˛
      *  01.00.08    MCC-¬¿≈ƒ     01/05/23  ¥µº‘»÷πÊπΩ¿Æ¥…Õ˝§Œƒ…≤√
      *  01.00.09    MCC-¬¿≈ƒ     01/05/23  •π•—ŒŒ∞Ë≈æ¡˜ƒ…≤√
      *  01.00.10    MCC-¬¿≈ƒ     01/05/24  HOKENJANAME 
      *  01.00.11    MCC-¬ø°π«º   01/06/13  ≈–œø∏Â°¢ø«Œ≈π‘∞Ÿ¡´∞‹§Úƒ…≤√
      *  01.00.12    MCC-¬ø°π«º   01/07/02  ∆¸…’∑ÂøÙ —ππ°¶«ØŒƒ…≤√
      *  01.00.13    MCC-¬ø°π«º   02/04/05  œ´∫“ ›∏±§Œƒ…≤√
      *  01.00.14    MCC-¬ø°π«º   02/05/02  »æ≥—•¡•ß•√•Ø§Œƒ…≤√
      *  01.00.15    MCC-¬¿≈ƒ     02/05/31  •´• ª·Ãæ∏ı ‰≤ËÃÃ§Úƒ…≤√
      *  02.00.00    MCC-¬ø°π«º   02/06/20  ≤ËÃÃ•Ï•§•¢•¶•» —ππ§À§Ë§ÎΩ§¿µ
      *  02.00.01    NACL-¬ø°π«º  02/07/31  •—•È•·•ø•’•°•§•Î§Ú£ƒ£¬§ÿ
      *  02.00.02    NACL-¬ø°π«º  02/09/09   ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *                                     º´«Â¿’ ›∏±§Œƒ…≤√
      *  02.00.03    NACL-¬ø°π«º  02/10/07  ¡•∞˜§Œœ∑øÕ ‰Ωı∂Ë ¨§ŒΩÈ¥¸…Ωº®Ω§¿µ
      *  02.00.04    NACL-¬ø°π«º  02/10/31  ¡•∞˜ ›∏± ‰Ωı∂Ë ¨ƒ…≤√
      *  02.00.05    NACL-¬ø°π«º  02/11/06   ›∏±°¶∏¯»Ò§Œ≥Œ«ß∆¸Ω§¿µ
      *  02.00.06    NACL-¬ø°π«º  02/11/14  ¡•∞˜ ›∏±§Œ —ππΩÈ¥¸…Ωº®Ω§¿µ
      *  02.00.07    NACL-¬ø°π«º  02/11/21  ∂¶∫—≤º¡•£≥∑Óƒ…≤√
      *  02.00.08    NACL-¬ø°π«º  03/03/24  £»£±£µ«Ø£¥∑Ó≤˛¿µ¬–±˛ƒ…≤√
      *                                     ∏¯»Ò…È√¥≥€ƒ…≤√
      *  02.00.09    NACL-¬ø°π«º  03/07/08   ›∏±º‘∞€∆∞∆¸•¡•ß•√•Øƒ…≤√
      *  02.00.10    NACL-¬ø°π«º  03/08/28  ∏¯»Ò…È√¥≥€§À°«£∞£±£≤°«§»
      *                                     °«£∞£µ£±°«§Úƒ…≤√
      *  02.00.11    NACL-¬ø°π«º  03/10/04  ∏¯»Ò…È√¥≥€§À
      *                                     ≈Ïµ˛§Œ∆√ƒÍº¿¥µ∏¯»Òƒ…≤√
      *  02.00.12    NACL-¬ø°π«º  03/10/09  ∏¯»Ò…È√¥≥€§À≈Ïµ˛§Œ'451'ƒ…≤√
      *  02.00.13    NACL-¬ø°π«º  03/10/27  øÕÃæº≠ΩÒª»Õ—∂Ë ¨ƒ…≤√
      *                                     º´»Ò ›∏±§ŒΩÈ¥¸∂Ë ¨ƒ…≤√
      *                                     •´•Î•∆»Øπ‘ΩÈ¥¸∂Ë ¨ƒ…≤√
      *  02.00.14    NACL-¬ø°π«º  04/08/20  ∏¯»Ò…È√¥≥€§À
      *                                      º∏À§Œ£±£∏£∂∏¯»Òƒ…≤√
      *  02.00.15    NACL-¬ø°π«º  05/03/23   ø¿Æ£±£∑«Ø£¥∑Ó≤˛¿µ¬–±˛
      *                                     ° ∏¯»Ò…È√¥≥€§À'025'ƒ…≤√°À
      *  02.00.16    NACL-¬ø°π«º  05/10/07  •Ê°º•∂•◊•Ì•∞•È•‡µØ∆∞ƒ…≤√
      *  02.00.17    NACL-¬ø°π«º  05/10/19  ∆√ ÃŒ≈Õ‹»Òƒ…≤√
      *  02.00.18    NACL-¬ø°π«º  05/10/20  ∏¯»Ò∫ÔΩ¸Ω§¿µ
      *  02.00.19    NACL-¬ø°π«º  05/11/14  MONFUNC ¬–±˛ ¬æ
      *  02.00.20    NACL-¬ø°π«º  06/05/18  ¿¡µ·ΩÒ»Øπ‘∂Ë ¨ƒ…≤√
      *  02.00.21    NACL-¬ø°π«º  06/05/19  ¬‡ø¶πÒ ›°¶œ∑øÕ∏¯»Ò•¡•ß•√•Øƒ…≤√
      *  03.00.01    NACL-¬ø°π«º  06/08/25   ø¿Æ£±£∏«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *                                     ° œ∑øÕ≥‰πÁ —ππ°À
      *  03.03.00    NACL-¬ø°π«º  06/10/17  ∏∫Ã»≥‰πÁ°¶∂‚≥€ƒ…≤√
      *  03.04.00    NACL-¬ø°π«º  06/11/14  π‚≥€∞—«§ ß§§ƒ…≤√
      *  03.04.01    NACL-¬ø°π«º  07/02/16  £—£“ºı…’¬–±˛
      *  03.05.00    NACL-¬ø°π«º  07/05/XX  •∞•Î°º•◊ø«Œ≈¬–±˛
      *  03.05.00    NACL-¬ø°π«º  07/06/12   ›∏± £ºÃµ°«Ωƒ…≤√
      *  03.05.01    NACL-¬ø°π«º  07/08/28  ∏¯»Ò¥¸∏¬¿⁄§Ï∂Ë ¨ƒ…≤√
      *  04.01.00    NACL-¬ø°π«º  07/11/XX  ∏¯≥≤ ›∏±¬–±˛
      *  04.00.00    NACL-¬ø°π«º  08/01/25  ∏¯»Ò…È√¥≥€§À∑Î≥À∆˛ΩÍ'011'ƒ…≤√
      *  04.02.00    NACL-¬ø°π«º  08/03/XX   ø¿Æ£≤£∞«Ø£¥∑Ó≤˛¿µ¬–±˛
      *  04.03.00    NACL-¬ø°π«º  08/10/03  ∏¯»Ò…È√¥≥€§ÀÀÃ≥§∆ª§Œ'183'ƒ…≤√
      *  04.04.00    NACL-¬ø°π«º  08/12/03  ΩªΩÍ§´§ÈÕπ ÿ»÷πÊ¿ﬂƒÍƒ…≤√
      *  04.05.00    NACL-¬ø°π«º  09/08/11  ¬‡ø¶πÒ ›«ØŒ•¡•ß•√•Øƒ…≤√
      *                                     πÒ ›≈˘£∑£∞∫–≈˛√£∑Ÿπƒ…≤√
      *  04.05.00    NACL-¬ø°π«º  09/09/08  ∏¯»Ò…È√¥≥€§À∞¶√Œ∏©§Œ'191'ƒ…≤√
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *    •—•È•·•ø•«°º•ø
      *    SELECT  PARA-FILE       ASSIGN  FILE-NAME1
      *                            ORGANIZATION    IS  INDEXED
      *                            ACCESS  MODE    IS  DYNAMIC
      *                            RECORD  KEY     IS  PAR-KEY
      *                            FILE    STATUS  IS  STS-PARA.
      *
       DATA                    DIVISION.
      *FILE                        SECTION.
      *
      *    •—•È•·•ø•«°º•ø
      *FD  PARA-FILE.
      *01  PARA-REC.
      *    03  PAR-KEY.
      *        05  PAR-FILEMEI         PIC X(08).
      *        05  PAR-EDANUM          PIC 9(04).
      *    03  PAR-DATA-REC            PIC X(3000).
      *
       WORKING-STORAGE             SECTION.
      *    •—•È•·•ø•’•°•§•ÎÃæ
      *01  FILE-NAME1.
      *    03  FILLER              PIC X(09)   VALUE   "/var/tmp/".
      *    03  FILLER              PIC X(07)   VALUE   "P01PARA".
      *    03  FILE-TERMID1        PIC X(64)   VALUE   SPACE.
      *
      *    ≤ËÃÃ»Û…Ωº®
           COPY    "ENUM-VALUE".
      *
      *    •π•—ŒŒ∞Ë
           COPY    "COMMON-SPA".
      *    ¥µº‘≈–œø•π•—ŒŒ∞Ë
           COPY    "P02COMMON-SPA".
      **    ¥µº‘≤ËÃÃ•π•—ŒŒ∞Ë
           COPY    "P02SCR-SPA".
      *
      *    •’•È•∞ŒŒ∞Ë
       01  STS-AREA.
           03  STS-PARA            PIC X(02).
      *
      *    •’•È•∞ŒŒ∞Ë
       01  FLG-AREA.
           03  FLG-END             PIC 9(01).
           03  FLG-PTINF           PIC 9(01).
           03  FLG-HKNNUM          PIC 9(01).
           03  FLG-PARA            PIC 9(01).
           03  FLG-UKETUKE         PIC 9(01).
           03  FLG-LNKPARA         PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
           03  FLG-PTRSIINF        PIC 9(01).
           03  FLG-HKNCOMBI        PIC 9(01).
           03  FLG-HKNJAINF        PIC 9(01).
           03  FLG-ADRS            PIC 9(01).
      *
      *    ∆˛Œœ§ŒÕ≠Ãµ
           03  FLG-IN-KANANAME        PIC 9(01).
           03  FLG-IN-NAME            PIC 9(01).
           03  FLG-IN-SEX             PIC 9(01).
           03  FLG-IN-BIRTHDAY        PIC 9(01).
           03  FLG-IN-POST            PIC 9(01).
           03  FLG-IN-DISCOUNTKBN     PIC 9(01).
      *    ∆ÛΩ≈≈–œøµø§§Õ—
           03  FLG-P02A-SYORI         PIC 9(01).
           03  FLG-CHK                PIC 9(01).
           03  FLG-ERR                PIC 9(01).
           03  FLG-OK                 PIC 9(01).
      *    ≈–œø•’•È•∞
           03  FLG-TOUROKU            PIC 9(01).
      *    ≈–œø•’•È•∞
           03  FLG-TOUROKU2           PIC 9(01).
      *
      *     ›∏±∆˛Œœ
           03  FLG-IN-HKN             PIC 9(01).
      *     ›∏±∫ÔΩ¸
           03  FLG-HKN-DEL            PIC 9(01).
      *    ∏¯»Ò∫ÔΩ¸
           03  FLG-KOH-DEL            PIC 9(01).
      *    ∏¯»Òƒ…≤√
           03  FLG-KOH-ADD            PIC 9(01).
      *    ∏¯»Òƒ…≤√
           03  FLG-KOH-ADD2           PIC 9(01).
      *
      *----(01.00.01) LINE ADD START ---------------------------------
           03  FLG-RJN             PIC 9(01).
      *----(01.00.15) LINE ADD START ---------------------------------
           03  FLG-JINMEI          PIC 9(01).
      *    •´• ª·Ãæ∏°∫˜Õ—•’•È•∞
      *    0:¬–æ›£±∑Ô/1:¬–æ›§ §∑/2: £øÙ∑Ô≥∫≈ˆ
           03  FLG-NAME            PIC 9(01)   OCCURS 2.
      *----(01.00.15) LINE ADD END   ---------------------------------
      *
           03  FLG-RJNCHK          PIC 9(01).
           03  FLG-HKNCHK          PIC 9(01).
           03  FLG-HKNCHK2         PIC 9(01).
           03  FLG-SEIHOGO         PIC 9(01).
           03  FLG-HKNCHK3         PIC 9(01).
      *
           03  FLG-P02A-CHK       PIC 9(01).
      *    ∏¯»Ò√±∆»•¡•ß•√•Ø
           03  FLG-KOHCHK         PIC 9(01).
      *
      *    Ω≈ £•®•È°º§ §∑
           03  FLG-ERRCHK         PIC 9(01).
      *    £»£±£∏°•£±£∞≤˛¿µ¬–±˛
           03  FLG-RJNCHK2             PIC 9(01).
           03  FLG-RJNCHK3             PIC 9(01).
           03  FLG-RJNERR              PIC 9(01).
           03  FLG-KOKUHO              PIC 9(01).
           03  FLG-RJNKOHERR           PIC 9(01).
           03  FLG-KOH27               PIC 9(01).
      *
           03  FLG-KANA                PIC 9(01).
           03  FLG-HKN-ADD2            PIC 9(01).
           03  FLG-27KOH-OK            PIC 9(01).
      *
      *    •´•¶•Û•»ŒŒ∞Ë
       01  CNT-AREA.
           03  CNT-ERR             PIC 9(06).
      *----(01.00.15) LINE ADD START ---------------------------------
           03  CNT-JINMEI          PIC 9(06).
           03  CNT-KANANAME        PIC 9(06).
      *----(01.00.15) LINE ADD END   ---------------------------------
      *
      *    •∑•π•∆•‡ŒŒ∞Ë
       01  SYS-AREA.
           03  SYS-YMD.
               05  SYS-YY          PIC 9(02).
               05  SYS-MM          PIC 9(02).
               05  SYS-DD          PIC 9(02).
           03  SYS-TIME.
               05  SYS-THH         PIC 9(02).
               05  SYS-TMM         PIC 9(02).
               05  SYS-TSS         PIC 9(02).
               05  SYS-TDD         PIC 9(02).
      *
      *    ≈∫ª˙ŒŒ∞Ë
       01  IDX-AREA.
           03  IDX                 PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDZ                 PIC 9(04).
           03  IDA                 PIC 9(04).
      *----(01.00.15) LINE ADD START ---------------------------------
           03  IDX1                PIC 9(05).
      *----(01.00.15) LINE ADD END   ---------------------------------
           03  IDX2                PIC 9(04).
           03  IDX-H               PIC 9(04).
           03  IDXH                PIC 9(04).
      *
           03  IDT                 PIC 9(04).
      *
           03  IDX-R               PIC 9(04).
           03  IDX-R2              PIC 9(04).
      *
           03  IDX-K               PIC 9(04).
           03  IDX-K2              PIC 9(04).
           03  IDX-KOH             PIC 9(04).
      *
           03  IDXK                PIC 9(04).
           03  IDX5                PIC 9(04).
      *
      *    ∞Ïª˛ŒŒ∞Ë
       01  WRK-AREA.
           03  WRK-SYMD.
               05  WRK-SYY         PIC 9(04).
               05  WRK-SMM         PIC 9(02).
               05  WRK-SDD         PIC 9(02).
           03  WRK-SYMD6           PIC 9(08).
           03  WRK-WYMD.
               05  WRK-WGO         PIC X(01).
               05  WRK-WYY         PIC 9(02).
               05  WRK-WMM         PIC 9(02).
               05  WRK-WDD         PIC 9(02).
           03  WRK-SAKIPG          PIC X(08).
           03  WRK-RENNUMZ         PIC ZZZZ.
      *    ¥Ω‡∆¸
           03  WRK-BASEYMD.
               05  WRK-BYY         PIC 9(04).
               05  WRK-BMM         PIC 9(02).
               05  WRK-BDD         PIC 9(02).
      *     ›¬∏«ØŒ
           03  WRK-MAE-NENREI.
               05  WRK-MAE-NENREI-YY       PIC 9(03).
               05  WRK-MAE-NENREI-MM       PIC 9(02).
      *    ∆˛Œœπ‡Ã‹Ãæ
      *****03  WRK-MCP-WIDGET          PIC X(64).
      *     ›∏±≥´ªœ∞Ã√÷
           03  WRK-HKNSTR              PIC 9(04).
      *    ∏¯»Ò≥´ªœ∞Ã√÷
           03  WRK-KOHSTR              PIC 9(04).
      *
           03  WRK-SELNUM              PIC X(04).
           03  WRK-GMN-SELNUM          PIC 9(04).
      *
           03  WRK-HKNCOMBI        PIC X(100).
           03  WRK-HKNKBN-MEI      PIC X(02).
      *
           03  WRK-NAIBU-IDX-AREA.
               05  WRK-G-IDX       PIC 9(04).
               05  WRK-N-IDX       PIC 9(04).
      *        1: ›∏±•∆°º•÷•Î /2:∏¯»Ò•∆°º•÷•Î
               05  WRK-W-TBL       PIC 9(01).
      *
           03  WRK-KENSAKU-AREA.
               05  WRK-KEN-HKNNUM      PIC X(03).
      *----(01.00.01) LINE MOD START ---------------------------------
      *         05  WRK-KEN-TEKYMD      PIC X(08).
               05  WRK-KEN-TEKSTYMD    PIC X(08).
               05  WRK-KEN-TEKEDYMD    PIC X(08).
      *----(01.00.01) LINE MOD END   ---------------------------------
               05  WRK-KEN-ERFLG       PIC X(01).
               05  WRK-KEN-SBTKBN      PIC X(01).
      *
           03  WRK-PARACNT-AREA.
               05  WRK-PCNT-HKN        PIC 9(04).
               05  WRK-PCNT-KOH        PIC 9(04).
      *
           03  WRK-SYSKAN-AREA.
               05  WRK-SYSKAN-KANRICD  PIC X(04).
               05  WRK-SYSKAN-KBNCD    PIC X(08).
               05  WRK-SYSKAN-STYUKYMD PIC X(08).
               05  WRK-SYSKAN-EDYUKYMD PIC X(08).
      *
           03  WRK-HKNKOH-FLG          PIC 9(01).
      *
           03  WRK-MEISAI1             PIC 9(06).
           03  WRK-MEISAI2             PIC 9(06).
           03  WRK-MEISAI3             PIC 9(06).
           03  WRK-HST                 PIC 9(04).
           03  WRK-HED                 PIC 9(04).
           03  WRK-KST                 PIC 9(04).
           03  WRK-KED                 PIC 9(04).
           03  WRK-DISCOUNT            PIC Z9.
           03  WRK-KYUSEI              PIC 9(01).
           03  WRK-RATEKBN             PIC X(02).
           03  WRK-KBNCD               PIC X(02).
           03  WRK-OK                  PIC 9(01).
      *----(01.00.06) LINE MOD START ---------------------------------
           03  WRK-WWYMD               PIC X(10).
      *----(01.00.06) LINE MOD END   ---------------------------------
      *
      *    œ´∫“ ›∏±£…£ƒ
           03  WRK-PTRSI-HKNID         PIC 9(10).
      *
      *----(01.00.15) LINE ADD START ---------------------------------
           03  WRK-NAME-AREA.
               05  WRK-NAME-X-AREA.
                   07  WRK-NAME-X  PIC X(02)   OCCURS 25.
               05  WRK-NAME-VAL    PIC X(50)   OCCURS  3.
               05  WRK-NAME-KANJI  PIC X(50)   OCCURS  2.
               05  WRK-NAME-KANA   PIC X(50)   OCCURS  2.
               05  WRK-KANJINAME-AREA.
                   07  WRK-KANJINAME-OCC       OCCURS  50
                                               INDEXED BY  IDX-NAME.
                       09  WRK-KANJINAME-T
                                   PIC X(50).
               05  WRK-KANJINAME   PIC X(50).
      *----(01.00.15) LINE ADD END   ---------------------------------
      *
      *     ›∏±∏¯»ÒºÔ Ã
           03  WRK-HKNNUM              PIC X(03).
           03  WRK-PAYKBN              PIC X(02).
           03  WRK-HKNKOHSBTKBN        PIC X(01).
           03  WRK-TANSEIDONAME        PIC X(20).
           03  WRK-TEKSTYMD            PIC X(08).
           03  WRK-TEKEDYMD            PIC X(08).
      *
           03  WRK-NAI-HKNSTR       PIC 9(04).
           03  WRK-NAI-KOHSTR       PIC 9(04).
      *
      *    …Ωº®Õ— ›∏±
           03  WRK-IDXH                PIC 9(04).
           03  WRK-CNT-HKN             PIC 9(04).
           03  WRK-CNT-HKN2            PIC 9(04).
      *    …¬±°ºÔ Ã
           03  WRK-HOSPSBT             PIC 9(01).
      *    œ∑øÕªŸ ß∂Ë ¨
           03  WRK-ROUPAYKBN           PIC X(01).
      *
      *    ¡¥≥—•¡•ß•√•Ø∑ÂøÙ
           03  WRK-LEN                 PIC 9(04).
      *
           03  WRK-EDANUM              PIC 9(04).
      *
      *!!!!
      *    £∑£∞∫–•¡•ß•√•Ø
           03  FLG-KOKUHO-CHK          PIC 9(01).
           03  WRK-KOKUHO-CHK          PIC 9(04).
      *!!!!
      *
      *    ∏¯»Ò£”£œ£“£‘Õ—° £”£–£¡§»∆±§∏ŒŒ∞Ë°À
       01  WRK-KOUHI-AREA.
      *    ∏¯»Òæ Û
           03  WRK-GMN-KOH-AREA.
               05  WRK-GMN-KOH-TBL         OCCURS   3.
                   07  WRK-GMN-HOK-G.
                       09  WRK-GMN-KOHNUM-G.
                          11  WRK-GMN-KOHNUM      PIC X(03).
                          11  WRK-GMN-KOHKBN      PIC X(01).
      ****************    11  WRK-GMN-H1          PIC X(01).
                          11  WRK-GMN-KOHNUMMEI   PIC X(16).
      *
                       09  WRK-GMN-KTEKSTYMD        PIC X(10).
                       09  WRK-GMN-KTEKEDYMD        PIC X(10).
                       09  WRK-GMN-KKAKUNINYMD      PIC X(10).
                       09  WRK-GMN-FTNJANUM         PIC X(08).
                       09  WRK-GMN-JKYSNUM          PIC X(20).
      *
                   07  WRK-NAI-KTEKSTYMD        PIC X(08).
                   07  WRK-NAI-KTEKEDYMD        PIC X(08).
                   07  WRK-NAI-KKAKUNINYMD      PIC X(08).
      *            ¥¸∏¬¿⁄§Ï∂Ë ¨
                   07  WRK-NAI-TEKEDCHKKBN      PIC X(01).
      *
                   07  WRK-NAI-PTKOH-EDANUM       PIC 9(04).
                   07  WRK-NAI-PTKOH-KOHID        PIC 9(10).
                   07  WRK-NAI-PTKOH-SBTKBN       PIC X(01).
                   07  WRK-NAI-PTKOH-PAYKBN       PIC X(02).
      *
      *                ≈–œøª˛§Œ…È√¥º‘»÷πÊ°¶∏¯»ÒºÔŒ‡
                   07  WRK-MAE-KOHNUM-G.
                       09  WRK-MAE-KOHNUM      PIC X(03).
                       09  WRK-MAE-KOHKBN      PIC X(01).
      **************** 09  WRK-MAE-H1          PIC X(01).
                       09  WRK-MAE-KOHNUMMEI   PIC X(16).
                   07  WRK-MAE-FTNJANUM            PIC X(08).
                   07  WRK-MAE-KKAKUNINYMD         PIC X(08).
                   07  WRK-MAE-KKAKUNINYMDW        PIC X(09).
      *            £∂£µ∫–∞ æÂ∑Ÿπ
                   07  WRK-NAI-AGE65               PIC 9(01).
      *            «ØŒ∑Ÿπ
                   07  WRK-NAI-AGECHK              PIC 9(01).
      *            …È√¥º‘»÷πÊ∑Ÿπ
                   07  WRK-NAI-FTNCHK              PIC 9(01).
      *             ›∏±º‘∞€∆∞∆¸∑Ÿπ
                   07  WRK-PTKOH-IDOYMD            PIC X(08).
                   07  WRK-NAI-PTKOH-KEIFLG        PIC X(01).
      *            ºıµÎº‘»÷πÊ∑Ÿπ
                   07  WRK-NAI-JYUCHK              PIC 9(01).
      *            ≥Œ«ß«Ø∑Ó∆¸∑Ÿπ
                   07  WRK-KOH-KAKUINFLG        PIC 9(01).
               05  WRK-KOH-MAX             PIC 9(04).
      *
      *     ›∏±¡»πÁ§ª° £”£–£¡§»∆±§∏°À
       01  WRK-HKNCOBMI-SORT-AREA.
           03  WRK-HKNCOMBI-AREA.
               05  WRK-GMN-HKNCOMBI-LIST       OCCURS   15.
                       09  WRK-GMN-THKNCOMBINUM    PIC 9(04).
                       09  WRK-GMN-THKNCOMBIMEI    PIC X(40).
                       09  WRK-GMN-TTEKSTYMD       PIC X(09).
                       09  WRK-GMN-TTEKEDYMD       PIC X(09).
                       09  WRK-GMN-THKNNUM         PIC X(03).
                       09  WRK-GMN-THKNID          PIC 9(10).
      *
                       09  WRK-NAI-TTEKSTYMD       PIC X(08).
                       09  WRK-NAI-TTEKEDYMD       PIC X(08).
                       09  WRK-NAI-TKOH1HKNNUM     PIC X(03).
                       09  WRK-NAI-TKOH2HKNNUM     PIC X(03).
                       09  WRK-NAI-TKOH3HKNNUM     PIC X(03).
                       09  WRK-NAI-TKOH4HKNNUM     PIC X(03).
                       09  WRK-NAI-THYOJIKBN       PIC X(01).
               05  WRK-HKNCOMBI-MAX            PIC 9(04).
      *
           03  WRK-SORT-KEY.
               05  WRK-SRT-TEKISTYMD      PIC X(08).
               05  WRK-SRT-HKNCOMBINUM    PIC X(04).
               05  WRK-SRT-IDX            PIC 9(04).
      *
           03  WRK-HKNCOMBI02-AREA.
               05  WRK-GMN-HKNCOMBI02-LIST       OCCURS   15.
                       09  WRK-GMN02-THKNCOMBINUM    PIC 9(04).
                       09  WRK-GMN02-THKNCOMBIMEI    PIC X(40).
                       09  WRK-GMN02-TTEKSTYMD       PIC X(09).
                       09  WRK-GMN02-TTEKEDYMD       PIC X(09).
                       09  WRK-GMN02-THKNNUM         PIC X(03).
                       09  WRK-GMN02-THKNID          PIC 9(10).
      *
                       09  WRK-NAI02-TTEKSTYMD       PIC X(08).
                       09  WRK-NAI02-TTEKEDYMD       PIC X(08).
                       09  WRK-NAI02-TKOH1HKNNUM     PIC X(03).
                       09  WRK-NAI02-TKOH2HKNNUM     PIC X(03).
                       09  WRK-NAI02-TKOH3HKNNUM     PIC X(03).
                       09  WRK-NAI02-TKOH4HKNNUM     PIC X(03).
                       09  WRK-NAI02-THYOJIKBN       PIC X(01).
      *
       01  WRK-HENSYU-AREA.
      *
           03  WRK-HONKA-TBL.
               05  WRK-HONKA-REC-G.
                   07  FILLER          PIC X(06) VALUE "1 À‹øÕ".
                   07  FILLER          PIC X(06) VALUE "2 ≤»¬≤".
               05  WRK-HONKA-REC-R     REDEFINES   WRK-HONKA-REC-G.
                   07  WRK-HONKA-REC   PIC X(06) OCCURS  2.
      *
           03  WRK-HJO-TBL.
               05  WRK-HJO-MAX         PIC 9(04).
               05  WRK-HJO-REC-G1.
                   07  FILLER          PIC X(10) VALUE "1 ø¶Ã≥".
                   07  FILLER          PIC X(10) VALUE "2 ≤º¡•".
                   07  FILLER          PIC X(10) VALUE "3 ƒÃ∂–".
                   07  FILLER          PIC X(10) VALUE "8 £≤≥‰".
                   07  FILLER          PIC X(10) VALUE "9 £±≥‰".
                   07  FILLER          PIC X(10) VALUE "A £±≥‰ø¶Ã≥".
                   07  FILLER          PIC X(10) VALUE "B £±≥‰≤º¡•".
                   07  FILLER          PIC X(10) VALUE "C £±≥‰ƒÃ∂–".
                   07  FILLER          PIC X(10) VALUE "D £≤≥‰ø¶Ã≥".
                   07  FILLER          PIC X(10) VALUE "E £≤≥‰≤º¡•".
                   07  FILLER          PIC X(10) VALUE "F £≤≥‰ƒÃ∂–".
               05  WRK-HJO-REC-R1      REDEFINES   WRK-HJO-REC-G1.
                   07  WRK-HJO-REC1    PIC X(10) OCCURS  11.
               05  WRK-HJO-REC-G2.
                   07  FILLER          PIC X(16) VALUE "0 Ãµ§∑".
                   07  FILLER          PIC X(16) VALUE "1 £±≥‰".
                   07  FILLER          PIC X(16) VALUE "2 £≤≥‰".
                   07  FILLER          PIC X(16) VALUE "3 £≥≥‰".
                   07  FILLER          PIC X(16) VALUE
                                                 "4 ≥∞£±≥‰ ∆˛£∞≥‰".
                   07  FILLER          PIC X(16) VALUE
                                                 "5 ≥∞£≤≥‰ ∆˛£±≥‰".
                   07  FILLER          PIC X(16) VALUE
                                                 "6 ≥∞£≥≥‰ ∆˛£≤≥‰".
               05  WRK-HJO-REC-R2      REDEFINES   WRK-HJO-REC-G2.
                   07  WRK-HJO-REC2    PIC X(16) OCCURS  7.
               05  WRK-HJO-REC-G3.
                   07  FILLER          PIC X(06) VALUE "1 ≤›¿«".
                   07  FILLER          PIC X(06) VALUE "2 »Û≤›".
               05  WRK-HJO-REC-R3      REDEFINES   WRK-HJO-REC-G3.
                   07  WRK-HJO-REC3    PIC X(06) OCCURS  2.
      *        œ∑øÕ§Œ ‰Ωı∂Ë ¨ƒ…≤√
               05  WRK-HJO-REC-G4.
                   07  FILLER          PIC X(06) VALUE "8 £≤≥‰".
                   07  FILLER          PIC X(06) VALUE "9 £±≥‰".
               05  WRK-HJO-REC-R4      REDEFINES   WRK-HJO-REC-G4.
                   07  WRK-HJO-REC4    PIC X(06) OCCURS  2.
      *        ∂¶∫—§Œ≤º¡•∏Â ‰Ωı∂Ë ¨ƒ…≤√
               05  WRK-HJO-REC-G5.
                   07  FILLER          PIC X(10) VALUE "2 ≤º¡•£≥∑Ó".
                   07  FILLER          PIC X(10) VALUE "8 £≤≥‰".
                   07  FILLER          PIC X(10) VALUE "9 £±≥‰".
                   07  FILLER          PIC X(10) VALUE "B £±≥‰≤º¡•".
                   07  FILLER          PIC X(10) VALUE "E £≤≥‰≤º¡•".
               05  WRK-HJO-REC-R5      REDEFINES   WRK-HJO-REC-G5.
                   07  WRK-HJO-REC5    PIC X(10) OCCURS  5.
      *        ¡•∞˜° £»£±£∏°•£±£∞∞ πﬂ°À
               05  WRK-HJO-REC-G1-2.
                   07  FILLER          PIC X(10) VALUE "1 ø¶Ã≥".
                   07  FILLER          PIC X(10) VALUE "2 ≤º¡•".
                   07  FILLER          PIC X(10) VALUE "3 ƒÃ∂–".
                   07  FILLER          PIC X(10) VALUE "7 £≥≥‰".
                   07  FILLER          PIC X(10) VALUE "9 £±≥‰".
                   07  FILLER          PIC X(10) VALUE "A £±≥‰ø¶Ã≥".
                   07  FILLER          PIC X(10) VALUE "B £±≥‰≤º¡•".
                   07  FILLER          PIC X(10) VALUE "C £±≥‰ƒÃ∂–".
                   07  FILLER          PIC X(10) VALUE "G £≥≥‰ø¶Ã≥".
                   07  FILLER          PIC X(10) VALUE "H £≥≥‰≤º¡•".
                   07  FILLER          PIC X(10) VALUE "I £≥≥‰ƒÃ∂–".
               05  WRK-HJO-REC-R1-2    REDEFINES   WRK-HJO-REC-G1-2.
                   07  WRK-HJO-REC1-2  PIC X(10) OCCURS  11.
      *        œ∑øÕ§Œ ‰Ωı∂Ë ¨ƒ…≤√° £»£±£∏°•£±£∞∞ πﬂ°À
               05  WRK-HJO-REC-G4-2.
                   07  FILLER          PIC X(06) VALUE "7 £≥≥‰".
                   07  FILLER          PIC X(06) VALUE "9 £±≥‰".
               05  WRK-HJO-REC-R4-2    REDEFINES   WRK-HJO-REC-G4-2.
                   07  WRK-HJO-REC4-2  PIC X(06) OCCURS  2.
      *        ∂¶∫—§Œ≤º¡•∏Â ‰Ωı∂Ë ¨ƒ…≤√° £»£±£∏°•£±£∞∞ πﬂ°À
               05  WRK-HJO-REC-G5-2.
                   07  FILLER          PIC X(10) VALUE "2 ≤º¡•£≥∑Ó".
                   07  FILLER          PIC X(10) VALUE "7 £≥≥‰".
                   07  FILLER          PIC X(10) VALUE "9 £±≥‰".
                   07  FILLER          PIC X(10) VALUE "B £±≥‰≤º¡•".
                   07  FILLER          PIC X(10) VALUE "H £≥≥‰≤º¡•".
               05  WRK-HJO-REC-R5-2      REDEFINES   WRK-HJO-REC-G5-2.
                   07  WRK-HJO-REC5-2    PIC X(10) OCCURS  5.
      *
      *        ∏Â¥¸π‚Œº‘§Œ ‰Ωı∂Ë ¨° £»£≤£∞°•£¥∞ πﬂ°À
               05  WRK-HJO-REC-G6.
                   07  FILLER          PIC X(10) VALUE "1 £±≥‰".
                   07  FILLER          PIC X(10) VALUE "3 £≥≥‰".
               05  WRK-HJO-REC-R6        REDEFINES   WRK-HJO-REC-G6.
                   07  WRK-HJO-REC6      PIC X(10) OCCURS  2.
      *
           03  WRK-KEI-TBL.
               05  WRK-KEI-REC-G.
                   07  FILLER          PIC X(06) VALUE "1 ∑—¬≥".
                   07  FILLER          PIC X(06) VALUE "2 «§∑—".
                   07  FILLER          PIC X(06) VALUE "3 ∆√ Ã".
               05  WRK-KEI-REC-R       REDEFINES   WRK-KEI-REC-G.
                   07  WRK-KEI-REC     PIC X(06) OCCURS  3.
               05  WRK-CONT-MAX        PIC 9(04).
      *
           03  WRK-HENYMD.
               05  WRK-HGO             PIC X(01).
               05  WRK-HYY             PIC Z9.
               05  FILLER              PIC X(01)   VALUE  ".".
               05  WRK-HMM             PIC Z9.
               05  FILLER              PIC X(01)   VALUE  ".".
               05  WRK-HDD             PIC Z9.
      *
           03  WRK-HENTIME.
               05  WRK-THH             PIC 99.
               05  FILLER              PIC X(01)   VALUE  ":".
               05  WRK-TMM             PIC 99.
      *
           03  WRK-KEI1                PIC X(06)   VALUE  "° ∑—°À".
           03  WRK-KEI2                PIC X(06)   VALUE  "° «§°À".
      *
           03  WRK-RATE-AREA.
               05  WRK-RATE-KBN        PIC X(02).
               05  WRK-RATE-SP         PIC X(01).
               05  WRK-RATE-EDIT.
                   07  WRK-RATE-EDITZ  PIC ZZZZZZZ.
                   07  WRK-RATE-TANI   PIC X(04).
               05  WRK-RATE-EDIT-R  REDEFINES    WRK-RATE-EDIT.
                   07  WRK-RATE-EDITR  PIC X(11).
      *
           03  TBL-MAX-KOH             PIC 9(02)  VALUE    60.
           03  TBL-MAX-HKN             PIC 9(02)  VALUE    40.
      *
       01  WRK-NENREI-AREA.
           03  WRK-YMDS1.
               05  WRK-YYS1        PIC 9(04).
               05  WRK-MMS1        PIC 9(02).
               05  WRK-DDS1        PIC 9(02).
           03  WRK-YMDS2.
               05  WRK-YYS2        PIC 9(04).
               05  WRK-MMS2        PIC 9(02).
               05  WRK-DDS2        PIC 9(02).
           03  WRK-NENREI.
               05  WRK-NENREI-YY       PIC 9(04).
               05  WRK-NENREI-MM       PIC 9(02).
               05  WRK-NENREI-DD       PIC 9(02).
      *   «ØŒ…Ωº®
       01  WRK-NENREI-G.
           03  WRK-NENREI-Z        PIC ZZ9.
           03  WRK-NENREI-MEI      PIC X(04).
       01  WRK-NENREI-GR           REDEFINES   WRK-NENREI-G.
           03  WRK-NENREI-ZN       PIC Z9.
           03  WRK-NENREI-MEIN     PIC X(08).
      *----(01.00.12) LINE ADD END   ---------------------------------
      *    »æ≥—¡¥≥— —¥π
       01  WRK-HENKAN-AREA.
           03  WRK-MAE-INPUT       PIC X(100).
           03  WRK-ATO-INPUT       PIC X(100).
           03  WRK-MAX             PIC 9(04).
      *
      *****************************************************************
      *    •’•°•§•Î•Ï•§•¢•¶•»
      *****************************************************************
      *
      *    •∑•π•∆•‡¥…Õ˝•ﬁ•π•ø
           COPY    "CPSYSKANRI.INC".
      *    æı¬÷æ Û
      *    COPY    "CPSK1018.INC".
      *    ∏∫Ã»ªˆÕ≥æ Û
      *    COPY    "CPSK1026.INC".
      *    ≥‰∞˙Œ®æ Û
      *****COPY    "CPSK1027.INC".
      *    º˛ ’ΩªΩÍ
           COPY    "CPSK1015.INC".
      *
      *    ΩªΩÍ•ﬁ•π•ø
       01  ADRS-REC.
           COPY    "CPADRS.INC".
      *
      *     ›∏±»÷πÊæ Û  *
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *
      *    ºı…’   *
       01  UKETUKE-REC.
           COPY    "CPUKETUKE.INC".
      *
      *     ›∏±º‘πÊ•ﬁ•π•ø
       01  HKNJAINF-REC.
           COPY    "CPHKNJAINF.INC".
      *
      *    ¥µº‘ ›∏±æ Û  *
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *    ¡»πÁ§ª∫Ó¿Æª˛ª»Õ—π‡Ã‹
           03  PTHKN-SBT          PIC X(01).
           03  PTHKN-SEIDO        PIC X(10).
      *
      *    ¥µº‘∏¯»Òæ Û  *
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *    ¡»πÁ§ª∫Ó¿Æª˛ª»Õ—π‡Ã‹
           03  PTKOH-SBT          PIC X(01).
           03  PTKOH-SEIDO        PIC X(10).
           03  PTKOH-HKNKOHKBN    PIC X(01).
           03  PTKOH-GENHKNNUM1   PIC X(03).
           03  PTKOH-GENHKNNUM2   PIC X(03).
           03  PTKOH-GENHKNNUM3   PIC X(03).
      *    ¥µº‘æ Û  *
       01  PTINF-REC.
           COPY "CPPTINF.INC".
      *
      *    ¥µº‘æ Û  *
      *01  LNK-PTINF-REC.
      *    COPY "CPPTINF.INC" REPLACING  //PTINF-// BY //LNK-PTINF-//.
      *
      *    µÏ¿´Õ˙ŒÚ   *
      *01  LNK-KYUSEIRRK-AREA.
      *    02  LNK-KYUSEIRRK-REC.
      *    COPY  "CPKYUSEIRRK.INC" REPLACING  //KYUSEI-//
      *                                    BY //LNK-KYU-//.
      *    ¥µº‘»÷πÊ —¥π  *
      *01  LNK-PTNUM-AREA.
      *    02  LNK-PTNUM-REC.
      *    COPY "CPPTNUM.INC" REPLACING //PTNUM-// BY //LNK-PTNUM-//.
      *
      *     ›∏±¡»§ﬂπÁ§Ô§ª
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    ¥µº‘œ´∫“ ›∏±æ Û
       01  PTRSIINF-REC.
           COPY    "CPPTRSIINF.INC".
      *----(01.00.15) LINE ADD START ---------------------------------
      *    øÕÃæ
       01  JINMEI-REC.
           COPY    "CPJINMEI.INC".
      *----(01.00.15) LINE ADD END   ---------------------------------
      *
      *    •—•È•·•ø•∆°º•÷•Î
       01  PARA-REC.
           COPY    "CPPARA.INC".
      *
      *****************************************************************
      *    •µ•÷•◊•ÌÕ—°°ŒŒ∞Ë
      *****************************************************************
      *
      *   ∆¸…’ —¥π•µ•÷
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    øÙª˙ —¥πŒŒ∞Ë
           COPY    "CPORCSNUM.INC".
      *   ¥µº‘»÷πÊ —¥π•µ•÷
           COPY    "CPORCSPTID.INC".
      *----(01.00.12) LINE ADD START ----------------------------------
      *
      *   ≤ËÃÃ∆¸…’ —¥π•µ•÷
          COPY    "CPORCSGDAY.INC".
      *----(01.00.12) LINE ADD END   ----------------------------------
      *
      *    ¡¥≥—•¡•ß•√•Ø•—•È•·•ø
           COPY    "CPORCSKANACHK.INC".
      *    ¡¥≥—•¡•ß•√•Ø•—•È•·•ø° ≥»ƒ•¥¡ª˙°À
           COPY    "CPORCSKANACHK2.INC".
      *
           COPY    "CPORCXKANACONV.INC".
      *
      *    £ƒ£¬∏°∫˜
           COPY    "MCPDATA.INC".
      *****COPY    "CPORCMCP.INC".
      *
      *****************************************************************
      *    œ¢ÕÌ°°ŒŒ∞Ë
      *****************************************************************
        LINKAGE                     SECTION.
      *
           COPY    "MCPAREA".
           COPY    "ORCA-SPA".
      *
           COPY    "LINKAREA".
      *
       01  SCRAREA.
           COPY    "P02.INC".
           COPY    "P02A.INC".
      *****COPY    "P02B.INC".
      *****COPY    "P02C.INC".
           COPY    "P02D.INC".
           COPY    "P02E.INC".
           COPY    "P02F.INC".
           COPY    "P014.INC".
           COPY    "P015.INC".
           COPY    "P98.INC".
           COPY    "P981.INC".
      *****COPY    "P99.INC".
           COPY    "P0201.INC".
           COPY    "P982.INC".
           COPY    "P100.INC".
           COPY    "P02X.INC".
           COPY    "P02S.INC".
           COPY    "P02Q.INC".
           COPY    "P02Q1.INC".
           COPY    "P02Y.INC".
           COPY    "P02Y1.INC".
           COPY    "P02G.INC".
           COPY    "P02G2.INC".
           COPY    "P02K.INC".
           COPY    "PERR.INC".
           COPY    "PID1.INC".
           COPY    "PATIENTGET.INC".
      *
       PROCEDURE                   DIVISION    USING
           MCPAREA
           SPAAREA
           LINKAREA
           SCRAREA.
      *
      *
      *****************************************************************
      *    ºÁ°°°°ΩËÕ˝
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  STS-AREA
           INITIALIZE                  CNT-AREA
           INITIALIZE                  WRK-AREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           MOVE    SPACE           TO  SPA-ERRCD
           MOVE    ZERO            TO  SPA-FLG-END
           MOVE    SPACE           TO  SPA-MCP-WIDGET
      *
           EVALUATE    MCP-STATUS      ALSO    MCP-EVENT
               WHEN    "LINK"          ALSO    ANY
                   PERFORM 100-INIT-SEC
      *    ≤ËÃÃ¡´∞‹
               WHEN     "PUTG"           ALSO   "CLICKED"
                   PERFORM 200-GMNSENI
      *    ∆˛Œœ
               WHEN      OTHER
                   PERFORM 200-ENTRY
           END-EVALUATE.
      *
      *    ≤ËÃÃ ‘Ω∏∏Â°¢…Ωº®§ÿ
           IF      SPA-FLG-END             =   ZERO
      ******** PERFORM 500-GMNHEN-SEC
               PERFORM 5001-MAPCUR-SEC
      *
           END-IF
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           .
           EXIT    PROGRAM
           .
      *****************************************************************
      *    ΩÈ¥¸°°ΩËÕ˝
      *****************************************************************
       100-INIT-SEC                    SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  STS-AREA
           INITIALIZE                  CNT-AREA
           INITIALIZE                  WRK-AREA
      *
      *    ΩÈ¥¸≤ËÃÃ•ª•√•»
           PERFORM 300-SCREEN-SEC
      *
           .
       100-INIT-EXT.
           EXIT.
      *****************************************************************
      *    ΩÈ¥¸≤ËÃÃΩËÕ˝
      *****************************************************************
       300-SCREEN-SEC              SECTION.
      *
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
           MOVE    ZERO            TO  SPA-FLG-END
      *
           EVALUATE    SPA-MOTOPG
      ****     ΩªΩÍ∏°∫˜§Ë§Í
      *        WHEN    "P99"
      *            IF      JPAR-POST     NOT =   SPACE
      *                MOVE    JPAR-POST   TO  SPA-GMN-POST
      *                MOVE    JPAR-EDITADRS-NAME
      *                                    TO  SPA-GMN-EDITADRS-NAME
      *                MOVE    42          TO  SPA-GMN-CUR
      *            ELSE
      *                MOVE    SPACE       TO  SPA-GMN-POST
      *                MOVE    40          TO  SPA-GMN-CUR
      ***********  END-IF
      *        ΩªΩÍ∏°∫˜§Ë§Í
               WHEN    "P98" 
                   IF      JPAR-POST   NOT =   SPACE
                       MOVE    JPAR-POST   TO  SPA-GMN-POST
                       MOVE    JPAR-EDITADRS-NAME
                                           TO  SPA-GMN-EDITADRS-NAME
                       MOVE    SPA-GMN-EDITADRS-NAME
                                           TO  SPA-MAE-ADRS
                       MOVE    42          TO  SPA-GMN-CUR
                   ELSE
                       MOVE    SPACE       TO  SPA-GMN-POST
                       MOVE    40          TO  SPA-GMN-CUR
                   END-IF
      *        ΩªΩÍ∞ÏÕ˜§Ë§Í
               WHEN    "P982"
                   IF     (SPA-GMN982-POST         =   SPACE )
                   AND    (SPA-GMN982-TOWNNAME     =   SPACE )
      *                ¡™¬Ú§ §∑
                       IF      SPA-GMN982-KBN      =   2
                           MOVE    41              TO  SPA-GMN-CUR
                       ELSE
                           MOVE    40              TO  SPA-GMN-CUR
                       END-IF
                   ELSE
                       IF      SPA-GMN982-POST     NOT =   SPACE
                           MOVE    SPA-GMN982-POST
                                                   TO  SPA-GMN-POST
                       END-IF
                       IF      SPA-GMN982-TOWNNAME     NOT =   SPACE
                           MOVE    SPA-GMN982-TOWNNAME
                                               TO  SPA-GMN-EDITADRS-NAME
                       END-IF
                       MOVE    SPA-GMN-POST    TO  SPA-MAE-POST
                       MOVE    42              TO  SPA-GMN-CUR
                   END-IF
                   MOVE    SPA-GMN-EDITADRS-NAME
                                               TO  SPA-MAE-ADRS
                   MOVE    ZERO                TO  SPA-GMN982-KBN
      *        ∆ÛΩ≈≈–œø≥Œ«ß≤ËÃÃΩËÕ˝
               WHEN    "P02A"
      *             ø∑µ¨§«•Í•π•»…Ωº®ª˛§Œ§ﬂ
                   IF      (SPA-P02G-FLG       =   2 )
                       PERFORM 41013-GRPPTNAME-CHK-SEC
                   END-IF
                   CONTINUE
      *        œ´∫“ ›∏±ππø∑≤ËÃÃΩËÕ˝
               WHEN    "P02D"
                   PERFORM 4910-RSKOH-PARAOUT-SEC
      *        •´• ª·Ãæ∏°∫˜
               WHEN    "P100"
                   PERFORM 3010-P100-HEN-SEC
      *        ¥µº‘ £ºÃ
               WHEN    "P02E"
      *             ›∏±¡»πÁ§ª∫Ó¿Æ
                   PERFORM 4503-HKNCOMBI-SYORI-SEC
                   PERFORM 310-SPASET-SEC
                   MOVE    1                  TO  SPA-GMN-CUR
      *        ¥µº‘ £ºÃ
               WHEN    "P02G"
      *             ›∏±¡»πÁ§ª∫Ó¿Æ
                   PERFORM 4503-HKNCOMBI-SYORI-SEC
                   PERFORM 310-SPASET-SEC
                   MOVE    1                  TO  SPA-GMN-CUR
      *        ≥Œ«ß•·•√•ª°º•∏
               WHEN    "PID1"
                   PERFORM 3001-PID1-SYORI-SEC
      *
      *        ΩÈ¥¸≤ËÃÃ ‘Ω∏
               WHEN    OTHER
      *             ›∏±°¶∏¯»Ò ‘Ω∏ΩËÕ˝
                   PERFORM 310-SPASET-SEC
                   MOVE    1                  TO  SPA-GMN-CUR
           END-EVALUATE
      *
           .
       300-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    •´• ª·Ãæ∏°∫˜≤ËÃÃ§Ë§ÍΩËÕ˝
      *****************************************************************
       3010-P100-HEN-SEC              SECTION.
      *
           IF    ( SPA-GMN-P100-FLG-BTN  NOT =   ZERO )
               MOVE    SPA-GMN-P100-KAKUTEI-NAME
                                           TO  SPA-GMN-NAME
                                               SPA-GMN-OLD-NAME
                                               SPA-GMN-NAMEH
      *        ¿§¬”ºÁÃæ
               IF  SPA-GMN-SETAINUSI      =   SPACE
                   IF      SPA-NAI-SETAIKBN-FLG    =   "1"
                       MOVE    SPA-GMN-NAME    TO  SPA-GMN-SETAINUSI
                   END-IF
               END-IF
           END-IF
      *
           MOVE    2                   TO  SPA-GMN-CUR
           .
       3010-P100-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ≥Œ«ß≤ËÃÃ§Ë§ÍΩËÕ˝
      *****************************************************************
       3001-PID1-SYORI-SEC              SECTION.
      *
           EVALUATE    SPA-PIDCD
               WHEN    "0104"
               WHEN    "0105"
               WHEN    "0110"
      *             ›∏±Ω≈ £ΩËÕ˝
                   CALL    "ORCSP03A"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
               WHEN    "0111"
      *            œ∑øÕ∏¯»Ò£≤≥‰§Ú£≥≥‰§ÿ
               IF      (SPA-PTKOH-MAX      >=  TBL-MAX-KOH )
                   MOVE    "0106"          TO  SPA-ERRCD
               ELSE
                   MOVE    ZERO                TO  SPA-KOH-ADD
                   CALL    "ORCSP03B"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
               END-IF
               WHEN    "0106"
               WHEN    "0107"
      *            ∏¯»ÒΩ≈ £ΩËÕ˝
               IF      (SPA-PTKOH-MAX      >=  TBL-MAX-KOH )
                   MOVE    "0106"          TO  SPA-ERRCD
               ELSE
                   MOVE    ZERO                TO  SPA-KOH-ADD
                   CALL    "ORCSP03B"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
      *            œ∑øÕ∏¯»Òƒ…≤√° £»£±£¥°•£±£∞≤˛¿µ¬–±˛°À
                   IF       SPA-KOH-ADD        =   1
      *                ∫«ΩÈ§Œ£±π‘§Úƒ…≤√§π§Î
                       MOVE    ZERO            TO  SPA-HKNKOH-FLG
                       PERFORM 4104-KOH-ADD-SEC
      *                ∏¯»ÒΩ≈ £ΩËÕ˝
                       CALL    "ORCSP03B"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
                   END-IF
               END-IF
      *         ›∏±Ω™ŒªΩËÕ˝
               WHEN    "0201"
               WHEN    "0203"
                   CALL    "ORCSP03A"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
               WHEN    "0202"
               WHEN    "0204"
                   IF      SPA-HKN-IDX1        =   ZERO
      *                ø∑µ¨§Œª˛°¢£±π‘≥´§±§Î
                       PERFORM 410311-HKNTBL-INS-SEC
                       MOVE    1                   TO  IDX
                   ELSE
                       MOVE    SPA-HKN-IDX1        TO  IDX
                   END-IF
                   PERFORM 410312-HKN-SPATBL-SET-SEC
                   CALL    "ORCSP03A"          USING   SPA-AREA
                                                       SPA-P02SCRAREA
                                                       SPA-P02KYOUTU
           END-EVALUATE
      *
           MOVE    SPACE               TO  SPA-PIDCD
      *
           .
       3001-PID1-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    •π•—ΩÈ¥¸ ‘Ω∏ΩËÕ˝
      *****************************************************************
       310-SPASET-SEC              SECTION.
      *
      *    «ØŒ∑◊ªª
           IF     (SPA-NAI-BIRTHDAY    =   SPACE  OR  ZERO )  OR
                  (SPA-BYMD-70     NOT =   ZERO            )
               CONTINUE
           ELSE
               PERFORM 410121-NENREI-SET-SEC
           END-IF
      *
      *    •∆°º•÷•Î∆‚§Œ ›∏±æ Û§ÀÃææŒ§Ú ‘Ω∏§π§Î
           PERFORM 3100-HKNTBL-KBNHEN-SEC
      *     ›∏±…Ωº®œ¢»÷
           MOVE    1                   TO  SPA-NAI-HKNSTR
      *     ›∏±æ Û£‘£¬£Ã§´§È ‘Ω∏
           PERFORM 3101-HKN-TBL-SPA-SEC
      *
      *    ∏¯»Ò…Ωº®œ¢»÷≥´ªœ
           MOVE    1                   TO  SPA-NAI-KOHSTR
      *    ∏¯»Ò£‘£¬£Ã§´§È ‘Ω∏
           PERFORM 3101-KOH-TBL-SPA-SEC
      *
      *     ›∏±¡»πÁ§ª…Ωº®° ∏Ω∫ﬂ¬–æ› ¨§Œ§ﬂ°À
           PERFORM 3103-HKNCOMB-PARA-SEC
      *
      *
           .
       310-SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    À‹øÕ≤»¬≤∂Ë ¨≈˘§ŒÃææŒ ‘Ω∏ΩËÕ˝
      *****************************************************************
       3100-HKNTBL-KBNHEN-SEC            SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX         >   SPA-PTHKN-MAX
      *
      *        À‹øÕ≤»¬≤
               PERFORM VARYING     IDT     FROM    1  BY  1
                       UNTIL       IDT     >   2
                   IF      WRK-HONKA-REC (IDT)(1:1)
                                           =   SPA-PTHKN-HONKZKKBN(IDX)
                       MOVE    WRK-HONKA-REC (IDT)(3:)
                                           TO  SPA-PTHKN-HONKZKKBN-MEI
                                                                  (IDX)
                   END-IF
               END-PERFORM
      *
      *        ∑—¬≥∂Ë ¨
               IF      SPA-PTHKN-HKNNUM (IDX)  =   "003"
                   MOVE    3                   TO  WRK-CONT-MAX
               ELSE
                   MOVE    2                   TO  WRK-CONT-MAX
               END-IF
               PERFORM VARYING IDT     FROM    1  BY  1
                       UNTIL   IDT     >   WRK-CONT-MAX
                   IF      WRK-KEI-REC (IDT)(1:1)
                                           =   SPA-PTHKN-CONTKBN (IDX)
                       MOVE    WRK-KEI-REC (IDT)(3:)
                                               TO  SPA-PTHKN-CONTKBN-MEI
                                                                  (IDX)
                   END-IF
               END-PERFORM
      *
      *        …È√¥≥‰πÁ
               EVALUATE    SPA-PTHKN-HKNNUM (IDX)
      *        ¡•∞˜
               WHEN    "002"
                   IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20021001") AND
                          (SPA-BYMD-70             >   ZERO      )  AND
                          (SPA-PTHKN-TEKSTYMD(IDX) >=  SPA-BYMD-70)
                       MOVE    4               TO  IDY
                       MOVE    11              TO  WRK-HJO-MAX
                   ELSE
                       MOVE    1               TO  IDY
                       MOVE    3               TO  WRK-HJO-MAX
                   END-IF
      *************MOVE    ZERO                TO  SPA-GMN-HOJO-MAX
                   PERFORM VARYING     IDT     FROM    IDY BY  1
                           UNTIL       IDT     >   WRK-HJO-MAX
      *              £»£±£∏°•£±£∞ ≤˛¿µ
                     IF    ((SPA-PTHKN-TEKSTYMD(IDX) =   SPACE )  AND
                            (SPA-SYSYMD              >=  "20061001")) OR
                            (SPA-PTHKN-TEKSTYMD(IDX) >=  "20061001")
                       IF      WRK-HJO-REC1-2 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC1-2 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    WRK-HJO-MAX     TO  IDT
                       END-IF
                     ELSE
                       IF      WRK-HJO-REC1 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC1 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    WRK-HJO-MAX     TO  IDT
                       END-IF
                     END-IF
                   END-PERFORM
      *        πÒ ›
               WHEN    "060"
               WHEN    "068"
                   PERFORM VARYING     IDT     FROM    1  BY  1
                           UNTIL       IDT     >   7
                       IF      WRK-HJO-REC2 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC2 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    7           TO  IDT
                       END-IF
                   END-PERFORM
      *        ∂¶∫—
               WHEN    "031"
               WHEN    "032"
               WHEN    "033"
               WHEN    "034"
                   IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20021001") AND
                          (SPA-BYMD-70             >   ZERO      )  AND
                          (SPA-PTHKN-TEKSTYMD(IDX) >=  SPA-BYMD-70)
                       MOVE    2               TO  IDY
                       MOVE    5               TO  WRK-HJO-MAX
                   ELSE
                       MOVE    1               TO  IDY
                       MOVE    1               TO  WRK-HJO-MAX
                   END-IF
                   PERFORM VARYING     IDT     FROM    IDY BY  1
                           UNTIL       IDT     >   WRK-HJO-MAX
      *              £»£±£∏°•£±£∞ ≤˛¿µ
                     IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20061001")
                        OR ((SPA-PTHKN-TEKSTYMD(IDX) =   SPACE  )  AND
                            (SPA-SYSYMD              >=  "20061001"))
                       IF      WRK-HJO-REC5-2 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC5-2 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    WRK-HJO-MAX     TO  IDT
                       END-IF
                     ELSE
                       IF      WRK-HJO-REC5 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC5 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    WRK-HJO-MAX     TO  IDT
                       END-IF
                     END-IF
                   END-PERFORM
      *£»£≤£∞°•£¥≤˛¿µ
      *        ∏Â¥¸π‚Œº‘
               WHEN    "039"
               WHEN    "040"
                   PERFORM VARYING     IDT     FROM    1  BY  1
                           UNTIL       IDT     >   2
                       IF      WRK-HJO-REC6 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                           MOVE    WRK-HJO-REC6 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                           MOVE    2           TO  IDT
                       END-IF
                   END-PERFORM
      *        §Ω§Œ¬æ
               WHEN    OTHER
      *            º´»Ò
                   IF      SPA-PTHKN-HKNNUM (IDX)(1:2) =   "98"
                       PERFORM VARYING     IDT     FROM    1  BY  1
                               UNTIL       IDT     >   2
                           IF      WRK-HJO-REC3 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                               MOVE    WRK-HJO-REC3 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                               MOVE    2           TO  IDT
                           END-IF
                       END-PERFORM
                   ELSE
      *                £»£±£¥°•£±£∞ ≤˛¿µ§Ë§Í
                       IF      SPA-PTHKN-TEKSTYMD(IDX) >=  "20021001"
                           PERFORM 31001-HKNTBL-RJNHEN-SEC
                       END-IF
                   END-IF
               END-EVALUATE
           END-PERFORM
      *
           .
       3100-HKNTBL-KBNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    œ∑øÕ ‰Ωı∂Ë ¨ ‘Ω∏ΩËÕ˝
      *****************************************************************
       31001-HKNTBL-RJNHEN-SEC            SECTION.
      *
      *    ≈¨Õ—≥´ªœ∆¸§¨£∑£∞∫–∞ æÂ§«°¢œ´∫“°¶º£∏≥°¶º´»Ò
           IF      (SPA-PTHKN-TEKSTYMD(IDX)    >=  SPA-BYMD-70)  AND
                   (SPA-BYMD-70                >   ZERO      )  AND
                   (SPA-PTHKN-HKNNUM(IDX)(1:1) NOT =   "9")
               PERFORM VARYING     IDT     FROM    1  BY  1
                       UNTIL       IDT     >   2
      *          £»£±£∏°•£±£∞ ≤˛¿µ§Ë§Í
                 IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20061001")
                    OR ((SPA-PTHKN-TEKSTYMD(IDX) =   SPACE  )  AND
                        (SPA-SYSYMD              >=  "20061001"))
                   IF      WRK-HJO-REC4-2 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                       MOVE    WRK-HJO-REC4-2 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                       MOVE    2               TO  IDT
                   END-IF
                 ELSE
                   IF      WRK-HJO-REC4 (IDT)(1:1)
                                           =   SPA-PTHKN-HOJOKBN(IDX)
                       MOVE    WRK-HJO-REC4 (IDT)(3:)
                                               TO  SPA-PTHKN-HOJOKBN-MEI
                                                                 (IDX)
                       MOVE    2               TO  IDT
                   END-IF
                 END-IF
               END-PERFORM
           END-IF
           .
       31001-HKNTBL-RJNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±æ Û•—•È•·•ø•’•°•§•Î∏°∫˜ΩËÕ˝
      *****************************************************************
       3101-HKN-TBL-SPA-SEC            SECTION.
      *
           INITIALIZE                  SPA-GMN-HKN-AREA
           MOVE    ZERO                TO  FLG-CHK
           IF      SPA-NAI-HKNSTR      =   ZERO
               CONTINUE
           ELSE
               PERFORM VARYING IDX     FROM    SPA-NAI-HKNSTR   BY  1
                   UNTIL      (IDX         >   SPA-PTHKN-MAX )  OR
                              (FLG-CHK NOT =   ZERO )
                   IF      SPA-PTHKN-SAKJOKBN (IDX)    =   SPACE
      *                £—£“•«°º•ø§Œ…Ωº®
                       IF     (SPA-QR-FLG          =   1   )  AND
                              (SPA-QR-HKNID    NOT =   ZERO )  AND
                              (SPA-QR-HKNID    NOT =   SPA-PTHKN-HKNID
                                                               (IDX))
                           CONTINUE
                       ELSE
                           MOVE    IDX             TO  SPA-NAI-HKNSTR
                           PERFORM 3101-HOKEN-HEN-SEC
                           MOVE    1               TO  FLG-CHK
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *    ¬–æ›§Œ ›∏±§¨§ §§ª˛°¢ø∑µ¨§»§π§Î
           IF      FLG-CHK             =   ZERO
               MOVE    ZERO                TO  SPA-NAI-HKNSTR
           END-IF
      *
           .
       3101-HKN-TBL-SPA-EXT.
           EXIT.
      *****************************************************************
      *    ∏¯»Òæ Û•—•È•·•ø•’•°•§•Î∏°∫˜ΩËÕ˝
      *****************************************************************
       3101-KOH-TBL-SPA-SEC        SECTION.
      *
           INITIALIZE                  SPA-GMN-KOH-AREA
           MOVE    ZERO                TO  IDY
           MOVE    ZERO                TO  FLG-CHK
           MOVE    ZERO                TO  SPA-NAI-KOHEND
           IF      SPA-NAI-KOHSTR      =   ZERO
               CONTINUE
           ELSE
      *
           PERFORM VARYING     IDX     FROM    SPA-NAI-KOHSTR BY  1
                   UNTIL      (IDX         >   SPA-PTKOH-MAX )  OR
                              (IDY         >=  3    )
               IF      SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE
                   IF      IDY             =   ZERO
                       MOVE    IDX             TO  SPA-NAI-KOHSTR
                   END-IF
                   MOVE    IDX                 TO  SPA-NAI-KOHEND
                   ADD     1                   TO  IDY
                   MOVE    1                   TO  FLG-CHK
                   PERFORM 3102-KOUHI-HEN-SEC
               END-IF
           END-PERFORM
           END-IF
      *
      *    ¬–æ›§Œ ›∏±§¨§ §§ª˛°¢ø∑µ¨§»§π§Î
           IF      FLG-CHK             =   ZERO
               MOVE    ZERO                TO  SPA-NAI-KOHSTR
               MOVE    ZERO                TO  SPA-NAI-KOHEND
           END-IF
      *
           .
       3101-KOH-TBL-SPA-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏± ‘Ω∏ΩËÕ˝
      *****************************************************************
       3101-HOKEN-HEN-SEC              SECTION.
      *
           MOVE    SPA-PTHKN-HKNNUM (IDX)  TO  SPA-GMN-HKNNUM
      *     ›∏±£…£ƒ° œ´∫“ ›∏±§Œ§»§Œ¥ÿœ¢°À
           MOVE    SPA-PTHKN-HKNID  (IDX)  TO  SPA-NAI-HKNID
      *
           MOVE    SPA-PTHKN-HKNJANUM(IDX) TO  SPA-GMN-HKNJANUM
           MOVE    SPA-PTHKN-HIHKNJANAME (IDX)
                                           TO  SPA-GMN-HIHKNJANAME
           MOVE    SPA-PTHKN-HONKZKKBN (IDX)
                                           TO  SPA-GMN-HONKZKKBN
           MOVE    SPA-GMN-HONKZKKBN       TO  SPA-MAE-HONKZKKBN
           MOVE    SPA-PTHKN-HOJOKBN (IDX) TO  SPA-GMN-HOJOKBN
           MOVE    SPA-PTHKN-CONTKBN (IDX) TO  SPA-GMN-CONTKBN
           MOVE    SPA-PTHKN-KIGO    (IDX) TO  SPA-GMN-KIGO
           MOVE    SPA-PTHKN-NUM     (IDX) TO  SPA-GMN-NUM
      *
           MOVE    SPA-PTHKN-HKN-SBTKBN(IDX)
                                           TO  SPA-NAI-PTHKN-SBTKBN
           MOVE    SPA-PTHKN-SAKJOKBN(IDX) TO  SPA-NAI-SAKJOKBN
           MOVE    SPA-PTHKN-SKKGETYMD  (IDX)
                                           TO  SPA-NAI-SKKGETYMD
           MOVE    SPA-PTHKN-TEKSTYMD(IDX) TO  SPA-NAI-HTEKSTYMD
           MOVE    SPA-PTHKN-TEKEDYMD(IDX) TO  SPA-NAI-HTEKEDYMD
           MOVE    SPA-PTHKN-KAKUNINYMD (IDX)
                                           TO  SPA-NAI-HKAKUNINYMD
      *
           MOVE    SPA-PTHKN-SKKGETYMDW (IDX)
                                           TO  SPA-GMN-SKKGETYMD
           MOVE    SPA-PTHKN-TEKSTYMDW (IDX)
                                           TO  SPA-GMN-HTEKSTYMD
           MOVE    SPA-PTHKN-TEKEDYMDW (IDX)
                                           TO  SPA-GMN-HTEKEDYMD
           MOVE    SPA-PTHKN-KAKUNINYMDW (IDX)
                                           TO  SPA-GMN-HKAKUNINYMD
      *
      *    ¡∞ ›¬∏
           MOVE    SPA-PTHKN-HKNNUM  (IDX) TO  SPA-MAE-HKNNUM
           MOVE    SPA-PTHKN-HKNJANUM(IDX) TO  SPA-MAE-HKNJANUM
           MOVE    SPA-PTHKN-HOJOKBN (IDX) TO  SPA-MAE-HOJOKBN
           MOVE    SPA-PTHKN-MAEKAKUNINYMD (IDX)
                                           TO  SPA-MAE-HKAKUNINYMD
           MOVE    SPA-PTHKN-MAEKAKUNINYMDW(IDX)
                                           TO  SPA-MAE-HKAKUNINYMDW
           MOVE    SPA-PTHKN-KIGO    (IDX) TO  SPA-OLD-KIGO
           MOVE    SPA-PTHKN-NUM     (IDX) TO  SPA-OLD-NUM
           MOVE    SPA-PTHKN-KIGO    (IDX) TO  SPA-MAE-KIGO
           MOVE    SPA-PTHKN-NUM     (IDX) TO  SPA-MAE-NUM
           MOVE    SPA-PTHKN-KIGO-KEIFLG (IDX)
                                           TO  SPA-KIGO-KEIFLG
           MOVE    SPA-PTHKN-NUM-KEIFLG (IDX)
                                           TO  SPA-NUM-KEIFLG
      *    ππø∑¡∞§Œµ≠πÊ∂ı«Ú•¡•ß•√•Ø§œ≈ˆ∆¸Õ≠∏˙§Œ§‚§Œ
           IF      FLG-TOUROKU     NOT =   ZERO
               IF      (SPA-PTHKN-TEKEDYMD(IDX)  <=  SPA-SYSYMD )
                   MOVE    1               TO  SPA-KIGO-KEIFLG
                   MOVE    1               TO  SPA-NUM-KEIFLG
               END-IF
           END-IF
      *    ∏Â¥¸π‚Œº‘∑Ÿπ
           MOVE    SPA-PTHKN-ROU-KEIFLG (IDX)
                                       TO  SPA-ROU-KEIFLG
      *    ø∑µ¨∞ ≥∞§œ•¡•ß•√•Ø∫—§ﬂ§»§π§Î
           IF      SPA-PTHKN-SINKIKBN (IDX)    =   SPACE
               MOVE    1                   TO  SPA-ROU-KEIFLG
           END-IF
      *!!
           MOVE    SPA-PTHKN-KEIFLG(IDX)   TO  SPA-HKNJA-KEIFLG
      *    ≥Œ«ß«Ø∑Ó∆¸
           MOVE    SPA-PTHKN-KAKUINFLG(IDX) TO  SPA-HKN-KAKUINFLG
      *
      *     ›∏±º‘»÷πÊ°°∏°∫˜•¡•ß•√•Ø
           INITIALIZE                    HKNJAINF-REC
           MOVE    SPA-HOSPNUM           TO  HKNJA-HOSPNUM
           MOVE    SPA-GMN-HKNJANUM      TO  HKNJA-HKNJANUM
      *
           MOVE    HKNJAINF-REC          TO  MCPDATA-REC
           MOVE    "tbl_hknjainf"        TO  MCP-TABLE
           MOVE    "key"                 TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknjainf"        TO  MCP-TABLE
               MOVE    "key"                 TO  MCP-PATHNAME
               PERFORM 900-HKNJAINF-READ-SEC
           ELSE
               INITIALIZE                  HKNJAINF-REC
               MOVE    1               TO  FLG-HKNJAINF
           END-IF
           MOVE    "tbl_hknjainf"        TO  MCP-TABLE
           MOVE    "key"                 TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *     ›∏±º‘»÷πÊ§¢§Í
           IF      FLG-HKNJAINF        =   ZERO
               MOVE    HKNJA-HKNJANAME     TO  SPA-HKNJA-HKNJANAME
               MOVE    HKNJA-ADRS          TO  SPA-HKNJA-ADRS
               MOVE    HKNJA-BANTI         TO  SPA-HKNJA-BANTI
               MOVE    HKNJA-TEL           TO  SPA-HKNJA-TEL
      *
               MOVE    HKNJA-IDOYMD        TO  SPA-HKNJA-IDOYMD
      *!       MOVE    SPA-PTHKN-KEIFLG(IDX)
      *!                                   TO  SPA-HKNJA-KEIFLG
           ELSE
               MOVE    SPACE               TO  SPA-HKNJA-HKNJANAME
               MOVE    SPACE               TO  SPA-HKNJA-ADRS
               MOVE    SPACE               TO  SPA-HKNJA-BANTI
               MOVE    SPACE               TO  SPA-HKNJA-TEL
      *
               MOVE    SPACE               TO  SPA-HKNJA-IDOYMD
      *!!      MOVE    SPACE               TO  SPA-HKNJA-KEIFLG
           END-IF
      *
      *     ›∏±æ Û
           MOVE    SPA-GMN-HKNNUM      TO  WRK-HKNNUM
           MOVE    SPA-NAI-HTEKSTYMD   TO  WRK-TEKSTYMD
           MOVE    SPA-NAI-HTEKEDYMD   TO  WRK-TEKEDYMD
           MOVE    ZERO                TO  WRK-PAYKBN
           PERFORM 31012-HKNNUM-SET-SEC
           IF      WRK-HKNKOHSBTKBN    NOT =   SPACE
               MOVE    WRK-TANSEIDONAME    TO  SPA-GMN-HKNNUMMEI
               MOVE    WRK-HKNKOHSBTKBN    TO  SPA-NAI-PTHKN-SBTKBN
           END-IF
      *****PERFORM VARYING     IDX     FROM    1   BY  1
      *            UNTIL       IDX     >   SPA-GMN-HKNMAX
      *        IF      SPA-GMN-HKNNUML (IDX)   =   SPA-GMN-HKNNUM
      *            MOVE    SPA-GMN-HKNNUMLST (IDX)
      *                                        TO  SPA-GMN-HKNNUM-G
      *            º± Ã
      *            MOVE    SPA-NAI-HKNSBTKBN (IDX)
      *                                        TO  SPA-NAI-PTHKN-SBTKBN
      *            MOVE    SPA-GMN-HKNMAX      TO  IDX
      *        END-IF
      *****END-PERFORM
      *
      *    À‹øÕ≤»¬≤∂Ë ¨≈˘
           PERFORM 31011-HKN-HEN-SEC
      *
      *    œ´∫“ ›∏±§Œ»÷πÊ¿ﬂƒÍ
           IF      SPA-GMN-HKNNUM      =   "971"
                                       OR  "973"
               PERFORM 310111-PARA-RSIHKN-SET-SEC
           END-IF
      *
           .
       3101-HOKEN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±∏¯»Ò∂Ë ¨ ‘Ω∏ΩËÕ˝
      *****************************************************************
       31012-HKNNUM-SET-SEC           SECTION.
      *
           INITIALIZE                  HKNNUM-REC
           MOVE    SPA-HOSPNUM         TO  HKN-HOSPNUM
           MOVE    WRK-HKNNUM          TO  HKN-HKNNUM
           IF      WRK-PAYKBN          =   SPACE
               MOVE    ZERO                TO  HKN-PAYKBN
           ELSE
               MOVE    WRK-PAYKBN          TO  HKN-PAYKBN
           END-IF
           MOVE    WRK-TEKSTYMD        TO  HKN-TEKSTYMD
           MOVE    WRK-TEKEDYMD        TO  HKN-TEKEDYMD
      *
           MOVE    HKNNUM-REC          TO  MCPDATA-REC
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknnum"        TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 921-HKNNUM-NEXT-SEC
           ELSE
               INITIALIZE              HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           MOVE    SPACE               TO  WRK-HKNKOHSBTKBN
           MOVE    SPACE               TO  WRK-TANSEIDONAME
           IF      FLG-HKNNUM          =   ZERO
               IF     (WRK-TEKSTYMD        >=  HKN-TEKSTYMD )  AND
                      (WRK-TEKEDYMD        <=  HKN-TEKEDYMD )
                   MOVE    HKN-HKNKOHSBTKBN    TO  WRK-HKNKOHSBTKBN
                   MOVE    HKN-TANSEIDONAME    TO  WRK-TANSEIDONAME
               END-IF
           END-IF
      *
           .
       31012-HKNNUM-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    À‹øÕ≤»¬≤∂Ë ¨≈˘ ‘Ω∏ΩËÕ˝
      *****************************************************************
       31011-HKN-HEN-SEC      SECTION.
      *
      *    À‹øÕ≤»¬≤
           MOVE    ZERO                TO  SPA-GMN-HONKZK-MAX
           PERFORM VARYING     IDT     FROM    1  BY  1
                   UNTIL       IDT     >   2
               MOVE    WRK-HONKA-REC (IDT)
                                       TO  SPA-GMN-HONKZKKBNL (IDT)
               MOVE    IDT             TO  SPA-GMN-HONKZK-MAX
               IF      SPA-GMN-HONKZKKBNL (IDT)(1:1)
                                           =   SPA-GMN-HONKZKKBN
                   MOVE    SPA-GMN-HONKZKKBNL (IDT)
                                           TO  SPA-GMN-HONKZKKBN-G
               END-IF
      *        º´¥±§œÀ‹øÕ§Œ§ﬂ
               IF      SPA-GMN-HKNNUM      =   "007"
      *        ∏¯≥≤ ›∏±§œÀ‹øÕ§Œ§ﬂ
                                           OR  "975"
      *        ∏Â¥¸π‚Œº‘§œÀ‹øÕ§Œ§ﬂ
                                           OR  "040"
                                           OR  "039"
                   MOVE    2               TO  IDT
               END-IF
           END-PERFORM
           IF      SPA-GMN-HONKZKKBN   =   SPACE
               MOVE    SPACE           TO  SPA-GMN-HONKZKKBN-G
           END-IF
      *
      *    ∑—¬≥∂Ë ¨
           IF    ( SPA-NAI-PTHKN-SBTKBN    NOT =   "1"  ) OR
                 ( SPA-GMN-HKNNUM          =   "060"
                                           OR  "067"
      *              ∆√ ÃŒ≈Õ‹»Òƒ…≤√
                                           OR  "068"
                                           OR  "069"
      *              ∏Â¥¸π‚Œº‘ƒ…≤√
                                           OR  "039"
                                           OR  "040" )
               MOVE    ZERO                TO  SPA-GMN-CONT-MAX
               MOVE    SPACE               TO  SPA-GMN-CONTKBN-G
           ELSE
               IF      SPA-GMN-HKNNUM      =   "002"
                   MOVE    3               TO  WRK-CONT-MAX
               ELSE
                   MOVE    2               TO  WRK-CONT-MAX
               END-IF
               PERFORM VARYING IDT     FROM    1  BY  1
                       UNTIL   IDT     >   WRK-CONT-MAX
                   MOVE    WRK-KEI-REC (IDT)
                                           TO  SPA-GMN-CONTKBNL (IDT)
                   IF      WRK-KEI-REC (IDT)(1:1)
                                           =   SPA-GMN-CONTKBN
                       MOVE    SPA-GMN-CONTKBNL (IDT)
                                               TO  SPA-GMN-CONTKBN-G
                   END-IF
                   MOVE    IDT             TO  SPA-GMN-CONT-MAX
               END-PERFORM
           END-IF
      *
      *    …È√¥≥‰πÁ
           EVALUATE    SPA-GMN-HKNNUM
      *        ¡•∞˜
               WHEN    "002"
                   IF     (SPA-NAI-HTEKSTYMD       >=  "20021001") AND
                          (SPA-BYMD-70             >   ZERO      )  AND
                          (SPA-NAI-HTEKSTYMD       >=  SPA-BYMD-70)
                       MOVE    4               TO  IDY
                       MOVE    11              TO  WRK-HJO-MAX
                   ELSE
                       MOVE    1               TO  IDY
                       MOVE    3               TO  WRK-HJO-MAX
                   END-IF
                   MOVE    ZERO                TO  SPA-GMN-HOJO-MAX
                   PERFORM VARYING     IDT     FROM    IDY BY  1
                           UNTIL       IDT     >   WRK-HJO-MAX
                       ADD     1           TO  SPA-GMN-HOJO-MAX
      *            £»£±£∏°•£±£∞ ≤˛¿µ§Ë§Í
                       IF     (SPA-NAI-HTEKSTYMD   >=  "20061001" )
                          OR ((SPA-NAI-HTEKSTYMD   =   SPACE  )  AND
                              (SPA-SYSYMD          >=  "20061001"))
                           MOVE    WRK-HJO-REC1-2 (IDT)
                                           TO  SPA-GMN-HOJOKBNL
                                                    (SPA-GMN-HOJO-MAX)
                       ELSE
                           MOVE    WRK-HJO-REC1 (IDT)
                                           TO  SPA-GMN-HOJOKBNL
                                                    (SPA-GMN-HOJO-MAX)
                       END-IF
                   END-PERFORM
      *        πÒ ›
               WHEN    "060"
               WHEN    "068"
                   PERFORM VARYING   IDT     FROM    1  BY  1
                         UNTIL       IDT     >   7
                       MOVE    WRK-HJO-REC2 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                       MOVE    IDT         TO  SPA-GMN-HOJO-MAX
                   END-PERFORM
      *        ∂¶∫—
               WHEN    "031"
               WHEN    "032"
               WHEN    "033"
               WHEN    "034"
                   IF     (SPA-PTHKN-TEKSTYMD(IDX) >=  "20021001") AND
                          (SPA-BYMD-70             >   ZERO      )  AND
                          (SPA-PTHKN-TEKSTYMD(IDX) >=  SPA-BYMD-70)
                       MOVE    2               TO  IDY
                       MOVE    5               TO  WRK-HJO-MAX
                   ELSE
                       MOVE    1               TO  IDY
                       MOVE    1               TO  WRK-HJO-MAX
                   END-IF
                   MOVE    ZERO                TO  SPA-GMN-HOJO-MAX
                   PERFORM VARYING     IDT     FROM    IDY BY  1
                           UNTIL       IDT     >   WRK-HJO-MAX
                       ADD     1           TO  SPA-GMN-HOJO-MAX
      *            £»£±£∏°•£±£∞ ≤˛¿µ§Ë§Í
                       IF     (SPA-NAI-HTEKSTYMD   >=  "20061001"  )
                          OR ((SPA-NAI-HTEKSTYMD   =   SPACE  )  AND
                              (SPA-SYSYMD          >=  "20061001"))
                           MOVE    WRK-HJO-REC5-2 (IDT)
                                           TO  SPA-GMN-HOJOKBNL
                                                    (SPA-GMN-HOJO-MAX)
                       ELSE
                           MOVE    WRK-HJO-REC5   (IDT)
                                           TO  SPA-GMN-HOJOKBNL
                                                    (SPA-GMN-HOJO-MAX)
                       END-IF
                   END-PERFORM
      *£»£≤£∞°•£¥≤˛¿µ
      *        ∏Â¥¸π‚Œº‘
               WHEN    "039"
               WHEN    "040"
                   PERFORM VARYING   IDT     FROM    1  BY  1
                         UNTIL       IDT     >   2
                       MOVE    WRK-HJO-REC6 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                       MOVE    IDT         TO  SPA-GMN-HOJO-MAX
                   END-PERFORM
      *        §Ω§Œ¬æ
               WHEN    OTHER
      *            º´»Ò
                   IF      SPA-GMN-HKNNUM (1:2)    =   "98"
                       PERFORM VARYING     IDT     FROM    1  BY  1
                               UNTIL       IDT     >   2
                           MOVE    WRK-HJO-REC3 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                           MOVE    IDT         TO  SPA-GMN-HOJO-MAX
                       END-PERFORM
                   ELSE
                       MOVE    ZERO        TO  SPA-GMN-HOJO-MAX
      *                £»£±£¥°•£±£∞ ≤˛¿µ§Ë§Í
                       IF      SPA-NAI-HTEKSTYMD   >=  "20021001"
                           PERFORM 310111-HKN-RJNHEN-SEC
                       END-IF
                   END-IF
           END-EVALUATE
      *
           IF      SPA-GMN-HOJO-MAX    =   ZERO
               MOVE    SPACE           TO  SPA-GMN-HOJOKBN-G
           END-IF
           PERFORM VARYING     IDT     FROM    1  BY  1
                   UNTIL       IDT     >   SPA-GMN-HOJO-MAX
               IF      SPA-GMN-HOJOKBNL (IDT)(1:1)
                                           =   SPA-GMN-HOJOKBN
                   MOVE    SPA-GMN-HOJOKBNL (IDT)
                                           TO  SPA-GMN-HOJOKBN-G
               END-IF
           END-PERFORM
      *
           .
       31011-HKN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    œ∑øÕ ‰Ωı∂Ë ¨ ‘Ω∏ΩËÕ˝
      *****************************************************************
       310111-HKN-RJNHEN-SEC            SECTION.
      *
      *    ≈¨Õ—≥´ªœ∆¸§¨£∑£∞∫–∞ æÂ§«°¢œ´∫“°¶º£∏≥°¶º´»Ò
           IF      (SPA-NAI-HTEKSTYMD      >=  SPA-BYMD-70)  AND
                   (SPA-BYMD-70            >   ZERO       )  AND
                   (SPA-GMN-HKNNUM(1:1) NOT =   "9")
               PERFORM VARYING     IDT     FROM    1  BY  1
                       UNTIL       IDT     >   2
      *            £»£±£∏°•£±£∞ ≤˛¿µ§Ë§Í
                   IF     (SPA-NAI-HTEKSTYMD       >=  "20061001" )
                      OR ((SPA-NAI-HTEKSTYMD       =   SPACE  )  AND
                          (SPA-SYSYMD              >=  "20061001"))
                       MOVE    WRK-HJO-REC4-2 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                   ELSE
                       MOVE    WRK-HJO-REC4 (IDT)
                                           TO  SPA-GMN-HOJOKBNL (IDT)
                   END-IF
                   MOVE    IDT             TO  SPA-GMN-HOJO-MAX
               END-PERFORM
           END-IF
           .
       310111-HKN-RJNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    œ´∫“ ›∏± ‘Ω∏ΩËÕ˝
      *****************************************************************
       310111-PARA-RSIHKN-SET-SEC      SECTION.
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTRSIINF"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           PERFORM
               UNTIL   FLG-PARA            =   1
      *
               MOVE    PARA-DATA-REC       TO  PTRSIINF-REC
               IF      PTRSI-HKNID         =   SPA-NAI-HKNID
                   MOVE    PARA-EDANUM     TO  SPA-NAI-RSHKN-EDANUM
                   MOVE    1               TO  FLG-PARA
               ELSE
                   MOVE    "tbl_para"          TO  MCP-TABLE
                   MOVE    "key5"              TO  MCP-PATHNAME
                   PERFORM 990-PARA-READ-SEC
               END-IF
           END-PERFORM
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       310111-PARA-RSIHKN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∏¯»Ò ‘Ω∏ΩËÕ˝
      *****************************************************************
       3102-KOUHI-HEN-SEC              SECTION.
      *
           MOVE    IDY                 TO  SPA-KOH-MAX
           MOVE    IDX                 TO  SPA-NAI-PTKOH-EDANUM (IDY)
      *
           MOVE    SPA-PTKOH-KOHNUM (IDX)  TO  SPA-GMN-KOHNUM  (IDY)
           MOVE    SPA-PTKOH-FTNJANUM(IDX) TO  SPA-GMN-FTNJANUM (IDY)
           MOVE    SPA-PTKOH-JKYSNUM (IDX) TO  SPA-GMN-JKYSNUM   (IDY)
      *
           IF      SPA-PTKOH-PAYKBN (IDX)  NOT =   ZERO
               MOVE    SPA-PTKOH-PAYKBN (IDX)(2:1)
                                           TO  SPA-GMN-KOHKBN  (IDY)
           ELSE
               MOVE    SPACE               TO  SPA-GMN-KOHKBN  (IDY)
           END-IF
           MOVE    SPA-PTKOH-PAYKBN (IDX)  TO  SPA-NAI-PTKOH-PAYKBN(IDY)
      *
           MOVE    SPA-PTKOH-TEKSTYMD(IDX) TO  SPA-NAI-KTEKSTYMD(IDY)
           MOVE    SPA-PTKOH-TEKEDYMD(IDX) TO  SPA-NAI-KTEKEDYMD (IDY)
           MOVE    SPA-PTKOH-KAKUNINYMD (IDX)
                                           TO  SPA-NAI-KKAKUNINYMD(IDY)
      *
           MOVE    SPA-PTKOH-TEKSTYMDW (IDX)
                                           TO  SPA-GMN-KTEKSTYMD (IDY)
           MOVE    SPA-PTKOH-TEKEDYMDW (IDX)
                                           TO  SPA-GMN-KTEKEDYMD (IDY)
           MOVE    SPA-PTKOH-KAKUNINYMDW (IDX)
                                           TO  SPA-GMN-KKAKUNINYMD (IDY)
      *
           MOVE    SPA-PTKOH-KOHID (IDX)   TO SPA-NAI-PTKOH-KOHID (IDY)
      *    ¥¸∏¬¿⁄§Ï∂Ë ¨
           MOVE    SPA-PTKOH-TEKEDCHKKBN(IDX)
                                           TO  SPA-NAI-TEKEDCHKKBN(IDY)
      *
           MOVE    SPA-PTKOH-KOHNUM(IDX)   TO  SPA-MAE-KOHNUM  (IDY)
           IF      SPA-PTKOH-PAYKBN(IDX)   NOT =   ZERO
               MOVE    SPA-PTKOH-PAYKBN(IDX)(2:1)
                                           TO  SPA-MAE-KOHKBN  (IDY)
           END-IF
           MOVE    SPA-PTKOH-FTNJANUM (IDX)
                                           TO  SPA-MAE-FTNJANUM   (IDY)
           MOVE    SPA-PTKOH-MAEKAKUNINYMD (IDX)
                                           TO  SPA-MAE-KKAKUNINYMD(IDY)
           MOVE    SPA-PTKOH-MAEKAKUNINYMDW(IDX)
                                           TO  SPA-MAE-KKAKUNINYMDW(IDY)
      *    ø∑µ¨∞ ≥∞§Œª˛œ∑øÕ•¡•ß•√•Ø∫—§ﬂ§»§π§Î
           IF      SPA-MAE-KOHNUM (IDY)    NOT =   SPACE
               MOVE    1                   TO  SPA-NAI-AGE65 (IDY)
               MOVE    1                   TO  SPA-NAI-AGECHK(IDY)
               MOVE    1                   TO  SPA-NAI-FTNCHK(IDY)
      *        ºıµÎº‘»÷πÊ∑Ÿπ
               MOVE    1                   TO  SPA-NAI-JYUCHK(IDY)
           END-IF
           MOVE    SPA-PTKOH-KAKUINFLG (IDX)
                                           TO  SPA-KOH-KAKUINFLG(IDY)
      *
      *    ∏¯»Òæ Û
           MOVE    SPA-GMN-KOHNUM (IDY)    TO  WRK-HKNNUM
           MOVE    SPA-NAI-KTEKSTYMD(IDY)  TO  WRK-TEKSTYMD
           MOVE    SPA-NAI-KTEKEDYMD(IDY)  TO  WRK-TEKEDYMD
           MOVE    SPA-NAI-PTKOH-PAYKBN(IDY)
                                           TO  WRK-PAYKBN
           IF     (WRK-HKNNUM          =   "027"  )  AND
                  (WRK-PAYKBN          =   ZERO  OR  SPACE )
      *        £»£±£≤°•£±£≤°•£≥£±§ﬁ§«§ŒªŸ ß∂Ë ¨§œ£∞£∞
               IF      WRK-TEKEDYMD        >=  "20010101"
                   MOVE    SPA-NAI-HOSPSBT         TO  WRK-PAYKBN(1:1)
                   MOVE    SPA-NAI-ROUPAYKBN       TO  WRK-PAYKBN(2:1)
               END-IF
           END-IF
           PERFORM 31012-HKNNUM-SET-SEC
           IF     (SPA-GMN-KOHNUM (IDY)        =   "027" )  AND
                  (SPA-NAI-PTKOH-PAYKBN(IDY)   =   ZERO  )
               MOVE    "œ∑øÕ ›∑Ú"          TO  WRK-TANSEIDONAME
               MOVE    "3"                 TO  WRK-HKNKOHSBTKBN
           END-IF
           MOVE    WRK-TANSEIDONAME    TO  SPA-GMN-KOHNUMMEI(IDY)
           MOVE    WRK-TANSEIDONAME    TO  SPA-MAE-KOHNUMMEI(IDY)
           MOVE    WRK-HKNKOHSBTKBN    TO  SPA-NAI-PTKOH-SBTKBN(IDY)
      *
      *     ›∏±º‘»÷πÊ°°∏°∫˜•¡•ß•√•Ø
           INITIALIZE                    HKNJAINF-REC
           MOVE    SPA-HOSPNUM            TO  HKNJA-HOSPNUM
           MOVE    SPA-PTKOH-FTNJANUM(IDX)
                                         TO  HKNJA-HKNJANUM
      *
           MOVE    HKNJAINF-REC        TO  MCPDATA-REC
           MOVE    "tbl_hknjainf"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknjainf"      TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-HKNJAINF-READ-SEC
           ELSE
               INITIALIZE                  HKNJAINF-REC
               MOVE    1               TO  FLG-HKNJAINF
           END-IF
           MOVE    "tbl_hknjainf"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           IF      FLG-HKNJAINF        =   ZERO
      *         ›∏±º‘»÷πÊ§Œ∏¯»ÒºÔ Ã§¨∞„§¶ª˛
               IF      HKNJA-HKNNUM    NOT =   SPA-GMN-KOHNUM (IDY)
                   MOVE    1               TO  FLG-HKNJAINF
               END-IF
           END-IF
      *
      *     ›∏±º‘»÷πÊ§¢§Í
           IF      FLG-HKNJAINF        =   ZERO
               MOVE    HKNJA-IDOYMD        TO  SPA-PTKOH-IDOYMD(IDY)
               MOVE    SPA-PTKOH-KEIFLG(IDX)
                                           TO  SPA-NAI-PTKOH-KEIFLG(IDY)
           ELSE
               MOVE    SPACE               TO  SPA-PTKOH-IDOYMD(IDY)
               MOVE    "1"                 TO  SPA-NAI-PTKOH-KEIFLG(IDY)
           END-IF
      *
           .
       3102-KOUHI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª…Ωº®° ∏Ω∫ﬂ¬–æ› ¨§Œ§ﬂ°ÀΩËÕ˝
      *****************************************************************
       3103-HKNCOMB-PARA-SEC        SECTION.
      *
           INITIALIZE                  SPA-HKNCOMBI-AREA
           MOVE    ZERO                TO  IDX
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "HKNCOMBI"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           PERFORM
               UNTIL   (FLG-PARA       NOT =   ZERO      )  OR
                       (IDX                >=  15        )
               MOVE    PARA-DATA-REC       TO  HKNCOMBI-REC
      *
               IF     (COMB-DELKBN     NOT =   "1"       )  AND
                      (SPA-SYSYMD          >=  COMB-TEKSTYMD  AND
                       SPA-SYSYMD          <=  COMB-TEKEDYMD )
                   ADD     1               TO  SPA-HKNCOMBI-MAX
                   ADD     1               TO  IDX
      *
                   MOVE    COMB-HKNCOMBINUM    TO  SPA-GMN-THKNCOMBINUM
                                                              (IDX)
                   MOVE    COMB-HKNNUM         TO  SPA-GMN-THKNNUM
                                                              (IDX)
                   MOVE    COMB-HKNID          TO  SPA-GMN-THKNID
                                                              (IDX)
      *
                   MOVE    COMB-TEKSTYMD       TO  WRK-SYMD
                   PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
                   MOVE    WRK-HENYMD          TO  SPA-GMN-TTEKSTYMD
                                                              (IDX)
                   MOVE    COMB-TEKEDYMD       TO  WRK-SYMD
                   PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
                   MOVE    WRK-HENYMD          TO  SPA-GMN-TTEKEDYMD
                                                              (IDX)
      *
                   PERFORM 31031-HKNCOMBI-HEN-SEC
                   MOVE    WRK-HKNCOMBI        TO  SPA-GMN-THKNCOMBIMEI
                                                              (IDX)
      *            ∆‚…Ù
                   MOVE    COMB-TEKSTYMD       TO  SPA-NAI-TTEKSTYMD
                                                              (IDX)
                   MOVE    COMB-TEKEDYMD       TO  SPA-NAI-TTEKEDYMD
                                                              (IDX)
      *            •´•Î•∆Õ— ›∏±ªÿƒÍ
                   MOVE    COMB-KOH1HKNNUM     TO  SPA-NAI-TKOH1HKNNUM
                                                              (IDX)
                   MOVE    COMB-KOH2HKNNUM     TO  SPA-NAI-TKOH2HKNNUM
                                                              (IDX)
                   MOVE    COMB-KOH3HKNNUM     TO  SPA-NAI-TKOH3HKNNUM
                                                              (IDX)
                   MOVE    COMB-KOH4HKNNUM     TO  SPA-NAI-TKOH4HKNNUM
                                                              (IDX)
               END-IF
      *
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *    œ´∫“ ›∏±§Œª˛•≥•·•Û•»§Ú…Ωº®§π§Î
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HKNCOMBI-MAX
      *        »Û…Ωº®∂Ë ¨¿ﬂƒÍ
               PERFORM 3134-HKNCOMBI-HYOJI-SEC
      *
               IF      SPA-GMN-THKNNUM (IDX)   =   "971"
                                               OR  "973"
                   PERFORM 31032-RSI-HKNCOMBI-HEN-SEC
               END-IF
           END-PERFORM
      *
      *     ›∏±≈¨Õ—∆¸ΩÁ§À•Ω°º•»§π§Î
           PERFORM 30133-HKNCOMBI-SORT-SEC
      *
           .
       3103-HKNCOMB-PARA-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª•Ω°º•»ΩËÕ˝
      *****************************************************************
       3134-HKNCOMBI-HYOJI-SEC             SECTION.
      *
           PERFORM VARYING     IDX5    FROM    1   BY  1
                   UNTIL      (IDX5        >   SPA-HYO-MAX )
               IF     (SPA-GMN-THKNCOMBINUM (IDX)
                                       =   SPA-HYO-HKNCOMBINUM(IDX5))
               AND    (SPA-GMN-THKNNUM  (IDX)
                                       =   SPA-HYO-HKNNUM     (IDX5))
               AND    (SPA-NAI-TKOH1HKNNUM (IDX)
                                       =   SPA-HYO-KOH1HKNNUM (IDX5))
               AND    (SPA-NAI-TKOH2HKNNUM (IDX)
                                       =   SPA-HYO-KOH2HKNNUM (IDX5))
               AND    (SPA-NAI-TKOH3HKNNUM (IDX)
                                       =   SPA-HYO-KOH3HKNNUM (IDX5))
               AND    (SPA-NAI-TKOH4HKNNUM (IDX)
                                       =   SPA-HYO-KOH4HKNNUM (IDX5))
                   MOVE    SPA-HYO-HYOJIKBN (IDX5)
                                           TO  SPA-NAI-THYOJIKBN (IDX)
                   MOVE    SPA-HYO-MAX     TO  IDX5
               END-IF
           END-PERFORM
      *
           .
       3134-HKNCOMBI-HYOJI-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª•Ω°º•»ΩËÕ˝
      *****************************************************************
       30133-HKNCOMBI-SORT-SEC             SECTION.
      *
      *    …Ωº® ¨§Œ§ﬂπ‘§¶
           INITIALIZE                  WRK-HKNCOBMI-SORT-AREA
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   15
               MOVE    ALL "9"         TO  WRK-SRT-TEKISTYMD
               MOVE    ALL "9"         TO  WRK-SRT-HKNCOMBINUM
               MOVE    ZERO            TO  WRK-SRT-IDX
               PERFORM VARYING     IDX2    FROM    1   BY  1
                       UNTIL       IDX2     >   SPA-HKNCOMBI-MAX
                   IF      SPA-GMN-THKNCOMBINUM (IDX2) =   ZERO
                       OR (SPA-NAI-THYOJIKBN    (IDX2) =   "1" )
                       CONTINUE
                   ELSE
                       PERFORM 301331-SORTSYORI-SEC
                   END-IF
               END-PERFORM
               IF      WRK-SRT-IDX     NOT =   ZERO
                   MOVE    SPA-GMN-HKNCOMBI-LIST (WRK-SRT-IDX)
                                       TO  WRK-GMN-HKNCOMBI-LIST(IDX)
                   INITIALIZE              SPA-GMN-HKNCOMBI-LIST
                                                         (WRK-SRT-IDX)
               END-IF
           END-PERFORM
      *
      *    »Û…Ωº® ¨§Œ§ﬂπ‘§¶
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   15
               MOVE    ALL "9"         TO  WRK-SRT-TEKISTYMD
               MOVE    ALL "9"         TO  WRK-SRT-HKNCOMBINUM
               MOVE    ZERO            TO  WRK-SRT-IDX
               PERFORM VARYING     IDX2    FROM    1   BY  1
                       UNTIL       IDX2     >   SPA-HKNCOMBI-MAX
                   IF      SPA-GMN-THKNCOMBINUM (IDX2) =   ZERO
                      AND (SPA-NAI-THYOJIKBN    (IDX2) =   SPACE)
                       CONTINUE
                   ELSE
                       PERFORM 301331-SORTSYORI-SEC
                   END-IF
               END-PERFORM
               IF      WRK-SRT-IDX     NOT =   ZERO
                   MOVE    SPA-GMN-HKNCOMBI-LIST (WRK-SRT-IDX)
                                       TO  WRK-GMN-HKNCOMBI02-LIST(IDX)
                   INITIALIZE              SPA-GMN-HKNCOMBI-LIST
                                                         (WRK-SRT-IDX)
               END-IF
           END-PERFORM
      *
      *    £”£–£¡ ‘Ω∏° …Ωº® ¨°À
           MOVE    ZERO                TO   SPA-HKNCOMBI-MAX
           INITIALIZE                  SPA-HKNCOMBI-AREA
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   15
               IF      WRK-GMN-THKNCOMBINUM (IDX) NOT =   ZERO
                   ADD     1           TO   SPA-HKNCOMBI-MAX
                   MOVE    WRK-GMN-HKNCOMBI-LIST (IDX)
                                       TO  SPA-GMN-HKNCOMBI-LIST
                                                  (SPA-HKNCOMBI-MAX)
               END-IF
           END-PERFORM
      *    £”£–£¡ ‘Ω∏° »Û…Ωº® ¨°À
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   15
               IF      WRK-GMN02-THKNCOMBINUM (IDX) NOT =   ZERO
                   ADD     1           TO   SPA-HKNCOMBI-MAX
                   MOVE    WRK-GMN-HKNCOMBI02-LIST (IDX)
                                       TO  SPA-GMN-HKNCOMBI-LIST
                                                  (SPA-HKNCOMBI-MAX)
               END-IF
           END-PERFORM
      *
           .
       30133-HKNCOMBI-SORT-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª ‘Ω∏ΩËÕ˝
      *****************************************************************
       301331-SORTSYORI-SEC             SECTION.
      *
           IF      WRK-SRT-TEKISTYMD   >   SPA-NAI-TTEKSTYMD  (IDX2)
               MOVE    IDX2                    TO  WRK-SRT-IDX
               MOVE    SPA-NAI-TTEKSTYMD (IDX2) TO  WRK-SRT-TEKISTYMD
               MOVE    SPA-GMN-THKNCOMBINUM(IDX2)
                                               TO  WRK-SRT-HKNCOMBINUM
           ELSE
               IF      WRK-SRT-TEKISTYMD   =   SPA-NAI-TTEKSTYMD(IDX2)
                   IF      WRK-SRT-HKNCOMBINUM
                                               >   SPA-GMN-THKNCOMBINUM
                                                              (IDX2)
                       MOVE    IDX2                TO  WRK-SRT-IDX
                       MOVE    SPA-NAI-TTEKSTYMD (IDX2)
                                                   TO  WRK-SRT-TEKISTYMD
                       MOVE    SPA-GMN-THKNCOMBINUM(IDX2)
                                                   TO
                                                   WRK-SRT-HKNCOMBINUM
                   END-IF
               END-IF
           END-IF
           .
       301331-SORTSYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª ‘Ω∏ΩËÕ˝
      *****************************************************************
       31031-HKNCOMBI-HEN-SEC             SECTION.
      *
           MOVE    SPACE               TO  WRK-HKNCOMBI
      *
           STRING  COMB-SYU-TANSEIDONAME   DELIMITED  BY  SPACE
                   " "                     DELIMITED  BY  SIZE
                   COMB-KOH1-TANSEIDONAME  DELIMITED  BY  SPACE
                   " "                     DELIMITED  BY  SIZE
                   COMB-KOH2-TANSEIDONAME  DELIMITED  BY  SPACE
                   " "                     DELIMITED  BY  SIZE
                   COMB-KOH3-TANSEIDONAME  DELIMITED  BY  SPACE
                   " "                     DELIMITED  BY  SIZE
                   COMB-KOH4-TANSEIDONAME  DELIMITED  BY  SPACE
                         INTO              WRK-HKNCOMBI
           END-STRING
      *    ºÁ ›∏±§¨§ §§ª˛
           IF      COMB-SYU-TANSEIDONAME   =   SPACE
               MOVE    SPACE               TO  WRK-HKNCOMBI
               STRING  COMB-KOH1-TANSEIDONAME  DELIMITED  BY  SPACE
                       " "                     DELIMITED  BY  SIZE
                       COMB-KOH2-TANSEIDONAME  DELIMITED  BY  SPACE
                       " "                     DELIMITED  BY  SIZE
                       COMB-KOH3-TANSEIDONAME  DELIMITED  BY  SPACE
                       " "                     DELIMITED  BY  SIZE
                       COMB-KOH4-TANSEIDONAME  DELIMITED  BY  SPACE
                         INTO              WRK-HKNCOMBI
               END-STRING
           END-IF
           .
       31031-HKNCOMBI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    œ´∫“ ›∏±¡»πÁ§ª ‘Ω∏ΩËÕ˝
      *****************************************************************
       31032-RSI-HKNCOMBI-HEN-SEC      SECTION.
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTRSIINF"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           MOVE    SPACE               TO  WRK-HKNCOMBI
           PERFORM
               UNTIL   FLG-PARA            =   1
      *
               MOVE    PARA-DATA-REC       TO  PTRSIINF-REC
               IF      PTRSI-HKNID         =   SPA-GMN-THKNID (IDX)
                   IF      PTRSI-COMMENT       =   SPACE
                       MOVE    SPACE               TO  WRK-HKNCOMBI
                       MOVE    SPACE               TO  WRK-HKNKBN-MEI
                       EVALUATE    PTRSI-HKNKBN
                           WHEN    "1"
                               MOVE    "√ª"        TO  WRK-HKNKBN-MEI
                           WHEN    "2"
                               MOVE    "Ω˝"        TO  WRK-HKNKBN-MEI
                           WHEN    "3"
                               MOVE    "•¢"        TO  WRK-HKNKBN-MEI
                           WHEN    "5"
                               MOVE    "∏¯"        TO  WRK-HKNKBN-MEI
                       END-EVALUATE
                       STRING  SPA-GMN-THKNCOMBIMEI (IDX)
                                                   DELIMITED  BY  SPACE
                           " "                     DELIMITED  BY  SIZE
                           WRK-HKNKBN-MEI          DELIMITED  BY  SPACE
                           INTO              WRK-HKNCOMBI
                       END-STRING
                   ELSE
                       MOVE    SPACE               TO  WRK-HKNCOMBI
                       MOVE    SPACE               TO  WRK-HKNKBN-MEI
                       EVALUATE    PTRSI-HKNKBN
                           WHEN    "1"
                               MOVE    "√ª"        TO  WRK-HKNKBN-MEI
                           WHEN    "2"
                               MOVE    "Ω˝"        TO  WRK-HKNKBN-MEI
                           WHEN    "3"
                               MOVE    "•¢"        TO  WRK-HKNKBN-MEI
                           WHEN    "5"
                               MOVE    "∏¯"        TO  WRK-HKNKBN-MEI
                       END-EVALUATE
                       STRING  SPA-GMN-THKNCOMBIMEI (IDX)
                                                   DELIMITED  BY  SPACE
                           " "                     DELIMITED  BY  SIZE
                           WRK-HKNKBN-MEI          DELIMITED  BY  SPACE
                           "° "                    DELIMITED  BY  SIZE
                           PTRSI-COMMENT           DELIMITED  BY  SPACE
                           "°À"                    DELIMITED  BY  SIZE
                           INTO              WRK-HKNCOMBI
                       END-STRING
                   END-IF
                   MOVE    WRK-HKNCOMBI    TO  SPA-GMN-THKNCOMBIMEI
                                                                   (IDX)
                   MOVE    1               TO  FLG-PARA
               END-IF
      *
               IF      FLG-PARA         =   ZERO
                   MOVE    "tbl_para"          TO  MCP-TABLE
                   MOVE    "key5"              TO  MCP-PATHNAME
                   PERFORM 990-PARA-READ-SEC
               END-IF
           END-PERFORM
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      WRK-HKNCOMBI        =   SPACE
               IF      SPA-NAI-RSIONLY     =   ZERO
                   MOVE    1               TO  SPA-NAI-RSIONLY
                   MOVE    "K120"          TO  SPA-ERRCD
               END-IF
           END-IF
           .
       31032-RSI-HKNCOMBI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    œ´∫“ ›∏±ππø∑≤ËÃÃΩËÕ˝
      *****************************************************************
       4910-RSKOH-PARAOUT-SEC         SECTION.
      *    ΩËÕ˝§ §∑
           IF      SPA-RSPAR-FLG      =   "1"
               MOVE    8              TO  SPA-GMN-CUR
               GO      TO      4910-RSKOH-PARAOUT-EXT
           END-IF
      *
      *    ∫ÔΩ¸ΩËÕ˝
           IF      SPA-NAI-SAKJOKBN    =   "1"
               MOVE    "/D"            TO  SPA-GMN-HKNJANUM(1:2)
               PERFORM 4101-KHNJANUM-CHK-SEC
           END-IF
      *     ›∏±≤ËÃÃ§Œ∆‚Õ∆§Ú£‘£¬£Ã§ÿ ‘Ω∏§π§Î
           PERFORM 41031-HKN-SPA-TBL-SET-SEC
      *    ≈–œø•‹•ø•Û§ÿ
           MOVE    60                  TO  SPA-GMN-CUR
      *
           .
       4910-RSKOH-PARAOUT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ≤ËÃÃ¡´∞‹ΩËÕ˝
      *****************************************************************
       200-GMNSENI                   SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *    ª‡À¥∂Ë ¨
               WHEN    "CLICKED"       ALSO    "P02_DEATHKBN"
                   PERFORM 490-DEATHKBN-SEC
      *     ›∏±¡»πÁ§ª
               WHEN    "CLICKED"       ALSO    "B05"
                   MOVE    ZERO        TO  FLG-TOUROKU 
                   MOVE    1           TO  FLG-TOUROKU2
                   PERFORM 450-HKNCOMBI-SEC
      *     ›∏±ƒ…≤√
               WHEN    "CLICKED"       ALSO    "B06S"
                   PERFORM 460-HKN-TUIKA-SEC
      *    ∏¯»Òƒ…≤√
               WHEN    "CLICKED"       ALSO    "B07S"
                   PERFORM 470-KOH-TUIKA-SEC
      *    ≥ŒƒÍ
               WHEN    "CLICKED"       ALSO    "B12"
                   PERFORM 490-TOUROKU-SEC
      *    [¡∞¢¨]≤°≤º
               WHEN    "CLICKED"       ALSO    "B06"
                   PERFORM 440-ZEN-GMNHYOUJI-SEC
      *    [º°¢≠]≤°≤º
               WHEN    "CLICKED"       ALSO    "B07"
                   PERFORM 450-TUGI-GMNHYOUJI-SEC
      *     ›∏±•¡•ß•√•Ø
               WHEN    "CLICKED"       ALSO    "BH1"
                   PERFORM 450-HKNKAKUNINYMD-ZUMI-SEC
      *    œ´∫“°¶º´«Â¿’∆˛Œœ≤ËÃÃ§ÿ
               WHEN    "CLICKED"       ALSO    "B09S"
                   PERFORM 481-ROUSAI-SEC
      *    ∏¯»Ò•¡•ß•√•Ø
               WHEN    "CLICKED"       ALSO    "BK1"
               WHEN    "CLICKED"       ALSO    "BK2"
               WHEN    "CLICKED"       ALSO    "BK3"
                   PERFORM 460-KOHKAKUNINYMD-ZUMI-SEC
      *    ¥¸∏¬¿⁄§Ï•¡•ß•√•Ø
               WHEN    "CLICKED"       ALSO    "CK1"
               WHEN    "CLICKED"       ALSO    "CK2"
               WHEN    "CLICKED"       ALSO    "CK3"
                   PERFORM 460-TEKEDCHKKBN-CHK-SEC
      *     Ã≤ËÃÃ
               WHEN    "CLICKED"       ALSO     ANY
                   PERFORM 4101-BETUGAMEN-SEC
           END-EVALUATE
      *
           .
       200-GMNSENI-EXT.
           EXIT.
      *****************************************************************
      *    ≤Òœ√°°ΩËÕ˝
      *****************************************************************
       200-ENTRY                   SECTION.
      *
      *    ∆˛Œœ∏ƒΩÍ§Œ•ª•√•»
           PERFORM 400-GMN-INPUT-SEC
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
      *
           .
      *
       200-ENTRY-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∆˛Œœ∏ƒΩÍ§Œ•ª•√•»ΩËÕ˝
      *****************************************************************
       400-GMN-INPUT-SEC          SECTION.
      *
      *****MOVE    MCP-WIDGET          TO  WRK-MCP-WIDGET
           MOVE    MCP-WIDGET          TO  SPA-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN-CUR
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *     ›∏±¡»πÁ§ª¡™¬Ú
               WHEN    ANY             ALSO    "HKNLIST"
                   PERFORM 4001-HKNLIST-SEL-SEC
           END-EVALUATE
           .
      *
       400-GMN-INPUT-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª¡™¬ÚΩËÕ˝
      *****************************************************************
       4001-HKNLIST-SEL-SEC          SECTION.
      *
      *    π‘¡™¬Ú
           MOVE    ZERO                TO  WRK-SELNUM
           MOVE    ZERO                TO  WRK-GMN-SELNUM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   30
               IF      P02-HKNLIST-SELECT (IDX)    =   "T"
                   IF     (P02-HKNCOBNUM (IDX)     =   SPACE ) AND
                          (IDX                     >   1     )
                       MOVE    P02-HKNCOBNUM (IDX - 1) TO  WRK-SELNUM
                   ELSE
                       MOVE    P02-HKNCOBNUM (IDX)     TO  WRK-SELNUM
                   END-IF
                   IF     (WRK-SELNUM          NUMERIC   )  AND
                          (WRK-SELNUM      NOT =   SPA-GMN-SELNUM )
                       MOVE    WRK-SELNUM      TO  WRK-GMN-SELNUM
                   END-IF
               END-IF
           END-PERFORM
      *
           IF      WRK-GMN-SELNUM      >   ZERO
               MOVE    WRK-GMN-SELNUM      TO  P02-P02-SELNUM
               MOVE    38                  TO  SPA-GMN-CUR
           END-IF
      *
           .
      *
       4001-HKNLIST-SEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       410-INPUT-CHK-SEC          SECTION.
      *
      *    ≤ËÃÃ§Ú£”£–£¡•ª•√•»
           PERFORM 4101-GMN-SPA-SET-SEC
      *    ¥À‹•¡•ß•√•Ø§» Ã≤ËÃÃΩËÕ˝
           PERFORM 4102-KIHON-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               CONTINUE
           ELSE
               PERFORM 410-INPUT-CHK2-SEC
      *        •ø•∞¿⁄§Í¬ÿ§®§Œª˛°¢¥¸¥÷Ω≈ £§œ•Ø•Í•¢§π§Î
               IF     (SPA-TAGU-FLG        =   1 )
                   OR (FLG-ERRCHK          =   1 )
                   IF      SPA-ERRCD       =   "0064"  OR
                                               "0089"
                       MOVE   SPACE            TO  SPA-ERRCD
                   END-IF
               END-IF
           END-IF
      *
           .
      *
       410-INPUT-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ≤ËÃÃ£”£–£¡ ‘Ω∏ΩËÕ˝
      *****************************************************************
       410-INPUT-CHK2-SEC          SECTION.
      *
      *    ≈–œøª˛°¢…¨ø‹∆˛Œœ•¡•ß•√•Ø
           IF      FLG-TOUROKU         =   1
               PERFORM 4109-TOUROKU-CHK-SEC
           END-IF
      *     ›∏±°¶∏¯»Ò§Œ•∆°º•÷•Î•ª•√•»§»•¡•ß•√•Ø
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-HKNKOH-FLG      =   1
                   PERFORM 4103-HKNKOH-TBL-SEC
               END-IF
           END-IF
      *
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )
               CONTINUE
           ELSE
      *
      *        ∏¯»Ò§Àƒ…≤√§¨§¢§√§øª˛°¢∫«ΩÈ§Œ£±π‘§Úƒ…≤√§π§Î
               IF      FLG-KOH-ADD         =   1
                   PERFORM 4104-KOH-ADD-SEC
               END-IF
           END-IF
           .
      *
       410-INPUT-CHK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ≤ËÃÃ£”£–£¡ ‘Ω∏ΩËÕ˝
      *****************************************************************
       4101-GMN-SPA-SET-SEC          SECTION.
      *
           MOVE    1                   TO  SPA-P02A-FLG1
           MOVE    1                   TO  SPA-P02A-FLG2
           MOVE    1                   TO  SPA-P02G-FLG
      *
      *    §´§ ª·Ãæ
           IF      P02-P02-KANANAME    =   SPA-MAE-KANANAME
               MOVE    ZERO                TO  FLG-IN-KANANAME
           ELSE
               MOVE    1                   TO  FLG-IN-KANANAME
               MOVE    ZERO                TO  SPA-NAI-KANAFLG
               MOVE    ZERO                TO  SPA-P02A-FLG1
               MOVE    ZERO                TO  SPA-P02A-FLG2
               MOVE    ZERO                TO  SPA-P02G-FLG
           END-IF
           MOVE    P02-P02-KANANAME    TO  SPA-GMN-KANANAME
      *    ¥¡ª˙ª·Ãæ
           IF      P02-P02-NAME        =   SPA-MAE-NAME
               MOVE    ZERO                TO  FLG-IN-NAME
           ELSE
               MOVE    1                   TO  FLG-IN-NAME
               MOVE    ZERO                TO  SPA-P02A-FLG1
               MOVE    ZERO                TO  SPA-P02A-FLG2
               MOVE    ZERO                TO  SPA-P02G-FLG
           END-IF
           MOVE    P02-P02-NAME        TO  SPA-GMN-NAME
      *    ª·Ãæ —ππ
           IF      SPA-GMN-NAME    NOT =   SPA-HZN-NAME
               MOVE    1                   TO  SPA-HEN-FLG
           END-IF
      *
           MOVE    P02-P02-NICKNAME    TO  SPA-GMN-NICKNAME
      *
           IF      P02-P02-SEX(1:1)    =   SPA-MAE-SEX
               MOVE    ZERO                TO  FLG-IN-SEX
           ELSE
               MOVE    1                   TO  FLG-IN-SEX
               MOVE    ZERO                TO  SPA-P02A-FLG2
               MOVE    ZERO                TO  SPA-P02G-FLG
           END-IF
           MOVE    P02-P02-SEX         TO  SPA-GMN-SEX-G
      *
           IF      P02-P02-BIRTHDAY    =   SPA-MAE-BIRTHDAY
               MOVE    ZERO                TO  FLG-IN-BIRTHDAY
           ELSE
               MOVE    1                   TO  FLG-IN-BIRTHDAY
               MOVE    ZERO                TO  SPA-P02A-FLG2
               MOVE    ZERO                TO  SPA-P02G-FLG
           END-IF
           MOVE    P02-P02-BIRTHDAY    TO  SPA-GMN-BIRTHDAYW
      *
           MOVE    P02-TSTPTNUMKBN     TO  SPA-GMN-TSTPTNUMKBN-G
           MOVE    P02-P02-HAKKO       TO  SPA-GMN-HAKKO-G
           MOVE    P02-P02-USERPG      TO  SPA-GMN-USERPG-G
      *
      *
           IF      P02-P02-POST        =   SPA-MAE-POST
               MOVE    ZERO                TO  FLG-IN-POST
           ELSE
               MOVE    1                   TO  FLG-IN-POST
           END-IF
      *
           IF      P02-P02-DISCOUNTKBN(1:2)
                                           =   SPA-MAE-DISCOUNTKBN
               MOVE    ZERO                TO  FLG-IN-DISCOUNTKBN
           ELSE
               MOVE    1                   TO  FLG-IN-DISCOUNTKBN
           END-IF
      *
           MOVE    P02-P02-POST        TO  SPA-GMN-POST
           MOVE    P02-P02-ADRS        TO  SPA-GMN-EDITADRS-NAME
           MOVE    P02-P02-TEL2        TO  SPA-GMN-TEL2
           MOVE    P02-P02-BANTI       TO  SPA-GMN-BANTI
           MOVE    P02-P02-TEL1        TO  SPA-GMN-TEL1
           MOVE    P02-P02-SETAINUSI   TO  SPA-GMN-SETAINUSI
           MOVE    P02-P02-ZOKUGARA    TO  SPA-GMN-ZOKUGARA
           MOVE    P02-P02-DISCOUNTKBN TO  SPA-GMN-DISCOUNTKBN-G
           MOVE    P02-P02-DISCOUNT    TO  SPA-GMN-DISCOUNT
           MOVE    P02-P02-CONDITION1  TO  SPA-GMN-CONDITION(1)
           MOVE    P02-P02-CONDITION2  TO  SPA-GMN-CONDITION(2)
           MOVE    P02-P02-CONDITION3  TO  SPA-GMN-CONDITION(3)
           MOVE    P02-P02-NYUKIN      TO  SPA-GMN-NYUKIN-HOHO-G
           MOVE    P02-P02-SKYPRTFLG   TO  SPA-GMN-SKYPRTFLG-G
           MOVE    P02-P02-COMMENT1    TO  SPA-GMN-COMMENT-1
           MOVE    P02-P02-COMMENT2    TO  SPA-GMN-COMMENT-2
           MOVE    P02-P02-TABOO1      TO  SPA-GMN-TABOO-1
           MOVE    P02-P02-TABOO2      TO  SPA-GMN-TABOO-2
           MOVE    P02-P02-ALLERGY1    TO  SPA-GMN-ALLERGY-1
           MOVE    P02-P02-ALLERGY2    TO  SPA-GMN-ALLERGY-2
           MOVE    P02-P02-KANSENSYO1  TO  SPA-GMN-KANSENSYO-1
           MOVE    P02-P02-KANSENSYO2  TO  SPA-GMN-KANSENSYO-2
      *
           MOVE    P02-P02-SELNUM      TO  SPA-GMN-SELNUM
           MOVE    P02-P02-SRYKA       TO  SPA-GMN-SRYKA-G
      *     ›∏±æ Û
           IF      SPA-MAE-HKNNUM      =   "971"
                                       OR  "973"
      *        œ´∫“§Œª˛°¢ ›∏±æ Û§À∆˛Œœ§¨§ §§§≥§»
               PERFORM 41011-ROUSAI-CHK-SEC
           ELSE
      *         ›∏±º‘»÷πÊ —ππª˛§À∞€∆∞•¡•ß•√•Ø§Ú•Ø•Í•¢§π§Î
               IF      P02-P02-HKNJANUM    NOT =   SPA-GMN-HKNJANUM
                   MOVE    SPACE               TO  SPA-HKNJA-KEIFLG
               END-IF
               IF      P02-P02-HONKZKBN(1:1)   NOT = SPA-GMN-HONKZKKBN
                   MOVE    SPA-GMN-HONKZKKBN   TO  SPA-MAE-HONKZKKBN
               END-IF
               MOVE    P02-P02-HKNJANUM    TO  SPA-GMN-HKNJANUM
               MOVE    P02-P02-HKNNUM      TO  SPA-GMN-HKNNUM-G
               MOVE    P02-P02-HONKZKBN    TO  SPA-GMN-HONKZKKBN-G
               MOVE    P02-P02-HOJOKBN     TO  SPA-GMN-HOJOKBN-G
               MOVE    P02-P02-CONTKBN     TO  SPA-GMN-CONTKBN-G
               MOVE    P02-P02-KIGO        TO  SPA-GMN-KIGO
               MOVE    P02-P02-NUM         TO  SPA-GMN-NUM
               MOVE    P02-P02-SKKGETYMD   TO  SPA-GMN-SKKGETYMD
      *        ≥´ªœ∆¸ —ππ§«∑Ÿπ•Ø•Í•¢
               IF      P02-P02-HTEKSTYMD   NOT =   SPA-GMN-HTEKSTYMD
                   MOVE    ZERO                TO  SPA-ROU-KEIFLG
               END-IF
               MOVE    P02-P02-HTEKSTYMD   TO  SPA-GMN-HTEKSTYMD
               MOVE    P02-P02-HTEKEDYMD   TO  SPA-GMN-HTEKEDYMD
               MOVE    P02-P02-HIHKNJANAME TO  SPA-GMN-HIHKNJANAME
      *        ≥Œ«ß∆¸ —ππ§«∑Ÿπ•Ø•Í•¢
               IF      P02-P02-HKAKUNINYMD NOT =   SPA-GMN-HKAKUNINYMD
                   MOVE    ZERO                TO  SPA-HKN-KAKUINFLG
               END-IF
               MOVE    P02-P02-HKAKUNINYMD TO  SPA-GMN-HKAKUNINYMD
      *
           END-IF
      *
      *     ›∏±º‘»÷πÊ —ππª˛§À∞€∆∞•¡•ß•√•Ø§Ú•Ø•Í•¢§π§Î
           IF      P02-P02-FTNJANUM1   NOT =   SPA-GMN-FTNJANUM (1)
               MOVE    SPACE               TO  SPA-NAI-PTKOH-KEIFLG(1)
           END-IF
           IF      P02-P02-FTNJANUM2   NOT =   SPA-GMN-FTNJANUM (2)
               MOVE    SPACE               TO  SPA-NAI-PTKOH-KEIFLG(2)
           END-IF
           IF      P02-P02-FTNJANUM3   NOT =   SPA-GMN-FTNJANUM (3)
               MOVE    SPACE               TO  SPA-NAI-PTKOH-KEIFLG(3)
           END-IF
      *    «ØŒ•¡•ß•√•Ø§Ú•Ø•Í•¢§π§Î
           IF     (P02-P02-FTNJANUM1   NOT =   SPA-GMN-FTNJANUM (1)) OR
                  (P02-P02-KOHNUM1     NOT =   SPA-GMN-KOHNUM-G (1)) OR
                  (P02-P02-KTEKSTYMD1  NOT =   SPA-GMN-KTEKSTYMD(1)) OR
                  (P02-P02-KTEKEDYMD1  NOT =   SPA-GMN-KTEKEDYMD(1))
               MOVE    ZERO                TO  SPA-NAI-AGECHK   (1)
           END-IF
           IF     (P02-P02-FTNJANUM2   NOT =   SPA-GMN-FTNJANUM (2)) OR
                  (P02-P02-KOHNUM2     NOT =   SPA-GMN-KOHNUM-G (2)) OR
                  (P02-P02-KTEKSTYMD2  NOT =   SPA-GMN-KTEKSTYMD(2)) OR
                  (P02-P02-KTEKEDYMD2  NOT =   SPA-GMN-KTEKEDYMD(2))
               MOVE    ZERO                TO  SPA-NAI-AGECHK   (2)
           END-IF
           IF     (P02-P02-FTNJANUM3   NOT =   SPA-GMN-FTNJANUM (3)) OR
                  (P02-P02-KOHNUM3     NOT =   SPA-GMN-KOHNUM-G (3)) OR
                  (P02-P02-KTEKSTYMD3  NOT =   SPA-GMN-KTEKSTYMD(3)) OR
                  (P02-P02-KTEKEDYMD3  NOT =   SPA-GMN-KTEKEDYMD(3))
               MOVE    ZERO                TO  SPA-NAI-AGECHK   (3)
           END-IF
      *    …È√¥º‘»÷πÊ∑Ÿπ•Ø•Í•¢§π§Î
           IF     (P02-P02-FTNJANUM1   NOT =   SPA-GMN-FTNJANUM (1))
               MOVE    ZERO                TO  SPA-NAI-FTNCHK   (1)
           END-IF
           IF     (P02-P02-FTNJANUM2   NOT =   SPA-GMN-FTNJANUM (2))
               MOVE    ZERO                TO  SPA-NAI-FTNCHK   (2)
           END-IF
           IF     (P02-P02-FTNJANUM3   NOT =   SPA-GMN-FTNJANUM (3))
               MOVE    ZERO                TO  SPA-NAI-FTNCHK   (3)
           END-IF
      *    ºıµÎº‘º‘»÷πÊ∑Ÿπ•Ø•Í•¢§π§Î
           IF     (P02-P02-JKYSNUM1    NOT =   SPA-GMN-JKYSNUM (1))
               MOVE    ZERO                TO  SPA-NAI-JYUCHK  (1)
           END-IF
           IF     (P02-P02-JKYSNUM2    NOT =   SPA-GMN-JKYSNUM (2))
               MOVE    ZERO                TO  SPA-NAI-JYUCHK  (2)
           END-IF
           IF     (P02-P02-JKYSNUM3    NOT =   SPA-GMN-JKYSNUM (3))
               MOVE    ZERO                TO  SPA-NAI-JYUCHK  (3)
           END-IF
      *    ∏¯»Ò£±
           MOVE    P02-P02-FTNJANUM1   TO  SPA-GMN-FTNJANUM (1)
           MOVE    P02-P02-KOHNUM1     TO  SPA-GMN-KOHNUM-G (1)
           MOVE    P02-P02-JKYSNUM1    TO  SPA-GMN-JKYSNUM  (1)
           IF      P02-P02-KTEKSTYMD1  NOT =   SPA-GMN-KTEKSTYMD (1)
               MOVE    ZERO             TO  SPA-NAI-AGE65    (1)
           END-IF
           MOVE    P02-P02-KTEKSTYMD1  TO  SPA-GMN-KTEKSTYMD (1)
           MOVE    P02-P02-KTEKEDYMD1  TO  SPA-GMN-KTEKEDYMD (1)
           IF      P02-P02-KKAKUNINYMD1
                                   NOT =   SPA-GMN-KKAKUNINYMD(1)
               MOVE    ZERO            TO  SPA-KOH-KAKUINFLG (1)
           END-IF
           MOVE    P02-P02-KKAKUNINYMD1
                                       TO  SPA-GMN-KKAKUNINYMD(1)
      *    ∏¯»Ò£≤
           MOVE    P02-P02-FTNJANUM2   TO  SPA-GMN-FTNJANUM (2)
           MOVE    P02-P02-KOHNUM2     TO  SPA-GMN-KOHNUM-G (2)
           MOVE    P02-P02-JKYSNUM2    TO  SPA-GMN-JKYSNUM  (2)
           IF      P02-P02-KTEKSTYMD2  NOT =   SPA-GMN-KTEKSTYMD (2)
               MOVE    ZERO             TO  SPA-NAI-AGE65    (2)
           END-IF
           MOVE    P02-P02-KTEKSTYMD2  TO  SPA-GMN-KTEKSTYMD (2)
           MOVE    P02-P02-KTEKEDYMD2  TO  SPA-GMN-KTEKEDYMD (2)
           IF      P02-P02-KKAKUNINYMD2
                                   NOT =   SPA-GMN-KKAKUNINYMD(2)
               MOVE    ZERO            TO  SPA-KOH-KAKUINFLG (2)
           END-IF
           MOVE    P02-P02-KKAKUNINYMD2
                                       TO  SPA-GMN-KKAKUNINYMD(2)
      *    ∏¯»Ò£≥
           MOVE    P02-P02-FTNJANUM3   TO  SPA-GMN-FTNJANUM (3)
           MOVE    P02-P02-KOHNUM3     TO  SPA-GMN-KOHNUM-G (3)
           MOVE    P02-P02-JKYSNUM3    TO  SPA-GMN-JKYSNUM  (3)
           IF      P02-P02-KTEKSTYMD3  NOT =   SPA-GMN-KTEKSTYMD (3)
               MOVE    ZERO             TO  SPA-NAI-AGE65    (3)
               MOVE    ZERO             TO  SPA-NAI-AGECHK   (3)
           END-IF
           MOVE    P02-P02-KTEKSTYMD3  TO  SPA-GMN-KTEKSTYMD (3)
           MOVE    P02-P02-KTEKEDYMD3  TO  SPA-GMN-KTEKEDYMD (3)
           IF      P02-P02-KKAKUNINYMD3
                                   NOT =   SPA-GMN-KKAKUNINYMD(3)
               MOVE    ZERO            TO  SPA-KOH-KAKUINFLG (3)
           END-IF
           MOVE    P02-P02-KKAKUNINYMD3
                                       TO  SPA-GMN-KKAKUNINYMD(3)
           .
      *
       4101-GMN-SPA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    œ´∫“§Œ ›∏±æ Û∆˛Œœ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       41011-ROUSAI-CHK-SEC          SECTION.
      *
           IF     (P02-P02-HKNJANUM    =   SPA-GMN-HKNJANUM ) AND
                  (P02-P02-HKNNUM      =   SPA-GMN-HKNNUM-G ) AND
                  (P02-P02-HONKZKBN    =   SPA-GMN-HONKZKKBN-G) AND
                  (P02-P02-HOJOKBN     =   SPA-GMN-HOJOKBN-G) AND
                  (P02-P02-CONTKBN     =   SPA-GMN-CONTKBN-G) AND
                  (P02-P02-KIGO        =   SPA-GMN-KIGO     ) AND
                  (P02-P02-NUM         =   SPA-GMN-NUM      ) AND
                  (P02-P02-SKKGETYMD   =   SPA-GMN-SKKGETYMD) AND
                  (P02-P02-HTEKSTYMD   =   SPA-GMN-HTEKSTYMD) AND
                  (P02-P02-HTEKEDYMD   =   SPA-GMN-HTEKEDYMD) AND
                  (P02-P02-HIHKNJANAME =   SPA-GMN-HIHKNJANAME) AND
                  (P02-P02-HKAKUNINYMD =   SPA-GMN-HKAKUNINYMD)
               MOVE    ZERO                TO  FLG-IN-HKN
           ELSE
               MOVE    P02-P02-HKNJANUM    TO  SPA-GMN-HKNJANUM
               MOVE    1                   TO  FLG-IN-HKN
           END-IF
           .
      *
       41011-ROUSAI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥À‹•¡•ß•√•Ø§» Ã≤ËÃÃΩËÕ˝
      *****************************************************************
       4102-KIHON-CHK-SEC          SECTION.
      *
      *    •´• ª·Ãæ
           PERFORM 4101-KANANAME-CHK-SEC
      *
      *    ¥¡ª˙ª·Ãæ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-NAME-CHK-SEC
           END-IF
      *
      *    ¿≠ Ã
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SEX-CHK-SEC
           END-IF
      *    ¿∏«Ø∑Ó∆¸
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-BIRTHDAY-CHK-SEC
           END-IF
      *    ƒÃæŒ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-NICKNAME-CHK-SEC
           END-IF
      *    •∆•π•»¥µº‘
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-TSTPTNUMKBN-CHK-SEC
           END-IF
      *    •´•Î•∆»Øπ‘
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-HAKKO-CHK-SEC
           END-IF
      *    £’°¶£–•¡•ß•√•ØΩËÕ˝
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-USERPG-CHK-SEC
           END-IF
      *     ›∏±º‘»÷πÊ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-KHNJANUM-CHK-SEC
           END-IF
      *
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               IF      FLG-HKN-DEL         =   ZERO
      *             ›∏±æ Û•¡•ß•√•Ø•µ•÷
                   CALL    "ORCSP03A"      USING   SPA-AREA
                                                   SPA-P02SCRAREA
                                                   SPA-P02KYOUTU
      *            •ø•∞¿⁄§Í¬ÿ§®§Œª˛°¢¥¸¥÷Ω≈ £§œ•Ø•Í•¢§π§Î
                   IF     (SPA-TAGU-FLG        =   1 )
                       OR (FLG-ERRCHK          =   1 )
                       IF      SPA-ERRCD       =   "0064"  OR
                                                   "0089"
                           MOVE   SPACE            TO  SPA-ERRCD
                       END-IF
                       IF      SPA-PIDCD   NOT =   SPACE
                           MOVE   SPACE            TO  SPA-PIDCD
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
      *    ∏¯»Ò
           PERFORM 4102-KOH-CHKALL-SEC
      *
      *    ∏¯»Òæ Û•¡•ß•√•Ø•µ•÷
           CALL    "ORCSP03B"          USING   SPA-AREA
                                               SPA-P02SCRAREA
                                               SPA-P02KYOUTU
      *    •ø•∞¿⁄§Í¬ÿ§®§Œª˛°¢¥¸¥÷Ω≈ £§œ•Ø•Í•¢§π§Î
           IF      SPA-TAGU-FLG        =   1
               OR (FLG-ERRCHK          =   1 )
               IF      SPA-ERRCD       =   "0088"  OR
                                           "0089"
                   MOVE   SPACE            TO  SPA-ERRCD
               END-IF
               IF      SPA-PIDCD   NOT =   SPACE
                   MOVE   SPACE            TO  SPA-PIDCD
               END-IF
           END-IF
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
      *    Õπ ÿ»÷πÊ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-POST-CHK-SEC
           END-IF
      *    ΩªΩÍ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-ADRS-CHK-SEC
           END-IF
      *    »÷√œ ˝ΩÒ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-BANTI-CHK-SEC
           END-IF
      *    ¿§¬”ºÁ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SETAINUSI-CHK-SEC
           END-IF
      *    ¬≥ ¡
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-ZOKUGARA-CHK-SEC
           END-IF
      *    ∏∫Ã»ªˆÕ≥
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-DISCOUNTKBN-CHK-SEC
           END-IF
      *    ≥‰∞˙Œ®
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-DISCOUNT-CHK-SEC
           END-IF
      *    ∆˛∂‚ ˝À°
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-NYUKIN-HOHO-CHK-SEC
           END-IF
      *    æı¬÷£±§´§È£≥
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-CONDITIONH-SET-SEC
           END-IF
      *    æı¬÷£±§´§È£≥
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-CONDITIONH-SET-SEC
           END-IF
      *    ¿¡µ·ΩÒ»Øπ‘∂Ë ¨
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SKYPRTFLG-CHK-SEC
           END-IF
      *    ∂ÿ¥˜¬æ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-COMMENT-CHK-SEC
           END-IF
      *     ›∏±¡»πÁ§ª¡™¬Ú
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SELNUM-CHK-SEC
           END-IF
      *    ø«Œ≈≤ ¡™¬Ú
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-FLG-END         =   ZERO  )
               PERFORM 4101-SRYKA-CHK-SEC
           END-IF
           .
      *
       4102-KIHON-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±º‘»÷πÊ∆˛Œœ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4101-KHNJANUM-CHK-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-HKN-DEL
      *    œ´∫“§«∆˛Œœ§¨§¢§√§øª˛°¢•®•È°º
           IF      FLG-IN-HKN          =   1
      *
               EVALUATE    SPA-GMN-HKNJANUM(1:2)
                   WHEN    "/A"
                   WHEN    "/a"
      *                ƒ…≤√§œ£œ£À
                       INITIALIZE                  SPA-GMN-HKN-AREA
                       MOVE    ZERO                TO  SPA-NAI-HKNSTR
                       MOVE    8                   TO  SPA-GMN-CUR
                       MOVE    1                   TO  FLG-HKN-DEL
                   WHEN    "/D"
                   WHEN    "/d"
      *                ∫ÔΩ¸§œœ´∫“ ›∏±≤ËÃÃ§ÿ
                       MOVE    SPACE               TO  SPA-GMN-HKNJANUM
                       MOVE    "0043"              TO  SPA-ERRCD
                       MOVE    61                  TO  SPA-GMN-CUR
                   WHEN    OTHER
                       MOVE    SPACE               TO  SPA-GMN-HKNJANUM
                       MOVE    "0043"              TO  SPA-ERRCD
                       MOVE    61                  TO  SPA-GMN-CUR
               END-EVALUATE
               GO      TO      4101-KHNJANUM-CHK-EXT
           END-IF
      *    ∫ÔΩ¸§Œ»ΩƒÍ
           IF      SPA-GMN-HKNJANUM(1:2)   =   "/D"  OR  "/d"
      *D       œ´∫“§Œª˛°¢œ´∫“ ›∏±≤ËÃÃ§ÿ
      *        IF      SPA-GMN-HKNNUM      =   "971"
      *                                    OR  "973"
      *            MOVE    "0043"          TO  SPA-ERRCD
      *            MOVE    61              TO  SPA-GMN-CUR
      *            GO      TO      4101-KHNJANUM-CHK-EXT
      *D       END-IF
      *        ø∑µ¨§Œª˛°¢£‘£¬£Ã§‚∫ÔΩ¸
               IF     (SPA-NAI-HKNSTR      >   ZERO      ) AND
                      (SPA-PTHKN-SINKIKBN (SPA-NAI-HKNSTR)
                                           =    "1"           )
                   MOVE    SPACE           TO  SPA-PTHKNINF-TBL
                                                     (SPA-NAI-HKNSTR)
                   INITIALIZE                  SPA-PTHKNINF-TBL
                                                     (SPA-NAI-HKNSTR)
      *             ›∏±•∆°º•÷•Î∂ı«Úπ‘∫ÔΩ¸ΩËÕ˝
                   PERFORM 410311-HKNTBL-DEL-SEC
               ELSE
                   IF      SPA-NAI-HKNSTR      >   ZERO
                       MOVE    "1"             TO  SPA-PTHKN-SAKJOKBN
                                                       (SPA-NAI-HKNSTR)
                       MOVE    "1"             TO  SPA-NAI-SAKJOKBN
                   END-IF
               END-IF
               MOVE    1                   TO  FLG-HKN-DEL
               INITIALIZE                  SPA-GMN-HKN-AREA
               IF      SPA-NAI-HKNSTR      =   ZERO
                   MOVE    1               TO  SPA-NAI-HKNSTR
               END-IF
      *        º°§Œ¬–æ›§Ú…Ωº®§π§Î
      *         ›∏±æ Û£‘£¬£Ã§´§È ‘Ω∏
               PERFORM 3101-HKN-TBL-SPA-SEC
               MOVE    8                   TO  SPA-GMN-CUR
               GO      TO      4101-KHNJANUM-CHK-EXT
           END-IF
      *
      *    ƒ…≤√§Œ»ΩƒÍ
           IF      SPA-GMN-HKNJANUM(1:2)   =   "/A"  OR  "/a"
               INITIALIZE                  SPA-GMN-HKN-AREA
               MOVE    ZERO                TO  SPA-NAI-HKNSTR
               MOVE    8                   TO  SPA-GMN-CUR
               MOVE    1                   TO  FLG-HKN-DEL
           END-IF
      *     £ºÃ§Œ»ΩƒÍ
           IF      SPA-GMN-HKNJANUM(1:2)   =   "/C"  OR  "/c"
      *         ‰Ωı∂Ë ¨°¢Õ≠∏˙¥¸¥÷§œ £ºÃ§∑§ §§
               MOVE    SPA-NAI-HKNSTR      TO  IDX
               MOVE    SPA-PTHKN-HKNJANUM(IDX) TO  SPA-GMN-HKNJANUM
               MOVE    SPACE               TO  SPA-GMN-HTEKSTYMD
               MOVE    SPACE               TO  SPA-GMN-HTEKEDYMD
               MOVE    SPACE               TO  SPA-GMN-HOJOKBN-G
               MOVE    SPACE               TO  SPA-GMN-HKAKUNINYMD
               MOVE    ZERO                TO  SPA-NAI-HKNID
               MOVE    SPACE               TO  SPA-NAI-HTEKSTYMD
               MOVE    SPACE               TO  SPA-NAI-HTEKEDYMD
               MOVE    SPACE               TO  SPA-NAI-HKAKUNINYMD
               INITIALIZE                  SPA-MAE-HKN-AREA
               MOVE    ZERO                TO  SPA-NAI-HKNSTR
               MOVE    8                   TO  SPA-GMN-CUR
               MOVE    1                   TO  FLG-HKN-DEL
           END-IF
      *
           .
       4101-KHNJANUM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∏¯»Ò∆˛Œœ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4102-KOH-CHKALL-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-KOH-ADD
           MOVE    ZERO                TO  FLG-KOH-DEL
      *    ∫ÔΩ¸§Œ»ΩƒÍ
           PERFORM VARYING     IDX-K   FROM    1   BY  1
                   UNTIL       IDX-K   >   3
               PERFORM 41021-KOH-DEL-CHK-SEC
           END-PERFORM
      *    £¬£∞£∑£”≤°≤ºª˛°¢∫«∏Â§Œπ‘§¨∆˛Œœ∫—§ﬂ§«§¢§Î§≥§»
           IF      FLG-KOH-ADD2        =   1
               IF     (SPA-GMN-KOHNUM(3)    NOT =   SPACE ) AND
                      (SPA-GMN-KTEKSTYMD(3) NOT =   SPACE )
                   MOVE    1                TO  FLG-KOH-ADD
               END-IF
           END-IF
      *
      *    ≤ËÃÃ§Œ∂ı«Úπ‘§Ú§ƒ§·§Î
           PERFORM 41022-PTKOH-TBL-SET-SEC
      *    º°§Œ•«°º•ø§Ú ‘Ω∏§π§Î
      **** IF      FLG-KOH-DEL         =   1
           IF      SPA-KOH-MAX         <   3
               PERFORM 41023-PTKOH-SAI-SET-SEC
           END-IF
      **** END-IF
           .
      *
       4102-KOH-CHKALL-EXT.
           EXIT.
      *
      ****************************************************************
      *    ∏¯»Ò∫ÔΩ¸ΩËÕ˝
      ****************************************************************
       41021-KOH-DEL-CHK-SEC      SECTION.
      *
      *    ∫ÔΩ¸§Œ»ΩƒÍ
           IF      SPA-GMN-FTNJANUM(IDX-K)(1:2)
                                        =   "/D"  OR  "/d"
               MOVE    SPA-NAI-PTKOH-EDANUM(IDX-K)  TO  IDX-KOH
      *        ø∑µ¨§Œª˛°¢£‘£¬£Ã§‚∫ÔΩ¸
               IF     (IDX-KOH             >   ZERO      ) AND
                      (SPA-PTKOH-SINKIKBN (IDX-KOH)
                                           =    "1"      )
                   MOVE    SPACE           TO  SPA-PTKOHINF-TBL
                                                     (IDX-KOH)
                   INITIALIZE                  SPA-PTKOHINF-TBL
                                                     (IDX-KOH)
               ELSE
                   IF      IDX-KOH         >   ZERO
                       MOVE    "1"             TO  SPA-PTKOH-SAKJOKBN
                                                       (IDX-KOH)
                   END-IF
               END-IF
               MOVE    1                   TO  FLG-KOH-DEL
               INITIALIZE                  SPA-GMN-KOH-TBL(IDX-K)
               EVALUATE    IDX-K
                   WHEN    1
                       MOVE    20          TO  SPA-GMN-CUR
                   WHEN    2
                       MOVE    26          TO  SPA-GMN-CUR
                   WHEN    3
                        MOVE    32          TO  SPA-GMN-CUR
               END-EVALUATE
           END-IF
      *    ƒ…≤√§Œ»ΩƒÍ° §…§Œπ‘§«∆˛Œœ§µ§Ï§∆§‚°¢∫«ΩÈ§Œ1π‘§Œ§ﬂ§Ú≥´§±§Î°À
           IF      SPA-GMN-FTNJANUM(IDX-K)(1:2)
                                        =   "/A"  OR  "/a"
      *        ∫«∏Â§Œπ‘§¨∆˛Œœ∫—§ﬂ§«§¢§Î§≥§»
               IF     (SPA-GMN-KOHNUM(3)    NOT =   SPACE ) AND
                      (SPA-GMN-KTEKSTYMD(3) NOT =   SPACE )
                   MOVE    1                TO  FLG-KOH-ADD
               END-IF
               MOVE    SPA-MAE-FTNJANUM(IDX-K)
                                        TO  SPA-GMN-FTNJANUM(IDX-K)
               EVALUATE    IDX-K
                   WHEN    1
                       MOVE    20          TO  SPA-GMN-CUR
                   WHEN    2
                       MOVE    26          TO  SPA-GMN-CUR
                   WHEN    3
                       MOVE    32          TO  SPA-GMN-CUR
               END-EVALUATE
           END-IF
           .
      *
       41021-KOH-DEL-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ∏¯»Ò∂ı«Ú∫ÔΩ¸ ‘Ω∏ΩËÕ˝
      ****************************************************************
       41022-PTKOH-TBL-SET-SEC      SECTION.
      *
           MOVE    SPA-GMN-KOH-AREA    TO  WRK-GMN-KOH-AREA
           INITIALIZE                      SPA-GMN-KOH-AREA
           MOVE    ZERO                TO  IDX-K
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   3
              IF      WRK-GMN-HOK-G (IDX)  NOT =   SPACE
                   ADD     1               TO  IDX-K
                   MOVE    WRK-GMN-KOH-TBL (IDX)
                                           TO  SPA-GMN-KOH-TBL (IDX-K)
               END-IF
           END-PERFORM
      *    ∫«¬Á§Ú ‘Ω∏§π§Î
           MOVE    IDX-K               TO  SPA-KOH-MAX
           .
      *
       41022-PTKOH-TBL-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *    ∏¯»Ò∫ÔΩ¸ ‘Ω∏ΩËÕ˝
      ****************************************************************
       41023-PTKOH-SAI-SET-SEC      SECTION.
      *
      *    ∂ı§§§øπ‘§ÿº°§Æ§Œ•«°º•ø§Ú ‘Ω∏§π§Î
           MOVE    SPA-KOH-MAX         TO  IDX-K
           IF      IDX-K               =   ZERO
               MOVE    1                   TO  IDX-K2
           ELSE
               IF      (SPA-NAI-PTKOH-EDANUM(IDX-K) NOT =   ZERO)
                   MOVE    SPA-NAI-PTKOH-EDANUM(IDX-K) TO  IDX-K2
                   ADD     1                   TO  IDX-K2
               ELSE
      *********    MOVE    4                   TO  IDX-K2
                   COMPUTE IDX-K2              =   SPA-PTKOH-MAX + 1
               END-IF
           END-IF
           MOVE    IDX-K               TO  IDY
           PERFORM VARYING     IDX     FROM    IDX-K2 BY  1
                   UNTIL      (IDX     >   SPA-PTKOH-MAX )  OR
                              (IDY     >=  3    )
               IF     (SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE) AND
                      (SPA-PTKOH-KOHNUM (IDX)  NOT =   SPACE )
                   ADD     1                   TO  IDY
                   MOVE    IDY                 TO  SPA-KOH-MAX
                   PERFORM 3102-KOUHI-HEN-SEC
               END-IF
           END-PERFORM
      *
           .
      *
       41023-PTKOH-SAI-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *    •´• ª·Ãæ•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       4101-KANANAME-CHK-SEC      SECTION.
      *
           IF      SPA-GMN-KANANAME    =   SPACE
               MOVE    SPA-GMN-KANANAME    TO  SPA-MAE-KANANAME
               GO      TO      4101-KANANAME-CHK-EXT
           END-IF
      *
      *    »æ≥—∂ı«Ú§Ú¡¥≥—∂ı«Ú§ÿ
           MOVE    SPA-GMN-KANANAME    TO  WRK-MAE-INPUT
           MOVE    50                  TO  WRK-LEN
           PERFORM 890-HALF-ZEN-SEC
           MOVE    WRK-ATO-INPUT       TO  SPA-GMN-KANANAME
           IF      FLG-ERR             =   1
               MOVE    "0025"              TO  SPA-ERRCD
               MOVE    1                   TO  SPA-GMN-CUR
               GO      TO      4101-KANANAME-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-KANANAME    TO  SPA-MAE-KANANAME
      *    •´•ø•´• §Œ§ﬂ§Œ»ΩƒÍ
           MOVE    ZERO                TO  FLG-KANA
           PERFORM VARYING     IDX     FROM    1   BY  2
                   UNTIL      (IDX     >    100 )  OR
                              (SPA-GMN-KANANAME(IDX:1) =  SPACE)
               IF     (SPA-GMN-KANANAME (IDX:2)
                                       =   "°°" 
                                       OR  "°º" 
                                       OR  "°›"  )  OR
                      (SPA-GMN-KANANAME (IDX:2)
                                       >=  "•°"  AND
                                       <=  "•ˆ"   )  OR
                      (SPA-GMN-KANANAME (IDX:2)
                                       >=  "£∞"  AND
                                       <=  "£˙"   )
                   CONTINUE
               ELSE
                   MOVE    1               TO  FLG-KANA
               END-IF
           END-PERFORM
           IF      FLG-KANA            =   1
               IF      SPA-NAI-KANAFLG     =   ZERO
                   MOVE    "K101"              TO  SPA-ERRCD
                   MOVE    1                   TO  SPA-GMN-CUR
                   MOVE    1                   TO  SPA-NAI-KANAFLG
                   GO      TO      4101-KANANAME-CHK-EXT
               END-IF
           END-IF
      *
      *    ¥¡ª˙ª·Ãæ∏°∫˜ΩËÕ˝
           IF     (FLG-IN-KANANAME         =   1    )  AND
                  (SPA-GMN-KANANAME    NOT =   SPA-GMN-OLD-KANANAME)
      *        øÕÃæº≠ΩÒ…‘ª»Õ—§ŒæÏπÁ
               IF      SPA-NAI-JINMEI-USE  =   "1"
                   MOVE    SPA-GMN-KANANAME
                                           TO  SPA-GMN-OLD-KANANAME
                   MOVE    SPA-GMN-NAME    TO  SPA-GMN-OLD-NAME
               ELSE
      *            £—£“§´§È§ŒΩÈ¥¸…Ωº®
                   IF      SPA-QR-FLG          =   2
                       MOVE    SPACE               TO  SPA-MAE-KANANAME
                   ELSE
                       PERFORM 4101-KANJI-NAME-EDIT-SEC
                   END-IF
               END-IF
           END-IF
      *
           .
       4101-KANANAME-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¥¡ª˙ª·Ãæ•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       4101-NAME-CHK-SEC      SECTION.
      *
           IF      SPA-GMN-NAME    NOT =   SPACE
      *        »æ≥—∂ı«Ú§Ú¡¥≥—∂ı«Ú§ÿ
               MOVE    SPA-GMN-NAME        TO  WRK-MAE-INPUT
               MOVE    50                  TO  WRK-LEN
      *        PERFORM 890-HALF-ZEN-SEC
      *TEST
               PERFORM 891-HALF-ZEN2-SEC
      *TEST
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-NAME
               IF      FLG-ERR             =   1
                   MOVE    "0026"              TO  SPA-ERRCD
                   MOVE    2                   TO  SPA-GMN-CUR
                   GO      TO      4101-NAME-CHK-EXT
               END-IF
           END-IF
      *
      *    ª·Ãæ —ππª˛°¢ ›∏±À‹øÕ§Ú…Ωº®√Ê§ŒæÏπÁ
           IF     (SPA-HEN-FLG         =   1   )    AND
                  (SPA-GMN-HKNNUM  NOT =   SPACE )  AND
                  (SPA-GMN-HONKZKKBN   =   "1"   )  AND
                  (SPA-GMN-HIHKNJANAME NOT =   SPACE )
      *        À‹øÕ§ŒæÏπÁ°¢ª·Ãæ§Ú ‘Ω∏§π§Î
               IF      (SPA-HZN-NAME       =   SPA-GMN-HIHKNJANAME) OR
                       (SPA-MAE-NAME       =   SPA-GMN-HIHKNJANAME)
                   MOVE    SPA-GMN-NAME    TO  SPA-GMN-HIHKNJANAME
               END-IF
           END-IF
      *
      *
           MOVE    SPA-GMN-NAME        TO  SPA-MAE-NAME
      *    ∏´Ω–§∑§ÿ
           MOVE    SPA-GMN-NAME        TO  SPA-GMN-NAMEH
      *    ¿§¬”ºÁ§ÿ
           IF      SPA-GMN-SETAINUSI   =   SPACE
               IF      SPA-NAI-SETAIKBN-FLG    =   "1"
                   MOVE    SPA-GMN-NAME        TO  SPA-GMN-SETAINUSI
               END-IF
           END-IF
      *
      *    ∆±¿´∆±Ãæ
           IF      (SPA-P02A-FLG1      =   ZERO  )  AND
                  ((SPA-MCP-WIDGET NOT =   "P02_KANANAME" ) OR
                   (SPA-NAI-JINMEI-USE NOT =   "1"   ))
               MOVE    1               TO  FLG-P02A-SYORI
               MOVE    1               TO  SPA-P02A-FLG1
      *        ∆±¿´∆±Ãæ•¡•ß•√•Ø§¢§Í
               IF      SPA-NAI-DOUMEI-CHKFLG   =   ZERO
                   PERFORM 41012-NIJYU-TRKGMN-SEC
               END-IF
           END-IF
      *
           .
       4101-NAME-CHK-EXT.
           EXIT.
      ****************************************************************
      *    ¿≠ Ã•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       4101-SEX-CHK-SEC      SECTION.
      *
           EVALUATE    SPA-GMN-SEX
               WHEN    "1"
                   MOVE    "√À"            TO  SPA-GMN-SEXH
                   MOVE    SPA-GMN-SEX     TO  SPA-MAE-SEX
               WHEN    "2"
                   MOVE    "Ω˜"            TO  SPA-GMN-SEXH
                   MOVE    SPA-GMN-SEX     TO  SPA-MAE-SEX
               WHEN    SPACE
                   CONTINUE
               WHEN    OTHER
                   MOVE    "0021"          TO  SPA-ERRCD
                   MOVE    3               TO  SPA-GMN-CUR
           END-EVALUATE
      *
           .
       4101-SEX-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¿∏«Ø∑Ó∆¸•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       4101-BIRTHDAY-CHK-SEC           SECTION.
      *
           IF      SPA-GMN-BIRTHDAYW   =   SPACE
               GO      TO      4101-BIRTHDAY-CHK-EXT
           END-IF
      *
      *    ∆¸…’≤ËÃÃ•¡•ß•√•Ø•µ•÷
           INITIALIZE                      ORCSGDAYAREA
           MOVE    SPA-GMN-BIRTHDAYW   TO  SGDAY-INDAY
           CALL    "ORCSGDAY"          USING
                                       ORCSGDAYAREA
           IF      SGDAY-RC            =   ZERO
               MOVE    SGDAY-OTDAY         TO  SPA-GMN-BIRTHDAYW
               MOVE    SGDAY-SDAY          TO  SPA-NAI-BIRTHDAY
               MOVE    SGDAY-SDAY          TO  WRK-SYMD
           ELSE
               MOVE    "0028"              TO  SPA-ERRCD
               MOVE    4                   TO  SPA-GMN-CUR
               GO      TO      4101-BIRTHDAY-CHK-EXT
           END-IF
      *
      *    •∑•π•∆•‡∆¸…’§»§Œ•¡•ß•√•Ø
           IF      SPA-NAI-BIRTHDAY    >   SPA-SYSYMD
               MOVE    SPACE           TO  SPA-NAI-BIRTHDAY
               MOVE    "0020"          TO  SPA-ERRCD
               MOVE    4               TO  SPA-GMN-CUR
               GO      TO      4101-BIRTHDAY-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-BIRTHDAYW   TO  SPA-MAE-BIRTHDAY
      *
      *    «ØŒ∑◊ªª
           PERFORM 410121-NENREI-SET-SEC
      *    ∏´Ω–§∑§À ‘Ω∏
           MOVE    SPA-GMN-BIRTHDAYW   TO  SPA-GMN-BIRTHDAYH
      *
      *    ∆ÛΩ≈≈–œøµø§§•¡•ß•√•Ø
      *    £—£“§´§È§ŒΩÈ¥¸…Ωº®
           IF      SPA-QR-FLG          =   2
               CONTINUE
           ELSE
             IF      SPA-P02A-FLG2       =   ZERO
               MOVE    2               TO  FLG-P02A-SYORI
               MOVE    1               TO  SPA-P02A-FLG2
               PERFORM 41012-NIJYU-TRKGMN-SEC
             END-IF
           END-IF
      *
      *!!
      *    •∞•Î°º•◊∞ÂŒ≈µ°¥ÿ§Œ∆±¿´∆±Ãæ•Í•π•»
           IF     (SPA-P02-SYORI       =   1    )  AND
                  (SPA-NAI-GRPPTLST-FLG    NOT =   "0" )  AND
                  (SPA-P02G-FLG        =   ZERO   )
      *        ø∑µ¨§«•Í•π•»…Ωº®ª˛§Œ§ﬂ
               IF     (SPA-FLG-END         =   ZERO )
                   PERFORM 41013-GRPPTNAME-CHK-SEC
               ELSE
                   MOVE    2               TO  SPA-P02G-FLG
               END-IF
           END-IF
      *!!
           .
       4101-BIRTHDAY-CHK-EXT.
           EXIT.
      *****************************************************************
      *    «ØŒ∑◊ªªΩËÕ˝
      *****************************************************************
       410121-NENREI-SET-SEC             SECTION.
      *
           IF      SPA-NAI-BIRTHDAY    =   SPACE  OR  ZERO
               MOVE    SPACE               TO  SPA-GMN-NENREI
               MOVE    ZERO                TO  SPA-NAI-NENREI
               GO      TO      410121-NENREI-SET-EXT
           END-IF
      *
           MOVE    SPA-NAI-NENREI      TO  WRK-MAE-NENREI
      *
           MOVE    SPA-NAI-BIRTHDAY    TO  WRK-YMDS1
           MOVE    SPA-SYSYMD          TO  WRK-YMDS2
           COMPUTE WRK-NENREI-YY       =   WRK-YYS2
                                       -   WRK-YYS1
           IF      WRK-YMDS1(5:4)      >   WRK-YMDS2(5:4)
               COMPUTE WRK-NENREI-YY   =   WRK-NENREI-YY
                                           -   1
               COMPUTE WRK-NENREI-MM   =  (WRK-MMS2  +  12 )
                                           -   WRK-MMS1
           ELSE
               COMPUTE WRK-NENREI-MM   =   WRK-MMS2
                                           -   WRK-MMS1
           END-IF
           IF      WRK-DDS1            >   WRK-DDS2
               COMPUTE WRK-NENREI-MM   =   WRK-NENREI-MM
                                           -   1
           END-IF
      *
           MOVE    WRK-NENREI-YY       TO  SPA-NAI-NENREI-YY
           MOVE    WRK-NENREI-MM       TO  SPA-NAI-NENREI-MM
      *    ≤ËÃÃ…Ωº®Õ—
           IF      WRK-NENREI-YY       =   ZERO
               MOVE    WRK-NENREI-MM       TO  WRK-NENREI-ZN
               MOVE    "•ˆ∑Ó"              TO  WRK-NENREI-MEIN
           ELSE
               MOVE    WRK-NENREI-YY       TO  WRK-NENREI-Z
               MOVE    "∫Õ"                TO  WRK-NENREI-MEI
           END-IF
           MOVE    WRK-NENREI-G        TO  SPA-GMN-NENREI
      *
      *    £∑£∞∫–≈˛√£∆¸
      *    ¿∏«Ø∑Ó∆¸§´§È¥Ω‡∆¸§Úµ·§·§Î
      *    £±∆¸§ §È§–¿∏«Ø∑Ó∆¸°¢£±∆¸∞ ≥∞§ §È§–¿∏«Ø∑Ó∆¸§ŒÕ‚∑Ó£±∆¸
           MOVE    SPA-NAI-BIRTHDAY    TO  WRK-BASEYMD
           IF      WRK-BDD         NOT =   01
               COMPUTE WRK-BMM         =   WRK-BMM     +   1
               IF      WRK-BMM         >   12
                   COMPUTE WRK-BYY     =   WRK-BYY     +   1
                   MOVE    01              TO  WRK-BMM
               END-IF
               MOVE    01                  TO  WRK-BDD
           END-IF
      *    £∂£µ∫–§Ú∑ﬁ§®§Î∆¸
           MOVE    WRK-BASEYMD         TO  SPA-BYMD-65
           COMPUTE SPA-B65-YY          =   SPA-B65-YY  +   65
      *    £∑£∞∫–§Ú∑ﬁ§®§Î∆¸
           MOVE    WRK-BASEYMD         TO  SPA-BYMD-70
           COMPUTE SPA-B70-YY          =   SPA-B70-YY  +   70
      *    £∑£µ∫–§Ú∑ﬁ§®§Î∆¸
           MOVE    WRK-BASEYMD         TO  SPA-BYMD-75
           COMPUTE SPA-B75-YY          =   SPA-B75-YY  +   75
      *
      *    £∑£µ∫–§Œ√¬¿∏∆¸° £»£≤£∞°•£¥§´§È°À
           MOVE    SPA-NAI-BIRTHDAY    TO  WRK-BASEYMD
           MOVE    WRK-BASEYMD         TO  SPA-BYMD-75-2
           COMPUTE SPA-B75-YY2         =   SPA-B75-YY2  +   75
           IF      WRK-BASEYMD(5:4)    =   "0229"
               MOVE    "0301"              TO  SPA-BYMD-75-2(5:4)
           END-IF
      *
      *    ø∑µ¨ £ºÃ∏Â°¢¿∏«Ø∑Ó∆¸ —ππª˛§À ‰Ωı∂Ë ¨§Œ∫∆ ‘Ω∏§Ú§™§≥§ §¶
           IF     (SPA-P02-SYORI       =   1    )  AND
                  (WRK-MAE-NENREI      =   ZERO )
               PERFORM 31011-HKN-HEN-SEC
           END-IF
           .
       410121-NENREI-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ƒÃæŒ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4101-NICKNAME-CHK-SEC          SECTION.
      *
           IF      SPA-GMN-NICKNAME    NOT =   SPACE
      *        »æ≥—∂ı«Ú§Ú¡¥≥—∂ı«Ú§ÿ
               MOVE    SPA-GMN-NICKNAME    TO  WRK-MAE-INPUT
               MOVE    50                  TO  WRK-LEN
               PERFORM 891-HALF-ZEN2-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-NICKNAME
               IF      FLG-ERR             =   1
                   MOVE    "0027"              TO  SPA-ERRCD
                   MOVE    5                   TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4101-NICKNAME-CHK-EXT.
           EXIT.
      *
      ***************************************************************
      *    •∆•π•»¥µº‘ΩËÕ˝
      ***************************************************************
       4101-TSTPTNUMKBN-CHK-SEC         SECTION.
      *
      *    •∆•π•»¥µº‘
           IF      SPA-GMN-TSTPTNUMKBN =   "0"  OR  "1"
               CONTINUE
           ELSE
      *        •®•È°º§Œª˛§π§Ÿ§∆°¢¥µº‘§ÿ
               MOVE    SPA-GMN-TSTPTNUMKBN-LST(1)
                                       TO  SPA-GMN-TSTPTNUMKBN-G
           END-IF
      *
           .
       4101-TSTPTNUMKBN-CHK-EXT.
           EXIT.
      *
      ***************************************************************
      *    •´•Î•∆»Øπ‘•¡•ß•√•ØΩËÕ˝
      ***************************************************************
       4101-HAKKO-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   2
               IF      SPA-GMN-HAKKO   =   SPA-GMN-HAKKO-LST(IDX)(1:1)
                   MOVE    SPA-GMN-HAKKO-LST (IDX)
                                           TO  SPA-GMN-HAKKO-G
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0029"              TO  SPA-ERRCD
               MOVE    6                   TO  SPA-GMN-CUR
           END-IF
      *
           .
       4101-HAKKO-CHK-EXT.
           EXIT.
      *
      ***************************************************************
      *    £’°¶£–•¡•ß•√•ØΩËÕ˝
      ***************************************************************
       4101-USERPG-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-USERPG-MAX
               IF      SPA-GMN-USERPG  =   SPA-GMN-USERPG-LST(IDX)(1:1)
                   MOVE    SPA-GMN-USERPG-LST (IDX)
                                           TO  SPA-GMN-USERPG-G
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0901"              TO  SPA-ERRCD
               MOVE    70                  TO  SPA-GMN-CUR
           END-IF
      *
           .
       4101-USERPG-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Õπ ÿ»÷πÊ •¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4101-POST-CHK-SEC             SECTION.
      *
           IF      SPA-GMN-POST        =   SPACE
               MOVE    SPA-GMN-POST        TO  SPA-MAE-POST
               GO      TO      4101-POST-CHK-EXT
           END-IF
      *
      *    º˛ ’ΩªΩÍ∞ÏÕ˜§ÿ
           IF      SPA-GMN-POST (1:1)  =   "/"
               IF      SPA-GMN-POST (2:3)  NUMERIC
                   PERFORM 41011-SYUHEN-JYUSYO-SEC
               ELSE
                   PERFORM 440-JYUSYO-SEC
               END-IF
               GO      TO      4101-POST-CHK-EXT
           END-IF
      *
      *    ∆˛Œœ§¨§¢§√§øª˛§Œ§ﬂ°¢π‘§¶
           IF      FLG-IN-POST         =   ZERO
               GO      TO      4101-POST-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-POST        TO  SPA-MAE-POST
      *
      *    Õπ ÿ»÷πÊ§Ë§Í°¢ΩªΩÍ∞ÏÕ˜§Ú…Ωº®§π§Î
           INITIALIZE                  SPA-P982-AREA
           MOVE    SPA-GMN-POST        TO  SPA-GMN982-POST
           MOVE    "P02"               TO  SPA-GMN982-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP982"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *    ¬–æ›§ §∑° ∑Ÿπ§»§π§Î°À
           IF      SPA-GMN982-MAX      =   ZERO
               MOVE    "0031"              TO  SPA-ERRCD
               MOVE     40                 TO  SPA-GMN-CUR
               GO  TO  4101-POST-CHK-EXT
           END-IF
      *    £±∑Ô§Œª˛°¢¬–æ›
           IF      SPA-GMN982-MAX      =   1
               MOVE    SPA-GMN982-POST     TO  SPA-GMN-POST
               MOVE    SPA-GMN982-TOWNNAME TO  SPA-GMN-EDITADRS-NAME
               MOVE    SPA-GMN-EDITADRS-NAME
                                           TO  SPA-MAE-ADRS
           ELSE
      *        ΩªΩÍ∞ÏÕ˜≤ËÃÃ§ÿ
               PERFORM 41012-P982-SYORI-SEC
           END-IF
      *
           .
       4101-POST-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    º˛ ’ΩªΩÍ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       41011-SYUHEN-JYUSYO-SEC         SECTION.
      *
      *    •∑•π•∆•‡¥…Õ˝§Ë§Íº˛ ’ΩªΩÍ§Ú∏°∫˜
           INITIALIZE                  SYS-1015-REC
           MOVE    "1015"              TO  SYS-1015-KANRICD
           MOVE    SPA-GMN-POST (2:3)  TO  SYS-1015-KBNCD
           MOVE    SPA-SYSYMD          TO  SYS-1015-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-1015-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-1015-HOSPNUM
           MOVE    SYS-1015-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
               PERFORM 900-SYSTEM-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1015-REC
           ELSE
      *        º˛ ’ΩªΩÍ∞ÏÕ˜§ÿ
               PERFORM 440-JYUSYO-SEC
               GO      TO      41011-SYUHEN-JYUSYO-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
      *    ΩªΩÍ•«°º•ø∆…§ﬂΩ–§∑
           INITIALIZE                      ADRS-REC
           MOVE    SYS-1015-LPUBCD     TO  ADRS-LPUBCD
           MOVE    SYS-1015-POST       TO  ADRS-POST
           MOVE    SYS-1015-RENNUM     TO  ADRS-EDANUM
           MOVE    SPA-HOSPNUM         TO  ADRS-HOSPNUM
           MOVE    ADRS-REC            TO  MCPDATA-REC
           MOVE    "tbl_adrs"          TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_adrs"          TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  ADRS-REC
                   MOVE    ADRS-POST           TO  SPA-GMN-POST
                   MOVE    ADRS-EDITADRS-NAME  TO  SPA-GMN-EDITADRS-NAME
                   MOVE    SPA-GMN-EDITADRS-NAME
                                               TO  SPA-MAE-ADRS
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-IF
           MOVE    "tbl_adrs"          TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      FLG-OK              =   ZERO
      *        º˛ ’ΩªΩÍ∞ÏÕ˜§ÿ
               PERFORM 440-JYUSYO-SEC
           END-IF
           .
       41011-SYUHEN-JYUSYO-EXT.
           EXIT.
      *
      *****************************************************************
      *    ΩªΩÍ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4101-ADRS-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-EDITADRS-NAME       =   SPACE
               MOVE    SPA-GMN-EDITADRS-NAME   TO  SPA-MAE-ADRS
           ELSE
      *        »æ≥—∂ı«Ú§Ú¡¥≥—∂ı«Ú§ÿ
               MOVE    SPA-GMN-EDITADRS-NAME   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-EDITADRS-NAME
               IF      FLG-ERR             =   1
                   MOVE    "0032"              TO  SPA-ERRCD
                   MOVE    41                  TO  SPA-GMN-CUR
               ELSE
      *            Õπ ÿ»÷πÊº´∆∞¿ﬂƒÍ
                   IF     (SPA-GMN-EDITADRS-NAME
                                           NOT =   SPA-MAE-ADRS )
                      AND (SPA-MCP-WIDGET      =   "P02_ADRS"   )
                       PERFORM 41012-ADRS-POST-SEC
                   ELSE
                       MOVE    SPA-GMN-EDITADRS-NAME   TO  SPA-MAE-ADRS
                   END-IF
               END-IF
           END-IF
           .
       4101-ADRS-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ΩªΩÍ§´§ÈÕπ ÿ»÷πÊ ‘Ω∏ΩËÕ˝
      *****************************************************************
       41012-ADRS-POST-SEC         SECTION.
      *
      *    Õπ ÿ»÷πÊ§Ë§Í°¢ΩªΩÍ∞ÏÕ˜§Ú…Ωº®§π§Î
           INITIALIZE                  SPA-P982-AREA
           MOVE    2                   TO  SPA-GMN982-KBN
           MOVE    SPA-GMN-EDITADRS-NAME
                                       TO  SPA-GMN982-TOWNNAME
           MOVE    "P02"               TO  SPA-GMN982-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP982"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
      *    £±∑Ô§Œª˛°¢¬–æ›
           IF      SPA-GMN982-MAX      =   1
               IF      SPA-GMN982-POST     NOT =   SPA-GMN-POST
                   MOVE    SPA-GMN982-POST     TO  SPA-GMN-POST
                   MOVE    SPA-GMN982-TOWNNAME TO  SPA-GMN-EDITADRS-NAME
               ELSE
                   IF      SPA-GMN982-TOWNNAME =   SPA-GMN-EDITADRS-NAME
                       CONTINUE
                   ELSE
                       MOVE    "1098"          TO  SPA-PIDCD
                   END-IF
               END-IF
               MOVE    SPA-GMN-POST            TO  SPA-MAE-POST
               MOVE    SPA-GMN-EDITADRS-NAME   TO  SPA-MAE-ADRS
           ELSE
               IF      SPA-GMN982-MAX      >   1
                   PERFORM 41012-P982-SYORI-SEC
               END-IF
           END-IF
      *
           .
       41012-ADRS-POST-EXT.
           EXIT.
      *****************************************************************
      *    ΩªΩÍ∞ÏÕ˜¡´∞‹ΩËÕ˝
      *****************************************************************
       41012-P982-SYORI-SEC         SECTION.
      *
      *    ΩªΩÍ∞ÏÕ˜≤ËÃÃ§ÿ
           MOVE    "SELNUM"            TO  MCP-WIDGET
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
      *
      *    ∞ÏÕ˜§ÿ
           MOVE    "P982"              TO  SPA-SAKIPG
           MOVE    "P02"               TO  SPA-MOTOPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    "P982"              TO  MCP-WINDOW
           PERFORM 900-PUT-WINDOW
           MOVE    1                   TO  SPA-FLG-END
      *
           .
       41012-P982-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    »÷√œ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4101-BANTI-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-BANTI   NOT =   SPACE
      *        »æ≥—∂ı«Ú§Ú¡¥≥—∂ı«Ú§ÿ
               MOVE    SPA-GMN-BANTI       TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-BANTI
               IF      FLG-ERR             =   1
                   MOVE    "0032"              TO  SPA-ERRCD
                   MOVE    42                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4101-BANTI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿§¬”ºÁ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4101-SETAINUSI-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-SETAINUSI   NOT =   SPACE
      *        »æ≥—∂ı«Ú§Ú¡¥≥—∂ı«Ú§ÿ
               MOVE    SPA-GMN-SETAINUSI   TO  WRK-MAE-INPUT
               MOVE    50                  TO  WRK-LEN
               PERFORM 891-HALF-ZEN2-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-SETAINUSI
               IF      FLG-ERR             =   1
                   MOVE    "0033"              TO  SPA-ERRCD
                   MOVE    47                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4101-SETAINUSI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¬≥ ¡•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4101-ZOKUGARA-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-ZOKUGARA    NOT =   SPACE
      *        »æ≥—∂ı«Ú§Ú¡¥≥—∂ı«Ú§ÿ
               MOVE    SPA-GMN-ZOKUGARA    TO  WRK-MAE-INPUT
               MOVE    30                  TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-ZOKUGARA
               IF      FLG-ERR             =   1
                   MOVE    "0034"              TO  SPA-ERRCD
                   MOVE    48                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4101-ZOKUGARA-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∏∫Ã»ªˆÕ≥•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4101-DISCOUNTKBN-CHK-SEC        SECTION.
      *
      *    ∏∫Ã»ªˆÕ≥§¨Ã§∆˛Œœ
      *    IF      SPA-GMN-DISCOUNTKBN =   SPACE
      *        MOVE    ZERO            TO  SPA-GMN-DISCOUNTKBN
      ******** GO  TO                  4101-DISCOUNTKBN-CHK-EXT
      *    END-IF
      *    ∏∫Ã»ªˆÕ≥§Ë§Í≥‰∞˙Œ®∂Ë ¨§ÚºË∆¿
           MOVE    SPACE               TO  WRK-RATEKBN
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING   IDX   FROM    1   BY  1
                   UNTIL   ( IDX       >   SPA-DISCOUNTKBN-MAX )
                   OR      ( SPA-GMN-DISCOUNTKBN-KBNCD (IDX)
                                             =   SPACE )
               IF      SPA-GMN-DISCOUNTKBN
                                   =   SPA-GMN-DISCOUNTKBN-KBNCD (IDX)
                   MOVE    1               TO  FLG-CHK
                   MOVE    SPA-GMN-DISCOUNTKBN-RATEKBN (IDX)
                                           TO  WRK-RATEKBN
                   MOVE    SPA-DISCOUNTKBN-MAX TO  IDX
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0019"              TO  SPA-ERRCD
               MOVE    45                  TO  SPA-GMN-CUR
               GO  TO                  4101-DISCOUNTKBN-CHK-EXT
           END-IF
      *
      *    ∏´§ƒ§´§È§ §§æÏπÁ°¢•ª•√•»§∑§ §§
           IF      WRK-RATEKBN             =   SPACE
               GO  TO                  4101-DISCOUNTKBN-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-DISCOUNTKBN     TO  SPA-MAE-DISCOUNTKBN
      *    ∏∫Ã»ªˆÕ≥§Ú∆˛Œœª˛§Œ§ﬂ°¢≥‰∞˙Œ®¿ﬂƒÍ
           IF      FLG-IN-DISCOUNTKBN  =   ZERO
               GO  TO                  4101-DISCOUNTKBN-CHK-EXT
           END-IF
      *
           MOVE    SPACE               TO  WRK-RATE-AREA
           PERFORM   VARYING   IDX   FROM    1   BY  1
                     UNTIL  ( IDX     >     SPA-DISCOUNT-MAX )
                     OR     ( SPA-GMN-DISCOUNT-KBNCD (IDX)  =   SPACE )
      *
             IF  WRK-RATEKBN           =   SPA-GMN-DISCOUNT-KBNCD (IDX)
                 MOVE    SPA-GMN-DISCOUNT-KBNCD(IDX)
                                       TO  WRK-RATE-KBN
                 MOVE    SPA-GMN-DISCOUNT-RITU (IDX)
                                       TO  WRK-RATE-EDITZ
                 EVALUATE    SPA-GMN-DISCOUNT-TEIRITU (IDX)
                 WHEN    "0"
                     MOVE    "≥∫≈ˆ§ §∑"    TO  WRK-RATE-EDIT-R
                 WHEN    "1"
                     MOVE    "(%)"         TO  WRK-RATE-TANI
                 WHEN    "2"
                     MOVE    "(±ﬂ)"        TO  WRK-RATE-TANI
                 END-EVALUATE
                 MOVE    SPA-DISCOUNT-MAX  TO  IDX
             END-IF
           END-PERFORM
           MOVE    WRK-RATE-AREA       TO  SPA-GMN-DISCOUNT
      *
           .
       4101-DISCOUNTKBN-CHK-EXT.
           EXIT.
      *
      ***************************************************************
      *    ≥‰∞˙Œ®•¡•ß•√•ØΩËÕ˝
      ***************************************************************
       4101-DISCOUNT-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-DISCOUNT-MAX)  OR
                              (SPA-GMN-DISCOUNT-KBNCD(IDX)
                                           =   SPACE  )
               IF      SPA-GMN-DISCOUNT(1:2)
                                       =   SPA-GMN-DISCOUNT-KBNCD
                                                              (IDX)
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0035"              TO  SPA-ERRCD
               MOVE    46                  TO  SPA-GMN-CUR
           END-IF
      *
           .
       4101-DISCOUNT-CHK-EXT.
           EXIT.
      ***************************************************************
      *    ∆˛∂‚ ˝À°•¡•ß•√•ØΩËÕ˝
      ***************************************************************
       4101-NYUKIN-HOHO-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-NYUKIN-MAX)
                          OR  (FLG-CHK     =   1   )
               IF      SPA-GMN-NYUKIN-HOHO
                                           =   SPA-GMN-NYUKIN-HOHOL
                                                              (IDX)
                   MOVE    SPA-GMN-NYUKIN-LST (IDX)
                                           TO  SPA-GMN-NYUKIN-HOHO-G
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           IF      FLG-CHK             =   ZERO
               MOVE    "0166"              TO  SPA-ERRCD
               MOVE    66                  TO  SPA-GMN-CUR
           END-IF
      *
           .
       4101-NYUKIN-HOHO-CHK-EXT.
           EXIT.
      ***************************************************************
      *    ¿¡µ·ΩÒ»Øπ‘∂Ë ¨•¡•ß•√•ØΩËÕ˝
      ***************************************************************
       4101-SKYPRTFLG-CHK-SEC         SECTION.
      *
           IF      SPA-GMN-SKYPRTFLG   =   SPACE
               MOVE    SPACE               TO  SPA-GMN-SKYPRTFLG-G
           ELSE
               MOVE    ZERO                TO  FLG-CHK
               PERFORM VARYING     IDX     FROM    1   BY  1
                       UNTIL      (IDX         >   SPA-SKYPRTFLG-MAX)
                              OR  (FLG-CHK     =   1   )
                   IF      SPA-GMN-SKYPRTFLG
                                           =   SPA-GMN-SKYPRTFLG-LST
                                                         (IDX)(1:1)
                       MOVE    SPA-GMN-SKYPRTFLG-LST (IDX)
                                           TO  SPA-GMN-SKYPRTFLG-G
                       MOVE    1               TO  FLG-CHK
                   END-IF
               END-PERFORM
               IF      FLG-CHK             =   ZERO
                   MOVE    "0167"              TO  SPA-ERRCD
                   MOVE    67                  TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
           .
       4101-SKYPRTFLG-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    æı¬÷ÃææŒ•ª•√•»ΩËÕ˝
      ****************************************************************
       4101-CONDITIONH-SET-SEC         SECTION.
      *
           PERFORM VARYING   IDX       FROM    1   BY  1
                   UNTIL    (IDX       >  3    )  OR
                            (SPA-ERRCD NOT =   SPACE )
               MOVE    ZERO                TO  FLG-CHK
               PERFORM VARYING   IDY       FROM    1   BY  1
                       UNTIL   ( IDY       >   SPA-CONDITION-MAX(IDX))
                       OR      ( SPA-GMN-CONDITION-KBNCD (IDX IDY)
                                           =   SPACE )
                   IF      SPA-GMN-CONDITION (IDX)(1:2)
                                           =   SPA-GMN-CONDITION-KBNCD
                                                            (IDX IDY)
                       MOVE    SPA-GMN-CONDITION-WORD (IDX IDY)
                                           TO  SPA-GMN-CONDITIONH (IDX)
                       MOVE    1           TO  FLG-CHK
                   END-IF
               END-PERFORM
               IF      FLG-CHK         =   ZERO
                   MOVE    "0036"          TO  SPA-ERRCD
                   EVALUATE    IDX
                       WHEN    1
                           MOVE    49          TO  SPA-GMN-CUR
                       WHEN    2
                           MOVE    50          TO  SPA-GMN-CUR
                       WHEN    3
                           MOVE    51          TO  SPA-GMN-CUR
                   END-EVALUATE
               END-IF
           END-PERFORM
      *
           .
       4101-CONDITIONH-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∂ÿ¥˜¬æ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4101-COMMENT-CHK-SEC          SECTION.
      *
           IF      SPA-GMN-TABOO-1     NOT =   SPACE
               MOVE    SPA-GMN-TABOO-1     TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-TABOO-1
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    52                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-TABOO-2     NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-TABOO-2     TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-TABOO-2
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    53                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-ALLERGY-1     NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-ALLERGY-1   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-ALLERGY-1
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    54                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-ALLERGY-2     NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-ALLERGY-2   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-ALLERGY-2
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    55                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-KANSENSYO-1 NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-KANSENSYO-1 TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-KANSENSYO-1
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    56                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           IF     (SPA-GMN-KANSENSYO-2 NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-KANSENSYO-2 TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-ATO-INPUT       TO  SPA-GMN-KANSENSYO-2
               IF      FLG-ERR             =   1
                   MOVE    "0030"              TO  SPA-ERRCD
                   MOVE    57                  TO  SPA-GMN-CUR
               END-IF
           END-IF
      *    •≥•·•Û•»
           IF     (SPA-GMN-COMMENT-1   NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-COMMENT-1   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-MAE-INPUT       TO  SPA-GMN-COMMENT-1
           END-IF
           IF     (SPA-GMN-COMMENT-2   NOT =   SPACE ) AND
                  (SPA-ERRCD               =   SPACE )
               MOVE    SPA-GMN-COMMENT-2   TO  WRK-MAE-INPUT
               MOVE    100                 TO  WRK-LEN
               PERFORM 890-HALF-ZEN-SEC
               MOVE    WRK-MAE-INPUT       TO  SPA-GMN-COMMENT-2
           END-IF
           .
       4101-COMMENT-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¡™¬Ú»÷πÊ•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       4101-SELNUM-CHK-SEC      SECTION.
      *
           IF      SPA-GMN-SELNUM  NOT =   ZERO
               MOVE    ZERO                TO  FLG-CHK
               PERFORM VARYING   IDX       FROM    1   BY  1
                       UNTIL     IDX       >  SPA-HKNCOMBI-MAX
                   IF      SPA-GMN-SELNUM  =   SPA-GMN-THKNCOMBINUM(IDX)
                       IF      SPA-NAI-THYOJIKBN (IDX)  =   "1"
                           MOVE    "0137"          TO  SPA-ERRCD
                           MOVE    38              TO  SPA-GMN-CUR
                       END-IF
                       MOVE    1               TO  FLG-CHK
                   END-IF
               END-PERFORM
               IF      FLG-CHK             =   ZERO
                   MOVE    "0037"              TO  SPA-ERRCD
                   MOVE    38                  TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
      *
       4101-SELNUM-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ø«Œ≈≤ •¡•ß•√•ØΩËÕ˝
      ****************************************************************
       4101-SRYKA-CHK-SEC      SECTION.
      *
           IF      SPA-GMN-SRYKA   NOT =   SPACE
               MOVE    ZERO                TO  FLG-CHK
               PERFORM VARYING   IDX       FROM    1   BY  1
                       UNTIL     IDX       >   SPA-SRYKA-MAX
                   IF      SPA-GMN-SRYKA   =   SPA-GMN-SRYKA-LST (IDX)
                                                              (1:2)
                       MOVE    1               TO  FLG-CHK
                   END-IF
               END-PERFORM
               IF      FLG-CHK             =   ZERO
                   MOVE    "0038"              TO  SPA-ERRCD
                   MOVE    39                  TO  SPA-GMN-CUR
               END-IF
           ELSE
      *        •´•Î•∆»Øπ‘ª˛§œ°¢…¨ø‹§»§π§Î
               IF      SPA-GMN-HAKKO       =   "1"
                   MOVE    "0039"              TO  SPA-ERRCD
                   MOVE    39                  TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
           .
      *
       4101-SRYKA-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ≈–œø¡∞°¢…¨ø‹∆˛Œœ•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       4109-TOUROKU-CHK-SEC      SECTION.
      *
      *    ≈–œøª˛°¢…¨ø‹∆˛Œœ•¡•ß•√•Ø
           IF      SPA-GMN-KANANAME    =   SPACE
               MOVE    "0100"              TO  SPA-ERRCD
               MOVE    1                   TO  SPA-GMN-CUR
               GO      TO      4109-TOUROKU-CHK-EXT
           END-IF
           IF      SPA-GMN-NAME        =   SPACE
               MOVE    "0101"              TO  SPA-ERRCD
               MOVE    2                   TO  SPA-GMN-CUR
               GO      TO      4109-TOUROKU-CHK-EXT
           END-IF
           IF      SPA-GMN-SEX         =   SPACE
               MOVE    "0103"              TO  SPA-ERRCD
               MOVE    3                   TO  SPA-GMN-CUR
               GO      TO      4109-TOUROKU-CHK-EXT
           END-IF
           IF      SPA-GMN-BIRTHDAYW   =   SPACE
               MOVE    "0102"              TO  SPA-ERRCD
               MOVE    4                   TO  SPA-GMN-CUR
               GO      TO      4109-TOUROKU-CHK-EXT
           END-IF
      *
      *    µÏ¿´Õ˙ŒÚ§Œππø∑
           PERFORM 41091-KYUSEI-KOU-SEC
      *
           .
      *
       4109-TOUROKU-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    µÏ¿´Õ˙ŒÚ§Œππø∑ΩËÕ˝
      ****************************************************************
       41091-KYUSEI-KOU-SEC      SECTION.
      *    ø∑µ¨§Œª˛°¢µÏ¿´Õ˙ŒÚ§œΩ–Œœ§∑§ §§
           IF      SPA-P02-SYORI       =   1
               GO      TO      41091-KYUSEI-KOU-EXT
           END-IF
      *
           MOVE    ZERO                TO  IDX
           IF     (SPA-OLD-NAME    NOT =   SPACE   )  AND
                  (SPA-GMN-NAME    NOT =   SPACE   )  AND
                  (SPA-GMN-NAME    NOT =   SPA-OLD-NAME)
               MOVE    SPA-NAI25-KYU-MAX   TO  IDX
               IF    ( IDX                         >   ZERO      ) AND
                     ((SPA-GMN25-KYU-CHGYMD(IDX)   =   SPA-SYSYMD) OR
                      (SPA-GMN25-KYU-NAME  (IDX)   =   SPA-OLD-NAME
                  AND  SPA-GMN25-KYU-KANANAME(IDX) =   SPA-OLD-KANANAME
                  AND  SPA-GMN25-KYU-NICKNAME(IDX) =  SPA-OLD-NICKNAME))
                   CONTINUE
               ELSE
                   ADD     1               TO  IDX
                   IF      IDX             >   20
                      MOVE    "2510"           TO  SPA-ERRCD
                      MOVE    1                TO  SPA-GMN-CUR
                      GO      TO      41091-KYUSEI-KOU-EXT
                   END-IF
                   ADD     1               TO  SPA-NAI25-KYU-MAX
      *
                   MOVE    SPA-OLD-NAME    TO  SPA-GMN25-KYU-NAME
                                                               (IDX)
                   MOVE    SPA-OLD-KANANAME
                                           TO  SPA-GMN25-KYU-KANANAME
                                                                (IDX)
                   MOVE    SPA-OLD-NICKNAME
                                           TO  SPA-GMN25-KYU-NICKNAME
                                                                (IDX)
                   MOVE    SPA-SYSYMD      TO  SPA-GMN25-KYU-CHGYMD
                                                               (IDX)
                   MOVE    SPA-SYSYMDWH    TO  SPA-GMN25-KYU-CHGYMDW
                                                              (IDX)
                   MOVE    SPA-SYSYMD      TO  SPA-GMN25-KYU-UPYMD(IDX)
               END-IF
           END-IF
      *
           .
      *
       41091-KYUSEI-KOU-EXT.
           EXIT.
      *
      ****************************************************************
      *     ›∏±°¶∏¯»Ò§Œ•∆°º•÷•Î•ª•√•»ΩËÕ˝
      ****************************************************************
       4103-HKNKOH-TBL-SEC      SECTION.
      *
      *     ›∏±≤ËÃÃ§Œ∆‚Õ∆§Ú£‘£¬£Ã§ÿ ‘Ω∏§π§Î
           PERFORM 41031-HKN-SPA-TBL-SET-SEC
      *
      *    ∏¯»Ò≤ËÃÃ§Œ∆‚Õ∆§Ú£‘£¬£Ã§ÿ ‘Ω∏§π§Î
           PERFORM 41032-KOH-SPA-TBL-SET-SEC
      *
      *     ›∏±§»∏¯»Ò§Œ¥¸¥÷Ω≈ £•¡•ß•√•Ø
           PERFORM 41033-HKNKOH-CHK-SEC
      *
      *!!
      *TEST
      *    ¬‡ø¶πÒ ›§Œ«ØŒ•¡•ß•√•Ø° £»£≤£∞°•£¥ ≤˛¿µ°À
           IF     (FLG-KOH-ADD2         =   ZERO  )
              AND (FLG-ERRCHK           =   ZERO  )
              AND (FLG-HKN-ADD2         =   ZERO  )
              AND (SPA-ERRCD            =   SPACE )
               IF     (SPA-SYSYMD          >=  "20080401" )  AND
                      (SPA-BYMD-65         >   ZERO       )  AND
                      (SPA-SYSYMD          >=  SPA-BYMD-65)
                   PERFORM 410334-TAIKOKUHO-CHK-SEC
               END-IF
           END-IF
      *    £»£±£¥°•£±£∞ ≤˛¿µ
      *!   IF      FLG-TOUROKU2         =   1
      *    ∏¯»Òƒ…≤√∞ ≥∞
           IF      FLG-KOH-ADD2         =   ZERO
              AND  FLG-ERRCHK           =   ZERO
              AND  FLG-HKN-ADD2         =   ZERO
              AND (SPA-ERRCD            =   SPACE )
              AND (SPA-PIDCD            =   SPACE )
      *!!
      *        £∑£∞∫–∞ æÂ§Œª˛°¢œ∑øÕ≥‰πÁ§¨¿ﬂƒÍ§µ§Ï§∆§§§Î§≥§»
               IF     (SPA-SYSYMD          >=  "20021001" )  AND
                      (SPA-BYMD-70         >   ZERO       )  AND
                      (SPA-SYSYMD          >=  SPA-BYMD-70)
                   PERFORM 410331-RJN-HKNCHK-SEC
               ELSE
      *        £»£±£∏°•£±£∞ ≤˛¿µ
      *        œ∑øÕ∏¯»Ò£≤≥‰•¡•ß•√•Ø
                   PERFORM 410332-RJN27-CHK-SEC
               END-IF
           END-IF
      *    £»£≤£∞°•£¥ ≤˛¿µ
           IF     (FLG-TOUROKU2         =   1   )
             AND  (SPA-ERRCD            =   SPACE )
             AND  (SPA-PIDCD            =   SPACE )
      *        œ∑øÕ∏¯»ÒΩ™Œª•¡•ß•√•Ø
               PERFORM 410333-RJN27-ENDCHK-SEC
           END-IF
           .
      *
       4103-HKNKOH-TBL-EXT.
           EXIT.
      *
      *
      ****************************************************************
      *     ›∏±≤ËÃÃ§Œ∆‚Õ∆§Ú£‘£¬£Ã§ÿ ‘Ω∏ΩËÕ˝
      ****************************************************************
       41031-HKN-SPA-TBL-SET-SEC      SECTION.
      *
           IF      SPA-GMN-HKNNUM      =   SPACE
      *        ∂ı«Úπ‘∫ÔΩ¸
               PERFORM 410311-HKNTBL-DEL-SEC
               GO      TO      41031-HKN-SPA-TBL-SET-EXT
           END-IF
      *
           IF      SPA-NAI-HKNSTR      =   ZERO
      *        ø∑µ¨§Œª˛°¢£±π‘≥´§±§Î
               PERFORM 410311-HKNTBL-INS-SEC
               MOVE    1                   TO  IDX
           ELSE
               MOVE    SPA-NAI-HKNSTR      TO  IDX
           END-IF
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      41031-HKN-SPA-TBL-SET-EXT
           END-IF
           PERFORM 410312-HKN-SPATBL-SET-SEC
      *
      *    ∂ı«Úπ‘∫ÔΩ¸
           PERFORM 410311-HKNTBL-DEL-SEC
      *
      *     ›∏±æ Û£‘£¬£Ã§´§È ‘Ω∏
           IF      SPA-NAI-HKNSTR      =   ZERO
               MOVE    1               TO  SPA-NAI-HKNSTR
           END-IF
           PERFORM 3101-HKN-TBL-SPA-SEC
           .
      *
       41031-HKN-SPA-TBL-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *     ›∏±•∆°º•÷•Î∂ı«Úπ‘∫ÔΩ¸ΩËÕ˝
      ****************************************************************
       410311-HKNTBL-DEL-SEC      SECTION.
      *
      *    ∂ı«Úπ‘§Ú§ƒ§·§Î
           MOVE    ZERO                TO  IDY
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               IF     (IDX                 <   40  )  AND
                      (SPA-PTHKN-HKNNUM (IDX)  =   SPACE)
                   MOVE    SPA-PTHKNINF-TBL (IDX + 1)
                                           TO  SPA-PTHKNINF-TBL (IDX)
                   INITIALIZE              SPA-PTHKNINF-TBL (IDX + 1)
               END-IF
               IF      SPA-PTHKN-HKNNUM (IDX)  NOT =   SPACE
                   MOVE    IDX             TO  IDY
               END-IF
           END-PERFORM
           MOVE    IDY                 TO  SPA-PTHKN-MAX
      *
           .
      *
       410311-HKNTBL-DEL-EXT.
           EXIT.
      *
      ****************************************************************
      *     ›∏±•∆°º•÷•Î£±π‘¡ﬁ∆˛ΩËÕ˝
      ****************************************************************
       410311-HKNTBL-INS-SEC           SECTION.
      *
           IF      (SPA-PTHKN-MAX       >=  TBL-MAX-HKN )
               MOVE    "0107"          TO  SPA-ERRCD
           ELSE
      *
      *    £±π‘≥´§±§Î
           MOVE    ZERO                TO  IDX
           PERFORM VARYING     IDX     FROM    SPA-PTHKN-MAX BY -1
                   UNTIL       IDX     <   1
               MOVE    SPA-PTHKNINF-TBL (IDX)
                                       TO  SPA-PTHKNINF-TBL (IDX + 1)
           END-PERFORM
           INITIALIZE                  SPA-PTHKNINF-TBL (01)
           ADD     1                   TO  SPA-PTHKN-MAX
      *
           END-IF
           .
       410311-HKNTBL-INS-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±≤ËÃÃ¢™£”£–£¡£‘£¬£Ã ‘Ω∏ΩËÕ˝
      *****************************************************************
       410312-HKN-SPATBL-SET-SEC              SECTION.
      *
           MOVE    SPA-GMN-HKNNUM      TO  SPA-PTHKN-HKNNUM (IDX)
           MOVE    SPA-GMN-HKNJANUM    TO  SPA-PTHKN-HKNJANUM (IDX)
           MOVE    SPA-GMN-HONKZKKBN   TO  SPA-PTHKN-HONKZKKBN (IDX)
           MOVE    SPA-GMN-HOJOKBN     TO  SPA-PTHKN-HOJOKBN (IDX)
           MOVE    SPA-GMN-CONTKBN     TO  SPA-PTHKN-CONTKBN (IDX)
           MOVE    SPA-GMN-KIGO        TO  SPA-PTHKN-KIGO    (IDX)
           MOVE    SPA-GMN-NUM         TO  SPA-PTHKN-NUM     (IDX)
           MOVE    SPA-GMN-HIHKNJANAME TO  SPA-PTHKN-HIHKNJANAME (IDX)
           MOVE    SPA-NAI-SKKGETYMD   TO  SPA-PTHKN-SKKGETYMD (IDX)
           MOVE    SPA-NAI-HTEKSTYMD   TO  SPA-PTHKN-TEKSTYMD (IDX)
           MOVE    SPA-NAI-HTEKEDYMD   TO  SPA-PTHKN-TEKEDYMD (IDX)
           MOVE    SPA-NAI-HKAKUNINYMD TO  SPA-PTHKN-KAKUNINYMD (IDX)
      *
           MOVE    SPA-NAI-SAKJOKBN    TO  SPA-PTHKN-SAKJOKBN (IDX)
           MOVE    SPA-NAI-PTHKN-SBTKBN
                                       TO  SPA-PTHKN-HKN-SBTKBN(IDX)
      *
           MOVE    SPA-HKNJA-KEIFLG    TO  SPA-PTHKN-KEIFLG  (IDX)
           MOVE    SPA-KIGO-KEIFLG     TO  SPA-PTHKN-KIGO-KEIFLG (IDX)
           MOVE    SPA-NUM-KEIFLG      TO  SPA-PTHKN-NUM-KEIFLG (IDX)
      *    ∏Â¥¸π‚Œº‘∑Ÿπ
           MOVE    SPA-ROU-KEIFLG      TO  SPA-PTHKN-ROU-KEIFLG (IDX)
      *    ≥Œ«ß«Ø∑Ó∆¸
           MOVE    SPA-HKN-KAKUINFLG   TO  SPA-PTHKN-KAKUINFLG (IDX)
      *
      *    ø∑µ¨§Œª˛ ›∏±£…£ƒºË∆¿° œ´∫“§œœ´∫“≤ËÃÃ§«ºË∆¿§π§Î°À
           IF      SPA-NAI-HKNID       =   ZERO
               ADD     1                   TO  SPA-PTNUM-HKNID
               MOVE    SPA-PTNUM-HKNID     TO  SPA-NAI-HKNID
           END-IF
           MOVE    SPA-NAI-HKNID       TO  SPA-PTHKN-HKNID (IDX)
      *
           IF      SPA-NAI-HKNSTR      =   ZERO
               MOVE    "1"             TO  SPA-PTHKN-SINKIKBN (IDX)
           END-IF
      *
           MOVE    SPA-GMN-HKNNUMMEI   TO  SPA-PTHKN-HKNNUM-MEI(IDX)
           MOVE    SPA-GMN-HONKZKKBNMEI
                                       TO  SPA-PTHKN-HONKZKKBN-MEI(IDX)
           MOVE    SPA-GMN-HOJOKBNMEI  TO  SPA-PTHKN-HOJOKBN-MEI(IDX)
           MOVE    SPA-GMN-CONTKBNMEI  TO  SPA-PTHKN-CONTKBN-MEI(IDX)
           MOVE    SPA-GMN-SKKGETYMD   TO  SPA-PTHKN-SKKGETYMDW(IDX)
           MOVE    SPA-GMN-HTEKSTYMD   TO  SPA-PTHKN-TEKSTYMDW(IDX)
           MOVE    SPA-GMN-HTEKEDYMD   TO  SPA-PTHKN-TEKEDYMDW(IDX)
           MOVE    SPA-GMN-HKAKUNINYMD TO  SPA-PTHKN-KAKUNINYMDW(IDX)
      *
      *
           .
       410312-HKN-SPATBL-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *    ∏¯»Ò≤ËÃÃ§Œ∆‚Õ∆§Ú£‘£¬£Ã§ÿ ‘Ω∏ΩËÕ˝
      ****************************************************************
       41032-KOH-SPA-TBL-SET-SEC      SECTION.
      *
      *     —ππ ¨§Œ§ﬂ
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   3
              IF     (SPA-GMN-KOHNUM      (IDX)  NOT =   SPACE ) AND
                     (SPA-NAI-PTKOH-EDANUM(IDX)  NOT =   ZERO  )
                   MOVE    SPA-NAI-PTKOH-EDANUM(IDX)   TO  IDY
                   PERFORM 3102-KOH-SPATBL-HEN-SEC
              END-IF
           END-PERFORM
      *    ø∑µ¨ ¨§Œ§ﬂ
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   3
              IF     (SPA-GMN-KOHNUM      (IDX)  NOT =   SPACE ) AND
                     (SPA-NAI-PTKOH-EDANUM(IDX)      =   ZERO  )
                   IF     (IDX             =   1  )  AND
                          (SPA-PTKOH-MAX   >   ZERO )
      *                ∫«ΩÈ§Œπ‘ƒ…≤√§Œª˛°¢£±π‘Ã‹§Ú§¢§±§Î
                       PERFORM 410321-KOHTBL-INS-SEC
                       MOVE    1               TO  IDY
                   ELSE
                       ADD     1               TO  SPA-PTKOH-MAX
                       MOVE    SPA-PTKOH-MAX   TO  IDY
                   END-IF
                   PERFORM 3102-KOH-SPATBL-HEN-SEC
              END-IF
           END-PERFORM
      *    ∂ı«Úπ‘∫ÔΩ¸
           PERFORM 410323-KOHTBL-DEL-SEC
      *    ∏¯»Òæ Û£‘£¬£Ã§´§È ‘Ω∏
           IF      SPA-NAI-KOHSTR      =   ZERO
               MOVE    1                   TO  SPA-NAI-KOHSTR
           END-IF
           PERFORM 3101-KOH-TBL-SPA-SEC
           .
      *
       41032-KOH-SPA-TBL-SET-EXT.
           EXIT.
      *
      ****************************************************************
      *    ∏¯»Ò•∆°º•÷•Î£±π‘¡ﬁ∆˛ΩËÕ˝
      ****************************************************************
       410321-KOHTBL-INS-SEC      SECTION.
      *
           MOVE    ZERO                TO  IDX2
           PERFORM VARYING     IDX2    FROM    SPA-PTKOH-MAX BY -1
                   UNTIL       IDX2    <   1
               MOVE    SPA-PTKOHINF-TBL (IDX2)
                                       TO  SPA-PTKOHINF-TBL (IDX2 + 1)
           END-PERFORM
           INITIALIZE                  SPA-PTKOHINF-TBL (01)
           ADD     1                   TO  SPA-PTKOH-MAX
      *
           .
       410321-KOHTBL-INS-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∏¯»Ò≤ËÃÃ¢™£”£–£¡£‘£¬£Ã ‘Ω∏ΩËÕ˝
      *****************************************************************
       3102-KOH-SPATBL-HEN-SEC              SECTION.
      *
           MOVE    SPA-GMN-KOHNUM   (IDX)  TO  SPA-PTKOH-KOHNUM (IDY)
           MOVE    SPA-GMN-FTNJANUM (IDX)  TO  SPA-PTKOH-FTNJANUM (IDY)
           MOVE    SPA-GMN-JKYSNUM  (IDX)  TO  SPA-PTKOH-JKYSNUM (IDY)
           MOVE    SPA-NAI-KTEKSTYMD(IDX)  TO  SPA-PTKOH-TEKSTYMD (IDY)
           MOVE    SPA-NAI-KTEKEDYMD(IDX)  TO  SPA-PTKOH-TEKEDYMD (IDY)
           MOVE    SPA-NAI-KKAKUNINYMD(IDX)
                                           TO  SPA-PTKOH-KAKUNINYMD(IDY)
           MOVE    SPA-NAI-PTKOH-PAYKBN(IDX)
                                           TO  SPA-PTKOH-PAYKBN (IDY)
      *
      ****MOVE    SPA-NAI-KSAKJOKBN (IDX) TO  SPA-PTKOH-SAKJOKBN(IDY)
      *
      *    ø∑µ¨§Œª˛∏¯»Ò£…£ƒºË∆¿
           IF      SPA-NAI-PTKOH-KOHID (IDX)   =   ZERO
               ADD     1                   TO  SPA-PTNUM-KOHID
               MOVE    SPA-PTNUM-KOHID     TO  SPA-NAI-PTKOH-KOHID(IDX)
      *
               MOVE    "1"                 TO  SPA-PTKOH-SINKIKBN (IDY)
           END-IF
           MOVE    SPA-NAI-PTKOH-KOHID (IDX)   TO  SPA-PTKOH-KOHID (IDY)
      *     ›∏±∏¯»ÒºÔ Ã∂Ë ¨
           MOVE   SPA-NAI-PTKOH-SBTKBN (IDX)   TO  SPA-PTKOH-HKN-SBTKBN
                                                                 (IDY)
      *    ¥¸∏¬¿⁄§Ï∂Ë ¨
           MOVE    SPA-NAI-TEKEDCHKKBN (IDX)
                                       TO  SPA-PTKOH-TEKEDCHKKBN(IDY)
           MOVE   SPA-GMN-KOHNUMMEI (IDX)  TO  SPA-PTKOH-KOHNUM-MEI(IDY)
           MOVE   SPA-GMN-KTEKSTYMD (IDX)  TO  SPA-PTKOH-TEKSTYMDW(IDY)
           MOVE   SPA-GMN-KTEKEDYMD (IDX)  TO  SPA-PTKOH-TEKEDYMDW(IDY)
           MOVE   SPA-GMN-KKAKUNINYMD(IDX) TO  SPA-PTKOH-KAKUNINYMDW
                                                                  (IDY)
      *
           MOVE   SPA-NAI-PTKOH-KEIFLG(IDX)    TO  SPA-PTKOH-KEIFLG
                                                                  (IDY)
      *
           MOVE    SPA-KOH-KAKUINFLG (IDX) TO  SPA-PTKOH-KAKUINFLG (IDY)
      *
           .
       3102-KOH-SPATBL-HEN-EXT.
           EXIT.
      *
      ****************************************************************
      *    ∏¯»Ò•∆°º•÷•Î∂ı«Úπ‘∫ÔΩ¸ΩËÕ˝
      ****************************************************************
       410323-KOHTBL-DEL-SEC      SECTION.
      *
      *    ∂ı«Úπ‘§Ú§ƒ§·§Î
           MOVE    ZERO                TO  IDY
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
               IF      SPA-PTKOH-KOHNUM (IDX)  =   SPACE
                   MOVE    SPA-PTKOHINF-TBL (IDX + 1)
                                           TO  SPA-PTKOHINF-TBL (IDX)
                   INITIALIZE              SPA-PTKOHINF-TBL (IDX + 1)
               END-IF
               IF      SPA-PTKOH-KOHNUM (IDX)  NOT =   SPACE
                   MOVE    IDX             TO  IDY
               END-IF
           END-PERFORM
           MOVE    IDY                 TO  SPA-PTKOH-MAX
      *
           .
      *
       410323-KOHTBL-DEL-EXT.
           EXIT.
      *
      ****************************************************************
      *     ›∏±§»∏¯»Ò§Œ¥¸¥÷Ω≈ £•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       41033-HKNKOH-CHK-SEC      SECTION.
      *
      *    πÒ ›° ¬‡ø¶º‘¥ﬁ§‡°À°¶¿∏≥Ë ›∏Ó Ω≈ £•¡•ß•√•Ø
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL      (IDX     >   SPA-PTHKN-MAX )  OR
                              (SPA-ERRCD   NOT =   SPACE )
               IF     (SPA-PTHKN-SAKJOKBN(IDX) =   SPACE    )  AND
                      (SPA-PTHKN-HKNNUM  (IDX) =   "060" OR "067"
      *              ∆√ ÃŒ≈Õ‹»Òƒ…≤√
                                               OR  "068"
                                               OR  "069"
      *              ∏Â¥¸π‚Œº‘
                                               OR  "039"
                                               OR  "040" )
                   PERFORM VARYING  IDY     FROM    1   BY  1
                           UNTIL   (IDY     >   SPA-PTKOH-MAX )  OR
                                   (SPA-ERRCD   NOT =   SPACE )
                      IF       SPA-PTKOH-SAKJOKBN (IDY)    =   SPACE
                           PERFORM 410331-HKNKOH-JYUFUKU-SEC
                      END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
           IF      SPA-GMN-HKNNUM      =   "060" OR "067"
      *        ∆√ ÃŒ≈Õ‹»Òƒ…≤√
                                       OR  "068"
                                       OR  "069"
               MOVE    16              TO  SPA-GMN-CUR
           ELSE
               PERFORM VARYING     IDY     FROM    1   BY  1
                       UNTIL       IDY     >   SPA-KOH-MAX
                   IF      SPA-NAI-PTKOH-SBTKBN (IDY)  =   "5"
                       EVALUATE    IDY
                           WHEN    1
                               MOVE    23          TO  SPA-GMN-CUR
                           WHEN    2
                               MOVE    29          TO  SPA-GMN-CUR
                           WHEN    3
                               MOVE    35          TO  SPA-GMN-CUR
                       END-EVALUATE
                       MOVE    SPA-KOH-MAX         TO  IDY
                   END-IF
               END-PERFORM
           END-IF
      **** IF      SPA-ERRCD           =   SPACE
      *        ∏∫Ã»Ω≈ £•¡•ß•√•Ø
      *        PERFORM 4909-960JYUFUKU-CHK-SEC
      **** END-IF
      *
           .
       41033-HKNKOH-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    £∑£∞∫–∞ æÂ§Œœ∑øÕ ›∏±•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       410331-RJN-HKNCHK-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-RJNCHK
           MOVE    ZERO                TO  FLG-RJNCHK2
           MOVE    ZERO                TO  FLG-HKNCHK
           MOVE    ZERO                TO  FLG-HKNCHK2
           MOVE    ZERO                TO  FLG-SEIHOGO
           MOVE    ZERO                TO  SPA-HKN-IDX1
           MOVE    ZERO                TO  FLG-RJNERR
           MOVE    ZERO                TO  FLG-RJNKOHERR
           MOVE    ZERO                TO  FLG-KOKUHO
      *!!
           MOVE    ZERO                TO  FLG-KOKUHO-CHK
           MOVE    ZERO                TO  WRK-KOKUHO-CHK
      *!!
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               IF     (SPA-PTHKN-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-SAKJOKBN (IDX) NOT =  "1"        )
                   IF      SPA-PTHKN-HKNNUM(IDX)(1:1)  NOT =   "9"
      *                ¡∞¥¸π‚Œº‘°¶∏Â¥¸π‚Œº‘∂Ë ¨»ΩƒÍ
                       PERFORM 4103311-HKNKBN-CHK-SEC
                   END-IF
      *             ›∏±§¨¬∏∫ﬂ§π§Î§≥§»
                   IF      SPA-PTHKN-HKN-SBTKBN (IDX)   =   "1"
                       MOVE    1               TO  FLG-HKNCHK
                       IF      SPA-HKN-IDX1    =   ZERO
                           MOVE    IDX             TO  SPA-HKN-IDX1
                       END-IF
                   ELSE
      *            ¬æ§Œº´»Ò≈˘§¨¬∏∫ﬂ§π§Î§≥§»
                       MOVE    1               TO  FLG-HKNCHK2
                   END-IF
               END-IF
           END-PERFORM
      *
      *    ∏¯»Ò
           MOVE    ZERO                TO  SPA-KOH-IDX2
           MOVE    ZERO                TO  FLG-27KOH-OK
           MOVE    ZERO                TO  FLG-RJNCHK3
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
               IF     (SPA-PTKOH-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
                      (SPA-PTKOH-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"        )
      *            œ∑øÕ
                   IF     (SPA-PTKOH-KOHNUM  (IDX) =   "027" )  OR
                          (SPA-PTKOH-HKN-SBTKBN (IDX)  =   "3" )
      *             £»£≤£∞°•£¥ ∏Â¥¸π‚Œº‘≥∫≈ˆ
                       OR (SPA-PTKOH-KOHNUM  (IDX) =   "968" )
                       MOVE    1                   TO  FLG-RJNCHK2
                   END-IF
      *            ¿∏≥Ë ›∏Ó
                   IF      SPA-PTKOH-KOHNUM  (IDX) =   "012"
                       MOVE    1                   TO  FLG-SEIHOGO
                   END-IF
      *!!          ∏Â¥¸π‚Œº‘»Û≥∫≈ˆ(H21.3)
                   IF      SPA-PTKOH-KOHNUM  (IDX) =   "977"
                       MOVE    1                   TO  FLG-RJNCHK3
                   END-IF
      *!!
               END-IF
      *        £»£±£∏°•£±£∞≤˛¿µ œ∑øÕ£≤≥‰§Ú£≥≥‰§ÿ
               IF     (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"        )
                   IF     (SPA-PTKOH-KOHNUM  (IDX) =   "027" )  AND
                          (SPA-PTKOH-TEKEDYMD(IDX) >=  "20061001") AND
                          (SPA-PTKOH-PAYKBN(IDX)(2:1)  =   "2"   )
      *                ¿⁄¬ÿ§®∏Â§Œ£≥≥‰§¨§¢§Î§≥§»
                       PERFORM 4103319-RJNKOH-CHK-SEC
                       IF      FLG-KOH27           =   1
                           MOVE    1                   TO  FLG-RJNKOHERR
                           MOVE    IDX                 TO  SPA-KOH-IDX2
                       END-IF
                   END-IF
               END-IF
      *        £»£≤£∞°•£¥≤˛¿µ œ∑øÕ∏¯»Ò
               IF     (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"  )   AND
                      (SPA-PTKOH-KOHNUM   (IDX)     =  "027" )  AND
                      (SPA-PTKOH-TEKEDYMD (IDX)     =  "20080331")
                   MOVE    1                   TO  FLG-27KOH-OK
               END-IF
           END-PERFORM
           IF      SPA-SYSYMD          <   "20080401"
      *        ¡∞¥¸π‚Œº‘∂Ë ¨§¨§¢§Í°¢œ∑øÕ∏¯»Ò§¨§ §§ª˛
               IF     (FLG-RJNCHK          =   1   )
                 AND  (FLG-RJNCHK2         =   ZERO)
                 AND  (FLG-RJNERR          =   ZERO)
                 AND  (FLG-RJNKOHERR       =   ZERO)
                   CONTINUE
               ELSE
                   PERFORM 4103311-RJN-CHEK02-SEC
               END-IF
           ELSE
      *        £»£≤£∞°•£¥§´§È
               IF      SPA-SYSYMD          >=  SPA-BYMD-75-2
      *            £∑£µ∫–∞ æÂ§«∏Â¥¸π‚Œº‘§¨§ §§ª˛
                   IF     (FLG-RJNCHK          =   2   )
                       OR (FLG-RJNCHK2         =   1   )
                       IF      (FLG-RJNCHK2        =   1   )
                           AND (FLG-RJNCHK     NOT =   2   )
                           AND (FLG-HKNCHK         =   1   )
      *                 ›∏±§¨§¢§Í°¢∏Â¥¸»Û≥∫≈ˆ§¨§ §§ª˛
                           AND (FLG-RJNCHK3        =   ZERO )
                           MOVE    "0121"              TO  SPA-ERRCD
                           MOVE    10                  TO  SPA-GMN-CUR
                       END-IF
                   ELSE
                       IF     (FLG-HKNCHK         =   1   )
      *                 ›∏±§¨§¢§Í°¢∏Â¥¸»Û≥∫≈ˆ§¨§ §§ª˛
                       AND    (FLG-RJNCHK3        =   ZERO )
                           IF      FLG-HKNCHK2        =    ZERO
                               MOVE    "0120"              TO  SPA-ERRCD
                           ELSE
                               MOVE    "0121"              TO  SPA-ERRCD
                           END-IF
                           MOVE    10                  TO  SPA-GMN-CUR
                       END-IF
                   END-IF
      *!!
      *            ∏Â¥¸»Û≥∫≈ˆ§¨§¢§Í°¢¡∞¥¸π‚Œº‘ ›∏±§¨§ §§ª˛
                   IF     (FLG-RJNCHK3         =   1 )
                   AND    (FLG-HKNCHK          =   1 )
                   AND    (FLG-RJNCHK          =   ZERO )
                       MOVE    "0128"              TO  SPA-ERRCD
                       MOVE    11                  TO  SPA-GMN-CUR
                   END-IF
      *!!
      *            Ω™Œª§π§Î ›∏±§Ú∫∆…Ωº®
                   IF     (SPA-ERRCD           =   "0121" )
                      AND (SPA-HKN-IDX1    NOT =   ZERO   )
                      AND (SPA-NAI-HKNSTR  NOT =   SPA-HKN-IDX1)
                       INITIALIZE                  SPA-GMN-HKN-AREA
                       MOVE    SPA-HKN-IDX1    TO  IDX
                       MOVE    IDX             TO  SPA-NAI-HKNSTR
                       PERFORM 3101-HOKEN-HEN-SEC
                   END-IF
               ELSE
      *            £∑£∞∫–§´§È£∑£µ∫–§ﬁ§«
      *            ¡∞¥¸π‚Œº‘∂Ë ¨§¨§¢§Í°¢œ∑øÕ∏¯»Ò§¨§ §§ª˛
                   IF     (FLG-RJNCHK          =   1   )
                     AND  (FLG-RJNCHK2         =   ZERO)
                     AND  (FLG-RJNERR          =   ZERO)
                     AND  (FLG-RJNKOHERR       =   ZERO)
                       CONTINUE
                   ELSE
                       PERFORM 4103311-RJN-CHEK02-SEC
                   END-IF
               END-IF
           END-IF
      *!!!
      *    ¡∞¥¸π‚Œº‘° £∑£∞∫–°À§« ›∏±§Œ¥¸¥÷ —ππ§¨§ §§æÏπÁ°¢≥Œ«ß«Ø∑Ó∆¸•¡•ß•√•Ø
           IF      (SPA-ERRCD          =   SPACE )
              AND  (SPA-PIDCD          =   SPACE )
              AND  (FLG-KOKUHO-CHK     =   1     )
               MOVE    WRK-KOKUHO-CHK      TO  IDX
               IF     (SPA-PTHKN-KAKUNINYMD (IDX)
                                           >=  SPA-BYMD-70 )
                 OR   (SPA-PTHKN-KAKUNINYMD (IDX)
                                           >=  SPA-SYSYMD  )
                    CONTINUE
               ELSE
                   IF      SPA-KEI-KOUKI3      =   ZERO
                       MOVE    "K151"              TO  SPA-ERRCD
                       MOVE    17                  TO  SPA-GMN-CUR
                       MOVE    1                   TO  SPA-KEI-KOUKI3
                       INITIALIZE                  SPA-GMN-HKN-AREA
                       MOVE    IDX             TO  SPA-NAI-HKNSTR
                       MOVE    IDX             TO  SPA-HKN-IDX1
                       PERFORM 3101-HOKEN-HEN-SEC
                   END-IF
               END-IF
           END-IF
      *
      *
           .
       410331-RJN-HKNCHK-EXT.
           EXIT.
      ****************************************************************
      *    ¡∞¥¸π‚Œº‘°¶œ∑øÕ∏¯»Ò§Œ¿⁄¬ÿ§®°¶•®•È°ºΩËÕ˝
      ****************************************************************
       4103311-RJN-CHEK02-SEC     SECTION.
      *
      *    œ∑øÕ ›∏±§¨§ §Ø°¢ ›∏±§¨¬∏∫ﬂ§π§Îª˛
           IF     (FLG-RJNCHK          =   ZERO  )  AND
                  (FLG-RJNCHK2         =   ZERO  )  AND
                  (FLG-HKNCHK          =   1     )
             AND  (FLG-27KOH-OK        =   ZERO )
      *        £”£∑°•£π°•£≥£∞∞ ¡∞§Œª˛œ∑øÕ∏¯»Ò§¨§¢§Î§≥§»§»§π§Î
               IF     (SPA-NAI-BIRTHDAY    <=  "19320930" )  OR
                      (SPA-SYSYMD          >=  SPA-BYMD-75)
                   MOVE    "0105"              TO  SPA-ERRCD
                   MOVE    20                  TO  SPA-GMN-CUR
               ELSE
      *        π‚Œº‘ ›∏±§Úº´∆∞ —¥π§ÿ
      *            ≥´ªœ∆¸§¨£∑£∞∫–∞ æÂ
                   IF      SPA-PTHKN-TEKSTYMD(SPA-HKN-IDX1)
                                               >=  SPA-BYMD-70
                       MOVE    "1066"              TO  SPA-ERRCD
                       MOVE    11                  TO  SPA-GMN-CUR
                   ELSE
                       MOVE    SPA-PTHKN-HKNNUM-MEI(SPA-HKN-IDX1)
                                                   TO  SPA-PIDMSG
                       MOVE    "0104"              TO  SPA-PIDCD
                       MOVE    8                   TO  SPA-GMN-CUR
                  END-IF
               END-IF
           END-IF
      *    œ∑øÕ∏¯»Ò§¨§ §Ø°¢£≤≥‰§Œ ›∏±§¨¬∏∫ﬂ§π§Îª˛
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PIDCD           =   SPACE )
               IF     (FLG-RJNCHK          =   1     )  AND
                      (FLG-RJNERR          =   1     )  AND
                      (FLG-RJNCHK2         =   ZERO  )
                 AND  (FLG-27KOH-OK        =   ZERO )
                   MOVE    SPA-PTHKN-HKNNUM-MEI(SPA-HKN-IDX1)
                                                   TO  SPA-PIDMSG
                   MOVE    "0110"              TO  SPA-PIDCD
                   MOVE    8                   TO  SPA-GMN-CUR
               END-IF
      *         ‰Ωı∂Ë ¨¡™¬Ú•®•È°º
               IF      FLG-RJNERR          =   2
                   MOVE    "1067"              TO  SPA-ERRCD
                   MOVE    11                  TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
      *    œ∑øÕ∏¯»Ò£≤≥‰§Œ ›∏±§¨¬∏∫ﬂ§π§Îª˛° VER.3.2.0§´§È°À
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PIDCD           =   SPACE )
               IF     (FLG-RJNKOHERR       =   1     )
      *            ≤ËÃÃ∞Ã√÷
                   IF      SPA-KOH-MAX         >=  3
      *                π‘¡ﬁ∆˛
                       MOVE    ZERO                TO  SPA-HKNKOH-FLG
                       PERFORM 4104-KOH-ADD-SEC
                       MOVE    1                   TO  SPA-KOH-GMN2
                   ELSE
                       COMPUTE SPA-KOH-GMN2   =   SPA-KOH-MAX
                                              +   1
                   END-IF
      *
                   IF      SPA-ERRCD           =   SPACE
      *
                   MOVE    ZERO                TO  SPA-KOH-GMN1
                   MOVE    ZERO                TO  FLG-KOH27
                   PERFORM VARYING     IDX-K   FROM    1   BY  1
                           UNTIL       IDX-K   >   3
                       IF     (SPA-NAI-PTKOH-EDANUM(IDX-K)
                                               =   SPA-KOH-IDX2 )
                         AND  (SPA-GMN-KOHNUM (IDX-K)  =   "027" )
                           MOVE    IDX-K           TO  SPA-KOH-GMN1
                       END-IF
                   END-PERFORM
                   MOVE    "0111"              TO  SPA-PIDCD
                   MOVE    21                  TO  SPA-GMN-CUR
      *
               END-IF
      *
               END-IF
           END-IF
      *
           .
       4103311-RJN-CHEK02-EXT.
           EXIT.
      ****************************************************************
      *    ¡∞¥¸π‚Œº‘°¶∏Â¥¸π‚Œº‘∂Ë ¨ΩËÕ˝
      ****************************************************************
       4103311-HKNKBN-CHK-SEC     SECTION.
      *
           EVALUATE    SPA-PTHKN-HKNNUM  (IDX)
      *        πÒ ›
               WHEN    "060"
               WHEN    "068"
      *            £»£±£∏°•£±£∞§ﬁ§«
                   IF     (SPA-PTHKN-TEKEDYMD (IDX) <  "20061001")
                       IF    (SPA-PTHKN-HOJOKBN (IDX)  =   "1"
                                                       OR  "2"
                                                       OR  "4"
                                                       OR  "5")
                           MOVE    1               TO  FLG-RJNCHK
                       END-IF
                   ELSE
                       IF    (SPA-BYMD-70          <  "20061001")
                         AND (SPA-PTHKN-TEKSTYMD (IDX)
                                                   <= SPA-BYMD-70)
                         AND (SPA-SYSYMD           <  "20061001")
                           IF    (SPA-PTHKN-HOJOKBN (IDX)
                                                       =   "1"
                                                       OR  "2"
                                                       OR  "4"
                                                       OR  "5")
                               MOVE    1           TO  FLG-RJNCHK
                           END-IF
                       ELSE
      *                £»£±£∏°•£±£∞∞ πﬂ
                           IF      SPA-PTHKN-HOJOKBN (IDX)  NOT =   "0"
                               MOVE    1               TO  FLG-RJNCHK
                           END-IF
                       END-IF
      *                ¡»πÁπÒ ›∞ ≥∞§œ£≤≥‰•®•È°º
                       IF    (SPA-PTHKN-HKNJANUM(IDX)(3:1)
                                                   NOT =  "3" ) AND
                             (SPA-PTHKN-HOJOKBN (IDX)  =   "2")
                           IF      SPA-PTHKN-TEKSTYMD (IDX)
                                                       <  "20061001"
                               MOVE    1           TO  FLG-RJNERR
                               MOVE    IDX         TO  SPA-HKN-IDX1
                           ELSE
                               MOVE    2           TO  FLG-RJNERR
                               MOVE    IDX         TO  SPA-HKN-IDX1
                           END-IF
                       END-IF
      *                ¡»πÁπÒ ›
                       IF    (SPA-PTHKN-HKNJANUM(IDX)(3:1)
                                                   =  "3" )
                           MOVE    1               TO  FLG-KOKUHO
                       END-IF
      *!!
      *                ≥´ªœ∆¸§¨£∑£∞∫–Ã§À˛§«Ω™Œª∆¸§¨£∑£∞∫–∞ æÂ
                       IF     (SPA-PTHKN-TEKSTYMD (IDX)
                                                   <   SPA-BYMD-70 ) AND
                              (SPA-PTHKN-TEKEDYMD (IDX)
                                                   >   SPA-BYMD-70 )
                           MOVE    1               TO  FLG-KOKUHO-CHK
                           MOVE    IDX             TO  WRK-KOKUHO-CHK
                       END-IF
      *!!
                   END-IF
      *        ¡•∞˜§« ‰Ωı∂Ë ¨§¢§Í
               WHEN    "002"
                   IF     (SPA-PTHKN-HOJOKBN (IDX)     =   "8" OR "9"
                                                       OR  "A" OR "B"
                                                       OR  "C" OR "D"
                                                       OR  "E" OR "F"
                                                       OR  "7"
                                                       OR  "G" OR "H"
                                                       OR  "I"        )
                       MOVE    1                   TO  FLG-RJNCHK
      *                £»£±£∏°•£±£∞≤˛¿µ° œ∑øÕ£≤≥‰§œ —ππ°À
                       IF     (SPA-PTHKN-TEKSTYMD (IDX) <   "20061001")
                          AND (SPA-PTHKN-TEKEDYMD (IDX) >=  "20061001")
                           IF     (SPA-PTHKN-HOJOKBN (IDX) =   "8"
                                                           OR  "D"
                                                           OR  "E"
                                                           OR  "F"  )
                              AND (SPA-PTHKN-CONTKBN (IDX) =   SPACE)
                               MOVE    1               TO  FLG-RJNERR
                               MOVE    IDX             TO  SPA-HKN-IDX1
                           END-IF
                       END-IF
                   END-IF
      *            À‹øÕ§«≤º¡•∏Â§ §È∏Â¥¸π‚Œº‘∞∑§§§»§π§Î
                   IF      (SPA-PTHKN-HOJOKBN (IDX)    =   "A"
                                                       OR  "B"
                                                       OR  "C"
                                                       OR  "D"
                                                       OR  "E"
                                                       OR  "F"
                                                       OR  "G"
                                                       OR  "H"
                                                       OR  "I" )
                       AND (SPA-PTHKN-HONKZKKBN(IDX)   =   "1" )
                       AND (SPA-PTHKN-TEKEDYMD (IDX)   >=  "20080401")
                       MOVE    2                   TO  FLG-RJNCHK
                   END-IF
      *!!
      *                ≥´ªœ∆¸§¨£∑£∞∫–Ã§À˛§«Ω™Œª∆¸§¨£∑£∞∫–∞ æÂ
                       IF     (SPA-PTHKN-TEKSTYMD (IDX)
                                                   <   SPA-BYMD-70 ) AND
                              (SPA-PTHKN-TEKEDYMD (IDX)
                                                   >   SPA-BYMD-70 )
                           MOVE    1               TO  FLG-KOKUHO-CHK
                           MOVE    IDX             TO  WRK-KOKUHO-CHK
                       END-IF
      *!!
      *        ∂¶∫—
               WHEN    "031"
               WHEN    "032"
               WHEN    "033"
               WHEN    "034"
                   IF     (SPA-PTHKN-HOJOKBN (IDX)     =   "8" OR "9"
                                                       OR  "7"
                                                       OR  "B" OR "E"
                                                       OR  "H"       )
      *                £»£±£∏°•£±£∞≤˛¿µ° œ∑øÕ£≤≥‰§œ —ππ°À
                       IF     (SPA-PTHKN-TEKSTYMD (IDX) <   "20061001")
                          AND (SPA-PTHKN-TEKEDYMD (IDX) >=  "20061001")
                           IF     (SPA-PTHKN-HOJOKBN (IDX) =   "8"
                                                           OR  "E"  )
                              AND (SPA-PTHKN-CONTKBN (IDX) =   SPACE)
                               MOVE    1               TO  FLG-RJNERR
                               MOVE    IDX             TO  SPA-HKN-IDX1
                           END-IF
                       END-IF
                       MOVE    1                   TO  FLG-RJNCHK
                   END-IF
      *        ∏Â¥¸π‚Œº‘
               WHEN    "039"
               WHEN    "040"
                   MOVE    2                   TO  FLG-RJNCHK
      *        §Ω§Œ¬æ
               WHEN    OTHER
                   IF      SPA-PTHKN-HOJOKBN (IDX) =   "8"  OR  "9"
                                                   OR  "7"
                       MOVE    1                   TO  FLG-RJNCHK
                   END-IF
      *            £»£±£∏°•£±£∞≤˛¿µ° œ∑øÕ£≤≥‰§œ —ππ°À
                   IF     (SPA-PTHKN-TEKSTYMD (IDX) <   "20061001")
                      AND (SPA-PTHKN-TEKEDYMD (IDX) >=  "20061001")
                       IF     (SPA-PTHKN-HOJOKBN (IDX) =   "8" )
                          AND (SPA-PTHKN-CONTKBN (IDX) =   SPACE)
                           MOVE    1               TO  FLG-RJNERR
                           MOVE    IDX             TO  SPA-HKN-IDX1
                        END-IF
                   END-IF
           END-EVALUATE
      *
           .
       4103311-HKNKBN-CHK-EXT.
           EXIT.
      ****************************************************************
      *    œ∑øÕ∏¯»Ò£≤≥‰•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       410332-RJN27-CHK-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-RJNKOHERR
      *DDD MOVE    ZERO                TO  FLG-KOKUHO
      *    PERFORM VARYING     IDX     FROM    1  BY  1
      *            UNTIL       IDX     >   SPA-PTHKN-MAX
      *        IF     (SPA-PTHKN-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
      *               (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
      *               (SPA-PTHKN-SAKJOKBN (IDX) NOT =  "1"        )
      *            ¡»πÁπÒ ›§ŒÕ≠Ãµ
      *            IF     (SPA-PTHKN-HKNNUM  (IDX) =   "060"
      *                                            OR  "068" )  AND
      *                   (SPA-PTHKN-TEKEDYMD (IDX) <   "20061001")
      *                ¡»πÁπÒ ›
      *                IF    (SPA-PTHKN-HKNJANUM(IDX)(3:1)
      *                                            =  "3" )
      *                    MOVE    1               TO  FLG-KOKUHO
      *                END-IF
      *            END-IF
      *        END-IF
      *DDD END-PERFORM
      *
      *    ∏¯»Ò
           MOVE    ZERO                TO  SPA-KOH-IDX2
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
      ******** IF     (SPA-PTKOH-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
               IF     (SPA-PTKOH-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"        )
      *            £»£±£∏°•£±£∞≤˛¿µ œ∑øÕ£≤≥‰§Ú£≥≥‰§ÿ
                   IF     (SPA-PTKOH-KOHNUM  (IDX) =   "027" )  AND
                          (SPA-PTKOH-TEKEDYMD(IDX) >=  "20061001") AND
                          (SPA-PTKOH-PAYKBN(IDX)(2:1)  =   "2"   )
      *                ¿⁄¬ÿ§®∏Â§Œ£≥≥‰§¨§¢§Î§≥§»
                       PERFORM 4103319-RJNKOH-CHK-SEC
                       IF      FLG-KOH27           =   1
                           MOVE    1                   TO  FLG-RJNKOHERR
                           MOVE    IDX                 TO  SPA-KOH-IDX2
                       END-IF
                   END-IF
               END-IF
           END-PERFORM
      *
      *    œ∑øÕ∏¯»Ò£≤≥‰§Œ ›∏±§¨¬∏∫ﬂ§π§Îª˛
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PIDCD           =   SPACE )
               IF     (FLG-RJNKOHERR       =   1     )
      *            ≤ËÃÃ∞Ã√÷
                   IF      SPA-KOH-MAX         >=  3
      *                π‘¡ﬁ∆˛
                       MOVE    ZERO                TO  SPA-HKNKOH-FLG
                       PERFORM 4104-KOH-ADD-SEC
                       MOVE    1                   TO  SPA-KOH-GMN2
                   ELSE
                       COMPUTE SPA-KOH-GMN2   =   SPA-KOH-MAX
                                              +   1
                   END-IF
      *
                   IF      SPA-ERRCD           =   SPACE
      *
                   MOVE    ZERO                TO  SPA-KOH-GMN1
                   MOVE    ZERO                TO  FLG-KOH27
                   PERFORM VARYING     IDX-K   FROM    1   BY  1
                           UNTIL       IDX-K   >   3
                       IF     (SPA-NAI-PTKOH-EDANUM(IDX-K)
                                               =   SPA-KOH-IDX2 )
                         AND  (SPA-GMN-KOHNUM (IDX-K)  =   "027" )
                           MOVE    IDX-K           TO  SPA-KOH-GMN1
                       END-IF
                   END-PERFORM
                   MOVE    "0111"              TO  SPA-PIDCD
                   MOVE    21                  TO  SPA-GMN-CUR
               END-IF
      *
               END-IF
      *
           END-IF
           .
       410332-RJN27-CHK-EXT.
           EXIT.
      ****************************************************************
      *    œ∑øÕ∏¯»ÒΩ™Œª•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       410333-RJN27-ENDCHK-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-RJNCHK
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               IF     (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-SAKJOKBN (IDX) NOT =  "1"        )
                   IF      SPA-PTHKN-HKNNUM(IDX)    =   "039"
                                                    OR  "040"
      *                ∏Â¥¸π‚Œº‘∂Ë ¨»ΩƒÍ
                       MOVE    1               TO  FLG-RJNCHK
                   END-IF
               END-IF
           END-PERFORM
      *    ∏¯»Ò
           MOVE    ZERO                TO  FLG-RJNCHK2
           MOVE    ZERO                TO  FLG-27KOH-OK
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
               IF     (SPA-PTKOH-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"        )
      *             £»£≤£∞°•£¥ ∏Â¥¸π‚Œº‘≥∫≈ˆ
                   IF     (SPA-PTKOH-KOHNUM  (IDX) =   "968" )
      *!!               ∏Â¥¸π‚Œº‘»Û≥∫≈ˆ(H21.3)
                       OR (SPA-PTKOH-KOHNUM  (IDX) =   "977" )
                       MOVE    1                   TO  FLG-RJNCHK2
                   END-IF
               END-IF
      *        £»£≤£∞°•£¥≤˛¿µ œ∑øÕ∏¯»Ò
               IF     (SPA-PTKOH-SAKJOKBN (IDX) NOT =  "1"  )   AND
                      (SPA-PTKOH-KOHNUM   (IDX)     =  "027" )  AND
                      (SPA-PTKOH-TEKEDYMD (IDX)     =  "20080331")
                  IF     (SPA-PTKOH-KAKUNINYMD (IDX)   <  "20080401")
      *            £¥∑Ó∞ πﬂ§œ≈ˆ∆¸
                  OR    ((SPA-PTKOH-KAKUNINYMD (IDX)   >=  "20080401")
                     AND (SPA-PTKOH-KAKUNINYMD (IDX)   =   SPA-SYSYMD))
                       MOVE    1                   TO  FLG-27KOH-OK
                   END-IF
               END-IF
           END-PERFORM
      *    £≤£∑œ∑øÕ∏¯»Ò§¨£»£≤£∞°•£≥°•£≥£±§«Ω™Œª°¢§´§ƒ°¢∏Â¥¸§¨§ §§ª˛
           IF     (FLG-27KOH-OK        =   1     )
               IF     (FLG-RJNCHK          =   1    )  OR
                      (FLG-RJNCHK2         =   1    )
                   CONTINUE
               ELSE
                   IF      SPA-KEI-KOUKI2       =   ZERO
                       MOVE    1                   TO  SPA-KEI-KOUKI2
                       MOVE    "K123"              TO  SPA-ERRCD
                       MOVE    10                  TO  SPA-GMN-CUR
                   END-IF
               END-IF
           END-IF
           .
       410333-RJN27-ENDCHK-EXT.
           EXIT.
      *!!
      *TEST
      ****************************************************************
      *    ¬‡ø¶πÒ ›•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       410334-TAIKOKUHO-CHK-SEC     SECTION.
      *
           MOVE    ZERO                TO  WRK-NAI-HKNSTR
           MOVE    ZERO                TO  FLG-HKNCHK3
           MOVE    ZERO                TO  FLG-HKNCHK2
           PERFORM VARYING     IDX     FROM    1  BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               IF     (SPA-PTHKN-TEKSTYMD (IDX)    <=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-SYSYMD ) AND
                      (SPA-PTHKN-SAKJOKBN (IDX) NOT =  "1"        )
                   IF     (SPA-PTHKN-HKNNUM   (IDX)    =   "067"  ) AND
                          (SPA-PTHKN-TEKEDYMD (IDX)    >=  SPA-BYMD-65)
                       MOVE    IDX             TO  WRK-NAI-HKNSTR
                       MOVE    1                   TO  FLG-HKNCHK3
                   END-IF
      *            ¬æ ›∏±
                   IF     (SPA-PTHKN-HKNNUM (IDX)  NOT =   "067"  )
                       MOVE    1                   TO  FLG-HKNCHK2
                   END-IF
               END-IF
           END-PERFORM
      *
           IF      WRK-NAI-HKNSTR      >   ZERO
               MOVE    "1051"              TO  SPA-ERRCD
               MOVE    17                  TO  SPA-GMN-CUR
               IF      WRK-NAI-HKNSTR      NOT =   SPA-NAI-HKNSTR
                   INITIALIZE                  SPA-GMN-HKN-AREA
                   MOVE    WRK-NAI-HKNSTR      TO  SPA-NAI-HKNSTR
                   MOVE    SPA-NAI-HKNSTR      TO  IDX
                   PERFORM 3101-HOKEN-HEN-SEC
               END-IF
           END-IF
           .
       410334-TAIKOKUHO-CHK-EXT.
           EXIT.
      *!!
      *TEST
      *
      ****************************************************************
      *     ›∏±§»∏¯»Ò§Œ¥¸¥÷Ω≈ £•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       4103319-RJNKOH-CHK-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-KOH27
           PERFORM VARYING     IDXK    FROM    1   BY  1
                   UNTIL       IDXK    >   SPA-GMN-KOHMAX
               IF     (SPA-GMN-KOHNUML (IDXK)   =   "027" )  AND
                      (SPA-GMN-KOHKBNL (IDXK)   =   "3"   )
                   MOVE    1               TO  FLG-KOH27
                   MOVE    SPA-GMN-KOHMAX  TO  IDXK
               END-IF
           END-PERFORM
      *
           .
       4103319-RJNKOH-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *     ›∏±§»∏¯»Ò§Œ¥¸¥÷Ω≈ £•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       410331-HKNKOH-JYUFUKU-SEC      SECTION.
      *
          IF     (SPA-PTKOH-TEKEDYMD (IDY)
                                       <   SPA-PTHKN-TEKSTYMD (IDX)) OR
                  (SPA-PTKOH-TEKSTYMD (IDY)
                                       >   SPA-PTHKN-TEKEDYMD (IDX))
               CONTINUE
           ELSE
      *        ¿∏≥Ë ›∏Ó§ŒæÏπÁ•®•È°º
               IF      SPA-PTKOH-HKN-SBTKBN (IDY)  =   "5"
                   MOVE    "0089"              TO  SPA-ERRCD
      *
                   IF      SPA-PTHKN-HKNNUM(IDX)    =   "039"
                                                    OR  "040"
                       MOVE    "0124"          TO  SPA-ERRCD
                   END-IF
               END-IF
      *        ªƒŒ±ÀÆøÕ§ŒæÏπÁ•®•È°º
               IF      SPA-PTKOH-KOHNUM (IDY)  =   "025"
                   MOVE    "0126"              TO  SPA-ERRCD
      *
                   IF      SPA-PTHKN-HKNNUM(IDX)    =   "039"
                                                    OR  "040"
                       MOVE    "0125"          TO  SPA-ERRCD
                   END-IF
               END-IF
           END-IF
      *
           .
       410331-HKNKOH-JYUFUKU-EXT.
           EXIT.
      *
      ****************************************************************
      *    ∏¯»Òƒ…≤√ΩËÕ˝
      ****************************************************************
       4104-KOH-ADD-SEC      SECTION.
      *
           IF      SPA-HKNKOH-FLG  NOT =   1
      *        ∏¯»Ò≤ËÃÃ§Œ∆‚Õ∆§Ú£‘£¬£Ã§ÿ ‘Ω∏§π§Î
               PERFORM 41032-KOH-SPA-TBL-SET-SEC
           END-IF
      *    •∆°º•÷•Î∑ÔøÙ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PTKOH-MAX       >=  TBL-MAX-KOH )
               MOVE    "0106"          TO  SPA-ERRCD
               GO      TO      4104-KOH-ADD-EXT
           END-IF
      *
      *    ∫«ΩÈ§Œ£±π‘§Ú≥´§±§Î
           IF      SPA-NAI-PTKOH-EDANUM(1) NOT =   ZERO
               MOVE    SPA-NAI-PTKOH-EDANUM(1) TO  IDX-K2
               INITIALIZE                  SPA-GMN-KOH-AREA
               MOVE    1                   TO  IDY
               PERFORM VARYING     IDX     FROM    IDX-K2 BY  1
                       UNTIL      (IDX     >   SPA-PTKOH-MAX )  OR
                                  (IDY     >=  3    )
                   IF      SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE
                       ADD     1                   TO  IDY
                       MOVE    IDY                 TO  SPA-KOH-MAX
                       PERFORM 3102-KOUHI-HEN-SEC
                   END-IF
               END-PERFORM
           ELSE
               INITIALIZE                  SPA-GMN-KOH-AREA
           END-IF
           MOVE    20                  TO  SPA-GMN-CUR
      *
           .
       4104-KOH-ADD-EXT.
           EXIT.
      *
      *
      ****************************************************************
      *    ¥¡ª˙ª·Ãæ ‘Ω∏ΩËÕ˝
      ****************************************************************
       4101-KANJI-NAME-EDIT-SEC     SECTION.
      *
           MOVE    SPA-GMN-KANANAME
                                   TO  SPA-GMN-OLD-KANANAME
           MOVE    SPA-GMN-NAME
                                   TO  SPA-GMN-OLD-NAME
      *
      **** øÕÃæº≠ΩÒ…‘ª»Õ—§ŒæÏπÁ
      *    IF      SPA-NAI-JINMEI-USE  =   "1"
      *        GO      TO      4101-KANJI-NAME-EDIT-EXT
      **** END-IF
      *
           MOVE    SPACE           TO  WRK-NAME-AREA
      *
           MOVE    SPACE           TO  SPA-P100-AREA
           INITIALIZE              SPA-P100-AREA
      *
      *    ¡¥≥—•π•⁄°º•π§Ú"@@"§À√÷§≠¥π§®§Î
      *    ° §≥§Ï§Ú§∑§∆§™§´§ §§§»"•°°º"§Ú¥ﬁ§‡ ∏ª˙ŒÛ§¨
      *    §¶§ﬁ§Ø ¨≤Ú§«§≠§ §§°£°À
           MOVE    SPA-GMN-KANANAME
                                   TO  WRK-NAME-X-AREA
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   25 )
                OR       ( WRK-NAME-X (IDX1) = SPACE )
      *
               IF  ( WRK-NAME-X (IDX1) =   "°°" )
                   MOVE    "@@"    TO  WRK-NAME-X (IDX1)
               END-IF
      *
           END-PERFORM
      *
      *    •ﬂ•…•Î•Õ°º•‡§¨§¢§ÎøÕ§ÚπÕŒ∏§∑§∆ ‘Ω∏§Úπ‘§¶
           UNSTRING    WRK-NAME-X-AREA
                                   DELIMITED BY    "@@" OR SPACE
           INTO    WRK-NAME-VAL (1)
                   WRK-NAME-VAL (2)
                   WRK-NAME-VAL (3)
           END-UNSTRING
      *
           IF ( WRK-NAME-VAL (3)   NOT =   SPACE )
               MOVE    WRK-NAME-VAL (1)
                                   TO  WRK-NAME-KANA (1)
               MOVE    WRK-NAME-VAL (3)
                                   TO  WRK-NAME-KANA (2)
           ELSE
               MOVE    WRK-NAME-VAL (1)
                                   TO  WRK-NAME-KANA (1)
               MOVE    WRK-NAME-VAL (2)
                                   TO  WRK-NAME-KANA (2)
           END-IF
      *
      *    ª· ‘Ω∏
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >       2 )
      *
               PERFORM 4101-KANJI-NAME-SELECT-SEC
      *
               MOVE    WRK-KANJINAME-T (1)
                                   TO  WRK-NAME-KANJI (IDX1)
               MOVE    WRK-KANJINAME-AREA
                                   TO  SPA-GMN-P100-KANJILST-ITM-AREA
                                                                (IDX1)
               MOVE    CNT-JINMEI  TO  SPA-GMN-P100-KANJILST-COUNT
                                                                (IDX1)
      *
           END-PERFORM
      *
      *    ¥¡ª˙ª·Ãæ∏°∫˜≤ËÃÃ∏∆Ω–
           PERFORM SPA-GMN-P100-CALL-SEC
      *
           .
      *
       4101-KANJI-NAME-EDIT-EXT.
           EXIT.
      ****************************************************************
      *    ¥¡ª˙ª·Ãæ∏°∫˜ΩËÕ˝
      ****************************************************************
       4101-KANJI-NAME-SELECT-SEC      SECTION.
      *
           MOVE    ZERO                TO  FLG-NAME (IDX1)
      *
           MOVE    SPACE               TO  WRK-KANJINAME-AREA
           MOVE    ZERO                TO  FLG-JINMEI
                                           CNT-JINMEI
      *
           IF  ( WRK-NAME-KANA (IDX1)  =   SPACE )
               MOVE    1               TO  FLG-NAME (IDX1)
               GO  TO  4101-KANJI-NAME-SELECT-EXT
           END-IF
      *
           MOVE    WRK-NAME-KANA (IDX1)
                                       TO  JINMEI-KANA
      *
      *    øÕÃæ•∆°º•÷•Î∏°∫˜ΩËÕ˝
           PERFORM 941-JINMEI-SELECT-SEC
      *
           PERFORM UNTIL ( FLG-JINMEI  =   1 )
                    OR   ( CNT-JINMEI >=   50 )
      *
      *        øÕÃæ•∆°º•÷•Î∆…π˛ΩËÕ˝
               PERFORM 941-JINMEI-NEXT-SEC
               IF  ( FLG-JINMEI        =   ZERO )
                   COMPUTE CNT-JINMEI  =   CNT-JINMEI  +   1
                   MOVE    JINMEI-KANJI
                                       TO  WRK-KANJINAME-T (CNT-JINMEI)
               END-IF
      *
           END-PERFORM
      *
           PERFORM 941-JINMEI-CLOSE-SEC
      *
           IF  ( CNT-JINMEI   >=   50 )
               GO  TO  4101-KANJI-NAME-SELECT-EXT
           END-IF
      *
      *    •´•ø•´• §Ú∞ÏÕ˜§Œ∫«∏Â§À∫‹§ª§Î
      *    ° ¥˚§À•Í•π•»§À¬∏∫ﬂ§∑§∆§§§ÎæÏπÁ§œ∫‹§ª§ §§°À
           SET     IDX-NAME    TO  1
           SEARCH  WRK-KANJINAME-OCC   VARYING  IDX-NAME
           AT  END
               COMPUTE CNT-JINMEI  =   CNT-JINMEI  +   1
               MOVE    WRK-NAME-KANA (IDX1)
                                   TO  WRK-KANJINAME-T (CNT-JINMEI)
           WHEN    WRK-KANJINAME-T (IDX-NAME)
                                   =   WRK-NAME-KANA (IDX1)
               CONTINUE
           END-SEARCH
           .
      *
       4101-KANJI-NAME-SELECT-EXT.
           EXIT.
      ****************************************************************
      *    •´• ª·Ãæ∏°∫˜≤ËÃÃ∏∆Ω–ΩËÕ˝
      ****************************************************************
       SPA-GMN-P100-CALL-SEC           SECTION.
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >       2 )
               MOVE    "°°°°°°°°°°°°°°°°°°°°°°°°°°°°"
                                   TO  SPA-GMN-P100-KANANAME (IDX1)
      *
               STRING  WRK-NAME-KANA (IDX1)
                                   DELIMITED   BY  SPACE
               INTO    SPA-GMN-P100-KANANAME (IDX1)
               END-STRING
      *
      *
               IF  ( FLG-NAME (IDX1)   =   ZERO )
                   MOVE    WIDGET-NORMAL
                               TO  SPA-GMN-P100-SELNUM-STATE  (IDX1)
                   MOVE   1        TO  SPA-GMN-P100-SELNUM (IDX1)
                   MOVE   SPA-GMN-P100-KANJILST-KANJI (IDX1 1)
                               TO  SPA-GMN-P100-KANJINAME (IDX1)
               ELSE
                   MOVE    WIDGET-INSENSITIVE
                               TO  SPA-GMN-P100-SELNUM-STATE (IDX1)
                   MOVE    1   TO  SPA-GMN-P100-KANJILST-COUNT (IDX1)
                   MOVE    "≥∫≈ˆ§ §∑"
                               TO  SPA-GMN-P100-KANJILST-KANJI(IDX1 1)
               END-IF
      *
           END-PERFORM
      *
           MOVE    SPACE               TO  SPA-MOTOPG
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP100"          USING
                                           MCPAREA
                                           SPAAREA
                                           LINKAREA
                                           SCRAREA
      *
      *
           MOVE    SPA-COMMON          TO  SPA-AREA
           MOVE    SPA-FREE            TO  SPA-P02SCRAREA
           MOVE    SPA-WORK            TO  SPA-P02KYOUTU
      *
           IF (SPA-GMN-P100-SELNUM-STATE (1)
                                       =   WIDGET-NORMAL )
               MOVE  "SELNUM1"         TO  MCP-WIDGET
           ELSE
               MOVE  "SELNUM2"         TO  MCP-WIDGET
           END-IF
      *
           MOVE  "P02"                 TO  SPA-MOTOPG
           MOVE  "P100"                TO  SPA-SAKIPG
      *
           MOVE  "NEW"                 TO  MCP-PUTTYPE
           MOVE  "P100"                TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE  1             TO  SPA-FLG-END
      *
           .
       SPA-GMN-P100-CALL-EXT.
           EXIT.
      *----(01.00.15) LINE ADD END   ---------------------------------
      ****************************************************************
      *    ª‡À¥∂Ë ¨•¡•ß•√•ØΩËÕ˝
      ****************************************************************
       490-DEATHKBN-SEC                 SECTION.
      *
           EVALUATE    SPA-GMN-DEATHKBN
               WHEN    "1"
                   MOVE    SPACE           TO  SPA-GMN-DEATHKBN
               WHEN    SPACE
               WHEN    "0"
                   MOVE    "1"             TO  SPA-GMN-DEATHKBN
           END-EVALUATE
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
      *
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-GMN-DEATHKBN    =   "1"
      *            ≈–œø•‹•ø•Û§ÿ
                   MOVE    60                  TO  SPA-GMN-CUR
               ELSE
      *             ›∏±§ÿ
                   MOVE    8                   TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
           .
       490-DEATHKBN-EXT.
           EXIT.
      *
      ***************************************************************
      *     ›∏±≥Œ«ß«Ø∑Ó∆¸∆˛Œœ∫—§ﬂΩËÕ˝
      ***************************************************************
       450-HKNKAKUNINYMD-ZUMI-SEC      SECTION.
      *
      *    œ´∫“§Œª˛°¢œ´∫“ ›∏±≤ËÃÃ§ÿ
           IF      SPA-GMN-HKNNUM      =   "971"
                                       OR  "973"
              GO      TO      450-HKNKAKUNINYMD-ZUMI-EXT
           END-IF
      *
           IF      P02-P02-HKNNUM  NOT =   SPACE
               IF     (SPA-SYSYMD          =   SPA-NAI-HKAKUNINYMD) AND
                      (SPA-MAE-HKAKUNINYMD NOT =   SPACE         )
                   MOVE    SPA-MAE-HKAKUNINYMDW
                                               TO  P02-P02-HKAKUNINYMD
               ELSE
                   MOVE    SPA-SYSYMDWH        TO  P02-P02-HKAKUNINYMD
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
      *
           .
       450-HKNKAKUNINYMD-ZUMI-EXT.
           EXIT.
      *
      ****************************************************************
      *    ∏¯»Ò≥Œ«ß«Ø∑Ó∆¸∆˛Œœ∫—§ﬂΩËÕ˝
      *****************************************************************
       460-KOHKAKUNINYMD-ZUMI-SEC             SECTION.
      *
           EVALUATE    MCP-WIDGET
               WHEN    "BK1"
                   IF       SPA-GMN-KOHNUM (1) NOT =   SPACE
                       IF     (SPA-SYSYMD      =   SPA-NAI-KKAKUNINYMD
                                                             (1) ) AND
                              (SPA-MAE-KKAKUNINYMD (1)
                                               NOT =   SPACE )
                           MOVE    SPA-MAE-KKAKUNINYMDW (1)
                                               TO  P02-P02-KKAKUNINYMD1
                           MOVE    SPA-MAE-KKAKUNINYMDW (1)
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (1)
                           MOVE    SPA-MAE-KKAKUNINYMD (1)
                                               TO  SPA-NAI-KKAKUNINYMD
                                                                    (1)
                       ELSE
                           MOVE    SPA-SYSYMDWH
                                               TO  P02-P02-KKAKUNINYMD1
                           MOVE    SPA-SYSYMDWH
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (1)
                           MOVE    SPA-SYSYMD  TO  SPA-NAI-KKAKUNINYMD
                                                                    (1)
                       END-IF
                   END-IF
               WHEN    "BK2"
                   IF       SPA-GMN-KOHNUM (2) NOT =   SPACE
                       IF     (SPA-SYSYMD      =   SPA-NAI-KKAKUNINYMD
                                                             (2) ) AND
                              (SPA-MAE-KKAKUNINYMD (2)
                                               NOT =   SPACE )
                           MOVE    SPA-MAE-KKAKUNINYMDW (2)
                                               TO  P02-P02-KKAKUNINYMD2
                           MOVE    SPA-MAE-KKAKUNINYMDW (2)
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (2)
                           MOVE    SPA-MAE-KKAKUNINYMD (2)
                                               TO  SPA-NAI-KKAKUNINYMD
                                                                    (2)
                       ELSE
                           MOVE    SPA-SYSYMDWH
                                               TO  P02-P02-KKAKUNINYMD2
                           MOVE    SPA-SYSYMDWH
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (2)
                           MOVE    SPA-SYSYMD  TO  SPA-NAI-KKAKUNINYMD
                                                                    (2)
                       END-IF
                   END-IF
               WHEN    "BK3"
                   IF       SPA-GMN-KOHNUM (3) NOT =   SPACE
                       IF     (SPA-SYSYMD      =   SPA-NAI-KKAKUNINYMD
                                                             (3) ) AND
                              (SPA-MAE-KKAKUNINYMD (3)
                                               NOT =   SPACE )
                           MOVE    SPA-MAE-KKAKUNINYMDW (3)
                                               TO  P02-P02-KKAKUNINYMD3
                           MOVE    SPA-MAE-KKAKUNINYMDW (3)
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (3)
                           MOVE    SPA-MAE-KKAKUNINYMD (3)
                                               TO  SPA-NAI-KKAKUNINYMD
                                                                    (3)
                       ELSE
                           MOVE    SPA-SYSYMDWH
                                               TO  P02-P02-KKAKUNINYMD3
                           MOVE    SPA-SYSYMDWH
                                               TO  SPA-GMN-KKAKUNINYMD
                                                                    (3)
                           MOVE    SPA-SYSYMD  TO  SPA-NAI-KKAKUNINYMD
                                                                    (3)
                       END-IF
                   END-IF
           END-EVALUATE
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
      *
           .
       460-KOHKAKUNINYMD-ZUMI-EXT.
           EXIT.
      ****************************************************************
      *    ∏¯»Ò¥¸∏¬¿⁄§Ï•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       460-TEKEDCHKKBN-CHK-SEC             SECTION.
      *
           EVALUATE    MCP-WIDGET
               WHEN    "CK1"
                   IF       SPA-GMN-KOHNUM (1) NOT =   SPACE
                       IF     (SPA-NAI-TEKEDCHKKBN (1)
                                                   =   "1"    )
                           MOVE    SPACE       TO  SPA-NAI-TEKEDCHKKBN
                                                                  (1)
                       ELSE
                           MOVE    "1"         TO  SPA-NAI-TEKEDCHKKBN
                                                                  (1)
                       END-IF
                   END-IF
               WHEN    "CK2"
                   IF       SPA-GMN-KOHNUM (2) NOT =   SPACE
                       IF     (SPA-NAI-TEKEDCHKKBN (2)
                                                   =   "1"    )
                           MOVE    SPACE       TO  SPA-NAI-TEKEDCHKKBN
                                                                  (2)
                       ELSE
                           MOVE    "1"         TO  SPA-NAI-TEKEDCHKKBN
                                                                  (2)
                       END-IF
                   END-IF
               WHEN    "CK3"
                   IF       SPA-GMN-KOHNUM (3) NOT =   SPACE
                       IF     (SPA-NAI-TEKEDCHKKBN (3)
                                                   =   "1"    )
                           MOVE    SPACE       TO  SPA-NAI-TEKEDCHKKBN
                                                                  (3)
                       ELSE
                           MOVE    "1"         TO  SPA-NAI-TEKEDCHKKBN
                                                                  (3)
                       END-IF
                   END-IF
           END-EVALUATE
      *
           MOVE    ZERO                TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
      *
           .
       460-TEKEDCHKKBN-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ∆ÛΩ≈≈–œøµø§§≤ËÃÃΩËÕ˝
      ****************************************************************
       41012-NIJYU-TRKGMN-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-P02A-CHK
           IF      FLG-P02A-SYORI      =   1
               IF     (SPA-GMN-KANANAME    =   SPACE )  OR
                      (SPA-GMN-NAME        =   SPACE )
                   MOVE    1               TO  FLG-P02A-CHK
               END-IF
           ELSE
               IF  ( SPA-GMN-KANANAME      =   SPACE )  OR
                   ( SPA-NAI-BIRTHDAY      =   SPACE )  OR
                   ( SPA-GMN-SEX           =   SPACE )
                   MOVE    1               TO  FLG-P02A-CHK
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  SPA-GMN2A-MAX
           IF      FLG-P02A-CHK        =   ZERO
               PERFORM 41013-NIJYU-GMN-SET-SEC
           END-IF
      *
           IF      SPA-GMN2A-MAX       >   ZERO
      *        ∆ÛΩ≈≈–œøµø§§≤ËÃÃ§ÿ
               MOVE    "P02"               TO  SPA-MOTOPG
               MOVE    "P02A"              TO  SPA-SAKIPG
      *
               MOVE    "NEW"               TO  MCP-PUTTYPE
               MOVE    "P02A"              TO  MCP-WINDOW
               MOVE    "B01"               TO  MCP-WIDGET
      *
               PERFORM 900-PUT-WINDOW
               MOVE    1                   TO  SPA-FLG-END
           END-IF
           .
       41012-NIJYU-TRKGMN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∆ÛΩ≈≈–œø≤ËÃÃ°°¥µº‘•ﬁ•π•ø∏°∫˜ΩËÕ˝
      *****************************************************************
       41013-NIJYU-GMN-SET-SEC   SECTION.
      *
           INITIALIZE                  SPA-P02A-AREA
           MOVE    FLG-P02A-SYORI      TO  SPA-P02A-SYORI
      *
           MOVE    SPACE               TO  SPA-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP02A"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           .
       41013-NIJYU-GMN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    •∞•Î°º•◊∞ÂŒ≈µ°¥ÿ§Œ∆±¿´∆±Ãæ•Í•π•»ΩËÕ˝
      *****************************************************************
       41013-GRPPTNAME-CHK-SEC          SECTION.
      *
           IF     (SPA-GMN-KANANAME    =   SPACE )  OR
                  (SPA-NAI-BIRTHDAY    =   SPACE )  OR
                  (SPA-GMN-SEX         =   SPACE )
               CONTINUE
           ELSE
               MOVE    1               TO  SPA-P02G-FLG
               PERFORM 410131-P02G-SYORI-SEC
           END-IF
           .
       41013-GRPPTNAME-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    •∞•Î°º•◊∞ÂŒ≈µ°¥ÿ§Œ∆±¿´∆±Ãæ•Í•π•»ΩËÕ˝
      *****************************************************************
       410131-P02G-SYORI-SEC          SECTION.
      *
           INITIALIZE                  SPA-P02G-AREA
      *
           MOVE    SPACE               TO  SPA-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP02G"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           IF      SPA-P02G-MAX    >   ZERO
      *        •∞•Î°º•◊∞ÂŒ≈µ°¥ÿ∆±∞Ï¥µº‘∞ÏÕ˜§ÿ
               MOVE    "P02"               TO  SPA-MOTOPG
               MOVE    "P02G"              TO  SPA-SAKIPG
      *
               MOVE    "NEW"               TO  MCP-PUTTYPE
               MOVE    "P02G"              TO  MCP-WINDOW
               MOVE    "SELNUM"            TO  MCP-WIDGET
      *
               PERFORM 900-PUT-WINDOW
               MOVE    1                   TO  SPA-FLG-END
           END-IF
           .
       410131-P02G-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ªΩËÕ˝
      *****************************************************************
       450-HKNCOMBI-SEC          SECTION.
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    ZERO                TO  FLG-ERRCHK
           IF      FLG-TOUROKU2        =   2
               CONTINUE
           ELSE
      *        ∆˛Œœ•¡•ß•√•ØΩËÕ˝
               PERFORM 410-INPUT-CHK-SEC
               IF     (SPA-ERRCD       NOT =   SPACE )  OR
                      (SPA-PIDCD       NOT =   SPACE )  OR
                      (SPA-FLG-END     NOT =   ZERO  )
                   GO      TO      450-HKNCOMBI-EXT
               END-IF
           END-IF
      *
      *    ≈–œø§Œª˛°¢ø∑µ¨¥µº‘§Œª˛§π§Ÿ§∆§Œ ›∏±°¶∏¯»Ò§Ú•¡•ß•√•Ø§π§Î
      *    £»£±£µ°•£¥≤˛¿µ¬–±˛§Œ§ø§·°¢ÀË≤Û°¢§π§Ÿ§∆§Œ•¡•ß•√•Ø§Úπ‘§¶
      *!   IF    ( SPA-P02-SYORI       =   1     )  AND
      *!         ( FLG-TOUROKU2    NOT =   ZERO  )
           IF      FLG-TOUROKU     NOT =   ZERO
               PERFORM 4501-ALLHKN-CHK-SEC
               IF     (SPA-ERRCD       NOT =   SPACE )  OR
                      (SPA-PIDCD       NOT =   SPACE )  OR
                      (SPA-FLG-END     NOT =   ZERO  )
                   GO      TO      450-HKNCOMBI-EXT
               END-IF
           END-IF
      *
      *
      *     ›∏±£‘£¬£Ã§´§È£–£¡£“£¡•’•°•§•Î§ÿ ‘Ω∏
           PERFORM 4501-PTHKNINF-LNK-SEC
      *    ∏¯»Ò£‘£¬£Ã§´§È£–£¡£“£¡•’•°•§•Î§ÿ ‘Ω∏
           PERFORM 4502-PTKOHINF-LNK-SEC
      *    ∏¯»Ò£‘£¬£Ã§´§È∏¯»Ò…È√¥§ÿ ‘Ω∏
           PERFORM 4504-PTKOHFTN-HEN-SEC
      *
      *     ›∏±¡»πÁ§ª∫Ó¿Æ
           PERFORM 4503-HKNCOMBI-SYORI-SEC
      *
           IF      SPA-GMN-CUR         =   ZERO
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
           .
       450-HKNCOMBI-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±°¶∏¯»Ò•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4501-ALLHKN-CHK-SEC          SECTION.
      *
      *    •®•È°º§¨§ §§ª˛§œ°¢∏µ§ÿ§‚§…§π
           MOVE    ZERO                TO  FLG-CHK
           MOVE    SPA-NAI-HKNSTR      TO  WRK-NAI-HKNSTR
           IF      SPA-PTHKN-MAX       >   ZERO
               PERFORM VARYING     IDX     FROM    1   BY  1
                       UNTIL      (IDX         >   SPA-PTHKN-MAX )  OR
                              (SPA-PIDCD   NOT =   SPACE )  OR
                              (SPA-ERRCD   NOT =   SPACE )
                   INITIALIZE                  SPA-GMN-HKN-AREA
      *            »Ô ›∏±º‘Ãæ§Œº´∆∞ —ππ§œ§∑§ §§
                   MOVE    1               TO  SPA-NAI-HIHKNFLG
                   IF      SPA-PTHKN-SAKJOKBN (IDX)    =   SPACE
                       IF      WRK-NAI-HKNSTR      =   ZERO
                           MOVE    IDX             TO  WRK-NAI-HKNSTR
                       END-IF
                       MOVE    IDX             TO  SPA-NAI-HKNSTR
                       PERFORM 3101-HOKEN-HEN-SEC
      *                 ›∏±æ Û•¡•ß•√•Ø•µ•÷
                       CALL    "ORCSP03A"          USING
                                                   SPA-AREA
                                                   SPA-P02SCRAREA
                                                   SPA-P02KYOUTU
                       PERFORM 410312-HKN-SPATBL-SET-SEC
                   END-IF
               END-PERFORM
               IF     (SPA-ERRCD       NOT =   SPACE )  OR
                      (SPA-PIDCD       NOT =   SPACE )
                   GO      TO      4501-ALLHKN-CHK-EXT
               END-IF
               MOVE    WRK-NAI-HKNSTR      TO  SPA-NAI-HKNSTR
               MOVE    SPA-NAI-HKNSTR      TO  IDX
               IF      IDX                 =   ZERO
                   MOVE    1               TO  IDX
               END-IF
               PERFORM 3101-HOKEN-HEN-SEC
           END-IF
      *
      *    ∏¯»Ò§œ£≥∑Ô∞ æÂ§Œª˛π‘§¶
           IF     (SPA-PTKOH-MAX       =   ZERO )  OR
                  (SPA-NAI-KOHEND      =   SPA-PTKOH-MAX )
               GO      TO      4501-ALLHKN-CHK-EXT
           END-IF
      *
           MOVE    SPA-NAI-KOHSTR      TO  WRK-NAI-KOHSTR
           MOVE    ZERO                TO  IDY
           MOVE    SPA-GMN-KOH-AREA    TO  WRK-GMN-KOH-AREA
           IF      WRK-NAI-KOHSTR      =   ZERO
               MOVE    1                   TO  WRK-NAI-KOHSTR
           END-IF
      *
           PERFORM VARYING     IDX     FROM    WRK-NAI-KOHSTR BY  1
                   UNTIL      (IDX         >   SPA-PTKOH-MAX )  OR
                              (SPA-PIDCD   NOT =   SPACE )  OR
                              (SPA-ERRCD   NOT =   SPACE )
               IF      IDY                 =   ZERO
                   INITIALIZE                  SPA-GMN-KOH-AREA
                   MOVE    ZERO                TO  SPA-NAI-KOHEND
               END-IF
               IF      SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE
                   IF      IDY             =   ZERO
                       MOVE    IDX             TO  SPA-NAI-KOHSTR
                   END-IF
                   MOVE    IDX                 TO  SPA-NAI-KOHEND
                   ADD     1                   TO  IDY
                   MOVE    1                   TO  FLG-CHK
                   PERFORM 3102-KOUHI-HEN-SEC
               END-IF
               IF      IDY                 >=  3
      *            ∏¯»Òæ Û•¡•ß•√•Ø•µ•÷
                   CALL    "ORCSP03B"          USING   SPA-AREA
                                               SPA-P02SCRAREA
                                               SPA-P02KYOUTU
                   IF      SPA-ERRCD           =   SPACE
                       MOVE    ZERO                TO  IDY
                   END-IF
               END-IF
           END-PERFORM
      *
           IF      IDY                 >   ZERO
      *        ∏¯»Òæ Û•¡•ß•√•Ø•µ•÷
               CALL    "ORCSP03B"          USING   SPA-AREA
                                               SPA-P02SCRAREA
                                               SPA-P02KYOUTU
           END-IF
      *    ∏µ§ÿÃ·§π
           IF      SPA-ERRCD           =   SPACE
               MOVE    WRK-GMN-KOH-AREA    TO  SPA-GMN-KOH-AREA
           END-IF
           .
       4501-ALLHKN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±ƒ…≤√ΩËÕ˝
      *****************************************************************
       4501-PTHKNINF-LNK-SEC          SECTION.
      *
      *    ∫ÔΩ¸§π§Î
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTHKNINF"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "DBDELETE"          TO  MCP-FUNC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "del3"              TO  MCP-PATHNAME
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTHKN-MAX
               PERFORM 45011-HKN-SPA-PARA-SEC
      *        ƒ…≤√
               INITIALIZE                      PARA-REC
               MOVE    "P02"               TO  PARA-GYOUMUID
               MOVE    SPA-TERMID          TO  PARA-TERMID
               MOVE    "PTHKNINF"          TO  PARA-FILEMEI
               MOVE    IDX                 TO  PARA-EDANUM
               MOVE    PTHKNINF-REC        TO  PARA-DATA-REC
      *
               MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
               MOVE    PARA-REC            TO  MCPDATA-REC
               MOVE    "DBINSERT"          TO  MCP-FUNC
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         CALL    "ORCDBMAIN"         USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
      *
               IF      MCP-RC          NOT =   ZERO
                   DISPLAY "P02W1 PARA HKNINF INS ERR:"  MCP-RC
                           ",PARA-KEY;" PARA-KEY "@"
               END-IF
           END-PERFORM
      *
           .
       4501-PTHKNINF-LNK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±£”£–£¡¢™•—•È•·•ø ‘Ω∏ΩËÕ˝
      *****************************************************************
       45011-HKN-SPA-PARA-SEC          SECTION.
      *
           MOVE    SPACE               TO  PTHKNINF-REC
           INITIALIZE                      PTHKNINF-REC
      *
           MOVE    SPA-HOSPNUM         TO  PTHKN-HOSPNUM
           MOVE    SPA-GMN-PTID        TO  PTHKN-PTID
           MOVE    SPA-PTHKN-HKNID     (IDX)   TO  PTHKN-HKNID
           MOVE    SPA-PTHKN-HKNNUM    (IDX)   TO  PTHKN-HKNNUM
           MOVE    SPA-PTHKN-HKNJANUM  (IDX)   TO  PTHKN-HKNJANUM
           MOVE    SPA-PTHKN-HIHKNJANAME(IDX)  TO  PTHKN-HIHKNJANAME
           MOVE    SPA-PTHKN-HONKZKKBN  (IDX)  TO  PTHKN-HONKZKKBN
           MOVE    SPA-PTHKN-HOJOKBN    (IDX)  TO  PTHKN-HOJOKBN
           MOVE    SPA-PTHKN-CONTKBN    (IDX)  TO  PTHKN-CONTKBN
           MOVE    SPA-PTHKN-KIGO       (IDX)  TO  PTHKN-KIGO
           MOVE    SPA-PTHKN-NUM        (IDX)  TO  PTHKN-NUM
           MOVE    SPA-PTHKN-SKKGETYMD  (IDX)  TO  PTHKN-SKKGETYMD
           MOVE    SPA-PTHKN-TEKSTYMD   (IDX)  TO  PTHKN-TEKSTYMD
           MOVE    SPA-PTHKN-TEKEDYMD   (IDX)  TO  PTHKN-TEKEDYMD
           MOVE    SPA-PTHKN-KAKUNINYMD (IDX)  TO  PTHKN-KAKUNINYMD
           MOVE    SPA-PTHKN-SAKJOKBN   (IDX)  TO  PTHKN-SAKJOKBN
      *
           .
       45011-HKN-SPA-PARA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∏¯»Òƒ…≤√ΩËÕ˝
      *****************************************************************
       4502-PTKOHINF-LNK-SEC          SECTION.
      *
      *    ∫ÔΩ¸§π§Î
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTKOHINF"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "DBDELETE"          TO  MCP-FUNC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "del3"              TO  MCP-PATHNAME
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           MOVE    ZERO                TO  WRK-EDANUM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
      *
               PERFORM 45021-KOH-SPA-PARA-SEC
      *
               ADD     1                   TO  WRK-EDANUM
      *        ƒ…≤√
               INITIALIZE                      PARA-REC
               MOVE    "P02"               TO  PARA-GYOUMUID
               MOVE    SPA-TERMID          TO  PARA-TERMID
               MOVE    "PTKOHINF"          TO  PARA-FILEMEI
               MOVE    WRK-EDANUM          TO  PARA-EDANUM
               MOVE    PTKOHINF-REC        TO  PARA-DATA-REC
      *
               MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
               MOVE    PARA-REC            TO  MCPDATA-REC
               MOVE    "DBINSERT"          TO  MCP-FUNC
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         CALL    "ORCDBMAIN"         USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
      *
               IF      MCP-RC          NOT =   ZERO
                   DISPLAY "P02W1 PARA PTKOHINF INS ERR:"  MCP-RC
               END-IF
           END-PERFORM
      *
           .
       4502-PTKOHINF-LNK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±£”£–£¡¢™•—•È•·•ø ‘Ω∏ΩËÕ˝
      *****************************************************************
       45021-KOH-SPA-PARA-SEC          SECTION.
      *
           MOVE    SPACE               TO  PTKOHINF-REC
           INITIALIZE                      PTKOHINF-REC
      *
           MOVE    SPA-HOSPNUM         TO  PTKOH-HOSPNUM
           MOVE    SPA-GMN-PTID        TO  PTKOH-PTID
           MOVE    SPA-PTKOH-KOHID     (IDX)   TO  PTKOH-KOHID
           MOVE    SPA-PTKOH-KOHNUM    (IDX)   TO  PTKOH-KOHNUM
           MOVE    SPA-PTKOH-PAYKBN    (IDX)   TO  PTKOH-PAYKBN
           MOVE    SPA-PTKOH-FTNJANUM  (IDX)   TO  PTKOH-FTNJANUM
           MOVE    SPA-PTKOH-JKYSNUM   (IDX)   TO  PTKOH-JKYSNUM
           MOVE    SPA-PTKOH-TEKSTYMD  (IDX)   TO  PTKOH-TEKSTYMD
           MOVE    SPA-PTKOH-TEKEDYMD  (IDX)   TO  PTKOH-TEKEDYMD
           MOVE    SPA-PTKOH-KAKUNINYMD(IDX)   TO  PTKOH-KAKUNINYMD
           MOVE    SPA-PTKOH-SAKJOKBN  (IDX)   TO  PTKOH-SAKJOKBN
           MOVE    SPA-PTKOH-TEKEDCHKKBN (IDX) TO  PTKOH-TEKEDCHKKBN
      *
           .
       45021-KOH-SPA-PARA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∏¯»Ò£‘£¬£Ã§´§È∏¯»Ò…È√¥§ÿ ‘Ω∏ΩËÕ˝
      *****************************************************************
       4504-PTKOHFTN-HEN-SEC          SECTION.
      *
      *    §π§Ÿ§∆§Ú∫ÔΩ¸§»§∑§∆§™§Ø
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-FTN1-MAX
               MOVE    "1"             TO  SPA-NAI24-FTNDELKBN (IDX)
           END-PERFORM
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PTKOH-MAX
      *        ππ¿µ°¢∞È¿Æ
               IF     (SPA-PTKOH-KOHNUM(IDX)   =   "015"
                                               OR  "016"
      *            ¿∏≥Ë ›∏Ó
                                               OR  "012" )
      *            ∆√ƒÍ…ÈÕ≠° £»£±£µ°•£±£∞∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "051" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20031001"))
      *            ≈Ïµ˛§Œ∆√ƒÍº¿¥µ∏¯»Ò° £»£±£µ°•£±£∞∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "151" )  AND
                      (SPA-PREFNUM             =   13    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20031001"))
      *            ≈Ïµ˛§Œ£¥£µ£±∏¯»Ò° £»£±£µ°•£±£∞∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "451" )  AND
                      (SPA-PREFNUM             =   13    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20031001"))
      *             º∏À∏©§Œ£±£∏£∂∏¯»Ò° £»£±£µ°•£±£∞∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "186" )  AND
                      (SPA-PREFNUM             =   28    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20031001"))
      *            æÆª˘∆√ƒÍ° £∞£µ£≤°À° £»£±£∑°•£∞£¥∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "052" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20050401"))
      *
      *            ¿∫ø¿ƒÃ±°° £∞£≤£±°À° £»£±£∏°•£∞£¥∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "021" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20060401"))
      *
      *            ∏∫Ã»° £π£∂£∞°¢£π£∂£±°À° £»£±£∏°•£±£∞∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "960"
                                               OR  "961"  )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20061001"))
      *
      *           Œ≈Õ‹≤∏Ó∞ÂŒ≈° £∞£≤£¥°À°¢æ„≥≤ª˘° £∞£∑£π°À° £»£±£∏°•£±£∞∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "079"
                                               OR  "024"  )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20061001"))
      *
      *           π‚≥€∞—«§ ß§§° £π£∂£¥°À
                 OR   (SPA-PTKOH-KOHNUM(IDX)   =   "964"  )
      *
      *             °≈Á§Œ√œ ˝∏¯»Ò° £»£±£π°•£≤∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "281" )  AND
                      (SPA-PREFNUM             =   07    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20070201"))
      *
      *            ∑Î≥À∆˛ΩÍ° £∞£±£±°À° £»£±£π°•£¥∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "011" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20070401"))
      *
      *            ¥Œ±Íº£Œ≈° £∞£≥£∏°À° £»£≤£∞°•£¥∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "038" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20080401"))
      *            ªƒŒ±ÀÆøÕ° £∞£≤£µ°À° £»£≤£∞°•£¥∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "025" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20080401"))
      *            ÀÃ≥§∆ª§Œ√œ ˝∏¯»Ò° £»£≤£∞°•£±£∞∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "183" )  AND
                      (SPA-PREFNUM             =   01    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20081001"))
      *
      *            ¿∫ø¿∆˛±°° £∞£≤£∞°À° £»£±£π°•£¥∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "020" )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20070401"))
      *            ∞¶√Œ∏©§Œ√œ ˝∏¯»Ò° £»£≤£±°•£±£∞∞ πﬂ°À
                 OR  ((SPA-PTKOH-KOHNUM(IDX)   =   "191" )  AND
                      (SPA-PREFNUM             =   23    )  AND
                      (SPA-PTKOH-TEKSTYMD(IDX) >=  "20091001"))
      *
                   MOVE    ZERO                TO  IDY
                   PERFORM VARYING     IDX2    FROM    1   BY  1
                           UNTIL       IDX2    >   SPA-FTN1-MAX
                       IF      SPA-PTKOH-KOHID(IDX)
                                               =   SPA-NAI24-KOHID(IDX2)
                           MOVE    IDX2            TO  IDY
                           MOVE    SPA-FTN1-MAX    TO  IDX2
                       END-IF
                   END-PERFORM
                   IF      IDY             =   ZERO
                       COMPUTE IDY         =   SPA-FTN1-MAX     +  1
                       IF      IDY         >   60
                           MOVE    "0097"          TO  SPA-ERRCD
                       ELSE
                           MOVE    IDY         TO  SPA-FTN1-MAX
                           INITIALIZE          SPA-GMN24-FTNTBLO (IDY)
                       END-IF
                   END-IF
      *
                   IF      SPA-ERRCD           =   SPACE
                       PERFORM 45041-PTKOHFTN-TBLHEN-SEC
                   END-IF
               END-IF
           END-PERFORM
      *
           .
       4504-PTKOHFTN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∏¯»Ò…È√¥§ÿ ‘Ω∏ΩËÕ˝
      *****************************************************************
       45041-PTKOHFTN-TBLHEN-SEC          SECTION.
      *
           MOVE    SPA-PTKOH-KOHID     (IDX)   TO  SPA-NAI24-KOHID (IDY)
           MOVE    SPA-PTKOH-KOHNUM    (IDX)   TO  SPA-NAI24-KOHNUM(IDY)
           MOVE    SPA-PTKOH-JKYSNUM   (IDX)   TO  SPA-NAI24-TJKYSNUM
                                                                 (IDY)
           MOVE    SPA-PTKOH-PAYKBN    (IDX)   TO  SPA-NAI24-PAYKBN(IDY)
           MOVE    SPA-PTKOH-TEKSTYMD  (IDX)   TO  SPA-NAI24-TKOHSTYMD
                                                                   (IDY)
           MOVE    SPA-PTKOH-TEKEDYMD  (IDX)   TO  SPA-NAI24-TKOHEDYMD
                                                                   (IDY)
           MOVE    SPA-PTKOH-SAKJOKBN  (IDX)   TO  SPA-NAI24-FTNDELKBN
                                                                   (IDY)
      *
           MOVE    SPA-PTKOH-KOHNUM-MEI(IDX)   TO  SPA-GMN24-TFTNKOHMEI
                                                                   (IDY)
           MOVE    SPA-PTKOH-TEKSTYMDW (IDX)   TO  SPA-GMN24-TKOHSTYMD
                                                                   (IDY)
           MOVE    SPA-PTKOH-TEKEDYMDW (IDX)   TO  SPA-GMN24-TKOHEDYMD
                                                                   (IDY)
           .
       45041-PTKOHFTN-TBLHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª∫Ó¿ÆΩËÕ˝
      *****************************************************************
       4503-HKNCOMBI-SYORI-SEC          SECTION.
      *
           MOVE    SPA-HOSPSBT         TO  WRK-HOSPSBT
           MOVE    SPA-ROUPAYKBN       TO  WRK-ROUPAYKBN
           MOVE    SPA-NAI-HOSPSBT     TO  SPA-HOSPSBT
           MOVE    SPA-NAI-ROUPAYKBN   TO  SPA-ROUPAYKBN
      *     ›∏±¡»πÁ§ª∫Ó¿Æ
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-GMN-PTID        TO  SPA-PTID
           CALL    "ORCGP02W2"         USING    SPA-AREA
           MOVE    WRK-HOSPSBT         TO  SPA-HOSPSBT
           MOVE    WRK-ROUPAYKBN       TO  SPA-ROUPAYKBN
      *     ›∏±¡»πÁ£…£ƒ¿ﬂƒÍΩËÕ˝
           IF      SPA-ERRCD           =   SPACE
               CALL    "ORCGP02W3"     USING    SPA-AREA
                                                SPA-P02KYOUTU
           END-IF
      *
      *     ›∏±¡»πÁ§ª…Ωº®° ∏Ω∫ﬂ¬–æ› ¨§Œ§ﬂ°À
           IF      SPA-ERRCD           =   SPACE
               PERFORM 3103-HKNCOMB-PARA-SEC
           END-IF
      *
           .
       4503-HKNCOMBI-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±ƒ…≤√ΩËÕ˝
      *****************************************************************
       460-HKN-TUIKA-SEC          SECTION.
      *
      *    ƒ…≤√§Œ»ΩƒÍ
           MOVE    1                   TO  FLG-HKN-ADD2
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      460-HKN-TUIKA-EXT
           END-IF
      *
      *    ƒ…≤√§Œ»ΩƒÍ
           INITIALIZE                  SPA-GMN-HKN-AREA
           MOVE    ZERO                TO  SPA-NAI-HKNSTR
           MOVE    8                   TO  SPA-GMN-CUR
      *
           .
       460-HKN-TUIKA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∏¯»Òƒ…≤√ΩËÕ˝
      *****************************************************************
       470-KOH-TUIKA-SEC          SECTION.
      *
      *    ƒ…≤√§Œ»ΩƒÍ
           MOVE    1                   TO  FLG-KOH-ADD2
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  FLG-ERRCHK
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      470-KOH-TUIKA-EXT
           END-IF
      *
           IF      FLG-KOH-ADD         =   ZERO
               MOVE    "0090"          TO  SPA-ERRCD
           END-IF
      *    •∆°º•÷•Î∑ÔøÙ
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (SPA-PTKOH-MAX       >=  TBL-MAX-KOH )
               MOVE    "0106"          TO  SPA-ERRCD
               GO      TO      470-KOH-TUIKA-EXT
           END-IF
      *
           EVALUATE    TRUE
               WHEN    SPA-GMN-KOHNUM(1)   =   SPACE
                   MOVE    20                  TO  SPA-GMN-CUR
               WHEN    SPA-GMN-KOHNUM(2)   =   SPACE
                   MOVE    26                  TO  SPA-GMN-CUR
               WHEN    SPA-GMN-KOHNUM(3)   =   SPACE
                   MOVE    32                  TO  SPA-GMN-CUR
           END-EVALUATE
      *
           .
       470-KOH-TUIKA-EXT.
           EXIT.
      *
      *****************************************************************
      *    •ø•∞ —ππ°¶ Ã≤ËÃÃ¿⁄¬ÿ°°…Ωº®ΩËÕ˝
      *****************************************************************
       4101-BETUGAMEN-SEC          SECTION.
      *
           MOVE    1                   TO  FLG-TOUROKU 
           MOVE    ZERO                TO  FLG-TOUROKU2
      *     ›∏±¡»πÁ§ª§Ú∫Ó¿Æ§π§Î° ∆˛Œœ•¡•ß•√•Øπ˛§ﬂ°À
           PERFORM 450-HKNCOMBI-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      4101-BETUGAMEN-EXT
           END-IF
           .
       4101-BETUGAMEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¡∞…Ωº®° ¥À‹°ß ›∏±∏¯»Òæ Û°ÀΩËÕ˝
      *****************************************************************
       440-ZEN-GMNHYOUJI-SEC           SECTION.
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    1                   TO  FLG-ERRCHK
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      440-ZEN-GMNHYOUJI-EXT
           END-IF
      *
      *     ›∏±æ Û
           IF      SPA-NAI-HKNSTR      >   1
               MOVE    SPA-NAI-HKNSTR      TO  WRK-HKNSTR
      *         ›∏±æ Û£‘£¬£Ã§´§È ‘Ω∏
               COMPUTE SPA-NAI-HKNSTR      =   SPA-NAI-HKNSTR  -  1
               PERFORM 3101-HKN-TBL-SPA-SEC
      *        ¬–æ›§¨§ §§ª˛∏µ§ÿ
               IF      SPA-NAI-HKNSTR      =   ZERO
                   MOVE    WRK-HKNSTR          TO  SPA-NAI-HKNSTR
                   PERFORM 3101-HKN-TBL-SPA-SEC
               END-IF
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
      *    ∏¯»Òæ Û
           IF      SPA-NAI-KOHSTR      >   1
      *        ¬–æ›≥´ªœ∞Ã√÷§Úµ·§·§Î
               MOVE    ZERO                TO  WRK-KOHSTR
               MOVE    ZERO                TO  IDY
               PERFORM VARYING     IDX     FROM    1  BY  1
                       UNTIL      (IDX     >   SPA-PTKOH-MAX) OR
                                  (IDX     =   SPA-NAI-KOHSTR)
                   IF      SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE
                       ADD     1               TO  IDY
                       IF      IDY             >   3
                           MOVE   1                TO  IDY
                       END-IF
                       IF      IDY             =   1
                           MOVE    IDX             TO  WRK-KOHSTR
                       END-IF
                   END-IF
               END-PERFORM
      *        ∏¯»Òæ Û£‘£¬£Ã§´§È ‘Ω∏
               IF      WRK-KOHSTR          >   ZERO
                   MOVE    WRK-KOHSTR          TO  SPA-NAI-KOHSTR
                   PERFORM 3101-KOH-TBL-SPA-SEC
               END-IF
               MOVE    20              TO  SPA-GMN-CUR
           END-IF
      *
           IF      SPA-GMN-CUR         =   ZERO
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
           .
       440-ZEN-GMNHYOUJI-EXT.
           EXIT.
      *
      *****************************************************************
      *    º°…Ωº®° ¥À‹°ß ›∏±∏¯»Òæ Û°ÀΩËÕ˝
      *****************************************************************
       450-TUGI-GMNHYOUJI-SEC          SECTION.
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    1                   TO  FLG-ERRCHK
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      450-TUGI-GMNHYOUJI-EXT
           END-IF
      *
           MOVE    ZERO                TO  SPA-GMN-CUR
      *     ›∏±æ Û
           IF      SPA-NAI-HKNSTR      <   SPA-PTHKN-MAX
               MOVE    SPA-NAI-HKNSTR      TO  WRK-HKNSTR
      *         ›∏±æ Û£‘£¬£Ã§´§È ‘Ω∏
               ADD     1                   TO  SPA-NAI-HKNSTR
               PERFORM 3101-HKN-TBL-SPA-SEC
      *        ¬–æ›§¨§ §§ª˛∏µ§ÿ
               IF     (SPA-NAI-HKNSTR      =   ZERO )  AND
                      (WRK-HKNSTR          >   ZERO )
                   MOVE    WRK-HKNSTR          TO  SPA-NAI-HKNSTR
                   PERFORM 3101-HKN-TBL-SPA-SEC
               END-IF
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
      *    ∏¯»Òæ Û
           IF     (SPA-NAI-KOHEND      <   SPA-PTKOH-MAX )  AND
                  (SPA-GMN-KOHNUM(3)   NOT =   SPACE )
               MOVE    SPA-NAI-KOHSTR      TO  WRK-KOHSTR
               MOVE    SPA-NAI-KOHEND      TO  SPA-NAI-KOHSTR
      *         ›∏±æ Û£‘£¬£Ã§´§È ‘Ω∏
               ADD     1                   TO  SPA-NAI-KOHSTR
               PERFORM 3101-KOH-TBL-SPA-SEC
      *        ¬–æ›§¨§ §§ª˛∏µ§ÿ
               IF      SPA-NAI-KOHSTR      =   ZERO
                   MOVE    WRK-KOHSTR          TO  SPA-NAI-KOHSTR
                   PERFORM 3101-KOH-TBL-SPA-SEC
               END-IF
               MOVE    20                  TO  SPA-GMN-CUR
           END-IF
      *
           IF      SPA-GMN-CUR         =   ZERO
               MOVE    8               TO  SPA-GMN-CUR
           END-IF
      *
           .
       450-TUGI-GMNHYOUJI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ΩªΩÍ∏°∫˜§ÿ
      *****************************************************************
       440-JYUSYO-SEC             SECTION.
      *
      ***  INITIALIZE                            P98
      *    INITIALIZE                            P99
      ***  INITIALIZE                            JPARA-REC
      *    INITIALIZE                            SPA-GMN98-TABLE
      *    MOVE  ZERO                        TO  SPA-GMN98-MAX
      *    MOVE  ZERO                        TO  SPA-GMN98-PAGE
     ****  CALL  "ORCSADR"                       USING
      *                                          SPA-P02KYOUTU
      *                                          SPA-P02SCRAREA
      *                                          P98
      *                                          P99
      ****                                       SPA-SYSYMD
      *
           MOVE    SPACE               TO  SPA-MOTOPG
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP98"           USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           MOVE    "P02"               TO  SPA-GMN98-MOTOPG
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
      *
      *    ∞ÏÕ˜§ÿ
           MOVE    "P98"               TO  SPA-SAKIPG
           MOVE    "P02"               TO  SPA-MOTOPG
      *
           MOVE    "SELNUM"            TO  MCP-WIDGET
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    "P98"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  SPA-FLG-END
      *
           .
       440-JYUSYO-EXT.
           EXIT.
      *
      *****************************************************************
      *    œ´∫“∆˛Œœ≤ËÃÃΩËÕ˝
      *****************************************************************
       481-ROUSAI-SEC             SECTION.
      *
           IF      SPA-GMN-PTNUM       =   SPACE
               MOVE    "1001"              TO  SPA-ERRCD
               MOVE    ZERO                TO  SPA-GMN-CUR
               GO      TO      481-ROUSAI-EXT
           END-IF
      *
           MOVE    1                   TO  SPA-HKNKOH-FLG
           MOVE    ZERO                TO  FLG-TOUROKU
      *    ∆˛Œœ•¡•ß•√•ØΩËÕ˝
           PERFORM 410-INPUT-CHK-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-PIDCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      481-ROUSAI-EXT
           END-IF
      *
      *    œ´∫“§´º´«Â¿’§¨≈–œø§µ§Ï§∆§§§Î§≥§»
           INITIALIZE                  HKNNUM-REC
           MOVE    SPA-HOSPNUM         TO  HKN-HOSPNUM
           MOVE    SPA-SYSYMD          TO  HKN-TEKSTYMD
           MOVE    SPA-SYSYMD          TO  HKN-TEKEDYMD
           MOVE    "971"               TO  HKN-HKNNUM
           MOVE    ZERO                TO  HKN-PAYKBN
      *
           MOVE    HKNNUM-REC          TO  MCPDATA-REC
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknnum"        TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 921-HKNNUM-NEXT-SEC
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           IF      FLG-HKNNUM          =   ZERO
               MOVE    1               TO  SPA-ROSAI-FLG
           ELSE
               MOVE    ZERO            TO  SPA-ROSAI-FLG
           END-IF
      *
      *    º´«Â¿’§¨≈–œø§µ§Ï§∆§§§Î§≥§»
           INITIALIZE                  HKNNUM-REC
           MOVE    SPA-HOSPNUM          TO  HKN-HOSPNUM
           MOVE    SPA-SYSYMD          TO  HKN-TEKSTYMD
           MOVE    SPA-SYSYMD          TO  HKN-TEKEDYMD
           MOVE    "973"               TO  HKN-HKNNUM
           MOVE    ZERO                TO  HKN-PAYKBN
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknnum"        TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 921-HKNNUM-NEXT-SEC
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           IF      FLG-HKNNUM          =   ZERO
               MOVE    1               TO  SPA-JIBAI-FLG
           ELSE
               MOVE    ZERO            TO  SPA-JIBAI-FLG
           END-IF
      *
           IF     (SPA-ROSAI-FLG       =   ZERO )  AND
                  (SPA-JIBAI-FLG       =   ZERO )
               MOVE    "0024"          TO  SPA-ERRCD
               MOVE    8               TO  SPA-GMN-CUR
               GO      TO              481-ROUSAI-EXT
           END-IF
      *
      *    ∏Ω∫ﬂ…Ωº®§µ§Ï§∆§§§Î§´§Œ»ΩƒÍ
           IF      SPA-GMN-HKNNUM      =   "971"  OR
                                           "973"  OR
                                           SPACE
               CONTINUE
           ELSE
      *        ∫«ΩÈ§Œœ´∫“°¶º´«Â¿’§»§π§Î
               PERFORM 4811-RSIHKN-SET-SEC
      *?       MOVE    "0022"        TO  SPA-ERRCD
      *?       MOVE    8             TO  SPA-GMN-CUR
               IF      SPA-ERRCD     NOT =   SPACE
                    GO      TO            481-ROUSAI-EXT
               END-IF
           END-IF
      *
      *     ›∏±°°¡´∞‹•—•È•·°º•ø•ª•√•»
           MOVE    SPA-P02KYOUTU         TO  SPA-WORK
      *
      *     ›∏±°°≤ËÃÃæ Û•ª•√•»ΩËÕ˝
           PERFORM 481-RSIHKNGMN-SET-SEC
      *
           MOVE    "P02"                 TO  SPA-MOTOPG
           MOVE    "P02D"                TO  SPA-SAKIPG
      *
      *     ›∏±∆˛Œœ≤ËÃÃ§ÿ
           MOVE   "NEW"                  TO  MCP-PUTTYPE.
           MOVE   "P02D"                 TO  MCP-WINDOW.
      *    •´°º•Ω•Î∞Ã√÷ªÿƒÍ
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
                   MOVE   3                    TO  SPA-GMN2D-CUR
                   MOVE   "KOHNUM1"            TO  MCP-WIDGET
               WHEN    "2"
                   MOVE   4                    TO  SPA-GMN2D-CUR
                   MOVE   "KOHNUM2"            TO  MCP-WIDGET
               WHEN    "3"
                   MOVE   16                   TO  SPA-GMN2D-CUR
                   MOVE   "KOHNUM3"            TO  MCP-WIDGET
               WHEN    OTHER
                   MOVE   1                    TO  SPA-GMN2D-CUR
                   MOVE   "HKNKBN"             TO  MCP-WIDGET
           END-EVALUATE
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                     TO  SPA-FLG-END
      *
           .
       481-ROUSAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    œ´∫“ ›∏±ΩÈ¥¸≤ËÃÃ•ª•√•»ΩËÕ˝
      *****************************************************************
       4811-RSIHKN-SET-SEC           SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           MOVE    ZERO                TO  IDX-R2
           PERFORM VARYING IDX-R       FROM    1   BY  1
                   UNTIL   IDX-R       >   SPA-PTHKN-MAX
              IF      (SPA-PTHKN-HKNNUM (IDX-R)    =   "971"  OR
                                                       "973" )  AND
                      (SPA-PTHKN-SAKJOKBN(IDX-R)   =   SPACE )
                   IF      SPA-PTHKN-TEKEDYMD(IDX-R)
                                                   =    "99999999"
                       IF      FLG-CHK             =   ZERO
                           MOVE    IDX-R           TO  IDX-R2
                           MOVE    1               TO  FLG-CHK
                       ELSE
                           MOVE    ZERO            TO  IDX-R2
                       END-IF
                   END-IF
               END-IF
           END-PERFORM
      *    Õ≠∏˙§ œ´∫“°¶º´«Â¿’§¨£±∑Ô§Œª˛°¢¬–æ›§»§π§Î
           IF     (FLG-CHK             =   1  )  AND
                  (IDX-R2              >   ZERO)
               MOVE    IDX-R2          TO  SPA-NAI-HKNSTR
               MOVE    IDX-R2          TO  IDX
               PERFORM 3101-HOKEN-HEN-SEC
      *        À‹øÕ≤»¬≤
               MOVE    SPACE           TO  SPA-GMN-HONKZKKBN-G
      *         ‰Ωı∂Ë ¨
               MOVE    SPACE           TO  SPA-GMN-HOJOKBN-G
               MOVE    SPACE           TO  SPA-GMN-HOJOKBN-LIST
               MOVE    ZERO            TO  SPA-GMN-HOJO-MAX
      *
               MOVE    SPACE           TO  SPA-GMN-CONTKBN-G
               MOVE    SPACE           TO  SPA-GMN-CONTKBN-LIST
               MOVE    ZERO            TO  SPA-GMN-CONT-MAX
           ELSE
      *        Õ≠∏˙§ œ´∫“°¶º´«Â¿’§¨§ §§ª˛°¢ø∑µ¨ƒ…≤√
               IF      FLG-CHK             =   ZERO
                   INITIALIZE                  SPA-GMN-HKN-AREA
                   MOVE    ZERO                TO  SPA-NAI-HKNSTR
               ELSE
                   MOVE    "0022"        TO  SPA-ERRCD
                   MOVE    8             TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
       4811-RSIHKN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    œ´∫“ ›∏±°°≤ËÃÃæ Û•ª•√•»ΩËÕ˝
      *****************************************************************
       481-RSIHKNGMN-SET-SEC           SECTION.
      *
           MOVE    SPA-P02KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA      TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGP02D"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA.
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           .
       481-RSIHKNGMN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ≈–œøΩËÕ˝
      *****************************************************************
       490-TOUROKU-SEC             SECTION.
      *
           MOVE    1                   TO  FLG-TOUROKU 
           MOVE    1                   TO  FLG-TOUROKU2
      *
           EVALUATE    SPA-P02-GAMEN
      *         ›∏±¡»πÁ§ªÕ˙ŒÚ
               WHEN    "P027"
                   MOVE    2               TO  FLG-TOUROKU2
           END-EVALUATE
      *
      *     ›∏±¡»πÁ§ª§Ú∫Ó¿Æ§π§Î° ∆˛Œœ•¡•ß•√•Øπ˛§ﬂ°À
           PERFORM 450-HKNCOMBI-SEC
           IF     (SPA-ERRCD       NOT =   SPACE )  OR
                  (SPA-FLG-END     NOT =   ZERO  )
               GO      TO      490-TOUROKU-EXT
           END-IF
      *     ›∏±¡»πÁ§ª∏¯»Ò√±∆»•¡•ß•√•Ø
      **** IF     (SPA-NAI-KOHONLY     =   ZERO ) AND
      *           (SPA-TAGU-FLG        =   ZERO )
      *       AND (SPA-NAI-KOHONLY-CHKFLG  =   "1"  )
      *        PERFORM 4901-KOHONLY-CHK-SEC
      *****END-IF
      *
           IF     (SPA-TAGU-FLG        =   ZERO )  AND
                  (SPA-ERRCD           =   SPACE)
               PERFORM 4901-KOHONLY-CHK-SEC
           END-IF
      *
      *    •´•Î•∆»Øπ‘§¢§Í§Œª˛°¢ ›∏±¡»πÁ§ª§Œ•¡•ß•√•Ø
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-GMN-HAKKO       =   "1"
                   IF      SPA-NAI-KARUTE-HAKKO    =   "2"
                       IF      SPA-GMN-SELNUM      =   ZERO
                           PERFORM 4901-KARUTE-CHEK-SEC
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
      *
           .
       490-TOUROKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∏∫Ã»Ω≈ £•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4909-960JYUFUKU-CHK-SEC             SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-PTKOH-MAX )  OR
                              (SPA-ERRCD   NOT =   SPACE )
               IF      (SPA-PTKOH-SAKJOKBN (IDX)    =   SPACE )  AND
                       (SPA-PTKOH-KOHNUM   (IDX)    =   "027" )
                   PERFORM VARYING  IDY     FROM    1   BY  1
                           UNTIL   (IDY     >   SPA-PTKOH-MAX )  OR
                                   (SPA-ERRCD   NOT =   SPACE )
                      IF      (SPA-PTKOH-SAKJOKBN (IDY)    =   SPACE )
                        AND   (SPA-PTKOH-KOHNUM   (IDY)    =   "960"
                                                           OR  "961"
                                                           OR  "962"
                                                           OR  "963" )
                           IF     (SPA-PTKOH-TEKEDYMD (IDY)
                                       <   SPA-PTKOH-TEKSTYMD (IDX)) OR
                                  (SPA-PTKOH-TEKSTYMD (IDY)
                                       >   SPA-PTKOH-TEKEDYMD (IDX))
                               CONTINUE
                           ELSE
                               MOVE    "0112"      TO  SPA-ERRCD
      *                        ∏¯»Ò§Œ£±»÷Ã‹§À•´°º•Ω•Î∞‹∆∞
                               MOVE    21          TO  SPA-GMN-CUR
                           END-IF
                      END-IF
                   END-PERFORM
              END-IF
           END-PERFORM
           .
       4909-960JYUFUKU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª∏¯»Ò√±∆»•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       4901-KOHONLY-CHK-SEC             SECTION.
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "HKNCOMBI"          TO  PARA-FILEMEI
      *
           MOVE    SPA-HOSPNUM         TO  PARA-HOSPNUM
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           PERFORM
               UNTIL  (FLG-PARA        NOT =   ZERO )  OR
                      (SPA-ERRCD       NOT =   SPACE )
               MOVE    PARA-DATA-REC       TO  HKNCOMBI-REC
               IF     (COMB-DELKBN         =   "1"       )  OR
                      (SPA-SYSYMD          >   COMB-TEKEDYMD)
                   CONTINUE
               ELSE
      *            √œ ˝∏¯»Ò√±∆»»ΩƒÍ
                   IF     (SPA-NAI-KOHONLY     =   ZERO ) AND
                          (SPA-NAI-KOHONLY-CHKFLG  =   "1" )
                       PERFORM 49011-KOHONLY-CHKSYORI-SEC
                   END-IF
      *            ¬‡ø¶πÒ ›§»œ∑øÕ∏¯»Ò§Œ¡»πÁ§ª
                   IF      (COMB-HKNNUM        =   "067" ) AND
                          ((COMB-KOH1HKNNUM    =   "027" ) OR
                           (COMB-KOH2HKNNUM    =   "027" ) OR
                           (COMB-KOH3HKNNUM    =   "027" ) OR
                           (COMB-KOH4HKNNUM    =   "027" ))
                       IF      SPA-NAI-TAICHK      =   ZERO
                           MOVE    "K011"          TO  SPA-ERRCD
                           MOVE    1               TO  SPA-NAI-TAICHK
                       END-IF
                   END-IF
               END-IF
      *
               MOVE    "tbl_para"          TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               PERFORM 990-PARA-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_para"          TO  MCP-TABLE
           MOVE    "key5"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           .
       4901-KOHONLY-CHK-EXT.
           EXIT.
      *****************************************************************
      *    √±∆»∏¯»Ò§Œ»ΩƒÍΩËÕ˝
      *****************************************************************
       49011-KOHONLY-CHKSYORI-SEC             SECTION.
      *
      *    ƒπ∫Í∏©§Œ»Ô«˙º‘∞ÂŒ≈° £±£∏£∂°À§œ√±∆»≤ƒ«Ω
           IF      (COMB-HKNNUM         =   SPACE )  AND
                   (COMB-KOH1HKNNUM     =   "186" )  AND
                   (COMB-KOH2HKNNUM     =   SPACE )  AND
                   (COMB-KOH3HKNNUM     =   SPACE )  AND
                   (COMB-KOH4HKNNUM     =   SPACE )  AND
                   (SPA-PREFNUM         =   "42"  )
               MOVE    ZERO             TO  FLG-KOHCHK
           ELSE
               MOVE    ZERO             TO  FLG-KOHCHK
               IF      (COMB-HKNNUM         =   SPACE )  AND
                       (COMB-KOH1HKNNUM     >=  "100"  AND
                                            <=  "899"  )  AND
                       ((COMB-KOH2HKNNUM     =   SPACE  ) OR
                        (COMB-KOH2HKNNUM     >=  "100"  AND
                                             <=  "899"  )) AND
                       ((COMB-KOH3HKNNUM     =   SPACE  ) OR
                        (COMB-KOH3HKNNUM     >=  "100"  AND
                                             <=  "899"  )) AND
                       ((COMB-KOH4HKNNUM     =   SPACE  ) OR
                        (COMB-KOH4HKNNUM     >=  "100"  AND
                                             <=  "899"  ))
                   PERFORM 49011-KOHONLY-HKNCHK-SEC
               END-IF
           END-IF
           IF      FLG-KOHCHK      =   1
               MOVE    "K010"          TO  SPA-ERRCD
               MOVE    1               TO  SPA-NAI-KOHONLY
           END-IF
           .
       49011-KOHONLY-CHKSYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    √±∆»∏¯»Ò§Œ»ΩƒÍΩËÕ˝
      *****************************************************************
       49011-KOHONLY-HKNCHK-SEC             SECTION.
      *
           MOVE    ZERO                TO  FLG-KOHCHK
      *
           IF      COMB-KOH1HKNNUM NOT =   SPACE
               MOVE    COMB-KOH1HKNNUM     TO  WRK-HKNNUM
               MOVE    COMB-KOH1PAYKBN     TO  WRK-PAYKBN
               PERFORM 49011-KOHHKNNUM-CHK-SEC
           END-IF
      *
           IF      COMB-KOH2HKNNUM NOT =   SPACE
               MOVE    COMB-KOH2HKNNUM     TO  WRK-HKNNUM
               MOVE    COMB-KOH2PAYKBN     TO  WRK-PAYKBN
               PERFORM 49011-KOHHKNNUM-CHK-SEC
           END-IF
      *
           IF      COMB-KOH3HKNNUM NOT =   SPACE
               MOVE    COMB-KOH3HKNNUM     TO  WRK-HKNNUM
               MOVE    COMB-KOH3PAYKBN     TO  WRK-PAYKBN
               PERFORM 49011-KOHHKNNUM-CHK-SEC
           END-IF
      *
           IF      COMB-KOH4HKNNUM NOT =   SPACE
               MOVE    COMB-KOH4HKNNUM     TO  WRK-HKNNUM
               MOVE    COMB-KOH4PAYKBN     TO  WRK-PAYKBN
               PERFORM 49011-KOHHKNNUM-CHK-SEC
           END-IF
           .
       49011-KOHONLY-HKNCHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    √±∆»∏¯»Ò§Œ»ΩƒÍΩËÕ˝
      *****************************************************************
       49011-KOHHKNNUM-CHK-SEC             SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN-KOHMAX
               IF     (WRK-HKNNUM      =   SPA-GMN-KOHNUML (IDX))
      *            √±∆»∏¯»Ò∞ ≥∞
                   IF      SPA-NAI-KOHSBTKBN (IDX) =   "6"
                       CONTINUE
                   ELSE
                       MOVE    1               TO  FLG-KOHCHK
                   END-IF
               END-IF
           END-PERFORM
           .
       49011-KOHHKNNUM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    •´•Î•∆»Øπ‘§Œ ›∏±¡»πÁ∑ËƒÍΩËÕ˝
      *****************************************************************
       4901-KARUTE-CHEK-SEC             SECTION.
      *
           MOVE    ZERO                TO  WRK-CNT-HKN
           MOVE    ZERO                TO  WRK-CNT-HKN2
           MOVE    ZERO                TO  WRK-IDXH
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HKNCOMBI-MAX
               MOVE    ZERO                TO  WRK-CNT-HKN2
      *
               IF      SPA-GMN-THKNNUM (IDX)       NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      SPA-NAI-TKOH1HKNNUM(IDX)    NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      SPA-NAI-TKOH2HKNNUM(IDX)    NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      SPA-NAI-TKOH3HKNNUM(IDX)    NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      SPA-NAI-TKOH4HKNNUM(IDX)    NOT =   SPACE
                   ADD     1                   TO  WRK-CNT-HKN2
               END-IF
               IF      WRK-CNT-HKN         <=  WRK-CNT-HKN2
                   MOVE    IDX                 TO  WRK-IDXH
                   MOVE    WRK-CNT-HKN2        TO  WRK-CNT-HKN
               END-IF
      *        œ´∫“°¶º´«Â¿’§¨§¢§Ï§–¬–æ›§»§π§Î
               IF      SPA-GMN-THKNNUM (IDX)       =   "971"
                                                   OR  "973"
                   MOVE    IDX                 TO  WRK-IDXH
                   MOVE    SPA-HKNCOMBI-MAX    TO  IDX
               END-IF
           END-PERFORM
      *
           IF      WRK-IDXH            =   ZERO
               MOVE    1               TO  WRK-IDXH
           END-IF
           MOVE    SPA-GMN-THKNCOMBINUM (WRK-IDXH)
                                       TO  SPA-GMN-SELNUM
      *
           .
       4901-KARUTE-CHEK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ≤ËÃÃ•´°º•Ω•Î•ª•√•»ΩËÕ˝
      *****************************************************************
       5001-MAPCUR-SEC             SECTION.
      *
      *    •´°º•Ω•ÎªÿƒÍ§Œ§ §§ª˛°¢∆˛Œœ§∑§øπ‡Ã‹§Œº°§Æ§ÿ
           IF     (SPA-ERRCD           =   SPACE)  AND
                  (SPA-GMN-CUR         =   ZERO )
               PERFORM 50011-INPUT-CUR-SEC
               ADD     1               TO  SPA-GMN-CUR
           END-IF
      *
           EVALUATE   SPA-GMN-CUR
              WHEN    01
                  MOVE    "P02_KANANAME"         TO  MCP-WIDGET
              WHEN    02
                  MOVE    "P02_NAME"             TO  MCP-WIDGET
              WHEN    03
                  MOVE    "P02_SEX"              TO  MCP-WIDGET
              WHEN    04
                  MOVE    "P02_BIRTHDAY"         TO  MCP-WIDGET
              WHEN    05
                  MOVE    "P02_NICKNAME"         TO  MCP-WIDGET
              WHEN    06
                  MOVE    "P02_HAKKO"            TO  MCP-WIDGET
              WHEN    70
                  MOVE    "P02_USERPG"           TO  MCP-WIDGET
              WHEN    07
                  MOVE    "TSTPTNUMKBN"          TO  MCP-WIDGET
      *        ›∏±æ Û
              WHEN    08
                  MOVE    "P02_HKNJANUM"         TO  MCP-WIDGET
              WHEN    09
                  MOVE    "P02_HKNNUM"         TO  MCP-WIDGET
              WHEN    10
                  MOVE    "P02_HONKZKBN"         TO  MCP-WIDGET
              WHEN    11
                  MOVE    "P02_HOJOKBN"         TO  MCP-WIDGET
              WHEN    12
                  MOVE    "P02_CONTKBN"         TO  MCP-WIDGET
              WHEN    13
                  MOVE    "P02_KIGO"             TO  MCP-WIDGET
              WHEN    14
                  MOVE    "P02_NUM"              TO  MCP-WIDGET
              WHEN    15
                  MOVE    "P02_SKKGETYMD"        TO  MCP-WIDGET
              WHEN    16
                  MOVE    "P02_HTEKSTYMD"        TO  MCP-WIDGET
              WHEN    17
                  MOVE    "P02_HTEKEDYMD"        TO  MCP-WIDGET
              WHEN    18
                  MOVE    "P02_HIHKNJANAME"      TO  MCP-WIDGET
              WHEN    19
                  MOVE    "P02_HKAKUNINYMD"      TO  MCP-WIDGET
      *    ∏¯»Ò£±
              WHEN    20
                  MOVE    "P02_FTNJANUM1"        TO  MCP-WIDGET
              WHEN    21
                  MOVE    "P02_KOHNUM1"          TO  MCP-WIDGET
              WHEN    22
                  MOVE    "P02_JKYSNUM1"         TO  MCP-WIDGET
              WHEN    23
                  MOVE    "P02_KTEKSTYMD1"       TO  MCP-WIDGET
              WHEN    24
                  MOVE    "P02_KTEKEDYMD1"       TO  MCP-WIDGET
              WHEN    25
                  MOVE    "P02_KKAKUNINYMD1"     TO  MCP-WIDGET
      *    ∏¯»Ò£±
              WHEN    26
                  MOVE    "P02_FTNJANUM2"        TO  MCP-WIDGET
              WHEN    27
                  MOVE    "P02_KOHNUM2"          TO  MCP-WIDGET
              WHEN    28
                  MOVE    "P02_JKYSNUM2"         TO  MCP-WIDGET
              WHEN    29
                  MOVE    "P02_KTEKSTYMD2"       TO  MCP-WIDGET
              WHEN    30
                  MOVE    "P02_KTEKEDYMD2"       TO  MCP-WIDGET
              WHEN    31
                  MOVE    "P02_KKAKUNINYMD2"     TO  MCP-WIDGET
      *    ∏¯»Ò£≥
              WHEN    32
                  MOVE    "P02_FTNJANUM3"        TO  MCP-WIDGET
              WHEN    33
                  MOVE    "P02_KOHNUM3"          TO  MCP-WIDGET
              WHEN    34
                  MOVE    "P02_JKYSNUM3"         TO  MCP-WIDGET
              WHEN    35
                  MOVE    "P02_KTEKSTYMD3"       TO  MCP-WIDGET
              WHEN    36
                  MOVE    "P02_KTEKEDYMD3"       TO  MCP-WIDGET
              WHEN    37
                  MOVE    "P02_KKAKUNINYMD3"     TO  MCP-WIDGET
      *    
              WHEN    38
                  MOVE    "P02_SELNUM"           TO  MCP-WIDGET
              WHEN    39
                  MOVE    "P02_SRYKA"            TO  MCP-WIDGET
      *
              WHEN    40
                  MOVE    "P02_POST"             TO  MCP-WIDGET
              WHEN    41
                  MOVE    "P02_ADRS"            TO  MCP-WIDGET
              WHEN    42
                  MOVE    "P02_BANTI"            TO  MCP-WIDGET
              WHEN    43
                  MOVE    "P02_TEL1"             TO  MCP-WIDGET
              WHEN    44
                  MOVE    "P02_TEL2"             TO  MCP-WIDGET
              WHEN    45
                  MOVE    "P02_DISCOUNTKBN"     TO  MCP-WIDGET
              WHEN    46
                  MOVE    "P02_DISCOUNT"        TO  MCP-WIDGET
              WHEN    66
                  MOVE    "P02_NYUKIN"          TO  MCP-WIDGET
              WHEN    67
                  MOVE    "P02_SKYPRTFLG"        TO  MCP-WIDGET
              WHEN    47
                  MOVE    "P02_SETAINUSI"        TO  MCP-WIDGET
              WHEN    48
                  MOVE    "P02_ZOKUGARA"        TO  MCP-WIDGET
              WHEN    49
                  MOVE    "P02_CONDITION1"      TO  MCP-WIDGET
              WHEN    50
                  MOVE    "P02_CONDITION2"      TO  MCP-WIDGET
              WHEN    51
                  MOVE    "P02_CONDITION3"      TO  MCP-WIDGET
              WHEN    52
                  MOVE    "P02_TABOO1"          TO  MCP-WIDGET
              WHEN    53
                  MOVE    "P02_TABOO2"          TO  MCP-WIDGET
              WHEN    54
                  MOVE    "P02_ALLERGY1"        TO  MCP-WIDGET
              WHEN    55
                  MOVE    "P02_ALLERGY2"        TO  MCP-WIDGET
              WHEN    56
                  MOVE    "P02_KANSENSYO1"      TO  MCP-WIDGET
              WHEN    57
                  MOVE    "P02_KANSENSYO2"      TO  MCP-WIDGET
              WHEN    58
                  MOVE    "P02_COMMENT1"        TO  MCP-WIDGET
              WHEN    59
                  MOVE    "P02_COMMENT2"        TO  MCP-WIDGET
      *       ≈–œø
              WHEN    60
                  MOVE    "B12"                 TO  MCP-WIDGET
      *       œ´∫“°¶º´«Â¿’
              WHEN    61
                  MOVE    "B09S"                TO  MCP-WIDGET
           END-EVALUATE
      *
           .
       5001-MAPCUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∆˛Œœ∏ƒΩÍ§Œ•ª•√•»ΩËÕ˝
      *****************************************************************
       50011-INPUT-CUR-SEC          SECTION.
      *
      *
           EVALUATE    SPA-MCP-WIDGET
      *     ›∏±¡»πÁ§ª¡™¬Ú
               WHEN    "HKNLIST"
                   MOVE    38          TO  SPA-GMN-CUR
      *    §´§ ª·Ãæ
               WHEN    "P02_KANANAME"
                   MOVE    1           TO  SPA-GMN-CUR
      *    ¥¡ª˙ª·Ãæ
               WHEN    "P02_NAME"
                   MOVE    2           TO  SPA-GMN-CUR
      *    ¿≠ Ã
               WHEN    "P02_SEX"
                   MOVE    3           TO  SPA-GMN-CUR
      *    ¿∏«Ø∑Ó∆¸
               WHEN    "P02_BIRTHDAY"
      *            •´•Î•∆»Øπ‘§ÿ
      ***********  MOVE    5           TO  SPA-GMN-CUR
      *             ›∏±æ Û§ÿ
                   MOVE    7           TO  SPA-GMN-CUR
      *    ƒÃæŒ
               WHEN    "P02_NICKNAME"
      *************MOVE    5           TO  SPA-GMN-CUR
      *             ›∏±æ Û§ÿ
                   MOVE    7           TO  SPA-GMN-CUR
      *    •´•Î•∆»Øπ‘
               WHEN    "P02_HAKKO"
      *             ›∏±æ Û§ÿ
                   MOVE    7           TO  SPA-GMN-CUR
      *    £’°¶£–
               WHEN    "P02_USERPG"
      *             ›∏±æ Û§ÿ
                   MOVE    7           TO  SPA-GMN-CUR
      *    •∆•π•»¥µº‘
               WHEN    "TSTPTNUMKBN"
                   MOVE    7           TO  SPA-GMN-CUR
      *     ›∏±æ Û
               WHEN    "P02_HKNJANUM"
                   MOVE    8           TO  SPA-GMN-CUR
               WHEN    "P02_HKNNUM"
                   MOVE    9           TO  SPA-GMN-CUR
               WHEN    "P02_HONKZKBN"
                   MOVE    10          TO  SPA-GMN-CUR
      *             ‰Ωı§¨§ §§ª˛°¢∑—¬≥§ÿ
                   IF      SPA-GMN-HOJO-MAX    =   ZERO
                       MOVE    11              TO  SPA-GMN-CUR
      *                ∑—¬≥§¨§ §§ª˛°¢µ≠πÊ§ÿ
                       IF      SPA-GMN-CONT-MAX    =   ZERO
                           MOVE    12              TO  SPA-GMN-CUR
                       END-IF
                   END-IF
               WHEN    "P02_HOJOKBN"
                   MOVE    11          TO  SPA-GMN-CUR
      *            ∑—¬≥§¨§ §§ª˛°¢µ≠πÊ§ÿ
                   IF      SPA-GMN-CONT-MAX    =   ZERO
                       MOVE    12              TO  SPA-GMN-CUR
                   END-IF
      *!!!         ∏Â¥¸π‚Œº‘§œ°¢»÷πÊ§ÿ
                   IF      SPA-GMN-HKNNUM      =   "039"
                       MOVE    13              TO  SPA-GMN-CUR
                   END-IF
               WHEN    "P02_CONTKBN"
                   MOVE    12          TO  SPA-GMN-CUR
               WHEN    "P02_KIGO"
                   MOVE    13          TO  SPA-GMN-CUR
               WHEN    "P02_NUM"
                   MOVE    14          TO  SPA-GMN-CUR
               WHEN    "P02_SKKGETYMD"
                   MOVE    15          TO  SPA-GMN-CUR
               WHEN    "P02_HTEKSTYMD"
                   MOVE    16          TO  SPA-GMN-CUR
               WHEN    "P02_HTEKEDYMD"
                   MOVE    17          TO  SPA-GMN-CUR
               WHEN    "P02_HIHKNJANAME"
                   MOVE    18          TO  SPA-GMN-CUR
               WHEN    "P02_HKAKUNINYMD"
                   MOVE    19          TO  SPA-GMN-CUR
      *    ∏¯»Ò£±
               WHEN    "P02_FTNJANUM1"
                   MOVE    20          TO  SPA-GMN-CUR
                   IF     (SPA-GMN-FTNJANUM(1) =   SPACE) AND
                          (SPA-GMN-KOHNUM (1)  =   SPACE)
                       MOVE    39          TO  SPA-GMN-CUR
                   END-IF
               WHEN    "P02_KOHNUM1"
                   MOVE    21          TO  SPA-GMN-CUR
               WHEN    "P02_JKYSNUM1"
                   MOVE    22          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKSTYMD1"
                   MOVE    23          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKEDYMD1"
                   MOVE    24          TO  SPA-GMN-CUR
               WHEN    "P02_KKAKUNINYMD1"
                   MOVE    25          TO  SPA-GMN-CUR
      *    ∏¯»Ò£≤
               WHEN    "P02_FTNJANUM2"
                   MOVE    26          TO  SPA-GMN-CUR
                   IF     (SPA-GMN-FTNJANUM(2) =   SPACE) AND
                          (SPA-GMN-KOHNUM (2)  =   SPACE)
                       MOVE    39          TO  SPA-GMN-CUR
                   END-IF
               WHEN    "P02_KOHNUM2"
                   MOVE    27          TO  SPA-GMN-CUR
               WHEN    "P02_JKYSNUM2"
                   MOVE    28          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKSTYMD2"
                   MOVE    29          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKEDYMD2"
                   MOVE    30          TO  SPA-GMN-CUR
               WHEN    "P02_KKAKUNINYMD2"
                   MOVE    31          TO  SPA-GMN-CUR
      *    ∏¯»Ò£≥
               WHEN    "P02_FTNJANUM3"
                   MOVE    32          TO  SPA-GMN-CUR
                   IF     (SPA-GMN-FTNJANUM(3) =   SPACE) AND
                          (SPA-GMN-KOHNUM (3)  =   SPACE)
                       MOVE    39          TO  SPA-GMN-CUR
                   END-IF
               WHEN    "P02_KOHNUM3"
                   MOVE    33          TO  SPA-GMN-CUR
               WHEN    "P02_JKYSNUM3"
                   MOVE    34          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKSTYMD3"
                   MOVE    35          TO  SPA-GMN-CUR
               WHEN    "P02_KTEKEDYMD3"
                   MOVE    36          TO  SPA-GMN-CUR
               WHEN    "P02_KKAKUNINYMD3"
                   MOVE    37          TO  SPA-GMN-CUR
      *    ¡™¬Ú»÷πÊ
               WHEN    "P02_SELNUM"
                   MOVE    38          TO  SPA-GMN-CUR
      *    ø«Œ≈≤ 
               WHEN    "P02_SRYKA"
                   MOVE    39          TO  SPA-GMN-CUR
      *    Õπ ÿ»÷πÊ
               WHEN    "P02_POST"
                   MOVE    40          TO  SPA-GMN-CUR
      *            ΩªΩÍ§¨§¢§Ï§–º°§Æ§ÿ
                   IF      SPA-GMN-EDITADRS-NAME   NOT =   SPACE
                       MOVE    41          TO  SPA-GMN-CUR
                   END-IF
      *    ΩªΩÍ
               WHEN    "P02_ADRS"
                   MOVE    41          TO  SPA-GMN-CUR
      *    »÷√œ ˝ΩÒ
               WHEN    "P02_BANTI"
                   MOVE    42          TO  SPA-GMN-CUR
      *    ≈≈œ√√Î
               WHEN    "P02_TEL1"
                   MOVE    43          TO  SPA-GMN-CUR
      *    ≈≈œ√ÃÎ
               WHEN    "P02_TEL2"
                   MOVE    44          TO  SPA-GMN-CUR
      *    ∏∫Ã»ªˆÕ≥
               WHEN    "P02_DISCOUNTKBN"
                   MOVE    45          TO  SPA-GMN-CUR
      *    ≥‰∞˙Œ®
               WHEN    "P02_DISCOUNT"
      ************ MOVE    46          TO  SPA-GMN-CUR
                   MOVE    65          TO  SPA-GMN-CUR
      *    ∆˛∂‚ ˝À°
               WHEN    "P02_NYUKIN"
                   MOVE    46          TO  SPA-GMN-CUR
      *    ¿§¬”ºÁ
               WHEN    "P02_SETAINUSI"
                   MOVE    47          TO  SPA-GMN-CUR
      *    ¬≥ ¡
               WHEN    "P02_ZOKUGARA"
                   MOVE    48          TO  SPA-GMN-CUR
      *    æı¬÷£±
               WHEN    "P02_CONDITION1"
                   MOVE    49          TO  SPA-GMN-CUR
      *    æı¬÷£≤
               WHEN    "P02_CONDITION2"
                   MOVE    50          TO  SPA-GMN-CUR
      *    æı¬÷£≥
               WHEN    "P02_CONDITION3"
      *******      MOVE    51                  TO  SPA-GMN-CUR
                   MOVE    66                  TO  SPA-GMN-CUR
      *    ¿¡µ·ΩÒ»Øπ‘∂Ë ¨
               WHEN    "P02_SKYPRTFLG"
                   MOVE    51                  TO  SPA-GMN-CUR
      *    ∂ÿ¥˜
               WHEN    "P02_TABOO1"
                   MOVE    52                  TO  SPA-GMN-CUR
               WHEN    "P02_TABOO2"
                   MOVE    53                  TO  SPA-GMN-CUR
      *    •¢•Ï•Î•Æ°º
               WHEN    "P02_ALLERGY1"
                   MOVE    54                  TO  SPA-GMN-CUR
               WHEN    "P02_ALLERGY2"
                   MOVE    55                  TO  SPA-GMN-CUR
      *    ¥∂¿˜æ…
               WHEN    "P02_KANSENSYO1"
                   MOVE    56                  TO  SPA-GMN-CUR
               WHEN    "P02_KANSENSYO2"
                   MOVE    57                  TO  SPA-GMN-CUR
      *    •≥•·•Û•»
               WHEN    "P02_COMMENT1"
                   MOVE    58                  TO  SPA-GMN-CUR
      *    •≥•·•Û•»£≤
               WHEN    "P02_COMMENT2"
                   MOVE    59                  TO  SPA-GMN-CUR
           END-EVALUATE
           .
      *
       50011-INPUT-CUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿æŒÒ¢™œ¬ŒÒFORMAT∆¸…’ ‘Ω∏
      *****************************************************************
       410112-SE-WAFORMAT-YMDEDIT-SEC  SECTION.
      *
           EVALUATE    WRK-SYMD
               WHEN    SPACE
                   MOVE    SPACE           TO  WRK-HENYMD
               WHEN    ZERO
                   MOVE    "0000000"       TO  WRK-HENYMD
               WHEN    "99999999"
                   MOVE    "9999999"       TO  WRK-HENYMD
               WHEN    OTHER
      *
                   MOVE    SPACE               TO  STS-AREA-DAY
                   INITIALIZE                      STS-AREA-DAY
                   MOVE    SPACE               TO  LNK-DAY2-AREA
                   MOVE    "21"                TO  LNK-DAY2-IRAI
                   MOVE    WRK-SYMD            TO  LNK-DAY2-YMD
                   CALL    "ORCSDAY"           USING
                                               STS-AREA-DAY
                                               LNK-DAY2-AREA
                   IF      STS-DAY-RC1         =   ZERO
                       MOVE    LNK-DAY2-EDTYMD1    TO  WRK-HENYMD
                   ELSE
                       MOVE    SPACE               TO  WRK-HENYMD
                   END-IF
           END-EVALUATE
           .
       410112-SE-WAFORMAT-YMDEDIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    »æ≥—∂ı«Ú§Ú¡¥≥—∂ı«Ú§ÿ —¥πΩËÕ˝
      *****************************************************************
       890-HALF-ZEN-SEC         SECTION.
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    WRK-MAE-INPUT       TO  KANACHK-MAE-INPUT
           MOVE    WRK-LEN             TO  KANACHK-MAX-CNT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           MOVE    KANACHK-MAE-INPUT   TO  WRK-MAE-INPUT
           IF     (KANACHK-RC      NOT =   ZERO  )  OR
                  (KANACHK-SYUBETU     =   1     )
               MOVE    1                   TO  FLG-ERR
               MOVE    KANACHK-MAE-INPUT   TO  WRK-ATO-INPUT
           ELSE
               MOVE    ZERO                TO  FLG-ERR
               MOVE    KANACHK-OUT-INPUT   TO  WRK-ATO-INPUT
           END-IF
      *
           .
       890-HALF-ZEN-EXT.
           EXIT.
      *****************************************************************
      *    »æ≥—∂ı«Ú§Ú¡¥≥—∂ı«Ú§ÿ —¥πΩËÕ˝° ≥∞ª˙§¢§Í°À
      *****************************************************************
       891-HALF-ZEN2-SEC         SECTION.
      *
           INITIALIZE                  ORCSKANACHK2AREA
           MOVE    "1"                 TO  KANACHK2-SYORI
           MOVE    WRK-MAE-INPUT       TO  KANACHK2-MAE-INPUT
           MOVE    WRK-LEN             TO  KANACHK2-MAX-CNT
           CALL    "ORCSKANACHK2"      USING
                                       ORCSKANACHK2AREA
           MOVE    KANACHK2-MAE-INPUT  TO  WRK-MAE-INPUT
           IF     (KANACHK2-RC     NOT =   ZERO  )  OR
                  (KANACHK2-SYUBETU    =   1     )
               MOVE    1                   TO  FLG-ERR
               MOVE    KANACHK2-MAE-INPUT  TO  WRK-ATO-INPUT
           ELSE
               MOVE    ZERO                TO  FLG-ERR
               MOVE    KANACHK2-OUT-INPUT  TO  WRK-ATO-INPUT
           END-IF
      *
           .
       891-HALF-ZEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    •∑•π•∆•‡¥…Õ˝•ﬁ•π•ø°°£“£≈£¡£ƒ
      *****************************************************************
       900-SYSTEM-READ-SEC         SECTION.
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       900-SYSTEM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      **    ¥µº‘•ﬁ•π•ø°º∆…§ﬂπ˛§ﬂ
      *****************************************************************
       900-PTINF-READ-SEC         SECTION.
      *
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTINF-REC
               MOVE    ZERO            TO  FLG-PTINF
           ELSE
               INITIALIZE                  PTINF-REC
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           .
       900-PTINF-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *     ›∏±»÷πÊ•ﬁ•π•øº°∏°∫˜ΩËÕ˝
      ****************************************************************
       921-HKNNUM-NEXT-SEC              SECTION.
      *
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNNUM-REC
               MOVE    ZERO            TO  FLG-HKNNUM
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           .
       921-HKNNUM-NEXT-EXT.
           EXIT.
      *
      *----(01.00.15) LINE ADD START ---------------------------------
      *****************************************************************
      *    øÕÃæ•∆°º•÷•Î∏°∫˜
      *****************************************************************
       941-JINMEI-SELECT-SEC           SECTION.
      *
           MOVE    SPA-HOSPNUM         TO  JINMEI-HOSPNUM
           MOVE    JINMEI-REC          TO  MCPDATA-REC
      *
           MOVE    "tbl_jinmei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  JINMEI-REC
           ELSE
               INITIALIZE                  JINMEI-REC
               MOVE    1               TO  FLG-JINMEI
           END-IF
           .
      *
       941-JINMEI-SELECT-EXT.
           EXIT.
      *****************************************************************
      *    øÕÃæ•∆°º•÷•Î∆…§ﬂπ˛§ﬂ
      *****************************************************************
       941-JINMEI-NEXT-SEC           SECTION.
      *
           MOVE    "tbl_jinmei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  JINMEI-REC
           ELSE
               INITIALIZE                  JINMEI-REC
               MOVE    1               TO  FLG-JINMEI
           END-IF
           .
      *
       941-JINMEI-NEXT-EXT.
           EXIT.
      *****************************************************************
      *    øÕÃæ•∆°º•÷•Î•Ø•Ì°º•∫ΩËÕ˝
      *****************************************************************
       941-JINMEI-CLOSE-SEC           SECTION.
      *
           MOVE    "tbl_jinmei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           .
      *
       941-JINMEI-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±º‘»÷πÊ•ﬁ•π•øº°∏°∫˜ΩËÕ˝
      *****************************************************************
       900-HKNJAINF-READ-SEC              SECTION.
      *
           MOVE    "tbl_hknjainf"      TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  HKNJAINF-REC
               MOVE    ZERO                TO  FLG-HKNJAINF
           ELSE
               INITIALIZE               HKNJAINF-REC
               MOVE    1               TO  FLG-HKNJAINF
           END-IF
           .
       900-HKNJAINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    •—•È•·•øæ Û∆…§ﬂπ˛§ﬂ
      *****************************************************************
       990-PARA-READ-SEC        SECTION.
      *
           MOVE    "tbl_para"          TO  MCP-TABLE
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PARA-REC
               MOVE    ZERO            TO  FLG-PARA
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           .
       990-PARA-READ-EXT.
           EXIT.
      *****************************************************************
      *    •∆°º•÷•Î∏°∫˜ΩËÕ˝
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £ƒ£¬∆…§ﬂπ˛§ﬂΩËÕ˝
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    £ƒ£¬•Ø•Ì°º•∫ΩËÕ˝
      *****************************************************************
       990-DBCLOSE-SEC         SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
      *----(01.00.15) LINE ADD END   ---------------------------------
      *****************************************************************
      *    £–£’£‘°°ΩËÕ˝
      *****************************************************************
       900-PUT-WINDOW           SECTION.
      *
           MOVE    "PUTWINDOW"      TO  MCP-FUNC.
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
       900-PUT-WINDOW-EXT.
           EXIT.
      *
