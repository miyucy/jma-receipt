      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCGP02D.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ´µ¼ÔÅÐÏ¿
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : Ï«ºÒÊÝ¸±ÆþÎÏ²èÌÌ¡Ê£Ð£°£²£Ä¡Ë
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  02/04/05    MCC-Â¿¡¹Ç¼    ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  01.00.01    MCC-Â¿¡¹Ç¼   02/06/18  ºÒ³²¶èÊ¬ÄÉ²Ã
      *  02.00.01    NACL-Â¿¡¹Ç¼  02/07/31  ¥Ñ¥é¥á¥¿¥Õ¥¡¥¤¥ë¤ò£Ä£Â¤Ø
      *  02.00.02    NACL-Â¿¡¹Ç¼  02/08/21  ¥¢¥Õ¥¿¡¼¥±¥¢¤ÎÎÅÍÜ´ü´ÖÄÉ²Ã
      *  02.00.03    NACL-Â¿¡¹Ç¼  02/09/10  ¼«ÇåÀÕ¤ÎÄÉ²Ã
      *  02.00.04    NACL-Â¿¡¹Ç¼  02/09/27  ¥³¥ó¥Ü¤Î¥Á¥§¥Ã¥¯ÄÉ²Ã
      *  02.00.05    NACL-Â¿¡¹Ç¼  03/05/12  ¼«ÈñÀÁµá¶èÊ¬ÄÉ²Ã
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
       DATA                    DIVISION.
      *FILE                        SECTION.
      *
       WORKING-STORAGE             SECTION.
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *    ´µ¼ÔÅÐÏ¿¥¹¥ÑÎÎ°è
           COPY    "P02COMMON-SPA".
      *    ´µ¼Ô²èÌÌ¥¹¥ÑÎÎ°è
           COPY    "P02SCR-SPA".
      *
      *    ¥¹¥Æ¡¼¥¿¥¹ÎÎ°è
       01  STS-AREA.
           03  STS-PARA            PIC X(02).
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-END             PIC 9(01).
           03  FLG-PARA            PIC 9(01).
           03  FLG-HKNNUM          PIC 9(01).
           03  FLG-HKNJAINF        PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
      *
           03  FLG-OK              PIC 9(01).
           03  FLG-TOUROKU         PIC 9(01).
      *
      *    ¥«¥¦¥ó¥ÈÎÎ°è
       01  CNT-AREA.
           03  CNT-ERR             PIC 9(06).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX                 PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDX2                PIC 9(02).
           03  IDX3                PIC 9(02).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
      *
           03  WRK-WYMD.
               05  WRK-WGO         PIC X(01).
               05  WRK-WYY         PIC 9(02).
               05  WRK-WMM         PIC 9(02).
               05  WRK-WDD         PIC 9(02).
           03  WRK-SYMD.
               05  WRK-SYY         PIC 9(04).
               05  WRK-SMM         PIC 9(02).
               05  WRK-SDD         PIC 9(02).
      *
           03  WRK-EDANUM          PIC 9(04).
      *
           03  WRK-N-IDX          PIC 9(04).
      *    È¾³ÑÁ´³ÑÊÑ´¹
       01  WRK-HENKAN-AREA.
           03  WRK-MAE-INPUT       PIC X(100).
           03  WRK-ATO-INPUT       PIC X(100).
           03  WRK-MAX             PIC 9(04).
      *    ÆþÎÏ¹àÌÜÌ¾
           03  WRK-MCP-WIDGET          PIC X(64).
      *
      *
       01  WRK-HENSYU-AREA.
           03  WRK-HENYMD.
               05  WRK-HGO         PIC X(01).
               05  WRK-HYY         PIC Z9.
               05  FILLER          PIC X(01)   VALUE  ".".
               05  WRK-HMM         PIC Z9.
               05  FILLER          PIC X(01)   VALUE  ".".
               05  WRK-HDD         PIC Z9.
      *
           03  WRK-HENTIME.
               05  WRK-THH         PIC 99.
               05  FILLER          PIC X(01)   VALUE  ":".
               05  WRK-TMM         PIC 99.
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¡ÊÂ»½ý¶èÊ¬¡Ë
           COPY    "CPSK4002.INC".
      *
      *    ´µ¼ÔÊÝ¸±¾ðÊó
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *    ÁÈ¹ç¤»ºîÀ®»þ»ÈÍÑ¹àÌÜ
           03  PTHKN-SBT          PIC X(01).
           03  PTHKN-SEIDO        PIC X(10).
      *
      *    ´µ¼Ô¸øÈñ¾ðÊó
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *    ÁÈ¹ç¤»ºîÀ®»þ»ÈÍÑ¹àÌÜ
           03  PTKOH-SBT          PIC X(01).
           03  PTKOH-SEIDO        PIC X(10).
           03  PTKOH-HKNKOHKBN    PIC X(01).
           03  PTKOH-GENHKNNUM1   PIC X(03).
           03  PTKOH-GENHKNNUM2   PIC X(03).
           03  PTKOH-GENHKNNUM3   PIC X(03).
      *
      *    ÊÝ¸±ÈÖ¹æ¥Þ¥¹¥¿
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *
      *    ÊÝ¸±¼Ô¹æ¥Þ¥¹¥¿
       01  HKNJAINF-REC.
           COPY    "CPHKNJAINF.INC".
      *
      *    ´µ¼ÔÏ«ºÒÊÝ¸±¾ðÊó
       01  PTRSIINF-REC.
           COPY    "CPPTRSIINF.INC".
      *
      *    ¥Ñ¥é¥á¥¿¥Æ¡¼¥Ö¥ë
       01  PARA-REC.
           COPY    "CPPARA.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    ¿ô»úÊÑ´¹ÎÎ°è
           COPY    "CPORCSNUM.INC".
      *   ¥Á¥§¥Ã¥¯¥Ç¥¸¥Ã¥È
           COPY    "CPORCCHKDGT.INC".
      *
      *   ²èÌÌÆüÉÕÊÑ´¹¥µ¥Ö
          COPY    "CPORCSGDAY.INC".
      *
      *    Á´³Ñ¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿
           COPY    "CPORCSKANACHK.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
           COPY    "CPORCMCP.INC".
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
        LINKAGE                     SECTION.
      *
           COPY    "MCPAREA".
           COPY    "ORCA-SPA".
      *
           COPY    "LINKAREA".
      *
       01  SCRAREA.
           COPY    "P02.INC".
           COPY    "P02A.INC".
           COPY    "P02D.INC".
           COPY    "P02E.INC".
           COPY    "P02F.INC".
           COPY    "P014.INC".
           COPY    "P015.INC".
           COPY    "P98.INC".
           COPY    "P981.INC".
           COPY    "P99.INC".
           COPY    "P0201.INC".
           COPY    "P982.INC".
           COPY    "P100.INC".
           COPY    "P02X.INC".
           COPY    "PERR.INC".
           COPY    "PID1.INC".
      *
       PROCEDURE                   DIVISION    USING
           MCPAREA
           SPAAREA
           LINKAREA
           SCRAREA.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  CNT-AREA
           INITIALIZE                  WRK-AREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA.
           MOVE    SPA-FREE        TO  SPA-P02SCRAREA
           MOVE    SPA-WORK        TO  SPA-P02KYOUTU
      *
           MOVE    SPACE           TO  SPA-ERRCD
           MOVE    ZERO            TO  FLG-END
      *
           EVALUATE    MCP-STATUS      ALSO    MCP-EVENT
               WHEN    "LINK"          ALSO    ANY
                   PERFORM 100-INIT-SEC
      *    ²èÌÌÁ«°Ü
               WHEN     "PUTG"           ALSO   "CLICKED"
                   PERFORM 200-GMNSENI
      *    ÆþÎÏ
               WHEN      OTHER
                   PERFORM 200-ENTRY
           END-EVALUATE.
      *
      *    ²èÌÌÊÔ½¸¸å¡¢É½¼¨¤Ø
           IF      FLG-END             =   ZERO
               PERFORM 500-SET-SCREEN
           END-IF
      *
           MOVE    SPA-P02KYOUTU     TO  SPA-WORK
           MOVE    SPA-AREA          TO  SPA-COMMON
           MOVE    SPA-P02SCRAREA    TO  SPA-FREE
      *
           .
           EXIT    PROGRAM
           .
      *
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  CNT-AREA
           INITIALIZE                  WRK-AREA
      *
      *    ¥¨¥é¡¼²èÌÌ¤è¤ê
           IF      SPA-MOTOPG          =   "PERR"
               MOVE    SPACE               TO  SPA-MOTOPG
               PERFORM 5001-MAPCUR-SEC
           ELSE
               PERFORM 300-SCREEN-SEC
      *
      *        ²èÌÌÊÔ½¸
               PERFORM 500-GMNHEN-SEC
           END-IF
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE.
           MOVE    "P02D"              TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
      *
           .
       100-INIT-EXT.
           EXIT.
      *****************************************************************
      *    ½é´ü²èÌÌ½èÍý
      *****************************************************************
       300-SCREEN-SEC              SECTION.
      *
      *
           IF      SPA-GMN-HKNNUM      =   SPACE
      *        [¿·µ¬ÆþÎÏ]
      *        ÊÝ¸±¾ðÊó
      *********MOVE    "971"               TO  SPA-GMN-HKNNUM
      *        Ï«ºÒÊÝ¸±¾ðÊó
               MOVE    SPACE               TO  SPA-P02D-AREA
               INITIALIZE                      SPA-P02D-AREA
      *        ÊÝ¸±ÈÖ¹æ
      *******  MOVE    "971"               TO  SPA-NAI2D-HKNNUM
               MOVE    ZERO                TO  SPA-NAI2D-GMNIDX
               MOVE    SPA-GMN-NAME        TO  SPA-GMN2D-HIHKNJANAME
           ELSE
      *
      *        Ï«ºÒÊÝ¸±¾ðÊó
               MOVE    SPACE               TO  SPA-P02D-AREA
               INITIALIZE                      SPA-P02D-AREA
      *        Ï«ºÒÊ¬
               PERFORM 3001-RSHKN-SET-SEC
           END-IF
      *
      *    ¥³¥ó¥Ü¥Ü¥¯¥¹¤ÎÊÔ½¸
           PERFORM 3002-COMBBOX-HEX-SEC
      *
           .
       300-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÊÝ¸±¼Ô¤ÎÊÔ½¸½èÍý
      *****************************************************************
       3001-RSHKN-SET-SEC             SECTION.
      *
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTRSIINF"          TO  PARA-FILEMEI
           MOVE    SPA-NAI-RSHKN-EDANUM
                                       TO  PARA-EDANUM
      *
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "DBSELECT"          TO  MCP-FUNC
           MOVE    "PARA-KEY"          TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    "PARA-KEY"          TO  ORC-DBPATH
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
           MOVE    "DBCLOSE"           TO  MCP-FUNC
           MOVE    "PARA-KEY"          TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
      *
           IF      FLG-PARA           =   1
               INITIALIZE                      PTRSIINF-REC
           ELSE
               MOVE    PARA-DATA-REC       TO  PTRSIINF-REC
           END-IF
      *
      *    Ï«ºÒÊÝ¸±¶èÊ¬
           MOVE    PTRSI-HKNKBN        TO  SPA-GMN2D-HKNKBN
           MOVE    PTRSI-HKNKBN        TO  SPA-NAI2D-HKNKBN-MAE
      *    ÊÝ¸±ÈÖ¹æ
           MOVE    PTRSI-HKNNUM        TO  SPA-NAI2D-HKNNUM
      *    ´µ¼Ô¸òÉÕÈÖ¹æ
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
                   MOVE    PTRSI-KOFUNUM       TO  SPA-GMN2D-KOHNUM1
               WHEN    "2"
                   MOVE    PTRSI-KOFUNUM       TO  SPA-GMN2D-KOHNUM2
               WHEN    "3"
                   MOVE    PTRSI-KOFUNUM       TO  SPA-GMN2D-KOHNUM3
           END-EVALUATE
      *
      *ÈïÊÝ¸±¼ÔÌ¾
           MOVE    SPA-GMN-NAME        TO  SPA-GMN2D-HIHKNJANAME
      *****MOVE    PTRSI-HIHKNJANAME   TO  SPA-GMN2D-HIHKNJANAME
      *»ö¶È½êÌ¾¾Î
           MOVE    PTRSI-JIGYOUNAME    TO  SPA-GMN2D-JIGYOUNAME
      *½êºßÃÏÅÔÆ»ÉÜ¸©Ì¾
           MOVE    PTRSI-PREFNAME      TO  SPA-GMN2D-PREFNAME
      *½êºßÃÏÅÔÆ»ÉÜ¸©¶èÊ¬
           MOVE    PTRSI-PREFKBN       TO  SPA-GMN2D-PREFKBN
      *½êºßÃÏ·´»Ô¶èÌ¾
           MOVE    PTRSI-CITYNAME      TO  SPA-GMN2D-CITYNAME
      *½êºßÃÏ·´»Ô¶è¶èÊ¬
           MOVE    PTRSI-CITYKBN       TO  SPA-GMN2D-CITYKBN
      *ºÒ³²¶èÊ¬
           MOVE    PTRSI-SAIGAIKBN     TO  SPA-GMN2D-SAIGAI
      *¿··ÑºÆÊÌ
           MOVE    PTRSI-SINKEI        TO  SPA-GMN2D-SINKEI
      *Å¾µ¢»öÍ³
           MOVE    PTRSI-TENKI         TO  SPA-GMN2D-TENKI
      *½ýÉÂÇ¯·îÆü
           MOVE    PTRSI-SHOBYOYMD     TO  SPA-NAI2D-SHOBYOYMD
           MOVE    PTRSI-SHOBYOYMD     TO  WRK-SYMD
           PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
           MOVE    WRK-HENYMD          TO  SPA-GMN2D-SHOBYOYMD
      *»Í»èÆÃÎã¶èÊ¬
           MOVE    PTRSI-SISIKBN       TO  SPA-GMN2D-SISIKBN
      *ÎÅÍÜ³«»ÏÇ¯·îÆü
           MOVE    PTRSI-RYOSTYMD      TO  SPA-NAI2D-RYOSTYMD
           MOVE    PTRSI-RYOSTYMD      TO  WRK-SYMD
           PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
           MOVE    WRK-HENYMD          TO  SPA-GMN2D-RYOSTYMD
      *ÎÅÍÜ½ªÎ»Ç¯·îÆü
           MOVE    PTRSI-RYOEDYMD      TO  SPA-NAI2D-RYOEDYMD
           MOVE    PTRSI-RYOEDYMD      TO  WRK-SYMD
           PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
           MOVE    WRK-HENYMD          TO  SPA-GMN2D-RYOEDYMD
      *Â»½ý¶èÊ¬
           MOVE    PTRSI-SONSHOUKBN    TO  SPA-GMN2D-SONSHOUKBN
      *Â»½ý¶èÊ¬¡Ý»ÞÈÖ
           MOVE    PTRSI-SONSHOUKBN-EDANUM
                                       TO  SPA-GMN2D-SONSHOUKBNEDA
      *¥¢¥Õ¥¿¡¼¥±¥¢ÎÅÍÜ³«»ÏÇ¯·îÆü
           MOVE    PTRSI-SINSATUYMD    TO  SPA-NAI2D-SINSATUYMD
           MOVE    PTRSI-SINSATUYMD    TO  WRK-SYMD
           PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
           MOVE    WRK-HENYMD          TO  SPA-GMN2D-SINSATUYMD
      *¥¢¥Õ¥¿¡¼¥±¥¢ÎÅÍÜ½ªÎ»Ç¯·îÆü
           MOVE    PTRSI-SINSATUEND    TO  SPA-NAI2D-SINSATUEND
           MOVE    PTRSI-SINSATUEND    TO  WRK-SYMD
           PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
           MOVE    WRK-HENYMD          TO  SPA-GMN2D-SINSATUEND
      *³ÎÇ§Ç¯·îÆü
           MOVE    PTRSI-KAKUNINYMD    TO  SPA-NAI2D-KAKUNINYMD
           MOVE    PTRSI-KAKUNINYMD    TO  WRK-SYMD
           PERFORM 410112-SE-WAFORMAT-YMDEDIT-SEC
           MOVE    WRK-HENYMD          TO  SPA-GMN2D-KAKUNINYMD
      *
      *¥³¥á¥ó¥È
           MOVE    PTRSI-COMMENT       TO  SPA-GMN2D-COMMENT
      *
      *¼«ÇåÀÕ´µ¼ÔÀÁµá¶èÊ¬
           MOVE    PTRSI-JIBAISEIKBN   TO  SPA-GMN2D-JIBAISEIKBN
      *
           .
       3001-RSHKN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥³¥ó¥Ü¥Ü¥¯¥¹¤ÎÊÔ½¸½èÍý
      *****************************************************************
       3002-COMBBOX-HEX-SEC             SECTION.
      *
      *    Ï«ºÒÊÝ¸±¶èÊ¬
           MOVE    ZERO                TO  SPA-GMN2D-HKNKBN-MAX
           IF      SPA-ROSAI-FLG       =   1
               MOVE    "1 Ã»´üµëÉÕ"        TO  SPA-GMN2D-HKNKBN-LST (01)
               MOVE    "2 ½ýÉÂÇ¯¶â"        TO  SPA-GMN2D-HKNKBN-LST (02)
               MOVE    "3 ¥¢¥Õ¥¿¡¼¥±¥¢"    TO  SPA-GMN2D-HKNKBN-LST (03)
               MOVE    3                   TO  SPA-GMN2D-HKNKBN-MAX
           END-IF
           IF      SPA-JIBAI-FLG       =   1
               ADD     1                   TO  SPA-GMN2D-HKNKBN-MAX
               MOVE    "4 ¼«ÇåÀÕÊÝ¸±"      TO  SPA-GMN2D-HKNKBN-LST
                                                 (SPA-GMN2D-HKNKBN-MAX)
           END-IF
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-HKNKBN-MAX
               IF      SPA-GMN2D-HKNKBN-LST(IDX) (1:1)
                                           =   SPA-GMN2D-HKNKBN
                   MOVE    SPA-GMN2D-HKNKBN-LST (IDX)
                                           TO  SPA-GMN2D-HKNKBN-G
               END-IF
           END-PERFORM
      *
      *    ºÒ³²¶èÊ¬
           MOVE    "1 ¶ÈÌ³Ãæ¤ÎºÒ³²"    TO  SPA-GMN2D-SAIGAI-LST (01)
           MOVE    "2 ÄÌ¶ÐÅÓ¾å¤ÎºÒ³²"  TO  SPA-GMN2D-SAIGAI-LST (02)
           MOVE    2                   TO  SPA-GMN2D-SAIGAI-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SAIGAI-MAX
               IF      SPA-GMN2D-SAIGAI-LST(IDX) (1:1)
                                           =   SPA-GMN2D-SAIGAI
                   MOVE    SPA-GMN2D-SAIGAI-LST (IDX)
                                           TO  SPA-GMN2D-SAIGAI-G
               END-IF
           END-PERFORM
      *
      *    ¼«ÇåÀÕ´µ¼ÔÀÁµá¶èÊ¬
           MOVE    "1 ´µ¼ÔÀÁµá¤¹¤ë(100%)"
                                       TO  SPA-GMN2D-JIBAISEIKBN-LST(01)
           MOVE    "2 ´µ¼ÔÀÁµá¤·¤Ê¤¤(0%)"
                                       TO  SPA-GMN2D-JIBAISEIKBN-LST(02)
           IF      SPA-GMN2D-HKNKBN    =   "4"
               MOVE    2                   TO  SPA-GMN2D-JIBAISEIKBN-MAX
           ELSE
               MOVE    ZERO                TO  SPA-GMN2D-JIBAISEIKBN-MAX
           END-IF
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-JIBAISEIKBN-MAX
               IF      SPA-GMN2D-JIBAISEIKBN-LST(IDX) (1:1)
                                           =   SPA-GMN2D-JIBAISEIKBN
                   MOVE    SPA-GMN2D-JIBAISEIKBN-LST (IDX)
                                           TO  SPA-GMN2D-JIBAISEIKBN-G
               END-IF
           END-PERFORM
      *
      *    ¿··Ñ¶èÊ¬
           PERFORM 41012-SINKEI-SET-SEC
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SINKEI-MAX
               IF      SPA-GMN2D-SINKEI-LST(IDX) (1:1)
                                           =   SPA-GMN2D-SINKEI
                   MOVE    SPA-GMN2D-SINKEI-LST (IDX)
                                           TO  SPA-GMN2D-SINKEI-G
               END-IF
           END-PERFORM
      *
      *    Å¾µ¢¶èÊ¬
           MOVE    "1 ¼£Ìþ"            TO  SPA-GMN2D-TENKI-LST (01)
           MOVE    "3 ·ÑÂ³"            TO  SPA-GMN2D-TENKI-LST (02)
           MOVE    "5 Å¾°å"            TO  SPA-GMN2D-TENKI-LST (03)
           MOVE    "7 Ãæ»ß"            TO  SPA-GMN2D-TENKI-LST (04)
           MOVE    "9 »àË´"            TO  SPA-GMN2D-TENKI-LST (05)
           MOVE    5                   TO  SPA-GMN2D-TENKI-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-TENKI-MAX
               IF      SPA-GMN2D-TENKI-LST(IDX) (1:1)
                                           =   SPA-GMN2D-TENKI
                   MOVE    SPA-GMN2D-TENKI-LST (IDX)
                                           TO  SPA-GMN2D-TENKI-G
               END-IF
           END-PERFORM
      *
      *    »Í»èÆÃÎã
           MOVE    "0 ¤Ê¤·"            TO  SPA-GMN2D-SISIKBN-LST (01)
           MOVE    "1 »Í»è"            TO  SPA-GMN2D-SISIKBN-LST (02)
           MOVE    "2 ¼ê»Ø"            TO  SPA-GMN2D-SISIKBN-LST (03)
           MOVE    3                   TO  SPA-GMN2D-SISIKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SISIKBN-MAX
               IF      SPA-GMN2D-SISIKBN-LST(IDX) (1:1)
                                           =   SPA-GMN2D-SISIKBN
                   MOVE    SPA-GMN2D-SISIKBN-LST (IDX)
                                           TO  SPA-GMN2D-SISIKBN-G
               END-IF
           END-PERFORM
      *
      *    ÅÔÆ»ÉÜ¸©
           MOVE    "ËÌ³¤Æ»"            TO  SPA-GMN2D-PREFNAME-LST(1)
           MOVE    "ÀÄ¿¹"              TO  SPA-GMN2D-PREFNAME-LST(2)
           MOVE    "´ä¼ê"              TO  SPA-GMN2D-PREFNAME-LST(3) 
           MOVE    "µÜ¾ë"              TO  SPA-GMN2D-PREFNAME-LST(4)
           MOVE    "½©ÅÄ"              TO  SPA-GMN2D-PREFNAME-LST(5)
           MOVE    "»³·Á"              TO  SPA-GMN2D-PREFNAME-LST(6)
           MOVE    "Ê¡Åç"              TO  SPA-GMN2D-PREFNAME-LST(7)
           MOVE    "°ñ¾ë"              TO  SPA-GMN2D-PREFNAME-LST(8)
           MOVE    "ÆÊÌÚ"              TO  SPA-GMN2D-PREFNAME-LST(9)
           MOVE    "·²ÇÏ"              TO  SPA-GMN2D-PREFNAME-LST(10)
           MOVE    "ºë¶Ì"              TO  SPA-GMN2D-PREFNAME-LST(11)
           MOVE    "ÀéÍÕ"              TO  SPA-GMN2D-PREFNAME-LST(12)
           MOVE    "Åìµþ"              TO  SPA-GMN2D-PREFNAME-LST(13)
           MOVE    "¿ÀÆàÀî"            TO  SPA-GMN2D-PREFNAME-LST(14)
           MOVE    "¿·³ã"              TO  SPA-GMN2D-PREFNAME-LST(15)
           MOVE    "ÉÙ»³"              TO  SPA-GMN2D-PREFNAME-LST(16)
           MOVE    "ÀÐÀî"              TO  SPA-GMN2D-PREFNAME-LST(17)
           MOVE    "Ê¡°æ"              TO  SPA-GMN2D-PREFNAME-LST(18)
           MOVE    "»³Íü"              TO  SPA-GMN2D-PREFNAME-LST(19)
           MOVE    "Ä¹Ìî"              TO  SPA-GMN2D-PREFNAME-LST(20)
           MOVE    "´ôÉì"              TO  SPA-GMN2D-PREFNAME-LST(21)
           MOVE    "ÀÅ²¬"              TO  SPA-GMN2D-PREFNAME-LST(22)
           MOVE    "°¦ÃÎ"              TO  SPA-GMN2D-PREFNAME-LST(23)
           MOVE    "»°½Å"              TO  SPA-GMN2D-PREFNAME-LST(24)
           MOVE    "¼¢²ì"              TO  SPA-GMN2D-PREFNAME-LST(25)
           MOVE    "µþÅÔ"              TO  SPA-GMN2D-PREFNAME-LST(26)
           MOVE    "Âçºå"              TO  SPA-GMN2D-PREFNAME-LST(27)
           MOVE    "Ê¼¸Ë"              TO  SPA-GMN2D-PREFNAME-LST(28)
           MOVE    "ÆàÎÉ"              TO  SPA-GMN2D-PREFNAME-LST(29)
           MOVE    "ÏÂ²Î»³"            TO  SPA-GMN2D-PREFNAME-LST(30)
           MOVE    "Ä»¼è"              TO  SPA-GMN2D-PREFNAME-LST(31)
           MOVE    "Åçº¬"              TO  SPA-GMN2D-PREFNAME-LST(32)
           MOVE    "²¬»³"              TO  SPA-GMN2D-PREFNAME-LST(33)
           MOVE    "¹­Åç"              TO  SPA-GMN2D-PREFNAME-LST(34)
           MOVE    "»³¸ý"              TO  SPA-GMN2D-PREFNAME-LST(35)
           MOVE    "ÆÁÅç"              TO  SPA-GMN2D-PREFNAME-LST(36)
           MOVE    "¹áÀî"              TO  SPA-GMN2D-PREFNAME-LST(37)
           MOVE    "°¦É²"              TO  SPA-GMN2D-PREFNAME-LST(38)
           MOVE    "¹âÃÎ"              TO  SPA-GMN2D-PREFNAME-LST(39)
           MOVE    "Ê¡²¬"              TO  SPA-GMN2D-PREFNAME-LST(40)
           MOVE    "º´²ì"              TO  SPA-GMN2D-PREFNAME-LST(41)
           MOVE    "Ä¹ºê"              TO  SPA-GMN2D-PREFNAME-LST(42)
           MOVE    "·§ËÜ"              TO  SPA-GMN2D-PREFNAME-LST(43)
           MOVE    "ÂçÊ¬"              TO  SPA-GMN2D-PREFNAME-LST(44)
           MOVE    "µÜºê"              TO  SPA-GMN2D-PREFNAME-LST(45)
           MOVE    "¼¯»ùÅç"            TO  SPA-GMN2D-PREFNAME-LST(46)
           MOVE    "²­Æì"              TO  SPA-GMN2D-PREFNAME-LST(47)
           MOVE    47                  TO  SPA-GMN2D-PREFNAME-MAX
      *
      *    ¸©¶èÊ¬
           MOVE    "1 ÅÔ"              TO  SPA-GMN2D-PREFKBN-LST (01)
           MOVE    "2 Æ»"              TO  SPA-GMN2D-PREFKBN-LST (02)
           MOVE    "3 ÉÜ"              TO  SPA-GMN2D-PREFKBN-LST (03)
           MOVE    "4 ¸©"              TO  SPA-GMN2D-PREFKBN-LST (04)
           MOVE    4                   TO  SPA-GMN2D-PREFKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-PREFKBN-MAX
               IF      SPA-GMN2D-PREFKBN-LST(IDX) (1:1)
                                           =   SPA-GMN2D-PREFKBN
                   MOVE    SPA-GMN2D-PREFKBN-LST (IDX)
                                           TO  SPA-GMN2D-PREFKBN-G
               END-IF
           END-PERFORM
      *
           MOVE    "1 ·´"              TO  SPA-GMN2D-CITYKBN-LST (01)
           MOVE    "2 »Ô"              TO  SPA-GMN2D-CITYKBN-LST (02)
           MOVE    "3 ¶è"              TO  SPA-GMN2D-CITYKBN-LST (03)
           MOVE    3                   TO  SPA-GMN2D-CITYKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-CITYKBN-MAX
               IF      SPA-GMN2D-CITYKBN-LST(IDX) (1:1)
                                           =   SPA-GMN2D-CITYKBN
                   MOVE    SPA-GMN2D-CITYKBN-LST (IDX)
                                           TO  SPA-GMN2D-CITYKBN-G
               END-IF
           END-PERFORM
      *
      *    Â»½ý¶èÊ¬
           MOVE    SPACE               TO  SYS-4002-REC
           INITIALIZE                  SYS-4002-REC
           MOVE    "4002"              TO  SYS-4002-KANRICD
      *    ¥·¥¹¥Æ¥à´ÉÍý¸¡º÷
           MOVE    SYS-4002-REC        TO  MCPDATA-REC
           MOVE    "DBSELECT"          TO  MCP-FUNC
           MOVE    "SYSKANRI-KEY2"     TO  ORC-DBPATH
           MOVE    SPA-SYSYMD          TO  ORC-DBYMD
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    "SYSKANRI-KEY2"     TO  ORC-DBPATH
               PERFORM 900-KANRIMST-READ-SEC
           ELSE
               INITIALIZE                  SYS-4002-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
           MOVE    ZERO                TO  IDX
           PERFORM
                   UNTIL      (FLG-SYSKANRI    =   1 )  OR
                              (IDX             >=  30)
               MOVE    MCPDATA-REC         TO  SYS-4002-REC
               ADD     1                   TO  IDX
               MOVE    IDX                 TO  SPA-GMN2D-SONSHOUKBN-MAX
               MOVE    SYS-4002-KBNCD(1:2) TO
                                       SPA-GMN2D-SONSHOUKBN-LST (IDX)
               IF      SYS-4002-KBNCD(3:1) NOT =   SPACE
                   MOVE    "-"                 TO
                                       SPA-GMN2D-SONSHOUKBN-LST (IDX)
                                                               (3:1)
                   MOVE    SYS-4002-KBNCD(3:1) TO
                                       SPA-GMN2D-SONSHOUKBN-LST (IDX)
                                                               (4:1)
               END-IF
               MOVE    SYS-4002-SONSHOUNAME    TO
                                       SPA-GMN2D-SONSHOUKBN-LST (IDX)
                                                               (5:)
      *
               MOVE    "SYSKANRI-KEY2"     TO  ORC-DBPATH
               PERFORM 900-KANRIMST-READ-SEC
           END-PERFORM
           MOVE    "DBCLOSE"           TO  MCP-FUNC
           MOVE    "SYSKANRI-KEY2"     TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SONSHOUKBN-MAX
               IF     (SPA-GMN2D-SONSHOUKBN-LST(IDX) (1:2)
                                           =   SPA-GMN2D-SONSHOUKBN) AND
                      (SPA-GMN2D-SONSHOUKBN-LST(IDX) (4:1)
                                           =   SPA-GMN2D-SONSHOUKBNEDA)
                   MOVE    SPA-GMN2D-SONSHOUKBN-LST (IDX)
                                           TO  SPA-GMN2D-SONSHOUKBN-G
               END-IF
           END-PERFORM
           .
       3002-COMBBOX-HEX-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-GMNHEN-SEC              SECTION.
      *
           MOVE    SPACE               TO  P02D
      *
      *    ÊÝ¸±¶èÊ¬
           MOVE    SPA-GMN2D-HKNKBN-G  TO  P02D-HKNKBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-HKNKBN-MAX
               MOVE    SPA-GMN2D-HKNKBN-LST (IDX)
                                       TO  P02D-HKNKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-HKNKBN-MAX    TO  P02D-HKNKBN-COUNT
      *
      *
      *    ¼«ÇåÀÕ´µ¼ÔÀÁµá¶èÊ¬
           MOVE    SPA-GMN2D-JIBAISEIKBN-G     TO  P02D-JIBAISEIKBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-JIBAISEIKBN-MAX
               MOVE    SPA-GMN2D-JIBAISEIKBN-LST (IDX)
                                       TO  P02D-JIBAISEIKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-JIBAISEIKBN-MAX 
                                           TO  P02D-JIBAISEIKBN-COUNT
      *
           MOVE    SPA-GMN2D-HIHKNJANAME   TO  P02D-HIHKNJANAME
           MOVE    SPA-GMN2D-KOHNUM1       TO  P02D-KOHNUM1
           MOVE    SPA-GMN2D-KOHNUM2       TO  P02D-KOHNUM2
      *    ¥³¥á¥ó¥È
           MOVE    SPA-GMN2D-COMMENT       TO  P02D-COMMENT
      *    ºÒ³²¶èÊ¬
           MOVE    SPA-GMN2D-SAIGAI-G  TO  P02D-SAIGAI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SAIGAI-MAX
               MOVE    SPA-GMN2D-SAIGAI-LST (IDX)
                                       TO  P02D-SAIGAI-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-SAIGAI-MAX    TO  P02D-SAIGAI-COUNT
      *
           MOVE    SPA-GMN2D-SINKEI-G  TO  P02D-SINKEI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SINKEI-MAX
               MOVE    SPA-GMN2D-SINKEI-LST (IDX)
                                       TO  P02D-SINKEI-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-SINKEI-MAX    TO  P02D-SINKEI-COUNT
      *
           MOVE    SPA-GMN2D-TENKI-G   TO  P02D-TENKI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-TENKI-MAX
               MOVE    SPA-GMN2D-TENKI-LST (IDX)
                                       TO  P02D-TENKI-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-TENKI-MAX     TO  P02D-TENKI-COUNT
      *
           MOVE    SPA-GMN2D-SISIKBN-G     TO  P02D-SISIKBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SISIKBN-MAX
               MOVE    SPA-GMN2D-SISIKBN-LST (IDX)
                                       TO  P02D-SISIKBN-ITEM(IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-SISIKBN-MAX   TO  P02D-SISIKBN-COUNT
      *
           MOVE    SPA-GMN2D-SHOBYOYMD     TO  P02D-SHOBYOYMD
           MOVE    SPA-GMN2D-RYOSTYMD      TO  P02D-RYOSTYMD
           MOVE    SPA-GMN2D-RYOEDYMD      TO  P02D-RYOEDYMD
           MOVE    SPA-GMN2D-JIGYOUNAME    TO  P02D-JIGYOUNAME
      *
      *    ÅÔÆ»ÉÜ¸©
           MOVE    SPA-GMN2D-PREFNAME-G     TO  P02D-PREFNAME
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-PREFNAME-MAX
               MOVE    SPA-GMN2D-PREFNAME-LST (IDX)
                                       TO  P02D-PREFNAME-ITEM(IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-PREFNAME-MAX  TO  P02D-PREFNAME-COUNT
      *
           MOVE    SPA-GMN2D-PREFKBN-G     TO  P02D-PREFKBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-PREFKBN-MAX
               MOVE    SPA-GMN2D-PREFKBN-LST (IDX)
                                       TO  P02D-PREFKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-PREFKBN-MAX   TO  P02D-PREFKBN-COUNT
      *
           MOVE    SPA-GMN2D-CITYNAME      TO  P02D-CITYNAME
      *
      *    »Ô¶è
           MOVE    SPA-GMN2D-CITYKBN-G     TO  P02D-CITYKBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-CITYKBN-MAX
               MOVE    SPA-GMN2D-CITYKBN-LST (IDX)
                                       TO  P02D-CITYKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-CITYKBN-MAX   TO  P02D-CITYKBN-COUNT
      *
           MOVE    SPA-GMN2D-KOHNUM3       TO  P02D-KOHNUM3
      *    Â»½ý
           MOVE    SPA-GMN2D-SONSHOUKBN-G  TO  P02D-SONSHOUKBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SONSHOUKBN-MAX
               MOVE    SPA-GMN2D-SONSHOUKBN-LST (IDX)
                                       TO  P02D-SONSHOUKBN-ITEM(IDX)
           END-PERFORM
           MOVE    SPA-GMN2D-SONSHOUKBN-MAX   TO  P02D-SONSHOUKBN-COUNT
      *
           MOVE    SPA-GMN2D-SINSATUYMD    TO  P02D-SINSATUYMD
      *
           MOVE    SPA-GMN2D-SINSATUEND    TO  P02D-SINSATUEND
      *
      *****MOVE    SPA-GMN2D-KENSAYMD      TO  P02D-KENSAYMD
      *
      *    ¥ê¥¹¥È
      *****PERFORM VARYING     IDX     FROM    1   BY  1
      *            UNTIL       IDX     >   SPA-GMN2D-SISI-MAX
      *        MOVE    SPA-GMN2D-TSINSATUYMD (IDX)
      *                                TO  P02D-TSINSATUYMD (IDX)
      *        MOVE    SPA-GMN2D-TKENSAYMD   (IDX)
      *                                TO  P02D-TKENSAYMD (IDX)
      *        MOVE    SPA-GMN2D-TSONSHOUKBN (IDX)
      *                                TO  P02D-TSONSHOUKBN (IDX)
      *    END-PERFORM
      *****MOVE    SPA-GMN2D-SISI-MAX   TO  P02D-SISIKBNLST-COUNT
      *
           PERFORM 5001-MAPCUR-SEC
      *
           .
       500-GMNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ¥«¡¼¥½¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       5001-MAPCUR-SEC             SECTION.
      *
      *    ¥«¡¼¥½¥ë»ØÄê¤Î¤Ê¤¤»þ¡¢ÆþÎÏ¤·¤¿¹àÌÜ¤Î¼¡¤®¤Ø
           IF      SPA-GMN2D-CUR       =   ZERO
               PERFORM 50011-INPUT-CUR-SEC
           END-IF
      *
           EVALUATE    SPA-GMN2D-CUR
               WHEN    01
                   MOVE    "HKNKBN"           TO  MCP-WIDGET
               WHEN    02
                   MOVE    "COMMENT"          TO  MCP-WIDGET
               WHEN    03
                   MOVE    "KOHNUM1"          TO  MCP-WIDGET
               WHEN    04
                   MOVE    "KOHNUM2"          TO  MCP-WIDGET
               WHEN    21
                   MOVE    "SAIGAI"           TO  MCP-WIDGET
               WHEN    05
                   MOVE    "SINKEI"           TO  MCP-WIDGET
               WHEN    06
                   MOVE    "TENKI"            TO  MCP-WIDGET
               WHEN    07
                   MOVE    "SISIKBN"          TO  MCP-WIDGET
               WHEN    08
                   MOVE    "SHOBYOYMD"        TO  MCP-WIDGET
               WHEN    09
                   MOVE    "RYOSTYMD"         TO  MCP-WIDGET
               WHEN    10
                   MOVE    "RYOEDYMD"         TO  MCP-WIDGET
               WHEN    11
                   MOVE    "JIGYOUNAME"        TO  MCP-WIDGET
               WHEN    12
                   MOVE    "PREFNAME"          TO  MCP-WIDGET
               WHEN    13
                   MOVE    "PREFKBN"           TO  MCP-WIDGET
               WHEN    14
                   MOVE    "CITYNAME"          TO  MCP-WIDGET
               WHEN    15
                   MOVE    "CITYKBN"           TO  MCP-WIDGET
               WHEN    16
                   MOVE    "KOHNUM3"           TO  MCP-WIDGET
               WHEN    17
                   MOVE    "SONSHOUKBN"        TO  MCP-WIDGET
               WHEN    18
                   MOVE    "SINSATUYMD"        TO  MCP-WIDGET
               WHEN    19
                   MOVE    "SINSATUEND"        TO  MCP-WIDGET
               WHEN    22
                   MOVE    "JIBAISEIKBN"       TO  MCP-WIDGET
      *********WHEN    19
      **********   MOVE    "KENSAYMD"          TO  MCP-WIDGET
               WHEN    20
                   MOVE    "B12"               TO  MCP-WIDGET
           END-EVALUATE
      *
           .
       5001-MAPCUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È½èÍý
      *****************************************************************
       50011-INPUT-CUR-SEC          SECTION.
      *
      *
           EVALUATE    WRK-MCP-WIDGET
               WHEN    "HKNKBN"
                   MOVE    2               TO  SPA-GMN2D-CUR
                   EVALUATE    SPA-GMN2D-HKNKBN
                       WHEN    "4"
                           MOVE    22              TO  SPA-GMN2D-CUR
                   END-EVALUATE
      *        ¼«ÇåÀÕÀÁµá¶èÊ¬
               WHEN    "JIBAISEIKBN"
                   MOVE    2               TO  SPA-GMN2D-CUR
               WHEN    "COMMENT"
      *            ¥³¥á¥ó¥È
                   EVALUATE    SPA-GMN2D-HKNKBN
                       WHEN    "1"
                           MOVE    3               TO  SPA-GMN2D-CUR
                       WHEN    "2"
                           MOVE    4               TO  SPA-GMN2D-CUR
                       WHEN    "3"
                           MOVE    16              TO  SPA-GMN2D-CUR
                       WHEN    "4"
                           MOVE    6               TO  SPA-GMN2D-CUR
                   END-EVALUATE
               WHEN    "KOHNUM1"
                   MOVE    21              TO  SPA-GMN2D-CUR
               WHEN    "KOHNUM2"
                   MOVE    21              TO  SPA-GMN2D-CUR
               WHEN    "SAIGAI"
                   MOVE    05              TO  SPA-GMN2D-CUR
               WHEN    "SINKEI"
                   MOVE    06              TO  SPA-GMN2D-CUR
               WHEN    "TENKI"
                   MOVE    07              TO  SPA-GMN2D-CUR
               WHEN    "SISIKBN"
                   MOVE    08              TO  SPA-GMN2D-CUR
               WHEN    "SHOBYOYMD"
                   MOVE    09              TO  SPA-GMN2D-CUR
               WHEN    "RYOSTYMD"
                   MOVE    10              TO  SPA-GMN2D-CUR
               WHEN    "RYOEDYMD"
                   MOVE    11              TO  SPA-GMN2D-CUR
               WHEN    "JIGYOUNAME"
                   MOVE    12              TO  SPA-GMN2D-CUR
               WHEN    "PREFNAME"
                   MOVE    13              TO  SPA-GMN2D-CUR
               WHEN    "PREFKBN"
                   MOVE    14              TO  SPA-GMN2D-CUR
               WHEN    "CITYNAME"
                   MOVE    15              TO  SPA-GMN2D-CUR
               WHEN    "CITYKBN"
                   MOVE    20              TO  SPA-GMN2D-CUR
               WHEN    "KOHNUM3"
                   MOVE    17              TO  SPA-GMN2D-CUR
               WHEN    "SONSHOUKBN"
                   MOVE    18              TO  SPA-GMN2D-CUR
               WHEN    "SINSATUYMD"
                   MOVE    19              TO  SPA-GMN2D-CUR
               WHEN    "SINSATUEND"
                   MOVE    20              TO  SPA-GMN2D-CUR
           END-EVALUATE
      *
           .
       50011-INPUT-CUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       200-GMNSENI                   SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *    Ìá¤ë
               WHEN    "CLICKED"       ALSO    "B01"
                   PERFORM 420-MODORU-SEC
                   PERFORM 210-BACK
      *    ºï½ü
               WHEN    "CLICKED"       ALSO    "B03"
                   PERFORM 430-SAKUJYO-SEC
      *    ÅÐÏ¿
               WHEN    "CLICKED"       ALSO    "B12"
                   PERFORM 490-TOROKU-SEC
           END-EVALUATE
      *
           .
       200-GMNSENI-EXT.
           EXIT.
      *****************************************************************
      *    ²ñÏÃ¡¡½èÍý
      *****************************************************************
       200-ENTRY                   SECTION.
      *
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È
           MOVE    MCP-WIDGET          TO  WRK-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN2D-CUR
      *
           MOVE    ZERO                TO  FLG-TOUROKU
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *
           .
      *
       200-ENTRY-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       410-INPUT-CHK-SEC          SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *    ´ðËÜ¥Á¥§¥Ã¥¯¤ÈÊÌ²èÌÌ½èÍý
           PERFORM 4102-KIHON-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      410-INPUT-CHK-EXT
           END-IF
      *
      *    ÅÐÏ¿»þ¡¢É¬¿ÜÆþÎÏ¥Á¥§¥Ã¥¯
           IF      FLG-TOUROKU         =   1
               PERFORM 4109-TOUROKU-CHK-SEC
               IF      SPA-ERRCD       NOT =   SPACE
                   GO      TO      410-INPUT-CHK-EXT
               END-IF
           END-IF
      *
           .
      *
       410-INPUT-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ£Ó£Ð£ÁÊÔ½¸½èÍý
      *****************************************************************
       4101-GMN-SPA-SET-SEC          SECTION.
      *
      *    ÊÝ¸±¶èÊ¬
           MOVE    P02D-HKNKBN         TO  SPA-GMN2D-HKNKBN-G
      *    ¼«ÇåÀÕ´µ¼ÔÀÁµá¶èÊ¬
           MOVE    P02D-JIBAISEIKBN    TO  SPA-GMN2D-JIBAISEIKBN-G
      *
           MOVE    P02D-HIHKNJANAME    TO  SPA-GMN2D-HIHKNJANAME
           MOVE    P02D-KOHNUM1        TO  SPA-GMN2D-KOHNUM1
           MOVE    P02D-KOHNUM2        TO  SPA-GMN2D-KOHNUM2
      *    ¥³¥á¥ó¥È
           MOVE    P02D-COMMENT        TO  SPA-GMN2D-COMMENT
      *    ºÒ³²¶èÊ¬
           MOVE    P02D-SAIGAI         TO  SPA-GMN2D-SAIGAI-G
           MOVE    P02D-SINKEI         TO  SPA-GMN2D-SINKEI-G
           MOVE    P02D-TENKI          TO  SPA-GMN2D-TENKI-G
           MOVE    P02D-SISIKBN        TO  SPA-GMN2D-SISIKBN-G
           MOVE    P02D-SHOBYOYMD      TO  SPA-GMN2D-SHOBYOYMD
           MOVE    P02D-RYOSTYMD       TO  SPA-GMN2D-RYOSTYMD
           MOVE    P02D-RYOEDYMD       TO  SPA-GMN2D-RYOEDYMD
           MOVE    P02D-JIGYOUNAME     TO  SPA-GMN2D-JIGYOUNAME
      *    ÅÔÆ»ÉÜ¸©
           MOVE    P02D-PREFNAME      TO  SPA-GMN2D-PREFNAME-G
           MOVE    P02D-PREFKBN       TO  SPA-GMN2D-PREFKBN-G
           MOVE    P02D-CITYNAME      TO  SPA-GMN2D-CITYNAME
           MOVE    P02D-CITYKBN       TO  SPA-GMN2D-CITYKBN-G
           MOVE    P02D-KOHNUM3       TO  SPA-GMN2D-KOHNUM3
           MOVE    P02D-SONSHOUKBN    TO  SPA-GMN2D-SONSHOUKBN-G
           MOVE    P02D-SINSATUYMD    TO  SPA-GMN2D-SINSATUYMD
           MOVE    P02D-SINSATUEND    TO  SPA-GMN2D-SINSATUEND
           .
      *
       4101-GMN-SPA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´ðËÜ¥Á¥§¥Ã¥¯¤ÈÊÌ²èÌÌ½èÍý
      *****************************************************************
       4102-KIHON-CHK-SEC          SECTION.
      *
           PERFORM 4101-HKNKBN-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *    ¼«ÇåÀÕ´µ¼ÔÀÁµá¶èÊ¬
           PERFORM 41011-JIBAISEIKBN-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-COMMENT-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-KOFUNUM-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-KOHNUM2-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-SAIGAI-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-SINKEI-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-TENKI-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-SISIKBN-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-SHOBYOYMD-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-RYOSTYMD-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-RYOEDYMD-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-JIGYOUNAME-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-PREFNAME-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-PREFKBN-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-CITYNAME-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-CITYKBN-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-KOHNUM3-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-SONSHOUKBN-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-SINSATUYMD-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
      *
           PERFORM 4101-SINSATUEND-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      4102-KIHON-CHK-EXT
           END-IF
           .
      *
       4102-KIHON-CHK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ÊÝ¸±ÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-HKNKBN-CHK-SEC         SECTION.
      *
      *    ½¤Àµ¤Î»þ¡¢ÊÑ¹¹¤Ï¤Ç¤­¤Ê¤¤¤³¤È¤È¤¹¤ë
           IF      SPA-NAI2D-HKNKBN-MAE    NOT =   SPACE
               IF      SPA-GMN2D-HKNKBN-G(1:1)
                                       NOT =   SPA-NAI2D-HKNKBN-MAE
                   MOVE    "0021"              TO  SPA-ERRCD
                   MOVE    1                   TO  SPA-GMN2D-CUR
                   GO      TO      4101-HKNKBN-CHK-EXT
               END-IF
           END-IF
      *
           IF      SPA-GMN2D-HKNKBN-G  =   SPACE
               GO      TO      4101-HKNKBN-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-HKNKBN-MAX
               IF      SPA-GMN2D-HKNKBN    =
                                       SPA-GMN2D-HKNKBN-LST (IDX)(1:1)
                   MOVE    SPA-GMN2D-HKNKBN-LST (IDX)
                                               TO  SPA-GMN2D-HKNKBN-G
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0001"              TO  SPA-ERRCD
               MOVE    1                   TO  SPA-GMN2D-CUR
           END-IF
      *
      *    ¿·µ¬¤Î»þ¡¢½é´üÉ½¼¨
           IF      SPA-NAI-RSHKN-EDANUM    =   ZERO
               PERFORM 41011-SYOKI-SET-SEC
           END-IF
      *
          .
       4101-HKNKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼«ÇåÀÕ´µ¼ÔÀÁµá¶èÊ¬¡¡½èÍý
      *****************************************************************
       41011-JIBAISEIKBN-CHK-SEC           SECTION.
      *
      *    ¼«ÇåÀÕ°Ê³°¤ÏÆþÎÏ¤Ê¤·¤È¤¹¤ë
           IF      SPA-GMN2D-HKNKBN    =   "4"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  SPA-GMN2D-JIBAISEIKBN-G
               GO      TO      41011-JIBAISEIKBN-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-JIBAISEIKBN-MAX
               IF      SPA-GMN2D-JIBAISEIKBN    =
                                           SPA-GMN2D-JIBAISEIKBN-LST
                                                          (IDX)(1:1)
                   MOVE    SPA-GMN2D-JIBAISEIKBN-LST (IDX)
                                           TO  SPA-GMN2D-JIBAISEIKBN-G
                   MOVE    1               TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0035"              TO  SPA-ERRCD
               MOVE    22                  TO  SPA-GMN2D-CUR
           END-IF
      *
          .
       41011-JIBAISEIKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÈïÊÝ¸±Ì¾½é´üÉ½¼¨¡¡½èÍý
      *****************************************************************
       41011-SYOKI-SET-SEC           SECTION.
      *
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
               WHEN    "2"
      *            ¼«ÇåÀÕÀÁµá¶èÊ¬
                   MOVE    SPACE           TO  SPA-GMN2D-JIBAISEIKBN-G
                   MOVE    ZERO            TO  SPA-GMN2D-JIBAISEIKBN-MAX
      *            ¿··ÑºÆÊÌÊÔ½¸
                   PERFORM 41012-SINKEI-SET-SEC
                   IF      SPA-GMN2D-SINKEIMEI =   SPACE
                       MOVE    SPA-GMN2D-SINKEI-LST (01)
                                               TO  SPA-GMN2D-SINKEI-G
                   END-IF
      *            Å¾µ¢
                   IF      SPA-GMN2D-TENKI     =   SPACE
                       MOVE    SPA-GMN2D-TENKI-LST (02)
                                               TO  SPA-GMN2D-TENKI-G
                   END-IF
      *
                   IF      SPA-GMN2D-SISIKBN   =   SPACE
                       MOVE    SPA-GMN2D-SISIKBN-LST (01)
                                               TO  SPA-GMN2D-SISIKBN-G
                   END-IF
      *            ½êºßÃÏÅÔÆ»ÉÜ¸©Ì¾
                   IF      SPA-GMN2D-PREFNAME  =   SPACE
                       IF      SPA-NAI-PREFNUM     NOT =   ZERO
                           MOVE    SPA-GMN2D-PREFNAME-LST
                                                (SPA-NAI-PREFNUM)
                                               TO  SPA-GMN2D-PREFNAME
                           EVALUATE    SPA-NAI-PREFNUM
                               WHEN    01
                                   MOVE    2       TO  IDX
                               WHEN    13
                                   MOVE    1       TO  IDX
                               WHEN    26
                               WHEN    27
                                   MOVE    3       TO  IDX
                               WHEN    OTHER
                                   MOVE    4       TO  IDX
                           END-EVALUATE
                           MOVE    SPA-GMN2D-PREFKBN-LST (IDX)
                                               TO  SPA-GMN2D-PREFKBN-G
                       END-IF
                   END-IF
                   IF      SPA-GMN2D-PREFKBN   =   SPACE
                        MOVE    SPA-GMN2D-PREFKBN-LST (01)
                                               TO  SPA-GMN2D-PREFKBN-G
                   END-IF
      *************IF      SPA-GMN2D-CITYKBN   =   SPACE
      *                 MOVE    SPA-GMN2D-CITYKBN-LST (01)
      *                                        TO  SPA-GMN2D-CITYKBN-G
      *************END-IF
      *
               WHEN    "3"
      *            ¼«ÇåÀÕÀÁµá¶èÊ¬
                   MOVE    SPACE           TO  SPA-GMN2D-JIBAISEIKBN-G
                   MOVE    ZERO            TO  SPA-GMN2D-JIBAISEIKBN-MAX
      *
                   IF      SPA-GMN2D-SONSHOUKBN   =   SPACE
                       MOVE    SPA-GMN2D-SONSHOUKBN-LST (01)
                                           TO  SPA-GMN2D-SONSHOUKBN-G
                   END-IF
               WHEN    "4"
      *            ¼«ÇåÀÕ
      *            ¼«ÇåÀÕ´µ¼ÔÀÁµá¶èÊ¬
                   MOVE    2               TO  SPA-GMN2D-JIBAISEIKBN-MAX
                   IF      SPA-GMN2D-JIBAISEIKBN   =   SPACE
                       MOVE    SPA-GMN2D-JIBAISEIKBN-LST (1)
                                           TO  SPA-GMN2D-JIBAISEIKBN-G
                   END-IF
      *
                   PERFORM 41012-SINKEI-SET-SEC
                   MOVE    SPACE           TO  SPA-GMN2D-SINKEI-G
      *            Å¾µ¢
                   IF      SPA-GMN2D-TENKI     =   SPACE
                       MOVE    SPA-GMN2D-TENKI-LST (02)
                                               TO  SPA-GMN2D-TENKI-G
                   END-IF
      *
                   IF      SPA-GMN2D-SISIKBN   =   SPACE
                       MOVE    SPA-GMN2D-SISIKBN-LST (01)
                                               TO  SPA-GMN2D-SISIKBN-G
                   END-IF
      *            ºÒ³²¶èÊ¬
                   MOVE   SPACE                TO  SPA-GMN2D-SAIGAI-G
           END-EVALUATE
      *
          .
       41011-SYOKI-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¿··ÑºÆÊÌÊÔ½¸½èÍý
      *****************************************************************
       41012-SINKEI-SET-SEC           SECTION.
      *
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
      *            Ã»´üµëÉÕ
                   MOVE    "1 ½é¿Ç"        TO  SPA-GMN2D-SINKEI-LST (01)
                   MOVE    "3 Å¾°å»Ï¿Ç"    TO  SPA-GMN2D-SINKEI-LST (02)
                   MOVE    "5 ·ÑÂ³"        TO  SPA-GMN2D-SINKEI-LST (03)
                   MOVE    "7 ºÆÈ¯"        TO  SPA-GMN2D-SINKEI-LST (04)
                   MOVE    4               TO  SPA-GMN2D-SINKEI-MAX
               WHEN    "2"
      *            ½ýÉÂÇ¯¶â
                   MOVE    "1 ½é¿Ç"        TO  SPA-GMN2D-SINKEI-LST (01)
                   MOVE    "5 ·ÑÂ³"        TO  SPA-GMN2D-SINKEI-LST (02)
                   MOVE    "7 ºÆÈ¯"        TO  SPA-GMN2D-SINKEI-LST (03)
                   MOVE    3               TO  SPA-GMN2D-SINKEI-MAX
               WHEN    OTHER
                   INITIALIZE                  SPA-GMN2D-SINKEI-COMB
                   MOVE    ZERO            TO  SPA-GMN2D-SINKEI-MAX
           END-EVALUATE
      *
      *
          .
       41012-SINKEI-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¥³¥á¥ó¥È    ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-COMMENT-CHK-SEC           SECTION.
      *
      *    Á´³Ñ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    SPA-GMN2D-COMMENT   TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           IF     (KANACHK-RC      NOT =   ZERO  )  OR
                  (KANACHK-SYUBETU     =   1     )
               IF      KANACHK-RC2         =   7
                   MOVE    KANACHK-OUT-INPUT   TO  SPA-GMN2D-COMMENT
               END-IF
               MOVE    "0031"              TO  SPA-ERRCD
               MOVE    02                  TO  SPA-GMN2D-CUR
           ELSE
               MOVE    KANACHK-OUT-INPUT   TO  SPA-GMN2D-COMMENT
           END-IF
      *
           .
       4101-COMMENT-CHK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    Ï«Æ¯ÊÝ¸±ÈÖ¹æÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-KOFUNUM-CHK-SEC            SECTION.
      *
           IF      SPA-GMN2D-KOHNUM1   =   SPACE
               GO      TO     4101-KOFUNUM-CHK-EXT
           END-IF
      *
      *    ·å¿ô¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    SPA-GMN2D-KOHNUM1   TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           IF     (KANACHK-RC          =   ZERO  )  AND
                  (KANACHK-SYUBETU     =   1     )  AND
                  (KANACHK-MAX         =   14  OR  11 )
      *        È¾³Ñ¤Ç¡¢£±£´¡¢£±£±·å¤Ç¤¢¤ë¤³¤È
               CONTINUE
           ELSE
               MOVE    "0003"              TO  SPA-ERRCD
               MOVE    3                   TO  SPA-GMN2D-CUR
           END-IF
      *
      ***  IF      KANACHK-MAX         =   11
      *        MOVE    ZERO            TO  SPA-GMN2D-KOHNUM1(12:)
      **** END-IF
      *
           .
       4101-KOFUNUM-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Ç¯¶â¾Ú½ñÈÖ¹æÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-KOHNUM2-CHK-SEC            SECTION.
      *
           IF      SPA-GMN2D-KOHNUM2   =   SPACE
               GO      TO     4101-KOHNUM2-CHK-EXT
           END-IF
      *
      *    ·å¿ô¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    SPA-GMN2D-KOHNUM2   TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           IF     (KANACHK-RC          =   ZERO  )  AND
                  (KANACHK-SYUBETU     =   1     )  AND
                  (KANACHK-MAX         =   9     )
      *        È¾³Ñ¤Ç¡¢£¹·å¤Ç¤¢¤ë¤³¤È
               CONTINUE
           ELSE
               MOVE    "0004"              TO  SPA-ERRCD
               MOVE    4                   TO  SPA-GMN2D-CUR
           END-IF
      *
           .
       4101-KOHNUM2-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÒ³²¶èÊ¬  ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-SAIGAI-CHK-SEC           SECTION.
      *
           IF      SPA-GMN2D-SAIGAI    =   SPACE
               GO      TO      4101-SAIGAI-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SAIGAI-MAX
               IF      SPA-GMN2D-SAIGAI    =
                                       SPA-GMN2D-SAIGAI-LST (IDX)(1:1)
                   MOVE    SPA-GMN2D-SAIGAI-LST (IDX)
                                               TO  SPA-GMN2D-SAIGAI-G
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0026"              TO  SPA-ERRCD
               MOVE    21                  TO  SPA-GMN2D-CUR
           END-IF
      *
           .
       4101-SAIGAI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿··ÑºÆÊÌ  ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-SINKEI-CHK-SEC           SECTION.
      *
           IF      SPA-GMN2D-SINKEI-G  =   SPACE
               GO      TO      4101-SINKEI-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SINKEI-MAX
               IF      SPA-GMN2D-SINKEI    =
                                       SPA-GMN2D-SINKEI-LST (IDX)(1:1)
                   MOVE    SPA-GMN2D-SINKEI-LST (IDX)
                                               TO  SPA-GMN2D-SINKEI-G
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0005"              TO  SPA-ERRCD
               MOVE    5                   TO  SPA-GMN2D-CUR
           END-IF
      *
           .
       4101-SINKEI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Å¾µ¢¶èÊ¬  ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-TENKI-CHK-SEC           SECTION.
      *
           IF      SPA-GMN2D-TENKI-G  =   SPACE
               GO      TO      4101-TENKI-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-TENKI-MAX
               IF      SPA-GMN2D-TENKI    =
                                       SPA-GMN2D-TENKI-LST (IDX)(1:1)
                   MOVE    SPA-GMN2D-TENKI-LST (IDX)
                                               TO  SPA-GMN2D-TENKI-G
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF     (SPA-GMN2D-TENKI NOT =   SPACE )  AND
                  (FLG-OK              =   ZERO  )
               MOVE    "0006"              TO  SPA-ERRCD
               MOVE    6                   TO  SPA-GMN2D-CUR
           END-IF
      *
           .
       4101-TENKI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    »Í»èÆÃÎã¶èÊ¬  ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-SISIKBN-CHK-SEC           SECTION.
      *
           IF      SPA-GMN2D-SISIKBN-G  =   SPACE
               GO      TO      4101-SISIKBN-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-SISIKBN-MAX
               IF      SPA-GMN2D-SISIKBN    =
                                       SPA-GMN2D-SISIKBN-LST (IDX)(1:1)
                   MOVE    SPA-GMN2D-SISIKBN-LST (IDX)
                                               TO  SPA-GMN2D-SISIKBN-G
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0007"              TO  SPA-ERRCD
               MOVE    7                   TO  SPA-GMN2D-CUR
           END-IF
      *
           .
       4101-SISIKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ½ýÉÂÇ¯·îÆü    ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-SHOBYOYMD-CHK-SEC           SECTION.
      *
           IF      SPA-GMN2D-SHOBYOYMD =   SPACE
               GO      TO      4101-SHOBYOYMD-CHK-EXT
           END-IF
      *
           IF      SPA-GMN2D-SHOBYOYMD =   SPACE
               IF      SPA-GMN2D-HKNKBN    =   "1" OR  "2"
                   MOVE    "0025"              TO  SPA-ERRCD
                   MOVE    8                   TO  SPA-GMN2D-CUR
                   GO      TO                  4101-SHOBYOYMD-CHK-EXT
               ELSE
                   MOVE    SPACE               TO  SPA-NAI2D-SHOBYOYMD
               END-IF
           ELSE
               INITIALIZE                      ORCSGDAYAREA
               MOVE    SPA-GMN2D-SHOBYOYMD     TO  SGDAY-INDAY
               CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
               IF      SGDAY-RC            =   ZERO
                   MOVE    SGDAY-OTDAY         TO  SPA-GMN2D-SHOBYOYMD
                   MOVE    SGDAY-SDAY          TO  SPA-NAI2D-SHOBYOYMD
               ELSE
                   MOVE    SPACE               TO  SPA-NAI2D-SHOBYOYMD
                   MOVE    "0008"              TO  SPA-ERRCD
                   MOVE    8                   TO  SPA-GMN2D-CUR
                   GO      TO                  4101-SHOBYOYMD-CHK-EXT
               END-IF
           END-IF
      *
           .
       4101-SHOBYOYMD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÎÅÍÜ³«»ÏÇ¯·îÆü    ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-RYOSTYMD-CHK-SEC           SECTION.
      *
      *
           IF      SPA-GMN2D-RYOSTYMD =   SPACE
               GO      TO      4101-RYOSTYMD-CHK-EXT
           END-IF
      *
           IF      SPA-GMN2D-RYOSTYMD      =   SPACE  OR  ZERO
               MOVE    SPACE               TO  SPA-NAI2D-RYOSTYMD
               IF      SPA-GMN2D-HKNKBN    =   "1"  OR  "2"
                   MOVE    "0012"              TO  SPA-ERRCD
                   MOVE    9                   TO  SPA-GMN2D-CUR
                   GO      TO      4101-RYOSTYMD-CHK-EXT
               END-IF
           ELSE
               INITIALIZE                      ORCSGDAYAREA
               MOVE    SPA-GMN2D-RYOSTYMD     TO  SGDAY-INDAY
               CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
               IF      SGDAY-RC            =   ZERO
                   MOVE    SGDAY-OTDAY         TO  SPA-GMN2D-RYOSTYMD
                   MOVE    SGDAY-SDAY          TO  SPA-NAI2D-RYOSTYMD
               ELSE
                   MOVE    SPACE               TO  SPA-NAI2D-RYOSTYMD
                   MOVE    "0009"              TO  SPA-ERRCD
                   MOVE    9                   TO  SPA-GMN2D-CUR
                   GO      TO                  4101-RYOSTYMD-CHK-EXT
               END-IF
           END-IF
      *
      *    ½ýÉÂÇ¯·îÆü¡äÎÅÍÜ³«»ÏÆü¤Ï¥¨¥é¡¼¤È¤¹¤ë
           IF      SPA-NAI2D-SHOBYOYMD >   SPA-NAI2D-RYOSTYMD
               MOVE    "0030"              TO  SPA-ERRCD
               MOVE    9                   TO  SPA-GMN2D-CUR
               GO      TO                  4101-RYOSTYMD-CHK-EXT
           END-IF
      *
           .
       4101-RYOSTYMD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÎÅÍÜ½ªÎ»Ç¯·îÆü    ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-RYOEDYMD-CHK-SEC           SECTION.
      *
           IF     (SPA-GMN2D-RYOSTYMD      =   SPACE ) AND
                  (SPA-GMN2D-RYOEDYMD      =   SPACE )
               GO      TO     4101-RYOEDYMD-CHK-EXT
           END-IF
      *
           IF      SPA-GMN2D-RYOEDYMD      =   SPACE
               MOVE    ALL "9"             TO  SPA-NAI2D-RYOEDYMD
               MOVE    "9999999  "         TO  SPA-GMN2D-RYOEDYMD
           END-IF
           IF      SPA-GMN2D-RYOEDYMD(1:7) =   "9999999"
               MOVE    ALL "9"             TO  SPA-NAI2D-RYOEDYMD
               MOVE    "9999999"           TO  SPA-GMN2D-RYOEDYMD
           ELSE
               INITIALIZE                      ORCSGDAYAREA
               MOVE    SPA-GMN2D-RYOEDYMD       TO  SGDAY-INDAY
               CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
               IF      SGDAY-RC            =   ZERO
                   MOVE    SGDAY-OTDAY         TO  SPA-GMN2D-RYOEDYMD
                   MOVE    SGDAY-SDAY          TO  SPA-NAI2D-RYOEDYMD
               ELSE
                   MOVE    SPACE               TO  SPA-NAI2D-RYOEDYMD
                   MOVE    "0010"              TO  SPA-ERRCD
                   MOVE    10                  TO  SPA-GMN2D-CUR
                   GO      TO                  4101-RYOEDYMD-CHK-EXT
               END-IF
           END-IF
      *
           IF      SPA-NAI2D-RYOSTYMD  >   SPA-NAI2D-RYOEDYMD
               MOVE    "0011"              TO  SPA-ERRCD
               MOVE    10                  TO  SPA-GMN2D-CUR
           END-IF
      *
           .
       4101-RYOEDYMD-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ö¶È¤ÎÌ¾¾ÎÆþÎÏ½èÍý
      *****************************************************************
       4101-JIGYOUNAME-CHK-SEC           SECTION.
      *
      *
           IF      SPA-GMN2D-JIGYOUNAME    =   SPACE
                GO      TO      4101-JIGYOUNAME-CHK-EXT
           END-IF
      *
      *    È¾³Ñ¶õÇò¢ªÁ´³Ñ¶õÇò
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    SPA-GMN2D-JIGYOUNAME
                                       TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           IF     (KANACHK-RC      NOT =   ZERO  )  OR
                  (KANACHK-SYUBETU     =   1     )
               MOVE    "0029"              TO  SPA-ERRCD
               MOVE    11                  TO  SPA-GMN2D-CUR
               IF      KANACHK-RC2         =   7
                   MOVE    KANACHK-OUT-INPUT   TO  SPA-GMN2D-JIGYOUNAME
               END-IF
           ELSE
               MOVE    KANACHK-OUT-INPUT   TO  SPA-GMN2D-JIGYOUNAME
           END-IF
      *
           .
       4101-JIGYOUNAME-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÔÆ»ÉÜ¸©ÆþÎÏ½èÍý
      *****************************************************************
       4101-PREFNAME-CHK-SEC           SECTION.
      *
      *    MOVE    12                  TO  SPA-GMN2D-CUR
      *
      *    MOVE    P02D-PREFNAME       TO  SPA-GMN2D-PREFNAME-G
      *
      *    MOVE    13                  TO  SPA-GMN2D-CUR
      *
           .
       4101-PREFNAME-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÔÆ»ÉÜ¸©ÆþÎÏ½èÍý
      *****************************************************************
       4101-PREFKBN-CHK-SEC           SECTION.
      *
      *    MOVE    13                  TO  SPA-GMN2D-CUR
      *
      *    MOVE    P02D-PREFKBN        TO  SPA-GMN2D-PREFKBN-G
           IF      SPA-GMN2D-PREFKBN-G =   SPACE
               GO      TO      4101-PREFKBN-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-PREFKBN-MAX
               IF      SPA-GMN2D-PREFKBN-LST(IDX) (1:1)
                                           =   SPA-GMN2D-PREFKBN
                   MOVE    SPA-GMN2D-PREFKBN-LST (IDX)
                                           TO  SPA-GMN2D-PREFKBN-G
                   MOVE    1               TO  FLG-OK
               END-IF
           END-PERFORM
      *
           IF      FLG-OK              =   ZERO
               MOVE    "0033"              TO  SPA-ERRCD
               MOVE    13                  TO  SPA-GMN2D-CUR
           END-IF
      *
      *
           .
       4101-PREFKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ·´»Ô¶èÆþÎÏ½èÍý
      *****************************************************************
       4101-CITYNAME-CHK-SEC           SECTION.
      *
           IF      SPA-GMN2D-CITYNAME    =   SPACE
                GO      TO      4101-CITYNAME-CHK-EXT
           END-IF
      *
      *    È¾³Ñ¶õÇò¢ªÁ´³Ñ¶õÇò
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    SPA-GMN2D-CITYNAME
                                       TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           IF     (KANACHK-RC      NOT =   ZERO  )  OR
                  (KANACHK-SYUBETU     =   1     )
               MOVE    "0030"              TO  SPA-ERRCD
               MOVE    14                  TO  SPA-GMN2D-CUR
               IF      KANACHK-RC2         =   7
                   MOVE    KANACHK-OUT-INPUT   TO  SPA-GMN2D-CITYNAME
               END-IF
           ELSE
               MOVE    KANACHK-OUT-INPUT   TO  SPA-GMN2D-CITYNAME
           END-IF
      *
           .
       4101-CITYNAME-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ·´»Ô¶èÆþÎÏ½èÍý
      *****************************************************************
       4101-CITYKBN-CHK-SEC           SECTION.
      *
           IF      SPA-GMN2D-CITYKBN-G     =   SPACE
               GO      TO      4101-CITYKBN-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GMN2D-CITYKBN-MAX
               IF      SPA-GMN2D-CITYKBN-LST(IDX) (1:1)
                                           =   SPA-GMN2D-CITYKBN
                   MOVE    SPA-GMN2D-CITYKBN-LST (IDX)
                                           TO  SPA-GMN2D-CITYKBN-G
                   MOVE    1               TO  FLG-OK
               END-IF
           END-PERFORM
      *
           IF      FLG-OK              =   ZERO
               MOVE    "0032"              TO  SPA-ERRCD
               MOVE    15                  TO  SPA-GMN2D-CUR
           END-IF
      *
           .
       4101-CITYKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ·ò¹¯´ÉÍý¼êÄ¢ÈÖ¹æ ÆþÎÏ½èÍý
      *****************************************************************
       4101-KOHNUM3-CHK-SEC           SECTION.
      *
           IF      SPA-GMN2D-KOHNUM3   =   SPACE
               GO      TO     4101-KOHNUM3-CHK-EXT
           END-IF
      *
      *    ·å¿ô¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    SPA-GMN2D-KOHNUM3   TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           IF     (KANACHK-RC          =   ZERO  )  AND
                  (KANACHK-SYUBETU     =   1     )  AND
                  (KANACHK-MAX         =   13  OR  10 )
      *        È¾³Ñ¤Ç¡¢£±£°¡¤£±£³·å¤Ç¤¢¤ë¤³¤È
               CONTINUE
           ELSE
               MOVE    "0028"              TO  SPA-ERRCD
               MOVE    16                  TO  SPA-GMN2D-CUR
           END-IF
      *
      **** IF      KANACHK-MAX         =   10
      *        MOVE    ZERO            TO  SPA-GMN2D-KOHNUM3(11:)
      *****END-IF
      *
      *
           .
       4101-KOHNUM3-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Â»½ý¶èÊ¬ ÆþÎÏ½èÍý
      *****************************************************************
       4101-SONSHOUKBN-CHK-SEC           SECTION.
      *
      *    MOVE    17                  TO  SPA-GMN2D-CUR
      *
      *    MOVE    P02D-SONSHOUKBN     TO  SPA-GMN2D-SONSHOUKBN-G
      *
      *    MOVE    18                  TO  SPA-GMN2D-CUR
           IF      SPA-GMN2D-SONSHOUKBN-G  =   SPACE
               GO      TO      4101-SONSHOUKBN-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-GMN2D-SONSHOUKBN-MAX) OR
                              (FLG-OK  =   1    )
               IF     (SPA-GMN2D-SONSHOUKBN-LST(IDX) (1:2)
                                           =   SPA-GMN2D-SONSHOUKBN) AND
                      (SPA-GMN2D-SONSHOUKBN-LST(IDX) (4:1)
                                           =   SPA-GMN2D-SONSHOUKBNEDA)
                   MOVE    SPA-GMN2D-SONSHOUKBN-LST (IDX)
                                           TO  SPA-GMN2D-SONSHOUKBN-G
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0034"              TO  SPA-ERRCD
               MOVE    17                  TO  SPA-GMN2D-CUR
           END-IF
      *
           .
       4101-SONSHOUKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¥¢¥Õ¥¿¡¼¥±¥¢ÎÅÍÜ³«»ÏÇ¯·îÆü    ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-SINSATUYMD-CHK-SEC           SECTION.
      *
           IF      SPA-GMN2D-SINSATUYMD     =   SPACE
               GO      TO      4101-SINSATUYMD-CHK-EXT
           END-IF
      *
           IF      SPA-GMN2D-SINSATUYMD     =   SPACE  OR  ZERO
               IF      SPA-GMN2D-HKNKBN    =   "3"
                   MOVE    "0019"              TO  SPA-ERRCD
               ELSE
                   MOVE    SPACE               TO  SPA-NAI2D-SINSATUYMD
               END-IF
           ELSE
               INITIALIZE                      ORCSGDAYAREA
               MOVE    SPA-GMN2D-SINSATUYMD    TO  SGDAY-INDAY
               CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
               IF      SGDAY-RC            =   ZERO
                   MOVE    SGDAY-OTDAY         TO  SPA-GMN2D-SINSATUYMD
                   MOVE    SGDAY-SDAY          TO  SPA-NAI2D-SINSATUYMD
               ELSE
                   MOVE    SPACE               TO  SPA-NAI2D-SINSATUYMD
                   MOVE    "0017"              TO  SPA-ERRCD
                   MOVE    18                  TO  SPA-GMN2D-CUR
               END-IF
           END-IF
      *
           .
       4101-SINSATUYMD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¥¢¥Õ¥¿¡¼¥±¥¢ÎÅÍÜ½ªÎ»Ç¯·îÆü    ÆþÎÏ¡¡½èÍý
      *****************************************************************
       4101-SINSATUEND-CHK-SEC           SECTION.
      *
           IF     (SPA-GMN2D-SINSATUYMD    =   SPACE ) AND
                  (SPA-GMN2D-SINSATUEND    =   SPACE )
               GO      TO      4101-SINSATUEND-CHK-EXT
           END-IF
      *
           IF      SPA-GMN2D-SINSATUEND    =   SPACE
               MOVE    ALL "9"             TO  SPA-NAI2D-SINSATUEND
               MOVE    "9999999  "         TO  SPA-GMN2D-SINSATUEND
           END-IF
           IF      SPA-GMN2D-SINSATUEND(1:7)   =   "9999999"
               MOVE    ALL "9"             TO  SPA-NAI2D-SINSATUEND
               MOVE    "9999999"           TO  SPA-GMN2D-SINSATUEND
           ELSE
               INITIALIZE                      ORCSGDAYAREA
               MOVE    SPA-GMN2D-SINSATUEND    TO  SGDAY-INDAY
               CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
               IF      SGDAY-RC            =   ZERO
                   MOVE    SGDAY-OTDAY         TO  SPA-GMN2D-SINSATUEND
                   MOVE    SGDAY-SDAY          TO  SPA-NAI2D-SINSATUEND
               ELSE
                   MOVE    SPACE               TO  SPA-NAI2D-SINSATUEND
                   MOVE    "0010"              TO  SPA-ERRCD
                   MOVE    19                  TO  SPA-GMN2D-CUR
               END-IF
           END-IF
      *
           IF      SPA-NAI2D-SINSATUYMD    >   SPA-NAI2D-SINSATUEND
               IF      SPA-ERRCD           =   SPACE
                   MOVE    "0011"              TO  SPA-ERRCD
                   MOVE    19                  TO  SPA-GMN2D-CUR
               END-IF
           END-IF
      *
           .
       4101-SINSATUEND-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼è¤ê¾Ã¤·½èÍý
      *****************************************************************
       420-MODORU-SEC             SECTION.
      *
      *    MOVE    SPACE               TO  HPARA-REC
      *    MOVE    "01"                TO  HPAR-FLG
      *
      *    MOVE    SPACE               TO  RSPARA-REC
      *    MOVE    "01"                TO  RSPAR-FLG
           MOVE    "1"                 TO  SPA-RSPAR-FLG
      *
           MOVE    1                   TO  FLG-END
      *
          .
       420-MODORU-EXT.
           EXIT.
      *****************************************************************
      *    ºï½ü½èÍý
      *****************************************************************
       430-SAKUJYO-SEC             SECTION.
      *
           MOVE    SPACE               TO  SPA-RSPAR-FLG
      *
           IF    SPA-NAI2D-HKNKBN-MAE  =   SPACE
               MOVE    "0020"          TO  SPA-ERRCD
               GO  TO                  430-SAKUJYO-EXT
           END-IF
      *
           MOVE    "1"                 TO  SPA-NAI-SAKJOKBN
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTRSIINF"          TO  PARA-FILEMEI
           MOVE    SPA-NAI-RSHKN-EDANUM
                                       TO  PARA-EDANUM
      *
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "DBSELECT"          TO  MCP-FUNC
           MOVE    "PARA-KEY"          TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    "PARA-KEY"          TO  ORC-DBPATH
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
           MOVE    "DBCLOSE"           TO  MCP-FUNC
           MOVE    "PARA-KEY"          TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
      *
           IF      FLG-PARA           =    ZERO
               MOVE    PARA-DATA-REC       TO  PTRSIINF-REC
               MOVE    "1"                 TO  PTRSI-SAKUJOKBN
               MOVE    PTRSIINF-REC        TO  PARA-DATA-REC
      *
               MOVE    PARA-REC            TO  MCPDATA-REC
               MOVE    "DBUPDATE"          TO  MCP-FUNC
               MOVE    "PARA-KEY"          TO  ORC-DBPATH
               CALL    "ORCMCPSUB"          USING
                                            MCPAREA
                                           ORCMCPAREA
                                            MCPDATA-REC
               IF      MCP-RC          NOT =   ZERO
                   DISPLAY "P02D PARA UPD ERR:"  MCP-RC
               END-IF
           END-IF
      *
      *
           MOVE    1                   TO  FLG-END
      *
      *    ½ªÎ»¤Ø
           PERFORM 210-BACK
      *
          .
       430-SAKUJYO-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       490-TOROKU-SEC             SECTION.
      *
           MOVE    1                   TO  FLG-TOUROKU
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *
      *    ÊÝ¸±´ü´Ö½ÅÊ£¥Á¥§¥Ã¥¯
           IF      SPA-ERRCD           =   SPACE
               PERFORM 49011-KANREN-HKN-CHECK-SEC
           END-IF
      *
      *    ´µ¼ÔÊÝ¸±½èÍý
           IF      SPA-ERRCD           =   SPACE
               PERFORM 49012-PTHKNINF-HEN-SEC
           END-IF
      *
      *    Ï«ºÒÊÝ¸±ÊÔ½¸½èÍý
           IF      SPA-ERRCD           =   SPACE
               PERFORM 4905-PTRSIINF-HEN-SEC
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE
               MOVE    SPACE               TO  SPA-RSPAR-FLG
               MOVE    1                   TO  FLG-END
      *        ½ªÎ»¤Ø
               PERFORM 210-BACK
           END-IF
           .
       490-TOROKU-EXT.
           EXIT.
      *
      *****************************************************************
      *   É¬¿ÜÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4109-TOUROKU-CHK-SEC             SECTION.
      *
      *    ´µ¼Ô¸òÉÕÈÖ¹æ
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
                   IF      SPA-GMN2D-KOHNUM1   =   SPACE
                       MOVE    "0022"              TO  SPA-ERRCD
                       MOVE    3                   TO  SPA-GMN2D-CUR
                   END-IF
                   IF      SPA-GMN2D-SAIGAI        =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0027"              TO  SPA-ERRCD
                       MOVE    21                  TO  SPA-GMN2D-CUR
                   END-IF
                   IF      SPA-GMN2D-SHOBYOYMD     =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0025"              TO  SPA-ERRCD
                       MOVE    8                   TO  SPA-GMN2D-CUR
                   END-IF
                   IF      SPA-GMN2D-RYOSTYMD =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0012"              TO  SPA-ERRCD
                       MOVE    9                   TO  SPA-GMN2D-CUR
                   END-IF
      *        ½ýÉÂ
               WHEN    "2"
                   IF      SPA-GMN2D-KOHNUM2   =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0023"              TO  SPA-ERRCD
                       MOVE    4                   TO  SPA-GMN2D-CUR
                   END-IF
                   IF      SPA-GMN2D-SAIGAI        =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0027"              TO  SPA-ERRCD
                       MOVE    21                  TO  SPA-GMN2D-CUR
                   END-IF
                   IF      SPA-GMN2D-SHOBYOYMD     =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0025"              TO  SPA-ERRCD
                       MOVE    8                   TO  SPA-GMN2D-CUR
                   END-IF
                   IF      SPA-GMN2D-RYOSTYMD      =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0012"              TO  SPA-ERRCD
                       MOVE    9                   TO  SPA-GMN2D-CUR
                   END-IF
               WHEN    "3"
                   IF      SPA-GMN2D-KOHNUM3   =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0024"              TO  SPA-ERRCD
                       MOVE    16                  TO  SPA-GMN2D-CUR
                   END-IF
                   IF      SPA-GMN2D-SINSATUYMD    =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0019"              TO  SPA-ERRCD
                       MOVE    18                  TO  SPA-GMN2D-CUR
                   END-IF
      *        ¼«ÇåÀÕ
               WHEN    "4"
                   IF      SPA-GMN2D-SHOBYOYMD     =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0025"              TO  SPA-ERRCD
                       MOVE    8                   TO  SPA-GMN2D-CUR
                   END-IF
                   IF      SPA-GMN2D-RYOSTYMD      =   SPACE
                     AND  (SPA-ERRCD               =   SPACE )
                       MOVE    "0012"              TO  SPA-ERRCD
                       MOVE    9                   TO  SPA-GMN2D-CUR
                   END-IF
           END-EVALUATE
      *
           .
       4109-TOUROKU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±´ü´Ö½ÅÊ£¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       49011-KANREN-HKN-CHECK-SEC    SECTION.
      *
      *¡©¡©    Ãæ¿È¤ò½¤Àµ¤·¤Æ¤Í¡©¡©
      *
      *
           .
       49011-KANREN-HKN-CHECK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ´µ¼ÔÊÝ¸±ÊÔ½¸½èÍý
      *****************************************************************
       49012-PTHKNINF-HEN-SEC         SECTION.
      *
      *    ¿·µ¬¤Î»þ¡¢ÊÝ¸±£É£Ä·×»»
           IF      SPA-NAI-HKNID       =   ZERO
               ADD     1                   TO  SPA-PTNUM-HKNID
               MOVE    SPA-PTNUM-HKNID     TO  SPA-NAI-HKNID
           END-IF
      *
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
               WHEN    "2"
               WHEN    "3"
                   MOVE    "971"               TO  SPA-GMN-HKNNUM
                   MOVE    "971"               TO  SPA-NAI2D-HKNNUM
               WHEN    "4"
                   MOVE    "973"               TO  SPA-GMN-HKNNUM
                   MOVE    "973"               TO  SPA-NAI2D-HKNNUM
           END-EVALUATE
      *
      *    Å¬ÍÑ´ü´Ö
           IF      SPA-GMN2D-HKNKBN    =   "3" 
      *        ¥¢¥Õ¥¿¡¼¥±¥¢
      ******** MOVE    "0000000"         TO  SPA-GMN-HTEKSTYMD
      *        MOVE    ZERO              TO  SPA-NAI-HTEKSTYMD
      *        MOVE    "9999999"         TO  SPA-GMN-HTEKEDYMD
      *********MOVE    "99999999"        TO  SPA-NAI-HTEKEDYMD
               MOVE    SPA-GMN2D-SINSATUYMD
                                             TO  SPA-GMN-HTEKSTYMD
               MOVE    SPA-NAI2D-SINSATUYMD
                                             TO  SPA-NAI-HTEKSTYMD
               MOVE    SPA-GMN2D-SINSATUEND
                                             TO  SPA-GMN-HTEKEDYMD
               MOVE    SPA-NAI2D-SINSATUEND
                                             TO  SPA-NAI-HTEKEDYMD
           ELSE
      *        °Ê³°¤Î»þ¡¢ÎÅÍÜ³«»ÏÇ¯·îÆü
               IF      SPA-GMN2D-RYOSTYMD    =   SPACE
                   MOVE    "0000000"         TO  SPA-GMN-HTEKSTYMD
                   MOVE    ZERO              TO  SPA-NAI-HTEKSTYMD
               ELSE
                   MOVE    SPA-GMN2D-RYOSTYMD
                                             TO  SPA-GMN-HTEKSTYMD
                   MOVE    SPA-NAI2D-RYOSTYMD
                                             TO  SPA-NAI-HTEKSTYMD
               END-IF
               IF      SPA-GMN2D-RYOEDYMD    =   SPACE
                   MOVE    "9999999"         TO  SPA-GMN-HTEKEDYMD
                   MOVE    "99999999"        TO  SPA-NAI-HTEKEDYMD
               ELSE
                   MOVE    SPA-GMN2D-RYOEDYMD
                                             TO  SPA-GMN-HTEKEDYMD
                   MOVE    SPA-NAI2D-RYOEDYMD
                                             TO  SPA-NAI-HTEKEDYMD
               END-IF
           END-IF
      *
      *    µ­¹æ¡¦ÈÖ¹æ¤Ø¥³¥á¥ó¥ÈÅù¤ÎÊÔ½¸
           MOVE    SPA-GMN2D-HKNKBNMEI   TO  SPA-GMN-KIGO
           MOVE    SPA-GMN2D-COMMENT     TO  SPA-GMN-NUM
      *
           .
       49012-PTHKNINF-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÊÝ¸±ÊÔ½¸½èÍý
      *****************************************************************
       4905-PTRSIINF-HEN-SEC         SECTION.
      *
      *    ´µ¼ÔÊÝ¸±½èÍý
      *
           INITIALIZE                      PTRSIINF-REC
      *
           MOVE    SPA-HOSPID          TO  PTRSI-HOSPID
           MOVE    SPA-GMN-PTID        TO  PTRSI-PTID
           MOVE    SPA-GMN2D-HKNKBN    TO  PTRSI-HKNKBN
           MOVE    SPA-NAI2D-HKNNUM    TO  PTRSI-HKNNUM
           MOVE    SPA-NAI-HKNID       TO  PTRSI-HKNID
      *
      *    ´µ¼Ô¸òÉÕÈÖ¹æ
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
                   MOVE    SPA-GMN2D-KOHNUM1   TO  PTRSI-KOFUNUM
               WHEN    "2"
                   MOVE    SPA-GMN2D-KOHNUM2   TO  PTRSI-KOFUNUM
               WHEN    "3"
                   MOVE    SPA-GMN2D-KOHNUM3   TO  PTRSI-KOFUNUM
           END-EVALUATE
      *
      *    ¼«ÇåÀÕ´µ¼ÔÀÁµá¶èÊ¬
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "4"
                   MOVE    SPA-GMN2D-JIBAISEIKBN
                                               TO  PTRSI-JIBAISEIKBN
           END-EVALUATE
      *
           MOVE    SPA-GMN2D-HIHKNJANAME
                                       TO  PTRSI-HIHKNJANAME
           MOVE    SPA-GMN2D-COMMENT   TO  PTRSI-COMMENT
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
      *        Ã»´ü¤Î¤ß
      *            »ö¶È½êÌ¾¾Î
                   MOVE    SPA-GMN2D-JIGYOUNAME
                                               TO  PTRSI-JIGYOUNAME
                   MOVE    SPA-GMN2D-PREFNAME  TO  PTRSI-PREFNAME
                   MOVE    SPA-GMN2D-PREFKBN   TO  PTRSI-PREFKBN
                   MOVE    SPA-GMN2D-CITYNAME  TO  PTRSI-CITYNAME
                   MOVE    SPA-GMN2D-CITYKBN   TO  PTRSI-CITYKBN
           END-EVALUATE
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
               WHEN    "2"
      *        Ã»´ü¡¦½ýÉÂ
                   MOVE    SPA-GMN2D-SINKEI    TO  PTRSI-SINKEI
      *            ºÒ³²¶èÊ¬
                   MOVE    SPA-GMN2D-SAIGAI    TO  PTRSI-SAIGAIKBN
      *
           END-EVALUATE
           EVALUATE    SPA-GMN2D-HKNKBN
               WHEN    "1"
               WHEN    "2"
               WHEN    "4"
      *        Ã»´ü¡¦½ýÉÂ¡¦¼«ÇåÀÕ
                   MOVE    SPA-GMN2D-TENKI     TO  PTRSI-TENKI
                   MOVE    SPA-NAI2D-SHOBYOYMD TO  PTRSI-SHOBYOYMD
                   MOVE    SPA-GMN2D-SISIKBN   TO  PTRSI-SISIKBN
                   MOVE    SPA-NAI2D-RYOSTYMD  TO  PTRSI-RYOSTYMD
                   MOVE    SPA-NAI2D-RYOEDYMD  TO  PTRSI-RYOEDYMD
           END-EVALUATE
           EVALUATE    SPA-GMN2D-HKNKBN
      *        ¥¢¥Õ¥¿¡¼¥±¥¢
               WHEN    "3"
                   MOVE    SPA-GMN2D-SONSHOUKBN
                                               TO  PTRSI-SONSHOUKBN
                   MOVE    SPA-GMN2D-SONSHOUKBNEDA
                                           TO  PTRSI-SONSHOUKBN-EDANUM
                   MOVE    SPA-NAI2D-SINSATUYMD
                                               TO  PTRSI-SINSATUYMD
                   MOVE    SPA-NAI2D-SINSATUEND
                                               TO  PTRSI-SINSATUEND
           END-EVALUATE
      *    ³ÎÇ§Ç¯·îÆü
           MOVE    SPA-NAI2D-KAKUNINYMD
                                       TO  PTRSI-KAKUNINYMD
      *
      *****MOVE    PTRSIINF-REC        TO  RSPAR-REC
      *
      *
           IF      SPA-NAI-RSHKN-EDANUM    =   ZERO
               ADD     1                   TO  SPA-P02-RSHKNMAX
               MOVE    SPA-P02-RSHKNMAX    TO  SPA-NAI-RSHKN-EDANUM
           END-IF
      *
      *
           INITIALIZE                      PARA-REC
           MOVE    "P02"               TO  PARA-GYOUMUID
           MOVE    SPA-TERMID          TO  PARA-TERMID
           MOVE    "PTRSIINF"          TO  PARA-FILEMEI
           MOVE    SPA-NAI-RSHKN-EDANUM
                                       TO  PARA-EDANUM
      *
           MOVE    PARA-REC            TO  MCPDATA-REC
           MOVE    "DBSELECT"          TO  MCP-FUNC
           MOVE    "PARA-KEY"          TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    "PARA-KEY"          TO  ORC-DBPATH
               PERFORM 990-PARA-READ-SEC
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
           MOVE    "DBCLOSE"           TO  MCP-FUNC
           MOVE    "PARA-KEY"          TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
      *
           IF      FLG-PARA           =   1
      *        ÄÉ²Ã
               INITIALIZE                      PARA-REC
               MOVE    "P02"               TO  PARA-GYOUMUID
               MOVE    SPA-TERMID          TO  PARA-TERMID
               MOVE    "PTRSIINF"          TO  PARA-FILEMEI
               MOVE    SPA-NAI-RSHKN-EDANUM
                                           TO  PARA-EDANUM
               MOVE    PTRSIINF-REC        TO  PARA-DATA-REC
      *
               MOVE    PARA-REC            TO  MCPDATA-REC
               MOVE    "DBINSERT"          TO  MCP-FUNC
               MOVE    "PARA-KEY"          TO  ORC-DBPATH
               CALL    "ORCMCPSUB"          USING
                                            MCPAREA
                                           ORCMCPAREA
                                            MCPDATA-REC
               IF      MCP-RC          NOT =   ZERO
                   DISPLAY "P02D PARA INS ERR:"  MCP-RC
               END-IF
           ELSE
               MOVE    PTRSIINF-REC        TO  PARA-DATA-REC
      *
               MOVE    PARA-REC            TO  MCPDATA-REC
               MOVE    "DBUPDATE"          TO  MCP-FUNC
               MOVE    "PARA-KEY"          TO  ORC-DBPATH
               CALL    "ORCMCPSUB"          USING
                                            MCPAREA
                                           ORCMCPAREA
                                            MCPDATA-REC
               IF      MCP-RC          NOT =   ZERO
                   DISPLAY "P02D PARA UPD ERR:"  MCP-RC
               END-IF
           END-IF
      *
           .
       4905-PTRSIINF-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ìá¤ë¡¡½èÍý
      *****************************************************************
       210-BACK                    SECTION.
      *
           MOVE    "P02D"              TO  SPA-MOTOPG
           MOVE    "P02"               TO  SPA-SAKIPG
      *
           MOVE    SPACE               TO  LNK-KYOUTU
      *
           MOVE    "JOIN"              TO  MCP-PUTTYPE.
           MOVE    "P02"               TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
           MOVE    ZERO                TO  SPA-FLG-END
           MOVE    "P02"               TO  SPA-P02-GAMEN
      *
           .
       210-BACK-EXT.
           EXIT.
      *****************************************************************
      *    À¾Îñ¢ªÏÂÎñFORMATÆüÉÕÊÔ½¸
      *****************************************************************
       410112-SE-WAFORMAT-YMDEDIT-SEC  SECTION.
      *
           EVALUATE    WRK-SYMD
               WHEN    SPACE
                   MOVE    SPACE               TO  WRK-HENYMD
               WHEN    ZERO
                   MOVE    "0000000  "         TO  WRK-HENYMD
               WHEN    "99999999"
                   MOVE    "9999999  "         TO  WRK-HENYMD
               WHEN    OTHER
                   MOVE    SPACE               TO  STS-AREA-DAY
                   INITIALIZE                      STS-AREA-DAY
                   MOVE    SPACE               TO  LNK-DAY2-AREA
                   MOVE    "21"                TO  LNK-DAY2-IRAI
                   MOVE    WRK-SYMD            TO  LNK-DAY2-YMD
                   CALL    "ORCSDAY"           USING
                                               STS-AREA-DAY
                                               LNK-DAY2-AREA
                   IF      STS-DAY-RC1             =   ZERO
                       MOVE    LNK-DAY2-EDTYMD1    TO  WRK-HENYMD
                   ELSE
                       MOVE    SPACE               TO  WRK-HENYMD
                   END-IF
           END-EVALUATE
           .
       410112-SE-WAFORMAT-YMDEDIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼«²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-SET-SCREEN              SECTION.
      *
           PERFORM 500-GMNHEN-SEC
      *
           IF      SPA-ERRCD       NOT =   SPACE
               PERFORM 510-ERRSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    "CURRENT"           TO  MCP-PUTTYPE.
           MOVE    "P02D"              TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
           .
       500-SET-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸É½¼¨Íý
      *****************************************************************
       510-ERRSET-SEC              SECTION.
           MOVE    SPACE               TO  SPA-ERRMSG
      *
           EVALUATE    SPA-ERRCD
               WHEN    "0001"
                   MOVE    "Ï«ºÒ¼«ÇåÊÝ¸±¶èÊ¬¤¬°ã¤¤¤Þ¤¹¡£"
                                               TO  SPA-ERRMSG
               WHEN    "0002"
                   MOVE    "ÈïÊÝ¸±¼ÔÌ¾ÆþÎÏ¥¨¥é¡¼"
                                               TO  SPA-ERRMSG
               WHEN    "0003"
                   MOVE    "Ï«Æ¯ÊÝ¸±ÈÖ¹æ¤ÏÈ¾³Ñ£±£´·å¤«£±£±·å¤Ç"
                                               TO  SPA-ERRMSG
                   MOVE    "ÆþÎÏ¤·¤Æ²¼¤µ¤¤¡£"
                                               TO  SPA-ERRMSG(35:)
               WHEN    "0004"
                   MOVE    "Ç¯¶â¾Ú½ñÈÖ¹æ¤ÏÈ¾³Ñ£¹·å¤ÇÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                               TO  SPA-ERRMSG
               WHEN    "0005"
                   MOVE    "¿··ÑºÆ¶èÊ¬ÆþÎÏ¥¨¥é¡¼"
                                               TO  SPA-ERRMSG
               WHEN    "0006"
                   MOVE    "Å¾µ¢»öÍ³ÆþÎÏ¥¨¥é¡¼"
                                               TO  SPA-ERRMSG
               WHEN    "0007"
                   MOVE    "»Í»èÆÃÎã¶èÊ¬ÆþÎÏ¥¨¥é¡¼"
                                               TO  SPA-ERRMSG
               WHEN    "0008"
                   MOVE    "½ýÉÂÇ¯·îÆü¤ÎÎñÆü¥¨¥é¡¼¤Ç¤¹"
                                               TO  SPA-ERRMSG
               WHEN    "0009"
                   MOVE    "ÎÅÍÜ³«»ÏÆü¤ÎÎñÆü¥¨¥é¡¼¤Ç¤¹"
                                               TO  SPA-ERRMSG
               WHEN    "0010"
                   MOVE    "ÎÅÍÜ½ªÎ»Æü¤ÎÎñÆü¥¨¥é¡¼¤Ç¤¹"
                                               TO  SPA-ERRMSG
               WHEN    "0011"
                   MOVE    "ÎÅÍÜ³«»ÏÆü¡äÎÅÍÜ½ªÎ»Æü¤ÏÆþÎÏ¤Ç¤­¤Þ¤»¤ó"
                                               TO  SPA-ERRMSG
               WHEN    "0012"
                   MOVE    "ÎÅÍÜ³«»ÏÆü¤ÏÉ¬¿ÜÆþÎÏ¤Ç¤¹¡£ÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                               TO  SPA-ERRMSG
               WHEN    "0017"
                   MOVE    "ÎÅÍÜ³«»ÏÆü¤ÎÎñÆü¥¨¥é¡¼¤Ç¤¹"
                                               TO  SPA-ERRMSG
               WHEN    "0018"
                   MOVE    "¸¡ººÇ¯·îÆü¤ÎÎñÆü¥¨¥é¡¼¤Ç¤¹"
                                               TO  SPA-ERRMSG
               WHEN    "0019"
                   MOVE    "ÎÅÍÜ³«»ÏÆü¤ÏÉ¬¿ÜÆþÎÏ¤Ç¤¹¡£ÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                               TO  SPA-ERRMSG
               WHEN    "0020"
                   MOVE    "¿·µ¬ÆþÎÏ»þ¡¢ºï½ü¤Ï¤Ç¤­¤Þ¤»¤ó"
                                               TO  SPA-ERRMSG
               WHEN    "0021"
                   MOVE    "Ï«ºÒ¼«ÇåÊÝ¸±¶èÊ¬¤ÏÊÑ¹¹¤Ç¤­¤Þ¤»¤ó"
                                               TO  SPA-ERRMSG
               WHEN    "0022"
                   MOVE    "Ï«Æ¯ÊÝ¸±ÈÖ¹æ¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                               TO  SPA-ERRMSG
               WHEN    "0023"
                   MOVE    "Ç¯¶â¾Ú½ñÈÖ¹æ¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                               TO  SPA-ERRMSG
               WHEN    "0024"
                   MOVE    "·ò¹¯´ÉÍý¼êÄ¢ÈÖ¹æ¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                               TO  SPA-ERRMSG
               WHEN    "0025"
                   MOVE    "½ýÉÂÇ¯·îÆü¤ÏÉ¬¿ÜÆþÎÏ¤Ç¤¹¡£ÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                               TO  SPA-ERRMSG
               WHEN    "0026"
                   MOVE    "ºÒ³²¶èÊ¬ÆþÎÏ¥¨¥é¡¼"
                                               TO  SPA-ERRMSG
               WHEN    "0027"
                   MOVE    "ºÒ³²¶èÊ¬¤ÏÉ¬¿ÜÆþÎÏ¤Ç¤¹¡£ÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                               TO  SPA-ERRMSG
               WHEN    "0028"
                   MOVE    "·ò¹¯´ÉÍý¼êÄ¢ÈÖ¹æ¤ÏÈ¾³Ñ£±£³·å¤«£±£°·å¤Ç"
                                               TO  SPA-ERRMSG
                   MOVE    "ÆþÎÏ¤·¤Æ²¼¤µ¤¤¡£"
                                               TO  SPA-ERRMSG(35:)
               WHEN    "0029"
                   MOVE    "»ö¶È¤ÎÌ¾¾Î¤ÏÁ´³Ñ¤ÇÆþÎÏ¤·¤Æ²¼¤µ¤¤¡£"
                                               TO  SPA-ERRMSG
               WHEN    "0030"
                   MOVE    "½ýÉÂÇ¯·îÆü¡äÎÅÍÜ³«»ÏÆü¤ÏÆþÎÏ¤Ç¤­¤Þ¤»¤ó"
                                               TO  SPA-ERRMSG
               WHEN    "0031"
                   MOVE    "½ýÉÂ¤ÎÉô°Ì¤ÏÁ´³Ñ¤ÇÆþÎÏ¤·¤Æ²¼¤µ¤¤¡£"
                                               TO  SPA-ERRMSG
               WHEN    "0032"
                   MOVE    "·´»Ô¶è¤¬¤¢¤ê¤Þ¤»¤ó¡£"
                                               TO  SPA-ERRMSG
               WHEN    "0033"
                   MOVE    "ÅÔÆ»ÉÜ¸©¤¬¤¢¤ê¤Þ¤»¤ó¡£"
                                               TO  SPA-ERRMSG
               WHEN    "0034"
                   MOVE    "Â»½ý¶èÊ¬¤¬¤¢¤ê¤Þ¤»¤ó¡£"
                                               TO  SPA-ERRMSG
               WHEN    "0035"
                   MOVE    "¼«ÇåÀÕÀÁµá¶èÊ¬¤¬¤¢¤ê¤Þ¤»¤ó¡£"
                                               TO  SPA-ERRMSG
           END-EVALUATE
      *
           MOVE    SPACE               TO  PERR
           MOVE    SPA-ERRCD           TO  PERR-ERRCODE
           MOVE    SPA-ERRMSG          TO  PERR-ERRMSG
           MOVE    "B01"               TO  MCP-WIDGET
      *
           MOVE    "P02D"              TO  SPA-MOTOPG
           MOVE    "PERR"              TO  SPA-SAKIPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE.
           MOVE    "PERR"              TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
      *
           .
       510-ERRMSG-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Ñ¥é¥á¥¿¾ðÊóÆÉ¤ß¹þ¤ß
      *****************************************************************
       990-PARA-READ-SEC        SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PARA-REC
               MOVE    ZERO            TO  FLG-PARA
           ELSE
               INITIALIZE                  PARA-REC
               MOVE    1               TO  FLG-PARA
           END-IF
      *
           .
       990-PARA-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Ñ¥é¥á¥¿¥Ç¡¼¥¿½çÆÉ¤ß
      *****************************************************************
      *990-PARA-NEXT-SEC           SECTION.
      *
      *    READ    PARA-FILE       NEXT
      *        AT  END
      *            MOVE    1           TO  FLG-PARA
      *        NOT AT  END
      *            MOVE    ZERO        TO  FLG-PARA
      *    END-READ
      *
      *    .
      *990-PARA-NEXT-EXT.
      *    EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÈÖ¹æ¥Þ¥¹¥¿¼¡¸¡º÷½èÍý
      *****************************************************************
       921-HKNMST-NEXT-SEC              SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  HKNNUM-REC
               MOVE    ZERO            TO  FLG-HKNNUM
           ELSE
               INITIALIZE              HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           .
       921-HKNMST-NEXT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±¼ÔÈÖ¹æ¥Þ¥¹¥¿¼¡¸¡º÷½èÍý
      *****************************************************************
       900-HKNJAINF-READ-SEC              SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  HKNJAINF-REC
               MOVE    ZERO            TO  FLG-HKNJAINF
           ELSE
               INITIALIZE              HKNJAINF-REC
               MOVE    1               TO  FLG-HKNJAINF
           END-IF
           .
       900-HKNJAINF-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       900-KANRIMST-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       900-KANRIMST-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ð£Õ£Ô¡¡½èÍý
      *****************************************************************
       900-PUT-WINDOW              SECTION.
      *
           MOVE   "PUTWINDOW"       TO  MCP-FUNC.
           CALL   "ORCMCPSUB"   USING
                                MCPAREA
                                ORCMCPAREA
                                MCPDATA-REC.
      *
           .
       900-PUT-WINDOW-EXT.
           EXIT.
      *
      *
