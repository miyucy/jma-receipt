      ******************************************************************
      * ORCA -- Online Receipt Computer Advantage
      *
      * Copyright (C)  2000-2001 JMA.         
      *
      * This module is part of ORCA.
      *
      *     ORCA is distributed in the hope that it will be useful, but
      * WITHOUT ANY WARRANTY.  No author or distributor accepts 
      * responsibility to anyone for the consequences of using it or for
      * whether it serves any particular purpose or works at all, unless
      * he says so in writing.
      * Refer to the GNU General Public License for full details. 
      *
      *     Everyone is granted permission to copy, modify and
      * redistribute ORCA, but only under the conditions described in
      * the GNU General Public License.  A copy of this license is
      * supposed to have been given to you along with ORCA so you can
      * know your rights and responsibilities.  It should be in a file
      * named COPYING.  Among other things, the copyright notice and 
      * this notice must be preserved on all copies. 
      ******************************************************************      *
      *
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCL0011.
      *****************************************************************
      *  •∑•π•∆•‡Ãæ        : £œ£“£√£¡
      *  •µ•÷•∑•π•∆•‡Ãæ    : 
      *  •≥•Û•›°º•Õ•Û•»Ãæ  : 
      *  ¥…Õ˝º‘            : 
      *  ∫Ó¿Æ∆¸…’    ∫Ó∂»º‘        µ≠Ω“
      *  00/12/01    MCC-∆£∏∂      ø∑µ¨∫Ó¿Æ
      *****************************************************************
      *  •◊•Ì•∞•È•‡Ω§¿µÕ˙ŒÚ
      * Maj/Min/Rev  Ω§¿µº‘       ∆¸…’      ∆‚Õ∆
      * 01.00.01     NACL-¬ø°π«º  03/05/23  £»£±£µ«Ø£∂∑Ó≤˛¿µ¬–±˛
      * 01.00.02     NACL-¬ø°π«º  03/07/01  ≥∞ÕËø«Œ≈Œ¡ƒ…≤√
      * 01.00.03     NACL-¬ø°π«º  04/02/17  ø«Œ≈≤ °«£ÿ£ÿ°«ƒ…≤√
      * 01.00.04     NACL-¬ø°π«º  04/10/29   ›∏±¡»πÁ§ª§Œ¡™¬Ú ¨§Ú∫«ΩÈ§ÿ
      * 01.00.05     NACL-√›≈ƒ    05/03/02  ∏¯»ÒΩ–ŒœΩÁ —ππ
      * 01.00.06     NACL-¬ø°π«º  06/03/20  £»£±£∏«Ø£¥∑Ó≤˛¿µ¬–±˛
      * 01.00.07     NACL-¬ø°π«º  06/05/25  MONFUNC¬–±˛
      *
      * 03.03.01     NACL-∆£∏∂    06/10/15  £≤£∞£∞£∂«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *                                     ∏¯»Ò§Œƒ…≤√
      * 03.03.02     NACL-∆£∏∂    06/10/31  Œ≈Õ‹≤∏Ó∞ÂŒ≈£≤£¥§Œƒ…≤√
      * 03.05.00     NACL-¬ø°π«º  07/05/09  •∞•Î°º•◊ø«Œ≈¬–±˛
      * 03.05.00     NACL-¬ø°π«º  07/05/25  UID•∆°º•÷•Î¬–±˛
      * 03.05.01     NACL-¬ø°π«º  07/08/10  ºı…’•·•‚ƒ…≤√¬–±˛
      * 04.03.00     NACL-¬ø°π«º  08/06/11  •·•‚≈–œø§Œ¡˜øÆ¬–±˛
      * 04.04.00     NACL-√›≈ƒ°°  09/02/25  ∏¯≥≤¬–±˛
      * 04.05.00     NACL-¬ø°π«º  10/01/15  º£∏≥°¶≥»ƒ•¥¡ª˙¬–±˛
      * 04.05.00     NACL-¬ø°π«º  10/03/XX   ø¿Æ£≤£≤«Ø£¥∑Ó≤˛¿µ¬–±˛
      *****************************************************************
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *    
      **** SELECT  LF03-FILE       ASSIGN  "/var/tmp/LF03V01"
      *                            ORGANIZATION    IS  INDEXED
      *                            ACCESS  MODE    IS  DYNAMIC
      *                            RECORD  KEY     IS  LF03-KEY
      ***                          FILE    STATUS  IS  STS-LF03.
      *
       DATA                        DIVISION.
       FILE                        SECTION.
      *
      *FD  LF03-FILE.
      *01  LF03-REC. 
      *    COPY    "CPRLF003.INC".
      *
       WORKING-STORAGE             SECTION.
      *        
018000*    •’•È•∞ŒŒ∞Ë
      *01  STS-AREA.
      *    03  STS-LF03            PIC X(02).
      *
018000*    •’•È•∞ŒŒ∞Ë
018100 01  FLG-AREA.
           03  FLG-END             PIC 9(01).
018900     03  FLG-PTINF           PIC 9(01).
018900     03  FLG-PTKOHINF        PIC 9(01).
018900     03  FLG-PTHKNINF        PIC 9(01).
018900     03  FLG-HKNCOMBI        PIC 9(01).
           03  FLG-SRYKARRK        PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
           03  FLG-TENSU           PIC 9(01).
      ***  03  FLG-LF03            PIC 9(01).
           03  FLG-CLMUID          PIC 9(01).
           03  FLG-JYURRK          PIC 9(01).
           03  FLG-SRYACT          PIC 9(01).
           03  FLG-HKNNUM          PIC 9(01).
           03  FLG-PTMEMOINF       PIC 9(01).
           03  FLG-UID             PIC 9(01).
      *
      *    ≈∫ª˙ŒŒ∞Ë
       01  IDX-AREA.
           03  IDW                 PIC 9(04).
           03  IDX                 PIC 9(04).
           03  IDX1                PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDY1                PIC 9(01).
           03  IDZ                 PIC 9(04).
      *
           03  IDX-U               PIC 9(04).
      *
           03  IDX-HZN             PIC 9(04).
      *
      *    ∞Ïª˛ŒŒ∞Ë
       01  WRK-AREA.
           03  WRK-WYMD.
               05  WRK-WYY         PIC X(04).
               05  WRK-WMM         PIC X(02).
               05  WRK-WDD         PIC X(02).
      *
           03  WRK-POST            PIC X(07).
           03  WRK-HENPOST         PIC X(08).
      *
           03  WRK-ZZZ             PIC Z99.
           03  WRK-999             PIC 9(03).
           03  WRK-SYOYMD          PIC X(08).
           03  WRK-SYOSIN          PIC 9(01).
           03  WRK-SYOSINKBN       PIC X(08).
      *
           03  WRK-SRYKA           PIC X(02).
      *
           03 TBL-MAX              PIC 9(01).
      *
      *    ∏¯»Ò ¬¬ÿ§®Õ—•Ô°º•Ø
           03  WRK-KOHI-AREA.
      *     ¬§”¬ÿ§®¡∞
               05  WRK-KOHI-TBL        OCCURS  4.
                   07  WRK-KOHID-O     PIC  9(10).
                   07  WRK-KOHHKNNUM-O PIC  X(03).
                   07  WRK-KOHMEI-O    PIC  X(50).
                   07  WRK-GAIJGNKBN-O PIC  X(01).
      *     ¬§”¬ÿ§®∏Â
           03  WRK-KOHI-AREA-X.
               05  WRK-KOHI-TBL-X      OCCURS  4.
                   07  WRK-KOHID       PIC  9(10).
                   07  WRK-KOHHKNNUM   PIC  X(03).
                   07  WRK-KOHMEI      PIC  X(50).
                   07  WRK-GAIJGNKBN   PIC  X(01).
      *    £”£œ£“£‘Õ—•Ô°º•Ø
           03  WRK-KOHI.
               05  WRK-KOHID-W         PIC  9(10).
               05  WRK-KOHHKNNUM-W     PIC  X(03).
               05  WRK-KOHMEI-W        PIC  X(50).
               05  WRK-GAIJGNKBN-W     PIC  X(01).
      *
      *    ø«ª°Œ¡Õ—
       01  WRK-SINSATU-AREA.
      *    ºıø«≤ÛøÙ
           03  WRK-SINSATU-CNT         PIC 9(04).
      *    £±£µ∫–Ã§À˛∫∆ø«Œ¡§¢§Í
           03  WRK-15MIMAN-ARI         PIC 9(01).
           03  FLG-15MIMAN             PIC 9(01).
           03  FLG-CHK                 PIC 9(01).
      *    æÆª˘≤ ≥∞ÕËø«Œ≈≤ ª‹¿ﬂµ¨Ω‡§¢§Í
           03  FLG-SYONIKA-ARI         PIC 9(01).
      *    æÆª˘≤ ≥∞ÕËø«Œ≈≤ ªªƒÍ
           03  FLG-SYONIKA             PIC 9(01).
           03  FLG-SYOSIN              PIC 9(01).
      *    ø«ª°Œ¡
           03  FLG-SINSATU         PIC 9(01).
      *    œ∑øÕ
           03  FLG-ROUJIN         PIC 9(01).
      *    «ØŒ»ΩƒÍÕ—
           03  WRK-BIRTHDAY.
               05  WRK-BIRTH-YY    PIC 9(04).
               05  WRK-BIRTH-MM    PIC 9(02).
               05  WRK-BIRTH-DD    PIC 9(02).
      *    Œ∑◊ªªŒŒ∞Ë
           03  WRK-NENREI.
               05  WRK-NENREI-YY         PIC 9(03).
               05  WRK-NENREI-MM         PIC 9(02).
               05  WRK-NENREI-DD         PIC 9(02).
      *
           03  WRK-YMDS1.
               05  WRK-YYS1        PIC 9(04).
               05  WRK-MMS1        PIC 9(02).
               05  WRK-DDS1        PIC 9(02).
           03  WRK-YMDS2.
               05  WRK-YYS2        PIC 9(04).
               05  WRK-MMS2        PIC 9(02).
               05  WRK-DDS2        PIC 9(02).
      *
           03  WRK-KAISU               PIC 9(04).
           03  WRK-HOSPSBT             PIC 9(01).
           03  WRK-SRYKBN              PIC X(02).
           03  WRK-KBN                 PIC X(01).
           03  WRK-KBN2                PIC X(01).
           03  FLG-ARI                 PIC 9(01).
      *
           03  FLG-ARIS                PIC 9(01).
      *
           03  WRK-LSTYMD              PIC X(08).
           03  WRK-LSTSRYKA            PIC X(02).
      * 
      *    …È√¥Œ®
           03  WRK-FTNRATE             PIC 9(02)V99.
           03  WRK-Z9                  PIC 9.ZZ.
           03  WRK-FTNRATEMEI          PIC X(05).
           03  WRK-ZZ9                 PIC ZZZZ9.
      *
           03  WRK-C-UID               PIC X(36).
      *
      *    ¥µº‘•·•‚ ¨≤Ú
           03  WRK-MEMO                PIC X(1000).
           03  WRK-MEMO-G.
               05  WRK-MEMO-01         PIC X(1000).
               05  WRK-MEMO-02         PIC X(1000).
               05  WRK-MEMO-03         PIC X(1000).
               05  WRK-MEMO-04         PIC X(1000).
               05  WRK-MEMO-05         PIC X(1000).
               05  WRK-MEMO-OK         PIC X(1000).
      *
           03  WRK-KOUMOKU             PIC X(200).
      *
       01  WRK-SRT-AREA.
           03  WRK-SRT-TABLE.
               05  FILLER              PIC X(03)   VALUE   "027".  
               05  FILLER              PIC X(03)   VALUE   "013".  
               05  FILLER              PIC X(03)   VALUE   "014".  
               05  FILLER              PIC X(03)   VALUE   "018".  
               05  FILLER              PIC X(03)   VALUE   "029".  
               05  FILLER              PIC X(03)   VALUE   "010".  
               05  FILLER              PIC X(03)   VALUE   "011".  
               05  FILLER              PIC X(03)   VALUE   "020".  
               05  FILLER              PIC X(03)   VALUE   "021".  
               05  FILLER              PIC X(03)   VALUE   "015".  
               05  FILLER              PIC X(03)   VALUE   "016".  
               05  FILLER              PIC X(03)   VALUE   "024".  
               05  FILLER              PIC X(03)   VALUE   "022".  
               05  FILLER              PIC X(03)   VALUE   "028".  
               05  FILLER              PIC X(03)   VALUE   "017".  
               05  FILLER              PIC X(03)   VALUE   "079".  
               05  FILLER              PIC X(03)   VALUE   "019".  
               05  FILLER              PIC X(03)   VALUE   "023".  
               05  FILLER              PIC X(03)   VALUE   "051".  
               05  FILLER              PIC X(03)   VALUE   "091".  
               05  FILLER              PIC X(03)   VALUE   "052".  
               05  FILLER              PIC X(03)   VALUE   "053".  
               05  FILLER              PIC X(03)   VALUE   "066".  
               05  FILLER              PIC X(03)   VALUE   "012".
      *********05  FILLER              PIC X(03)   VALUE   "972".
      *********05  FILLER              PIC X(03)   VALUE   "974".
           03  WRK-SRT-TABLE-R         REDEFINES   WRK-SRT-TABLE.      
               05  WRK-SRT-KOHHKNNUM   PIC X(03)   OCCURS  24.
      *
           03  WRK-SRT-KOHHKNNUM-MAX   PIC 9(02)   VALUE   24.
      *  
       01  WRK-HENYMD.
           03  WRK-HENYY           PIC X(04).
           03  FILLER              PIC X(01)   VALUE   "-".  
           03  WRK-HENMM           PIC X(02).
           03  FILLER              PIC X(01)   VALUE   "-".
           03  WRK-HENDD           PIC X(02).
      *
      *    ø«ª°Œ¡•∆°º•÷•Î
       01  TBL-SINSATU-AREA.
      *    ΩÈø«Œ¡° ∞Ï»Ã …¬±°°À
           03  FILLER              PIC X(14)   VALUE   "101F 111000110".
      *    ΩÈø«Œ¡° œ∑øÕ …¬±°°À
           03  FILLER              PIC X(14)   VALUE   "111F 111700110".
      *    ΩÈø«Œ¡° ∞Ï»Ã ø«Œ≈ΩÍ°À
           03  FILLER              PIC X(14)   VALUE   "102F 111003610".
      *    ΩÈø«Œ¡° œ∑øÕ ø«Œ≈ΩÍ°À
           03  FILLER              PIC X(14)   VALUE   "112F 111700210".
      *
      *    ∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "101  112007410".
      *    ∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "201  112007510".
      *    ∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "401  112007610".
      *    ∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À£±£µ∫ÕÃ§À˛
           03  FILLER              PIC X(14)   VALUE   "401 M112007710".
      *    ∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "401 E112012310".
      *    ∫∆ø«Œ¡° ∞Ï»Ã …¬±°°ÀøÕπ©ø’¬°
           03  FILLER              PIC X(14)   VALUE   "401 J112007810".
      *
      *    ≈≈œ√∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "101T 112007950".
      *    ≈≈œ√∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "201T 112008050".
      *    ≈≈œ√∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "401T 112008150".
      *    ≈≈œ√∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À£±£µ∫ÕÃ§À˛
           03  FILLER              PIC X(14)   VALUE   "401TM112008250".
      *    ≈≈œ√∫∆ø«Œ¡° ∞Ï»Ã …¬±°°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "401TE112012450".
      *
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "101D 112008350".
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "201D 112008450".
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "401D 112008550".
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À£±£µ∫ÕÃ§À˛
           03  FILLER              PIC X(14)   VALUE   "401DM112008650".
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "401DE112008750".
      *
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "101S 112008850".
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "201S 112008950".
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "401S 112009050".
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À£±£µ∫ÕÃ§À˛
           03  FILLER              PIC X(14)   VALUE   "401SM112009150".
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã …¬±°°À°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "401SE112012550".
      *
      *    ∫∆ø«Œ¡° ∞Ï»Ã ø«Œ≈ΩÍ°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "102  112009210".
      *    ∫∆ø«Œ¡° ∞Ï»Ã ø«Œ≈ΩÍ°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "202  112009310".
      *    ∫∆ø«Œ¡° ∞Ï»Ã ø«Œ≈ΩÍ°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "402  112009410".
      *    ∫∆ø«Œ¡° ∞Ï»Ã ø«Œ≈ΩÍ°À£±£µ∫ÕÃ§À˛
           03  FILLER              PIC X(14)   VALUE   "402 M112009510".
      *    ∫∆ø«Œ¡° ∞Ï»Ã ø«Œ≈ΩÍ°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "402 E112012610".
      *    ∫∆ø«Œ¡° ∞Ï»Ã ø«Œ≈ΩÍ°ÀøÕπ©ø’¬°
           03  FILLER              PIC X(14)   VALUE   "402 J112009610".
      *
      *    ≈≈œ√∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "102T 112009750".
      *    ≈≈œ√∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "202T 112009850".
      *    ≈≈œ√∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "402T 112009950".
      *    ≈≈œ√∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£±£µ∫ÕÃ§À˛
           03  FILLER              PIC X(14)   VALUE   "402TM112010050".
      *    ≈≈œ√∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "402TE112012750".
      *
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "102D 112010150".
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "202D 112010250".
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "402D 112010350".
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£±£µ∫ÕÃ§À˛
           03  FILLER              PIC X(14)   VALUE   "402DM112010450".
      *    ∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "402DE112010550".
      *
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "102S 112010650".
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "202S 112010750".
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "402S 112010850".
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À£±£µ∫ÕÃ§À˛
           03  FILLER              PIC X(14)   VALUE   "402SM112010950".
      *    ≈≈œ√∆±∆¸∫∆ø«° ∞Ï»Ã ø«Œ≈ΩÍ°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "402SE112012850".
      *
      *    ∫∆ø«Œ¡° œ∑øÕ …¬±°°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "111  112702310".
      *    ∫∆ø«Œ¡° œ∑øÕ …¬±°°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "211  112702410".
      *    ∫∆ø«Œ¡° œ∑øÕ …¬±°°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "411  112702510".
      *    ∫∆ø«Œ¡° œ∑øÕ …¬±°°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "411 E112706310".
      *    ∫∆ø«Œ¡° œ∑øÕ …¬±°°ÀøÕπ©ø’¬°
           03  FILLER              PIC X(14)   VALUE   "411 J112702610".
      *
      *    ≈≈œ√∫∆ø«° œ∑øÕ …¬±°°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "111T 112702750".
      *    ≈≈œ√∫∆ø«° œ∑øÕ …¬±°°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "211T 112702850".
      *    ≈≈œ√∫∆ø«° œ∑øÕ …¬±°°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "411T 112702950".
      *    ≈≈œ√∫∆ø«° œ∑øÕ …¬±°°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "411TE112706450".
      *
      *    ∆±∆¸∫∆ø«° œ∑øÕ …¬±°°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "111D 112703050".
      *    ∆±∆¸∫∆ø«° œ∑øÕ …¬±°°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "211D 112703150".
      *    ∆±∆¸∫∆ø«° œ∑øÕ …¬±°°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "411D 112703250".
      *    ∆±∆¸∫∆ø«° œ∑øÕ …¬±°°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "411DE112703350".
      *
      *    ∆±∆¸≈≈œ√∫∆ø«° œ∑øÕ …¬±°°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "111S 112703450".
      *    ∆±∆¸≈≈œ√∫∆ø«° œ∑øÕ …¬±°°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "211S 112703550".
      *    ∆±∆¸≈≈œ√∫∆ø«° œ∑øÕ …¬±°°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "411S 112703650".
      *    ∆±∆¸≈≈œ√∫∆ø«° œ∑øÕ …¬±°°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "411SE112706550".
      *
      *    ∫∆ø«Œ¡° œ∑øÕ ø«Œ≈ΩÍ°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "112  112703710".
      *    ∫∆ø«Œ¡° œ∑øÕ ø«Œ≈ΩÍ°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "212  112703810".
      *    ∫∆ø«Œ¡° œ∑øÕ ø«Œ≈ΩÍ°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "412  112703910".
      *    ∫∆ø«Œ¡° œ∑øÕ ø«Œ≈ΩÍ°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "412 E112706610".
      *    ∫∆ø«Œ¡° œ∑øÕ ø«Œ≈ΩÍ°ÀøÕπ©ø’¬°
           03  FILLER              PIC X(14)   VALUE   "412 J112704010".
      *
      *    ≈≈œ√∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "112T 112704150".
      *    ≈≈œ√∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "212T 112704250".
      *    ≈≈œ√∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "412T 112704350".
      *    ≈≈œ√∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "412TE112706750".
      *
      *    ∆±∆¸∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "112D 112704450".
      *    ∆±∆¸∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "212D 112704550".
      *    ∆±∆¸∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "412D 112704650".
      *    ∆±∆¸∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "412DE112704750".
      *
      *    ∆±∆¸≈≈œ√∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À£±≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "112S 112704850".
      *    ∆±∆¸≈≈œ√∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À£≤°§£≥≤ÛÃ‹
           03  FILLER              PIC X(14)   VALUE   "212S 112704950".
      *    ∆±∆¸≈≈œ√∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À£¥≤ÛÃ‹∞ πﬂ
           03  FILLER              PIC X(14)   VALUE   "412S 112705050".
      *    ∆±∆¸≈≈œ√∫∆ø«° œ∑øÕ ø«Œ≈ΩÍ°À∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘
           03  FILLER              PIC X(14)   VALUE   "412SE112706850".
      *
      *
      *    æÆª˘≤ ≥∞ÕËø«ª°Œ¡(±°≥∞ΩË ˝ ΩÈø«)
           03  FILLER              PIC X(14)   VALUE   "100  113003510".
      *    æÆª˘≤ ≥∞ÕËø«ª°Œ¡(±°∆‚ΩË ˝ ΩÈø«)
           03  FILLER              PIC X(14)   VALUE   "100  113003710".
      *    æÆª˘≤ ≥∞ÕËø«ª°Œ¡(±°≥∞ΩË ˝ ∫∆ø«)
           03  FILLER              PIC X(14)   VALUE   "200  113003610".
      *    æÆª˘≤ ≥∞ÕËø«ª°Œ¡(±°∆‚ΩË ˝ ∫∆ø«)
           03  FILLER              PIC X(14)   VALUE   "200  113003810".
      *
      *    ≥∞ÕËø«Œ≈Œ¡
           03  FILLER              PIC X(14)   VALUE   "501  112011310".
      *    ∆±∆¸≥∞ÕËø«Œ≈Œ¡
           03  FILLER              PIC X(14)   VALUE   "501D 112011710".
      *    ≥∞ÕËø«Œ≈Œ¡° œ∑øÕ°À
           03  FILLER              PIC X(14)   VALUE   "511  112705510".
      *    ∆±∆¸≥∞ÕËø«Œ≈Œ¡° œ∑øÕ°À
           03  FILLER              PIC X(14)   VALUE   "511D 112705850".
      *
      *
       01  TBL-SINSATU-AREAR       REDEFINES   TBL-SINSATU-AREA.
           03  TBL-SINSATU-OCC         OCCURS  88    INDEXED  TBL-IDX.
      *        ≤ÛøÙ° £µ°ß≥∞ÕËø«Œ≈Œ¡°À
               05  TBL-KAISU           PIC 9(01).
      *        œ∑øÕ∞Ï»Ã∂Ë ¨° £∞°ß∞Ï»Ã°¢£±°ßœ∑øÕ°À
               05  TBL-ROUJIN          PIC 9(01).
      *        …¬±°ºÔ Ã° £±°ß…¬±°°¢£≤°ßø«Œ≈ΩÍ°À
               05  TBL-HOSPSBT         PIC 9(01).
      *        D:∆±∆¸∫∆ø«°¢T°ß≈≈œ√∫∆ø«°¢S:∆±∆¸≈≈œ√∫∆ø«°¢F:ΩÈø«
               05  TBL-KBN             PIC X(01).
      *        M:£±£µ∫ÕÃ§À˛°¢E°ß∏¸¿∏æ §¨ƒÍ§·§Î¥µº‘°¢J:øÕπ©ø’¬°
               05  TBL-KBN2            PIC X(01).
      *        ø«Œ≈•≥°º•…
               05  TBL-SRYCD           PIC X(09).
      *
      *01  TBL-SIN-MAX                 PIC 9(04)   VALUE   84.
       01  TBL-SIN-MAX                 PIC 9(04)   VALUE   88.
      *
      *****************************************************************
      *    •’•°•§•Î•Ï•§•¢•¶•»
      *****************************************************************
      *
      *    ¥µº‘•ﬁ•π•ø°›
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *     ›∏±¡»§ﬂπÁ§Ô§ª
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    ¥µº‘ ›∏±æ Û
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *
      *    ¥µº‘∏¯»Òæ Û
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *
      *    ø«Œ≈≤ Õ˙ŒÚ
       01  SRYKARRK-REC.
           COPY    "CPSRYKARRK.INC".
      *
      *    ≈¿øÙ
           COPY    "CPTENSU.INC".
      *
      *    •∑•π•∆•‡¥…Õ˝•ﬁ•π•ø
           COPY    "CPSYSKANRI.INC".
      *
           COPY    "CPSK1005.INC".
      *
           COPY    "CPSK1006.INC".
      *
           COPY    "CPSK1001.INC".
      *    ∞ÂŒ≈µ°¥ÿæ Û°›ΩÍ∫ﬂ√œ°¢œ¢ÕÌ¿Ë 
           COPY    "CPSK1002.INC".
      *
           COPY    "CPSK1010.INC".
      *
      *    £√£Ã£¡£…£Õ¿‹¬≥æ Û
           COPY  "CPSK9000.INC".
      *
      *    ºıø«Õ˙ŒÚ
       01  JYURRK-REC.
           COPY    "CPJYURRK.INC".
      *
      *    ø«Œ≈π‘∞Ÿ•ﬁ•π•ø°›
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *     ›∏±»÷πÊ
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *
      *    £’£…£ƒ•∆°º•÷•Î
      *01  CLMUID-REC.
           COPY    "CPCLMUID.INC".
      *
      *    ¥µº‘•·•‚
       01  PTMEMOINF-REC.
           COPY    "CPPTMEMOINF.INC".
      *
      *****************************************************************
      *    •µ•÷•◊•ÌÕ—°°ŒŒ∞Ë
      *****************************************************************
      *
      *    •π•—ŒŒ∞Ë
      **** COPY    "COMMON-SPA".
      *   ∆¸…’ —¥π•µ•÷
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *
      *    ∂¶ƒÃ•—•È•·•ø
           COPY    "MCPAREA".
      **** COPY    "CPORCMCP.INC".
      *
           COPY    "MCPDATA.INC".
      *     
      *    ¥µº‘»÷πÊ —¥π•µ•÷
           COPY    "CPORCSPTID.INC".
      *
      *     ›∏±«ØŒ°¶…È√¥≥‰πÁªªƒÍ•µ•÷
           COPY    "CPORCSAGECHK.INC".
      *
      *    •ﬁ•∑•Û∆¸…’ºË∆¿•µ•÷
           COPY    "CPORCSMCNDATE.INC".
      *
       01  HZN-LF01-REC. 
           COPY    "CPRLF001.INC"    REPLACING  //LF01-//
                                     BY         //HZN-LF01-//.
      *
      *    ¡¥≥—•¡•ß•√•Ø
           COPY    "CPORCXKANACONV.INC".
      *
      *    ¡¥≥—•¡•ß•√•Ø•—•È•·•ø
           COPY    "CPORCSKANACHK.INC".
      *
      *    £’£…£ƒºË∆¿Õ—•®•Í•¢
       01 UIDIO-AREA.
           03  C-RET   PIC X(2).
           03  C-UID   PIC X(36).
       01  ST          PIC 9(2).
      * 
           COPY    "CPMML0031.INC".
      *****************************************************************
      *    œ¢ÕÌ°°ŒŒ∞Ë
      *****************************************************************
       LINKAGE                     SECTION.
      *
      *01  LNK-PTID             PIC 9(10).
      *01  LNK-SRYKA            PIC X(02).
       01  LNK-TIME             PIC X(06).
      *01  LNK-HOSPID           PIC X(24).
      *01  LNK-SYSYMD           PIC 9(08).
      *01  LNK-DRCD             PIC X(05).
      *01  LNK-HKNCOMBI         PIC X(04).
       01  LNK-PARA-SINRYONAIYO PIC X(16).
       01  LNK-PARA-RENNUM      PIC X(02).
       01  LNK-PARA-MEMO        PIC X(02).
      *    •π•—ŒŒ∞Ë
           COPY    "COMMON-SPA".
      *
       01  WRK-LF01-REC. 
           COPY    "CPRLF001.INC"    REPLACING  //LF01//
                                     BY         //WRK-LF01//.
      *
      ******************************************************************
      *
      *PROCEDURE                       DIVISION
      *                                USING   LNK-PTID
      *                                        LNK-SRYKA
      *                                        LNK-TIME
      *                                        LNK-HOSPID
      *                                        LNK-SYSYMD
      *                                        LNK-DRCD
      *                                        LNK-HKNCOMBI
      *                                        LNK-PARA-SINRYONAIYO
      ****                                     WRK-LF01-REC
       PROCEDURE                       DIVISION
                                       USING
           LNK-TIME
           LNK-PARA-SINRYONAIYO
           LNK-PARA-RENNUM
           LNK-PARA-MEMO
           SPA-AREA
           WRK-LF01-REC
           .
      *
      *****************************************************************
      *    ºÁ°°°°ΩËÕ˝
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC
                   UNTIL       FLG-END     =   1
      *
           PERFORM 300-END-SEC
      *
           EXIT    PROGRAM
           .
      *****************************************************************
      *    ΩÈ¥¸°°ΩËÕ˝
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  IDX-AREA
           INITIALIZE                  WRK-AREA
      *
      *    æÆª˘≤ ≥∞ÕËø«Œ≈≤  ‘Ω∏
           MOVE    SPACE               TO  SYS-1006-REC
           INITIALIZE                      SYS-1006-REC
           MOVE    "1006"              TO  SYS-1006-KANRICD
           MOVE    "1"                 TO  SYS-1006-KBNCD
           MOVE    SPA-SYSYMD          TO  SYS-1006-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-1006-EDYUKYMD
      *    •∑•π•∆•‡¥…Õ˝∏°∫˜° ª‹¿ﬂ¥Ω‡°À
           MOVE    SPA-HOSPNUM         TO  SYS-1006-HOSPNUM
           MOVE    SYS-1006-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
               PERFORM 901-SYSKANRI-READ-SEC
           ELSE
               MOVE    SPACE               TO  SYS-1006-REC
               INITIALIZE                  SYS-1006-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
           MOVE    ZERO                TO  FLG-SYONIKA-ARI
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1006-REC
               IF      SYS-1006-SSTKIJUN (121) =   1
                   MOVE    1               TO  FLG-SYONIKA-ARI
               END-IF
           END-IF
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *    •∑•π•∆•‡¥…Õ˝∏°∫˜° £√£Ã£¡£…£Õ¿‹¬≥æ Û°À
           MOVE    SPACE               TO  SYS-9000-REC
           INITIALIZE                      SYS-9000-REC
           MOVE    "9000"              TO  SYS-9000-KANRICD
           MOVE    "*"                 TO  SYS-9000-KBNCD
           MOVE    SPA-SYSYMD          TO  SYS-9000-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-9000-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-9000-HOSPNUM
           MOVE    SYS-9000-REC        TO  MCPDATA-REC
      *
           PERFORM 900-SYSKANRI-INV-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-9000-REC
           ELSE
               INITIALIZE                      SYS-9000-REC
           END-IF
      *    •Ï•ª≈≈§Œ≤ §ÿ —ππ
           MOVE    SPA-SRYKA           TO  WRK-SRYKA
           IF     (SYS-9000-RECEDEN-FLG    =   "1" )  AND
                  (SPA-SRYKA           NOT =   "XX")
               PERFORM 1001-RECDEN-SRYKA-SEC
           END-IF
      *
      *    OPEN    I-O     LF03-FILE
      *
      *    INITIALIZE                  FLG-AREA
      *    MOVE    SPA-HOSPNUM     TO  LF03-HOSPNUM
      *    MOVE    SPA-PTID        TO  LF03-PTID
      *    MOVE    WRK-SRYKA       TO  LF03-SRYKA
      *
      *    DISPLAY "LD03 READ START WRK-SRYKA:"  WRK-SRYKA
      *
      *    PERFORM 900-LF03-READ-SEC
      *    IF      FLG-LF03        =   1
      *        DISPLAY "SPA-HOSPNUM INVALID"
      *        MOVE    SPACE           TO  LF03-REC
      *        INITIALIZE                  LF03-REC
      *        MOVE    SPA-HOSPNUM     TO  LF03-HOSPNUM
      *        MOVE    SPA-PTID        TO  LF03-PTID
      *        MOVE    WRK-SRYKA       TO  LF03-SRYKA
      *****END-IF
      *
      *    ππø∑∆¸ºË∆¿
           INITIALIZE                  ORCSMCNDATEAREA
           CALL    "ORCSMCNDATE"       USING
                                       ORCSMCNDATEAREA
      *    UID∏°∫˜
           INITIALIZE                      CLMUID-REC
           MOVE    SPA-HOSPNUM         TO  CLMUID-HOSPNUM
           MOVE    SPA-PTID            TO  CLMUID-PTID
           MOVE    WRK-SRYKA           TO  CLMUID-SRYKA
           PERFORM 903-CLMUID-READ-SEC
           IF      FLG-CLMUID          =   1
               INITIALIZE                      CLMUID-REC
               MOVE    SPA-HOSPNUM         TO  CLMUID-HOSPNUM
               MOVE    SPA-PTID            TO  CLMUID-PTID
               MOVE    WRK-SRYKA           TO  CLMUID-SRYKA
           END-IF
      *     £øÙ•€•π•»§Œª˛°¢UID§œ∫«ΩÈ§Œ§ﬂ¿ﬂƒÍ
           IF     (LNK-PARA-RENNUM     =   "01"  )
             OR   (FLG-CLMUID          =   1     )
               MOVE    ZERO                TO  FLG-UID
           ELSE
               MOVE    1                   TO  FLG-UID
           END-IF
      *    •·•‚≈–œø§´§È
           IF     LNK-PARA-MEMO        =   "@@"
               IF      FLG-CLMUID          =   ZERO
                   MOVE    1               TO  FLG-UID
               END-IF
           END-IF
           .
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    •Ï•ª≈≈§Œ≤ §ÿ —ππΩËÕ˝
      *****************************************************************
       1001-RECDEN-SRYKA-SEC                SECTION.
      *
           MOVE    SPACE               TO  SYS-1005-REC
           INITIALIZE                      SYS-1005-REC
           MOVE    "1005"              TO  SYS-1005-KANRICD
           MOVE    SPA-SRYKA           TO  SYS-1005-KBNCD
           MOVE    SPA-SYSYMD          TO  SYS-1005-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-1005-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-1005-HOSPNUM
           MOVE    SYS-1005-REC        TO  MCPDATA-REC
      *
           PERFORM 900-SYSKANRI-INV-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1005-REC
      *        •Ï•ª≈≈ø«Œ≈≤ 
               IF      SYS-1005-RECESRYKA  =   SPACE
                   MOVE    "XX"                TO  WRK-SRYKA
               ELSE
                   MOVE    SYS-1005-RECESRYKA  TO  WRK-SRYKA
               END-IF
           END-IF
           .
       1001-RECDEN-SRYKA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÁ°°°°ΩËÕ˝
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
           DISPLAY "11 START"
           MOVE    SPACE           TO  WRK-LF01-REC
           INITIALIZE              WRK-LF01-REC
      *
      *    ¥µº‘∆…§ﬂΩ–§∑
           MOVE    SPA-HOSPNUM     TO  PTINF-HOSPNUM
           MOVE    SPA-PTID        TO  PTINF-PTID
           PERFORM 900-PTINF-READ-SEC
      *
      *    MOVE    SPA-PTID        TO  WRK-LF01-PTID1
      *                                WRK-LF01-PTID2
      *    ¥µº‘»÷πÊ —¥π
           INITIALIZE                       ORCSPTIDAREA
           MOVE    SPA-HOSPNUM     TO  SPTID-HOSPNUM
           MOVE    SPA-PTID        TO  SPTID-PTID
           CALL    "ORCSPTID"      USING   ORCSPTIDAREA
                                           SPA-AREA
           MOVE    SPTID-PTNUM     TO  WRK-LF01-PTID1
                                       WRK-LF01-PTID2
      *
           INITIALIZE              UIDIO-AREA
           PERFORM 500-UUID-SET-SEC
           DISPLAY "C-UID" C-UID 
           MOVE    C-UID           TO  WRK-LF01-UID1
                                       CLMUID-UID-NEW
           PERFORM 500-UUID-SET-SEC
           MOVE    C-UID           TO  WRK-LF01-UID3
      *
           MOVE    SPA-SYSYMD      TO  WRK-WYMD
           PERFORM 500-HIZUKE-HENSYU-SEC
           MOVE    WRK-HENYMD      TO  WRK-LF01-CONFIRMDATE1
      *                                WRK-LF01-CONFIRMDATE2
                                       WRK-LF01-CONFIRMDATE3
      *
           MOVE    WRK-HENYMD      TO  WRK-LF01-UKEYMD(1:10)
           MOVE    "T"             TO  WRK-LF01-UKEYMD(11:1)
           MOVE    LNK-TIME (1:2)  TO  WRK-LF01-UKEYMD(12:2)
           MOVE    ":"             TO  WRK-LF01-UKEYMD(14:1) 
           MOVE    LNK-TIME (3:2)  TO  WRK-LF01-UKEYMD(15:2)
           MOVE    ":"             TO  WRK-LF01-UKEYMD(17:1) 
           MOVE    LNK-TIME (5:2)  TO  WRK-LF01-UKEYMD(18:2)
      *
           MOVE    "facility"      TO  WRK-LF01-IDTYPE1
                                       WRK-LF01-IDTYPE2
      *
           IF      PTINF-KANANAME  NOT =   SPACE
               MOVE    "P"         TO  WRK-LF01-KANANAME-REPCODE
               MOVE    PTINF-KANANAME
                                   TO  WRK-LF01-KANANAME
           END-IF
      *
           MOVE    "I"             TO  WRK-LF01-NAME-REPCODE
      ***  MOVE    PTINF-NAME      TO  WRK-LF01-NAME
      *    ≥»ƒ•¥¡ª˙ —¥π
           MOVE    PTINF-NAME      TO  WRK-KOUMOKU
           PERFORM 800-ORCSKANACHK-SEC
           MOVE    WRK-KOUMOKU     TO  WRK-LF01-NAME
      *
           MOVE    PTINF-BIRTHDAY  TO  WRK-WYMD
           PERFORM 500-HIZUKE-HENSYU-SEC
           MOVE    WRK-HENYMD      TO  WRK-LF01-BIRTHDAY
      *
           EVALUATE    PTINF-SEX
               WHEN    "1"
                   MOVE    "male"      TO  WRK-LF01-SEX
               WHEN    "2"
                   MOVE    "female"    TO  WRK-LF01-SEX
               WHEN    " "
                   MOVE    "unknown"   TO  WRK-LF01-SEX
               WHEN    OTHER
                   MOVE    "other"     TO  WRK-LF01-SEX
           END-EVALUATE
      *
           IF      PTINF-HOME-POST     =   SPACE
           AND     PTINF-HOME-ADRS     =   SPACE
           AND     PTINF-HOME-BANTI    =   SPACE
               CONTINUE
           ELSE
               MOVE    PTINF-HOME-POST     TO  WRK-POST
               PERFORM 500-POST-HENSYU-SEC
               MOVE    WRK-HENPOST         TO  WRK-LF01-HOME-POST
               MOVE    "home"          TO  WRK-LF01-HOME-KREPCODE
               STRING  PTINF-HOME-ADRS     DELIMITED   BY  SPACE
                       "°°"                DELIMITED   BY  SIZE
                       PTINF-HOME-BANTI    DELIMITED   BY  SPACE
                                       INTO    WRK-LF01-HOME-ADRS
               END-STRING
           END-IF 
      *
      *
           IF      PTINF-RENRAKU-POST     =   SPACE
           AND     PTINF-RENRAKU-ADRS     =   SPACE
           AND     PTINF-RENRAKU-BANTI    =   SPACE
               CONTINUE
           ELSE
             MOVE    PTINF-RENRAKU-POST     TO  WRK-POST
             PERFORM 500-POST-HENSYU-SEC
             MOVE    WRK-HENPOST         TO  WRK-LF01-RENRAKU-POST
             MOVE    "home"          TO  WRK-LF01-RENRAKU-KREPCODE
             STRING  PTINF-RENRAKU-ADRS  DELIMITED   BY  SPACE
                     "°°"                DELIMITED   BY  SIZE
                     PTINF-RENRAKU-BANTI DELIMITED   BY  SPACE
                                     INTO    WRK-LF01-RENRAKU-ADRS
             END-STRING
           END-IF 
      *
           IF       PTINF-HOME-TEL1      NOT =  SPACE
               MOVE     "?????"          TO  WRK-LF01-PHONE-AREA
               MOVE     "?????"          TO  WRK-LF01-PHONE-CITY
               MOVE     "?????"          TO  WRK-LF01-PHONE-NUM
               MOVE     PTINF-HOME-TEL1  TO  WRK-LF01-PHONE-MEMO
           END-IF
      *
           IF      PTINF-OFFICE-POST     =   SPACE
           AND     PTINF-OFFICE-ADRS     =   SPACE
           AND     PTINF-OFFICE-BANTI    =   SPACE
               CONTINUE
           ELSE
             MOVE    PTINF-OFFICE-POST     TO  WRK-POST
             PERFORM 500-POST-HENSYU-SEC
             MOVE    WRK-HENPOST         TO  WRK-LF01-OFFICE-POST
             MOVE    "business"          TO  WRK-LF01-OFFICE-KREPCODE
             STRING  PTINF-OFFICE-ADRS   DELIMITED   BY  SPACE
                     "°°"                DELIMITED   BY  SIZE
                     PTINF-OFFICE-BANTI  DELIMITED   BY  SPACE
                                     INTO    WRK-LF01-OFFICE-ADRS
             END-STRING
             END-IF 
      *
      *
           IF      PTINF-KISEI-POST     =   SPACE
           AND     PTINF-KISEI-ADRS     =   SPACE
           AND     PTINF-KISEI-BANTI    =   SPACE
               CONTINUE
           ELSE
             MOVE    PTINF-KISEI-POST     TO  WRK-POST
             PERFORM 500-POST-HENSYU-SEC
             MOVE    WRK-HENPOST         TO  WRK-LF01-KISEI-POST
             MOVE    "home"          TO  WRK-LF01-KISEI-KREPCODE
             STRING  PTINF-KISEI-ADRS    DELIMITED   BY  SPACE
                     "°°"                DELIMITED   BY  SIZE
                     PTINF-KISEI-BANTI   DELIMITED   BY  SPACE
                                     INTO    WRK-LF01-KISEI-ADRS
             END-STRING
           END-IF
      *                
           IF      PTINF-DEATHKBN  =   "1"
               MOVE    "true"          TO  WRK-LF01-DEATHKBN
           ELSE
               MOVE    "false"         TO  WRK-LF01-DEATHKBN
           END-IF
      *
           MOVE    "regist"        TO  WRK-LF01-UKEYMD-KREPCODE
      *    ¥µº‘≈–œø§´§È
           IF      WRK-SRYKA       =   "XX"
               MOVE    "info"          TO  WRK-LF01-UKEYMD-KREPCODE
      *        ø«Œ≈≤ ¿ﬂƒÍ
               PERFORM 2009-SRYKA-SET-SEC
           END-IF
      *    •·•‚§´§È
           IF      LNK-PARA-MEMO       =   "@@"
               MOVE    "memo"          TO  WRK-LF01-UKEYMD-KREPCODE
           END-IF
      *
           MOVE    "false"         TO  WRK-LF01-NYUGAIKBN
      *
      *
      *    ø«Œ≈≤ ÃææŒ
           MOVE    SPACE               TO  SYS-1005-REC
           INITIALIZE                      SYS-1005-REC
           MOVE    "1005"              TO  SYS-1005-KANRICD
           IF      SPA-SRYKA           =   "XX"
               MOVE    WRK-SRYKA           TO  SYS-1005-KBNCD
           ELSE
               MOVE    SPA-SRYKA           TO  SYS-1005-KBNCD
           END-IF
           MOVE    SPA-SYSYMD          TO  SYS-1005-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-1005-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-1005-HOSPNUM
           MOVE    SYS-1005-REC        TO  MCPDATA-REC
           PERFORM 900-SYSKANRI-INV-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1005-REC
               MOVE    SYS-1005-SRYKANAME  TO  WRK-LF01-SRYNAME
                                           WRK-LF01-CRE001-DPERTNAME
                                           WRK-LF01-CRE301-DPERTNAME
               MOVE    WRK-SRYKA           TO  WRK-LF01-CRE001-DPERTID
                                           WRK-LF01-CRE301-DPERTID
               MOVE    "I"                 TO  WRK-LF01-SRYREP
           END-IF
      *
           MOVE    SPACE               TO  WRK-C-UID
      *
      *     ›∏±æ Û  
           INITIALIZE                  HKNCOMBI-REC
           MOVE    SPA-HOSPNUM     TO  COMB-HOSPNUM
           MOVE    SPA-PTID        TO  COMB-PTID
           MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hkncombi"      TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 900-COMB-READ-SEC
           ELSE
               INITIALIZE                  HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           MOVE    ZERO                TO  IDX
           MOVE    ZERO                TO  IDX-HZN
           MOVE    SPACE               TO   WRK-FTNRATEMEI
           PERFORM UNTIL       (IDX            =   20   )  OR
                               (FLG-HKNCOMBI   =   1    )
           DISPLAY " ›∏±æ Û START"
112500         IF     (SPA-SYSYMD            >=  COMB-TEKSTYMD)  AND
112800                (SPA-SYSYMD            <=  COMB-TEKEDYMD)  AND
                      (COMB-DELKBN           =   SPACE        )
                   ADD     1                 TO  IDX
      *
      *            …È√¥Œ®∑◊ªª
                   INITIALIZE                  ORCSAGECHKAREA
                   MOVE    COMB-HOSPNUM        TO  AGECHK-HOSPNUM
                   MOVE    COMB-PTID           TO  AGECHK-PTID
                   MOVE    SPA-SYSYMD          TO  AGECHK-SRYYMD
                   MOVE    PTINF-BIRTHDAY      TO  AGECHK-BIRTHDAY
                   MOVE    COMB-HKNCOMBINUM    TO  AGECHK-HKNCOMBINUM
                   CALL    "ORCSAGECHK"        USING
                                               ORCSAGECHKAREA
                                               SPA-AREA
      *            …È√¥Œ®
                   IF      AGECHK-RC           =   ZERO
                       COMPUTE WRK-FTNRATE         =   AGECHK-FTNRATE
                                                   /   100
                   ELSE
                       COMPUTE WRK-FTNRATE         =   COMB-GAI-KFTNRATE
                                                   /   100
                   END-IF
                   MOVE    WRK-FTNRATE         TO   WRK-Z9
                   MOVE    WRK-Z9              TO   WRK-FTNRATEMEI
      *
      *   ºÁ ›∏±æ Û∆…§ﬂΩ–§∑
                   IF      COMB-HKNID          NOT =   ZERO
      *                …È√¥Œ®
                       MOVE    WRK-FTNRATEMEI      TO
                                               WRK-LF01-OUTRATIO (IDX)
      *                £±≤ÛÃ‹
                       IF      FLG-UID             =   ZERO
                           MOVE    COMB-HKNCOMBINUM    TO
                                               CLMUID-HKNCOMBI (IDX)
      *
                           INITIALIZE              UIDIO-AREA
                           PERFORM 500-UUID-SET-SEC
                           MOVE    C-UID               TO
                                               WRK-LF01-UID2    (IDX)
                                               CLMUID-UID       (IDX)
                       ELSE
      *                £≤≤ÛÃ‹§´§È
                           PERFORM 2004-UID-TBL-SEC
                       END-IF
      *
                       IF      SPA-HKNCOMBINUM     =   COMB-HKNCOMBINUM
                           MOVE    C-UID           TO  WRK-C-UID
                           MOVE    IDX             TO  IDX-HZN
                       END-IF
      *
                       MOVE    SPA-SYSYMD          TO  WRK-WYMD
                       PERFORM 500-HIZUKE-HENSYU-SEC
                       MOVE    WRK-HENYMD          TO  
                               WRK-LF01-CONFIRMDATE2(IDX)
                       INITIALIZE                  PTHKNINF-REC
                       MOVE    SPA-HOSPNUM         TO  PTHKN-HOSPNUM
                       MOVE    SPA-PTID            TO  PTHKN-PTID
                       MOVE    COMB-HKNID          TO  PTHKN-HKNID
                       MOVE    SPA-SYSYMD          TO  PTHKN-TEKSTYMD
                       MOVE    SPA-SYSYMD          TO  PTHKN-TEKEDYMD
                       MOVE    PTHKNINF-REC        TO  MCPDATA-REC
                       PERFORM 910-PTHKNINF-INV-SEC
                       MOVE    PTHKN-HKNJANUM  
                               TO  WRK-LF01-HKNJANUM (IDX)
                       IF      PTHKN-KIGO          =   SPACE
                           MOVE    "µ≠∫‹§ §∑"     
                               TO  WRK-LF01-KIGO     (IDX)
                       ELSE
                           MOVE    PTHKN-KIGO      
                               TO  WRK-LF01-KIGO     (IDX)
                       END-IF
                       IF      PTHKN-NUM           =   SPACE
                           MOVE    "µ≠∫‹§ §∑"     
                               TO  WRK-LF01-NUM      (IDX)
                       ELSE
                           MOVE    PTHKN-NUM       
                               TO  WRK-LF01-NUM      (IDX)
                       END-IF
                       IF      PTHKN-HONKZKKBN =   "1"
                           MOVE    "true"      
                               TO  WRK-LF01-HONKZKKBN (IDX)
                       ELSE
                           MOVE    "false"     
                               TO  WRK-LF01-HONKZKKBN (IDX)
                       END-IF
                       MOVE    PTHKN-TEKSTYMD  TO  WRK-WYMD
                       PERFORM 500-HIZUKE-HENSYU-SEC
                       MOVE    WRK-HENYMD      
                               TO  WRK-LF01-TEKSTYMD (IDX)
                       MOVE    PTHKN-TEKEDYMD  TO  WRK-WYMD
                       PERFORM 500-HIZUKE-HENSYU-SEC
                       MOVE    WRK-HENYMD      
                               TO  WRK-LF01-TEKEDYMD (IDX)
                       PERFORM VARYING IDW FROM    1   BY  1
                               UNTIL   IDW >       MML0031-TMAX
                         IF    PTHKN-HKNNUM  =  MML0031-HOKEN (IDW)
                               MOVE    MML0031-NAME(IDW) 
                                       TO  WRK-LF01-HKNSBT  (IDX)
      *                         ›∏±ºÔ Ã
      *                        PERFORM 2001-HKNNUM-SET-SEC
                               MOVE    99        TO  IDW
                         END-IF
                      END-PERFORM
      *                 
                      PERFORM 2001-HKNNUM-SET-SEC
                   ELSE
      *                ºÁ ›∏±§ §∑
      *                £±≤ÛÃ‹
                       IF      FLG-UID             =   ZERO
                           MOVE    COMB-HKNCOMBINUM    TO
                                               CLMUID-HKNCOMBI (IDX)
      *                 
                           INITIALIZE              UIDIO-AREA
                           PERFORM 500-UUID-SET-SEC
                           MOVE    C-UID               TO
                                               WRK-LF01-UID2    (IDX)
                                               CLMUID-UID       (IDX)
                       ELSE
      *                £≤≤ÛÃ‹§´§È
                           PERFORM 2004-UID-TBL-SEC
                       END-IF
      *
                       IF      SPA-HKNCOMBINUM     =   COMB-HKNCOMBINUM
                           MOVE    C-UID           TO  WRK-C-UID
                           MOVE    IDX             TO  IDX-HZN
                       END-IF
      *
                       MOVE    SPA-SYSYMD          TO  WRK-WYMD
                       PERFORM 500-HIZUKE-HENSYU-SEC
                       MOVE    WRK-HENYMD          TO  
                               WRK-LF01-CONFIRMDATE2(IDX)
                       MOVE    "9999" 
                                               TO  WRK-LF01-HKNJANUM
                                                                (IDX)
                       MOVE    "∏¯»Ò√±∆»"      TO  WRK-LF01-HKNSBT
                                                                (IDX)
                       MOVE    "XX"            TO  WRK-LF01-HKNSBTCODE
                                                                 (IDX)
                       MOVE    "µ≠∫‹§ §∑"      TO  WRK-LF01-KIGO (IDX)
                       MOVE    "µ≠∫‹§ §∑"      TO  WRK-LF01-NUM  (IDX)
                       MOVE    "true"          TO  WRK-LF01-HONKZKKBN
                                                                 (IDX)
                       MOVE    COMB-TEKSTYMD   TO  WRK-WYMD
                       PERFORM 500-HIZUKE-HENSYU-SEC
                       MOVE    WRK-HENYMD      TO  WRK-LF01-TEKSTYMD
                                                               (IDX)
                       MOVE    COMB-TEKEDYMD   TO  WRK-WYMD
                       PERFORM 500-HIZUKE-HENSYU-SEC
                       MOVE    WRK-HENYMD      TO  WRK-LF01-TEKEDYMD
                                                               (IDX)
                   END-IF
      *
      *   ∏¯»Ò∆…§ﬂΩ–§∑
                   IF      COMB-KOHHKNNUM (1)  NOT =   SPACE
                       PERFORM 20012-KOHID-HENSYU-SEC
                       PERFORM VARYING IDY1 FROM    1   BY  1
                               UNTIL   IDY1 >       4
                               OR      WRK-KOHID(IDY1)    =   ZERO
                           INITIALIZE              PTKOHINF-REC
                           MOVE    SPA-HOSPNUM     TO  PTKOH-HOSPNUM
                           MOVE    SPA-PTID        TO  PTKOH-PTID
                           MOVE    WRK-KOHID(IDY1) TO  PTKOH-KOHID
                           MOVE    SPA-SYSYMD      TO  PTKOH-TEKSTYMD
                           MOVE    SPA-SYSYMD      TO  PTKOH-TEKEDYMD
                           MOVE    PTKOHINF-REC    TO  MCPDATA-REC
                           PERFORM 910-PTKOHINF-INV-SEC
                           MOVE    IDY1            TO
                                           WRK-LF01-PRIORITY (IDX IDY1)
                     IF    PTKOH-FTNJANUM          =   SPACE
                           MOVE    "mikinyu"       TO
                                            WRK-LF01-FTNJANUM(IDX IDY1)
                     ELSE
                           MOVE    PTKOH-FTNJANUM  TO
                                            WRK-LF01-FTNJANUM(IDX IDY1)
                     END-IF
                     IF    PTKOH-JKYSNUM           =   SPACE
                           MOVE    "mikinyu"       TO
                                            WRK-LF01-JKYSNUM (IDX IDY1)
                     ELSE
                           MOVE    PTKOH-JKYSNUM   TO
                                            WRK-LF01-JKYSNUM (IDX IDY1)
                     END-IF
                           MOVE    PTKOH-TEKSTYMD  TO  WRK-WYMD
                           PERFORM 500-HIZUKE-HENSYU-SEC
                           MOVE    WRK-HENYMD      TO
                                        WRK-LF01-TTEKSTYMD (IDX IDY1)
                           MOVE    PTKOH-TEKEDYMD  TO  WRK-WYMD
                           PERFORM 500-HIZUKE-HENSYU-SEC
                           MOVE    WRK-HENYMD      TO
                                        WRK-LF01-TTEKEDYMD (IDX IDY1)
      *??
      *                    …È√¥Œ®°¶…È√¥≥€ ‘Ω∏
                           PERFORM 400-KOHFTN-HENSYU-SEC
      *??
      *                    ∏¯»ÒÃææŒ
                           MOVE    WRK-KOHMEI (IDY1)   TO
                                           WRK-LF01-KOHINAME (IDX IDY1)
      *
                       END-PERFORM    
                   END-IF
               END-IF
      *
               MOVE    "tbl_hkncombi"      TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 900-COMB-READ-SEC
           END-PERFORM
      *    •´°º•Ω•Î•Ø•Ì°º•π
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *    ª»Õ— ›∏± (claim:insuranceUid)
           MOVE    WRK-C-UID           TO  WRK-LF01-FIL1
           IF      IDX-HZN             >   ZERO
               PERFORM 2002-HKNCOMBI-LIST-SEC
           END-IF
      *
      *    ΩÈø«°ø∫∆ø«
           MOVE    SPACE               TO  WRK-SYOYMD
           MOVE    ZERO                TO  WRK-SYOSIN 
           MOVE    SPACE               TO  WRK-LSTYMD
           MOVE    SPACE               TO  WRK-LSTSRYKA
      *
      *    ø«Œ≈≤ ŒÚ§Ú∏°∫˜
           MOVE    SPACE               TO  SRYKARRK-REC
           INITIALIZE                  SRYKARRK-REC
           MOVE    SPA-HOSPNUM         TO  KARRK-HOSPNUM
           MOVE    SPA-PTID            TO  KARRK-PTID
      *
           MOVE    SRYKARRK-REC        TO  MCPDATA-REC
           MOVE    "tbl_srykarrk"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_srykarrk"      TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 975-SRYKARRK-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SRYKARRK
               MOVE    SPACE               TO  SRYKARRK-REC
               INITIALIZE                  SRYKARRK-REC
           END-IF
           PERFORM UNTIL       FLG-SRYKARRK    =   1
      *
      *        ΩÈø«ªªƒÍ∆¸
               IF     (KARRK-SYOSINYMD2 NOT =  SPACE      ) AND
                      (KARRK-SYOSINYMD2    >=  WRK-SYOYMD )
                   MOVE    KARRK-SYOSINYMD2    TO  WRK-SYOYMD
               END-IF
      *        ∫«Ω™ºıø«∆¸
               IF     (KARRK-LASTYMD   NOT =   SPACE      ) AND
                      (KARRK-LASTYMD       >=  WRK-LSTYMD )
                   MOVE    KARRK-LASTYMD       TO  WRK-LSTYMD
                   MOVE    KARRK-SRYKA         TO  WRK-LSTSRYKA
               END-IF
      *
               MOVE    "tbl_srykarrk"      TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 975-SRYKARRK-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_srykarrk"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *    ΩÈø«Œ¡ªªƒÍÕ≠Ãµ
           IF      WRK-SYOYMD          =   SPACE
      *            ΩÈø«ªªƒÍ
               MOVE    1               TO  WRK-SYOSIN
           END-IF
      *
      *    ΩÈø«Œ¡ªªƒÍ∆¸§¨ø«Œ≈∆¸§Œª˛°¢∫∆ø«§»§π§Î
           IF      WRK-SYOSIN          =   1
               IF      WRK-SYOYMD          =   SPA-SYSYMD
                   MOVE    ZERO            TO  WRK-SYOSIN
               END-IF
           END-IF
      *
           IF      WRK-SYOSIN         =   ZERO
      *
               MOVE    WRK-SYOYMD      TO  WRK-WYMD
               PERFORM 500-HIZUKE-HENSYU-SEC
               MOVE    WRK-HENYMD      TO  WRK-LF01-CONFIRMDATE4
           END-IF
      *
           MOVE    "tbl_tensu"         TO  WRK-LF01-ID
      *    ∞ÂŒ≈µ°¥ÿæ Û°›ΩÍ∫ﬂ√œ°¢œ¢ÕÌ¿Ë
           MOVE    SPACE               TO  SYS-1002-REC
           INITIALIZE                  SYS-1002-REC
           MOVE    "1002"              TO  SYS-1002-KANRICD
           MOVE    "*"                 TO  SYS-1002-KBNCD
           MOVE    SPA-SYSYMD          TO  SYS-1002-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-1002-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-1002-HOSPNUM
           MOVE    SYS-1002-REC        TO  MCPDATA-REC
           PERFORM 900-SYSKANRI-INV-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1002-REC
           ELSE
               INITIALIZE                  SYS-1002-REC
           END-IF
      *    ∞ÂŒ≈µ°¥ÿ£…£ƒ ‘Ω∏
           MOVE    SPACE               TO  SYS-1001-REC
           INITIALIZE                  SYS-1001-REC
           MOVE    "1001"              TO  SYS-1001-KANRICD
           MOVE    "*"                 TO  SYS-1001-KBNCD
           MOVE    SPA-SYSYMD          TO  SYS-1001-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-1001-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-1001-HOSPNUM
           MOVE    SYS-1001-REC        TO  MCPDATA-REC
           PERFORM 900-SYSKANRI-INV-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1001-REC
      ******** EVALUATE    SYS-1001-HOSPSBT    ALSO    WRK-SYOSIN
      *            WHEN    "1"                 ALSO    1
      *                MOVE    "111000110"     TO  WRK-LF01-IJICD
      *                MOVE    "110"           TO
      *                        WRK-LF01-BUNDLE-CLASSCODE    
      *            WHEN    "1"                 ALSO    ZERO
      *                MOVE    "112000110"     TO  WRK-LF01-IJICD    
      *                MOVE    "120"           TO
      *                        WRK-LF01-BUNDLE-CLASSCODE    
      *            WHEN    "2"                 ALSO    1
      *                MOVE    "111003610"     TO  WRK-LF01-IJICD    
      *                MOVE    "110"           TO
      *                        WRK-LF01-BUNDLE-CLASSCODE    
      *            WHEN    "2"                 ALSO    ZERO
      *                MOVE    "112000210"     TO  WRK-LF01-IJICD
      *                MOVE    "120"           TO
      *                        WRK-LF01-BUNDLE-CLASSCODE    
      *            WHEN    OTHER
      *                DISPLAY "*** ORCL0011 IJICD ERR HOSPSBT="
      *                        SYS-1001-HOSPSBT " SYOSIN=" WRK-SYOSIN 
      *********END-EVALUATE
      * ∫Ó¿Æº‘ ª‹¿ﬂæ ÛÃæ
      *        ≥»ƒ•¥¡ª˙ —¥π
               MOVE    SYS-1001-HOSPNAME    TO  WRK-KOUMOKU
               PERFORM 800-ORCSKANACHK-SEC
               MOVE    WRK-KOUMOKU          TO  SYS-1001-HOSPNAME
      *
               MOVE  SYS-1001-HOSPNAME      TO  
                     WRK-LF01-CRE001-FACILITYNAME
                     WRK-LF01-CRE101-FACILITYNAME
                     WRK-LF01-CRE301-FACILITYNAME
      *¥…Õ˝º‘Ãæ
      *        ≥»ƒ•¥¡ª˙ —¥π
               MOVE    SYS-1001-KANRINAME   TO  WRK-KOUMOKU
               PERFORM 800-ORCSKANACHK-SEC
               MOVE    WRK-KOUMOKU          TO  SYS-1001-KANRINAME
      *
               MOVE  SYS-1001-KANRINAME     TO  WRK-LF01-CRE001-FULLNAME
                                                WRK-LF01-CRE101-FULLNAME
      *                                         WRK-LF01-CRE201-FULLNAME
                                                WRK-LF01-CRE301-FULLNAME
      *∞ÂŒ≈µ°¥ÿ•≥°º•…
               MOVE  SYS-1001-HOSPCD     TO  WRK-LF01-CRE001-PERSONALID
                                             WRK-LF01-CRE101-PERSONALID
                                             WRK-LF01-CRE301-PERSONALID
               MOVE  "doctor"               TO  WRK-LF01-CRE001-LICENSE
                                                WRK-LF01-CRE101-LICENSE
                                                WRK-LF01-CRE301-LICENSE
               MOVE  SYS-1001-HOSPID     TO  WRK-LF01-CRE001-FACILITYID
                                             WRK-LF01-CRE101-FACILITYID
                                             WRK-LF01-CRE301-FACILITYID
      *Õπ ÿ»÷πÊ
               MOVE  SYS-1002-POST(1:3)     TO  WRK-LF01-CRE001-ZIP(1:3)
                                                WRK-LF01-CRE101-ZIP(1:3)
                                                WRK-LF01-CRE301-ZIP(1:3)
               MOVE  "-"                    TO  WRK-LF01-CRE001-ZIP(4:1)
                                                WRK-LF01-CRE101-ZIP(4:1)
                                                WRK-LF01-CRE301-ZIP(4:1)
               MOVE  SYS-1002-POST(4:4)     TO  WRK-LF01-CRE001-ZIP(5:4)
                                                WRK-LF01-CRE101-ZIP(5:4)
                                                WRK-LF01-CRE301-ZIP(5:4)
      *ΩªΩÍ
               MOVE  SYS-1002-ADRS       TO  WRK-LF01-CRE001-ADRFULLNAME
                                             WRK-LF01-CRE101-ADRFULLNAME
                                             WRK-LF01-CRE301-ADRFULLNAME
      *        PERFORM UNTIL       (IDX            =   20   )
               PERFORM VARYING IDX FROM    1   BY  1
                               UNTIL   IDX >       20
                 IF    WRK-LF01-HONKZKKBN(IDX) NOT =   SPACE 
                       MOVE  "MML0031"      
                             TO  WRK-LF01-HKNSBTTBL(IDX)
                       MOVE  SYS-1001-HOSPNAME      
                             TO  WRK-LF01-CRE201-FACILITYNAME(IDX)
                       MOVE  SYS-1001-KANRINAME 
                             TO  WRK-LF01-CRE201-FULLNAME(IDX)
                       MOVE  SYS-1001-HOSPCD        
                             TO  WRK-LF01-CRE201-PERSONALID(IDX)
                       MOVE  "doctor"               
                             TO  WRK-LF01-CRE201-LICENSE(IDX)
                       MOVE  SYS-1001-HOSPID         
                             TO  WRK-LF01-CRE201-FACILITYID(IDX)
                       MOVE  SYS-1005-SRYKANAME  
                             TO  WRK-LF01-CRE201-DPERTNAME(IDX)
                       MOVE  WRK-SRYKA           
                             TO  WRK-LF01-CRE201-DPERTID(IDX)
                       MOVE  SYS-1002-POST(1:3) 
                                            TO  WRK-LF01-CRE201-ZIP(IDX)
                                                                 (1:3)
                       MOVE  "-"            
                                            TO  WRK-LF01-CRE201-ZIP(IDX)
                                                                  (4:1)
                       MOVE  SYS-1002-POST(4:4)     
                                            TO  WRK-LF01-CRE201-ZIP(IDX)
                                                                   (5:4)
                       MOVE  SYS-1002-ADRS  
                                            TO  
                             WRK-LF01-CRE201-ADRFULLNAME(IDX)
                  END-IF
               END-PERFORM
           END-IF     
      *
      *    •…•Ø•ø°º
           IF      SPA-DRCD            =   "@@@@@"
               CONTINUE
           ELSE
               PERFORM 2001-DRCD-NAME-SEC
               MOVE    SYS-1010-NAME   TO  WRK-LF01-CRE301-FULLNAME
               MOVE    SPA-DRCD        TO  WRK-LF01-CRE301-PERSONALID
           END-IF
      *    ø«ª°Œ¡•≥°º•…§Ú∑ËƒÍ§π§Î
           PERFORM 2020-SRYCD-SET-SEC
      *
           IF      WRK-LF01-IJICD       NOT =   SPACE
               INITIALIZE                       TNS-TENSU-REC
               MOVE    WRK-LF01-IJICD       TO  TNS-SRYCD
               PERFORM 900-TENSU-INV-SEC
               IF       FLG-TENSU       =       ZERO
                   MOVE    TNS-NAME        TO  WRK-LF01-HOSPSBT
      *            æÆª˘≤ ≥∞ÕËø«ª°Œ¡§«∆±∆¸∫∆ø«§Œª˛
                   IF     (WRK-LF01-IJICD(1:3) =   "113") AND
                          (WRK-LSTYMD          =   SPA-SYSYMD)
                       MOVE    "æÆª˘≤ ≥∞ÕËø«ª°Œ¡°¶∆±∆¸∫∆ø«"
                                               TO  WRK-LF01-HOSPSBT
                   END-IF
               ELSE
                   DISPLAY "*** ORCL0011 TEN INVALID KEY=" 
                           WRK-LF01-IJICD 
               END-IF
           END-IF
      *
      *    ø«ª°Œ¡•≥°º•…§Ú∑ËƒÍ§π§Î
           MOVE    LNK-PARA-SINRYONAIYO
                                       TO  WRK-LF01-YYKMEMO
      *
      *    ºı…’•·•‚ ‘Ω∏
           PERFORM 2009-PTMEMOINF-SEC
      *
           MOVE    1                  TO  FLG-END
      *
           .
       200-MAIN-EXT.
           EXIT.
      * 
      *****************************************************************
      *    £≤≤ÛÃ‹§´§È§ŒUID¿ﬂƒÍΩËÕ˝
      *****************************************************************
       2004-UID-TBL-SEC              SECTION.
      *
           PERFORM VARYING     IDX-U   FROM    1   BY  1
                   UNTIL       IDX-U   >   20
               IF      CLMUID-HKNCOMBI (IDX-U) =   COMB-HKNCOMBINUM
                   MOVE    CLMUID-UID  (IDX-U) TO  C-UID
                   MOVE    CLMUID-UID  (IDX-U) TO  WRK-LF01-UID2 (IDX)
                   MOVE    20                  TO  IDX-U
               END-IF
           END-PERFORM
           .
       2004-UID-TBL-EXT.
           EXIT.
      * 
      *****************************************************************
      *    •…•Ø•ø°º¿ﬂƒÍΩËÕ˝
      *****************************************************************
       2001-DRCD-NAME-SEC              SECTION.
      *
           MOVE    SPACE               TO  SYS-1010-REC
           INITIALIZE                      SYS-1010-REC
           MOVE    "1010"              TO  SYS-1010-KANRICD
           MOVE    SPA-DRCD            TO  SYS-1010-KBNCD
           MOVE    SPA-SYSYMD          TO  SYS-1010-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-1010-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-1010-HOSPNUM
           MOVE    SYS-1010-REC        TO  MCPDATA-REC
      *
           PERFORM 900-SYSKANRI-INV-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1010-REC
           ELSE
               INITIALIZE                      SYS-1010-REC
           END-IF
      *
      *    ≥»ƒ•¥¡ª˙ —¥π
           MOVE    SYS-1010-NAME       TO  WRK-KOUMOKU
           PERFORM 800-ORCSKANACHK-SEC
           MOVE    WRK-KOUMOKU         TO  SYS-1010-NAME
           .
       2001-DRCD-NAME-EXT.
           EXIT.
      * 
      *****************************************************************
      *    ø«Œ≈≤ ¿ﬂƒÍΩËÕ˝
      *****************************************************************
       2009-SRYKA-SET-SEC              SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYKA
      *
           MOVE    SPACE               TO  SYS-1005-REC
           INITIALIZE                      SYS-1005-REC
           MOVE    "1005"              TO  SYS-1005-KANRICD
           MOVE    SPA-SYSYMD          TO  SYS-1005-STYUKYMD
           MOVE    SPA-SYSYMD          TO  SYS-1005-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-1005-HOSPNUM
           MOVE    SYS-1005-REC        TO  MCPDATA-REC
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-SYSKANRI
                   MOVE    MCPDATA-REC         TO  SYS-1005-REC
                   MOVE    SYS-1005-KBNCD      TO  WRK-SRYKA
               ELSE
                   INITIALIZE                      SYS-1005-REC
               END-IF
           ELSE
               INITIALIZE                      SYS-1005-REC
           END-IF
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       2009-SRYKA-SET-EXT.
           EXIT.
      * 
      *****************************************************************
      *     ›∏±ºÔ Ã ‘Ω∏ΩËÕ˝
      *****************************************************************
       2001-HKNNUM-SET-SEC              SECTION.
      *
           EVALUATE    PTHKN-HKNNUM 
               WHEN    "060"
      *            πÒ ›§ŒæÏπÁ§œ°¢•º•Ì§Ú¿ﬂƒÍ
                   MOVE    "00"    TO  WRK-LF01-HKNSBTCODE (IDX)
               WHEN    "971"
      *            œ´∫“
                   MOVE    "R1"    TO  WRK-LF01-HKNSBTCODE (IDX)
                   MOVE    "9999"  TO  WRK-LF01-HKNJANUM (IDX)
                   MOVE    "œ´∫“"  TO  WRK-LF01-HKNSBT  (IDX)
               WHEN    "973"
      *            º´«Â¿’
                   MOVE    "R3"    TO  WRK-LF01-HKNSBTCODE (IDX)
                   MOVE    "9999"  TO  WRK-LF01-HKNJANUM (IDX)
                   MOVE    "º´«Â¿’"    TO  WRK-LF01-HKNSBT  (IDX)
               WHEN    "975"
      *            ∏¯≥≤
                   MOVE    "K5"    TO  WRK-LF01-HKNSBTCODE (IDX)
                   MOVE    "9999"  TO  WRK-LF01-HKNJANUM (IDX)
                   MOVE    "∏¯≥≤"  TO  WRK-LF01-HKNSBT  (IDX)
               WHEN    OTHER
                   EVALUATE    PTHKN-HKNNUM(1:2)
                   WHEN    "98"
      *                º´»Ò
                       MOVE    "Z"         TO  WRK-LF01-HKNSBTCODE
                                                            (IDX)(1:1)
                       MOVE    PTHKN-HKNNUM(3:1)
                                           TO  WRK-LF01-HKNSBTCODE
                                                            (IDX)(2:1)
                       MOVE    "9999" 
                                           TO  WRK-LF01-HKNJANUM (IDX)
                       MOVE    "º´»Ò" 
                                           TO  WRK-LF01-HKNSBT  (IDX)
                   WHEN    "90"
      *                º£∏≥
                       MOVE    "A"         TO  WRK-LF01-HKNSBTCODE
                                                            (IDX)(1:1)
                       MOVE    PTHKN-HKNNUM(3:1)
                                           TO  WRK-LF01-HKNSBTCODE
                                                            (IDX)(2:1)
                       MOVE    "9999" 
                                           TO  WRK-LF01-HKNJANUM (IDX)
                       MOVE    "º£∏≥" 
                                           TO  WRK-LF01-HKNSBT  (IDX)
                   WHEN    "91"
      *                º£∏≥
                       MOVE    "B"         TO  WRK-LF01-HKNSBTCODE
                                                            (IDX)(1:1)
                       MOVE    PTHKN-HKNNUM(3:1)
                                           TO  WRK-LF01-HKNSBTCODE
                                                            (IDX)(2:1)
                       MOVE    "9999" 
                                           TO  WRK-LF01-HKNJANUM (IDX)
                       MOVE    "º£∏≥" 
                                           TO  WRK-LF01-HKNSBT  (IDX)
                   WHEN    OTHER
      *                §Ω§Œ¬æ° ≤º£≤∑Â°À
                       MOVE    PTHKN-HKNNUM    TO  WRK-999
                       MOVE    WRK-999         TO  WRK-ZZZ
                       MOVE    WRK-ZZZ(2:2)    TO  WRK-LF01-HKNSBTCODE
                                                                (IDX)
                   END-EVALUATE
           END-EVALUATE
      *
           .
       2001-HKNNUM-SET-EXT.
           EXIT.
      * 
      *****************************************************************
      *    ∏¯»Ò∏ƒ ÃΩËÕ˝
      *****************************************************************
       20012-KOHID-HENSYU-SEC              SECTION.
      *
           INITIALIZE                      WRK-KOHI-AREA
                                           WRK-KOHI-AREA-X
           MOVE    ZERO                    TO  TBL-MAX
      *
      *
           PERFORM VARYING IDZ FROM    1   BY  1
                   UNTIL   IDZ >       4
               MOVE    COMB-KOHID    (IDZ) TO  WRK-KOHID-O     (IDZ)
               MOVE    COMB-KOHHKNNUM(IDZ) TO  WRK-KOHHKNNUM-O (IDZ)
      *        ∏¯»ÒÃææŒ
               MOVE    COMB-KOH-TANSEIDONAME(IDZ)
                                           TO  WRK-KOHMEI-O    (IDZ)
      *        ∏¯»Ò°›≥∞ÕË°›æÂ∏¬∂Ë ¨
               MOVE    COMB-KOH-GAIJGNKBN (IDZ)
                                           TO  WRK-GAIJGNKBN-O (IDZ)
           END-PERFORM
      *
      *    Õ•¿ËΩÁ∞Ã§À ¬§Ÿ¬ÿ§®
           PERFORM VARYING IDZ FROM    1   BY  1
                   UNTIL   IDZ >       WRK-SRT-KOHHKNNUM-MAX
                   OR      TBL-MAX     =   4 
               PERFORM VARYING IDY FROM    1   BY  1
                       UNTIL   IDY >       4
                   IF      WRK-SRT-KOHHKNNUM   (IDZ)
                                   =   WRK-KOHHKNNUM-O (IDY)
                       ADD     1               TO  TBL-MAX
                       MOVE    WRK-KOHI-TBL    (IDY)   TO
                                           WRK-KOHI-TBL-X (TBL-MAX)
                       INITIALIZE          WRK-KOHI-TBL   (IDY)
                       MOVE    4               TO  IDY
                   END-IF
               END-PERFORM
           END-PERFORM
      *
      *    §π§Ÿ§∆ ¬§Ÿ¬ÿ§®§øª˛ 
           IF      TBL-MAX                 =   4
               GO  TO  20012-KOHID-HENSYU-EXT
           END-IF
      *
      *    √œ ˝∏¯»Ò§Œ ¬§”¬ÿ§®
           PERFORM VARYING IDZ FROM    1    BY  1
                   UNTIL   IDZ >       3
               COMPUTE IDX1    =   IDZ     +   1
               PERFORM VARYING IDY FROM    IDX1    BY  1
                       UNTIL   IDY >       4
                   IF      WRK-KOHHKNNUM-O (IDZ) >   
                                           WRK-KOHHKNNUM-O (IDY)
                   OR      WRK-KOHHKNNUM-O (IDZ) =   SPACE 
                       MOVE    WRK-KOHI-TBL    (IDZ) TO  
                                           WRK-KOHI
                       MOVE    WRK-KOHI-TBL    (IDY) TO  
                                           WRK-KOHI-TBL(IDZ)
                       MOVE    WRK-KOHI              TO  
                                           WRK-KOHI-TBL(IDY)
                   END-IF
               END-PERFORM
           END-PERFORM
      *
      *    √œ ˝∏¯»Ò§Œƒ…≤√
           PERFORM VARYING IDZ FROM    1   BY  1
                   UNTIL   IDZ         >   4
                   OR      TBL-MAX     =   4 
               IF      WRK-KOHID-O (IDZ)   >   ZERO
                   ADD     1               TO  TBL-MAX
                   MOVE    WRK-KOHI-TBL (IDZ)
                           TO  WRK-KOHI-TBL-X (TBL-MAX)
               END-IF    
           END-PERFORM
076800     .
076900 20012-KOHID-HENSYU-EXT.
077000     EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª•Í•π•»ΩËÕ˝
      *****************************************************************
       2002-HKNCOMBI-LIST-SEC        SECTION.
      *
           INITIALIZE                  HZN-LF01-REC
           MOVE    1                   TO  IDX
           MOVE    WRK-LF01-TBL(IDX-HZN)   TO  HZN-LF01-TBL (1)
           PERFORM VARYING     IDY     FROM    1   BY  1
                   UNTIL      (IDY     >   20  )  OR
                              (IDX     >=  20  )
               IF      IDX-HZN         NOT =   IDY
                   ADD     1               TO  IDX
                   MOVE    WRK-LF01-TBL(IDY)   TO  HZN-LF01-TBL (IDX)
               END-IF
           END-PERFORM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   20
               MOVE    HZN-LF01-TBL(IDX)   TO  WRK-LF01-TBL (IDX)
           END-PERFORM
      *
           .
       2002-HKNCOMBI-LIST-EXT.
           EXIT.
      *
      *****************************************************************
      *    …È√¥Œ®°¶…È√¥≥€ ‘Ω∏ΩËÕ˝
      *****************************************************************
       400-KOHFTN-HENSYU-SEC        SECTION.
      *
      *
           MOVE    SPACE               TO  HKNNUM-REC
           MOVE    SPA-HOSPNUM         TO  HKN-HOSPNUM
      *     ›∏±»÷πÊ° ∏¯»Ò°À
           MOVE    PTKOH-KOHNUM        TO  HKN-HKNNUM
      *    ªŸ ß∂Ë ¨
           MOVE    PTKOH-PAYKBN        TO  HKN-PAYKBN
           MOVE    SPA-SYSYMD          TO  HKN-TEKSTYMD
           MOVE    SPA-SYSYMD          TO  HKN-TEKEDYMD
      *
           MOVE    HKNNUM-REC          TO  MCPDATA-REC
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hknnum"        TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 980-HKNNUM-READ-SEC
           ELSE
               INITIALIZE              HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           MOVE    "tbl_hknnum"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      WRK-GAIJGNKBN (IDY1)    =   SPACE
      *        À‹øÕ°›≥∞ÕË°›≤Û°›…È√¥≥‰πÁ
               COMPUTE WRK-FTNRATE         =   HKN-HON-GAIKFTNRATE
                                           /   100
               MOVE    WRK-FTNRATE         TO  WRK-Z9
               MOVE    WRK-Z9              TO  WRK-FTNRATEMEI
               MOVE    WRK-FTNRATEMEI      TO  WRK-LF01-RATIO (IDX IDY1)
               MOVE    "ratio"             TO  WRK-LF01-RATIO-CODE
                                                              (IDX IDY1)
           ELSE
      *        æÂ∏¬≥€
               IF      HKN-HON-GAIKKOTGAK  =   ZERO
      *            À‹øÕ°›≥∞ÕË°›∆¸°›æÂ∏¬≥€
                   MOVE    HKN-HON-GAIDJGNGAK  TO  WRK-ZZ9
               ELSE
      *            À‹øÕ°›≥∞ÕË°›≤Û°›æÂ∏¬≥€
                   MOVE    HKN-HON-GAIKKOTGAK  TO  WRK-ZZ9
               END-IF
               MOVE    WRK-ZZ9             TO  WRK-LF01-RATIO (IDX IDY1)
               MOVE    "fix"               TO  WRK-LF01-RATIO-CODE
                                                              (IDX IDY1)
           END-IF
           .
       400-KOHFTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ø«ª°Œ¡•≥°º•…§Ú∑ËƒÍΩËÕ˝
      *****************************************************************
       2020-SRYCD-SET-SEC        SECTION.
      *
      *    ºıø«Õ˙ŒÚ§Ë§Íø«ª°≤ÛøÙ§Úµ·§·§Î
           PERFORM 1000-SINSATU-KAISU-SEC
      *
           MOVE    ZERO                TO  FLG-ARIS
      *    æÆª˘≤ ≥∞ÕËø«ª°Œ¡
           IF      (FLG-SYONIKA-ARI    =   1   )  AND
                  ((WRK-NENREI-YY      <   3   )  OR
                   (WRK-NENREI-YY      =   3   AND
                    WRK-NENREI-MM      =   ZERO ))
               PERFORM 20201-SYONIKA-HEN-SEC
               IF      FLG-ARIS        =   1
                   GO      TO      2020-SRYCD-SET-EXT
               END-IF
           END-IF
      *
      *    ø«ª°Œ¡•≥°º•…§Ú∑ËƒÍ§π§Î
           IF      WRK-SYOSIN          =   1
               MOVE    "11"                TO  WRK-SRYKBN
               MOVE    "F"                 TO  WRK-KBN
      *        ø«ª°•≥°º•…§Ú•∆°º•÷•Î§Ë§Í∑ËƒÍ
               PERFORM 2001-SRYCD-TBL-SEC
               MOVE    "110"           TO
                       WRK-LF01-BUNDLE-CLASSCODE    
           ELSE
      *        ∆±∆¸∫∆ø«Œ¡ªªƒÍ
               IF      WRK-LSTYMD          =   SPA-SYSYMD
                   MOVE    "12"                TO  WRK-SRYKBN
                   MOVE    "D"                 TO  WRK-KBN
      *            ø«ª°•≥°º•…§Ú•∆°º•÷•Î§Ë§Í∑ËƒÍ
                   PERFORM 2001-SRYCD-TBL-SEC
               ELSE
      *        ∫∆ø«Œ¡ªªƒÍ
                   MOVE    "12"                TO  WRK-SRYKBN
                   MOVE    SPACE               TO  WRK-KBN
      *            ø«ª°•≥°º•…§Ú•∆°º•÷•Î§Ë§Í∑ËƒÍ
                   PERFORM 2001-SRYCD-TBL-SEC
               END-IF
               MOVE    "120"           TO
                       WRK-LF01-BUNDLE-CLASSCODE    
           END-IF
           .
       2020-SRYCD-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºıø«Õ˙ŒÚ§Ë§Íø«ª°≤ÛøÙ§Úµ·§·§ÎΩËÕ˝
      *****************************************************************
       1000-SINSATU-KAISU-SEC          SECTION.
      *
           MOVE    ZERO                TO  WRK-SINSATU-CNT
           MOVE    ZERO                TO  FLG-15MIMAN
           MOVE    ZERO                TO  WRK-15MIMAN-ARI
      *
      *    «ØŒ∑◊ªª
           MOVE    PTINF-BIRTHDAY      TO  WRK-YMDS1
           MOVE    SPA-SYSYMD          TO  WRK-YMDS2
           COMPUTE WRK-NENREI-YY       =   WRK-YYS2
                                       -   WRK-YYS1
           IF      WRK-YMDS1(5:4)      >   WRK-YMDS2(5:4)
               COMPUTE WRK-NENREI-YY   =   WRK-NENREI-YY
                                           -   1
               COMPUTE WRK-NENREI-MM   =  (WRK-MMS2  +  12 )
                                           -   WRK-MMS1
           ELSE
               COMPUTE WRK-NENREI-MM   =   WRK-MMS2
                                           -   WRK-MMS1
           END-IF
           IF      WRK-DDS1            >   WRK-DDS2
               COMPUTE WRK-NENREI-MM   =   WRK-NENREI-MM
                                           -   1
           END-IF
      *
      *    £±£µ∫–§À§ §Î«Ø∑Ó∆¸§Ú∑◊ªª
           MOVE    PTINF-BIRTHDAY      TO  WRK-BIRTHDAY
           COMPUTE WRK-BIRTH-YY        =   WRK-BIRTH-YY    +  15
      *
      *    ºıø«Õ˙ŒÚ§Ë§Íºıø«≤ÛøÙ§Úµ·§·§Î
      *    ºıø«ŒÚ§Ú∏°∫˜§π§Î° ø«Œ≈∑Ó£±∆¸§´§Èø«Œ≈∆¸§ﬁ§«§Œ»œ∞œ°À
           MOVE    SPACE               TO  JYURRK-REC
           INITIALIZE                  JYURRK-KEY
           MOVE    SPA-HOSPNUM         TO  JYURRK-HOSPNUM
           MOVE    SPA-PTID            TO  JYURRK-PTID
      *
      *    £»£±£µ«Ø£∂∑Ó§Ë§Í§π§Ÿ§∆£±≤ÛÃ‹§»§π§Î
           IF      SPA-SYSYMD          >=  "20030601"
               MOVE    SPA-SYSYMD          TO  JYURRK-SRYYMD
           ELSE
               MOVE    SPA-SYSYMD          TO  JYURRK-SRYYMD
               MOVE    "01"                TO  JYURRK-SRYYMD(7:2)
           END-IF
           MOVE    SPA-SYSYMD          TO  JYURRK-UPSRYYMD
           MOVE    "2"                 TO  JYURRK-NYUGAIKBN
      *
           MOVE    JYURRK-REC          TO  MCPDATA-REC
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key14"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_jyurrk"        TO  MCP-TABLE
               MOVE    "key14"             TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           ELSE
               MOVE    SPACE               TO  JYURRK-REC
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
           PERFORM
                   UNTIL    FLG-JYURRK     =   1
               IF      JYURRK-RENNUM       =   1
                   MOVE    ZERO            TO  FLG-SYONIKA
               END-IF
               MOVE    ZERO                TO  FLG-CHK
               IF      FLG-CHK             =   ZERO
      *            ºıø«Õ˙ŒÚ§À∆±∆¸¬æ≤ ªªƒÍ§¨§ §§§≥§»
                   PERFORM 10001-DOUJI-CHK-SEC
               END-IF
      *
               IF     (JYURRK-EDANUM       =   1   )  AND
                      (JYURRK-DOUJI-RENNUM =   1  OR  ZERO )
                   CONTINUE
               ELSE
                   MOVE    1               TO  FLG-CHK
               END-IF
      *        ºıø«≤ÛøÙ
               IF      FLG-CHK         =   ZERO
                   ADD     1               TO  WRK-SINSATU-CNT
               END-IF
      *
               MOVE    "tbl_jyurrk"        TO  MCP-TABLE
               MOVE    "key14"             TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           END-PERFORM
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key14"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *!   £±£µ∫–Ã§À˛∫∆ø«≤ ªªƒÍÕ≠§Í
      *    IF     (WRK-NENREI-YY       =   15              )  AND
      *           (WRK-BIRTHDAY(1:6)   =   SPA-SYSYMD (1:6))
      *        IF      FLG-15MIMAN         =   1
      *            MOVE    1               TO  WRK-15MIMAN-ARI
      *        END-IF
      *!   END-IF
           .
       1000-SINSATU-KAISU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºıø«Õ˙ŒÚ§À∆±∆¸¬æ≤ ªªƒÍ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       10001-DOUJI-CHK-SEC                  SECTION.
      *
           IF      JYURRK-SRYKBN (01)      =   "01"
               CONTINUE
           ELSE
               MOVE    1                   TO  FLG-CHK
               GO      TO      10001-DOUJI-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-SINSATU
           MOVE    ZERO                TO  FLG-SYOSIN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   15  )  OR
                              (FLG-SINSATU         =   1     )  OR
                              (JYURRK-ZAINUM (IDX) =   ZERO  )
      *
               MOVE    SPACE               TO  SRYACT-REC
               INITIALIZE                  SRYACT-REC
               MOVE    SPA-HOSPNUM         TO  SRY-HOSPNUM
               MOVE    "2"                 TO  SRY-NYUGAIKBN
               MOVE    JYURRK-PTID         TO  SRY-PTID
               MOVE    JYURRK-SRYKA        TO  SRY-SRYKA
               MOVE    JYURRK-SRYYMD(1:6)  TO  SRY-SRYYM
               MOVE    JYURRK-ZAINUM (IDX)
                                           TO  SRY-ZAINUM
      *
               MOVE    SRYACT-REC          TO  MCPDATA-REC
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 910-DBSELECT-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    "tbl_sryact"        TO  MCP-TABLE
                   MOVE    "key2"              TO  MCP-PATHNAME
                   PERFORM 930-SRYACT-READ-SEC
                ELSE
                   INITIALIZE                  SRYACT-REC
                   MOVE    1               TO  FLG-SRYACT
               END-IF
      *
               PERFORM
                       UNTIL  (FLG-SRYACT      =   1     )  OR
                              (FLG-SINSATU     =   1     )
                   PERFORM VARYING     IDY     FROM    1   BY  1
                           UNTIL   (IDY        >   5   )  OR
                                   (FLG-SINSATU          =   1     )  OR
                                   (SRY-SRYCD (IDY)      =   SPACE )
                       PERFORM 100011-IPN-DOUJI-CHK-SEC
                   END-PERFORM
      *
                   MOVE    "tbl_sryact"        TO  MCP-TABLE
                   MOVE    "key2"              TO  MCP-PATHNAME
                   PERFORM 930-SRYACT-READ-SEC
               END-PERFORM
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 990-DBCLOSE-SEC
      *
           END-PERFORM
      *
           IF    ((FLG-SINSATU         =   1   )  OR
                  (FLG-SYONIKA         =   1   ))  AND
                  (FLG-SYOSIN          =   ZERO )
               MOVE    ZERO            TO  FLG-CHK
           ELSE
               MOVE    1               TO  FLG-CHK
           END-IF
      *
      *    ΩÈø«Œ¡ªªƒÍª˛°¢≤ÛøÙ§Ú•Ø•Í•¢§π§Î
           IF      FLG-SYOSIN          =   1
               MOVE    ZERO            TO  WRK-SINSATU-CNT
           END-IF
      *
           .
       10001-DOUJI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∞Ï»Ã∆±∆¸¬æ≤ ªªƒÍ•¡•ß•√•ØΩËÕ˝
      *****************************************************************
       100011-IPN-DOUJI-CHK-SEC        SECTION.
      *
      *    ø«ª°Œ¡∏°∫˜
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
               AT   END
                   MOVE    ZERO               TO  FLG-ARI
                   MOVE    SPACE              TO  WRK-KBN
                   MOVE    SPACE              TO  WRK-KBN2
               WHEN   SRY-SRYCD (IDY)     =   TBL-SRYCD (TBL-IDX)
                   MOVE    1                  TO  FLG-ARI
                   MOVE    TBL-KBN  (TBL-IDX) TO  WRK-KBN
                   MOVE    TBL-KBN2 (TBL-IDX) TO  WRK-KBN2
           END-SEARCH
      *
           IF      FLG-ARI         =   1
               MOVE    1               TO  FLG-SINSATU
      *        æÆª˘≤ ≥∞ÕËø«ª°Œ¡§¢§Í
               IF      SRY-SRYCD(IDY)(1:3)     =   "113"
                   MOVE    1           TO  FLG-SYONIKA
               END-IF
      *!       £±£µ∫–Ã§À˛§Œºıø«§¢§Í
      *        IF      JYURRK-SRYYMD       <   WRK-BIRTHDAY
      *            MOVE    1               TO  FLG-15MIMAN
      *!       END-IF
           ELSE
               EVALUATE    SRY-SRYCD (IDY)
      *            ∫ﬂ¬¥µº‘À¨Ã‰ø«ª°Œ¡
                   WHEN    "114001110"
      *            ∫ﬂ¬Àˆ¥¸∞ÂŒ≈¡ÌπÁø«ª°Œ¡
                   WHEN    "114007610"
                   WHEN    "114007710"
                       MOVE    1               TO  FLG-SINSATU
               END-EVALUATE
           END-IF
      *    ΩÈø«Œ¡§œªªƒÍ≥∞§»§π§Î
           IF     (SRY-SRYKBN          =   "11" )  OR
                  (SRY-SRYCD(IDY)      =   "113003510"  OR
                                           "113003710" )
               MOVE    1               TO  FLG-SYOSIN
           END-IF
      *
           .
       100011-IPN-DOUJI-CHK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ø«ª°Œ¡§Ú•∆°º•÷•Î§Ë§Í∑ËƒÍΩËÕ˝
      *****************************************************************
       2001-SRYCD-TBL-SEC              SECTION.
      *
           IF      WRK-SRYKBN          =   "11"
               MOVE    1               TO  WRK-KAISU
           ELSE
      ******   EVALUATE    WRK-SINSATU-CNT
      *            WHEN    0
      *                MOVE    1               TO  WRK-KAISU
      *            WHEN    1
      *            WHEN    2
      *                MOVE    2               TO  WRK-KAISU
      *            WHEN    OTHER
      *                MOVE    4               TO  WRK-KAISU
      ******** END-EVALUATE
      *        …¬±°§«£≤£∞£∞æ≤∞ æÂ§œ≥∞ÕËø«Œ≈Œ¡§»§π§Î
               IF      (SYS-1001-HOSPSBT       =   "1"  )  AND
                       (SYS-1001-BEDSUIPN      >=  200  )
                   MOVE    5               TO  WRK-KAISU
               ELSE
      *        ∞ ≥∞§œ§π§Ÿ§∆£±≤ÛÃ‹§»§π§Î
                   MOVE    1               TO  WRK-KAISU
               END-IF
           END-IF
      *
           MOVE    SPACE               TO  WRK-KBN2
      *!!! £±£µ∫ÕÃ§À˛
      *    IF    ((WRK-NENREI-YY       <   15 ) OR
      *           (WRK-15MIMAN-ARI     =   1  )) AND
      *          ( WRK-KAISU           =   4  )
      *        MOVE    4                   TO  WRK-KAISU
      *        MOVE    "M"                 TO  WRK-KBN2
      *!!! END-IF
      *    œ∑øÕ
           IF      WRK-NENREI-YY       >=  70
               MOVE    1               TO  FLG-ROUJIN
           ELSE
               MOVE    ZERO            TO  FLG-ROUJIN
           END-IF
      *£»£±£∏°ø£¥≤˛¿µ¬–±˛
      *    §π§Ÿ§∆∞Ï»Ã
           MOVE    SYS-1001-HOSPSBT    TO  WRK-HOSPSBT
           IF      SPA-SYSYMD(1:6)     >=  "200604"
               MOVE    ZERO                TO  FLG-ROUJIN
               IF      WRK-KBN             =   "F"
                   MOVE    1               TO  WRK-HOSPSBT
               END-IF
           END-IF
      *£»£≤£≤«Ø£¥∑Ó≤˛¿µ
      *    §π§Ÿ§∆…¬±°° ø«Œ≈ΩÍ«—ªﬂ°À
           IF      SPA-SYSYMD(1:6)     >=  "201004"
               MOVE    1               TO  WRK-HOSPSBT
           END-IF
      *
      *    ø«ª°Œ¡•ª•√•»
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT   END
                       MOVE    SPACE           TO  WRK-LF01-IJICD
                       DISPLAY "*** ORCL0011 IJICD ERR HOSPSBT="
                               SYS-1001-HOSPSBT " SYOSIN=" WRK-SYOSIN 
                   WHEN   (WRK-KAISU           =   TBL-KAISU (TBL-IDX))
                     AND  (FLG-ROUJIN          =   TBL-ROUJIN(TBL-IDX))
                     AND  (WRK-HOSPSBT         =   TBL-HOSPSBT(TBL-IDX))
                     AND  (WRK-KBN             =   TBL-KBN    (TBL-IDX))
                     AND  (WRK-KBN2            =   TBL-KBN2   (TBL-IDX))
                     AND  (WRK-SRYKBN          =   TBL-SRYCD(TBL-IDX)
                                                                (2:2))
                       MOVE    TBL-SRYCD (TBL-IDX)
                                               TO  WRK-LF01-IJICD
           END-SEARCH
      *
           .
       2001-SRYCD-TBL-EXT.
           EXIT.
      *
      *****************************************************************
      *    æÆª˘≤ ≥∞ÕËø«ª°Œ¡ —¥πΩËÕ˝
      *****************************************************************
       20201-SYONIKA-HEN-SEC        SECTION.
      *
      *    £≥∫–§À§ §Î«Ø∑Ó∆¸§Ú∑◊ªª
           MOVE    PTINF-BIRTHDAY      TO  WRK-BIRTHDAY
           COMPUTE WRK-BIRTH-YY        =   WRK-BIRTH-YY    +  3
      *    £≥∫–≈˛√£∑Ó§À≈¨Õ—
           IF      WRK-BIRTHDAY(1:6)   <   SPA-SYSYMD (1:6)
               GO      TO      20201-SYONIKA-HEN-EXT
           END-IF
      *
           IF      (WRK-NENREI-YY      =   3 )  AND
                   (WRK-NENREI-MM      =   ZERO)  AND
                   (PTINF-BIRTHDAY(7:2)    <=  SPA-SYSYMD(7:2))
      *        £≥∫–§Œ√¬¿∏∆¸∞ ¡∞§«°¢≈ˆ∑Ó§Àø«ª°§¨§¢§√§øª˛
               IF      WRK-LSTYMD(1:6)     =   SPA-SYSYMD(1:6)
                   IF     (WRK-LSTYMD          =   SPA-SYSYMD) AND
                          (FLG-SYONIKA         =   ZERO      )
                       GO      TO      20201-SYONIKA-HEN-EXT
                   END-IF
               ELSE
                   GO      TO      20201-SYONIKA-HEN-EXT
               END-IF
           END-IF
           MOVE    1                   TO  FLG-ARIS
      *
      *    ø«ª°Œ¡•≥°º•…§Ú∑ËƒÍ§π§Î
           IF      WRK-SYOSIN          =   1
      *        ΩÈø«
               IF      SYS-1001-SYOHOKBN    =   "0"
      *            ±°∆‚
                   MOVE    "113003710"         TO  WRK-LF01-IJICD
               ELSE
      *            ±°≥∞
                   MOVE    "113003510"         TO  WRK-LF01-IJICD
               END-IF
               MOVE    "130"           TO  WRK-LF01-BUNDLE-CLASSCODE
           ELSE
      *        ∫∆ø«
               IF      SYS-1001-SYOHOKBN    =   "0"
      *            ±°∆‚
                   MOVE    "113003810"         TO  WRK-LF01-IJICD
               ELSE
      *            ±°≥∞
                   MOVE    "113003610"         TO  WRK-LF01-IJICD
               END-IF
               MOVE    "130"           TO  WRK-LF01-BUNDLE-CLASSCODE
           END-IF
      *
           .
       20201-SYONIKA-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ºı…’•·•‚ ‘Ω∏ΩËÕ˝
      *****************************************************************
        2009-PTMEMOINF-SEC        SECTION.
      *
           MOVE    SPACE               TO  PTMEMOINF-REC
           INITIALIZE                  PTMEMOINF-REC
           MOVE    SPA-HOSPNUM         TO  PTMEMOINF-HOSPNUM
           MOVE    SPA-PTID            TO  PTMEMOINF-PTID
           MOVE    2                   TO  PTMEMOINF-MEMOKBN
           MOVE    SPA-SYSYMD          TO  PTMEMOINF-SYSYMD
      *
           MOVE    PTMEMOINF-REC       TO  MCPDATA-REC
           MOVE    "tbl_ptmemoinf"     TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptmemoinf"     TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 910-PTMEMOINF-READ-SEC
           ELSE
               MOVE    1               TO  FLG-PTMEMOINF
               INITIALIZE                  PTMEMOINF-REC
           END-IF
           MOVE    SPACE               TO  WRK-MEMO
           PERFORM UNTIL    FLG-PTMEMOINF  =   1
               IF      PTMEMOINF-SRYKA     =   "00"
                   IF      WRK-MEMO        =   SPACE
                       MOVE    PTMEMOINF-MEMO  TO  WRK-MEMO
                   END-IF
               ELSE
                   IF      PTMEMOINF-SRYKA     =   SPA-SRYKA
                       MOVE    PTMEMOINF-MEMO  TO  WRK-MEMO
                   END-IF
               END-IF
               MOVE    "tbl_ptmemoinf"     TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 910-PTMEMOINF-READ-SEC
           END-PERFORM
           MOVE    "tbl_ptmemoinf"     TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           MOVE    SPACE               TO  WRK-MEMO-G
           MOVE    WRK-MEMO            TO  WRK-MEMO-OK
           IF      WRK-MEMO        NOT =   SPACE
      *        ≤˛π‘§Ú"@"§»§π§Î
               INSPECT     WRK-MEMO    REPLACING  ALL  X"0A"
                                                  BY   "/"
               UNSTRING    WRK-MEMO    DELIMITED BY "°ˆ°ˆ°ˆ°ˆ°ˆ"
                     INTO  WRK-MEMO-01
                           WRK-MEMO-02
                           WRK-MEMO-03
                           WRK-MEMO-04
                           WRK-MEMO-05
               END-UNSTRING
               IF      WRK-MEMO-01     NOT =   SPACE
                   MOVE    WRK-MEMO-01     TO  WRK-MEMO-OK
               END-IF
               IF      WRK-MEMO-02     NOT =   SPACE
                   IF      WRK-MEMO-02(1:1)    =   "/"
                       MOVE    WRK-MEMO-02(2:) TO  WRK-MEMO-OK
                   ELSE
                       MOVE    WRK-MEMO-02     TO  WRK-MEMO-OK
                   END-IF
               END-IF
               IF      WRK-MEMO-03     NOT =   SPACE
                   IF      WRK-MEMO-03(1:1)    =   "/"
                       MOVE    WRK-MEMO-03(2:) TO  WRK-MEMO-OK
                   ELSE
                       MOVE    WRK-MEMO-03     TO  WRK-MEMO-OK
                   END-IF
               END-IF
               IF      WRK-MEMO-04     NOT =   SPACE
                   IF      WRK-MEMO-04(1:1)    =   "/"
                       MOVE    WRK-MEMO-04(2:) TO  WRK-MEMO-OK
                   ELSE
                       MOVE    WRK-MEMO-04     TO  WRK-MEMO-OK
                   END-IF
               END-IF
               IF      WRK-MEMO-05     NOT =   SPACE
                   IF      WRK-MEMO-05(1:1)    =   "/"
                       MOVE    WRK-MEMO-05(2:) TO  WRK-MEMO-OK
                   ELSE
                       MOVE    WRK-MEMO-05     TO  WRK-MEMO-OK
                   END-IF
               END-IF
               INITIALIZE                  ORCXKANACONVAREA
               MOVE    1000                TO  KANACONV-LEN
               MOVE    1000                TO  KANACONV-STLEN
               MOVE    0                   TO  KANACONV-CONV-FLAG
               MOVE    0                   TO  KANACONV-CHAR-TYPE
               MOVE    WRK-MEMO-OK         TO  KANACONV-INDATA
               CALL    "kanaconv"          USING ORCXKANACONVAREA
               MOVE    KANACONV-OUTDATA    TO  WRK-MEMO-OK
           END-IF
      *    ºı…’•·•‚
           MOVE    WRK-MEMO-OK         TO  WRK-LF01-UKE-MEMO
           .
        2009-PTMEMOINF-EXT.
           EXIT.
      *****************************************************************
      *    ∆¸…’ —¥πΩËÕ˝
      *****************************************************************
       500-HIZUKE-HENSYU-SEC        SECTION.
      *
           IF      WRK-WYMD         =   SPACE
               MOVE    ALL "0"          TO  WRK-WYMD
           END-IF
      *
           IF      WRK-WYMD         =   ALL "9"
               MOVE    "99991231"       TO  WRK-WYMD
           END-IF
      *
           MOVE    WRK-WYY          TO  WRK-HENYY
           MOVE    WRK-WMM          TO  WRK-HENMM
           MOVE    WRK-WDD          TO  WRK-HENDD
           .
       500-HIZUKE-HENSYU--EXT.
           EXIT.
      *
      *****************************************************************
      *    £’£…£ƒºË∆¿ΩËÕ˝
      *****************************************************************
       500-UUID-SET-SEC             SECTION.
      *
           INITIALIZE     UIDIO-AREA.
           CALL    "orcuidset" USING ST UIDIO-AREA.
           DISPLAY "UUID CALL" UIDIO-AREA.
      *    WIN-EXEC GRAPH "DLL_orcuidset", UIDIO-AREA, " ", " ",
      *                                    UIDIO-AREA, ST
           .
       500-UUID-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    Õπ ÿ»÷πÊ —¥πΩËÕ˝
      *****************************************************************
       500-POST-HENSYU-SEC        SECTION.
      *
           IF      WRK-POST        =   SPACE
               MOVE    SPACE           TO  WRK-HENPOST
           ELSE
               MOVE    WRK-POST(1:3)   TO  WRK-HENPOST (1:3)
               MOVE    "-"             TO  WRK-HENPOST (4:1)
               MOVE    WRK-POST(4:4)   TO  WRK-HENPOST (5:4)       
           END-IF
           .
       500-POST-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¡¥≥—≥»ƒ•¥¡ª˙ —¥πΩËÕ˝
      *****************************************************************
       800-ORCSKANACHK-SEC        SECTION.
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    WRK-KOUMOKU         TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           MOVE    KANACHK-MAE-INPUT   TO  WRK-KOUMOKU
           .
       800-ORCSKANACHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ω™Œª°°°°ΩËÕ˝
      *****************************************************************
       300-END-SEC                 SECTION.
      *
           IF      FLG-CLMUID          =   ZERO
      *        UIDππø∑ΩËÕ˝
               MOVE    SMCNDATE-YMD        TO  CLMUID-UPYMD
               MOVE    SMCNDATE-HMS        TO  CLMUID-UPHMS
      *
               MOVE    CLMUID-REC          TO  MCPDATA-REC
               MOVE    "DBUPDATE"          TO  MCP-FUNC
               MOVE    "tbl_clm_uid"       TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"         USING
                                               MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC          NOT =   ZERO 
                   DISPLAY "ORCL0011 UPD CLMUID-KEY =>" CLMUID-KEY  "."
               END-IF
           ELSE
      *        UID≈–œøΩËÕ˝
               MOVE    SMCNDATE-YMD        TO  CLMUID-CREYMD
               MOVE    SMCNDATE-YMD        TO  CLMUID-UPYMD
               MOVE    SMCNDATE-HMS        TO  CLMUID-UPHMS
      *
               MOVE    CLMUID-REC          TO  MCPDATA-REC
               MOVE    "DBINSERT"          TO  MCP-FUNC
               MOVE    "tbl_clm_uid"       TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"         USING
                                               MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC          NOT =   ZERO 
                   DISPLAY "ORCL0011 INS CLMUID-KEY =>" CLMUID-KEY  "."
               END-IF
           END-IF
      *
           .
       300-END-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥µº‘•ﬁ•π•ø°º∆…π˛ΩËÕ˝
      *****************************************************************
       900-PTINF-READ-SEC         SECTION.
      *
           MOVE    PTINF-REC           TO  MCPDATA-REC
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptinf"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  PTINF-REC
                   MOVE    ZERO                TO  FLG-PTINF
               ELSE
                   MOVE    1                   TO  FLG-PTINF
                   INITIALIZE                  PTINF-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTINF
               INITIALIZE                  PTINF-REC
           END-IF
      *
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       900-PTINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥µº‘ ›∏±æ Û•ﬁ•π•ø∆…π˛
      *****************************************************************
       910-PTHKNINF-INV-SEC         SECTION.
      *
           MOVE    "tbl_pthkninf"      TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_pthkninf"      TO  MCP-TABLE
               MOVE    "key3"              TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-PTHKNINF
                   MOVE    MCPDATA-REC         TO  PTHKNINF-REC
               ELSE
                   MOVE    1                   TO  FLG-PTHKNINF
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTHKNINF
           END-IF
      *
           MOVE    "tbl_pthkninf"      TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       910-PTHKNINF-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥µº‘∏¯»Òæ Û•ﬁ•π•ø∆…π˛
      *****************************************************************
       910-PTKOHINF-INV-SEC         SECTION.
      *
           MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
               MOVE    "key3"              TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-PTKOHINF
                   MOVE    MCPDATA-REC         TO  PTKOHINF-REC
               ELSE
                   MOVE    1                   TO  FLG-PTKOHINF
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTKOHINF
           END-IF
      *
           MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       910-PTKOHINF-INV-EXT.
           EXIT.
      *****************************************************************
      *    £’£…£ƒ•«°º•ø∆…π˛ΩËÕ˝
      *****************************************************************
       903-CLMUID-READ-SEC         SECTION.
      *
           MOVE    CLMUID-REC          TO  MCPDATA-REC
           MOVE    "tbl_clm_uid"       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_clm_uid"       TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  CLMUID-REC
                   MOVE    ZERO                TO  FLG-CLMUID
               ELSE
                   MOVE    1                   TO  FLG-CLMUID
                   INITIALIZE                  CLMUID-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-CLMUID
               INITIALIZE                  CLMUID-REC
           END-IF
      *
           MOVE    "tbl_clm_uid"       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       903-CLMUID-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       900-COMB-READ-SEC         SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNCOMBI-REC
               MOVE    ZERO            TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                  HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           .
       900-COMB-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥…Õ˝•ﬁ•π•ø°º∆…π˛ΩËÕ˝
      *****************************************************************
       901-SYSKANRI-READ-SEC        SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO                TO  FLG-SYSKANRI
           ELSE
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
      *
           .
       901-SYSKANRI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥…Õ˝•ﬁ•π•ø°º∆…π˛° •≠°º°À
      *****************************************************************
       900-SYSKANRI-INV-SEC         SECTION.
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-SYSKANRI
               ELSE
                   MOVE    1                   TO  FLG-SYSKANRI
               END-IF
           ELSE
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       900-SYSKANRI-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    ø«Œ≈≤ ŒÚ•«°º•øºÁ•≠°º∏°∫˜
      *****************************************************************
       975-SRYKARRK-READ-SEC           SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SRYKARRK-REC
               MOVE    ZERO                TO  FLG-SRYKARRK
           ELSE
               MOVE    1                   TO  FLG-SRYKARRK
               INITIALIZE                  SRYKARRK-REC
           END-IF
      *
           .
       975-SRYKARRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ≈¿øÙ∆…π˛
      *****************************************************************
       900-TENSU-INV-SEC           SECTION.
      *
           MOVE    SPA-SYSYMD          TO  TNS-YUKOSTYMD
           MOVE    SPA-SYSYMD          TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-TENSU
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
               ELSE
                   MOVE    1                   TO  FLG-TENSU
               END-IF
           ELSE
               MOVE    1                   TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           .
       900-TENSU-INV-EXT.
           EXIT.
      ******************************************************************
      *    ºıø«Õ˙ŒÚ•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       970-JYURRK-READ-SEC         SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  JYURRK-REC
               MOVE    ZERO            TO  FLG-JYURRK
           ELSE
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
      *
           .
       970-JYURRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ø«Œ≈π‘∞Ÿ•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       930-SRYACT-READ-SEC         SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       930-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±»÷πÊ•ﬁ•π•øº°∏°∫˜ΩËÕ˝
      *****************************************************************
       980-HKNNUM-READ-SEC             SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  HKNNUM-REC
               MOVE    ZERO            TO  FLG-HKNNUM
           ELSE
               INITIALIZE              HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
           .
       980-HKNNUM-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¥µº‘•·•‚∆…π˛ΩËÕ˝
      *****************************************************************
       910-PTMEMOINF-READ-SEC         SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  PTMEMOINF-REC
               MOVE    ZERO                TO  FLG-PTMEMOINF
           ELSE
               INITIALIZE                      PTMEMOINF-REC
               MOVE    1                   TO  FLG-PTMEMOINF
           END-IF
      *
           .
       910-PTMEMOINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    •∆°º•÷•Î∏°∫˜ΩËÕ˝
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £ƒ£¬∆…§ﬂπ˛§ﬂΩËÕ˝
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    £ƒ£¬•Ø•Ì°º•πΩËÕ˝
      *****************************************************************
       990-DBCLOSE-SEC         SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
