      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
      *
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCGI01.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : Æþ±¡¶ÈÌ³
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ÆþÂà±¡ÅÐÏ¿¡Ê£É£°£±¡Ë
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  02.08.09    ¤Ò¤µ¤Ê¤¬ ¡¡   ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  01.00.01    NACL-ÂÀÅÄ    02.12.10  ¼ýÇ¼ÌÀºÙºï½ü½èÍýÄÉ²Ã
      *  01.00.02    NACL-ÂÀÅÄ    02.12.26  Æþ±¡²Ê¤Î½é´üÉ½¼¨¤ò½¤Àµ
      *  01.00.03    NACL-ÂÀÅÄ    03.01.24  ¿©»ö¤Î½¸·×ÊýË¡½¤Àµ
      *  01.00.04    NACL-ÂÀÅÄ    03.02.03  Âà±¡»þ¿ÇÎÅ¹Ô°Ù¥Á¥§¥Ã¥¯ÄÉ²Ã
      *  01.00.05    NACL-ÂÀÅÄ    03.02.05  ¼«±¡ÎòºîÀ®¥Ç¡¼¥¿¤ò¹ÍÎ¸¤¹¤ë
      *  01.00.06    NACL-ÂÀÅÄ    03.03.05  °ÛÆ°¼è¾Ãµ¡Ç½¤òÄÉ²Ã
      *                                     Æþ±¡Îò¤ÎÉ½¼¨¤ò½¤Àµ
      *  01.00.07    NACL-ÂÀÅÄ    03.03.06  ÄÌ»»Æü¿ô¤ò´Ø¿ô¤è¤ê¼èÆÀ¤¹¤ë
      *                                     ¤è¤¦½¤Àµ
      *  01.00.08    NACL-ÂÀÅÄ    03.03.07  ÇÓÂ¾À©¸æÂÐ±þ
      *  01.00.09    NACL-ÂÀÅÄ    03.03.12  ÁªÄêÎÅÍÜÈñ£±£¸£°Æü±Û¤¨¤Î
      *                                     Æü¿ô»»ÄêÊýË¡½¤Àµ
      *  01.00.10    NACL-ÂÀÅÄ    03.03.12  ¥«¥ë¥Æ°õºþµ¡Ç½ÄÉ²Ã
      *  01.00.11    NACL-ÂÀÅÄ    03.03.14  Å¾²Ê¡¦Å¾Åï¡¦Å¾¼¼»þ¡¢Æþ±¡ÎÁ
      *                                     ¤Î¤ß¤ÎÊÑ¹¹¤â²Ä¤È¤¹¤ë
      *  01.00.12    NACL-ÂÀÅÄ    03.03.18  Æþ±¡¥«¥¹¥¿¥Þ¥¤¥ºÄ¢É¼ÂÐ±þ
      *  01.00.13    NACL-ÂÀÅÄ    03.04.02  ÉéÃ´¶â·×»»¥µ¥Ö°ú¿ô½¤Àµ
      *  01.00.14    NACL-ÂÀÅÄ    03.04.08  ´µ¼ÔÅÐÏ¿¤Ø¤ÎÁ«°Ü¤òÄÉ²Ã
      *  01.00.15    NACL-ÂÀÅÄ    03.04.09  ÊÝ¸±ÁÈ¹ç¤»¤Î¼èÆÀÊýË¡½¤Àµ
      *  01.00.16    NACL-ÂÀÅÄ    03.05.08  Æþ±¡ÎòÉ½¼¨¤Î¼«±¡ÎòÂà±¡Æü¤Î
      *                                     ÊÔ½¸¤ò½¤Àµ¡ÊÆþ±¡ÃæÂÐ±þ¡Ë
      *  01.00.17    NACL-ÂÀÅÄ    03.05.16  Æþ±¡¥«¥ë¥Æ¤ËÊÝ¸±¤òÊÔ½¸¤¹¤ë
      *  01.00.18    NACL-ÂÀÅÄ    03.05.19  Âà±¡»þ¿ÇÎÅ¹Ô°Ù¥Á¥§¥Ã¥¯ÄÉ²Ã
      *  01.00.19    NACL-ÂÀÅÄ    03.06.05  Æþ±¡Îò¤Î½¤Àµ¤òÆüÉÕ¹àÌÜ°Ê³°¤Ï
      *                                     ¤¤¤Ä¤Ç¤âÊÑ¹¹²Ä¤È¤¹¤ë
      *  01.00.20    NACL-¾®Æ¦Âô  03.06.23  ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ¤ÎÅ¾¼¼¡¢
      *                                     Âà±¡¼è¾Ã¡¢°ÛÆ°¼è¾Ã¤ÎÀµ¼°ÂÐ±þ
      *  01.00.21    NACL-ÂÀÅÄ    03.06.24  ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ¡Ê£³£°Æü
      *                                     °ÊÆâºÆÆþ±¡¡Ë¤Î¹ÍÎ¸¤òÄÉ²Ã
      *  01.00.22    NACL-¾®Æ¦Âô  03.06.24  ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ¡Ê£³£°Æü
      *                                     °ÊÆâºÆÆþ±¡¡Ë¤Î¹ÍÎ¸¤òÄÉ²Ã
      *  01.00.23    NACL-¾®Æ¦Âô  03.06.24  ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤ÎÅ¾¼¼ÂÐ±þ
      *  01.00.24    NACL-ÂÀÅÄ    03.07.01  ½ÐÎÏÀè¥×¥ê¥ó¥¿¥µ¥ÖÄÉ²Ã
      *  01.00.25    NACL-¾®Æ¦Âô  03.07.08  ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤ÎÂà±¡¼è¾ÃÂÐ±þ
      *  01.00.26    NACL-¾®Æ¦Âô  03.07.09  ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤Î°ÛÆ°¼è¾ÃÂÐ±þ
      *  01.00.27    NACL-¾®Æ¦Âô  03.07.10  Âà±¡¼è¾Ã»þ¤Ë¿ÇÎÅÏ¿´ÉÍýÂÎÀ©²Ã»»¤ò
      *                                     »»Äê¤·¤Ê¤¤
      *  01.00.28    NACL-¾®Æ¦Âô  03.07.10  Âà±¡¼è¾Ã»þ¤ÎÄÌ»»Æü¿ô»»Äê¤ò½¤Àµ
      *  01.00.29    NACL-ÂÀÅÄ    03.07.10  ÇÓÂ¾À©¸æ½èÍý½¤Àµ
      *  01.00.30    NACL-¾®Æ¦Âô  03.07.10  °ÛÆ°¼è¾Ã»þ¤Ë¿ÇÎÅ²ñ·×¤òºï½ü¤·¤Ê¤¤¤è¤¦
      *                                     ÊÑ¹¹
      *  01.00.31    NACL-¾®Æ¦Âô  03.07.11  ¿ÇÎÅÏ¿´ÉÍýÂÎÀ©²Ã»»¤ÎÆÃÊÌ¥Á¥§¥Ã¥¯ºï½ü
      *  01.00.32    NACL-¾®Æ¦Âô  03.09.24  ÆÃÊÌÆþ±¡´ðËÜÎÁ»»Äê»þ¤ÎÆýÍÄ»ù²Ã»»ÂÐ±þ
      *  01.00.33    NACL-ÂÀÅÄ    03.09.24  ¾®»ùÆþ±¡°åÎÅ´ÉÍýÎÁ¤Ç¤ÎÆþ±¡»þ¤ËÇ¯Îð
      *                                     ¤ò¥Á¥§¥Ã¥¯¤·£±£µºÍ°Ê¾å¤Ç¤¢¤ì¤ÐÆÃÄêÆþ
      *                                     ±¡ÎÁ¥³¥ó¥Ü¤ËÉ½¼¨¤ò¤·¤Ê¤¤
      *  01.00.34    NACL-¾®Æ¦Âô  03.09.24  ¾®»ùÆþ±¡°åÎÅ´ÉÍýÎÁ£³¤Î»»ÄêÂÐ±þÄÉ²Ã
      *  01.00.35    NACL-Â¿¡¹Ç¼  03.09.30  ¶ÈÌ³¸¢¸ÂÈ½ÄêÄÉ²Ã
      *  01.00.36    NACL-¾®Æ¦Âô  03.10.03  °ìÎà´¶À÷¾É´µ¼ÔÆþ±¡°åÎÅ´ÉÍý¤Î»»ÄêÂÐ±þ
      *                                     ÄÉ²Ã
      *  01.00.37    NACL-¾®Æ¦Âô  03.10.03  Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ¤Î»»Äê
      *                                     ÂÐ±þÄÉ²Ã
      *  01.00.38    NACL-ÂÀÅÄ    03.10.09  Æþ±¡ÆüÊÑ¹¹»þ¤Ë¼¼ÎÁº¹³Û¤ò½é´ü²½¤·¤Ê¤¤
      *  01.00.39    NACL-¾®Æ¦Âô  03.10.24  Ï«ºÒ¡Ê¼«Çå¡ËÆþ±¡»þ¤ËÏ·¿ÍÅÀ¿ôÌµ¸ú
      *  01.00.40    NACL-¾®Æ¦Âô  03.10.27  Ï«ºÒ¡Ê¼«Çå¡ËÆþ±¡»þ¤ËÁªÄêÆþ±¡¤Ê¤·
      *  01.00.41    NACL-ÂÀÅÄ    03.11.14  ¹¹¿·ÆüÉÕÊÔ½¸ÂÐ±þ
      *  01.00.42    NACL-¾®Æ¦Âô  03.11.26  Ï·¿Í´µ¼Ô¤ÎÈ½Äê¾ò·ïÄÉ²Ã
      *  01.00.43    NACL-¾®Æ¦Âô  03.12.01  ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤Î
      *                                     »»ÄêÂÐ±þÄÉ²Ã¡Ê»»Äê¾å¸ÂÆü¿ô·Ð²á¸å¤Î
      *                                     °ìÈÌÆþ±¡ÎÁ»»Äê¤Ï¥³¥á¥ó¥È¤È¤¹¤ë¡Ë
      *  01.00.44    NACL-ÂÀÅÄ    04.01.28  ÉÂ¼¼ÊÑ¹¹»þ¤Ë¼¼ÎÁº¹³ÛÉ½¼¨¤¬
      *                                     ÊÑ¤ï¤é¤Ê¤¤ÉÔ¶ñ¹ç¤ò½¤Àµ
      *  01.00.45    NACL-¾®Æ¦Âô  04.03.10  Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ£²¤Î
      *                                     »»ÄêÂÐ±þÄÉ²Ã
      *  01.00.46    NACL-¾®Æ¦Âô  04.03.11  ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ¤Î
      *                                     »»ÄêÂÐ±þÄÉ²Ã
      *  01.00.47    NACL-ÂÀÅÄ    04.03.11  Å¾²Ê¡¦Å¾Åï¡¦Å¾¼¼»þ¤Î¹àÌÜÊÑ¹¹
      *                                     ¥Á¥§¥Ã¥¯¤òºï½ü
      *  01.00.48    NACL-ÂÀÅÄ    04.03.12  »»ÄêÆþ±¡ÎÁ¤ÎÉ½¼¨¤òÄÉ²Ã
      *  01.00.49    NACL-¾®Æ¦Âô  04.03.15  ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤Î
      *                                     »»ÄêÂÐ±þºÆÄÉ²Ã
      *  01.00.50    NACL-¾®Æ¦Âô  04.03.15  °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ¤Î»»ÄêÂÐ±þÄÉ²Ã
      *  01.00.51    NACL-¾®Æ¦Âô  04.03.16  £±£µºÐÌ¤Ëþ¤Î´µ¼Ô¤ÏÁªÄêÆþ±¡ÂÐ¾Ý³°
      *  01.00.52    NACL-ÂÀÅÄ    04.08.02  Äê´üÀÁµáÃæ¤ÏÂà±¡ÅÐÏ¿¤ÏÉÔ²Ä¤È¤¹¤ë
      *  01.00.53    NACL-ÂÀÅÄ    04.10.14  Âà±¡»öÍ³ÄÉ²Ã
      *  01.00.54    NACL-¾®Æ¦Âô  05.07.19  ¼«Èñ£±£°¹àÌÜÂÐ±þ
      *****************************************************************
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                        DIVISION.
       FILE                        SECTION.
      *
      *
       WORKING-STORAGE             SECTION.
      *
      *
      *    ²èÌÌÈóÉ½¼¨
           COPY    "ENUM-VALUE".
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *
      *    ÆþÂà±¡ÅÐÏ¿¶¦ÄÌÎÎ°è
           COPY    "I0COMMON-SPA".
      *
      *    ²èÌÌÍÑ£Ó£Ð£Á
           COPY    "I0SCR-SPA".
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-END                     PIC 9(01).
           03  FLG-ERR                     PIC 9(01).
           03  FLG-DBRC                    PIC 9(01).
           03  FLG-ENTRYCHK                PIC 9(01).
           03  FLG-PTNYUINRRK              PIC 9(01).
           03  FLG-HKNCOMBICHK             PIC 9(01).
           03  FLG-SYORIPTN                PIC 9(01).
           03  FLG-TAISYO                  PIC 9(01).
           03  FLG-UKETUKEGAITO            PIC 9(01).
           03  FLG-SYSKANRI                PIC 9(01).
           03  FLG-ORCSDAY                 PIC 9(01).
           03  FLG-JYUHKNCOMBISET          PIC 9(01).
           03  FLG-NYUKSN                  PIC 9(01).
           03  FLG-HKNCOMBI                PIC 9(01).
           03  FLG-TENKA-SRYKA             PIC 9(01).
           03  FLG-PTINF                   PIC 9(01).
           03  FLG-ZI-SAISIN               PIC 9(01).
           03  FLG-TOKSET-LOOP             PIC 9(01).
           03  FLG-SYUNOU                  PIC 9(01).
           03  FLG-SYUMEI                  PIC 9(01).
           03  FLG-PTTEIKIRRK              PIC 9(01).
           03  FLG-TENSU                   PIC 9(01).
           03  FLG-SRYACCT                 PIC 9(01).
           03  FLG-SYUARI                  PIC 9(01).
           03  FLG-RJN                     PIC 9(01).
           03  FLG-NYUINACCT               PIC 9(01).
           03  FLG-NYUINACCTARI            PIC 9(01).
           03  FLG-WKPTTEIKIRRK            PIC 9(01).
           03  FLG-HKNCOMBIGET             PIC 9(01).
           03  FLG-RRKCHK                  PIC 9(01).
           03  FLG-CMB-EDIT                PIC 9(01).
           03  FLG-NYUREKILST-ROW          PIC 9(01).
           03  FLG-SHONUM                  PIC 9(01).
           03  FLG-TAIINRRK                PIC 9(01).
           03  FLG-TEIKI-CHK               PIC 9(01).
           03  FLG-TAINDOUJITU             PIC 9(01).
           03  FLG-TAINTUSANMINUS          PIC 9(01).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX0                        PIC 9(05).
           03  IDX1                        PIC 9(05).
           03  IDX2                        PIC 9(05).
           03  IDX3                        PIC 9(05).
           03  IDX4                        PIC 9(05).
           03  IDX5                        PIC 9(05).
           03  IDX6                        PIC 9(05).
           03  IDX7                        PIC 9(05).
           03  IDX8                        PIC 9(05).
           03  IDX9                        PIC 9(05).
           03  IDX10                       PIC 9(05).
           03  IDX11                       PIC 9(05).
           03  IDX12                       PIC 9(05).
           03  IDX13                       PIC 9(05).
           03  IDX14                       PIC 9(05).
           03  IDX15                       PIC 9(05).
           03  IDX16                       PIC 9(05).
           03  IDX-CMB                     PIC 9(05).
           03  IDX-DAY                     PIC 9(02).
      *
      *    ¥«¥¦¥ó¥ÈÎÎ°è
       01  CNT-AREA.
           03  CNT-TUKISU          PIC 9(05).
      *
      *    ¥·¥¹¥Æ¥àÎÎ°è
       01  SYS-AREA.
           03  SYS-YMD     PIC X(08).
           03  SYS-TIME    PIC X(06).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-I0IDCD                  PIC X(04).
           03  WRK-I0ID-FLG                PIC X(02).
           03  WRK-I0IDMSG                 PIC X(80). 
           03  WRK-MOTOPG                  PIC X(08).
           03  WRK-YMD                     PIC X(10). 
           03  WRK-SYMD.
               05  WRK-SYY                 PIC 9(04).
               05  WRK-SMM                 PIC 9(02).
               05  WRK-SDD                 PIC 9(02).
           03  WRK-HENYMDG                 PIC X(09).
           03  WRK-KANACHK-MAE-INPUT       PIC X(400).
           03  WRK-KANACHK-OUT-INPUT       PIC X(400).
      *    ¥Ñ¥¹Ì¾ÎÎ°è
           03  WRK-DBPATH                  PIC X(20).
           03  WRK-CALC-YMD1.
               05  WRK-CALC-YY1            PIC 9(04).
               05  WRK-CALC-MM1            PIC 9(02).
               05  WRK-CALC-DD1            PIC 9(02).
      *
           03  WRK-CALC-YMD2.
               05  WRK-CALC-YY2            PIC 9(04).
               05  WRK-CALC-MM2            PIC 9(02).
               05  WRK-CALC-DD2            PIC 9(02).
           03  WRK-AGE-YY                  PIC S9(04).
           03  WRK-AGE-MM                  PIC S9(02).
           03  WRK-AGE-G.
               05  WRK-AGE-Z               PIC ---9.
               05  WRK-AGE-MEI             PIC X(04).
           03  WRK-BIRTHDAY                PIC X(08).
           03  WRK-COMBO.
               05  WRK-CMB-CD              PIC X(05).
               05  WRK-CMB-IDX             PIC 9(03).
               05  WRK-CMB-ITM             PIC X(100).
               05  WRK-CMB-ITM2            PIC X(100).
               05  WRK-CMB-ITM3            PIC X(100).
               05  WRK-CMB-ITM4            PIC X(100).
           03  WRK-CNT                     PIC 9(05).
           03  WRK-NUM-EDIT.
               05  WRK-99                  PIC 9(02).
               05  WRK-99999               PIC 9(05).
               05  WRK-999999              PIC 9(06).
               05  WRK-ZZ9                 PIC ZZ9.
               05  WRK-ZZZ9                PIC ZZZ9.
               05  WRK-ZZZZ9               PIC ZZZZ9.
               05  WRK-ZZZZZ9              PIC ZZZZZ9.
           03  WRK-SAGAKU.
               05  WRK-SAGAKU-NUM          PIC ZZZZ9.
               05  WRK-SAGAKU-EN           PIC X(02).
           03  WRK-STR1                    PIC X(20).
           03  WRK-STR2                    PIC X(20).
           03  WRK-IDX1                    PIC 9(05).
           03  WRK-IDX2                    PIC 9(05).
           03  WRK-BTUJYOHO-TBL.
               05  WRK-BTUJYOHO-CNT        PIC 9(05).
               05  WRK-BTUJYOHO-OCC        OCCURS  50
                                           INDEXED BY  WRK-BTUNUM-IDX.
                   07  WRK-BTUJY-BTUNUM    PIC X(02).
                   07  WRK-BTUJY-BRM-SAGAKU
                                           PIC X(02).
                   07  WRK-BTUJY-BRM-KA    PIC X(02).
           03  WRK-BRM-SAGAKU-CD           PIC X(02).
           03  WRK-BTU-KA-CD               PIC X(02).
           03  WRK-BRM-KA-CD               PIC X(02).
           03  WRK-HKNCOMBI                PIC X(100).
           03  WRK-FTNRATE                 PIC X(05).
           03  WRK-HKNKBN-MEI              PIC X(02).
           03  WRK-CREYMD                  PIC X(08).
           03  WRK-JTIKBN                  PIC X(01).
           03  WRK-RRKNUM                  PIC 9(03).
           03  WRK-RRKEDANUM               PIC 9(03).
           03  WRK-KJNYMD                  PIC X(08).
           03  WRK-KIHON-KJNYMD            PIC X(08).
           03  WRK-UPDKBN                  PIC X(3).
           03  WRK-TENNYUYMD               PIC X(08).
           03  WRK-TENSTUYMD               PIC X(08).
           03  WRK-BRMNUM                  PIC X(06).
           03  WRK-BRMNUM-IN               PIC X(06).
           03  WRK-BRMNUM-EDT              PIC X(06).
           03  WRK-BRMNUM-OT               PIC X(06).
           03  WRK-NYUINKA-KEY             PIC X(02).
           03  WRK-BTUNUM-KEY              PIC X(02).
           03  WRK-BRMNUM-KEY              PIC X(08).
           03  WRK-HKNCOMBI-KEY            PIC X(04).
           03  WRK-TOKUTEI-KEY.
               05  WRK-TOKUTEI-KBN-KEY     PIC X(01).
               05  WRK-TOKUTEI-NYUIN-KEY   PIC X(02).
      *
           03  WRK-REKI-BYOMEI-EDIT-AREA.
               05  WRK-REKI-BYOMEI-EDIT-OCC
                                           OCCURS 100
                                           INDEXED BY  WRK-RRKBYO-IDX.
                   07  WRK-REKI-BYO-ZITA-FLG   PIC 9(01).
                   07  WRK-REKI-BYO-NYUINKA    PIC X(02).
                   07  WRK-REKI-BYO-NYUINYMD   PIC X(08).
                   07  WRK-REKI-BYO-TAIINYMD   PIC X(08).
                   07  WRK-REKI-BYO-RENNUM     PIC 9(02).
                   07  WRK-REKI-BYO-SRYYMD     PIC X(08).
                   07  WRK-REKI-BYO-BYOMEI     PIC X(40).
                   07  WRK-REKI-BYO-TENKIKBN   PIC X(01).
           03  WRK-WIDGET-B07-STT              PIC S9(9)   BINARY.
           03  WRK-WIDGET-B08-STT              PIC S9(9)   BINARY.
           03  WRK-WIDGET-STT                  PIC S9(9)   BINARY.
           03  WRK-STYMD                       PIC X(08).
           03  WRK-EDYMD                       PIC X(08).
           03  WRK-NISSU                       PIC 9(05).
           03  WRK-NISSU1                      PIC 9(05).
           03  WRK-NISSU2                      PIC 9(05).
           03  WRK-TSUSAN                      PIC 9(05).
           03  WRK-NYUINNISSU                  PIC 9(05).
           03  WRK-SANTEISTYMD                 PIC X(08).
           03  WRK-SENTEI-STYMD                PIC X(08).
           03  WRK-BIRTHDAY-15                 PIC X(08).
           03  WRK-BIRTHDAY-15R   REDEFINES    WRK-BIRTHDAY-15.
               05  WRK-BIRTHDAY-15Y            PIC 9(04).
               05  WRK-BIRTHDAY-15MD           PIC 9(04).
           03  WRK-REKI-ZIIN-TBL.
               05  WRK-REKI-ZIIN-CNT           PIC 9(05).
               05  WRK-REKI-ZIIN-OCC           OCCURS  100.
                   07  WRK-REKI-ZIIN-NYUINYMD  PIC X(08).
                   07  WRK-REKI-ZIIN-TAIINYMD  PIC X(08).
           03  WRK-ZOGENPTN                PIC X(01).
           03  WRK-ZOGEN                   PIC S9(05).
           03  WRK-KEISANYMD               PIC X(08).
           03  WRK-HKNCOMBINUM             PIC X(04).
           03  WRK-HKNCOMBINUM9   REDEFINES  WRK-HKNCOMBINUM
                                           PIC 9(04).
           03  WRK-SHONUM                  PIC 9(03).
           03  WRK-SRYKAMEI                PIC X(30).
           03  WRK-TENKA-SRYKA-TBL.
               05  WRK-TENKA-SRYKA-CNT     PIC 9(05).
               05  WRK-TENKA-SRYKA         PIC X(02)
                                           OCCURS 50.
           03  WRK-SAGAKU-KBN              PIC X(02).
           03  WRK-SAGAKU-KBN9  REDEFINES  WRK-SAGAKU-KBN
                                           PIC 9(02).
           03  WRK-ZI-SAISIN-RRKNUM        PIC 9(03).
           03  WRK-ZI-SAISIN-RRKEDANUM     PIC 9(03).
           03  WRK-KANRICD                 PIC X(04).
           03  WRK-KBNCD                   PIC X(08).
           03  WRK-TOKNYUIN-NM             PIC X(60).
           03  WRK-TOKNYUIN-KBN            PIC X(01).
           03  WRK-TOKNYUIN-CD             PIC X(02).
           03  WRK-TAIHI-SRYKA             PIC X(02).
           03  WRK-NOW-SKYSTYMD            PIC X(08).
           03  WRK-SKYSTYM                 PIC X(06).
           03  WRK-SYU-SUM-IDX             PIC 9(05).
           03  WRK-TAIINUPDCNT             PIC 9(05).
      *
           03  WRK-MCP-WIDGET      PIC X(64).
           03  WRK-IDOYMD                  PIC X(08).
           03  WRK-NYUINYMD                PIC X(08).
           03  WRK-MAE-SKYEDYMD            PIC X(08).
           03  WRK-SKYSTYMD                PIC X(08).
           03  WRK-SKYEDYMD                PIC X(08).
           03  WRK-SKYMONEY                PIC  S9(07).
      *    °åÎÅµ¡´ØÀßÄê¤ÎÆþ±¡ÎÁ²Ã»»¥Á¥§¥Ã¥¯ÍÑ
           03  WRK-NYUKHNKSN-SRYCD         PIC X(09)  OCCURS 20.
           03  WRK-NYUKSNKBN               PIC X(03).
           03  WRK-BTU-NYUKSNKBN           PIC X(03).
           03  WRK-KSN-NYUKSNKBN           PIC X(03).
           03  WRK-STYUKYMD                PIC X(08).
           03  WRK-TAIINYMD.
               05  WRK-TAIINYM             PIC X(06).
               05  WRK-TAIINDD             PIC 9(02).
           03  WRK-MCP-PUTTYPE             PIC X(08).
           03  WRK-ORCHCN01-SYORIKBN       PIC X(01).
           03  WRK-ORCHCN01-PRTKBN         PIC X(01).
           03  WRK-AGECHK-SRYYMD           PIC X(08).
           03  WRK-NACCT-SRYYM             PIC X(08).
           03  WRK-PRINT-PG                PIC X(20).
           03  WRK-ORCSHKN-HKNCOMBINUM     PIC X(04).
           03  WRK-TOKUBETSU-NYUIN         PIC X(01).
      *    ²ñ·×ºîÀ®ÍÑÂàÈòÎÎ°è
           03  WRK-TAIHI-HKN               PIC 9(03).
           03  WRK-TAIHI-SHOKUJI           PIC 9(03).
           03  IDX-SHOKUJIX                PIC X(02).
           03  IDX-SHOKUJI9   REDEFINES    IDX-SHOKUJIX
                                           PIC 9(02).
           03  IDX-SKJ                     PIC 9(02).
           03  WRK-NYUINCHU-TAIINYMD       PIC X(08).
           03  WRK-ORCHCN01-HKNCOMBINUM    PIC 9(04).
           03  WRK-STIDX                   PIC 9(02).
           03  WRK-EDIDX                   PIC 9(02).
           03  WRK-MIN-YMD.
               05  WRK-MIN-YM              PIC X(06).
               05  WRK-MIN-DD              PIC 9(02).
      *    ÆÃÄêÆþ±¡ÎÁ¤Î²ñ·×ºîÀ®¸å¤Ë°ìÈÌ¤ÎÆþ±¡ÎÁ¤Ç²ñ·×¤òºîÀ®¤¹¤ë¤¿¤á¤Î
      *    ÎÎ°è
           03  IPN-NYUKAIKEI-SAKUSEI-FLG   PIC X(01).
           03  IPN-SANTEISTYMD             PIC X(08).
           03  WRK-IPN-HANTEI-YMD1.
               05  WRK-IPN-HANTEI-YM1.
                   07  WRK-IPN-HANTEI-Y1   PIC 9(04).
                   07  WRK-IPN-HANTEI-M1   PIC 9(02).
               05  WRK-IPN-HANTEI-D1       PIC 9(02).
           03  WRK-IPN-HANTEI-YMD2         PIC X(08).
      *    ÆÃÄêÆþ±¡ÎÁ¤Î²ñ·×ºîÀ®ÍÑ¤Ë¿ÇÎÅ¥³¡¼¥É¤òÂàÈò¤¹¤ëÎÎ°è
           03  WRK-TOKUTEI-SRYCD1          PIC X(09).
           03  WRK-TOKUTEI-SRYCD2          PIC X(09).
           03  WRK-SRYCD                   PIC X(09).
           03  WRK-SHOKAI-NYUINYMD-W       PIC X(10).
           03  WRK-CHK-SHONUM              PIC 9(03).
           03  WRK-I01-I04-PROCKBN         PIC X(01).
           03  WRK-FTN-NYUINYMD            PIC X(08).
           03  WRK-FTN-TAIINYMD            PIC X(08).
           03  WRK-FTN-DJKBN               PIC X(01).
           03  WRK-FTN-RRKNUM              PIC 9(03).
           03  WRK-NYUREKILST-SEL          PIC 9(05).
      *    Å¾²Ê¡¿Å¾Åï¡¿Å¾¼¼»þ¤Ë¿©»ö²ñ·×¤òÂàÈò¤¹¤ë¹àÌÜ¡ÊºÇÂç£²¥«·îÊ¬¡Ë
           03  WRK-TENROOM-SKJ-SRYYMX.
               05  WRK-TENROOM-SKJ-SRYYY9  PIC 9(04).
               05  WRK-TENROOM-SKJ-SRYMM9  PIC 9(02).
           03  WRK-TENROOM-SKJ-TABLE.
               05  WRK-TENROOM-SKJ-TBL     OCCURS  2.
                   07  WRK-TENROOM-SKJ-SRYYM
                                           PIC X(06).
                   07  WRK-TENROOM-SKJ-DD  PIC 9(02).
                   07  WRK-TENROOM-SKJ     PIC 9(03)  OCCURS  31.
           03  WRK-NAI-NYUINYMD.
               05  WRK-NAI-NYUINYM         PIC X(06).
               05  WRK-NAI-NYUINDD         PIC 9(02).
      *
      *    ´µ¼ÔÇ¯Îð»»½ÐÍÑ¥¨¥ê¥¢
       01  WRK-NENREI-AREA.
           03  WRK-NENREI                  PIC 9(03).
           03  WRK-YMDS1.
               05  WRK-YYS1                PIC 9(04).
               05  WRK-MMS1                PIC 9(02).
               05  WRK-DDS1                PIC 9(02).
           03  WRK-YMDS2.
               05  WRK-YYS2                PIC 9(04).
               05  WRK-MMS2                PIC 9(02).
               05  WRK-DDS2                PIC 9(02).
      *
      *    ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ¡ÊÅ¾²Ê¡¢Å¾Åï¡Ë·×»»¥¨¥ê¥¢
       01  TN-IDX                          PIC 9(02).
       01  WK-TOKUTEI-DAY                  PIC 9(04).
       01  WK-TOKUTEI-DAY2                 PIC 9(04).
      *
       01  WRK-ROW.
           03  WRK-NYUREKILST-ROW          PIC S9(9)   BINARY.
      *
       01  CONST-AREA.
           03  CONST-NYUREKILST-MAX        PIC 9(05)   VALUE   100.
           03  CONST-JOB-SHELLID           PIC X(08)   VALUE   "TEIKI1".
           03  CONST-JOB-JOBID             PIC 9(07)   VALUE   1.
      *
      *    ¥¹¥ÑÎÎ°è ¥ï¡¼¥¯
           COPY    "COMMON-SPA"      REPLACING
                               //SPA-// BY //WRK-SPA-//.
      *
      *    Æþ±¡ÍúÎò¥ï¡¼¥¯
       01  WKPTNYUINRRK-REC.
           COPY    "CPPTNYUINRRK.INC"  REPLACING
                               //PTNYUINRRK-// BY //WKPTNYUINRRK-//.
      *
      *    ¼ýÇ¼¥ï¡¼¥¯
       01  SUMSYUNOU-REC.
         02 SUMSYUNOU-CNT     PIC 9(05).
         02 SUMSYUNOU-OCC     OCCURS 13.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //SUMSYU-//.
         02 SUMSYUDAY-OCC     OCCURS 13.
           COPY  "CPSYUDAY.INC"    REPLACING  //SDAY-//
                                                       BY //SUMSDAY-//.
      *    ¼ýÇ¼¹ç·×¥ï¡¼¥¯
       01  TTLSYUNOU-REC.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //TTLSYU-//.
      *
      *    Äê´üÀÁµáÍúÎò½¸·×ÍÑ¥ï¡¼¥¯
       01  SUMTEIKIRRK-REC.
         02    SUMTEIKIRRK-MAX         PIC 9(05).
         02    SUMTEIKIRRK-OCC     OCCURS 50.
           COPY  "CPTEIKIRRK.INC"  REPLACING  //TEIKIRRK-//
                                           BY //SUMTEIKIRRK-//.
      *
      *    Âà±¡Æü¤ÎÆ±ÆüºÆÆþ±¡ÍÑ¥ï¡¼¥¯ÎÎ°è
       01  WRK-DOU-AREA.
           03  WRK-DOU-NAI-I01-NYUINYMD      PIC X(08).
           03  WRK-DOU-PTNYUINRRK-TENNYUYMD  PIC X(08).
           03  WRK-DOU-TENNYUYMD             PIC X(08).
           03  FLG-JIINRRK                   PIC 9(01).
       01  WRK-PTNYUINRRK-REC.
           COPY  "CPPTNYUINRRK.INC"  REPLACING  //PTNYUINRRK-//
                                            BY  //WRK-PTNYUINRRK-//.
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿
           COPY    "CPSYSKANRI.INC".
      *    ¡Ê¿ÇÎÅ²ÊÆþ±¡²Ê¾ðÊó¡Ë
           COPY    "CPSK1005.INC".
      *    ¡Ê¿¦°÷¾ðÊó¡Ë
           COPY    "CPSK1010.INC".
      *
      *    Ä¢É¼¥×¥í¥°¥é¥àÌ¾
           COPY    "CPSK1035.INC".
      *    ¡Ê°åÎÅµ¡´Ø¾ðÊó¡Ë
           COPY    "CPSK5000.INC".
      *    ¡ÊÉÂÅï¾ðÊó¡Ë
           COPY    "CPSK5001.INC".
      *    ¡ÊÉÂ¼¼¾ðÊó¡Ë
           COPY    "CPSK5002.INC".
      *    ¡Ê¼¼ÎÁº¹³Û¡Ë
           COPY    "CPSK5113.INC".
      *    ¡ÊÆÃÄêÆþ±¡ÎÁ¡ÝÉÂÅï¡Ë
           COPY    "CPSK5110.INC".
      *    ¡ÊÆÃÄêÆþ±¡ÎÁ¡ÝÉÂ¼¼¡Ë
           COPY    "CPSK5111.INC".
      *    
           COPY    "CPSK5013.INC".
      *
      *    ´µ¼Ô¥Þ¥¹¥¿
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    ´µ¼ÔÈÖ¹æ
       01  PTNUM-REC.
           COPY    "CPPTNUM.INC".
      *
      *    ´µ¼ÔÆþ±¡ÍúÎò
       01  PTNYUINRRK-REC.
           COPY    "CPPTNYUINRRK.INC".
      *
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    ´µ¼ÔÉÂÌ¾
       01  PTBYOMEI-REC.
           COPY    "CPPTBYOMEI.INC".
      *
      *    ´µ¼ÔÏ«ºÒÊÝ¸±¾ðÊó
       01  PTRSIINF-REC.
           COPY    "CPPTRSIINF.INC".
      *
      *    ´µ¼ÔÂ¾±¡ÎòÉÕ²Ã¾ðÊó
       01  PTTAINFUKA-REC.
           COPY    "CPPTTAINFUKA.INC".
      *
      *    ¼õÉÕ¥Þ¥¹¥¿
       01  UKETUKE-REC.
           COPY    "CPUKETUKE.INC".
      *
      *    ¼ýÇ¼¥Þ¥¹¥¿¡¼
       01  SYUNOU-REC.
           COPY    "CPSYUNOU.INC".
      *
      *    ¼ýÇ¼ÌÀºÙ¥Þ¥¹¥¿¡¼
       01  SYUMEI-REC.
           COPY    "CPSYUMEI.INC".
      *
      *    ¼õ¿ÇÍúÎò
       01  JYURRK-REC.
           COPY    "CPJYURRK.INC".
       01  WKJYURRK-REC.
           COPY    "CPJYURRK.INC"      REPLACING
                                       //JYURRK-// BY //WKJYURRK-//.
      *    Ï·¿Í°ìÈÌ¥³¡¼¥ÉÊÑ´¹
        01  SRYCDCHG-REC.
            COPY    "CPSRYCDCHG.INC".
      *
      *    ´µ¼ÔÄê´üÀÁµáÍúÎò
        01 PTTEIKIRRK-REC.
           COPY     "CPPTTEIKIRRK.INC".
      *
      *    Äê´üÀÁµáÍúÎò
        01 TEIKIRRK-REC.
           COPY     "CPTEIKIRRK.INC".
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¡Ý
      *01  TENSU-REC.
           COPY    "CPTENSU.INC".
      *
      *    Æþ±¡ÎÁ²Ã»»¥Á¥§¥Ã¥¯
       01  NYUKSNCHK-REC.
           COPY    "CPNYUKSNCHK.INC".
      *
      *    ¿ÇÎÅ²ñ·×
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    ÁªÄêÎÅÍÜÈñ
       01  SENTEICDCHG-REC.
           COPY    "CPSENTEICDCHG.INC".
      *
      *    Æþ±¡²ñ·×
       01  NYUINACCT-REC.
           COPY    "CPNYUINACCT.INC".
      *
      *    ´µ¼Ô¸øÈñ¾ðÊó
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *    ¥¸¥ç¥Ö´ÉÍý¥Þ¥¹¥¿
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑÎÎ°è
      *****************************************************************
      *
      *    Æ±ÆüÆþ±¡¥Á¥§¥Ã¥¯¥µ¥Ö
           COPY    "CPORCSDNTCHK.INC".
      *
       01  LNKNRRK-REC.
           COPY    "CPPTNYUINRRK.INC"  REPLACING  //PTNYUINRRK-// 
                                       BY         //LNKNRRK-//.
      *
      *    Æþ±¡ÅÐÏ¿¥µ¥Ö
           COPY    "CPI0SUB01.INC".
      *
      *    ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
           COPY    "CPORCSGDAY.INC".
      *
      *    ´µ¼ÔÈÖ¹æÊÑ´¹¥µ¥Ö
           COPY    "CPORCSPTNUM.INC".
      *
      *    ¿ôÃÍ¹æÊÑ´¹¥µ¥Ö
           COPY    "CPORCSNUM.INC".
      *
      *    Á´³Ñ¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿
           COPY    "CPORCSKANACHK.INC".
      *
      *    ½é´ü²Ã»»»»Äê¥µ¥Ö
           COPY    "CPORCSSYOKIKSN.INC".
      *
      *    Æþ±¡²ñ·×ºîÀ®¥µ¥Ö
           COPY    "CPORCSNYUACCT.INC".
      *
      *    ÉéÃ´¶â·×»»¥µ¥Ö
       01  LNK-ORCS02-REC.
           COPY  "CPORCS02.INC".
       01  LNK-SYUNOU-REC-T.
         02 LNK-SYUNOU-REC     OCCURS 10.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //LNK-SYU-//.
       01  LNK-SYUDAY-REC-T.
         02 LNK-SYUDAY-REC     OCCURS 10.
           COPY  "CPSYUDAY.INC"  REPLACING  //SDAY-// BY //LNK-SDAY-//.
      *
      *    ÄÌ»»Æü¿ô¼èÆÀ¥µ¥Ö
           COPY "CPORCSTUSAN.INC".
      *
      *    ÇÓÂ¾À©¸æ¥µ¥Ö¥Ñ¥é¥á¥¿
           COPY    "CPORCSLOCK.INC".
      *
      *    Æþ±¡¥«¥ë¥Æ
           COPY    "CPORCHCN01.INC".
      *
      *    ÊÝ¸±»»ÄêÍÑÇ¯Îð¡¦³ä¹ç·×»»¥µ¥Ö
           COPY    "CPORCSAGECHK.INC".
      *
      *    ÊÝ¸±ÁÈ¹ç¤»ÊÔ½¸¥µ¥Ö
           COPY    "CPORCSHKNSET.INC".
      *
      *    ¥ª¥ó¥é¥¤¥óÄ¢É¼Ì¾¡¦½ÐÎÏÀè¥×¥ê¥ó¥¿Ì¾¼èÆÀ¥Ñ¥é
           COPY    "CPORCSPRTNM.INC".
      *
      *   ¥¸¥ç¥Ö´ÉÍý£Ä£ÂÀ©¸æ¥µ¥Ö
           COPY    "CPORCSJOBKANRI.INC".
      *
      *    ÆüÊó¥­¡¼¼èÆÀ¥µ¥Ö
           COPY "CPORCSDAILYKEY.INC".
      *
      *    ¥Þ¥·¥óÆüÉÕ¼èÆÀ¥µ¥Ö
           COPY    "CPORCSMCNDATE.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
           COPY    "CPORCMCP.INC".
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
      *
        LINKAGE                     SECTION.
      *
      *     ¥Æ¡¼¥Ö¥ë¥¢¥¯¥»¥¹
           COPY    "MCPAREA".
           COPY    "ORCA-SPA".
      *
           COPY    "LINKAREA".
      *
       01  SCRAREA.
           COPY    "I01.INC".
           COPY    "I02.INC".
           COPY    "I03.INC".
           COPY    "I04.INC".
           COPY    "I05.INC".
           COPY    "I06.INC".
           COPY    "I0ERR.INC".
           COPY    "I0ID1.INC".
           COPY    "I0ID2.INC".
      *
      *
       PROCEDURE                   DIVISION    USING
                                               MCPAREA
                                               SPAAREA
                                               LINKAREA
                                               SCRAREA.
      *****************************************************************
      *    ¼ç    ½è    Íý
      *****************************************************************
      *
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  IDX-AREA
           INITIALIZE                  WRK-AREA
           INITIALIZE                  CNT-AREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA.
           MOVE    SPA-FREE        TO  SPA-I0FREE.
           MOVE    SPA-WORK        TO  SPA-I0KYOUTU
      *
           MOVE    SPACE           TO  SPA-ERRCD.
           MOVE    ZERO            TO  FLG-END.
      *
           EVALUATE    MCP-STATUS      ALSO    MCP-EVENT
               WHEN    "LINK"          ALSO    ANY
                   PERFORM 100-INIT-SEC
      *    ²èÌÌÁ«°Ü
               WHEN    "PUTG"          ALSO   "CLICKED"
                   PERFORM 200-GMNSENI
      *    ÆþÎÏ
               WHEN      OTHER
                   PERFORM 200-ENTRY
           END-EVALUATE.
      *
      *    ²èÌÌÁ«°Ü¤¬¤Ê¤¤»þ¡¢²èÌÌÉ½¼¨¤Ø
           IF  FLG-END   =   ZERO
               PERFORM 500-SET-SCREEN
           END-IF.
      *
           MOVE    SPA-I0KYOUTU    TO  SPA-WORK
           MOVE    SPA-AREA        TO  SPA-COMMON.
           MOVE    SPA-I0FREE      TO  SPA-FREE
           .
      *
       000-PROC-SEC-EXT.
           EXIT    PROGRAM.
      *
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                   SECTION.
      *
      *    ¥¨¥é¡¼²èÌÌ¤è¤ê
           IF    ( SPA-MOTOPG          =   "I0ERR" )
               MOVE    SPACE           TO  SPA-MOTOPG
               PERFORM 5001-MAPCUR-SEC
           ELSE
      *        ½é´ü²èÌÌ¥»¥Ã¥È
               PERFORM 300-SCREEN-SEC
               IF    ( FLG-END         =   1 )
                   GO  TO  100-INIT-EXT
               END-IF 
      *
      *        ²èÌÌÊÔ½¸
               PERFORM 500-GMNHEN-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   PERFORM 510-ERRSET-SEC
                   GO  TO  100-INIT-EXT
               END-IF
      *
               IF    ( SPA-I0IDCD  NOT =   SPACE )
                   PERFORM 520-I0IDSET-SEC
                   GO  TO  100-INIT-EXT
               END-IF
      *
               IF    ( SPA-I0IDCD2 NOT =   SPACE )
                   PERFORM 520-I0IDSET-SEC
                   GO  TO  100-INIT-EXT
               END-IF
      *
           END-IF
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    SPACE               TO  MCP-PUTTYPE
           MOVE    "I01"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
           .
      *
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é´ü²èÌÌ½èÍý
      *****************************************************************
       300-SCREEN-SEC              SECTION.
      *
      *    Â¾¤Î£Ì£Ä¤è¤ê
           IF    ( LINKAREA        NOT =   SPACE )
               MOVE    LNK-KYOUTU          TO  SPA-KYOUTU
               MOVE    SPA-MOTOPG          TO  WRK-MOTOPG
      *
               IF      WRK-MOTOPG(1:3)     =   "P97"
                   MOVE    LNK-COMMON      TO  SPA-KYOUTU
                   MOVE    LNK-SCRSPA      TO  SPA-I01
                   MOVE    SPA-WORK        TO  SPA-I0KYOUTU
                   MOVE    1               TO  SPA-GMN-I01-CUR
               END-IF
      *
               IF      WRK-MOTOPG(1:3)     =   "P97"
                   PERFORM 330-P97-SET-SEC
                   GO  TO  300-SCREEN-EXT
               END-IF
           END-IF
      *
           EVALUATE    SPA-MOTOPG
      *
      *    ³ÎÇ§²èÌÌ
           WHEN    "I0ID1"
               PERFORM 330-I0ID1-SET-SEC
      *
               GO  TO      300-SCREEN-EXT
      *
      *
      *    ³ÎÇ§²èÌÌ£²
           WHEN    "I0ID2"
               PERFORM 330-I0ID2-SET-SEC
      *
               GO  TO      300-SCREEN-EXT
      *
      *    Æþ±¡ÎòÉ½¼¨²èÌÌ
           WHEN    "I02"
               PERFORM 330-I02-SET-SEC
               GO  TO      300-SCREEN-EXT
      *
      *    Æþ±¡ÎòºîÀ®²èÌÌ
           WHEN    "I03"
               PERFORM 330-I03-SET-SEC
               GO  TO      300-SCREEN-EXT
      *
      *    ÀÁµá³ÎÇ§²èÌÌ
           WHEN    "I04"
               IF    ( SPA-I01-I04-BTN =   "B12" )
      *            ²èÌÌ¤ò¹¹¿·¸å¤ÎÆâÍÆ¤ÇºÆÉ½¼¨
                   PERFORM 4101-PTNUM-CHK-SEC
               ELSE
                   IF    ( SPA-I01-I04-PROCKBN =   "1" )
      *                ¥«¡¼¥½¥ë¤òÂà±¡Æü¤ËÀßÄê
                       MOVE    11          TO  SPA-GMN-I01-CUR
                   ELSE
      *                ¥«¡¼¥½¥ë¤òÁªÂòÈÖ¹æ¤ËÀßÄê
                       MOVE    100         TO  SPA-GMN-I01-CUR
                   END-IF
               END-IF
      *
               GO  TO      300-SCREEN-EXT
      *
      *    ¼ýÇ¼ÅÐÏ¿¡¦Æþ±¡²ñ·×¾È²ñ²èÌÌ
           WHEN    "S02"
           WHEN    "I41"
      *
      *        ÂàÈò¤·¤Æ¤ª¤¤¤¿£Ó£Ð£Á¤ÎÆâÍÆ¤ò¸µ¤ËÌá¤¹
               INITIALIZE                  I0SUB01-LNK
               MOVE    SPA-TERMID      TO  I0SUB01-TERMID
               MOVE    "I"             TO  I0SUB01-KBN
               CALL    "ORCGI0SUB01"   USING   I0SUB01-LNK
      *
               MOVE    I0SUB01-SCRSPA-AREA
                                       TO  SPA-I0FREE
               MOVE    I0SUB01-COMMON  TO  SPA-I0KYOUTU
      *
               GO  TO  300-SCREEN-EXT
      *    ´µ¼ÔÅÐÏ¿²èÌÌ
           WHEN    "P02"
      *        ÂàÈò¤·¤Æ¤ª¤¤¤¿£Ó£Ð£Á¤ÎÆâÍÆ¤ò¸µ¤ËÌá¤¹
               INITIALIZE                  I0SUB01-LNK
               MOVE    SPA-TERMID      TO  I0SUB01-TERMID
               MOVE    "I"             TO  I0SUB01-KBN
               CALL    "ORCGI0SUB01"   USING   I0SUB01-LNK
      *
               MOVE    I0SUB01-SCRSPA-AREA
                                       TO  SPA-I0FREE
               MOVE    I0SUB01-COMMON  TO  SPA-I0KYOUTU
      *
               PERFORM 330-P02-SET-SEC
      *
               GO  TO  300-SCREEN-EXT
      *
      *    Æþ±¡´µ¼Ô¾È²ñ²èÌÌ
           WHEN    "I20"
      *    ¿ÇÎÅ¹Ô°Ù²èÌÌ
           WHEN    "K02N"
      *
               PERFORM 310-SPASET-SEC
               MOVE    SPA-MOTOPG      TO  SPA-I0-MOTOPG
      *
               MOVE    SPA-PTID        TO  SPA-NAI-I01-PTID
               MOVE    SPA-PTNUM       TO  SPA-GMN-I01-PTNUM
               PERFORM 4101-PTINF-SELECT-SEC
               IF    ( SPA-ERRCD   =   SPACE )
      *            ¾È²ñ¤È¤·¤ÆÉ½¼¨
                   MOVE    SPA-GMN-I01-B07-STT
                                   TO  WRK-WIDGET-B07-STT
                   MOVE    SPA-GMN-I01-B08-STT
                                   TO  WRK-WIDGET-B08-STT
                   MOVE    "04"        TO  WRK-CMB-CD
                   PERFORM 4103-CMB-SYORIKBN-SRH-SEC
                   MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-SYORIKBN
                   PERFORM 4201-WIDGET-INSENSITIVE-SEC
                   MOVE    WRK-WIDGET-B07-STT
                                   TO  SPA-GMN-I01-B07-STT
                   MOVE    WRK-WIDGET-B08-STT
                                   TO  SPA-GMN-I01-B08-STT
               END-IF
      *
               INITIALIZE                  SPA-ERRCD
                                           SPA-I0IDCD
                                           SPA-I0IDCD2
               GO  TO  300-SCREEN-EXT
           END-EVALUATE
      *
           PERFORM 310-SPASET-SEC
      *
           .
       300-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¹¥Ñ½é´üÊÔ½¸½èÍý
      *****************************************************************
       310-SPASET-SEC              SECTION.
      *
      *    Æþ³°¶èÊ¬
           MOVE    "1"             TO  SPA-NYUGAIKBN
      *
           INITIALIZE              I01
                                   SPA-I0FREE
                                   SPA-I0KYOUTU
      *
      *    ¥³¥ó¥Ü¥Ü¥Ã¥¯¥¹½é´ü²½
           MOVE    SPA-SYSYMD      TO  WRK-KJNYMD
           PERFORM 310-CMB-SYOKI-SEC
      *
      *    ½èÍý¶èÊ¬¥³¥ó¥Ü¡ÊÁ´¤ÆÉ½¼¨¡Ë
           PERFORM 310-CMB-SYORIKBN-SET1-SEC
      *
      *    ²èÌÌ½é´ü²½
           PERFORM 420-CLEAR-SEC
      *
      *
           .
       310-SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥³¥ó¥Ü¥Ü¥Ã¥¯¥¹½é´ü½èÍý
      *****************************************************************
       310-CMB-SYOKI-SEC               SECTION.
      *
      *    INITIALIZE              SPA-GMN-I01-CMB-DAT-AREA
      *
      *    ¼¼ÎÁº¹³Û¥³¥ó¥Ü
           PERFORM 310-CMB-SAGAKU-SET-SEC
      *
      *    Æþ±¡²Ê¥³¥ó¥Ü
           PERFORM 310-CMB-NYUINKA-SET-SEC
      *
      *    Âà±¡»öÍ³¥³¥ó¥Ü
           PERFORM 310-CMB-TAIINCD-SET-SEC
      *
      *    ½é²ó¥³¥ó¥Ü
           PERFORM 310-CMB-SHOKAI-SET-SEC
      *
      *    Ã´Åö°å¥³¥ó¥Ü
           PERFORM 310-CMB-DR-SET-SEC
      *
      *    Äê´üÀÁµá¥³¥ó¥Ü
           PERFORM 310-CMB-SEIKYU-SET-SEC
      *
      *    ¸¡º÷»þ´µ¼ÔÉ½¼¨¥³¥ó¥Ü
           PERFORM 310-CMB-DISPKBN-SET-SEC
      *
           .
       310-CMB-SYOKI-EXT.
           EXIT.
      *****************************************************************
      *    ½èÍý¶èÊ¬¥³¥ó¥Ü½é´ü½èÍý¡ÊÁ´¤ÆÉ½¼¨¡Ë
      *****************************************************************
       310-CMB-SYORIKBN-SET1-SEC       SECTION.
      *
           INITIALIZE              SPA-GMN-I01-CMB-SYORIKBN
      *
           MOVE    10              TO  SPA-GMN-I01-SYORIKBN-CNT
      *
           MOVE    "01 Æþ±¡ÅÐÏ¿"   TO  SPA-GMN-I01-SYORIKBN-ITM (01)
           MOVE    "02 Âà±¡ÅÐÏ¿"   TO  SPA-GMN-I01-SYORIKBN-ITM (02)
           MOVE    "03 ÊÑ¹¹"       TO  SPA-GMN-I01-SYORIKBN-ITM (03)
           MOVE    "04 ¾È²ñ"       TO  SPA-GMN-I01-SYORIKBN-ITM (04)
           MOVE    "05 Æþ±¡¼è¾Ã"   TO  SPA-GMN-I01-SYORIKBN-ITM (05)
           MOVE    "06 Æþ±¡¼è¾Ã¡Ê²ñ·×´Þ¤à¡Ë"
                                   TO  SPA-GMN-I01-SYORIKBN-ITM (06)
           MOVE    "07 Âà±¡¼è¾Ã"   TO  SPA-GMN-I01-SYORIKBN-ITM (07)
           MOVE    "08 Å¾²Ê¡¡Å¾Åï¡¡Å¾¼¼"
                                   TO  SPA-GMN-I01-SYORIKBN-ITM (08)
           MOVE    "09 °ÛÆ°¼è¾Ã"   TO  SPA-GMN-I01-SYORIKBN-ITM (09)
           MOVE    "10 Âà±¡ºÆ·×»»" TO  SPA-GMN-I01-SYORIKBN-ITM (10)
      *
      *
           .
       310-CMB-SYORIKBN-SET1-EXT.
           EXIT.
      *****************************************************************
      *    ½èÍý¶èÊ¬¥³¥ó¥Ü½é´ü½èÍý¡Ê½éÆþ±¡¡Ë
      *****************************************************************
       310-CMB-SYORIKBN-SET2-SEC       SECTION.
      *
           INITIALIZE              SPA-GMN-I01-CMB-SYORIKBN
      *
           MOVE    1               TO  SPA-GMN-I01-SYORIKBN-CNT
           MOVE    "01 Æþ±¡ÅÐÏ¿"   TO  SPA-GMN-I01-SYORIKBN-ITM (01)
      *
      *    Âà±¡ÍúÎò¥Á¥§¥Ã¥¯
           PERFORM 3101-TAIINRRK-CHK-SEC
      *
           .
       310-CMB-SYORIKBN-SET2-EXT.
           EXIT.
      *****************************************************************
      *    ½èÍý¶èÊ¬¥³¥ó¥Ü½é´ü½èÍý¡ÊÆþ±¡Ãæ¡Ë
      *****************************************************************
       310-CMB-SYORIKBN-SET3-SEC       SECTION.
      *
           INITIALIZE              SPA-GMN-I01-CMB-SYORIKBN
      *
           MOVE    6               TO  SPA-GMN-I01-SYORIKBN-CNT
      *
           MOVE    "02 Âà±¡ÅÐÏ¿"   TO  SPA-GMN-I01-SYORIKBN-ITM (01)
           MOVE    "03 ÊÑ¹¹"       TO  SPA-GMN-I01-SYORIKBN-ITM (02)
           MOVE    "04 ¾È²ñ"       TO  SPA-GMN-I01-SYORIKBN-ITM (03)
           MOVE    "05 Æþ±¡¼è¾Ã"   TO  SPA-GMN-I01-SYORIKBN-ITM (04)
           MOVE    "06 Æþ±¡¼è¾Ã¡Ê²ñ·×´Þ¤à¡Ë"
                                   TO  SPA-GMN-I01-SYORIKBN-ITM (05)
           MOVE    "08 Å¾²Ê¡¡Å¾Åï¡¡Å¾¼¼"
                                   TO  SPA-GMN-I01-SYORIKBN-ITM (06)
      *
      *    Âà±¡ÍúÎò¥Á¥§¥Ã¥¯
           PERFORM 3101-TAIINRRK-CHK-SEC
      *
           .
       310-CMB-SYORIKBN-SET3-EXT.
           EXIT.
      *****************************************************************
      *    ½èÍý¶èÊ¬¥³¥ó¥Ü½é´ü½èÍý¡ÊÆþ±¡Îò¤¢¤ê¡ÝÂà±¡ºÑ¡Ë
      *****************************************************************
       310-CMB-SYORIKBN-SET4-SEC       SECTION.
      *
           INITIALIZE              SPA-GMN-I01-CMB-SYORIKBN
      *
           MOVE    3               TO  SPA-GMN-I01-SYORIKBN-CNT
      *
           MOVE    "01 Æþ±¡ÅÐÏ¿"   TO  SPA-GMN-I01-SYORIKBN-ITM (01)
           MOVE    "04 ¾È²ñ"       TO  SPA-GMN-I01-SYORIKBN-ITM (02)
           MOVE    "07 Âà±¡¼è¾Ã"   TO  SPA-GMN-I01-SYORIKBN-ITM (03)
      *
      *    Âà±¡ÍúÎò¥Á¥§¥Ã¥¯
           PERFORM 3101-TAIINRRK-CHK-SEC
      *
           .
       310-CMB-SYORIKBN-SET4-EXT.
           EXIT.
      *****************************************************************
      *    ½èÍý¶èÊ¬¥³¥ó¥Ü½é´ü½èÍý¡ÊÁ°²óÆþ±¡ÎòºîÀ®¡Ë
      *****************************************************************
       310-CMB-SYORIKBN-SET5-SEC       SECTION.
      *
           INITIALIZE              SPA-GMN-I01-CMB-SYORIKBN
      *
           MOVE    2               TO  SPA-GMN-I01-SYORIKBN-CNT
      *
           MOVE    "01 Æþ±¡ÅÐÏ¿"   TO  SPA-GMN-I01-SYORIKBN-ITM (01)
           MOVE    "04 ¾È²ñ"       TO  SPA-GMN-I01-SYORIKBN-ITM (02)
      *
      *    Âà±¡ÍúÎò¥Á¥§¥Ã¥¯
           PERFORM 3101-TAIINRRK-CHK-SEC
      *
      *
           .
       310-CMB-SYORIKBN-SET5-EXT.
           EXIT.
      *****************************************************************
      *    ½èÍý¶èÊ¬¥³¥ó¥Ü½é´ü½èÍý¡ÊÆþ±¡Ãæ¡Ë
      *****************************************************************
       310-CMB-SYORIKBN-SET6-SEC       SECTION.
      *
           INITIALIZE              SPA-GMN-I01-CMB-SYORIKBN
      *
           MOVE    7               TO  SPA-GMN-I01-SYORIKBN-CNT
      *
           MOVE    "02 Âà±¡ÅÐÏ¿"   TO  SPA-GMN-I01-SYORIKBN-ITM (01)
           MOVE    "03 ÊÑ¹¹"       TO  SPA-GMN-I01-SYORIKBN-ITM (02)
           MOVE    "04 ¾È²ñ"       TO  SPA-GMN-I01-SYORIKBN-ITM (03)
           MOVE    "05 Æþ±¡¼è¾Ã"   TO  SPA-GMN-I01-SYORIKBN-ITM (04)
           MOVE    "06 Æþ±¡¼è¾Ã¡Ê²ñ·×´Þ¤à¡Ë"
                                   TO  SPA-GMN-I01-SYORIKBN-ITM (05)
           MOVE    "08 Å¾²Ê¡¡Å¾Åï¡¡Å¾¼¼"
                                   TO  SPA-GMN-I01-SYORIKBN-ITM (06)
           MOVE    "09 °ÛÆ°¼è¾Ã"   TO  SPA-GMN-I01-SYORIKBN-ITM (07)
      *
      *    Âà±¡ÍúÎò¥Á¥§¥Ã¥¯
           PERFORM 3101-TAIINRRK-CHK-SEC
      *
           .
       310-CMB-SYORIKBN-SET6-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡ÍúÎò¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       3101-TAIINRRK-CHK-SEC           SECTION.
      *
           MOVE    ZERO                TO  FLG-TAIINRRK
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   SPA-GMN-I01-NYUREKILST-CNT )
                    OR   ( FLG-TAIINRRK    NOT =   ZERO )
      *
               IF    ( SPA-NAI-I01-TZITA-FLG (IDX0)      =   ZERO )
                AND  ( SPA-NAI-I01-TTAIINYMD (IDX0)  NOT =   SPACE )
                   MOVE    1           TO  FLG-TAIINRRK
               END-IF
      *
           END-PERFORM
      *
           IF    ( FLG-TAIINRRK    NOT =   ZERO )
               COMPUTE SPA-GMN-I01-SYORIKBN-CNT
                   =   SPA-GMN-I01-SYORIKBN-CNT
                   +   1
               MOVE    "10 Âà±¡ºÆ·×»»" TO  SPA-GMN-I01-SYORIKBN-ITM
                                            (SPA-GMN-I01-SYORIKBN-CNT)
           END-IF
      *
           .
       3101-TAIINRRK-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¼¼ÎÁº¹³Û¥³¥ó¥Ü½é´ü½èÍý
      *****************************************************************
       310-CMB-SAGAKU-SET-SEC          SECTION.
      *
           INITIALIZE              SPA-GMN-I01-CMB-SAGAKU
      *
           INITIALIZE                  SYSKANRI-REC
           MOVE    "5113"          TO  SYS-KANRICD
           MOVE    WRK-KJNYMD      TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¸¡º÷½èÍý
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1            >   30 )
                   OR    ( FLG-DBRC    NOT =   ZERO )
      *
               MOVE    MCPDATA-REC TO  SYS-5113-REC
      *
               MOVE    IDX1    TO  SPA-GMN-I01-SAGAKU-CNT
               MOVE    SYS-5113-KBNCD (1 : 2)
                           TO  SPA-GMN-I01-SAGAKU-ITM  (IDX1)(1 : 2)
               MOVE    SYS-5113-BRM-SAGAKU-NM
                           TO  WRK-99999
               MOVE    WRK-99999
                               TO  WRK-SAGAKU-NUM
               MOVE    "±ß"    TO  WRK-SAGAKU-EN
               MOVE    WRK-SAGAKU
                           TO  SPA-GMN-I01-SAGAKU-ITM  (IDX1)(4 : )
      *
      *        ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¹þ½èÍý
               MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¥¯¥í¡¼¥º½èÍý
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       310-CMB-SAGAKU-SET-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²Ê¥³¥ó¥Ü½é´ü½èÍý
      *****************************************************************
       310-CMB-NYUINKA-SET-SEC         SECTION.
      *
           INITIALIZE                  SPA-GMN-I01-CMB-NYUINKA
      *
           INITIALIZE                  SYSKANRI-REC
           MOVE    "1005"          TO  SYS-KANRICD
           MOVE    WRK-KJNYMD      TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¸¡º÷½èÍý
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1            >   99 )
                   OR    ( FLG-DBRC    NOT =   ZERO )
      *
               MOVE    MCPDATA-REC TO  SYS-1005-REC
      *
               MOVE    IDX1    TO  SPA-GMN-I01-NYUINKA-CNT
               MOVE    SYS-1005-KBNCD (1 : 2)
                           TO  SPA-GMN-I01-NYUINKA-ITM (IDX1)(1 : 2)
               MOVE    SYS-1005-SRYKANAME
                           TO  SPA-GMN-I01-NYUINKA-ITM (IDX1)(4 : )
      *
      *        ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¹þ½èÍý
               MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¥¯¥í¡¼¥º½èÍý
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       310-CMB-NYUINKA-SET-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡»öÍ³¥³¥ó¥Ü½é´ü½èÍý
      *****************************************************************
       310-CMB-TAIINCD-SET-SEC         SECTION.
      *
           INITIALIZE                  SPA-GMN-I01-CMB-TAIINCD
      *
           INITIALIZE                  SYSKANRI-REC
           MOVE    "5013"          TO  SYS-KANRICD
           MOVE    WRK-KJNYMD      TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¸¡º÷½èÍý
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1            >   50 )
                   OR    ( FLG-DBRC    NOT =   ZERO )
      *
               MOVE    MCPDATA-REC TO  SYS-5013-REC
      *
               MOVE    IDX1    TO  SPA-GMN-I01-TAIINCD-CNT
               MOVE    SYS-5013-KBNCD (1 : 2)
                           TO  SPA-GMN-I01-TAIINCD-ITM (IDX1)(1 : 2)
               MOVE    SYS-5013-NAME
                           TO  SPA-GMN-I01-TAIINCD-ITM (IDX1)(4 : )
      *
      *        ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¹þ½èÍý
               MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¥¯¥í¡¼¥º½èÍý
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       310-CMB-TAIINCD-SET-EXT.
           EXIT.
      *****************************************************************
      *    ½é²ó¥³¥ó¥Ü½é´ü½èÍý
      *****************************************************************
       310-CMB-SHOKAI-SET-SEC          SECTION.
      *
           INITIALIZE                  SPA-GMN-I01-CMB-SHOKAI
      *
           MOVE    2                   TO  SPA-GMN-I01-SHOKAI-CNT
      *
           MOVE    "1 ½é²ó"            TO  SPA-GMN-I01-SHOKAI-ITM (01)
           MOVE    "2 ·ÑÂ³"            TO  SPA-GMN-I01-SHOKAI-ITM (02)
      *
           .
       310-CMB-SHOKAI-SET-EXT.
           EXIT.
      *****************************************************************
      *    Ã´Åö°å¥³¥ó¥Ü½é´ü½èÍý
      *****************************************************************
       310-CMB-DR-SET-SEC              SECTION.
      *
           INITIALIZE                  SPA-GMN-I01-CMB-DR
      *
           INITIALIZE                  SYSKANRI-REC
           MOVE    "1010"          TO  SYS-KANRICD
           MOVE    "1"             TO  SYS-KBNCD
           MOVE    WRK-KJNYMD      TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¸¡º÷½èÍý
           MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1            >   50 )
                   OR    ( FLG-DBRC    NOT =   ZERO )
      *
               MOVE    MCPDATA-REC TO  SYS-1010-REC
      *
               MOVE    IDX1    TO  SPA-GMN-I01-DR-CNT (1)
               MOVE    SYS-1010-KBNCD (2 : 4)
                           TO  SPA-GMN-I01-DR-ITM(1 IDX1)(1 : 4)
               MOVE    SYS-1010-NAME
                           TO  SPA-GMN-I01-DR-ITM(1 IDX1)(6 : )
      *
      *        ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¹þ½èÍý
               MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¥¯¥í¡¼¥º½èÍý
           MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           MOVE    SPA-GMN-I01-CMB-DR-OCC (1)
                                       TO  SPA-GMN-I01-CMB-DR-OCC (2)
                                           SPA-GMN-I01-CMB-DR-OCC (3)
      *
           .
       310-CMB-DR-SET-EXT.
           EXIT.
      *****************************************************************
      *    Äê´üÀÁµá¥³¥ó¥Ü½é´ü½èÍý
      *****************************************************************
       310-CMB-SEIKYU-SET-SEC          SECTION.
      *
           INITIALIZE                  SPA-GMN-I01-CMB-SEIKYU
      *
           MOVE    2               TO  SPA-GMN-I01-SEIKYU-CNT
      *
           MOVE    "1 °åÎÅµ¡´Ø¤Ç¤ÎÀßÄê"
                                   TO  SPA-GMN-I01-SEIKYU-ITM (01)
           MOVE    "2 ·îËö»þ¤Î¤ßÀÁµá  "
                                   TO  SPA-GMN-I01-SEIKYU-ITM (02)
      *
      *
           .
       310-CMB-SEIKYU-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¸¡º÷»þ´µ¼ÔÉ½¼¨¥³¥ó¥Ü½é´ü½èÍý
      *****************************************************************
       310-CMB-DISPKBN-SET-SEC         SECTION.
      *
           INITIALIZE                  SPA-GMN-I01-CMB-DISPKBN
      *
           MOVE    2               TO  SPA-GMN-I01-DISPKBN-CNT
      *
           MOVE    "1 É½¼¨²Ä  "    TO  SPA-GMN-I01-DISPKBN-ITM (1)
           MOVE    "2 É½¼¨ÉÔ²Ä"    TO  SPA-GMN-I01-DISPKBN-ITM (2)
      *
      *
           .
       310-CMB-DISPKBN-SET-EXT.
           EXIT.
      *****************************************************************
      *    »áÌ¾¸¡º÷²èÌÌ¡Ê£Ð£¹£·¡Ë¤«¤é¤ÎÌá¤êÃÍÀßÄê½èÍý
      *****************************************************************
       330-P97-SET-SEC                 SECTION.
      *
           MOVE    LNK-KYOUTU          TO  WRK-SPA-KYOUTU
      *
      *    ¿Í¤¬Áª¤Ð¤ì¤Ê¤«¤Ã¤¿¾ì¹ç¡¢
      *    Æ±°ì¤Î¿Í¤¬ÁªÂò¤µ¤ì¤¿¾ì¹ç¤Ï¡¢²èÌÌÆâÍÆ¤ÎÊÑ¹¹¤Ï¹Ô¤ï¤Ê¤¤
           IF    ( WRK-SPA-PTID    =   ZERO )
             OR  ( WRK-SPA-PTID    =   SPA-NAI-I01-PTID )
               GO  TO  330-P97-SET-EXT
           END-IF
      *
      *    ²èÌÌ½é´ü²½
           PERFORM 420-CLEAR-SEC
      *
           MOVE    WRK-SPA-PTID        TO  SPA-NAI-I01-PTID 
           MOVE    WRK-SPA-PTNUM       TO  SPA-GMN-I01-PTNUM
      *
           PERFORM 4101-PTINF-SELECT-SEC
      *
           .
       330-P97-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼ÔÅÐÏ¿²èÌÌ¡Ê£Ð£°£²¡Ë¤«¤é¤ÎÌá¤êÃÍÀßÄê½èÍý
      *****************************************************************
       330-P02-SET-SEC                 SECTION.
      *
           IF    ( SPA-ERRMSG(1:2)     =   "NO" )
      *        Ìá¤ë
               IF      SPA-PTNUM(1:1)     =   "*"
      *            ²èÌÌ½é´ü²½
                   PERFORM 420-CLEAR-SEC
               END-IF
               GO  TO  330-P02-SET-EXT
           END-IF
      *
           IF    ( SPA-PTID            =   ZERO )
      *        ²èÌÌ½é´ü²½
               PERFORM 420-CLEAR-SEC
               GO  TO  330-P02-SET-EXT
           END-IF
      *
           MOVE    SPA-PTID            TO  SPA-NAI-I01-PTID
           MOVE    SPA-PTNUM           TO  SPA-GMN-I01-PTNUM
      *
           PERFORM 4101-PTINF-SELECT-SEC
      *
           .
       330-P02-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³ÎÇ§²èÌÌ¡Ê£É£°£É£Ä£±¡Ë¤«¤é¤ÎÌá¤êÃÍÀßÄê½èÍý
      *****************************************************************
       330-I0ID1-SET-SEC               SECTION.
      *
           MOVE    SPA-I0ID1-FLG   TO  WRK-I0ID-FLG
           MOVE    SPA-I0IDCD      TO  WRK-I0IDCD
      *
           MOVE    SPACE           TO  SPA-I0ID1-FLG
           MOVE    SPACE           TO  SPA-I0IDCD
      *
           IF    ( WRK-I0ID-FLG    =   "OK" )
               MOVE    SPACE       TO  WRK-UPDKBN
               EVALUATE    WRK-I0IDCD
               WHEN    "3009"
                   MOVE    1       TO  FLG-TAINTUSANMINUS
                   MOVE    "INS"   TO  WRK-UPDKBN
                   PERFORM 4801-PTNYUINRRK-UPD-SEC
                   IF    ( SPA-ERRCD       NOT =   SPACE )
                       GO  TO  330-I0ID1-SET-EXT
                   END-IF
               WHEN    "3010"
                   MOVE    "INS"   TO  WRK-UPDKBN
                   PERFORM 4801-PTNYUINRRK-UPD-SEC
                   IF    ( SPA-ERRCD       NOT =   SPACE )
                       GO  TO  330-I0ID1-SET-EXT
                   END-IF
      *        Æþ±¡¼è¾Ã
               WHEN "3001"
               WHEN "3006"
      *        Æþ±¡¼è¾Ã¡Ê²ñ·×´Þ¤à¡Ë
               WHEN "3002"
               WHEN "3007"
                   MOVE    "DEL"   TO  WRK-UPDKBN
                   PERFORM 4801-PTNYUINRRK-UPD-SEC
                   IF    ( SPA-ERRCD       NOT =   SPACE )
                       GO  TO  330-I0ID1-SET-EXT
                   END-IF
      *        Âà±¡¼è¾Ã
               WHEN "3003"
                   MOVE    "UPD"   TO  WRK-UPDKBN
                   PERFORM 4801-PTNYUINRRK-UPD-SEC
                   IF    ( SPA-ERRCD       NOT =   SPACE )
                       GO  TO  330-I0ID1-SET-EXT
                   END-IF
      *        Âà±¡ÅÐÏ¿
               WHEN "3008"
                   MOVE    ZERO    TO  FLG-TEIKI-CHK
                   PERFORM 480-TOUROKU-SEC
                   IF    ( SPA-ERRCD       NOT =   SPACE )
                       GO  TO  330-I0ID1-SET-EXT
                   END-IF
               WHEN "3004"
               WHEN "3005"
                   IF    ( WRK-I0IDCD      =   "3005" )
      *
                       MOVE    1   TO  SPA-NAI-I01-TORIKESI-FLG
      *
      *                ¿ÇÎÅ²ñ·×¥Æ¡¼¥Ö¥ë¥Á¥§¥Ã¥¯½èÍý
                       PERFORM 490-SRYACCT-CHK-SEC
                       IF    ( SPA-I0IDCD  NOT =   SPACE )
                         OR  ( SPA-ERRCD   NOT =   SPACE )
                           GO  TO  330-I0ID1-SET-EXT
                       END-IF
                   END-IF
      *
      *            ÀÁµá³«»ÏÆü¼èÆÀ½èÍý
                   PERFORM 4801-SKYSTYMD-GET-SEC
      *            ÀÁµá³ÎÇ§²èÌÌÁ«°Ü½èÍý
                   MOVE    "JOIN"      TO  WRK-MCP-PUTTYPE
                   PERFORM 490-TAIIN-SYORI-SEC
                   IF    ( SPA-ERRCD   NOT =   SPACE )
                       GO  TO  330-I0ID1-SET-EXT
                   END-IF
      *
               END-EVALUATE
      *
           ELSE
               EVALUATE    WRK-I0IDCD
      *        Æþ±¡¼è¾Ã
               WHEN "3001"
               WHEN "3006"
      *        Æþ±¡¼è¾Ã¡Ê²ñ·×´Þ¤à¡Ë
               WHEN "3002"
               WHEN "3007"
      *        Âà±¡¼è¾Ã
               WHEN "3003"
                   MOVE    02      TO  SPA-GMN-I01-CUR
      *        Âà±¡ÅÐÏ¿
               WHEN "3004"
                   MOVE    11      TO  SPA-GMN-I01-CUR
               END-EVALUATE
           END-IF
      *
           .
       330-I0ID1-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³ÎÇ§²èÌÌ¡Ê£É£°£É£Ä£²¡Ë¤«¤é¤ÎÌá¤êÃÍÀßÄê½èÍý
      *****************************************************************
       330-I0ID2-SET-SEC               SECTION.
      *
           MOVE    SPA-I0ID2-FLG   TO  WRK-I0ID-FLG
           MOVE    SPA-I0IDCD2     TO  WRK-I0IDCD
      *
           MOVE    SPACE           TO  SPA-I0ID2-FLG
           MOVE    SPACE           TO  SPA-I0IDCD2
      *
           IF    ( WRK-I0ID-FLG    =   "OK" )
               MOVE    SPACE       TO  WRK-UPDKBN
               EVALUATE    WRK-I0IDCD
               WHEN "3101"
                   MOVE    "DEL"   TO  WRK-UPDKBN
                   PERFORM 4801-PTNYUINRRK-UPD-SEC
                   IF    ( SPA-ERRCD       NOT =   SPACE )
                       GO  TO  330-I0ID2-SET-EXT
                   END-IF
      *
               END-EVALUATE
           END-IF
      *
           .
       330-I0ID2-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡ÎòÉ½¼¨²èÌÌ¤«¤éÌá¤Ã¤¿¾ì¹ç¤Î½èÍý
      *****************************************************************
       330-I02-SET-SEC                 SECTION.
      *
           IF    ( SPA-NAI-I01-PTRRKNUM    =   SPA-I01-I02-PTRRKNUM )
            AND  ( SPA-I01-I02-TAIINYMD    NOT =   SPACE )
               MOVE    SPA-I01-I02-TAIINCD TO  WRK-CMB-CD
               PERFORM 4103-CMB-TAIINCD-SRH-SEC
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-TAIINCD
           END-IF
      *
           .
       330-I02-SET-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎòºîÀ®²èÌÌ¤«¤éÌá¤Ã¤¿¾ì¹ç¤Î½èÍý
      *****************************************************************
       330-I03-SET-SEC                 SECTION.
      *
      *    Ìá¤ë¥Ü¥¿¥ó¤ÇÌá¤Ã¤Æ¤­¤¿¾ì¹ç¤Ï²¿¤â¤·¤Ê¤¤
           IF    ( SPA-I01-I03-BTN =   "B01" )
               GO  TO  330-I03-SET-EXT
           END-IF
      *
      *    Æþ±¡Îò¥ê¥¹¥È¤òºÆÊÔ½¸¤¹¤ë
           PERFORM 4101-NYUREKI-EDIT-SEC
      *
      *    ºÇ¿·¤ÎÆþ±¡Îò¤ò¼èÆÀ¤¹¤ë
           PERFORM 4101-PTNYUINRRK-SEL1-SEC
      *
           IF  (   SPA-I01-I03-SYORIKBN        =   "2" OR  "3" )
               IF    (   FLG-PTNYUINRRK        =   ZERO )
                   IF    ( PTNYUINRRK-JTIKBN   NOT =   "5" AND "6" )
                    AND  ( PTNYUINRRK-TAIINYMD =   "99999999" )
                       MOVE    1       TO  SPA-GMN-I01-NYUREKILST-SEL
                                           SPA-GMN-I01-SELNUM
                       GO  TO  330-I03-SET-EXT
                   END-IF
               END-IF
           END-IF
      *
           IF  (   SPA-I01-I03-SYORIKBN-CD     =   "01" )
      *        Æþ±¡Îò¤Ê¤·¡Ê½éÆþ±¡¡Ë
               IF  (   FLG-PTNYUINRRK  NOT =   ZERO )
                   PERFORM 310-CMB-SYORIKBN-SET2-SEC
                   MOVE    SPA-GMN-I01-SYORIKBN-ITM (01)
                                       TO  SPA-GMN-I01-SYORIKBN
               ELSE
      *            ÎòºîÀ®¥Ç¡¼¥¿Í­¤ê
                   IF    ( PTNYUINRRK-JTIKBN   =   "5" OR "6" )
                       PERFORM 310-CMB-SYORIKBN-SET5-SEC
                       MOVE    SPA-GMN-I01-SYORIKBN-ITM (01)
                                       TO  SPA-GMN-I01-SYORIKBN
                   ELSE
                       PERFORM 310-CMB-SYORIKBN-SET4-SEC
                       MOVE    SPA-GMN-I01-SYORIKBN-ITM (01)
                                       TO  SPA-GMN-I01-SYORIKBN
                   END-IF
               END-IF
           ELSE
      *        Æþ±¡Îò¤Ê¤·¡Ê½éÆþ±¡¡Ë
               IF  (   FLG-PTNYUINRRK  NOT =   ZERO )
                   MOVE    SPA-SYSYMD  TO  WRK-KJNYMD
                   PERFORM 310-CMB-SYOKI-SEC
                   PERFORM 4201-INPUT-AREA-CLEAR-SEC
                   PERFORM 310-CMB-SYORIKBN-SET2-SEC
                   MOVE    SPACE       TO  SPA-GMN-I01-SYORIKBN
               ELSE
      *            ÎòºîÀ®¥Ç¡¼¥¿Í­¤ê
                   IF    ( PTNYUINRRK-JTIKBN   =   "5" OR "6" )
                       PERFORM 4101-INPUT-AREA-EDIT2-SEC
                       PERFORM 4201-WIDGET-INSENSITIVE-SEC
                       PERFORM 310-CMB-SYORIKBN-SET5-SEC
                       MOVE    SPA-GMN-I01-SYORIKBN-ITM (02)
                                       TO  SPA-GMN-I01-SYORIKBN
                   ELSE
                       PERFORM 4101-INPUT-AREA-EDIT-SEC
                       PERFORM 4201-WIDGET-INSENSITIVE-SEC
                       PERFORM 310-CMB-SYORIKBN-SET4-SEC
                       MOVE    SPA-GMN-I01-SYORIKBN-ITM (02)
                                       TO  SPA-GMN-I01-SYORIKBN
                   END-IF
               END-IF
           END-IF
      *
           MOVE    WIDGET-NORMAL       TO  SPA-GMN-I01-B07-STT
           MOVE    WIDGET-NORMAL       TO  SPA-GMN-I01-B08-STT
      *
           IF    ( SPA-GMN-I01-NYUREKILST-CNT  >   ZERO )
               MOVE    1           TO  SPA-GMN-I01-NYUREKILST-SEL
                                       SPA-GMN-I01-SELNUM
           ELSE
               MOVE   ZERO         TO  SPA-GMN-I01-NYUREKILST-SEL
                                       SPA-GMN-I01-SELNUM
           END-IF
      *
           .
       330-I03-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       200-GMNSENI                     SECTION.
      *
           IF      ( MCP-WIDGET        =   "B06"
                                       OR  "B07"
                                       OR  "B11"
                                       OR  "B12"
                                       OR  "B23"
                                                 )
      *        ´µ¼ÔÈÖ¹æ¥Á¥§¥Ã¥¯
               PERFORM 4102-PTNUM-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   PERFORM 420-CLEAR-SEC
                   GO  TO  200-GMNSENI-EXT
               END-IF
      *
           END-IF
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
           WHEN    "CLICKED"       ALSO    "B01"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 210-BACK
           WHEN    "CLICKED"       ALSO    "B02"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 420-CLEAR-SEC
           WHEN    "CLICKED"       ALSO    "B03"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 420-MAEPTINF-SET-SEC
           WHEN    "CLICKED"       ALSO    "B05"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-KANJATOROKU-SEC
           WHEN    "CLICKED"       ALSO    "B06"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-NYUINREKI-SEC
           WHEN    "CLICKED"       ALSO    "B07"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-NYUINRRK-SAKUSEI-SEC
           WHEN    "CLICKED"       ALSO    "B08"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-NYUINRRK-SYUSEI-SEC
           WHEN    "CLICKED"       ALSO    "B09"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-KENSAKU-SEC
           WHEN    "CLICKED"       ALSO    "B12"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               MOVE    1                   TO  FLG-TEIKI-CHK
               PERFORM 480-TOUROKU-SEC
           WHEN    "CLICKED"       ALSO    "B11"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-KARUTE-PRT-SEC
           WHEN    "CLICKED"       ALSO    "B23"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-ZOKUSI-PRT-SEC
           WHEN    "CLICKED"       ALSO    "B20"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-S02-SENI-SEC
           WHEN    "CLICKED"       ALSO    "B21"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-NYUINKAIKEI-SEC
           WHEN    "CLICKED"       ALSO    "B24"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM 480-I06-SENI-SEC
           END-EVALUATE.
      *
       200-GMNSENI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²ñÏÃ¡¡½èÍý
      *****************************************************************
       200-ENTRY                   SECTION.
      *
           IF      ( MCP-WIDGET    NOT =   "PTNUM" )
      *        ´µ¼ÔÈÖ¹æ¥Á¥§¥Ã¥¯
               PERFORM 4102-PTNUM-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   PERFORM 420-CLEAR-SEC
                   GO  TO  200-ENTRY-EXT
               END-IF
      *
           END-IF
      *
           MOVE    MCP-WIDGET      TO  WRK-MCP-WIDGET
      *
           EVALUATE    MCP-EVENT   ALSO    MCP-WIDGET
      *    ´µ¼ÔÈÖ¹æ¥Á¥§¥Ã¥¯
           WHEN    "ACTIVATE"      ALSO    "PTNUM"
               PERFORM 4101-PTNUM-CHK-SEC
      *    ½èÍý¶èÊ¬¥Á¥§¥Ã¥¯
           WHEN    "ACTIVATE"      ALSO    "SYORIKBN"
               PERFORM 4101-SYORIKBN-CHK-SEC
           WHEN    OTHER
      *
      *        ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È
               PERFORM 400-GMN-INPUT-SEC
      *        ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
               PERFORM 410-INPUT-CHK-SEC
           END-EVALUATE
      *
           .
      *
       200-ENTRY-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È½èÍý
      *****************************************************************
       400-GMN-INPUT-SEC          SECTION.
      *
           EVALUATE    MCP-EVENT   ALSO    MCP-WIDGET
      *    Æþ±¡Îò¥ê¥¹¥È
           WHEN        ANY         ALSO    "NYUREKILST"
               PERFORM 4101-NYUREKILST-SEL-SEC
           WHEN        OTHER
               MOVE    ZERO        TO      SPA-GMN-I01-CUR
      *
           END-EVALUATE
      *
           .
      *
       400-GMN-INPUT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       410-INPUT-CHK-SEC          SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *
      *    ½èÍý¶èÊ¬¥Á¥§¥Ã¥¯
           PERFORM 4102-SYORIKBN-CHK-SEC
           IF    ( SPA-ERRCD NOT =   SPACE )
               GO  TO  410-INPUT-CHK-EXT
           END-IF
      *
      *    Æþ±¡Âà±¡ÅÐÏ¿²èÌÌ¤ÇÅÐÏ¿¤·¤¿Æþ±¡Îò¤Î¤ß¥Á¥§¥Ã¥¯¤¹¤ë
           IF    ( SPA-NAI-I01-NYURRK-FLG   = ZERO )
      *        ´ðËÜ¥Á¥§¥Ã¥¯½èÍý
               PERFORM 4102-KIHON-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                 OR  ( FLG-END     NOT =   ZERO  )
                   GO  TO  410-INPUT-CHK-EXT
               END-IF
      *
           END-IF
      *
      *    ÁªÂòÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SELNUM-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  410-INPUT-CHK-EXT
           END-IF
      *
           .
      *
       410-INPUT-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ£Ó£Ð£ÁÊÔ½¸½èÍý
      *****************************************************************
       4101-GMN-SPA-SET-SEC            SECTION.
      *
      *    °ÛÆ°Æü
           MOVE    I01-IDOYMD          TO  SPA-GMN-I01-IDOYMD
      *    ÉÂ¼¼ÈÖ¹æ
           MOVE    I01-BRMNUM          TO  SPA-GMN-I01-BRMNUM
      *    ÉÂÅïÌ¾¾Î
           MOVE    I01-BTUNAME         TO  SPA-GMN-I01-BTUNAME
      *    ¼¼ÎÁº¹³Û
           MOVE    I01-SAGAKU          TO  SPA-GMN-I01-SAGAKU
      *    Æþ±¡Æü
           MOVE    I01-NYUINYMD        TO  SPA-GMN-I01-NYUINYMD
      *    Æþ±¡²Ê
           MOVE    I01-NYUINKA         TO  SPA-GMN-I01-NYUINKA
      *    ½é²ó
           MOVE    I01-SHOKAI          TO  SPA-GMN-I01-SHOKAI
      *    ½é²óÈÖ¹æ
           MOVE    I01-SHONUM          TO  SPA-GMN-I01-SHONUM
      *    ½é²óÆþ±¡Æü
           MOVE    I01-LBL-SHONYUINYMD TO  SPA-GMN-I01-LBL-SHONYUINYMD
      *    Âà±¡Æü
           MOVE    I01-TAIINYMD        TO  SPA-GMN-I01-TAIINYMD
      *    Âà±¡»öÍ³
           MOVE    I01-TAIINCD         TO  SPA-GMN-I01-TAIINCD
      *    Ã´Åö°å
           MOVE    I01-DR (1)          TO  SPA-GMN-I01-DR (1)
           MOVE    I01-DR (2)          TO  SPA-GMN-I01-DR (2)
           MOVE    I01-DR (3)          TO  SPA-GMN-I01-DR (3)
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»
           MOVE    I01-HKNCOMBI        TO  SPA-GMN-I01-HKNCOMBI
      *    ÆÃÄêÆþ±¡
           MOVE    I01-TOKNYUIN        TO  SPA-GMN-I01-TOKNYUIN
      *    Á°¼õ¤±¶â
           MOVE    I01-MAEUKE          TO  SPA-GMN-I01-MAEUKE
      *    Äê´üÀÁµá
           MOVE    I01-SEIKYU          TO  SPA-GMN-I01-SEIKYU
      *    ¸¡º÷»þ´µ¼ÔÉ½¼¨
           MOVE    I01-DISPKBN         TO  SPA-GMN-I01-DISPKBN
      *    ÁªÂòÈÖ¹æ
           MOVE    I01-SELNUM          TO  SPA-GMN-I01-SELNUM
      *
           .
      *
       4101-GMN-SPA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´ðËÜ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4102-KIHON-CHK-SEC              SECTION.
      *
           EVALUATE    SPA-GMN-I01-SYORIKBN-CD
           WHEN    "01"
      *
      *        Æþ±¡Æü¥Á¥§¥Ã¥¯½èÍý
               PERFORM 4101-NYUINYMD-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
               MOVE    SPA-NAI-I01-NYUINYMD
                                   TO  WRK-KIHON-KJNYMD
           WHEN    "08"
      *
      *        °ÛÆ°Æü¥Á¥§¥Ã¥¯½èÍý
               PERFORM 4101-IDOYMD-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
               MOVE    SPA-NAI-I01-IDOYMD
                                   TO  WRK-KIHON-KJNYMD
           WHEN    OTHER
               MOVE    SPA-NAI-I01-MAEIDOYMD
                                   TO  WRK-KIHON-KJNYMD
           END-EVALUATE
      *
      *    Âà±¡Æü¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-TAIINYMD-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ÉÂ¼¼ÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
           IF    ( SPA-GMN-I01-BRMNUM  NOT =   SPA-NAI-I01-BRMNUM-MAE )
            OR   ( SPA-GMN-I01-BTUNAME-CNT =   ZERO )
               PERFORM 4101-BRMNUM-CHK-SEC
               MOVE    SPA-GMN-I01-BRMNUM
                                       TO  SPA-NAI-I01-BRMNUM-MAE
               MOVE    SPA-ERRCD       TO  SPA-NAI-I01-BRMNUM-ERR
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
           ELSE
               IF    ( SPA-NAI-I01-BRMNUM-ERR
                                   NOT =   SPACE )
                   MOVE    SPA-NAI-I01-BRMNUM-ERR
                                       TO  SPA-ERRCD
                   MOVE    4           TO  SPA-GMN-I01-CUR
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
           END-IF
      *
      *    ÉÂÅïÌ¾¾Î¥Á¥§¥Ã¥¯½èÍý
           IF    ( SPA-GMN-I01-BTUNAME
                                       NOT =   SPA-NAI-I01-BTUNAME-MAE )
               PERFORM 4101-BTUNAME-CHK-SEC
               MOVE    SPA-GMN-I01-BTUNAME
                                       TO  SPA-NAI-I01-BTUNAME-MAE
               MOVE    SPA-ERRCD       TO  SPA-NAI-I01-BTUNAME-ERR
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
           ELSE
               IF    ( SPA-NAI-I01-BTUNAME-ERR
                                   NOT =   SPACE )
                   MOVE    SPA-NAI-I01-BTUNAME-ERR
                                       TO  SPA-ERRCD
                   MOVE    5           TO  SPA-GMN-I01-CUR
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
           END-IF
      *
      *    PERFORM 4101-BTUNAME-CHK-SEC
      *    IF    ( SPA-ERRCD   NOT =   SPACE )
      *        GO  TO  4102-KIHON-CHK-EXT
      *    END-IF
      *
      *    ¼¼ÎÁº¹³Û¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SAGAKU-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Æþ±¡²Ê¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-NYUINKA-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ½é²ó¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SHOKAI-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ½é²óÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SHONUM-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Âà±¡»öÍ³¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-TAIINCD-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Ã´Åö°å¥Á¥§¥Ã¥¯½èÍý
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   3   )
      *
               PERFORM 4101-DR-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
      *
           END-PERFORM
      *
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-HKNCOMBI-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ÆÃÄêÆþ±¡¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-TOKNYUIN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Á°¼õ¤±¶â¥Á¥§¥Ã¥¯½èÍý
      *    PERFORM 4101-MAEUKE-CHK-SEC
      *    IF    ( SPA-ERRCD   NOT =   SPACE )
      *        GO  TO  4102-KIHON-CHK-EXT
      *    END-IF
      *
      *    Äê´üÀÁµá¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SEIKYU-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ¸¡º÷»þ´µ¼ÔÉ½¼¨¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-DISPKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
           .
      *
       4102-KIHON-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼ÔÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-PTNUM-CHK-SEC              SECTION.
      *
           PERFORM  420-CLEAR-SEC
      *
           MOVE    1               TO  SPA-GMN-I01-CUR
      *
           MOVE    SPACE           TO  SPA-GMN-I01-ERRCD (1)
      *
           INITIALIZE                  SPA-NAI-I01-PTID
                                       SPA-GMN-I01-NAME
                                       SPA-NAI-I01-KANANAME
                                       SPA-GMN-I01-SEX
                                       SPA-GMN-I01-BIRTHDAY
                                       SPA-NAI-I01-BIRTHDAY
                                       SPA-GMN-I01-AGE
                                       SPA-KYOTUKEY
      *
           MOVE    I01-PTNUM       TO  SPA-GMN-I01-PTNUM
      *
      *    ´µ¼ÔÈÖ¹æ¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-GMN-I01-PTNUM   =   SPACE )
               MOVE    "1001"      TO  SPA-ERRCD
               MOVE    SPA-ERRCD   TO  SPA-GMN-I01-ERRCD (1)
               GO  TO  4101-PTNUM-CHK-EXT
           END-IF
      *
      *    ¡ö¤Î¤È¤­¡¢´µ¼Ô¿·µ¬ÅÐÏ¿¤Ø
           IF    ( SPA-GMN-I01-PTNUM(1:1)  =   "*" )
               MOVE    "*"                 TO  SPA-PTNUM
               PERFORM 481-KANJATOROKU-SEC
               GO  TO      4101-PTNUM-CHK-EXT
           END-IF
      *
      *    ´µ¼ÔÈÖ¹æÊÑ´¹¥µ¥Ö¸Æ¤Ó½Ð¤·
           INITIALIZE                  ORCSPTNUMAREA
           MOVE    SPA-GMN-I01-PTNUM   TO  SPTNUM-PTNUM
           CALL    "ORCSPTNUM"         USING   ORCSPTNUMAREA
                                               SPA-AREA
           MOVE    SPTNUM-PTNUM        TO  SPA-GMN-I01-PTNUM
           EVALUATE    SPTNUM-RC
               WHEN    00
                   MOVE    SPTNUM-PTNUM        TO  SPA-GMN-I01-PTNUM
                   MOVE    SPTNUM-PTID         TO  SPA-NAI-I01-PTID
               WHEN   10
                   MOVE    "0002"              TO  SPA-ERRCD
                   MOVE    SPA-ERRCD           TO  SPA-GMN-I01-ERRCD (1)
                   GO  TO  4101-PTNUM-CHK-EXT
               WHEN    20
      *            »áÌ¾¸¡º÷¤Ø
                   MOVE    SPACE               TO  LINKAREA
                   MOVE    SPA-KYOUTU          TO  LNK-COMMON
                   MOVE    SPA-I0FREE          TO  LNK-SCRSPA
      *
                   MOVE    "I01"               TO  SPA-MOTOPG
                   MOVE    "P97"               TO  SPA-SAKIPG
                   MOVE    ZERO                TO  SPA-PTID
      *            ´µ¼Ô»áÌ¾¥»¥Ã¥È
                   MOVE    SPA-GMN-I01-PTNUM   TO  SPA-NAME
                   MOVE    SPA-KYOUTU          TO  LNK-KYOUTU
      *
                   MOVE    "CHANGE"            TO  MCP-PUTTYPE
                   MOVE    "P97"               TO  MCP-WINDOW
                   PERFORM 900-PUT-WINDOW
                   MOVE    1                   TO  FLG-END
                   GO      TO     4101-PTNUM-CHK-EXT
               WHEN    OTHER
                   MOVE    "0002"              TO  SPA-ERRCD
                   MOVE    SPA-ERRCD           TO  SPA-GMN-I01-ERRCD (1)
                   GO  TO  4101-PTNUM-CHK-EXT
           END-EVALUATE
      *
      *    ´µ¼Ô¥Þ¥¹¥¿¸¡º÷
           INITIALIZE  PTINF-REC
           MOVE    SPA-HOSPID                  TO  PTINF-HOSPID
           MOVE    SPA-NAI-I01-PTID            TO  PTINF-PTID
           MOVE    PTINF-REC                   TO  MCPDATA-REC
      *
           MOVE    "PTINF-KEY"                 TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
      *
      *        ÇÓÂ¾À©¸æ½èÍý
               PERFORM 990-LOCK-IN-SEC
               IF  (   SPA-ERRCD   NOT =   SPACE )
                   MOVE    SPA-ERRCD           TO  SPA-GMN-I01-ERRCD (1)
                   GO  TO  4101-PTNUM-CHK-EXT
               END-IF
      *
      *        ´µ¼Ô¾ðÊóÀßÄê
               PERFORM 4101-PTINF-SET-SEC
      *        IF    ( SPA-NAI-I01-NYURRK-FLG        =   ZERO )
      *            IF    ( SPA-GMN-I01-HKNCOMBI-CNT   >   ZERO )
      *                CONTINUE
      *            ELSE
      *                MOVE    "1021"      TO  SPA-ERRCD
      *                MOVE    1           TO  SPA-GMN-I01-CUR
      *            END-IF
      *        END-IF
      *
           ELSE
               MOVE    "0002"                  TO  SPA-ERRCD
               MOVE    SPA-ERRCD               TO  SPA-GMN-I01-ERRCD (1)
           END-IF
      *
      *    ´µ¼Ô¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "PTINF-KEY"                 TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *
           .
      *
       4101-PTNUM-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÍúÎò¥Þ¥¹¥¿¸¡º÷½èÍý¡ÊÆþÎÏÎÎ°èÉ½¼¨ÍÑ¡Ë
      *****************************************************************
       4101-PTNYUINRRK-SEL1-SEC        SECTION.
      *
           MOVE    ZERO            TO  FLG-PTNYUINRRK
           INITIALIZE  PTNYUINRRK-REC
           MOVE    ZERO            TO  SPA-NAI-I01-PTRRKNUM
                                       SPA-NAI-I01-PTRRKEDANUM
      *
           MOVE    SPA-HOSPID      TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID
                                   TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC  TO  MCPDATA-REC
      *
      *    Æþ±¡ÍúÎò¸¡º÷½èÍý
           MOVE    "PTNYUINRRK-KEY3"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
               MOVE    MCPDATA-REC TO  PTNYUINRRK-REC
               MOVE    PTNYUINRRK-RRKNUM
                                       TO  SPA-NAI-I01-PTRRKNUM
               MOVE    PTNYUINRRK-RRKEDANUM
                                       TO  SPA-NAI-I01-PTRRKEDANUM
           ELSE
               MOVE    1           TO  FLG-PTNYUINRRK
           END-IF
      *
      *    Æþ±¡ÍúÎò¥¯¥í¡¼¥º
           MOVE    "PTNYUINRRK-KEY3"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4101-PTNYUINRRK-SEL1-EXT.
           EXIT.
      *****************************************************************
      *    ÆþÎÏÎÎ°èÊÔ½¸½èÍý
      *****************************************************************
       4101-INPUT-AREA-EDIT-SEC        SECTION.
      *
           IF    ( PTNYUINRRK-TAIINYMD =   "99999999" )
               MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  WRK-KJNYMD
               PERFORM 310-CMB-SYOKI-SEC
           ELSE
               MOVE    PTNYUINRRK-TAIINYMD
                                   TO  WRK-KJNYMD
               PERFORM 310-CMB-SYOKI-SEC
           END-IF
      *
      *    ÆþÎÏÎÎ°è½é´ü²½
           PERFORM 4201-INPUT-AREA-CLEAR-SEC
      *
           MOVE    ZERO            TO  SPA-NAI-I01-NYURRK-FLG
      *
      *    Æ±ÆüºÆÆþ±¡¥Õ¥é¥°
           PERFORM 800-ORCSDNTCHK-SEC
           MOVE    SDNTCHK-DJKBN   TO  SPA-NAI-I01-DJKBN
           MOVE    SDNTCHK-STYMD   TO  SPA-NAI-I01-DJSTYMD
      *
      *    Á°²ó°ÛÆ°Æü
           MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  WRK-YMD
           PERFORM 5002-HIZUKE-CHK-SEC
      *
           IF      ( PTNYUINRRK-JTIKBN     = "2" OR "3" OR "4" OR "7" )
            AND    ( PTNYUINRRK-TAIINYMD   = "99999999" )
               MOVE    WRK-HENYMDG TO  SPA-GMN-I01-MAEIDOYMD
           END-IF
      *
           MOVE    WRK-SYMD        TO  SPA-NAI-I01-MAEIDOYMD
      *
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¥³¥ó¥ÜÀßÄê½èÍý
           MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  WRK-KJNYMD
           PERFORM 4101-CMB-HKNCOMBI-SET-SEC
      *
      *    ÉÂ¼¼ÈÖ¹æ
           MOVE   PTNYUINRRK-BRMNUM ( 3 : 6 )
                                   TO  WRK-BRMNUM-IN
           PERFORM 4101-BRMNUM-LEFT-EDIT-SEC
           MOVE   WRK-BRMNUM-OT    TO  SPA-GMN-I01-BRMNUM
                                       SPA-NAI-I01-BRMNUM-MAE
                                       SPA-NAI-I01-BRMNUM-MOT
      *
      *    ÉÂ¼¼¾ðÊó¤è¤êÉÂÅï¥³¥ó¥ÜÊÔ½¸
           MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  WRK-KJNYMD
           PERFORM 4101-BRMNUM-SEL-SEC
      *
      *    ÉÂÅïÈÖ¹æ
           MOVE    PTNYUINRRK-BTUNUM
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-BTUNAME-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-BTUNAME
                                       SPA-NAI-I01-BTUNAME-MAE
                                       SPA-NAI-I01-BTUNAME-MOT
      *
      *    Æþ±¡²Ê
           MOVE    PTNYUINRRK-NYUINKA
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-NYUINKA-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-NYUINKA
           MOVE    PTNYUINRRK-NYUINKA
                                   TO  SPA-NAI-I01-NYUINKA-MOT
      *
      *    ÊÝ¸±ÁÈ¹ç¤»ÈÖ¹æ
           MOVE    PTNYUINRRK-HKNCOMBINUM
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-HKNCOMBI-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-HKNCOMBI
           MOVE    WRK-CMB-ITM2    TO  SPA-NAI-I01-FTNRATE
           MOVE    PTNYUINRRK-HKNCOMBINUM
                                   TO  SPA-NAI-I01-HKNCOMBI-MOT
      *
      *    Æþ±¡Æü
           MOVE    PTNYUINRRK-NYUINYMD
                                   TO  WRK-YMD
           PERFORM 5002-HIZUKE-CHK-SEC
           MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-NYUINYMD
           MOVE    WRK-SYMD        TO  SPA-NAI-I01-NYUINYMD
                                       SPA-NAI-I01-NYUINYMD-MAE
      *
      *    Âà±¡Æü
           IF    ( PTNYUINRRK-TAIINYMD     =   "99999999" )
               MOVE    SPACE           TO  SPA-GMN-I01-TAIINYMD
                                           SPA-NAI-I01-TAIINYMD
           ELSE
               MOVE    PTNYUINRRK-TAIINYMD
                                   TO  WRK-YMD
               PERFORM 5002-HIZUKE-CHK-SEC
               MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-TAIINYMD
               MOVE    WRK-SYMD        TO  SPA-NAI-I01-TAIINYMD
      *
      *        Âà±¡»öÍ³
               MOVE    PTNYUINRRK-TAIINCD  TO  WRK-CMB-CD
               PERFORM 4103-CMB-TAIINCD-SRH-SEC
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-TAIINCD
           END-IF
      *
      *
      *    ÆÃÄêÆþ±¡ÎÁ¥³¥ó¥ÜÀßÄê½èÍý
           MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  WRK-KJNYMD
           PERFORM 4101-CMB-TOKNYUIN-SET-SEC
      *
      *    ÆÃÄêÆþ±¡ÎÁ
           MOVE    SPACE           TO  WRK-CMB-CD
           MOVE    PTNYUINRRK-TOKUTEI-KBN
                                   TO  WRK-CMB-CD (1 : 1)
           MOVE    PTNYUINRRK-TOKUTEI-NYUIN
                                   TO  WRK-CMB-CD (2 : 2)
      *
           PERFORM 4103-CMB-TOKNYUIN-SRH2-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-TOKNYUIN
           MOVE    WRK-CMB-ITM2    TO  SPA-NAI-I01-TOKNYUIN-ORG
                                       SPA-NAI-I01-TOKNYUINMOT
      *
      *    »»ÄêÆþ±¡ÎÁ
           IF    ( SPA-GMN-I01-TOKNYUIN    =   SPACE )
               MOVE    SPA-NAI-I01-KHNRYO-NM
                                       TO  SPA-GMN-I01-SNTNYUIN
           ELSE
               MOVE    SPA-GMN-I01-TOKNYUIN-NM
                                       TO  SPA-GMN-I01-SNTNYUIN
           END-IF
      *
      *    ¼¼ÎÁº¹³Û
           MOVE    PTNYUINRRK-RM-SAGAKU
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-SAGAKU-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-SAGAKU
      *
      *    Äê´üÀÁµá¶èÊ¬
           MOVE    PTNYUINRRK-TEIKI-SEIKYUKBN
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-SEIKYU-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-SEIKYU
      *
      *    ¸¡º÷É½¼¨¶èÊ¬
           MOVE    PTNYUINRRK-KENSAKU-DISPKBN
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-DISPKBN-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-DISPKBN
      *
      *    ½é²ó·ÑÂ³¶èÊ¬
           MOVE  PTNYUINRRK-SHOKAIKBN
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-SHOKAI-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-SHOKAI
      *
      *    ½é²óÈÖ¹æ
           MOVE    PTNYUINRRK-SHONUM
                                   TO  SPA-GMN-I01-SHONUM
      *    ½é²óÆþ±¡Æü
           PERFORM 4101-SHONYUINYMD-EDIT-SEC
      *
      *    Ã´Åö°å£±
           MOVE    PTNYUINRRK-DRCD1 (2 : 4)
                                   TO  WRK-CMB-CD
           MOVE    1               TO  IDX1
           PERFORM 4103-CMB-DR-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-DR (1)
      *
      *    Ã´Åö°å£²
           MOVE    PTNYUINRRK-DRCD2 (2 : 4) 
                                   TO  WRK-CMB-CD
           MOVE    2               TO  IDX1
           PERFORM 4103-CMB-DR-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-DR (2)
      *
      *    Ã´Åö°å£³
           MOVE    PTNYUINRRK-DRCD3 (2 : 4)
                                   TO  WRK-CMB-CD
           MOVE    3               TO  IDX1
           PERFORM 4103-CMB-DR-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-DR (3)
       .
      *
       4101-INPUT-AREA-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ½é²óÆþ±¡ÆüÊÔ½¸½èÍý
      *****************************************************************
       4101-SHONYUINYMD-EDIT-SEC       SECTION.
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL ( IDX1    >   SPA-GMN-I01-NYUREKILST-CNT )
               IF    ( SPA-GMN-I01-SHONUM
                                   =   SPA-GMN-I01-TSHONUM (IDX1))
                   IF    ( SPA-GMN-I01-TSHOKAI (IDX1)  =   "1" )
                       STRING "Æþ±¡Æü "
                              SPA-GMN-I01-TNYUINYMD (IDX1)
                       DELIMITED   BY  SIZE
                       INTO   SPA-GMN-I01-LBL-SHONYUINYMD
                       END-STRING
                       MOVE    SPA-GMN-I01-NYUREKILST-CNT
                                   TO  IDX1
                   END-IF
               END-IF
      *
           END-PERFORM
       .
      *
       4101-SHONYUINYMD-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ÆþÎÏÎÎ°èÊÔ½¸½èÍý¡ÊÆþ±¡Îò¤òÊÔ½¸¡Ë
      *****************************************************************
       4101-INPUT-AREA-EDIT2-SEC       SECTION.
      *
      *    ÆþÎÏÎÎ°è½é´ü²½
           PERFORM 4201-INPUT-AREA-CLEAR-SEC
      *
           MOVE    1               TO  SPA-NAI-I01-NYURRK-FLG
      *
      *    Æ±ÆüºÆÆþ±¡¥Õ¥é¥°
           PERFORM 800-ORCSDNTCHK-SEC
           MOVE    SDNTCHK-DJKBN   TO  SPA-NAI-I01-DJKBN
           MOVE    SDNTCHK-STYMD   TO  SPA-NAI-I01-DJSTYMD
      *
      *    ÉÂÅïÌ¾¾Î
           MOVE    PTNYUINRRK-BTUNAME
                                   TO  SPA-GMN-I01-BTUNAME
      *
      *    Æþ±¡Æü
           MOVE    PTNYUINRRK-NYUINYMD
                                   TO  WRK-YMD
           PERFORM 5002-HIZUKE-CHK-SEC
           MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-NYUINYMD
           MOVE    WRK-SYMD        TO  SPA-NAI-I01-NYUINYMD
                                       SPA-NAI-I01-NYUINYMD-MAE
      *
      *    Âà±¡Æü
           IF    ( PTNYUINRRK-TAIINYMD     =   "99999999" )
               MOVE    SPACE           TO  SPA-GMN-I01-TAIINYMD
                                           SPA-NAI-I01-TAIINYMD
           ELSE
               MOVE    PTNYUINRRK-TAIINYMD
                                   TO  WRK-YMD
               PERFORM 5002-HIZUKE-CHK-SEC
               MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-TAIINYMD
               MOVE    WRK-SYMD        TO  SPA-NAI-I01-TAIINYMD
      *
      *        Âà±¡»öÍ³
               MOVE    PTNYUINRRK-TAIINCD  TO  WRK-CMB-CD
               PERFORM 4103-CMB-TAIINCD-SRH-SEC
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-TAIINCD
           END-IF
      *
      *    ½é²ó·ÑÂ³¶èÊ¬
           MOVE  PTNYUINRRK-SHOKAIKBN
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-SHOKAI-SRH-SEC
           MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-SHOKAI
      *
      *    ½é²óÈÖ¹æ
           MOVE    PTNYUINRRK-SHONUM
                                   TO  SPA-GMN-I01-SHONUM
      *    ½é²óÆþ±¡Æü
           PERFORM 4101-SHONYUINYMD-EDIT-SEC
      *
       .
      *
       4101-INPUT-AREA-EDIT2-EXT.
           EXIT.
      *****************************************************************
      *    ÉÂ¼¼ÈÖ¹æº¸µÍ½èÍý
      *****************************************************************
       4101-BRMNUM-LEFT-EDIT-SEC       SECTION.
      *
           IF    ( WRK-BRMNUM-IN (1 : 1)   =   SPACE )
               MOVE    SPACE           TO  WRK-STR1
               MOVE    1               TO  WRK-IDX1
               UNSTRING    WRK-BRMNUM-IN
                   DELIMITED   BY  ALL SPACE
                   INTO    WRK-STR1
                   WITH    POINTER WRK-IDX1
               END-UNSTRING
               MOVE    WRK-BRMNUM-IN (WRK-IDX1 : )
                                       TO  WRK-BRMNUM-EDT
           ELSE
               MOVE    WRK-BRMNUM-IN   TO  WRK-BRMNUM-EDT
           END-IF
      *
           PERFORM VARYING WRK-IDX1    FROM    6   BY  -1
               UNTIL     ( WRK-IDX1    <   1 )
                 OR      ( WRK-BRMNUM-EDT (WRK-IDX1 : 1)
                                   NOT =   SPACE )
               CONTINUE
           END-PERFORM
      *
           IF    ( WRK-IDX1    <   1 )
               MOVE    WRK-BRMNUM-EDT  TO  WRK-BRMNUM-OT
               GO  TO  4101-BRMNUM-LEFT-EDIT-EXT
           END-IF
      *
      *    ÉÂ¼¼ÈÖ¹æ¤¬¿ô»ú¤Î¾ì¹çÁ°¥¼¥í¤ò¤È¤ë
           IF    ( WRK-BRMNUM-EDT ( 1 : WRK-IDX1 )
                                       IS  NUMERIC )
               IF    ( WRK-BRMNUM-EDT ( 1 : 1 )
                                       =   ZERO )
                   MOVE    1               TO  WRK-IDX2
                   MOVE    SPACE           TO  WRK-STR1
                   UNSTRING    WRK-BRMNUM-EDT
                       DELIMITED BY  ALL ZERO
                   INTO    WRK-STR1
                   WITH    POINTER WRK-IDX2
                   END-UNSTRING
                   MOVE    WRK-BRMNUM-EDT (WRK-IDX2 : )
                                           TO  WRK-BRMNUM-OT
               ELSE
                   MOVE    WRK-BRMNUM-EDT  TO  WRK-BRMNUM-OT
               END-IF
           ELSE
                   MOVE    WRK-BRMNUM-EDT  TO  WRK-BRMNUM-OT
           END-IF
      *
           .
       4101-BRMNUM-LEFT-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÍúÎòÊÔ½¸½èÍý
      *****************************************************************
       4101-NYUREKI-EDIT-SEC       SECTION.
      *
      *    ´µ¼ÔÍúÎò¥Þ¥¹¥¿¸¡º÷
           PERFORM 4101-PTNYUINRRK-SEL2-SEC
      *
      *    ¼çÉÂÌ¾ÊÔ½¸½èÍý
           PERFORM 4101-SYUBYOMEI-EDIT-SEC
      *
      *    Æü¿ôÊÔ½¸½èÍý
           PERFORM 4101-NISSU-EDIT-SEC
      *
           .
       4101-NYUREKI-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÍúÎòÊÔ½¸½èÍý¡ÊÆþ±¡ÎòÉ½¼¨ÍÑ¡Ë
      *****************************************************************
       4101-PTNYUINRRK-SEL2-SEC        SECTION.
      *
      *
           INITIALIZE  PTNYUINRRK-REC
                       SPA-GMN-I01-NYUREKILST-AREA
                       SPA-NAI-I01-NYUREKILST-AREA
                       WRK-REKI-BYOMEI-EDIT-AREA
      *
           MOVE    1               TO  FLG-NYUREKILST-ROW
      *
           MOVE    SPA-HOSPID      TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID
                                   TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC  TO  MCPDATA-REC
      *
      *    Æþ±¡ÍúÎò¸¡º÷½èÍý
           MOVE    "PTNYUINRRK-KEY2"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1            >   CONST-NYUREKILST-MAX   )
               OR        ( FLG-DBRC    NOT =   ZERO )
      *
               MOVE    MCPDATA-REC TO  PTNYUINRRK-REC
               MOVE    IDX1        TO  SPA-GMN-I01-NYUREKILST-CNT
      *
      *
      *        Æþ±¡Îò¥ê¥¹¥ÈÊÔ½¸
               IF    ( PTNYUINRRK-JTIKBN   =   "5" OR "6" )
                   PERFORM 4101-NYUREKILST-EDIT2-SEC
               ELSE
                   PERFORM 4101-NYUREKILST-EDIT-SEC
               END-IF
      *
      *        Æþ±¡ÍúÎò¸¡º÷½èÍý
               MOVE    "PTNYUINRRK-KEY2"
                                   TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
      *    Æþ±¡ÍúÎò¥¯¥í¡¼¥º
           MOVE    "PTNYUINRRK-KEY2"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4101-PTNYUINRRK-SEL2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼Ô¾ðÊó¸¡º÷½èÍý
      *****************************************************************
       4101-PTINF-SELECT-SEC              SECTION.
      *
      *    ´µ¼Ô¥Þ¥¹¥¿¸¡º÷
           INITIALIZE  PTINF-REC
           MOVE    SPA-HOSPID          TO  PTINF-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTINF-PTID
           MOVE    PTINF-REC           TO  MCPDATA-REC
      *
           MOVE    "PTINF-KEY"         TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
      *
      *        ÇÓÂ¾À©¸æ½èÍý
               PERFORM 990-LOCK-IN-SEC
               IF  (   SPA-ERRCD   NOT =   SPACE )
                   MOVE    SPA-ERRCD   TO  SPA-GMN-I01-ERRCD (1)
                   GO  TO  4101-PTINF-SELECT-EXT
               END-IF
      *
      *        ´µ¼Ô¾ðÊóÀßÄê
               PERFORM 4101-PTINF-SET-SEC
           END-IF
      *
      *    ´µ¼Ô¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "PTINF-KEY"         TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *
           .
       4101-PTINF-SELECT-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼Ô¾ðÊóÀßÄê½èÍý
      *****************************************************************
       4101-PTINF-SET-SEC              SECTION.
      *
           MOVE    MCPDATA-REC     TO  PTINF-REC
      *    ´µ¼Ô£É£Ä
           MOVE    PTINF-PTID      TO  SPA-NAI-I01-PTID
      *    ´µ¼Ô»áÌ¾
           MOVE    PTINF-NAME      TO  SPA-GMN-I01-NAME
      *    ´µ¼Ô¥«¥Ê»áÌ¾
           MOVE    PTINF-KANANAME  TO  SPA-NAI-I01-KANANAME
      *    ´µ¼ÔÀ­ÊÌ
           EVALUATE    PTINF-SEX
           WHEN    "1"
               MOVE    "ÃË"        TO  SPA-GMN-I01-SEX
           WHEN    "2"
               MOVE    "½÷"        TO  SPA-GMN-I01-SEX
           END-EVALUATE
      *    ´µ¼ÔÀ¸Ç¯·îÆü
           MOVE    PTINF-BIRTHDAY  TO  WRK-YMD
           PERFORM 5002-HIZUKE-CHK-SEC
           MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-BIRTHDAY
           MOVE    PTINF-BIRTHDAY  TO  SPA-NAI-I01-BIRTHDAY
      *    ´µ¼ÔÇ¯Îð
           MOVE    PTINF-BIRTHDAY  TO  WRK-BIRTHDAY
           PERFORM 4101-AGE-CALC-SEC
      *
           MOVE    WRK-AGE-G       TO  SPA-GMN-I01-AGE
      *
           MOVE    WIDGET-INSENSITIVE
                                       TO  SPA-GMN-I01-IDOYMD-STT
      *
      *
      *    Æþ±¡ÍúÎòÊÔ½¸½èÍý
           PERFORM 4101-NYUREKI-EDIT-SEC
      *
           MOVE    ZERO                TO  FLG-SYORIPTN
      *
      *    Æþ±¡ÍúÎò¥Þ¥¹¥¿¸¡º÷½èÍý¡ÊÆþÎÏÎÎ°èÉ½¼¨ÍÑ¡Ë
           PERFORM 4101-PTNYUINRRK-SEL1-SEC
      *    Æþ±¡Îò¤Ê¤·¡Ê½éÆþ±¡¡Ë
           IF  (   FLG-PTNYUINRRK  NOT =   ZERO )
               MOVE    1               TO  FLG-SYORIPTN
           ELSE
      *
               EVALUATE    TRUE
      *        ÎòºîÀ®¥Ç¡¼¥¿¤¢¤ê
               WHEN    PTNYUINRRK-JTIKBN   =   "5"
               WHEN    PTNYUINRRK-JTIKBN   =   "6"
                   MOVE    2           TO  FLG-SYORIPTN
      *        Æþ±¡Ãæ
               WHEN    PTNYUINRRK-TAIINYMD =   "99999999"
                   MOVE    3           TO  FLG-SYORIPTN
      *        Âà±¡ºÑ¤ß
               WHEN    OTHER
                   MOVE    4           TO  FLG-SYORIPTN
               END-EVALUATE
           END-IF
      *
           EVALUATE    FLG-SYORIPTN
           WHEN    1
               MOVE    3           TO  SPA-GMN-I01-CUR
               MOVE    SPA-SYSYMD  TO  WRK-KJNYMD
               PERFORM 310-CMB-SYOKI-SEC
               PERFORM 4201-INPUT-AREA-CLEAR-SEC
               PERFORM 4101-WIDGET-NYUIN-STT-SEC
      *        ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¥³¥ó¥ÜÀßÄê½èÍý
               MOVE    SPA-SYSYMD      TO  WRK-KJNYMD
               PERFORM 4101-CMB-HKNCOMBI-SET-SEC
      *        ¼õÉÕ¥Þ¥¹¥¿¤è¤êÆþ±¡²ÊÅù¤ò³ÎÄê¤¹¤ë
               MOVE    SPA-SYSYMD  TO  WRK-KJNYMD
               PERFORM 4101-UKETUKE-SEL-SEC
      *        ¼õ¿ÇÍúÎò¸¡º÷½èÍý
               MOVE    SPA-SYSYMD  TO  WRK-KJNYMD
               PERFORM 4101-JYURRK-SEL-SEC
               PERFORM 310-CMB-SYORIKBN-SET2-SEC
      *        ¥Ç¥Õ¥©¥ë¥È¤Î½èÍý¶èÊ¬¤ËÆþ±¡ÅÐÏ¿¤òÀßÄê
               MOVE    SPA-GMN-I01-SYORIKBN-ITM (01)
                                   TO  SPA-GMN-I01-SYORIKBN
           WHEN    2
               MOVE    2           TO  SPA-GMN-I01-CUR
      *
               PERFORM 4101-INPUT-AREA-EDIT2-SEC
               PERFORM 4201-WIDGET-INSENSITIVE-SEC
               MOVE    WIDGET-NORMAL
                                   TO  SPA-GMN-I01-B07-STT
               MOVE    WIDGET-NORMAL
                                   TO  SPA-GMN-I01-B08-STT
               PERFORM 310-CMB-SYORIKBN-SET5-SEC
      *        ¥Ç¥Õ¥©¥ë¥È¤Î½èÍý¶èÊ¬¤Ë¾È²ñ¤òÀßÄê
               MOVE    SPA-GMN-I01-SYORIKBN-ITM (02)
                                   TO  SPA-GMN-I01-SYORIKBN
      *
      *
           WHEN    3
               MOVE    2               TO  SPA-GMN-I01-CUR
               PERFORM 4101-INPUT-AREA-EDIT-SEC
               IF    ( PTNYUINRRK-RRKEDANUM    >   1   )
                   PERFORM 310-CMB-SYORIKBN-SET6-SEC
               ELSE
                   PERFORM 310-CMB-SYORIKBN-SET3-SEC
               END-IF
      *
               PERFORM 4101-WIDGET-HENKOU-STT-SEC
      *        ¥Ç¥Õ¥©¥ë¥È¤Î½èÍý¶èÊ¬¤ËÊÑ¹¹¤òÀßÄê
               MOVE    SPA-GMN-I01-SYORIKBN-ITM (02)
                                   TO  SPA-GMN-I01-SYORIKBN
           WHEN    4
               MOVE    2               TO  SPA-GMN-I01-CUR
               PERFORM 4101-INPUT-AREA-EDIT-SEC
               PERFORM 4201-WIDGET-INSENSITIVE-SEC
               MOVE    WIDGET-NORMAL
                                   TO  SPA-GMN-I01-B07-STT
               MOVE    WIDGET-NORMAL
                                   TO  SPA-GMN-I01-B08-STT
      *
               PERFORM 310-CMB-SYORIKBN-SET4-SEC
      *        ¥Ç¥Õ¥©¥ë¥È¤Î½èÍý¶èÊ¬¤Ë¾È²ñ¤òÀßÄê
               MOVE    SPA-GMN-I01-SYORIKBN-ITM (02)
                                   TO  SPA-GMN-I01-SYORIKBN
      *
           END-EVALUATE
      *
           IF    ( SPA-GMN-I01-NYUREKILST-CNT  >   ZERO )
               MOVE    1           TO  SPA-GMN-I01-NYUREKILST-SEL
                                       SPA-GMN-I01-SELNUM
           END-IF
      *
           MOVE    SPA-GMN-I01-PTNUM   TO  SPA-LAST-PTNUM
           MOVE    SPA-NAI-I01-PTID    TO  SPA-LAST-PTID
      *
           .
      *
       4101-PTINF-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¼õÉÕ¥Þ¥¹¥¿¸¡º÷½èÍý
      *****************************************************************
       4101-UKETUKE-SEL-SEC            SECTION.
      
      *
      *    ¼õÉÕ¥Þ¥¹¥¿¸¡º÷
           MOVE    SPACE               TO  UKETUKE-REC
           INITIALIZE                  UKETUKE-REC
           MOVE    SPA-HOSPID          TO  UKE-HOSPID
           MOVE    WRK-KJNYMD          TO  UKE-UKEYMD
           MOVE    SPA-NAI-I01-PTID    TO  UKE-PTID
      *
           MOVE    UKETUKE-REC         TO  MCPDATA-REC
           MOVE    "UKETUKE-KEY2"      TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           MOVE    ZERO                TO  FLG-UKETUKEGAITO   
      *
           PERFORM UNTIL ( FLG-DBRC    NOT =   ZERO )
               OR        ( FLG-UKETUKEGAITO
                                       NOT =   ZERO )
      *
               MOVE    MCPDATA-REC     TO  UKETUKE-REC
      *
      *        ²ñ·×¤Î¤Þ¤À¤ÎºÇ½é¤Î¼õÉÕ¤òÂÐ¾Ý¤È¤¹¤ë
               IF    ( UKE-KAIKEITIME  =   ZERO )
                   IF    ( SPA-GMN-I01-NYUINKA =   SPACE   )
                       MOVE    1               TO  FLG-UKETUKEGAITO
                       MOVE    UKE-SRYKA       TO  WRK-CMB-CD
                       PERFORM 4103-CMB-NYUINKA-SRH-SEC
                       MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-NYUINKA
                   END-IF
      *
                   IF    ( SPA-GMN-I01-DR (1)  =   SPACE   )
                       MOVE    UKE-DRCD (2 : 4)
                                               TO  WRK-CMB-CD
                       MOVE    1               TO  IDX1
                       PERFORM 4103-CMB-DR-SRH-SEC
                       MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-DR (1)
                   END-IF
               END-IF
      *
               MOVE    "UKETUKE-KEY2"          TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
           END-PERFORM
      *
           MOVE    "UKETUKE-KEY2"      TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
      *
       4101-UKETUKE-SEL-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡Îò¥ê¥¹¥ÈÊÔ½¸½èÍý
      *****************************************************************
       4101-NYUREKILST-EDIT-SEC        SECTION.
      *
      *    ¼«±¡Â¾±¡¥Õ¥é¥°
           MOVE    ZERO            TO  SPA-NAI-I01-TZITA-FLG (IDX1)
      *
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¸¡º÷½èÍý
           INITIALIZE                  SYSKANRI-REC
           MOVE    "5000"          TO  SYS-KANRICD
           MOVE    "*"             TO  SYS-KBNCD
           MOVE    SPA-SYSYMD      TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
           MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
               MOVE    MCPDATA-REC TO  SYS-5000-REC
           ELSE
               INITIALIZE              SYS-5000-REC
           END-IF
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( SYS-5000-REKI-DISPKBN   =   "2" )
               MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
               MOVE    "PTNYUINRRK-KEY4"   TO  WRK-DBPATH
               PERFORM 900-TBL-SELECT-SEC
               IF    ( FLG-DBRC        =   ZERO )
                   MOVE    MCPDATA-REC TO  PTNYUINRRK-REC

               END-IF
      *
      *        ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¥¯¥í¡¼¥º
               MOVE    "PTNYUINRRK-KEY4"
                                       TO  WRK-DBPATH
               PERFORM 900-TBL-CLOSE-SEC
           END-IF
      *
      *    Æ±ÆüºÆÆþ±¡¥Õ¥é¥°
           PERFORM 800-ORCSDNTCHK-SEC
           MOVE    SDNTCHK-DJKBN   TO  SPA-NAI-I01-TDJKBN  (IDX1)
           MOVE    SDNTCHK-STYMD   TO  SPA-NAI-I01-TDJSTYMD(IDX1)
      *
      *    Æþ±¡Îò
           MOVE    PTNYUINRRK-RRKNUM
                                   TO  SPA-NAI-I01-TRRKNUM (IDX1)
      *    ÁªÂòÈÖ¹æ
           MOVE    IDX1            TO  SPA-GMN-I01-TSELNUM (IDX1)
      *
      *    ½é²ó¶èÊ¬
           MOVE    PTNYUINRRK-SHOKAIKBN
                                   TO  SPA-GMN-I01-TSHOKAI (IDX1)
      *
      *    ½é²óÈÖ¹æ
           MOVE    PTNYUINRRK-SHONUM
                                   TO  SPA-GMN-I01-TSHONUM (IDX1)
      *
      *    ÉÂÅï
           INITIALIZE  SYSKANRI-REC
           MOVE    "5001"          TO  SYS-KANRICD
           MOVE    PTNYUINRRK-BTUNUM
                                   TO  SYS-KBNCD
           MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
           MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO )
               MOVE    MCPDATA-REC TO  SYS-5001-REC
               MOVE    SYS-5001-BTU-NAME
                                   TO  SPA-GMN-I01-TBTUNAME (IDX1)
           END-IF
           MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    ÉÂ¼¼ÈÖ¹æ
           IF    ( PTNYUINRRK-BRMNUM (3 : 6)
                                   IS  NUMERIC )
               MOVE    PTNYUINRRK-BRMNUM (3 : 6)
                                   TO   WRK-999999
               MOVE    WRK-999999
                                   TO   WRK-ZZZZZ9
               MOVE    WRK-ZZZZZ9
                                   TO  SPA-GMN-I01-TBRMNUM (IDX1)
           ELSE
               MOVE    PTNYUINRRK-BRMNUM ( 3 : 6 )
                                   TO  SPA-GMN-I01-TBRMNUM (IDX1)
           END-IF
      *
      *    Æþ±¡Æü
           MOVE    PTNYUINRRK-NYUINYMD
                                   TO  WRK-YMD
           PERFORM 5002-HIZUKE-CHK-SEC
           MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-TNYUINYMD (IDX1)
           MOVE    PTNYUINRRK-NYUINYMD
                                   TO  SPA-NAI-I01-TNYUINYMD (IDX1)
      *
      *    Âà±¡Æü
           IF    ( PTNYUINRRK-TAIINYMD   =   "99999999" )
               MOVE    SPACE   TO  SPA-GMN-I01-TTAIINYMD (IDX1)
                                   SPA-NAI-I01-TTAIINYMD (IDX1)
           ELSE
               MOVE    PTNYUINRRK-TAIINYMD
                                   TO  WRK-YMD
               PERFORM 5002-HIZUKE-CHK-SEC
               MOVE    WRK-HENYMDG TO  SPA-GMN-I01-TTAIINYMD (IDX1)
               MOVE    PTNYUINRRK-TAIINYMD
                                   TO  SPA-NAI-I01-TTAIINYMD (IDX1)
           END-IF
      *
      *    ¿ÇÎÅ²Ê
           INITIALIZE  SYSKANRI-REC
           MOVE    "1005"          TO  SYS-KANRICD
           MOVE    PTNYUINRRK-NYUINKA
                                   TO  SYS-KBNCD
           MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
           MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO )
               MOVE    MCPDATA-REC TO  SYS-1005-REC
               MOVE    SYS-1005-SRYKANAME
                                   TO  SPA-GMN-I01-TNYUINKA (IDX1)
           END-IF
           MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *------------
           MOVE    ZERO            TO  WRK-REKI-BYO-ZITA-FLG (IDX1)
           MOVE    PTNYUINRRK-NYUINYMD
                                   TO  WRK-REKI-BYO-NYUINYMD  (IDX1)
      *
           IF    ( PTNYUINRRK-TAIINYMD   =   "99999999" )
               MOVE    "99999999"
                                   TO  WRK-REKI-BYO-TAIINYMD (IDX1)
           ELSE
               MOVE    PTNYUINRRK-TAIINYMD
                                   TO  WRK-REKI-BYO-TAIINYMD (IDX1)
           END-IF
      *
           MOVE    PTNYUINRRK-NYUINKA
                                   TO  WRK-REKI-BYO-NYUINKA (IDX1)
      *
           .
      *
       4101-NYUREKILST-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡Îò¥ê¥¹¥ÈÊÔ½¸½èÍý(Æþ±¡Îò¤òÊÔ½¸)
      *****************************************************************
       4101-NYUREKILST-EDIT2-SEC       SECTION.
      *
      *    ¼«±¡Â¾±¡¥Õ¥é¥°
           IF    ( PTNYUINRRK-JTIKBN   =   "5" )
               MOVE    1           TO  SPA-NAI-I01-TZITA-FLG (IDX1)
           ELSE
               MOVE    2           TO  SPA-NAI-I01-TZITA-FLG (IDX1)
           END-IF
      *
      *    Æ±ÆüºÆÆþ±¡¥Õ¥é¥°
           PERFORM 800-ORCSDNTCHK-SEC
           MOVE    SDNTCHK-DJKBN   TO  SPA-NAI-I01-TDJKBN  (IDX1)
           MOVE    SDNTCHK-STYMD   TO  SPA-NAI-I01-TDJSTYMD(IDX1)
      *
      *    Æþ±¡Îò
           MOVE    PTNYUINRRK-RRKNUM
                                   TO  SPA-NAI-I01-TRRKNUM (IDX1)
      *    ÁªÂòÈÖ¹æ
           MOVE    IDX1            TO  SPA-GMN-I01-TSELNUM (IDX1)
      *
      *    ½é²ó¶èÊ¬
           MOVE    PTNYUINRRK-SHOKAIKBN
                                   TO  SPA-GMN-I01-TSHOKAI (IDX1)
      *
      *    ½é²óÈÖ¹æ
           MOVE    PTNYUINRRK-SHONUM
                                   TO  SPA-GMN-I01-TSHONUM (IDX1)
      *
      *    ÉÂÅï
           MOVE    PTNYUINRRK-BTUNAME
                                   TO  SPA-GMN-I01-TBTUNAME (IDX1)
      *
      *    ÉÂ¼¼ÈÖ¹æ¡Ê¼«±¡Îò¡¿Â¾±¡Îò¡Ë¤òÉ½¼¨
           EVALUATE    PTNYUINRRK-JTIKBN
           WHEN    "5"
               MOVE    "Â¾±¡Îò"    TO  SPA-GMN-I01-TBRMNUM (IDX1)
           WHEN    "6"
               MOVE    "¼«±¡Îò"    TO  SPA-GMN-I01-TBRMNUM (IDX1)
           END-EVALUATE
      *
      *    Æþ±¡Æü
           MOVE    PTNYUINRRK-NYUINYMD
                                   TO  WRK-YMD
           PERFORM 5002-HIZUKE-CHK-SEC
           MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-TNYUINYMD (IDX1)
           MOVE    PTNYUINRRK-NYUINYMD
                                   TO  SPA-NAI-I01-TNYUINYMD (IDX1)
      *
      *    Âà±¡Æü¡ÊºÇ¿·¤Î¾ðÊó¤ò¼èÆÀ¡Ë
           IF    ( PTNYUINRRK-TAIINYMD     =   "99999999" )
               MOVE    SPACE       TO  SPA-GMN-I01-TTAIINYMD (IDX1)
                                       SPA-NAI-I01-TTAIINYMD (IDX1)
           ELSE
               MOVE    PTNYUINRRK-TAIINYMD
                                   TO  WRK-YMD
               PERFORM 5002-HIZUKE-CHK-SEC
               MOVE    WRK-HENYMDG TO  SPA-GMN-I01-TTAIINYMD (IDX1)
      *
               MOVE    PTNYUINRRK-TAIINYMD
                                   TO  SPA-NAI-I01-TTAIINYMD (IDX1)
           END-IF
      *
           IF    ( PTNYUINRRK-JTIKBN       =   "6" )
            AND  ( PTNYUINRRK-NYUINCHUKBN  =   "1" )
               MOVE    "*"         TO  SPA-GMN-I01-TTAIINYMD (IDX1)
                                                             (10:)
           END-IF
      *
      *    ÄÌ»»ÂÐ¾ÝÆü¿ô
           MOVE    PTNYUINRRK-TAISYONISSU
                                   TO  SPA-NAI-I01-TNYURRKTAISYO (IDX1)
      *
      *    ÉÂÌ¾
           INITIALIZE  PTTAINFUKA-REC
           MOVE    SPA-HOSPID      TO  PTTAINFUKA-HOSPID
           MOVE    PTNYUINRRK-PTID
                                   TO  PTTAINFUKA-PTID
           MOVE    PTNYUINRRK-RRKNUM
                                   TO  PTTAINFUKA-RRKNUM
           MOVE    PTTAINFUKA-REC  TO  MCPDATA-REC
           MOVE    "PTTAINFUKA-KEY"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
               MOVE    MCPDATA-REC TO  PTTAINFUKA-REC
               MOVE    PTTAINFUKA-BYOMEI (1)
                                   TO  WRK-REKI-BYO-BYOMEI (IDX1)
           END-IF
      *
           MOVE    "PTTAINFUKA-KEY"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           MOVE    1               TO  WRK-REKI-BYO-ZITA-FLG (IDX1)
           MOVE    SPACE           TO  WRK-REKI-BYO-NYUINYMD  (IDX1)
                                       WRK-REKI-BYO-TAIINYMD (IDX1)
                                       WRK-REKI-BYO-TAIINYMD  (IDX1)
                                       WRK-REKI-BYO-NYUINKA (IDX1)
           .
      *
       4101-NYUREKILST-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ¼çÉÂÌ¾ÊÔ½¸½èÍý
      *****************************************************************
       4101-SYUBYOMEI-EDIT-SEC        SECTION.
      *
      *    ´µ¼ÔÉÂÌ¾¥Þ¥¹¥¿¸¡º÷
           INITIALIZE  PTBYOMEI-REC
           MOVE    SPA-HOSPID          TO  PTBYO-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTBYO-PTID
           MOVE    PTBYOMEI-REC        TO  MCPDATA-REC
           MOVE    "PTBYOMEI-KEY3"     TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM UNTIL ( FLG-DBRC    NOT =   ZERO )
      *
               MOVE    MCPDATA-REC     TO  PTBYOMEI-REC
      *
      *        Æþ±¡ÉÂÌ¾¤Î¤ß¤òÂÐ¾Ý¤È¤¹¤ë
               IF    ( PTBYO-NYUGAIKBN =   "1" )
      *            ÂÐ¾Ý¤Î¼çÉÂÌ¾¤ò¥ï¡¼¥¯¥¨¥ê¥¢¤ËÂàÈò¤¹¤ë
                   PERFORM 4101-SYUBYOMEI-TAIHI-SEC
               END-IF
      *
      *        ´µ¼ÔÉÂÌ¾¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß
               MOVE    "PTBYOMEI-KEY3" TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
      *    ´µ¼ÔÉÂÌ¾¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "PTBYOMEI-KEY3"     TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    Æþ±¡Îò¥ê¥¹¥È¤Î¼çÉÂÌ¾¤ÎÊÔ½¸¤ò¹Ô¤¦
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-NYUREKILST-CNT )
      *
               IF    ( WRK-REKI-BYO-BYOMEI (IDX1)  NOT =   SPACE )
                   MOVE    WRK-REKI-BYO-BYOMEI (IDX1)
                                       TO  SPA-GMN-I01-TBYOMEI (IDX1)
                   EVALUATE    WRK-REKI-BYO-TENKIKBN (IDX1)
                   WHEN "1"
                       MOVE    "¼£¤æ"  TO  SPA-GMN-I01-TTENKI (IDX1)
                   WHEN "2"
                       MOVE    "»àË´"  TO  SPA-GMN-I01-TTENKI (IDX1)
                   WHEN "3"
                       MOVE    "Ãæ»ß"  TO  SPA-GMN-I01-TTENKI (IDX1)
                   WHEN "4"
                       MOVE    "°Ü¹Ô"  TO  SPA-GMN-I01-TTENKI (IDX1)
                   END-EVALUATE
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4101-SYUBYOMEI-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ¼çÉÂÌ¾ÂàÈò½èÍý
      *****************************************************************
       4101-SYUBYOMEI-TAIHI-SEC        SECTION.
      *
      *    Æþ±¡»þ¤Î¿ÇÎÅ²Ê¤Ç¡¢Æþ±¡´ü´ÖÃæ¤Ë¿ÇÎÅ³«»ÏÆü¤¬¤¢¤ë
      *    ¼çÉÂÌ¾¤Ç¡¢ÆüÉÕ¤¬ºÇ¤â¸Å¤¤¤â¤Î¤ò¼èÆÀ¤¹¤ë
           SET     WRK-RRKBYO-IDX  TO  1
           SEARCH  WRK-REKI-BYOMEI-EDIT-OCC
               VARYING WRK-RRKBYO-IDX
           WHEN  ( WRK-RRKBYO-IDX  >  SPA-GMN-I01-NYUREKILST-CNT )
               CONTINUE
           WHEN  ( WRK-REKI-BYO-ZITA-FLG (WRK-RRKBYO-IDX)
                                   =  ZERO             )
             AND ( WRK-REKI-BYO-NYUINYMD (WRK-RRKBYO-IDX)
                                  <=   PTBYO-SRYYMD    )
             AND ( WRK-REKI-BYO-TAIINYMD (WRK-RRKBYO-IDX)
                                  >=   PTBYO-SRYYMD    )
             AND ( WRK-REKI-BYO-NYUINKA  (WRK-RRKBYO-IDX)
                                   =   PTBYO-SRYKA     )
             AND ( PTBYO-SYUBYOFLG =   "1"             )
      *
               MOVE    ZERO        TO  FLG-TAISYO
               EVALUATE    TRUE
               WHEN    ( WRK-REKI-BYO-SRYYMD (WRK-RRKBYO-IDX)
                                   = SPACE )
                   MOVE    1       TO  FLG-TAISYO
               WHEN    ( WRK-REKI-BYO-SRYYMD (WRK-RRKBYO-IDX)
                                   >   PTBYO-SRYYMD    )
                   MOVE    1       TO  FLG-TAISYO
               WHEN    ( WRK-REKI-BYO-SRYYMD (WRK-RRKBYO-IDX)
                                   =   PTBYO-SRYYMD    )
      *            Æ±°ìÆü¤Î¾ì¹ç¤ÏÏ¢ÈÖ¤Î¾®¤µ¤¤Êý¤ò¼èÆÀ
                   IF  ( WRK-REKI-BYO-RENNUM (WRK-RRKBYO-IDX)
                                   >   PTBYO-RENNUM )
                       MOVE    1       TO  FLG-TAISYO
                   END-IF
      *
               END-EVALUATE
      *
      *
               IF    ( FLG-TAISYO  =   "1" )
                   MOVE    PTBYO-RENNUM
                       TO  WRK-REKI-BYO-RENNUM (WRK-RRKBYO-IDX)
                   MOVE    PTBYO-SRYYMD
                       TO  WRK-REKI-BYO-SRYYMD (WRK-RRKBYO-IDX)
                   MOVE    PTBYO-BYOMEI
                       TO  WRK-REKI-BYO-BYOMEI (WRK-RRKBYO-IDX)
                   MOVE    PTBYO-TENKIKBN
                       TO  WRK-REKI-BYO-TENKIKBN (WRK-RRKBYO-IDX)
               END-IF
      *
           END-SEARCH
           .
      *
       4101-SYUBYOMEI-TAIHI-EXT.
           EXIT.
      *****************************************************************
      *    Æü¿ôÊÔ½¸½èÍý½èÍý
      *****************************************************************
       4101-NISSU-EDIT-SEC             SECTION.
      *
           PERFORM VARYING IDX1
                   FROM    SPA-GMN-I01-NYUREKILST-CNT
                   BY      -1
                   UNTIL ( IDX1    <   1 )
      *
               IF    ( SPA-GMN-I01-TSHOKAI (IDX1)  =   "1" )
                   MOVE    ZERO    TO  WRK-TSUSAN
                   MOVE    SPA-GMN-I01-TSHONUM (IDX1)
                                   TO  WRK-CHK-SHONUM
                   PERFORM VARYING IDX2    FROM    IDX1    BY  -1
                           UNTIL ( IDX2    <   1 )
      *
                       PERFORM 4101-NISSU-EDIT2-SEC
      *
                   END-PERFORM
               END-IF
           END-PERFORM
      *
           IF    ( SPA-GMN-I01-NYUREKILST-CNT  <= ZERO )
               GO  TO  4101-NISSU-EDIT-EXT
           END-IF
      *
           INITIALIZE                      PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID
                                       TO  PTNYUINRRK-PTID
           MOVE    SPA-NAI-I01-TNYUINYMD (SPA-GMN-I01-NYUREKILST-CNT)
                                       TO  PTNYUINRRK-NYUINYMD
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY31"  TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
           ELSE
               INITIALIZE                  PTNYUINRRK-REC
           END-IF
      *
           PERFORM UNTIL ( FLG-DBRC    NOT =   ZERO )
      *
               PERFORM 800-ORCSDNTCHK-SEC
      *
               MOVE    ZERO            TO  WRK-TSUSAN
               MOVE    PTNYUINRRK-SHONUM
                                       TO  WRK-CHK-SHONUM
      *
               PERFORM UNTIL ( PTNYUINRRK-SHONUM
                                           NOT =   WRK-CHK-SHONUM )
                        OR   ( FLG-DBRC    NOT =   ZERO )
      *
                   IF    ( PTNYUINRRK-JTIKBN   =   "5" )
                           COMPUTE WRK-TSUSAN
                               =   WRK-TSUSAN
                               +   PTNYUINRRK-TAISYONISSU
                   ELSE
                       IF    ( SDNTCHK-STYMD   NOT =   ZERO )
                           MOVE    SDNTCHK-STYMD
                                       TO  WRK-STYMD
                           MOVE    PTNYUINRRK-TAIINYMD
                                       TO  WRK-EDYMD
                           PERFORM 5002-KIKAN-CALC-SEC
                           IF    ( FLG-ORCSDAY =   ZERO )
                               COMPUTE WRK-TSUSAN
                                   =   WRK-TSUSAN
                                   +   WRK-NISSU2
                           END-IF
                       END-IF
                   END-IF
      *
                   MOVE    "PTNYUINRRK-KEY31"  TO  WRK-DBPATH
                   PERFORM 900-TBL-READ-SEC
                   IF    ( FLG-DBRC        =   ZERO )
                       MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
                   ELSE
                       INITIALIZE                  PTNYUINRRK-REC
                   END-IF
      *
               END-PERFORM
      *
               PERFORM VARYING IDX2    
                       FROM    SPA-GMN-I01-NYUREKILST-CNT
                       BY      -1
                       UNTIL ( IDX2    <   1 )
      *
                   PERFORM 4101-NISSU-EDIT2-SEC
      *
               END-PERFORM
      *
           END-PERFORM
      *
           MOVE    "PTNYUINRRK-KEY31"  TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4101-NISSU-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Æü¿ôÊÔ½¸½èÍý½èÍý¡ÊÂÐ¾Ý¥Á¥§¥Ã¥¯¡Ë
      *****************************************************************
       4101-NISSU-EDIT2-SEC            SECTION.
      *
           IF    ( WRK-CHK-SHONUM  NOT =   SPA-GMN-I01-TSHONUM (IDX2) )
               GO  TO  4101-NISSU-EDIT2-EXT
           END-IF
      *
           IF    ( IDX2    =   1 )
             AND ( SPA-NAI-I01-TNYUINYMD (IDX2)
                               =   SPACE )
               GO  TO  4101-NISSU-EDIT2-EXT
           END-IF
      *
           MOVE    SPA-NAI-I01-TNYUINYMD (IDX2)
                           TO  WRK-STYMD
           MOVE    SPA-NAI-I01-TTAIINYMD (IDX2)
                           TO  WRK-EDYMD
           PERFORM 5002-KIKAN-CALC-SEC
           IF    ( FLG-ORCSDAY =   ZERO )
               IF    ( SPA-NAI-I01-TZITA-FLG (IDX2)
                               =   ZERO )
                   MOVE    WRK-NISSU2
                               TO  WRK-NISSU
      *
                   IF    ( SPA-NAI-I01-TDJKBN (IDX2)   =   SPACE )
                       COMPUTE WRK-TSUSAN
                           =   WRK-TSUSAN  +   WRK-NISSU2
                   ELSE
                       COMPUTE WRK-TSUSAN
                           =   WRK-TSUSAN  +   WRK-NISSU2  -   1
                   END-IF
      *
               ELSE
                   MOVE    SPA-NAI-I01-TNYURRKTAISYO (IDX2)
                               TO  WRK-NISSU
                   COMPUTE WRK-TSUSAN
                       =   WRK-TSUSAN
                       +   SPA-NAI-I01-TNYURRKTAISYO (IDX2)
      *
               END-IF
               MOVE    WRK-NISSU   TO  WRK-ZZZZ9
               MOVE    WRK-ZZZZ9   TO  SPA-GMN-I01-TNISSU (IDX2)
               MOVE    WRK-TSUSAN  TO  WRK-ZZZZ9
               MOVE    WRK-ZZZZ9   TO  SPA-GMN-I01-TTUSAN (IDX2)
           END-IF
      *
           .
       4101-NISSU-EDIT2-EXT.
           EXIT.
      *****************************************************************
      *    Ç¯Îð»»½Ð½èÍý
      *****************************************************************
       4101-AGE-CALC-SEC               SECTION.
      *
           IF  (   WRK-BIRTHDAY    <   SPA-SYSYMD )
               MOVE    WRK-BIRTHDAY    TO  WRK-CALC-YMD1
               MOVE    SPA-SYSYMD      TO  WRK-CALC-YMD2
           ELSE
               MOVE    SPA-SYSYMD      TO  WRK-CALC-YMD1
               MOVE    WRK-BIRTHDAY    TO  WRK-CALC-YMD2
           END-IF
      *
           COMPUTE WRK-AGE-YY          =   WRK-CALC-YY2
                                       -   WRK-CALC-YY1
           IF    ( WRK-CALC-YMD1(5:4)  >   WRK-CALC-YMD2(5:4) )
               COMPUTE WRK-AGE-YY      =   WRK-AGE-YY
                                       -   1
               COMPUTE WRK-AGE-MM      =  (WRK-CALC-MM2    +   12 )
                                       -   WRK-CALC-MM1
           ELSE
               COMPUTE WRK-AGE-MM      =   WRK-CALC-MM2
                                       -   WRK-CALC-MM1
           END-IF
      *
           IF    ( WRK-CALC-DD1        >   WRK-CALC-DD2 )
               COMPUTE WRK-AGE-MM      =   WRK-AGE-MM
                                       -   1
           END-IF
      *
           IF  (   WRK-BIRTHDAY    <   SPA-SYSYMD )
               CONTINUE
           ELSE
               COMPUTE WRK-AGE-YY  =   WRK-AGE-YY
                                   *   -1
               COMPUTE WRK-AGE-MM  =   WRK-AGE-MM
                                   *   -1
           END-IF
      *
           IF    ( WRK-AGE-YY          =   ZERO )
               MOVE    WRK-AGE-MM      TO  WRK-AGE-Z
               MOVE    "¥ö·î"          TO  WRK-AGE-MEI
           ELSE
               MOVE    WRK-AGE-YY      TO  WRK-AGE-Z
               MOVE    "ºÍ"            TO  WRK-AGE-MEI
           END-IF
      *
           .
       4101-AGE-CALC-EXT.
           EXIT.
      *****************************************************************
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¥³¥ó¥ÜÀßÄê½èÍý
      *****************************************************************
       4101-CMB-HKNCOMBI-SET-SEC       SECTION.
      *
           INITIALIZE                  SPA-GMN-I01-CMB-HKNCOMBI
                                       SPA-KYOTUKEY
                                       SPA-KYOTU-SET
                                       ORCSHKNSETAREA
      *
           MOVE    WRK-KJNYMD          TO  SPA-SRYYMD
           MOVE    SPA-GMN-I01-NYUINKA-CD
                                       TO  SPA-SRYKA
           MOVE    "1"                 TO  SPA-NYUGAIKBN
           MOVE    SPA-NAI-I01-PTID    TO  SPA-PTID
           MOVE    SPA-NAI-I01-BIRTHDAY
                                       TO  SPA-BIRTHDAY
           MOVE    SPA-GMN-I01-HKNCOMBI-CD
                                       TO  SPA-HKNCOMBINUM
           MOVE    "1"                 TO  ORCSHKN-KBN
      *
           CALL    "ORCSHKNSET"        USING   SPA-AREA
                                               ORCSHKNSETAREA
           IF    ( ORCSHKN-ERRCD   NOT =   ZERO )
               GO  TO  4101-CMB-HKNCOMBI-SET-EXT
           END-IF
      *
           IF    ( ORCSHKN-HKN-MAX     >   30 )
               MOVE    30              TO  SPA-GMN-I01-HKNCOMBI-CNT
           ELSE
               MOVE    ORCSHKN-HKN-MAX TO  SPA-GMN-I01-HKNCOMBI-CNT
           END-IF
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL ( IDX1    >   SPA-GMN-I01-HKNCOMBI-CNT )

               MOVE    ORCSHKN-GMN-HKNCOMBINUM (IDX1)
                                       TO  SPA-GMN-I01-HKNCOMBI-ITM
                                                       (IDX1)(1 : 4)
               MOVE    ORCSHKN-GMN-HKNCOMBIMEI (IDX1)
                                       TO  SPA-GMN-I01-HKNCOMBI-ITM
                                                       (IDX1)(6 : )
               MOVE    ORCSHKN-GMN-FTNRATEMEI  (IDX1)
                                       TO  SPA-GMN-I01-HKNCOMBI-ITM2
                                                       (IDX1)
               MOVE    ORCSHKN-NAI-RSI-HKNKBN (IDX1)
                                       TO  SPA-GMN-I01-HKNCOMBI-ITM3
                                                       (IDX1)
      *
           END-PERFORM
      *
           IF    ( ORCSHKN-IDX    >=   1 )
            AND  ( ORCSHKN-IDX    <=   SPA-GMN-I01-HKNCOMBI-CNT )
               MOVE    SPA-GMN-I01-HKNCOMBI-ITM (ORCSHKN-IDX)
                                       TO  SPA-GMN-I01-HKNCOMBI
               MOVE    SPA-GMN-I01-HKNCOMBI-ITM2 (ORCSHKN-IDX)
                                       TO  SPA-NAI-I01-FTNRATE
               MOVE    SPA-GMN-I01-HKNCOMBI-ITM3 (ORCSHKN-IDX)
                                       TO  SPA-NAI-I01-RSI-HKNKBN
           END-IF
      *
           .
       4101-CMB-HKNCOMBI-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¸¡º÷½èÍý
      *****************************************************************
       4101-JYURRK-SEL-SEC           SECTION.
      *
           MOVE    SPACE           TO  WKJYURRK-REC
      *
      *    ¼õ¿ÇÍúÎò¸¡º÷
           INITIALIZE                  JYURRK-REC
           MOVE    SPA-HOSPID      TO  JYURRK-HOSPID
           MOVE    SPA-NAI-I01-PTID
                                   TO  JYURRK-PTID
           MOVE    WRK-KJNYMD      TO  JYURRK-SRYYMD
           MOVE    JYURRK-REC      TO  MCPDATA-REC
           MOVE    "JYURRK-KEY10"  TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM
               UNTIL ( FLG-DBRC        NOT =   ZERO )
                OR   ( WKJYURRK-REC    NOT =   SPACE )
      *
               MOVE    MCPDATA-REC TO  JYURRK-REC  
      *
      *        ºÇ¸å¤Î¼õ¿ÇÍúÎò¤òÂÐ¾Ý¤È¤¹¤ë¡Ê¿ÇÎÅÆü°ÊÁ°¤Î¤â¤Î¡Ë
               IF    ((SPA-GMN-I01-NYUINKA     NOT =   SPACE  )
                  AND (SPA-GMN-I01-NYUINKA-CD      =   JYURRK-SRYKA ) )
                OR    ( SPA-GMN-I01-NYUINKA        =   SPACE        )
                   MOVE    JYURRK-REC  TO  WKJYURRK-REC
               END-IF
      *
      *        ¼õ¿ÇÍúÎòÆÉ¹þ
               MOVE    "JYURRK-KEY10"      TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
      *    ¼õ¿ÇÍúÎò¥¯¥í¡¼¥º
           MOVE    "JYURRK-KEY10"      TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( WKJYURRK-REC        =   SPACE )
               GO  TO  4101-JYURRK-SEL-EXT
           END-IF
      *
           MOVE    WKJYURRK-REC        TO  JYURRK-REC 
      *
      *    Æþ±¡²Ê
           IF    ( SPA-GMN-I01-NYUINKA =   SPACE )
               MOVE    JYURRK-SRYKA    TO  WRK-CMB-CD
               PERFORM 4103-CMB-NYUINKA-SRH-SEC
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-NYUINKA
           END-IF
      *
      *    ¼ç¼£°å
           IF    ( SPA-GMN-I01-DR (1)  =   SPACE )
               MOVE    JYURRK-DRCD (2 : 4) 
                                       TO  WRK-CMB-CD
               MOVE    1               TO  IDX1
               PERFORM 4103-CMB-DR-SRH-SEC
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-DR (1)
           END-IF
      *
           .
       4101-JYURRK-SEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½èÍý¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SYORIKBN-CHK-SEC           SECTION.
      *
           MOVE    2               TO  SPA-GMN-I01-CUR
      *
           MOVE    SPACE           TO  SPA-GMN-I01-ERRCD (2)
      *
           MOVE    I01-SYORIKBN    TO  SPA-GMN-I01-SYORIKBN
      *
           IF    ( SPA-GMN-I01-SYORIKBN    =   SPACE )
               MOVE    "1002"      TO  SPA-ERRCD
               MOVE    SPA-ERRCD   TO  SPA-GMN-I01-ERRCD (2)
               GO  TO  4101-SYORIKBN-CHK-EXT
           END-IF
      *
      *    ½èÍý¶èÊ¬¥µ¡¼¥Á
           MOVE    SPA-GMN-I01-SYORIKBN-CD
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-SYORIKBN-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-SYORIKBN
           ELSE
               MOVE    "0012"      TO  SPA-ERRCD
               MOVE    SPA-ERRCD           TO  SPA-GMN-I01-ERRCD (2)
               MOVE    2           TO  SPA-GMN-I01-CUR
               GO  TO  4101-SYORIKBN-CHK-EXT
           END-IF
      *
           MOVE    SPACE           TO  SPA-GMN-I01-IDOYMD
                                       SPA-NAI-I01-IDOYMD
                                       SPA-NAI-I01-IDOYMD-MAE
      *
      *    Æþ±¡Îò¥Ü¥¿¥ó¤Î¾õÂÖ¤òÂàÈò
           MOVE    SPA-GMN-I01-B07-STT
                                   TO  WRK-WIDGET-B07-STT
           MOVE    SPA-GMN-I01-B08-STT
                                   TO  WRK-WIDGET-B08-STT
      *
      *    ¥³¥é¥à¥ê¥¹¥È¤ÎÁªÂò°ÌÃÖ¤òÂàÈò
           MOVE    SPA-GMN-I01-NYUREKILST-SEL
                                   TO  WRK-NYUREKILST-SEL
      *
           INITIALIZE              SPA-GMN-I01-INPUT-AREA
                                   SPA-NAI-I01-INPUT-AREA
      *
      *    Æþ±¡ÍúÎò¥Þ¥¹¥¿¸¡º÷½èÍý¡ÊÆþÎÏÎÎ°èÉ½¼¨ÍÑ¡Ë
           PERFORM 4101-PTNYUINRRK-SEL1-SEC
           IF    ( FLG-PTNYUINRRK  =   ZERO  )
      *        ÆþÎÏÎÎ°èÊÔ½¸½èÍý
               IF    ( PTNYUINRRK-JTIKBN   =   "5" OR "6" )
                   PERFORM 4101-INPUT-AREA-EDIT2-SEC
               ELSE
                   PERFORM 4101-INPUT-AREA-EDIT-SEC
               END-IF
           END-IF
      *
           IF    ( FLG-PTNYUINRRK  NOT =   ZERO  )
            OR   ( SPA-GMN-I01-SYORIKBN-CD =   "01" )    
               PERFORM 4201-INPUT-AREA-CLEAR-SEC
      *        ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¥³¥ó¥ÜÀßÄê½èÍý
               MOVE    SPA-SYSYMD      TO  WRK-KJNYMD
               PERFORM 4101-CMB-HKNCOMBI-SET-SEC
           END-IF
      *
      *    ½èÍý¶èÊ¬±þ¤¸¤Æ²èÌÌÊÔ½¸¤ÎÆâÍÆ¤òÊÑ¹¹¤¹¤ë
           EVALUATE    SPA-GMN-I01-SYORIKBN-CD
      *    Æþ±¡ÅÐÏ¿
           WHEN    "01"
      *
      *        ¥³¥ó¥Ü¥Ü¥Ã¥¯¥¹½é´ü½èÍý
               MOVE    SPA-SYSYMD      TO  WRK-KJNYMD
               PERFORM 310-CMB-SYOKI-SEC
      *
      *        ¼õÉÕ¥Þ¥¹¥¿¤è¤êÆþ±¡²ÊÅù¤ò³ÎÄê¤¹¤ë
               MOVE    SPA-SYSYMD      TO  WRK-KJNYMD
               PERFORM 4101-UKETUKE-SEL-SEC
      *        ¼õ¿ÇÍúÎò¸¡º÷½èÍý
               MOVE    SPA-SYSYMD      TO  WRK-KJNYMD
               PERFORM 4101-JYURRK-SEL-SEC
               PERFORM 4101-WIDGET-NYUIN-STT-SEC
      *    Âà±¡ÅÐÏ¿
           WHEN    "02"
      *
      *        Âà±¡Æü¤Ë¥·¥¹¥Æ¥àÆüÉÕ¤«Á°²ó°ÛÆ°Æü¤ÇÆüÉÕ¤Î¿·¤·¤¤Êý¤òÉ½¼¨
               IF    ( SPA-SYSYMD      >   SPA-NAI-I01-MAEIDOYMD )
                   MOVE    SPA-SYSYMD      TO  WRK-YMD
               ELSE
                   MOVE    SPA-NAI-I01-MAEIDOYMD
                                           TO  WRK-YMD
               END-IF
               PERFORM 5002-HIZUKE-CHK-SEC
               MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-TAIINYMD
               MOVE    WRK-SYMD        TO  SPA-NAI-I01-TAIINYMD
      *        ¥³¥ó¥Ü¥Ü¥Ã¥¯¥¹½é´ü½èÍý
               MOVE    SPA-NAI-I01-TAIINYMD
                                       TO  WRK-KJNYMD
               PERFORM 310-CMB-SYOKI-SEC
      *
               PERFORM 4101-WIDGET-TAIIN-STT-SEC
      *
      *
      *    ÊÑ¹¹
           WHEN    "03"
               PERFORM 4101-WIDGET-HENKOU-STT-SEC
      *    ¾È²ñ
           WHEN    "04"
               PERFORM 4201-WIDGET-INSENSITIVE-SEC
      *    Å¾²Ê¡¡Å¾Åï¡¡Å¾¼¼
           WHEN    "08"
      *
      *        °ÛÆ°Æü¤Ë¥·¥¹¥Æ¥àÆüÉÕ¤«Á°²ó°ÛÆ°Æü¤ÇÆüÉÕ¤Î¿·¤·¤¤Êý¤òÉ½¼¨
               IF    ( SPA-SYSYMD      >   SPA-NAI-I01-MAEIDOYMD )
                   MOVE    SPA-SYSYMD      TO  WRK-YMD
               ELSE
                   MOVE    SPA-NAI-I01-MAEIDOYMD
                                           TO  WRK-YMD
               END-IF
               PERFORM 5002-HIZUKE-CHK-SEC
               MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-IDOYMD
               MOVE    WRK-SYMD        TO  SPA-NAI-I01-IDOYMD
                                           SPA-NAI-I01-IDOYMD-MAE
      *
      *        ¥³¥ó¥Ü¥Ü¥Ã¥¯¥¹½é´ü½èÍý
               MOVE    SPA-NAI-I01-IDOYMD
                                       TO  WRK-KJNYMD
               PERFORM 310-CMB-SYOKI-SEC
      *
      *        ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¥³¥ó¥ÜÀßÄê½èÍý
               MOVE    SPA-NAI-I01-IDOYMD
                                       TO  WRK-KJNYMD
               PERFORM 4101-CMB-HKNCOMBI-SET-SEC
      *
      *        ¼õÉÕ¥Þ¥¹¥¿¤è¤êÆþ±¡²ÊÅù¤ò³ÎÄê¤¹¤ë
               MOVE    SPA-SYSYMD      TO  WRK-KJNYMD
               PERFORM 4101-UKETUKE-SEL-SEC
      *        ¼õ¿ÇÍúÎò¸¡º÷½èÍý
               MOVE    SPA-NAI-I01-IDOYMD
                                       TO  WRK-KJNYMD
               PERFORM 4101-JYURRK-SEL-SEC
      *
               IF    ( SPA-NAI-I01-NYURRK-FLG   = ZERO )
                   PERFORM 4102-KIHON-CHK-SEC
               END-IF
      *
               PERFORM 4101-WIDGET-TENKA-STT-SEC
      *
      *    ¾È²ñ
           WHEN    "10"
               PERFORM 4201-WIDGET-INSENSITIVE-SEC
               MOVE    WIDGET-NORMAL   TO  SPA-GMN-I01-B12-STT
      *    ¤½¤ÎÂ¾
           WHEN    OTHER
               PERFORM 4201-WIDGET-INSENSITIVE-SEC
               MOVE    WIDGET-NORMAL   TO  SPA-GMN-I01-B12-STT
           END-EVALUATE
      *
      *    Æþ±¡Îò¥Ü¥¿¥ó¤Î¾õÂÖ¤ò¸µ¤Ë¤â¤É¤¹
           MOVE    WRK-WIDGET-B07-STT  TO  SPA-GMN-I01-B07-STT
           MOVE    WRK-WIDGET-B08-STT  TO  SPA-GMN-I01-B08-STT
      *
           IF    ( SPA-GMN-I01-SYORIKBN-CD     =   "10" )
               MOVE    WRK-NYUREKILST-SEL
                                       TO  SPA-GMN-I01-NYUREKILST-SEL
                                           SPA-GMN-I01-SELNUM
           ELSE
               IF    ( SPA-GMN-I01-NYUREKILST-CNT  >   ZERO )
                   MOVE    1           TO  SPA-GMN-I01-NYUREKILST-SEL
                                           SPA-GMN-I01-SELNUM
               END-IF
           END-IF
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¤¬Â¸ºß¤·¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-GMN-I01-SYORIKBN-CD     =   "01" )
               IF    ( SPA-GMN-I01-HKNCOMBI-CNT   >   ZERO )
                   CONTINUE
               ELSE
                   MOVE    "1021"      TO  SPA-ERRCD
                   MOVE    1           TO  SPA-GMN-I01-CUR
                   GO  TO  4101-SYORIKBN-CHK-EXT
               END-IF
           END-IF
      *
           EVALUATE SPA-GMN-I01-SYORIKBN-CD
           WHEN    "04"
               MOVE    2               TO  SPA-GMN-I01-CUR
           WHEN    "10"
               MOVE    100             TO  SPA-GMN-I01-CUR
           WHEN    OTHER
               MOVE    4               TO  SPA-GMN-I01-CUR
           END-EVALUATE
      *
           .
      *
       4101-SYORIKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÅÐÏ¿»þÆþÎÏ²ÄÈÝÀßÄê½èÍý
      *****************************************************************
       4101-WIDGET-NYUIN-STT-SEC       SECTION.
      *
           PERFORM 4201-WIDGET-STATE-CLEAR-SEC
      *
           MOVE    WIDGET-INSENSITIVE
                                   TO
                                       SPA-GMN-I01-IDOYMD-STT
                                       SPA-GMN-I01-TAIINYMD-STT
                                       SPA-GMN-I01-TAIINCD-STT
                                       SPA-GMN-I01-TAIINCD-ITM-STT
                                       SPA-GMN-I01-SHONUM-STT
      *
           .
      *
       4101-WIDGET-NYUIN-STT-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡ÅÐÏ¿»þÆþÎÏ²ÄÈÝÀßÄê½èÍý
      *****************************************************************
       4101-WIDGET-TAIIN-STT-SEC       SECTION.
      *
           PERFORM 4201-WIDGET-STATE-CLEAR-SEC
      *
           MOVE    WIDGET-INSENSITIVE
                                   TO
                                       SPA-GMN-I01-B07-STT
      *                                SPA-GMN-I01-B08-STT
                                       SPA-GMN-I01-IDOYMD-STT
                                       SPA-GMN-I01-BRMNUM-STT
                                       SPA-GMN-I01-BTUNAME-STT
                                       SPA-GMN-I01-BTUNAME-ITM-STT
                                       SPA-GMN-I01-SAGAKU-STT
                                       SPA-GMN-I01-SAGAKU-ITM-STT
                                       SPA-GMN-I01-NYUINYMD-STT
                                       SPA-GMN-I01-NYUINKA-STT
                                       SPA-GMN-I01-NYUINKA-ITM-STT
                                       SPA-GMN-I01-SHOKAI-STT
                                       SPA-GMN-I01-SHOKAI-ITM-STT
                                       SPA-GMN-I01-SHONUM-STT
                                       SPA-GMN-I01-DR-STT (1)
                                       SPA-GMN-I01-DR-ITM-STT (1)
                                       SPA-GMN-I01-DR-STT (2)
                                       SPA-GMN-I01-DR-ITM-STT (2)
                                       SPA-GMN-I01-DR-STT (3)
                                       SPA-GMN-I01-DR-ITM-STT (3)
                                       SPA-GMN-I01-HKNCOMBI-STT
                                       SPA-GMN-I01-HKNCOMBI-ITM-STT
                                       SPA-GMN-I01-TOKNYUIN-STT
                                       SPA-GMN-I01-TOKNYUIN-ITM-STT
                                       SPA-GMN-I01-SNTNYUIN-STT
                                       SPA-GMN-I01-MAEUKE-STT
                                       SPA-GMN-I01-SEIKYU-STT
                                       SPA-GMN-I01-SEIKYU-ITM-STT
                                       SPA-GMN-I01-DISPKBN-STT
                                       SPA-GMN-I01-DISPKBN-ITM-STT
      *
           .
      *
       4101-WIDGET-TAIIN-STT-EXT.
           EXIT.
      *****************************************************************
      *    ÊÑ¹¹»þÆþÎÏ²ÄÈÝÀßÄê½èÍý
      *****************************************************************
       4101-WIDGET-HENKOU-STT-SEC       SECTION.
      *
           PERFORM 4201-WIDGET-STATE-CLEAR-SEC
      *
           MOVE    WIDGET-INSENSITIVE
                                   TO  SPA-GMN-I01-B07-STT
      *                                SPA-GMN-I01-B08-STT
                                       SPA-GMN-I01-IDOYMD-STT
                                       SPA-GMN-I01-BRMNUM-STT
                                       SPA-GMN-I01-BTUNAME-STT
                                       SPA-GMN-I01-BTUNAME-ITM-STT
                                       SPA-GMN-I01-SAGAKU-STT
                                       SPA-GMN-I01-SAGAKU-ITM-STT
                                       SPA-GMN-I01-NYUINYMD-STT
                                       SPA-GMN-I01-NYUINKA-STT
                                       SPA-GMN-I01-NYUINKA-ITM-STT
                                       SPA-GMN-I01-SHOKAI-STT
                                       SPA-GMN-I01-SHOKAI-ITM-STT
                                       SPA-GMN-I01-SHONUM-STT
                                       SPA-GMN-I01-TAIINYMD-STT
                                       SPA-GMN-I01-TAIINCD-STT
                                       SPA-GMN-I01-TAIINCD-ITM-STT
                                       SPA-GMN-I01-HKNCOMBI-STT
                                       SPA-GMN-I01-HKNCOMBI-ITM-STT
                                       SPA-GMN-I01-TOKNYUIN-STT
                                       SPA-GMN-I01-TOKNYUIN-ITM-STT
                                       SPA-GMN-I01-SNTNYUIN-STT
      *
           .
      *
       4101-WIDGET-TAIIN-STT-EXT.
           EXIT.
      *****************************************************************
      *    Å¾²Ê¡¦Å¾Åï¡¦Å¾¼¼»þÆþÎÏ²ÄÈÝÀßÄê½èÍý
      *****************************************************************
       4101-WIDGET-TENKA-STT-SEC       SECTION.
      *
           PERFORM 4201-WIDGET-STATE-CLEAR-SEC
      *
           MOVE    WIDGET-INSENSITIVE
                                   TO
                                       SPA-GMN-I01-B07-STT
      *                                SPA-GMN-I01-B08-STT
                                       SPA-GMN-I01-NYUINYMD-STT
                                       SPA-GMN-I01-SHOKAI-STT
                                       SPA-GMN-I01-SHOKAI-ITM-STT
                                       SPA-GMN-I01-SHONUM-STT
                                       SPA-GMN-I01-TAIINYMD-STT
                                       SPA-GMN-I01-TAIINCD-STT
                                       SPA-GMN-I01-TAIINCD-ITM-STT
                                       SPA-GMN-I01-MAEUKE-STT
                                       SPA-GMN-I01-SEIKYU-STT
                                       SPA-GMN-I01-SEIKYU-ITM-STT
                                       SPA-GMN-I01-DISPKBN-STT
                                       SPA-GMN-I01-DISPKBN-ITM-STT
      *
           .
      *
       4101-WIDGET-TENKA-STT-EXT.
           EXIT.
      *****************************************************************
      *    °ÛÆ°Æü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-IDOYMD-CHK-SEC             SECTION.
      *
           MOVE    SPA-NAI-I01-IDOYMD
                                       TO  WRK-IDOYMD
      *
           IF    ( SPA-GMN-I01-IDOYMD  =   SPACE )
               IF    ( SPA-SYSYMD      >   SPA-NAI-I01-MAEIDOYMD )
                   MOVE    SPA-SYSYMD      TO  WRK-YMD
               ELSE
                   MOVE    SPA-NAI-I01-MAEIDOYMD
                                           TO  WRK-YMD
               END-IF
               PERFORM 5002-HIZUKE-CHK-SEC
               MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-IDOYMD
               MOVE    WRK-SYMD        TO  SPA-NAI-I01-IDOYMD
           ELSE
               MOVE    SPA-GMN-I01-IDOYMD
                                       TO  WRK-YMD
               PERFORM 5002-HIZUKE-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
      *
      *            ¥¨¥é¡¼¥³¡¼¥É¤òÀßÄê¡Ê¸åÂ³¤Î½èÍý¤ÏÂ³¹Ô¡Ë
                   MOVE    "0013"      TO  SPA-ERRCD
                   MOVE    3           TO  SPA-GMN-I01-CUR
                   MOVE    WRK-IDOYMD  TO  WRK-YMD
                   PERFORM 5002-HIZUKE-CHK-SEC
               END-IF
      *
               MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-IDOYMD
               MOVE    WRK-SYMD        TO  SPA-NAI-I01-IDOYMD
           END-IF
      *
           IF    ( SPA-NAI-I01-IDOYMD  NOT =   SPA-NAI-I01-IDOYMD-MAE )
            OR   ( WRK-MCP-WIDGET          =   "SYORIKBN" )
               MOVE    SPA-NAI-I01-IDOYMD  TO  SPA-NAI-I01-IDOYMD-MAE
      *        ¥³¥ó¥Ü½é´ü½èÍý
               MOVE    SPA-NAI-I01-IDOYMD
                                   TO  WRK-KJNYMD
               PERFORM 310-CMB-SYOKI-SEC
      *
      *        ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¥³¥ó¥Ü½é´ü½èÍý
               PERFORM 4101-CMB-HKNCOMBI-SET-SEC
      *        ¼õÉÕ¥Þ¥¹¥¿¸¡º÷½èÍý
               MOVE    SPA-NAI-I01-IDOYMD
                                   TO  WRK-KJNYMD
               PERFORM 4101-UKETUKE-SEL-SEC
      *        ¼õ¿ÇÍúÎò¸¡º÷½èÍý
               MOVE    SPA-NAI-I01-IDOYMD
                                   TO  WRK-KJNYMD
               PERFORM 4101-JYURRK-SEL-SEC
      *
      *        ÉÂ¼¼ÈÖ¹æ¥Á¥§¥Ã¥¯
               MOVE    SPA-NAI-I01-IDOYMD
                                   TO  WRK-KIHON-KJNYMD
      *
               PERFORM 4101-BRMNUM-CHK-SEC
               MOVE    SPA-GMN-I01-BRMNUM
                                       TO  SPA-NAI-I01-BRMNUM-MAE
               MOVE    SPA-ERRCD       TO  SPA-NAI-I01-BRMNUM-ERR
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  4101-IDOYMD-CHK-EXT
               END-IF
      *
               MOVE    4               TO   SPA-GMN-I01-CUR
      *
           END-IF
      
      *
           .
      *
       4101-IDOYMD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡Æü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-NYUINYMD-CHK-SEC           SECTION.
      *
           MOVE    SPA-NAI-I01-NYUINYMD    TO  WRK-NYUINYMD
      *
           IF    ( SPA-GMN-I01-NYUINYMD    =   SPACE )
      *
      *        ÆþÎÏ¤¬¤Ê¤¤¾ì¹ç¡¢¥·¥¹¥Æ¥àÆüÉÕ¤òÀßÄê
               MOVE    SPA-SYSYMD  TO  WRK-YMD
               PERFORM 5002-HIZUKE-CHK-SEC
               MOVE    WRK-HENYMDG TO  SPA-GMN-I01-NYUINYMD
               MOVE    WRK-SYMD    TO  SPA-NAI-I01-NYUINYMD
           ELSE
               MOVE    SPA-GMN-I01-NYUINYMD
                                   TO  WRK-YMD
               PERFORM 5002-HIZUKE-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
      *            ¥¨¥é¡¼¥³¡¼¥É¤òÀßÄê¡Ê¸åÂ³¤Î½èÍý¤ÏÂ³¹Ô¡Ë
                   MOVE    "0017"      TO  SPA-ERRCD
                   MOVE    7           TO  SPA-GMN-I01-CUR
                   MOVE    WRK-NYUINYMD
                                       TO  WRK-YMD
                   PERFORM 5002-HIZUKE-CHK-SEC
               END-IF
               MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-NYUINYMD
               MOVE    WRK-SYMD        TO  SPA-NAI-I01-NYUINYMD
           END-IF
      *
           IF    (  SPA-NAI-I01-NYUINYMD
                                   NOT =   SPA-NAI-I01-NYUINYMD-MAE )
               MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  SPA-NAI-I01-NYUINYMD-MAE
      *        ¥³¥ó¥Ü½é´ü½èÍý
               MOVE    SPA-NAI-I01-NYUINYMD
                                   TO  WRK-KJNYMD
               PERFORM 310-CMB-SYOKI-SEC
      *
               MOVE    SPA-NAI-I01-NYUINYMD
                                   TO  WRK-KJNYMD
      *        ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¥³¥ó¥Ü½é´ü½èÍý
               PERFORM 4101-CMB-HKNCOMBI-SET-SEC
      *        ¼õÉÕ¥Þ¥¹¥¿¸¡º÷½èÍý
               MOVE    SPA-NAI-I01-NYUINYMD
                                   TO  WRK-KJNYMD
               PERFORM 4101-UKETUKE-SEL-SEC
      *        ¼õ¿ÇÍúÎò¸¡º÷½èÍý
               MOVE    SPA-NAI-I01-NYUINYMD
                                   TO  WRK-KJNYMD
               PERFORM 4101-JYURRK-SEL-SEC
      *
               MOVE    SPA-NAI-I01-NYUINYMD
                                   TO  WRK-KIHON-KJNYMD
      *        ÉÂ¼¼ÈÖ¹æ¥Á¥§¥Ã¥¯
               PERFORM 4101-BRMNUM-CHK-SEC
               MOVE    SPA-GMN-I01-BRMNUM
                                       TO  SPA-NAI-I01-BRMNUM-MAE
               MOVE    SPA-ERRCD       TO  SPA-NAI-I01-BRMNUM-ERR
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  4101-NYUINYMD-CHK-EXT
               END-IF
      *
               MOVE    8              TO   SPA-GMN-I01-CUR
      *
           END-IF
      *
           .
      *
       4101-NYUINYMD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡Æü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-TAIINYMD-CHK-SEC           SECTION.
      *
           MOVE    SPACE           TO  SPA-NAI-I01-TAIINYMD
      *
           IF    ( SPA-GMN-I01-TAIINYMD    =   SPACE )
               GO  TO  4101-TAIINYMD-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-TAIINYMD
                                   TO  WRK-YMD
           PERFORM 5002-HIZUKE-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               MOVE    "0021"      TO  SPA-ERRCD
               MOVE    11          TO  SPA-GMN-I01-CUR
               GO  TO  4101-TAIINYMD-CHK-EXT
           END-IF
      *
           MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-TAIINYMD
           MOVE    WRK-SYMD        TO  SPA-NAI-I01-TAIINYMD
      *
           IF    ( WRK-MCP-WIDGET  =   "TAIINYMD" )
               MOVE    SPA-NAI-I01-TAIINYMD
                                   TO  WRK-KJNYMD
               PERFORM 310-CMB-SYOKI-SEC
           END-IF
      *
           .
      *
       4101-TAIINYMD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡»öÍ³¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-TAIINCD-CHK-SEC            SECTION.
      *
           IF    ( SPA-GMN-I01-TAIINCD =   SPACE )
               GO  TO  4101-TAIINCD-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-TAIINCD-CD
                                       TO  WRK-CMB-CD
           PERFORM 4103-CMB-TAIINCD-SRH-SEC
           IF    ( WRK-CMB-ITM     =   SPACE )
               MOVE    "0028"          TO  SPA-ERRCD
               MOVE    20              TO  SPA-GMN-I01-CUR
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-TAIINCD
           END-IF
      *
           .
      *
       4101-TAIINCD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÉÂ¼¼ÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-BRMNUM-CHK-SEC             SECTION.
      *
           IF    ( SPA-GMN-I01-BRMNUM  =   SPACE )
               INITIALIZE  SPA-GMN-I01-CMB-BTUNAME
                           SPA-GMN-I01-BTUNAME
               GO  TO  4101-BRMNUM-CHK-EXT
           END-IF
      *
      *    Á´³ÑÈ¾³Ñº®ºß¥Á¥§¥Ã¥¯
           MOVE    SPA-GMN-I01-BRMNUM
                                   TO  WRK-KANACHK-MAE-INPUT
      *
           PERFORM     800-ENRTRY-CHK-SEC
           MOVE    WRK-KANACHK-OUT-INPUT
                                   TO  SPA-GMN-I01-BRMNUM
           IF  ( FLG-ENTRYCHK      NOT =   1 )
               MOVE    SPACE           TO  SPA-GMN-I01-BTUNAME
               MOVE    "0003"          TO  SPA-ERRCD
               MOVE    4               TO  SPA-GMN-I01-CUR
               GO  TO  4101-BRMNUM-CHK-EXT
           END-IF
      *
      *    º¸µÍÊÔ½¸¤ò¹Ô¤¦
           MOVE    SPA-GMN-I01-BRMNUM  TO  WRK-BRMNUM-IN
           PERFORM 4101-BRMNUM-LEFT-EDIT-SEC
           MOVE    WRK-BRMNUM-OT       TO  SPA-GMN-I01-BRMNUM
      *
      *    ´Ö¤Ë¶õÇòÊ¸»ú¤¬º®Æþ¤·¤Æ¤¤¤Ê¤¤¤«¥Á¥§¥Ã¥¯
           MOVE    SPACE           TO  WRK-STR1
                                       WRK-STR2
           UNSTRING    SPA-GMN-I01-BRMNUM
               DELIMITED   BY  ALL SPACE
               INTO    WRK-STR1
                       WRK-STR2
           END-UNSTRING
      *
           IF    ( WRK-STR2        NOT =   SPACE )
               MOVE    SPACE           TO  SPA-GMN-I01-BTUNAME
               MOVE    "0014"          TO  SPA-ERRCD
               MOVE    4               TO  SPA-GMN-I01-CUR
               GO  TO  4101-BRMNUM-CHK-EXT
           END-IF
      *
      *    ÉÂ¼¼ÈÖ¹æÂ¸ºß¥Á¥§¥Ã¥¯
           MOVE    WRK-KIHON-KJNYMD    TO  WRK-KJNYMD
           PERFORM 4101-BRMNUM-SEL-SEC
      *
           EVALUATE    SPA-GMN-I01-BTUNAME-CNT
      *    ³ºÅö¤ÎÉÂ¼¼¤¬Â¸ºß¤·¤Ê¤«¤Ã¤¿¾ì¹ç
           WHEN    0
               MOVE    SPACE           TO  SPA-GMN-I01-BTUNAME
               MOVE    "0004"          TO  SPA-ERRCD
               MOVE    4               TO  SPA-GMN-I01-CUR
               GO  TO  4101-BRMNUM-CHK-EXT
      *    ³ºÅö¤ÎÉÂ¼¼¤¬£±·ïÂ¸ºß¤·¤¿¾ì¹ç
           WHEN    1
               MOVE    SPA-GMN-I01-BTUNAME-ITM (1)
                                       TO  SPA-GMN-I01-BTUNAME
               MOVE    SPA-GMN-I01-BTUNAME-ITM2 (1)
                                       TO  WRK-BRM-SAGAKU-CD
               MOVE    SPA-GMN-I01-BTUNAME-ITM3 (1)
                                       TO  WRK-BTU-KA-CD
               MOVE    SPA-GMN-I01-BTUNAME-ITM4 (1)
                                       TO  WRK-BRM-KA-CD
               MOVE    6               TO  SPA-GMN-I01-CUR
      *    ³ºÅö¤ÎÉÂ¼¼¤¬Ê£¿ô·ïÂ¸ºß¤·¤¿¾ì¹ç
           WHEN    OTHER
               IF    ( SPA-GMN-I01-BTUNAME =   SPACE )
                   MOVE    SPA-GMN-I01-BTUNAME-ITM (1)
                                       TO  SPA-GMN-I01-BTUNAME
                   MOVE    SPA-GMN-I01-BTUNAME-ITM2 (1)
                                       TO  WRK-BRM-SAGAKU-CD
                   MOVE    SPA-GMN-I01-BTUNAME-ITM3 (1)
                                       TO  WRK-BTU-KA-CD
                   MOVE    SPA-GMN-I01-BTUNAME-ITM4 (1)
                                       TO  WRK-BRM-KA-CD
               ELSE
                   MOVE   SPA-GMN-I01-BTUNAME-CD
                                       TO  WRK-CMB-CD
                   PERFORM 4103-CMB-BTUNAME-SRH-SEC
                   IF    ( WRK-CMB-ITM =   SPACE )
                       MOVE    SPA-GMN-I01-BTUNAME-ITM (1)
                                       TO  SPA-GMN-I01-BTUNAME
                       MOVE    SPA-GMN-I01-BTUNAME-ITM2 (1)
                                       TO  WRK-BRM-SAGAKU-CD
                       MOVE    SPA-GMN-I01-BTUNAME-ITM3 (1)
                                       TO  WRK-BTU-KA-CD
                       MOVE    SPA-GMN-I01-BTUNAME-ITM4 (1)
                                       TO  WRK-BRM-KA-CD
                   ELSE
                      MOVE WRK-CMB-ITM TO  SPA-GMN-I01-BTUNAME
                      MOVE WRK-CMB-ITM2
                                       TO  WRK-BRM-SAGAKU-CD
                      MOVE WRK-CMB-ITM3
                                       TO  WRK-BTU-KA-CD
                      MOVE WRK-CMB-ITM4
                                       TO  WRK-BRM-KA-CD
                   END-IF
               END-IF
           END-EVALUATE
      *
      *    ¼¼ÎÁº¹³Û¤Î½é´üÃÍ¤òÀßÄê
           IF    ( SPA-GMN-I01-BRMNUM      =  SPA-NAI-I01-BRMNUM-MAE )
               MOVE    SPA-GMN-I01-SAGAKU-CD
                                       TO  WRK-CMB-CD
               PERFORM 4103-CMB-SAGAKU-SRH-SEC
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-SAGAKU
           ELSE
               MOVE    WRK-BRM-SAGAKU-CD   TO  WRK-CMB-CD
               PERFORM 4103-CMB-SAGAKU-SRH-SEC
               MOVE    WRK-CMB-ITM         TO  SPA-GMN-I01-SAGAKU
           END-IF
      *
      *    ¿ÇÎÅ²Ê¤Î½é´üÃÍ¤òÀßÄê
           IF    ( SPA-GMN-I01-BRMNUM      =  SPA-NAI-I01-BRMNUM-MAE )
               MOVE    SPA-GMN-I01-NYUINKA-CD
                                           TO  WRK-CMB-CD
               PERFORM 4103-CMB-NYUINKA-SRH-SEC
               MOVE    WRK-CMB-ITM         TO  SPA-GMN-I01-NYUINKA
           ELSE
               IF    ( WRK-BRM-KA-CD       NOT =   SPACE )
                   MOVE    WRK-BRM-KA-CD   TO  WRK-CMB-CD
                   PERFORM 4103-CMB-NYUINKA-SRH-SEC
                   MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-NYUINKA
               ELSE
                   IF    ( WRK-BTU-KA-CD   NOT =   SPACE )
                       MOVE    WRK-BTU-KA-CD   TO  WRK-CMB-CD
                       PERFORM 4103-CMB-NYUINKA-SRH-SEC
                       MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-NYUINKA
                   END-IF
               END-IF
           END-IF
      *
      *    ÆÃÄêÆþ±¡ÎÁ¥³¥ó¥ÜÀßÄê½èÍý
           MOVE    WRK-KIHON-KJNYMD    TO  WRK-KJNYMD
           PERFORM 4101-CMB-TOKNYUIN-SET-SEC
      *
      *    ÆÃÄêÆþ±¡ÎÁ¤Î½é´üÃÍ¤òÀßÄê
           PERFORM 4101-TOKNYUIN-SYOKI-SEC
      *
           .
      *
       4101-BRMNUM-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÉÂ¼¼¸¡º÷½èÍý
      *****************************************************************
       4101-BRMNUM-SEL-SEC             SECTION.
      *
           INITIALIZE              SYSKANRI-REC
                                   WRK-BTUJYOHO-TBL
      *
           MOVE    "5002"          TO  SYS-KANRICD
           MOVE    WRK-KJNYMD
                                   TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¸¡º÷
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM UNTIL ( FLG-DBRC       NOT =   ZERO )
                   OR    ( WRK-BTUJYOHO-CNT  >= 50  )
      *
               MOVE    MCPDATA-REC TO  SYS-5002-REC
      *
               IF    ( SYS-5002-BRM-NUM
                                               =   SPA-GMN-I01-BRMNUM )
                   COMPUTE WRK-BTUJYOHO-CNT    
                       =   WRK-BTUJYOHO-CNT    +   1
                   MOVE    SYS-5002-KBNCD (1 : 2)
                                               TO  WRK-BTUJY-BTUNUM
                                                   (WRK-BTUJYOHO-CNT)
                   MOVE    SYS-5002-BRM-SAGAKU
                                               TO  WRK-BTUJY-BRM-SAGAKU
                                                   (WRK-BTUJYOHO-CNT)
                   MOVE    SYS-5002-BRM-KA
                                               TO  WRK-BTUJY-BRM-KA
                                                   (WRK-BTUJYOHO-CNT)
               END-IF
      *
      *        ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß
               MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    ÉÂÅïÌ¾¸¡º÷½èÍý
           PERFORM 4101-BTUNAME-SEL-SEC
      *
           .
       4101-BRMNUM-SEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÉÂÅïÌ¾¾ÎÀßÄê½èÍý
      *****************************************************************
       4101-BTUNAME-SEL-SEC            SECTION.
      *
      *
           INITIALIZE              SYSKANRI-REC
                                   SPA-GMN-I01-CMB-BTUNAME
      *
           MOVE    "5001"          TO  SYS-KANRICD
           MOVE    WRK-KJNYMD      TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¸¡º÷
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM UNTIL ( FLG-DBRC                NOT = ZERO )
                   OR    ( SPA-GMN-I01-BTUNAME-CNT    >= 50  )
      *
               MOVE    MCPDATA-REC TO  SYS-5001-REC
      *
               SET WRK-BTUNUM-IDX  TO  1
               SEARCH  WRK-BTUJYOHO-OCC    VARYING WRK-BTUNUM-IDX
               WHEN    WRK-BTUJY-BTUNUM (WRK-BTUNUM-IDX)
                                   =   SYS-5001-BTU-NUM
                   COMPUTE SPA-GMN-I01-BTUNAME-CNT
                       =   SPA-GMN-I01-BTUNAME-CNT +   1
      *
                   MOVE    SYS-5001-BTU-NUM
                               TO  SPA-GMN-I01-BTUNAME-ITM
                                    (SPA-GMN-I01-BTUNAME-CNT) (1 : 2)
                   MOVE    SYS-5001-BTU-NAME
                               TO  SPA-GMN-I01-BTUNAME-ITM
                                    (SPA-GMN-I01-BTUNAME-CNT) (4 : )
                   MOVE    WRK-BTUJY-BRM-SAGAKU (WRK-BTUNUM-IDX)
                               TO  SPA-GMN-I01-BTUNAME-ITM2
                                    (SPA-GMN-I01-BTUNAME-CNT)
                   MOVE    SYS-5001-BTU-KA
                               TO  SPA-GMN-I01-BTUNAME-ITM3
                                    (SPA-GMN-I01-BTUNAME-CNT)
                   MOVE    WRK-BTUJY-BRM-KA (WRK-BTUNUM-IDX)
                               TO  SPA-GMN-I01-BTUNAME-ITM4
                                    (SPA-GMN-I01-BTUNAME-CNT)
               WHEN   WRK-BTUJY-BTUNUM (WRK-BTUNUM-IDX)
                                   =   SPACE
                   CONTINUE
               END-SEARCH
      *
      *        ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß
               MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4101-BTUNAME-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ÆÃÄêÆþ±¡ÎÁ¥³¥ó¥ÜÀßÄê½èÍý
      *****************************************************************
       4101-CMB-TOKNYUIN-SET-SEC       SECTION.
      *
           INITIALIZE  SPA-GMN-I01-CMB-TOKNYUIN
                       SPA-NAI-I01-KHNRYO-G
      *
           MOVE    ZERO            TO  FLG-CMB-EDIT
      *    ÉÂÅï¾ðÊó¤«¤é¥³¥ó¥Ü¹àÌÜ¤òÀßÄê
           MOVE    "5001"          TO  WRK-KANRICD
           MOVE    SPA-GMN-I01-BTUNAME-CD
                                   TO  WRK-KBNCD
           PERFORM 4102-SYSKANRI-SEL-SEC
           IF    ( FLG-SYSKANRI    =   ZERO )
               MOVE    MCPDATA-REC TO  SYS-5001-REC
      *
      *        ÉÂÅï¤ÎÆþ±¡´ðËÜÎÁ¤òÂàÈò¤¹¤ë
               IF    ( SYS-5001-BTU-KHNSRYCD
                               NOT =   SPACE )
                   MOVE    SYS-5001-BTU-KHNSRYCD
                                   TO  SPA-NAI-I01-KHNRYO-CD
                   MOVE    SYS-5001-BTU-KHNSRYCD
                                   TO  WRK-SRYCD
                   PERFORM 900-TENSU-KEY-SEL-SEC
                   IF    ( FLG-TENSU   =   ZERO )
                       MOVE    TNS-NAME    TO   SPA-NAI-I01-KHNRYO-NM
                   END-IF
               END-IF
      *
               IF    ( SYS-5001-BTU-TOKTEI-NYUIN
                               NOT =   SPACE )
                   MOVE    "5110"      TO  WRK-KANRICD
                   IF    ( SYS-5001-BTU-TOKTEI-NYUIN
                                       =   "01" OR "02" OR "14" )
                       PERFORM 41011-PT-AGE-SEC
                       IF    ( WRK-NENREI  <   15 )
                           MOVE    1   TO  FLG-CMB-EDIT
                       END-IF
                   ELSE
                       MOVE        1   TO  FLG-CMB-EDIT
                   END-IF
      *
                   IF    ( FLG-CMB-EDIT    =   1 )
                       MOVE    SYS-5001-BTU-TOKTEI-NYUIN
                                       TO  WRK-KBNCD
                       PERFORM 4102-SYSKANRI-SEL-SEC
                       IF    ( FLG-SYSKANRI    =   ZERO )
                           MOVE    MCPDATA-REC
                                       TO  SYS-5110-REC
                           MOVE    SYS-5110-BTU-TOKUTEINYUIN-NM
                                       TO  WRK-TOKNYUIN-NM
                           MOVE    "2"     TO  WRK-TOKNYUIN-KBN
                           MOVE    SYS-5110-KBNCD
                                       TO  WRK-TOKNYUIN-CD
                           PERFORM 4101-CMB-TOKNYUIN-DAT-SET-SEC
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
      *    ÉÂ¼¼¾ðÊó¤«¤é¥³¥ó¥Ü¹àÌÜ¤òÀßÄê
           MOVE    "5002"          TO  WRK-KANRICD
           MOVE    SPA-GMN-I01-BTUNAME-CD
                                   TO  WRK-KBNCD (1 : 2)
           MOVE    SPA-GMN-I01-BRMNUM
                                   TO  WRK-BRMNUM
           PERFORM 4800-BRMNUM-EDIT-SEC
           MOVE    WRK-BRMNUM-EDT  TO  WRK-KBNCD (3 : )
           PERFORM 4102-SYSKANRI-SEL-SEC
           IF    ( FLG-SYSKANRI    =   ZERO )
               MOVE    MCPDATA-REC TO  SYS-5002-REC
               IF    ( SYS-5002-BRM-TOKTEI-NYUIN
                               NOT =   SPACE )
                   MOVE    "5111"      TO  WRK-KANRICD
                   MOVE    SYS-5002-BRM-TOKTEI-NYUIN
                                       TO  WRK-KBNCD
                   PERFORM 4102-SYSKANRI-SEL-SEC
                   IF    ( FLG-SYSKANRI    =   ZERO )
                       MOVE    MCPDATA-REC
                                       TO  SYS-5111-REC
                       MOVE    SYS-5111-BRM-TOKUTEINYUIN-NM
                                       TO  WRK-TOKNYUIN-NM
                       MOVE    "3"     TO  WRK-TOKNYUIN-KBN
                       MOVE    SYS-5111-KBNCD
                                       TO  WRK-TOKNYUIN-CD
                       PERFORM 4101-CMB-TOKNYUIN-DAT-SET-SEC
                   END-IF
      *
      *            ÉÂ¼¼¤ÎÆÃÄêÆþ±¡ÎÁ¤¬¡¢¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ¤Î¾ì¹ç¡¢
      *            ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ¡Ê£³£°Æü°ÊÆâºÆÆþ±¡¡Ë¤â¥³¥ó¥Ü¤Ø
      *            ÄÉ²Ã¤¹¤ë
                   IF    ( SYS-5002-BRM-TOKTEI-NYUIN   =   "02" )
                       MOVE    "5111"      TO  WRK-KANRICD
                       MOVE    "23"        TO  WRK-KBNCD
                       PERFORM 4102-SYSKANRI-SEL-SEC
                       IF    ( FLG-SYSKANRI    =   ZERO )
                           MOVE    MCPDATA-REC
                                       TO  SYS-5111-REC
                           MOVE    SYS-5111-BRM-TOKUTEINYUIN-NM
                                       TO  WRK-TOKNYUIN-NM
                           MOVE    "3"     TO  WRK-TOKNYUIN-KBN
                           MOVE    SYS-5111-KBNCD
                                       TO  WRK-TOKNYUIN-CD
                           PERFORM 4101-CMB-TOKNYUIN-DAT-SET-SEC
                       END-IF
      *
                   END-IF
      *
               END-IF
           END-IF
      *
      *    Ï·¿Í¤Î¾ì¹ç¡¢Ï·¿Í°ìÈÌÉÂÅïÆÃÄêÆþ±¡´ðËÜÎÁ¤ò¥³¥ó¥Ü¤ËÀßÄê
           MOVE    WRK-KJNYMD  TO  WRK-AGECHK-SRYYMD
           PERFORM 4801-RJN-TAISYO-CHK-SEC
           IF    ( FLG-RJN         =   1 )
               MOVE    "5111"      TO  WRK-KANRICD
               MOVE    "22"        TO  WRK-KBNCD
               PERFORM 4102-SYSKANRI-SEL-SEC
               IF    ( FLG-SYSKANRI    =   ZERO )
                   MOVE    MCPDATA-REC     TO  SYS-5111-REC
                   MOVE    SYS-5111-BRM-TOKUTEINYUIN-NM
                                           TO  WRK-TOKNYUIN-NM
                   MOVE    "3"             TO  WRK-TOKNYUIN-KBN
                   MOVE    SYS-5111-KBNCD
                                           TO  WRK-TOKNYUIN-CD
                   PERFORM 4101-CMB-TOKNYUIN-DAT-SET-SEC
               END-IF
      *
               MOVE    "5111"      TO  WRK-KANRICD
               MOVE    "24"        TO  WRK-KBNCD
               PERFORM 4102-SYSKANRI-SEL-SEC
               IF    ( FLG-SYSKANRI    =   ZERO )
                   MOVE    MCPDATA-REC     TO  SYS-5111-REC
                   MOVE    SYS-5111-BRM-TOKUTEINYUIN-NM
                                           TO  WRK-TOKNYUIN-NM
                   MOVE    "3"             TO  WRK-TOKNYUIN-KBN
                   MOVE    SYS-5111-KBNCD
                                           TO  WRK-TOKNYUIN-CD
                   PERFORM 4101-CMB-TOKNYUIN-DAT-SET-SEC
               END-IF
      *
           END-IF
      *
      *    Ã»´üÂÚºß¼ê½Ñ´ðËÜÎÁ¤ò¥³¥ó¥Ü¤ËÀßÄê
           MOVE    "5111"      TO  WRK-KANRICD
           MOVE    "21"        TO  WRK-KBNCD
           PERFORM 4102-SYSKANRI-SEL-SEC
           IF    ( FLG-SYSKANRI    =   ZERO )
               MOVE    MCPDATA-REC     TO  SYS-5111-REC
               MOVE    SYS-5111-BRM-TOKUTEINYUIN-NM
                                       TO  WRK-TOKNYUIN-NM
               MOVE    "3"             TO  WRK-TOKNYUIN-KBN
               MOVE    SYS-5111-KBNCD
                                       TO  WRK-TOKNYUIN-CD
               PERFORM 4101-CMB-TOKNYUIN-DAT-SET-SEC
           END-IF
      *
      *
           .
       4101-CMB-TOKNYUIN-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÆÃÄêÆþ±¡ÎÁ¥³¥ó¥ÜÀßÄê½èÍý
      *****************************************************************
       41011-PT-AGE-SEC            SECTION.
      *
           MOVE    ZERO                TO  WRK-NENREI
      *
           MOVE    SPA-NAI-I01-BIRTHDAY
                                       TO  WRK-YMDS1
           MOVE    WRK-KJNYMD          TO  WRK-YMDS2
           COMPUTE WRK-NENREI      =   WRK-YYS2
                                   -   WRK-YYS1
           IF    ( WRK-YMDS1(5:4)     >   WRK-YMDS2(5:4) )
                COMPUTE WRK-NENREI =   WRK-NENREI  -   1
           END-IF
      *
           .
       41011-PT-AGE-EXT.
           EXIT.
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¸¡º÷½èÍý
      *****************************************************************
       4102-SYSKANRI-SEL-SEC       SECTION.
      *
           INITIALIZE              SYSKANRI-REC
           MOVE    ZERO            TO  FLG-SYSKANRI
      *
           MOVE    WRK-KANRICD     TO  SYS-KANRICD
           MOVE    WRK-KBNCD       TO  SYS-KBNCD
           MOVE    WRK-KJNYMD      TO  ORC-DBYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
           MOVE    "SYSKANRI-KEY10"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO )
               CONTINUE
           ELSE
               MOVE    1          TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "SYSKANRI-KEY10"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4102-SYSKANRI-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ÆÃÄêÆþ±¡ÎÁ¥³¥ó¥Ü¥Ç¡¼¥¿¥»¥Ã¥È½èÍý
      *****************************************************************
       4101-CMB-TOKNYUIN-DAT-SET-SEC   SECTION.
      *
           IF    ( WRK-TOKNYUIN-NM     =   SPACE )
               GO  TO  4101-CMB-TOKNYUIN-DAT-SET-EXT
           END-IF
      *
           COMPUTE SPA-GMN-I01-TOKNYUIN-CNT
               =   SPA-GMN-I01-TOKNYUIN-CNT    +   1
           MOVE    SPA-GMN-I01-TOKNYUIN-CNT
                                       TO  IDX10
           MOVE    IDX10               TO  WRK-99
           MOVE    WRK-99              TO  SPA-GMN-I01-TOKNYUIN-ITM
                                                       (IDX10) (1 : 2)
           MOVE    WRK-TOKNYUIN-NM     TO  SPA-GMN-I01-TOKNYUIN-ITM
                                                       (IDX10) (4 : )
           MOVE    WRK-TOKNYUIN-KBN
                                       TO  SPA-GMN-I01-TOKNYUIN-ITM2
                                                       (IDX10) (1 : 1)
           MOVE    WRK-TOKNYUIN-CD
                                       TO  SPA-GMN-I01-TOKNYUIN-ITM2
                                                       (IDX10) (2 : 2)
      *
           .
       4101-CMB-TOKNYUIN-DAT-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÆÃÄêÆþ±¡ÎÁ½é´üÃÍÀßÄê½èÍý
      *****************************************************************
       4101-TOKNYUIN-SYOKI-SEC         SECTION.
      *
           INITIALIZE  SPA-GMN-I01-TOKNYUIN
                       SPA-GMN-I01-SNTNYUIN
      *
           MOVE    ZERO                TO  FLG-TOKSET-LOOP
      *
           PERFORM VARYING IDX10
                   FROM    SPA-GMN-I01-TOKNYUIN-CNT    BY  -1
                   UNTIL ( IDX10   <   1 )
                    OR   ( FLG-TOKSET-LOOP NOT =   ZERO )
      *
               IF    ( SPA-GMN-I01-TOKNYUIN-ITM2 (IDX10) (1 : 1)
                                   =   "1" OR  "2" OR  "3" )
                   IF    ( SPA-GMN-I01-TOKNYUIN-ITM2 (IDX10)
                                   >=  "321" )
                       CONTINUE
                   ELSE
                       MOVE    SPA-GMN-I01-TOKNYUIN-ITM (IDX10)
                                       TO  SPA-GMN-I01-TOKNYUIN
                       MOVE    SPA-GMN-I01-TOKNYUIN-ITM2 (IDX10)
                                       TO  SPA-NAI-I01-TOKNYUIN-ORG
                       MOVE    1       TO  FLG-TOKSET-LOOP
                   END-IF
               END-IF
      *
           END-PERFORM
      *
      *    »»ÄêÆþ±¡ÎÁ¤Ë¤Ä¤¤¤Æ¤â½é´üÃÍ¤òÀßÄê
           IF    ( SPA-GMN-I01-TOKNYUIN    =   SPACE )
               MOVE    SPA-NAI-I01-KHNRYO-NM
                                       TO  SPA-GMN-I01-SNTNYUIN
           ELSE
               MOVE    SPA-GMN-I01-TOKNYUIN-NM
                                       TO  SPA-GMN-I01-SNTNYUIN
           END-IF
      *
           .
       4101-TOKNYUIN-SYOKI-EXT.
           EXIT.
      *****************************************************************
      *    ÉÂÅïÌ¾¾Î¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-BTUNAME-CHK-SEC            SECTION.
      *
           IF    ( SPA-GMN-I01-BTUNAME =   SPACE )
               GO  TO  4101-BTUNAME-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-BTUNAME-CD
                                       TO  WRK-CMB-CD
           PERFORM 4103-CMB-BTUNAME-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-BTUNAME
      *        ¼¼ÎÁº¹³Û¤Î¥Ç¥Õ¥©¥ë¥ÈÃÍ¤òÀßÄê
               MOVE    WRK-CMB-ITM2
                                   TO  WRK-CMB-CD
               PERFORM 4103-CMB-SAGAKU-SRH-SEC
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-SAGAKU
      *
      *        ¿ÇÎÅ²Ê¤Î½é´üÃÍ¤òÀßÄê
               IF    ( WRK-CMB-ITM4    NOT =   SPACE )
                   MOVE    WRK-CMB-ITM4        TO  WRK-CMB-CD
                   PERFORM 4103-CMB-NYUINKA-SRH-SEC
                   MOVE    WRK-CMB-ITM         TO  SPA-GMN-I01-NYUINKA
               ELSE
                   IF    ( WRK-CMB-ITM3    NOT =   SPACE )
                       MOVE    WRK-CMB-ITM3    TO  WRK-CMB-CD
                       PERFORM 4103-CMB-NYUINKA-SRH-SEC
                       MOVE    WRK-CMB-ITM     TO  SPA-GMN-I01-NYUINKA
                   END-IF
               END-IF
           ELSE
               MOVE    "0015"      TO  SPA-ERRCD
               MOVE    5           TO  SPA-GMN-I01-CUR
               GO  TO  4101-BTUNAME-CHK-EXT
           END-IF
      *
      *    ÆÃÄêÆþ±¡ÎÁ¥³¥ó¥ÜÀßÄê½èÍý
           MOVE    WRK-KIHON-KJNYMD    TO  WRK-KJNYMD
           PERFORM 4101-CMB-TOKNYUIN-SET-SEC
      *
      *    ÆÃÄêÆþ±¡ÎÁ¤Î½é´üÃÍ¤òÀßÄê
           PERFORM 4101-TOKNYUIN-SYOKI-SEC
      *
           .
      *
       4101-BTUNAME-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¼¼ÎÁº¹³Û¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SAGAKU-CHK-SEC             SECTION.
      *
           IF    ( SPA-GMN-I01-SAGAKU  =   SPACE )
               GO  TO  4101-SAGAKU-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-SAGAKU-CD
                                       TO  WRK-CMB-CD
           PERFORM 4103-CMB-SAGAKU-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-SAGAKU
           ELSE
               MOVE    "0016"      TO  SPA-ERRCD
               MOVE    6           TO  SPA-GMN-I01-CUR
               GO  TO  4101-SAGAKU-CHK-EXT
           END-IF
      *
           .
      *
       4101-SAGAKU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²Ê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-NYUINKA-CHK-SEC            SECTION.
      *
           IF    ( SPA-GMN-I01-NYUINKA =   SPACE )
               GO  TO  4101-NYUINKA-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-NYUINKA-CD
                                       TO  WRK-CMB-CD
           PERFORM 4103-CMB-NYUINKA-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-NYUINKA
           ELSE
               MOVE    "0018"      TO  SPA-ERRCD
               MOVE    8           TO  SPA-GMN-I01-CUR
               GO  TO  4101-NYUINKA-CHK-EXT
           END-IF
      *
           .
      *
       4101-NYUINKA-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ½é²ó¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SHOKAI-CHK-SEC             SECTION.
      *
           IF    ( SPA-GMN-I01-SHOKAI  =   SPACE )
               GO  TO  4101-SHOKAI-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-SHOKAI-CD
                                       TO  WRK-CMB-CD
           PERFORM 4103-CMB-SHOKAI-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-SHOKAI
           ELSE
               MOVE    "0019"      TO  SPA-ERRCD
               MOVE    9           TO  SPA-GMN-I01-CUR
               GO  TO  4101-SHOKAI-CHK-EXT
           END-IF
      *
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "01" )
               IF    ( SPA-GMN-I01-SHOKAI-CD   =   "2")
                   MOVE    WIDGET-NORMAL
                                           TO  SPA-GMN-I01-SHONUM-STT
               ELSE
                   MOVE    WIDGET-INSENSITIVE
                                           TO  SPA-GMN-I01-SHONUM-STT
                   MOVE    ZERO            TO  SPA-GMN-I01-SHONUM
                   MOVE    SPACE       TO  SPA-GMN-I01-LBL-SHONYUINYMD
               END-IF
           END-IF
      *
           .
      *
       4101-SHOKAI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ½é²óÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SHONUM-CHK-SEC             SECTION.
      *
           MOVE    SPACE       TO      SPA-GMN-I01-LBL-SHONYUINYMD
                                       WRK-SHOKAI-NYUINYMD-W
           MOVE    ZERO        TO      FLG-SHONUM
      *
           IF    ( SPA-GMN-I01-SHONUM   =   ZERO )
               GO  TO  4101-SHONUM-CHK-EXT
           END-IF
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL ( IDX1    >   SPA-GMN-I01-NYUREKILST-CNT )
                    OR   ( FLG-SHONUM      =   1 )
      *
               IF    ( SPA-GMN-I01-TSHONUM (IDX1)
                                   =   SPA-GMN-I01-SHONUM )
                 AND ( SPA-GMN-I01-TSHOKAI (IDX1)  =   "1" )
      *
                   MOVE      SPA-GMN-I01-TNYUINYMD (IDX1)
                                   TO  WRK-SHOKAI-NYUINYMD-W
                   MOVE      1     TO  FLG-SHONUM
      *
               END-IF
      *
           END-PERFORM
      *
           IF    ( FLG-SHONUM      =   ZERO )
               INITIALIZE                  WKPTNYUINRRK-REC
               MOVE    SPA-HOSPID      TO  WKPTNYUINRRK-HOSPID
               MOVE    SPA-NAI-I01-PTID
                                       TO  WKPTNYUINRRK-PTID
               MOVE    SPA-GMN-I01-SHONUM
                                       TO  WKPTNYUINRRK-SHONUM
               MOVE    WKPTNYUINRRK-REC
                                       TO  MCPDATA-REC
               MOVE    "PTNYUINRRK-KEY30"
                                       TO  WRK-DBPATH
               PERFORM 900-TBL-SELECT-SEC
               IF    ( FLG-DBRC        =   ZERO )
                   MOVE    MCPDATA-REC TO  WKPTNYUINRRK-REC
                   MOVE    WKPTNYUINRRK-NYUINYMD
                                       TO  WRK-YMD
                   PERFORM 5002-HIZUKE-CHK-SEC
                   MOVE    WRK-HENYMDG TO  WRK-SHOKAI-NYUINYMD-W
      *
                   MOVE      1       TO  FLG-SHONUM
               END-IF
      *
               MOVE    "PTNYUINRRK-KEY30"
                                       TO  WRK-DBPATH
               PERFORM 900-TBL-CLOSE-SEC
      *
           END-IF
      *
           IF    ( FLG-SHONUM      =   1 )
               STRING "Æþ±¡Æü "
                      WRK-SHOKAI-NYUINYMD-W
               DELIMITED   BY  SIZE
               INTO   SPA-GMN-I01-LBL-SHONYUINYMD
               END-STRING
           ELSE
               MOVE    10          TO      SPA-GMN-I01-CUR
               MOVE    "0005"      TO      SPA-ERRCD
               GO  TO  4101-SHONUM-CHK-EXT
           END-IF
      *
           .
       4101-SHONUM-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Ã´Åö°å¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-DR-CHK-SEC                 SECTION.
      *
           IF    ( SPA-GMN-I01-DR (IDX1)  =   SPACE )
               GO  TO  4101-DR-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-DR-CD (IDX1)
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-DR-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-DR (IDX1)
           ELSE
               MOVE    "0022"      TO  SPA-ERRCD
               COMPUTE SPA-GMN-I01-CUR =   IDX1    +   11
               GO  TO  4101-DR-CHK-EXT
           END-IF
      *
           .
      *
       4101-DR-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤ï¤»¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-HKNCOMBI-CHK-SEC           SECTION.
      *
           IF    ( SPA-GMN-I01-SYORIKBN-CD    =   "01" OR  "08")
               CONTINUE
           ELSE
               GO  TO  4101-HKNCOMBI-CHK-EXT
           END-IF
      *
           IF    ( SPA-GMN-I01-HKNCOMBI-CNT   >   ZERO )
               CONTINUE
           ELSE
               MOVE    SPACE       TO  SPA-GMN-I01-HKNCOMBI
               MOVE    "1021"      TO  SPA-ERRCD
               MOVE    15          TO  SPA-GMN-I01-CUR
               GO  TO  4101-HKNCOMBI-CHK-EXT
           END-IF
      *
           IF    ( SPA-GMN-I01-HKNCOMBI
                                       =   SPACE )
               GO  TO  4101-HKNCOMBI-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-HKNCOMBI-CD
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-HKNCOMBI-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-HKNCOMBI
               MOVE    WRK-CMB-ITM2
                                   TO  SPA-NAI-I01-FTNRATE
               MOVE    WRK-CMB-ITM3
                                   TO  SPA-NAI-I01-RSI-HKNKBN
           ELSE
               MOVE    "0023"      TO  SPA-ERRCD
               MOVE    15          TO  SPA-GMN-I01-CUR
               GO  TO  4101-HKNCOMBI-CHK-EXT
           END-IF
      *
           .
      *
       4101-HKNCOMBI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÆÃÄêÆþ±¡¥Á¥§¥Ã¥¯½èÍý¡Ê»»ÄêÆþ±¡ÎÁ¤ÎÀßÄê¤â¹Ô¤¦¡Ë
      *****************************************************************
       4101-TOKNYUIN-CHK-SEC           SECTION.
      *
           MOVE    SPACE           TO  SPA-NAI-I01-TOKNYUIN-ORG
                                       SPA-GMN-I01-SNTNYUIN
      *
           IF    ( SPA-GMN-I01-TOKNYUIN
                                       =   SPACE )
               MOVE    SPA-NAI-I01-KHNRYO-NM
                                   TO  SPA-GMN-I01-SNTNYUIN
               GO  TO  4101-TOKNYUIN-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-TOKNYUIN-CD
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-TOKNYUIN-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-TOKNYUIN
               MOVE    WRK-CMB-ITM2
                                   TO  SPA-NAI-I01-TOKNYUIN-ORG
               MOVE    SPA-GMN-I01-TOKNYUIN-NM
                                   TO  SPA-GMN-I01-SNTNYUIN
           ELSE
               MOVE    "0024"      TO  SPA-ERRCD
               MOVE    16          TO  SPA-GMN-I01-CUR
               GO  TO  4101-TOKNYUIN-CHK-EXT
           END-IF
      *
           .
      *
       4101-TOKNYUIN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Á°¼õ¤±¶â¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-MAEUKE-CHK-SEC             SECTION.
      *
      *
           .
      *
       4101-MAEUKE-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Äê´üÀÁµá¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SEIKYU-CHK-SEC             SECTION.
      *
           IF    ( SPA-GMN-I01-SEIKYU
                                       =   SPACE )
               GO  TO  4101-SEIKYU-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-SEIKYU-CD
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-SEIKYU-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-SEIKYU
           ELSE
               MOVE    "0025"      TO  SPA-ERRCD
               MOVE    18          TO  SPA-GMN-I01-CUR
               GO  TO  4101-SEIKYU-CHK-EXT
           END-IF
      *
           .
      *
       4101-SEIKYU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¸¡º÷»þ´µ¼ÔÉ½¼¨¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-DISPKBN-CHK-SEC            SECTION.
      *
           IF    ( SPA-GMN-I01-DISPKBN
                                       =   SPACE )
               GO  TO  4101-DISPKBN-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-DISPKBN-CD
                                   TO  WRK-CMB-CD
           PERFORM 4103-CMB-DISPKBN-SRH-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM TO  SPA-GMN-I01-DISPKBN
           ELSE
               MOVE    "0026"      TO  SPA-ERRCD
               MOVE    19          TO  SPA-GMN-I01-CUR
               GO  TO  4101-DISPKBN-CHK-EXT
           END-IF
      *
           .
      *
       4101-DISPKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÂòÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SELNUM-CHK-SEC             SECTION.
      *
           IF    ( SPA-GMN-I01-SELNUM  =   ZERO )
               GO  TO  4101-SELNUM-CHK-EXT
           END-IF
      *
      *    ÆþÎÏ¤µ¤ì¤¿ÈÖ¹æ¤¬Â¸ºß¤¹¤ë¤«¥Á¥§¥Ã¥¯
           IF    ( SPA-GMN-I01-SELNUM  >   SPA-GMN-I01-NYUREKILST-CNT )
               MOVE    "0027"      TO  SPA-ERRCD
               MOVE    100         TO  SPA-GMN-I01-CUR
               GO  TO  4101-SELNUM-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-SELNUM
                                   TO  SPA-GMN-I01-NYUREKILST-SEL
      *
           .
      *
       4101-SELNUM-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡Îò¥ê¥¹¥ÈÁªÂò½èÍý
      *****************************************************************
       4101-NYUREKILST-SEL-SEC         SECTION.
      *
           PERFORM VARYING     IDX1    FROM    1   BY  1
                   UNTIL     ( IDX1    >   SPA-GMN-I01-NYUREKILST-CNT )
      *
               IF    ( I01-NYUREKILST-SELECT (IDX1)    =   "T"  )
                   MOVE    IDX1        TO  SPA-GMN-I01-NYUREKILST-SEL
                   MOVE    SPA-GMN-I01-TSELNUM (IDX1)
                                       TO  I01-SELNUM
                   MOVE    SPA-GMN-I01-NYUREKILST-CNT
                                       TO  IDX1
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4101-NYUREKILST-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼ÔÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4102-PTNUM-CHK-SEC              SECTION.
      *
      *    ´µ¼ÔÈÖ¹æ¤¬¥¨¥é¡¼¤Ç¤Ê¤¤¤³¤È
           IF    ( SPA-GMN-I01-ERRCD (1)   NOT =   SPACE )
               MOVE    SPA-GMN-I01-ERRCD (1)
                                   TO  SPA-ERRCD
               MOVE    1           TO  SPA-GMN-I01-CUR
               GO  TO  4102-PTNUM-CHK-EXT
           END-IF
      *
      *    ´µ¼ÔÈÖ¹æ¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-GMN-I01-PTNUM           =   SPACE )
               MOVE    "1001"      TO  SPA-ERRCD
               MOVE    1           TO  SPA-GMN-I01-CUR
               GO  TO  4102-PTNUM-CHK-EXT
           END-IF
      *
           .
      *
       4102-PTNUM-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ½èÍý¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4102-SYORIKBN-CHK-SEC              SECTION.
      *
      *    ½èÍý¶èÊ¬¤¬¥¨¥é¡¼¤Ç¤Ê¤¤¤³¤È
           IF    ( SPA-GMN-I01-ERRCD (2)   NOT =   SPACE )
               MOVE    SPA-GMN-I01-ERRCD (2)
                                   TO  SPA-ERRCD
               MOVE    2           TO  SPA-GMN-I01-CUR
               GO  TO  4102-SYORIKBN-CHK-EXT
           END-IF
      *
      *    ½èÍý¶èÊ¬¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-GMN-I01-SYORIKBN    =   SPACE )
               MOVE    "1002"      TO  SPA-ERRCD
               MOVE    2           TO  SPA-GMN-I01-CUR
               GO  TO  4102-SYORIKBN-CHK-EXT
           END-IF
      *
      *    ½èÍý¶èÊ¬¤¬¾È²ñ¤Î¾ì¹ç¡¢¥«¡¼¥½¥ë¤Ï¾ï¤Ë½èÍý¶èÊ¬¤Ë¤ª¤¯
           IF    ( SPA-GMN-I01-SYORIKBN    =   "4" )
               MOVE    2           TO  SPA-GMN-I01-CUR
               GO  TO  4102-SYORIKBN-CHK-EXT
           END-IF
      *
           .
      *
       4102-SYORIKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ½èÍý¶èÊ¬¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-SYORIKBN-SRH-SEC   SECTION.
      *
           SET     CMB-IDX01       TO  1
           SEARCH  SPA-GMN-I01-SYORIKBN-ITM
                   VARYING CMB-IDX01
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-SYORIKBN-ITM (CMB-IDX01) (1 : 2)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX01
               MOVE    SPA-GMN-I01-SYORIKBN-ITM (CMB-IDX01)
                                   TO  WRK-CMB-ITM
           WHEN    SPA-GMN-I01-SYORIKBN-ITM (CMB-IDX01)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-SYORIKBN-SRH-EXT.
           EXIT.
      *****************************************************************
      *    ÉÂÅïÌ¾¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-BTUNAME-SRH-SEC    SECTION.
      *
           SET     CMB-IDX02       TO  1
           SEARCH  SPA-GMN-I01-BTUNAME-ITM-OCC
                   VARYING CMB-IDX02
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-ITM2
                                   WRK-CMB-ITM3
                                   WRK-CMB-ITM4
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-BTUNAME-ITM (CMB-IDX02) (1 : 2)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX02
               MOVE    SPA-GMN-I01-BTUNAME-ITM (CMB-IDX02)
                                   TO  WRK-CMB-ITM
               MOVE    SPA-GMN-I01-BTUNAME-ITM2 (CMB-IDX02)
                                   TO  WRK-CMB-ITM2
               MOVE    SPA-GMN-I01-BTUNAME-ITM3 (CMB-IDX02)
                                   TO  WRK-CMB-ITM3
               MOVE    SPA-GMN-I01-BTUNAME-ITM4 (CMB-IDX02)
                                   TO  WRK-CMB-ITM4
           WHEN    SPA-GMN-I01-BTUNAME-ITM (CMB-IDX02)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-ITM2
                                   WRK-CMB-ITM3
                                   WRK-CMB-ITM4
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-BTUNAME-SRH-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡»öÍ³¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-TAIINCD-SRH-SEC    SECTION.
      *
           INITIALIZE              WRK-CMB-ITM
                                   WRK-CMB-IDX
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-I01-TAIINCD-CNT )
                    OR   ( WRK-CMB-ITM     NOT =   SPACE )
      *
               IF    ( SPA-GMN-I01-TAIINCD-ITM (IDX-CMB) (1:2)
                                               =   WRK-CMB-CD )
                   MOVE    SPA-GMN-I01-TAIINCD-ITM (IDX-CMB)
                                   TO  WRK-CMB-ITM
                   MOVE    IDX-CMB TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4103-CMB-TAIINCD-SRH-EXT.
           EXIT.
      *****************************************************************
      *    ¼¼ÎÁº¹³Û¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-SAGAKU-SRH-SEC     SECTION.
      *
           SET     CMB-IDX03       TO  1
           SEARCH  SPA-GMN-I01-SAGAKU-ITM
                   VARYING CMB-IDX03
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-SAGAKU-ITM (CMB-IDX03) (1 : 2)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX03
               MOVE    SPA-GMN-I01-SAGAKU-ITM (CMB-IDX03)
                                   TO  WRK-CMB-ITM
           WHEN    SPA-GMN-I01-SAGAKU-ITM (CMB-IDX03)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-SAGAKU-SRH-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²Ê¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-NYUINKA-SRH-SEC    SECTION.
      *
           SET     CMB-IDX04       TO  1
           SEARCH  SPA-GMN-I01-NYUINKA-ITM
                   VARYING CMB-IDX04
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-NYUINKA-ITM (CMB-IDX04) (1 : 2)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX04
               MOVE    SPA-GMN-I01-NYUINKA-ITM (CMB-IDX04)
                                   TO  WRK-CMB-ITM
           WHEN    SPA-GMN-I01-NYUINKA-ITM (CMB-IDX04)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-NYUINKA-SRH-EXT.
           EXIT.
      *****************************************************************
      *    ½é²ó¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-SHOKAI-SRH-SEC     SECTION.
      *
           SET     CMB-IDX05       TO  1
           SEARCH  SPA-GMN-I01-SHOKAI-ITM
                   VARYING CMB-IDX05
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-SHOKAI-ITM (CMB-IDX05) (1 : 1)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX05
               MOVE    SPA-GMN-I01-SHOKAI-ITM (CMB-IDX05)
                                   TO  WRK-CMB-ITM
           WHEN    SPA-GMN-I01-SHOKAI-ITM (CMB-IDX05)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-SHOKAI-SRH-EXT.
           EXIT.
      *****************************************************************
      *    Ã´Åö°å¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-DR-SRH-SEC         SECTION.
      *
           INITIALIZE              WRK-CMB-ITM
                                   WRK-CMB-IDX
      *
           MOVE    SPA-GMN-I01-DR-CNT (IDX1)
                                   TO  WRK-CNT
           PERFORM VARYING IDX2    FROM    1   BY  1
                   UNTIL  (IDX2    >   WRK-CNT )
                   OR     (WRK-CMB-ITM NOT =   SPACE )
                   OR     (SPA-GMN-I01-DR-ITM (IDX1 IDX2)
                                           =   SPACE )
               IF    ( SPA-GMN-I01-DR-ITM (IDX1 IDX2) (1 : 4)
                                   =   WRK-CMB-CD  )
                   MOVE    IDX2    TO  WRK-CMB-IDX
                   MOVE    SPA-GMN-I01-DR-ITM (IDX1 IDX2)
                                   TO  WRK-CMB-ITM
               END-IF
           END-PERFORM
      *
           .
      *
       4103-CMB-DR-SRH-EXT.
           EXIT.
      *****************************************************************
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-HKNCOMBI-SRH-SEC   SECTION.
      *
           SET     CMB-IDX07       TO  1
           SEARCH  SPA-GMN-I01-HKNCOMBI-ITM-OCC
                   VARYING CMB-IDX07
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-ITM2
                                   WRK-CMB-ITM3
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-HKNCOMBI-ITM (CMB-IDX07) (1 : 4)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX07
               MOVE    SPA-GMN-I01-HKNCOMBI-ITM (CMB-IDX07)
                                   TO  WRK-CMB-ITM
               MOVE    SPA-GMN-I01-HKNCOMBI-ITM2 (CMB-IDX07)
                                   TO  WRK-CMB-ITM2
               MOVE    SPA-GMN-I01-HKNCOMBI-ITM3 (CMB-IDX07)
                                   TO  WRK-CMB-ITM3
           WHEN    SPA-GMN-I01-HKNCOMBI-ITM (CMB-IDX07)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-ITM2
                                   WRK-CMB-ITM3
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-HKNCOMBI-SRH-EXT.
           EXIT.
      *****************************************************************
      *    ÆÃÄêÆþ±¡¥µ¡¼¥Á½èÍý
      *    ¥³¥ó¥Ü¤ËÉ½¼¨¤µ¤ì¤Æ¤¤¤ëÈÖ¹æ¤Ç¥µ¡¼¥Á
      *****************************************************************
       4103-CMB-TOKNYUIN-SRH-SEC   SECTION.
      *
           SET     CMB-IDX08       TO  1
           SEARCH  SPA-GMN-I01-TOKNYUIN-ITM-OCC
                   VARYING CMB-IDX08
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-ITM2
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-TOKNYUIN-ITM (CMB-IDX08) (1 : 2)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX08
               MOVE    SPA-GMN-I01-TOKNYUIN-ITM (CMB-IDX08)
                                   TO  WRK-CMB-ITM
               MOVE    SPA-GMN-I01-TOKNYUIN-ITM2 (CMB-IDX08)
                                   TO  WRK-CMB-ITM2
           WHEN    SPA-GMN-I01-TOKNYUIN-ITM (CMB-IDX08)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-ITM2
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-TOKNYUIN-SRH-EXT.
           EXIT.
      *****************************************************************
      *    ÆÃÄêÆþ±¡¥µ¡¼¥Á½èÍý£²
      *    ¼ÂºÝ¤Î¥³¡¼¥É¤Ç¥µ¡¼¥Á
      *****************************************************************
       4103-CMB-TOKNYUIN-SRH2-SEC  SECTION.
      *
           SET     CMB-IDX08       TO  1
           SEARCH  SPA-GMN-I01-TOKNYUIN-ITM-OCC
                   VARYING CMB-IDX08
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-ITM2
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-TOKNYUIN-ITM2 (CMB-IDX08)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX08
               MOVE    SPA-GMN-I01-TOKNYUIN-ITM (CMB-IDX08)
                                   TO  WRK-CMB-ITM
               MOVE    SPA-GMN-I01-TOKNYUIN-ITM2 (CMB-IDX08)
                                   TO  WRK-CMB-ITM2
           WHEN    SPA-GMN-I01-TOKNYUIN-ITM2 (CMB-IDX08)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-ITM2
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-TOKNYUIN-SRH2-EXT.
           EXIT.
      *****************************************************************
      *    Äê´üÀÁµá¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-SEIKYU-SRH-SEC         SECTION.
      *
           SET     CMB-IDX09       TO  1
           SEARCH  SPA-GMN-I01-SEIKYU-ITM
                   VARYING CMB-IDX09
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-SEIKYU-ITM (CMB-IDX09) (1 : 1)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX09
               MOVE    SPA-GMN-I01-SEIKYU-ITM (CMB-IDX09)
                                   TO  WRK-CMB-ITM
           WHEN    SPA-GMN-I01-SEIKYU-ITM (CMB-IDX09)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-SEIKYU-SRH-EXT.
           EXIT.
      *****************************************************************
      *    ¸¡º÷»þ´µ¼ÔÉ½¼¨¥µ¡¼¥Á½èÍý
      *****************************************************************
       4103-CMB-DISPKBN-SRH-SEC    SECTION.
      *
           SET     CMB-IDX10       TO  1
           SEARCH  SPA-GMN-I01-DISPKBN-ITM
                   VARYING CMB-IDX10
           AT  END
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           WHEN    SPA-GMN-I01-DISPKBN-ITM (CMB-IDX10) (1 : 1)
                                   =   WRK-CMB-CD
               SET WRK-CMB-IDX     TO  CMB-IDX10
               MOVE    SPA-GMN-I01-DISPKBN-ITM (CMB-IDX10)
                                   TO  WRK-CMB-ITM
           WHEN    SPA-GMN-I01-DISPKBN-ITM (CMB-IDX10)
                                   =   SPACE
               INITIALIZE          WRK-CMB-ITM
                                   WRK-CMB-IDX
           END-SEARCH
      *
           .
      *
       4103-CMB-DISPKBN-SRH-EXT.
           EXIT.
      *****************************************************************
      *    Ìá¤ë¡¡½èÍý
      *****************************************************************
       210-BACK                    SECTION.
      *
      *    ÇÓÂ¾À©¸æ²ò½ü½èÍý
           PERFORM 990-LOCK-OUT-SEC
      *
           EVALUATE    SPA-I0-MOTOPG
           WHEN    "I20"
           WHEN    "K02N"
               MOVE    SPA-I0-MOTOPG   TO  SPA-SAKIPG
           WHEN    OTHER
               MOVE    "M01"           TO  SPA-SAKIPG
           END-EVALUATE
      *
           MOVE    "I01"               TO  SPA-MOTOPG
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    SPACE               TO  SPA-WORK 
           INITIALIZE                      SPA-KYOTUKEY
                                           SPA-KYOTU-SET
      *
           MOVE    SPA-KYOUTU          TO  LNK-KYOUTU
      *
           MOVE    "CHANGE"            TO  MCP-PUTTYPE
           MOVE    SPA-SAKIPG          TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
           .
      *
       210-BACK-EXT.
           EXIT.
      *****************************************************************
      *    ¥¯¥ê¥¢½èÍý
      *****************************************************************
       420-CLEAR-SEC                   SECTION.
      *
      *    ÇÓÂ¾À©¸æ²ò½ü½èÍý
           PERFORM 990-LOCK-OUT-SEC
      *
           INITIALIZE    SPA-GMN-I01-HEAD-AREA
                         SPA-NAI-I01-HEAD-AREA
                         SPA-GMN-I01-NYUREKILST-AREA
                         SPA-NAI-I01-NYUREKILST-AREA
                         SPA-GMN-I01-ERRCD-TBL
                         SPA-GMN-I01-CMB-BTUNAME
                         SPA-GMN-I01-CMB-HKNCOMBI
      *
           PERFORM 4201-INPUT-AREA-CLEAR-SEC
      *
           PERFORM 310-CMB-SYORIKBN-SET1-SEC
      *
           PERFORM 4201-WIDGET-STATE-CLEAR-SEC
      *
           MOVE    1                   TO  SPA-GMN-I01-CUR
      *
      *
           .
      *
       420-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    Á°²ó´µ¼ÔÀßÄê½èÍý
      *****************************************************************
       420-MAEPTINF-SET-SEC            SECTION.
      *
      *    Á°²ó´µ¼Ô¤¬ÀßÄê¤µ¤ì¤Æ¤¤¤ë¤Ð¤¢¤ÏÁ°²ó´µ¼Ô¤òÉ½¼¨¤¹¤ë
           IF    ( SPA-LAST-PTNUM  NOT =   SPACE )
               MOVE    SPA-LAST-PTID   TO  SPA-NAI-I01-PTID
               MOVE    SPA-LAST-PTNUM  TO  SPA-GMN-I01-PTNUM
               PERFORM 4101-PTINF-SELECT-SEC 
           END-IF
      *
           .
      *
       420-MAEPTINF-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏÎÎ°è½é´ü²½½èÍý
      *****************************************************************
       4201-INPUT-AREA-CLEAR-SEC       SECTION.
      *
           INITIALIZE              SPA-GMN-I01-INPUT-AREA
                                   SPA-NAI-I01-INPUT-AREA
                                   SPA-GMN-I01-CMB-BTUNAME
                                   SPA-GMN-I01-CMB-HKNCOMBI
                                   SPA-GMN-I01-CMB-TOKNYUIN
      *
           MOVE    SPA-GMN-I01-SHOKAI-ITM (01)
                                       TO  SPA-GMN-I01-SHOKAI
           MOVE    SPA-GMN-I01-SEIKYU-ITM (01)
                                   TO  SPA-GMN-I01-SEIKYU
           MOVE    SPA-GMN-I01-DISPKBN-ITM (1)
                                   TO  SPA-GMN-I01-DISPKBN
      *
      *    Æþ±¡Æü¤Ë¥·¥¹¥Æ¥àÆüÉÕ¤òÉ½¼¨
           MOVE    SPA-SYSYMD      TO  WRK-YMD
           PERFORM 5002-HIZUKE-CHK-SEC
           MOVE    WRK-HENYMDG     TO  SPA-GMN-I01-NYUINYMD
           MOVE    WRK-SYMD        TO  SPA-NAI-I01-NYUINYMD
                                       SPA-NAI-I01-NYUINYMD-MAE
      *
           MOVE    ZERO            TO  SPA-GMN-I01-NYUREKILST-SEL
      *
           .
      *
       4201-INPUT-AREA-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ¾õÂÖ½é´ü²½½èÍý
      *****************************************************************
       4201-WIDGET-STATE-CLEAR-SEC     SECTION.
      *
           MOVE    WIDGET-NORMAL   TO  SPA-GMN-I01-B07-STT
                                       SPA-GMN-I01-B08-STT
                                       SPA-GMN-I01-B12-STT
                                       SPA-GMN-I01-IDOYMD-STT
                                       SPA-GMN-I01-BRMNUM-STT
                                       SPA-GMN-I01-BTUNAME-STT
                                       SPA-GMN-I01-BTUNAME-ITM-STT
                                       SPA-GMN-I01-SAGAKU-STT
                                       SPA-GMN-I01-SAGAKU-ITM-STT
                                       SPA-GMN-I01-NYUINYMD-STT
                                       SPA-GMN-I01-NYUINKA-STT
                                       SPA-GMN-I01-NYUINKA-ITM-STT
                                       SPA-GMN-I01-SHOKAI-STT
                                       SPA-GMN-I01-SHOKAI-ITM-STT
                                       SPA-GMN-I01-SHONUM-STT
                                       SPA-GMN-I01-TAIINYMD-STT
                                       SPA-GMN-I01-TAIINCD-STT
                                       SPA-GMN-I01-TAIINCD-ITM-STT
                                       SPA-GMN-I01-DR-STT (1)
                                       SPA-GMN-I01-DR-ITM-STT (1)
                                       SPA-GMN-I01-DR-STT (2)
                                       SPA-GMN-I01-DR-ITM-STT (2)
                                       SPA-GMN-I01-DR-STT (3)
                                       SPA-GMN-I01-DR-ITM-STT (3)
                                       SPA-GMN-I01-HKNCOMBI-STT
                                       SPA-GMN-I01-HKNCOMBI-ITM-STT
                                       SPA-GMN-I01-TOKNYUIN-STT
                                       SPA-GMN-I01-TOKNYUIN-ITM-STT
                                       SPA-GMN-I01-SNTNYUIN-STT
                                       SPA-GMN-I01-MAEUKE-STT
                                       SPA-GMN-I01-SEIKYU-STT
                                       SPA-GMN-I01-SEIKYU-ITM-STT
                                       SPA-GMN-I01-DISPKBN-STT
                                       SPA-GMN-I01-DISPKBN-ITM-STT
      *
           .
      *
       4201-WIDGET-STATE-CLEAR-EXT.
           EXIT.
      *****************************************************************
      *    ²èÌÌ¾õÂÖÈó³èÀ­½èÍý
      *****************************************************************
       4201-WIDGET-INSENSITIVE-SEC     SECTION.
      *
           MOVE    WIDGET-INSENSITIVE
                                   TO  SPA-GMN-I01-B07-STT
                                       SPA-GMN-I01-B08-STT
                                       SPA-GMN-I01-B12-STT
                                       SPA-GMN-I01-IDOYMD-STT
                                       SPA-GMN-I01-BRMNUM-STT
                                       SPA-GMN-I01-BTUNAME-STT
                                       SPA-GMN-I01-BTUNAME-ITM-STT
                                       SPA-GMN-I01-SAGAKU-STT
                                       SPA-GMN-I01-SAGAKU-ITM-STT
                                       SPA-GMN-I01-NYUINYMD-STT
                                       SPA-GMN-I01-NYUINKA-STT
                                       SPA-GMN-I01-NYUINKA-ITM-STT
                                       SPA-GMN-I01-SHOKAI-STT
                                       SPA-GMN-I01-SHOKAI-ITM-STT
                                       SPA-GMN-I01-SHONUM-STT
                                       SPA-GMN-I01-TAIINYMD-STT
                                       SPA-GMN-I01-TAIINCD-STT
                                       SPA-GMN-I01-TAIINCD-ITM-STT
                                       SPA-GMN-I01-DR-STT (1)
                                       SPA-GMN-I01-DR-ITM-STT (1)
                                       SPA-GMN-I01-DR-STT (2)
                                       SPA-GMN-I01-DR-ITM-STT (2)
                                       SPA-GMN-I01-DR-STT (3)
                                       SPA-GMN-I01-DR-ITM-STT (3)
                                       SPA-GMN-I01-HKNCOMBI-STT
                                       SPA-GMN-I01-HKNCOMBI-ITM-STT
                                       SPA-GMN-I01-TOKNYUIN-STT
                                       SPA-GMN-I01-TOKNYUIN-ITM-STT
                                       SPA-GMN-I01-SNTNYUIN-STT
                                       SPA-GMN-I01-MAEUKE-STT
                                       SPA-GMN-I01-SEIKYU-STT
                                       SPA-GMN-I01-SEIKYU-ITM-STT
                                       SPA-GMN-I01-DISPKBN-STT
                                       SPA-GMN-I01-DISPKBN-ITM-STT
      *
           .
       4201-WIDGET-INSENSITIVE-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼ÔÅÐÏ¿¤Ø
      *****************************************************************
       480-KANJATOROKU-SEC             SECTION.
      *
           MOVE    SPA-NAI-I01-PTID    TO  SPA-PTID
           MOVE    SPA-GMN-I01-PTNUM   TO  SPA-PTNUM
           PERFORM 481-KANJATOROKU-SEC
      *
          .
       480-KANJATOROKU-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼ÔÅÐÏ¿¤Ø
      *****************************************************************
       481-KANJATOROKU-SEC             SECTION.
      *
      *    ´µ¼ÔÅÐÏ¿¤Î¸¢¸Â¤¬¤Ê¤¤»þ¡¢¥¨¥é¡¼
           IF      SPA-GSRAUTH-12      =   "1"
               CONTINUE
           ELSE
               MOVE    "9300"              TO  SPA-ERRCD
               MOVE    1                   TO  SPA-GMN-I01-CUR
               GO  TO  481-KANJATOROKU-EXT
           END-IF
      *
      *    £Ó£Ð£Á¤ÎÆâÍÆ¤òÂàÈò
           INITIALIZE                  I0SUB01-LNK
           MOVE    SPA-TERMID          TO  I0SUB01-TERMID
           MOVE    "O"                 TO  I0SUB01-KBN
           MOVE    SPA-I0FREE          TO  I0SUB01-SCRSPA-AREA
           MOVE    SPA-I0KYOUTU        TO  I0SUB01-COMMON
      *
           CALL    "ORCGI0SUB01"       USING   I0SUB01-LNK
      *
           MOVE    "I01"               TO  SPA-MOTOPG
           MOVE    "I01"               TO  SPA-MOTOPG2
           MOVE    "P02"               TO  SPA-SAKIPG
      *
           MOVE    SPACE               TO  LINKAREA
      *
           INITIALIZE                      SPA-WORK
           MOVE    SPA-AREA            TO  LNK-KYOUTU
      *
           MOVE    "CHANGE"            TO  MCP-PUTTYPE
           MOVE    "P02"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
      *
          .
       481-KANJATOROKU-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡Îò²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       480-NYUINREKI-SEC               SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *
      *    ÁªÂòÈÖ¹æÌ¤ÆþÎÏ¥Á¥§¥Ã¥¯
           IF    ( SPA-GMN-I01-SELNUM  =   ZERO )
               MOVE    "1019"      TO  SPA-ERRCD
               MOVE    100         TO  SPA-GMN-I01-CUR
               GO  TO  480-NYUINREKI-EXT
           END-IF
      *
      *    ÁªÂòÈÖ¹æ¥Á¥§¥Ã¥¯¡Ê´ðËÜ¥Á¥§¥Ã¥¯¡Ë
           PERFORM 4101-SELNUM-CHK-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  480-NYUINREKI-EXT
           END-IF
      *
           MOVE    SPA-NAI-I01-PTID
                                   TO  SPA-I01-I02-PTID
           MOVE    SPA-NAI-I01-TRRKNUM (SPA-GMN-I01-SELNUM)
                                   TO  SPA-I01-I02-PTRRKNUM
      *
           MOVE    SPACE           TO  SPA-MOTOPG
      *
           MOVE    SPA-I0KYOUTU    TO  SPA-WORK
           MOVE    SPA-AREA        TO  SPA-COMMON
           MOVE    SPA-I0FREE      TO  SPA-FREE
      *
           MOVE    "LINK"          TO  MCP-STATUS
           MOVE    SPACE           TO  MCP-EVENT
      *
           CALL    "ORCGI02"      USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-I0FREE
           MOVE    SPA-WORK        TO  SPA-I0KYOUTU
      *
           IF    ( SPA-NAI-I01-TZITA-FLG (SPA-GMN-I01-SELNUM)
                                   =   ZERO  )
               MOVE    "NYUGAI"        TO  MCP-WIDGET
           ELSE
               MOVE    "B01"           TO  MCP-WIDGET
           END-IF
      *
           MOVE    "I01"           TO  SPA-MOTOPG
           MOVE    "I02"           TO  SPA-SAKIPG
      *
           MOVE    "NEW"           TO  MCP-PUTTYPE
           MOVE    "I02"           TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE  1             TO  FLG-END
      *
           .
       480-NYUINREKI-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡ÎòºîÀ®²èÌÌÁ«°Ü½èÍý¡ÊºîÀ®½èÍý¡Ë
      *****************************************************************
       480-NYUINRRK-SAKUSEI-SEC        SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *
           MOVE    "1"                 TO  SPA-I01-I03-SYORIKBN
           MOVE    SPA-NAI-I01-PTID    TO  SPA-I01-I03-PTID
      *
           MOVE    ZERO                TO  FLG-PTNYUINRRK
           INITIALIZE  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO )
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
           ELSE
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF
      *
           MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( FLG-PTNYUINRRK  NOT =   ZERO )
               COMPUTE     SPA-I01-I03-PTRRKNUM    =   1
               COMPUTE     SPA-I01-I03-PTRRKEDANUM =   1
           ELSE
               COMPUTE     SPA-I01-I03-PTRRKNUM    =   PTNYUINRRK-RRKNUM
                                                   +   1
               COMPUTE     SPA-I01-I03-PTRRKEDANUM =   1
           END-IF
      *
           MOVE    SPA-GMN-I01-SYORIKBN-CD
                                   TO  SPA-I01-I03-SYORIKBN-CD
      *
           MOVE    SPA-GMN-I01-NYUREKILST-SEL
                                   TO  IDX1
           IF    ( IDX1            >   ZERO )
            AND  ( IDX1            <=  SPA-GMN-I01-NYUREKILST-CNT )
               MOVE    SPA-GMN-I01-TSHONUM (IDX1)
                                   TO  SPA-I01-I03-SHONUM
           ELSE
               MOVE    ZERO        TO  SPA-I01-I03-SHONUM
           END-IF
      *
           MOVE    ZERO            TO  SPA-I01-I03-TAIINYMD
           IF    ( SPA-I01-I03-SHONUM      NOT =   ZERO )
               PERFORM VARYING IDX2    FROM    1   BY  1
                   UNTIL     ( IDX2    >    SPA-GMN-I01-NYUREKILST-CNT )
                   IF    ( SPA-I01-I03-SHONUM
                                   =   SPA-GMN-I01-TSHONUM (IDX2) )
                       MOVE    SPA-NAI-I01-TTAIINYMD (IDX2)
                                   TO  SPA-I01-I03-TAIINYMD
                   END-IF
               END-PERFORM
           END-IF
      *
           MOVE    SPACE           TO  SPA-MOTOPG
           MOVE    SPA-I0KYOUTU    TO  SPA-WORK
           MOVE    SPA-AREA        TO  SPA-COMMON
           MOVE    SPA-I0FREE      TO  SPA-FREE
      *
           MOVE    "LINK"          TO  MCP-STATUS
           MOVE    SPACE           TO  MCP-EVENT
      *
           CALL    "ORCGI03"      USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-I0FREE
           MOVE    SPA-WORK        TO  SPA-I0KYOUTU
      *
           MOVE    "SHOKAI"        TO  MCP-WIDGET
      *
           MOVE    "I01"           TO  SPA-MOTOPG
           MOVE    "I03"           TO  SPA-SAKIPG
      *
           MOVE    "NEW"           TO  MCP-PUTTYPE
           MOVE    "I03"           TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE  1             TO  FLG-END
      *
           .
       480-NYUINRRK-SAKUSEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡ÎòºîÀ®²èÌÌÁ«°Ü½èÍý¡Ê½¤Àµ½èÍý¡Ë
      *****************************************************************
       480-NYUINRRK-SYUSEI-SEC         SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *
      *    Îò¤¬ÁªÂò¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-GMN-I01-NYUREKILST-SEL >   ZERO )
            AND  ( SPA-GMN-I01-NYUREKILST-SEL
                              <=   SPA-GMN-I01-NYUREKILST-CNT )
               CONTINUE
           ELSE
               MOVE    "1023"          TO  SPA-ERRCD
               GO  TO  480-NYUINRRK-SYUSEI-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-NYUREKILST-SEL
                                       TO  IDX1
      *
      *    ÎòºîÀ®¥Ç¡¼¥¿¤¬ÁªÂò¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-NAI-I01-TZITA-FLG (IDX1)    =   ZERO )
               MOVE    "1023"          TO  SPA-ERRCD
               GO  TO  480-NYUINRRK-SYUSEI-EXT
           END-IF
      *
      *    ÎòºîÀ®¥Ç¡¼¥¿¤¬ºÇ¿·¤Ç¤¢¤ë¤³¤È
           MOVE    ZERO                TO  FLG-RRKCHK
           COMPUTE IDX3    =   IDX1    -   1
           PERFORM VARYING IDX2    FROM    IDX3    BY  -1
                   UNTIL ( IDX2    <   1 )
                   OR    ( FLG-RRKCHK      NOT =   ZERO )
               IF    ( SPA-GMN-I01-TSHONUM (IDX1)
                                   =   SPA-GMN-I01-TSHONUM (IDX2) )
                   MOVE    1       TO  FLG-RRKCHK
                   MOVE    1       TO  IDX2
               END-IF
           END-PERFORM
      *
           IF    ( FLG-RRKCHK       =   ZERO )
               MOVE    "2"             TO  SPA-I01-I03-SYORIKBN
           ELSE
               MOVE    "3"             TO  SPA-I01-I03-SYORIKBN
           END-IF
      *
           MOVE    SPA-NAI-I01-PTID
                                   TO  SPA-I01-I03-PTID
           MOVE    SPA-NAI-I01-TRRKNUM (IDX1)
                                   TO  SPA-I01-I03-PTRRKNUM
           MOVE    1               TO  SPA-I01-I03-PTRRKEDANUM
           MOVE    SPA-GMN-I01-SYORIKBN-CD
                                   TO  SPA-I01-I03-SYORIKBN-CD
           MOVE    ZERO            TO  SPA-I01-I03-TAIINYMD
           IF    ( SPA-GMN-I01-TSHOKAI (IDX1)  NOT =   "1" )
               COMPUTE IDX3    =   IDX1    +   1
               PERFORM VARYING IDX2    FROM    IDX3    BY  1
                   UNTIL     ( IDX2    >    SPA-GMN-I01-NYUREKILST-CNT )
                   IF    ( SPA-GMN-I01-TSHONUM (IDX1)
                                   =   SPA-GMN-I01-TSHONUM (IDX2) )
                       MOVE    SPA-NAI-I01-TTAIINYMD (IDX2)
                                   TO  SPA-I01-I03-TAIINYMD
                   END-IF
               END-PERFORM
           END-IF
      *
           MOVE    SPACE           TO  SPA-MOTOPG
           MOVE    SPA-I0KYOUTU    TO  SPA-WORK
           MOVE    SPA-AREA        TO  SPA-COMMON
           MOVE    SPA-I0FREE      TO  SPA-FREE
      *
           MOVE    "LINK"          TO  MCP-STATUS
           MOVE    SPACE           TO  MCP-EVENT
      *
           CALL    "ORCGI03"      USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-I0FREE
           MOVE    SPA-WORK        TO  SPA-I0KYOUTU
      *
           MOVE    "COMMENT"       TO  MCP-WIDGET
      *
           MOVE    "I01"           TO  SPA-MOTOPG
           MOVE    "I03"           TO  SPA-SAKIPG
      *
           MOVE    "NEW"           TO  MCP-PUTTYPE
           MOVE    "I03"           TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE  1             TO  FLG-END
      *
           .
       480-NYUINRRK-SYUSEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    »áÌ¾¸¡º÷½èÍý
      *****************************************************************
       480-KENSAKU-SEC                 SECTION.
      *
           MOVE    SPACE               TO  LINKAREA
           MOVE    SPA-KYOUTU          TO  LNK-COMMON
           MOVE    SPA-I0FREE          TO  LNK-SCRSPA
      *
           MOVE    ZERO                TO  SPA-PTID
      *
           MOVE    "I01"               TO  SPA-MOTOPG
           MOVE    "P97"               TO  SPA-SAKIPG
      *    »áÌ¾¤ò¥¯¥ê¥¢¤¹¤ë
           MOVE    SPACE               TO  SPA-NAME
           MOVE    SPA-KYOUTU          TO  LNK-KYOUTU
      *
           MOVE    "CHANGE"            TO  MCP-PUTTYPE
           MOVE    "P97"               TO  MCP-WINDOW
           PERFORM 900-PUT-WINDOW
           MOVE    1                   TO  FLG-END
           .
      *
       480-KENSAKU-EXT.
           EXIT.
      *****************************************************************
      *    ¥«¥ë¥ÆÈ¯¹Ô½èÍý
      *****************************************************************
       480-KARUTE-PRT-SEC              SECTION.
      *
           PERFORM 410-INPUT-CHK-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  480-KARUTE-PRT-EXT
           END-IF
      *
           MOVE    "2"                 TO  WRK-ORCHCN01-SYORIKBN
           MOVE    "1"                 TO  WRK-ORCHCN01-PRTKBN
      *
      *    Æþ±¡¥«¥ë¥ÆÊÔ½¸¥µ¥Ö¸Æ½Ð
           PERFORM 4801-ORCHCN01-CALL-SEC
      *
           .
       480-KARUTE-PRT-EXT.
           EXIT.
      *****************************************************************
      *    Â³»æÈ¯¹Ô½èÍý
      *****************************************************************
       480-ZOKUSI-PRT-SEC              SECTION.
      *
           PERFORM 410-INPUT-CHK-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  480-ZOKUSI-PRT-EXT
           END-IF
      *
           MOVE    "1"                 TO  WRK-ORCHCN01-SYORIKBN
           MOVE    "2"                 TO  WRK-ORCHCN01-PRTKBN
      *
      *    Æþ±¡¥«¥ë¥ÆÊÔ½¸¥µ¥Ö¸Æ½Ð
           PERFORM 4801-ORCHCN01-CALL-SEC
      *
           .
       480-ZOKUSI-PRT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡¿ÇÎÅÏ½¥µ¥Ö¸Æ½Ð½èÍý
      *****************************************************************
       4801-ORCHCN01-CALL-SEC          SECTION.
      *
           MOVE    SPA-AREA            TO  WRK-SPA-AREA
           INITIALIZE                      WRK-SPA-KYOTUKEY
                                           WRK-SPA-KYOTU-SET
                                           ORCHCN01AREA
      *
           MOVE    WRK-ORCHCN01-SYORIKBN
                                       TO  ORCHCN01-SYORIKBN
           MOVE    WRK-ORCHCN01-PRTKBN
                                       TO  ORCHCN01-PRTKBN
           MOVE    SPA-NAI-I01-PTID    TO  WRK-SPA-PTID
           MOVE    SPA-GMN-I01-PTNUM   TO  WRK-SPA-PTNUM
           MOVE    SPA-GMN-I01-NYUINKA-CD
                                       TO  WRK-SPA-SRYKA
      *    ¥«¥ë¥ÆÊÔ½¸ÍÑÊÝ¸±ÁÈ¹ç¤»·èÄê½èÍý
           PERFORM 4801-HKNCOMBI-KETTEI-SEC
      *    MOVE    SPA-GMN-I01-HKNCOMBI-CD
      *                                TO  WRK-SPA-HKNCOMBINUM
           IF    ( WRK-ORCHCN01-HKNCOMBINUM    =   ZERO )
               MOVE    SPACE           TO  WRK-SPA-HKNCOMBINUM
           ELSE
               MOVE    WRK-ORCHCN01-HKNCOMBINUM
                                       TO  WRK-SPA-HKNCOMBINUM
           END-IF
      *
           MOVE    ZERO                TO  IDX2
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL ( IDX1    >   3 )
               IF    ( SPA-GMN-I01-DR-CD (IDX1)
                                   NOT =   SPACE )
                   COMPUTE IDX2    =   IDX2    +   1
                   MOVE    "1"         TO  ORCHCN01-DR (IDX2) (1 : 1)
                   MOVE    SPA-GMN-I01-DR-CD (IDX1)
                                       TO  ORCHCN01-DR (IDX2) (2 : )
               END-IF
           END-PERFORM
      *
           MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  ORCHCN01-NYUINYMD
      *
      *    DISPLAY "ORCHCN01-SYORIKBN  = " ORCHCN01-SYORIKBN
      *    DISPLAY "ORCHCN01-PRTKBN    = " ORCHCN01-PRTKBN
      *    DISPLAY "SPA-PTID           = " SPA-PTID
      *    DISPLAY "SPA-PTNUM          = " SPA-PTNUM
      *    DISPLAY "SPA-SRYKA          = " SPA-SRYKA
      *    DISPLAY "SPA-HKNCOMBINUM    = " SPA-HKNCOMBINUM
      *    DISPLAY "ORCHCN01-DR (1)    = " ORCHCN01-DR (1)
      *    DISPLAY "ORCHCN01-DR (2)    = " ORCHCN01-DR (2)
      *    DISPLAY "ORCHCN01-DR (3)    = " ORCHCN01-DR (3)
      *    DISPLAY "ORCHCN01-NYUINYMD  = " ORCHCN01-NYUINYMD
      *
      *    Ä¢É¼¥×¥í¥°¥é¥àÌ¾¼èÆÀ
           PERFORM 4801-PRINT-PG-EDIT-SEC
      *
           CALL    WRK-PRINT-PG    USING   WRK-SPA-AREA
                                           ORCHCN01AREA
      *
           .
       4801-ORCHCN01-CALL-EXT.
           EXIT.
      *****************************************************************
      *   ¥«¥ë¥ÆÊÔ½¸ÍÑÊÝ¸±ÁÈ¹ç¤»·èÄê½èÍý
      *****************************************************************
       4801-HKNCOMBI-KETTEI-SEC        SECTION.
      *
           INITIALIZE                  WRK-ORCHCN01-HKNCOMBINUM
      *
           EVALUATE    SPA-GMN-I01-SYORIKBN-CD
           WHEN    "01"
               MOVE    SPA-GMN-I01-HKNCOMBI-CD
                                   TO  WRK-ORCHCN01-HKNCOMBINUM
           WHEN    "08"
               IF    ( SPA-GMN-I01-HKNCOMBI-CD
                               NOT =   SPA-NAI-I01-HKNCOMBI-MOT )
                   MOVE    SPA-GMN-I01-HKNCOMBI-CD
                                   TO  WRK-ORCHCN01-HKNCOMBINUM
               ELSE
                   PERFORM 4801-NYUACCT-HKNCOMBI-GET-SEC
               END-IF
           WHEN    OTHER
                   PERFORM 4801-NYUACCT-HKNCOMBI-GET-SEC
           END-EVALUATE
      *
           .
       4801-HKNCOMBI-KETTEI-EXT.
           EXIT.
      *****************************************************************
      *   Æþ±¡²ñ·×¤è¤êÊÝ¸±ÁÈ¹ç¤»¼èÆÀ½èÍý
      *****************************************************************
       4801-NYUACCT-HKNCOMBI-GET-SEC   SECTION.
      *
           MOVE    ZERO                TO  FLG-NYUINACCT
           MOVE    ZERO                TO  FLG-HKNCOMBIGET
      *
           IF    ( SPA-NAI-I01-NYUINYMD    <   SPA-SYSYMD )
               MOVE    SPA-SYSYMD      TO  WRK-MIN-YMD
           ELSE
               MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  WRK-MIN-YMD
           END-IF
      *
           INITIALIZE  NYUINACCT-REC
           MOVE    SPA-HOSPID          TO  NACCT-HOSPID
           MOVE    "1"                 TO  NACCT-NYUGAIKBN
           MOVE    SPA-NAI-I01-PTID    TO  NACCT-PTID
           MOVE    WRK-MIN-YM          TO  NACCT-SRYYM
           MOVE    "5"                 TO  NACCT-ZAISKBKBN
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY19"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        NOT =   ZERO )
               MOVE    1               TO  FLG-NYUINACCT
           ELSE
               MOVE    MCPDATA-REC     TO  NYUINACCT-REC
           END-IF
      *
           PERFORM UNTIL ( FLG-NYUINACCT   =   1 )
                   OR    ( FLG-HKNCOMBIGET =   1 )
                   OR    ( NACCT-SRYYM <   SPA-NAI-I01-NYUINYMD (1 : 6))
      *
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY7-AREA
               MOVE    "71"                TO  LNK-DAY7-IRAI
               MOVE    NACCT-SRYYM         TO  LNK-DAY7-YM
               CALL    "ORCSDAY"       USING   STS-AREA-DAY
                                               LNK-DAY7-AREA
               MOVE    LNK-DAY7-KOYOMI(7:2)
                                           TO  WRK-STIDX
      *
               MOVE    1                   TO  WRK-EDIDX
      *
               PERFORM VARYING IDX-DAY   FROM    WRK-STIDX   BY  -1
                   UNTIL ( IDX-DAY           <   WRK-EDIDX )
                    OR   ( FLG-HKNCOMBIGET =   1 )
      *
                   IF    ( WRK-MIN-YM      =   NACCT-SRYYM )
                       IF    ( WRK-MIN-DD >=  IDX-DAY)
                        AND  ( NACCT-DAY (IDX-DAY)   NOT =   ZERO )
                           MOVE    NACCT-DAY (IDX-DAY)
                                           TO  WRK-ORCHCN01-HKNCOMBINUM
                           MOVE    1       TO  FLG-HKNCOMBIGET
                       END-IF
                   ELSE
                       MOVE    SPA-NAI-I01-NYUINYMD
                                           TO  WRK-NAI-NYUINYMD
                       IF    ( WRK-NAI-NYUINYM
                                           =   NACCT-SRYYM )
                        AND  ( WRK-NAI-NYUINDD
                                           >   IDX-DAY)
                           MOVE    1       TO  IDX-DAY
                       ELSE
                           IF    ( NACCT-DAY (IDX-DAY)   NOT =   ZERO )
                               MOVE    NACCT-DAY (IDX-DAY)
                                           TO  WRK-ORCHCN01-HKNCOMBINUM
                               MOVE    1   TO  FLG-HKNCOMBIGET
                           END-IF
                       END-IF
                   END-IF
      *
               END-PERFORM
      *
               MOVE    "NYUINACCT-KEY19"   TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
               IF    ( FLG-DBRC        NOT =   ZERO )
                   MOVE    1           TO  FLG-NYUINACCT
               ELSE
                   MOVE    MCPDATA-REC TO  NYUINACCT-REC
               END-IF
      *
           END-PERFORM
      *
           MOVE    "NYUINACCT-KEY19"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4801-NYUACCT-HKNCOMBI-GET-EXT.
           EXIT.
      *****************************************************************
      *   Ä¢É¼¥×¥í¥°¥é¥àÌ¾ÊÔ½¸½èÍý
      *****************************************************************
       4801-PRINT-PG-EDIT-SEC         SECTION.
      *
           INITIALIZE                      WRK-PRINT-PG
      *
           INITIALIZE                      ORCSPRTNMAREA
           MOVE    "1"                 TO  ORCSPRTNM-KBN
           MOVE    "00000001"          TO  ORCSPRTNM-KBNCD
           MOVE    SPA-SYSYMD          TO  ORCSPRTNM-SRYYMD
           MOVE    "1"                 TO  ORCSPRTNM-NYUGAIKBN
           CALL    "ORCSPRTNM"         USING
                                           ORCSPRTNMAREA
                                           WRK-SPA-AREA
                                           SYS-1035-REC
           IF    ( ORCSPRTNM-RC        =   ZERO )
              MOVE    ORCSPRTNM-PRTPG  TO  WRK-PRINT-PG
           ELSE
               MOVE    "ORCHCN01"      TO  WRK-PRINT-PG
           END-IF
      *
      *
           .
       4801-PRINT-PG-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²ñ·×¾È²ñÁ«°Ü½èÍý
      *****************************************************************
       480-NYUINKAIKEI-SEC             SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *
      *    Æþ±¡²ñ·×¾È²ñ¤Ø°ú¤­·Ñ¤°¾ðÊó¤òÀßÄê
           PERFORM 4801-SENIJI-PARA-SET-SEC
      *
      *    £Ó£Ð£Á¤ÎÆâÍÆ¤òÂàÈò
           INITIALIZE                  I0SUB01-LNK
           MOVE    SPA-TERMID          TO  I0SUB01-TERMID
           MOVE    "O"                 TO  I0SUB01-KBN
           MOVE    SPA-I0FREE          TO  I0SUB01-SCRSPA-AREA
           MOVE    SPA-I0KYOUTU        TO  I0SUB01-COMMON
      *
           CALL    "ORCGI0SUB01"       USING   I0SUB01-LNK
      *
      *    Æþ±¡²ñ·×¾È²ñ¤ØÁ«°Ü¤¹¤ë
           MOVE    "I01"               TO  SPA-MOTOPG
           MOVE    "I41"               TO  SPA-SAKIPG
      *
           MOVE    SPACE               TO  LINKAREA
           MOVE    SPA-I0KYOUTU        TO  SPA-WORK
           MOVE    SPA-KYOUTU          TO  LNK-KYOUTU
           MOVE    SPA-KYOUTU          TO  LNK-COMMON
           MOVE    SPA-I0FREE          TO  LNK-SCRSPA
      *
           MOVE   "CHANGE"             TO  MCP-PUTTYPE.
           MOVE   "I41"                TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
       480-NYUINKAIKEI-EXT.
           EXIT.
      *****************************************************************
      *    ¼ýÇ¼ÅÐÏ¿Á«°Ü½èÍý
      *****************************************************************
       480-S02-SENI-SEC                SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *
      *    ¼ýÇ¼ÅÐÏ¿¤Ø°ú¤­·Ñ¤°¾ðÊó¤òÀßÄê
           PERFORM 4801-SENIJI-PARA-SET-SEC
      *
      *    £Ó£Ð£Á¤ÎÆâÍÆ¤òÂàÈò
           INITIALIZE                  I0SUB01-LNK
           MOVE    SPA-TERMID          TO  I0SUB01-TERMID
           MOVE    "O"                 TO  I0SUB01-KBN
           MOVE    SPA-I0FREE          TO  I0SUB01-SCRSPA-AREA
           MOVE    SPA-I0KYOUTU        TO  I0SUB01-COMMON
      *
           CALL    "ORCGI0SUB01"       USING   I0SUB01-LNK
      *
      *    ¼ýÇ¼ÅÐÏ¿¤ØÁ«°Ü¤¹¤ë
           MOVE    "I01"               TO  SPA-MOTOPG
           MOVE    "S02"               TO  SPA-SAKIPG
      *
           MOVE    SPACE               TO  LINKAREA
           MOVE    SPA-I0KYOUTU        TO  SPA-WORK
           MOVE    SPA-KYOUTU          TO  LNK-KYOUTU
           MOVE    SPA-KYOUTU          TO  LNK-COMMON
           MOVE    SPA-I0FREE          TO  LNK-SCRSPA
      *
           MOVE   "CHANGE"             TO  MCP-PUTTYPE.
           MOVE   "S02"                TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
       480-S02-SENI-EXT.
           EXIT.
      *****************************************************************
      *    ¥ª¡¼¥À¡¼ÊÑ¹¹²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       480-I06-SENI-SEC                SECTION.
      *
      *    ¼ýÇ¼ÅÐÏ¿¤ØÁ«°Ü¤¹¤ë
           MOVE    "I01"               TO  SPA-MOTOPG
           MOVE    "I06"               TO  SPA-SAKIPG
      *
           MOVE   "CHANGE"             TO  MCP-PUTTYPE
           MOVE   "I06"                TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
       480-I06-SENI-EXT.
           EXIT.
      *****************************************************************
      *    Â¾¶ÈÌ³°ú·Ñ¾ðÊóÀßÄê½èÍý
      *****************************************************************
       4801-SENIJI-PARA-SET-SEC        SECTION.
      *
           INITIALIZE                  SPA-KYOTUKEY
                                       SPA-KYOTU-SET
      *
      *    Æþ±¡²Ê¤òÊÔ½¸
           MOVE    SPACE           TO  WRK-SRYKAMEI
      *
           IF    ( SPA-GMN-I01-NYUINKA NOT =   SPACE )
               MOVE    SPA-GMN-I01-NYUINKA-CD
                                   TO  WRK-CMB-CD
               PERFORM 4103-CMB-NYUINKA-SRH-SEC
               MOVE    WRK-CMB-ITM
                                   TO  WRK-SRYKAMEI
           END-IF
      *
      *    ¥·¥¹¥Æ¥àÆüÉÕ¤ò¿ÇÎÅÆüÉÕ¤È¤·¤Æ²ñ·×¤Ë°ú¤­·Ñ¤°
           MOVE    SPA-SYSYMD      TO  SPA-SRYYMD
           MOVE    SPA-SYSYMDWH    TO  SPA-SRYYMDW
      *
      *    Æþ±¡²Ê¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤¿¾ì¹ç¤Ï²ñ·×¤Ë°ú¤­·Ñ¤°
      *    ¡Ê´µ¼Ô¾ðÊó¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤¿¾ì¹ç¤Ë¸Â¤ë¡Ë
           IF    ( WRK-SRYKAMEI        NOT =   SPACE )
            AND  ( SPA-NAI-I01-PTID    NOT =   ZERO )
               MOVE    SPA-GMN-I01-NYUINKA-CD
                                   TO  SPA-SRYKA
               MOVE    WRK-SRYKAMEI
                                   TO  SPA-SRYKAMEI
           END-IF
      *
      *    ´µ¼Ô¾ðÊó¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤¿¾ì¹ç¤Ï²ñ·×¤Ë°ú·Ñ¤°
           IF    ( SPA-NAI-I01-PTID    NOT =   ZERO )
               MOVE    SPA-NAI-I01-PTID
                                   TO  SPA-PTID
               MOVE    SPA-GMN-I01-PTNUM
                                   TO  SPA-PTNUM
               MOVE    SPA-NAI-I01-KANANAME
                                   TO  SPA-KANANAME
               MOVE    SPA-GMN-I01-NAME
                                   TO  SPA-NAME
               MOVE    SPA-GMN-I01-SEX
                                   TO  SPA-SEX
               MOVE    SPA-GMN-I01-BIRTHDAY
                                   TO  SPA-BIRTHDAYW
               MOVE    SPA-NAI-I01-BIRTHDAY
                                   TO  SPA-BIRTHDAY
           END-IF
      *
           .
       4801-SENIJI-PARA-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       480-TOUROKU-SEC                 SECTION.
      *
           IF    ( SPA-GMN-I01-SYORIKBN-CD     =   "02" OR "10" )
            AND  ( FLG-TEIKI-CHK       =   1 )
      *
      *        Äê´üÀÁµá½èÍýÃæ¥Á¥§¥Ã¥¯
               PERFORM 4801-TEIKI-JOB-CHK-SEC
               IF    ( SPA-I0IDCD      NOT =   SPACE )
                   GO  TO  480-TOUROKU-EXT
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-SYORIKBN-CD     =   "10" )
      *
               PERFORM 4101-GMN-SPA-SET-SEC
           ELSE
      *
               PERFORM 410-INPUT-CHK-SEC
               IF    ( SPA-ERRCD       NOT =   SPACE )
                   GO  TO  480-TOUROKU-EXT
               END-IF
      *
               PERFORM 4801-KANREN-CHK-SEC
               IF    ( SPA-ERRCD       NOT =   SPACE )
                   GO  TO  480-TOUROKU-EXT
               END-IF
           END-IF
      *
           PERFORM 4801-SYORI-KANREN-CHK-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  480-TOUROKU-EXT
           END-IF
      *
           MOVE    SPACE           TO  WRK-UPDKBN
           EVALUATE    SPA-GMN-I01-SYORIKBN-CD
      *    Æþ±¡ÅÐÏ¿
           WHEN    "01"
      *
               IF    ( FLG-TAINDOUJITU =   1 )
                   MOVE    "3009"  TO  SPA-I0IDCD
                   GO  TO  480-TOUROKU-EXT
               END-IF
      *
               IF    ( FLG-TAINDOUJITU =   2 )
                   MOVE    "3010"  TO  SPA-I0IDCD
                   GO  TO  480-TOUROKU-EXT
               END-IF
      *
               MOVE    "INS"       TO  WRK-UPDKBN
      *
      *    Âà±¡ÅÐÏ¿
           WHEN    "02"
      *
               IF    ( FLG-SYUARI  NOT =   ZERO )
                   MOVE    "3005"  TO  SPA-I0IDCD
                   GO  TO  480-TOUROKU-EXT
               END-IF
      *
      *        ¿ÇÎÅ²ñ·×¥Æ¡¼¥Ö¥ë¥Á¥§¥Ã¥¯½èÍý
               PERFORM 490-SRYACCT-CHK-SEC
               IF    ( SPA-I0IDCD  NOT =   SPACE )
                 OR  ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  480-TOUROKU-EXT
               END-IF
      *
      *        Âà±¡½èÍý
               MOVE    "CHANGE"    TO  WRK-MCP-PUTTYPE
               PERFORM 490-TAIIN-SYORI-SEC
               IF    ( SPA-ERRCD       NOT =   SPACE )
                   GO  TO  480-TOUROKU-EXT
               END-IF
               GO  TO  480-TOUROKU-EXT
      *    Å¾²Ê¡¦Å¾Åï¡¦Å¾¼¼
           WHEN    "08"
               MOVE    "INS"       TO  WRK-UPDKBN
      *    Æþ±¡¼è¾Ã
           WHEN    "05"
               IF    ( SPA-NAI-I01-PTRRKEDANUM >   1 )
                   MOVE    "3006"      TO  SPA-I0IDCD
               ELSE
                   MOVE    "3001"      TO  SPA-I0IDCD
               END-IF
               GO  TO  480-TOUROKU-EXT
      *    Æþ±¡¼è¾Ã¡Ê²ñ·×´Þ¤à¡Ë
           WHEN    "06"
               IF    ( SPA-NAI-I01-PTRRKEDANUM >   1 )
                   MOVE    "3007"      TO  SPA-I0IDCD
               ELSE
                   MOVE    "3002"      TO  SPA-I0IDCD
               END-IF
               GO  TO  480-TOUROKU-EXT
      *    Âà±¡¼è¾Ã
           WHEN    "07"
               MOVE    "3003"      TO  SPA-I0IDCD
               GO  TO  480-TOUROKU-EXT
      *    °ÛÆ°¼è¾Ã
           WHEN    "09"
               MOVE    "DEL"       TO  WRK-UPDKBN
               MOVE    "3101"      TO  SPA-I0IDCD2
               GO  TO  480-TOUROKU-EXT
      *    Âà±¡ºÆ·×»»
           WHEN    "10"
               MOVE    "CHANGE"    TO  WRK-MCP-PUTTYPE
               PERFORM 490-TAIIN-SAIKEISAN-SYORI-SEC
               IF    ( SPA-ERRCD       NOT =   SPACE )
                   GO  TO  480-TOUROKU-EXT
               END-IF
               GO  TO  480-TOUROKU-EXT
      *    ¤½¤ÎÂ¾
           WHEN    OTHER
               MOVE    "UPD"       TO  WRK-UPDKBN
           END-EVALUATE
      *
           PERFORM 4801-PTNYUINRRK-UPD-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  480-TOUROKU-EXT
           END-IF
      *
           .
      *
       480-TOUROKU-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼ÔÍúÎò¥Þ¥¹¥¿¹¹¿·½èÍý
      *****************************************************************
       4801-PTNYUINRRK-UPD-SEC     SECTION.
      *
      *    Æþ±¡ÍúÎò¥Ç¡¼¥¿ÊÔ½¸
           PERFORM 4801-PTNYUINRRK-EDIT-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  4801-PTNYUINRRK-UPD-EXT
           END-IF
      *
           EVALUATE WRK-UPDKBN
           WHEN    "INS"
      *        Æþ±¡ÍúÎò¥Þ¥¹¥¿ÄÉ²Ã
               MOVE    "PTNYUINRRK-KEY"
                                       TO  WRK-DBPATH
               MOVE    PTNYUINRRK-REC  TO  MCPDATA-REC
               PERFORM 900-TBL-INSERT-SEC
           WHEN    "UPD"
      *        Æþ±¡ÍúÎò¥Þ¥¹¥¿¹¹¿·
               MOVE    "PTNYUINRRK-KEY"
                                       TO  WRK-DBPATH
               MOVE    PTNYUINRRK-REC  TO  MCPDATA-REC
               PERFORM 900-TBL-UPDATE-SEC
           WHEN    "DEL"
      *        Æþ±¡ÍúÎò¥Þ¥¹¥¿ºï½ü
               IF    ( SPA-GMN-I01-SYORIKBN-CD
                                       =   "05"  OR  "06" )
                   MOVE    "PTNYUINRRK-DEL1"
                                       TO  WRK-DBPATH
               ELSE
                   MOVE    "PTNYUINRRK-KEY"
                                       TO  WRK-DBPATH
               END-IF
               MOVE    PTNYUINRRK-REC  TO  MCPDATA-REC
               PERFORM 900-TBL-DELETE-SEC
           END-EVALUATE
      *
           IF    ( FLG-DBRC    NOT =   ZERO )
      *        Æþ±¡Îò¤òºÆÊÔ½¸
               PERFORM 4101-NYUREKI-EDIT-SEC
               MOVE    "4001"      TO  SPA-ERRCD
               GO  TO  4801-PTNYUINRRK-UPD-EXT
           END-IF
      *
      *    Æþ±¡²ñ·×¥Æ¡¼¥Ö¥ë¤òÊÔ½¸¤¹¤ë¡ÊÆþ±¡»þ¡¦Å¾¼¼»þ¡Ë
      *     IF    ( SPA-GMN-I01-SYORIKBN-CD =   "01"
      *                                     OR  "08" )
           IF      SPA-GMN-I01-SYORIKBN-CD =   "01"
               PERFORM 4801-NYUKAIKEI-EDIT-SEC
               IF    ( SPA-ERRCD       NOT =   SPACE )
                   GO  TO  4801-PTNYUINRRK-UPD-EXT
               END-IF
           END-IF
      *
      *    Æþ±¡²ñ·×¥Æ¡¼¥Ö¥ë¤òÊÔ½¸¤¹¤ë¡ÊÆþ±¡¼è¾Ã»þ¡Ë
           IF     SPA-GMN-I01-SYORIKBN-CD =   "05"  OR  "06"
               PERFORM 4801-NYUKAIKEI-ERASE-SEC
           END-IF
      *
      *    Æþ±¡²ñ·×¥Æ¡¼¥Ö¥ë¤òÊÔ½¸¤¹¤ë¡ÊÂà±¡¼è¾Ã»þ¡Ë
           IF     SPA-GMN-I01-SYORIKBN-CD =   "07"
               PERFORM 4801-TAIINKAIKEI-CANCEL-SEC
           END-IF
      *
      *    Æþ±¡²ñ·×¥Æ¡¼¥Ö¥ë¤òÊÔ½¸¤¹¤ë¡ÊÅ¾²Ê¡¿Å¾Åï¡¿Å¾¼¼»þ¡Ë
           IF     SPA-GMN-I01-SYORIKBN-CD =   "08"
               PERFORM 4801-TENROOM-EDIT-SEC
               IF     IPN-NYUKAIKEI-SAKUSEI-FLG    =   "1"
                   MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
                   MOVE    IPN-SANTEISTYMD   TO   WRK-SANTEISTYMD
                   MOVE    IPN-SANTEISTYMD   TO   SPA-NAI-I01-IDOYMD
                   PERFORM   4801-TENROOM-EDIT-SEC
               END-IF
           END-IF
      *
      *    Æþ±¡²ñ·×¥Æ¡¼¥Ö¥ë¤òÊÔ½¸¤¹¤ë¡Ê°ÛÆ°¼è¾Ã»þ¡Ë
           IF     SPA-GMN-I01-SYORIKBN-CD =   "09"
               PERFORM 4801-IDOKAIKEI-CANCEL-SEC
           END-IF
      *
      *    ´µ¼Ô¾ðÊó¤ÎÆþ±¡ÎòÈÖ¹æ¤ò¹¹¿·¤¹¤ë
           PERFORM 4801-PTINF-UPD-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  4801-PTNYUINRRK-UPD-EXT
           END-IF
      *
      *    Á°²ó´µ¼Ô¾ðÊó¤òÀßÄê
           MOVE SPA-NAI-I01-PTID   TO  SPA-LAST-PTID
           MOVE SPA-GMN-I01-PTNUM  TO  SPA-LAST-PTNUM
      *
      *    ²èÌÌ¤ò¹¹¿·¸å¤ÎÆâÍÆ¤ÇºÆÉ½¼¨
           PERFORM 4101-PTNUM-CHK-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  4801-PTNYUINRRK-UPD-EXT
           END-IF
           .
      *
       4801-PTNYUINRRK-UPD-EXT.
           EXIT.
      *****************************************************************
      *    Äê´üÀÁµá½èÍýÃæ¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-TEIKI-JOB-CHK-SEC          SECTION.
      *
      *    ¥¸¥ç¥Ö´ÉÍý¥Á¥§¥Ã¥¯½èÍý
           MOVE    "CHK"               TO  SJOBKANRI-MODE
           INITIALIZE                      JOBKANRI-REC
           MOVE    CONST-JOB-JOBID     TO  JOB-JOBID
           MOVE    CONST-JOB-SHELLID   TO  JOB-SHELLID
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA
                                   JOBKANRI-REC
           IF    ( SJOBKANRI-RETURN    =   ZERO )
               IF    ( JOB-ENDYMD      =   SPACE )
                   MOVE    "3008"      TO  SPA-I0IDCD
               END-IF
           END-IF
      *
           .
       4801-TEIKI-JOB-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ´ØÏ¢¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4801-KANREN-CHK-SEC         SECTION.
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¤¬Â¸ºß¤¹¤ë¤³¤È
      *    IF    ( SPA-GMN-I01-HKNCOMBI-CNT    >   ZERO )
      *        CONTINUE
      *    ELSE
      *        MOVE    "1021"      TO  SPA-ERRCD
      *        MOVE    1           TO  SPA-GMN-I01-CUR
      *        GO  TO  4801-KANREN-CHK-EXT
      *    END-IF
      *
      *    É¬¿ÜÆþÎÏ¥Á¥§¥Ã¥¯
      *    ÉÂ¼¼ÈÖ¹æ
           IF    ( SPA-GMN-I01-BRMNUM      =   SPACE )
               MOVE    "1003"      TO  SPA-ERRCD
               MOVE    4           TO  SPA-GMN-I01-CUR
               GO  TO  4801-KANREN-CHK-EXT
           END-IF
      *
      *    ÉÂÅïÌ¾
           IF    ( SPA-GMN-I01-BTUNAME     =   SPACE )
               MOVE    "1004"      TO  SPA-ERRCD
               MOVE    5           TO  SPA-GMN-I01-CUR
               GO  TO  4801-KANREN-CHK-EXT
           END-IF
      *
      *    Æþ±¡Æü
           IF    ( SPA-GMN-I01-NYUINYMD    =   SPACE )
               MOVE    "1005"      TO  SPA-ERRCD
               MOVE    7           TO  SPA-GMN-I01-CUR
               GO  TO  4801-KANREN-CHK-EXT
           END-IF
      *
      *    Æþ±¡²Ê
           IF    ( SPA-GMN-I01-NYUINKA     =   SPACE )
               MOVE    "1006"      TO  SPA-ERRCD
               MOVE    8           TO  SPA-GMN-I01-CUR
               GO  TO  4801-KANREN-CHK-EXT
           END-IF
      *
      *    ½é²ó
           IF    ( SPA-GMN-I01-SHOKAI      =   SPACE )
               MOVE    "1007"      TO  SPA-ERRCD
               MOVE    9           TO  SPA-GMN-I01-CUR
               GO  TO  4801-KANREN-CHK-EXT
           END-IF
      *
      *    ½é²óÍúÎòÈÖ¹æ
           IF    ( SPA-GMN-I01-SHOKAI-CD   =   "2" )
               IF    ( SPA-GMN-I01-SHONUM  =   ZERO )
                   MOVE    "1022"      TO  SPA-ERRCD
                   MOVE    10          TO  SPA-GMN-I01-CUR
                   GO  TO  4801-KANREN-CHK-EXT
               END-IF
           END-IF
      *
      *    Ã´Åö°å
      ***  IF    ( SPA-GMN-I01-DR (1)         =   SPACE )
      *     AND  ( SPA-GMN-I01-DR (2)         =   SPACE )
      *     AND  ( SPA-GMN-I01-DR (3)         =   SPACE )
      *        MOVE    "1008"      TO  SPA-ERRCD
      *        MOVE    11          TO  SPA-GMN-I01-CUR
      *        GO  TO  4801-KANREN-CHK-EXT
      *    END-IF
      *
      *
      *    ÊÝ¸±ÁÈ¹ç¤»
           IF    ( SPA-GMN-I01-HKNCOMBI    =   SPACE )
            AND  ( SPA-GMN-I01-SYORIKBN-CD =   "01" OR "08" )
               MOVE    "1009"      TO  SPA-ERRCD
               MOVE    15          TO  SPA-GMN-I01-CUR
               GO  TO  4801-KANREN-CHK-EXT
           END-IF
      *    Ï«ºÒÊÝ¸±¡Ê¥¢¥Õ¥¿¡¼¡Ë
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "01" OR "08" )
             IF    ( SPA-NAI-I01-RSI-HKNKBN    =   "3" )
               MOVE    "1033"      TO  SPA-ERRCD
               MOVE    15          TO  SPA-GMN-I01-CUR
               GO  TO  4801-KANREN-CHK-EXT
             END-IF
           END-IF
      *
      *    Äê´üÀÁµá
           IF    ( SPA-GMN-I01-SEIKYU      =   SPACE )
               MOVE    "1010"      TO  SPA-ERRCD
               MOVE    18          TO  SPA-GMN-I01-CUR
               GO  TO  4801-KANREN-CHK-EXT
           END-IF
      *
      *    ¸¡º÷»þ´µ¼ÔÉ½¼¨
           IF    ( SPA-GMN-I01-DISPKBN     =   SPACE )
               MOVE    "1011"      TO  SPA-ERRCD
               MOVE    19          TO  SPA-GMN-I01-CUR
               GO  TO  4801-KANREN-CHK-EXT
           END-IF
      *
      *    Æþ±¡´ðËÜÎÁ¥Á¥§¥Ã¥¯
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "01" OR "08" )
               IF    ( SPA-GMN-I01-TOKNYUIN    =   SPACE )
                   INITIALIZE  SYS-5001-REC
                   MOVE    "5001"              TO  SYS-5001-KANRICD
                   MOVE    SPA-GMN-I01-BTUNAME-CD
                                               TO  SYS-5001-KBNCD
                   MOVE    WRK-KIHON-KJNYMD    TO  ORC-DBYMD
                   MOVE    SYS-5001-REC        TO  MCPDATA-REC
                   MOVE    "SYSKANRI-KEY"      TO  WRK-DBPATH
                   PERFORM 900-TBL-SELECT-SEC
                   IF    ( FLG-DBRC    =   ZERO )
                       MOVE    MCPDATA-REC     TO  SYS-5001-REC
                   ELSE
                       INITIALIZE                  SYS-5001-REC
                   END-IF
      *
                   MOVE    "SYSKANRI-KEY"      TO  WRK-DBPATH
                   PERFORM 900-TBL-CLOSE-SEC
      *
                   IF    ( SYS-5001-BTU-KHNSRYCD   =   SPACE )
                       MOVE    "1027"          TO  SPA-ERRCD
                       MOVE    16              TO  SPA-GMN-I01-CUR
                       GO  TO  4801-KANREN-CHK-EXT
                   END-IF
               END-IF
           END-IF
      *
           .
       4801-KANREN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ½èÍýÊÌ´ØÏ¢¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4801-SYORI-KANREN-CHK-SEC       SECTION.
      *
      *    ½èÍý¶èÊ¬¸ÇÍ­¤Î´ØÏ¢¥Á¥§¥Ã¥¯
           EVALUATE    SPA-GMN-I01-SYORIKBN-CD
      *    Æþ±¡ÅÐÏ¿
           WHEN    "01"
               PERFORM 4801-NYUIN-TOUROKU-CHK-SEC
      *    Âà±¡ÅÐÏ¿
           WHEN    "02"
               PERFORM 4801-TAIIN-TOUROKU-CHK-SEC
      *    ÊÑ¹¹
           WHEN    "03"
               PERFORM 4801-HENKOU-CHK-SEC
      *    ¾È²ñ
           WHEN    "04"
               PERFORM 4801-SYOKAI-CHK-SEC
      *    Æþ±¡¼è¾Ã
           WHEN    "05"
           WHEN    "06"
               PERFORM 4801-NYUIN-TORIKESI-CHK-SEC
      *    Âà±¡¼è¾Ã
           WHEN    "07"
               PERFORM 4801-TAIIN-TORIKESI-CHK-SEC
      *    Å¾²Ê¡¡Å¾Åï¡¡Å¾¼¼
           WHEN    "08"
               PERFORM 4801-TEKNA-CHK-SEC
      *    °ÛÆ°¼è¾Ã
           WHEN    "09"
               PERFORM 4801-IDO-TORIKESI-CHK-SEC
      *    Âà±¡ºÆ·×»»
           WHEN    "10"
               PERFORM 4801-TAIIN-SAIKEISAN-CHK-SEC
           END-EVALUATE
      *
           .
       4801-SYORI-KANREN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÅÐÏ¿»þ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-NYUIN-TOUROKU-CHK-SEC      SECTION.
      *
      *    Á°²óÂà±¡Æü¡åÆþ±¡Æü¤È¤Ê¤Ã¤Æ¤¤¤ë¤³¤È
      *    Á°Îò¤¬¼«¡ÊÂ¾¡Ë±¡Îò¤Î¾ì¹ç¤ÏÁ°²óÂà±¡Æü¡ãÆþ±¡Æü¤È¤Ê¤Ã¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-NAI-I01-TTAIINYMD (1) NOT =   SPACE )
      *
               EVALUATE    SPA-NAI-I01-TZITA-FLG (1)
               WHEN    ZERO
                   IF    ( SPA-NAI-I01-TTAIINYMD (1)
                                  <=    SPA-NAI-I01-NYUINYMD )
                       CONTINUE
                   ELSE
                       MOVE    "1018"      TO  SPA-ERRCD
                       MOVE    7           TO  SPA-GMN-I01-CUR
                       GO  TO  4801-NYUIN-TOUROKU-CHK-EXT
                   END-IF
      *
      *            Æ±ÆüºÆÆþ±¡¤Î¾ì¹ç·ÑÂ³Æþ±¡¤È¤Ê¤Ã¤Æ¤¤¤ë¤³¤È
                   IF    ( SPA-NAI-I01-TTAIINYMD (1)
                                   =    SPA-NAI-I01-NYUINYMD )
                       IF    ( SPA-GMN-I01-SHOKAI-CD   =   "2" )
                         AND ( SPA-GMN-I01-SHONUM
                                   =   SPA-GMN-I01-TSHONUM (1)  )
                           CONTINUE
                       ELSE
                           MOVE    "1038"  TO  SPA-ERRCD
                           MOVE    10      TO  SPA-GMN-I01-CUR
                           GO  TO  4801-NYUIN-TOUROKU-CHK-EXT
                       END-IF
                   END-IF
               WHEN    1
                   IF    ( SPA-NAI-I01-TTAIINYMD (1)
                                  <=    SPA-NAI-I01-NYUINYMD )
                       IF    ( SPA-NAI-I01-TTAIINYMD (1)
                                   =    SPA-NAI-I01-NYUINYMD )
                           MOVE    SPA-NAI-I01-TNYUINYMD (1)
                                           TO  WRK-STYMD
                           MOVE    SPA-NAI-I01-TTAIINYMD (1)
                                           TO  WRK-EDYMD
                           PERFORM 5002-KIKAN-CALC-SEC
                           IF    ( SPA-NAI-I01-TNYURRKTAISYO (1)
                                           =   WRK-NISSU2 )
                               MOVE    1   TO  FLG-TAINDOUJITU
                           ELSE
                               MOVE    2   TO  FLG-TAINDOUJITU
                           END-IF
                       END-IF
                   ELSE
                       MOVE    "1018"      TO  SPA-ERRCD
                       MOVE    7           TO  SPA-GMN-I01-CUR
                       GO  TO  4801-NYUIN-TOUROKU-CHK-EXT
                   END-IF
               WHEN    OTHER
                   IF    ( SPA-NAI-I01-TTAIINYMD (1)
                                  <     SPA-NAI-I01-NYUINYMD )
                       CONTINUE
                   ELSE
                       MOVE    "1036"      TO  SPA-ERRCD
                       MOVE    7           TO  SPA-GMN-I01-CUR
                       GO  TO  4801-NYUIN-TOUROKU-CHK-EXT
                   END-IF
      *
      *            Á°²ó¼«±¡Îò¥Á¥§¥Ã¥¯
                   PERFORM 4801-ZENKAI-ZIINRRK-CHK-SEC
                   IF    ( SPA-ERRCD   NOT =   SPACE )
                       GO  TO  4801-NYUIN-TOUROKU-CHK-EXT
                   END-IF
               END-EVALUATE
           END-IF
      *
           .
       4801-NYUIN-TOUROKU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Á°²ó¼«±¡Îò¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-ZENKAI-ZIINRRK-CHK-SEC     SECTION.
      *
      *    Á°²óÆþ±¡Îò¡Ê¼«±¡Ê¬¡Ë¤ò¥Á¥§¥Ã¥¯
           MOVE    SPACE               TO  WRK-NYUINCHU-TAIINYMD
           MOVE    ZERO                TO  FLG-WKPTTEIKIRRK
      *
           INITIALIZE      WKPTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  WKPTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  WKPTNYUINRRK-PTID
      *
           MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  WRK-YMD
           MOVE    "1"                 TO  WRK-ZOGENPTN
           MOVE    -1                  TO  WRK-ZOGEN
           PERFORM 5002-CALENDAR-SEC
           MOVE    WRK-KEISANYMD       TO  WKPTNYUINRRK-NYUINYMD
                                           WRK-NYUINCHU-TAIINYMD
      *
           MOVE    WKPTNYUINRRK-REC    TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY12"  TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        NOT =   ZERO )
               MOVE    1               TO  FLG-WKPTTEIKIRRK
           ELSE
               MOVE    MCPDATA-REC     TO  WKPTNYUINRRK-REC
           END-IF
      *
           MOVE    "PTNYUINRRK-KEY12"  TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( FLG-WKPTTEIKIRRK    NOT =   ZERO )
               GO  TO  4801-ZENKAI-ZIINRRK-CHK-EXT
           END-IF
      *
      *    Á°Îò¤Î¼«±¡Îò¤¬¡ÖÆþ±¡Ãæ¡×¤Î¾ì¹ç
           IF    ( WKPTNYUINRRK-JTIKBN         =   "6" )
            AND  ( WKPTNYUINRRK-NYUINCHUKBN    =   "1" )
      *
      *        ·ÑÂ³Æþ±¡¤Ç¤¢¤ë¤³¤È
               IF    ( SPA-GMN-I01-SHOKAI-CD   NOT =   "2" )
                   MOVE    "1031"      TO  SPA-ERRCD
                   MOVE    9           TO  SPA-GMN-I01-CUR
                   GO TO   4801-ZENKAI-ZIINRRK-CHK-EXT
               END-IF
      *
      *        ½é²óÈÖ¹æ¤¬Åù¤·¤¤¤³¤È
               IF    ( WKPTNYUINRRK-SHONUM NOT =   SPA-GMN-I01-SHONUM )
                   MOVE    "1031"      TO  SPA-ERRCD
                   MOVE    10          TO  SPA-GMN-I01-CUR
                   GO TO   4801-ZENKAI-ZIINRRK-CHK-EXT
               END-IF
      *
      *        ¼«±¡Îò¤ÎÂà±¡Æü¤ÎÍâÆü¤¬Æþ±¡Æü¤È¤Ê¤Ã¤Æ¤¤¤ë¤³¤È
               IF    ( WKPTNYUINRRK-TAIINYMD
                                   NOT =   WRK-NYUINCHU-TAIINYMD )
                   MOVE    "1032"      TO  SPA-ERRCD
                   MOVE    7           TO  SPA-GMN-I01-CUR
                   GO TO   4801-ZENKAI-ZIINRRK-CHK-EXT
               END-IF
           END-IF
      *
           .
       4801-ZENKAI-ZIINRRK-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡ÅÐÏ¿»þ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-TAIIN-TOUROKU-CHK-SEC      SECTION.
      *
      *    Âà±¡Æü
           IF    ( SPA-GMN-I01-TAIINYMD    =   SPACE )
               MOVE    "1020"      TO  SPA-ERRCD
               MOVE    11          TO  SPA-GMN-I01-CUR
               GO  TO  4801-TAIIN-TOUROKU-CHK-EXT
           END-IF
      *
      *    Á°²ó°ÛÆ°Æü¤¬É½¼¨¤µ¤ì¤Æ¤¤¤Ê¤¤¾ì¹ç¤ÏÆþ±¡Æü¤ÈÂà±¡Æü¤òÈæ³Ó
      *    Á°²ó°ÛÆ°Æü¤¬É½¼¨¤µ¤ì¤Æ¤¤¤ë¾ì¹ç¤ÏÁ°²ó°ÛÆ°Æü¤ÈÂà±¡Æü¤òÈæ³Ó
           IF    ( SPA-GMN-I01-MAEIDOYMD  =   SPACE   )
               IF    ( SPA-NAI-I01-NYUINYMD
                                      <=   SPA-NAI-I01-TAIINYMD )
                   CONTINUE
               ELSE
                   MOVE    "1012"      TO  SPA-ERRCD
                   MOVE    11          TO  SPA-GMN-I01-CUR
                   GO  TO  4801-TAIIN-TOUROKU-CHK-EXT
               END-IF
           ELSE
               IF    ( SPA-NAI-I01-MAEIDOYMD
                                      <=   SPA-NAI-I01-TAIINYMD )
                   CONTINUE
               ELSE
                   MOVE    "1013"      TO  SPA-ERRCD
                   MOVE    11          TO  SPA-GMN-I01-CUR
                   GO  TO  4801-TAIIN-TOUROKU-CHK-EXT
               END-IF
           END-IF
      *
      *    Æ±ÆüºÆÆþ±¡¤Î¾ì¹ç¡¢Æþ±¡Æü¡âÂà±¡Æü¤È¤Ê¤Ã¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-NAI-I01-DJKBN   =   "1" OR "2" )
               IF    ( SPA-NAI-I01-NYUINYMD =   SPA-NAI-I01-TAIINYMD )
                   MOVE    "1037"      TO  SPA-ERRCD
                   MOVE    11          TO  SPA-GMN-I01-CUR
                   GO  TO  4801-TAIIN-TOUROKU-CHK-EXT
               END-IF
           END-IF
      *
      *    Äê´üÀÁµá¤È¤Î´ØÏ¢¥Á¥§¥Ã¥¯
      *    ÀÁµá³«»ÏÆü¼èÆÀ½èÍý
           PERFORM 4801-SKYSTYMD-GET-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  4801-TAIIN-TOUROKU-CHK-EXT
           END-IF
      *
      *    Á°²óÄê´üÀÁµáÆü¤ÎÍâÆü¡Ê¤¢¤ë¤¤¤ÏÆþ±¡Æü¡Ë
      *    ¡Á»»Äê³«»ÏÆü¤ÎÍâ·î¤Þ¤Ç¤Î
      *    ÆüÉÕ¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤ë¤³¤È
           MOVE    WRK-NOW-SKYSTYMD
                                   TO  WRK-YMD
           MOVE    "2"             TO  WRK-ZOGENPTN
           MOVE    1               TO  WRK-ZOGEN
           PERFORM 5002-CALENDAR-SEC
      *
           IF    ( SPA-NAI-I01-TAIINYMD (1 : 6)
                                   <= WRK-KEISANYMD (1 : 6) )
               CONTINUE
           ELSE
               MOVE    "1025"      TO  SPA-ERRCD
               MOVE    11          TO  SPA-GMN-I01-CUR
               GO  TO  4801-TAIIN-TOUROKU-CHK-EXT
           END-IF
      *
      *    ·îÅÓÃæ¤ÎÄê´üÀÁµá½ªÎ»¸å...(1)¡¢
      *    Äê´üÀÁµá¶èÊ¬¤ò¡Ö2 ·îËö»þ¤Î¤ßÀÁµá¡×¤ËÊÑ¹¹¤µ¤ì¤¿¾ì¹ç¡¢
      *    (1)¤ÇºîÀ®¤µ¤ì¤¿¼ýÇ¼¤¬Ì¤Æþ¶â¤Ç¤¢¤ë¤³¤È
           PERFORM 4801-MAE-TEIKI-SKYEDYMD-GET-SEC
           IF    ( SPA-GMN-I01-SEIKYU-CD   =   "2" )
             AND ( WRK-MAE-SKYEDYMD    NOT =   SPACE )
               MOVE    WRK-MAE-SKYEDYMD
                                       TO  WRK-YMD
               MOVE    "1"             TO  WRK-ZOGENPTN
               MOVE    1               TO  WRK-ZOGEN
               PERFORM 5002-CALENDAR-SEC
               IF    ( WRK-KEISANYMD (7 : 2)   NOT =   "01" )
                   MOVE    ZERO                TO  FLG-SYUNOU
                   INITIALIZE  SYUNOU-REC
                   MOVE    SPA-HOSPID          TO  SYU-HOSPID
                   MOVE    SPA-NAI-I01-PTID    TO  SYU-PTID
                   MOVE    "1"                 TO  SYU-NYUGAIKBN
                   MOVE    WRK-NOW-SKYSTYMD    TO  SYU-SKYSTYMD
                   MOVE    SPA-NAI-I01-TAIINYMD
                                           TO  SYU-SKYEDYMD
                   MOVE    SYUNOU-REC          TO  MCPDATA-REC
                   MOVE    "SYUNOU-KEY5"       TO  WRK-DBPATH
                   PERFORM 900-TBL-SELECT-SEC
                   IF    ( FLG-DBRC        NOT =   ZERO )
                       MOVE    1               TO  FLG-SYUNOU
                   END-IF
      *
                   PERFORM UNTIL   ( FLG-SYUNOU    NOT =   ZERO )
                            OR     ( SPA-ERRCD     NOT =   SPACE )
                       MOVE    MCPDATA-REC     TO  SYUNOU-REC
                       IF    ( SYU-NYUIN-RRKNUM
                                           =   SPA-NAI-I01-PTRRKNUM )
                        AND  ( SYU-DENPJTIKBN
                                       NOT =   "3" )
      *                 AND  ( SYU-CREATEKBN   =   "2" )
                           MOVE    1           TO  FLG-SYUARI
                           IF    ( SYU-NYUKIN-TOTAL    >   ZERO )
                               MOVE    "1028"  TO  SPA-ERRCD
                           END-IF
                       END-IF
      *
                       MOVE    "SYUNOU-KEY5"   TO  WRK-DBPATH
                       PERFORM 900-TBL-READ-SEC
                       IF    ( FLG-DBRC    NOT =   ZERO )
                           MOVE    1           TO  FLG-SYUNOU
                       END-IF
      *
                   END-PERFORM
      *
                   MOVE    "SYUNOU-KEY5"   TO  WRK-DBPATH
                   PERFORM 900-TBL-CLOSE-SEC
      *
                   IF    ( SPA-ERRCD     NOT =   SPACE )
                       MOVE    11          TO  SPA-GMN-I01-CUR
                       GO  TO  4801-TAIIN-TOUROKU-CHK-EXT
                   END-IF
               END-IF
      *
           END-IF
      *
      *    Âà±¡·î¤Ë²ñ·×¥Æ¡¼¥Ö¥ë¤¬Â¸ºß¤·¤Æ¤¤¤ë¤³¤È
           MOVE    SPA-NAI-I01-TAIINYMD (1 : 6)
                                       TO  WRK-NACCT-SRYYM
           PERFORM 4801-NYUINACCT-SEL-SEC
           IF    ( FLG-NYUINACCTARI    =   ZERO )
               MOVE    "1030"          TO  SPA-ERRCD
               GO  TO  4801-TAIIN-TOUROKU-CHK-EXT
           END-IF
      *
           .
       4801-TAIIN-TOUROKU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá³«»ÏÆü¼èÆÀ½èÍý
      *****************************************************************
       4801-SKYSTYMD-GET-SEC           SECTION.
      *
      *    Á°²óÄê´üÀÁµá½ªÎ»Æü¼èÆÀ½èÍý
           PERFORM 4801-MAE-TEIKI-SKYEDYMD-GET-SEC
           IF    ( WRK-MAE-SKYEDYMD    NOT =   SPACE )
               IF    ( WRK-MAE-SKYEDYMD
                                       >=  SPA-NAI-I01-TAIINYMD )
                   MOVE    "1026"      TO  SPA-ERRCD
                   MOVE    11          TO  SPA-GMN-I01-CUR
                   GO  TO  4801-SKYSTYMD-GET-EXT
               ELSE
                   MOVE    WRK-MAE-SKYEDYMD
                                       TO  WRK-YMD
                   MOVE    "1"         TO  WRK-ZOGENPTN
                   MOVE    1           TO  WRK-ZOGEN
                   PERFORM 5002-CALENDAR-SEC
                   MOVE    WRK-KEISANYMD
                                       TO  WRK-NOW-SKYSTYMD
                   IF    ( SPA-GMN-I01-SEIKYU-CD   =   "2" )
                       IF   ( SPA-NAI-I01-NYUINYMD (1 : 6)
                           <  WRK-NOW-SKYSTYMD     (1 : 6) )
                           MOVE    "01"    TO  WRK-NOW-SKYSTYMD (7 : 2)
                       ELSE
                           MOVE    SPA-NAI-I01-NYUINYMD
                                           TO  WRK-NOW-SKYSTYMD
      *
                           IF    ( SPA-NAI-I01-DJKBN   =   "1" )
                               MOVE    SPA-NAI-I01-NYUINYMD
                                               TO  WRK-YMD
                               MOVE    "1"     TO  WRK-ZOGENPTN
                               MOVE    1       TO  WRK-ZOGEN
                               PERFORM 5002-CALENDAR-SEC
                               MOVE    WRK-KEISANYMD
                                       TO  WRK-NOW-SKYSTYMD
                           END-IF
      *
                       END-IF
                   END-IF
               END-IF
           ELSE
               MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  WRK-NOW-SKYSTYMD
               IF    ( SPA-NAI-I01-DJKBN   =   "1" )
                   MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  WRK-YMD
                   MOVE    "1"         TO  WRK-ZOGENPTN
                   MOVE    1           TO  WRK-ZOGEN
                   PERFORM 5002-CALENDAR-SEC
                   MOVE    WRK-KEISANYMD
                                       TO  WRK-NOW-SKYSTYMD
               END-IF
           END-IF
      *
           .
       4801-SKYSTYMD-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÑ¹¹»þ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-HENKOU-CHK-SEC             SECTION.
      *
      *
           .
       4801-HENKOU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¾È²ñ»þ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-SYOKAI-CHK-SEC             SECTION.
      *
      *
           .
       4801-SYOKAI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡¼è¾Ã»þ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-NYUIN-TORIKESI-CHK-SEC     SECTION.
      *
      *
           .
       4801-NYUIN-TORIKESI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡¼è¾Ã»þ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-TAIIN-TORIKESI-CHK-SEC     SECTION.
      *
        
      *
           .
       4801-TAIIN-TORIKESI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Å¾²Ê¡¡Å¾Åï¡¡Å¾¼¼»þ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-TEKNA-CHK-SEC              SECTION.
      *
      *    °ÛÆ°Æü¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-GMN-I01-IDOYMD  =   SPACE )
               MOVE    "1014"      TO  SPA-ERRCD
               MOVE    3           TO  SPA-GMN-I01-CUR
               GO  TO  4801-TEKNA-CHK-EXT
           END-IF
      *
      *    Á°²ó°ÛÆ°Æü¤¬É½¼¨¤µ¤ì¤Æ¤¤¤Ê¤¤¾ì¹ç¤ÏÆþ±¡Æü¤È°ÛÆ°Æü¤òÈæ³Ó
      *    Á°²ó°ÛÆ°Æü¤¬É½¼¨¤µ¤ì¤Æ¤¤¤ë¾ì¹ç¤ÏÁ°²ó°ÛÆ°Æü¤È°ÛÆ°Æü¤òÈæ³Ó
           IF    ( SPA-GMN-I01-MAEIDOYMD  =   SPACE   )
               IF    ( SPA-NAI-I01-NYUINYMD
                                      <=   SPA-NAI-I01-IDOYMD )
                   CONTINUE
               ELSE
                   MOVE    "1015"      TO  SPA-ERRCD
                   MOVE    3           TO  SPA-GMN-I01-CUR
                   GO  TO  4801-TEKNA-CHK-EXT
               END-IF
           ELSE
               IF    ( SPA-NAI-I01-MAEIDOYMD
                                      <=   SPA-NAI-I01-IDOYMD )
                   CONTINUE
               ELSE
                   MOVE    "1016"      TO  SPA-ERRCD
                   MOVE    3           TO  SPA-GMN-I01-CUR
                   GO  TO  4801-TEKNA-CHK-EXT
               END-IF
           END-IF
      *
      *    *** 2004.03.11 ºï½ü ***
      *    Æþ±¡²Ê¤Þ¤¿¤Ï¡¢ÉÂ¼¼ÈÖ¹æ¤Þ¤¿¤Ï¡¢ÉÂÅïÌ¾¤Þ¤¿¤Ï¡¢ÆÃÄêÆþ±¡ÎÁ¤Î¤¤¤º¤ì
      *    ¤«¤¬ÊÑ¹¹¤µ¤ì¤Æ¤¤¤ë¤³¤È 
      *-   IF    ( SPA-GMN-I01-NYUINKA-CD  =   SPA-NAI-I01-NYUINKA-MOT )
      *-    AND  ( SPA-GMN-I01-BTUNAME     =   SPA-NAI-I01-BTUNAME-MOT )
      *-    AND  ( SPA-GMN-I01-BRMNUM      =   SPA-NAI-I01-BRMNUM-MOT  )
      *-    AND  ( SPA-GMN-I01-HKNCOMBI-CD =   SPA-NAI-I01-HKNCOMBI-MOT)
      *-    AND  ( SPA-NAI-I01-TOKNYUIN-ORG
      *-                                   =   SPA-NAI-I01-TOKNYUINMOT )
      *-           MOVE    "1017"      TO  SPA-ERRCD
      *-           MOVE    4           TO  SPA-GMN-I01-CUR
      *-           GO  TO  4801-TEKNA-CHK-EXT
      *-   END-IF
      *
      *    ³ºÅö·î¤Î²ñ·×¥Æ¡¼¥Ö¥ë¤¬ºîÀ®ºÑ¤Ç¤¢¤ë¤³¤È
           MOVE    SPA-NAI-I01-IDOYMD (1 : 6)
                                       TO  WRK-NACCT-SRYYM
           PERFORM 4801-NYUINACCT-SEL-SEC
           IF    ( FLG-NYUINACCTARI    =   ZERO )
               MOVE    "1029"          TO  SPA-ERRCD
               GO  TO  4801-TEKNA-CHK-EXT
           END-IF
      *
           .
       4801-TEKNA-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²ñ·×¸¡º÷½èÍý
      *****************************************************************
       4801-NYUINACCT-SEL-SEC              SECTION.
      *
           MOVE    ZERO                TO  FLG-NYUINACCTARI
      *
           MOVE    ZERO                TO  FLG-NYUINACCT
           INITIALIZE                      NYUINACCT-REC
           MOVE    SPA-HOSPID          TO  NACCT-HOSPID
           MOVE    "1"                 TO  NACCT-NYUGAIKBN
           MOVE    SPA-NAI-I01-PTID    TO  NACCT-PTID
           MOVE    WRK-NACCT-SRYYM
                                       TO  NACCT-SRYYM
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY7"    TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        NOT =   ZERO )
               MOVE    1               TO  FLG-NYUINACCT
           END-IF
      *
           PERFORM UNTIL ( FLG-NYUINACCT       NOT =   ZERO )
                    OR   ( FLG-NYUINACCTARI    NOT =   ZERO )
      *
               MOVE    MCPDATA-REC     TO  NYUINACCT-REC
      *
               IF    ( NACCT-ZAISKBKBN     =    "1"    )
                   MOVE    1           TO  FLG-NYUINACCTARI
               END-IF
      *
               MOVE    "NYUINACCT-KEY7"    TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
               IF    ( FLG-DBRC    NOT =   ZERO )
                   MOVE     1          TO  FLG-NYUINACCT
               END-IF
      *
           END-PERFORM
      *
           MOVE    "NYUINACCT-KEY7"    TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4801-NYUINACCT-SEL-EXT.
           EXIT.
      *****************************************************************
      *    °ÛÆ°¼è¾Ã»þ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-IDO-TORIKESI-CHK-SEC       SECTION.
      *
        
      *
           .
       4801-IDO-TORIKESI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡ºÆ·×»»´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-TAIIN-SAIKEISAN-CHK-SEC       SECTION.
      *
      *    Îò¤¬ÁªÂò¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-GMN-I01-NYUREKILST-SEL >   ZERO )
            AND  ( SPA-GMN-I01-NYUREKILST-SEL
                              <=   SPA-GMN-I01-NYUREKILST-CNT )
               CONTINUE
           ELSE
               MOVE    "1034"          TO  SPA-ERRCD
               GO  TO  4801-TAIIN-SAIKEISAN-CHK-EXT
           END-IF
      *
           MOVE    SPA-GMN-I01-NYUREKILST-SEL
                                       TO  IDX1
      *
      *    ÎòºîÀ®¥Ç¡¼¥¿¤¬ÁªÂò¤µ¤ì¤Æ¤¤¤Ê¤¤¤³¤È
           IF    ( SPA-NAI-I01-TZITA-FLG (IDX1)    NOT =   ZERO )
               MOVE    "1035"          TO  SPA-ERRCD
               GO  TO  4801-TAIIN-SAIKEISAN-CHK-EXT
           END-IF
      *
      *    Æþ±¡Ãæ¤ÎÎò¤¬ÁªÂò¤µ¤ì¤Æ¤¤¤Ê¤¤¤³¤È
           IF    ( SPA-NAI-I01-TTAIINYMD (IDX1)        =   SPACE )
               MOVE    "1034"          TO  SPA-ERRCD
               GO  TO  4801-TAIIN-SAIKEISAN-CHK-EXT
           END-IF
      *
           .
       4801-TAIIN-SAIKEISAN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÍúÎò¥Ç¡¼¥¿ÊÔ½¸
      *****************************************************************
       4801-PTNYUINRRK-EDIT-SEC    SECTION.
      *
      *    Æþ±¡ÍúÎò¥Ç¡¼¥¿ÊÔ½¸Á°½èÍý
           PERFORM 4801-PTNYUINRRK-EDIT-MAE-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  4801-PTNYUINRRK-EDIT-EXT
           END-IF
      *
           INITIALIZE              PTNYUINRRK-REC
      *
      *    °åÎÅµ¡´Ø£É£Ä
           MOVE    SPA-HOSPID      TO  PTNYUINRRK-HOSPID
      *
      *    ´µ¼Ô£É£Ä
           MOVE    SPA-NAI-I01-PTID
                                   TO  PTNYUINRRK-PTID
      *
      *    Æþ±¡ÍúÎòÈÖ¹æ¡ÊÆþ±¡£±²ó¤Ç¡Ü£±¤º¤ÄºÎÈÖ¡Ë
           MOVE    WRK-RRKNUM      TO  PTNYUINRRK-RRKNUM
      *
      *    Æþ±¡ÍúÎò»ÞÈÖ¹æ¡ÊÅ¾²Ê¡¦Å¾¼¼¡¦Å¾Åï»þ¤ËºÎÈÖ¡Ë
           MOVE    WRK-RRKEDANUM   TO  PTNYUINRRK-RRKEDANUM
      *
           IF    ( WRK-UPDKBN      =   "DEL" )
               GO  TO  4801-PTNYUINRRK-EDIT-EXT
           END-IF
      *
      *    ÉÂÅïÈÖ¹æ
           MOVE    SPA-GMN-I01-BTUNAME-CD
                                   TO  PTNYUINRRK-BTUNUM
           MOVE    SPA-GMN-I01-BTUNAME-CD
                                   TO  PTNYUINRRK-BRMNUM (1 : 2)
      *
      *    ÉÂÅïÌ¾¾Î
      *    MOVE    SPA-GMN-I01-BTUNAME-NM
      *                            TO  PTNYUINRRK-BTUNAME
      *
      *    ÉÂ¼¼ÈÖ¹æ
           MOVE    SPA-GMN-I01-BRMNUM
                                   TO  WRK-BRMNUM
      *    ÉÂ¼¼ÈÖ¹æ¤¬¿ô»ú¤Î¾ì¹ç¡¢Á°¥¼¥íÊÔ½¸¤ò¹Ô¤¦
           PERFORM 4800-BRMNUM-EDIT-SEC
           MOVE    WRK-BRMNUM-EDT  TO  PTNYUINRRK-BRMNUM (3 : 6)
      *    Æþ±¡²Ê
           MOVE    SPA-GMN-I01-NYUINKA-CD
                                   TO  PTNYUINRRK-NYUINKA
      *    ÊÝ¸±ÁÈ¹ç¤»ÈÖ¹æ
           MOVE    SPA-GMN-I01-HKNCOMBI-CD
                                   TO  PTNYUINRRK-HKNCOMBINUM
      *    Æþ±¡Æü
           MOVE    SPA-NAI-I01-NYUINYMD
                                   TO  PTNYUINRRK-NYUINYMD
      *    Âà±¡Æü¡¢Âà±¡»öÍ³
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "02" )
               MOVE    SPA-NAI-I01-TAIINYMD
                                   TO  PTNYUINRRK-TAIINYMD
               MOVE    SPA-GMN-I01-TAIINCD
                                   TO  PTNYUINRRK-TAIINCD
           ELSE
               MOVE    "99999999"  TO  PTNYUINRRK-TAIINYMD
               MOVE    SPACE       TO  PTNYUINRRK-TAIINCD
           END-IF
      *
      *    ÆÃÄêÆþ±¡ÎÁ¶èÊ¬
           MOVE    SPA-NAI-I01-TOKNYUIN-ORG-KBN
                                   TO  PTNYUINRRK-TOKUTEI-KBN
      *    ÆÃÄêÆþ±¡ÎÁ
           MOVE    SPA-NAI-I01-TOKNYUIN-ORG-CD
                                   TO  PTNYUINRRK-TOKUTEI-NYUIN
      *    ¼¼ÎÁº¹³Û
           MOVE    SPA-GMN-I01-SAGAKU-CD
                                   TO  PTNYUINRRK-RM-SAGAKU
      *    Äê´üÀÁµá¶èÊ¬
           MOVE    SPA-GMN-I01-SEIKYU-CD
                                   TO  PTNYUINRRK-TEIKI-SEIKYUKBN
      *    ¸¡º÷É½¼¨¶èÊ¬
           MOVE    SPA-GMN-I01-DISPKBN-CD
                                   TO  PTNYUINRRK-KENSAKU-DISPKBN
      *    ½é²ó·ÑÂ³¶èÊ¬
           MOVE    SPA-GMN-I01-SHOKAI-CD
                                   TO  PTNYUINRRK-SHOKAIKBN
      *    ½é²óÈÖ¹æ
           MOVE    WRK-SHONUM
                                   TO  PTNYUINRRK-SHONUM
      *
      *    Ã´Åö°å£±
           IF    ( SPA-GMN-I01-DR-CD (1)   NOT =   SPACE )
               MOVE    "1"         TO  PTNYUINRRK-DRCD1 ( 1 : 1 ) 
               MOVE    SPA-GMN-I01-DR-CD (1)
                                   TO  PTNYUINRRK-DRCD1 ( 2 : )
           END-IF
      *    Ã´Åö°å£²
           IF    ( SPA-GMN-I01-DR-CD (2)   NOT =   SPACE )
               MOVE    "1"         TO  PTNYUINRRK-DRCD2 ( 1 : 1 ) 
               MOVE    SPA-GMN-I01-DR-CD (2)
                                   TO  PTNYUINRRK-DRCD2 ( 2 : )
           END-IF
      *    Ã´Åö°å£³
           IF    ( SPA-GMN-I01-DR-CD (3)   NOT =   SPACE )
               MOVE    "1"         TO  PTNYUINRRK-DRCD3 ( 1 : 1 ) 
               MOVE    SPA-GMN-I01-DR-CD (3)
                                   TO  PTNYUINRRK-DRCD3 ( 2 : )
           END-IF
      *    ¾õÂÖ¶èÊ¬
      *    ¡Ê£±¡§Æþ±¡¡¡£²¡§Å¾²Ê¡¡£³¡§Å¾Åï¡¡£´¡§Å¾¼¼¡¡£µ¡§Â¾±¡Îò
      *      £¶¡§¼«±¡Îò ¡Ë
      *    Å¾ÆþÆü
      *    Å¾½ÐÆü
           EVALUATE    SPA-GMN-I01-SYORIKBN-CD
      *    Æþ±¡ÅÐÏ¿
           WHEN    "01"
               MOVE    "1"         TO  PTNYUINRRK-JTIKBN
               MOVE    SPA-NAI-I01-NYUINYMD
                                   TO  PTNYUINRRK-TENNYUYMD
               MOVE    "99999999"  TO  PTNYUINRRK-TENSTUYMD
      *    Âà±¡ÅÐÏ¿
      *    WHEN    "02"
      *        MOVE    WRK-JTIKBN  TO  PTNYUINRRK-JTIKBN
      *        MOVE    WRK-TENNYUYMD
      *                            TO  PTNYUINRRK-TENNYUYMD
      *        MOVE    SPA-NAI-I01-TAIINYMD
      *                            TO  PTNYUINRRK-TENSTUYMD
      *    Âà±¡¼è¾Ã
           WHEN    "07"
               MOVE    WRK-JTIKBN  TO  PTNYUINRRK-JTIKBN
               MOVE    WRK-TENNYUYMD
                                   TO  PTNYUINRRK-TENNYUYMD
               MOVE    "99999999"  TO  PTNYUINRRK-TENSTUYMD
      *    Å¾²Ê¡¡Å¾Åï¡¡Å¾¼¼
           WHEN    "08"
      *
               EVALUATE    TRUE
      *        ²Ê¤¬ÊÑ¤ï¤Ã¤¿¾ì¹ç
               WHEN    WRK-NYUINKA-KEY NOT =   PTNYUINRRK-NYUINKA
                   MOVE    "2"   TO  PTNYUINRRK-JTIKBN
      *        ÉÂÅï¤¬ÊÑ¤ï¤Ã¤¿¾ì¹ç
               WHEN    WRK-BTUNUM-KEY  NOT =   PTNYUINRRK-BTUNUM
                   MOVE    "3"   TO  PTNYUINRRK-JTIKBN
      *        ÉÂ¼¼¤¬ÊÑ¤ï¤Ã¤¿¾ì¹ç
               WHEN    WRK-BRMNUM-KEY  NOT =   PTNYUINRRK-BRMNUM
                   MOVE    "4"   TO  PTNYUINRRK-JTIKBN
      *        Æþ±¡ÎÁ¤¬ÊÑ¤ï¤Ã¤¿¤È¤­
               WHEN  ( WRK-HKNCOMBI-KEY
                                       NOT  =  PTNYUINRRK-HKNCOMBINUM )
               WHEN  ( WRK-TOKUTEI-KBN-KEY
                                   NOT =   PTNYUINRRK-TOKUTEI-KBN )
                 OR  ( WRK-TOKUTEI-NYUIN-KEY
                                   NOT =   PTNYUINRRK-TOKUTEI-NYUIN )
                   MOVE    "7"   TO  PTNYUINRRK-JTIKBN
               WHEN    OTHER
                   MOVE    "7"   TO  PTNYUINRRK-JTIKBN
               END-EVALUATE
      *
               MOVE    SPA-NAI-I01-IDOYMD
                                   TO  PTNYUINRRK-TENNYUYMD
               MOVE    "99999999"  TO  PTNYUINRRK-TENSTUYMD
      *    ¤½¤ÎÂ¾
           WHEN    OTHER
               MOVE    WRK-JTIKBN  TO  PTNYUINRRK-JTIKBN
               MOVE    WRK-TENNYUYMD
                                   TO  PTNYUINRRK-TENNYUYMD
               MOVE    WRK-TENSTUYMD
                                   TO  PTNYUINRRK-TENSTUYMD
           END-EVALUATE
      *
      *    Æþ±¡Ãæ¶èÊ¬ ("0"¸ÇÄê)
           MOVE    "0"             TO  PTNYUINRRK-NYUINCHUKBN
      *
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "01" )
               IF    ( SPA-NAI-I01-TTAIINYMD (1)   NOT =   SPACE )
                   IF    ( SPA-NAI-I01-TTAIINYMD (1)
                                   =   SPA-NAI-I01-NYUINYMD )
                       EVALUATE    SPA-NAI-I01-TZITA-FLG (1)
                       WHEN    ZERO
                           MOVE    "1" TO  PTNYUINRRK-DOUJITSUKBN
                       WHEN    1
                           MOVE    "2" TO  PTNYUINRRK-DOUJITSUKBN
                       END-EVALUATE
                   END-IF
               END-IF
           ELSE
                       MOVE    SPA-NAI-I01-DJKBN
                                   TO  PTNYUINRRK-DOUJITSUKBN
           END-IF
      *
           IF    ( WRK-UPDKBN      =   "UPD" )
      *
               PERFORM 800-MCNDATE-SEC
               MOVE    WRK-CREYMD      TO  PTNYUINRRK-CREYMD
               MOVE    SMCNDATE-YMD    TO  PTNYUINRRK-UPYMD
               MOVE    SMCNDATE-HMS    TO  PTNYUINRRK-UPHMS
           ELSE
               PERFORM 800-MCNDATE-SEC
               MOVE    SMCNDATE-YMD    TO  PTNYUINRRK-CREYMD
                                           PTNYUINRRK-UPYMD
               MOVE    SMCNDATE-HMS    TO  PTNYUINRRK-UPHMS
           END-IF
      *
           .
      *
       4801-PTNYUINRRK-EDIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡ÍúÎò¥Ç¡¼¥¿ÊÔ½¸
      *****************************************************************
       4801-PTNYUINRRK-EDIT-MAE-SEC    SECTION.
      *
           MOVE    SPACE           TO  WRK-CREYMD
                                       WRK-TENNYUYMD
                                       WRK-TENSTUYMD
                                       WRK-NYUINKA-KEY
                                       WRK-BTUNUM-KEY
                                       WRK-BRMNUM-KEY
                                       WRK-TOKUTEI-KEY
           MOVE    ZERO            TO  WRK-SHONUM
      *
           MOVE    SPA-NAI-I01-PTRRKNUM
                                   TO  WRK-RRKNUM
           MOVE    SPA-NAI-I01-PTRRKEDANUM
                                   TO  WRK-RRKEDANUM
      *
      *    Æþ±¡ÅÐÏ¿»þ¡¢Â¾±¡Âà±¡Æü¤È¤ÎÆ±°ìÆþ±¡»þ¤ÇÂ¾±¡Îò¤Î
      *    ÄÌ»»Æü¿ô¤òÄ´À°¤¹¤ë¾ì¹ç
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "01" )
            AND  ( FLG-TAINTUSANMINUS      =   1 )
               PERFORM 4801-TAINTUSANMINUS-UPD-SEC
               IF    ( SPA-ERRCD       NOT =   SPACE )
                   GO  TO  4801-PTNYUINRRK-EDIT-MAE-EXT
               END-IF
           END-IF
      *
      *    Æþ±¡ÅÐÏ¿¤Ç½é²ó¤Î¾ì¹ç¡¢ÀßÄê¤¹¤ë½é²óÈÖ¹æ¤òµá¤á¤ë
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "01" )
            AND  ( SPA-GMN-I01-SHOKAI-CD   =   "1"  )
               PERFORM 4801-SYOKAI-GET-SEC
           ELSE
               COMPUTE WRK-SHONUM      =   SPA-GMN-I01-SHONUM
           END-IF
      *
      *    Âà±¡¼è¾Ã½èÍý»þ¡¢ÍúÎò¤òÁÌ¤Ã¤ÆÂà±¡Æü¤ò¹¹¿·¤¹¤ë
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "07" )
      *
               PERFORM 4801-TAIINYMD-UPD-SEC
      *
      *        Á°²óÄê´üÀÁµá½ªÎ»Æü¼èÆÀ½èÍý
               PERFORM 4801-MAE-TEIKI-SKYEDYMD-GET-SEC
               IF    ( WRK-MAE-SKYEDYMD    =   SPACE )
                   MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  WRK-SKYSTYMD
               ELSE
                   MOVE    WRK-MAE-SKYEDYMD
                                       TO  WRK-YMD
                   MOVE    "1"         TO  WRK-ZOGENPTN
                   MOVE    1           TO  WRK-ZOGEN
                   PERFORM 5002-CALENDAR-SEC
                   MOVE    WRK-KEISANYMD
                                       TO  WRK-SKYSTYMD
               END-IF
               MOVE    SPA-NAI-I01-TAIINYMD
                                       TO  WRK-SKYEDYMD
      *        ¼ýÇ¼¥Ç¡¼¥¿¤ò¹¹¿·¤¹¤ë
               PERFORM 4801-SYUNOU-UPD-SEC
               IF    ( SPA-ERRCD       NOT =   SPACE )
                   GO  TO  4801-PTNYUINRRK-EDIT-MAE-EXT
               END-IF
      *
           END-IF
      *
      *    Æþ±¡¼è¾Ã»þ¡¢Å¾²ÊÎò¤ò¥ï¡¼¥¯¤ËÂàÈò¤¹¤ë
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "05"  OR  "06" )
               PERFORM 4801-TENKAREKI-TAIHI-SEC
      *
      *        -- Äê´üÀÁµá¤ÇºîÀ®¤µ¤ì¤¿¼ýÇ¼¥Ç¡¼¥¿¤ò¼è¾Ã
      *        Á°²óÄê´üÀÁµá½ªÎ»Æü¼èÆÀ½èÍý
               PERFORM 4801-MAE-TEIKI-SKYEDYMD-GET-SEC
               IF    ( WRK-MAE-SKYEDYMD    =   SPACE )
                   CONTINUE
               ELSE
                   MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  WRK-SKYSTYMD
                   MOVE    WRK-MAE-SKYEDYMD
                                       TO  WRK-SKYEDYMD
      *
      *            ´µ¼ÔÄê´üÀÁµáÍúÎò¤òºï½ü¤¹¤ë
                   PERFORM 4801-PTTEIKIRRK-DEL-SEC
                   IF    ( SPA-ERRCD       NOT =   SPACE )
                       GO  TO  4801-PTNYUINRRK-EDIT-MAE-EXT
                   END-IF
      *
      *            Äê´üÀÁµáÍúÎò¤ò¹¹¿·¤¹¤ë
                   PERFORM 4801-TEIKIRRK-UPD-SEC
                   IF    ( SPA-ERRCD       NOT =   SPACE )
                       GO  TO  4801-PTNYUINRRK-EDIT-MAE-EXT
                   END-IF
      *
      *            ¼ýÇ¼¥Ç¡¼¥¿¤ò¹¹¿·¤¹¤ë
                   PERFORM 4801-SYUNOU-UPD-SEC
                   IF    ( SPA-ERRCD       NOT =   SPACE )
                       GO  TO  4801-PTNYUINRRK-EDIT-MAE-EXT
                   END-IF
      *
               END-IF
           END-IF
      *
      *    Å¾²Ê¡¦Å¾Åï¡¦Å¾¼¼¤Î¾ì¹ç¡¢Å¾½Ð¸µ¤ÎÎò¤ÎÅ¾½ÐÆü¤Ë°ÛÆ°Æü¤òÀßÄê
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "08" )
               PERFORM 4801-TENSYUTU-MOTO-UPD-SEC
               IF    ( SPA-ERRCD       NOT =   SPACE )
                   GO  TO  4801-PTNYUINRRK-EDIT-MAE-EXT
               END-IF
           END-IF
      *
      *    °ÛÆ°¼è¾Ã¤Î¾ì¹ç¡¢°ÛÆ°Á°¤ÎÎò¤ÎÅ¾½ÐÆü¤ËALL9¤òÀßÄê
           IF    ( SPA-GMN-I01-SYORIKBN-CD =   "09" )
               PERFORM 4801-IDO-MAE-UPD-SEC
               IF    ( SPA-ERRCD       NOT =   SPACE )
                   GO  TO  4801-PTNYUINRRK-EDIT-MAE-EXT
               END-IF
           END-IF
      *
           PERFORM 4801-RRKNUM-EDIT-SEC
      *
      *    Æþ±¡ÍúÎò¥Þ¥¹¥¿¸¡º÷
           PERFORM 4801-PTNYUINRRK-SEL-SEC
           IF    ( FLG-PTNYUINRRK  =   ZERO )
      *        ÄÉ²Ã½èÍý»þ¡¢´û¤Ë¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¾ì¹ç¤Ï¥¨¥é¡¼¤È¤¹¤ë
               IF    ( WRK-UPDKBN  =   "INS" )
      *            Æþ±¡Îò¤òºÆÊÔ½¸
                   PERFORM 4101-NYUREKI-EDIT-SEC
                   MOVE    "4002"  TO  SPA-ERRCD
                   GO  TO  4801-PTNYUINRRK-EDIT-MAE-EXT
               ELSE
      *
      *            ¹¹¿·¥Ç¡¼¥¿ÍÑ¤Ë¾õÂÖ¶èÊ¬Åù¤òÂàÈò
                   MOVE    PTNYUINRRK-JTIKBN
                                   TO  WRK-JTIKBN
                   MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  WRK-TENNYUYMD
                   MOVE    PTNYUINRRK-TENSTUYMD
                                   TO  WRK-TENSTUYMD
                   MOVE    PTNYUINRRK-CREYMD
                                   TO  WRK-CREYMD
               END-IF
           ELSE
      *        ¹¹¿·¡¦ºï½ü½èÍý»þ¡¢ÂÐ¾Ý¥Ç¡¼¥¿¤¬Â¸ºß¤·¤Ê¤±¤ì¤Ð¥¨¥é¡¼¤È¤¹¤ë
               IF    ( WRK-UPDKBN  =   "UPD" OR "DEL")
      *            Æþ±¡Îò¤òºÆÊÔ½¸
                   PERFORM 4101-NYUREKI-EDIT-SEC
                   MOVE    "4003"  TO  SPA-ERRCD
                   GO  TO  4801-PTNYUINRRK-EDIT-MAE-EXT
               END-IF
           END-IF
      *
      *
           .
       4801-PTNYUINRRK-EDIT-MAE-EXT.
           EXIT.
      *****************************************************************
      *    ½é²óÈÖ¹æ¼èÆÀ½èÍý
      *****************************************************************
       4801-SYOKAI-GET-SEC         SECTION.
      *
      *    Æþ±¡ÍúÎò¥Þ¥¹¥¿¸¡º÷
           MOVE    ZERO                TO  FLG-PTNYUINRRK
           INITIALIZE  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY6"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO  )
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
           ELSE
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF
      *
           MOVE    "PTNYUINRRK-KEY6"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( FLG-PTNYUINRRK  NOT =   ZERO )
               COMPUTE WRK-SHONUM  =   1
           ELSE
               COMPUTE WRK-SHONUM  =   PTNYUINRRK-SHONUM   +   1
           END-IF
      *
           .
       4801-SYOKAI-GET-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡Æü¹¹¿·½èÍý
      *****************************************************************
       4801-TAIINYMD-UPD-SEC       SECTION.
      *
           MOVE    ZERO                TO  WRK-TAIINUPDCNT
      *
      *    Æþ±¡ÍúÎò¥Þ¥¹¥¿¸¡º÷
           INITIALIZE  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    SPA-NAI-I01-PTRRKNUM
                                       TO  PTNYUINRRK-RRKNUM
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY4"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
      *    Æþ±¡Îò¤ÎÂà±¡Æü¤ò¹¹¿·¤¹¤ë¡£
           PERFORM UNTIL ( FLG-DBRC    NOT =   ZERO )
      *
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
      *
               COMPUTE WRK-TAIINUPDCNT
                   =   WRK-TAIINUPDCNT +   1
      *
      *        ºÇ¿·Îò¤ÏÊÌÅÓ¹¹¿·½èÍý¤ò¹Ô¤¦
               IF    ( WRK-TAIINUPDCNT =   1 )
                   IF    ( SPA-NAI-I01-PTRRKNUM
                                       =   PTNYUINRRK-RRKNUM )
                    AND  ( SPA-NAI-I01-PTRRKEDANUM
                                       =   PTNYUINRRK-RRKEDANUM )
                       CONTINUE
                   ELSE
                       MOVE    "4004"  TO  SPA-ERRCD
                       GO  TO  4801-TAIINYMD-UPD-EXT
                   END-IF
               ELSE
                  MOVE    "99999999"
                                       TO  PTNYUINRRK-TAIINYMD
                  MOVE    SPACE        TO  PTNYUINRRK-TAIINCD
                  PERFORM 800-MCNDATE-SEC
                  MOVE    SMCNDATE-YMD        TO  PTNYUINRRK-UPYMD
                  MOVE    SMCNDATE-HMS        TO  PTNYUINRRK-UPHMS
      *
                   MOVE    "PTNYUINRRK-KEY"
                                       TO  WRK-DBPATH
                   MOVE    PTNYUINRRK-REC  TO  MCPDATA-REC
                   PERFORM 900-TBL-UPDATE-SEC
                   IF    ( FLG-DBRC    NOT =   ZERO )
                       MOVE    "4005"  TO  SPA-ERRCD
                       GO  TO  4801-TAIINYMD-UPD-EXT
                   END-IF
               END-IF
      *
               MOVE    "PTNYUINRRK-KEY4"   TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
           MOVE    "PTNYUINRRK-KEY4"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( WRK-TAIINUPDCNT     =   ZERO )
               MOVE    "4006"  TO  SPA-ERRCD
               GO  TO  4801-TAIINYMD-UPD-EXT
           END-IF
      *
      *
           .
       4801-TAIINYMD-UPD-EXT.
           EXIT.
      *****************************************************************
      *    ¼ýÇ¼¥Ç¡¼¥¿¹¹¿·½èÍý
      *****************************************************************
       4801-SYUNOU-UPD-SEC             SECTION.
      *
           MOVE    ZERO                TO  FLG-SYUNOU
           INITIALIZE  SYUNOU-REC
      *
           MOVE    SPA-HOSPID          TO  SYU-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  SYU-PTID
           MOVE    "1"                 TO  SYU-NYUGAIKBN
           MOVE    WRK-SKYSTYMD        TO  SYU-SKYSTYMD
           MOVE    WRK-SKYEDYMD        TO  SYU-SKYEDYMD
           MOVE    SYUNOU-REC          TO  MCPDATA-REC
           MOVE    "SYUNOU-KEY5"       TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        NOT =   ZERO )
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           PERFORM UNTIL ( FLG-SYUNOU  NOT =   ZERO )
      *
               MOVE    MCPDATA-REC     TO  SYUNOU-REC
      *
               IF    ( SYU-NYUIN-RRKNUM    =   SPA-NAI-I01-PTRRKNUM )
                AND  ( SYU-DENPJTIKBN  NOT =   "3" )
      *
      *            ¼ýÇ¼ÌÀºîÀ®½èÍý
                   PERFORM 4801-SYUMEI-SAKUSEI-SEC
                   IF    ( SPA-ERRCD   NOT =   SPACE )
                       GO  TO  4801-SYUNOU-UPD-EXT
                   END-IF
      *
      *            ÀÁµá¼è¾Ã¤È¤·¤Æ¼ýÇ¼¥Ç¡¼¥¿¤ò¹¹¿·
                   MOVE    ZERO            TO  SYU-SKYMONEY
                   MOVE    "3"             TO  SYU-DENPJTIKBN
      *
                   PERFORM 800-MCNDATE-SEC
                   MOVE    SMCNDATE-YMD    TO  SYU-UPYMD
                   MOVE    SMCNDATE-HMS    TO  SYU-UPHMS
      *
                   MOVE    SYUNOU-REC      TO  MCPDATA-REC
                   MOVE    "SYUNOU-KEY"    TO  WRK-DBPATH
                   PERFORM 900-TBL-UPDATE-SEC
                   IF    ( FLG-DBRC    NOT =   ZERO )
                       MOVE    "4007"      TO  SPA-ERRCD
                       GO  TO  4801-SYUNOU-UPD-EXT
                   END-IF
               END-IF
      *
               MOVE    "SYUNOU-KEY5"   TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
               IF    ( FLG-DBRC    NOT =   ZERO )
                   MOVE    1           TO  FLG-SYUNOU
               END-IF
      *
           END-PERFORM
      *
           MOVE    "SYUNOU-KEY5"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
      *
       4801-SYUNOU-UPD-EXT.
           EXIT.
      *****************************************************************
      *    Á°²óÄê´üÀÁµá½ªÎ»Æü¼èÆÀ½èÍý
      *****************************************************************
       4801-MAE-TEIKI-SKYEDYMD-GET-SEC SECTION.
      *
           MOVE    SPACE               TO  WRK-MAE-SKYEDYMD
      *
           INITIALIZE                      PTTEIKIRRK-REC
           MOVE    SPA-HOSPID          TO  PTTEIKIRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTTEIKIRRK-PTID
           MOVE    SPA-NAI-I01-PTRRKNUM
                                       TO  PTTEIKIRRK-RRKNUM
           MOVE    PTTEIKIRRK-REC      TO  MCPDATA-REC
           MOVE    "PTTEIKIRRK-KEY7"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC            =   ZERO )
               MOVE    MCPDATA-REC     TO  PTTEIKIRRK-REC
               MOVE    PTTEIKIRRK-SKYEDYMD
                                       TO  WRK-MAE-SKYEDYMD
           END-IF
      *
           MOVE    "PTTEIKIRRK-KEY7"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
      *
       4801-MAE-TEIKI-SKYEDYMD-GET-EXT.
           EXIT.
      *****************************************************************
      *    ¼ýÇ¼ÌÀºÙºîÀ®½èÍý
      *****************************************************************
       4801-SYUMEI-SAKUSEI-SEC         SECTION.
      *
           COMPUTE WRK-SKYMONEY    =   SYU-SKYMONEY        *   -1
      *
      *    ÅÁÉ¼ÈÖ¹æ»ÞÈÖ¤òµá¤á¤ë
           MOVE    ZERO                TO  FLG-SYUMEI
           INITIALIZE                      SYUMEI-REC
           MOVE    SYU-HOSPID          TO  SMEI-HOSPID
           MOVE    SYU-NYUGAIKBN       TO  SMEI-NYUGAIKBN
           MOVE    SYU-PTID            TO  SMEI-PTID
           MOVE    SYU-DENPNUM         TO  SMEI-DENPNUM
           MOVE    SYUMEI-REC          TO  MCPDATA-REC
           MOVE    "SYUMEI-KEY2"       TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    NOT =   ZERO )
               MOVE    1               TO  FLG-SYUMEI
           END-IF
      *
      *
           PERFORM VARYING  IDX13  FROM    1   BY   1
               UNTIL ( FLG-SYUMEI  =   1)
      *
               MOVE    "SYUMEI-KEY2"   TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
               IF    ( FLG-DBRC    NOT =   ZERO )
                   MOVE    1               TO  FLG-SYUMEI
               END-IF
      *
           END-PERFORM
      *
           MOVE    "SYUMEI-KEY2"       TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           MOVE    SPACE               TO  SYUMEI-REC
           INITIALIZE                      SYUMEI-REC
           MOVE    SYU-HOSPID          TO  SMEI-HOSPID
           MOVE    SYU-NYUGAIKBN       TO  SMEI-NYUGAIKBN
           MOVE    SYU-PTID            TO  SMEI-PTID
      *ÅÁÉ¼ÈÖ¹æ
           MOVE    SYU-DENPNUM         TO  SMEI-DENPNUM
      *ÅÁÉ¼ÈÖ¹æ»ÞÈÖ
           MOVE    IDX13               TO  SMEI-DENPEDANUM
      *Æþ¶âÏ¢ÈÖ
           MOVE    ZERO                TO  SMEI-NYUKINRENNUM
      *¿ÇÎÅ²Ê
           MOVE    SYU-SRYKA           TO  SMEI-SRYKA
      *ÅÁÉ¼¾õÂÖ¶èÊ¬
           MOVE    SPACE               TO  SMEI-MEISAIJOUTAIKBN
      *ÀÁµáÈ¯¹ÔÆü¡ÊÈ¯¹ÔÆü¤ÎÀ¾Îñ¡Ë
           MOVE    SPACE               TO  SMEI-SKYPRINTYMD
      *ÀÁµáºÆÈ¯¹ÔÆü
           MOVE    SPACE               TO  SMEI-SKYREPRINTYMD
      *ÎÎ¼ý½ñÈ¯¹ÔÆü
           MOVE    SPACE               TO  SMEI-RYOSYUPRINTYMD
      *ÎÎ¼ý½ñºÆÈ¯¹ÔÆü
           MOVE    SPACE               TO  SMEI-RYOSYUREPRINTYMD
      *ÀÁµá¶â³Û
           MOVE    WRK-SKYMONEY        TO  SMEI-SKYMONEY
      *
      *ÆþÊÖ¶â¶èÊ¬
           MOVE    SPACE               TO  SMEI-NYUHEN-KBN
      *ÆþÊÖ¶â³Û
           MOVE    ZERO                TO  SMEI-NYUHEN-MONEY
      *ÆþÊÖ¶âÆü
           MOVE    SPA-SYSYMD          TO  SMEI-NYUHEN-YMD
      *Æþ¶âÊýË¡
           MOVE    "00"                TO  SMEI-NYUKIN-HOHO
      *¾õÂÖ¶èÊ¬
           MOVE    "5"                 TO  SMEI-JOUTAIKBN
      *
      *    ÄÉ²ÃÂÐ¾Ý¤Î¥Ç¡¼¥¿¤¬´û¤ËÂ¸ºß¤·¤Ê¤¤¤«¥Á¥§¥Ã¥¯
           MOVE    SYUMEI-REC          TO  MCPDATA-REC
           MOVE    "SYUMEI-KEY"        TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC            =   ZERO )
               MOVE    "4008"          TO  SPA-ERRCD
               GO  TO  4801-SYUMEI-SAKUSEI-EXT
           END-IF
      *
           MOVE    "SYUMEI-KEY"        TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           PERFORM 800-MCNDATE-SEC
           MOVE    SMCNDATE-YMD        TO  SMEI-CREYMD
                                           SMEI-UPYMD
           MOVE    SMCNDATE-HMS        TO  SMEI-CREHMS
                                           SMEI-UPHMS
      *
           MOVE    SMEI-CREYMD         TO  SDAILYKEY-CREYMD
           MOVE    SMEI-CREHMS         TO  SDAILYKEY-CREHMS
           MOVE    SMEI-NYUHEN-YMD     TO  SDAILYKEY-BASEYMD
           PERFORM 800-DAILYKEY-SEC
           MOVE    SDAILYKEY-DAILYKEY  TO  SMEI-DAILYKEY
      *
      *    ¼ýÇ¼ÌÀºÙÄÉ²Ã
           MOVE    "SYUMEI-KEY"        TO  WRK-DBPATH
      *
           MOVE    SYUMEI-REC          TO  MCPDATA-REC
           PERFORM 900-TBL-INSERT-SEC
           IF    ( FLG-DBRC        NOT =   ZERO )
               MOVE    "4009"          TO  SPA-ERRCD
               GO  TO  4801-SYUMEI-SAKUSEI-EXT
           END-IF
      *
           .
       4801-SYUMEI-SAKUSEI-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼ÔÄê´üÀÁµáÍúÎòºï½ü½èÍý
      *****************************************************************
       4801-PTTEIKIRRK-DEL-SEC         SECTION.
      *
           INITIALIZE  SUMTEIKIRRK-REC
           MOVE    ZERO                TO  FLG-PTTEIKIRRK
      *
           INITIALIZE  PTTEIKIRRK-REC
           MOVE    SPA-HOSPID          TO  PTTEIKIRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTTEIKIRRK-PTID
           MOVE    WRK-SKYSTYMD        TO  PTTEIKIRRK-SKYSTYMD
           MOVE    WRK-SKYEDYMD        TO  PTTEIKIRRK-SKYEDYMD
           MOVE    PTTEIKIRRK-REC      TO  MCPDATA-REC
           MOVE    "PTTEIKIRRK-KEY4"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        NOT =   ZERO )
               MOVE    1               TO  FLG-PTTEIKIRRK
           END-IF
      *
           PERFORM UNTIL ( FLG-PTTEIKIRRK  NOT =   ZERO )
      *
               MOVE    MCPDATA-REC     TO  PTTEIKIRRK-REC
      *
               IF    ( PTTEIKIRRK-RRKNUM   =   SPA-NAI-I01-PTRRKNUM )
      *
      *            Äê´üÍúÎò´ÉÍý¾ðÊó½¸·×
                   PERFORM 4801-TEIKIRRK-SUM-SEC
               END-IF
      *
               MOVE    "PTTEIKIRRK-KEY4"   TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
               IF    ( FLG-DBRC        NOT =   ZERO )
                   MOVE    1           TO  FLG-PTTEIKIRRK
               END-IF
      *
           END-PERFORM
      *
           MOVE    "PTTEIKIRRK-KEY4"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    ´µ¼ÔÀÁµáÍúÎòºï½ü
           INITIALIZE  PTTEIKIRRK-REC
           MOVE    SPA-HOSPID          TO  PTTEIKIRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTTEIKIRRK-PTID
           MOVE    WRK-SKYSTYMD        TO  PTTEIKIRRK-SKYSTYMD
           MOVE    WRK-SKYEDYMD        TO  PTTEIKIRRK-SKYEDYMD
           MOVE    SPA-NAI-I01-PTRRKNUM
                                       TO  PTTEIKIRRK-RRKNUM
           MOVE    PTTEIKIRRK-REC      TO  MCPDATA-REC
           MOVE    "PTTEIKIRRK-DEL3"   TO  WRK-DBPATH
           PERFORM 900-TBL-DELETE-SEC
           IF    ( FLG-DBRC        NOT =   ZERO )
               MOVE    "4010"          TO  SPA-ERRCD
               GO  TO  4801-PTTEIKIRRK-DEL-EXT
           END-IF
      *
           .
       4801-PTTEIKIRRK-DEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    Äê´üÀÁµá´ÉÍý¾ðÊó½¸·×¡Ê¥Þ¥¤¥Ê¥¹Ê¬¡Ë
      *****************************************************************
       4801-TEIKIRRK-SUM-SEC           SECTION.
      *
           INITIALIZE  SYUNOU-REC
      *
           MOVE    SPA-HOSPID          TO  SYU-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  SYU-PTID
           MOVE    "1"                 TO  SYU-NYUGAIKBN
           MOVE    PTTEIKIRRK-DENPNUM  TO  SYU-DENPNUM
           MOVE    SYUNOU-REC          TO  MCPDATA-REC
           MOVE    "SYUNOU-KEY"        TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC            =   ZERO )
               MOVE    MCPDATA-REC     TO  SYUNOU-REC
           ELSE
               INITIALIZE                  SYUNOU-REC
           END-IF
      *
           MOVE    "SYUNOU-KEY"        TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    Äê´üÀÁµá´ÉÍý¾ðÊó½¸·×¡Ê¥Þ¥¤¥Ê¥¹Ê¬¡Ë
           PERFORM VARYING IDX13   FROM    1   BY  1
                   UNTIL ( IDX13   >   100 )
               EVALUATE SUMTEIKIRRK-SRYYM (IDX13)
                                   ALSO    SUMTEIKIRRK-SAKKBN (IDX13)
               WHEN    SPACE       ALSO    ANY
                   MOVE    PTTEIKIRRK-SRYYM
                                   TO  SUMTEIKIRRK-SRYYM   (IDX13)
                   MOVE    PTTEIKIRRK-SAKKBN
                                   TO  SUMTEIKIRRK-SAKKBN  (IDX13)
                   MOVE    PTTEIKIRRK-SKYSTYMD
                                   TO  SUMTEIKIRRK-SKYSTYMD(IDX13)
                   MOVE    PTTEIKIRRK-SKYEDYMD
                                   TO  SUMTEIKIRRK-SKYEDYMD(IDX13)
                   COMPUTE SUMTEIKIRRK-SKYTEN (IDX13)
                       =   SYU-TOTAL-HKNTEN    *   -1
                   COMPUTE SUMTEIKIRRK-SKYMONEY (IDX13)
                       =   SYU-SKYMONEY        *   -1
                   COMPUTE SUMTEIKIRRK-MAX
                       =   SUMTEIKIRRK-MAX     +   1
                   MOVE    100         TO  IDX13
               WHEN    PTTEIKIRRK-SRYYM
                                   ALSO    PTTEIKIRRK-SAKKBN
                   COMPUTE SUMTEIKIRRK-SKYTEN (IDX13)
                       =   SUMTEIKIRRK-SKYTEN (IDX13)
                       + ( SYU-TOTAL-HKNTEN    *   -1 )
                   COMPUTE SUMTEIKIRRK-SKYMONEY (IDX13)
                       =   SUMTEIKIRRK-SKYMONEY (IDX13)
                       + ( SYU-SKYMONEY        *   -1 )
                   MOVE    100         TO  IDX13
               END-EVALUATE
           END-PERFORM
      *
           .
       4801-TEIKIRRK-SUM-EXT.
           EXIT. 
      *****************************************************************
      *    Äê´üÀÁµáÍúÎò¹¹¿·½èÍý
      *****************************************************************
       4801-TEIKIRRK-UPD-SEC           SECTION.
      *
           PERFORM VARYING IDX13    FROM    1   BY  1
                   UNTIL ( IDX13    >   SUMTEIKIRRK-MAX )
      *
               INITIALIZE  TEIKIRRK-REC
      *
               MOVE    SUMTEIKIRRK-OCC (IDX13)
                                       TO  TEIKIRRK-REC
               MOVE    SPA-TERMID      TO  TEIKIRRK-TERMID
      *
               MOVE    TEIKIRRK-REC    TO  MCPDATA-REC
               MOVE    "TEIKIRRK-KEY"  TO  WRK-DBPATH
               PERFORM 900-TBL-SELECT-SEC
      *        ¹¹¿·ÂÐ¾Ý¤Î¥Ç¡¼¥¿¤¬¤¹¤Ç¤ËÂ¸ºß¤¹¤ë¾ì¹ç¤Ï¹¹¿·
      *        Â¸ºß¤·¤Ê¤¤¾ì¹ç¤ÏÄÉ²Ã
               IF    ( FLG-DBRC        =   ZERO )
                   MOVE    MCPDATA-REC TO  TEIKIRRK-REC
      *
                   COMPUTE TEIKIRRK-SKYTEN
                       =   TEIKIRRK-SKYTEN
                       +   SUMTEIKIRRK-SKYTEN   (IDX13)
      *
                   COMPUTE TEIKIRRK-SKYMONEY
                       =   TEIKIRRK-SKYMONEY
                       +   SUMTEIKIRRK-SKYMONEY (IDX13)
      *
                   PERFORM 800-MCNDATE-SEC
                   MOVE    SMCNDATE-YMD    TO  TEIKIRRK-UPYMD
                   MOVE    SMCNDATE-HMS    TO  TEIKIRRK-UPHMS
      *
      *            Äê´üÀÁµá´ÉÍý¥Ç¡¼¥¿¹¹¿·
                   MOVE    TEIKIRRK-REC    TO  MCPDATA-REC
                   MOVE    "TEIKIRRK-KEY"  TO  WRK-DBPATH
                   PERFORM 900-TBL-UPDATE-SEC
                   IF  (   FLG-DBRC    NOT =   ZERO )
                       MOVE    "4011"      TO  SPA-ERRCD
                       GO  TO  4801-TEIKIRRK-UPD-EXT
                   END-IF
               ELSE
      *
                   PERFORM 800-MCNDATE-SEC
                   MOVE    SMCNDATE-YMD    TO  TEIKIRRK-CREYMD
                                               TEIKIRRK-UPYMD
                   MOVE    SMCNDATE-HMS    TO  TEIKIRRK-UPHMS
      *
                   MOVE    TEIKIRRK-REC    TO  MCPDATA-REC
                   MOVE    "TEIKIRRK-KEY"  TO  WRK-DBPATH
                   PERFORM 900-TBL-INSERT-SEC
                   IF  (   FLG-DBRC    NOT =   ZERO )
                       MOVE    "4012"      TO  SPA-ERRCD
                       GO  TO  4801-TEIKIRRK-UPD-EXT
                   END-IF
               END-IF
      *
           END-PERFORM
      *
           .
       4801-TEIKIRRK-UPD-EXT.
           EXIT. 
      *****************************************************************
      *    Å¾²ÊÎòÂàÈò½èÍý
      *****************************************************************
       4801-TENKAREKI-TAIHI-SEC    SECTION.
      *
           INITIALIZE  WRK-TENKA-SRYKA-TBL
      *
      *    Æþ±¡ÍúÎò¥Þ¥¹¥¿¸¡º÷
           INITIALIZE  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    SPA-NAI-I01-PTRRKNUM
                                       TO  PTNYUINRRK-RRKNUM
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY4"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM UNTIL ( FLG-DBRC    NOT =   ZERO )
                   OR    ( WRK-TENKA-SRYKA-CNT
                                          >=  50 )
      *
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
      *
               MOVE    ZERO            TO  FLG-TENKA-SRYKA
               PERFORM VARYING IDX9    FROM    1   BY  1
                       UNTIL ( IDX9    >   50 )
                        OR   ( WRK-TENKA-SRYKA (IDX9) = SPACE )
                        OR   ( FLG-TENKA-SRYKA NOT    = ZERO  )
      *
                   IF    ( WRK-TENKA-SRYKA (IDX9)
                                       =   PTNYUINRRK-NYUINKA )
                       MOVE    1       TO  FLG-TENKA-SRYKA
                   END-IF
      *
               END-PERFORM
      *
               IF    ( FLG-TENKA-SRYKA =   ZERO )
                   COMPUTE WRK-TENKA-SRYKA-CNT
                       =   WRK-TENKA-SRYKA-CNT +   1
                   MOVE    PTNYUINRRK-NYUINKA
                                       TO  WRK-TENKA-SRYKA
                                               (WRK-TENKA-SRYKA-CNT)
               END-IF
      *
               MOVE    "PTNYUINRRK-KEY4"   TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
      *
           END-PERFORM
      *
           MOVE    "PTNYUINRRK-KEY4"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4801-TENKAREKI-TAIHI-EXT.
           EXIT.
      *****************************************************************
      *    Â¾±¡ÎòÄÌ»»Æü¿ô¸º»»¹¹¿·½èÍý
      *****************************************************************
       4801-TAINTUSANMINUS-UPD-SEC  SECTION.
      *
           MOVE    SPA-NAI-I01-TRRKNUM (1)
                               TO      WRK-RRKNUM
           MOVE    1           TO      WRK-RRKEDANUM
           PERFORM 4801-PTNYUINRRK-SEL-SEC
           IF    ( FLG-PTNYUINRRK  NOT =   ZERO )
               MOVE    "4028"  TO      SPA-ERRCD
               GO  TO  4801-TAINTUSANMINUS-UPD-EXT
           END-IF
      *
           IF    ( PTNYUINRRK-JTIKBN   NOT =   "5" )
               MOVE    "4030"  TO  SPA-ERRCD
           END-IF
      *
           COMPUTE PTNYUINRRK-TAISYONISSU
               =   PTNYUINRRK-TAISYONISSU  -   1
      *
           PERFORM 800-MCNDATE-SEC
           MOVE    SMCNDATE-YMD        TO  PTNYUINRRK-UPYMD
           MOVE    SMCNDATE-HMS        TO  PTNYUINRRK-UPHMS
      *
           MOVE    "PTNYUINRRK-KEY"
                               TO  WRK-DBPATH
           MOVE    PTNYUINRRK-REC  TO  MCPDATA-REC
           PERFORM 900-TBL-UPDATE-SEC
           IF    ( FLG-DBRC    NOT =   ZERO )
               MOVE    "4029"  TO  SPA-ERRCD
               GO  TO  4801-TAINTUSANMINUS-UPD-EXT
           END-IF
      *
           .
       4801-TAINTUSANMINUS-UPD-EXT.
           EXIT.
      *****************************************************************
      *    °ÛÆ°Á°Îò¹¹¿·½èÍý
      *****************************************************************
       4801-IDO-MAE-UPD-SEC  SECTION.
      *
      *    Æþ±¡ÍúÎò¥Þ¥¹¥¿¸¡º÷
           PERFORM 4802-PTNYUINRRK-SEL-SEC
           IF    ( FLG-PTNYUINRRK  NOT =   ZERO )
               MOVE    "4013"  TO  SPA-ERRCD
               GO  TO  4801-IDO-MAE-UPD-EXT
           END-IF
      *
           MOVE    ALL "9"     TO  PTNYUINRRK-TENSTUYMD
      *
           PERFORM 800-MCNDATE-SEC
           MOVE    SMCNDATE-YMD        TO  PTNYUINRRK-UPYMD
           MOVE    SMCNDATE-HMS        TO  PTNYUINRRK-UPHMS
      *
           MOVE    "PTNYUINRRK-KEY"
                               TO  WRK-DBPATH
           MOVE    PTNYUINRRK-REC  TO  MCPDATA-REC
           PERFORM 900-TBL-UPDATE-SEC
           IF    ( FLG-DBRC    NOT =   ZERO )
               MOVE    "4014"  TO  SPA-ERRCD
               GO  TO  4801-IDO-MAE-UPD-EXT
           END-IF
      *
           .
       4801-IDO-MAE-UPD-EXT.
           EXIT.
      *****************************************************************
      *    Å¾½Ð¸µÎò¹¹¿·½èÍý
      *****************************************************************
       4801-TENSYUTU-MOTO-UPD-SEC  SECTION.
      *
      *    Æþ±¡ÍúÎò¥Þ¥¹¥¿¸¡º÷
           PERFORM 4801-PTNYUINRRK-SEL-SEC
           IF    ( FLG-PTNYUINRRK  NOT =   ZERO )
               MOVE    "4015"  TO  SPA-ERRCD
               GO  TO  4801-TENSYUTU-MOTO-UPD-EXT
           END-IF
      *
           MOVE    SPA-NAI-I01-IDOYMD
                               TO  PTNYUINRRK-TENSTUYMD
      *
           PERFORM 800-MCNDATE-SEC
           MOVE    SMCNDATE-YMD        TO  PTNYUINRRK-UPYMD
           MOVE    SMCNDATE-HMS        TO  PTNYUINRRK-UPHMS
      *
           MOVE    "PTNYUINRRK-KEY"
                               TO  WRK-DBPATH
           MOVE    PTNYUINRRK-REC  TO  MCPDATA-REC
           PERFORM 900-TBL-UPDATE-SEC
           IF    ( FLG-DBRC    NOT =   ZERO )
               MOVE    "4016"  TO  SPA-ERRCD
               GO  TO  4801-TENSYUTU-MOTO-UPD-EXT
           END-IF
      *
      *    ¹¹¿·¥Ç¡¼¥¿ÍÑ¤ËÆþ±¡²ÊÅù¤òÂàÈò
           MOVE    PTNYUINRRK-NYUINKA
                               TO  WRK-NYUINKA-KEY
           MOVE    PTNYUINRRK-BTUNUM
                               TO  WRK-BTUNUM-KEY
           MOVE    PTNYUINRRK-BRMNUM
                               TO  WRK-BRMNUM-KEY
           MOVE    PTNYUINRRK-TOKUTEI-KBN
                               TO  WRK-TOKUTEI-KBN-KEY
           MOVE    PTNYUINRRK-HKNCOMBINUM
                               TO  WRK-HKNCOMBI-KEY
           MOVE    PTNYUINRRK-TOKUTEI-NYUIN
                               TO  WRK-TOKUTEI-NYUIN-KEY
      *
           .
       4801-TENSYUTU-MOTO-UPD-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎòÈÖ¹æºÎÈÖ½èÍý
      *****************************************************************
       4801-RRKNUM-EDIT-SEC        SECTION.
      *
           EVALUATE    SPA-GMN-I01-SYORIKBN-CD
      *    Æþ±¡
           WHEN    "01"
      *
               MOVE    ZERO                TO  FLG-PTNYUINRRK
               INITIALIZE  PTNYUINRRK-REC
               MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
               MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
               MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
               MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
               PERFORM 900-TBL-SELECT-SEC
               IF    ( FLG-DBRC    =   ZERO )
                   MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
               ELSE
                   MOVE    1               TO  FLG-PTNYUINRRK
               END-IF
      *
               MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
               PERFORM 900-TBL-CLOSE-SEC
      *
               IF    ( FLG-PTNYUINRRK  NOT =   ZERO )
                   COMPUTE     WRK-RRKNUM      =   1
                   COMPUTE     WRK-RRKEDANUM   =   1
               ELSE
                   COMPUTE     WRK-RRKNUM      =   PTNYUINRRK-RRKNUM
                                               +   1
                   COMPUTE     WRK-RRKEDANUM   =   1
               END-IF
      *
      *    Å¾²Ê¡¡Å¾Åï¡¡Å¾¼¼
           WHEN    "08"
               COMPUTE     WRK-RRKEDANUM   =   WRK-RRKEDANUM   +   1
      *    ¤½¤ÎÂ¾
           WHEN    OTHER
               CONTINUE
           END-EVALUATE
      *
           .
       4801-RRKNUM-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÍúÎò¸¡º÷½èÍý
      *****************************************************************
       4801-PTNYUINRRK-SEL-SEC     SECTION.
      *
      *    Æþ±¡ÍúÎò¸¡º÷
           MOVE    ZERO                TO  FLG-PTNYUINRRK
      *
           INITIALIZE  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    WRK-RRKNUM          TO  PTNYUINRRK-RRKNUM
           MOVE    WRK-RRKEDANUM       TO  PTNYUINRRK-RRKEDANUM
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY"    TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO  )
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
           ELSE
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF
      *
      *    Æþ±¡ÍúÎò¥¯¥í¡¼¥º
           MOVE    "PTNYUINRRK-KEY"    TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4801-PTNYUINRRK-SEL-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÍúÎò¸¡º÷½èÍý
      *****************************************************************
       4802-PTNYUINRRK-SEL-SEC     SECTION.
      *
      *    Æþ±¡ÍúÎò¸¡º÷
           MOVE    ZERO                TO  FLG-PTNYUINRRK
      *
           INITIALIZE  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    WRK-RRKNUM          TO  PTNYUINRRK-RRKNUM
           COMPUTE PTNYUINRRK-RRKEDANUM
               =   WRK-RRKEDANUM       -   1
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY"    TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO  )
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
           ELSE
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF
      *
      *    Æþ±¡ÍúÎò¥¯¥í¡¼¥º
           MOVE    "PTNYUINRRK-KEY"    TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4801-PTNYUINRRK-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ÉÂ¼¼ÈÖ¹æÊÔ½¸½èÍý
      *****************************************************************
       4800-BRMNUM-EDIT-SEC        SECTION.
      *
           MOVE    SPACE       TO  WRK-STR1
           MOVE    1           TO  WRK-IDX1
           STRING  WRK-BRMNUM
               DELIMITED   BY  SPACE
               INTO    WRK-STR1
               WITH    POINTER WRK-IDX1
           END-STRING
      *
           COMPUTE WRK-IDX1    =   WRK-IDX1    -   1
      *
           IF    ( WRK-IDX1    <   1 )
               MOVE    WRK-BRMNUM  TO  WRK-BRMNUM-EDT
               GO  TO  4800-BRMNUM-EDIT-EXT
           END-IF
      *
      *    ÉÂ¼¼ÈÖ¹æ¤¬¿ô»ú¤Î¾ì¹ç¥¼¥íµÍ¤á¤ò¹Ô¤¦
           IF    ( WRK-BRMNUM ( 1 : WRK-IDX1 )
                                   IS  NUMERIC )
               COMPUTE WRK-IDX2    =   6   -   WRK-IDX1 + 1
               MOVE    ZERO    TO  WRK-BRMNUM-EDT
               MOVE    WRK-BRMNUM ( 1 : WRK-IDX1 )
                               TO  WRK-BRMNUM-EDT (WRK-IDX2 : WRK-IDX1)
           ELSE
               MOVE    WRK-BRMNUM
                               TO  WRK-BRMNUM-EDT
           END-IF
      *
           .
       4800-BRMNUM-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡¡¡²ñ·×¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
      *****************************************************************
       4801-NYUKAIKEI-EDIT-SEC         SECTION.
      *
      *---------------Âà±¡Æü¤ÎÆ±ÆüÆþ±¡½èÍý¤³¤³¤«¤é----------------------
           MOVE   SPACE                TO  WRK-DOU-TENNYUYMD
      *    Æ±ÆüºÆÆþ±¡ÍÑ¤ËÆþ±¡Æü¡ÊÅ¾ÆþÆü¡Ë¤òÂàÈò
           MOVE   SPA-NAI-I01-NYUINYMD TO  WRK-DOU-NAI-I01-NYUINYMD
           MOVE   PTNYUINRRK-TENNYUYMD TO  WRK-DOU-PTNYUINRRK-TENNYUYMD
      *    Æþ±¡ÍúÎò¤ÎÂàÈò
           MOVE   PTNYUINRRK-REC       TO  WRK-PTNYUINRRK-REC
      *    ºÇ½ªÆþ±¡ÍúÎò¤¬¼«±¡Îò¤«¤òÈ½Äê¤¹¤ë
           MOVE    ZERO                TO  FLG-JIINRRK
           INITIALIZE  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO  )
               MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
               PERFORM  900-TBL-READ-SEC
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
               IF      PTNYUINRRK-JTIKBN   NOT =   "5"  AND "6"
                   DISPLAY "PTNYUINRRK-RRKNUM = " PTNYUINRRK-RRKNUM
                   DISPLAY "PTNYUINRRK-TAIINYMD = " PTNYUINRRK-TAIINYMD
                   IF  PTNYUINRRK-TAIINYMD  = WRK-DOU-NAI-I01-NYUINYMD                   
                       MOVE   1        TO  FLG-JIINRRK
                   END-IF
               END-IF
           END-IF
      *    Æþ±¡ÍúÎò¥¯¥í¡¼¥º
           MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *    Æþ±¡ÍúÎò¤ÎÉü¸µ
           MOVE    WRK-PTNYUINRRK-REC  TO  PTNYUINRRK-REC
      *    Á°Îò¤¬¼«±¡Îò¡ÊÆ±ÆüÂà±¡Ê¬¡Ë¤Î¾ì¹ç¡¢Æþ±¡²ñ·×ºîÀ®Æü¤ò£±Æü¤º¤é¤¹
           IF     FLG-JIINRRK    =     1
               INITIALIZE                  STS-AREA-DAY
               INITIALIZE                  LNK-DAY6-AREA
               MOVE    "61"            TO  LNK-DAY6-IRAI
               MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  LNK-DAY6-KIJUN
               MOVE    "1"             TO  LNK-DAY6-ZOGENPTN
               MOVE    1               TO  LNK-DAY6-ZOGEN
               CALL    "ORCSDAY"       USING     STS-AREA-DAY
                                                 LNK-DAY6-AREA
               MOVE    LNK-DAY6-KEISAN TO  SPA-NAI-I01-NYUINYMD
               INITIALIZE                  STS-AREA-DAY
               INITIALIZE                  LNK-DAY6-AREA
               MOVE    "61"            TO  LNK-DAY6-IRAI
               MOVE    WRK-DOU-PTNYUINRRK-TENNYUYMD
                                       TO  LNK-DAY6-KIJUN
               MOVE    "1"             TO  LNK-DAY6-ZOGENPTN
               MOVE    1               TO  LNK-DAY6-ZOGEN
               CALL    "ORCSDAY"       USING     STS-AREA-DAY
                                                 LNK-DAY6-AREA
               MOVE    LNK-DAY6-KEISAN TO  WRK-DOU-TENNYUYMD
           END-IF
      *---------------Âà±¡Æü¤ÎÆ±ÆüÆþ±¡½èÍý¤³¤³¤Þ¤Ç----------------------
      *
           INITIALIZE      ORCSSYOKIKSNAREA
      *
      *    ÄÌ»»Æü¿ô¡¢»»Äê³«»ÏÆü¤òµá¤á¤ë
           PERFORM 4801-TSUSAN-SANTEI-GET-SEC
           IF    ( SPA-ERRCD    NOT =  SPACE )
               GO  TO  4801-NYUKAIKEI-EDIT-EXT
           END-IF
      *
           DISPLAY  "==WRK-TSUSAN == " WRK-TSUSAN
           MOVE    WRK-TSUSAN      TO  SYOKIKSN-IN-TUSANNISSU
           MOVE    WRK-SANTEISTYMD
                                   TO  SYOKIKSN-IN-SANTEISTYMD
      *
           IF      SPA-GMN-I01-TOKNYUIN-CD    NOT =   SPACE
               PERFORM   4801-TOKTEI-NYUIN-SET-SEC
           ELSE
               IF  SYS-5001-BTU-KHNSRYCD      NOT =   SPACE
                   MOVE    SYS-5001-BTU-KHNSRYCD
                                       TO  SYOKIKSN-IN-KHNSRYCD
                   PERFORM   4801-RJNCD-CHG-SEC
                   CALL    "ORCSSYOKIKSN"  USING   ORCSSYOKIKSNAREA
                   IF    ( SYOKIKSN-OT-RC  NOT =   ZERO )
                       MOVE    "4017"      TO  SPA-ERRCD
                       GO  TO  4801-NYUKAIKEI-EDIT-EXT
                   END-IF
               ELSE
                   MOVE    "4018"      TO  SPA-ERRCD
                   GO  TO  4801-NYUKAIKEI-EDIT-EXT
               END-IF
           END-IF
      *
      *    Æþ±¡²ñ·×ºîÀ®¥µ¥Ö¤Î¸Æ½Ð¤·
           INITIALIZE            ORCSNYUACCT-AREA
           MOVE     "1"     TO   LNK-SCNYUACCT-SYORI-KBN
           MOVE     "1"                TO  SPA-NYUGAIKBN
           MOVE     PTNYUINRRK-PTID    TO  SPA-PTID
           MOVE     PTNYUINRRK-NYUINKA TO  SPA-SRYKA
           MOVE    SYOKIKSN-IN-KHNSRYCD
                            TO   LNK-SCNYUACCT-NYUKHN-SRYCD(1)
           MOVE    SYOKIKSN-IN-SANTEISTYMD
                            TO   LNK-SCNYUACCT-STSRYYMD
           PERFORM   VARYING   IDX6   FROM   1   BY   1
               UNTIL (SYOKIKSN-OT-KGNSRYCD(IDX6)  =  SPACE) OR
                     (IDX6   >     7)
               MOVE   SYOKIKSN-OT-KGNSRYCD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-SRYCD(IDX6)
               MOVE   SYOKIKSN-OT-YUKOSTYMD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(IDX6)
               MOVE   SYOKIKSN-OT-YUKOEDYMD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-EDYUKYMD(IDX6)
           END-PERFORM
      *
      *    ÄÌ»»»»ÄêºÑÆü¿ô
           MOVE   WRK-TSUSAN    TO  LNK-SCNYUACCT-NYUKHN-NISUU
      *
      *    ÆÃÄêÆþ±¡¤ÇÆþ±¡ÎÁ¤¬ÊÑ¹¹¤Ë¤Ê¤ë¥³¡¼¥É¤ÎÂÐ±þ
      *    ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190774110"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   "190774110"  TO  LNK-SCNYUACCT-KAGEN-SRYCD(1)
                 MOVE   SPA-NAI-I01-NYUINYMD
                                  TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE    13                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
      *
                 MOVE   "190774210"  TO  LNK-SCNYUACCT-KAGEN-SRYCD(2)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE     1                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-STYUKYMD(2)
                 MOVE    "99999999"
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(2)
           END-IF
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190739910"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   ZERO            TO  TN-IDX
                 IF     STUSAN-NISSU02      <=  90
                     ADD    1           TO  TN-IDX
                     MOVE   "190739910" TO   LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
      *              Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ¤Î£¹£°Æü°ÊÆâ¤Î½ªÆü¤òºÆ·×»»
                     MOVE     ZERO      TO   WK-TOKUTEI-DAY
                     COMPUTE  WK-TOKUTEI-DAY  =  90  - STUSAN-NISSU02
                     MOVE   SPA-NAI-I01-NYUINYMD
                                       TO  LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-NYUINYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WK-TOKUTEI-DAY    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
                 END-IF
      *
                 ADD    1   TO    TN-IDX
      *
                 MOVE   "190740010"  TO  LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 IF      TN-IDX      =     2
                     MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE     1                TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 ELSE
                     MOVE    SPA-NAI-I01-NYUINYMD
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 END-IF
                 MOVE    "99999999"    TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
           END-IF
      *
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ£²
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190813410"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   ZERO            TO  TN-IDX
                 IF     STUSAN-NISSU02      <=  90
                     ADD    1           TO  TN-IDX
                     MOVE   "190813410" TO   LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
      *              Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ¤Î£¹£°Æü°ÊÆâ¤Î½ªÆü¤òºÆ·×»»
                     MOVE     ZERO      TO   WK-TOKUTEI-DAY
                     COMPUTE  WK-TOKUTEI-DAY  =  90  - STUSAN-NISSU02
                     MOVE   SPA-NAI-I01-NYUINYMD
                                       TO  LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-NYUINYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WK-TOKUTEI-DAY    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
                 END-IF
      *
                 ADD    1   TO    TN-IDX
      *
                 MOVE   "190813510"  TO  LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 IF      TN-IDX      =     2
                     MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE     1                TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 ELSE
                     MOVE    SPA-NAI-I01-NYUINYMD
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 END-IF
                 MOVE    "99999999"    TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
           END-IF
      *
      *    ÆÃÄêÆþ±¡ÎÁ¤Ç£·Æü¤Þ¤Ç¡¢£±£´Æü¤Þ¤Ç¡¢¤½¤ì°Ê¹ß¤Ï°ìÈÌÆþ±¡ÎÁ¤ò»»Äê¤¹¤ë
      *    ¾ì¹ç¤Î¿ÇÎÅ¥³¡¼¥É¤ò¼èÆÀ
           PERFORM    4801-TOKUTEI-NYUIN-7-14-SEC
      *
           IF    SYOKIKSN-IN-KHNSRYCD   =   WRK-TOKUTEI-SRYCD1
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   WRK-TOKUTEI-SRYCD1  
                                  TO  LNK-SCNYUACCT-KAGEN-SRYCD(1)
                 MOVE   SPA-NAI-I01-NYUINYMD
                                  TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE     6                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
      *
                 MOVE   WRK-TOKUTEI-SRYCD2
                                  TO  LNK-SCNYUACCT-KAGEN-SRYCD(2)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE     1                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-STYUKYMD(2)
                 MOVE    "99999999"
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(2)
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE     14               TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 MOVE    "1"      TO      IPN-NYUKAIKEI-SAKUSEI-FLG
           END-IF
      *
      *    ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¡Ê£¶£°Æü¾å¸Â¡Ë
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190024810"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   "190024810"  TO  LNK-SCNYUACCT-KAGEN-SRYCD(1)
                 MOVE   SPA-NAI-I01-NYUINYMD
                                  TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE    59                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE     60               TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          ÆÃÄêÆþ±¡´ü´Ö¡Ê£¶£°Æü·Ð²á¡Ë¤·¤¿ºÝ¤Î°ìÈÌÆþ±¡ÎÁºîÀ®¤Î
      *          ²ÄÈÝ¤òÈ½Äê
                 MOVE    SPA-NAI-I01-NYUINYMD
                                  TO      WRK-IPN-HANTEI-YMD1
                 IF      WRK-IPN-HANTEI-M1   =   12
                     ADD    1     TO      WRK-IPN-HANTEI-Y1
                     MOVE   1     TO      WRK-IPN-HANTEI-M1
                 ELSE
                     ADD    1     TO      WRK-IPN-HANTEI-M1
                 END-IF
      *          ·îËöÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY7-AREA
                 MOVE    "71"              TO  LNK-DAY7-IRAI
                 MOVE   WRK-IPN-HANTEI-YM1 TO  LNK-DAY7-YM
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE    LNK-DAY7-KOYOMI   TO      WRK-IPN-HANTEI-YMD1
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                  TO      WRK-IPN-HANTEI-YMD2
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 IF      WRK-IPN-HANTEI-YMD1 > WRK-IPN-HANTEI-YMD2
                     MOVE    "1"   TO     IPN-NYUKAIKEI-SAKUSEI-FLG
                 END-IF
           END-IF
      *
      *    ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ¡Ê£²£±Æü¤ò¸ÂÅÙ¡Ë
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190117310"
                 MOVE   SPACE       TO   IPN-NYUKAIKEI-SAKUSEI-FLG
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   "190117310"
                                    TO   LNK-SCNYUACCT-KAGEN-SRYCD(1)
                 MOVE   SPA-NAI-I01-NYUINYMD
                                  TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE    20                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE     21               TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 MOVE    "1"      TO      IPN-NYUKAIKEI-SAKUSEI-FLG
           END-IF
      *
      *-------ÆÃÄêÆþ±¡ÂÐ±þ¤³¤³¤Þ¤Ç-----------------------------------
      *
      *    Æþ±¡ÎÁ²Ã»»¿ÇÎÅ¥³¡¼¥É¼è¤ê¹þ¤ß
           PERFORM    4801-NYUKSN-GET-SEC
      *
      *    ÆÃÄêÆþ±¡ÎÁ¶èÊ¬¤Î¥»¥Ã¥È
           IF      SPA-GMN-I01-TOKNYUIN-CD    =   SPACE
               MOVE     "0"     TO  LNK-SCNYUACCT-TOKUTEINYUIN-KBN
           ELSE
               MOVE     "1"     TO  LNK-SCNYUACCT-TOKUTEINYUIN-KBN
           END-IF
      *    ³°Çñ
           MOVE   "099999911"   TO  LNK-SCNYUACCT-GAIHAKU-SRYCD
      *    ¼¼ÎÁº¹³Û
           MOVE   "099999912"   TO  LNK-SCNYUACCT-SAGAKU-SRYCD
           IF     PTNYUINRRK-RM-SAGAKU   =   SPACE
               MOVE    ZERO     TO  LNK-SCNYUACCT-SAGAKU-KBN
           ELSE
               MOVE   PTNYUINRRK-RM-SAGAKU 
                                TO  WRK-SAGAKU-KBN
               MOVE   WRK-SAGAKU-KBN9
                                TO  LNK-SCNYUACCT-SAGAKU-KBN
           END-IF
      *    ¿©»ö¶èÊ¬
           MOVE   "099999913"   TO  LNK-SCNYUACCT-SHOKUJI-SRYCD
           MOVE   1             TO  LNK-SCNYUACCT-SHOKUJIKBN
      *    ¿©Æ²²Ã»»
           PERFORM     4801-BTUSEL-SEC
           IF   FLG-SYSKANRI           =    ZERO
               IF   SYS-5001-BTU-SYOKUDOKBN       =    "2"
                    MOVE     "197000570"    TO
                                LNK-SCNYUACCT-SHOKUDO-SRYCD
                    MOVE    1   TO   LNK-SCNYUACCT-SHOKUDO-KBN
               END-IF
           END-IF
      *    ÊÝ¸±ÁÈ¹ç¤»
           MOVE   "099999914"   TO  LNK-SCNYUACCT-HKNCOMBINUM-SRYCD
           MOVE   PTNYUINRRK-HKNCOMBINUM
                                TO  WRK-HKNCOMBINUM
           MOVE   WRK-HKNCOMBINUM9 
                                TO  LNK-SCNYUACCT-HKNCOMBINUM
           MOVE   SPA-SRYKA     TO  WRK-TAIHI-SRYKA
           MOVE   "00"          TO  SPA-SRYKA
           PERFORM 4801-SENTEI-SET-SEC
           CALL   "ORCSNYUACCT"  USING   SPA-AREA
                                         ORCSNYUACCT-AREA
           MOVE   WRK-TAIHI-SRYKA TO     SPA-SRYKA
           IF     LNK-SCNYUACCT-RC   NOT =  ZERO
               DISPLAY  "ORCGI01 ORCSNYUACCT ERR RC = "
                         LNK-SCNYUACCT-RC
           END-IF
      *
           IF     IPN-NYUKAIKEI-SAKUSEI-FLG    =   "1"
               MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
               MOVE    IPN-SANTEISTYMD   TO   WRK-SANTEISTYMD
               MOVE    IPN-SANTEISTYMD   TO   SPA-NAI-I01-IDOYMD
               MOVE    IPN-SANTEISTYMD   TO   PTNYUINRRK-TENNYUYMD
               PERFORM   4801-TENROOM-EDIT-SEC
           END-IF
      *
           .
       4801-NYUKAIKEI-EDIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄêÆþ±¡ÎÁ¡Ê£·Æü¡¿£±£´Æü¡¿¤½¤ì°Ê¹ß¡Ë¤Î¿ÇÎÅ¥³¡¼¥É¥»¥Ã¥È
      *****************************************************************
       4801-TOKUTEI-NYUIN-7-14-SEC         SECTION.
      *
      *ÆÃÄêÆþ±¡ÎÁ¤Ç£·Æü¤Þ¤Ç¡¢£±£´Æü¤Þ¤Ç¡¢¤½¤ì°Ê¹ß¤Ï°ìÈÌÆþ±¡ÎÁ¤ò»»Äê¤¹¤ë
      *¾ì¹ç¤Î¿ÇÎÅ¥³¡¼¥É¤ò¼èÆÀ
      *
           MOVE      SPACE        TO    IPN-NYUKAIKEI-SAKUSEI-FLG
           MOVE      "999999999"  TO    WRK-TOKUTEI-SRYCD1
                                        WRK-TOKUTEI-SRYCD2
           EVALUATE   SYOKIKSN-IN-KHNSRYCD
      *    ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ
               WHEN   "190024610"
                   MOVE    "190024610"  TO  WRK-TOKUTEI-SRYCD1
                   MOVE    "190074610"  TO  WRK-TOKUTEI-SRYCD2
      *    ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¡Ê½Å¾É¼ÔÅùÈæÎ¨´ð½àÌ¤Ëþ¡Ë
               WHEN   "190116310"
                   MOVE    "190116310"  TO  WRK-TOKUTEI-SRYCD1
                   MOVE    "190116410"  TO  WRK-TOKUTEI-SRYCD2
      *    µßÌ¿µßµÞÆþ±¡ÎÁ£±
               WHEN   "190024510"
                   MOVE    "190024510"  TO  WRK-TOKUTEI-SRYCD1
                   MOVE    "190074510"  TO  WRK-TOKUTEI-SRYCD2
      *    µßÌ¿µßµÞÆþ±¡ÎÁ£±¡Ê¹âÅÙ¡Ë
               WHEN   "190110210"
                   MOVE    "190110210"  TO  WRK-TOKUTEI-SRYCD1
                   MOVE    "190110610"  TO  WRK-TOKUTEI-SRYCD2
      *    µßÌ¿µßµÞÆþ±¡ÎÁ£±¡Ê£Á¤Þ¤¿¤Ï¿·Àß¡Ë
               WHEN   "190110310"
                   MOVE    "190110310"  TO  WRK-TOKUTEI-SRYCD1
                   MOVE    "190110710"  TO  WRK-TOKUTEI-SRYCD2
      *    µßÌ¿µßµÞÆþ±¡ÎÁ£²
               WHEN   "190024310"
                   MOVE    "190024310"  TO  WRK-TOKUTEI-SRYCD1
                   MOVE    "190024410"  TO  WRK-TOKUTEI-SRYCD2
      *    µßÌ¿µßµÞÆþ±¡ÎÁ£²¡Ê¹âÅÙ¡Ë
               WHEN   "190110410"
                   MOVE    "190110410"  TO  WRK-TOKUTEI-SRYCD1
                   MOVE    "190110810"  TO  WRK-TOKUTEI-SRYCD2
      *    µßÌ¿µßµÞÆþ±¡ÎÁ£²¡Ê£Á¤Þ¤¿¤Ï¿·Àß¡Ë
               WHEN   "190110510"
                   MOVE    "190110510"  TO  WRK-TOKUTEI-SRYCD1
                   MOVE    "190110910"  TO  WRK-TOKUTEI-SRYCD2
      *    °ìÎà´¶À÷¾É´µ¼ÔÆþ±¡°åÎÅ´ÉÍýÎÁ
               WHEN   "190075510"
                   MOVE    "190075510"  TO  WRK-TOKUTEI-SRYCD1
                   MOVE    "190075610"  TO  WRK-TOKUTEI-SRYCD2
           END-EVALUATE
           .
      *
       4801-TOKUTEI-NYUIN-7-14-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡ÎÁ²Ã»»¤Î¼è¤ê¹þ¤ß½èÍý
      *****************************************************************
       4801-NYUKSN-GET-SEC         SECTION.
      *
           MOVE   ZERO             TO   IDX8
      *
      *°åÎÅµ¡´Ø²Ã»»¡Ê¸º»»¡Ë¾ðÊó
           INITIALIZE              SYSKANRI-REC
           MOVE    "5000"          TO  SYS-KANRICD
           EVALUATE   SPA-GMN-I01-SYORIKBN-CD
               WHEN   "01"
                   MOVE   SPA-NAI-I01-NYUINYMD
                                   TO  ORC-DBYMD
               WHEN   "08"
                   MOVE   SPA-NAI-I01-IDOYMD
                                   TO  ORC-DBYMD
               WHEN   "09"
                   MOVE   SPA-NAI-I01-MAEIDOYMD
                                   TO  ORC-DBYMD
               WHEN   OTHER
                   MOVE    SPA-SYSYMD
                                   TO  ORC-DBYMD
           END-EVALUATE
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¤Î°åÎÅµ¡´Ø¾ðÊó¤è¤ê¼èÆÀ
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           IF   FLG-DBRC           =    ZERO
               MOVE    MCPDATA-REC TO   SYS-5000-REC
      *        Æþ±¡ÎÁ²Ã»»
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL  (SYS-5000-KSNCD(IDX7)    =   SPACE)  OR
                        (IDX7                    >   20)
                    IF   SYS-5000-KSNKBN(IDX7)   =   "2"
                             ADD    1                TO  IDX8
                             MOVE   SYS-5000-KSNCD(IDX7)  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                    END-IF
               END-PERFORM
      *        ÃÏ°è²Ã»»
               IF   SYS-5000-CHIIKIKSN    NOT =   SPACE
                    ADD    1        TO   IDX8
                    MOVE   SYS-5000-CHIIKIKSN   TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
           END-IF
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "SYSKANRI-KEY2" TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *ÉÂÅï²Ã»»¾ðÊó
           PERFORM     4801-BTUSEL-SEC
      *
           IF   FLG-SYSKANRI           =    ZERO
      *
      *        ´Ç¸îÊä½õ²Ã»»
               IF    SYS-5001-BTU-KNGHJOKSN   NOT =   SPACE
                   ADD      1          TO     IDX8
                   EVALUATE     SYS-5001-BTU-KNGHJOKSN
                       WHEN     "01"
                           MOVE  "190103070"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "02"
                           MOVE  "190103470"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "03"
                           MOVE  "190103770"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "04"
                           MOVE  "190103970"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "05"
                           MOVE  "190104070"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                   END-EVALUATE
               END-IF
      *
      *        Ìë´Ö¶ÐÌ³Åù´Ç¸î²Ã»»
               IF    SYS-5001-BTU-YAKANKNGKSN   NOT =   SPACE
                   ADD      1          TO     IDX8
                   EVALUATE     SYS-5001-BTU-YAKANKNGKSN
                       WHEN     "01"
                           MOVE  "190109870"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "02"
                           MOVE  "190076070"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "03"
                           MOVE  "190076170"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "04"
                           MOVE  "190076370"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "05"
                           MOVE  "190076470"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                   END-EVALUATE
               END-IF
      *
      *        ¾®»ùÆþ±¡°åÎÅ´ÉÍýÎÁ²Ã»»¡ÊÊÝ°é»Î£±¿Í°Ê¾å¡Ë
               IF    SYS-5001-BTU-HIKSISUKBN   =   "2"
                   ADD      1          TO     IDX8
                   MOVE  "190111370"   TO  WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *
      *        ÉÂÅïÆþ±¡ÎÁ²Ã»»
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL  (IDX7                    >   12)
                    IF   IDX7          =       6
      *                 »ùÆ¸»×½Õ´üÀº¿À²ÊÆþ±¡°åÎÅ´ÉÍý²Ã»»¡Ê£²£°ºÍÌ¤Ëþ¡Ë
                        IF   SYS-5001-KSNKBN(IDX7)   =   "2"
                             PERFORM   4801-PT-AGE-SEC
                             IF     WRK-NENREI    <      20
                                 ADD    1                TO  IDX8
                                 MOVE   SYS-5001-KSNCD(IDX7)  TO
                                           WRK-NYUKHNKSN-SRYCD(IDX8)
                             END-IF
                        END-IF
                    ELSE
                        IF   IDX7  =  3  OR  4  OR  5
                             CONTINUE
                        ELSE
                            IF   SYS-5001-KSNKBN(IDX7)   =   "2"
                                 ADD    1                TO  IDX8
                                 MOVE   SYS-5001-KSNCD(IDX7)  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                            END-IF
                        END-IF
                    END-IF
               END-PERFORM
           END-IF
      *
      *ÉÂ¼¼¾ðÊó
           PERFORM     4801-BRMSEL-SEC
      *
           IF   FLG-SYSKANRI       =    ZERO
      *        ¿·À¸»ùÆþ±¡°åÎÅ´ÉÍý²Ã»»
               IF   SYS-5002-SINSEIJI-KBN     =   "2"
                    ADD     1       TO     IDX8
                    MOVE   SYS-5002-SINSEIJI-CD  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        ¿ÇÎÅ½êÎÅÍÜÉÂ¾²ÎÅÍÜ´Ä¶­²Ã»»¡Ê£±¡Ë
               IF   SYS-5002-SNR-RYOYO-KBN(1)     =   "2"
                    ADD     1       TO     IDX8
                    MOVE   SYS-5002-SNR-RYOYO-CD(1)  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        ¿ÇÎÅ½êÎÅÍÜÉÂ¾²ÎÅÍÜ´Ä¶­²Ã»»¡Ê£²¡Ë
               IF   SYS-5002-SNR-RYOYO-KBN(2)     =   "2"
                    ADD     1       TO     IDX8
                    MOVE   SYS-5002-SNR-RYOYO-CD(2)  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        Êü¼ÍÀþ¼£ÎÅÉÂ¼¼´ÉÍý²Ã»»
               IF   SYS-5002-HOSYASEN-KBN     =   "2"
                    ADD     1       TO     IDX8
                    MOVE   SYS-5002-HOSYASEN-CD  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        ÎÅÍÜ´Ä¶­²Ã»»
               IF   SYS-5002-RYOYO-KBN     =   "2"
                    ADD     1       TO     IDX8
                    MOVE   SYS-5002-RYOYO-CD  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        ÎÅÍÜÉÂÅïÎÅÍÜ´Ä¶­²Ã»»£±
               IF   SYS-5002-BTU-RYOYO-KBN(1)     =   "2"
                    ADD     1       TO     IDX8
                    MOVE   "190106070"  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        ÎÅÍÜÉÂÅïÎÅÍÜ´Ä¶­²Ã»»£²
               IF   SYS-5002-BTU-RYOYO-KBN(2)     =   "2"
                    ADD     1       TO     IDX8
                    MOVE   "190106170"  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        ÎÅÍÜÉÂÅïÎÅÍÜ´Ä¶­²Ã»»£³
               IF   SYS-5002-BTU-RYOYO-KBN(3)     =   "2"
                    ADD     1       TO     IDX8
                    MOVE   "190106270"  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        ½Å¾É¼ÔÅùÎÅÍÜ´Ä¶­ÆÃÊÌ²Ã»»¡Ê¸Ä¼¼¡Ë
               IF   SYS-5002-JYUTOK1-KBN          =   "2"
                    ADD     1       TO     IDX8
                    MOVE   SYS-5002-JYUTOK1-CD  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        ½Å¾É¼ÔÅùÎÅÍÜ´Ä¶­ÆÃÊÌ²Ã»»¡Ê£²¿ÍÉô²°¡Ë
               IF   SYS-5002-JYUTOK2-KBN          =   "2"
                    ADD     1       TO     IDX8
                    MOVE   SYS-5002-JYUTOK2-CD  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
      *        Ìµ¶Ý¼£ÎÅ¼¼´ÉÍý²Ã»»
               IF   SYS-5002-MUKIN-KBN            =   "2"
                    ADD     1       TO     IDX8
                    MOVE   SYS-5002-MUKIN-CD  TO
                                   WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
           END-IF
      *
      *    Æþ±¡ÎÁ¤ÈÆþ±¡ÎÁ²Ã»»¤ÎÊ»»»Äê¥Á¥§¥Ã¥¯
           MOVE    ZERO            TO     IDX9
           PERFORM    VARYING    IDX8   FROM   1   BY   1
                      UNTIL      (WRK-NYUKHNKSN-SRYCD(IDX8)  =  SPACE)
                         OR      (IDX8   >     20)
                         PERFORM   4801-NYUKSN-CHK-SEC
                         IF     FLG-NYUKSN       =   ZERO   
                             ADD    1                TO  IDX9
                             MOVE   WRK-NYUKHNKSN-SRYCD(IDX8)  TO
                                   LNK-SCNYUACCT-NYUKHNKSN-SRYCD(IDX9)
                         END-IF
           END-PERFORM
      *
           .
      *
       4801-NYUKSN-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡ÎÁ²Ã»»¤Î»»Äê²Ä¡¦ÉÔ²Ä¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-NYUKSN-CHK-SEC         SECTION.
      *
           MOVE    ZERO            TO  FLG-NYUKSN
      *
      **     EVALUATE   WRK-NYUKHNKSN-SRYCD(IDX8)
      *        ¿ÇÎÅÏ¿´ÉÍýÂÎÀ©²Ã»»
      **         WHEN   "190100370"
      **             IF   SPA-GMN-I01-SYORIKBN-CD   =  "07" OR "08"
      **                  MOVE   1        TO     FLG-NYUKSN
      **             END-IF
      *            ¼«±¡¤Ç¤Î·ÑÂ³Æþ±¡¥Á¥§¥Ã¥¯
      **     END-EVALUATE
      *
      *    Æþ±¡ÎÁ²Ã»»¥Á¥§¥Ã¥¯¥Æ¡¼¥Ö¥ë¤Ë¤è¤ëÈ½Äê
           INITIALIZE  NYUKSNCHK-REC
      *
           PERFORM   48011-TENSU-SEL-SEC
           MOVE    WRK-BTU-NYUKSNKBN
                                   TO  NYUKSNCHK-NYUINKBN
           PERFORM   48012-TENSU-SEL-SEC
           MOVE    WRK-KSN-NYUKSNKBN
                                   TO  NYUKSNCHK-KSNKBN
           MOVE    SYOKIKSN-IN-SANTEISTYMD    TO  ORC-DBYMD
      *
           MOVE    "NYUKSNCHK-KEY" TO  WRK-DBPATH
           MOVE    NYUKSNCHK-REC   TO  MCPDATA-REC
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
               MOVE    MCPDATA-REC TO  NYUKSNCHK-REC
           ELSE
               MOVE   1        TO     FLG-NYUKSN
               GO  TO          4801-NYUKSN-CHK-EXT
           END-IF
      *
           IF    ( NYUKSNCHK-CHKKBN    =   "1" OR "2" )
               CONTINUE
           ELSE
               MOVE   1        TO     FLG-NYUKSN
               GO  TO  4801-NYUKSN-CHK-EXT
           END-IF
      *
           .
      *
       4801-NYUKSN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¸¡º÷½èÍý¡ÊÆþ±¡ÎÁ¡Ë
      *****************************************************************
       48011-TENSU-SEL-SEC              SECTION.
      *
           MOVE    SPACE           TO  WRK-NYUKSNKBN
           MOVE    SPACE           TO  WRK-TOKUBETSU-NYUIN
      *
           MOVE    ZERO            TO  FLG-TENSU
           INITIALIZE              TNS-TENSU-REC
      *
           IF      LNK-SCNYUACCT-NYUKHN-SRYCD(1) NOT = SPACE
               MOVE   LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                                   TO  TNS-SRYCD
           ELSE
               MOVE   LNK-SCNYUACCT-KAGEN-SRYCD(1)
                                   TO  TNS-SRYCD
           END-IF
           MOVE    SYOKIKSN-IN-SANTEISTYMD    TO  ORC-DBYMD
           MOVE    TNS-TENSU-REC   TO  MCPDATA-REC
      *
           MOVE    "TENSU-KEY"     TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
               MOVE    MCPDATA-REC TO  TNS-TENSU-REC
           ELSE
               MOVE    1           TO  FLG-TENSU
           END-IF
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "TENSU-KEY"     TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( FLG-TENSU       NOT =   ZERO )
               GO  TO  48011-TENSU-SEL-EXT
           END-IF
      *
           MOVE    TNS-NYUKHNKSNKBN
                                   TO  WRK-BTU-NYUKSNKBN
      *
      *    ÆÃÊÌÆþ±¡ÎÁ¤ÎÈ½Äê
           EVALUATE   TNS-NYUKHNKBN
               WHEN   73
               WHEN   74
               WHEN   75
               WHEN   76
               WHEN   77
               WHEN   78
               WHEN   79
                   MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
           END-EVALUATE
           .
      *
       48011-TENSU-SEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¸¡º÷½èÍý¡ÊÆþ±¡ÎÁ²Ã»»¡Ë
      *****************************************************************
       48012-TENSU-SEL-SEC              SECTION.
      *
           MOVE    SPACE           TO  WRK-NYUKSNKBN
      *
           MOVE    ZERO            TO  FLG-TENSU
           INITIALIZE              TNS-TENSU-REC
      *
      *    ÆÃÊÌÆþ±¡ÎÁ»»Äê»þ¤ËÍÄ»ù²Ã»»¤ÈÆýÍÄ»ù²Ã»»¤Î²Ã»»¥³¡¼¥ÉÃÖ¤­´¹¤¨
           IF      WRK-TOKUBETSU-NYUIN   =   "1"
               EVALUATE   WRK-NYUKHNKSN-SRYCD(IDX8)
                   WHEN   "190100470"
                       MOVE  "190100570"  TO  WRK-NYUKHNKSN-SRYCD(IDX8)
                   WHEN   "190100770"
                       MOVE  "190100870"  TO  WRK-NYUKHNKSN-SRYCD(IDX8)
               END-EVALUATE
           END-IF
      *
           MOVE    WRK-NYUKHNKSN-SRYCD(IDX8)
                                   TO  TNS-SRYCD
           MOVE    SYOKIKSN-IN-SANTEISTYMD    TO  ORC-DBYMD
           MOVE    TNS-TENSU-REC   TO  MCPDATA-REC
      *
           MOVE    "TENSU-KEY"     TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
               MOVE    MCPDATA-REC TO  TNS-TENSU-REC
           ELSE
               MOVE    1           TO  FLG-TENSU
           END-IF
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "TENSU-KEY"     TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( FLG-TENSU       NOT =   ZERO )
               GO  TO  48012-TENSU-SEL-EXT
           END-IF
      *
           MOVE    TNS-NYUKHNKSNKBN
                                   TO  WRK-KSN-NYUKSNKBN
           .
      *
       48012-TENSU-SEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡´µ¼Ô¤ÎÇ¯Îð»»½Ð
      *****************************************************************
       4801-PT-AGE-SEC         SECTION.
      *
           INITIALIZE                      PTINF-REC
           MOVE    SPA-HOSPID          TO  PTINF-HOSPID
           MOVE    PTNYUINRRK-PTID     TO  PTINF-PTID
           MOVE    PTINF-REC           TO  MCPDATA-REC
           MOVE    "PTINF-KEY"         TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO  )
               MOVE    MCPDATA-REC     TO  PTINF-REC
           ELSE
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           IF      FLG-PTINF           =   1
               MOVE    ZERO            TO  WRK-NENREI
           ELSE
               MOVE   PTINF-BIRTHDAY   TO  WRK-YMDS1
               MOVE   SYOKIKSN-IN-SANTEISTYMD
                                       TO  WRK-YMDS2
               MOVE   ZERO             TO  WRK-NENREI
               COMPUTE  WRK-NENREI     =   WRK-YYS2
                                       -   WRK-YYS1
               IF   WRK-YMDS1(5:4)     >   WRK-YMDS2(5:4)
                    ADD   -1           TO  WRK-NENREI
               END-IF
           END-IF
      *
           .
      *
       4801-PT-AGE-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡¼è¾Ã¡¡²ñ·×¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
      *****************************************************************
       4801-NYUKAIKEI-ERASE-SEC         SECTION.
      *
           PERFORM     VARYING   IDX6   FROM   1   BY   1
                       UNTIL    (WRK-TENKA-SRYKA(IDX6)  =  SPACE)   OR
                                (IDX6       >   50)
                PERFORM  4801-NYUKAIKEI-ERASE-SUB-SEC
           END-PERFORM
      *
           .
       4801-NYUKAIKEI-ERASE-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡¼è¾Ã¡¡²ñ·×¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý£²
      *****************************************************************
       4801-NYUKAIKEI-ERASE-SUB-SEC         SECTION.
      *
           DISPLAY "4801-NYUKAIKEI-ERASE-SUB-SEC"
           DISPLAY "SPA-NAI-I01-NYUINYMD = " SPA-NAI-I01-NYUINYMD
           DISPLAY "PTNYUINRRK-PTID      = " PTNYUINRRK-PTID
           DISPLAY "PTNYUINRRK-NYUINYMD  = " PTNYUINRRK-NYUINYMD
           DISPLAY "PTNYUINRRK-TAIINYMD  = " PTNYUINRRK-TAIINYMD
           DISPLAY "PTNYUINRRK-HKNCOMBINUM  = " PTNYUINRRK-HKNCOMBINUM
      *---------------Âà±¡Æü¤ÎÆ±ÆüÆþ±¡½èÍý¤³¤³¤«¤é----------------------
           MOVE   SPACE                TO  WRK-DOU-TENNYUYMD
      *    Æ±ÆüºÆÆþ±¡ÍÑ¤ËÆþ±¡Æü¡ÊÅ¾ÆþÆü¡Ë¤òÂàÈò
           MOVE   SPA-NAI-I01-NYUINYMD TO  WRK-DOU-NAI-I01-NYUINYMD
      *    Æþ±¡ÍúÎò¤ÎÂàÈò
           MOVE   PTNYUINRRK-REC       TO  WRK-PTNYUINRRK-REC
      *    ºÇ½ªÆþ±¡ÍúÎò¤¬¼«±¡Îò¤«¤òÈ½Äê¤¹¤ë
           MOVE    ZERO                TO  FLG-JIINRRK
           INITIALIZE  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO  )
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
               IF      PTNYUINRRK-JTIKBN   NOT =   "5"  AND "6"
                   DISPLAY "PTNYUINRRK-RRKNUM = " PTNYUINRRK-RRKNUM
                   DISPLAY "PTNYUINRRK-TAIINYMD = " PTNYUINRRK-TAIINYMD
                   IF  PTNYUINRRK-TAIINYMD  = WRK-DOU-NAI-I01-NYUINYMD                   
                       MOVE   1        TO  FLG-JIINRRK
                   END-IF
               END-IF
           END-IF
      *    Æþ±¡ÍúÎò¥¯¥í¡¼¥º
           MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *    Æþ±¡ÍúÎò¤ÎÉü¸µ
           MOVE    WRK-PTNYUINRRK-REC  TO  PTNYUINRRK-REC
      *    Á°Îò¤¬¼«±¡Îò¡ÊÆ±ÆüÂà±¡Ê¬¡Ë¤Î¾ì¹ç¡¢Æþ±¡²ñ·×ºîÀ®Æü¤ò£±Æü¤º¤é¤¹
           IF     FLG-JIINRRK    =     1
               INITIALIZE                  STS-AREA-DAY
               INITIALIZE                  LNK-DAY6-AREA
               MOVE    "61"            TO  LNK-DAY6-IRAI
               MOVE    SPA-NAI-I01-NYUINYMD
                                       TO  LNK-DAY6-KIJUN
               MOVE    "1"             TO  LNK-DAY6-ZOGENPTN
               MOVE    1               TO  LNK-DAY6-ZOGEN
               CALL    "ORCSDAY"       USING     STS-AREA-DAY
                                                 LNK-DAY6-AREA
               MOVE    LNK-DAY6-KEISAN TO  SPA-NAI-I01-NYUINYMD
           END-IF
      *---------------Âà±¡Æü¤ÎÆ±ÆüÆþ±¡½èÍý¤³¤³¤Þ¤Ç----------------------
      *    Æþ±¡²ñ·×ºîÀ®¥µ¥Ö¤Î¸Æ½Ð¤·
           INITIALIZE            ORCSNYUACCT-AREA
           MOVE     SPA-GMN-I01-SYORIKBN-CD(2:1)
                                       TO   LNK-SCNYUACCT-SYORI-KBN
           MOVE     "1"                TO  SPA-NYUGAIKBN
           MOVE     PTNYUINRRK-PTID    TO  SPA-PTID
           MOVE     WRK-TENKA-SRYKA(IDX6)
                                       TO  SPA-SRYKA
           MOVE     SPA-NAI-I01-NYUINYMD
                                       TO   LNK-SCNYUACCT-STSRYYMD
      *    ÊÝ¸±ÁÈ¹ç¤»
           MOVE   PTNYUINRRK-HKNCOMBINUM
                                        TO  WRK-HKNCOMBINUM
           MOVE   WRK-HKNCOMBINUM9      TO  LNK-SCNYUACCT-HKNCOMBINUM
           MOVE   SPA-SRYKA     TO  WRK-TAIHI-SRYKA
           MOVE   "00"          TO  SPA-SRYKA
           CALL   "ORCSNYUACCT"  USING   SPA-AREA
                                         ORCSNYUACCT-AREA
           MOVE   WRK-TAIHI-SRYKA TO     SPA-SRYKA
           IF     LNK-SCNYUACCT-RC   NOT =  ZERO
                  DISPLAY  "ORCGI01 ORCSNYUACCT ERR RC = "
                            LNK-SCNYUACCT-RC
           END-IF
           DISPLAY "4801-NYUKAIKEI-ERASE-SUB-EXT"
      *
           .
       4801-NYUKAIKEI-ERASE-SUB-EXT.
           EXIT.
      *
      *****************************************************************
      *    Âà±¡¼è¾Ã¡¡²ñ·×¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
      *****************************************************************
       4801-TAIINKAIKEI-CANCEL-SEC         SECTION.
      *
           MOVE      SPACE        TO    WRK-DOU-TENNYUYMD
           MOVE      SPACE        TO    IPN-NYUKAIKEI-SAKUSEI-FLG
      *
      *    ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ»»Äê»þ¤ËÂà±¡Æü¤ò£Ó£Ð£Á¡Ý°ÛÆ°Æü¤ÈÅ¾ÆþÆü¤Ë¥»¥Ã¥È
      *    °Ê²¼¤ÎÆÃÄêÆþ±¡ÎÁ¤âÆ±ÍÍ
      *      µßÌ¿µßµÞÆþ±¡ÎÁ
      *      °ìÎà´¶À÷¾É´µ¼ÔÆþ±¡°åÎÅ´ÉÍýÎÁ
      *      ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ
      *      ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ
      *      °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN  = "03" OR "04" OR "05" OR
                                                "06" OR "07" OR "08" OR
                                                "09" OR "13" OR "14" OR
                                                "16" OR "17" OR "18"
                    MOVE   SPA-NAI-I01-TAIINYMD
                                       TO   PTNYUINRRK-TENNYUYMD
                                            SPA-NAI-I01-IDOYMD

               END-IF
           ELSE
               IF  PTNYUINRRK-TOKUTEI-KBN   =   SPACE
                   INITIALIZE                  STS-AREA-DAY
                   INITIALIZE                  LNK-DAY6-AREA
                   MOVE    "61"                TO  LNK-DAY6-IRAI
                   MOVE    SPA-NAI-I01-TAIINYMD
                                               TO  LNK-DAY6-KIJUN
                   MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
                   MOVE     1                  TO  LNK-DAY6-ZOGEN
                   CALL  "ORCSDAY"             USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                   MOVE    LNK-DAY6-KEISAN     TO  PTNYUINRRK-TENNYUYMD
      *             MOVE   SPA-NAI-I01-TAIINYMD
      *                                 TO   PTNYUINRRK-TENNYUYMD
               END-IF
           END-IF
      *
      *    Âà±¡¼è¾ÃÁ°¤Î²ñ·×¸µ¥Ç¡¼¥¿ºîÀ®
           INITIALIZE      ORCSSYOKIKSNAREA
      *
      *    Æþ±¡²ñ·×ºï½üÁ°¤Ë²ñ·×¥Ç¡¼¥¿¤Î¿©»ö¶èÊ¬¤ÈÊÝ¸±ÁÈ¹ç¤»¤òÂàÈò
           INITIALIZE                      NYUINACCT-REC
           MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
           MOVE    "1"                 TO  NACCT-NYUGAIKBN
           MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
           MOVE    "00"                TO  NACCT-SRYKA
           MOVE   SPA-NAI-I01-TAIINYMD(1:6)
                                       TO  NACCT-SRYYM
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY16"   TO  WRK-DBPATH
           PERFORM   900-TBL-SELECT-SEC
           IF      FLG-DBRC            =   ZERO
               MOVE    ZERO        TO      WRK-TAIHI-SHOKUJI
               PERFORM UNTIL       FLG-DBRC     NOT =   ZERO
      *
                   MOVE     MCPDATA-REC   TO   NYUINACCT-REC
      *
      *            ¿©»ö¤òÂàÈò
                   IF      NACCT-ZAISKBKBN     =   "4"
                       MOVE    SPA-NAI-I01-TAIINYMD(7:2)
                                         TO    IDX-SHOKUJIX
                       IF      NACCT-DAY(IDX-SHOKUJI9)  NOT =   ZERO
                            MOVE   NACCT-DAY(IDX-SHOKUJI9) TO
                                                  WRK-TAIHI-SHOKUJI
                       END-IF
                   END-IF
      *            ÊÝ¸±¤òÂàÈò
                   IF      NACCT-ZAISKBKBN     =   "5"
                       MOVE   SPA-NAI-I01-TAIINYMD(7:2)
                                         TO    IDX-SHOKUJIX
                       IF      NACCT-DAY(IDX-SHOKUJI9)  NOT =   ZERO
                            MOVE   NACCT-DAY(IDX-SHOKUJI9) TO
                                                  WRK-TAIHI-HKN
                       END-IF
                   END-IF
      *
                   MOVE    "NYUINACCT-KEY16"   TO  WRK-DBPATH
                   PERFORM 900-TBL-READ-SEC
               END-PERFORM
           ELSE
               INITIALIZE                  NYUINACCT-REC
           END-IF
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "NYUINACCT-KEY16"      TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *
      *    ÄÌ»»Æü¿ô¡¢»»Äê³«»ÏÆü¤òµá¤á¤ë
           PERFORM 4801-TSUSAN-SANTEI-GET-SEC
           IF    ( SPA-ERRCD    NOT =  SPACE )
               GO  TO  4801-TAIINKAIKEI-CANCEL-EXT
           END-IF
      *
           MOVE    WRK-TSUSAN      TO  SYOKIKSN-IN-TUSANNISSU
           MOVE    WRK-SANTEISTYMD
                                   TO  SYOKIKSN-IN-SANTEISTYMD
      *
      *    ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ»»Äê»þ¤ËÆÃÄêÆþ±¡¤Ç¤Î»»ÄêÆü¤¬£±£´Æü¤ò
      *    ·Ð²á¤·¤Æ¤¤¤¿¾ì¹ç¤Ï°ìÈÌ¤ÎÆþ±¡ÎÁ»»Äê¤È¤¹¤ë
      *    °Ê²¼¤ÎÆÃÄêÆþ±¡ÎÁ¤âÆ±ÍÍ
      *    µßÌ¿µßµÞÆþ±¡ÎÁ
      *    °ìÎà´¶À÷¾É´µ¼ÔÆþ±¡°åÎÅ´ÉÍýÎÁ
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN   = "03" OR "04" OR "05" OR
                                                 "06" OR "07" OR "08" OR
                                                 "09" OR "14" OR "16"
                   IF   STUSAN-NISSU06   >=   14
                       MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
                   END-IF
               END-IF
           END-IF
      *
      *    ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ»»Äê»þ¤ËÆÃÄêÆþ±¡¤Ç¤Î»»ÄêÆü¤¬£¶£°Æü¤ò
      *    ·Ð²á¤·¤Æ¤¤¤¿¾ì¹ç¤Ï°ìÈÌ¤ÎÆþ±¡ÎÁ»»Äê¤È¤¹¤ë
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN   = "13"
                   IF   STUSAN-NISSU06   >=   60
                       MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
                   END-IF
               END-IF
           END-IF
      *
      *    ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ»»Äê»þ¤ËÆÃÄêÆþ±¡¤Ç¤Î»»ÄêÆü¤¬£²£±Æü¤ò
      *    ·Ð²á¤·¤Æ¤¤¤¿¾ì¹ç¤Ï°ìÈÌ¤ÎÆþ±¡ÎÁ»»Äê¤È¤¹¤ë
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN   = "17"
                   IF   STUSAN-NISSU06   >=   21
                       MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
                   END-IF
               END-IF
           END-IF
      *
      *    °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ»»Äê»þ¤ËÆÃÄêÆþ±¡¤Ç¤Î»»ÄêÆü¤¬£¹£°Æü¤ò
      *    ·Ð²á¤·¤Æ¤¤¤¿¾ì¹ç¤Ï°ìÈÌ¤ÎÆþ±¡ÎÁ»»Äê¤È¤¹¤ë
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN   = "18"
                   IF   STUSAN-NISSU06   >=   90
                       MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
                   END-IF
               END-IF
           END-IF
      *
           IF      SPA-GMN-I01-TOKNYUIN-CD    NOT =   SPACE
               PERFORM   4801-TOKTEI-NYUIN-SET-SEC
           ELSE
               IF  SYS-5001-BTU-KHNSRYCD      NOT =   SPACE
                   MOVE    SYS-5001-BTU-KHNSRYCD
                                       TO  SYOKIKSN-IN-KHNSRYCD
                   PERFORM   4801-RJNCD-CHG-SEC
                   CALL    "ORCSSYOKIKSN"  USING   ORCSSYOKIKSNAREA
                   IF    ( SYOKIKSN-OT-RC  NOT =   ZERO )
                       MOVE    "4019"      TO  SPA-ERRCD
                       GO  TO  4801-TAIINKAIKEI-CANCEL-EXT
                   END-IF
               ELSE
                   MOVE    "4020"      TO  SPA-ERRCD
                   GO  TO  4801-TAIINKAIKEI-CANCEL-EXT
               END-IF
           END-IF
      *
      *    Æþ±¡²ñ·×ºîÀ®¥µ¥Ö¤Î¸Æ½Ð¤·
           INITIALIZE                      ORCSNYUACCT-AREA
           MOVE     "7"                TO  LNK-SCNYUACCT-SYORI-KBN
           MOVE     "1"                TO  SPA-NYUGAIKBN
           MOVE     PTNYUINRRK-PTID    TO  SPA-PTID
           MOVE     PTNYUINRRK-NYUINKA TO  SPA-SRYKA
           MOVE     SPA-NAI-I01-NYUINYMD
                                       TO   LNK-SCNYUACCT-STSRYYMD
           MOVE     SPA-NAI-I01-TAIINYMD
                                       TO   LNK-SCNYUACCT-EDSRYYMD
           MOVE    SYOKIKSN-IN-KHNSRYCD
                            TO   LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *Âà±¡Æü¤«¤é¤Î²ñ·×ºÆºîÀ®¤ËÊÑ¹¹ ---------------------------------
      **     MOVE    SYOKIKSN-IN-SANTEISTYMD
      **                      TO   LNK-SCNYUACCT-STSRYYMD
           MOVE     SPA-NAI-I01-TAIINYMD
                                       TO   LNK-SCNYUACCT-STSRYYMD
      *--------------------------------------------------------------
      *
           PERFORM   VARYING   IDX6   FROM   1   BY   1
               UNTIL (SYOKIKSN-OT-KGNSRYCD(IDX6)  =  SPACE) OR
                     (IDX6   >     7)
               MOVE   SYOKIKSN-OT-KGNSRYCD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-SRYCD(IDX6)
               MOVE   SYOKIKSN-OT-YUKOSTYMD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(IDX6)
               MOVE   SYOKIKSN-OT-YUKOEDYMD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-EDYUKYMD(IDX6)
           END-PERFORM
      *
      *    ÄÌ»»»»ÄêºÑÆü¿ô
           MOVE   WRK-TSUSAN    TO  LNK-SCNYUACCT-NYUKHN-NISUU
      *
      *    ÆÃÄêÆþ±¡¤ÇÆþ±¡ÎÁ¤¬ÊÑ¹¹¤Ë¤Ê¤ë¥³¡¼¥É¤ÎÂÐ±þ
      *    ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190774110"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   "190774110"  TO  LNK-SCNYUACCT-KAGEN-SRYCD(1)
                 MOVE   SPA-NAI-I01-NYUINYMD
                                  TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE    13                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
      *
                 MOVE   "190774210"  TO  LNK-SCNYUACCT-KAGEN-SRYCD(2)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE     1                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-STYUKYMD(2)
                 MOVE    "99999999"
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(2)
           END-IF
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190739910"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   "190739910"  TO  LNK-SCNYUACCT-KAGEN-SRYCD(1)
                 MOVE   SPA-NAI-I01-NYUINYMD
                                  TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE    88                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
      *
                 MOVE   "190740010"  TO  LNK-SCNYUACCT-KAGEN-SRYCD(2)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE     1                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-STYUKYMD(2)
                 MOVE    "99999999"
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(2)
           END-IF
      *
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ£²
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190813410"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   "190813410"  TO  LNK-SCNYUACCT-KAGEN-SRYCD(1)
                 MOVE   SPA-NAI-I01-NYUINYMD
                                  TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-NYUINYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE    88                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
      *
                 MOVE   "190813510"  TO  LNK-SCNYUACCT-KAGEN-SRYCD(2)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE     1                TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO LNK-SCNYUACCT-KAGEN-STYUKYMD(2)
                 MOVE    "99999999"
                                  TO LNK-SCNYUACCT-KAGEN-EDYUKYMD(2)
           END-IF
      *
      *    ÆÃÄêÆþ±¡ÎÁ¤Ç£·Æü¤Þ¤Ç¡¢£±£´Æü¤Þ¤Ç¡¢¤½¤ì°Ê¹ß¤Ï°ìÈÌÆþ±¡ÎÁ¤ò»»Äê¤¹¤ë
      *    ¾ì¹ç¤Î¿ÇÎÅ¥³¡¼¥É¤ò¼èÆÀ
           PERFORM    4801-TOKUTEI-NYUIN-7-14-SEC
      *
           MOVE      ZERO               TO  TN-IDX
           IF    SYOKIKSN-IN-KHNSRYCD   =   WRK-TOKUTEI-SRYCD1
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                                         WK-TOKUTEI-DAY2
                 COMPUTE  WK-TOKUTEI-DAY  =  14  - STUSAN-NISSU06
                 IF       STUSAN-NISSU07  <  7
                     ADD     1        TO     TN-IDX
                     COMPUTE  WK-TOKUTEI-DAY2 =  6   -  STUSAN-NISSU07
                     MOVE   WRK-TOKUTEI-SRYCD1  TO
                                    LNK-SCNYUACCT-KAGEN-SRYCD(TN-IDX)
                     MOVE   SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE   WK-TOKUTEI-DAY2    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(TN-IDX)
                 END-IF
      *
                 IF     WK-TOKUTEI-DAY   >=   1
                     ADD     1     TO   TN-IDX
                     MOVE   WRK-TOKUTEI-SRYCD2  TO 
                                    LNK-SCNYUACCT-KAGEN-SRYCD(TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     IF    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1) NOT = SPACE
                         MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                               TO  LNK-DAY6-KIJUN
                         MOVE    "1"           TO  LNK-DAY6-ZOGENPTN
                         MOVE     1            TO  LNK-DAY6-ZOGEN
                         CALL  "ORCSDAY"       USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                         MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(TN-IDX)
                     ELSE
                         MOVE  SPA-NAI-I01-IDOYMD   TO  LNK-DAY6-KIJUN
                         MOVE  SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(TN-IDX)
                     END-IF
                     MOVE    "99999999"        TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(TN-IDX)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 MOVE    "1"      TO      IPN-NYUKAIKEI-SAKUSEI-FLG
           END-IF
      *
      *    ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190024810"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                                         WK-TOKUTEI-DAY2
                 COMPUTE  WK-TOKUTEI-DAY  =  60  - STUSAN-NISSU06
                 IF       STUSAN-NISSU07  <  60
                     MOVE   "190024810"  TO
                                    LNK-SCNYUACCT-KAGEN-SRYCD(1)
                     MOVE   SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
      *               MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                     COMPUTE  LNK-DAY6-ZOGEN = WK-TOKUTEI-DAY  -  1
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          ÆÃÄêÆþ±¡´ü´Ö¡Ê£¶£°Æü·Ð²á¡Ë¤·¤¿ºÝ¤Î°ìÈÌÆþ±¡ÎÁºîÀ®¤Î
      *          ²ÄÈÝ¤òÈ½Äê
                 MOVE    SPA-NAI-I01-IDOYMD
                                  TO      WRK-IPN-HANTEI-YMD1
                 IF      WRK-IPN-HANTEI-M1   =   12
                     ADD    1     TO      WRK-IPN-HANTEI-Y1
                     MOVE   1     TO      WRK-IPN-HANTEI-M1
                 ELSE
                     ADD    1     TO      WRK-IPN-HANTEI-M1
                 END-IF
      *          ·îËöÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY7-AREA
                 MOVE    "71"              TO  LNK-DAY7-IRAI
                 MOVE   WRK-IPN-HANTEI-YM1 TO  LNK-DAY7-YM
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE    LNK-DAY7-KOYOMI   TO      WRK-IPN-HANTEI-YMD1
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                  TO      WRK-IPN-HANTEI-YMD2
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 IF      WRK-IPN-HANTEI-YMD1 > WRK-IPN-HANTEI-YMD2
                     MOVE    "1"   TO     IPN-NYUKAIKEI-SAKUSEI-FLG
                 END-IF
           END-IF
      *
      *    ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ¡Ê£²£±Æü¤ò¸ÂÅÙ¡Ë
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190117310"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                 COMPUTE  WK-TOKUTEI-DAY  =  21  - STUSAN-NISSU06
      *
                 IF     WK-TOKUTEI-DAY   >=   1
                     MOVE   "190117310"  TO 
                                    LNK-SCNYUACCT-KAGEN-SRYCD(1)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE    SPA-NAI-I01-IDOYMD  TO
                                 LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                                 LNK-DAY6-KIJUN
                     MOVE    "1"           TO  LNK-DAY6-ZOGENPTN
                     MOVE     WK-TOKUTEI-DAY
                                           TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"       USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 MOVE    "1"      TO      IPN-NYUKAIKEI-SAKUSEI-FLG
           END-IF
      *
      *    °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190117410"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                                         WK-TOKUTEI-DAY2
                 COMPUTE  WK-TOKUTEI-DAY  =  90  - STUSAN-NISSU06
                 IF       STUSAN-NISSU07  <  90
                     MOVE   "190117410"  TO
                                    LNK-SCNYUACCT-KAGEN-SRYCD(1)
                     MOVE   SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
      *               MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                     COMPUTE  LNK-DAY6-ZOGEN = WK-TOKUTEI-DAY  -  1
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          ÆÃÄêÆþ±¡´ü´Ö¡Ê£¶£°Æü·Ð²á¡Ë¤·¤¿ºÝ¤Î°ìÈÌÆþ±¡ÎÁºîÀ®¤Î
      *          ²ÄÈÝ¤òÈ½Äê
                 MOVE    SPA-NAI-I01-IDOYMD
                                  TO      WRK-IPN-HANTEI-YMD1
                 IF      WRK-IPN-HANTEI-M1   =   12
                     ADD    1     TO      WRK-IPN-HANTEI-Y1
                     MOVE   1     TO      WRK-IPN-HANTEI-M1
                 ELSE
                     ADD    1     TO      WRK-IPN-HANTEI-M1
                 END-IF
      *          ·îËöÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY7-AREA
                 MOVE    "71"              TO  LNK-DAY7-IRAI
                 MOVE   WRK-IPN-HANTEI-YM1 TO  LNK-DAY7-YM
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE    LNK-DAY7-KOYOMI   TO      WRK-IPN-HANTEI-YMD1
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                  TO      WRK-IPN-HANTEI-YMD2
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 IF      WRK-IPN-HANTEI-YMD1 > WRK-IPN-HANTEI-YMD2
                     MOVE    "1"   TO     IPN-NYUKAIKEI-SAKUSEI-FLG
                 END-IF
           END-IF
      *-------ÆÃÄêÆþ±¡ÂÐ±þ¤³¤³¤Þ¤Ç-----------------------------------
      *
      *    Æþ±¡ÎÁ²Ã»»¿ÇÎÅ¥³¡¼¥É¼è¤ê¹þ¤ß
           PERFORM    4801-NYUKSN-GET-SEC
      *
      *    ÆÃÄêÆþ±¡ÎÁ¶èÊ¬¤Î¥»¥Ã¥È
           IF      SPA-GMN-I01-TOKNYUIN-CD    =   SPACE
               MOVE     "0"     TO  LNK-SCNYUACCT-TOKUTEINYUIN-KBN
           ELSE
               MOVE     "1"     TO  LNK-SCNYUACCT-TOKUTEINYUIN-KBN
           END-IF
      *    ³°Çñ
           MOVE   "099999911"   TO  LNK-SCNYUACCT-GAIHAKU-SRYCD
      *    ¼¼ÎÁº¹³Û
           MOVE   "099999912"   TO  LNK-SCNYUACCT-SAGAKU-SRYCD
           IF     PTNYUINRRK-RM-SAGAKU   =   SPACE
               MOVE    ZERO     TO  LNK-SCNYUACCT-SAGAKU-KBN
           ELSE
               MOVE   PTNYUINRRK-RM-SAGAKU 
                                TO  WRK-SAGAKU-KBN
               MOVE   WRK-SAGAKU-KBN9
                                TO  LNK-SCNYUACCT-SAGAKU-KBN
           END-IF
      *    ¿©»ö¶èÊ¬
           MOVE   "099999913"   TO  LNK-SCNYUACCT-SHOKUJI-SRYCD
           IF     WRK-TAIHI-SHOKUJI    NOT =   ZERO
                  MOVE   WRK-TAIHI-SHOKUJI
                                TO  LNK-SCNYUACCT-SHOKUJIKBN
           ELSE
                  MOVE   1      TO  LNK-SCNYUACCT-SHOKUJIKBN
           END-IF
      *    ¿©Æ²²Ã»»
           PERFORM     4801-BTUSEL-SEC
           IF   FLG-SYSKANRI           =    ZERO
               IF   SYS-5001-BTU-SYOKUDOKBN       =    "2"
                    MOVE     "197000570"    TO
                                LNK-SCNYUACCT-SHOKUDO-SRYCD
                    MOVE    1   TO   LNK-SCNYUACCT-SHOKUDO-KBN
               END-IF
           END-IF
      *    ÊÝ¸±ÁÈ¹ç¤»
           MOVE   "099999914"   TO  LNK-SCNYUACCT-HKNCOMBINUM-SRYCD
           IF     WRK-TAIHI-HKN    NOT =   ZERO
                  MOVE   WRK-TAIHI-HKN
                                TO  LNK-SCNYUACCT-HKNCOMBINUM
           ELSE
                  MOVE   PTNYUINRRK-HKNCOMBINUM
                                TO  WRK-HKNCOMBINUM
                  MOVE   WRK-HKNCOMBINUM9 
                                TO  LNK-SCNYUACCT-HKNCOMBINUM
           END-IF
           MOVE   SPA-SRYKA     TO  WRK-TAIHI-SRYKA
           MOVE   "00"          TO  SPA-SRYKA
           PERFORM 4801-SENTEI-SET-SEC
           CALL   "ORCSNYUACCT"  USING   SPA-AREA
                                         ORCSNYUACCT-AREA
           MOVE   WRK-TAIHI-SRYKA TO     SPA-SRYKA
           IF     LNK-SCNYUACCT-RC   NOT =  ZERO
                  DISPLAY  "ORCGI01 ORCSNYUACCT ERR RC = "
                            LNK-SCNYUACCT-RC
           END-IF
      *
           IF     IPN-NYUKAIKEI-SAKUSEI-FLG    =   "1"
               MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
               MOVE    IPN-SANTEISTYMD   TO   WRK-SANTEISTYMD
               MOVE    IPN-SANTEISTYMD   TO   SPA-NAI-I01-IDOYMD
               MOVE    IPN-SANTEISTYMD   TO   PTNYUINRRK-TENNYUYMD
               PERFORM   4801-TENROOM-EDIT-SEC
           END-IF
      *
           .
       4801-TAIINKAIKEI-CANCEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    Å¾²Ê¡¿Å¾Åï¡¿Å¾¼¼»þ¡¡²ñ·×¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
      *****************************************************************
       4801-TENROOM-EDIT-SEC         SECTION.
      *
           MOVE      SPACE        TO    WRK-DOU-TENNYUYMD
           MOVE      SPACE        TO    IPN-NYUKAIKEI-SAKUSEI-FLG
      *
           INITIALIZE      ORCSSYOKIKSNAREA
      *
      *    ÄÌ»»Æü¿ô¡¢»»Äê³«»ÏÆü¤òµá¤á¤ë
           PERFORM 4801-TSUSAN-SANTEI-GET-SEC
           IF    ( SPA-ERRCD    NOT =  SPACE )
               GO  TO  4801-TENROOM-EDIT-EXT
           END-IF
      *
           MOVE    WRK-TSUSAN      TO  SYOKIKSN-IN-TUSANNISSU
           MOVE    WRK-SANTEISTYMD
                                   TO  SYOKIKSN-IN-SANTEISTYMD
      *
      *    ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ»»Äê»þ¤ËÆÃÄêÆþ±¡¤Ç¤Î»»ÄêÆü¤¬£±£´Æü¤ò
      *    ·Ð²á¤·¤Æ¤¤¤¿¾ì¹ç¤Ï°ìÈÌ¤ÎÆþ±¡ÎÁ»»Äê¤È¤¹¤ë
      *    °Ê²¼¤ÎÆÃÄêÆþ±¡ÎÁ¤âÆ±ÍÍ
      *    µßÌ¿µßµÞÆþ±¡ÎÁ
      *    °ìÎà´¶À÷¾É´µ¼ÔÆþ±¡°åÎÅ´ÉÍýÎÁ
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN   = "03" OR "04" OR "05" OR
                                                 "06" OR "07" OR "08" OR
                                                 "09" OR "14" OR "16"
                   IF   STUSAN-NISSU06   >=   14
                       MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
                   END-IF
               END-IF
           END-IF
      *
      *    ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ»»Äê»þ¤ËÆÃÄêÆþ±¡¤Ç¤Î»»ÄêÆü¤¬£¶£°Æü¤ò
      *    ·Ð²á¤·¤Æ¤¤¤¿¾ì¹ç¤Ï°ìÈÌ¤ÎÆþ±¡ÎÁ»»Äê¤È¤¹¤ë
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN   = "13"
                   IF   STUSAN-NISSU06   >=   60
                       MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
                   END-IF
               END-IF
           END-IF
      *
      *    ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ»»Äê»þ¤ËÆÃÄêÆþ±¡¤Ç¤Î»»ÄêÆü¤¬£²£±Æü¤ò
      *    ·Ð²á¤·¤Æ¤¤¤¿¾ì¹ç¤Ï°ìÈÌ¤ÎÆþ±¡ÎÁ»»Äê¤È¤¹¤ë
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN   = "17"
                   IF   STUSAN-NISSU06   >=   21
                       MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
                   END-IF
               END-IF
           END-IF
      *
      *    °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ»»Äê»þ¤ËÆÃÄêÆþ±¡¤Ç¤Î»»ÄêÆü¤¬£¹£°Æü¤ò
      *    ·Ð²á¤·¤Æ¤¤¤¿¾ì¹ç¤Ï°ìÈÌ¤ÎÆþ±¡ÎÁ»»Äê¤È¤¹¤ë
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN   = "18"
                   IF   STUSAN-NISSU06   >=   90
                       MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
                   END-IF
               END-IF
           END-IF
      *
           IF      SPA-GMN-I01-TOKNYUIN-CD    NOT =   SPACE
               PERFORM   4801-TOKTEI-NYUIN-SET-SEC
           ELSE
               IF  SYS-5001-BTU-KHNSRYCD      NOT =   SPACE
                   MOVE    SYS-5001-BTU-KHNSRYCD
                                       TO  SYOKIKSN-IN-KHNSRYCD
                   PERFORM   4801-RJNCD-CHG-SEC
                   CALL    "ORCSSYOKIKSN"  USING   ORCSSYOKIKSNAREA
                   IF    ( SYOKIKSN-OT-RC  NOT =   ZERO )
                       MOVE    "4021"      TO  SPA-ERRCD
                       GO  TO  4801-TENROOM-EDIT-EXT
                   END-IF
               ELSE
                   MOVE    "4022"      TO  SPA-ERRCD
                   GO  TO  4801-TENROOM-EDIT-EXT
               END-IF
           END-IF
      *
      *    Æþ±¡²ñ·×ºîÀ®Á°¤Ë²ñ·×¥Ç¡¼¥¿¤Î¿©»ö¶èÊ¬¤òÂàÈò
      *    ¡Ê°ÛÆ°·îÊ¬¡Ë
           INITIALIZE                      NYUINACCT-REC
           MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
           MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
           MOVE    SPA-NAI-I01-IDOYMD(1:6)
                                       TO  NACCT-SRYYM
                                           WRK-TENROOM-SKJ-SRYYMX
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY28"   TO  WRK-DBPATH
           PERFORM   900-TBL-SELECT-SEC
           IF      FLG-DBRC            =   ZERO
               MOVE     MCPDATA-REC    TO  NYUINACCT-REC
      *        ¿©»ö¤òÂàÈò
               MOVE    NACCT-SRYYM     TO  WRK-TENROOM-SKJ-SRYYM(1)
               MOVE    SPA-NAI-I01-IDOYMD(7:2)
                                       TO  IDX-SHOKUJIX
               PERFORM   VARYING   IDX-SKJ FROM  IDX-SHOKUJI9  BY  1
                         UNTIL     IDX-SKJ   >   31
                    MOVE   NACCT-DAY(IDX-SKJ)
                                       TO  WRK-TENROOM-SKJ(1 IDX-SKJ)
               END-PERFORM
           ELSE
               MOVE    SPA-NAI-I01-IDOYMD(1:6)
                                       TO  WRK-TENROOM-SKJ-SRYYM(1)
               MOVE    SPA-NAI-I01-IDOYMD(7:2)
                                       TO  IDX-SHOKUJIX
               PERFORM   VARYING   IDX-SKJ FROM  IDX-SHOKUJI9  BY  1
                         UNTIL     IDX-SKJ   >   31
                    MOVE   ZERO        TO  WRK-TENROOM-SKJ(1 IDX-SKJ)
               END-PERFORM
           END-IF
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "NYUINACCT-KEY28"      TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *    ¡Ê°ÛÆ°Íâ·îÊ¬¡Ë
           INITIALIZE                      NYUINACCT-REC
           MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
           MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
           IF      WRK-TENROOM-SKJ-SRYMM9  =  12
               ADD   1     TO   WRK-TENROOM-SKJ-SRYYY9
               MOVE  1     TO   WRK-TENROOM-SKJ-SRYMM9
           ELSE
               ADD   1     TO   WRK-TENROOM-SKJ-SRYMM9
           END-IF
           MOVE    WRK-TENROOM-SKJ-SRYYMX
                                       TO  NACCT-SRYYM
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY28"   TO  WRK-DBPATH
           PERFORM   900-TBL-SELECT-SEC
           IF      FLG-DBRC            =   ZERO
               MOVE     MCPDATA-REC    TO  NYUINACCT-REC
      *        ¿©»ö¤òÂàÈò
               MOVE    NACCT-SRYYM     TO  WRK-TENROOM-SKJ-SRYYM(2)
               PERFORM   VARYING   IDX-SKJ FROM  1  BY  1
                         UNTIL     IDX-SKJ   >   31
                    MOVE   NACCT-DAY(IDX-SKJ)
                                       TO  WRK-TENROOM-SKJ(2 IDX-SKJ)
               END-PERFORM
           ELSE
               MOVE    SPACE           TO  WRK-TENROOM-SKJ-SRYYM(2)
           END-IF
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "NYUINACCT-KEY28"      TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    Æþ±¡²ñ·×ºîÀ®¥µ¥Ö¤Î¸Æ½Ð¤·
           INITIALIZE                     ORCSNYUACCT-AREA
           MOVE    "8"                TO  LNK-SCNYUACCT-SYORI-KBN
           MOVE    "1"                TO  SPA-NYUGAIKBN
           MOVE    PTNYUINRRK-PTID    TO  SPA-PTID
           MOVE    PTNYUINRRK-NYUINKA TO  SPA-SRYKA
           MOVE    SYOKIKSN-IN-KHNSRYCD
                           TO  LNK-SCNYUACCT-NYUKHN-SRYCD(1)
           MOVE    SYOKIKSN-IN-SANTEISTYMD
                           TO   LNK-SCNYUACCT-STSRYYMD
           MOVE    SPA-NAI-I01-IDOYMD
                           TO   LNK-SCNYUACCT-EDSRYYMD
           PERFORM   VARYING   IDX6   FROM   1   BY   1
               UNTIL (SYOKIKSN-OT-KGNSRYCD(IDX6)  =  SPACE) OR
                     (IDX6   >     7)
               MOVE   SYOKIKSN-OT-KGNSRYCD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-SRYCD(IDX6)
               MOVE   SYOKIKSN-OT-YUKOSTYMD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(IDX6)
               MOVE   SYOKIKSN-OT-YUKOEDYMD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-EDYUKYMD(IDX6)
           END-PERFORM
      *    ÄÌ»»»»ÄêºÑÆü¿ô
           MOVE   WRK-TSUSAN    TO  LNK-SCNYUACCT-NYUKHN-NISUU
      *
      *    ÆÃÄêÆþ±¡¤ÇÆþ±¡ÎÁ¤¬ÊÑ¹¹¤Ë¤Ê¤ë¥³¡¼¥É¤ÎÂÐ±þ
      *    ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190774110"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   ZERO            TO  TN-IDX
                 IF     STUSAN-NISSU01      <=  14
                     ADD    1           TO  TN-IDX
                     MOVE   "190774110" TO   LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
      *              ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ¤Î£±£´Æü°ÊÆâ¤Î½ªÆü¤òºÆ·×»»
                     MOVE     ZERO      TO   WK-TOKUTEI-DAY
                     COMPUTE  WK-TOKUTEI-DAY  =  14  - STUSAN-NISSU01
                     MOVE   SPA-NAI-I01-IDOYMD
                                       TO  LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WK-TOKUTEI-DAY    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
                 END-IF
      *
                 ADD    1   TO    TN-IDX
      *
                 MOVE   "190774210"  TO  LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 IF      TN-IDX      =     2
                     MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE     1                TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 ELSE
                     MOVE    SPA-NAI-I01-IDOYMD
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 END-IF
                 MOVE    "99999999"    TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
           END-IF
      *
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190739910"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   ZERO            TO  TN-IDX
                 IF     STUSAN-NISSU01      <=  90
                     ADD    1           TO  TN-IDX
                     MOVE   "190739910" TO   LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
      *              Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ¤Î£¹£°Æü°ÊÆâ¤Î½ªÆü¤òºÆ·×»»
                     MOVE     ZERO      TO   WK-TOKUTEI-DAY
                     COMPUTE  WK-TOKUTEI-DAY  =  90  - STUSAN-NISSU01
                     MOVE   SPA-NAI-I01-IDOYMD
                                       TO  LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WK-TOKUTEI-DAY    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
                 END-IF
      *
                 ADD    1   TO    TN-IDX
      *
                 MOVE   "190740010"  TO  LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 IF      TN-IDX      =     2
                     MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE     1                TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 ELSE
                     MOVE    SPA-NAI-I01-IDOYMD
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 END-IF
                 MOVE    "99999999"    TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
           END-IF
      *
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ£²
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190813410"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   ZERO            TO  TN-IDX
                 IF     STUSAN-NISSU01      <=  90
                     ADD    1           TO  TN-IDX
                     MOVE   "190813410" TO   LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
      *              Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ¤Î£¹£°Æü°ÊÆâ¤Î½ªÆü¤òºÆ·×»»
                     MOVE     ZERO      TO   WK-TOKUTEI-DAY
                     COMPUTE  WK-TOKUTEI-DAY  =  90  - STUSAN-NISSU01
                     MOVE   SPA-NAI-I01-IDOYMD
                                       TO  LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WK-TOKUTEI-DAY    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
                 END-IF
      *
                 ADD    1   TO    TN-IDX
      *
                 MOVE   "190813510"  TO  LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 IF      TN-IDX      =     2
                     MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE     1                TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 ELSE
                     MOVE    SPA-NAI-I01-IDOYMD
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 END-IF
                 MOVE    "99999999"    TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
           END-IF
      *
      *    ÆÃÄêÆþ±¡ÎÁ¤Ç£·Æü¤Þ¤Ç¡¢£±£´Æü¤Þ¤Ç¡¢¤½¤ì°Ê¹ß¤Ï°ìÈÌÆþ±¡ÎÁ¤ò»»Äê¤¹¤ë
      *    ¾ì¹ç¤Î¿ÇÎÅ¥³¡¼¥É¤ò¼èÆÀ
           PERFORM    4801-TOKUTEI-NYUIN-7-14-SEC
      *
           MOVE      ZERO               TO  TN-IDX
           IF    SYOKIKSN-IN-KHNSRYCD   =   WRK-TOKUTEI-SRYCD1
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                                         WK-TOKUTEI-DAY2
                 COMPUTE  WK-TOKUTEI-DAY  =  14  - STUSAN-NISSU06
                 IF       STUSAN-NISSU07  <  7
                     ADD     1        TO     TN-IDX
                     COMPUTE  WK-TOKUTEI-DAY2 =  6   -  STUSAN-NISSU07
                     MOVE   WRK-TOKUTEI-SRYCD1  TO
                                    LNK-SCNYUACCT-KAGEN-SRYCD(TN-IDX)
                     MOVE   SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE   WK-TOKUTEI-DAY2    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(TN-IDX)
                 END-IF
      *
                 IF     WK-TOKUTEI-DAY   >=   1
                     ADD     1     TO   TN-IDX
                     MOVE   WRK-TOKUTEI-SRYCD2  TO 
                                    LNK-SCNYUACCT-KAGEN-SRYCD(TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     IF    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1) NOT = SPACE
                         MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                               TO  LNK-DAY6-KIJUN
                         MOVE    "1"           TO  LNK-DAY6-ZOGENPTN
                         MOVE     1            TO  LNK-DAY6-ZOGEN
                         CALL  "ORCSDAY"       USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                         MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(TN-IDX)
                     ELSE
                         MOVE  SPA-NAI-I01-IDOYMD   TO  LNK-DAY6-KIJUN
                         MOVE  SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(TN-IDX)
                     END-IF
                     MOVE    "99999999"        TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(TN-IDX)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 MOVE    "1"      TO      IPN-NYUKAIKEI-SAKUSEI-FLG
           END-IF
      *
      *    ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190024810"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                 COMPUTE  WK-TOKUTEI-DAY  =  60  - STUSAN-NISSU06
                 IF       STUSAN-NISSU07  <  60
                     MOVE   "190024810"  TO
                                    LNK-SCNYUACCT-KAGEN-SRYCD(1)
                     MOVE   SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
      *               MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                     COMPUTE  LNK-DAY6-ZOGEN = WK-TOKUTEI-DAY  -  1
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          ÆÃÄêÆþ±¡´ü´Ö¡Ê£¶£°Æü·Ð²á¡Ë¤·¤¿ºÝ¤Î°ìÈÌÆþ±¡ÎÁºîÀ®¤Î
      *          ²ÄÈÝ¤òÈ½Äê
                 MOVE    SPA-NAI-I01-IDOYMD
                                  TO      WRK-IPN-HANTEI-YMD1
                 IF      WRK-IPN-HANTEI-M1   =   12
                     ADD    1     TO      WRK-IPN-HANTEI-Y1
                     MOVE   1     TO      WRK-IPN-HANTEI-M1
                 ELSE
                     ADD    1     TO      WRK-IPN-HANTEI-M1
                 END-IF
      *          ·îËöÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY7-AREA
                 MOVE    "71"              TO  LNK-DAY7-IRAI
                 MOVE   WRK-IPN-HANTEI-YM1 TO  LNK-DAY7-YM
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE    LNK-DAY7-KOYOMI   TO      WRK-IPN-HANTEI-YMD1
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                  TO      WRK-IPN-HANTEI-YMD2
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 IF      WRK-IPN-HANTEI-YMD1 > WRK-IPN-HANTEI-YMD2
                     MOVE    "1"   TO     IPN-NYUKAIKEI-SAKUSEI-FLG
                 END-IF
           END-IF
      *
      *    ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ¡Ê£²£±Æü¤ò¸ÂÅÙ¡Ë
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190117310"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                 COMPUTE  WK-TOKUTEI-DAY  =  21  - STUSAN-NISSU06
      *
                 IF     WK-TOKUTEI-DAY   >=   1
                     MOVE   "190117310"  TO 
                                    LNK-SCNYUACCT-KAGEN-SRYCD(1)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE    SPA-NAI-I01-IDOYMD  TO
                                 LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                                 LNK-DAY6-KIJUN
                     MOVE    "1"           TO  LNK-DAY6-ZOGENPTN
                     MOVE     WK-TOKUTEI-DAY
                                           TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"       USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 MOVE    "1"      TO      IPN-NYUKAIKEI-SAKUSEI-FLG
           END-IF
      *
      *    °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ¡Ê£¹£°Æü¤ò¸ÂÅÙ¡Ë
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190117410"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                 COMPUTE  WK-TOKUTEI-DAY  =  90  - STUSAN-NISSU06
                 IF       STUSAN-NISSU07  <  90
                     MOVE   "190117410"  TO
                                    LNK-SCNYUACCT-KAGEN-SRYCD(1)
                     MOVE   SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
      *               MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                     COMPUTE  LNK-DAY6-ZOGEN = WK-TOKUTEI-DAY  -  1
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          ÆÃÄêÆþ±¡´ü´Ö¡Ê£¶£°Æü·Ð²á¡Ë¤·¤¿ºÝ¤Î°ìÈÌÆþ±¡ÎÁºîÀ®¤Î
      *          ²ÄÈÝ¤òÈ½Äê
                 MOVE    SPA-NAI-I01-IDOYMD
                                  TO      WRK-IPN-HANTEI-YMD1
                 IF      WRK-IPN-HANTEI-M1   =   12
                     ADD    1     TO      WRK-IPN-HANTEI-Y1
                     MOVE   1     TO      WRK-IPN-HANTEI-M1
                 ELSE
                     ADD    1     TO      WRK-IPN-HANTEI-M1
                 END-IF
      *          ·îËöÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY7-AREA
                 MOVE    "71"              TO  LNK-DAY7-IRAI
                 MOVE   WRK-IPN-HANTEI-YM1 TO  LNK-DAY7-YM
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE    LNK-DAY7-KOYOMI   TO      WRK-IPN-HANTEI-YMD1
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                  TO      WRK-IPN-HANTEI-YMD2
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 IF      WRK-IPN-HANTEI-YMD1 > WRK-IPN-HANTEI-YMD2
                     MOVE    "1"   TO     IPN-NYUKAIKEI-SAKUSEI-FLG
                 END-IF
           END-IF
      *-------ÆÃÄêÆþ±¡ÂÐ±þ¤³¤³¤Þ¤Ç-----------------------------------
      *
      *    Æþ±¡ÎÁ²Ã»»¿ÇÎÅ¥³¡¼¥É¼è¤ê¹þ¤ß
           PERFORM    4801-NYUKSN-GET-SEC
      *
      *    ÆÃÄêÆþ±¡ÎÁ¶èÊ¬¤Î¥»¥Ã¥È
           IF      SPA-GMN-I01-TOKNYUIN-CD    =   SPACE
               MOVE     "0"     TO  LNK-SCNYUACCT-TOKUTEINYUIN-KBN
           ELSE
               MOVE     "1"     TO  LNK-SCNYUACCT-TOKUTEINYUIN-KBN
           END-IF
      *    ³°Çñ
           MOVE   "099999911"   TO  LNK-SCNYUACCT-GAIHAKU-SRYCD
      *    ¼¼ÎÁº¹³Û
           MOVE   "099999912"   TO  LNK-SCNYUACCT-SAGAKU-SRYCD
           IF     PTNYUINRRK-RM-SAGAKU   =   SPACE
               MOVE    ZERO     TO  LNK-SCNYUACCT-SAGAKU-KBN
           ELSE
               MOVE   PTNYUINRRK-RM-SAGAKU 
                                TO  WRK-SAGAKU-KBN
               MOVE   WRK-SAGAKU-KBN9
                                TO  LNK-SCNYUACCT-SAGAKU-KBN
           END-IF
      *    ¿©»ö¶èÊ¬
           MOVE   "099999913"   TO  LNK-SCNYUACCT-SHOKUJI-SRYCD
           IF     WRK-TAIHI-SHOKUJI    NOT =   ZERO
                  MOVE   WRK-TAIHI-SHOKUJI
                                TO  LNK-SCNYUACCT-SHOKUJIKBN
           ELSE
                  MOVE   1      TO  LNK-SCNYUACCT-SHOKUJIKBN
           END-IF
      *    ¿©Æ²²Ã»»
           PERFORM     4801-BTUSEL-SEC
           IF   FLG-SYSKANRI           =    ZERO
               IF   SYS-5001-BTU-SYOKUDOKBN       =    "2"
                    MOVE     "197000570"    TO
                                LNK-SCNYUACCT-SHOKUDO-SRYCD
                    MOVE    1   TO   LNK-SCNYUACCT-SHOKUDO-KBN
               END-IF
           END-IF
      *    ÊÝ¸±ÁÈ¹ç¤»
           MOVE   "099999914"   TO  LNK-SCNYUACCT-HKNCOMBINUM-SRYCD
           MOVE   PTNYUINRRK-HKNCOMBINUM
                                TO  WRK-HKNCOMBINUM
           MOVE   WRK-HKNCOMBINUM9 
                                TO  LNK-SCNYUACCT-HKNCOMBINUM
      *    Å¾²Ê¸µÆþ±¡²Ê
           MOVE   "00"          TO  LNK-SCNYUACCT-MOTO-NYUINKA
      **     MOVE   SPA-GMN-I01-NYUINKA-MOT (1 : 2)
      **                          TO  LNK-SCNYUACCT-MOTO-NYUINKA
           MOVE   SPA-SRYKA     TO  WRK-TAIHI-SRYKA
           MOVE   "00"          TO  SPA-SRYKA
           PERFORM 4801-SENTEI-SET-SEC
           CALL   "ORCSNYUACCT"  USING   SPA-AREA
                                         ORCSNYUACCT-AREA
           MOVE   WRK-TAIHI-SRYKA TO     SPA-SRYKA
           IF     LNK-SCNYUACCT-RC   NOT =  ZERO
               DISPLAY  "ORCGI01 ORCSNYUACCT ERR RC = "
                         LNK-SCNYUACCT-RC
           END-IF
      *
           IF     IPN-NYUKAIKEI-SAKUSEI-FLG    =   "1"
               MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
               MOVE    IPN-SANTEISTYMD   TO   WRK-SANTEISTYMD
               MOVE    IPN-SANTEISTYMD   TO   SPA-NAI-I01-IDOYMD
               MOVE    IPN-SANTEISTYMD   TO   PTNYUINRRK-TENNYUYMD
           END-IF
      *
      *    Æþ±¡²ñ·×ºîÀ®¸å¤ËÂàÈò¥Ç¡¼¥¿¤Î¿©»ö¶èÊ¬¤òÉü¸µ
      *    ¡Ê°ÛÆ°·îÊ¬¡Ë
           INITIALIZE                      NYUINACCT-REC
           MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
           MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
           MOVE    WRK-TENROOM-SKJ-SRYYM(1)
                                       TO  NACCT-SRYYM
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY28"   TO  WRK-DBPATH
           PERFORM   900-TBL-SELECT-SEC
           IF      FLG-DBRC            =   ZERO
               MOVE     MCPDATA-REC    TO  NYUINACCT-REC
      *        ¿©»ö¤òÉü¸µ
               MOVE    SPA-NAI-I01-IDOYMD(7:2)
                                       TO  IDX-SHOKUJIX
               PERFORM   VARYING   IDX-SKJ FROM  IDX-SHOKUJI9  BY  1
                         UNTIL     IDX-SKJ   >   31
                    MOVE   WRK-TENROOM-SKJ(1 IDX-SKJ)
                                       TO  NACCT-DAY(IDX-SKJ)
               END-PERFORM
      *        ºÞ²ó¿ôºÆ¥»¥Ã¥È
               MOVE  ZERO              TO  NACCT-ZAIKAISU
               PERFORM  VARYING   IDX-SKJ FROM  1  BY  1
                         UNTIL     IDX-SKJ   >   31
                   IF   NACCT-DAY(IDX-SKJ)   NOT =  0
                       ADD   1        TO  NACCT-ZAIKAISU
                   END-IF
               END-PERFORM   
           END-IF
           MOVE     NYUINACCT-REC      TO  MCPDATA-REC
           MOVE     "DBUPDATE"         TO  MCP-FUNC
           MOVE     "NYUINACCT-KEY"    TO  ORC-DBPATH
           CALL     "ORCMCPSUB"        USING  MCPAREA
                                              ORCMCPAREA
                                              MCPDATA-REC 
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "NYUINACCT-KEY28"      TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    ¡Ê°ÛÆ°Íâ·îÊ¬¡Ë
           IF   WRK-TENROOM-SKJ-SRYYM(2)  NOT =   SPACE
               INITIALIZE                      NYUINACCT-REC
               MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
               MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
               MOVE    WRK-TENROOM-SKJ-SRYYM(2)
                                           TO  NACCT-SRYYM
      *
               MOVE    NYUINACCT-REC       TO  MCPDATA-REC
               MOVE    "NYUINACCT-KEY28"   TO  WRK-DBPATH
               PERFORM   900-TBL-SELECT-SEC
               IF      FLG-DBRC            =   ZERO
                   MOVE     MCPDATA-REC    TO  NYUINACCT-REC
      *            ¿©»ö¤òÉü¸µ
                   PERFORM   VARYING   IDX-SKJ FROM  1  BY  1
                             UNTIL     IDX-SKJ   >   31
                        MOVE   WRK-TENROOM-SKJ(2 IDX-SKJ)
                                           TO  NACCT-DAY(IDX-SKJ)
                   END-PERFORM
      *            ºÞ²ó¿ôºÆ¥»¥Ã¥È
                   MOVE  ZERO              TO  NACCT-ZAIKAISU
                   PERFORM  VARYING   IDX-SKJ FROM  1  BY  1
                             UNTIL     IDX-SKJ   >   31
                       IF   NACCT-DAY(IDX-SKJ)   NOT =  0
                           ADD   1        TO  NACCT-ZAIKAISU
                       END-IF
                   END-PERFORM   
               END-IF
               MOVE     NYUINACCT-REC      TO  MCPDATA-REC
               MOVE     "DBUPDATE"         TO  MCP-FUNC
               MOVE     "NYUINACCT-KEY"    TO  ORC-DBPATH
               CALL     "ORCMCPSUB"        USING  MCPAREA
                                                  ORCMCPAREA
                                                  MCPDATA-REC 
      *        Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
               MOVE    "NYUINACCT-KEY28"      TO  ORC-DBPATH
               PERFORM 900-TBL-CLOSE-SEC
           END-IF
      *
           .
       4801-TENROOM-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    °ÛÆ°¼è¾Ã»þ²ñ·×¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
      *****************************************************************
       4801-IDOKAIKEI-CANCEL-SEC       SECTION.
      *
           MOVE   SPACE                TO  WRK-DOU-TENNYUYMD
      *    Æþ±¡²ñ·×ºîÀ®¥µ¥Ö¤Î¸Æ½Ð¤·¡Ê°ÛÆ°Ê¬¤Î²ñ·×ºï½ü¡Ë
           INITIALIZE            ORCSNYUACCT-AREA
           MOVE     "4"     TO   LNK-SCNYUACCT-SYORI-KBN
           MOVE     "1"                TO  SPA-NYUGAIKBN
           MOVE     PTNYUINRRK-PTID    TO  SPA-PTID
           MOVE     PTNYUINRRK-NYUINKA TO  SPA-SRYKA
           INITIALIZE                  STS-AREA-DAY
           INITIALIZE                  LNK-DAY6-AREA
           MOVE    "61"                TO  LNK-DAY6-IRAI
           MOVE    SPA-NAI-I01-MAEIDOYMD
                                       TO  LNK-DAY6-KIJUN
           MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
           MOVE    -1                  TO  LNK-DAY6-ZOGEN
           CALL  "ORCSDAY"             USING   STS-AREA-DAY
                                               LNK-DAY6-AREA
           MOVE    LNK-DAY6-KEISAN     TO  LNK-SCNYUACCT-EDSRYYMD
      *
      *    Æþ±¡²ñ·×ºï½üÁ°¤Ë²ñ·×¥Ç¡¼¥¿¤Î¿©»ö¶èÊ¬¤ÈÊÝ¸±ÁÈ¹ç¤»¤òÂàÈò
           INITIALIZE                      NYUINACCT-REC
           MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
           MOVE    "1"                 TO  NACCT-NYUGAIKBN
           MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
           MOVE    "00"                TO  NACCT-SRYKA
           MOVE    LNK-SCNYUACCT-EDSRYYMD(1:6)
                                       TO  NACCT-SRYYM
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY16"   TO  WRK-DBPATH
           PERFORM   900-TBL-SELECT-SEC
           IF      FLG-DBRC            =   ZERO
               MOVE    ZERO        TO      WRK-TAIHI-SHOKUJI
               PERFORM UNTIL       FLG-DBRC     NOT =   ZERO
      *
                   MOVE     MCPDATA-REC   TO   NYUINACCT-REC
      *
      *            ¿©»ö¤òÂàÈò
                   IF      NACCT-ZAISKBKBN     =   "4"
                       MOVE    LNK-SCNYUACCT-EDSRYYMD(7:2)
                                         TO    IDX-SHOKUJIX
                       IF      NACCT-DAY(IDX-SHOKUJI9)  NOT =   ZERO
                            MOVE   NACCT-DAY(IDX-SHOKUJI9) TO
                                                  WRK-TAIHI-SHOKUJI
                       END-IF
                   END-IF
      *            ÊÝ¸±¤òÂàÈò
                   IF      NACCT-ZAISKBKBN     =   "5"
                       MOVE    LNK-SCNYUACCT-EDSRYYMD(7:2)
                                         TO    IDX-SHOKUJIX
                       IF      NACCT-DAY(IDX-SHOKUJI9)  NOT =   ZERO
                            MOVE   NACCT-DAY(IDX-SHOKUJI9) TO
                                                  WRK-TAIHI-HKN
                       END-IF
                   END-IF
      *
                   MOVE    "NYUINACCT-KEY16"   TO  WRK-DBPATH
                   PERFORM 900-TBL-READ-SEC
               END-PERFORM
           ELSE
               INITIALIZE                  NYUINACCT-REC
           END-IF
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "NYUINACCT-KEY16"      TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    Æþ±¡²ñ·×ºîÀ®Á°¤Ë²ñ·×¥Ç¡¼¥¿¤Î¿©»ö¶èÊ¬¤òÂàÈò
      *    ¡Ê°ÛÆ°·îÊ¬¡Ë
           INITIALIZE                      NYUINACCT-REC
           MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
           MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
           MOVE    LNK-SCNYUACCT-EDSRYYMD(1:6)
                                       TO  NACCT-SRYYM
                                           WRK-TENROOM-SKJ-SRYYMX
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY28"   TO  WRK-DBPATH
           PERFORM   900-TBL-SELECT-SEC
           IF      FLG-DBRC            =   ZERO
               MOVE     MCPDATA-REC    TO  NYUINACCT-REC
      *        ¿©»ö¤òÂàÈò
               MOVE    NACCT-SRYYM     TO  WRK-TENROOM-SKJ-SRYYM(1)
               MOVE    LNK-SCNYUACCT-EDSRYYMD(7:2)
                                       TO  IDX-SHOKUJIX
               MOVE    LNK-SCNYUACCT-EDSRYYMD(7:2)
                                       TO  WRK-TENROOM-SKJ-DD(1)
               PERFORM   VARYING   IDX-SKJ FROM  IDX-SHOKUJI9  BY  1
                         UNTIL     IDX-SKJ   >   31
                    MOVE   NACCT-DAY(IDX-SKJ)
                                       TO  WRK-TENROOM-SKJ(1 IDX-SKJ)
               END-PERFORM
           END-IF
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "NYUINACCT-KEY28"      TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *    ¡Ê°ÛÆ°Íâ·îÊ¬¡Ë
           INITIALIZE                      NYUINACCT-REC
           MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
           MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
           IF      WRK-TENROOM-SKJ-SRYMM9  =  12
               ADD   1     TO   WRK-TENROOM-SKJ-SRYYY9
               MOVE  1     TO   WRK-TENROOM-SKJ-SRYMM9
           ELSE
               ADD   1     TO   WRK-TENROOM-SKJ-SRYMM9
           END-IF
           MOVE    WRK-TENROOM-SKJ-SRYYMX
                                       TO  NACCT-SRYYM
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY28"   TO  WRK-DBPATH
           PERFORM   900-TBL-SELECT-SEC
           IF      FLG-DBRC            =   ZERO
               MOVE     MCPDATA-REC    TO  NYUINACCT-REC
      *        ¿©»ö¤òÂàÈò
               MOVE    NACCT-SRYYM     TO  WRK-TENROOM-SKJ-SRYYM(2)
               PERFORM   VARYING   IDX-SKJ FROM  1  BY  1
                         UNTIL     IDX-SKJ   >   31
                    MOVE   NACCT-DAY(IDX-SKJ)
                                       TO  WRK-TENROOM-SKJ(2 IDX-SKJ)
               END-PERFORM
           END-IF
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "NYUINACCT-KEY28"      TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    ÊÝ¸±ÁÈ¹ç¤»
           MOVE   PTNYUINRRK-HKNCOMBINUM
                                       TO  WRK-HKNCOMBINUM
           MOVE   WRK-HKNCOMBINUM9     TO  LNK-SCNYUACCT-HKNCOMBINUM
           MOVE   SPA-SRYKA            TO  WRK-TAIHI-SRYKA
           MOVE   "00"                 TO  SPA-SRYKA
           CALL   "ORCSNYUACCT"  USING   SPA-AREA
                                         ORCSNYUACCT-AREA
           MOVE   WRK-TAIHI-SRYKA TO     SPA-SRYKA
           IF     LNK-SCNYUACCT-RC   NOT =  ZERO
                  DISPLAY  "ORCGI01 ORCSNYUACCT ERR RC = "
                            LNK-SCNYUACCT-RC
           END-IF
      *
      *    Æþ±¡²ñ·×ºîÀ®¥µ¥Ö¤Î¸Æ½Ð¤·¡Ê°ÛÆ°Á°¤Î²ñ·×ºîÀ®¡Ë
      *
           MOVE    SPACE               TO  IPN-NYUKAIKEI-SAKUSEI-FLG
      *
           INITIALIZE                  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-PTID            TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY9"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO  )
               MOVE    MCPDATA-REC TO  PTNYUINRRK-REC
           ELSE
               INITIALIZE              PTNYUINRRK-REC
           END-IF
      *
           MOVE    "PTNYUINRRK-KEY9"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ»»Äê»þ¤ËÂà±¡Æü¤ò£Ó£Ð£Á¡Ý°ÛÆ°Æü¤ÈÅ¾ÆþÆü¤Ë¥»¥Ã¥È
      *    °Ê²¼¤ÎÆÃÄêÆþ±¡ÎÁ¤âÆ±ÍÍ
      *    µßÌ¿µßµÞÆþ±¡ÎÁ
      *    °ìÎà´¶À÷¾É´µ¼ÔÆþ±¡°åÎÅ´ÉÍýÎÁ
      *    ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ
      *    ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ
      *    °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               IF   PTNYUINRRK-TOKUTEI-NYUIN  = "03" OR "04" OR "05" OR
                                                "06" OR "07" OR "08" OR
                                                "09" OR "13" OR "14" OR
                                                "16" OR "17" OR "18"
                    MOVE   SPA-NAI-I01-MAEIDOYMD
                                       TO   PTNYUINRRK-TENNYUYMD
                                            SPA-NAI-I01-IDOYMD

               END-IF
           END-IF
      *
           INITIALIZE      ORCSSYOKIKSNAREA
      *
      *    ÄÌ»»Æü¿ô¡¢»»Äê³«»ÏÆü¤òµá¤á¤ë
           MOVE    SPA-NAI-I01-MAEIDOYMD  TO   PTNYUINRRK-TENNYUYMD
           PERFORM 4801-TSUSAN-SANTEI-GET-SEC
           IF    ( SPA-ERRCD    NOT =  SPACE )
               GO  TO  4801-IDOKAIKEI-CANCEL-EXT
           END-IF
      *
           MOVE    WRK-TSUSAN      TO  SYOKIKSN-IN-TUSANNISSU
           MOVE    WRK-SANTEISTYMD
                                   TO  SYOKIKSN-IN-SANTEISTYMD
      *
           INITIALIZE              SYSKANRI-REC
           MOVE    "5001"          TO  SYS-KANRICD
           MOVE    SPA-NAI-I01-MAEIDOYMD
                                   TO  ORC-DBYMD
           MOVE    PTNYUINRRK-BTUNUM
                                   TO  SYS-KBNCD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¤ÎÉÂÅï¾ðÊó¤è¤ê¼èÆÀ
           MOVE    "SYSKANRI-KEY"  TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           IF   FLG-DBRC           =    ZERO
               MOVE    MCPDATA-REC TO   SYS-5001-REC
           END-IF
      *    ¥·¥¹¥Æ¥à´ÉÍý¥¯¥í¡¼¥º
           MOVE    "SYSKANRI-KEY"      TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF      PTNYUINRRK-TOKUTEI-NYUIN    NOT =   SPACE
               PERFORM   4801-TOKTEI-NYUIN-SET-SEC
           ELSE
               IF  SYS-5001-BTU-KHNSRYCD      NOT =   SPACE
                   MOVE    SYS-5001-BTU-KHNSRYCD
                                       TO  SYOKIKSN-IN-KHNSRYCD
                   PERFORM   4801-RJNCD-CHG-SEC
                   CALL    "ORCSSYOKIKSN"  USING   ORCSSYOKIKSNAREA
                   IF    ( SYOKIKSN-OT-RC  NOT =   ZERO )
                       MOVE    "4023"      TO  SPA-ERRCD
                       GO  TO  4801-IDOKAIKEI-CANCEL-EXT
                   END-IF
               ELSE
                   MOVE    "4024"      TO  SPA-ERRCD
                   GO  TO  4801-IDOKAIKEI-CANCEL-EXT
               END-IF
           END-IF
      *
      *    Æþ±¡²ñ·×ºîÀ®¥µ¥Ö¤Î¸Æ½Ð¤·
           INITIALIZE            ORCSNYUACCT-AREA
           MOVE     "1"     TO   LNK-SCNYUACCT-SYORI-KBN
           MOVE     "1"                TO  SPA-NYUGAIKBN
           MOVE     PTNYUINRRK-PTID    TO  SPA-PTID
           MOVE     PTNYUINRRK-NYUINKA TO  SPA-SRYKA
           MOVE    SYOKIKSN-IN-KHNSRYCD
                            TO   LNK-SCNYUACCT-NYUKHN-SRYCD(1)
           MOVE    SYOKIKSN-IN-SANTEISTYMD
                            TO   LNK-SCNYUACCT-STSRYYMD
           PERFORM   VARYING   IDX6   FROM   1   BY   1
               UNTIL (SYOKIKSN-OT-KGNSRYCD(IDX6)  =  SPACE) OR
                     (IDX6   >     7)
               MOVE   SYOKIKSN-OT-KGNSRYCD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-SRYCD(IDX6)
               MOVE   SYOKIKSN-OT-YUKOSTYMD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-STYUKYMD(IDX6)
               MOVE   SYOKIKSN-OT-YUKOEDYMD(IDX6)
                         TO  LNK-SCNYUACCT-KAGEN-EDYUKYMD(IDX6)
           END-PERFORM
      *    ÄÌ»»»»ÄêºÑÆü¿ô
           MOVE   WRK-TSUSAN    TO  LNK-SCNYUACCT-NYUKHN-NISUU
      *
      *    ÆÃÄêÆþ±¡¤ÇÆþ±¡ÎÁ¤¬ÊÑ¹¹¤Ë¤Ê¤ë¥³¡¼¥É¤ÎÂÐ±þ
      *    ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190774110"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   ZERO            TO  TN-IDX
                 IF     STUSAN-NISSU01      <=  14
                     ADD    1           TO  TN-IDX
                     MOVE   "190774110" TO   LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
      *              ¿ÇÎÅ½êÏ·¿Í°åÎÅ´ÉÍýÎÁ¤Î£±£´Æü°ÊÆâ¤Î½ªÆü¤òºÆ·×»»
                     MOVE     ZERO      TO   WK-TOKUTEI-DAY
                     COMPUTE  WK-TOKUTEI-DAY  =  14  - STUSAN-NISSU01
                     MOVE   SPA-NAI-I01-MAEIDOYMD
                                       TO  LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-MAEIDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WK-TOKUTEI-DAY    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
                 END-IF
      *
                 ADD    1   TO    TN-IDX
      *
                 MOVE   "190774210"  TO  LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 IF      TN-IDX      =     2
                     MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE     1                TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 ELSE
                     MOVE    SPA-NAI-I01-MAEIDOYMD
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 END-IF
                 MOVE    "99999999"    TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
           END-IF
      *
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190739910"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   ZERO            TO  TN-IDX
                 IF     STUSAN-NISSU01      <=  90
                     ADD    1           TO  TN-IDX
                     MOVE   "190739910" TO   LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
      *              Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ¤Î£¹£°Æü°ÊÆâ¤Î½ªÆü¤òºÆ·×»»
                     MOVE     ZERO      TO   WK-TOKUTEI-DAY
                     COMPUTE  WK-TOKUTEI-DAY  =  90  - STUSAN-NISSU01
                     MOVE   SPA-NAI-I01-MAEIDOYMD
                                       TO  LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-MAEIDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WK-TOKUTEI-DAY    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
                 END-IF
      *
                 ADD    1   TO    TN-IDX
      *
                 MOVE   "190740010"  TO  LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 IF      TN-IDX      =     2
                     MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE     1                TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 ELSE
                     MOVE    SPA-NAI-I01-MAEIDOYMD
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 END-IF
                 MOVE    "99999999"    TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
           END-IF
      *
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ£²
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190813410"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                 MOVE   ZERO            TO  TN-IDX
                 IF     STUSAN-NISSU01      <=  90
                     ADD    1           TO  TN-IDX
                     MOVE   "190813410" TO   LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
      *              Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ¤Î£¹£°Æü°ÊÆâ¤Î½ªÆü¤òºÆ·×»»
                     MOVE     ZERO      TO   WK-TOKUTEI-DAY
                     COMPUTE  WK-TOKUTEI-DAY  =  90  - STUSAN-NISSU01
                     MOVE   SPA-NAI-I01-MAEIDOYMD
                                       TO  LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-MAEIDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WK-TOKUTEI-DAY    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
                 END-IF
      *
                 ADD    1   TO    TN-IDX
      *
                 MOVE   "190813510"  TO  LNK-SCNYUACCT-KAGEN-SRYCD
                                                               (TN-IDX)
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 IF      TN-IDX      =     2
                     MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                           TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE     1                TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 ELSE
                     MOVE    SPA-NAI-I01-MAEIDOYMD
                                       TO LNK-SCNYUACCT-KAGEN-STYUKYMD
                                                               (TN-IDX)
                 END-IF
                 MOVE    "99999999"    TO LNK-SCNYUACCT-KAGEN-EDYUKYMD
                                                               (TN-IDX)
           END-IF
      *
      *    ÆÃÄêÆþ±¡ÎÁ¤Ç£·Æü¤Þ¤Ç¡¢£±£´Æü¤Þ¤Ç¡¢¤½¤ì°Ê¹ß¤Ï°ìÈÌÆþ±¡ÎÁ¤ò»»Äê¤¹¤ë
      *    ¾ì¹ç¤Î¿ÇÎÅ¥³¡¼¥É¤ò¼èÆÀ
           PERFORM    4801-TOKUTEI-NYUIN-7-14-SEC
      *
           MOVE      ZERO               TO  TN-IDX
           IF    SYOKIKSN-IN-KHNSRYCD   =   WRK-TOKUTEI-SRYCD1
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                                         WK-TOKUTEI-DAY2
                 COMPUTE  WK-TOKUTEI-DAY  =  14  - STUSAN-NISSU06
                 IF       STUSAN-NISSU07  <  7
                     ADD     1        TO     TN-IDX
                     COMPUTE  WK-TOKUTEI-DAY2 =  6   -  STUSAN-NISSU07
                     MOVE   WRK-TOKUTEI-SRYCD1  TO
                                    LNK-SCNYUACCT-KAGEN-SRYCD(TN-IDX)
                     MOVE   SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE   WK-TOKUTEI-DAY2    TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(TN-IDX)
                 END-IF
      *
                 IF     WK-TOKUTEI-DAY   >=   1
                     ADD     1     TO   TN-IDX
                     MOVE   WRK-TOKUTEI-SRYCD2  TO 
                                    LNK-SCNYUACCT-KAGEN-SRYCD(TN-IDX)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     IF    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1) NOT = SPACE
                         MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                               TO  LNK-DAY6-KIJUN
                         MOVE    "1"           TO  LNK-DAY6-ZOGENPTN
                         MOVE     1            TO  LNK-DAY6-ZOGEN
                         CALL  "ORCSDAY"       USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                         MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(TN-IDX)
                     ELSE
                         MOVE  SPA-NAI-I01-IDOYMD   TO  LNK-DAY6-KIJUN
                         MOVE  SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(TN-IDX)
                     END-IF
                     MOVE    "99999999"        TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(TN-IDX)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 MOVE    "1"      TO      IPN-NYUKAIKEI-SAKUSEI-FLG
           END-IF
      *
      *    ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190024810"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                 COMPUTE  WK-TOKUTEI-DAY  =  60  - STUSAN-NISSU06
                 IF       STUSAN-NISSU07  <  60
                     MOVE   "190024810"  TO
                                    LNK-SCNYUACCT-KAGEN-SRYCD(1)
                     MOVE   SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
      *               MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                     COMPUTE  LNK-DAY6-ZOGEN = WK-TOKUTEI-DAY  -  1
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          ÆÃÄêÆþ±¡´ü´Ö¡Ê£¶£°Æü·Ð²á¡Ë¤·¤¿ºÝ¤Î°ìÈÌÆþ±¡ÎÁºîÀ®¤Î
      *          ²ÄÈÝ¤òÈ½Äê
                 MOVE    SPA-NAI-I01-IDOYMD
                                  TO      WRK-IPN-HANTEI-YMD1
                 IF      WRK-IPN-HANTEI-M1   =   12
                     ADD    1     TO      WRK-IPN-HANTEI-Y1
                     MOVE   1     TO      WRK-IPN-HANTEI-M1
                 ELSE
                     ADD    1     TO      WRK-IPN-HANTEI-M1
                 END-IF
      *          ·îËöÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY7-AREA
                 MOVE    "71"              TO  LNK-DAY7-IRAI
                 MOVE   WRK-IPN-HANTEI-YM1 TO  LNK-DAY7-YM
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE    LNK-DAY7-KOYOMI   TO      WRK-IPN-HANTEI-YMD1
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                  TO      WRK-IPN-HANTEI-YMD2
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 IF      WRK-IPN-HANTEI-YMD1 > WRK-IPN-HANTEI-YMD2
                     MOVE    "1"   TO     IPN-NYUKAIKEI-SAKUSEI-FLG
                 END-IF
           END-IF
      *
      *    ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ¡Ê£²£±Æü¤ò¸ÂÅÙ¡Ë
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190117310"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                         LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                 COMPUTE  WK-TOKUTEI-DAY  =  21  - STUSAN-NISSU06
      *
                 IF     WK-TOKUTEI-DAY   >=   1
                     MOVE   "190117310"  TO 
                                    LNK-SCNYUACCT-KAGEN-SRYCD(1)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE    SPA-NAI-I01-IDOYMD  TO
                                 LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                                 LNK-DAY6-KIJUN
                     MOVE    "1"           TO  LNK-DAY6-ZOGENPTN
                     MOVE     WK-TOKUTEI-DAY
                                           TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"       USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 MOVE    "1"      TO      IPN-NYUKAIKEI-SAKUSEI-FLG
           END-IF
      *
      *    °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ
           IF    SYOKIKSN-IN-KHNSRYCD   =   "190117410"
                 MOVE   SPACE       TO   SYOKIKSN-IN-KHNSRYCD
                                        LNK-SCNYUACCT-NYUKHN-SRYCD(1)
      *          °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ¤Î»»Äê²ÄÇ½Æü¿ô¤ò·×»»
                 MOVE     ZERO      TO   WK-TOKUTEI-DAY
                 COMPUTE  WK-TOKUTEI-DAY  =  90  - STUSAN-NISSU06
                 IF       STUSAN-NISSU07  <  90
                     MOVE   "190117410"  TO
                                    LNK-SCNYUACCT-KAGEN-SRYCD(1)
                     MOVE   SPA-NAI-I01-IDOYMD   TO
                                  LNK-SCNYUACCT-KAGEN-STYUKYMD(1)
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   SPA-NAI-I01-IDOYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
      *               MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                     COMPUTE  LNK-DAY6-ZOGEN = WK-TOKUTEI-DAY  -  1
                     CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN   TO
                                  LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                 END-IF
      *          °ìÈÌÆþ±¡ÎÁ¤Î»»Äê³«»ÏÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY6-AREA
                 MOVE    "61"              TO  LNK-DAY6-IRAI
                 MOVE   SPA-NAI-I01-IDOYMD
                                           TO  LNK-DAY6-KIJUN
                 MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                 MOVE   WK-TOKUTEI-DAY     TO  LNK-DAY6-ZOGEN
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                 MOVE    LNK-DAY6-KEISAN
                                  TO       IPN-SANTEISTYMD
      *          ÆÃÄêÆþ±¡´ü´Ö¡Ê£¶£°Æü·Ð²á¡Ë¤·¤¿ºÝ¤Î°ìÈÌÆþ±¡ÎÁºîÀ®¤Î
      *          ²ÄÈÝ¤òÈ½Äê
                 MOVE    SPA-NAI-I01-IDOYMD
                                  TO      WRK-IPN-HANTEI-YMD1
                 IF      WRK-IPN-HANTEI-M1   =   12
                     ADD    1     TO      WRK-IPN-HANTEI-Y1
                     MOVE   1     TO      WRK-IPN-HANTEI-M1
                 ELSE
                     ADD    1     TO      WRK-IPN-HANTEI-M1
                 END-IF
      *          ·îËöÆü¤ò»»Äê
                 INITIALIZE                STS-AREA-DAY
                 INITIALIZE                LNK-DAY7-AREA
                 MOVE    "71"              TO  LNK-DAY7-IRAI
                 MOVE   WRK-IPN-HANTEI-YM1 TO  LNK-DAY7-YM
                 CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE    LNK-DAY7-KOYOMI   TO      WRK-IPN-HANTEI-YMD1
                 MOVE    LNK-SCNYUACCT-KAGEN-EDYUKYMD(1)
                                  TO      WRK-IPN-HANTEI-YMD2
      *          °ìÈÌÆþ±¡²ñ·×ºîÀ®ÍÑ¤Î¥Õ¥é¥°ÀßÄê
                 IF      WRK-IPN-HANTEI-YMD1 > WRK-IPN-HANTEI-YMD2
                     MOVE    "1"   TO     IPN-NYUKAIKEI-SAKUSEI-FLG
                 END-IF
           END-IF
      *-------ÆÃÄêÆþ±¡ÂÐ±þ¤³¤³¤Þ¤Ç-----------------------------------
      *
      *    Æþ±¡ÎÁ²Ã»»¿ÇÎÅ¥³¡¼¥É¼è¤ê¹þ¤ß
           PERFORM    4801-NYUKSN-GET-SEC
      *
      *    ÆÃÄêÆþ±¡ÎÁ¶èÊ¬¤Î¥»¥Ã¥È
           IF      PTNYUINRRK-TOKUTEI-NYUIN    =   SPACE
               MOVE     "0"     TO  LNK-SCNYUACCT-TOKUTEINYUIN-KBN
           ELSE
               MOVE     "1"     TO  LNK-SCNYUACCT-TOKUTEINYUIN-KBN
           END-IF
      *    ³°Çñ
           MOVE   "099999911"   TO  LNK-SCNYUACCT-GAIHAKU-SRYCD
      *    ¼¼ÎÁº¹³Û
           MOVE   "099999912"   TO  LNK-SCNYUACCT-SAGAKU-SRYCD
           IF     PTNYUINRRK-RM-SAGAKU   =   SPACE
               MOVE    ZERO     TO  LNK-SCNYUACCT-SAGAKU-KBN
           ELSE
               MOVE   PTNYUINRRK-RM-SAGAKU 
                                TO  WRK-SAGAKU-KBN
               MOVE   WRK-SAGAKU-KBN9
                                TO  LNK-SCNYUACCT-SAGAKU-KBN
           END-IF
      *    ¿©»ö¶èÊ¬
           MOVE   "099999913"   TO  LNK-SCNYUACCT-SHOKUJI-SRYCD
           IF     WRK-TAIHI-SHOKUJI    NOT =   ZERO
                  MOVE   WRK-TAIHI-SHOKUJI
                                TO  LNK-SCNYUACCT-SHOKUJIKBN
           ELSE
                  MOVE   1      TO  LNK-SCNYUACCT-SHOKUJIKBN
           END-IF
      *    ¿©Æ²²Ã»»
           PERFORM     4801-BTUSEL-SEC
           IF   FLG-SYSKANRI           =    ZERO
               IF   SYS-5001-BTU-SYOKUDOKBN       =    "2"
                    MOVE     "197000570"    TO
                                LNK-SCNYUACCT-SHOKUDO-SRYCD
                    MOVE    1   TO   LNK-SCNYUACCT-SHOKUDO-KBN
               END-IF
           END-IF
      *    ÊÝ¸±ÁÈ¹ç¤»
           MOVE   "099999914"   TO  LNK-SCNYUACCT-HKNCOMBINUM-SRYCD
           IF     WRK-TAIHI-HKN    NOT =   ZERO
                  MOVE   WRK-TAIHI-HKN
                                TO  LNK-SCNYUACCT-HKNCOMBINUM
           ELSE
                  MOVE   PTNYUINRRK-HKNCOMBINUM
                                TO  WRK-HKNCOMBINUM
                  MOVE   WRK-HKNCOMBINUM9 
                                TO  LNK-SCNYUACCT-HKNCOMBINUM
           END-IF
           MOVE   SPA-SRYKA     TO  WRK-TAIHI-SRYKA
           MOVE   "00"          TO  SPA-SRYKA
           PERFORM 4801-SENTEI-SET-SEC
           CALL   "ORCSNYUACCT"  USING   SPA-AREA
                                         ORCSNYUACCT-AREA
           MOVE   WRK-TAIHI-SRYKA TO     SPA-SRYKA
           IF     LNK-SCNYUACCT-RC   NOT =  ZERO
               DISPLAY  "ORCGI01 ORCSNYUACCT ERR RC = "
                         LNK-SCNYUACCT-RC
           END-IF
      *
           IF     IPN-NYUKAIKEI-SAKUSEI-FLG    =   "1"
               MOVE    SPACE   TO   SPA-GMN-I01-TOKNYUIN-CD
               MOVE    IPN-SANTEISTYMD   TO   WRK-SANTEISTYMD
               MOVE    IPN-SANTEISTYMD   TO   SPA-NAI-I01-IDOYMD
               MOVE    IPN-SANTEISTYMD   TO   PTNYUINRRK-TENNYUYMD
               PERFORM   4801-TENROOM-EDIT-SEC
           END-IF
      *
      *    Æþ±¡²ñ·×ºîÀ®¸å¤ËÂàÈò¥Ç¡¼¥¿¤Î¿©»ö¶èÊ¬¤òÉü¸µ
      *    ¡Ê°ÛÆ°·îÊ¬¡Ë
           INITIALIZE                      NYUINACCT-REC
           MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
           MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
           MOVE    WRK-TENROOM-SKJ-SRYYM(1)
                                       TO  NACCT-SRYYM
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           MOVE    "NYUINACCT-KEY28"   TO  WRK-DBPATH
           PERFORM   900-TBL-SELECT-SEC
           IF      FLG-DBRC            =   ZERO
               MOVE     MCPDATA-REC    TO  NYUINACCT-REC
      *        ¿©»ö¤òÉü¸µ
               MOVE    WRK-TENROOM-SKJ-DD(1)
                                       TO  IDX-SHOKUJIX
               PERFORM   VARYING   IDX-SKJ FROM  IDX-SHOKUJI9  BY  1
                         UNTIL     IDX-SKJ   >   31
                    MOVE   WRK-TENROOM-SKJ(1 IDX-SKJ)
                                       TO  NACCT-DAY(IDX-SKJ)
               END-PERFORM
           END-IF
           MOVE     NYUINACCT-REC      TO  MCPDATA-REC
           MOVE     "DBUPDATE"         TO  MCP-FUNC
           MOVE     "NYUINACCT-KEY"    TO  ORC-DBPATH
           CALL     "ORCMCPSUB"        USING  MCPAREA
                                              ORCMCPAREA
                                              MCPDATA-REC 
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "NYUINACCT-KEY28"      TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *    ¡Ê°ÛÆ°Íâ·îÊ¬¡Ë
           IF   WRK-TENROOM-SKJ-SRYYM(2)  NOT =   SPACE
               INITIALIZE                      NYUINACCT-REC
               MOVE    PTNYUINRRK-HOSPID   TO  NACCT-HOSPID
               MOVE    PTNYUINRRK-PTID     TO  NACCT-PTID
               MOVE    WRK-TENROOM-SKJ-SRYYM(2)
                                           TO  NACCT-SRYYM
      *
               MOVE    NYUINACCT-REC       TO  MCPDATA-REC
               MOVE    "NYUINACCT-KEY28"   TO  WRK-DBPATH
               PERFORM   900-TBL-SELECT-SEC
               IF      FLG-DBRC            =   ZERO
                   MOVE     MCPDATA-REC    TO  NYUINACCT-REC
      *            ¿©»ö¤òÉü¸µ
                   PERFORM   VARYING   IDX-SKJ FROM  1  BY  1
                             UNTIL     IDX-SKJ   >   31
                        MOVE   WRK-TENROOM-SKJ(2 IDX-SKJ)
                                           TO  NACCT-DAY(IDX-SKJ)
                   END-PERFORM
               END-IF
               MOVE     NYUINACCT-REC      TO  MCPDATA-REC
               MOVE     "DBUPDATE"         TO  MCP-FUNC
               MOVE     "NYUINACCT-KEY"    TO  ORC-DBPATH
               CALL     "ORCMCPSUB"        USING  MCPAREA
                                                  ORCMCPAREA
                                                  MCPDATA-REC 
      *        Æþ±¡²ñ·×¥Þ¥¹¥¿¥¯¥í¡¼¥º
               MOVE    "NYUINACCT-KEY28"      TO  ORC-DBPATH
               PERFORM 900-TBL-CLOSE-SEC
           END-IF
      *
           .
       4801-IDOKAIKEI-CANCEL-EXT.
           EXIT.
      *
      *****************************************************************
      *     ÁªÄêÎÅÍÜÈñ¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¼èÆÀ½èÍý
      *****************************************************************
       4801-SENTEI-SET-SEC         SECTION.
      *
           INITIALIZE  SENTEICDCHG-REC
           MOVE    LNK-SCNYUACCT-NYUKHN-SRYCD(1)
                                   TO  SENCHG-IPNSRYCD
           MOVE    SENTEICDCHG-REC TO  MCPDATA-REC
           MOVE    "SENTEICDCHG-KEY2"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO  )
               MOVE    MCPDATA-REC TO  SENTEICDCHG-REC
           ELSE
               INITIALIZE              SENTEICDCHG-REC
           END-IF
      *
           MOVE    "SENTEICDCHG-KEY2"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      **     MOVE    SENCHG-SENTEISRYCD
      **                             TO  LNK-SCNYUACCT-SENTEI-SRYCD
           IF      SENCHG-SENTEISRYCD    NOT =  SPACE
               MOVE    "099999916"   TO  LNK-SCNYUACCT-SENTEI-SRYCD
               MOVE    WRK-SENTEI-STYMD
                                     TO  LNK-SCNYUACCT-SENTEI-STYMD
           END-IF
      *    £±£µºÍÌ¤Ëþ¤Î´µ¼Ô¤ÏÁªÄêÆþ±¡ÂÐ¾Ý³°
           MOVE     PTINF-BIRTHDAY   TO  WRK-BIRTHDAY-15
           ADD      15               TO  WRK-BIRTHDAY-15Y
           IF       WRK-SENTEI-STYMD <=  WRK-BIRTHDAY-15
               MOVE   WRK-BIRTHDAY-15  TO  LNK-SCNYUACCT-SENTEI-STYMD
           END-IF
      *
      *
           .
       4801-SENTEI-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÄÌ»»Æü¿ô¼èÆÀ½èÍý
      *****************************************************************
       4801-TSUSAN-SANTEI-GET-SEC      SECTION.
           DISPLAY "4801-TSUSAN-SANTEI-GET-SEC"
      *
           INITIALIZE                  WRK-TSUSAN
                                       WRK-SANTEISTYMD
      *
           INITIALIZE                  ORCSTUSANAREA
           MOVE    SPA-HOSPID      TO  STUSAN-HOSPID
           MOVE    PTNYUINRRK-PTID TO  STUSAN-PTID
      *---------------Âà±¡Æü¤ÎÆ±ÆüÆþ±¡½èÍý¤³¤³¤«¤é----------------------
           IF   WRK-DOU-TENNYUYMD    NOT =   SPACE
               MOVE    WRK-DOU-TENNYUYMD  TO  PTNYUINRRK-TENNYUYMD
           END-IF
      *---------------Âà±¡Æü¤ÎÆ±ÆüÆþ±¡½èÍý¤³¤³¤Þ¤Ç----------------------
           MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  STUSAN-KJNYMD
      *    ÆÃÄêÆþ±¡¤Ç¤Î»»ÄêºÑÆü¿ô¤ò¼èÆÀÍÑ
      *    ÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ
      *    µßÌ¿µßµÞÆþ±¡ÎÁ
      *    °ìÎà´¶À÷¾É´µ¼ÔÆþ±¡°åÎÅ´ÉÍýÎÁ
      *    ¹­ÈÏ°ÏÇ®½ýÆÃÄê½¸Ãæ¼£ÎÅ¼¼´ÉÍýÎÁ
      *    ¥Ï¥¤¥±¥¢¥æ¥Ë¥Ã¥ÈÆþ±¡°åÎÅ´ÉÍýÎÁ
      *    °¡µÞÀ­´üÆþ±¡°åÎÅ´ÉÍýÎÁ
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "3"
               EVALUATE   PTNYUINRRK-TOKUTEI-NYUIN
                   WHEN   "03"
                   WHEN   "04"
                   WHEN   "05"
                       MOVE   "190024510"  TO  STUSAN-TOKUTEI-SRYCD(1)
                       MOVE   "190074510"  TO  STUSAN-TOKUTEI-SRYCD(2)
                       MOVE   "190110210"  TO  STUSAN-TOKUTEI-SRYCD(3)
                       MOVE   "190110610"  TO  STUSAN-TOKUTEI-SRYCD(4)
                       MOVE   "190110310"  TO  STUSAN-TOKUTEI-SRYCD(5)
                       MOVE   "190110710"  TO  STUSAN-TOKUTEI-SRYCD(6)
                   WHEN   "06"
                   WHEN   "07"
                   WHEN   "08"
                       MOVE   "190024310"  TO  STUSAN-TOKUTEI-SRYCD(1)
                       MOVE   "190024410"  TO  STUSAN-TOKUTEI-SRYCD(2)
                       MOVE   "190110410"  TO  STUSAN-TOKUTEI-SRYCD(3)
                       MOVE   "190110810"  TO  STUSAN-TOKUTEI-SRYCD(4)
                       MOVE   "190110510"  TO  STUSAN-TOKUTEI-SRYCD(5)
                       MOVE   "190110910"  TO  STUSAN-TOKUTEI-SRYCD(6)
                   WHEN   "09"
                   WHEN   "16"
                       MOVE   "190024610"  TO  STUSAN-TOKUTEI-SRYCD(1)
                       MOVE   "190074610"  TO  STUSAN-TOKUTEI-SRYCD(2)
                       MOVE   "190116310"  TO  STUSAN-TOKUTEI-SRYCD(3)
                       MOVE   "190116410"  TO  STUSAN-TOKUTEI-SRYCD(4)
                   WHEN   "14"
                       MOVE   "190075510"  TO  STUSAN-TOKUTEI-SRYCD(1)
                       MOVE   "190075610"  TO  STUSAN-TOKUTEI-SRYCD(2)
                   WHEN   "13"
                       MOVE   "190024810"  TO  STUSAN-TOKUTEI-SRYCD(1)
                   WHEN   "17"
                       MOVE   "190117310"  TO  STUSAN-TOKUTEI-SRYCD(1)
                   WHEN   "18"
                       MOVE   "190117410"  TO  STUSAN-TOKUTEI-SRYCD(1)
               END-EVALUATE
           END-IF
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ£±
      *    Ï·¿ÍÀ­ÃÔÊò¼À´µ¼£ÎÅÉÂÅïÆþ±¡ÎÁ£²
           IF   PTNYUINRRK-TOKUTEI-KBN   =   "2"
               EVALUATE   PTNYUINRRK-TOKUTEI-NYUIN
                   WHEN   "05"
                       MOVE   "190739910"  TO  STUSAN-TOKUTEI-SRYCD(1)
                   WHEN   "15"
                       MOVE   "190813410"  TO  STUSAN-TOKUTEI-SRYCD(1)
               END-EVALUATE
           END-IF
           CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
           IF    ( STUSAN-RC       NOT =   ZERO )
               MOVE    "4025"      TO  SPA-ERRCD
               GO  TO  4801-TSUSAN-SANTEI-GET-EXT
           END-IF
      *
           COMPUTE WRK-TSUSAN  =   STUSAN-NISSU03  -   1
           DISPLAY "==PTNYUINRRK-TENNYUYMD1 = " PTNYUINRRK-TENNYUYMD
      *---------------Âà±¡Æü¤ÎÆ±ÆüÆþ±¡½èÍý¤³¤³¤«¤é----------------------
      *     IF   WRK-DOU-TENNYUYMD    NOT =   SPACE
      *         MOVE    WRK-DOU-TENNYUYMD  TO  PTNYUINRRK-TENNYUYMD
      *     END-IF
      *---------------Âà±¡Æü¤ÎÆ±ÆüÆþ±¡½èÍý¤³¤³¤Þ¤Ç----------------------
           DISPLAY "==WRK-DOU-TENNYUYMD =" WRK-DOU-TENNYUYMD
           DISPLAY "==PTNYUINRRK-TENNYUYMD2 = " PTNYUINRRK-TENNYUYMD
           MOVE    PTNYUINRRK-TENNYUYMD
                                   TO  WRK-SANTEISTYMD
      *
           MOVE    WRK-SANTEISTYMD
                                   TO  WRK-YMD
           MOVE    "1"             TO  WRK-ZOGENPTN
           IF    ( STUSAN-KJNYMD-CHK-FLG  =   ZERO )
               COMPUTE WRK-ZOGEN   =   180 -   STUSAN-NISSU04
           ELSE
               COMPUTE WRK-ZOGEN   =   180 - ( STUSAN-NISSU04  -   1 )
           END-IF
      *
           PERFORM 5002-CALENDAR-SEC
           MOVE    WRK-KEISANYMD   TO  WRK-SENTEI-STYMD
           DISPLAY "4801-TSUSAN-SANTEI-GET-EXT"
      *
           .
       4801-TSUSAN-SANTEI-GET-EXT.
           EXIT.
      ******************************************************************
      *    ÄÌ»»Æü¿ô¡¢»»Äê³«»ÏÆü¼èÆÀ½èÍý¡ÊÆþ±¡ÅÐÏ¿»þ¡Ë
      *****************************************************************
      *- 4801-NYUTSUSAN-SANTEI-GET-SEC   SECTION.
      *-*
      *-     INITIALIZE                  WRK-TSUSAN
      *-                                 WRK-SANTEISTYMD
      *-*
      *-     PERFORM VARYING IDX1    FROM    1   BY  1
      *-         UNTIL     ( IDX1    >  CONST-NYUREKILST-MAX )
      *-         IF    ( SPA-NAI-I01-TZITA-FLG (IDX1)
      *-                                             =   2 )
      *-          AND  ( SPA-GMN-I01-TSHONUM (IDX1)
      *-                             =   PTNYUINRRK-SHONUM )
      *-             COMPUTE WRK-TSUSAN
      *-                 =   WRK-TSUSAN
      *-                 +   SPA-NAI-I01-TNYURRKTAISYO (IDX1)
      *-         END-IF
      *-*
      *-     END-PERFORM
      *-*
      *-*    Îò¤ò¤µ¤«¤Î¤Ü¤êÄÌ»»¤ÎÂÐ¾Ý¤È¤Ê¤ë¥Ç¡¼¥¿¤òÃê½Ð¤¹¤ë
      *-     INITIALIZE    WRK-REKI-ZIIN-TBL
      *-     PERFORM VARYING IDX1    FROM    1   BY  1
      *-         UNTIL     ( IDX1    >  CONST-NYUREKILST-MAX )
      *-         IF    ( SPA-NAI-I01-TZITA-FLG (IDX1)
      *-                                             =   ZERO )
      *-          AND  ( SPA-GMN-I01-TSHONUM (IDX1)
      *-                             =   PTNYUINRRK-SHONUM )
      *-*
      *-             COMPUTE WRK-REKI-ZIIN-CNT
      *-                 =   WRK-REKI-ZIIN-CNT   +   1
      *-*
      *-             MOVE    WRK-REKI-ZIIN-CNT   TO  IDX2
      *-             MOVE    SPA-NAI-I01-TNYUINYMD (IDX1)
      *-                             TO  WRK-REKI-ZIIN-NYUINYMD (IDX2)
      *-             MOVE    SPA-NAI-I01-TTAIINYMD (IDX1)
      *-                             TO  WRK-REKI-ZIIN-TAIINYMD (IDX2)
      *-*
      *-            IF    ( SPA-GMN-I01-TSHOKAI (IDX1)  =   "1" )
      *-                MOVE   CONST-NYUREKILST-MAX     TO  IDX1
      *-            END-IF
      *-*
      *-         END-IF
      *-     END-PERFORM
      *-*
      *-*    Æþ±¡Æü¤¬Á°²óÂà±¡Æü¤ÈÆ±Æü¤Î¾ì¹ç¤Ï¡¢ÍâÆü¤ò»»Äê³«»ÏÆü¤ËÀßÄê¤¹¤ë
      *-     IF    ( SPA-GMN-I01-NYUREKILST-CNT  >   ZERO )
      *-      AND  ( SPA-NAI-I01-TZITA-FLG (1)   =   ZERO )
      *-      AND  ( PTNYUINRRK-NYUINYMD
      *-                             =   SPA-NAI-I01-TTAIINYMD (1) )
      *-         MOVE    PTNYUINRRK-NYUINYMD
      *-                             TO WRK-YMD
      *-         MOVE    "1"         TO WRK-ZOGENPTN
      *-         MOVE    1           TO WRK-ZOGEN
      *-         PERFORM 5002-CALENDAR-SEC
      *-         MOVE    WRK-KEISANYMD
      *-                             TO  WRK-SANTEISTYMD
      *-     ELSE
      *-         MOVE    PTNYUINRRK-NYUINYMD
      *-                             TO  WRK-SANTEISTYMD
      *-     END-IF
      *-*
      *-*    º£²ó¤¬½é²ó¤Î¾ì¹ç¡¢¤Þ¤¿¤Ï²áµî¤ËÎòºîÀ®¥Ç¡¼¥¿¤·¤«¤Ê¤¤¾ì¹ç¤Ï¡¢
      *-*    °Ê²¼¤Î½èÍý¤Ï¹Ô¤ï¤Ê¤¤
      *-     IF    ( PTNYUINRRK-SHOKAIKBN    =   "1" )
      *-       OR  ( WRK-REKI-ZIIN-CNT      <=  ZERO )
      *-     DISPLAY "************************"
      *-     DISPLAY "*** NYUTSUSAN-SANTEI ***"
      *-     DISPLAY "WRK-TSUSAN      = " WRK-TSUSAN
      *-     DISPLAY "WRK-SANTEISTYMD = " WRK-SANTEISTYMD
      *-     DISPLAY "************************"
      *-         GO  TO  4801-NYUTSUSAN-SANTEI-GET-EXT
      *-     END-IF
      *-*
      *-     PERFORM VARYING IDX1
      *-             FROM    WRK-REKI-ZIIN-CNT
      *-             BY      -1
      *-             UNTIL ( IDX1    <   1 )
      *-*
      *-         MOVE    WRK-REKI-ZIIN-NYUINYMD (IDX1)
      *-                         TO  WRK-STYMD
      *-         MOVE    WRK-REKI-ZIIN-TAIINYMD (IDX1)
      *-                         TO  WRK-EDYMD
      *-         PERFORM 5002-KIKAN-CALC-SEC
      *-         IF    ( FLG-ORCSDAY =   ZERO )
      *-             IF    ( WRK-REKI-ZIIN-CNT
      *-                                     >   IDX1 )
      *-              AND  ( WRK-REKI-ZIIN-NYUINYMD (IDX1)
      *-                 =   WRK-REKI-ZIIN-TAIINYMD (IDX1 + 1) )
      *-                 COMPUTE WRK-TSUSAN
      *-                     =   WRK-TSUSAN  +   WRK-NISSU2  -   1
      *-             ELSE
      *-                 COMPUTE WRK-TSUSAN
      *-                     =   WRK-TSUSAN  +   WRK-NISSU2
      *-             END-IF
      *-         END-IF
      *-*
      *-     END-PERFORM
      *-*
      *-     DISPLAY "*** NYUTSUSAN-SANTEI ***"
      *-     DISPLAY "WRK-TSUSAN = "  WRK-TSUSAN
      *-     DISPLAY "WRK-SANTEISTYMD = " WRK-SANTEISTYMD
      *-     DISPLAY "************************"
      *-*
      *-     .
      *- 4801-NYUTSUSAN-SANTEI-GET-EXT.
      *-     EXIT.
      *****************************************************************
      *    ÄÌ»»Æü¿ô¡¢»»Äê³«»ÏÆü¼èÆÀ½èÍý¡ÊÅ¾²Ê¡¦Å¾Åï¡¦Å¾¼¼»þ¡Ë
      *****************************************************************
      *- 4801-IDOTSUSAN-SANTEI-GET-SEC   SECTION.
      *-*
      *-     INITIALIZE                  WRK-NYUINNISSU
      *-                                 WRK-TSUSAN
      *-                                 WRK-SANTEISTYMD
      *-*
      *-     PERFORM VARYING IDX1    FROM    1   BY  1
      *-         UNTIL     ( IDX1    >  CONST-NYUREKILST-MAX )
      *-         IF    ( SPA-NAI-I01-TZITA-FLG (IDX1)
      *-                                             =   2 )
      *-          AND  ( SPA-GMN-I01-TSHONUM (IDX1)
      *-                             =   PTNYUINRRK-SHONUM )
      *-             COMPUTE WRK-TSUSAN
      *-                 =   WRK-TSUSAN
      *-                 +   SPA-NAI-I01-TNYURRKTAISYO (IDX1)
      *-         END-IF
      *-*
      *-     END-PERFORM
      *-*
      *-*    Æþ±¡Æü¤«¤é¡Ê°ÛÆ°ÆüÅöÆü¤ò´Þ¤Þ¤Ê¤¤¡Ë°ÛÆ°Æü¤Þ¤Ç¤ÎÆü¿ô¤òµá¤á¤ë
      *-*    ¡ÊÆþ±¡Æü¿ô¤È¤¹¤ë¡Ë
      *-     MOVE    PTNYUINRRK-NYUINYMD
      *-                                 TO  WRK-STYMD
      *-     MOVE    PTNYUINRRK-TENNYUYMD
      *-                                 TO  WRK-EDYMD
      *-     PERFORM 5002-KIKAN-CALC-SEC
      *-     MOVE    WRK-NISSU1          TO  WRK-NYUINNISSU
      *-*
      *-*    Îò¤ò¤µ¤«¤Î¤Ü¤êÄÌ»»¤ÎÂÐ¾Ý¤È¤Ê¤ë¥Ç¡¼¥¿¤òÃê½Ð¤¹¤ë
      *-     INITIALIZE    WRK-REKI-ZIIN-TBL
      *-     PERFORM VARYING IDX1    FROM    2   BY  1
      *-         UNTIL     ( IDX1    >  CONST-NYUREKILST-MAX )
      *-         IF    ( SPA-NAI-I01-TZITA-FLG (IDX1)
      *-                                             =   ZERO )
      *-          AND  ( SPA-GMN-I01-TSHONUM (IDX1)
      *-                             =   PTNYUINRRK-SHONUM )
      *-*
      *-             COMPUTE WRK-REKI-ZIIN-CNT
      *-                 =   WRK-REKI-ZIIN-CNT   +   1
      *-*
      *-             MOVE    WRK-REKI-ZIIN-CNT   TO  IDX2
      *-             MOVE    SPA-NAI-I01-TNYUINYMD (IDX1)
      *-                             TO  WRK-REKI-ZIIN-NYUINYMD (IDX2)
      *-             MOVE    SPA-NAI-I01-TTAIINYMD (IDX1)
      *-                             TO  WRK-REKI-ZIIN-TAIINYMD (IDX2)
      *-*
      *-            IF    ( SPA-GMN-I01-TSHOKAI (IDX1)  =   "1" )
      *-                MOVE  CONST-NYUREKILST-MAX      TO  IDX1
      *-            END-IF
      *-*
      *-         END-IF
      *-     END-PERFORM
      *-*
      *-*    °ÛÆ°Æü¤¬Á°²óÂà±¡Æü¤ÈÆ±Æü¤Î¾ì¹ç¤Ï¡¢ÍâÆü¤ò»»Äê³«»ÏÆü¤ËÀßÄê¤¹¤ë
      *-     IF    ( SPA-GMN-I01-NYUREKILST-CNT  >   1 )
      *-      AND  ( SPA-NAI-I01-TZITA-FLG (2)   =   ZERO )
      *-      AND  ( PTNYUINRRK-TENNYUYMD
      *-                             =   SPA-NAI-I01-TTAIINYMD (2) )
      *-         MOVE    PTNYUINRRK-TENNYUYMD
      *-                             TO WRK-YMD
      *-         MOVE    "1"         TO WRK-ZOGENPTN
      *-         MOVE    1           TO WRK-ZOGEN
      *-         PERFORM 5002-CALENDAR-SEC
      *-         MOVE    WRK-KEISANYMD
      *-                             TO  WRK-SANTEISTYMD
      *-     ELSE
      *-*        °ÛÆ°Æü¤¬Á°²óÂà±¡Æü¤ÈÆ±Æü¤ÇÌµ¤¤¾ì¹ç¤Ï¡¢°ÛÆ°Æü¤ò»»Äê³«»ÏÆü
      *-*        ¤ËÀßÄê¤¹¤ë¡£
      *-*        ÄÌ»»Æü¿ô¤ÏÆþ±¡Æü¤ÈÁ°²óÂà±¡Æü¤¬Æ±Æü¤Î¾ì¹ç¤Ï¡¢
      *-*        Îò¤òÁÌ¤Ã¤Æµá¤á¤¿ÄÌ»»Æü¿ô¡ÜÆþ±¡Æü¿ô¡Ý£±
      *-*        ¤½¤¦¤Ç¤Ê¤¤¾ì¹ç¡¢ÄÌ»»Æü¿ô¡ÜÆþ±¡Æü¿ô¤òÄÌ»»Æü¿ô¤ËÀßÄê¤¹¤ë
      *-         MOVE    PTNYUINRRK-TENNYUYMD
      *-                             TO  WRK-SANTEISTYMD
      *-         IF    ( SPA-GMN-I01-NYUREKILST-CNT  >   1 )
      *-          AND  ( SPA-NAI-I01-TZITA-FLG (2)   =   ZERO )
      *-          AND  ( PTNYUINRRK-NYUINYMD
      *-                             =   SPA-NAI-I01-TTAIINYMD (2) )
      *-             COMPUTE WRK-TSUSAN
      *-                 =   WRK-TSUSAN  +   WRK-NYUINNISSU  -   1
      *-         ELSE
      *-             COMPUTE WRK-TSUSAN
      *-                 =   WRK-TSUSAN  +   WRK-NYUINNISSU
      *-         END-IF
      *-     END-IF
      *-*
      *-*    º£²ó¤¬½é²ó¤Î¾ì¹ç¡¢¤Þ¤¿¤Ï²áµî¤ËÎòºîÀ®¥Ç¡¼¥¿¤·¤«¤Ê¤¤¾ì¹ç¤Ï¡¢
      *-*    °Ê²¼¤Î½èÍý¤Ï¹Ô¤ï¤Ê¤¤
      *-     IF    ( PTNYUINRRK-SHOKAIKBN    =   "1" )
      *-       OR  ( WRK-REKI-ZIIN-CNT      <=  ZERO )
      *-     DISPLAY "************************"
      *-     DISPLAY "*** IDOTSUSAN-SANTEI ***"
      *-     DISPLAY "WRK-TSUSAN      = " WRK-TSUSAN
      *-     DISPLAY "WRK-SANTEISTYMD = " WRK-SANTEISTYMD
      *-     DISPLAY "************************"
      *-         GO  TO  4801-IDOTSUSAN-SANTEI-GET-EXT
      *-     END-IF
      *-*
      *-     PERFORM VARYING IDX1
      *-             FROM    WRK-REKI-ZIIN-CNT
      *-             BY      -1
      *-             UNTIL ( IDX1    <   1 )
      *-*
      *-         MOVE    WRK-REKI-ZIIN-NYUINYMD (IDX1)
      *-                         TO  WRK-STYMD
      *-         MOVE    WRK-REKI-ZIIN-TAIINYMD (IDX1)
      *-                         TO  WRK-EDYMD
      *-         PERFORM 5002-KIKAN-CALC-SEC
      *-         IF    ( FLG-ORCSDAY =   ZERO )
      *-             IF    ( WRK-REKI-ZIIN-CNT
      *-                                     >   IDX1 )
      *-              AND  ( WRK-REKI-ZIIN-NYUINYMD (IDX1)
      *-                 =   WRK-REKI-ZIIN-TAIINYMD (IDX1 + 1) )
      *-                 COMPUTE WRK-TSUSAN
      *-                     =   WRK-TSUSAN  +   WRK-NISSU2  -   1
      *-             ELSE
      *-                 COMPUTE WRK-TSUSAN
      *-                     =   WRK-TSUSAN  +   WRK-NISSU2
      *-             END-IF
      *-         END-IF
      *-*
      *-     END-PERFORM
      *-*
      *-     DISPLAY "*** IDOTSUSAN-SANTEI ***"
      *-     DISPLAY "WRK-TSUSAN = "  WRK-TSUSAN
      *-     DISPLAY "WRK-SANTEISTYMD = " WRK-SANTEISTYMD
      *-     DISPLAY "************************"
      *-*
      *-     .
      *- 4801-IDOTSUSAN-SANTEI-GET-EXT.
      *-     EXIT.
      *****************************************************************
      *    ÉÂÅï¾ðÊó¸¡º÷½èÍý
      *****************************************************************
       4801-BTUSEL-SEC             SECTION.
      *
           INITIALIZE              SYSKANRI-REC
           MOVE    ZERO            TO  FLG-SYSKANRI
      *
           MOVE    "5001"          TO  SYS-KANRICD
           MOVE    PTNYUINRRK-BTUNUM
                                   TO  SYS-KBNCD
           EVALUATE   SPA-GMN-I01-SYORIKBN-CD
               WHEN   "01"
                   MOVE   SPA-NAI-I01-NYUINYMD
                                   TO  ORC-DBYMD
               WHEN   "08"
                   MOVE   SPA-NAI-I01-IDOYMD
                                   TO  ORC-DBYMD
               WHEN   "09"
                   MOVE   SPA-NAI-I01-MAEIDOYMD
                                   TO  ORC-DBYMD
               WHEN   OTHER
                   MOVE    SPA-SYSYMD
                                   TO  ORC-DBYMD
           END-EVALUATE
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
           MOVE    "SYSKANRI-KEY10"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO )
               MOVE    MCPDATA-REC
                                  TO  SYS-5001-REC
           ELSE
               MOVE    1          TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "SYSKANRI-KEY10"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4801-BTUSEL-EXT.
           EXIT.
      *****************************************************************
      *    ÉÂ¼¼¾ðÊó¸¡º÷½èÍý
      *****************************************************************
       4801-BRMSEL-SEC             SECTION.
      *
           INITIALIZE              SYSKANRI-REC
           MOVE    ZERO            TO  FLG-SYSKANRI
      *
           MOVE    "5002"          TO  SYS-KANRICD
           MOVE    PTNYUINRRK-BRMNUM
                                   TO  SYS-KBNCD
           EVALUATE   SPA-GMN-I01-SYORIKBN-CD
               WHEN   "01"
                   MOVE   SPA-NAI-I01-NYUINYMD
                                   TO  ORC-DBYMD
               WHEN   "08"
                   MOVE   SPA-NAI-I01-IDOYMD
                                   TO  ORC-DBYMD
               WHEN   "09"
                   MOVE   SPA-NAI-I01-MAEIDOYMD
                                   TO  ORC-DBYMD
               WHEN   OTHER
                   MOVE    SPA-SYSYMD
                                   TO  ORC-DBYMD
           END-EVALUATE
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
           MOVE    "SYSKANRI-KEY10"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC    =   ZERO )
               MOVE    MCPDATA-REC
                                  TO  SYS-5002-REC
           ELSE
               MOVE    1          TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "SYSKANRI-KEY10"
                                   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4801-BRMSEL-EXT.
           EXIT.
      *****************************************************************
      *    ÆÃÄêÆþ±¡ÎÁ¥»¥Ã¥È½èÍý
      *****************************************************************
       4801-TOKTEI-NYUIN-SET-SEC   SECTION.
      *    ÉÂÅï
           IF  PTNYUINRRK-TOKUTEI-KBN   =   "1"
             EVALUATE    PTNYUINRRK-TOKUTEI-NYUIN
               WHEN    "01"
                       MOVE   "190075810"   TO  SYOKIKSN-IN-KHNSRYCD
             END-EVALUATE
           END-IF
      *    ÉÂÅï
           IF  PTNYUINRRK-TOKUTEI-KBN   =   "2"
             EVALUATE    PTNYUINRRK-TOKUTEI-NYUIN
               WHEN    "01"
                       MOVE   "190111110"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "02"
                       MOVE   "190111210"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "03"
                       MOVE   "190055210"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "04"
                       MOVE   "190055310"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "05"
                       MOVE   "190739910"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "06"
                       MOVE   "190740110"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "07"
                       MOVE   "190055010"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "08"
                       MOVE   "190055110"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "09"
                       MOVE   "190028910"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "10"
                       MOVE   "190111410"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "11"
                       MOVE   "190066910"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "12"
                       MOVE   "190067010"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "13"
                       MOVE   "190075910"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "14"
                       MOVE   "190075810"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "15"
                       MOVE   "190813410"   TO  SYOKIKSN-IN-KHNSRYCD
             END-EVALUATE
           END-IF
      *    ÉÂ¼¼
           IF  PTNYUINRRK-TOKUTEI-KBN   =   "3"
             EVALUATE    PTNYUINRRK-TOKUTEI-NYUIN
               WHEN    "01"
                       MOVE   "190075710"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "02"
                       MOVE   "190774110"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "03"
                       MOVE   "190024510"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "04"
                       MOVE   "190110210"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "05"
                       MOVE   "190110310"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "06"
                       MOVE   "190024310"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "07"
                       MOVE   "190110410"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "08"
                       MOVE   "190110510"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "09"
                       MOVE   "190024610"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "10"
                       MOVE   "190024710"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "11"
                       MOVE   "190066710"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "12"
                       MOVE   "190066810"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "13"
                       MOVE   "190024810"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "14"
                       MOVE   "190075510"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "15"
                       MOVE   "190788810"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "16"
                       MOVE   "190116310"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "17"
                       MOVE   "190117310"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "18"
                       MOVE   "190117410"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "20"
                       MOVE   "190076710"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "21"
                       MOVE   "190076810"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "22"
                       MOVE   "190799410"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "23"
                       MOVE   "190808910"   TO  SYOKIKSN-IN-KHNSRYCD
               WHEN    "24"
                       MOVE   "190799510"   TO  SYOKIKSN-IN-KHNSRYCD
             END-EVALUATE
           END-IF
      *
           .
       4801-BTU-TOKTEI-NYUIN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡ÎÁ°ìÈÌ¥³¡¼¥É¤«¤éÏ·¿Í¥³¡¼¥É¤Ø¤ÎÃÖ¤­´¹¤¨½èÍý
      *****************************************************************
       4801-RJNCD-CHG-SEC   SECTION.
      *
      *    Ï·¿ÍÂÐ¾Ý´µ¼Ô¥Á¥§¥Ã¥¯
           MOVE    SYOKIKSN-IN-SANTEISTYMD
                                   TO  WRK-AGECHK-SRYYMD
           PERFORM 4801-RJN-TAISYO-CHK-SEC
           IF    ( FLG-RJN         =   1 )    AND
                 ( COMB-HKNNUM     NOT =   "971" )  AND
                 ( COMB-HKNNUM     NOT =   "973" )
               INITIALIZE              SRYCDCHG-REC
      *
               MOVE    SYOKIKSN-IN-KHNSRYCD
                                       TO   CHG-IPNSRYCD
               MOVE    SRYCDCHG-REC    TO   MCPDATA-REC
               MOVE    "SRYCDCHG-KEY2" TO   WRK-DBPATH
               PERFORM 900-TBL-SELECT-SEC 
               IF    ( FLG-DBRC    =   ZERO )
                   MOVE    MCPDATA-REC
                                       TO   SRYCDCHG-REC
                   IF   CHG-RJNSRYCD   NOT =   SPACE
                        MOVE   CHG-RJNSRYCD
                                       TO  SYOKIKSN-IN-KHNSRYCD
                   END-IF
               END-IF
      *
               MOVE    "SRYCDCHG-KEY2" TO   WRK-DBPATH
               PERFORM 900-TBL-CLOSE-SEC
           END-IF
      *
           .
       4801-RJNCD-CHG-EXT.
           EXIT.
      *****************************************************************
      *    Ï·¿ÍÂÐ¾Ý´µ¼Ô¥Á¥§¥Ã¥¯
      *****************************************************************
       4801-RJN-TAISYO-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-RJN
      *
      *    Æþ±¡´µ¼Ô¤ÎÏ·¿ÍÊÝ¸±È½Äê
           MOVE    ZERO                TO   FLG-HKNCOMBI
           INITIALIZE              HKNCOMBI-REC
      *
           MOVE    SPA-HOSPID          TO   COMB-HOSPID
           MOVE    SPA-NAI-I01-PTID
                                       TO   COMB-PTID
           IF      SPA-GMN-I01-SYORIKBN-CD =   "07"  OR  "09"
               MOVE    WRK-TAIHI-HKN   TO   COMB-HKNCOMBINUM
           ELSE
               MOVE    SPA-GMN-I01-HKNCOMBI-CD
                                       TO   COMB-HKNCOMBINUM
           END-IF
           MOVE    HKNCOMBI-REC        TO   MCPDATA-REC
           MOVE    "HKNCOMBI-KEY"      TO   WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC 
           IF    ( FLG-DBRC    =   ZERO )
               MOVE    MCPDATA-REC
                                       TO   HKNCOMBI-REC
           ELSE
               MOVE    1               TO   FLG-HKNCOMBI
           END-IF
      *
           MOVE    "HKNCOMBI-KEY"      TO   WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    Æþ±¡´µ¼Ô¤ÎÇ¯Îð·×»»
           INITIALIZE ORCSAGECHKAREA
           MOVE    SPA-HOSPID          TO  AGECHK-HOSPID
           MOVE    SPA-NAI-I01-PTID
                                       TO  AGECHK-PTID
           MOVE    WRK-AGECHK-SRYYMD
                                       TO  AGECHK-SRYYMD
           MOVE    SPA-NAI-I01-BIRTHDAY
                                       TO  AGECHK-BIRTHDAY
           CALL    "ORCSAGECHK"        USING
                                           ORCSAGECHKAREA
           IF    ( AGECHK-RC       =   ZERO )
               CONTINUE
           ELSE
               INITIALIZE  ORCSAGECHKAREA
           END-IF
      *
      *    Ï·¿ÍÂÐ¾Ý´µ¼ÔÈ½Äê
           IF    ((FLG-HKNCOMBI     =   ZERO)    AND
                  (COMB-KOH1HKNNUM  =   "027"))      OR
                 ( AGECHK-NENREI   >=    75)         OR
                 ((AGECHK-NENREI   >=    70)     AND
                  (PTINF-BIRTHDAY  <=   "19320930")) OR
                  (AGECHK-ROUJIN    =    1)
               MOVE    1            TO  FLG-RJN
           END-IF
      *
      *    ´µ¼Ô¸øÈñ¾ðÊó¤«¤éÏ·¿ÍÊÝ·ò¤ÎÅÐÏ¿¥Á¥§¥Ã¥¯
           INITIALIZE                    PTKOHINF-REC
           MOVE    SPA-HOSPID       TO   PTKOH-HOSPID
           MOVE    SPA-NAI-I01-PTID TO   PTKOH-PTID
           MOVE    "027"            TO   PTKOH-KOHNUM
           MOVE    WRK-AGECHK-SRYYMD
                                    TO   PTKOH-TEKSTYMD
           MOVE    WRK-AGECHK-SRYYMD
                                    TO   PTKOH-TEKEDYMD
           MOVE    PTKOHINF-REC     TO   MCPDATA-REC
           MOVE    "PTKOHINF-KEY6"  TO   WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC 
           IF    ( FLG-DBRC    =   ZERO )
               MOVE    1            TO  FLG-RJN
           END-IF
           MOVE    "PTKOHINF-KEY6"  TO   WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       4801-RJN-TAISYO-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼Ô¾ðÊó¹¹¿·½èÍý
      *****************************************************************
       4801-PTINF-UPD-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-ZI-SAISIN
      *    Æþ±¡Îò¤è¤êºÇ¿·¤ÎÎò¾ðÊó¤ò¼èÆÀ
           INITIALIZE  PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY3"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
      *
           PERFORM UNTIL ( FLG-DBRC        NOT =   ZERO )
                   OR    ( FLG-ZI-SAISIN   NOT =   ZERO )
      *
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
      *
               IF    ( PTNYUINRRK-JTIKBN   =   "5" OR "6" )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-ZI-SAISIN
                   MOVE    PTNYUINRRK-RRKNUM
                                       TO  WRK-ZI-SAISIN-RRKNUM
                   MOVE    PTNYUINRRK-RRKEDANUM
                                       TO  WRK-ZI-SAISIN-RRKEDANUM
               END-IF
      *
               MOVE    "PTNYUINRRK-KEY3"   TO  WRK-DBPATH
               PERFORM 900-TBL-READ-SEC
           END-PERFORM
      *
           MOVE    "PTNYUINRRK-KEY3"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
      *    ´µ¼Ô¥Þ¥¹¥¿¸¡º÷
           MOVE    ZERO                TO  FLG-PTINF
           INITIALIZE  PTINF-REC
           MOVE    SPA-HOSPID          TO  PTINF-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTINF-PTID
           MOVE    PTINF-REC           TO  MCPDATA-REC
      *
           MOVE    "PTINF-KEY"         TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF     ( FLG-DBRC           =  ZERO )
               MOVE    MCPDATA-REC     TO  PTINF-REC
           ELSE
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
      *    ´µ¼Ô¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "PTINF-KEY"         TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( FLG-PTINF           NOT =   ZERO )
               MOVE    "4026"          TO  SPA-ERRCD
               GO  TO  4801-PTINF-UPD-EXT
           END-IF
      *
      *    ´µ¼Ô¾ðÊó¤ÎÆþ±¡ÎòÈÖ¹æ¤ò¹¹¿·¤¹¤ë
           IF    ( FLG-ZI-SAISIN       =   1 )
               MOVE   WRK-ZI-SAISIN-RRKNUM
                                       TO  PTINF-RRKNUM
               MOVE   WRK-ZI-SAISIN-RRKEDANUM
                                       TO  PTINF-RRKEDANUM
           ELSE
               MOVE    ZERO            TO  PTINF-RRKNUM
                                           PTINF-RRKEDANUM
           END-IF
      *
           PERFORM 800-MCNDATE-SEC
           MOVE    SMCNDATE-YMD        TO  PTINF-UPYMD
           MOVE    SMCNDATE-HMS        TO  PTINF-UPHMS
      *
      *    ´µ¼Ô¾ðÊó¹¹¿·
           MOVE    PTINF-REC           TO  MCPDATA-REC
           MOVE    "PTINF-KEY"         TO  WRK-DBPATH
           PERFORM 900-TBL-UPDATE-SEC
           IF     ( FLG-DBRC       NOT =  ZERO )
               MOVE    "4027"          TO  SPA-ERRCD
               GO  TO  4801-PTINF-UPD-EXT
           END-IF
      *
           .
       4801-PTINF-UPD-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¥Æ¡¼¥Ö¥ë¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       490-SRYACCT-CHK-SEC             SECTION.
      *
           MOVE    SPA-NAI-I01-TAIINYMD
                                       TO  WRK-TAIINYMD
      *
           MOVE    ZERO                TO  FLG-SRYACCT
      *
           INITIALIZE                      SRYACCT-REC
      *
           MOVE    SPA-HOSPID          TO  ACCT-HOSPID
           MOVE    "1"                 TO  ACCT-NYUGAIKBN
           MOVE    SPA-NAI-I01-PTID    TO  ACCT-PTID
           MOVE    WRK-TAIINYM         TO  ACCT-SRYYM
           MOVE    SRYACCT-REC         TO  MCPDATA-REC
           MOVE    "SRYACCT-KEY15"     TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC 
           IF    ( FLG-DBRC            NOT =   ZERO )
               MOVE    1               TO  FLG-SRYACCT
           END-IF
      *
           PERFORM UNTIL ( FLG-SRYACCT     NOT =   ZERO )
                   OR    ( SPA-I0IDCD      NOT =   SPACE )
      *
               MOVE    MCPDATA-REC     TO  SRYACCT-REC
      *
               IF    ( ACCT-SRYCDTOTAL =   120001110
                  OR                       120000410 )
                   CONTINUE
               ELSE
                   IF    ( WRK-TAIINYM     =   ACCT-SRYYM )
                       COMPUTE IDX14       =   WRK-TAIINDD +   1
                   ELSE
                       COMPUTE IDX14       =   1
                   END-IF
      *
                   PERFORM UNTIL ( IDX14               >   31 )
                           OR    ( SPA-I0IDCD      NOT =   SPACE )
      *
                       IF    ( ACCT-DAY (1 IDX14)      >   ZERO )
                           MOVE    "3004"          TO  SPA-I0IDCD
                       END-IF
      *
                       COMPUTE IDX14       =   IDX14   +   1
      *
                   END-PERFORM
               END-IF
      *
               IF    ( SPA-I0IDCD      =   SPACE )
                   MOVE    "SRYACCT-KEY15"     TO  WRK-DBPATH
                   PERFORM 900-TBL-READ-SEC 
                   IF    ( FLG-DBRC            NOT =   ZERO )
                       MOVE    1               TO  FLG-SRYACCT
                   END-IF
               END-IF
           END-PERFORM
      *
           MOVE    "SRYACCT-KEY15"     TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC 
      *
           .
       490-SRYACCT-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÉéÃ´¶â·×»»½èÍý
      *****************************************************************
       490-FTNKIN-CALC-SEC             SECTION.
      *
      *    ÄÌ»»Æü¿ô¤òµá¤á¤ë
           MOVE    WRK-FTN-NYUINYMD
                                   TO  WRK-STYMD
      *
      *    ÀÁµá³«»ÏÆü¡ÊÆþ±¡Æü¤Þ¤¿¤ÏÁ°²óÄê´üÀÁµá½ªÎ»Æü¤ÎÍâÆü¡Ë¤òÀßÄê
           MOVE    WRK-NOW-SKYSTYMD
                                   TO  WRK-EDYMD
           PERFORM 5002-KIKAN-CALC-SEC
           IF    ( FLG-ORCSDAY     NOT =   ZERO )
               MOVE    "2008"      TO  SPA-ERRCD
               GO  TO  490-FTNKIN-CALC-EXT
           END-IF
      *
           MOVE    SPACE           TO  LNK-ORCS02-REC
                                       LNK-SYUNOU-REC-T
                                       LNK-SYUDAY-REC-T
      *
           INITIALIZE                  LNK-ORCS02-REC
                                       LNK-SYUNOU-REC-T
                                       LNK-SYUDAY-REC-T
      *
           MOVE    SPA-HOSPID      TO  LNK-S02-HOSPID
           MOVE    "1"             TO  LNK-S02-NYUGAIKBN
           MOVE    SPA-NAI-I01-PTID
                                   TO  LNK-S02-PTID
           MOVE    WRK-NISSU1      TO  LNK-S02-NYUIN-TSUSAN-NISSU
      *
      *    ÀÁµá³«»ÏÆü¡ÊÆþ±¡Æü¡ÊÆ±ÆüºÆÆþ±¡¤Î¾ì¹ç¤ÏÆþ±¡ÆüÍâÆü¡Ë¤Þ¤¿¤Ï
      *    Á°²óÄê´üÀÁµá½ªÎ»Æü¤ÎÍâÆü¡Ë¤òÀßÄê
           MOVE    WRK-NOW-SKYSTYMD
                                       TO  LNK-S02-SKYSTYMD
           MOVE    WRK-FTN-TAIINYMD
                                   TO  LNK-S02-SKYEDYMD
           MOVE    SPA-SYSYMD      TO  LNK-S02-SYSYMD
           MOVE    "1"             TO  LNK-S02-SYORI-KBN
           CALL    "ORCSNYUFTN"    USING
                                   SPA-AREA
                                   LNK-ORCS02-REC
                                   LNK-SYUNOU-REC-T
                                   LNK-SYUDAY-REC-T
           IF    ( LNK-S02-RC      NOT = ZERO )
               EVALUATE LNK-S02-RC
               WHEN    13
                   MOVE    "2012"      TO  SPA-ERRCD
                   GO  TO  490-FTNKIN-CALC-EXT
               WHEN    OTHER
                   MOVE    "2008"      TO  SPA-ERRCD
                   GO  TO  490-FTNKIN-CALC-EXT
               END-EVALUATE
           END-IF
      *
           PERFORM VARYING IDX11   FROM    1   BY  1
                   UNTIL ( IDX11   >   10 )
      *
               DISPLAY "LNK-SYU-SKYMONEY (" IDX11" ) = "
                        LNK-SYU-SKYMONEY ( IDX11 )
      *
           END-PERFORM
      *    ¼ýÇ¼¥Ç¡¼¥¿ÂàÈò½èÍý
           PERFORM 490-SYUNOU-TAIHI-SEC
           IF    ( SPA-ERRCD       NOT =   SPACE )
               GO  TO  490-FTNKIN-CALC-EXT
           END-IF
      *
           .
       490-FTNKIN-CALC-EXT.
           EXIT.
      *****************************************************************
      *    ¼ýÇ¼¥Ç¡¼¥¿ÂàÈò½èÍý
      *****************************************************************
       490-SYUNOU-TAIHI-SEC            SECTION.
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¼èÆÀ
           PERFORM 490-HKNCOMBI-GET-SEC
      *
           INITIALIZE  SPA-I0-SYUNOU-TBL
           MOVE    LOW-VALUE       TO  WRK-SKYSTYM
           MOVE    SPACE           TO  SUMSYUNOU-REC
                                       TTLSYUNOU-REC
           INITIALIZE                  SUMSYUNOU-REC
                                       TTLSYUNOU-REC
                                       CNT-TUKISU
      *
           PERFORM VARYING IDX11   FROM    1   BY  1
                   UNTIL ( IDX11           >   10 )
                   OR    ( SUMSYUNOU-CNT    >=  13 )
                   OR    ( LNK-SYU-SKYSTYMD (IDX11)    =   SPACE )
      *
               IF    ( LNK-SYU-SKYSTYMD (IDX11) (1 : 6)
                                   NOT =   WRK-SKYSTYM )
      *
                   MOVE    LNK-SYU-SKYSTYMD (IDX11) (1 : 6)
                                   TO      WRK-SKYSTYM
                   COMPUTE SUMSYUNOU-CNT
                                       =   SUMSYUNOU-CNT +   1
                   MOVE    SUMSYUNOU-CNT
                                   TO  WRK-SYU-SUM-IDX
      *
                   MOVE    1       TO    SPA-I0-SYUNOU-TTLDAT-FLG
                                                 (WRK-SYU-SUM-IDX)
      *
                   MOVE    LNK-SYU-SKYSTYMD (IDX11)
                                   TO   WRK-YMD
                   PERFORM 5002-HIZUKE-CHK-SEC
                   MOVE    WRK-HENYMDG (1 : 6)
                           TO SPA-I0-SYUNOU-YM-W (WRK-SYU-SUM-IDX)
                   MOVE    WRK-SYMD    (1 : 6)
                           TO SPA-I0-SYUNOU-YM-S (WRK-SYU-SUM-IDX)
      *
                   MOVE    ZERO    TO    SPA-I0-SYUNOU-HKNCOMBI-SU
                                                 (WRK-SYU-SUM-IDX)
      *
                   COMPUTE CNT-TUKISU  =   CNT-TUKISU  +   1
      *
               END-IF
      *
               IF    ( SUMSYUNOU-CNT <   13 )
                   COMPUTE SUMSYUNOU-CNT    =   SUMSYUNOU-CNT +   1
      *
                   MOVE    0       TO    SPA-I0-SYUNOU-TTLDAT-FLG
                                                 (SUMSYUNOU-CNT)
      *
                   MOVE    SPA-I0-SYUNOU-YM-W (WRK-SYU-SUM-IDX)
                                       TO  SPA-I0-SYUNOU-YM-W
                                                 (SUMSYUNOU-CNT)
                   MOVE    SPA-I0-SYUNOU-YM-S (WRK-SYU-SUM-IDX)
                                       TO  SPA-I0-SYUNOU-YM-S
                                                 (SUMSYUNOU-CNT)
      *
      *            ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»Ì¾¾Î¼èÆÀ
                   MOVE    LNK-SYU-HKNCOMBINUM (IDX11)
                                           TO   WRK-ORCSHKN-HKNCOMBINUM
                   PERFORM 490-HKNCOMBI-EDIT-SEC
                   MOVE    WRK-HKNCOMBI
                                           TO  SPA-I0-SYUNOU-HKNCOMBI
                                                        (SUMSYUNOU-CNT)
      *
                   COMPUTE SPA-I0-SYUNOU-HKNCOMBI-SU (WRK-SYU-SUM-IDX)
                       =   SPA-I0-SYUNOU-HKNCOMBI-SU (WRK-SYU-SUM-IDX)
                       +   1
      *
                   MOVE    LNK-SYUNOU-REC (IDX11)
                                       TO  SUMSYUNOU-OCC (SUMSYUNOU-CNT)
                   MOVE    LNK-SYUDAY-REC (IDX11)
                                       TO  SUMSYUDAY-OCC (SUMSYUNOU-CNT)
      *            ÊÝ¸±ÎÁ
                   PERFORM VARYING     IDX12   FROM    1   BY  1
                           UNTIL       IDX12   >   12
                     COMPUTE SUMSYU-HKNTEN   (WRK-SYU-SUM-IDX IDX12)
                         =   SUMSYU-HKNTEN   (WRK-SYU-SUM-IDX IDX12)
                         +   LNK-SYU-HKNTEN (IDX11 IDX12)
                     COMPUTE TTLSYU-HKNTEN (IDX12)
                         =   TTLSYU-HKNTEN (IDX12)
                         +   LNK-SYU-HKNTEN (IDX11 IDX12)
      *
                     COMPUTE SUMSYU-TGMONEY   (WRK-SYU-SUM-IDX IDX12)
                         =   SUMSYU-TGMONEY   (WRK-SYU-SUM-IDX IDX12)
                         +   LNK-SYU-TGMONEY (IDX11 IDX12)
                     COMPUTE TTLSYU-TGMONEY  (IDX12)
                         =   TTLSYU-TGMONEY  (IDX12)
                         +   LNK-SYU-TGMONEY (IDX11 IDX12)
      *
                     COMPUTE SUMSYU-TGMONEY-TAX (WRK-SYU-SUM-IDX IDX12)
                         =   SUMSYU-TGMONEY-TAX (WRK-SYU-SUM-IDX IDX12)
                         +   LNK-SYU-TGMONEY-TAX (IDX11 IDX12)
                     COMPUTE TTLSYU-TGMONEY-TAX  (IDX12)
                         =   TTLSYU-TGMONEY-TAX  (IDX12)
                         +   LNK-SYU-TGMONEY-TAX (IDX11 IDX12)
                   END-PERFORM
      *
      *            ÊÝ¸±Å¬ÍÑ¶â³Û
                   COMPUTE SUMSYU-HKNTEKMONEY   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-HKNTEKMONEY   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-HKNTEKMONEY (IDX11)
                   COMPUTE TTLSYU-HKNTEKMONEY
                       =   TTLSYU-HKNTEKMONEY
                       +   LNK-SYU-HKNTEKMONEY (IDX11)
      *
      *            Ï·¿Í°ìÉôÉéÃ´¶â
                   COMPUTE SUMSYU-RJN-FTN    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-RJN-FTN    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-RJN-FTN  (IDX11)
                   COMPUTE TTLSYU-RJN-FTN
                       =   TTLSYU-RJN-FTN
                       +   LNK-SYU-RJN-FTN  (IDX11)
      *
      *            ¸øÈñ°ìÉôÉéÃ´¶â
                   COMPUTE SUMSYU-KOH-FTN    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-KOH-FTN    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-KOH-FTN  (IDX11)
                   COMPUTE TTLSYU-KOH-FTN
                       =   TTLSYU-KOH-FTN
                       +   LNK-SYU-KOH-FTN  (IDX11)
      *
      *            ¼«Èñ
                   COMPUTE SUMSYU-JIHI-1   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-1   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-1 (IDX11)
                   COMPUTE TTLSYU-JIHI-1
                       =   TTLSYU-JIHI-1
                       +   LNK-SYU-JIHI-1 (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-2   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-2   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-2 (IDX11)
                   COMPUTE TTLSYU-JIHI-2
                       =   TTLSYU-JIHI-2
                       +   LNK-SYU-JIHI-2 (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-3   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-3   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-3 (IDX11)
                   COMPUTE TTLSYU-JIHI-3
                       =   TTLSYU-JIHI-3
                       +   LNK-SYU-JIHI-3 (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-4   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-4   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-4 (IDX11)
                   COMPUTE TTLSYU-JIHI-4
                       =   TTLSYU-JIHI-4
                       +   LNK-SYU-JIHI-4 (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-5   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-5   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-5 (IDX11)
                   COMPUTE TTLSYU-JIHI-5
                       =   TTLSYU-JIHI-5
                       +   LNK-SYU-JIHI-5 (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-6   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-6   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-6 (IDX11)
                   COMPUTE TTLSYU-JIHI-6
                       =   TTLSYU-JIHI-6
                       +   LNK-SYU-JIHI-6 (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-7   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-7   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-7 (IDX11)
                   COMPUTE TTLSYU-JIHI-7
                       =   TTLSYU-JIHI-7
                       +   LNK-SYU-JIHI-7 (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-8   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-8   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-8 (IDX11)
                   COMPUTE TTLSYU-JIHI-8
                       =   TTLSYU-JIHI-8
                       +   LNK-SYU-JIHI-8 (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-9   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-9   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-9 (IDX11)
                   COMPUTE TTLSYU-JIHI-9
                       =   TTLSYU-JIHI-9
                       +   LNK-SYU-JIHI-9 (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-10  (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-10  (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-10 (IDX11)
                   COMPUTE TTLSYU-JIHI-10
                       =   TTLSYU-JIHI-10
                       +   LNK-SYU-JIHI-5 (IDX11)
      *
      *            ¼«Èñ·×
                   COMPUTE SUMSYU-JIHI-TOTAL   (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-TOTAL   (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-TOTAL (IDX11)
                   COMPUTE TTLSYU-JIHI-TOTAL
                       =   TTLSYU-JIHI-TOTAL
                       +   LNK-SYU-JIHI-TOTAL (IDX11)
      *
      *            ¼«Èñ¡Ê¾ÃÈñÀÇ¤¢¤ê¡Ë
                   COMPUTE SUMSYU-JIHI-1-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-1-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-1-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-1-TAX
                       =   TTLSYU-JIHI-1-TAX
                       +   LNK-SYU-JIHI-1-TAX  (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-2-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-2-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-2-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-2-TAX
                       =   TTLSYU-JIHI-2-TAX
                       +   LNK-SYU-JIHI-2-TAX  (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-3-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-3-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-3-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-3-TAX
                       =   TTLSYU-JIHI-3-TAX
                       +   LNK-SYU-JIHI-3-TAX  (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-4-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-4-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-4-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-4-TAX
                       =   TTLSYU-JIHI-4-TAX
                       +   LNK-SYU-JIHI-4-TAX  (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-5-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-5-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-5-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-5-TAX
                       =   TTLSYU-JIHI-5-TAX
                       +   LNK-SYU-JIHI-5-TAX  (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-6-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-6-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-6-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-6-TAX
                       =   TTLSYU-JIHI-6-TAX
                       +   LNK-SYU-JIHI-6-TAX  (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-7-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-7-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-7-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-7-TAX
                       =   TTLSYU-JIHI-7-TAX
                       +   LNK-SYU-JIHI-7-TAX  (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-8-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-8-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-8-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-8-TAX
                       =   TTLSYU-JIHI-8-TAX
                       +   LNK-SYU-JIHI-8-TAX  (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-9-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-9-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-9-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-9-TAX
                       =   TTLSYU-JIHI-9-TAX
                       +   LNK-SYU-JIHI-9-TAX  (IDX11)
      *
                   COMPUTE SUMSYU-JIHI-10-TAX    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-10-TAX    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-10-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-10-TAX
                       =   TTLSYU-JIHI-10-TAX
                       +   LNK-SYU-JIHI-10-TAX  (IDX11)
      *
      *            ¼«Èñ·×¡Ê¾ÃÈñÀÇ¤¢¤ê¡Ë
                   COMPUTE SUMSYU-JIHI-TOTAL-TAX (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-TOTAL-TAX (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-TOTAL-TAX (IDX11)
                   COMPUTE TTLSYU-JIHI-TOTAL-TAX
                       =   TTLSYU-JIHI-TOTAL-TAX
                       +   LNK-SYU-JIHI-TOTAL-TAX (IDX11)
      *
      *            ¼«Èñ¾ÃÈñÀÇ
                   COMPUTE SUMSYU-JIHI-TAX  (WRK-SYU-SUM-IDX)
                       =   SUMSYU-JIHI-TAX  (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-JIHI-TAX  (IDX11)
                   COMPUTE TTLSYU-JIHI-TAX
                       =   TTLSYU-JIHI-TAX
                       +   LNK-SYU-JIHI-TAX  (IDX11)
      *
      *            Ï«ºÒ½é¿Ç
                   COMPUTE SUMSYU-RSISHOSHIN-MONEY (WRK-SYU-SUM-IDX)
                       =   SUMSYU-RSISHOSHIN-MONEY (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-RSISHOSHIN-MONEY (IDX11)
                   COMPUTE TTLSYU-RSISHOSHIN-MONEY
                       =   TTLSYU-RSISHOSHIN-MONEY
                       +   LNK-SYU-RSISHOSHIN-MONEY (IDX11)
      *
      *            Ï«ºÒºÆ¿Ç
                   COMPUTE SUMSYU-RSISAISHIN-MONEY (WRK-SYU-SUM-IDX)
                       =   SUMSYU-RSISAISHIN-MONEY (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-RSISAISHIN-MONEY (IDX11)
                   COMPUTE TTLSYU-RSISAISHIN-MONEY
                       =   TTLSYU-RSISAISHIN-MONEY
                       +   LNK-SYU-RSISAISHIN-MONEY (IDX11)
      *
      *            Ï«ºÒ»ØÆ³
                   COMPUTE SUMSYU-RSISDO-MONEY  (WRK-SYU-SUM-IDX)
                       =   SUMSYU-RSISDO-MONEY  (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-RSISDO-MONEY (IDX11)
                   COMPUTE TTLSYU-RSISDO-MONEY
                       =   TTLSYU-RSISDO-MONEY
                       +   LNK-SYU-RSISDO-MONEY (IDX11)
      *
      *            Ï«ºÒ¤½¤ÎÂ¾
                   COMPUTE SUMSYU-RSIETC-MONEY (WRK-SYU-SUM-IDX)
                       =   SUMSYU-RSIETC-MONEY (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-RSIETC-MONEY (IDX11)
                   COMPUTE TTLSYU-RSIETC-MONEY
                       =   TTLSYU-RSIETC-MONEY
                       +   LNK-SYU-RSIETC-MONEY (IDX11)
      *
      *            ¿©»öÎÅÍÜÈñ¡ÊÊÝ¸±¡Ë
                   COMPUTE SUMSYU-RYOYOHI-SKJ (WRK-SYU-SUM-IDX)
                       =   SUMSYU-RYOYOHI-SKJ (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-RYOYOHI-SKJ (IDX11)
                   COMPUTE TTLSYU-RYOYOHI-SKJ
                       =   TTLSYU-RYOYOHI-SKJ
                       +   LNK-SYU-RYOYOHI-SKJ (IDX11)
      *
      *            ¿©»öÉéÃ´³Û¡ÊÊÝ¸±¡§¼«¸ÊÉéÃ´¡Ë
                   COMPUTE SUMSYU-SKYMONEY-SKJ (WRK-SYU-SUM-IDX)
                       =   SUMSYU-SKYMONEY-SKJ (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-SKYMONEY-SKJ (IDX11)
                   COMPUTE TTLSYU-SKYMONEY-SKJ
                       =   TTLSYU-SKYMONEY-SKJ
                       +   LNK-SYU-SKYMONEY-SKJ (IDX11)
      *
      *            ¿©»öÉéÃ´³Û¡ÊÊÝ¸±¡§¼«¸ÊÉéÃ´¾ÃÈñÀÇ¡Ë
                   COMPUTE SUMSYU-SKYMONEY-SKJ-TAX (WRK-SYU-SUM-IDX)
                       =   SUMSYU-SKYMONEY-SKJ-TAX (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-SKYMONEY-SKJ-TAX (IDX11)
                   COMPUTE TTLSYU-SKYMONEY-SKJ-TAX
                       =   TTLSYU-SKYMONEY-SKJ-TAX
                       +   LNK-SYU-SKYMONEY-SKJ-TAX (IDX11)
      *
      *            ¿©»öÉéÃ´³Û¡ÊÊÝ¸±¡§¼«¸ÊÉéÃ´¹ç·×¡Ë
                   COMPUTE SUMSYU-SKYMONEY-SKJ-KEI (WRK-SYU-SUM-IDX)
                       =   SUMSYU-SKYMONEY-SKJ-KEI (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-SKYMONEY-SKJ-KEI (IDX11)
                   COMPUTE TTLSYU-SKYMONEY-SKJ-KEI
                       =   TTLSYU-SKYMONEY-SKJ-KEI
                       +   LNK-SYU-SKYMONEY-SKJ-KEI (IDX11)
      *
      *            ¿©»öÎÅÍÜÈñ¡Ê¼«Èñ¡Ë
                   COMPUTE SUMSYU-RYOYOHI-SKJ-JIHI (WRK-SYU-SUM-IDX)
                       =   SUMSYU-RYOYOHI-SKJ-JIHI (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-RYOYOHI-SKJ-JIHI (IDX11)
                   COMPUTE TTLSYU-RYOYOHI-SKJ-JIHI
                       =   TTLSYU-RYOYOHI-SKJ-JIHI
                       +   LNK-SYU-RYOYOHI-SKJ-JIHI (IDX11)
      *
      *            ¿©»öÉéÃ´³Û¡Ê¼«Èñ¡§¼«¸ÊÉéÃ´¡Ë
                   COMPUTE SUMSYU-SKYMONEY-SKJ-JIHI (WRK-SYU-SUM-IDX)
                       =   SUMSYU-SKYMONEY-SKJ-JIHI (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-SKYMONEY-SKJ-JIHI (IDX11)
                   COMPUTE TTLSYU-SKYMONEY-SKJ-JIHI
                       =   TTLSYU-SKYMONEY-SKJ-JIHI
                       +   LNK-SYU-SKYMONEY-SKJ-JIHI (IDX11)
      *
      *            ¿©»öÉéÃ´³Û¡Ê¼«Èñ¡§¼«¸ÊÉéÃ´¾ÃÈñÀÇ¡Ë
                   COMPUTE SUMSYU-SKYMONEY-SKJ-JIHI-TAX
                                                    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-SKYMONEY-SKJ-JIHI-TAX
                                                    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-SKYMONEY-SKJ-JIHI-TAX (IDX11)
                   COMPUTE TTLSYU-SKYMONEY-SKJ-JIHI-TAX
                       =   TTLSYU-SKYMONEY-SKJ-JIHI-TAX
                       +   LNK-SYU-SKYMONEY-SKJ-JIHI-TAX (IDX11)
      *
      *            ¿©»öÉéÃ´³Û¡Ê¼«Èñ¡§¼«¸ÊÉéÃ´¹ç·×¡Ë
                   COMPUTE SUMSYU-SKYMONEY-SKJ-JIHI-KEI
                                                    (WRK-SYU-SUM-IDX)
                       =   SUMSYU-SKYMONEY-SKJ-JIHI-KEI
                                                    (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-SKYMONEY-SKJ-JIHI-KEI (IDX11)
                   COMPUTE TTLSYU-SKYMONEY-SKJ-JIHI-KEI
                       =   TTLSYU-SKYMONEY-SKJ-JIHI-KEI
                       +   LNK-SYU-SKYMONEY-SKJ-JIHI-KEI (IDX11)
      *
      *            ¼¼ÎÁº¹³Û
                   COMPUTE SUMSYU-RMSAGAKU (WRK-SYU-SUM-IDX)
                       =   SUMSYU-RMSAGAKU (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-RMSAGAKU (IDX11)
                   COMPUTE TTLSYU-RMSAGAKU
                       =   TTLSYU-RMSAGAKU
                       +   LNK-SYU-RMSAGAKU (IDX11)
      *
      *            ÀÁµá¶â³Û
                   COMPUTE SUMSYU-SKYMONEY (WRK-SYU-SUM-IDX)
                       =   SUMSYU-SKYMONEY (WRK-SYU-SUM-IDX)
                       +   LNK-SYU-SKYMONEY (IDX11)
                   COMPUTE TTLSYU-SKYMONEY
                       =   TTLSYU-SKYMONEY
                       +   LNK-SYU-SKYMONEY (IDX11)
      *
               END-IF
      *
           END-PERFORM
      *
      *    ¥¼¥í·ï¤Î¾ì¹ç¤Ï¥¨¥é¡¼¤È¤¹¤ë
           IF    ( SUMSYUNOU-CNT    <=  ZERO )
               MOVE    "2008"      TO  SPA-ERRCD
               GO  TO  490-SYUNOU-TAIHI-EXT
           END-IF
      *
           COMPUTE SUMSYUNOU-CNT    =   SUMSYUNOU-CNT +   1
      *
      *    ¥Æ¡¼¥Ö¥ëºÇÂç·ï¿ô¥ª¡¼¥Ð¡¼»þ¤Ï¥¨¥é¡¼¤È¤¹¤ë
           IF    ( SUMSYUNOU-CNT    >   13 )
               MOVE    "2008"      TO  SPA-ERRCD
               GO  TO  490-SYUNOU-TAIHI-EXT
           END-IF
      *
      *
           MOVE    SUMSYUNOU-CNT    TO  SPA-I0-SYUNOU-CNT
      *
           MOVE    2               TO  SPA-I0-SYUNOU-TTLDAT-FLG
                                                   (SUMSYUNOU-CNT)
           MOVE    "999999"        TO  SPA-I0-SYUNOU-YM-S
                                                   (SUMSYUNOU-CNT)
           MOVE    "999999"        TO  SPA-I0-SYUNOU-YM-W
                                                   (SUMSYUNOU-CNT)
           MOVE    CNT-TUKISU      TO  SPA-I0-SYUNOU-TUKI-SU
                                                   (SUMSYUNOU-CNT)
           MOVE    TTLSYUNOU-REC   TO  SUMSYUNOU-OCC (SUMSYUNOU-CNT)
      *
           PERFORM VARYING IDX11   FROM    1   BY  1
                   UNTIL ( IDX11   >   SPA-I0-SYUNOU-CNT )
      *
               MOVE    SUMSYUNOU-OCC (IDX11)
                                   TO  SPA-I0-SYUNOU-DAT (IDX11)
               MOVE    SUMSYUDAY-OCC (IDX11)
                                   TO  SPA-I0-SYUDAY-DAT (IDX11)
      *
           END-PERFORM
      *
           .
       490-SYUNOU-TAIHI-EXT.
           EXIT.
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¼èÆÀ½èÍý
      *****************************************************************
       490-HKNCOMBI-GET-SEC            SECTION.
      *
           INITIALIZE                  SPA-KYOTUKEY
                                       SPA-KYOTU-SET
                                       ORCSHKNSETAREA
      *
           MOVE    SPA-SYSYMD          TO  SPA-SRYYMD
           MOVE    "1"                 TO  SPA-NYUGAIKBN
           MOVE    SPA-NAI-I01-PTID    TO  SPA-PTID
           MOVE    SPA-NAI-I01-BIRTHDAY
                                       TO  SPA-BIRTHDAY
           MOVE    "2"                 TO  ORCSHKN-KBN
      *
           CALL    "ORCSHKNSET"        USING   SPA-AREA
                                               ORCSHKNSETAREA
           IF    ( ORCSHKN-ERRCD   NOT =   ZERO )
               INITIALIZE              ORCSHKNSETAREA
               GO  TO  490-HKNCOMBI-GET-EXT
           END-IF
      *
           .
       490-HKNCOMBI-GET-EXT.
           EXIT.
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»ÊÔ½¸½èÍý
      *****************************************************************
       490-HKNCOMBI-EDIT-SEC           SECTION.
      *
           MOVE    SPACE                   TO  WRK-HKNCOMBI
           PERFORM VARYING IDX15   FROM 1  BY  1
                   UNTIL ( IDX15   >   ORCSHKN-HKN-MAX )
                     OR  ( IDX15   >   100 )
      *
               IF    ( ORCSHKN-GMN-HKNCOMBINUM (IDX15)
                                   =   WRK-ORCSHKN-HKNCOMBINUM )
                   MOVE    ORCSHKN-GMN-HKNCOMBIMEI (IDX15)
                                           TO  WRK-HKNCOMBI
                   MOVE    ORCSHKN-HKN-MAX TO  IDX15
               END-IF
      *
           END-PERFORM
      *
           .
       490-HKNCOMBI-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá³ÎÇ§²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       490-SYUNOU-SUM-SEC              SECTION.
      *
      *
       490-SYUNOU-SUM-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡½èÍý
      *****************************************************************
       490-TAIIN-SYORI-SEC             SECTION.
      *
      *    ÉéÃ´¶â·×»»½èÍý
           MOVE    SPA-NAI-I01-NYUINYMD    TO  WRK-FTN-NYUINYMD
           MOVE    SPA-NAI-I01-TAIINYMD    TO  WRK-FTN-TAIINYMD
           MOVE    SPA-NAI-I01-DJKBN       TO  WRK-FTN-DJKBN
           PERFORM 490-FTNKIN-CALC-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  490-TAIIN-SYORI-EXT
           END-IF
      *
      *    ÀÁµá³ÎÇ§²èÌÌÁ«°Ü½èÍý
           MOVE    "1"             TO  WRK-I01-I04-PROCKBN
           PERFORM 490-I04-SENI-SEC
           .
      *
       490-TAIIN-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡½èÍý
      *****************************************************************
       490-TAIIN-SAIKEISAN-SYORI-SEC   SECTION.
      *
      *    ÀÁµá³«»ÏÆü¼èÆÀ½èÍý
           MOVE    SPA-NAI-I01-TNYUINYMD (IDX1)
                                           TO  WRK-FTN-NYUINYMD
           MOVE    SPA-NAI-I01-TRRKNUM (IDX1)
                                           TO  WRK-FTN-RRKNUM
           MOVE    SPA-NAI-I01-TDJKBN (IDX1)
                                           TO  WRK-FTN-DJKBN
           PERFORM 4901-SKYSTYMD-GET-SEC
      *
      *    ÉéÃ´¶â·×»»½èÍý
           MOVE    SPA-NAI-I01-TNYUINYMD (IDX1)
                                           TO  WRK-FTN-NYUINYMD
           MOVE    SPA-NAI-I01-TTAIINYMD (IDX1)
                                           TO  WRK-FTN-TAIINYMD
           PERFORM 490-FTNKIN-CALC-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  490-TAIIN-SAIKEISAN-SYORI-EXT
           END-IF
      *
      *    ÀÁµá³ÎÇ§²èÌÌÁ«°Ü½èÍý
           MOVE    "2"             TO  WRK-I01-I04-PROCKBN
           PERFORM 490-I04-SENI-SEC
           .
      *
       490-TAIIN-SAIKEISAN-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá³ÎÇ§²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       490-I04-SENI-SEC                SECTION.
      *
           INITIALIZE  SPA-I01-I04-AREA
           MOVE    WRK-I01-I04-PROCKBN TO  SPA-I01-I04-PROCKBN
           IF    ( WRK-I01-I04-PROCKBN =   "1" )
               MOVE    SPA-NAI-I01-PTRRKNUM
                                           TO  SPA-I01-I04-RRKNUM
               MOVE    SPA-NAI-I01-PTRRKEDANUM
                                           TO  SPA-I01-I04-RRKEDANUM
               MOVE    SPA-NAI-I01-MAEIDOYMD
                                           TO  SPA-I01-I04-KJNYMD
               MOVE    SPA-GMN-I01-HKNCOMBI-CD
                                           TO  SPA-I01-I04-HKNCOMBI
               MOVE    SPA-GMN-I01-NYUINKA-CD
                                           TO  SPA-I01-I04-NYUINKA
               MOVE    SPA-NAI-I01-NYUINYMD
                                           TO  SPA-I01-I04-NYUINYMD
               MOVE    SPA-NAI-I01-TAIINYMD
                                           TO  SPA-I01-I04-TAIINYMD
               MOVE    SPA-GMN-I01-TAIINCD
                                           TO  SPA-I01-I04-TAIINCD
               MOVE    WRK-NOW-SKYSTYMD    TO  SPA-I01-I04-SKYSTYMD
               MOVE    SPA-NAI-I01-TAIINYMD
                                           TO  SPA-I01-I04-SKYEDYMD
               MOVE    SPA-NAI-I01-TORIKESI-FLG
                                           TO  SPA-I01-I04-TORIKESI-FLG
           ELSE
               PERFORM 4901-PTNYUINRRK-SEL-SEC
               MOVE    PTNYUINRRK-RRKNUM   TO  SPA-I01-I04-RRKNUM
               MOVE    PTNYUINRRK-RRKEDANUM
                                           TO  SPA-I01-I04-RRKEDANUM
               MOVE    PTNYUINRRK-TENNYUYMD
                                           TO  SPA-I01-I04-KJNYMD
               MOVE    PTNYUINRRK-HKNCOMBINUM
                                           TO  SPA-I01-I04-HKNCOMBI
               MOVE    PTNYUINRRK-NYUINKA  TO  SPA-I01-I04-NYUINKA
               MOVE    PTNYUINRRK-NYUINYMD TO  SPA-I01-I04-NYUINYMD
               MOVE    PTNYUINRRK-TAIINYMD TO  SPA-I01-I04-TAIINYMD
               MOVE    PTNYUINRRK-TAIINCD  TO  SPA-I01-I04-TAIINCD
      *
               MOVE    WRK-NOW-SKYSTYMD    TO  SPA-I01-I04-SKYSTYMD
      *
               MOVE    PTNYUINRRK-TAIINYMD TO  SPA-I01-I04-SKYEDYMD
           END-IF
      *
           MOVE    "I01"               TO  SPA-MOTOPG
           MOVE    "I04"               TO  SPA-SAKIPG
      *
           MOVE   WRK-MCP-PUTTYPE      TO  MCP-PUTTYPE
           MOVE   SPA-SAKIPG           TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
      *
       490-I04-SENI-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÍúÎò¸¡º÷½èÍý¡ÊÂà±¡ºÆ·×»»½èÍý¡Ë
      *****************************************************************
       4901-PTNYUINRRK-SEL-SEC         SECTION.
      *
           INITIALIZE                      PTNYUINRRK-REC
           MOVE    SPA-HOSPID          TO  PTNYUINRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTNYUINRRK-PTID
           MOVE    SPA-NAI-I01-TRRKNUM (SPA-GMN-I01-NYUREKILST-SEL)
                                       TO  PTNYUINRRK-RRKNUM
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "PTNYUINRRK-KEY4"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC            =   ZERO )
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
           ELSE
               INITIALIZE                  PTNYUINRRK-REC
           END-IF
      *
           MOVE    "PTNYUINRRK-KEY4"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
           .
      *
       4901-PTNYUINRRK-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá³«»ÏÆü¼èÆÀ½èÍý¡ÊÂà±¡ºÆ·×»»½èÍý¡Ë
      *****************************************************************
       4901-SKYSTYMD-GET-SEC           SECTION.
      *
           MOVE    SPACE               TO  WRK-NOW-SKYSTYMD
      *
           INITIALIZE                      PTTEIKIRRK-REC
           MOVE    SPA-HOSPID          TO  PTTEIKIRRK-HOSPID
           MOVE    SPA-NAI-I01-PTID    TO  PTTEIKIRRK-PTID
           MOVE    WRK-FTN-RRKNUM      TO  PTTEIKIRRK-RRKNUM
           MOVE    PTTEIKIRRK-REC      TO  MCPDATA-REC
           MOVE    "PTTEIKIRRK-KEY7"   TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC            =   ZERO )
               MOVE    MCPDATA-REC     TO  PTTEIKIRRK-REC
               MOVE    PTTEIKIRRK-SKYEDYMD
                                       TO  WRK-YMD
               MOVE    "1"             TO  WRK-ZOGENPTN
               MOVE    1               TO  WRK-ZOGEN
               PERFORM 5002-CALENDAR-SEC
               MOVE    WRK-KEISANYMD   TO  WRK-NOW-SKYSTYMD
           END-IF
      *
           MOVE    "PTTEIKIRRK-KEY7"   TO  WRK-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           IF    ( WRK-NOW-SKYSTYMD    =   SPACE )
               MOVE    WRK-FTN-NYUINYMD
                                       TO  WRK-NOW-SKYSTYMD
               IF    ( WRK-FTN-DJKBN   =   "1" )
                   MOVE    WRK-FTN-NYUINYMD
                                       TO  WRK-YMD
                   MOVE    "1"         TO  WRK-ZOGENPTN
                   MOVE    1           TO  WRK-ZOGEN
                   PERFORM 5002-CALENDAR-SEC
                   MOVE    WRK-KEISANYMD
                                       TO  WRK-NOW-SKYSTYMD
               END-IF
           END-IF
      *
           .
       4901-SKYSTYMD-GET-EXT.
           EXIT.
      *****************************************************************
      *    ¼«²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-SET-SCREEN              SECTION.
      *
           PERFORM 500-GMNHEN-SEC
      *
           IF    ( SPA-ERRCD       NOT =   SPACE )
               PERFORM 510-ERRSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           IF    ( SPA-I0IDCD      NOT =   SPACE )
               PERFORM 520-I0IDSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           IF    ( SPA-I0IDCD2 NOT =   SPACE )
               PERFORM 520-I0ID2SET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           MOVE    "CURRENT"           TO  MCP-PUTTYPE.
           MOVE    "I01    "           TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
           .
       500-SET-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÆâÍÆÊÔ½¸½èÍý
      *****************************************************************
       500-GMNHEN-SEC              SECTION.
      *
      *    ´µ¼ÔÈÖ¹æ
           MOVE    SPA-GMN-I01-PTNUM       TO  I01-PTNUM
      *    ´µ¼Ô»áÌ¾
           MOVE    SPA-GMN-I01-NAME        TO  I01-NAME
      *    ´µ¼ÔÀ­ÊÌ
           MOVE    SPA-GMN-I01-SEX         TO  I01-SEX
      *    ´µ¼ÔÃÂÀ¸Æü
           MOVE    SPA-GMN-I01-BIRTHDAY    TO  I01-BIRTHDAY
      *    ´µ¼ÔÇ¯Îð
           MOVE    SPA-GMN-I01-AGE         TO  I01-AGE
      *    ½èÍý¶èÊ¬
           MOVE    SPA-GMN-I01-SYORIKBN    TO  I01-SYORIKBN
           MOVE    SPA-GMN-I01-SYORIKBN-CNT
                                           TO  I01-SYORIKBN-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-SYORIKBN-CNT )
               MOVE    SPA-GMN-I01-SYORIKBN-ITM (IDX1)
                                           TO  I01-SYORIKBN-ITM (IDX1)
           END-PERFORM
      *
      *    °ÛÆ°Æü
           MOVE    SPA-GMN-I01-IDOYMD      TO  I01-IDOYMD
      *
      *    Á°²ó°ÛÆ°Æü
           MOVE    SPA-GMN-I01-MAEIDOYMD   TO  I01-MAEIDOYMD
      *
      *    ÉÂ¼¼ÈÖ¹æ
           MOVE    SPA-GMN-I01-BRMNUM      TO  I01-BRMNUM
      *    ÉÂÅïÌ¾
           MOVE    SPA-GMN-I01-BTUNAME     TO  I01-BTUNAME
           MOVE    SPA-GMN-I01-BTUNAME-CNT TO  I01-BTUNAME-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-BTUNAME-CNT )
               MOVE    SPA-GMN-I01-BTUNAME-ITM (IDX1)
                                           TO  I01-BTUNAME-ITM (IDX1)
           END-PERFORM
      *
      *    ¼¼ÎÁº¹³Û
           MOVE    SPA-GMN-I01-SAGAKU      TO  I01-SAGAKU
           MOVE    SPA-GMN-I01-SAGAKU-CNT  TO  I01-SAGAKU-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-SAGAKU-CNT )
               MOVE    SPA-GMN-I01-SAGAKU-ITM (IDX1)
                                           TO  I01-SAGAKU-ITM (IDX1)
           END-PERFORM
      *
      *    Æþ±¡Æü
           MOVE    SPA-GMN-I01-NYUINYMD    TO  I01-NYUINYMD
      *    Æþ±¡²Ê
           MOVE    SPA-GMN-I01-NYUINKA     TO  I01-NYUINKA
           MOVE    SPA-GMN-I01-NYUINKA-CNT TO  I01-NYUINKA-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-NYUINKA-CNT )
               MOVE    SPA-GMN-I01-NYUINKA-ITM (IDX1)
                                           TO  I01-NYUINKA-ITM (IDX1)
           END-PERFORM
      *
      *    ½é²ó
           MOVE    SPA-GMN-I01-SHOKAI      TO  I01-SHOKAI
           MOVE    SPA-GMN-I01-SHOKAI-CNT  TO  I01-SHOKAI-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-SHOKAI-CNT )
               MOVE    SPA-GMN-I01-SHOKAI-ITM (IDX1)
                                           TO  I01-SHOKAI-ITM (IDX1)
           END-PERFORM
      *
      *    ½é²óÈÖ¹æ
           MOVE    SPA-GMN-I01-SHONUM      TO  I01-SHONUM
      *
      *    ½é²óÆþ±¡Æü
           MOVE    SPA-GMN-I01-LBL-SHONYUINYMD
                                           TO  I01-LBL-SHONYUINYMD
      *
      *    Âà±¡Æü
           MOVE    SPA-GMN-I01-TAIINYMD    TO  I01-TAIINYMD
      *
      *    Âà±¡»öÍ³
           MOVE    SPA-GMN-I01-TAIINCD     TO  I01-TAIINCD
           MOVE    SPA-GMN-I01-TAIINCD-CNT TO  I01-TAIINCD-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-TAIINCD-CNT )
               MOVE    SPA-GMN-I01-TAIINCD-ITM (IDX1)
                                           TO  I01-TAIINCD-ITM (IDX1)
           END-PERFORM
      *
      *    Ã´Åö°å
           PERFORM VARYING IDX1   FROM     1   BY  1
               UNTIL     ( IDX1   >    3   )
               MOVE    SPA-GMN-I01-DR (IDX1)
                                           TO  I01-DR (IDX1)
               MOVE    SPA-GMN-I01-DR-CNT (IDX1)
                                           TO  I01-DR-CNT (IDX1)
                                               WRK-CNT
               PERFORM VARYING IDX2   FROM     1   BY  1
                   UNTIL     ( IDX2   >    WRK-CNT )
                   MOVE    SPA-GMN-I01-DR-ITM (IDX1 IDX2)
                                   TO  I01-DR-ITM (IDX1 IDX2)
               END-PERFORM
           END-PERFORM
      *
      *    ÊÝ¸±ÁÈ¹ç¤ï¤»
           MOVE    SPA-GMN-I01-HKNCOMBI    TO  I01-HKNCOMBI
           MOVE    SPA-GMN-I01-HKNCOMBI-CNT
                                           TO  I01-HKNCOMBI-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-HKNCOMBI-CNT   )
               MOVE    SPA-GMN-I01-HKNCOMBI-ITM (IDX1)
                                           TO  I01-HKNCOMBI-ITM (IDX1)
           END-PERFORM
      *
      *    ÆÃÄêÆþ±¡ÎÁ
           MOVE    SPA-GMN-I01-TOKNYUIN    TO  I01-TOKNYUIN
           MOVE    SPA-GMN-I01-TOKNYUIN-CNT
                                           TO  I01-TOKNYUIN-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-TOKNYUIN-CNT   )
               MOVE    SPA-GMN-I01-TOKNYUIN-ITM (IDX1)
                                           TO  I01-TOKNYUIN-ITM (IDX1)
           END-PERFORM
      *
      *    »»ÄêÆþ±¡ÎÁ
           MOVE    SPA-GMN-I01-SNTNYUIN    TO  I01-SNTNYUIN
      *
      *    Á°¼õ¤±¶â
           MOVE    SPA-GMN-I01-MAEUKE      TO  I01-MAEUKE
      *
      *    Äê´üÀÁµá
           MOVE    SPA-GMN-I01-SEIKYU      TO  I01-SEIKYU
           MOVE    SPA-GMN-I01-SEIKYU-CNT  TO  I01-SEIKYU-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-SEIKYU-CNT   )
               MOVE    SPA-GMN-I01-SEIKYU-ITM (IDX1)
                                           TO  I01-SEIKYU-ITM (IDX1)
           END-PERFORM
      *
      *    ¸¡º÷»þ´µ¼ÔÉ½¼¨
           MOVE    SPA-GMN-I01-DISPKBN     TO  I01-DISPKBN
           MOVE    SPA-GMN-I01-DISPKBN-CNT TO  I01-DISPKBN-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   SPA-GMN-I01-DISPKBN-CNT   )
               MOVE    SPA-GMN-I01-DISPKBN-ITM (IDX1)
                                           TO  I01-DISPKBN-ITM (IDX1)
           END-PERFORM
      *
      *    ÁªÂòÈÖ¹æ
           MOVE    SPA-GMN-I01-SELNUM      TO  I01-SELNUM
      *
      *    Æþ±¡Îò¥ê¥¹¥È
           MOVE    SPA-GMN-I01-NYUREKILST-CNT
                                           TO  I01-NYUREKILST-CNT
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL ( IDX1    >   SPA-GMN-I01-NYUREKILST-CNT )
               MOVE    SPA-GMN-I01-TSELNUM (IDX1)
                                       TO  WRK-ZZZ9
               MOVE    WRK-ZZZ9        TO  I01-TSELNUM (IDX1)
               IF    ( SPA-GMN-I01-TSHOKAI (IDX1)  =   "1" )
                   MOVE    "¡ý"        TO  I01-TSHOKAI (IDX1)
               ELSE
                   MOVE    SPACE       TO  I01-TSHOKAI (IDX1)
               END-IF
               MOVE    SPA-GMN-I01-TSHONUM (IDX1)
                                       TO  WRK-ZZZ9
               MOVE    WRK-ZZZ9
                                       TO  I01-TSHONUM (IDX1)
               MOVE    SPA-GMN-I01-TBTUNAME (IDX1)
                                       TO  I01-TBTUNAME (IDX1)
               MOVE    SPA-GMN-I01-TBRMNUM (IDX1)
                                       TO  I01-TBRMNUM (IDX1)
               MOVE    SPA-GMN-I01-TNYUINYMD (IDX1)
                                       TO  I01-TNYUINYMD (IDX1)
               MOVE    SPA-GMN-I01-TTAIINYMD (IDX1)
                                       TO  I01-TTAIINYMD (IDX1)
               MOVE    SPA-GMN-I01-TNYUINKA (IDX1)
                                       TO  I01-TNYUINKA (IDX1)
               MOVE    SPA-GMN-I01-TBYOMEI (IDX1)
                                       TO  I01-TBYOMEI (IDX1)
               MOVE    SPA-GMN-I01-TTENKI (IDX1)
                                       TO  I01-TTENKI (IDX1)
               MOVE    SPA-GMN-I01-TNISSU (IDX1)
                                       TO  I01-TNISSU (IDX1)
               MOVE    SPA-GMN-I01-TTUSAN (IDX1)
                                       TO  I01-TTUSAN (IDX1)
      *
               IF    ( SPA-GMN-I01-NYUREKILST-SEL  =   IDX1)
                   MOVE    "T"         TO  I01-NYUREKILST-SELECT (IDX1)
               ELSE
                   MOVE    "F"         TO  I01-NYUREKILST-SELECT (IDX1)
               END-IF
      *
           END-PERFORM
      *
           EVALUATE    FLG-NYUREKILST-ROW
           WHEN    1
               MOVE    ZERO            TO  I01-NYUREKILST-ROW
               MOVE    ZERO            TO  I01-NYUREKILST-ROWATTR
           WHEN    OTHER
               MOVE    SPA-GMN-I01-NYUREKILST-SEL
                                       TO  I01-NYUREKILST-ROW
               MOVE    2               TO  I01-NYUREKILST-ROWATTR
           END-EVALUATE
      *
      *    ¹àÌÜ¾õÂÖÊÔ½¸
           PERFORM 500-GMNHEN-STATE-EDIT-SEC
      *
           PERFORM 5001-MAPCUR-SEC
      *
           .
       500-GMNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¹àÌÜ¾õÂÖÊÔ½¸½èÍý
      *****************************************************************
       500-GMNHEN-STATE-EDIT-SEC       SECTION.
      *
      *    Æþ±¡ÎòºîÀ®¥Ü¥¿¥ó
           MOVE    SPA-GMN-I01-B07-STT
                                       TO  I01-B07-STT
      *    Æþ±¡Îò½¤Àµ¥Ü¥¿¥ó
           MOVE    SPA-GMN-I01-B08-STT
                                       TO  I01-B08-STT
      *    ÅÐÏ¿¥Ü¥¿¥ó
           MOVE    SPA-GMN-I01-B12-STT
                                       TO  I01-B12-STT
      *    °ÛÆ°Æü
           MOVE    SPA-GMN-I01-IDOYMD-STT
                                       TO  I01-IDOYMD-STT
      *    ÉÂ¼¼ÈÖ¹æ
           MOVE    SPA-GMN-I01-BRMNUM-STT
                                       TO  I01-BRMNUM-STT
      *    ÉÂÅïÌ¾
           MOVE    SPA-GMN-I01-BTUNAME-STT
                                       TO  I01-BTUNAME-STT
           MOVE    SPA-GMN-I01-BTUNAME-ITM-STT
                                       TO  I01-BTUNAME-ITM-STT
      *    ¼¼ÎÁº¹³Û
           MOVE    SPA-GMN-I01-SAGAKU-STT
                                       TO  I01-SAGAKU-STT
           MOVE    SPA-GMN-I01-SAGAKU-ITM-STT
                                       TO  I01-SAGAKU-ITM-STT
      *    Æþ±¡Æü
           MOVE    SPA-GMN-I01-NYUINYMD-STT
                                       TO  I01-NYUINYMD-STT
      *    Æþ±¡²Ê
           MOVE    SPA-GMN-I01-NYUINKA-STT
                                       TO  I01-NYUINKA-STT
           MOVE    SPA-GMN-I01-NYUINKA-ITM-STT
                                       TO  I01-NYUINKA-ITM-STT
      *    ½é²ó
           MOVE    SPA-GMN-I01-SHOKAI-STT
                                       TO  I01-SHOKAI-STT
           MOVE    SPA-GMN-I01-SHOKAI-ITM-STT
                                       TO  I01-SHOKAI-ITM-STT
      *    ½é²óÈÖ¹æ
           MOVE    SPA-GMN-I01-SHONUM-STT
                                       TO  I01-SHONUM-STT
      *    Âà±¡Æü
           MOVE    SPA-GMN-I01-TAIINYMD-STT
                                       TO  I01-TAIINYMD-STT
      *    Âà±¡»öÍ³
           MOVE    SPA-GMN-I01-TAIINCD-STT
                                       TO  I01-TAIINCD-STT
           MOVE    SPA-GMN-I01-TAIINCD-ITM-STT
                                       TO  I01-TAIINCD-ITM-STT
      *    Ã´Åö°å
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   3   )
               MOVE    SPA-GMN-I01-DR-STT (IDX1)
                                       TO  I01-DR-STT (IDX1)
               MOVE    SPA-GMN-I01-DR-ITM-STT (IDX1)
                                       TO  I01-DR-ITM-STT (IDX1)
           END-PERFORM
      *    ÊÝ¸±ÁÈ¹ç¤ï¤»
           MOVE    SPA-GMN-I01-HKNCOMBI-STT
                                       TO  I01-HKNCOMBI-STT
           MOVE    SPA-GMN-I01-HKNCOMBI-ITM-STT
                                       TO  I01-HKNCOMBI-ITM-STT
      *    ÆÃÄêÆþ±¡ÎÁ
           MOVE    SPA-GMN-I01-TOKNYUIN-STT
                                       TO  I01-TOKNYUIN-STT
           MOVE    SPA-GMN-I01-TOKNYUIN-ITM-STT
                                       TO  I01-TOKNYUIN-ITM-STT
      *    »»ÄêÆþ±¡ÎÁ
           MOVE    SPA-GMN-I01-SNTNYUIN-STT
                                       TO  I01-SNTNYUIN-STT
      *    Á°¼õ¤±¶â
           MOVE    SPA-GMN-I01-MAEUKE-STT
                                       TO  I01-MAEUKE-STT
      *    Äê´üÀÁµá
           MOVE    SPA-GMN-I01-SEIKYU-STT
                                       TO  I01-SEIKYU-STT
           MOVE    SPA-GMN-I01-SEIKYU-ITM-STT
                                       TO  I01-SEIKYU-ITM-STT
      *    ¸¡º÷»þ´µ¼ÔÉ½¼¨
           MOVE    SPA-GMN-I01-DISPKBN-STT
                                       TO  I01-DISPKBN-STT
           MOVE    SPA-GMN-I01-DISPKBN-ITM-STT
                                       TO  I01-DISPKBN-ITM-STT
      *¶ÈÌ³½èÍý¸¢¸ÂÀßÄê
      *    Æþ±¡²ñ·×¾È²ñ
           IF      SPA-GSRAUTH-32      =   "1"
               MOVE    WIDGET-NORMAL       TO  I01-B21-STATE
           ELSE
               MOVE    WIDGET-INSENSITIVE  TO  I01-B21-STATE
           END-IF
      *    ´µ¼ÔÅÐÏ¿
           IF      SPA-GSRAUTH-12      =   "1"
               MOVE    WIDGET-NORMAL       TO  I01-B05-STATE
           ELSE
               MOVE    WIDGET-INSENSITIVE  TO  I01-B05-STATE
           END-IF
      *
           .
       500-GMNHEN-STATE-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ²èÌÌ¥«¡¼¥½¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       5001-MAPCUR-SEC              SECTION.
      *
           IF     (SPA-ERRCD           =   SPACE)  AND
                  (SPA-GMN-I01-CUR     =   ZERO )
               PERFORM 5011-INPUT-CUR-SEC
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   1   )
                   MOVE    "PTNUM"         TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   2   )
                   MOVE    "SYORIKBN"      TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   3   )
               IF  ( SPA-GMN-I01-IDOYMD-STT    =   WIDGET-NORMAL )
                   MOVE    "IDOYMD"        TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   4
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   4   )
               IF  ( SPA-GMN-I01-BRMNUM-STT    =   WIDGET-NORMAL )
                   MOVE    "BRMNUM"        TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   5
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   5   )
               IF  ( SPA-GMN-I01-BTUNAME-STT   =   WIDGET-NORMAL )
                   MOVE    "BTUNAME"       TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   6
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   6   )
               IF  ( SPA-GMN-I01-SAGAKU-STT    =   WIDGET-NORMAL )
                   MOVE    "SAGAKU"        TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   7
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   7   )
               IF  ( SPA-GMN-I01-NYUINYMD-STT  =   WIDGET-NORMAL )
                   MOVE    "NYUINYMD"      TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   8
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   8   )
               IF  ( SPA-GMN-I01-NYUINKA-STT   =   WIDGET-NORMAL )
                   MOVE    "NYUINKA"       TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   9
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   9   )
               IF  ( SPA-GMN-I01-SHOKAI-STT    =   WIDGET-NORMAL )
                   MOVE    "SHOKAI"        TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   10
               END-IF
           END-IF
      *
      *    ½é²óÁªÂòÈÖ¹æ
           IF    ( SPA-GMN-I01-CUR =   10  )
               IF  ( SPA-GMN-I01-SHONUM-STT    =   WIDGET-NORMAL )
                   MOVE    "SHONUM"        TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   11
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   11  )
               IF  ( SPA-GMN-I01-TAIINYMD-STT  =   WIDGET-NORMAL )
                   MOVE    "TAIINYMD"      TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   20
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   20  )
               IF  ( SPA-GMN-I01-TAIINCD-STT   =   WIDGET-NORMAL )
                   MOVE    "TAIINCD"       TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   12
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   12  )
               IF  ( SPA-GMN-I01-DR-STT (1)    =   WIDGET-NORMAL )
                   MOVE    "DR1"           TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   13
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   13  )
               IF  ( SPA-GMN-I01-DR-STT (2)    =   WIDGET-NORMAL )
                   MOVE    "DR2"           TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   14
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   14  )
               IF  ( SPA-GMN-I01-DR-STT (3)    =   WIDGET-NORMAL )
                   MOVE    "DR3"           TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   15
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   15  )
               IF  ( SPA-GMN-I01-HKNCOMBI-STT  =   WIDGET-NORMAL )
                   MOVE    "HKNCOMBI"      TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   16
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   16  )
               IF  ( SPA-GMN-I01-TOKNYUIN-STT  =   WIDGET-NORMAL )
                   MOVE    "TOKNYUIN"      TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   17
               END-IF
           END-IF
      *
      *??? xx »ÃÄê xx Á°¼õ¤±¶â¤Ë¤Ï¥«¡¼¥½¥ë¤òÈô¤Ð¤µ¤Ê¤¤¤è¤¦¤Ë¤¹¤ë xx
           IF    ( SPA-GMN-I01-CUR =   17  )
               COMPUTE SPA-GMN-I01-CUR =   18
           END-IF
      *??? IF    ( SPA-GMN-I01-CUR =   17  )
      *???     IF  ( SPA-GMN-I01-MAEUKE-STT    =   WIDGET-NORMAL )
      *???         MOVE    "MAEUKE"        TO  MCP-WIDGET
      *???         GO  TO  5001-MAPCUR-EXT
      *???     ELSE
      *???         COMPUTE SPA-GMN-I01-CUR =   SPA-GMN-I01-CUR +   1
      *???     END-IF
      *??? END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   18  )
               IF  ( SPA-GMN-I01-SEIKYU-STT    =   WIDGET-NORMAL )
                   MOVE    "SEIKYU"        TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   COMPUTE SPA-GMN-I01-CUR =   19
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   19  )
               IF  ( SPA-GMN-I01-DISPKBN-STT   =   WIDGET-NORMAL )
                   MOVE    "DISPKBN"       TO  MCP-WIDGET
                   GO  TO  5001-MAPCUR-EXT
               ELSE
                   MOVE    212             TO  SPA-GMN-I01-CUR
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   100  )
               MOVE    "SELNUM"        TO  MCP-WIDGET
               GO  TO  5001-MAPCUR-EXT
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   206  )
               MOVE    "B06"           TO  MCP-WIDGET
               GO  TO  5001-MAPCUR-EXT
           END-IF
      *
           IF    ( SPA-GMN-I01-CUR =   212  )
               MOVE    "B12"           TO  MCP-WIDGET
               GO  TO  5001-MAPCUR-EXT
           END-IF
      *
           .
      *
       5001-MAPCUR-EXT.
           EXIT.
      *****************************************************************
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È½èÍý
      *****************************************************************
       5011-INPUT-CUR-SEC          SECTION.
      *
           EVALUATE    WRK-MCP-WIDGET
           WHEN    "IDOYMD"
               MOVE    004             TO  SPA-GMN-I01-CUR
           WHEN    "BRMNUM"
               MOVE    005             TO  SPA-GMN-I01-CUR
           WHEN    "BTUNAME"
               MOVE    006             TO  SPA-GMN-I01-CUR
           WHEN    "SAGAKU"
               MOVE    007             TO  SPA-GMN-I01-CUR
           WHEN    "NYUINYMD"
               MOVE    008             TO  SPA-GMN-I01-CUR
           WHEN    "NYUINKA"
               MOVE    009             TO  SPA-GMN-I01-CUR
           WHEN    "SHOKAI"
               MOVE    010             TO  SPA-GMN-I01-CUR
           WHEN    "SHONUM"
               MOVE    011             TO  SPA-GMN-I01-CUR
           WHEN    "TAIINYMD"
               MOVE    020             TO  SPA-GMN-I01-CUR
           WHEN    "DR1"
               MOVE    013             TO  SPA-GMN-I01-CUR
           WHEN    "DR2"
               MOVE    014             TO  SPA-GMN-I01-CUR
           WHEN    "DR3"
               MOVE    015             TO  SPA-GMN-I01-CUR
           WHEN    "HKNCOMBI"
               MOVE    016             TO  SPA-GMN-I01-CUR
           WHEN    "TOKNYUIN"
               MOVE    017             TO  SPA-GMN-I01-CUR
           WHEN    "MAEUKE"
               MOVE    018             TO  SPA-GMN-I01-CUR
           WHEN    "SEIKYU"
               MOVE    019             TO  SPA-GMN-I01-CUR
           WHEN    "DISPKBN"
               MOVE    212             TO  SPA-GMN-I01-CUR
           WHEN    "TAIINCD"
               MOVE    012             TO  SPA-GMN-I01-CUR
           WHEN    "SELNUM"
               IF    ( SPA-GMN-I01-SYORIKBN-CD =   "10" )
                   MOVE    212         TO  SPA-GMN-I01-CUR
               ELSE
                   MOVE    206         TO  SPA-GMN-I01-CUR
               END-IF
           END-EVALUATE
      *
           .
      *
       5011-INPUT-CUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸É½¼¨Íý
      *****************************************************************
       510-ERRSET-SEC              SECTION.
      *
           MOVE    SPACE               TO  SPA-ERRMSG
      *
           EVALUATE    SPA-ERRCD
           WHEN    "0001"
               MOVE    "ÆþÎÏ¥¨¥é¡¼"    TO  SPA-ERRMSG
           WHEN    "0002"
               MOVE    "³ºÅö¤Î´µ¼Ô¤ÏÂ¸ºß¤·¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "0003"
               MOVE    "È¾³ÑÊ¸»ú¤Ç¤Î¤ßÆþÎÏ¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "0004"
               MOVE    "³ºÅö¤ÎÉÂ¼¼¤ÏÂ¸ºß¤·¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "0005"
               MOVE    "½éÎò¤òÁªÂò¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "0011"
               MOVE    "´µ¼ÔÈÖ¹æÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0012"
               MOVE    "½èÍý¶èÊ¬ÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0013"
               MOVE    "°ÛÆ°ÆüÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0014"
               MOVE    "ÉÂ¼¼ÈÖ¹æÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0015"
               MOVE    "ÉÂÅïÌ¾ÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0016"
               MOVE    "¼¼ÎÁº¹³ÛÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0017"
               MOVE    "Æþ±¡ÆüÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0018"
               MOVE    "Æþ±¡²ÊÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0019"
               MOVE    "½é²óÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0020"
               MOVE    "½éÎòÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0021"
               MOVE    "Âà±¡ÆüÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0022"
               MOVE    "Ã´Åö°åÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0023"
               MOVE    "ÊÝ¸±ÁÈ¹ç¤»ÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0024"
               MOVE    "ÆÃÄêÆþ±¡ÎÁÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0025"
               MOVE    "Äê´üÀÁµáÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0026"
               MOVE    "¸¡º÷»þ´µ¼ÔÉ½¼¨ÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0027"
               MOVE    "ÁªÂòÈÖ¹æÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "0028"
               MOVE    "Âà±¡»öÍ³ÆþÎÏ¥¨¥é¡¼" 
                                       TO  SPA-ERRMSG
           WHEN    "1001"
               MOVE    "´µ¼ÔÈÖ¹æ¤òÆþÎÏ¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1002"
               MOVE    "½èÍý¶èÊ¬¤òÁªÂò¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1003"
               MOVE    "ÉÂ¼¼ÈÖ¹æ¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1004"
               MOVE    "ÉÂÅïÌ¾¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1005"
               MOVE    "Æþ±¡Æü¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1006"
               MOVE    "Æþ±¡²Ê¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1007"
               MOVE    "½é²ó¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1008"
               MOVE    "Ã´Åö°å¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1009"
               MOVE    "ÊÝ¸±ÁÈ¹ç¤»¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1010"
               MOVE    "Äê´üÀÁµá¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1011"
               MOVE    "¸¡º÷»þ´µ¼ÔÉ½¼¨¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1012"
               MOVE    "Âà±¡Æü¡ãÆþ±¡Æü¤È¤Ê¤Ã¤Æ¤¤¤Þ¤¹"
                                       TO  SPA-ERRMSG
           WHEN    "1013"
               MOVE    "Âà±¡Æü¡ãÁ°²ó°ÛÆ°Æü¤È¤Ê¤Ã¤Æ¤¤¤Þ¤¹"
                                       TO  SPA-ERRMSG
           WHEN    "1014"
               MOVE    "°ÛÆ°Æü¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1015"
               MOVE    "°ÛÆ°Æü¡ãÆþ±¡Æü¤È¤Ê¤Ã¤Æ¤¤¤Þ¤¹"
                                       TO  SPA-ERRMSG
           WHEN    "1016"
               MOVE    "°ÛÆ°Æü¡ãÁ°²ó°ÛÆ°Æü¤È¤Ê¤Ã¤Æ¤¤¤Þ¤¹"
                                       TO  SPA-ERRMSG
           WHEN    "1017"
               MOVE    "Æþ±¡²Ê¡¦ÉÂÅï¡¦ÉÂ¼¼¡¦ÊÝ¸±ÁÈ¹ç¤»¡¦ÆÃÄêÆþ±¡"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "ÎÁ¤Î¤¤¤º¤ì¤«¤òÊÑ¹¹¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG (41 : )
           WHEN    "1018"
               MOVE    "Æþ±¡Æü¡ãÁ°²óÂà±¡Æü¤È¤Ê¤Ã¤Æ¤¤¤Þ¤¹"
                                       TO  SPA-ERRMSG
           WHEN    "1019"
               MOVE    "Æþ±¡Îò¤òÁªÂò¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1020"
               MOVE    "Âà±¡Æü¤òÆþÎÏ¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1021"
               MOVE    "ÊÝ¸±ÁÈ¹ç¤»¤¬¤¢¤ê¤Þ¤»¤ó¡£½èÍý¤Ç¤­¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1022"
               MOVE    "·ÑÂ³¸µ¤ÎÎòÈÖ¹æ¤òÆþÎÏ¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1023"
               MOVE    "Æþ±¡ÎòºîÀ®²èÌÌ¤ÇºîÀ®¤·¤¿Æþ±¡Îò¤òÁªÂò¤·¤Æ"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG (41 : )
      *    WHEN    "1024"
      *        MOVE    "ÁªÂòÎò¤è¤ê¿·¤·¤¤Îò¤¬Â¸ºß¤¹¤ë¤¿¤á½¤Àµ¤Ç¤­"
      *                                TO  SPA-ERRMSG (1 : 40)
      *        MOVE    "¤Þ¤»¤ó"        TO  SPA-ERRMSG (41 : )
           WHEN    "1025"
               MOVE    "Äê´üÀÁµá¤¬¹Ô¤ï¤ì¤Æ¤¤¤Ê¤¤¤¿¤á¡¢ÉéÃ´¶â·×»»"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "¤Ï¹Ô¤¨¤Þ¤»¤ó"  TO  SPA-ERRMSG (41 : )
           WHEN    "1026"
               MOVE    "Äê´üÀÁµáºÑ¤ß¤Î´ü´Ö¤Ë³ºÅö¤¹¤ë¤¿¤á¡¢Âà±¡ÅÐ"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "Ï¿¤Ï¹Ô¤¨¤Þ¤»¤ó" 
                                       TO  SPA-ERRMSG (41 : )
           WHEN    "1027"
               MOVE    "Æþ±¡ÎÁ¤¬»ØÄê¤µ¤ì¤Æ¤¤¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1028"
               MOVE    "Äê´üÀÁµá¤¬·îËö¤Î¤ß¤ËÊÑ¹¹¤µ¤ì¤Æ¤¤¤Þ¤¹¡£"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "·îÅÓÃæ¤ÎÆþ¶â¡ÊÀÁµá¡Ë¤ò¼è¾Ã¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG (41 : )
           WHEN    "1029"
               MOVE    "°ÛÆ°·î¤Î²ñ·×¥Æ¡¼¥Ö¥ë¤¬ºîÀ®¤µ¤ì¤Æ¤¤¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1030"
               MOVE    "Âà±¡·î¤Î²ñ·×¥Æ¡¼¥Ö¥ë¤¬ºîÀ®¤µ¤ì¤Æ¤¤¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1031"
               MOVE    "Á°Îò¤Î¼«±¡Îò¤¬¡ÖÆþ±¡Ãæ¡×¤Ç¤¹¡£Á°Îò¤Î·ÑÂ³"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "Æþ±¡¤È¤·¤ÆÅÐÏ¿¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG (41 : )
           WHEN    "1032"
               MOVE    "Á°Îò¤Î¼«±¡Îò¤¬¡ÖÆþ±¡Ãæ¡×¤Ç¤¹¡£Æþ±¡Æü¤òÁ°"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "Îò¤ÎÂà±¡Æü¤ÎÍâÆü¤Ë¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG (41 : )
           WHEN    "1033"
               MOVE    "Ï«ºÒÊÝ¸±¡Ê¥¢¥Õ¥¿¡¼¥±¥¢¡Ë¤ÏÆþ±¡¤Ç¤­¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1034"
               MOVE    "Âà±¡ºÑ¤ÎÎò¤òÁªÂò¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1035"
               MOVE    "Æþ±¡ÎòºîÀ®½èÍý¤ÇºîÀ®¤·¤¿Îò¤Ï½èÍý¤ÎÂÐ¾Ý³°"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "¤Ç¤¹"
                                       TO  SPA-ERRMSG (41 : )
           WHEN    "1036"
               MOVE  "Æþ±¡Æü¡åÁ°²óÂà±¡Æü¤È¤Ê¤Ã¤Æ¤¤¤Þ¤¹"
                                       TO  SPA-ERRMSG
           WHEN    "1037"
               MOVE    "Æ±ÆüºÆÆþ±¡¤Î¾ì¹ç¡¢Æ±Æü¤ÎÂà±¡ÅÐÏ¿¤Ï¹Ô¤¨¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1038"
               MOVE    "Æ±ÆüºÆÆþ±¡¤Ï·ÑÂ³Æþ±¡¤Î¤ß²ÄÇ½¤Ç¤¹"
                                       TO  SPA-ERRMSG
           WHEN    "2012"
               MOVE    "Âà±¡·×»»¤ËÉ¬Í×¤Ê²ñ·×¾ðÊó¤¬ºîÀ®¤µ¤ì¤Æ¤¤¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "2008"
               MOVE    "ÉéÃ´¶â·×»»½èÍý¤Ë¼ºÇÔ¤·¤Þ¤·¤¿"
                                       TO  SPA-ERRMSG
           WHEN    "4001"  THRU    "4999"
               MOVE    "¹¹¿·½èÍý¤Ë¼ºÇÔ¤·¤Þ¤·¤¿"
                                       TO  SPA-ERRMSG
      *
           WHEN    "9300"
               MOVE    "´µ¼ÔÅÐÏ¿¤Î¶ÈÌ³¸¢¸Â¤Ï¤¢¤ê¤Þ¤»¤ó¡£"
                                                TO  SPA-ERRMSG
               MOVE    "´µ¼ÔÅÐÏ¿¤Ï¤Ç¤­¤Þ¤»¤ó¡£"
                                                TO  SPA-ERRMSG(33:)
           WHEN    "9999"
               MOVE    "Â¾Ã¼Ëö¤Ç»ÈÍÑÃæ¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               MOVE    SLOCK-MSG       TO  SPA-ERRMSG(21:)
           END-EVALUATE
      *
           MOVE    SPACE               TO  I0ERR
           MOVE    SPA-ERRCD           TO  I0ERR-ERRCODE
           MOVE    SPA-ERRMSG          TO  I0ERR-ERRMSG
           MOVE    "B01"               TO  MCP-WIDGET
      *
           MOVE    "I01"               TO  SPA-MOTOPG
           MOVE    "I0ERR"             TO  SPA-SAKIPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    "I0ERR"             TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                    TO  FLG-END
      *
           .
       510-ERRSET-EXT.
           EXIT.
      *****************************************************************
      *    ¥¬¥¤¥É¥á¥Ã¥»¡¼¥¸É½¼¨
      *****************************************************************
       520-I0IDSET-SEC             SECTION.
      *
           EVALUATE    SPA-I0IDCD
           WHEN    "3001"
               MOVE    "Æþ±¡¾ðÊó¤òºï½ü¤·¤Þ¤¹¡Ê²ñ·×¾ðÊó¤Ï»Ä¤ê¤Þ¤¹¡Ë"
                                       TO  WRK-I0IDMSG
           WHEN    "3002"
               MOVE    "Æþ±¡¾ðÊó¤òºï½ü¤·¤Þ¤¹"
                                       TO  WRK-I0IDMSG (1 : 20)
               MOVE    "¡Ê²ñ·×¾ðÊó¤âÊ»¤»¤Æºï½ü¤·¤Þ¤¹¡Ë"
                                       TO  WRK-I0IDMSG (21 : )
           WHEN    "3003"
               MOVE    "Âà±¡¼è¾Ã¤ò¹Ô¤¤¤Þ¤¹"
                                       TO  WRK-I0IDMSG
           WHEN    "3004"
               MOVE    SPACE           TO  WRK-I0IDMSG
               STRING  "Âà±¡¸å¤Î¿ÇÎÅÆü¤ÇÆþÎÏ¤µ¤ì¤¿¿ÇÎÅ¹Ô°Ù¤Ï"
                       "ºï½ü¤µ¤ì¤Þ¤¹¡£³ÎÇ§¤·¤Æ¤¯¤À¤µ¤¤"
               DELIMITED BY SIZE
               INTO  WRK-I0IDMSG
               END-STRING
           WHEN    "3005"
               MOVE    SPACE           TO  WRK-I0IDMSG
               STRING  "Äê´üÀÁµá¤¬·îËö¤Î¤ß¤ËÊÑ¹¹¤µ¤ì¤Æ¤¤¤Þ¤¹¡£"
                       "·îÅÓÃæ¤ÇºîÀ®¤·¤¿ÀÁµá¥Ç¡¼¥¿¤Ï¼è¾Ã¤·¤Þ¤¹"
               DELIMITED BY SIZE
               INTO  WRK-I0IDMSG
               END-STRING
           WHEN    "3006"
               MOVE    SPACE           TO  WRK-I0IDMSG
               STRING  "Æþ±¡¾ðÊó¡Ê°ÛÆ°Îò¤¢¤ê¡Ë¤òºï½ü¤·¤Þ¤¹"
                       "¡Ê²ñ·×¾ðÊó¤Ï»Ä¤ê¤Þ¤¹¡Ë"
               DELIMITED BY SIZE
               INTO  WRK-I0IDMSG
               END-STRING
           WHEN    "3008"
               MOVE    SPACE           TO  WRK-I0IDMSG
               STRING  "Äê´üÀÁµá½èÍýÃæ¤Î¤¿¤áÂà±¡½èÍý¤Ï¹Ô¤¨¤Þ¤»¤ó¡£"
                       "¤è¤í¤·¤¤¤Ç¤¹¤«"
               DELIMITED BY SIZE
               INTO  WRK-I0IDMSG
               END-STRING
           WHEN    "3007"
               MOVE    SPACE           TO  WRK-I0IDMSG
               STRING  "Æþ±¡¾ðÊó¡Ê°ÛÆ°Îò¤¢¤ê¡Ë¤òºï½ü¤·¤Þ¤¹"
                       "¡Ê²ñ·×¾ðÊó¤âÊ»¤»¤Æºï½ü¤·¤Þ¤¹¡Ë"
               DELIMITED BY SIZE
               INTO  WRK-I0IDMSG
               END-STRING
           WHEN    "3009"
               MOVE    SPACE           TO  WRK-I0IDMSG
               STRING  "Æþ±¡Æü¤¬Â¾±¡Âà±¡Æü¤È½ÅÊ£¤·¤Þ¤¹¡£"
                       "Â¾±¡Îò¤ÎÄÌ»»Æü¿ô¤ò¸º»»¤·¤Þ¤¹¤«¡©"
               DELIMITED BY SIZE
               INTO  WRK-I0IDMSG
               END-STRING
           WHEN    "3010"
               MOVE    SPACE           TO  WRK-I0IDMSG
               STRING  "Æþ±¡Æü¤¬Â¾±¡Âà±¡Æü¤È½ÅÊ£¤·¤Þ¤¹¡£"
                       "¤è¤í¤·¤¤¤Ç¤¹¤«¡©"
               DELIMITED BY SIZE
               INTO  WRK-I0IDMSG
               END-STRING
           END-EVALUATE
      *
      *
           MOVE    SPACE                TO  I0ID1
           MOVE    SPA-I0IDCD           TO  I0ID1-ID1CODE
           MOVE    WRK-I0IDMSG          TO  I0ID1-ID1MSG
           MOVE    "B12"                TO  MCP-WIDGET
      *
           MOVE    "I01"                TO  SPA-MOTOPG
           MOVE    "I0ID1"              TO  SPA-SAKIPG
      *
           MOVE    "NEW"                TO  MCP-PUTTYPE
           MOVE    "I0ID1"              TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                    TO  FLG-END
      *
           .
       520-I0IDSET-EXT.
           EXIT.
      *****************************************************************
      *    ¥¬¥¤¥É¥á¥Ã¥»¡¼¥¸É½¼¨
      *****************************************************************
       520-I0ID2SET-SEC            SECTION.
      *
           EVALUATE    SPA-I0IDCD2
           WHEN    "3101"
               MOVE    "Å¾²Ê¡ÊÅ¾Åï¡¦Å¾¼¼¡ËÎò¤òºï½ü¤·¤Þ¤¹"
                                       TO  WRK-I0IDMSG
           END-EVALUATE
      *
      *
           MOVE    SPACE               TO  I0ID2
           MOVE    SPA-I0IDCD2         TO  I0ID2-ID2CODE
           MOVE    WRK-I0IDMSG         TO  I0ID2-ID2MSG
      *
      *
           MOVE    SPA-GMN-I01-MAEIDOYMD
                                       TO  I0ID2-IDOYMD
           MOVE    SPA-GMN-I01-NYUINKA-NM
                                       TO  I0ID2-NYUINKA
      *
           MOVE    SPA-GMN-I01-BRMNUM  TO  I0ID2-BRM
      *
           MOVE    SPA-GMN-I01-BTUNAME-NM
                                       TO  I0ID2-BTU
      *
           MOVE    SPA-GMN-I01-HKNCOMBI-NM
                                       TO  I0ID2-HKNCOMBI
           MOVE    SPA-GMN-I01-SNTNYUIN
                                       TO  I0ID2-TOKNYUIN
      *
           MOVE    "B12"                TO  MCP-WIDGET
      *
           MOVE    "I01"                TO  SPA-MOTOPG
           MOVE    "I0ID2"              TO  SPA-SAKIPG
      *
           MOVE    "NEW"                TO  MCP-PUTTYPE
           MOVE    "I0ID2"              TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                    TO  FLG-END
      *
           .
       520-I0ID2SET-EXT.
           EXIT.
      *****************************************************************
      *    ÆüÉÕ¥Á¥§¥Ã¥¯¡¦ÊÔ½¸½èÍý
      *****************************************************************
       5002-HIZUKE-CHK-SEC             SECTION.
      *
           MOVE    SPACE               TO  WRK-HENYMDG
                                           WRK-SYMD
      *
           IF    ( WRK-YMD         =   SPACE )
               GO  TO  5002-HIZUKE-CHK-EXT
           END-IF
      *
      *    ÆüÉÕ²èÌÌ¥Á¥§¥Ã¥¯¥µ¥Ö
           INITIALIZE                      ORCSGDAYAREA
           MOVE    WRK-YMD             TO  SGDAY-INDAY
           CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
           IF  ( SGDAY-RC              =   ZERO )
               MOVE    SGDAY-OTDAY     TO  WRK-HENYMDG
               MOVE    SGDAY-SDAY      TO  WRK-SYMD
           ELSE
               MOVE    "0001"          TO  SPA-ERRCD
           END-IF
           .
       5002-HIZUKE-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ´ü´Ö»»½Ð½èÍý
      *****************************************************************
       5002-KIKAN-CALC-SEC             SECTION.
      *
           MOVE    ZERO                TO  FLG-ORCSDAY
                                           WRK-NISSU1
                                           WRK-NISSU2
      *
           INITIALIZE                  STS-AREA-DAY
           INITIALIZE                  LNK-DAY5-AREA
           MOVE    "51"                TO  LNK-DAY5-IRAI
           MOVE    WRK-STYMD           TO  LNK-DAY5-START
           MOVE    WRK-EDYMD           TO  LNK-DAY5-END
           CALL  "ORCSDAY"             USING   STS-AREA-DAY
                                           LNK-DAY5-AREA
           IF      ( STS-DAY-RC1   NOT =   ZERO )
               MOVE    1           TO  FLG-ORCSDAY
               GO  TO              5002-KIKAN-CALC-EXT
           END-IF
      *
           MOVE    LNK-DAY5-NISSU1     TO  WRK-NISSU1
           MOVE    LNK-DAY5-NISSU2     TO  WRK-NISSU2
      *
           .
       5002-KIKAN-CALC-EXT.
           EXIT.
      *****************************************************************
      *    ¥«¥ì¥ó¥À¡¼½èÍý
      *****************************************************************
       5002-CALENDAR-SEC               SECTION.
      *
           INITIALIZE                  STS-AREA-DAY
           INITIALIZE                  LNK-DAY6-AREA
           MOVE    "61"                TO  LNK-DAY6-IRAI
           MOVE    WRK-YMD             TO  LNK-DAY6-KIJUN
           MOVE    WRK-ZOGENPTN        TO  LNK-DAY6-ZOGENPTN
           MOVE    WRK-ZOGEN           TO  LNK-DAY6-ZOGEN
           CALL  "ORCSDAY"             USING   STS-AREA-DAY
                                               LNK-DAY6-AREA
           MOVE    LNK-DAY6-KEISAN     TO  WRK-KEISANYMD
      *
           .
       5002-CALENDAR-EXT.
           EXIT.
      *****************************************************************
      *    Á´³ÑÈ¾³Ñº®ºß¥Á¥§¥Ã¥¯
      *****************************************************************
       800-ENRTRY-CHK-SEC              SECTION.
      *
           MOVE    ZERO            TO  FLG-ENTRYCHK
      *
           IF  ( WRK-KANACHK-MAE-INPUT
                                   =   SPACE )
               GO  TO  800-ENRTRY-CHK-EXT
           END-IF
      *
           MOVE    SPACE           TO  ORCSKANACHKAREA
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"             TO  KANACHK-SYORI
           MOVE    WRK-KANACHK-MAE-INPUT
                                   TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"   USING   ORCSKANACHKAREA
           MOVE    KANACHK-OUT-INPUT
                                   TO  WRK-KANACHK-OUT-INPUT
           IF      ( KANACHK-RC    NOT =   ZERO )
               MOVE    1           TO  FLG-ENTRYCHK
               GO  TO  800-ENRTRY-CHK-EXT
           END-IF
      *
      *    Á´³Ñ¤Ç¤Ê¤¤¾ì¹ç¤Ï¥¨¥é¡¼¤È¤¹¤ë¡£
           IF      ( KANACHK-SYUBETU   NOT =   2 )
               MOVE    1           TO  FLG-ENTRYCHK
           END-IF
      *
           .
       800-ENRTRY-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æ±ÆüºÆÆþ±¡¥Á¥§¥Ã¥¯¥µ¥Ö
      *****************************************************************
       800-ORCSDNTCHK-SEC              SECTION.
      *
           INITIALIZE                  SDNTCHK-AREA
           MOVE    PTNYUINRRK-REC      TO      LNKNRRK-REC
           CALL    "ORCSDNTCHK"        USING   SDNTCHK-AREA
                                               LNKNRRK-REC
      *
           .
       800-ORCSDNTCHK-EXT.
           EXIT.
      *****************************************************************
      *    ÆüÊó¥­¡¼¼èÆÀ¥µ¥Ö
      *****************************************************************
       800-DAILYKEY-SEC         SECTION.
      *
           CALL    "ORCSDAILYKEY"   USING   SDAILYKEYAREA
      *
           .
      *
       800-DAILYKEY-EXT.
           EXIT.
      *****************************************************************
      *    ¥Þ¥·¥óÆüÉÕ¼èÆÀ¥µ¥Ö
      *****************************************************************
       800-MCNDATE-SEC         SECTION.
      *
           CALL    "ORCSMCNDATE"   USING   ORCSMCNDATEAREA
      *
           .
      *
       800-MCNDATE-EXT.
           EXIT.
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¸¡º÷½èÍý
      *****************************************************************
       900-TENSU-KEY-SEL-SEC           SECTION.
      *
           MOVE    ZERO                TO  FLG-TENSU
           INITIALIZE                  TNS-TENSU-REC
      *
           MOVE    WRK-SRYCD           TO  TNS-SRYCD
           MOVE    WRK-KJNYMD          TO  ORC-DBYMD
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
      *
           MOVE    "TENSU-KEY"         TO  WRK-DBPATH
           PERFORM 900-TBL-SELECT-SEC
           IF    ( FLG-DBRC        =   ZERO )
               MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
           ELSE
               MOVE    1               TO  FLG-TENSU
           END-IF
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "TENSU-KEY"         TO  ORC-DBPATH
           PERFORM 900-TBL-CLOSE-SEC
      *
           .
       900-TENSU-KEY-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
      *****************************************************************
       900-TBL-SELECT-SEC              SECTION.
      *
           MOVE    ZERO            TO  FLG-DBRC
           MOVE    WRK-DBPATH      TO  ORC-DBPATH
           PERFORM 910-DB-SELECT-SEC
           IF    ( MCP-RC          =   ZERO )
               MOVE    WRK-DBPATH  TO  ORC-DBPATH
               PERFORM 910-DB-READ-SEC
               IF    ( MCP-RC          =   ZERO )
                   CONTINUE
               ELSE
                   MOVE    1       TO  FLG-DBRC
               END-IF
           ELSE
               MOVE    1           TO  FLG-DBRC
           END-IF
      *
           .
       900-TBL-SELECT-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ëÆÉ¹þ½èÍý
      *****************************************************************
       900-TBL-READ-SEC                SECTION.
      *
           MOVE    ZERO            TO  FLG-DBRC
           MOVE    WRK-DBPATH      TO  ORC-DBPATH
           PERFORM 910-DB-READ-SEC
           IF    ( MCP-RC          =   ZERO )
               CONTINUE
           ELSE
               MOVE    1           TO  FLG-DBRC
           END-IF
      *
           .
       900-TBL-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¹¹¿·½èÍý
      *****************************************************************
       900-TBL-UPDATE-SEC              SECTION.
      *
           MOVE    ZERO            TO  FLG-DBRC
           MOVE    WRK-DBPATH      TO  ORC-DBPATH
           PERFORM 910-DB-UPDATE-SEC
           IF    ( MCP-RC          =   ZERO )
               CONTINUE
           ELSE
               MOVE    1           TO  FLG-DBRC
           END-IF
      *
           .
       900-TBL-UPDATE-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ëÄÉ²Ã½èÍý
      *****************************************************************
       900-TBL-INSERT-SEC              SECTION.
      *
           MOVE    ZERO            TO  FLG-DBRC
           MOVE    WRK-DBPATH      TO  ORC-DBPATH
           PERFORM 910-DB-INSERT-SEC
           IF    ( MCP-RC          =   ZERO )
               CONTINUE
           ELSE
               MOVE    1           TO  FLG-DBRC
           END-IF
      *
           .
       900-TBL-INSERT-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ëºï½ü½èÍý
      *****************************************************************
       900-TBL-DELETE-SEC              SECTION.
      *
           MOVE    ZERO            TO  FLG-DBRC
           MOVE    WRK-DBPATH      TO  ORC-DBPATH
           PERFORM 910-DB-DELETE-SEC
           IF    ( MCP-RC          =   ZERO )
               CONTINUE
           ELSE
               MOVE    1           TO  FLG-DBRC
           END-IF
      *
           .
       900-TBL-DELETE-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       900-TBL-CLOSE-SEC               SECTION.
      *
           MOVE    WRK-DBPATH      TO  ORC-DBPATH
           PERFORM 910-DB-CLOSE-SEC
      *
           .
       900-TBL-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Âºï½ü½èÍý
      *****************************************************************
       910-DB-DELETE-SEC               SECTION.
      *
           MOVE    "DBDELETE"          TO  MCP-FUNC
           CALL    "ORCMCPSUB"         USING
                                       MCPAREA
                                       ORCMCPAREA
                                       MCPDATA-REC
      *
           .
      *
       910-DB-UPDATE-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£Â¹¹¿·½èÍý
      *****************************************************************
       910-DB-UPDATE-SEC               SECTION.
      *
           MOVE    "DBUPDATE"          TO  MCP-FUNC
           CALL    "ORCMCPSUB"         USING
                                       MCPAREA
                                       ORCMCPAREA
                                       MCPDATA-REC
      *
           .
      *
       910-DB-UPDATE-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÄÉ²Ã½èÍý
      *****************************************************************
       910-DB-INSERT-SEC               SECTION.
      *
           MOVE    "DBINSERT"          TO  MCP-FUNC
           CALL    "ORCMCPSUB"         USING
                                       MCPAREA
                                       ORCMCPAREA
                                       MCPDATA-REC
      *
           .
      *
       910-DB-INSERT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£Â¸¡º÷½èÍý
      *****************************************************************
       910-DB-SELECT-SEC               SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
      *
           .
      *
       910-DB-SELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       910-DB-READ-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
           CALL    "ORCMCPSUB"         USING
                                       MCPAREA
                                       ORCMCPAREA
                                       MCPDATA-REC
      *
           .
      *
       910-DB-READ-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£Â¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       910-DB-CLOSE-SEC                SECTION.
      *
           MOVE    "DBCLOSECURSOR"      TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
      *
           .
      *
       910-DB-CLOSE-EXT.
           EXIT.
      *****************************************************************
      *    ÇÓÂ¾À©¸æ½èÍý
      *****************************************************************
       990-LOCK-IN-SEC         SECTION.
      *
      *    ÇÓÂ¾À©¸æ½èÍý
           MOVE    1                   TO  SLOCK-MODE
           MOVE    SPA-NAI-I01-PTID    TO  SLOCK-PTID
           CALL    "ORCSLOCK"          USING
                                       MCPAREA
                                       SPA-AREA
                                       ORCSLOCKAREA
           IF    ( SLOCK-RETURN    NOT =   ZERO )
               MOVE    "9999"          TO  SPA-ERRCD
           END-IF
           .
       990-LOCK-IN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÇÓÂ¾À©¸æ²ò½ü½èÍý
      *****************************************************************
       990-LOCK-OUT-SEC         SECTION.
      *
      *    ÇÓÂ¾À©¸æ²ò½ü½èÍý
           MOVE    2                   TO  SLOCK-MODE
           CALL    "ORCSLOCK"          USING
                                       MCPAREA
                                       SPA-AREA
                                       ORCSLOCKAREA
           .
       990-LOCK-OUT-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ð£Õ£Ô¡¡½èÍý
      *****************************************************************
       900-PUT-WINDOW              SECTION.
      *
           MOVE   "PUTWINDOW"       TO  MCP-FUNC.
           CALL   "ORCMCPSUB"   USING
                                MCPAREA
                                ORCMCPAREA
                                MCPDATA-REC.
      *
           .
       900-PUT-WINDOW-EXT.
           EXIT.

