      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION                            DIVISION.
       PROGRAM-ID.                               ORCGW24.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ¥·¥¹¥Æ¥à´ÉÍý¾ðÊóÀßÄê
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : °åÎÅµ¡´ØÆþ±¡´ðËÜ¾ðÊóÀßÄê
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  02/07/30    NACL¡ÝÂÀÅÄ    ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  00.00.01    NACL-ÂÀÅÄ    03.01.24  Æþ±¡¿ÇÎÅ·×²èÌ¤¼Â»Ü¸º»»¤ò
      *                                     ²èÌÌ¤«¤éºï½ü
      *  00.00.02    NACL-ÂÀÅÄ    03.03.05  Æþ±¡ÎòÉ½¼¨¶èÊ¬¤òÄÉ²Ã
      *  00.00.03    NACL-ÂÀÅÄ    03.03.07  ÀÁµá½ñÈ¯¹Ô¶èÊ¬¤òÄÉ²Ã
      *                                     Âà±¡¾ÚÌÀ½ñÈ¯¹Ô¶èÊ¬¤òÄÉ²Ã
      *  00.00.04    NACL-ÂÀÅÄ    03.03.24  ÁªÄêÎÅÍÜÈñ¾ðÊó¤òÄÉ²Ã
      *  00.00.05    NACL-ÂÀÅÄ    03.04.10  ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬¤òÄÉ²Ã
      *  00.00.06    NACL-ÂÀÅÄ    03.06.25  ÅÀ¿ô¥Þ¥¹¥¿Í­¸ú´ü´Ö¤Î»ØÄê¤ò½¤Àµ
      *  00.00.07    NACL-ÂÀÅÄ    04.01.07  ¹¹¿·ÆüÉÕÊÔ½¸ÂÐ±þ
      *  00.00.08    NACL-ÂÀÅÄ    04.01.15  ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¶èÊ¬ÄÉ²Ã
      *  01.00.01    NACL-ÂÀÅÄ    04.03.04  Î×¾²¸¦½¤ÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»
      *                                     Î¥Åç²Ã»»ÄÉ²Ã
      *  01.00.02    NACL-ÂÀÅÄ    04.08.23  Æþ±¡²ñ·×¼¼ÎÁº¹³Û¶èÊ¬ÄÉ²Ã
      *  01.00.03    NACL-¾®Æ¦Âô  06.01.19  ³°ÇñÅÐÏ¿»þ¤Î¼Â¹¹¿·¶èÊ¬ÄÉ²Ã
      *  02.08.00    NACL-ÂÀÅÄ    06.02.27  ¸º»»¾ðÊó¤ÎÊÔ½¸¾ì½êÊÑ¹¹
      *  03.02.01    NACL-¾®Æ¦Âô  06.08.09  É¸·çÂÐ±þ
      *  03.02.02    NACL-¾®Æ¦Âô  06.09.12  Äê¿ôÄ¶²áÂÐ±þ
      *  03.04.00    NACL-Â¿¡¹Ç¼  06/10/26  ¸¡º÷²èÌÌÏ¢Íí¾ðÊóÄÉ²Ã 
      *  03.04.00    NACL-ÂÀÅÄ    06/11/29  Âà±¡ºÆ·×»»¶èÊ¬ÄÉ²Ã
      *  03.05.00    NACL-ÂÀÅÄ    07.05.18  ¥°¥ë¡¼¥×¿ÇÎÅÂÐ±þ
      *  03.05.00    NACL-¾®Æ¦Âô  07.07.27  ÎÅÍÜÉÂÅï¡ÊÉÂ¾²¡ËÆþ±¡²ñ·×
      *                                     É½¼¨¶èÊ¬ÂÐ±þ
      *  04.03.00    NACL-Â¿¡¹Ç¼  08.08.28  Âà±¡»þ±¡³°½èÊý¤»¤ó¶èÊ¬ÄÉ²Ã
      *  04.05.00    NACL-ÂÀÅÄ    10.03.01  ²þÀµÂÐ±þ
      *****************************************************************
      *
       ENVIRONMENT                               DIVISION.
       CONFIGURATION                             SECTION.
       INPUT-OUTPUT                              SECTION.
       FILE-CONTROL.
      *
       DATA                    DIVISION.
       FILE                        SECTION.
      *
       WORKING-STORAGE             SECTION.
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¾ðÊóÀßÄêÍÑ¶¦ÄÌ¥Ñ¥é¥á¥¿
           COPY    "W01COMMON-SPA".
      *
      *    ¥³¥ó¥¹¥¿¥ó¥ÈÃÍ
           COPY    "ENUM-VALUE".
      *
      *    ²èÌÌÍÑ£Ó£Ð£Á
           COPY    "W24SCR-SPA".
      *    ²èÌÌÍÑ£Ó£Ð£Á
           COPY    "W25SCR-SPA".
      *
      *    ¥Õ¥é¥°¥¨¥ê¥¢
       01  FLG-AREA.
           03  FLG-END                             PIC 9(01).
           03  FLG-SYSKANRI                        PIC 9(01).
           03  FLG-TENSU                           PIC 9(01).
           03  FLG-KANJI                           PIC 9(01).
           03  FLG-KENSAKU                         PIC 9(01).
           03  FLG-ENTRYCHK                        PIC 9(01).
           03  FLG-SSTKIJUNERR                     PIC 9(01).
           03  FLG-HIZUKE-ERR                      PIC 9(01).
           03  FLG-NYUKSNCD-G.
               05  FLG-190098870                   PIC 9(01).
               05  FLG-190098970                   PIC 9(01).
               05  FLG-190099170                   PIC 9(01).
               05  FLG-190099270                   PIC 9(01).
               05  FLG-190099570                   PIC 9(01).
               05  FLG-190099870                   PIC 9(01).
               05  FLG-190099970                   PIC 9(01).
               05  FLG-190100370                   PIC 9(01).
               05  FLG-190100470                   PIC 9(01).
               05  FLG-190100670                   PIC 9(01).
               05  FLG-190100770                   PIC 9(01).
               05  FLG-190100970                   PIC 9(01).
               05  FLG-190107170                   PIC 9(01).
               05  FLG-190117170                   PIC 9(01).
               05  FLG-190117270                   PIC 9(01).
               05  FLG-190119910                   PIC 9(01).
               05  FLG-190120410                   PIC 9(01).
               05  FLG-190120510                   PIC 9(01).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX0                                PIC 9(05).
           03  IDX1                                PIC 9(05).
           03  IDX2                                PIC 9(05).
           03  IDX3                                PIC 9(05).
           03  IDX4                                PIC 9(05).
           03  IDXC                                PIC 9(05).
           03  IDXY                                PIC 9(05).
           03  IDXZ                                PIC 9(05).
           03  IDX-CMB                             PIC 9(05).
           03  IDX-SYS                             PIC 9(05).
           03  IDX-SKJ                             PIC 9(05).
           03  IDX-KSN                             PIC 9(05).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-WIDMSG                          PIC X(70). 
           03  WRK-YMD                             PIC X(10). 
           03  WRK-SYMD.
               05  WRK-SYY                         PIC 9(04).
               05  WRK-SMM                         PIC 9(02).
               05  WRK-SDD                         PIC 9(02).
           03  WRK-HENYMDG                         PIC X(09).
           03  WRK-KANACHK-MAE-INPUT               PIC X(400).
           03  WRK-CMB-CD                          PIC X(05).
           03  WRK-CMB-ITM-G.
               05  WRK-CMB-IDX                     PIC 9(03).
               05  WRK-CMB-ITM                     PIC X(100).
               05  WRK-CMB-ITM2                    PIC X(100).
           03  WRK-SRYCD                           PIC X(09).
           03  WRK-INPUTCD                         PIC X(09).
           03  WRK-CD-MCNT                         PIC 9(02).
           03  WRK-TNS-SRYCD                       PIC X(09).
           03  WRK-TNS-NAME                        PIC X(100).
           03  WRK-SELNUM                          PIC 9(05).
           03  WRK-STYUKYMD                        PIC X(08).
           03  WRK-EDYUKYMD                        PIC X(08).
           03  WRK-SEL-STYUKYMD                    PIC X(08).
           03  WRK-SEL-EDYUKYMD                    PIC X(08).
           03  WRK-CREYMD                          PIC X(08).
           03  WRK-MAX                             PIC 9(05).
           03  WRK-BASE-CUR                        PIC 9(05).
           03  WRK-CHIIKIKSN-G.
               05  WRK-CHIIKIKSN                   PIC 9(01).
               05  WRK-CHIIKIKSNFL                 PIC X(27).
      *
       01  SSTKJN-AREA.
           03  SSTKJN-VAL.
               05  SSTKJN-VAL1                     PIC X(500).
               05  SSTKJN-VAL2                     PIC X(500).
           03  SSTKJN-R    REDEFINES       SSTKJN-VAL.
               05  SSTKJN-CD                       PIC 9(01)
                                                   OCCURS  1000.
      *
      *    ¸ÇÄêÃÍÎÎ°è
       01  CONST-AREA.
      *
           03  CONST-H220401           PIC X(08)   VALUE "20100401".
           03  CONST-H180401           PIC X(08)   VALUE "20060401".
           03  CONST-H160401           PIC X(08)   VALUE "20040401".
           03  CONST-SRYACT-MAX        PIC 9(03)   VALUE 10.
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á
           03  CONST-SENTEI-TANKA      PIC 9(03)   VALUE 10.
      *    Æþ±¡»þ¿©»öÎÅÍÜ
           03  CONST-SHOKUJIRYOYOCD-VAL.
               05                      PIC X(09)   VALUE   "197000110".
               05                      PIC X(09)   VALUE   "197000710".
           03  CONST-SHOKUJIRYOYOCD-R
                       REDEFINES   CONST-SHOKUJIRYOYOCD-VAL.
               05  CONST-SHOKUJIRYOYOCD-OCC        OCCURS  2.
                   07  CONST-SHOKUJIRYOYOCD
                                       PIC X(09).
      *    ¿©»ö¾ðÊó
           03  CONST-SKJSRY-AREA.
               05  CONST-SKJSRY-MAX    PIC 9(05)   VALUE   2.
               05  CONST-SKJSRY-H1804-G.
                   07  CONST-SKJSRY-H1804-VAL.
                       09              PIC X(09)   VALUE   "197000570".
                       09              PIC X(09)   VALUE   "         ".
                   07  CONST-SKJSRY-H1804-R
                               REDEFINES   CONST-SKJSRY-H1804-VAL.
                       09  CONST-SKJSRY-H1804-OCC  OCCURS  2.
                           11  CONST-SKJSRY-H1804  PIC X(09).
               05  CONST-SKJSRY-G.
                   07  CONST-SKJSRY-VAL.
                       09              PIC X(09)   VALUE   "197000270".
                       09              PIC X(09)   VALUE   "197000570".
                   07  CONST-SKJSRY-R  REDEFINES   CONST-SKJSRY-VAL.
                       09  CONST-SKJSRY-OCC        OCCURS  2.
                           11  CONST-SKJSRY-SRYCD  PIC X(09).
      *
      *    °åÎÅµ¡´Ø¸º»»¾ðÊó
           03  CONST-GEN-AREA.
               05  CONST-GEN-MAX       PIC 9(05)   VALUE   4.
               05  CONST-GEN-VAL.
                   07                  PIC X(09)   VALUE   "190080470".
                   07                  PIC X(09)   VALUE   "190080570".
                   07                  PIC X(09)   VALUE   "190111690".
                   07                  PIC X(09)   VALUE   "190111790".
               05  CONST-GEN-R REDEFINES   CONST-GEN-VAL.
                   07  CONST-GEN-OCC               OCCURS  4.
                       09  CONST-GENCD PIC X(09).
      *
      *    Æþ±¡²Ã»»¾ðÊó
           03  CONST-NYUKSN-AREA.
               05  CONST-NYUKSN-MAX    PIC 9(05)   VALUE   20.
               05  CONST-NYUKSN-H2204-G.
                   07  CONST-NYUKSN-H2204-VAL.
                       09              PIC X(09)   VALUE   "190098870".
                       09              PIC X(09)   VALUE   "190099870".
                       09              PIC X(09)   VALUE   "190100370".
                       09              PIC X(09)   VALUE   "190100470".
                       09              PIC X(09)   VALUE   "190100770".
                       09              PIC X(09)   VALUE   "190100670".
                       09              PIC X(09)   VALUE   "190100970".
                       09              PIC X(09)   VALUE   "190107170".
                       09              PIC X(09)   VALUE   "190117170".
                       09              PIC X(09)   VALUE   "190119910".
                       09              PIC X(09)   VALUE   "190117270".
                       09              PIC X(09)   VALUE   "190120510".
                       09              PIC X(09)   VALUE   "190136910".
                       09              PIC X(09)   VALUE   "190137070".
                       09              PIC X(09)   VALUE   "190120410".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                   07  CONST-NYUKSN-H2204-R
                               REDEFINES   CONST-NYUKSN-H2204-VAL.
                       09  CONST-NYUKSN-H2204
                                       PIC X(09)   OCCURS   20.
               05  CONST-NYUKSN-H1804-G.
                   07  CONST-NYUKSN-H1804-VAL.
                       09              PIC X(09)   VALUE   "190098870".
                       09              PIC X(09)   VALUE   "190099870".
                       09              PIC X(09)   VALUE   "190100370".
                       09              PIC X(09)   VALUE   "190100470".
                       09              PIC X(09)   VALUE   "190100770".
                       09              PIC X(09)   VALUE   "190100670".
                       09              PIC X(09)   VALUE   "190100970".
                       09              PIC X(09)   VALUE   "190107170".
                       09              PIC X(09)   VALUE   "190117170".
                       09              PIC X(09)   VALUE   "190119910".
                       09              PIC X(09)   VALUE   "190117270".
                       09              PIC X(09)   VALUE   "190120510".
                       09              PIC X(09)   VALUE   "190120410".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                   07  CONST-NYUKSN-H1804-R
                               REDEFINES   CONST-NYUKSN-H1804-VAL.
                       09  CONST-NYUKSN-H1804
                                       PIC X(09)   OCCURS   20.
               05  CONST-NYUKSN-H1604-G.
                   07  CONST-NYUKSN-H1604-VAL.
                       09              PIC X(09)   VALUE   "190098870".
                       09              PIC X(09)   VALUE   "190098970".
                       09              PIC X(09)   VALUE   "190099170".
                       09              PIC X(09)   VALUE   "190099270".
                       09              PIC X(09)   VALUE   "190099570".
                       09              PIC X(09)   VALUE   "190099870".
                       09              PIC X(09)   VALUE   "190099970".
                       09              PIC X(09)   VALUE   "190100370".
                       09              PIC X(09)   VALUE   "190100470".
                       09              PIC X(09)   VALUE   "190100770".
                       09              PIC X(09)   VALUE   "190100670".
                       09              PIC X(09)   VALUE   "190100970".
                       09              PIC X(09)   VALUE   "190107170".
                       09              PIC X(09)   VALUE   "190117170".
                       09              PIC X(09)   VALUE   "190117270".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                   07  CONST-NYUKSN-H1604-R
                               REDEFINES   CONST-NYUKSN-H1604-VAL.
                       09  CONST-NYUKSN-H1604
                                       PIC X(09)   OCCURS   20.
               05  CONST-NYUKSN-SRYCD-G.
                   07  CONST-NYUKSN-SRYCD-VAL.
                       09              PIC X(09)   VALUE   "190098870".
                       09              PIC X(09)   VALUE   "190098970".
                       09              PIC X(09)   VALUE   "190099170".
                       09              PIC X(09)   VALUE   "190099270".
                       09              PIC X(09)   VALUE   "190099570".
                       09              PIC X(09)   VALUE   "190099870".
                       09              PIC X(09)   VALUE   "190099970".
                       09              PIC X(09)   VALUE   "190100370".
                       09              PIC X(09)   VALUE   "190100470".
                       09              PIC X(09)   VALUE   "190100770".
                       09              PIC X(09)   VALUE   "190100670".
                       09              PIC X(09)   VALUE   "190100970".
                       09              PIC X(09)   VALUE   "190107170".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                   07  CONST-NYUKSN-SRYCD-R
                               REDEFINES   CONST-NYUKSN-SRYCD-VAL.
                       09  CONST-NYUKSN-SRYCD
                                       PIC X(09)   OCCURS   20.
      *
      *    ÃÏ°è²Ã»»¾ðÊó
           03  CONST-CHIIKIKSN-SRYCD-AREA.
               05  CONST-CHIIKIKSN-H1804-G.
                   07  CONST-CHIIKIKSN-H1804-VAL.
                       09              PIC X(09)   VALUE   "190077070".
                       09              PIC X(09)   VALUE   "190077170".
                       09              PIC X(09)   VALUE   "190120010".
                       09              PIC X(09)   VALUE   "190077270".
                       09              PIC X(09)   VALUE   "190120110".
                       09              PIC X(09)   VALUE   "190077370".
                   07  CONST-CHIIKIKSN-H1804-R
                           REDEFINES   CONST-CHIIKIKSN-H1804-VAL.
                       09  CONST-CHIIKIKSN-H1804
                                       PIC X(09)   OCCURS  6.
               05  CONST-CHIIKIKSN-SRYCD-G.
                   07  CONST-CHIIKIKSN-SRYCD-VAL.
                       09              PIC X(09)   VALUE   "190077070".
                       09              PIC X(09)   VALUE   "190077170".
                       09              PIC X(09)   VALUE   "190077270".
                       09              PIC X(09)   VALUE   "190077370".
                       09              PIC X(09)   VALUE   "         ".
                       09              PIC X(09)   VALUE   "         ".
                   07  CONST-CHIIKIKSN-SRYCD-R
                           REDEFINES   CONST-CHIIKIKSN-SRYCD-VAL.
                       09  CONST-CHIIKIKSN-SRYCD
                                       PIC X(09)   OCCURS  6.
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿
           COPY  "CPSYSKANRI.INC".
      *    °åÎÅµ¡´Ø¾ðÊó
           COPY  "CPSK1001.INC".
      *    »ÜÀß´ð½à¥³¡¼¥É¥Õ¥é¥°¾ðÊó
           COPY  "CPSK1006.INC".
      *    °åÎÅµ¡´ØÆþ±¡´ðËÜ¾ðÊó
           COPY  "CPSK5000.INC".
      *    ÅÀ¿ô¥Þ¥¹¥¿
           COPY  "CPTENSU.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *    ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *
      *    ²èÌÌÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSGDAY.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
           COPY    "CPORCMCP.INC".
      *
      *    Á´³Ñ¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿
           COPY    "CPORCSKANACHK.INC".
      *
      *    ¥Þ¥·¥óÆüÉÕ¼èÆÀ¥µ¥Ö
           COPY    "CPORCSMCNDATE.INC".
      *
      *****************************************************************
      *    Ï¢ÍíÎÎ°è
      *****************************************************************
       LINKAGE                     SECTION.
      *
           COPY    "MCPAREA".
           COPY    "ORCA-SPA".
           COPY    "LINKAREA".
      *
       01  SCRAREA.
           COPY    "W01.INC".
           COPY    "W02.INC".
           COPY    "W03.INC".
           COPY    "W04.INC".
           COPY    "W05.INC".
           COPY    "W06.INC".
           COPY    "W07.INC".
           COPY    "W08.INC".
           COPY    "W09.INC".
           COPY    "W10.INC".
           COPY    "W11.INC".
           COPY    "W111.INC".
           COPY    "W12.INC".
           COPY    "W121.INC".
           COPY    "W13.INC".
           COPY    "W14.INC".
           COPY    "W15.INC".
           COPY    "W16.INC".
           COPY    "W17.INC".
           COPY    "W18.INC".
           COPY    "W19.INC".
           COPY    "W20.INC".
           COPY    "W21.INC".
           COPY    "W22.INC".
           COPY    "W23.INC".
           COPY    "W24.INC".
           COPY    "W25.INC".
           COPY    "W28.INC".
           COPY    "W29.INC".
           COPY    "W30.INC".
           COPY    "W31.INC".
           COPY    "W32.INC".
           COPY    "W33.INC".
           COPY    "W34.INC".
           COPY    "W35.INC".
           COPY    "W60.INC".
           COPY    "W61.INC".
           COPY    "W62.INC".
           COPY    "W63.INC".
           COPY    "W64.INC".
           COPY    "W65.INC".
           COPY    "W66.INC".
           COPY    "W67.INC".
           COPY    "W96.INC".
           COPY    "W98.INC".
           COPY    "W981.INC".
           COPY    "W97.INC".
           COPY    "W99.INC".
           COPY    "WERR.INC".
           COPY    "WID1.INC".
           COPY    "WID2.INC".
      *
       PROCEDURE                   DIVISION    USING
                                               MCPAREA
                                               SPAAREA
                                               LINKAREA
                                               SCRAREA.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  WRK-AREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA.
           MOVE    SPA-WORK        TO  SPA-W01KYOUTU
           MOVE    SPA-FREE        TO  SPA-W24FREE
      *
           MOVE    SPACE           TO  SPA-ERRCD
           MOVE    ZERO            TO  FLG-END
      *
           EVALUATE    MCP-STATUS      ALSO    MCP-EVENT
               WHEN    "LINK"          ALSO    ANY
                   PERFORM 100-INIT-SEC
      *    ²èÌÌÁ«°Ü
               WHEN     "PUTG"           ALSO   "CLICKED"
                   PERFORM 200-GMNSENI
      *    ÆþÎÏ
               WHEN      OTHER
                   PERFORM 200-ENTRY
           END-EVALUATE.
      *
      *    ²èÌÌÁ«°Ü¤¬¤Ê¤¤»þ¡¢²èÌÌÉ½¼¨¤Ø
           IF      FLG-END             =   ZERO
               PERFORM 500-SET-SCREEN
           END-IF
      *
           MOVE    SPA-W01KYOUTU   TO  SPA-WORK
           MOVE    SPA-AREA        TO  SPA-COMMON
           MOVE    SPA-W24FREE     TO  SPA-FREE
      *
           .
           EXIT    PROGRAM
           .
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
      *    ¥¨¥é¡¼²èÌÌ¤è¤ê
           IF    ( SPA-MOTOPG          =   "WERR" )
               PERFORM 5001-MAPCUR-SEC
           ELSE
      *        ½é´ü²èÌÌ¥»¥Ã¥È
               PERFORM 300-SCREEN-SEC
               IF    ( FLG-END         =   1 )
                   GO  TO  100-INIT-EXT
               END-IF 
      *
      *        ²èÌÌÊÔ½¸
               PERFORM 500-GMNHEN-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   PERFORM 510-ERRSET-SEC
                   GO  TO  100-INIT-EXT
               END-IF
           END-IF
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    SPACE               TO  MCP-PUTTYPE
           MOVE    "W24    "           TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
           .
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é´ü²èÌÌ½èÍý
      *****************************************************************
       300-SCREEN-SEC              SECTION.
      *
      *    Â¾¤Î£Ì£Ä¤è¤ê
           IF    ( LINKAREA        NOT =   SPACE )
               MOVE    LNK-KYOUTU          TO  SPA-KYOUTU
           END-IF
      *
           EVALUATE    SPA-MOTOPG
           WHEN    "W25"
      *        ¿ÇÎÅ¹Ô°Ù¥»¥Ã¥È½èÍý
               PERFORM 320-W25SPASET-SEC
               GO  TO  300-SCREEN-EXT
           WHEN    "WID1"
               PERFORM 330-WID1-SET-SEC
               MOVE    SPACE           TO  SPA-WID1-FLG
               MOVE    SPACE           TO  SPA-WIDCD
               GO  TO      300-SCREEN-EXT
           END-EVALUATE
      *
           PERFORM 310-SPASET-SEC
      *
           .
       300-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¹¥Ñ½é´üÊÔ½¸½èÍý
      *****************************************************************
       310-SPASET-SEC              SECTION.
      *
           PERFORM 800-H1804-KAISEI-CHK-SEC
      *
           PERFORM 3101-SPASET-SEC
      *
           .
       310-SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¹¥Ñ½é´üÊÔ½¸½èÍý
      *****************************************************************
       3101-SPASET-SEC             SECTION.
      *
           MOVE    SPACE           TO  SPA-W24
           INITIALIZE                  SPA-W24
                                           W24
      *
      *    ¥³¥ó¥Ü¥Ü¥Ã¥¯¥¹½é´ü²½
           PERFORM 310-CMB-SYOKI-SEC
      *
      *    ÆþÎÏ¾ðÊóÎÎ°è½é´ü²½½èÍý
           PERFORM 4201-INPUT-AREA-INIT-SEC
      *
      *    ÆþÎÏ¾ðÊóÊÔ½¸½èÍý
           PERFORM 310-INPUT-AREA-EDIT-SEC
      *
           .
       3101-SPASET-EXT.
           EXIT.
      *****************************************************************
      *    ¥³¥ó¥Ü¥Ü¥Ã¥¯¥¹½é´ü½èÍý
      *****************************************************************
       310-CMB-SYOKI-SEC               SECTION.
      *
           INITIALIZE              SPA-GMN-W24-CMB-DAT-AREA
      *
      *    Æþ±¡»þ¿©»öÎÅÍÜ¥³¥ó¥Ü
           PERFORM 310-SKJRYOYOLST-SET-SEC
      *
      *    ¿©»ö¿ÇÎÅ¹Ô°Ù¥³¥ó¥Ü
           PERFORM 310-SKJSRYLST-SET-SEC
      *
      *    ÃÏ°è²Ã»»¥³¥ó¥Ü
           PERFORM 310-CHIIKIKSNLST-SET-SEC
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÉéÃ´¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-SENTEI-FTNKBNLST-SET-SEC
      *
      *    ÁªÄêÎÅÍÜÈñ¡Ý¾ÃÈñÀÇ¥³¥ó¥Ü
           PERFORM 310-SENTEI-TAXLST-SET-SEC
      *
      *    Æþ±¡ÎòÉ½¼¨¥³¥ó¥Ü
           PERFORM 310-REKI-DISPKBNLST-SET-SEC
      *
      *    Âà±¡ºÆ·×»»¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-SAIKEISANKBNLST-SET-SEC
      *
      *    Æþ¶â¤Î¼è°·¤¤¥³¥ó¥Ü
           PERFORM 310-NYKNKNRKBNLST-SET-SEC
      *
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-SKYPRTKBNLST-SET-SEC
      *
      *    ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-MISYUPRTKBNLST-SET-SEC
      *
      *    ¿ÇÎÅÈñÌÀºÙ½ñÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-SRYPRTKBNLST-SET-SEC
      *
      *    Âà±¡¾ÚÌÀ½ñÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-TAIPRTKBNLST-SET-SEC
      *
      *    Âà±¡¾ÚÌÀ½ñµ­ºÜ¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-TAIKSIKBNLST-SET-SEC
      *
      *    ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-BRMSGK-TAXLST-SET-SEC
      *
      *    Æþ±¡²ñ·×¼¼ÎÁº¹³Û¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-NACCT-BRMSGKLST-SET-SEC
      *
      *    Æþ±¡²ñ·×³°Çñ¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-NACCT-GAIHAKULST-SET-SEC
      *
      *    É¸·ç¸º³Û¶èÊ¬¥³¥ó¥Ü
           IF    ( SPA-W01-STYUKYMD    >=  CONST-H180401 )
               PERFORM 310-HYOUKETULST-SET-SEC
           END-IF
      *
      *    Äê¿ôÄ¶²á¶èÊ¬¥³¥ó¥Ü
           IF    ( SPA-W01-STYUKYMD    >=  CONST-H180401 )
               PERFORM 310-TEISULST-SET-SEC
           END-IF
      *
      *    £Á£Ä£ÌÆþÎÏ¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-ADLINPUTLST-SET-SEC
      *
      *    Äê´üÀÁµáº¹³Û½é´üÉ½¼¨¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-TEIKISAGAKUACTLST-SET-SEC
      *
      *    ÎÅÍÜÆþ±¡É½¼¨¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-RYOYODSPLST-SET-SEC
      *!!
      *    Âà±¡»þ±¡³°½èÊý¤»¤óÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü
           PERFORM 310-SHOHOUKBNLST-SET-SEC
      *
           .
       310-CMB-SYOKI-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡»þ¿©»öÎÅÍÜ¥³¥ó¥Ü
      *****************************************************************
       310-SKJRYOYOLST-SET-SEC         SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-SKJRYOYO-MAX
      *
           MOVE    "1"             TO  SPA-GMN-W24-SKJRYOYOL   (1)
           MOVE    "Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë"
                                   TO  SPA-GMN-W24-SKJRYOYOMEIL(1)
      *
           MOVE    "2"             TO  SPA-GMN-W24-SKJRYOYOL   (2)
           MOVE    "Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£²¡Ë"
                                   TO  SPA-GMN-W24-SKJRYOYOMEIL(2)
      *
           .
       310-SKJRYOYOLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¿©»ö¿ÇÎÅ¹Ô°Ù¥³¥ó¥Ü
      *****************************************************************
       310-SKJSRYLST-SET-SEC           SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-SKJSRY-MAX
      *
           MOVE    "1"             TO  SPA-GMN-W24-SKJSRYL    (1)
           MOVE    "»»Äê¤·¤Ê¤¤"    TO  SPA-GMN-W24-SKJSRYMEIL (1)
      *
           MOVE    "2"             TO  SPA-GMN-W24-SKJSRYL    (2)
           MOVE    "»»Äê¤¹¤ë"      TO  SPA-GMN-W24-SKJSRYMEIL (2)
      *
           .
       310-SKJSRYLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÃÏ°è²Ã»»¥³¥ó¥Ü
      *****************************************************************
       310-CHIIKIKSNLST-SET-SEC        SECTION.
      *
           IF    ( SPA-W01-EDYUKYMD    >=  CONST-H180401 )
               MOVE    6               TO  SPA-GMN-W24-CHIIKIKSN-MAX
      *
               MOVE    "1"             TO  SPA-GMN-W24-CHIIKIKSNL(1)
               MOVE    "£±µéÃÏÃÏ°è²Ã»»" TO  SPA-GMN-W24-CHIIKIKSNMEIL(1)
               MOVE    "2"             TO  SPA-GMN-W24-CHIIKIKSNL    (2)
               MOVE    "£²µéÃÏÃÏ°è²Ã»»" TO  SPA-GMN-W24-CHIIKIKSNMEIL(2)
               MOVE    "3"             TO  SPA-GMN-W24-CHIIKIKSNL    (3)
               MOVE    "£³µéÃÏÃÏ°è²Ã»»" TO  SPA-GMN-W24-CHIIKIKSNMEIL(3)
               MOVE    "4"             TO  SPA-GMN-W24-CHIIKIKSNL    (4)
               MOVE    "£´µéÃÏÃÏ°è²Ã»»" TO  SPA-GMN-W24-CHIIKIKSNMEIL(4)
               MOVE    "5"             TO  SPA-GMN-W24-CHIIKIKSNL    (5)
               MOVE    "£µµéÃÏÃÏ°è²Ã»»" TO  SPA-GMN-W24-CHIIKIKSNMEIL(5)
               MOVE    "6"             TO  SPA-GMN-W24-CHIIKIKSNL    (6)
               MOVE    "£¶µéÃÏÃÏ°è²Ã»»" TO  SPA-GMN-W24-CHIIKIKSNMEIL(6)
           ELSE
               MOVE    4               TO  SPA-GMN-W24-CHIIKIKSN-MAX
      *
               MOVE    "1"             TO  SPA-GMN-W24-CHIIKIKSNL    (1)
               MOVE    "£±¼ïÃÏ°è²Ã»»"  TO  SPA-GMN-W24-CHIIKIKSNMEIL (1)
               MOVE    "2"             TO  SPA-GMN-W24-CHIIKIKSNL    (2)
               MOVE    "£²¼ïÃÏ°è²Ã»»"  TO  SPA-GMN-W24-CHIIKIKSNMEIL (2)
               MOVE    "3"             TO  SPA-GMN-W24-CHIIKIKSNL    (3)
               MOVE    "£³¼ïÃÏ°è²Ã»»"  TO  SPA-GMN-W24-CHIIKIKSNMEIL (3)
               MOVE    "4"             TO  SPA-GMN-W24-CHIIKIKSNL    (4)
               MOVE    "£´¼ïÃÏ°è²Ã»»"  TO  SPA-GMN-W24-CHIIKIKSNMEIL (4)
           END-IF
      *
           .
       310-CHIIKIKSNLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÄêÎÅÍÜÈñ¡ÝÉéÃ´¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-SENTEI-FTNKBNLST-SET-SEC    SECTION.
      *
           MOVE    3               TO  SPA-GMN-W24-SENTEI-FTNKBN-MAX
      *
           MOVE    "1"             TO  SPA-GMN-W24-SENTEI-FTNKBNL    (1)
           MOVE    "°åÎÅµ¡´ØÄêÎ¨ÀßÄê"
                                   TO  SPA-GMN-W24-SENTEI-FTNKBNMEIL (1)
      *
           MOVE    "2"             TO  SPA-GMN-W24-SENTEI-FTNKBNL    (2)
           MOVE    "°åÎÅµ¡´ØÄê³ÛÀßÄê"
                                   TO  SPA-GMN-W24-SENTEI-FTNKBNMEIL (2)
      *
           MOVE    "3"             TO  SPA-GMN-W24-SENTEI-FTNKBNL    (3)
           MOVE    "ÉÂÅïÊÌ¤ËÀßÄê"
                                   TO  SPA-GMN-W24-SENTEI-FTNKBNMEIL (3)
      *
           .
       310-SENTEI-FTNKBNLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÄêÎÅÍÜÈñ¡Ý¾ÃÈñÀÇ¥³¥ó¥Ü
      *****************************************************************
       310-SENTEI-TAXLST-SET-SEC       SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-SENTEI-TAX-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-SENTEI-TAXL    (1)
           MOVE    "¤Ê¤·"          TO  SPA-GMN-W24-SENTEI-TAXMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-SENTEI-TAXL    (2)
           MOVE    "¤¢¤ê"          TO  SPA-GMN-W24-SENTEI-TAXMEIL (2)
      *
           .
       310-SENTEI-TAXLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎòÉ½¼¨¥³¥ó¥Ü
      *****************************************************************
       310-REKI-DISPKBNLST-SET-SEC     SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-REKI-DISPKBN-MAX
      *
           MOVE    "1"             TO  SPA-GMN-W24-REKI-DISPKBNL    (1)
           MOVE    "Æþ±¡»þ¤ÎÎò¤òÉ½¼¨"
                                   TO  SPA-GMN-W24-REKI-DISPKBNMEIL (1)
      *
           MOVE    "2"             TO  SPA-GMN-W24-REKI-DISPKBNL    (2)
           MOVE    "ºÇ¿·¤ÎÎò¤òÉ½¼¨"
                                   TO  SPA-GMN-W24-REKI-DISPKBNMEIL (2)
      *
           .
       310-REKI-DISPKBNLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ºÆ·×»»¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-SAIKEISANKBNLST-SET-SEC     SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-SAIKEISANKBN-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-SAIKEISANKBNL    (1)
           MOVE    "¼ýÇ¼ºÆºîÀ®"
                                   TO  SPA-GMN-W24-SAIKEISANKBNMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-SAIKEISANKBNL    (2)
           MOVE    "¼ýÇ¼ÄûÀµ"
                                   TO  SPA-GMN-W24-SAIKEISANKBNMEIL (2)
      *
           .
       310-SAIKEISANKBNLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    Æþ¶â¤Î¼è°·¤¤¥³¥ó¥Ü
      *****************************************************************
       310-NYKNKNRKBNLST-SET-SEC     SECTION.
      *
           MOVE    5               TO  SPA-GMN-W24-NYKNKNRKBN-MAX
      *
           MOVE    "1"             TO  SPA-GMN-W24-NYKNKNRKBNL (1)
           MOVE    "º£²óÀÁµáÊ¬¤Î¤ßÆþ¶â"
                                   TO  SPA-GMN-W24-NYKNKNRKBNMEIL (1)
      *
           MOVE    "2"             TO  SPA-GMN-W24-NYKNKNRKBNL (2)
           MOVE    "º£²óÊ¬¡¦ÅÁÉ¼¤Î¸Å¤¤Ì¤¼ý½ç"
                                   TO  SPA-GMN-W24-NYKNKNRKBNMEIL (2)
      *
           MOVE    "3"             TO  SPA-GMN-W24-NYKNKNRKBNL (3)
           MOVE    "º£²óÊ¬¡¦ÅÁÉ¼¤Î¿·¤·¤¤Ì¤¼ý½ç"
                                   TO  SPA-GMN-W24-NYKNKNRKBNMEIL (3)
      *
           MOVE    "4"             TO  SPA-GMN-W24-NYKNKNRKBNL (4)
           MOVE    "ÅÁÉ¼¤Î¸Å¤¤Ì¤¼ý½ç"
                                   TO  SPA-GMN-W24-NYKNKNRKBNMEIL (4)
      *
           MOVE    "5"             TO  SPA-GMN-W24-NYKNKNRKBNL (5)
           MOVE    "ÅÁÉ¼¤Î¿·¤·¤¤Ì¤¼ý½ç"
                                   TO  SPA-GMN-W24-NYKNKNRKBNMEIL (5)
      *
           .
       310-NYKNKNRKBNLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-SKYPRTKBNLST-SET-SEC    SECTION.
      *
           MOVE    3               TO  SPA-GMN-W24-SKYPRTKBN-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-SKYPRTKBNL   (1)
           MOVE    "È¯¹Ô¤·¤Ê¤¤"    TO  SPA-GMN-W24-SKYPRTKBNMEIL(1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-SKYPRTKBNL   (2)
           MOVE    "È¯¹Ô¤¹¤ë"      TO  SPA-GMN-W24-SKYPRTKBNMEIL(2)
      *
           MOVE    "2"             TO  SPA-GMN-W24-SKYPRTKBNL   (3)
           MOVE    "È¯¹Ô¤¹¤ë¡ÊÀÁµá¤¢¤ê¡Ë"
                                   TO  SPA-GMN-W24-SKYPRTKBNMEIL(3)
      *
           .
       310-SKYPRTKBNLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-MISYUPRTKBNLST-SET-SEC      SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-MISYUPRTKBN-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-MISYUPRTKBNL    (1)
           MOVE    "°õ»ú¤·¤Ê¤¤"    TO  SPA-GMN-W24-MISYUPRTKBNMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-MISYUPRTKBNL    (2)
           MOVE    "°õ»ú¤¹¤ë"      TO  SPA-GMN-W24-MISYUPRTKBNMEIL (2)
      *
           .
       310-MISYUPRTKBNLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅÈñÌÀºÙ½ñÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-SRYPRTKBNLST-SET-SEC    SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-SRYPRTKBN-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-SRYPRTKBNL   (1)
           MOVE    "È¯¹Ô¤·¤Ê¤¤"    TO  SPA-GMN-W24-SRYPRTKBNMEIL(1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-SRYPRTKBNL   (2)
           MOVE    "È¯¹Ô¤¹¤ë"      TO  SPA-GMN-W24-SRYPRTKBNMEIL(2)
      *
      *
           .
       310-SRYPRTKBNLST-SET-EXT.
           EXIT.
      *!
      *****************************************************************
      *    Âà±¡»þ±¡³°½èÊý¤»¤óÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-SHOHOUKBNLST-SET-SEC    SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-SHOHOUKBN-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-SHOHOUKBNL   (1)
           MOVE    "È¯¹Ô¤·¤Ê¤¤"    TO  SPA-GMN-W24-SHOHOUKBNMEIL(1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-SHOHOUKBNL   (2)
           MOVE    "È¯¹Ô¤¹¤ë"      TO  SPA-GMN-W24-SHOHOUKBNMEIL(2)
      *
      *
           .
       310-SHOHOUKBNLST-SET-EXT.
           EXIT.
      *!
      *****************************************************************
      *    Âà±¡¾ÚÌÀ½ñÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-TAIPRTKBNLST-SET-SEC    SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-TAIPRTKBN-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-TAIPRTKBNL    (1)
           MOVE    "È¯¹Ô¤·¤Ê¤¤"    TO  SPA-GMN-W24-TAIPRTKBNMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-TAIPRTKBNL    (2)
           MOVE    "È¯¹Ô¤¹¤ë"      TO  SPA-GMN-W24-TAIPRTKBNMEIL (2)
      *
           .
       310-TAIPRTKBNLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡¾ÚÌÀ½ñµ­ºÜ¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-TAIKSIKBNLST-SET-SEC    SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-TAIKSIKBN-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-TAIKSIKBNL    (1)
           MOVE    "£²¤È£³¤òµ­ºÜ¤·¤Ê¤¤"
                                   TO  SPA-GMN-W24-TAIKSIKBNMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-TAIKSIKBNL    (2)
           MOVE    "£²¤È£³¤òµ­ºÜ¤¹¤ë"
                                   TO  SPA-GMN-W24-TAIKSIKBNMEIL (2)
      *
           .
       310-TAIKSIKBNLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-BRMSGK-TAXLST-SET-SEC   SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-BRMSGK-TAX-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-BRMSGK-TAXL    (1)
           MOVE    "¤Ê¤·"          TO  SPA-GMN-W24-BRMSGK-TAXMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-BRMSGK-TAXL    (2)
           MOVE    "¤¢¤ê"          TO  SPA-GMN-W24-BRMSGK-TAXMEIL (2)
      *
           .
       310-BRMSGK-TAXLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²ñ·×¼¼ÎÁº¹³Û¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-NACCT-BRMSGKLST-SET-SEC     SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-NACCT-BRMSGK-MAX
      *
           MOVE    "1"             TO  SPA-GMN-W24-NACCT-BRMSGKL    (1)
           MOVE    "»»Äê¤·¤Ê¤¤"    TO  SPA-GMN-W24-NACCT-BRMSGKMEIL (1)
      *
           MOVE    "2"             TO  SPA-GMN-W24-NACCT-BRMSGKL    (2)
           MOVE    "»»Äê¤¹¤ë"      TO  SPA-GMN-W24-NACCT-BRMSGKMEIL (2)
      *
           .
       310-NACCT-BRMSGKLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²ñ·×³°Çñ¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-NACCT-GAIHAKULST-SET-SEC    SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-NACCT-GAIHAKU-MAX
      *
           MOVE    "1"             TO  SPA-GMN-W24-NACCT-GAIHAKUL    (1)
           MOVE    "¼Â¹¹¿·¤Ê¤·"    TO  SPA-GMN-W24-NACCT-GAIHAKUMEIL (1)
      *
           MOVE    "2"             TO  SPA-GMN-W24-NACCT-GAIHAKUL    (2)
           MOVE    "¼Â¹¹¿·¤¢¤ê"    TO  SPA-GMN-W24-NACCT-GAIHAKUMEIL (2)
      *
           .
       310-NACCT-GAIHAKULST-SET-EXT.
           EXIT.
      *****************************************************************
      *    É¸·ç¸º³Û¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-HYOUKETULST-SET-SEC    SECTION.
      *
           MOVE    5               TO  SPA-GMN-W24-HYOUKETU-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-HYOUKETUL    (1)
           MOVE    "¸º³Û¤Ê¤·"
                                   TO  SPA-GMN-W24-HYOUKETUMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-HYOUKETUL    (2)
           MOVE    "£±£°£°Ê¬¤Î£±£°¸º³Û"
                                   TO  SPA-GMN-W24-HYOUKETUMEIL (2)
      *
           MOVE    "2"             TO  SPA-GMN-W24-HYOUKETUL    (3)
           MOVE    "£±£°£°Ê¬¤Î£±£µ¸º³Û"
                                   TO  SPA-GMN-W24-HYOUKETUMEIL (3)
      *
           MOVE    "3"             TO  SPA-GMN-W24-HYOUKETUL    (4)
           MOVE    "£±£°£°Ê¬¤Î£²¸º³Û"
                                   TO  SPA-GMN-W24-HYOUKETUMEIL (4)
      *
           MOVE    "4"             TO  SPA-GMN-W24-HYOUKETUL    (5)
           MOVE    "£±£°£°Ê¬¤Î£³¸º³Û"
                                   TO  SPA-GMN-W24-HYOUKETUMEIL (5)
      *
           .
       310-HYOUKETULST-SET-EXT.
           EXIT.
      *****************************************************************
      *    Äê¿ôÄ¶²á¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-TEISULST-SET-SEC    SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-TEISU-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-TEISUL    (1)
           MOVE    "Äê¿ôÄ¶²á¤Ê¤·"
                                   TO  SPA-GMN-W24-TEISUMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-TEISUL    (2)
           MOVE    "Äê¿ôÄ¶²á¤¢¤ê"
                                   TO  SPA-GMN-W24-TEISUMEIL (2)
      *
           .
       310-TEISULST-SET-EXT.
           EXIT.
      *****************************************************************
      *    £Á£Ä£ÌÆþÎÏ¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-ADLINPUTLST-SET-SEC    SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-ADLINPUT-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-ADLINPUTL    (1)
           MOVE    "¤·¤Ê¤¤"
                                   TO  SPA-GMN-W24-ADLINPUTMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-ADLINPUTL    (2)
           MOVE    "¤¹¤ë"
                                   TO  SPA-GMN-W24-ADLINPUTMEIL (2)
      *
           .
       310-ADLINPUTLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    Äê´üÀÁµáº¹³Û½é´üÉ½¼¨¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-TEIKISAGAKUACTLST-SET-SEC    SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-TEIKISAGAKUACT-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-TEIKISAGAKUACTL   (1)
           MOVE    "½é´üÉ½¼¨¤·¤Ê¤¤"
                                   TO  SPA-GMN-W24-TEIKISAGAKUACTMEIL(1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-TEIKISAGAKUACTL   (2)
           MOVE    "½é´üÉ½¼¨¤¹¤ë"
                                   TO  SPA-GMN-W24-TEIKISAGAKUACTMEIL(2)
      *
           .
       310-TEIKISAGAKUACTLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÎÅÍÜÆþ±¡É½¼¨¶èÊ¬¥³¥ó¥Ü
      *****************************************************************
       310-RYOYODSPLST-SET-SEC    SECTION.
      *
           MOVE    2               TO  SPA-GMN-W24-RYOYODSP-MAX
      *
           MOVE    "0"             TO  SPA-GMN-W24-RYOYODSPL    (1)
           MOVE    "»»ÄêÆþ±¡ÎÁ¤Î¤ßÉ½¼¨"
                                   TO  SPA-GMN-W24-RYOYODSPMEIL (1)
      *
           MOVE    "1"             TO  SPA-GMN-W24-RYOYODSPL    (2)
      *
           IF    ( SPA-W01-STYUKYMD    >=  CONST-H220401 )
            AND  ( SPA-HOSPSBT          =  1 )
               MOVE    "Æþ±¡ÎÁ£Á¡Á£É¤òÉ½¼¨"
                                   TO  SPA-GMN-W24-RYOYODSPMEIL (2)
           ELSE
               MOVE    "Æþ±¡ÎÁ£Á¡Á£Å¤òÉ½¼¨"
                                   TO  SPA-GMN-W24-RYOYODSPMEIL (2)
           END-IF
      *
           .
       310-RYOYODSPLST-SET-EXT.
           EXIT.
      *****************************************************************
      *    ÆþÎÏ¾ðÊóÊÔ½¸½èÍý
      *****************************************************************
       310-INPUT-AREA-EDIT-SEC     SECTION.
      *
      *    °åÎÅµ¡´ØÆþ±¡´ðËÜ¾ðÊó¸¡º÷½èÍý
           PERFORM 310-SYS-5000-SEL-SEC
           IF    ( FLG-SYSKANRI    =   ZERO )
               CONTINUE
           ELSE
      *
      *        °åÎÅµ¡´ØÆþ±¡´ðËÜ¾ðÊó¸¡º÷½èÍý¡Ê´ü´ÖÀÚ¤êÂØ¤¨¥Á¥§¥Ã¥¯¡Ë
               PERFORM 311-SYS-5000-SEL-SEC
               IF    ( FLG-SYSKANRI    =   ZERO )
                   CONTINUE
               ELSE
                   GO  TO  310-INPUT-AREA-EDIT-EXT
               END-IF
      *
           END-IF
      *
      *    ¿©»öÎÅÍÜÈñ
           IF    ( SYS-5000-SHOKUJIRYOYOCD NOT =   SPACE )
               PERFORM VARYING IDX0    FROM    1   BY  1
                       UNTIL ( IDX0    >   2 )
                   IF    ( SYS-5000-SHOKUJIRYOYOCD
                                   =   CONST-SHOKUJIRYOYOCD (IDX0) )
                       MOVE    SPA-GMN-W24-SKJRYOYOLST (IDX0)
                                       TO  SPA-GMN-W24-SKJRYOYO-G
                   END-IF
               END-PERFORM
           END-IF
      *
      *    ÆÃÊÌ´ÉÍý²Ã»»
           IF    ( SPA-W01-EDYUKYMD    >=  CONST-H180401 )
               CONTINUE
           ELSE
               PERFORM VARYING IDX0    FROM    1   BY  1
                       UNTIL ( IDX0    >   CONST-SKJSRY-MAX )
                        OR   ( SPA-NAI-W24-SKJSRY-SRYCD (IDX0)
                                   =   SPACE )
                   IF    ( SYS-5000-SHOKUCD (1)
                                   =   SPA-NAI-W24-SKJSRY-SRYCD (IDX0))
                       MOVE    SYS-5000-SHOKUKBN (1)
                                       TO  WRK-CMB-CD
                       PERFORM 4200-SKJSRYLST-CHK-SEC
                       MOVE    WRK-CMB-ITM TO  SPA-GMN-W24-SKJSRY-OCC
                                                                (IDX0)
                   END-IF
               END-PERFORM
           END-IF
      *
      *    ¿©Æ²²Ã»»
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   CONST-SKJSRY-MAX )
                    OR   ( SPA-NAI-W24-SKJSRY-SRYCD (IDX0)
                                   =   SPACE )
               IF    ( SYS-5000-SHOKUCD (2)
                                   =   SPA-NAI-W24-SKJSRY-SRYCD (IDX0))
                   MOVE    SYS-5000-SHOKUKBN (2)
                                       TO  WRK-CMB-CD
                   PERFORM 4200-SKJSRYLST-CHK-SEC
                   MOVE    WRK-CMB-ITM TO  SPA-GMN-W24-SKJSRY-OCC
                                                                (IDX0)
               END-IF
           END-PERFORM
      *
      *    ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¶èÊ¬
           MOVE    SYS-5000-BRMSGK-TAXKBN  TO  WRK-CMB-CD
           PERFORM 4200-BRMSGK-TAXLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM         TO  SPA-GMN-W24-BRMSGK-TAX-G
           ELSE
               MOVE    SPA-GMN-W24-BRMSGK-TAXLST (1)
                                           TO  SPA-GMN-W24-BRMSGK-TAX-G
           END-IF
      *
      *    Æþ±¡²ñ·×¼¼ÎÁº¹³Û¶èÊ¬
           MOVE    SYS-5000-NACCT-BRMSGKKBN  TO  WRK-CMB-CD
           PERFORM 4200-NACCT-BRMSGKLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-NACCT-BRMSGK-G
           ELSE
               MOVE    SPA-GMN-W24-NACCT-BRMSGKLST (1)
                                       TO  SPA-GMN-W24-NACCT-BRMSGK-G
           END-IF
      *
      *    Æþ±¡²ñ·×³°Çñ¶èÊ¬
           MOVE    SYS-5000-NACCT-GAIHAKUKBN  TO  WRK-CMB-CD
           PERFORM 4200-NACCT-GAIHAKULST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-NACCT-GAIHAKU-G
           ELSE
               MOVE    SPA-GMN-W24-NACCT-GAIHAKULST (1)
                                       TO  SPA-GMN-W24-NACCT-GAIHAKU-G
           END-IF
      *
      *    É¸·ç¸º³Û¶èÊ¬
           MOVE    SYS-5000-HYOUKETUKBN  TO  WRK-CMB-CD
           PERFORM 4200-HYOUKETULST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-HYOUKETU-G
           ELSE
               MOVE    SPA-GMN-W24-HYOUKETULST (1)
                                       TO  SPA-GMN-W24-HYOUKETU-G
           END-IF
      *
      *    Äê¿ôÄ¶²á¶èÊ¬
           MOVE    SYS-5000-TEISUKBN  TO  WRK-CMB-CD
           PERFORM 4200-TEISULST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-TEISU-G
           ELSE
               MOVE    SPA-GMN-W24-TEISULST (1)
                                       TO  SPA-GMN-W24-TEISU-G
           END-IF
      *
      *    £Á£Ä£ÌÆþÎÏ¶èÊ¬
           MOVE    SYS-5000-ADLINPUTKBN  TO  WRK-CMB-CD
           PERFORM 4200-ADLINPUTLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-ADLINPUT-G
           ELSE
               MOVE    SPA-GMN-W24-ADLINPUTLST (2)
                                       TO  SPA-GMN-W24-ADLINPUT-G
           END-IF
      *
      *    Äê´üÀÁµáº¹³Û½é´üÉ½¼¨
           MOVE    SYS-5000-TEIKISAGAKUACTKBN  TO  WRK-CMB-CD
           PERFORM 4200-TEIKISAGAKUACTLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-TEIKISAGAKUACT-G
           ELSE
               MOVE    SPA-GMN-W24-TEIKISAGAKUACTLST (1)
                                       TO  SPA-GMN-W24-TEIKISAGAKUACT-G
           END-IF
      *
      *    ÎÅÍÜÆþ±¡É½¼¨¶èÊ¬
           MOVE    SYS-5000-RYOYODSPKBN  TO  WRK-CMB-CD
           PERFORM 4200-RYOYODSPLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-RYOYODSP-G
           ELSE
               MOVE    SPA-GMN-W24-RYOYODSPLST (1)
                                       TO  SPA-GMN-W24-RYOYODSP-G
           END-IF
      *
      *    Æþ±¡ÎÁ²Ã»»¾ðÊó
           PERFORM 3101-INPUT-AREA-KSN-SET-SEC
      *
      *    ÃÏ°è²Ã»»¾ðÊó
           IF       (( SYS-5000-STYUKYMD   <   CONST-H180401 )
            AND      ( SPA-W01-EDYUKYMD    >=  CONST-H180401 ))
               MOVE    SPACE       TO  SPA-GMN-W24-CHIIKIKSN-G
           ELSE
               IF    ( SYS-5000-CHIIKIKSN  NOT =   SPACE )
                   PERFORM VARYING IDX0 FROM    1   BY  1
                           UNTIL ( IDX0 >   SPA-GMN-W24-CHIIKIKSN-MAX )
      *
                       IF    ( SYS-5000-STYUKYMD   >=  CONST-H180401 )
                           IF    ( CONST-CHIIKIKSN-H1804 (IDX0)
                                           =   SYS-5000-CHIIKIKSN )
                               MOVE    SPA-GMN-W24-CHIIKIKSNLST (IDX0)
                                   TO  SPA-GMN-W24-CHIIKIKSN-G
                           END-IF
                       ELSE
                           IF    ( CONST-CHIIKIKSN-SRYCD (IDX0)
                                           =   SYS-5000-CHIIKIKSN )
                               MOVE    SPA-GMN-W24-CHIIKIKSNLST (IDX0)
                                   TO  SPA-GMN-W24-CHIIKIKSN-G
                           END-IF
                       END-IF
      *
                   END-PERFORM
               END-IF
           END-IF
      *
      *    Æþ±¡²ñ·×¥Æ¡¼¥Ö¥ëÉ½¼¨¾ðÊó
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   CONST-SRYACT-MAX )
               MOVE    SYS-5000-DSPCD (IDX0)
                                       TO  SPA-GMN-W24-SRYCD  (IDX0)
                                       WRK-SRYCD
               IF    ( WRK-SRYCD   NOT =   SPACE )
                   PERFORM 900-TENSU-KEY-SEL-SEC
                   MOVE    TNS-NAME    TO  SPA-GMN-W24-SRYACT (IDX0)
               END-IF
      *
           END-PERFORM
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÉéÃ´¶èÊ¬
           MOVE    SYS-5000-SENTEI-FTNKBN  TO  WRK-CMB-CD
           PERFORM 4200-SENTEI-FTNKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-SENTEI-FTNKBN-G
           ELSE
               MOVE    SPA-GMN-W24-SENTEI-FTNKBNLST (1)
                                       TO  SPA-GMN-W24-SENTEI-FTNKBN-G
           END-IF
      *
      *    ÁªÄêÎÅÍÜÈñ¡Ý¾ÃÈñÀÇ¶èÊ¬
           MOVE    SYS-5000-SENTEI-TAXKBN  TO  WRK-CMB-CD
           PERFORM 4200-SENTEI-TAXLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-SENTEI-TAX-G
           ELSE
               MOVE    SPA-GMN-W24-SENTEI-TAXLST (1)
                                       TO  SPA-GMN-W24-SENTEI-TAX-G
           END-IF
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á¡Ê¶â³Û¡Ë
           EVALUATE    SYS-5000-SENTEI-FTNKBN
           WHEN    SPACE
               MOVE    CONST-SENTEI-TANKA
                                       TO  SPA-GMN-W24-SENTEI-TANKA
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKAIP
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKARJ
           WHEN    "1"
               IF    ( SYS-5000-SENTEI-TANKA-X     IS  NUMERIC )
                   MOVE    SYS-5000-SENTEI-TANKA
                                       TO  SPA-GMN-W24-SENTEI-TANKA
               ELSE
                   MOVE    ZERO        TO  SPA-GMN-W24-SENTEI-TANKA
               END-IF
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKAIP
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKARJ
           WHEN    "2"
               IF    ( SYS-5000-SENTEI-KINGAKU-X   IS  NUMERIC )
                   MOVE    SYS-5000-SENTEI-KINGAKU
                                       TO  SPA-GMN-W24-SENTEI-TANKA
               ELSE
                   MOVE    ZERO        TO  SPA-GMN-W24-SENTEI-TANKA
               END-IF
               IF    ( SYS-5000-SENTEI-IPN-KINGAKU-X   IS  NUMERIC )
                   MOVE    SYS-5000-SENTEI-IPN-KINGAKU
                                       TO  SPA-GMN-W24-SENTEI-TANKAIP
               ELSE
                   MOVE    ZERO        TO  SPA-GMN-W24-SENTEI-TANKAIP
               END-IF
               IF    ( SYS-5000-SENTEI-RJN-KINGAKU-X   IS  NUMERIC )
                   MOVE    SYS-5000-SENTEI-RJN-KINGAKU
                                       TO  SPA-GMN-W24-SENTEI-TANKARJ
               ELSE
                   MOVE    ZERO        TO  SPA-GMN-W24-SENTEI-TANKARJ
               END-IF
           WHEN    OTHER
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKA
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKAIP
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKARJ
               MOVE    SPACE           TO  SPA-GMN-W24-SENTEI-TAX-G
           END-EVALUATE
      *
      *    Æþ±¡ÎòÉ½¼¨¶èÊ¬
           MOVE    SYS-5000-REKI-DISPKBN   TO  WRK-CMB-CD
           PERFORM 4200-REKI-DISPKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-REKI-DISPKBN-G
           ELSE
               MOVE    SPA-GMN-W24-REKI-DISPKBNLST (1)
                                       TO  SPA-GMN-W24-REKI-DISPKBN-G
           END-IF
      *
      *    Âà±¡ºÆ·×»»¶èÊ¬
           MOVE    SYS-5000-SAIKEISANKBN   TO  WRK-CMB-CD
           PERFORM 4200-SAIKEISANKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-SAIKEISANKBN-G
           ELSE
               MOVE    SPA-GMN-W24-SAIKEISANKBNLST (1)
                                       TO  SPA-GMN-W24-SAIKEISANKBN-G
           END-IF
      *
      *    Æþ¶â¤Î¼è°·¤¤
           MOVE    SYS-5000-NYKNKNRKBN   TO  WRK-CMB-CD
           PERFORM 4200-NYKNKNRKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-NYKNKNRKBN-G
           ELSE
               MOVE    SPA-GMN-W24-NYKNKNRKBNLST (1)
                                       TO  SPA-GMN-W24-NYKNKNRKBN-G
           END-IF
      *
      *    ÀÁµá½ñÈ¯¹ÔÈ¯¹Ô¶èÊ¬
           MOVE    SYS-5000-SKYPRTKBN   TO  WRK-CMB-CD
           PERFORM 4200-SKYPRTKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM         TO  SPA-GMN-W24-SKYPRTKBN-G
           ELSE
               MOVE    SPA-GMN-W24-SKYPRTKBNLST (2)
                                           TO  SPA-GMN-W24-SKYPRTKBN-G
           END-IF
      *
      *    ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬
           MOVE    SYS-5000-SKYMISYUPRTKBN TO  WRK-CMB-CD
           PERFORM 4200-MISYUPRTKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-MISYUPRTKBN-G
           ELSE
               MOVE    SPA-GMN-W24-MISYUPRTKBNLST (1)
                                       TO  SPA-GMN-W24-MISYUPRTKBN-G
           END-IF
      *
      *    ¿ÇÎÅÈñÌÀºÙ½ñÈ¯¹Ô¶èÊ¬
           MOVE    SYS-5000-SRYPRTKBN   TO  WRK-CMB-CD
           PERFORM 4200-SRYPRTKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM         TO  SPA-GMN-W24-SRYPRTKBN-G
           ELSE
               MOVE    SPA-GMN-W24-SRYPRTKBNLST (1)
                                           TO  SPA-GMN-W24-SRYPRTKBN-G
           END-IF
      *
      *    Âà±¡¾ÚÌÀ½ñÈ¯¹Ô¶èÊ¬
           MOVE    SYS-5000-TAIPRTKBN  TO  WRK-CMB-CD
           PERFORM 4200-TAIPRTKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM         TO  SPA-GMN-W24-TAIPRTKBN-G
           ELSE
               MOVE    SPA-GMN-W24-TAIPRTKBNLST (2)
                                           TO  SPA-GMN-W24-TAIPRTKBN-G
           END-IF
      *
      *    Âà±¡¾ÚÌÀ½ñµ­ºÜ¶èÊ¬
           MOVE    SYS-5000-TAIKSIKBN  TO  WRK-CMB-CD
           PERFORM 4200-TAIKSIKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM         TO  SPA-GMN-W24-TAIKSIKBN-G
           ELSE
               MOVE    SPA-GMN-W24-TAIKSIKBNLST (1)
                                           TO  SPA-GMN-W24-TAIKSIKBN-G
           END-IF
      *!!
      *    Âà±¡»þ±¡³°½èÊý¤»¤óÈ¯¹Ô¶èÊ¬
           MOVE    SYS-5000-SHOHOUKBN   TO  WRK-CMB-CD
           PERFORM 4200-SHOHOUKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM     NOT =   SPACE )
               MOVE    WRK-CMB-ITM         TO  SPA-GMN-W24-SHOHOUKBN-G
           ELSE
               MOVE    SPA-GMN-W24-SHOHOUKBNLST (1)
                                           TO  SPA-GMN-W24-SHOHOUKBN-G
           END-IF
      *!!
      *
      *    ¸º»»¾ðÊó
           IF    ( SPA-W01-EDYUKYMD    >=  CONST-H180401 )
               CONTINUE
           ELSE
               PERFORM 3101-GENZAN-EDIT-SEC
           END-IF
           .
       310-INPUT-AREA-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ²Ã»»ÀßÄê½èÍý
      *****************************************************************
       3101-INPUT-AREA-KSN-SET-SEC     SECTION.
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   CONST-NYUKSN-MAX )
      *
               MOVE    "F"     TO  SPA-GMN-W24-CHK-NYUKSN (IDX0)
      *
               EVALUATE    SPA-NAI-W24-NYUKSN-SRYCD (IDX0)
               WHEN    SPACE
                   CONTINUE
               WHEN    OTHER
                   PERFORM VARYING IDX-SYS FROM    1   BY  1
                           UNTIL ( IDX-SYS >   CONST-NYUKSN-MAX )
      *
                       IF    ( SPA-NAI-W24-NYUKSN-SRYCD (IDX0)
                                           =   SYS-5000-KSNCD (IDX-SYS))
                           IF    ( SYS-5000-KSNKBN (IDX-SYS)
                                           =   "2" )
                               MOVE    "T"
                                   TO   SPA-GMN-W24-CHK-NYUKSN (IDX0)
                           END-IF
                       END-IF
      *
      *
                   END-PERFORM
      *
               END-EVALUATE
      *
           END-PERFORM
      *
           .
       3101-INPUT-AREA-KSN-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¸º»»¾ðÊóÊÔ½¸½èÍý
      *****************************************************************
       3101-GENZAN-EDIT-SEC            SECTION.
      *
           IF    ( SPA-W01-EDYUKYMD   >=   CONST-H160401 )
               MOVE    16          TO  IDX0
           ELSE
               MOVE    14          TO  IDX0
           END-IF
      *
           MOVE    2               TO  IDX1
      *
           PERFORM UNTIL ( IDX1    >   4 )
      *
               IF    ( SYS-5000-GENKBN (IDX1)  =   "2" )
                   MOVE    "T"     TO  SPA-GMN-W24-CHK-NYUKSN (IDX0)
               END-IF
      *
               COMPUTE IDX0    =   IDX0    +   1
               COMPUTE IDX1    =   IDX1    +   1
      *
           END-PERFORM
      *
           .
       3101-GENZAN-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    °åÎÅµ¡´ØÆþ±¡´ðËÜ¾ðÊó¸¡º÷½èÍý
      *****************************************************************
       310-SYS-5000-SEL-SEC        SECTION.
      *
      *    °åÎÅµ¡´ØÆþ±¡´ðËÜ¾ðÊó¸¡º÷
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    SPA-W01-STYUKYMD    TO  SYS-STYUKYMD
                                           SYS-EDYUKYMD
           PERFORM 900-SYSKANRI-KEY10-SEL-SEC
           MOVE    MCPDATA-REC         TO  SYS-5000-REC
      *
           .
      *
       310-SYS-5000-SEL-EXT.
           EXIT.
      *****************************************************************
      *    °åÎÅµ¡´ØÆþ±¡´ðËÜ¾ðÊó¸¡º÷½èÍý¡Ê´ü´ÖÀÚ¤êÂØ¤¨»þ¡Ë
      *****************************************************************
       311-SYS-5000-SEL-SEC        SECTION.
      *
      *    °åÎÅµ¡´ØÆþ±¡´ðËÜ¾ðÊó¸¡º÷
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    SPA-W01-STYUKYMD    TO  SYS-STYUKYMD
           PERFORM 900-SYSKANRI-KEY16-SEL-SEC
           MOVE    MCPDATA-REC         TO  SYS-5000-REC
           .
      *
       311-SYS-5000-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¥»¥Ã¥È½èÍý
      *****************************************************************
       320-W25SPASET-SEC           SECTION.
      *
           IF    ( SPA-W25-SRYCD   NOT =   SPACE )
               MOVE    SPA-GMN-W24-MOTOIDX
                                       TO  IDXZ
               MOVE    SPA-W25-SRYCD   TO  SPA-GMN-W24-SRYCD (IDXZ)
               PERFORM 4101-SRYCD-CHK-SEC
           ELSE
               COMPUTE SPA-GMN-W24-CUR =   SPA-GMN-W24-MOTOIDX +   28
           END-IF 
           .
       320-W25SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³ÎÇ§²èÌÌ¡Ê£Ã£É£Ä£±¡Ë£Ï£Ë½èÍý
      *****************************************************************
       330-WID1-SET-SEC            SECTION.
      *
           IF    ( SPA-WID1-FLG    =   "OK" )
               EVALUATE    SPA-WIDCD
               WHEN "3001"
                   PERFORM 481-TOUROKU-SEC
               WHEN "3002"
                   PERFORM 431-DEL-SEC
               END-EVALUATE
           END-IF
      *
      *
           .
       330-WID1-SET-EXT.
           EXIT.
      *****************************************************************
      *    ²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       200-GMNSENI                           SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO      MCP-WIDGET
      *    Ìá¤ë
           WHEN    "CLICKED"       ALSO    "B01"
               MOVE   "CHANGE"             TO  MCP-PUTTYPE
               PERFORM  210-BACK
      *    ¥¯¥ê¥¢
           WHEN    "CLICKED"       ALSO    "B02"
               PERFORM 420-CLEAR-SEC
      *    ºï½ü
           WHEN    "CLICKED"       ALSO    "B03"
               PERFORM 430-DEL-SEC
      *    ÅÐÏ¿
           WHEN    "CLICKED"       ALSO    "B12"
               PERFORM 480-TOUROKU-SEC
      *    Æþ±¡²Ã»»¾ðÊó
           WHEN    "CLICKED"       ALSO    "CHK_NYUKSN01"
                                   THRU    "CHK_NYUKSN20"
      *
      *        ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È
               PERFORM 400-GMN-INPUT-SEC
      *        ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
               PERFORM 410-INPUT-CHK-SEC
      *
           END-EVALUATE
           .
      *
       200-GMNSENI-EXT.
           EXIT.
      *****************************************************************
      *    ²ñÏÃ¡¡½èÍý
      *****************************************************************
       200-ENTRY                             SECTION.
      *
      *    EVALUATE    MCP-EVENT   ALSO    MCP-WIDGET
      *
      *    WHEN    OTHER
      *
      *        ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È
               PERFORM 400-GMN-INPUT-SEC
      *        ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
               PERFORM 410-INPUT-CHK-SEC
      *    END-EVALUATE
      *
           .
      *
       200-ENTRY-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È½èÍý
      *****************************************************************
       400-GMN-INPUT-SEC          SECTION.
      *
           MOVE    ZERO        TO      SPA-GMN-W24-CUR
      *
           .
      *
       400-GMN-INPUT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       410-INPUT-CHK-SEC          SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *
      *    ´ðËÜ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4102-KIHON-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
             OR  ( FLG-END     NOT =   ZERO  )
               GO  TO  410-INPUT-CHK-EXT
           END-IF
      *
           .
      *
       410-INPUT-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ£Ó£Ð£ÁÊÔ½¸½èÍý
      *****************************************************************
       4101-GMN-SPA-SET-SEC            SECTION.
      *
      *    Æþ±¡»þ¿©»öÎÅÍÜ
           MOVE    W24-SKJRYOYO        TO  SPA-GMN-W24-SKJRYOYO-G
      *
      *    ¿©»ö¿ÇÎÅ¹Ô°Ù
           MOVE    W24-SYOKUJI (1)     TO  SPA-GMN-W24-SKJSRY-OCC (1)
      *
      *    ¿©»ö¿ÇÎÅ¹Ô°Ù
           MOVE    W24-SYOKUJI (2)     TO  SPA-GMN-W24-SKJSRY-OCC (2)
      *
      *    ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¶èÊ¬
           MOVE    W24-BRMSGK-TAX      TO  SPA-GMN-W24-BRMSGK-TAX-G
      *    Æþ±¡²ñ·×¼¼ÎÁº¹³Û¶èÊ¬
           MOVE    W24-NACCT-BRMSGK    TO  SPA-GMN-W24-NACCT-BRMSGK-G
      *    Æþ±¡²ñ·×³°Çñ¶èÊ¬
           MOVE    W24-NACCT-GAIHAKU   TO  SPA-GMN-W24-NACCT-GAIHAKU-G
      *
      *    Æþ±¡²Ã»»¾ðÊó
           PERFORM VARYING     IDX1    FROM    1   BY  1
                   UNTIL     ( IDX1    >   20 )
               MOVE    W24-CHK-NYUKSN (IDX1)
                                   TO  SPA-GMN-W24-CHK-NYUKSN (IDX1)
           END-PERFORM
      *
      *    Æþ±¡²ñ·×É½¼¨¾ðÊó
           PERFORM VARYING     IDX1    FROM    1   BY  1
                   UNTIL     ( IDX1    >   10 )
               MOVE    W24-SRYCD (IDX1)
                                   TO  SPA-GMN-W24-SRYCD (IDX1)
           END-PERFORM
      *
      *    ÃÏ°è²Ã»»
           MOVE    W24-CHIIKIKSN       TO  SPA-GMN-W24-CHIIKIKSN-G
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÉéÃ´¶èÊ¬
           MOVE    W24-SENTEI-FTNKBN   TO  SPA-GMN-W24-SENTEI-FTNKBN-G
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á
           MOVE    W24-SENTEI-TANKA    TO  SPA-GMN-W24-SENTEI-TANKA
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á¡Ê°ìÈÌ¡Ë
           MOVE    W24-SENTEI-TANKAIP  TO  SPA-GMN-W24-SENTEI-TANKAIP
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á¡ÊÏ·¿Í¡Ë
           MOVE    W24-SENTEI-TANKARJ  TO  SPA-GMN-W24-SENTEI-TANKARJ
      *
      *    ÁªÄêÎÅÍÜÈñ¡Ý¾ÃÈñÀÇ
           MOVE    W24-SENTEI-TAX      TO  SPA-GMN-W24-SENTEI-TAX
      *
      *    Æþ±¡ÎòÉ½¼¨¶èÊ¬
           MOVE    W24-REKI-DISPKBN    TO  SPA-GMN-W24-REKI-DISPKBN-G
      *
      *    Âà±¡ºÆ·×»»¶èÊ¬
           MOVE    W24-SAIKEISANKBN    TO  SPA-GMN-W24-SAIKEISANKBN-G
      *
      *    Æþ¶â¤Î¼è°·¤¤
           MOVE    W24-NYKNKNRKBN      TO  SPA-GMN-W24-NYKNKNRKBN-G
      *
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬
           MOVE    W24-SKYPRTKBN       TO  SPA-GMN-W24-SKYPRTKBN-G
      *
      *    ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬
           MOVE    W24-SKYMISYUPRTKBN  TO  SPA-GMN-W24-MISYUPRTKBN-G
      *
      *    ¿ÇÎÅÈñÌÀºÙ½ñÈ¯¹Ô¶èÊ¬
           MOVE    W24-SRYPRTKBN       TO  SPA-GMN-W24-SRYPRTKBN-G
      *
      *    Âà±¡¾ÚÌÀ½ñÈ¯¹Ô¶èÊ¬
           MOVE    W24-TAIPRTKBN       TO  SPA-GMN-W24-TAIPRTKBN-G
      *
      *    Âà±¡¾ÚÌÀ½ñµ­ºÜ¶èÊ¬
           MOVE    W24-TAIKSIKBN       TO  SPA-GMN-W24-TAIKSIKBN-G
      *
      *    É¸·ç¸º³Û¶èÊ¬
           MOVE    W24-HYOUKETU        TO  SPA-GMN-W24-HYOUKETU-G
      *
      *    Äê¿ôÄ¶²á¶èÊ¬
           MOVE    W24-TEISU           TO  SPA-GMN-W24-TEISU-G
      *
      *    £Á£Ä£Ì¶èÊ¬
           MOVE    W24-ADLINPUT        TO  SPA-GMN-W24-ADLINPUT-G
      *
      *    Äê´üÀÁµáº¹³Û½é´üÉ½¼¨¶èÊ¬
           MOVE    W24-TEIKISAGAKUACT  TO  SPA-GMN-W24-TEIKISAGAKUACT-G
      *
      *    ÎÅÍÜÆþ±¡É½¼¨¶èÊ¬
           MOVE    W24-RYOYODSP        TO  SPA-GMN-W24-RYOYODSP-G
      *
      *    Âà±¡»þ±¡³°½èÊý¤»¤ó¶èÊ¬
           MOVE    W24-SHOHOUKBN       TO  SPA-GMN-W24-SHOHOUKBN-G
      *
           .
      *
       4101-GMN-SPA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´ðËÜ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4102-KIHON-CHK-SEC              SECTION.
      *
      *    Æþ±¡»þ¿©»öÎÅÍÜ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SKJRYOYO-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ¿©»ö¿ÇÎÅ¹Ô°Ù¥Á¥§¥Ã¥¯½èÍý
           PERFORM VARYING IDX-SKJ     FROM    1   BY  1
                   UNTIL ( IDX-SKJ     >   CONST-SKJSRY-MAX )
                    OR   ( SPA-NAI-W24-SKJSRY-SRYCD (IDX-SKJ) )
               PERFORM 4101-SKJSRY-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
           END-PERFORM
      *
      *    ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¶èÊ¬
           PERFORM 4101-BRMSGK-TAX-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Æþ±¡²ñ·×¼¼ÎÁº¹³Û¶èÊ¬
           PERFORM 4101-NACCT-BRMSGK-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Æþ±¡²ñ·×³°Çñ¶èÊ¬
           PERFORM 4101-NACCT-GAIHAKU-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Æþ±¡²Ã»»¾ðÊó¥Á¥§¥Ã¥¯½èÍý
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL ( IDX1    >   20 )
               PERFORM 4101-CHK-NYUKSN-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
           END-PERFORM
      *
      *    Æþ±¡²Ã»»¾ðÊó¥Á¥§¥Ã¥¯½èÍý-»ÜÀß´ð½à¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SSTKIJUN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ÃÏ°è²Ã»»¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-CHIIKIKSN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Æþ±¡²ñ·×É½¼¨¾ðÊó¥Á¥§¥Ã¥¯½èÍý
           PERFORM VARYING IDXZ    FROM    1   BY  1
                   UNTIL ( IDXZ    >   10 )
               PERFORM 4101-SRYCD-CHK-SEC
               IF    ( SPA-ERRCD   NOT =   SPACE )
                 OR  ( FLG-END     NOT =   ZERO  )
                   GO  TO  4102-KIHON-CHK-EXT
               END-IF
           END-PERFORM
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÉéÃ´¶èÊ¬
           PERFORM 4101-SENTEI-FTNKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á
           PERFORM 4101-SENTEI-TANKA-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á¡Ê°ìÈÌ¡Ë
           PERFORM 4101-SENTEI-TANKAIP-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á¡ÊÏ·¿Í¡Ë
           PERFORM 4101-SENTEI-TANKARJ-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ÁªÄêÎÅÍÜÈñ¡Ý¾ÃÈñÀÇ
           PERFORM 4101-SENTEI-TAX-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Æþ±¡ÎòÉ½¼¨¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-REKI-DISPKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Âà±¡ºÆ·×»»¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SAIKEISANKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Æþ¶â¤Î¼è°·¤¤¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-NYKNKNRKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SKYPRTKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-MISYUPRTKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    ¿ÇÎÅÈñÌÀºÙ½ñÈ¯¹Ô¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SRYPRTKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Âà±¡¾ÚÌÀ½ñÈ¯¹Ô¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4100-TAIPRTKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Âà±¡¾ÚÌÀ½ñµ­ºÜ¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4100-TAIKSIKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    É¸·ç¸º³Û¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4100-HYOUKETU-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Äê¿ôÄ¶²á¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4100-TEISU-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    £Á£Ä£ÌÆþÎÏ¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4100-ADLINPUT-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *    Äê´üÀÁµáº¹³Û½é´üÉ½¼¨¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4100-TEIKISAGAKUACT-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
      *!!
      *    Âà±¡»þ±¡³°½èÊý¤»¤óÈ¯¹Ô¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4101-SHOHOUKBN-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *!!
      *
      *    ÎÅÍÜÆþ±¡É½¼¨¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
           PERFORM 4100-RYOYODSP-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  4102-KIHON-CHK-EXT
           END-IF
      *
           .
      *
       4102-KIHON-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Ìá¤ë¡¡½èÍý
      *****************************************************************
       210-BACK                    SECTION.
      *
           MOVE    "W01"               TO  SPA-SAKIPG
           MOVE    "W24"               TO  SPA-MOTOPG
      *
      ***  MOVE   "CHANGE"             TO  MCP-PUTTYPE
           MOVE    "W01"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
       210-BACK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸¡º÷½èÍý
      *****************************************************************
       409-KENSAKU-SEC             SECTION.
      *
           MOVE    IDXZ                TO  SPA-GMN-W24-MOTOIDX
           PERFORM 5011-INPUT-CUR-SEC
      *
      *    ¶¦ÄÌ£Ó£Ð£ÁÊÔ½¸
           INITIALIZE                  SPA-W25-AREA
           MOVE    "2"                 TO  SPA-W25-TYPE
      *
           INITIALIZE                  SPA-W25GMN-AREA
           IF      WRK-INPUTCD         NOT =   SPACE
      *        ¿ÇÎÅ¹Ô°Ù¤Ç¸¡º÷¡Ê¥ª¥ê¥¸¥Ê¥ë¤Î£Ú£¹£¸¤ÏÆâÉþ¡Ë
               MOVE    "8"                 TO  SPA-W25-GMN-SYORI
      *        MOVE    "3"                 TO  SPA-W25-GMN-SYORI
               MOVE    WRK-INPUTCD         TO  SPA-W25-INPUTCD
               MOVE    "1"                 TO  SPA-W25-TYPE
               IF      FLG-KANJI           =   1
                   MOVE    "J"             TO  SPA-W25-CDSYUBETU
               ELSE
                   IF      WRK-INPUTCD(1:1)    NUMERIC
                       EVALUATE    WRK-CD-MCNT
                           WHEN    3
                           WHEN    6
                               MOVE    "6"     TO  SPA-W25-CDSYUBETU
                           WHEN    4
                               MOVE    "4"     TO  SPA-W25-CDSYUBETU
                           WHEN    5
                               MOVE    "5"     TO  SPA-W25-CDSYUBETU
                       END-EVALUATE
                   ELSE
                       MOVE    "A"             TO  SPA-W25-CDSYUBETU
                   END-IF
               END-IF
      *        ²èÌÌÊÔ½¸
               PERFORM 41011-W25-SET-SEC
      *        ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¤Ç¡¢ÂÐ¾Ý¥Ç¡¼¥¿¤Ê¤·¤Î»þ¡¢¿ÇÎÅ¹Ô°Ù¤Ç¸¡º÷¤¹¤ë
               IF     (SPA-W25-GMN-MAX     =   ZERO )  AND
                      (SPA-W25-CDSYUBETU   =   "J"  )
                   INITIALIZE                  SPA-W25GMN-AREA
                   MOVE    "8"                 TO  SPA-W25-GMN-SYORI
      *            ²èÌÌÊÔ½¸
                   PERFORM 41011-W25-SET-SEC
               END-IF
           ELSE
      *        ²èÌÌÊÔ½¸
               PERFORM 41011-W25-SET-SEC
           END-IF
      *
           MOVE    "W24"               TO  SPA-MOTOPG
           MOVE    "W25"               TO  SPA-SAKIPG
           MOVE    "W24"               TO  SPA-W25-MOTOPG
      *
           IF      SPA-W25-GMN-MAX     =   ZERO
               MOVE    "INPUT"             TO  MCP-WIDGET
           ELSE
               MOVE    "SELNUM1"           TO  MCP-WIDGET
           END-IF
      *
           MOVE   "NEW"                TO  MCP-PUTTYPE.
           MOVE   "W25    "            TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
      *
           .
       409-KENSAKU-EXT.
           EXIT.
      *****************************************************************
      *    ¸¡º÷²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       41011-W25-SET-SEC                           SECTION.
      *
           MOVE    SPACE               TO  SPA-MOTOPG
           MOVE    SPA-W01KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-W25-GMN-AREA    TO  SPA-W25-KYOUTU
           MOVE    SPA-W24FREE         TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGW25"           USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA.
      *
           MOVE    SPA-COMMON          TO  SPA-AREA
           MOVE    SPA-WORK            TO  SPA-W01KYOUTU
           MOVE    SPA-FREE            TO  SPA-W24FREE
           MOVE    SPA-W25-KYOUTU      TO  SPA-W25-GMN-AREA
      *
           .
       41011-W25-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¾ò·ï¥¯¥ê¥¢½èÍý
      *****************************************************************
       420-CLEAR-SEC               SECTION.
      *
           PERFORM 4201-INPUT-AREA-INIT-SEC
           .
       420-CLEAR-EXT.
           EXIT.
      *****************************************************************
      *    ºï½ü½èÍý
      *****************************************************************
       430-DEL-SEC                 SECTION.
      *
           MOVE    "3002"          TO  SPA-WIDCD
      *
           .
       430-DEL-EXT.
           EXIT.
      *****************************************************************
      *    ºï½ü½èÍý
      *****************************************************************
       431-DEL-SEC                 SECTION.
      *
           INITIALIZE                      SYS-5000-REC
           MOVE    SPA-HOSPNUM         TO  SYS-5000-HOSPNUM
           MOVE    "5000"              TO  SYS-5000-KANRICD
           MOVE    "*"                 TO  SYS-5000-KBNCD
           MOVE    SPA-W01-STYUKYMD    TO  SYS-5000-STYUKYMD
           MOVE    SPA-W01-EDYUKYMD    TO  SYS-5000-EDYUKYMD
           MOVE    SYS-5000-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBDELETE-SEC
           IF    ( MCP-RC          =   ZERO )
               MOVE   "JOIN"           TO  MCP-PUTTYPE
               PERFORM 210-BACK
           ELSE
               MOVE    "1202"          TO  SPA-ERRCD
           END-IF
      *
           .
       431-DEL-EXT.
           EXIT.
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       480-TOUROKU-SEC             SECTION.
      *
      *    ÆþÎÏ¸Ä½ê¤Î¥Á¥§¥Ã¥¯
           PERFORM 410-INPUT-CHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
             OR  ( FLG-END     NOT =   ZERO  )
               GO  TO  480-TOUROKU-EXT
           END-IF
      *
           PERFORM 4900-KANRENCHK-SEC
           IF    ( SPA-ERRCD   NOT =   SPACE )
               GO  TO  480-TOUROKU-EXT
           END-IF
      *
           MOVE    "3001"          TO  SPA-WIDCD
      *
           .
       480-TOUROKU-EXT.
           EXIT.
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       481-TOUROKU-SEC                 SECTION.
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           IF    ( SPA-W01-SELNUM      >   ZERO )
               MOVE    SPA-W01-SEL-STYUKYMD    TO  SYS-STYUKYMD
               MOVE    SPA-W01-SEL-EDYUKYMD    TO  SYS-EDYUKYMD
           ELSE
               MOVE    SPA-W01-STYUKYMD        TO  SYS-STYUKYMD
               MOVE    SPA-W01-EDYUKYMD        TO  SYS-EDYUKYMD
           END-IF
           PERFORM 900-SYSKANRI-KEY10-SEL-SEC
           IF    ( FLG-SYSKANRI        =   ZERO )
      *
               MOVE    SYSKANRI-REC        TO  SYS-5000-REC
      *
               MOVE    SYS-5000-STYUKYMD   TO  WRK-STYUKYMD
               MOVE    SYS-5000-EDYUKYMD   TO  WRK-EDYUKYMD
               MOVE    SYS-5000-CREYMD     TO  WRK-CREYMD
               PERFORM 4811-HOSP-NYUINKHN-EDIT-SEC
      *
               PERFORM 800-MCNDATE-SEC
               MOVE    WRK-CREYMD          TO  SYS-5000-CREYMD
               MOVE    SMCNDATE-YMD        TO  SYS-5000-UPYMD
               MOVE    SMCNDATE-HMS        TO  SYS-5000-UPHMS
      *
               MOVE    SYS-5000-REC        TO  SYSKANRI-REC
               MOVE    SYS-5000-HOSPNUM    TO  SYSUP-HOSPNUM
               MOVE    SYS-5000-KANRICD    TO  SYSUP-KANRICD
               MOVE    SYS-5000-KBNCD      TO  SYSUP-KBNCD
               MOVE    WRK-STYUKYMD        TO  SYSUP-STYUKYMD
               MOVE    WRK-EDYUKYMD        TO  SYSUP-EDYUKYMD
               MOVE    SYSKANRI-REC        TO  MCPDATA-REC
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "upd1"              TO  MCP-PATHNAME
               PERFORM 910-DBUPDATE-SEC
           ELSE
               PERFORM 4811-HOSP-NYUINKHN-EDIT-SEC
      *
               PERFORM 800-MCNDATE-SEC
               MOVE    SMCNDATE-YMD        TO  SYS-5000-CREYMD
                                               SYS-5000-UPYMD
               MOVE    SMCNDATE-HMS        TO  SYS-5000-UPHMS
      *
               MOVE    SYS-5000-REC        TO  MCPDATA-REC
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 910-DBINSERT-SEC
           END-IF
      *
           IF    ( MCP-RC          =   ZERO )
               MOVE    "JOIN"          TO  MCP-PUTTYPE
               PERFORM 210-BACK
           ELSE
               MOVE    "1201"          TO  SPA-ERRCD
           END-IF
      *
      *
           .
       481-TOUROKU-EXT.
           EXIT.
      *****************************************************************
      *    °åÎÅµ¡´ØÆþ±¡´ðËÜ¾ðÊóÊÔ½¸½èÍý
      *****************************************************************
       4811-HOSP-NYUINKHN-EDIT-SEC     SECTION.
      *
           INITIALIZE                  SYS-5000-REC
      *
           MOVE    SPA-HOSPNUM         TO  SYS-5000-HOSPNUM
      *
      *    ´ÉÍý¥³¡¼¥É
           MOVE    "5000"              TO  SYS-5000-KANRICD
      *    ¶èÊ¬¥³¡¼¥É
           MOVE    "*"                 TO  SYS-5000-KBNCD
      *    Í­¸ú³«»ÏÇ¯·îÆü
           MOVE    SPA-W01-STYUKYMD    TO  SYS-5000-STYUKYMD
      *    Í­¸ú½ªÎ»Ç¯·îÆü
           MOVE    SPA-W01-EDYUKYMD    TO  SYS-5000-EDYUKYMD
      *    ¿©»öÎÅÍÜÈñ
           EVALUATE    SPA-GMN-W24-SKJRYOYO
           WHEN    "1"
               MOVE    CONST-SHOKUJIRYOYOCD (1)
                                       TO  SYS-5000-SHOKUJIRYOYOCD
           WHEN    "2"
               MOVE    CONST-SHOKUJIRYOYOCD (2)
                                       TO  SYS-5000-SHOKUJIRYOYOCD
           END-EVALUATE
      *
      *    ÆÃÊÌ´ÉÍý²Ã»»
           IF    ( SPA-W01-EDYUKYMD    >=  CONST-H180401 )
               CONTINUE
           ELSE
               PERFORM VARYING IDX-SKJ FROM    1   BY  1
                       UNTIL ( IDX-SKJ >   CONST-SKJSRY-MAX )
                        OR   ( SPA-NAI-W24-SKJSRY-SRYCD (IDX-SKJ)
                                       =   SPACE )
      *
                   IF    ( SPA-NAI-W24-SKJSRY-SRYCD (IDX-SKJ)
                                   =   "197000270" )
                       MOVE    SPA-NAI-W24-SKJSRY-SRYCD (IDX-SKJ)
                                       TO  SYS-5000-SHOKUCD  (1)
                       MOVE    SPA-GMN-W24-SKJSRY (IDX-SKJ)
                                       TO  SYS-5000-SHOKUKBN (1)
                   END-IF
               END-PERFORM
           END-IF
      *
      *    ¿©Æ²²Ã»»
           PERFORM VARYING IDX-SKJ FROM    1   BY  1
                   UNTIL ( IDX-SKJ >   CONST-SKJSRY-MAX )
                    OR   ( SPA-NAI-W24-SKJSRY-SRYCD (IDX-SKJ)
                                       =   SPACE )
      *
               IF    ( SPA-NAI-W24-SKJSRY-SRYCD (IDX-SKJ)
                               =   "197000570" )
                   MOVE    SPA-NAI-W24-SKJSRY-SRYCD (IDX-SKJ)
                                   TO  SYS-5000-SHOKUCD  (2)
                   MOVE    SPA-GMN-W24-SKJSRY (IDX-SKJ)
                                   TO  SYS-5000-SHOKUKBN (2)
               END-IF
           END-PERFORM
      *
      *    ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¶èÊ¬
           MOVE    SPA-GMN-W24-BRMSGK-TAX
                                   TO  SYS-5000-BRMSGK-TAXKBN
      *
      *    Æþ±¡²ñ·×¼¼ÎÁº¹³Û¶èÊ¬
           MOVE    SPA-GMN-W24-NACCT-BRMSGK
                                   TO  SYS-5000-NACCT-BRMSGKKBN
      *
      *    Æþ±¡²ñ·×³°Çñ¶èÊ¬
           MOVE    SPA-GMN-W24-NACCT-GAIHAKU
                                   TO  SYS-5000-NACCT-GAIHAKUKBN
      *
           EVALUATE    TRUE
           WHEN  ( SPA-W01-EDYUKYMD   >=   CONST-H220401 )
               MOVE    15          TO  WRK-MAX
           WHEN  ( SPA-W01-EDYUKYMD   >=   CONST-H180401 )
               MOVE    13          TO  WRK-MAX
           WHEN  ( SPA-W01-EDYUKYMD   >=   CONST-H160401 )
               MOVE    15          TO  WRK-MAX
           WHEN    OTHER
               MOVE    13          TO  WRK-MAX
           END-EVALUATE
      *
      *    Æþ±¡ÎÁ²Ã»»¾ðÊó
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL ( IDX1    >   WRK-MAX )
               MOVE    SPA-NAI-W24-NYUKSN-SRYCD (IDX1)
                                   TO  SYS-5000-KSNCD (IDX1)
               IF    ( SPA-GMN-W24-CHK-NYUKSN (IDX1)
                                   =   "F" )
                   MOVE    "1"     TO  SYS-5000-KSNKBN (IDX1)
               ELSE
                   MOVE    "2"     TO  SYS-5000-KSNKBN (IDX1)
               END-IF
           END-PERFORM
      *
      *    ÃÏ°è²Ã»»¾ðÊó
           IF    ( SPA-GMN-W24-CHIIKIKSN   >=  "1")
            AND  ( SPA-GMN-W24-CHIIKIKSN   <=  "6" )
               MOVE    SPA-GMN-W24-CHIIKIKSN   TO  WRK-CHIIKIKSN-G
               IF    ( SYS-5000-STYUKYMD   >=  CONST-H180401 )
                   MOVE    CONST-CHIIKIKSN-H1804 (WRK-CHIIKIKSN)
                                   TO  SYS-5000-CHIIKIKSN
               ELSE
                   MOVE    CONST-CHIIKIKSN-SRYCD (WRK-CHIIKIKSN)
                                   TO  SYS-5000-CHIIKIKSN
               END-IF
           END-IF
      *
      *    Æþ±¡²ñ·×¥Æ¡¼¥Ö¥ëÉ½¼¨¾ðÊó
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL ( IDX1    >    10 )
               MOVE    SPA-GMN-W24-SRYCD (IDX1)
                                   TO  SYS-5000-DSPCD (IDX1)
           END-PERFORM
      *
      *    ÁªÄêÆþ±¡ÉéÃ´¶èÊ¬
           MOVE    SPA-GMN-W24-SENTEI-FTNKBN
                                   TO  SYS-5000-SENTEI-FTNKBN
      *
      *    ÁªÄêÆþ±¡¾ÃÈñÀÇ¶èÊ¬
           MOVE    SPA-GMN-W24-SENTEI-TAX
                                   TO  SYS-5000-SENTEI-TAXKBN
      *    ÁªÄêÆþ±¡Ã±²Á¡Ê¶â³Û¡Ë
           EVALUATE    SPA-GMN-W24-SENTEI-FTNKBN
           WHEN    "1"
               MOVE    SPA-GMN-W24-SENTEI-TANKA
                                   TO  SYS-5000-SENTEI-TANKA
               MOVE    ZERO        TO  SYS-5000-SENTEI-KINGAKU
           WHEN    "2"
               MOVE    ZERO        TO  SYS-5000-SENTEI-TANKA
               MOVE    SPA-GMN-W24-SENTEI-TANKA
                                   TO  SYS-5000-SENTEI-KINGAKU
               MOVE    SPA-GMN-W24-SENTEI-TANKAIP
                                   TO  SYS-5000-SENTEI-IPN-KINGAKU
               MOVE    SPA-GMN-W24-SENTEI-TANKARJ
                                   TO  SYS-5000-SENTEI-RJN-KINGAKU
           WHEN    OTHER
               MOVE    ZERO        TO  SYS-5000-SENTEI-KINGAKU
               MOVE    ZERO        TO  SYS-5000-SENTEI-IPN-KINGAKU
               MOVE    ZERO        TO  SYS-5000-SENTEI-RJN-KINGAKU
           END-EVALUATE
      *
      *    Æþ±¡ÎòÉ½¼¨¶èÊ¬
           MOVE    SPA-GMN-W24-REKI-DISPKBN
                                   TO  SYS-5000-REKI-DISPKBN
      *    Âà±¡ºÆ·×»»¶èÊ¬
           MOVE    SPA-GMN-W24-SAIKEISANKBN
                                   TO  SYS-5000-SAIKEISANKBN
      *    Æþ¶â¤Î¼è°·¤¤
           MOVE    SPA-GMN-W24-NYKNKNRKBN
                                   TO  SYS-5000-NYKNKNRKBN
      *
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬
           MOVE    SPA-GMN-W24-SKYPRTKBN
                                   TO  SYS-5000-SKYPRTKBN
      *
      *    ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬
           MOVE    SPA-GMN-W24-MISYUPRTKBN
                                   TO  SYS-5000-SKYMISYUPRTKBN
      *
      *    ¿ÇÎÅÈñÌÀºÙ½ñÈ¯¹Ô¶èÊ¬
           MOVE    SPA-GMN-W24-SRYPRTKBN
                                   TO  SYS-5000-SRYPRTKBN
      *
      *    Âà±¡¾ÚÌÀ½ñÈ¯¹Ô¶èÊ¬
           MOVE    SPA-GMN-W24-TAIPRTKBN
                                   TO  SYS-5000-TAIPRTKBN
      *
      *    Âà±¡¾ÚÌÀ½ñµ­ºÜ¶èÊ¬
           MOVE    SPA-GMN-W24-TAIKSIKBN
                                   TO  SYS-5000-TAIKSIKBN
      *
      *    É¸·ç¸º³Û¶èÊ¬
           MOVE    SPA-GMN-W24-HYOUKETU
                                   TO  SYS-5000-HYOUKETUKBN
      *
      *    Äê¿ôÄ¶²á¶èÊ¬
           MOVE    SPA-GMN-W24-TEISU
                                   TO  SYS-5000-TEISUKBN
      *
      *    £Á£Ä£ÌÆþÎÏ¶èÊ¬
           MOVE    SPA-GMN-W24-ADLINPUT
                                   TO  SYS-5000-ADLINPUTKBN
      *
      *    Äê´üÀÁµáº¹³Û½é´üÉ½¼¨¶èÊ¬
           MOVE    SPA-GMN-W24-TEIKISAGAKUACT
                                   TO  SYS-5000-TEIKISAGAKUACTKBN
      *
      *    ÎÅÍÜÆþ±¡É½¼¨¶èÊ¬
           MOVE    SPA-GMN-W24-RYOYODSP
                                   TO  SYS-5000-RYOYODSPKBN
      *
      *    ¸º»»¾ðÊó
           IF    ( SPA-W01-EDYUKYMD    >=  CONST-H180401 )
               CONTINUE
           ELSE
               PERFORM 48111-GENZAN-EDIT-SEC
           END-IF
      *
      *    Âà±¡»þ±¡³°½èÊý¤»¤óÈ¯¹Ô¶èÊ¬
           MOVE    SPA-GMN-W24-SHOHOUKBN
                                   TO  SYS-5000-SHOHOUKBN
      *
           .
      *
       4811-HOSP-NYUINKHN-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ¸º»»¾ðÊóÊÔ½¸½èÍý
      *****************************************************************
       48111-GENZAN-EDIT-SEC           SECTION.
      *
           IF    ( SPA-W01-EDYUKYMD   >=   CONST-H160401 )
               MOVE    16          TO  IDX0
           ELSE
               MOVE    14          TO  IDX0
           END-IF
      *
           MOVE    2               TO  IDX1
      *
           PERFORM UNTIL ( IDX1    >   CONST-GEN-MAX )
      *
               MOVE    CONST-GENCD (IDX1)
                                   TO  SYS-5000-GENCD (IDX1)
      *
               IF    ( SPA-GMN-W24-CHK-NYUKSN (IDX0)   =   "T" )
                   MOVE    "2"     TO  SYS-5000-GENKBN (IDX1)
               ELSE
                   MOVE    "1"     TO  SYS-5000-GENKBN (IDX1)
               END-IF
      *
               COMPUTE IDX0    =   IDX0    +   1
               COMPUTE IDX1    =   IDX1    +   1
      *
           END-PERFORM
      *
           .
      *
       48111-GENZAN-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡»þ¿©»öÎÅÍÜ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SKJRYOYO-CHK-SEC           SECTION.
      *
           IF    ( SPA-GMN-W24-SKJRYOYO-G  =   SPACE )
               GO  TO  4101-SKJRYOYO-CHK-EXT
           END-IF
      *
      *    ³ºÅö¥³¡¼¥É¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¤«¥Á¥§¥Ã¥¯
           MOVE    SPA-GMN-W24-SKJRYOYO
                                   TO  WRK-CMB-CD
           PERFORM 4200-SKJRYOYOLST-CHK-SEC
           IF   (  WRK-CMB-ITM     =   SPACE )
               MOVE    1           TO  SPA-GMN-W24-CUR
               MOVE    "0005"      TO  SPA-ERRCD
           ELSE
               MOVE    WRK-CMB-ITM TO  SPA-GMN-W24-SKJRYOYO
           END-IF
      *
           .
      *
       4101-SKJRYOYO-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¿©»ö¿ÇÎÅ¹Ô°Ù¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SKJSRY-CHK-SEC         SECTION.
      *
           IF    ( SPA-GMN-W24-SKJSRY-OCC (IDX-SKJ)
                                       =   SPACE )
               MOVE   "1"          TO  WRK-CMB-CD
               PERFORM 4200-SKJSRYLST-CHK-SEC
               MOVE    WRK-CMB-ITM TO  SPA-GMN-W24-SKJSRY-OCC (IDX-SKJ)
               GO  TO  4101-SKJSRY-CHK-EXT
           END-IF
      *
      *    ³ºÅö¥³¡¼¥É¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¤«¥Á¥§¥Ã¥¯
           MOVE    SPA-GMN-W24-SKJSRY (IDX-SKJ)
                                       TO  WRK-CMB-CD
           PERFORM 4200-SKJSRYLST-CHK-SEC
           IF   (  WRK-CMB-ITM     =   SPACE )
      *
               COMPUTE SPA-GMN-W24-CUR =   IDX-SKJ +   1
      *
               EVALUATE    SPA-NAI-W24-SKJSRY-SRYCD (IDX-SKJ)
               WHEN    "197000270"
                   MOVE    "0006"      TO  SPA-ERRCD
               WHEN    "197000570"
                   MOVE    "0007"      TO  SPA-ERRCD
               WHEN    OTHER
                   MOVE    "0001"      TO  SPA-ERRCD
               END-EVALUATE
      *
           ELSE
               MOVE    WRK-CMB-ITM TO  SPA-GMN-W24-SKJSRY-OCC (IDX-SKJ)
           END-IF
      *
      *
           .
      *
       4101-SKJSRY-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¶èÊ¬
      *****************************************************************
       4101-BRMSGK-TAX-CHK-SEC         SECTION.
      *
           MOVE    SPA-GMN-W24-BRMSGK-TAX
                                       TO  WRK-CMB-CD
           PERFORM 4200-BRMSGK-TAXLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-BRMSGK-TAXLST (1)
                                       TO  SPA-GMN-W24-BRMSGK-TAX-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-BRMSGK-TAX-G
           END-IF
      *
           .
       4101-BRMSGK-TAX-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²ñ·×¼¼ÎÁº¹³Û¶èÊ¬
      *****************************************************************
       4101-NACCT-BRMSGK-CHK-SEC         SECTION.
      *
      *    ³ºÅö¥³¡¼¥É¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¤«¥Á¥§¥Ã¥¯
           MOVE    SPA-GMN-W24-NACCT-BRMSGK
                                       TO  WRK-CMB-CD
           PERFORM 4200-NACCT-BRMSGKLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-NACCT-BRMSGKLST (1)
                                       TO  SPA-GMN-W24-NACCT-BRMSGK-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-NACCT-BRMSGK-G
           END-IF
      *
           .
       4101-NACCT-BRMSGK-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²ñ·×³°Çñ¶èÊ¬
      *****************************************************************
       4101-NACCT-GAIHAKU-CHK-SEC         SECTION.
      *
      *    ³ºÅö¥³¡¼¥É¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¤«¥Á¥§¥Ã¥¯
           MOVE    SPA-GMN-W24-NACCT-GAIHAKU
                                       TO  WRK-CMB-CD
           PERFORM 4200-NACCT-GAIHAKULST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-NACCT-GAIHAKULST (1)
                                       TO  SPA-GMN-W24-NACCT-GAIHAKU-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-NACCT-GAIHAKU-G
           END-IF
      *
           .
       4101-NACCT-GAIHAKU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²Ã»»¾ðÊó¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-CHK-NYUKSN-CHK-SEC         SECTION.
      *
           IF    ( SPA-GMN-W24-NYUKSNMEI (IDX1) =  SPACE )
               MOVE    "F"         TO  SPA-GMN-W24-CHK-NYUKSN (IDX1)
           END-IF
      *
           .
      *
       4101-CHK-NYUKSN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    »ÜÀß´ð½à¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SSTKIJUN-CHK-SEC           SECTION.
      *
      *    »ÜÀß´ð½à¸¡º÷½èÍý
           PERFORM 4101-SYS-1006-SEL-SEC
      *
           MOVE    7               TO  WRK-BASE-CUR
      *
           PERFORM VARYING IDX-KSN FROM    1   BY  1
                   UNTIL ( IDX-KSN         >   CONST-NYUKSN-MAX )
                    OR   ( SPA-ERRCD   NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-CHK-NYUKSN (IDX-KSN)  =   "T" )
                   PERFORM 41011-SSTKIJUN-CHK-SEC
               END-IF
           END-PERFORM
      *
           .
       4101-SSTKIJUN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    »ÜÀß´ð½à¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       41011-SSTKIJUN-CHK-SEC          SECTION.
      *
           MOVE    ZERO            TO  FLG-SSTKIJUNERR
      *
           EVALUATE    SPA-NAI-W24-NYUKSN-SRYCD (IDX-KSN)
           WHEN    "190098870"
      *        Æþ±¡»þ°å³Ø´ÉÍýÎÁ¥Á¥§¥Ã¥¯
               IF  ( SSTKJN-CD (201)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190098970"
      *        ¾Ò²ð³°Íè²Ã»»¡ÊÆÃÄêµ¡Ç½ÉÂ±¡°Ê³°¡Ë
               IF    ( SSTKJN-CD (202) =   1 )
                AND (( SSTKJN-CD (147) =   1 )
                 OR  ( SSTKJN-CD (148) =   1 )
                 OR  ( SSTKJN-CD (107) =   1 )
                 OR  ( SSTKJN-CD (108) =   1 ))
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190099170"
      *        ¾Ò²ð³°ÍèÆÃÊÌ²Ã»»
               IF    ( SSTKJN-CD (202) =   1 )
                AND  ( SSTKJN-CD (203) =   1 )
                AND (( SSTKJN-CD (147) =   1 )
                 OR  ( SSTKJN-CD (148) =   1 )
                 OR  ( SSTKJN-CD (107) =   1 )
                 OR  ( SSTKJN-CD (108) =   1 ))
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190099270"
      *        µÞÀ­´üÆþ±¡²Ã»»
               IF  ( SSTKJN-CD (323)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190099570"
      *        µÞÀ­´üÆÃÄêÆþ±¡²Ã»»
               IF  ( SSTKJN-CD (324)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
      *        ÃÏ°è°åÎÅ»Ù±çÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»
           WHEN    "190099870"
               IF  ( SSTKJN-CD (146)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190099970"
      *        ÃÏ°è°åÎÅ»Ù±çÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»£²
               IF    ( SSTKJN-CD (146)   =   1 )
                AND  ( SSTKJN-CD (147)   =   1 )
                AND  ( SSTKJN-CD (156)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190117170"
           WHEN    "190119910"
      *        Ã±ÆÈ·¿µÚ¤Ó´ÉÍý·¿Î×¾²¸¦½¤ÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»¡ÊÆþ±¡½éÆü¡Ë
      *        ¶¨ÎÏ·¿Î×¾²¸¦½¤ÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»¡ÊÆþ±¡½éÆü¡Ë
               IF    ( SSTKJN-CD (206)   =   1 )
                AND  ( SSTKJN-CD (364)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190100370"
      *        ¿ÇÎÅÏ¿´ÉÍýÂÎÀ©²Ã»»
               IF    ( SSTKJN-CD (206)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190100470"
           WHEN    "190100770"
           WHEN    "190100670"
           WHEN    "190100970"
      *        ÆýÍÄ»ù²Ã»»¡ÊÉÂ±¡¡Ë
      *        ÍÄ»ù²Ã»»¡ÊÉÂ±¡¡Ë
      *        ÆýÍÄ»ù²Ã»»¡Ê¿ÇÎÅ½ê¡Ë
      *        ÍÄ»ù²Ã»»¡Ê¿ÇÎÅ½ê¡Ë
               CONTINUE
           WHEN    "190107170"
      *        Àº¿ÀÉÂÅïÆþ±¡»þ°å³Ø´ÉÍý²Ã»»
               IF    ( SSTKJN-CD (207)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190117270"
      *        Î¥Åç²Ã»»
                   CONTINUE
           WHEN    "190120510"
      *        °åÎÅ°ÂÁ´ÂÐºö²Ã»»¡ÊÆþ±¡½éÆü¡Ë
               IF    ( SSTKJN-CD (605)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           WHEN    "190120410"
      *        ±ÉÍÜ´ÉÍý¼Â»Ü²Ã»»
               IF    ( SSTKJN-CD (604)   =   1 )
                   CONTINUE
               ELSE
                   MOVE    1           TO  FLG-SSTKIJUNERR
               END-IF
           END-EVALUATE
      *
           IF    ( FLG-SSTKIJUNERR     =   1 )
               COMPUTE SPA-GMN-W24-CUR
                   =   WRK-BASE-CUR    +   IDX-KSN
               MOVE    "0004"  TO  SPA-ERRCD
               MOVE    "F"     TO  SPA-GMN-W24-CHK-NYUKSN (IDX-KSN)
           END-IF
      *
           .
       41011-SSTKIJUN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    »ÜÀß´ð½à¸¡º÷½èÍý
      *****************************************************************
       4101-SYS-1006-SEL-SEC           SECTION.
      *
           MOVE    ZERO            TO  SSTKJN-AREA
      *
      *    »ÜÀß´ð½à¾ðÊó¸¡º÷
           INITIALIZE  SYSKANRI-REC
           MOVE    "1006"          TO  SYS-KANRICD
           MOVE    SPA-W01-EDYUKYMD
                                   TO  SYS-STYUKYMD
                                       SYS-EDYUKYMD
           PERFORM 900-SYSKANRI-KEY2-SEL-SEC
      *
           PERFORM UNTIL ( FLG-SYSKANRI    =   1 )
      *
               MOVE    SYSKANRI-REC    TO  SYS-1006-REC
      *
               EVALUATE    SYS-1006-KBNCD
               WHEN    "1"
                   MOVE    SYS-1006-TBL    TO  SSTKJN-VAL1
               WHEN    "2"
                   MOVE    SYS-1006-TBL    TO  SSTKJN-VAL2
               END-EVALUATE
      *
               PERFORM 900-SYSKANRI-KEY2-FET-SEC
      *
           END-PERFORM
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBCLOSECURSOR-SEC
      *
           .
       4101-SYS-1006-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ÃÏ°è²Ã»»¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-CHIIKIKSN-CHK-SEC          SECTION.
      *
           IF    ( SPA-GMN-W24-CHIIKIKSN-G =   SPACE )
               GO  TO  4101-CHIIKIKSN-CHK-EXT
           END-IF
      *
      *    ³ºÅö¥³¡¼¥É¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¤«¥Á¥§¥Ã¥¯
           MOVE    SPA-GMN-W24-CHIIKIKSN
                                       TO  WRK-CMB-CD
           PERFORM 4200-CHIIKIKSNLST-CHK-SEC
           IF   (  WRK-CMB-ITM     =   SPACE )
               MOVE    28          TO  SPA-GMN-W24-CUR
               MOVE    "0008"      TO  SPA-ERRCD
           ELSE
               MOVE    WRK-CMB-ITM TO  SPA-GMN-W24-CHIIKIKSN-G
           END-IF
      *
           .
      *
       4101-CHIIKIKSN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²ñ·×É½¼¨¾ðÊó¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SRYCD-CHK-SEC              SECTION.
      *
           IF    ( SPA-GMN-W24-SRYCD (IDXZ)    =   SPACE )
               MOVE    SPACE       TO  SPA-GMN-W24-SRYACT (IDXZ)
               GO  TO  4101-SRYCD-CHK-EXT
           END-IF
      *
      *    "/" ÆþÎÏ¤Î»þ¡¢¸¡º÷²èÌÌ¤Ø
           IF    ( SPA-GMN-W24-SRYCD (IDXZ)(1 : 1)   =  "/" )
               MOVE    SPACE           TO  WRK-INPUTCD
               PERFORM 409-KENSAKU-SEC
               GO  TO  4101-SRYCD-CHK-EXT
           END-IF
      *
      *    ÆþÎÏ¥³¡¼¥É¥Á¥§¥Ã¥¯
           PERFORM 4010-SRYCD-CHK-SEC
           IF    ( FLG-KENSAKU         =   1 )
               GO  TO  4101-SRYCD-CHK-EXT
           END-IF
      *
           EVALUATE  SPA-GMN-W24-SRYCD (IDXZ) (1 : 1)
           WHEN  "0"
               IF  ( SPA-GMN-W24-SRYCD (IDXZ)(2 : 2) = "00" )
                   MOVE    "0003"    TO  SPA-ERRCD
                   GO  TO  4101-SRYCD-CHK-EXT
               END-IF
           WHEN  "1"
           WHEN  "6"
           WHEN  "7"
           WHEN  "8"
               CONTINUE
           WHEN  OTHER
               MOVE    "0003"      TO  SPA-ERRCD
               GO  TO  4101-SRYCD-CHK-EXT
           END-EVALUATE
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿³ºÅö¥Ç¡¼¥¿ÆÉ¤ß½Ð¤·
           MOVE    SPA-GMN-W24-SRYCD (IDXZ)
                                   TO  WRK-SRYCD
           PERFORM 900-TENSU-KEY-SEL-SEC
           IF    ( FLG-TENSU       NOT =   ZERO )
               COMPUTE SPA-GMN-W24-CUR =   IDXZ    +   28
               MOVE    "0002"      TO  SPA-ERRCD
           END-IF
      *
           MOVE    TNS-NAME        TO  SPA-GMN-W24-SRYACT (IDXZ)
      *
           .
      *
       4101-SRYCD-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ÆþÎÏ¥³¡¼¥É¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4010-SRYCD-CHK-SEC                        SECTION.
      *
           MOVE    ZERO               TO  FLG-KENSAKU
      *
           MOVE    ZERO               TO  WRK-CD-MCNT
           MOVE    ZERO               TO  FLG-KANJI
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    SPA-GMN-W24-SRYCD (IDXZ)
                                       TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           MOVE    KANACHK-OUT-INPUT   TO
                                       SPA-GMN-W24-SRYCD (IDXZ)
           IF      KANACHK-RC      NOT =   ZERO
      *        Á´³ÑÈ¾³Ñº®ºß¥¨¥é¡¼
               MOVE    "0003"              TO  SPA-ERRCD
               GO      TO    4010-SRYCD-CHK-EXT
           ELSE
               MOVE    KANACHK-MAX         TO  WRK-CD-MCNT
      *        Á´³Ñ
               IF      KANACHK-SYUBETU     =   2
                   MOVE    1               TO  FLG-KANJI
                   MOVE    SPACE   TO   SPA-GMN-W24-SRYCD (IDXZ)(9:)
               ELSE
                   MOVE    ZERO            TO  FLG-KANJI
               END-IF
           END-IF
      *
      *    È¾³Ñ¤Ç£¹Ê¸»ú¤Î»þ¡¢ÅÀ¿ô¥Þ¥¹¥¿¥Á¥§¥Ã¥¯¤Ø
           IF     (WRK-CD-MCNT         =   9  )  AND
                  (FLG-KANJI           =   ZERO )  AND
                  (SPA-GMN-W24-SRYCD (IDXZ) (1 : 9 )
                                       IS  NUMERIC  )
               GO      TO    4010-SRYCD-CHK-EXT
           END-IF
      *
           MOVE    1                   TO  FLG-KENSAKU
           MOVE    SPA-GMN-W24-SRYCD (IDXZ)
                                       TO  WRK-INPUTCD
           PERFORM 409-KENSAKU-SEC
      *
           .
       4010-SRYCD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÄêÎÅÍÜÈñ¡ÝÉéÃ´¶èÊ¬
      *****************************************************************
       4101-SENTEI-FTNKBN-CHK-SEC         SECTION.
      *
      *    ³ºÅö¥³¡¼¥É¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¤«¥Á¥§¥Ã¥¯
           MOVE    SPA-GMN-W24-SENTEI-FTNKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-SENTEI-FTNKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-SENTEI-FTNKBNLST (1)
                                       TO  SPA-GMN-W24-SENTEI-FTNKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-SENTEI-FTNKBN-G
           END-IF
      *
           EVALUATE    SPA-GMN-W24-SENTEI-FTNKBN
           WHEN    "1"
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKAIP
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKARJ
           WHEN    "2"
               CONTINUE
           WHEN    OTHER
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKA
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKAIP
               MOVE    ZERO            TO  SPA-GMN-W24-SENTEI-TANKARJ
               MOVE    SPACE           TO  SPA-GMN-W24-SENTEI-TAX-G
           END-EVALUATE
      *
           .
       4101-SENTEI-FTNKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á
      *****************************************************************
       4101-SENTEI-TANKA-CHK-SEC       SECTION.
      *
      *
           .
       4101-SENTEI-TANKA-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á¡Ê°ìÈÌ¡Ë
      *****************************************************************
       4101-SENTEI-TANKAIP-CHK-SEC     SECTION.
      *
      *
           .
       4101-SENTEI-TANKAIP-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á¡ÊÏ·¿Í¡Ë
      *****************************************************************
       4101-SENTEI-TANKARJ-CHK-SEC     SECTION.
      *
      *
           .
       4101-SENTEI-TANKARJ-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÄêÎÅÍÜÈñ¡Ý¾ÃÈñÀÇ
      *****************************************************************
       4101-SENTEI-TAX-CHK-SEC         SECTION.
      *
           IF    ( SPA-GMN-W24-SENTEI-TAX-G =   SPACE )
               EVALUATE    SPA-GMN-W24-SENTEI-FTNKBN
               WHEN    "1"
               WHEN    "2"
                   MOVE    SPA-GMN-W24-SENTEI-TAXLST (1)
                                       TO  SPA-GMN-W24-SENTEI-TAX-G
               WHEN    OTHER
                   CONTINUE
               END-EVALUATE
               GO  TO  4101-SENTEI-TAX-CHK-EXT
           END-IF
      *
      *    ³ºÅö¥³¡¼¥É¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¤«¥Á¥§¥Ã¥¯
           MOVE    SPA-GMN-W24-SENTEI-TAX
                                       TO  WRK-CMB-CD
           PERFORM 4200-SENTEI-TAXLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-SENTEI-TAXLST (1)
                                       TO  SPA-GMN-W24-SENTEI-TAX-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-SENTEI-TAX-G
           END-IF
      *
           .
       4101-SENTEI-TAX-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎòÉ½¼¨¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-REKI-DISPKBN-CHK-SEC       SECTION.
      *
           MOVE    SPA-GMN-W24-REKI-DISPKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-REKI-DISPKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-REKI-DISPKBNLST (1)
                                       TO  SPA-GMN-W24-REKI-DISPKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-REKI-DISPKBN-G
           END-IF
      *
           .
      *
       4101-REKI-DISPKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡ºÆ·×»»¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SAIKEISANKBN-CHK-SEC       SECTION.
      *
           MOVE    SPA-GMN-W24-SAIKEISANKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-SAIKEISANKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-SAIKEISANKBNLST (1)
                                       TO  SPA-GMN-W24-SAIKEISANKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-SAIKEISANKBN-G
           END-IF
      *
           .
      *
       4101-SAIKEISANKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ¶â¤Î¼è°·¤¤¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-NYKNKNRKBN-CHK-SEC         SECTION.
      *
           MOVE    SPA-GMN-W24-NYKNKNRKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-NYKNKNRKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-NYKNKNRKBNLST (1)
                                       TO  SPA-GMN-W24-NYKNKNRKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-NYKNKNRKBN-G
           END-IF
      *
           .
      *
       4101-NYKNKNRKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SKYPRTKBN-CHK-SEC       SECTION.
      *
           MOVE    SPA-GMN-W24-SKYPRTKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-SKYPRTKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-SKYPRTKBNLST (2)
                                       TO  SPA-GMN-W24-SKYPRTKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-SKYPRTKBN-G
           END-IF
      *
           .
      *
       4101-SKYPRTKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅÈñÌÀºÙ½ñÈ¯¹Ô¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SRYPRTKBN-CHK-SEC       SECTION.
      *
           MOVE    SPA-GMN-W24-SRYPRTKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-SRYPRTKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-SRYPRTKBNLST (1)
                                       TO  SPA-GMN-W24-SRYPRTKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-SRYPRTKBN-G
           END-IF
      *
           .
      *
       4101-SRYPRTKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡»þ±¡³°½èÊý¤»¤óÈ¯¹Ô¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-SHOHOUKBN-CHK-SEC       SECTION.
      *
           MOVE    SPA-GMN-W24-SHOHOUKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-SHOHOUKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-SHOHOUKBNLST (1)
                                       TO  SPA-GMN-W24-SHOHOUKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-SHOHOUKBN-G
           END-IF
      *
           .
      *
       4101-SHOHOUKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-MISYUPRTKBN-CHK-SEC       SECTION.
      *
           MOVE    SPA-GMN-W24-MISYUPRTKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-MISYUPRTKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-MISYUPRTKBNLST (1)
                                       TO  SPA-GMN-W24-MISYUPRTKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-MISYUPRTKBN-G
           END-IF
      *
           .
      *
       4101-MISYUPRTKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡¾ÚÌÀ½ñ°õºþ¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4100-TAIPRTKBN-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-W24-TAIPRTKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-TAIPRTKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-TAIPRTKBNLST (2)
                                       TO  SPA-GMN-W24-TAIPRTKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-TAIPRTKBN-G
           END-IF
      *
           .
      *
       4100-TAIPRTKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡¾ÚÌÀ½ñµ­ºÜ¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4100-TAIKSIKBN-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-W24-TAIKSIKBN
                                       TO  WRK-CMB-CD
           PERFORM 4200-TAIKSIKBNLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-TAIKSIKBNLST (1)
                                       TO  SPA-GMN-W24-TAIKSIKBN-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-TAIKSIKBN-G
           END-IF
      *
           .
      *
       4100-TAIKSIKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    É¸·ç¸º³Û¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4100-HYOUKETU-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-W24-HYOUKETU
                                       TO  WRK-CMB-CD
           PERFORM 4200-HYOUKETULST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-HYOUKETULST (1)
                                       TO  SPA-GMN-W24-HYOUKETU-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-HYOUKETU-G
           END-IF
      *
           .
      *
       4100-HYOUKETU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Äê¿ôÄ¶²á¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4100-TEISU-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-W24-TEISU
                                       TO  WRK-CMB-CD
           PERFORM 4200-TEISULST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-TEISULST (1)
                                       TO  SPA-GMN-W24-TEISU-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-TEISU-G
           END-IF
      *
           .
      *
       4100-TEISU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    £Á£Ä£ÌÆþÎÏ¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4100-ADLINPUT-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-W24-ADLINPUT
                                       TO  WRK-CMB-CD
           PERFORM 4200-ADLINPUTLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-ADLINPUTLST (2)
                                       TO  SPA-GMN-W24-ADLINPUT-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-ADLINPUT-G
           END-IF
      *
           .
      *
       4100-ADLINPUT-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Äê´üÀÁµáº¹³Û½é´üÉ½¼¨¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4100-TEIKISAGAKUACT-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-W24-TEIKISAGAKUACT
                                       TO  WRK-CMB-CD
           PERFORM 4200-TEIKISAGAKUACTLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-TEIKISAGAKUACTLST (1)
                                       TO  SPA-GMN-W24-TEIKISAGAKUACT-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-TEIKISAGAKUACT-G
           END-IF
      *
           .
      *
       4100-TEIKISAGAKUACT-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÎÅÍÜÆþ±¡É½¼¨¶èÊ¬¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4100-RYOYODSP-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-W24-RYOYODSP
                                       TO  WRK-CMB-CD
           PERFORM 4200-RYOYODSPLST-CHK-SEC
           IF    ( WRK-CMB-ITM         =   SPACE )
               MOVE    SPA-GMN-W24-RYOYODSPLST (1)
                                       TO  SPA-GMN-W24-RYOYODSP-G
           ELSE
               MOVE    WRK-CMB-ITM     TO  SPA-GMN-W24-RYOYODSP-G
           END-IF
      *
           IF   SPA-GMN-W24-RYOYODSP    =   "1"
               IF  (SPA-GMN-W24-HYOUKETU = "1" OR "2" OR "3" OR "4") OR
                   (SPA-GMN-W24-TEISU    = "1")      
                   MOVE    59          TO  SPA-GMN-W24-CUR
                   MOVE    "1010"      TO  SPA-ERRCD
               END-IF
           END-IF
      *
           .
      *
       4100-RYOYODSP-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡»þ¿©»öÎÅÍÜ¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-SKJRYOYOLST-CHK-SEC    SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-SKJRYOYO-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-SKJRYOYOL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-SKJRYOYOLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-SKJRYOYOLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¿©»ö¿ÇÎÅ¹Ô°Ù¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-SKJSRYLST-CHK-SEC      SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-SKJSRY-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-SKJSRYL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-SKJSRYLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-SKJSRYLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÃÏ°è²Ã»»¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-CHIIKIKSNLST-CHK-SEC      SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-CHIIKIKSN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-CHIIKIKSNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-CHIIKIKSNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-CHIIKIKSNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎòÉ½¼¨¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-REKI-DISPKBNLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-REKI-DISPKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-REKI-DISPKBNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-REKI-DISPKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-REKI-DISPKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡ºÆ·×»»¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-SAIKEISANKBNLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-SAIKEISANKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-SAIKEISANKBNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-SAIKEISANKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-SAIKEISANKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ¶â¤Î¼è°·¤¤¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-NYKNKNRKBNLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-NYKNKNRKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-NYKNKNRKBNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-NYKNKNRKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-NYKNKNRKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-SKYPRTKBNLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-SKYPRTKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-SKYPRTKBNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-SKYPRTKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-SKYPRTKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-MISYUPRTKBNLST-CHK-SEC     SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-MISYUPRTKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-MISYUPRTKBNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-MISYUPRTKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-MISYUPRTKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅÈñÌÀºÙ½ñÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-SRYPRTKBNLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-SRYPRTKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-SRYPRTKBNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-SRYPRTKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-SRYPRTKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡»þ±¡³°½èÊý¤»¤óÈ¯¹Ô¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-SHOHOUKBNLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-SHOHOUKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-SHOHOUKBNL   (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-SHOHOUKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
           END-PERFORM
           .
       4200-SHOHOUKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡¾ÚÌÀ½ñÈ¯¹Ô¶èÊ¬¥µ¡¼¥Á½èÍý
      *****************************************************************
       4200-TAIPRTKBNLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-TAIPRTKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-TAIPRTKBNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-TAIPRTKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-TAIPRTKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Âà±¡¾ÚÌÀ½ñµ­ºÜ¶èÊ¬¥µ¡¼¥Á½èÍý
      *****************************************************************
       4200-TAIKSIKBNLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-TAIKSIKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-TAIKSIKBNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-TAIKSIKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
      *
       4200-TAIKSIKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÄêÎÅÍÜÈñ¡ÝÉéÃ´¶èÊ¬¥µ¡¼¥Á½èÍý
      *****************************************************************
       4200-SENTEI-FTNKBNLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-SENTEI-FTNKBN-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-SENTEI-FTNKBNL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-SENTEI-FTNKBNLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-SENTEI-FTNKBNLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÁªÄêÎÅÍÜÈñ¡Ý¾ÃÈñÀÇ¥µ¡¼¥Á½èÍý
      *****************************************************************
       4200-SENTEI-TAXLST-CHK-SEC     SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-SENTEI-TAX-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-SENTEI-TAXL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-SENTEI-TAXLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-SENTEI-TAXLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¥µ¡¼¥Á½èÍý
      *****************************************************************
       4200-BRMSGK-TAXLST-CHK-SEC  SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB     FROM    1   BY  1
                   UNTIL ( IDX-CMB     >   SPA-GMN-W24-BRMSGK-TAX-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-BRMSGK-TAXL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-BRMSGK-TAXLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-BRMSGK-TAXLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²ñ·×¼¼ÎÁº¹³Û¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-NACCT-BRMSGKLST-CHK-SEC    SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-NACCT-BRMSGK-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-NACCT-BRMSGKL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-NACCT-BRMSGKLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-NACCT-BRMSGKLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²ñ·×³°Çñ¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-NACCT-GAIHAKULST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-NACCT-GAIHAKU-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-NACCT-GAIHAKUL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-NACCT-GAIHAKULST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-NACCT-GAIHAKULST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    É¸·ç¸º³Û¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-HYOUKETULST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-HYOUKETU-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-HYOUKETUL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-HYOUKETULST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-HYOUKETULST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Äê¿ôÄ¶²á¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-TEISULST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-TEISU-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-TEISUL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-TEISULST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-TEISULST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    £Á£Ä£ÌÆþÎÏ¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-ADLINPUTLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-ADLINPUT-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-ADLINPUTL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-ADLINPUTLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-ADLINPUTLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Äê´üÀÁµáº¹³Û½é´üÉ½¼¨¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-TEIKISAGAKUACTLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-TEIKISAGAKUACT-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-TEIKISAGAKUACTL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-TEIKISAGAKUACTLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-TEIKISAGAKUACTLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÎÅÍÜÆþ±¡É½¼¨¶èÊ¬¥³¥ó¥Ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4200-RYOYODSPLST-CHK-SEC   SECTION.
      *
           INITIALIZE                  WRK-CMB-ITM-G
      *
           PERFORM VARYING IDX-CMB FROM    1   BY  1
                   UNTIL ( IDX-CMB >   SPA-GMN-W24-RYOYODSP-MAX )
                    OR   ( WRK-CMB-ITM NOT =   SPACE )
      *
               IF    ( SPA-GMN-W24-RYOYODSPL (IDX-CMB)
                                       =   WRK-CMB-CD )
                   MOVE    SPA-GMN-W24-RYOYODSPLST (IDX-CMB)
                                       TO  WRK-CMB-ITM
                   MOVE    IDX-CMB     TO  WRK-CMB-IDX
               END-IF
      *
           END-PERFORM
      *
           .
       4200-RYOYODSPLST-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÆþÎÏ¾ðÊóÎÎ°è½é´ü²½½èÍý
      *****************************************************************
       4201-INPUT-AREA-INIT-SEC        SECTION.
      *
           INITIALIZE  SPA-GMN-W24-INPUT-AREA
                       SPA-NAI-W24-AREA
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   CONST-SKJSRY-MAX )
      *
               IF    ( SPA-W01-EDYUKYMD    >=  CONST-H180401 )
                   MOVE    CONST-SKJSRY-H1804 (IDX0)
                                   TO  SPA-NAI-W24-SKJSRY-SRYCD  (IDX0)
               ELSE
                   MOVE    CONST-SKJSRY-SRYCD (IDX0)
                                   TO  SPA-NAI-W24-SKJSRY-SRYCD  (IDX0)
               END-IF
      *
               IF    ( SPA-NAI-W24-SKJSRY-SRYCD  (IDX0)
                                           NOT =   SPACE )
                   MOVE    SPA-NAI-W24-SKJSRY-SRYCD (IDX0)
                                       TO  WRK-SRYCD
                   PERFORM 900-TENSU-KEY-SEL-SEC
                   IF  SPA-NAI-W24-SKJSRY-SRYCD (IDX0)  =  "197000570"
                       MOVE  "¿©Æ²²Ã»»"     TO    TNS-NAME
                   END-IF
                   MOVE    TNS-NAME    TO  SPA-GMN-W24-LBLSKJSRY (IDX0)
               END-IF
      *
           END-PERFORM
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   CONST-NYUKSN-MAX )
      *
               EVALUATE    TRUE
               WHEN  ( SPA-W01-EDYUKYMD    >=  CONST-H220401 )
                   MOVE    CONST-NYUKSN-H2204 (IDX0)
                                   TO  SPA-NAI-W24-NYUKSN-SRYCD  (IDX0)
               WHEN  ( SPA-W01-EDYUKYMD    >=  CONST-H180401 )
                   MOVE    CONST-NYUKSN-H1804 (IDX0)
                                   TO  SPA-NAI-W24-NYUKSN-SRYCD  (IDX0)
               WHEN  ( SPA-W01-EDYUKYMD    >=  CONST-H160401 )
                   MOVE    CONST-NYUKSN-H1604 (IDX0)
                                   TO  SPA-NAI-W24-NYUKSN-SRYCD  (IDX0)
               WHEN    OTHER
                   MOVE    CONST-NYUKSN-SRYCD (IDX0)
                                   TO  SPA-NAI-W24-NYUKSN-SRYCD  (IDX0)
               END-EVALUATE
      *
               MOVE    "F"         TO  SPA-GMN-W24-CHK-NYUKSN (IDX0)
      *
           END-PERFORM
      *
           MOVE    SPA-W01-STYUKYMDH
                                   TO  SPA-GMN-W24-STYUKYMD
           MOVE    SPA-W01-EDYUKYMDH
                                   TO  SPA-GMN-W24-EDYUKYMD
      *
           MOVE    SPA-GMN-W24-SKJSRYLST (1)
                                   TO  SPA-GMN-W24-SKJSRY-OCC (1)
                                       SPA-GMN-W24-SKJSRY-OCC (2)
      *
           MOVE    SPA-GMN-W24-BRMSGK-TAXLST (1)
                                   TO  SPA-GMN-W24-BRMSGK-TAX-G
      *
           MOVE    SPA-GMN-W24-NACCT-BRMSGKLST (1)
                                   TO  SPA-GMN-W24-NACCT-BRMSGK-G
      *
           MOVE    SPA-GMN-W24-NACCT-GAIHAKULST (1)
                                   TO  SPA-GMN-W24-NACCT-GAIHAKU-G
      *
           MOVE    SPA-GMN-W24-SENTEI-FTNKBNLST (1)
                                   TO  SPA-GMN-W24-SENTEI-FTNKBN-G
      *
           MOVE    CONST-SENTEI-TANKA
                                   TO  SPA-GMN-W24-SENTEI-TANKA
      *
           MOVE    SPA-GMN-W24-SENTEI-TAXLST (1)
                                   TO  SPA-GMN-W24-SENTEI-TAX-G
      *
           MOVE    SPA-GMN-W24-REKI-DISPKBNLST (1)
                                   TO  SPA-GMN-W24-REKI-DISPKBN-G
           MOVE    SPA-GMN-W24-SAIKEISANKBNLST (1)
                                   TO  SPA-GMN-W24-SAIKEISANKBN-G
           MOVE    SPA-GMN-W24-NYKNKNRKBNLST (1)
                                   TO  SPA-GMN-W24-NYKNKNRKBN-G
           MOVE    SPA-GMN-W24-SKYPRTKBNLST    (2)
                                   TO  SPA-GMN-W24-SKYPRTKBN-G
           MOVE    SPA-GMN-W24-MISYUPRTKBNLST  (1)
                                   TO  SPA-GMN-W24-MISYUPRTKBN-G
           MOVE    SPA-GMN-W24-SRYPRTKBNLST    (1)
                                   TO  SPA-GMN-W24-SRYPRTKBN-G
           MOVE    SPA-GMN-W24-TAIPRTKBNLST (2)
                                   TO  SPA-GMN-W24-TAIPRTKBN-G
           MOVE    SPA-GMN-W24-TAIKSIKBNLST (1)
                                   TO  SPA-GMN-W24-TAIKSIKBN-G
           MOVE    SPA-GMN-W24-HYOUKETULST (1)
                                   TO  SPA-GMN-W24-HYOUKETU-G
           MOVE    SPA-GMN-W24-TEISULST (1)
                                   TO  SPA-GMN-W24-TEISU-G
           MOVE    SPA-GMN-W24-ADLINPUTLST (2)
                                   TO  SPA-GMN-W24-ADLINPUT-G
           MOVE    SPA-GMN-W24-TEIKISAGAKUACTLST (1)
                                   TO  SPA-GMN-W24-TEIKISAGAKUACT-G
           MOVE    SPA-GMN-W24-RYOYODSPLST (1)
                                   TO  SPA-GMN-W24-RYOYODSP-G
      *
           MOVE    SPA-GMN-W24-SHOHOUKBNLST    (1)
                                   TO  SPA-GMN-W24-SHOHOUKBN-G
      *
      *    Æþ±¡²Ã»»Ì¾¾ÎÊÔ½¸½èÍý
           PERFORM 4201-NYUKSNMEI-EDIT-SEC
      *
      *    Æþ±¡¸º»»Ì¾¾ÎÊÔ½¸½èÍý
           IF    ( SPA-W01-EDYUKYMD   >=   CONST-H180401 )
               CONTINUE
           ELSE
               PERFORM 4201-GENZANMEI-EDIT-SEC
           END-IF
      *
           MOVE    1               TO  SPA-GMN-W24-CUR
      *
           .
      *
       4201-INPUT-AREA-INIT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡²Ã»»Ì¾¾ÎÊÔ½¸½èÍý
      *****************************************************************
       4201-NYUKSNMEI-EDIT-SEC         SECTION.
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
               UNTIL     ( IDX0    >   CONST-NYUKSN-MAX )
                    OR   ( SPA-NAI-W24-NYUKSN-SRYCD (IDX0) =   SPACE )
               MOVE    SPA-NAI-W24-NYUKSN-SRYCD (IDX0)
                                   TO  WRK-SRYCD
               PERFORM 900-TENSU-KEY-SEL-SEC
               IF    ( FLG-TENSU   =   ZERO )
                   MOVE    TNS-NAME
                                   TO  SPA-GMN-W24-NYUKSNMEI (IDX0)
               END-IF
           END-PERFORM
      *
      *
           .
       4201-NYUKSNMEI-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡¸º»»Ì¾¾ÎÊÔ½¸½èÍý
      *****************************************************************
       4201-GENZANMEI-EDIT-SEC         SECTION.
      *
           IF    ( SPA-W01-EDYUKYMD    >=  CONST-H160401 )
               MOVE    16          TO  IDX0
           ELSE
               MOVE    14          TO  IDX0
           END-IF
      *
           MOVE    2               TO  IDX1
      *
           PERFORM UNTIL ( IDX1    >   CONST-GEN-MAX )
      *
                MOVE    CONST-GENCD (IDX1)  TO  WRK-SRYCD
                PERFORM 900-TENSU-KEY-SEL-SEC
                MOVE    TNS-NAME   TO  SPA-GMN-W24-NYUKSNMEI  (IDX0)
      *
               COMPUTE IDX0    =   IDX0    +   1
               COMPUTE IDX1    =   IDX1    +   1
      *
           END-PERFORM
      *
           .
       4201-GENZANMEI-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    °åÎÅµ¡´Ø¾ðÊó¸¡º÷½èÍý
      *****************************************************************
       4201-SYS-1001-SEL-SEC           SECTION.
      *
      *    °åÎÅµ¡´Ø¾ðÊó¸¡º÷
           INITIALIZE  SYSKANRI-REC
           MOVE    "1001"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    SPA-W01-EDYUKYMD    TO  SYS-STYUKYMD
                                           SYS-EDYUKYMD
           PERFORM 900-SYSKANRI-KEY10-SEL-SEC
           MOVE    SYSKANRI-REC        TO  SYS-1001-REC
      *
           .
       4201-SYS-1001-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ¶¦ÄÌ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       4900-KANRENCHK-SEC              SECTION.
      *
           INITIALIZE      FLG-NYUKSNCD-G
           PERFORM VARYING  IDX-KSN FROM    1   BY  1
                   UNTIL (  IDX-KSN >   CONST-NYUKSN-MAX )
      *
               IF    ( SPA-GMN-W24-CHK-NYUKSN (IDX-KSN)  =   "T" )
                   EVALUATE    SPA-NAI-W24-NYUKSN-SRYCD (IDX-KSN)
                   WHEN    "190098870"
                       MOVE    1           TO  FLG-190098870
                   WHEN    "190098970"
                       MOVE    1           TO  FLG-190098970
                   WHEN    "190099170"
                       MOVE    1           TO  FLG-190099170
                   WHEN    "190099270"
                       MOVE    1           TO  FLG-190099270
                   WHEN    "190099570"
                       MOVE    1           TO  FLG-190099570
                   WHEN    "190099870"
                       MOVE    1           TO  FLG-190099870
                   WHEN    "190099970"
                       MOVE    1           TO  FLG-190099970
                   WHEN    "190100370"
                       MOVE    1           TO  FLG-190100370
                   WHEN    "190100470"
                       MOVE    1           TO  FLG-190100470
                   WHEN    "190100670"
                       MOVE    1           TO  FLG-190100670
                   WHEN    "190100770"
                       MOVE    1           TO  FLG-190100770
                   WHEN    "190100970"
                       MOVE    1           TO  FLG-190100970
                   WHEN    "190107170"
                       MOVE    1           TO  FLG-190107170
                   WHEN    "190117170"
                       MOVE    1           TO  FLG-190117170
                   WHEN    "190117270"
                       MOVE    1           TO  FLG-190117270
                   WHEN    "190119910"
                       MOVE    1           TO  FLG-190119910
                   WHEN    "190120410"
                       MOVE    1           TO  FLG-190120410
                   WHEN    "190120510"
                       MOVE    1           TO  FLG-190120510
                   END-EVALUATE
               END-IF
      *
           END-PERFORM
      *
      *    µÞÀ­´üÉÂ±¡²Ã»»¤ÈµÞÀ­´üÆÃÄêÉÂ±¡²Ã»»¤¬
      *    Æ±»þ¤Ë»»Äê¤µ¤ì¤Æ¤¤¤Ê¤¤¤³¤È
           IF    ( SPA-W01-EDYUKYMD      >=    CONST-H180401 )
               CONTINUE
           ELSE
               IF    ( FLG-190099270           =   1 )
                AND  ( FLG-190099570           =   1 )
                   MOVE    "1001"      TO  SPA-ERRCD
                   GO  TO  4900-KANRENCHK-EXT
               END-IF
           END-IF
      *
      *    ÃÏ°è°åÎÅ»Ù±çÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»£±¤È£²¤¬
      *    Æ±»þ¤Ë»»Äê¤µ¤ì¤Æ¤¤¤Ê¤¤¤³¤È
           IF    ( SPA-W01-EDYUKYMD      >=    CONST-H180401 )
               CONTINUE
           ELSE
               IF    ( FLG-190099870           =   1 )
                AND  ( FLG-190099970           =   1 )
                   MOVE   "1002"       TO  SPA-ERRCD
                   GO  TO  4900-KANRENCHK-EXT
               END-IF
           END-IF
      *
      *    °åÎÅµ¡´Ø¾ðÊó¤è¤êÉÂ±¡¤«¿ÇÎÅ½ê¤òÈ½ÃÇ¤·¡¢
      *    ÆýÍÄ»ù²Ã»»¤Î¥Á¥§¥Ã¥¯¤¬ÂÅÅö¤Ç¤¢¤ë¤³¤È
           PERFORM 4201-SYS-1001-SEL-SEC
           EVALUATE    SYS-1001-HOSPSBT
           WHEN    "1"
               IF    ( FLG-190100670     =   1 )
                OR   ( FLG-190100970     =   1 )
                   MOVE    "1003"        TO  SPA-ERRCD
                   GO  TO  4900-KANRENCHK-EXT
               END-IF
      *
           WHEN    "2"
               IF    ( FLG-190100470     =   1 )
                OR   ( FLG-190100770     =   1 )
                   MOVE    "1004"        TO  SPA-ERRCD
                   GO  TO  4900-KANRENCHK-EXT
               END-IF
      *
           END-EVALUATE
      *
      *    ½ÅÊ£¤·¤Æ¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¤¬ÀßÄê¤µ¤ì¤Æ¤¤¤Ê¤¤¤³¤È
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL ( IDX1    >   9 )
               IF    ( SPA-GMN-W24-SRYCD (IDX1)    NOT =   SPACE )
                   COMPUTE IDX3    =   IDX1    +   1
                   PERFORM VARYING IDX2    FROM    10      BY  -1
                           UNTIL ( IDX2    <   IDX3 )
                       IF    ( SPA-GMN-W24-SRYCD (IDX1)
                                           = SPA-GMN-W24-SRYCD (IDX2))
                           COMPUTE SPA-GMN-W24-CUR =   IDX2    +   28
                           MOVE    "1005"  TO  SPA-ERRCD
                           GO  TO  4900-KANRENCHK-EXT
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
      *
      *    ÁªÄêÆþ±¡ÎÁ¡ÝÉéÃ´¶èÊ¬¤¬ÆþÎÏ¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SPA-GMN-W24-SENTEI-FTNKBN   NOT =   SPACE )
               CONTINUE
           ELSE
               MOVE    39            TO  SPA-GMN-W24-CUR
               MOVE    "1006"        TO  SPA-ERRCD
               GO  TO  4900-KANRENCHK-EXT
           END-IF
      *
      *    ÁªÄêÆþ±¡ÎÁ¡ÝÉéÃ´¶èÊ¬¤¬ÄêÎ¨ÀßÄê¤Î»þ¡¢
      *    ÅÀ¿ôÃ±²Á¤¬£¹£¹ÅÀ°Ê²¼¤Ç¤¢¤ë¤³¤È
           IF    ( SPA-GMN-W24-SENTEI-FTNKBN      =   "1" )
               IF    ( SPA-GMN-W24-SENTEI-TANKA  <=   99  )
                   CONTINUE
               ELSE
                   MOVE    40            TO  SPA-GMN-W24-CUR
                   MOVE    "1007"        TO  SPA-ERRCD
                   GO  TO  4900-KANRENCHK-EXT
               END-IF
           END-IF
      *
      *    ÁªÄêÆþ±¡ÎÁ¡ÝÉéÃ´¶èÊ¬¤¬Äê³ÛÀßÄê¤Î»þ¡¢
      *    °ìÈÌ¡¿Ï·¿Í¤È°ìÈÌ£±Æü¡¦Ï·¿Í£±Æü¤È°ì½ï¤ËÀßÄê¤µ¤ì¤Æ¤¤¤Ê¤¤¤³¤È
           IF    ( SPA-GMN-W24-SENTEI-FTNKBN      =   "2" )
               IF    ( SPA-GMN-W24-SENTEI-TANKA   >   ZERO  )
                   IF    ( SPA-GMN-W24-SENTEI-TANKAIP =    ZERO )
                    AND  ( SPA-GMN-W24-SENTEI-TANKARJ =    ZERO )
                       CONTINUE
                   ELSE
                       MOVE    40      TO  SPA-GMN-W24-CUR
                       MOVE    "1008"  TO  SPA-ERRCD
                       GO  TO  4900-KANRENCHK-EXT
                   END-IF
               END-IF
           END-IF
      *
      *    É¸·ç¤ÈÄê¿ôÄ¶²á¤ÏÆ±»þÀßÄêÉÔ²Ä¤È¤¹¤ë
           IF    ( SPA-GMN-W24-HYOUKETU    NOT = SPACE AND "0") AND
                 ( SPA-GMN-W24-TEISU       NOT = SPACE AND "0")
                       MOVE    53      TO  SPA-GMN-W24-CUR
                       MOVE    "1009"  TO  SPA-ERRCD
                       GO  TO  4900-KANRENCHK-EXT
           END-IF
      *
           .
      *
       4900-KANRENCHK-EXT.
           EXIT.
      *****************************************************************
      *    ¼«²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-SET-SCREEN                  SECTION.
      *
           PERFORM 500-GMNHEN-SEC
      *
           IF      SPA-ERRCD       NOT =   SPACE
               PERFORM 510-ERRSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           IF      SPA-WIDCD       NOT =   SPACE
               PERFORM 520-WIDSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           MOVE    "CURRENT"           TO  MCP-PUTTYPE.
           MOVE    "W24    "           TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
           .
       500-SET-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-GMNHEN-SEC                  SECTION.
      *
           INITIALIZE                          W24
      *
      *    Í­¸ú³«»ÏÆü
           MOVE    SPA-GMN-W24-STYUKYMD    TO  W24-STYUKYMD
      *    Í­¸ú½ªÎ»Æü
           MOVE    SPA-GMN-W24-EDYUKYMD    TO  W24-EDYUKYMD
      *    Æþ±¡»þ¿©»öÎÅÍÜ
           MOVE    SPA-GMN-W24-SKJRYOYO-G  TO  W24-SKJRYOYO
           MOVE    SPA-GMN-W24-SKJRYOYO-MAX
                                           TO  W24-SKJRYOYO-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0        >   SPA-GMN-W24-SKJRYOYO-MAX )
      *
               MOVE    SPA-GMN-W24-SKJRYOYOLST (IDX0)
                                           TO  W24-SKJRYOYO-ITM (IDX0)
      *
           END-PERFORM
      *
      *    ¿©»ö¿ÇÎÅ¹Ô°Ù
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   CONST-SKJSRY-MAX )
                    OR   ( SPA-NAI-W24-SKJSRY-SRYCD (IDX0) =   SPACE )
      *
               MOVE    SPA-GMN-W24-LBLSKJSRY (IDX0)
                                       TO  W24-LBLSYOKUJI (IDX0)
               MOVE    SPA-GMN-W24-SKJSRY-OCC (IDX0)
                                       TO  W24-SYOKUJI (IDX0)
               MOVE    SPA-GMN-W24-SKJSRY-MAX
                                       TO  W24-SYOKUJI-CNT (IDX0)
               PERFORM VARYING IDX1    FROM    1   BY  1
                       UNTIL ( IDX1    >   SPA-GMN-W24-SKJSRY-MAX )
      *
                   MOVE    SPA-GMN-W24-SKJSRYLST (IDX1)
                                       TO  W24-SYOKUJI-ITM (IDX0 IDX1)
      *
               END-PERFORM
      *
           END-PERFORM
      *
      *
      *    ¼¼ÎÁº¹³Û¾ÃÈñÀÇ¶èÊ¬
           MOVE    SPA-GMN-W24-BRMSGK-TAX-G TO W24-BRMSGK-TAX
           MOVE    SPA-GMN-W24-BRMSGK-TAX-MAX
                                           TO  W24-BRMSGK-TAX-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-BRMSGK-TAX-CNT )
      *
               MOVE    SPA-GMN-W24-BRMSGK-TAXLST (IDX0)
                                       TO  W24-BRMSGK-TAX-ITM (IDX0)
      *
           END-PERFORM
      *
      *    Æþ±¡²ñ·×¼¼ÎÁº¹³Û¶èÊ¬
           MOVE    SPA-GMN-W24-NACCT-BRMSGK-G
                                           TO  W24-NACCT-BRMSGK
           MOVE    SPA-GMN-W24-NACCT-BRMSGK-MAX
                                           TO  W24-NACCT-BRMSGK-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-NACCT-BRMSGK-CNT )
      *
               MOVE    SPA-GMN-W24-NACCT-BRMSGKLST (IDX0)
                                       TO  W24-NACCT-BRMSGK-ITM(IDX0)
      *
           END-PERFORM
      *
      *    Æþ±¡²ñ·×³°Çñ¶èÊ¬
           MOVE    SPA-GMN-W24-NACCT-GAIHAKU-G
                                           TO  W24-NACCT-GAIHAKU
           MOVE    SPA-GMN-W24-NACCT-GAIHAKU-MAX
                                           TO  W24-NACCT-GAIHAKU-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-NACCT-GAIHAKU-CNT )
      *
               MOVE    SPA-GMN-W24-NACCT-GAIHAKULST (IDX0)
                                       TO  W24-NACCT-GAIHAKU-ITM (IDX0)
      *
           END-PERFORM
      *
      *    Æþ±¡²Ã»»¾ðÊó
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   CONST-NYUKSN-MAX )
               MOVE    SPA-GMN-W24-NYUKSNMEI (IDX0)
                                           TO  W24-NYUKSNMEI (IDX0)
               MOVE    SPA-GMN-W24-CHK-NYUKSN (IDX0)
                                           TO  W24-CHK-NYUKSN(IDX0)
           END-PERFORM
      *
      *    Æþ±¡²ñ·×É½¼¨¾ðÊó
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   CONST-SRYACT-MAX )
               MOVE    SPA-GMN-W24-SRYCD (IDX0)
                                           TO  W24-SRYCD (IDX0)
               MOVE    SPA-GMN-W24-SRYACT (IDX0)
                                           TO  W24-SRYACT (IDX0)
           END-PERFORM
      *
      *    ÃÏ°è²Ã»»
           MOVE    SPA-GMN-W24-CHIIKIKSN-G TO  W24-CHIIKIKSN
           MOVE    SPA-GMN-W24-CHIIKIKSN-MAX
                                           TO  W24-CHIIKIKSN-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-CHIIKIKSN-CNT )
      *
               MOVE    SPA-GMN-W24-CHIIKIKSNLST (IDX0)
                                           TO  W24-CHIIKIKSN-ITM (IDX0)
      *
           END-PERFORM
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÉéÃ´¶èÊ¬
           MOVE    SPA-GMN-W24-SENTEI-FTNKBN-G
                                           TO  W24-SENTEI-FTNKBN
           MOVE    SPA-GMN-W24-SENTEI-FTNKBN-MAX
                                           TO  W24-SENTEI-FTNKBN-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-SENTEI-FTNKBN-CNT )
      *
               MOVE    SPA-GMN-W24-SENTEI-FTNKBNLST (IDX0)
                                       TO  W24-SENTEI-FTNKBN-ITM (IDX0)
      *
           END-PERFORM
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á
           MOVE    SPA-GMN-W24-SENTEI-TANKA
                                       TO  W24-SENTEI-TANKA
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á¡Ê°ìÈÌ¡Ë
           MOVE    SPA-GMN-W24-SENTEI-TANKAIP
                                       TO  W24-SENTEI-TANKAIP
      *
      *    ÁªÄêÎÅÍÜÈñ¡ÝÅÀ¿ôÃ±²Á¡ÊÏ·¿Í¡Ë
           MOVE    SPA-GMN-W24-SENTEI-TANKARJ
                                       TO  W24-SENTEI-TANKARJ
      *
      *    ÁªÄêÎÅÍÜÈñ¡Ý¥é¥Ù¥ë
           EVALUATE    SPA-GMN-W24-SENTEI-FTNKBN
           WHEN    "1"
               MOVE    "ÅÀ¿ôÃ±²Á"      TO  W24-LBL-SENTEI-TANKA
               MOVE    SPACE           TO  W24-LBL-SENTEI-EN
           WHEN    "2"
               MOVE    "°ìÈÌ¡¿Ï·¿Í"    TO  W24-LBL-SENTEI-TANKA
               MOVE    "±ß"            TO  W24-LBL-SENTEI-EN
               MOVE    "°ìÈÌ£±Æü"      TO  W24-LBL-SENTEI-TANKAIP
               MOVE    "±ß"            TO  W24-LBL-SENTEI-ENIP
               MOVE    "Ï·¿Í£±Æü"      TO  W24-LBL-SENTEI-TANKARJ
               MOVE    "±ß"            TO  W24-LBL-SENTEI-ENRJ
           WHEN    OTHER
               MOVE    SPACE           TO  W24-LBL-SENTEI-TANKA
               MOVE    SPACE           TO  W24-LBL-SENTEI-EN
           END-EVALUATE
      *
      *    ÁªÄêÎÅÍÜÈñ¡Ý¾ÃÈñÀÇ
           MOVE    SPA-GMN-W24-SENTEI-TAX-G
                                       TO  W24-SENTEI-TAX
           MOVE    SPA-GMN-W24-SENTEI-TAX-MAX
                                       TO  W24-SENTEI-TAX-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-SENTEI-TAX-CNT )
      *
               MOVE    SPA-GMN-W24-SENTEI-TAXLST (IDX0)
                                       TO  W24-SENTEI-TAX-ITM (IDX0)
      *
           END-PERFORM
      *
      *    Æþ±¡ÎòÉ½¼¨¶èÊ¬
           MOVE    SPA-GMN-W24-REKI-DISPKBN-G
                                       TO  W24-REKI-DISPKBN
           MOVE    SPA-GMN-W24-REKI-DISPKBN-MAX
                                       TO  W24-REKI-DISPKBN-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-REKI-DISPKBN-CNT )
      *
               MOVE    SPA-GMN-W24-REKI-DISPKBNLST (IDX0)
                                       TO  W24-REKI-DISPKBN-ITM (IDX0)
      *
           END-PERFORM
      *
      *    Âà±¡ºÆ·×»»¶èÊ¬
           MOVE    SPA-GMN-W24-SAIKEISANKBN-G
                                       TO  W24-SAIKEISANKBN
           MOVE    SPA-GMN-W24-SAIKEISANKBN-MAX
                                       TO  W24-SAIKEISANKBN-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-SAIKEISANKBN-CNT )
      *
               MOVE    SPA-GMN-W24-SAIKEISANKBNLST (IDX0)
                                       TO  W24-SAIKEISANKBN-ITM (IDX0)
      *
           END-PERFORM
      *
      *    Æþ¶â¤Î¼è°·¤¤
           MOVE    SPA-GMN-W24-NYKNKNRKBN-G
                                       TO  W24-NYKNKNRKBN
           MOVE    SPA-GMN-W24-NYKNKNRKBN-MAX
                                       TO  W24-NYKNKNRKBN-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-NYKNKNRKBN-CNT )
      *
               MOVE    SPA-GMN-W24-NYKNKNRKBNLST (IDX0)
                                       TO  W24-NYKNKNRKBN-ITM (IDX0)
      *
           END-PERFORM
      *
      *    ÀÁµá½ñÈ¯¹Ô¶èÊ¬
           MOVE    SPA-GMN-W24-SKYPRTKBN-G
                                       TO  W24-SKYPRTKBN
           MOVE    SPA-GMN-W24-SKYPRTKBN-MAX
                                       TO  W24-SKYPRTKBN-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0        >   W24-SKYPRTKBN-CNT )
      *
               MOVE    SPA-GMN-W24-SKYPRTKBNLST (IDX0)
                                       TO  W24-SKYPRTKBN-ITM (IDX0)
      *
           END-PERFORM
      *
      *    ÀÁµá½ñÌ¤¼ý³Û°õºþ¶èÊ¬
           MOVE    SPA-GMN-W24-MISYUPRTKBN-G
                                       TO  W24-SKYMISYUPRTKBN
           MOVE    SPA-GMN-W24-MISYUPRTKBN-MAX
                                       TO  W24-SKYMISYUPRTKBN-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-SKYMISYUPRTKBN-CNT )
      *
               MOVE    SPA-GMN-W24-MISYUPRTKBNLST (IDX0)
                                       TO  W24-SKYMISYUPRTKBN-ITM (IDX0)
      *
           END-PERFORM
      *
      *    ¿ÇÎÅÈñÌÀºÙ½ñÈ¯¹Ô¶èÊ¬
           MOVE    SPA-GMN-W24-SRYPRTKBN-G
                                       TO  W24-SRYPRTKBN
           MOVE    SPA-GMN-W24-SRYPRTKBN-MAX
                                       TO  W24-SRYPRTKBN-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0        >   W24-SRYPRTKBN-CNT )
      *
               MOVE    SPA-GMN-W24-SRYPRTKBNLST (IDX0)
                                       TO  W24-SRYPRTKBN-ITM (IDX0)
      *
           END-PERFORM
      *
      *    Âà±¡¾ÚÌÀ½ñÈ¯¹Ô¶èÊ¬
           MOVE    SPA-GMN-W24-TAIPRTKBN-G
                                       TO  W24-TAIPRTKBN
           MOVE    SPA-GMN-W24-TAIPRTKBN-MAX
                                       TO  W24-TAIPRTKBN-CNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-TAIPRTKBN-CNT )
      *
               MOVE    SPA-GMN-W24-TAIPRTKBNLST (IDX0)
                                       TO  W24-TAIPRTKBN-ITM (IDX0)
      *
           END-PERFORM
      *
      *    Âà±¡¾ÚÌÀ½ñµ­ºÜ¶èÊ¬
           MOVE    SPA-GMN-W24-TAIKSIKBN-G
                                       TO  W24-TAIKSIKBN
           MOVE    SPA-GMN-W24-TAIKSIKBN-MAX
                                       TO  W24-TAIKSIKBN-CNT
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-TAIKSIKBN-CNT )
      *
      *
               MOVE    SPA-GMN-W24-TAIKSIKBNLST (IDX0)
                                       TO  W24-TAIKSIKBN-ITM (IDX0)
      *
           END-PERFORM
      *!!
      *    Âà±¡»þ±¡³°½èÊý¤»¤óÈ¯¹Ô¶èÊ¬
           MOVE    SPA-GMN-W24-SHOHOUKBN-G
                                       TO  W24-SHOHOUKBN
           MOVE    SPA-GMN-W24-SHOHOUKBN-MAX
                                       TO  W24-SHOHOUKBN-COUNT
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0        >   SPA-GMN-W24-SHOHOUKBN-MAX )
      *
               MOVE    SPA-GMN-W24-SHOHOUKBNLST (IDX0)
                                       TO  W24-SHOHOUKBN-ITEM (IDX0)
      *
           END-PERFORM
      *
      *    É¸·ç¸º³Û¶èÊ¬
           MOVE    SPA-GMN-W24-HYOUKETU-G
                                       TO  W24-HYOUKETU
           MOVE    SPA-GMN-W24-HYOUKETU-MAX
                                       TO  W24-HYOUKETU-CNT
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-HYOUKETU-CNT )
      *
      *
               MOVE    SPA-GMN-W24-HYOUKETULST (IDX0)
                                       TO  W24-HYOUKETU-ITM (IDX0)
      *
           END-PERFORM
      *
      *    Äê¿ôÄ¶²á¶èÊ¬
           MOVE    SPA-GMN-W24-TEISU-G
                                       TO  W24-TEISU
           MOVE    SPA-GMN-W24-TEISU-MAX
                                       TO  W24-TEISU-CNT
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-TEISU-CNT )
      *
      *
               MOVE    SPA-GMN-W24-TEISULST (IDX0)
                                       TO  W24-TEISU-ITM (IDX0)
      *
           END-PERFORM
      *
      *
      *    £Á£Ä£ÌÆþÎÏ¶èÊ¬
           MOVE    SPA-GMN-W24-ADLINPUT-G
                                       TO  W24-ADLINPUT
           MOVE    SPA-GMN-W24-ADLINPUT-MAX
                                       TO  W24-ADLINPUT-CNT
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-ADLINPUT-CNT )
      *
      *
               MOVE    SPA-GMN-W24-ADLINPUTLST (IDX0)
                                       TO  W24-ADLINPUT-ITM (IDX0)
      *
           END-PERFORM
      *
      *    Äê´üÀÁµáº¹³Û½é´üÉ½¼¨¶èÊ¬
           MOVE    SPA-GMN-W24-TEIKISAGAKUACT-G
                                       TO  W24-TEIKISAGAKUACT
           MOVE    SPA-GMN-W24-TEIKISAGAKUACT-MAX
                                       TO  W24-TEIKISAGAKUACT-CNT
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-TEIKISAGAKUACT-CNT )
      *
      *
               MOVE    SPA-GMN-W24-TEIKISAGAKUACTLST (IDX0)
                                       TO  W24-TEIKISAGAKUACT-ITM (IDX0)
      *
           END-PERFORM
      *
      *    ÎÅÍÜÆþ±¡É½¼¨¶èÊ¬
           MOVE    SPA-GMN-W24-RYOYODSP-G
                                       TO  W24-RYOYODSP
           MOVE    SPA-GMN-W24-RYOYODSP-MAX
                                       TO  W24-RYOYODSP-CNT
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   W24-RYOYODSP-CNT )
      *
      *
               MOVE    SPA-GMN-W24-RYOYODSPLST (IDX0)
                                       TO  W24-RYOYODSP-ITM (IDX0)
      *
           END-PERFORM
      *
           IF    ( SPA-W01-EDYUKYMD    >=  CONST-H180401 )
               MOVE    "Æþ±¡²Ã»»¾ðÊó"          TO  W24-FRAME3-LABEL
           ELSE
               MOVE    "Æþ±¡²Ã»»¡¦¸º»»¾ðÊó"    TO  W24-FRAME3-LABEL
           END-IF
      *
      *    ¹àÌÜ¾õÂÖÊÔ½¸
           PERFORM 500-GMNHEN-STATE-EDIT-SEC
      *
           PERFORM 5001-MAPCUR-SEC
      *
           .
       500-GMNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¹àÌÜ¾õÂÖÊÔ½¸½èÍý
      *****************************************************************
       500-GMNHEN-STATE-EDIT-SEC       SECTION.
      *
           MOVE    WIDGET-NORMAL       TO  W24-B03-STATE
           MOVE    WIDGET-NORMAL       TO  W24-SENTEI-TANKAIP-STATE
           MOVE    WIDGET-NORMAL       TO  W24-SENTEI-TANKARJ-STATE
           MOVE    WIDGET-NORMAL       TO  W24-B03-STATE
           MOVE    WIDGET-NORMAL       TO  W24-SYOKUJI-STATE (1)
           MOVE    WIDGET-NORMAL       TO  W24-SYOKUJI-STATE (2)
           MOVE    WIDGET-NORMAL       TO  W24-SYOKUJI-ITM-STATE (1)
           MOVE    WIDGET-NORMAL       TO  W24-SYOKUJI-ITM-STATE (2)
           MOVE    WIDGET-NORMAL       TO  W24-HYOUKETU-STATE
           MOVE    WIDGET-NORMAL       TO  W24-TEISU-STATE
           MOVE    WIDGET-NORMAL       TO  W24-HYOUKETU-ITM-STATE
      *
           IF    ( SPA-W01-STYUKYMD    =   ZERO )
               MOVE    WIDGET-INSENSITIVE
                                       TO  W24-B03-STATE
           END-IF
      *
           IF    ( SPA-GMN-W24-SENTEI-FTNKBN   =   "1" )
               MOVE    WIDGET-INSENSITIVE
                                       TO  W24-SENTEI-TANKAIP-STATE
                                           W24-SENTEI-TANKARJ-STATE
           END-IF
      *
           IF    ( SPA-NAI-W24-SKJSRY-SRYCD (1)   =   SPACE )
               MOVE    WIDGET-INSENSITIVE
                                       TO  W24-SYOKUJI-STATE (1)
                                           W24-SYOKUJI-ITM-STATE (1)
           END-IF
      *
           IF    ( SPA-NAI-W24-SKJSRY-SRYCD (2)   =   SPACE )
               MOVE    WIDGET-INSENSITIVE
                                       TO  W24-SYOKUJI-STATE (2)
                                           W24-SYOKUJI-ITM-STATE (2)
           END-IF
      *
           IF    ( SPA-W01-STYUKYMD    <   CONST-H180401 )
               MOVE    WIDGET-INSENSITIVE
                                       TO  W24-HYOUKETU-STATE
                                           W24-HYOUKETU-ITM-STATE
           END-IF
      *
           IF    ( SPA-W01-STYUKYMD    <   CONST-H180401 )
               MOVE    WIDGET-INSENSITIVE
                                       TO  W24-TEISU-STATE
                                           W24-TEISU-ITM-STATE
           END-IF
      *
           .
       500-GMNHEN-STATE-EDIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ¥«¡¼¥½¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       5001-MAPCUR-SEC             SECTION.
      *
           IF     (SPA-ERRCD           =   SPACE)  AND
                  (SPA-GMN-W24-CUR     =   ZERO )
               PERFORM 5011-INPUT-CUR-SEC
           END-IF
      *
           PERFORM 5012-SKIP-CUR-SEC
      *
           EVALUATE    SPA-GMN-W24-CUR
           WHEN    001
               MOVE    "SKJRYOYO"      TO  MCP-WIDGET
           WHEN    002
               MOVE    "SYOKUJI01"     TO  MCP-WIDGET
           WHEN    003
               MOVE    "SYOKUJI02"     TO  MCP-WIDGET
           WHEN    008
               MOVE    "CHK_NYUKSN01"  TO  MCP-WIDGET
           WHEN    009
               MOVE    "CHK_NYUKSN02"  TO  MCP-WIDGET
           WHEN    010
               MOVE    "CHK_NYUKSN03"  TO  MCP-WIDGET
           WHEN    011
               MOVE    "CHK_NYUKSN04"  TO  MCP-WIDGET
           WHEN    012
               MOVE    "CHK_NYUKSN05"  TO  MCP-WIDGET
           WHEN    013
               MOVE    "CHK_NYUKSN06"  TO  MCP-WIDGET
           WHEN    014
               MOVE    "CHK_NYUKSN07"  TO  MCP-WIDGET
           WHEN    015
               MOVE    "CHK_NYUKSN08"  TO  MCP-WIDGET
           WHEN    016
               MOVE    "CHK_NYUKSN09"  TO  MCP-WIDGET
           WHEN    017
               MOVE    "CHK_NYUKSN10"  TO  MCP-WIDGET
           WHEN    018
               MOVE    "CHK_NYUKSN11"  TO  MCP-WIDGET
           WHEN    019
               MOVE    "CHK_NYUKSN12"  TO  MCP-WIDGET
           WHEN    020
               MOVE    "CHK_NYUKSN13"  TO  MCP-WIDGET
           WHEN    021
               MOVE    "CHK_NYUKSN14"  TO  MCP-WIDGET
           WHEN    022
               MOVE    "CHK_NYUKSN15"  TO  MCP-WIDGET
           WHEN    023
               MOVE    "CHK_NYUKSN16"  TO  MCP-WIDGET
           WHEN    024
               MOVE    "CHK_NYUKSN17"  TO  MCP-WIDGET
           WHEN    025
               MOVE    "CHK_NYUKSN18"  TO  MCP-WIDGET
           WHEN    026
               MOVE    "CHK_NYUKSN19"  TO  MCP-WIDGET
           WHEN    027
               MOVE    "CHK_NYUKSN20"  TO  MCP-WIDGET
           WHEN    028
               MOVE    "CHIIKIKSN"     TO  MCP-WIDGET
           WHEN    029
               MOVE    "SRYCD01"       TO  MCP-WIDGET
           WHEN    030
               MOVE    "SRYCD02"       TO  MCP-WIDGET
           WHEN    031
               MOVE    "SRYCD03"       TO  MCP-WIDGET
           WHEN    032
               MOVE    "SRYCD04"       TO  MCP-WIDGET
           WHEN    033
               MOVE    "SRYCD05"       TO  MCP-WIDGET
           WHEN    034
               MOVE    "SRYCD06"       TO  MCP-WIDGET
           WHEN    035
               MOVE    "SRYCD07"       TO  MCP-WIDGET
           WHEN    036
               MOVE    "SRYCD08"       TO  MCP-WIDGET
           WHEN    037
               MOVE    "SRYCD09"       TO  MCP-WIDGET
           WHEN    038
               MOVE    "SRYCD10"       TO  MCP-WIDGET
           WHEN    039
               MOVE    "SENTEI_FTNKBN"    TO  MCP-WIDGET
           WHEN    040
               MOVE    "SENTEI_TANKA"  TO  MCP-WIDGET
           WHEN    041
               MOVE    "SENTEI_TAX"    TO  MCP-WIDGET
           WHEN    042
               MOVE    "REKI_DISPKBN"  TO  MCP-WIDGET
           WHEN    056
               MOVE    "SAIKEISANKBN"  TO  MCP-WIDGET
           WHEN    058
               MOVE    "NYKNKNRKBN"    TO  MCP-WIDGET
           WHEN    043
               MOVE    "SKYPRTKBN"     TO  MCP-WIDGET
           WHEN    044
               MOVE    "SKYMISYUPRTKBN"
                                       TO  MCP-WIDGET
           WHEN    050
               MOVE    "SRYPRTKBN"     TO  MCP-WIDGET
           WHEN    045
               MOVE    "TAIPRTKBN"     TO  MCP-WIDGET
           WHEN    052
               MOVE    "TAIKSIKBN"     TO  MCP-WIDGET
           WHEN    046
               MOVE    "BRMSGK_TAX"    TO  MCP-WIDGET
           WHEN    047
               MOVE    "NACCT_BRMSGK"  TO  MCP-WIDGET
           WHEN    051
               MOVE    "NACCT_GAIHAKU" TO  MCP-WIDGET
           WHEN    053
               MOVE    "HYOUKETU"      TO  MCP-WIDGET
           WHEN    054
               MOVE    "TEISU"         TO  MCP-WIDGET
           WHEN    055
               MOVE    "ADLINPUT"      TO  MCP-WIDGET
           WHEN    048
               MOVE    "SENTEI_TANKAIP"
                                       TO  MCP-WIDGET
           WHEN    049
               MOVE    "SENTEI_TANKARJ"
                                       TO  MCP-WIDGET
           WHEN    057
               MOVE    "TEIKISAGAKUACT" TO MCP-WIDGET
           WHEN    059
               MOVE    "RYOYODSP"      TO MCP-WIDGET
      *    Âà±¡»þ±¡³°½èÊý¤»¤ó
           WHEN    060
               MOVE    "SHOHOUKBN"     TO MCP-WIDGET
           WHEN    212
               MOVE    "B12"           TO  MCP-WIDGET
           END-EVALUATE
      *
           .
       5001-MAPCUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È½èÍý
      *****************************************************************
       5011-INPUT-CUR-SEC          SECTION.
      *
           EVALUATE    MCP-WIDGET
           WHEN    "SKJRYOYO"
               MOVE    002             TO  SPA-GMN-W24-CUR
           WHEN    "SYOKUJI01"
               MOVE    003             TO  SPA-GMN-W24-CUR
           WHEN    "SYOKUJI02"
               MOVE    046             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN01"
               MOVE    009             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN02"
               MOVE    010             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN03"
               MOVE    011             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN04"
               MOVE    012             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN05"
               MOVE    013             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN06"
               MOVE    014             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN07"
               MOVE    015             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN08"
               MOVE    016             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN09"
               MOVE    017             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN10"
               MOVE    018             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN11"
               MOVE    019             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN12"
               MOVE    020             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN13"
               MOVE    021             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN14"
               MOVE    022             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN15"
               MOVE    023             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN16"
               MOVE    024             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN17"
               MOVE    025             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN18"
               MOVE    026             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN19"
               MOVE    027             TO  SPA-GMN-W24-CUR
           WHEN    "CHK_NYUKSN20"
               MOVE    028             TO  SPA-GMN-W24-CUR
           WHEN    "CHIIKIKSN"
               MOVE    029             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD01"
               MOVE    030             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD02"
               MOVE    031             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD03"
               MOVE    032             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD04"
               MOVE    033             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD05"
               MOVE    034             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD06"
               MOVE    035             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD07"
               MOVE    036             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD08"
               MOVE    037             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD09"
               MOVE    038             TO  SPA-GMN-W24-CUR
           WHEN    "SRYCD10"
               MOVE    039             TO  SPA-GMN-W24-CUR
           WHEN    "SENTEI_FTNKBN"
               EVALUATE    SPA-GMN-W24-SENTEI-FTNKBN
               WHEN    "1"
               WHEN    "2"
                   MOVE    040         TO  SPA-GMN-W24-CUR
               WHEN    OTHER
                   MOVE    042         TO  SPA-GMN-W24-CUR
               END-EVALUATE
           WHEN    "SENTEI_TANKA"
               MOVE    048             TO  SPA-GMN-W24-CUR
           WHEN    "SENTEI_TANKAIP"
               MOVE    049             TO  SPA-GMN-W24-CUR
           WHEN    "SENTEI_TANKARJ"
               MOVE    041             TO  SPA-GMN-W24-CUR
           WHEN    "SENTEI_TAX"
               MOVE    042         TO  SPA-GMN-W24-CUR
           WHEN    "REKI_DISPKBN"
               MOVE    056             TO  SPA-GMN-W24-CUR
           WHEN    "SAIKEISANKBN"
               MOVE    058             TO  SPA-GMN-W24-CUR
           WHEN    "NYKNKNRKBN"
               MOVE    043             TO  SPA-GMN-W24-CUR
           WHEN    "SKYPRTKBN"
               MOVE    044             TO  SPA-GMN-W24-CUR
           WHEN    "SKYMISYUPRTKBN"
               MOVE    050             TO  SPA-GMN-W24-CUR
           WHEN    "SRYPRTKBN"
               MOVE    045             TO  SPA-GMN-W24-CUR
           WHEN    "TAIPRTKBN"
               MOVE    052             TO  SPA-GMN-W24-CUR
           WHEN    "TAIKSIKBN"
               MOVE    057             TO  SPA-GMN-W24-CUR
           WHEN    "BRMSGK_TAX"
               MOVE    047             TO  SPA-GMN-W24-CUR
           WHEN    "NACCT_BRMSGK"
               MOVE    051             TO  SPA-GMN-W24-CUR
           WHEN    "NACCT_GAIHAKU"
               MOVE    053             TO  SPA-GMN-W24-CUR
           WHEN    "HYOUKETU"
               MOVE    054             TO  SPA-GMN-W24-CUR
           WHEN    "TEISU"
               MOVE    055             TO  SPA-GMN-W24-CUR
           WHEN    "ADLINPUT"
               MOVE    059             TO  SPA-GMN-W24-CUR
           WHEN    "TEIKISAGAKUACT"
      ******** MOVE    212             TO  SPA-GMN-W24-CUR
               MOVE    060             TO  SPA-GMN-W24-CUR
           WHEN    "SHOHOUKBN"
               MOVE    212             TO  SPA-GMN-W24-CUR
           WHEN    "RYOYODSP"
               MOVE    008             TO  SPA-GMN-W24-CUR
           END-EVALUATE
      *
           .
      *
       5011-INPUT-CUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥«¡¼¥½¥ë¥¹¥­¥Ã¥×½èÍý
      *****************************************************************
       5012-SKIP-CUR-SEC               SECTION.
      *
           IF    ( SPA-GMN-W24-CUR =   2 )
               IF    ( W24-SYOKUJI-STATE (1)   =   WIDGET-INSENSITIVE )
                   MOVE    3           TO  SPA-GMN-W24-CUR
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-W24-CUR =   3 )
               IF    ( W24-SYOKUJI-STATE (2)   =   WIDGET-INSENSITIVE )
                   MOVE    46          TO  SPA-GMN-W24-CUR
               END-IF
           END-IF
      *
           PERFORM VARYING IDX0    FROM    8   BY  1
                   UNTIL ( IDX0    >   27 )
      *
               IF    ( SPA-GMN-W24-CUR     =   IDX0 )
                   IF    ( SPA-GMN-W24-NYUKSNMEI (IDX0 - 7)
                                           =   SPACE )
                       MOVE    28      TO  SPA-GMN-W24-CUR
                   END-IF
               END-IF
      *
           END-PERFORM
      *
           IF    ( SPA-GMN-W24-CUR     =   48 )
               IF    ( W24-SENTEI-TANKAIP-STATE
                                           =   WIDGET-INSENSITIVE )
                   MOVE    41          TO  SPA-GMN-W24-CUR
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-W24-CUR     =   49 )
               IF    ( W24-SENTEI-TANKARJ-STATE
                                           =   WIDGET-INSENSITIVE )
                   MOVE    41          TO  SPA-GMN-W24-CUR
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-W24-CUR     =   53 )
               IF    ( W24-HYOUKETU-STATE
                                           =   WIDGET-INSENSITIVE )
                   MOVE    54           TO  SPA-GMN-W24-CUR
               END-IF
           END-IF
      *
           IF    ( SPA-GMN-W24-CUR     =   54 )
               IF    ( W24-TEISU-STATE
                                           =   WIDGET-INSENSITIVE )
                   MOVE    55           TO  SPA-GMN-W24-CUR
               END-IF
           END-IF
      *
           .
       5012-SKIP-CUR-EXT.
           EXIT.
      *****************************************************************
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸É½¼¨Íý
      *****************************************************************
       510-ERRSET-SEC              SECTION.
      *
           MOVE    SPACE               TO  SPA-ERRMSG
      *
           EVALUATE    SPA-ERRCD
           WHEN    "0001"
               MOVE    "ÆþÎÏ¥¨¥é¡¼"    TO  SPA-ERRMSG
           WHEN    "0002"
               MOVE    "³ºÅö¤Î¿ÇÎÅ¥³¡¼¥É¤ÏÂ¸ºß¤·¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "0003"
               MOVE    "¿ÇÎÅ¥³¡¼¥ÉÆþÎÏµ¬Â§¤Ë¤¢¤Ã¤Æ¤¤¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "0004"
               MOVE    "²Ã»»¤ËÉ¬Í×¤Ê»ÜÀß´ð½à¤¬ÀßÄê¤µ¤ì¤Æ¤¤¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "0005"
               MOVE    "¿©»öÎÅÍÜÈñÆþÎÏ¥¨¥é¡¼"
                                       TO  SPA-ERRMSG
           WHEN    "0006"
               MOVE    "ÆÃÊÌ´ÉÍý²Ã»»ÆþÎÏ¥¨¥é¡¼"
                                       TO  SPA-ERRMSG
           WHEN    "0007"
               MOVE    "¿©Æ²²Ã»»ÆþÎÏ¥¨¥é¡¼"
                                       TO  SPA-ERRMSG
           WHEN    "0008"
               MOVE    "ÃÏ°è²Ã»»ÆþÎÏ¥¨¥é¡¼"
                                       TO  SPA-ERRMSG
           WHEN    "1001"
               MOVE    "µÞÀ­´üÉÂ±¡²Ã»»¤ÈµÞÀ­´üÆÃÄêÉÂ±¡²Ã»»¤ÏÆ±»þ"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "¤Ë²Ã»»¤Ç¤­¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG (41 : )
           WHEN    "1002"
               MOVE    "ÃÏ°è°åÎÅ»Ù±çÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»£±¤È£²¤ÏÆ±»þ"
                                       TO  SPA-ERRMSG (1 : 40)
               MOVE    "¤Ë²Ã»»¤Ç¤­¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG (41 : )
           WHEN    "1003"
               MOVE    "¿ÇÎÅ½ê¤Ë´Ø¤¹¤ë²Ã»»¤Ï¹Ô¤¨¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1004"
               MOVE    "ÉÂ±¡¤Ë´Ø¤¹¤ë²Ã»»¤Ï¹Ô¤¨¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1005"
               MOVE    "Æ±¤¸¿ÇÎÅ¹Ô°Ù¤¬½ÅÊ£¤·¤ÆÀßÄê¤µ¤ì¤Æ¤¤¤Þ¤¹"
                                       TO  SPA-ERRMSG
           WHEN    "1006"
               MOVE    "ÉéÃ´·×»»¤òÆþÎÏ¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1007"
               MOVE    "ÅÀ¿ôÃ±²Á¤Ï£¹£¹ÅÀ°Ê²¼¤ÇÆþÎÏ¤·¤Æ¤¯¤À¤µ¤¤"
                                       TO  SPA-ERRMSG
           WHEN    "1008"
               MOVE    SPACE           TO  SPA-ERRMSG
               STRING  "°ìÈÌ¡¿Ï·¿Í¤È°ìÈÌ£±Æü¡ÊÏ·¿Í£±Æü¡Ë¤Ï¤¤¤º¤ì"
                                           DELIMITED   BY  SIZE
                       "¤«¤òÆþÎÏ¤·¤Æ¤¯¤À¤µ¤¤"
                                           DELIMITED   BY  SIZE
               INTO  SPA-ERRMSG
               END-STRING
           WHEN    "1009"
               MOVE    "É¸·ç¤ÈÄê¿ôÄ¶²á¤ÏÆ±»þÀßÄê¤Ç¤­¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1010"
               MOVE    "É¸·ç¤Þ¤¿¤ÏÄê¿ôÄ¶²á¤ÈÆ±»þÀßÄê¤Ç¤­¤Þ¤»¤ó"
                                       TO  SPA-ERRMSG
           WHEN    "1201"
               MOVE    "¹¹¿·¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿"
                                       TO  SPA-ERRMSG
           WHEN    "1202"
               MOVE    "¹¹¿·¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿"
                                       TO  SPA-ERRMSG
           END-EVALUATE
      *
           MOVE    SPACE               TO  WERR
           MOVE    SPA-ERRCD           TO  WERR-ERRCODE
           MOVE    SPA-ERRMSG          TO  WERR-ERRMSG
           MOVE    "B01"               TO  MCP-WIDGET
      *
           MOVE    "W24"               TO  SPA-MOTOPG
           MOVE    "WERR"              TO  SPA-SAKIPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    "WERR"              TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
       510-ERRSET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¬¥¤¥É¥á¥Ã¥»¡¼¥¸É½¼¨
      *****************************************************************
       520-WIDSET-SEC              SECTION.
      *
           EVALUATE    SPA-WIDCD
           WHEN    "3001"
               MOVE    "ÅÐÏ¿½èÍý¤ò¤·¤Þ¤¹"
                                        TO  WRK-WIDMSG
           WHEN    "3002"
               MOVE    "ºï½ü½èÍý¤ò¤·¤Þ¤¹"
                                        TO  WRK-WIDMSG
           END-EVALUATE
      *
      *
           MOVE    SPACE                TO  WID1
           MOVE    SPA-WIDCD            TO  WID1-ID1CODE
           MOVE    WRK-WIDMSG           TO  WID1-ID1MSG
           MOVE    "B12"                TO  MCP-WIDGET
      *
           MOVE    "W24"                TO  SPA-MOTOPG
           MOVE    "WID1"               TO  SPA-SAKIPG
      *
           MOVE    "NEW"                TO  MCP-PUTTYPE
           MOVE    "WID1"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                    TO  FLG-END              
      *
           .
       520-WIDSET-EXT.
           EXIT.
      *
      *****************************************************************
      *    Á´³ÑÈ¾³Ñº®ºß¥Á¥§¥Ã¥¯
      *****************************************************************
       800-ENRTRY-CHK-SEC              SECTION.
      *
           MOVE    ZERO            TO  FLG-ENTRYCHK
      *
           IF  ( WRK-KANACHK-MAE-INPUT
                                   =   SPACE )
               GO  TO  800-ENRTRY-CHK-EXT
           END-IF
      *
           MOVE    SPACE           TO  ORCSKANACHKAREA
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"             TO  KANACHK-SYORI
           MOVE    WRK-KANACHK-MAE-INPUT
                                   TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"   USING   ORCSKANACHKAREA
           IF      ( KANACHK-RC    NOT =   ZERO )
               MOVE    1           TO  FLG-ENTRYCHK
               GO  TO  800-ENRTRY-CHK-EXT
           END-IF
      *
      *    Á´³Ñ¤Ç¤Ê¤¤¾ì¹ç¤Ï¥¨¥é¡¼¤È¤¹¤ë¡£
           IF      ( KANACHK-SYUBETU   NOT =   2 )
               MOVE    1           TO  FLG-ENTRYCHK
           END-IF
      *
           .
       800-ENRTRY-CHK-EXT.
           EXIT.
      *****************************************************************
      *    À¾ÎñÆüËÜ¸ìÊÑ´¹½èÍý
      *****************************************************************
       800-SEIWA-HEN-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-HIZUKE-ERR
           MOVE    SPACE               TO  WRK-SYMD
                                           WRK-HENYMDG
      *
           IF    ( WRK-YMD         =   "00000000" 
                                   OR  "99999999" )
               MOVE    WRK-YMD     TO  WRK-HENYMDG
                                       WRK-SYMD
               GO  TO  800-SEIWA-HEN-EXT
           END-IF
      *
      *    ÆüÉÕ²èÌÌ¥Á¥§¥Ã¥¯¥µ¥Ö
           INITIALIZE                      ORCSGDAYAREA
           MOVE    WRK-YMD             TO  SGDAY-INDAY
           CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
           IF  ( SGDAY-RC              =   ZERO )
               MOVE    SGDAY-OTDAY     TO  WRK-HENYMDG
               MOVE    SGDAY-SDAY      TO  WRK-SYMD
           ELSE
               MOVE    1               TO  FLG-HIZUKE-ERR
           END-IF
      *
           .
       800-SEIWA-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¥Þ¥·¥óÆüÉÕ¼èÆÀ¥µ¥Ö
      *****************************************************************
       800-MCNDATE-SEC         SECTION.
      *
           CALL    "ORCSMCNDATE"   USING   ORCSMCNDATEAREA
      *
           .
      *
       800-MCNDATE-EXT.
           EXIT.
      *****************************************************************
      *    Ê¿À®£±£¸Ç¯ÅÙ²þÀµ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       800-H1804-KAISEI-CHK-SEC            SECTION.
      *
           IF    ( SPA-W01-SELNUM      >   ZERO )
               IF    ( CONST-H180401   >   SPA-W01-SEL-STYUKYMD )
                AND  ( CONST-H180401  <=   SPA-W01-EDYUKYMD )
                   PERFORM 310-SYS-5000-SEL-SEC
                   IF    ( FLG-SYSKANRI    =   ZERO )
                       MOVE    SYS-5000-EDYUKYMD   TO  WRK-EDYUKYMD
                       MOVE    "20060331"          TO  SYS-5000-EDYUKYMD
                       PERFORM 800-MCNDATE-SEC
                       MOVE    SMCNDATE-YMD    TO  SYS-5000-UPYMD
                       MOVE    SMCNDATE-HMS    TO  SYS-5000-UPHMS
                       MOVE    SYS-5000-REC    TO  SYSKANRI-REC
                       MOVE    SYS-5000-HOSPNUM    TO  SYSUP-HOSPNUM
                       MOVE    SYS-5000-KANRICD    TO  SYSUP-KANRICD
                       MOVE    SYS-5000-KBNCD      TO  SYSUP-KBNCD
                       MOVE    SYS-5000-STYUKYMD   TO  SYSUP-STYUKYMD
                       MOVE    WRK-EDYUKYMD        TO  SYSUP-EDYUKYMD
                       MOVE    SYSKANRI-REC        TO  MCPDATA-REC
                       MOVE    "tbl_syskanri"      TO  MCP-TABLE
                       MOVE    "upd1"              TO  MCP-PATHNAME
                       PERFORM 910-DBUPDATE-SEC
                       IF    ( MCP-RC  NOT =   ZERO )
                           DISPLAY "1:DBUPDATE ERR"
                       END-IF
      *
                       MOVE    SPA-W01-STYUKYMD    TO  WRK-STYUKYMD
                       MOVE    SPA-W01-SELNUM      TO  WRK-SELNUM
                       MOVE    SPA-W01-SEL-STYUKYMD
                                                   TO  WRK-SEL-STYUKYMD
      *
                       INITIALIZE                  SPA-W01-SELNUM
                                                   SPA-W01-SEL-STYUKYMD
                                                   SPA-W01-SEL-EDYUKYMD
      *
                       MOVE    CONST-H180401       TO  SPA-W01-STYUKYMD
                       PERFORM 3101-SPASET-SEC
                       PERFORM 4811-HOSP-NYUINKHN-EDIT-SEC
      *
                       PERFORM 800-MCNDATE-SEC
                       MOVE    SMCNDATE-YMD        TO  SYS-5000-CREYMD
                                                       SYS-5000-UPYMD
                       MOVE    SMCNDATE-HMS        TO  SYS-5000-UPHMS
      *
                       MOVE    SYS-5000-REC    TO  SYSKANRI-REC
                       MOVE    SYSKANRI-REC    TO  MCPDATA-REC
                       MOVE    "tbl_syskanri"  TO  MCP-TABLE
                       MOVE    "key"           TO  MCP-PATHNAME
                       PERFORM 910-DBINSERT-SEC
                       IF    ( MCP-RC  NOT =   ZERO )
                           DISPLAY "2:DBINSERT ERR"
                       END-IF
                       MOVE    WRK-SELNUM      TO  SPA-W01-SELNUM
                       MOVE    WRK-STYUKYMD    TO  SPA-W01-STYUKYMD
                       MOVE    WRK-SEL-STYUKYMD
                                               TO  SPA-W01-SEL-STYUKYMD
      *
                       MOVE    20060331        TO  SPA-W01-SEL-EDYUKYMD
                                                   SPA-W01-EDYUKYMD
      *
                       MOVE    SPA-W01-STYUKYMD    TO  WRK-YMD
                       PERFORM 800-SEIWA-HEN-SEC
                       MOVE    WRK-HENYMDG TO  SPA-W01-STYUKYMDH
      *
                       MOVE    SPA-W01-EDYUKYMD    TO  WRK-YMD
                       PERFORM 800-SEIWA-HEN-SEC
                       MOVE    WRK-HENYMDG TO  SPA-W01-EDYUKYMDH
      *
                   END-IF
               END-IF
           ELSE
               IF    ( CONST-H180401   >  SPA-W01-STYUKYMD )
                AND  ( CONST-H180401  <=  SPA-W01-EDYUKYMD )
                   MOVE    SPA-W01-EDYUKYMD    TO  WRK-EDYUKYMD
                   MOVE    20060331            TO  SPA-W01-EDYUKYMD
                   PERFORM 3101-SPASET-SEC
                   PERFORM 4811-HOSP-NYUINKHN-EDIT-SEC
      *
                   PERFORM 800-MCNDATE-SEC
                   MOVE    SMCNDATE-YMD    TO  SYS-5000-CREYMD
                                               SYS-5000-UPYMD
                   MOVE    SMCNDATE-HMS    TO  SYS-5000-UPHMS
      *
                   MOVE    SYS-5000-REC    TO  SYSKANRI-REC
                   MOVE    SYSKANRI-REC    TO  MCPDATA-REC
                   MOVE    "tbl_syskanri"  TO  MCP-TABLE
                   MOVE    "key"           TO  MCP-PATHNAME
                   PERFORM 910-DBINSERT-SEC
                   IF    ( MCP-RC  NOT =   ZERO )
                       DISPLAY "3:DBINSERT ERR"
                   END-IF
      *
                   MOVE    CONST-H180401   TO  SPA-W01-STYUKYMD
                   MOVE    WRK-EDYUKYMD    TO  SPA-W01-EDYUKYMD
                   PERFORM 3101-SPASET-SEC
                   PERFORM 4811-HOSP-NYUINKHN-EDIT-SEC
      *
                   PERFORM 800-MCNDATE-SEC
                   MOVE    SMCNDATE-YMD    TO  SYS-5000-CREYMD
                                               SYS-5000-UPYMD
                   MOVE    SMCNDATE-HMS    TO  SYS-5000-UPHMS
      *
                   MOVE    SYS-5000-REC    TO  SYSKANRI-REC
                   MOVE    SYSKANRI-REC    TO  MCPDATA-REC
                   MOVE    "tbl_syskanri"  TO  MCP-TABLE
                   MOVE    "key"           TO  MCP-PATHNAME
                   PERFORM 910-DBINSERT-SEC
                   IF    ( MCP-RC  NOT =   ZERO )
                       DISPLAY "4:DBINSERT ERR"
                   END-IF
      *
                   MOVE    CONST-H180401   TO  SPA-W01-STYUKYMD
                   MOVE    WRK-EDYUKYMD    TO  SPA-W01-EDYUKYMD
      *
                   MOVE    SPA-W01-STYUKYMD    TO  WRK-YMD
                   PERFORM 800-SEIWA-HEN-SEC
                   MOVE    WRK-HENYMDG TO  SPA-W01-STYUKYMDH
      *
                   MOVE    SPA-W01-EDYUKYMD    TO  WRK-YMD
                   PERFORM 800-SEIWA-HEN-SEC
                   MOVE    WRK-HENYMDG TO  SPA-W01-EDYUKYMDH
      *
               END-IF
           END-IF
      *
           .
      *
       800-H1804-KAISEI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¸¡º÷½èÍý(KEY2)
      *****************************************************************
       900-SYSKANRI-KEY2-SEL-SEC       SECTION.
      *
           MOVE    ZERO            TO  FLG-SYSKANRI
      *
           MOVE    SPA-HOSPNUM     TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
           MOVE    "tbl_syskanri"  TO  MCP-TABLE
           MOVE    "key2"          TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF    ( MCP-RC          =   ZERO )
               MOVE    MCPDATA-REC TO  SYSKANRI-REC
           ELSE
               MOVE    1           TO  FLG-SYSKANRI
               INITIALIZE              SYSKANRI-REC
           END-IF
      *
           .
       900-SYSKANRI-KEY2-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍýFETCH½èÍý(KEY2)
      *****************************************************************
       900-SYSKANRI-KEY2-FET-SEC       SECTION.
      *
           MOVE    ZERO            TO  FLG-SYSKANRI
      *
           MOVE    "tbl_syskanri"  TO  MCP-TABLE
           MOVE    "key2"          TO  MCP-PATHNAME
           PERFORM 910-DBFETCH-SEC
           IF    ( MCP-RC          =   ZERO )
               MOVE    MCPDATA-REC TO  SYSKANRI-REC
           ELSE
               MOVE    1           TO  FLG-SYSKANRI
               INITIALIZE              SYSKANRI-REC
           END-IF
      *
           .
       900-SYSKANRI-KEY2-FET-EXT.
           EXIT.
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¸¡º÷½èÍý(KEY10)
      *****************************************************************
       900-SYSKANRI-KEY10-SEL-SEC              SECTION.
      *
           MOVE    ZERO                TO  FLG-SYSKANRI
      *
           MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF    ( MCP-RC              =   ZERO )
               MOVE    MCPDATA-REC     TO  SYSKANRI-REC
           ELSE
               INITIALIZE                  SYSKANRI-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBCLOSECURSOR-SEC
      *
           .
       900-SYSKANRI-KEY10-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¸¡º÷½èÍý(KEY16)
      *****************************************************************
       900-SYSKANRI-KEY16-SEL-SEC       SECTION.
      *
           MOVE    ZERO                TO  FLG-SYSKANRI
      *
           MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key16"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF    ( MCP-RC              =   ZERO )
               MOVE    MCPDATA-REC     TO  SYSKANRI-REC
           ELSE
               INITIALIZE                  SYSKANRI-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key16"             TO  MCP-PATHNAME
           PERFORM 910-DBCLOSECURSOR-SEC
      *
           .
       900-SYSKANRI-KEY16-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¸¡º÷½èÍý
      *****************************************************************
       900-TENSU-KEY-SEL-SEC           SECTION.
      *
           MOVE    ZERO                TO  FLG-TENSU
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¸¡º÷
           INITIALIZE  TNS-TENSU-REC
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    WRK-SRYCD           TO  TNS-SRYCD
           MOVE    SPA-W01-EDYUKYMD    TO  TNS-YUKOSTYMD
                                           TNS-YUKOEDYMD
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF    ( MCP-RC      =   ZERO )
               MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
           ELSE
               MOVE    1               TO  FLG-TENSU
               INITIALIZE                  TNS-TENSU-REC
           END-IF
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¥¯¥í¡¼¥º
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBCLOSECURSOR-SEC
      *
           .
       900-TENSU-KEY-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
      *****************************************************************
       910-DBSELECT-SEC          SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
           CALL    "ORCDBMAIN"      USING      MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF        ( MCP-RC          =   ZERO )
               PERFORM 910-DBFETCH-SEC
           END-IF
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ëÆÉ¹þ½èÍý
      *****************************************************************
       910-DBFETCH-SEC            SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
           CALL    "ORCDBMAIN"      USING      MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBFETCH-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       910-DBCLOSECURSOR-SEC           SECTION.
      *
           MOVE    "DBCLOSECURSOR" TO  MCP-FUNC
           CALL    "ORCDBMAIN"      USING      MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBCLOSECURSOR-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÄÉ²Ã½èÍý
      *****************************************************************
       910-DBINSERT-SEC                SECTION.
      *
           MOVE    "DBINSERT"      TO  MCP-FUNC
           CALL    "ORCDBMAIN"      USING      MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBINSERT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£Â¹¹¿·½èÍý
      *****************************************************************
       910-DBUPDATE-SEC                SECTION.
      *
           MOVE    "DBUPDATE"      TO  MCP-FUNC
           CALL    "ORCDBMAIN"      USING      MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBUPDATE-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£Âºï½ü½èÍý
      *****************************************************************
       910-DBDELETE-SEC                SECTION.
      *
           MOVE    "DBDELETE"      TO  MCP-FUNC
           CALL    "ORCDBMAIN"      USING      MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBDELETE-EXT.
           EXIT.
      *****************************************************************
      *    £Ð£Õ£Ô¡¡½èÍý
      *****************************************************************
       900-PUT-WINDOW                  SECTION.
      *
           MOVE   LOW-VALUE         TO  MCP-TABLE
                                        MCP-PATHNAME
           MOVE   "PUTWINDOW"       TO  MCP-FUNC
           CALL    "ORCDBMAIN"      USING      MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       900-PUT-WINDOW-EXT.
           EXIT.
      *
      *
