      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCGW201.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ¥·¥¹¥Æ¥à´ÉÍý¾ðÊóÀßÄê
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : Æþ±¡ÎÁ²Ã»»ÀßÄêÅÐÏ¿
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  06/03/08    NACL¡Ý¾®Æ¦Âô  ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *****************************************************************
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
       DATA                        DIVISION.
       FILE                        SECTION.
      *
      *
       WORKING-STORAGE             SECTION.
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¾ðÊóÀßÄêÍÑ¶¦ÄÌ¥Ñ¥é¥á¥¿
           COPY    "W01COMMON-SPA".
      *
      *    ²èÌÌÍÑ£Ó£Ð£Á
           COPY    "W20SCR-SPA".
      *    ²èÌÌÍÑ£Ó£Ð£Á
           COPY    "W25SCR-SPA".
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-END             PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
           03  FLG-TENSU           PIC 9(01).
      *
           03  FLG-CHK             PIC 9(01).
           03  FLG-SELNUM          PIC 9(01).
           03  FLG-KENSAKU         PIC 9(01).
           03  FLG-KANJI           PIC 9(01).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX                 PIC 9(04).
           03  IDX2                PIC 9(04).
           03  IDXK                PIC 9(04).
           03  IDY                 PIC 9(04).
      *
      *    ¥³¥ó¥¹¥¿¥ó¥ÈÃÍ
       01  CONSTANT-AREA.
      *
           03 CONS-KSN-VAL.
      *      ¥·¥¹¥Æ¥à´ÉÍý¡Ê°åÎÅµ¡´Ø¾ðÊó¡ËÀßÄê²Ã»»
      *        Áí¹çÆþ±¡ÂÎÀ©²Ã»»
               05  CONS-KSN1           PIC X(11) VALUE "0 190098870".
      *        ÃÏ°è°åÎÅ»Ù±çÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»
               05  CONS-KSN2           PIC X(11) VALUE "0 190099870".
      *        ¿ÇÎÅÏ¿´ÉÍýÂÎÀ©²Ã»»
               05  CONS-KSN3           PIC X(11) VALUE "0 190100370".
      *        ÆýÍÄ»ù²Ã»»¡ÊÉÂ±¡¡Ë
               05  CONS-KSN4           PIC X(11) VALUE "0 190100470".
      *        ÆýÍÄ»ù²Ã»»¡ÊÉÂ±¡¡Ë¡ÊÆÃÊÌÆþ±¡´ðËÜÎÁÅù¡Ë
               05  CONS-KSN5           PIC X(11) VALUE "0 190100570".
      *        ÆýÍÄ»ù²Ã»»¡Ê¿ÇÎÅ½ê¡Ë
               05  CONS-KSN6           PIC X(11) VALUE "0 190100670".
      *        ÍÄ»ù²Ã»»¡ÊÉÂ±¡¡Ë
               05  CONS-KSN7           PIC X(11) VALUE "0 190100770".
      *        ÍÄ»ù²Ã»»¡ÊÉÂ±¡¡Ë¡ÊÆÃÊÌÆþ±¡´ðËÜÎÁÅù¡Ë
               05  CONS-KSN8           PIC X(11) VALUE "0 190100870".
      *        ÍÄ»ù²Ã»»¡Ê¿ÇÎÅ½ê¡Ë
               05  CONS-KSN9           PIC X(11) VALUE "0 190100970".
      *        Àº¿ÀÉÂÅïÆþ±¡»þ°å³Ø´ÉÍý²Ã»»
               05  CONS-KSN10          PIC X(11) VALUE "0 190107170".
      *        ´ð´´·¿Î×¾²¸¦½¤ÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»
               05  CONS-KSN11          PIC X(11) VALUE "0 190117170".
      *        ¶¨ÎÏ·¿Î×¾²¸¦½¤ÉÂ±¡Æþ±¡¿ÇÎÅ²Ã»»
               05  CONS-KSN12          PIC X(11) VALUE "0 190119910".
      *        Î¥Åç²Ã»»
               05  CONS-KSN13          PIC X(11) VALUE "0 190117270".
      *        °åÎÅ°ÂÁ´ÂÐºö²Ã»»£±
               05  CONS-KSN14          PIC X(11) VALUE "0 190120510".
      *        °åÎÅ°ÂÁ´ÂÐºö²Ã»»£²
               05  CONS-KSN15          PIC X(11) VALUE "0 190136910".
      *        ´¶À÷ËÉ»ßÂÐºö²Ã»»
               05  CONS-KSN16          PIC X(11) VALUE "0 190137070".
      *        ±ÉÍÜ´ÉÍý¼Â»Ü²Ã»»
               05  CONS-KSN17          PIC X(11) VALUE "0 190120410".
      *        ¸åÈ¯°åÌôÉÊ»ÈÍÑÂÎÀ©²Ã»»
               05  CONS-KSN18          PIC X(11) VALUE "0 190138010".
      *        £±µéÃÏÃÏ°è²Ã»»
               05  CONS-KSN19          PIC X(11) VALUE "0 190077070".
      *        £²µéÃÏÃÏ°è²Ã»»
               05  CONS-KSN20          PIC X(11) VALUE "0 190077170".
      *        £³µéÃÏÃÏ°è²Ã»»
               05  CONS-KSN21          PIC X(11) VALUE "0 190120010".
      *        £´µéÃÏÃÏ°è²Ã»»
               05  CONS-KSN22          PIC X(11) VALUE "0 190077270".
      *        £µµéÃÏÃÏ°è²Ã»»
               05  CONS-KSN23          PIC X(11) VALUE "0 190120110".
      *        £¶µéÃÏÃÏ°è²Ã»»
               05  CONS-KSN24          PIC X(11) VALUE "0 190077370".
      *
      *      ÉÂ±¡¤Î¥·¥¹¥Æ¥à´ÉÍý¡ÊÉÂÅï´ÉÍý¡ËÀßÄê²Ã»»
      *        ´Ç¸îÊä½õ²Ã»»£±
               05  CONS-KSN25          PIC X(11) VALUE "1 190103770".
      *        ´Ç¸îÊä½õ²Ã»»£±¡Ê£±£³ÂÐ£±Æþ±¡´ðËÜÎÁ¡Ë
               05  CONS-KSN26          PIC X(11) VALUE "1 190103870".
      *        ´Ç¸îÊä½õ²Ã»»£²
               05  CONS-KSN27          PIC X(11) VALUE "1 190103970".
      *        ´Ç¸îÊä½õ²Ã»»£³
               05  CONS-KSN28          PIC X(11) VALUE "1 190104070".
      *        ¥×¥ì¥¤¥ë¡¼¥à¡¢ÊÝ°é»ÎÅù²Ã»»
               05  CONS-KSN29          PIC X(11) VALUE "1 190111370".
      *        ÆñÉÂ´µ¼ÔÅùÆþ±¡¿ÇÎÅ²Ã»»
               05  CONS-KSN30          PIC X(11) VALUE "1 190101770".
      *        ÆÃ¼ì¼À´µÆþ±¡»ÜÀß´ÉÍý²Ã»»
               05  CONS-KSN31          PIC X(11) VALUE "1 190101970".
      *        »ùÆ¸¡¦»×½Õ´üÀº¿À²ÊÆþ±¡°åÎÅ´ÉÍý²Ã»»
               05  CONS-KSN32          PIC X(11) VALUE "1 190110170".
      *        Àº¿À²Ê±þµÞÆþ±¡»ÜÀß´ÉÍý²Ã»»
               05  CONS-KSN33          PIC X(11) VALUE "1 190106970".
      *        ´Ç¸îÇÛÃÖ²Ã»»
               05  CONS-KSN34          PIC X(11) VALUE "1 190102070".
      *        £±£µÂÐ£±Êä½õÂÎÀ©²Ã»»
               05  CONS-KSN35          PIC X(11) VALUE "1 190135710".
      *        £²£°ÂÐ£±Êä½õÂÎÀ©²Ã»»
               05  CONS-KSN36          PIC X(11) VALUE "1 190135810".
      *        £²£µÂÐ£±Êä½õÂÎÀ©²Ã»»
               05  CONS-KSN37          PIC X(11) VALUE "1 190127110".
      *        £µ£°ÂÐ£±Êä½õÂÎÀ©²Ã»»
               05  CONS-KSN38          PIC X(11) VALUE "1 190127210".
      *        £·£µÂÐ£±Êä½õÂÎÀ©²Ã»»
               05  CONS-KSN39          PIC X(11) VALUE "1 190127310".
      *        £±£°£°ÂÐ£±Êä½õÂÎÀ©²Ã»»
               05  CONS-KSN40          PIC X(11) VALUE "1 190127410".
      *        ½Å¾É´µ¼Ô²óÉüÉÂÅï²Ã»»
               05  CONS-KSN41          PIC X(11) VALUE "1 190129870".
      *        µÞÀ­´ü´Ç¸îÊä½õÂÎÀ©²Ã»»£±
               05  CONS-KSN42          PIC X(11) VALUE "1 190135910".
      *        µÞÀ­´ü´Ç¸îÊä½õÂÎÀ©²Ã»»£²
               05  CONS-KSN43          PIC X(11) VALUE "1 190136010".
      *        Àº¿À²ÊÃÏ°è°Ü¹Ô¼Â»Ü²Ã»»
               05  CONS-KSN44          PIC X(11) VALUE "1 190127810".
      *        °ìÈÌÉÂÅï´Ç¸îÉ¬Í×ÅÙÉ¾²Á²Ã»»
               05  CONS-KSN45          PIC X(11) VALUE "1 190131570".
      *        °ìÈÌÉÂÅï´Ç¸îÉ¬Í×ÅÙÉ¾²Á²Ã»»¡ÊÀìÌçÉÂ±¡¡Ë
               05  CONS-KSN46          PIC X(11) VALUE "1 190134970".
      *        °ìÈÌÉÂÅï´Ç¸îÉ¬Í×ÅÙÉ¾²Á²Ã»»¡ÊÆÃÄêµ¡Ç½ÉÂ±¡¡Ë
               05  CONS-KSN47          PIC X(11) VALUE "1 190134870".
      *        µÙÆü¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥óÄó¶¡ÂÎÀ©²Ã»»
               05  CONS-KSN48          PIC X(11) VALUE "1 190140870".
      *
      *      ÉÂ±¡¤Î¥·¥¹¥Æ¥à´ÉÍý¡ÊÉÂ¼¼´ÉÍý¡ËÀßÄê²Ã»»
      *        Êü¼ÍÀþ¼£ÎÅÉÂ¼¼´ÉÍý²Ã»»
               05  CONS-KSN49          PIC X(11) VALUE "2 190106670".
      *        ÎÅÍÜ´Ä¶­²Ã»»
               05  CONS-KSN50          PIC X(11) VALUE "2 190105570".
      *        ÎÅÍÜÉÂÅïÎÅÍÜ´Ä¶­²Ã»»£±
               05  CONS-KSN51          PIC X(11) VALUE "2 190120210".
      *        ÎÅÍÜÉÂÅïÎÅÍÜ´Ä¶­²Ã»»£²
               05  CONS-KSN52          PIC X(11) VALUE "2 190106070".
      *        ÎÅÍÜÉÂÅïÎÅÍÜ´Ä¶­²Ã»»£³
               05  CONS-KSN53          PIC X(11) VALUE "2 190106170".
      *        ÎÅÍÜÉÂÅïÎÅÍÜ´Ä¶­²Ã»»£´
               05  CONS-KSN54          PIC X(11) VALUE "2 190106270".
      *        ½Å¾É¼ÔÅùÎÅÍÜ´Ä¶­ÆÃÊÌ²Ã»»¡Ê¸Ä¼¼¡Ë
               05  CONS-KSN55          PIC X(11) VALUE "2 190105870".
      *        ½Å¾É¼ÔÅùÎÅÍÜ´Ä¶­ÆÃÊÌ²Ã»»¡Ê£²¿ÍÉô²°¡Ë
               05  CONS-KSN56          PIC X(11) VALUE "2 190105970".
      *        Ìµ¶Ý¼£ÎÅ¼¼´ÉÍý²Ã»»
               05  CONS-KSN57          PIC X(11) VALUE "2 190106570".
      *
      *      ¿ÇÎÅ½ê¤Î¥·¥¹¥Æ¥à´ÉÍý¡ÊÉÂÅï´ÉÍý¡ËÀßÄê²Ã»»
      *        ÆñÉÂ´µ¼ÔÅùÆþ±¡¿ÇÎÅ²Ã»»
               05  CONS-KSN58          PIC X(11) VALUE "1 190101770".
      *        ÆÃ¼ì¼À´µÆþ±¡»ÜÀß´ÉÍý²Ã»»
               05  CONS-KSN59          PIC X(11) VALUE "1 190101970".
      *        °å»ÕÇÛÃÖ²Ã»»£±
               05  CONS-KSN60          PIC X(11) VALUE "1 190135570".
      *        °å»ÕÇÛÃÖ²Ã»»£²
               05  CONS-KSN61          PIC X(11) VALUE "1 190117070".
      *        Ìë´Ö¶ÛµÞÂÎÀ©³ÎÊÝ²Ã»»
               05  CONS-KSN62          PIC X(11) VALUE "1 190126470".
      *        ´Ç¸îÇÛÃÖ²Ã»»£±
               05  CONS-KSN63          PIC X(11) VALUE "1 190109670".
      *        ´Ç¸îÇÛÃÖ²Ã»»£²
               05  CONS-KSN64          PIC X(11) VALUE "1 190126570".
      *        Ìë´Ö´Ç¸îÇÛÃÖ²Ã»»£±
               05  CONS-KSN65          PIC X(11) VALUE "1 190126770".
      *        Ìë´Ö´Ç¸îÇÛÃÖ²Ã»»£²
               05  CONS-KSN66          PIC X(11) VALUE "1 190126670".
      *
      *      ¿ÇÎÅ½ê¤Î¥·¥¹¥Æ¥à´ÉÍý¡ÊÉÂ¼¼´ÉÍý¡ËÀßÄê²Ã»»
      *        ¿ÇÎÅ½êÎÅÍÜÉÂ¾²ÎÅÍÜ´Ä¶­²Ã»»£±
               05  CONS-KSN67          PIC X(11) VALUE "2 190106370".
      *        ¿ÇÎÅ½êÎÅÍÜÉÂ¾²ÎÅÍÜ´Ä¶­²Ã»»£²
               05  CONS-KSN68          PIC X(11) VALUE "2 190106470".
      *        Êü¼ÍÀþ¼£ÎÅÉÂ¼¼´ÉÍý²Ã»»
               05  CONS-KSN69          PIC X(11) VALUE "2 190106670".
      *        Ìµ¶Ý¼£ÎÅ¼¼´ÉÍý²Ã»»
               05  CONS-KSN70          PIC X(11) VALUE "2 190106570".
      *
      *      ÆþÂà±¡ÅÐÏ¿»þ¤Ë»»Äê¤¹¤ë²Ã»»
      *        êóáì´µ¼Ô´ÉÍý²Ã»»
               05  CONS-KSN71          PIC X(11) VALUE "3 190116990".
      *        Í­¾²¿ÇÎÅ½ê°ìÈÌÉÂ¾²½é´ü²Ã»»
               05  CONS-KSN72          PIC X(11) VALUE "3 190135470".
      *        µßµÞ¡¦ºßÂðÅù»Ù±çÎÅÍÜÉÂ¾²½é´ü²Ã»»¡Ê¿ÇÎÅ½ê¡Ë
               05  CONS-KSN73          PIC X(11) VALUE "3 190135670".
      *        µßµÞ¡¦ºßÂðÅù»Ù±çÎÅÍÜÉÂ¾²½é´ü²Ã»»¡ÊÉÂ±¡¡Ë
               05  CONS-KSN74          PIC X(11) VALUE "3 190134270".
           03  CONS-KSN-R  REDEFINES CONS-KSN-VAL.
               05  CONS-KSN-OCC            OCCURS    74.
                   07  CONS-KSN-KBN        PIC X(01).
                   07  CONS-KSN-FIL        PIC X(01).
                   07  CONS-KSN-CD         PIC X(09).
           03  CONS-KSN-MAX                PIC 9(05)   VALUE 74.
        
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-WIDGET              PIC X(64).
           03  WRK-WIDMSG              PIC X(70).
      *
           03  WRK-SELNUM              PIC 9(03).
           03  WRK-KBNCD               PIC 9(08).
           03  WRK-ZZ9                 PIC ZZ9.
           03  WRK-CD-MCNT             PIC 9(02).
           03  WRK-INPUTCD             PIC X(09).
      *
      *    ¥³¥é¥à¥ê¥¹¥È°ÌÃÖ
           03  WRK-W201-ROW            PIC S9(09).
           03  FLG-GMN-INIT            PIC  9(01).
      *
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿
           COPY  "CPSYSKANRI.INC".
      *    ÉÂÅï´ÉÍý
           COPY  "CPSK5001.INC".
      *    ÅÀ¿ô¥Þ¥¹¥¿
           COPY  "CPTENSU.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    ¿ô»úÊÑ´¹ÎÎ°è
           COPY    "CPORCSNUM.INC".
      *    ¥Þ¥·¥óÆüÉÕ¼èÆÀ¥µ¥Ö
           COPY    "CPORCSMCNDATE.INC".
      *
      *    Á´³Ñ¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿
           COPY    "CPORCSKANACHK.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
        LINKAGE                     SECTION.
      *
           COPY    "MCPAREA".
           COPY    "ORCA-SPA".
      *
           COPY    "LINKAREA".
      *
       01  SCRAREA.
           COPY    "W01.INC".
           COPY    "W02.INC".
           COPY    "W03.INC".
           COPY    "W04.INC".
           COPY    "W05.INC".
           COPY    "W06.INC".
           COPY    "W07.INC". 
           COPY    "W08.INC". 
           COPY    "W09.INC".
           COPY    "W10.INC".
           COPY    "W11.INC".
           COPY    "W111.INC".
           COPY    "W12.INC".
           COPY    "W121.INC".
           COPY    "W13.INC".
           COPY    "W14.INC".
           COPY    "W15.INC".
           COPY    "W16.INC".
           COPY    "W17.INC".
           COPY    "W18.INC".
           COPY    "W19.INC".
           COPY    "W20.INC".
           COPY    "W201.INC".
           COPY    "W21.INC".
           COPY    "W22.INC".
           COPY    "W23.INC".
           COPY    "W24.INC".
           COPY    "W25.INC".
           COPY    "W28.INC".
           COPY    "W29.INC".
           COPY    "W30.INC".
           COPY    "W31.INC".
           COPY    "W32.INC".
           COPY    "W321.INC".
           COPY    "W33.INC".
           COPY    "W34.INC".
           COPY    "W35.INC".
           COPY    "W60.INC".
           COPY    "W61.INC".
           COPY    "W62.INC".
           COPY    "W63.INC".
           COPY    "W64.INC".
           COPY    "W65.INC".
           COPY    "W66.INC".
           COPY    "W67.INC".
           COPY    "W96.INC".
           COPY    "W98.INC".
           COPY    "W981.INC".
           COPY    "W97.INC".
           COPY    "W99.INC".
           COPY    "WERR.INC".
           COPY    "WID1.INC".
           COPY    "WID2.INC".
      *
       PROCEDURE                   DIVISION    USING
           MCPAREA
           SPAAREA
           LINKAREA
           SCRAREA.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  IDX-AREA
           INITIALIZE                  WRK-AREA
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-WORK        TO  SPA-W01KYOUTU
           MOVE    SPA-FREE        TO  SPA-W20FREE
      *
           MOVE    SPACE           TO  SPA-ERRCD
           MOVE    ZERO            TO  FLG-END
      *
           EVALUATE    MCP-STATUS      ALSO    MCP-EVENT
               WHEN    "LINK"          ALSO    ANY
                   PERFORM 100-INIT-SEC
      *    ²èÌÌÁ«°Ü
               WHEN     "PUTG"           ALSO   "CLICKED"
                   PERFORM 200-GMNSENI
      *    ÆþÎÏ
               WHEN      OTHER
                   PERFORM 200-ENTRY
           END-EVALUATE.
      *
      *    ²èÌÌÁ«°Ü¤¬¤Ê¤¤»þ¡¢²èÌÌÉ½¼¨¤Ø
           IF      FLG-END             =   ZERO
               PERFORM 500-SET-SCREEN
           END-IF
      *
           MOVE    SPA-W20FREE     TO  SPA-FREE
           MOVE    SPA-W01KYOUTU   TO  SPA-WORK
           MOVE    SPA-AREA        TO  SPA-COMMON
      *
           .
           EXIT    PROGRAM
           .
      *
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
      *    ¥¨¥é¡¼²èÌÌ¤è¤ê
           IF      SPA-MOTOPG          =   "WERR"
               MOVE    SPACE               TO  SPA-MOTOPG
               PERFORM 5001-MAPCUR-SEC
           ELSE
      *
      *        ½é´ü²èÌÌÊÔ½¸
               PERFORM 300-SCREEN-SEC
      *
      *        ²èÌÌÊÔ½¸
               PERFORM 500-GMNHEN-SEC
           END-IF
      *
           IF      FLG-END             =   ZERO
               MOVE    SPACE               TO  LINKAREA
               MOVE   "NEW"                TO  MCP-PUTTYPE
               MOVE   "W201"               TO  MCP-WINDOW
               PERFORM 900-PUT-WINDOW
               MOVE    1                   TO  FLG-END
           END-IF
           .
      *
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é´ü²èÌÌ½èÍý
      *****************************************************************
       300-SCREEN-SEC              SECTION.
      *
      *    Â¾¤Î£Ì£Ä¤è¤ê
           IF      LINKAREA        NOT =   SPACE
               MOVE    LNK-KYOUTU          TO  SPA-KYOUTU
           END-IF
      *
           EVALUATE    SPA-MOTOPG
           EVALUATE    SPA-MOTOPG
           WHEN    "W25"
                   PERFORM 320-W25SPASET-SEC
               WHEN    "WID1"
                   PERFORM 330-WID1-SET-SEC
               WHEN    OTHER
                       PERFORM 310-SPASET-SEC
           END-EVALUATE
      *
           .
       300-SCREEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¥»¥Ã¥È½èÍý
      *****************************************************************
       320-W25SPASET-SEC           SECTION.
      *
           IF    ( SPA-W25-SRYCD   NOT =   SPACE )
               MOVE    SPA-W25-SRYCD   TO  SPA-W201-KSNCD2
               PERFORM 22022-KSNCD2-CHK-SEC
           END-IF 
           .
       320-W25SPASET-EXT.
           EXIT.
      *****************************************************************
      *    ³ÎÇ§²èÌÌ¡Ê£Ã£É£Ä£±¡Ë£Ï£Ë½èÍý
      *****************************************************************
       330-WID1-SET-SEC            SECTION.
      *
           EVALUATE    SPA-WIDCD
               WHEN    "1001"
      *            ¹¹¿·
                   IF      SPA-WID1-FLG    =   "OK"
                       PERFORM 2201-TOUROKU-SYORI-SEC
                   ELSE
                       MOVE    1           TO  SPA-W201-CUR
                   END-IF
               WHEN    "1003"
      *            ºï½ü
                   IF      SPA-WID1-FLG    =   "OK"
                       PERFORM 2301-DELETE-SYORI-SEC
                   ELSE
                       MOVE    1           TO  SPA-W201-CUR
                   END-IF
           END-EVALUATE
           MOVE    SPACE           TO  SPA-WID1-FLG
           MOVE    SPACE           TO  SPA-WIDCD
      *
           .
       330-WID1-SET-EXT.
           EXIT.
      *****************************************************************
      *    ²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       310-SPASET-SEC                  SECTION.
      *
           INITIALIZE                  SPA-W201-AREA
      *
           MOVE    1                   TO  FLG-GMN-INIT
      *
           INITIALIZE                  SPA-W201-LIST-G
      *
      *    ¥¢¥Ã¥×¥Ç¡¼¥ÈÂÐ¾Ý¤Î¥Ç¡¼¥¿¤òÆÉ¤ßÄ¾¤¹
           INITIALIZE                  SYSKANRI-REC
      *
           MOVE   "5001"               TO  SYS-KANRICD
           MOVE   SPA-GMN-W20-BTUNUM   TO  SYS-KBNCD
           MOVE   SPA-NAI-W20-YUKOSTYMD-OLD
                                       TO  SYS-STYUKYMD
                                           SYS-EDYUKYMD
           PERFORM 900-SYSKANRI-KEY10-SEL-SEC
           IF   ( FLG-SYSKANRI    NOT =   ZERO )
               MOVE    "9000"          TO  SPA-ERRCD
               GO  TO  310-SPASET-EXT
           END-IF
      *
           MOVE    SYSKANRI-REC        TO  SYS-5001-REC
      *
           MOVE    ZERO                TO  IDX
           PERFORM UNTIL  (IDX             >=  10)
               ADD     1                   TO  IDX
               IF      SYS-5001-KSNCD2 (IDX)  NOT =   SPACE
                   MOVE    IDX             TO  SPA-W201-LIST-MAX
                   MOVE    IDX             TO  SPA-W201-TRENNUM (IDX)
                   MOVE    SYS-5001-KSNCD2 (IDX)
                                           TO  SPA-W201-TKSNCD2 (IDX)
                   INITIALIZE                  TNS-TENSU-REC
                   MOVE    SPA-HOSPNUM     TO  TNS-HOSPNUM
                   MOVE    SYS-5001-KSNCD2 (IDX)
                                           TO  TNS-SRYCD
                   MOVE    SPA-NAI-W20-YUKOSTYMD
                                           TO  TNS-YUKOSTYMD
                   MOVE    SPA-NAI-W20-YUKOSTYMD
                                           TO  TNS-YUKOEDYMD
                   MOVE    TNS-TENSU-REC   TO  MCPDATA-REC
                   MOVE    "tbl_tensu"     TO  MCP-TABLE
                   MOVE    "key"           TO  MCP-PATHNAME
                   PERFORM 910-DBSELECT-SEC
                   IF      MCP-RC          =   ZERO
                       MOVE    "tbl_tensu" TO  MCP-TABLE
                       MOVE    "key"       TO  MCP-PATHNAME
                       PERFORM 900-TENSU-READ-SEC
                       IF    FLG-TENSU     =   ZERO
                           MOVE   MCPDATA-REC
                                           TO  TNS-TENSU-REC
                           MOVE   TNS-NAME TO  SPA-W201-TKSNNM2(IDX)
                       ELSE
                           MOVE   SPACE    TO  SPA-W201-TKSNNM2(IDX)
                       END-IF
                   ELSE
                       MOVE    1               TO  FLG-TENSU
                   END-IF
                   MOVE    "tbl_tensu"         TO  MCP-TABLE
                   MOVE    "key"               TO  MCP-PATHNAME
                   PERFORM 990-DBCLOSE-SEC
      *
               ELSE
                   MOVE    11             TO  IDX
               END-IF
           END-PERFORM
      *
           IF      SPA-W201-LIST-MAX   =   ZERO
               MOVE    2                   TO  SPA-W201-CUR
           ELSE
               MOVE    1                   TO  SPA-W201-CUR
           END-IF
           .
       310-SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-GMNHEN-SEC                  SECTION.
      *
      *    ¥³¥é¥à¥ê¥¹¥È°ÌÃÖÊÝÂ¸
           IF      FLG-GMN-INIT        =   1
               MOVE    ZERO                TO  WRK-W201-ROW
           ELSE
               MOVE    W201-MEILIST-ROW    TO  WRK-W201-ROW
           END-IF
      *
           MOVE    SPACE               TO  W201
      *    ¥³¥é¥à¥ê¥¹¥È¤Î°ÌÃÖ»ØÄê
           MOVE    ZERO                TO  W201-MEILIST-ROW
           IF      WRK-W201-ROW    NOT =   ZERO
               MOVE    WRK-W201-ROW    TO  W201-MEILIST-ROW 
           END-IF
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-W201-LIST-MAX
               MOVE    SPA-W201-TRENNUM (IDX)  TO  WRK-ZZ9
               MOVE    WRK-ZZ9             TO  W201-TRENNUM (IDX)
               MOVE    SPA-W201-TKSNCD2(IDX)
                                           TO  W201-TKSNCD2 (IDX)
               INITIALIZE                      TNS-TENSU-REC
               MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
               MOVE    SPA-W201-TKSNCD2(IDX)
                                           TO  TNS-SRYCD
               MOVE    SPA-NAI-W20-YUKOSTYMD
                                           TO  TNS-YUKOSTYMD
               MOVE    SPA-NAI-W20-YUKOSTYMD
                                           TO  TNS-YUKOEDYMD
               MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 910-DBSELECT-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    "tbl_tensu"     TO  MCP-TABLE
                   MOVE    "key"           TO  MCP-PATHNAME
                   PERFORM 900-TENSU-READ-SEC
                   IF    FLG-TENSU         =   ZERO
                       MOVE   MCPDATA-REC  TO  TNS-TENSU-REC
                           MOVE   TNS-NAME TO  SPA-W201-TKSNNM2(IDX)
                                               W201-TKSNNM2 (IDX)
                   ELSE
                       MOVE   SPACE        TO  SPA-W201-TKSNNM2(IDX)
                                               W201-TKSNNM2 (IDX)
                   END-IF
               ELSE
                   MOVE    1               TO  FLG-TENSU
               END-IF
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 990-DBCLOSE-SEC
               IF      SPA-W201-SELNUM     =   SPA-W201-TRENNUM (IDX)
                   MOVE    "T"             TO  W201-MEILIST-SELECT
                                                               (IDX)
                   MOVE    IDX             TO  W201-MEILIST-ROW
                   MOVE    2               TO  W201-MEILIST-ROWATTR
               ELSE
                   MOVE    "F"             TO  W201-MEILIST-SELECT
                                                               (IDX)
               END-IF
           END-PERFORM
           MOVE    SPA-W201-LIST-MAX    TO  W201-MEILIST-COUNT
      *
           MOVE    SPA-W201-SELNUM      TO  W201-SELNUM
           MOVE    SPA-W201-KSNCD2      TO  W201-KSNCD2
           MOVE    SPA-W201-KSNNM2      TO  W201-KSNNM2
      *
           PERFORM 5001-MAPCUR-SEC
           .
       500-GMNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ¥«¡¼¥½¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       5001-MAPCUR-SEC             SECTION.
      *
           IF      SPA-W201-CUR        =   ZERO
               EVALUATE    WRK-WIDGET
                   WHEN    "SELNUM"
                       MOVE    2                   TO  SPA-W201-CUR
                   WHEN    "KSNCD2"
                       MOVE    99                  TO  SPA-W201-CUR
               END-EVALUATE
           END-IF
      *
           EVALUATE    SPA-W201-CUR
               WHEN    1
                   MOVE    "SELNUM"            TO  MCP-WIDGET
               WHEN    2
                   MOVE    "KSNCD2"            TO  MCP-WIDGET
               WHEN    99
                   MOVE    "B12"               TO  MCP-WIDGET
           END-EVALUATE
      *
           .
       5001-MAPCUR-EXT.
           EXIT.
      *****************************************************************
      *    ²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       200-GMNSENI                   SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *        Ìá¤ë
               WHEN    "CLICKED"       ALSO    "B01"
                   PERFORM 210-BACK
      *        ¥¯¥ê¥¢
               WHEN    "CLICKED"       ALSO    "B02"
                   PERFORM 220-CLERA-SYORI-SEC
      *        ºï½ü
               WHEN    "CLICKED"       ALSO    "B03"
                   PERFORM 230-DELETE-SEC
      *        ÅÐÏ¿
               WHEN    "CLICKED"       ALSO    "B12"
                   PERFORM 220-TOUROKU-SEC
           END-EVALUATE
      *
           .
       200-GMNSENI-EXT.
           EXIT.
      *****************************************************************
      *    ²ñÏÃ¡¡½èÍý
      *****************************************************************
       200-ENTRY                   SECTION.
      *
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È
           PERFORM 210-GMN-INPUT-SEC
      *
           EVALUATE    WRK-WIDGET
               WHEN    "MEILIST"
                   PERFORM 2001-MEILIST-SEC
               WHEN    OTHER
      *            ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
                   PERFORM 220-INPUT-CHK-SEC
           END-EVALUATE
      *
           .
       200-ENTRY-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È½èÍý
      *****************************************************************
       210-GMN-INPUT-SEC               SECTION.
      *
           MOVE    ZERO                TO  SPA-W201-CUR
      *    ÆþÎÏ¹àÌÜ¤Î·èÄê
           MOVE    MCP-WIDGET          TO  WRK-WIDGET
      *
           .
       210-GMN-INPUT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       220-INPUT-CHK-SEC               SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¤ØÊÔ½¸
           PERFORM 2201-GMNSPA-SET-SEC
      *
           PERFORM 2002-SELNUM-SEC
      *
           IF      SPA-ERRCD           =   SPACE
               PERFORM 2202-KSNCD2-CHK-SEC
           END-IF
      *
           .
       220-INPUT-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ê¥¹¥ÈÁªÂò½èÍý
      *****************************************************************
       2001-MEILIST-SEC               SECTION.
      *
           MOVE    ZERO                TO  WRK-SELNUM
           PERFORM VARYING     IDX     FROM   1   BY  1
                   UNTIL       IDX     >   SPA-W201-LIST-MAX
              IF      W201-MEILIST-SELECT (IDX)    =  "T"
                  IF       IDX                 =   SPA-W201-SELNUM
                      CONTINUE
                  ELSE
                      MOVE    IDX              TO  WRK-SELNUM
                  END-IF
              END-IF
           END-PERFORM
      *
           IF      WRK-SELNUM      NOT =   ZERO
               MOVE    WRK-SELNUM          TO  SPA-W201-SELNUM
               MOVE    1                   TO  FLG-SELNUM
               PERFORM 2002-SELNUM-SEC
           END-IF
      *
           .
       2001-MEILIST-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÁªÂòÈÖ¹æ½èÍý
      *****************************************************************
       2002-SELNUM-SEC               SECTION.
      *
           INITIALIZE                      ORCSNUMAREA
           MOVE    SPA-W201-SELNUM     TO  SNUM-INX
           CALL    "ORCSNUM"           USING
                                       ORCSNUMAREA
           IF     (SNUM-RC         NOT =   ZERO  )   OR
                  (SNUM-MINKBN         =   "1"   )
               MOVE    "0001"              TO  SPA-ERRCD
               MOVE    1                   TO  SPA-W201-CUR
           ELSE
               MOVE    SNUM-OUTNUM         TO  SPA-W201-SELNUM
           END-IF
      *
           IF      (SPA-W201-SELNUM    >   ZERO)  AND
                   (SPA-ERRCD          =   SPACE) 
               MOVE    ZERO                TO  FLG-CHK
               PERFORM VARYING     IDX     FROM    1   BY  1
                       UNTIL      (IDX     >   SPA-W201-LIST-MAX ) OR
                                  (FLG-CHK =   1    )
                   IF      SPA-W201-TRENNUM (IDX)   =   SPA-W201-SELNUM
                       MOVE    1                   TO  FLG-CHK
                       IF      FLG-SELNUM          =   1
      *                    ÌÀºÙÊÔ½¸
                           PERFORM 20021-MEISAI-HENSYU-SEC
                       END-IF
                       MOVE    SPA-W201-SELNUM     TO
                                                   SPA-W201-MAE-SELNUM
                   END-IF
               END-PERFORM
               IF      FLG-CHK             =   ZERO
                   MOVE    "0001"          TO  SPA-ERRCD
                   MOVE    1               TO  SPA-W201-CUR
               END-IF
           END-IF
      *
           .
       2002-SELNUM-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙÊÔ½¸½èÍý
      *****************************************************************
       20021-MEISAI-HENSYU-SEC               SECTION.
      *
           MOVE    SPA-W201-TRENNUM (IDX)   TO  SPA-W201-SELNUM
           MOVE    SPA-W201-TKSNCD2 (IDX)   TO  SPA-W201-KSNCD2
           MOVE    SPA-W201-TKSNNM2 (IDX)   TO  SPA-W201-KSNNM2
      *
           .
       20021-MEISAI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ¹àÌÜ¢ª£Ó£Ð£ÁÊÔ½¸½èÍý
      *****************************************************************
       2201-GMNSPA-SET-SEC               SECTION.
      *
           IF      W201-SELNUM         =   SPA-W201-MAE-SELNUM
               MOVE    ZERO                TO  FLG-SELNUM
           ELSE
               MOVE    1                   TO  FLG-SELNUM
           END-IF
           MOVE    W201-SELNUM          TO  SPA-W201-SELNUM
           MOVE    W201-KSNCD2          TO  SPA-W201-KSNCD2
           MOVE    W201-KSNNM2          TO  SPA-W201-KSNNM2
      *
           .
       2201-GMNSPA-SET-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎÁ²Ã»»¥³¡¼¥É¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       2202-KSNCD2-CHK-SEC            SECTION.
      *
           IF    ( SPA-W201-KSNCD2     =   SPACE )
               CONTINUE
           ELSE
               MOVE    ZERO            TO  FLG-KENSAKU
               MOVE    SPACE           TO  WRK-INPUTCD
      *
      *        "/" ÆþÎÏ¤Î»þ¡¢¸¡º÷²èÌÌ¤Ø
               IF    ( SPA-W201-KSNCD2 (1 : 1)   =  "/" )
                   MOVE    1           TO  FLG-KENSAKU
               ELSE
                   PERFORM 22021-KSNCD2-CHK-SEC
               END-IF
               IF    ( SPA-ERRCD       =   SPACE )
                   IF    ( FLG-KENSAKU =   ZERO )
                       PERFORM 22022-KSNCD2-CHK-SEC
                   ELSE
                       PERFORM 409-KENSAKU-SEC
                   END-IF
               END-IF
           END-IF
      *
           .
       2202-KSNCD2-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎÁ²Ã»»¥³¡¼¥É¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       22021-KSNCD2-CHK-SEC            SECTION.
      *
           MOVE    ZERO               TO  FLG-KENSAKU
      *
           MOVE    ZERO               TO  WRK-CD-MCNT
           MOVE    ZERO               TO  FLG-KANJI
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    SPA-W201-KSNCD2     TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           MOVE    KANACHK-OUT-INPUT   TO
                                       SPA-W201-KSNCD2
           IF      KANACHK-RC      NOT =   ZERO
      *        Á´³ÑÈ¾³Ñº®ºß¥¨¥é¡¼
               MOVE    "0003"              TO  SPA-ERRCD
           ELSE
               MOVE    KANACHK-MAX         TO  WRK-CD-MCNT
      *        Á´³Ñ
               IF      KANACHK-SYUBETU     =   2
                   MOVE    1           TO  FLG-KANJI
                   MOVE    SPACE       TO  SPA-W201-KSNCD2(9:)
               ELSE
                   MOVE    ZERO        TO  FLG-KANJI
               END-IF
           END-IF
      *
           IF    ( SPA-ERRCD           =   SPACE )
      *        È¾³Ñ¤Ç£¹Ê¸»ú¤Î»þ¡¢ÅÀ¿ô¥Þ¥¹¥¿¥Á¥§¥Ã¥¯¤Ø
               IF     (WRK-CD-MCNT         =   9  )  AND
                      (FLG-KANJI           =   ZERO )  AND
                      (SPA-W201-KSNCD2 (1 : 9 )
                                       IS  NUMERIC  )
                   CONTINUE
               ELSE
                   MOVE    1          TO  FLG-KENSAKU
                   MOVE    SPA-W201-KSNCD2
                                      TO  WRK-INPUTCD
               END-IF
           END-IF
      *
           .
       22021-KSNCD2-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎÁ²Ã»»¥³¡¼¥É¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       22022-KSNCD2-CHK-SEC            SECTION.
      *
           INITIALIZE                      TNS-TENSU-REC
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    SPA-W201-KSNCD2     TO  TNS-SRYCD
           MOVE    SPA-NAI-W20-YUKOSTYMD
                                       TO  TNS-YUKOSTYMD
           MOVE    SPA-NAI-W20-YUKOSTYMD
                                       TO  TNS-YUKOEDYMD
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"     TO  MCP-TABLE
               MOVE    "key"           TO  MCP-PATHNAME
               PERFORM 900-TENSU-READ-SEC
               IF    FLG-TENSU         =   ZERO
                   MOVE   MCPDATA-REC  TO  TNS-TENSU-REC
                   MOVE   TNS-NAME     TO  SPA-W201-KSNNM2
               ELSE
                   MOVE   SPACE        TO  SPA-W201-KSNNM2
               END-IF
           ELSE
               MOVE    1               TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      FLG-TENSU           NOT =   ZERO
               MOVE    "0002"          TO  SPA-ERRCD
               MOVE    2               TO  SPA-W201-CUR
           END-IF
      *
           IF      FLG-TENSU           =   ZERO
              IF   TNS-HOSPSRYKBN      =   ZERO
                  CONTINUE
              ELSE
                  IF  (TNS-HOSPSRYKBN  =  1)   AND
                      (SPA-HOSPSBT     =  2)
                      MOVE    "0005"   TO  SPA-ERRCD
                      MOVE    2        TO  SPA-W201-CUR
                  END-IF
                  IF  (TNS-HOSPSRYKBN  =  2)   AND
                      (SPA-HOSPSBT     =  1)
                      MOVE    "0006"   TO  SPA-ERRCD
                      MOVE    2        TO  SPA-W201-CUR
                  END-IF
              END-IF
           END-IF
      *
      *        ¥·¥¹¥Æ¥à´ÉÍý¡Ê°åÎÅµ¡´Ø¾ðÊó¡Ë¤ÇÀßÄê¤¹¤ë²Ã»»
      *        ¤Ç¤Ê¤¤¤³¤È¤Î¥Á¥§¥Ã¥¯
           IF  SPA-ERRCD       =   SPACE
               PERFORM VARYING IDXK    FROM    1   BY  1
                       UNTIL ( IDXK    >   CONS-KSN-MAX )
                        OR   ( SPA-ERRCD   NOT =   SPACE )
                   IF    ( SPA-W201-KSNCD2     =   CONS-KSN-CD (IDXK))
                       MOVE    2           TO  SPA-W201-CUR
                       EVALUATE    CONS-KSN-KBN (IDXK)
                       WHEN    "0"
                           MOVE    "0007"  TO  SPA-ERRCD
                       WHEN    "1"
                           MOVE    "0008"  TO  SPA-ERRCD
                       WHEN    "2"
                           MOVE    "0009"  TO  SPA-ERRCD
                       WHEN    "3"
                           MOVE    "0013"  TO  SPA-ERRCD
                       END-EVALUATE
                   END-IF
               END-PERFORM
           END-IF
      *
           .
       22022-KSNCD2-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸¡º÷½èÍý
      *****************************************************************
       409-KENSAKU-SEC             SECTION.
      *
      *    ¶¦ÄÌ£Ó£Ð£ÁÊÔ½¸
           INITIALIZE                  SPA-W25-AREA
           MOVE    "2"                 TO  SPA-W25-TYPE
      *
           INITIALIZE                  SPA-W25GMN-AREA
           IF      WRK-INPUTCD         NOT =   SPACE
      *        ¿ÇÎÅ¹Ô°Ù¤Ç¸¡º÷¡Ê¥ª¥ê¥¸¥Ê¥ë¤Î£Ú£¹£¸¤ÏÆâÉþ¡Ë
               MOVE    "8"                 TO  SPA-W25-GMN-SYORI
      *        MOVE    "3"                 TO  SPA-W25-GMN-SYORI
               MOVE    WRK-INPUTCD         TO  SPA-W25-INPUTCD
               MOVE    "1"                 TO  SPA-W25-TYPE
               IF      FLG-KANJI           =   1
                   MOVE    "J"             TO  SPA-W25-CDSYUBETU
               ELSE
                   IF      WRK-INPUTCD(1:1)    NUMERIC
                       EVALUATE    WRK-CD-MCNT
                           WHEN    3
                           WHEN    6
                               MOVE    "6"     TO  SPA-W25-CDSYUBETU
                           WHEN    4
                               MOVE    "4"     TO  SPA-W25-CDSYUBETU
                           WHEN    5
                               MOVE    "5"     TO  SPA-W25-CDSYUBETU
                       END-EVALUATE
                   ELSE
                       MOVE    "A"             TO  SPA-W25-CDSYUBETU
                   END-IF
               END-IF
      *        ²èÌÌÊÔ½¸
               PERFORM 41011-W25-SET-SEC
      *        ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¤Ç¡¢ÂÐ¾Ý¥Ç¡¼¥¿¤Ê¤·¤Î»þ¡¢¿ÇÎÅ¹Ô°Ù¤Ç¸¡º÷¤¹¤ë
               IF     (SPA-W25-GMN-MAX     =   ZERO )  AND
                      (SPA-W25-CDSYUBETU   =   "J"  )
                   INITIALIZE                  SPA-W25GMN-AREA
                   MOVE    "8"                 TO  SPA-W25-GMN-SYORI
      *            ²èÌÌÊÔ½¸
                   PERFORM 41011-W25-SET-SEC
               END-IF
           ELSE
      *        ²èÌÌÊÔ½¸
               MOVE    "8"                 TO  SPA-W25-GMN-SYORI
               PERFORM 41011-W25-SET-SEC
           END-IF
      *
           MOVE    "W201"              TO  SPA-MOTOPG
           MOVE    "W25"               TO  SPA-SAKIPG
           MOVE    "W201"              TO  SPA-W25-MOTOPG
      *
           IF      SPA-W25-GMN-MAX     =   ZERO
               MOVE    "INPUT"             TO  MCP-WIDGET
           ELSE
               MOVE    "SELNUM1"           TO  MCP-WIDGET
           END-IF
      *
           MOVE   "NEW"                TO  MCP-PUTTYPE.
           MOVE   "W25    "            TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
      *
           .
       409-KENSAKU-EXT.
           EXIT.
      *****************************************************************
      *    ¸¡º÷²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       41011-W25-SET-SEC                           SECTION.
      *
           MOVE    SPACE               TO  SPA-MOTOPG
           MOVE    SPA-W01KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-W25-GMN-AREA    TO  SPA-W25-KYOUTU
           MOVE    SPA-W20FREE         TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGW25"           USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA.
      *
           MOVE    SPA-COMMON          TO  SPA-AREA
           MOVE    SPA-WORK            TO  SPA-W01KYOUTU
           MOVE    SPA-FREE            TO  SPA-W20FREE
           MOVE    SPA-W25-KYOUTU      TO  SPA-W25-GMN-AREA
      *
           .
       41011-W25-SET-EXT.
           EXIT.
      *****************************************************************
      *    ¥¯¥ê¥¢½èÍý
      *****************************************************************
       220-CLERA-SYORI-SEC                   SECTION.
      *
           INITIALIZE                  SPA-W201-GMN-G
           MOVE    ZERO                TO  SPA-W201-MAE-SELNUM
      *
           IF      SPA-W201-LIST-MAX   =   ZERO
               MOVE    2                   TO  SPA-W201-CUR
           ELSE
               MOVE    1                   TO  SPA-W201-CUR
           END-IF
      *
           .
       220-CLERA-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    ¥¯¥ê¥¢½èÍý
      *****************************************************************
       230-DELETE-SEC                   SECTION.
      *
           PERFORM 2002-SELNUM-SEC
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-W201-SELNUM     >   ZERO
                   MOVE    "1003"          TO  SPA-WIDCD
               ELSE
                   MOVE    "0004"          TO  SPA-ERRCD
                   MOVE    1               TO  SPA-W201-CUR
               END-IF
           END-IF
      *
           .
       230-DELETE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºï½ü½èÍý
      *****************************************************************
       2301-DELETE-SYORI-SEC                   SECTION.
      *
           IF    SPA-W201-SELNUM       NOT =   ZERO
               MOVE    SPACE           TO  SPA-W201-TKSNCD2
                                                 (SPA-W201-SELNUM)
           END-IF
      *
      *    ¥¢¥Ã¥×¥Ç¡¼¥ÈÂÐ¾Ý¤Î¥Ç¡¼¥¿¤òÆÉ¤ßÄ¾¤¹
           INITIALIZE                      SYSKANRI-REC
      *
           MOVE   "5001"               TO  SYS-KANRICD
           MOVE   SPA-GMN-W20-BTUNUM   TO  SYS-KBNCD
           MOVE   SPA-NAI-W20-YUKOSTYMD-OLD
                                       TO  SYS-STYUKYMD
                                           SYS-EDYUKYMD
           PERFORM 900-SYSKANRI-KEY10-SEL-SEC
           IF   ( FLG-SYSKANRI         NOT =   ZERO )
               MOVE    "9001"          TO  SPA-ERRCD
               GO  TO  2201-TOUROKU-SYORI-EXT
           END-IF
      *
           MOVE    SYSKANRI-REC        TO  SYS-5001-REC
           MOVE    SPACE               TO  SYS-5001-KSN2
      *
           MOVE    ZERO                TO  IDX2
           PERFORM    VARYING   IDX   FROM   1  BY  1
             UNTIL   (IDX       >   10)
               IF   SPA-W201-TKSNCD2(IDX)   NOT =    SPACE
                  ADD     1            TO  IDX2
                  MOVE    SPA-W201-TKSNCD2(IDX)
                                       TO  SYS-5001-KSNCD2(IDX2)
               END-IF
           END-PERFORM
           MOVE    SYS-5001-REC        TO  SYSKANRI-REC
           MOVE    SYS-5001-KANRICD    TO  SYSUP-KANRICD
           MOVE    SYS-5001-KBNCD      TO  SYSUP-KBNCD
           MOVE    SPA-NAI-W20-YUKOSTYMD-OLD
                                       TO  SYSUP-STYUKYMD
           MOVE    SPA-NAI-W20-YUKOEDYMD-OLD
                                       TO  SYSUP-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYSUP-HOSPNUM
      *
           PERFORM 800-MCNDATE-SEC
           MOVE    SMCNDATE-YMD    TO  SYS-UPYMD
           MOVE    SMCNDATE-HMS    TO  SYS-UPHMS
      *
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "upd1"              TO  MCP-PATHNAME
           PERFORM 910-DBUPDATE-SEC
           IF   (  MCP-RC              NOT =   ZERO )
               MOVE    "9001"          TO  SPA-ERRCD
           END-IF
      *
           IF   SPA-ERRCD    =    SPACE
                PERFORM   310-SPASET-SEC
           END-IF
      *
           .
       2301-DELETE-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÐÏ¿¡¡½èÍý
      *****************************************************************
       220-TOUROKU-SEC                   SECTION.
      *
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 220-INPUT-CHK-SEC
      *    ¹¹¿·Á°
           IF      SPA-ERRCD           =   SPACE
               PERFORM 2201-ALL-CHK-SEC
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE
               PERFORM 2201-TOUROKU-SYORI-SEC
           END-IF
      *
           .
       220-TOUROKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¹¹¿·Á°¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       2201-ALL-CHK-SEC                SECTION.
      *
           IF      SPA-W201-KSNCD2     =   SPACE
               MOVE    "0010"          TO  SPA-ERRCD
               MOVE    2               TO  SPA-W201-CUR
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE
             IF  SPA-W201-TKSNCD2(10)    NOT =  SPACE
                 MOVE    "0011"          TO  SPA-ERRCD
                 MOVE    2               TO  SPA-W201-CUR
             END-IF
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE
             IF  SPA-W201-SELNUM   NOT =   ZERO
                 MOVE    "0014"          TO  SPA-ERRCD
                 MOVE    1               TO  SPA-W201-CUR
             END-IF
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE
             IF (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(1)) OR
                (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(2)) OR
                (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(3)) OR
                (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(4)) OR
                (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(5)) OR
                (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(6)) OR
                (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(7)) OR
                (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(8)) OR
                (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(9)) OR
                (SPA-W201-KSNCD2       =   SPA-W201-TKSNCD2(10))
                 MOVE    "0012"          TO  SPA-ERRCD
                 MOVE    2               TO  SPA-W201-CUR
             END-IF
           END-IF
           .
       2201-ALL-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       2201-TOUROKU-SYORI-SEC                   SECTION.
      *
           IF    SPA-W201-SELNUM       =   ZERO
                 PERFORM    VARYING    IDX   FROM  1   BY   1
                   UNTIL   (IDX     >   10)  OR
                           (SPA-W201-TKSNCD2(IDX)   =   SPACE)
                    CONTINUE
                 END-PERFORM
           END-IF
           MOVE     SPA-W201-KSNCD2    TO  SPA-W201-TKSNCD2(IDX)
           MOVE     IDX                TO  SPA-W201-TRENNUM(IDX)
           ADD      1                  TO  SPA-W201-LIST-MAX
      *
      *    ¥¢¥Ã¥×¥Ç¡¼¥ÈÂÐ¾Ý¤Î¥Ç¡¼¥¿¤òÆÉ¤ßÄ¾¤¹
           INITIALIZE                      SYSKANRI-REC
      *
           MOVE   "5001"               TO  SYS-KANRICD
           MOVE   SPA-GMN-W20-BTUNUM   TO  SYS-KBNCD
           MOVE   SPA-NAI-W20-YUKOSTYMD-OLD
                                       TO  SYS-STYUKYMD
                                           SYS-EDYUKYMD
           PERFORM 900-SYSKANRI-KEY10-SEL-SEC
           IF   ( FLG-SYSKANRI         NOT =   ZERO )
               MOVE    "9001"          TO  SPA-ERRCD
               GO  TO  2201-TOUROKU-SYORI-EXT
           END-IF
      *
           MOVE    SYSKANRI-REC        TO  SYS-5001-REC
           PERFORM    VARYING   IDX   FROM   1  BY  1
             UNTIL   (IDX       >   10)  OR
                     (SPA-W201-TKSNCD2(IDX)  =  SPACE)
             MOVE    SPA-W201-TKSNCD2(IDX)
                                       TO  SYS-5001-KSNCD2(IDX)
           END-PERFORM
           MOVE    SYS-5001-REC        TO  SYSKANRI-REC
           MOVE    SYS-5001-KANRICD    TO  SYSUP-KANRICD
           MOVE    SYS-5001-KBNCD      TO  SYSUP-KBNCD
           MOVE    SPA-NAI-W20-YUKOSTYMD-OLD
                                       TO  SYSUP-STYUKYMD
           MOVE    SPA-NAI-W20-YUKOEDYMD-OLD
                                       TO  SYSUP-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYSUP-HOSPNUM
      *
           PERFORM 800-MCNDATE-SEC
           MOVE    SMCNDATE-YMD    TO  SYS-UPYMD
           MOVE    SMCNDATE-HMS    TO  SYS-UPHMS
      *
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "upd1"              TO  MCP-PATHNAME
           PERFORM 910-DBUPDATE-SEC
           IF   (  MCP-RC              NOT =   ZERO )
               MOVE    "9001"          TO  SPA-ERRCD
           END-IF
      *
           IF   SPA-ERRCD    =    SPACE
                PERFORM   220-CLERA-SYORI-SEC
           END-IF
           .
       2201-TOUROKU-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÊÔ½¸½èÍý
      *****************************************************************
       22011-DBHENSYU-SEC                   SECTION.
      *
           .
       22011-DBHENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ìá¤ë¡¡½èÍý
      *****************************************************************
       210-BACK                    SECTION.
      *
           MOVE    "W20"               TO  SPA-SAKIPG
           MOVE    "W201"              TO  SPA-MOTOPG
      *
           MOVE    "JOIN"              TO  MCP-PUTTYPE
           MOVE    "W20"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
       210-BACK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼«²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-SET-SCREEN              SECTION.
      *
            PERFORM 500-GMNHEN-SEC
      *
           IF      SPA-ERRCD       NOT =   SPACE
               PERFORM 510-ERRSET-SEC
               GO      TO      500-SET-SCREEN-EXT
           END-IF
      *
           IF      SPA-WIDCD       NOT =   SPACE
               PERFORM 520-WIDSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    "CURRENT"           TO  MCP-PUTTYPE.
           MOVE    "W201"              TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
           .
       500-SET-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸É½¼¨Íý
      *****************************************************************
       510-ERRSET-SEC              SECTION.
           MOVE    SPACE               TO  SPA-ERRMSG
      *
           EVALUATE    SPA-ERRCD
               WHEN    "0001"
                   MOVE    "ÁªÂòÈÖ¹æ¤¬¤¢¤ê¤Þ¤»¤ó¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0002"
                   MOVE   "Æþ±¡ÎÁ²Ã»»¥³¡¼¥É¤¬ÅÀ¿ô¥Þ¥¹¥¿¤ËÂ¸ºß¤·¤Þ¤»¤ó¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0003"
                   MOVE   "Æþ±¡ÎÁ²Ã»»¥³¡¼¥É¤òÀµ¤·¤¯ÆþÎÏ¤·¤Æ¤¯¤À¤µ¤¤¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0004"
                   MOVE    "ÁªÂòÈÖ¹æ¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0005"
                   MOVE   "ÉÂ±¡¤Î¤ß»»Äê²ÄÇ½¤Ê²Ã»»¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0006"
                   MOVE   "¿ÇÎÅ½ê¤Î¤ß»»Äê²ÄÇ½¤Ê²Ã»»¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0007"
                MOVE "¥·¥¹¥Æ¥à´ÉÍý¡Ý°åÎÅµ¡´Ø¾ðÊó¤ÇÀßÄê²ÄÇ½¤Ê²Ã»»¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0008"
                MOVE "¥·¥¹¥Æ¥à´ÉÍý¡ÝÉÂÅï´ÉÍý¾ðÊó¤ÇÀßÄê²ÄÇ½¤Ê²Ã»»¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0009"
                MOVE "¥·¥¹¥Æ¥à´ÉÍý¡ÝÉÂ¼¼´ÉÍý¾ðÊó¤ÇÀßÄê²ÄÇ½¤Ê²Ã»»¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0010"
                   MOVE    "Æþ±¡ÎÁ²Ã»»¥³¡¼¥É¤¬Ì¤ÀßÄê¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0011"
                   MOVE    "Æþ±¡ÎÁ²Ã»»¥³¡¼¥É¤ÎÀßÄê¤Ï£±£°·ï¤¬¾å¸Â¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0012"
                   MOVE    "Æþ±¡ÎÁ²Ã»»¥³¡¼¥É¤¬½ÅÊ£¤·¤Æ¤¤¤Þ¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0013"
                   MOVE    "ÆþÂà±¡ÅÐÏ¿²èÌÌ¤ÇÀßÄê²ÄÇ½¤Ê²Ã»»¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
               WHEN    "0014"
                   MOVE    "ÁªÂò¤µ¤ì¤¿²Ã»»¤ÏÄÉ²Ã¤Ç¤­¤Þ¤»¤ó¡£"
                                       TO  SPA-ERRMSG
               WHEN    "9000"
                   MOVE    "ÉÂÅï¾ðÊó¤¬¼èÆÀ¤Ç¤­¤Þ¤»¤ó¡£"
                                       TO  SPA-ERRMSG
               WHEN    "9001"
                   MOVE    "¹¹¿·¥¨¥é¡¼¤Ç¤¹¡£"
                                       TO  SPA-ERRMSG
           END-EVALUATE
      *
           MOVE    SPACE               TO  WERR
           MOVE    SPA-ERRCD           TO  WERR-ERRCODE
           MOVE    SPA-ERRMSG          TO  WERR-ERRMSG
           MOVE    "B01"               TO  MCP-WIDGET
      *
           MOVE    "W201"               TO  SPA-MOTOPG
           MOVE    "WERR"              TO  SPA-SAKIPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE.
           MOVE    "WERR"              TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
           .
       510-ERRSET-EXT.
           EXIT.
      *****************************************************************
      *    ¥¬¥¤¥É¥á¥Ã¥»¡¼¥¸É½¼¨
      *****************************************************************
       520-WIDSET-SEC              SECTION.
      *
           MOVE    SPACE           TO  WRK-WIDMSG
      *
           EVALUATE    SPA-WIDCD
               WHEN    "1001"
                   STRING  "Æþ±¡ÎÁ²Ã»»¤òÄÉ²Ã¤·¤Þ¤¹¡£"
                                                   DELIMITED  BY  SIZE
                           "¤è¤í¤·¤¤¤Ç¤¹¤«¡©"      DELIMITED  BY  SIZE
                                                   INTO    WRK-WIDMSG
                   END-STRING
               WHEN    "1003"
                   STRING  "Æþ±¡ÎÁ²Ã»»¤òºï½ü¤·¤Þ¤¹¡£"
                                                   DELIMITED  BY  SIZE
                           "¤è¤í¤·¤¤¤Ç¤¹¤«¡©"      DELIMITED  BY  SIZE
                                                   INTO    WRK-WIDMSG
                   END-STRING
          END-EVALUATE
      *
           MOVE    SPACE               TO  WID1
           MOVE    SPA-WIDCD           TO  WID1-ID1CODE
           MOVE    WRK-WIDMSG          TO  WID1-ID1MSG
           MOVE    "B12"               TO  MCP-WIDGET
      *
           MOVE    "W201"              TO  SPA-MOTOPG
           MOVE    "WID1"              TO  SPA-SAKIPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    "WID1"              TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
       520-WIDSET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Þ¥·¥óÆüÉÕ¼èÆÀ¥µ¥Ö
      *****************************************************************
       800-MCNDATE-SEC         SECTION.
      *
           CALL    "ORCSMCNDATE"   USING   ORCSMCNDATEAREA
      *
           .
      *
       800-MCNDATE-EXT.
           EXIT.
      *****************************************************************
      *    ´ÉÍý¥Þ¥¹¥¿¡¼ÆÉ¹þ½èÍý
      *****************************************************************
       900-SYSKANRI-READ-SEC        SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO                TO  FLG-SYSKANRI
           ELSE
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
      *
           .
       900-SYSKANRI-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¸¡º÷½èÍý(KEY10)
      *****************************************************************
       900-SYSKANRI-KEY10-SEL-SEC      SECTION.
      *
           MOVE    ZERO            TO  FLG-SYSKANRI
      *
           MOVE    SPA-HOSPNUM     TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
           MOVE    "tbl_syskanri"  TO  MCP-TABLE
           MOVE    "key10"         TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF    ( MCP-RC          =   ZERO )
               MOVE    "tbl_syskanri"  TO  MCP-TABLE
               MOVE    "key10"         TO  MCP-PATHNAME
               PERFORM  920-DBFETCH-SEC
               MOVE    MCPDATA-REC TO  SYSKANRI-REC
           ELSE
               MOVE    1           TO  FLG-SYSKANRI
               INITIALIZE              SYSKANRI-REC
           END-IF
      *
           MOVE    "tbl_syskanri"  TO  MCP-TABLE
           MOVE    "key10"         TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       900-SYSKANRI-KEY10-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¡¼ÆÉ¹þ½èÍý
      *****************************************************************
       900-TENSU-READ-SEC        SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO                TO  FLG-TENSU
           ELSE
               MOVE    1                   TO  FLG-TENSU
           END-IF
      *
           .
       900-TENSU-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â£Õ£Ð£Ä£Á£Ô£Å½èÍý
      *****************************************************************
       910-DBUPDATE-SEC                SECTION.
      *
           MOVE    "DBUPDATE"          TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       910-DBUPDATE-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       990-DBCLOSE-SEC         SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ð£Õ£Ô¡¡½èÍý
      *****************************************************************
       900-PUT-WINDOW              SECTION.
      *
           MOVE   "PUTWINDOW"       TO  MCP-FUNC.
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       900-PUT-WINDOW-EXT.
           EXIT.
      *
