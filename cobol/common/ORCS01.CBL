      *******************************************************************
      * Project code name "ORCA"
      * ∆¸∞Â…∏Ω‡•Ï•ª•◊•»•Ω•’•»° JMA standard receipt software°À
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this licence along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION      DIVISION.
       PROGRAM-ID.         ORCS01.
      ****************************************************************
      *    OS           LINUX                                         
      *                                                               
      *    PROGRAM      ORCS01  /  …È√¥∂‚≥€ªªƒÍ•µ•÷                   
      *                          ° ø∑œ∑øÕ ›∏±¬–±˛°À                   
      *  ¥…Õ˝º‘            : 
      *  ∫Ó¿Æ∆¸…’    ∫Ó∂»º‘        µ≠Ω“
      *  00/12/01    MCC°›æÆ∆¶¬Ù   ø∑µ¨∫Ó¿Æ
      ****************************************************************
      *  •◊•Ì•∞•È•‡Ω§¿µÕ˙ŒÚ
      * Maj/Min/Rev  Ω§¿µº‘       ∆¸…’      ∆‚Õ∆
      *  01.00.01    MCC°›æÆ∆¶¬Ù  01/06/05  ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒªªƒÍ•Ì•∏•√•Ø
      *                                     Ω§¿µ
      *  01.00.02    MCC°›æÆ∆¶¬Ù  01/06/11  ∫£≤Û¿¡µ·≥€§À ›∏±≈¨Õ—≥∞∂‚≥€§Œ
      *                                     ≤√ªª§‚§Ï
      *  01.00.03    MCC°›∆£∏∂    01/07/10  ≈ÍÃÙ§Œ§»§≠∫ﬁ∑ø∂Ë ¨§«§ﬁ§»§·§Î
      *  01.00.04    MCC°›æÆ∆¶¬Ù  01/08/08  ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒªªƒÍ•Ì•∏•√•Ø
      *                                     Ω§¿µ(æÂ∏¬•¡•ß•√•Øƒ…≤√)
      *  01.00.05    MCC°›æÆ∆¶¬Ù  01/10/17  ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒªªƒÍ•Ì•∏•√•Ø
      *                                     Ω§¿µ(∆÷…˛ÃÙ∫ﬁ§Œ≤ÛøÙ§Ú£±§À•ª•√•»)
      *  01.00.06    MCC°›æÆ∆¶¬Ù  01/10/21  ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒªªƒÍ•Ì•∏•√•Ø
      *                                     Ω§¿µ(æÂ∏¬∂‚≥€§ŒªªΩ–§ÚΩË ˝ÃÙ∫ﬁ§Œ
      *                                          πÁ∑◊√Õ§À —ππ)
      *  01.00.07    MCC°›æÆ∆¶¬Ù  01/10/25  ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒªªƒÍ•Ì•∏•√•Ø
      *                                     Ω§¿µ(£≈£÷£¡£Ã£’£¡£‘£≈§Œ£◊£»£≈£Œ
      *                                          æÚ∑Ô§Ú —ππ)
      *  01.00.08    MCC°›æÆ∆¶¬Ù  02/01/09  ¥µº‘…È√¥Ãµ§∑°¢ÃÙ∫ﬁ∞Ï…Ù…È√¥Õ≠§Í
      *                                     §Œ∏¯»Òª»Õ—ª˛§Œ¿¡µ·∂‚≥€ªªƒÍ§ÚΩ§¿µ
      *  01.00.09    MCC°›æÆ∆¶¬Ù  02/01/23  ∆‚…˛ÃÙ∫ﬁ∫ÆπÁª˛§ŒÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚
      *                                     ªªƒÍ§ÚΩ§¿µ
      *  01.00.10    MCC°›æÆ∆¶¬Ù  02/02/05  œ∑øÕ…È√¥§»∏¯»Ò…È√¥§Œ∑◊ªª¡∞•Ø•Í•¢
      *                                     §Úƒ…≤√
      *  01.00.11    MCC°›æÆ∆¶¬Ù  02/03/07  ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§Œ∑◊ªªª˛§À∫ﬁ≈¿øÙ§¨
      *                                     £≤£∞≈¿§«§¢§Ï§–∆±∞ÏÃÙ∫ﬁ§Œ§ﬁ§»§·
      *                                     (ºÔŒ‡øÙ§Œ•´•¶•Û•»)§Ú§∑§ §§§Ë§¶§À
      *                                     Ω§¿µ
      *  01.00.12    MCC°›æÆ∆¶¬Ù  02/02/12  œ∑øÕ£¥£± ›∏±§Œ∆˛Œœª˛§À•Ï•ª•◊•»§Œ
      *                                     ¥µº‘…È√¥≥€§Ú£±£∞±ﬂÃ§À˛ªÕºŒ∏ﬁ∆˛§Ú 
      *                                     π‘§ §Ô§ §§∂‚≥€§À§∑§ø
      *                                     (∏¯»Ò£±§ŒæÂ∏¬≥€§¢§Í∏¬ƒÍ§«ƒ…≤√)
      *  01.00.13    MCC°›æÆ∆¶¬Ù  02/02/13  ¥µº‘…È√¥∂Ë ¨§À£≥°ß∏«ƒÍ≥€§Úƒ…≤√
      *  01.00.14    MCC°›æÆ∆¶¬Ù  02/04/12  œ´∫“ ›∏±¬–±˛
      *                                     ∫∆∑◊ªªª˛§Àø«Œ≈∂Ë ¨ÀË§Œ≈¿øÙΩ∏∑◊
      *                                     §´§È±ﬂ∑˙§∆π‡Ã‹ ¨§Œ≈¿øÙ§Ú∏∫ªª§π§Î
      *  01.00.15    MCC°›æÆ∆¶¬Ù  02/09/06  ∆√ƒÍº¿¥µ§Œ∏¯»Ò¥µº‘§Œ•Ï•ª•◊•»
      *                                     ∞Ï…Ù…È√¥∂‚≥€§Ú±ﬂ√±∞Ã§«µ≠∫‹§π§Î§Ë§¶
      *                                     Ω§¿µ° ªÕºŒ∏ﬁ∆˛ΩËÕ˝§Ú•π•≠•√•◊°À
      *                                     ¢®¥µº‘…È√¥∂‚§œ£±£∞±ﬂÃ§À˛ªÕºŒ∏ﬁ∆˛
      *  01.00.16    MCC°›æÆ∆¶¬Ù  02/09/09  œ´∫“ ›∏±¬–±˛
      *                                     œ´∫“ ›∏±ª˛§œ¥µº‘¿¡µ·≥€§ÚÃµæÚ∑Ô§À
      *                                     •º•Ì±ﬂ§»§π§Î
      *  01.00.17    MCC°›æÆ∆¶¬Ù  02/09/10  œ∑øÕ£¥£± ›∏±§Œ∆˛Œœª˛§À•Ï•ª•◊•»§Œ
      *                                     ¥µº‘…È√¥≥€§Ú£±£∞±ﬂÃ§À˛ªÕºŒ∏ﬁ∆˛§Ú 
      *                                     π‘§ §Ô§ §§æÚ∑Ô§ÀƒÍ≥€¿©§ŒæÏπÁ§‚
      *                                     ƒ…≤√§∑§ø
      *  01.00.18    MCC°›æÆ∆¶¬Ù  02/09/17  ∆√ƒÍº¿¥µ•Ï•ª•◊•»§Œ¥µº‘…È√¥≥€§Œ
      *                                     ∑◊ªª§Úƒ˚¿µ
      *  01.00.19    MCC°›ÃÁœ∆    02/09/17  º´«Â¿’ ›∏±¬–±˛
      *  01.00.20    MCC°›æÆ∆¶¬Ù  02/09/17  °  ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛°À
      *                                     ∑Ú ›§Œπ‚Œº‘§À§ƒ§§§∆ ‰Ωı∂Ë ¨§Ë§Í
      *                                     …È√¥≥‰πÁ§Ú•ª•√•»
      *  01.00.21    MCC°›æÆ∆¶¬Ù  02/09/17  °  ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛°À
      *                                     £≥∫–Ã§À˛§Œ¥µº‘§À§ƒ§§§∆§œ ›∏±§Œ
      *                                     …È√¥≥‰πÁ§Ú£≤≥‰§»§π§Î
      *                                     √¢§∑πÒ ›≈˘§« ‰Ωı∂Ë ¨§À£±≥‰§¨¡™¬Ú
      *                                     §µ§Ï§øæÏπÁ°¢§Ω§¡§È§ÚÕ•¿Ë§π§Î§≥§»
      *  01.00.22    MCC°›æÆ∆¶¬Ù  02/09/19  °  ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛°À
      *                                     œ∑øÕ ›∏±§Œ£∏°¶£π≥‰¬–±˛
      *  01.00.23    MCC°›æÆ∆¶¬Ù  02/09/25  °  ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛°À
      *                                     ø≤§ø§≠§Íœ∑øÕ∫ﬂ¬¡ÌπÁø«Œ≈Œ¡§»
      *                                     ∫ﬂ¬Àˆ¥¸∞ÂŒ≈¡ÌπÁø«Œ≈Œ¡§ŒªªƒÍ
      *                                     π‚Œº‘§ƒ§§§∆…È√¥≥€§ŒæÂ∏¬§Ú¿ﬂƒÍ
      *  01.00.24    NACL°›ÃÁœ∆   02/10/08  °  ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛°À
      *                                     ƒ…≤√Ω§¿µ
      *  01.00.25    NACL°›ÃÁœ∆   02/10/28  ƒ˚¿µª˛§Œ∏∫Ã»ªªƒÍΩ§¿µ
      *  01.00.26    NACL°›æÆ∆¶¬Ù 02/12/05  £∂£µ∫–∞ æÂ§Œø≤§ø§≠§Íœ∑øÕ§À§ƒ§§§∆
      *                                     ÃÙ∫ﬁ…È√¥∂‚§ÚªªƒÍ§∑§ §§§Ë§¶Ω§¿µ
      *  01.00.27    NACL°›æÆ∆¶¬Ù 02/12/20  £∂£µ∫–∞ æÂ§Œø≤§ø§≠§Íœ∑øÕ§À§ƒ§§§∆
      *                                     ÃÙ∫ﬁ…È√¥∂‚§ÚªªƒÍ§∑§ §§§Ë§¶Ω§¿µ
      *                                     ° •’•È•∞ΩÈ¥¸≤Ω∞Ã√÷ —ππ°À
      *  01.00.28    NACL°›ÃÁœ∆   03/02/06  º´»Ò ›∏±§Œ≤›¿«¬–±˛
      *  01.00.29    NACL°›ÃÁœ∆   03/03/07  œ∑øÕ∏¬≈Ÿ≥€§ŒΩ∏∑◊ —ππ
      *  01.00.30    NACL°›ÃÁœ∆   03/03/18  ∏¯»Ò§Œƒ„«Ø∂‚°¶ƒ„ΩÍ∆¿¬–±˛≈˘
      *****************************************************************
       ENVIRONMENT         DIVISION.
       CONFIGURATION       SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                DIVISION.
       FILE                        SECTION.
      *
       WORKING-STORAGE SECTION.
      *
       01  WK-END                      PIC 9(08).
       01  WK-KSNRATE9                 PIC 9(03).
       01  WK-KSNRATE                  PIC 9V99.
       01  STS-AREA.
           03  STS-SYUNOU              PIC X(02).
           03  STS-TSYRRK              PIC X(02).
           03  STS-TNKRRK              PIC X(02).
           03  STS-HKNNUM              PIC X(02).
           03  STS-HKNCOMBI            PIC X(02).
       01  SYURYO-YMD.
           03  SYURYO-YY               PIC 9(04).
           03  SYURYO-MM               PIC 9(02).
           03  SYURYO-DD               PIC 9(02).
       01  KEISAN-AREA.
           03  WK-KNJFTNKIN            PIC 9(10).
           03  WK-ZENGAKU              PIC 9(10).
           03  WK-ZENGAKU-SYU          PIC 9(10).
           03  WK-ZENGAKU-YAK          PIC 9(10).
           03  WK-FTNKIN1              PIC 9(10).
           03  WK-FTNKIN2              PIC 9(10).
           03  WK-FTNKIN3              PIC 9(10).
           03  WK-FUTANWARI            PIC 9V99.
           03  WK-SEIKYUGK             PIC 9(10).
           03  WK-YAKFTN-TENSUU        PIC 9(10).
           03  WK-GAIKFTNRATE          PIC 9(03).
           03  WK-GAIYKZFTNKBN         PIC X(01).
           03  WK-TOKUTEI-COMPFTN      PIC 9(08).
           03  WK-TOKUTEI-COMPFTN2     PIC 9(08).
           03  WK-TOKUTEI-COMPFTN3     PIC 9(08).
       01  SHOHOUSEN-AREA.
           03  FLG-INNAI               PIC X(01).
           03  FLG-INGAI               PIC X(01).
       01  WK-FLG.
           03  FLG-SYUNOU              PIC 9(01).
           03  FLG-TNKRRK              PIC 9(01).
           03  FLG-TSYRRK              PIC 9(01).
           03  FLG-HKNNUM              PIC 9(01).
           03  FLG-HKNCOMBI            PIC 9(01).
           03  FLG-SYSKANRI            PIC 9(01).
           03  FLG-PTINF               PIC 9(01).
           03  FLG-SRYACCT             PIC 9(01).
           03  FLG-SRYACT              PIC 9(01).
           03  FLG-SANSHOU             PIC X(01).
           03  FLG-SANSHOU2            PIC X(01).
           03  FLG-SANSHOU3            PIC X(01).                       
           03  FLG-SANTEI1             PIC X(01).
           03  FLG-SANTEI2             PIC X(01).
           03  FLG-SANTEI3             PIC X(01).
           03  FLG-SANTEI4             PIC X(01).
           03  FLG-FTNKIN1             PIC X(01).
           03  FLG-FTNKIN2             PIC X(01).
           03  FLG-FTNKIN3             PIC X(01).
           03  FLG-SHOHOZUMI           PIC X(01).
           03  FLG-YAKFTN              PIC X(01).
      *----(01.00.03) LINE ADD START --------------------------
           03  FLG-ZAIGATAKBN          PIC 9(01).
           03  FLG-TENSU               PIC 9(01).
           03  FLG-ADDKBN              PIC 9(01). 
      *----(01.00.03) LINE ADD END   --------------------------
           03  FLG-LOCALRJN            PIC 9(01).
      *
           03  WK-ERR                  PIC 9(01).
           03  WK-UERR                 PIC 9(01).
           03  WK-PAYKBN               PIC X(02).
      *
      *     ›∏±∂Ë ¨° ∂ı«Ú°ß∞Â ›°°£±°ßœ´∫“°°£≤°ßº´«Â¿’°À
           03  WK-HKNKBN               PIC X(01).
      *
      *    ¥µº‘…È√¥∑◊ªªª˛§ŒªÕºŒ∏ﬁ∆˛Õ—•Ô°º•Ø
           03  WK-FTN                  PIC 9(10).
      *
      *    …¬±°≥‰∞˙≥€∑◊ªªª˛§Œ≥‰∞˙Œ®Õ—•Ô°º•Ø
           03  WK-RATE                 PIC 9(1)V9(2).
      *
      *    ∏¯»Ò§Œ¥µº‘…È√¥æÂ∏¬≤ÛøÙ§»æÂ∏¬∂‚≥€§Œ¬‡»ÚÕ—•®•Í•¢
       01  HOKEN-MAX-AREA.
           03  MAX-KAI-KOHI1-D         PIC 9(05).
           03  MAX-KAI-KOHI2-D         PIC 9(05).
           03  MAX-KAI-KOHI3-D         PIC 9(05).
           03  MAX-KAI-KOHI4-D         PIC 9(05).
           03  MAX-KAI-KOHI1-M         PIC 9(05).
           03  MAX-KAI-KOHI2-M         PIC 9(05).
           03  MAX-KAI-KOHI3-M         PIC 9(05).
           03  MAX-KAI-KOHI4-M         PIC 9(05).
           03  MAX-KIN-KOHI1-D         PIC 9(08).
           03  MAX-KIN-KOHI2-D         PIC 9(08).
           03  MAX-KIN-KOHI3-D         PIC 9(08).
           03  MAX-KIN-KOHI4-D         PIC 9(08).
           03  MAX-KIN-KOHI1-M         PIC 9(08).
           03  MAX-KIN-KOHI2-M         PIC 9(08).
           03  MAX-KIN-KOHI3-M         PIC 9(08).
           03  MAX-KIN-KOHI4-M         PIC 9(08).
      *
      *    ∏¯»Ò§Œª»Õ—≤ÛøÙ•´•¶•Û•»Õ—•®•Í•¢
       01  HOKEN-KAISU-AREA.
           03  KAISU-KOHI1-D           PIC 9(05).
           03  KAISU-KOHI2-D           PIC 9(05).
           03  KAISU-KOHI3-D           PIC 9(05).
           03  KAISU-KOHI4-D           PIC 9(05).
           03  KAISU-KOHI1-M           PIC 9(05).
           03  KAISU-KOHI2-M           PIC 9(05).
           03  KAISU-KOHI3-M           PIC 9(05).
           03  KAISU-KOHI4-M           PIC 9(05).
      *
       01  HOKEN-KAISU-TABLE.
           03  HOKEN-KAISU-TBL         OCCURS  32.
               05  KOHI1-TBL           PIC 9(02).
               05  KOHI2-TBL           PIC 9(02).
               05  KOHI3-TBL           PIC 9(02).
               05  KOHI4-TBL           PIC 9(02).
      *
      *    ∏¯»Ò§Œ¥µº‘…È√¥∫—§ﬂ∂‚≥€§Œ≤√ªªÕ—•®•Í•¢
       01  HOKEN-FUTAN-AREA.
           03  FTN-KOHI1-D             PIC 9(08).
           03  FTN-KOHI2-D             PIC 9(08).
           03  FTN-KOHI3-D             PIC 9(08).
           03  FTN-KOHI4-D             PIC 9(08).
           03  FTN-KOHI1-M             PIC 9(08).
           03  FTN-KOHI2-M             PIC 9(08).
           03  FTN-KOHI3-M             PIC 9(08).
           03  FTN-KOHI4-M             PIC 9(08).
      *
      *    ∏¯»Ò§Œ¥µº‘…È√¥≤ƒ«Ω§ ªƒ≥€ªªƒÍÕ—•®•Í•¢
       01  HOKEN-ZAN-AREA.
           03  ZAN-KOHI1-D             PIC 9(08).
           03  ZAN-KOHI2-D             PIC 9(08).
           03  ZAN-KOHI3-D             PIC 9(08).
           03  ZAN-KOHI4-D             PIC 9(08).
           03  ZAN-KOHI1-M             PIC 9(08).
           03  ZAN-KOHI2-M             PIC 9(08).
           03  ZAN-KOHI3-M             PIC 9(08).
           03  ZAN-KOHI4-M             PIC 9(08).
           03  ZAN-KOHI-AREA.
             05  ZAN-KOHI1             PIC 9(08).
             05  ZAN-KOHI2             PIC 9(08).
             05  ZAN-KOHI3             PIC 9(08).
             05  ZAN-KOHI4             PIC 9(08).
           03  ZAN-KOHI-TBL  REDEFINES  ZAN-KOHI-AREA
                                        OCCURS  4.
             05  ZAN-KOHI-T            PIC 9(08).
      *
      *    ¥µº‘«ØŒªªΩ–Õ—•®•Í•¢
       01  WRK-NENREI-AREA.
           03  WRK-NENREI              PIC 9(03).
           03  WRK-YMDS1.
               05  WRK-YYS1            PIC 9(04).
               05  WRK-MMS1            PIC 9(02).
               05  WRK-DDS1            PIC 9(02).
           03  WRK-YMDS2.
               05  WRK-YYS2            PIC 9(04).
               05  WRK-MMS2            PIC 9(02).
               05  WRK-DDS2            PIC 9(02).
      *
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚° ∏¯»Ò Ã∑◊ªª°À¬‡»ÚŒŒ∞Ë
       01  WK-YAKFTN.
           03  WK-SYU-YAKFTN           PIC 9(08).
           03  WK-KOH-YAKFTN-AREA.
             05  WK-KOH1-YAKFTN        PIC 9(08).
             05  WK-KOH2-YAKFTN        PIC 9(08).
             05  WK-KOH3-YAKFTN        PIC 9(08).
             05  WK-KOH4-YAKFTN        PIC 9(08).
           03  WK-KOH-YAKFTN-TBL    REDEFINES  WK-KOH-YAKFTN-AREA
                                               OCCURS  4.
             05  WK-KOH-YAKFTN-T       PIC 9(08).
                                                
      *
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚∑◊ªª•®•Í•¢
       01  YAKFTN-AREA.
      *
      *        •—•È•·•ø§´§È§Œºı§±ºË§ÍÕ—°  £øÙ ›∏±¡»πÁ§ªÕ—°À
           03  LNK-S02-TBL         OCCURS   40.
               07  LNK-S02-SRYKBN       PIC  X(02).
               07  LNK-S02-ZAIBAN       PIC  9(08).
               07  LNK-S02-SRYCD        PIC  X(09).
               07  LNK-S02-SURYOU       PIC  9(05)V9(03).
               07  LNK-S02-KAISUU       PIC  9(03).
               07  LNK-S02-TENSUU       PIC  9(07).
      *
      *        •—•È•·•ø§´§È§Œºı§±ºË§ÍÕ—
           03  YAKFTN-TABLE.
               05  YAKFTN-TBL-OCC       OCCURS  40.
                   07  YAKFTN-KEY.
                       09  YAKFTN-SRYKBN
                                          PIC X(02).
                       09  YAKFTN-SRYCD   PIC X(09).
                   07  YAKFTN-ZAIBAN      PIC 9(08).
                   07  YAKFTN-TENSUU      PIC 9(07).
                   07  YAKFTN-KAISUU-TABLE.
                       09  YAKFTN-KAISUU  PIC 9(02)  OCCURS 180.
                   07  YAKFTN-MAX         PIC 9(03).
           03  YAKFTN-TABLE2.
               05  YAKFTN-TBL-OCC2       OCCURS  40.
                   07  YAKFTN-KEY2.
                       09  YAKFTN-SRYKBN2
                                          PIC X(02).
                       09  YAKFTN-SRYCD2   PIC X(09).
                       09  YAKFTN-ZAIBAN2  PIC 9(08).
                   07  YAKFTN-TENSUU2      PIC 9(07).
                   07  YAKFTN-KAISUU-TABLE2.
                       09  YAKFTN-KAISUU2  PIC 9(02)  OCCURS 180.
                   07  YAKFTN-MAX2         PIC 9(03).
      *
      *        ∫ﬁ»÷πÊ ÃÃÙ∫ﬁøÙ∑◊ªªÕ—
           03  YAKFTN-ZAI-TABLE.
               05  YAKFTN-ZAI-TBL-OCC   OCCURS  40.
                   07  YAKFTN-ZAI-SRYKBN
                                        PIC X(02).
                   07  YAKFTN-ZAI-SRYCD PIC X(09).
                   07  YAKFTN-ZAI-ZAIBAN
                                        PIC 9(08).
                   07  YAKFTN-ZAI-TENSUU
                                        PIC 9(07).
                   07  YAKFTN-ZAI-KAISUU-TABLE.
                       09  YAKFTN-ZAI-KAISUU
                                        PIC 9(02)    OCCURS 180.
                   07  YAKFTN-ZAI-MAX   PIC 9(03).
      *        ∞Ï∆¸ΩË ˝ ¨§ŒÃÙ∫ﬁ∑◊ªªÕ—
           03  YAKFTN-TOTAL-TABLE.
               05  YAKFTN-TOTAL-TBL-OCC   OCCURS   3.
                   07  YAKFTN-TOTAL-KAISUU  PIC  9(2)  OCCURS  180.
      *
      *         ¬§”¬ÿ§®Õ—•Ô°º•Ø
           03  WK-SRT-YAKFTN-TABLE.
               05  WK-SRT-YAKFTN-KEY.
                   07  WK-SRT-YAKFTN-SRYKBN     PIC X(02).
                   07  WK-SRT-YAKFTN-SRYCD      PIC X(09).
               05  WK-SRT-YAKFTN-ZAIBAN         PIC 9(08).
               05  WK-SRT-YAKFTN-TENSUU         PIC 9(07).
               05  WK-SRT-YAKFTN-KAISUU         PIC 9(02)  OCCURS 180.
               05  WK-SRT-YAKFTN-MAX            PIC 9(03).
      *
           03  WK-KEY-SRY.
               05  WK-KEY-SRYKBN          PIC X(02).
               05  WK-KEY-SRYCD           PIC X(09).
           03  WK-KEY-ZAIBAN              PIC 9(08).  
      *
      *        …˛Õ—¥¸¥÷ ‘Ω∏Õ—•Ô°º•Ø
           03  WK-KAISUU-TABLE.
               05  WK-KAISUU           PIC 9(02)    OCCURS 180.
           03  WK-ZAI-KAISUU-TABLE.
               05  WK-ZAI-KAISUU       PIC 9(02)    OCCURS 180.
           03  WK-KINGAK               PIC 9(07).
           03  YAKFTN-SOGOKEI          PIC 9(07).
           03  WK-FUTAN                PIC 9(05).
           03  YAKFTN-JOUGEN           PIC 9(07).
      *
      *     ›∏± —ππª˛§Œ∑—¬≥∆˛ŒœÕ—§ŒÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚ŒŒ∞Ë
           03  WK-CONT-YAKFTNAREA.
               05  WK-CONT-YAKFTNKIN1  PIC 9(07).
               05  WK-CONT-YAKFTNKIN2  PIC 9(07).
      *
      *----(01.00.04) LINE ADD START --------------------------
           03  WK-KBNBETSU-YAKUZAI.
               05  WK-TOYAKU-TENSU     PIC 9(10)    OCCURS  4.
           03  WK-TOYAKU-ZAIBAN-AREA   OCCURS  40.
               05  WK-TOYAKU-SRYKBN    PIC X(02).
               05  WK-TOYAKU-ZAIBAN    PIC 9(08).
               05  WK-TOYAKU-ZAITEN    PIC 9(07).
           03  WK-NAI-FUTAN            PIC 9(05).
           03  WK-TON-FUTAN            PIC 9(05).
           03  WK-GAI-FUTAN            PIC 9(05).
      *----(01.00.04) LINE ADD END   --------------------------
      *
      *    ≈∫§®ª˙ŒŒ∞Ë
       01  IDX-AREA.
           03  IDX                     PIC  9(02)  VALUE  ZERO.
           03  IDX2X                   PIC  X(02).
           03  IDX2R                   REDEFINES    IDX2X.
               05  IDX2                PIC  9(02).
           03  Y-IDX                   PIC  9(03)  VALUE  ZERO.
           03  Y-IDX2                  PIC  9(03)  VALUE  ZERO.
           03  Y-IDX3                  PIC  9(03)  VALUE  ZERO.
           03  Y-IDX4                  PIC  9(03)  VALUE  ZERO.
           03  Y-IDX5                  PIC  9(03)  VALUE  ZERO.
           03  HKNGAI-IDX              PIC  9(02)  VALUE  ZERO.
           03  DSP-IDX                 PIC  9(02)  VALUE  ZERO.
           03  DSP-IDX2                PIC  9(02)  VALUE  ZERO.
           03  KOH-IDX                 PIC  9(02)  VALUE  ZERO.
      *
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘§Œ…È√¥æÂ∏¬ªªƒÍ•®•Í•¢
      *
       01  WK-SYUHKN-TAIHI-AREA.
           03  MAX-KIN-SYU-M           PIC 9(08).
           03  FTN-SYU-M               PIC 9(08).
           03  ZAN-SYU-M               PIC 9(08).
           03  FLG-SANTEI-SYU          PIC X(01).
           03  WK-SYU-SYUCOMPFTN       PIC 9(08).                       
           03  FLG-ZAITAKU             PIC 9(01).                       
           03  FTN-KOH-XXX             PIC 9(08).                       
           03  FTN-KOH-YYY             PIC 9(08).                       
           03  FTN-KOH-ZZZ             PIC 9(08).
           03  FLG-KOUREI-KBN          PIC X(01).                       
      *----(01.00.23) LINE ADD END   --------------------------
      *
      *****************************************************************
      *    •’•°•§•Î•Ï•§•¢•¶•»
      *****************************************************************
      *
      *    º˝«º•ﬁ•π•ø°º
       01  SYU-SYUNOU-REC.
           COPY    "CPSYUNOU.INC".
      *
      *    ƒ„ΩÍ∆¿º‘Õ˙ŒÚ
       01  TSYRRK-REC.
           COPY    "CPTSYRRK.INC".
      *
      *    «Ø∂‚Õ˙ŒÚ
       01  TNKRRK-REC.
           COPY    "CPTNKRRK.INC".
      *
      *     ›∏±¡»§ﬂπÁ§Ô§ª
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *     ›∏±»÷πÊ
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *
      *    ≈¿øÙ
           COPY    "CPTENSU.INC".
      *
      *    •∑•π•∆•‡¥…Õ˝
           COPY    "CPSK1001.INC".
           COPY    "CPSK1026.INC".
           COPY    "CPSK1027.INC".
           COPY    "CPSK4001.INC".
      *
      *    ¥µº‘æ Û
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    ø«Œ≈≤Ò∑◊
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    ø«Œ≈π‘∞Ÿ
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *****************************************************************
      *    •µ•÷•◊•ÌÕ—°°ŒŒ∞Ë
      *****************************************************************
      *
      *     ›∏±ªªƒÍÕ—«ØŒ°¶≥‰πÁ∑◊ªª•µ•÷
           COPY    "CPORCSAGECHK.INC".
      *    £ƒ£¬∏°∫˜
           COPY    "MCPDATA.INC".
           COPY    "CPORCMCP.INC".
      *
      /
      ***
       LINKAGE             SECTION.
           COPY  "MCPAREA". 
           COPY  "CPORCS01.INC".
       01  LNK-SYU-SYUNOU-REC.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //LNK-SYU-//.
      /
       PROCEDURE           DIVISION  USING
                                     MCPAREA
                                     LNK-ORCS01-REC
                                     LNK-SYU-SYUNOU-REC.
      ******************************************************************
      *        ∞ÕÕÍ¿©∏ÊΩËÕ˝
      ******************************************************************
       MAIN-RTN            SECTION.
       MAIN-000.
           MOVE    ZERO            TO  LNK-S01-RC.
           MOVE    SPACE           TO  KEISAN-AREA.
           INITIALIZE                  KEISAN-AREA.
           MOVE    ZERO            TO  LNK-SYU-RJN-FTN
                                       LNK-SYU-KOH-FTN
                                       LNK-SYU-YKZ-FTN.
           MOVE    ZERO            TO  LNK-SYU-SYUHKNFTNMONEY
                                       LNK-SYU-SYUCOMPFTN
                                       LNK-SYU-SYUCOMPYKZFTN
                                       LNK-SYU-SYUCOMPTOTAL
           MOVE    SPACE    TO  LNK-SYU-SYUYKZFTNKBN.
           INITIALIZE    WK-SYUHKN-TAIHI-AREA.
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   4
                  MOVE    ZERO     TO  LNK-SYU-KOH-HKNFTNMONEY(IDX)
                                       LNK-SYU-KOH-COMPFTN(IDX)
                                       LNK-SYU-KOH-COMPYKZFTN(IDX)
                                       LNK-SYU-KOH-COMPTOTAL(IDX)
                  MOVE    SPACE    TO  LNK-SYU-KOH-YKZFTNKBN(IDX)
                                       
           END-PERFORM.
      *
      *     ›∏±¡»πÁ§ª•ﬁ•π•ø§Œª≤æ»…Ù ¨≥ŒƒÍ
           PERFORM   100-KAKUTEI-SEC.
      *
      *     ›∏±¡»πÁ§ª•ﬁ•π•ø§Œ∏°∫˜
           INITIALIZE                           HKNCOMBI-REC.
           MOVE    LNK-SYU-HOSPID       TO      COMB-HOSPID.
           MOVE    LNK-SYU-PTID         TO      COMB-PTID.
           MOVE    LNK-SYU-HKNCOMBINUM  TO      COMB-HKNCOMBINUM.
           MOVE    HKNCOMBI-REC         TO      MCPDATA-REC.
           MOVE    "DBSELECT"           TO      MCP-FUNC.
           MOVE    "HKNCOMBI-KEY"       TO      ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING   MCPAREA
                                                 ORCMCPAREA
                                                 MCPDATA-REC.
           IF      MCP-RC               =       ZERO
               MOVE    "HKNCOMBI-KEY"   TO      ORC-DBPATH 
               PERFORM   HKNCOMBI-READ-SEC
               IF      FLG-HKNCOMBI     =       1
                   MOVE    "DBCLOSE"        TO      MCP-FUNC
                   MOVE    "HKNCOMBI-KEY"   TO      ORC-DBPATH
                   CALL    "ORCMCPSUB"       USING   MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
                   DISPLAY "HKNCOMBI DBFETCH ERR"
                   MOVE     10          TO      LNK-S01-RC
                   GO   TO              MAIN-EXT
               END-IF
           ELSE
               MOVE    "DBCLOSE"        TO      MCP-FUNC
               MOVE    "HKNCOMBI-KEY"   TO      ORC-DBPATH
               CALL    "ORCMCPSUB"       USING   MCPAREA
                                                 ORCMCPAREA
                                                 MCPDATA-REC
               MOVE    1                TO      FLG-HKNCOMBI
               DISPLAY "HKNCOMBI DBSELECT ERR"
               MOVE     10              TO      LNK-S01-RC
               GO   TO                  MAIN-EXT
           END-IF.
           MOVE    "DBCLOSE"            TO      MCP-FUNC.
           MOVE    "HKNCOMBI-KEY"       TO      ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING   MCPAREA
                                                 ORCMCPAREA
                                                 MCPDATA-REC.
      *
      *     ›∏±¡»πÁ§ª•ﬁ•π•ø§´§ÈºÁ ›∏±§Œ ›∏±ºÔŒ‡§Ú»ΩƒÍ
      *    ° ∂ı«Ú°ß∞Â ›°¢£±°ßœ´∫“°¢£≤°ßº´«Â°À
           MOVE     SPACE               TO       WK-HKNKBN.
           EVALUATE    COMB-SYU-HKNKOHSBTKBN
               WHEN    "4"
                       MOVE    "1"      TO       WK-HKNKBN
           END-EVALUATE.
      *
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§Œ∑◊ªªΩËÕ˝
           MOVE         ZERO              TO     LNK-SYU-YKZ-FTN.
           MOVE         ZERO              TO     LNK-SYU-RESE-YKZ-FTN.
           PERFORM      YAKFTN-SANTEI-SEC.
           MOVE         YAKFTN-SOGOKEI    TO     LNK-SYU-RESE-YKZ-FTN.
           EVALUATE     FLG-SANSHOU
               WHEN     "1"
                   IF  COMB-GAI-YKZFTNKBN      NOT =   "0"
                       MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                       IF     COMB-GAI-YKZFTNKBN     =   "1"
                            MOVE   YAKFTN-SOGOKEI  TO  LNK-SYU-YKZ-FTN
                       END-IF
      *             ELSE
      *                 MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                   END-IF
               WHEN     "2"
                   IF  COMB-TSY-GAIYKZFTNKBN   NOT =   "0"
                       MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                       IF   COMB-TSY-GAIYKZFTNKBN  =   "1"
                            MOVE   YAKFTN-SOGOKEI  TO  LNK-SYU-YKZ-FTN
                       END-IF
      *             ELSE
      *                 MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                   END-IF
               WHEN     "3"
                   IF  COMB-TNK-GAIYKZFTNKBN   NOT =   "0"
                       MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                       IF   COMB-TNK-GAIYKZFTNKBN  =   "1"
                            MOVE   YAKFTN-SOGOKEI  TO  LNK-SYU-YKZ-FTN
                       END-IF
      *             ELSE
      *                 MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                   END-IF
           END-EVALUATE.
      *
      *    ¥µº‘…È√¥≥€§ŒªªƒÍ
           PERFORM       200-HKNFTN-SANTEI-SEC
           EVALUATE      FLG-SANSHOU
               WHEN      "1"
                   IF   (COMB-GAI-FTNKBN       =    "2")    AND
                        (COMB-GAI-YKZFTNKBN    =    "2")
                         MOVE   ZERO        TO   WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   END-IF
               WHEN      "2"
                   IF   (COMB-TSY-GAIFTNKBN    =    "2")    AND
                        (COMB-TSY-GAIYKZFTNKBN =    "2")
                         MOVE   ZERO        TO   WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   END-IF
               WHEN      "3"
                   IF   (COMB-TNK-GAIFTNKBN    =    "2")    AND
                        (COMB-TNK-GAIYKZFTNKBN =    "2")
                         MOVE   ZERO        TO   WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   END-IF
           END-EVALUATE.
           EVALUATE      FLG-SANSHOU
               WHEN      "1"
                   IF    COMB-GAI-YKZFTNKBN    =    "0"   OR  "3"
                         MOVE   ZERO        TO      LNK-SYU-YKZ-FTN
                   END-IF
               WHEN      "2"
                   IF    COMB-TSY-GAIYKZFTNKBN    =    "0"   OR  "3"
                         MOVE   ZERO        TO      LNK-SYU-YKZ-FTN
                   END-IF
               WHEN      "3"
                   IF    COMB-TNK-GAIYKZFTNKBN    =    "0"   OR  "3"
                         MOVE   ZERO        TO      LNK-SYU-YKZ-FTN
                   END-IF
           END-EVALUATE.
      *
      *    ªªΩ–¿¡µ·≥€§Œ£±£∞±ﬂÃ§À˛ªÕºŒ∏ﬁ∆˛° ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§‚¥ﬁ§‡°À
      *    ¢®œ´∫“ ›∏±§ŒæÏπÁ§œªÕºŒ∏ﬁ∆˛§Úπ‘§Ô§ §§
           IF     (LNK-SYU-SKYMONEY      NOT =   ZERO)   OR
                  (LNK-SYU-YKZ-FTN       NOT =   ZERO)
               IF   WK-HKNKBN            NOT =   "1"
                   COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +
                                               LNK-SYU-YKZ-FTN
                   COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +  5
                   COMPUTE  WK-SEIKYUGK      = LNK-SYU-SKYMONEY  /  10
                   COMPUTE  LNK-SYU-SKYMONEY = WK-SEIKYUGK       *  10
               ELSE
                   COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +
                                               LNK-SYU-YKZ-FTN
               END-IF 
           END-IF.
      *
      *    ºÁ ›∏±°¶œ∑øÕ°¶∏¯»Ò§Œ»Ω Ã
      *      ° ºÁ ›∏±°À
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)    AND
                  (LNK-SYU-KOH1HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH2HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH3HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH4HKNNUM    =       SPACE)
                   MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-HKNTEKMONEY
                   IF     LNK-SYU-YKZ-FTN    NOT =   ZERO
                          COMPUTE  LNK-SYU-HKNTEKMONEY  =
                                   LNK-SYU-HKNTEKMONEY  -
                                   LNK-SYU-YKZ-FTN
                   END-IF
           END-IF.
      *       ° œ∑øÕ°À 
      *
           IF     (LNK-SYU-KOH1HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH2HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH3HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH4HKNNUM    =   SPACE)
                   CONTINUE
           ELSE
               IF      COMB-KOH1-HKNKOHSBTKBN    =       "3"
                  IF  (COMB-KOH2-HKNKOHSBTKBN    =     SPACE)  AND
                      (COMB-KOH3-HKNKOHSBTKBN    =     SPACE)  AND
                      (COMB-KOH4-HKNKOHSBTKBN    =     SPACE)
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-RJN-FTN
                  ELSE
      *            ° ∏¯»Ò°À
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-KOH-FTN
                       IF     LNK-SYU-YKZ-FTN    NOT =   ZERO
                           IF   LNK-SYU-KOH-FTN  >    LNK-SYU-YKZ-FTN
                               COMPUTE  LNK-SYU-KOH-FTN  =
                                        LNK-SYU-KOH-FTN  -
                                        LNK-SYU-YKZ-FTN
                           ELSE
                               MOVE     ZERO     TO   LNK-SYU-KOH-FTN
                           END-IF               
                       END-IF
                  END-IF
               ELSE
      *            ° ∏¯»Ò°À
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-KOH-FTN
                       IF     LNK-SYU-YKZ-FTN    NOT =   ZERO
                           IF   LNK-SYU-KOH-FTN  >    LNK-SYU-YKZ-FTN
                               COMPUTE  LNK-SYU-KOH-FTN  =
                                        LNK-SYU-KOH-FTN  -
                                        LNK-SYU-YKZ-FTN
                           ELSE
                               MOVE     ZERO     TO   LNK-SYU-KOH-FTN
                           END-IF               
                       END-IF
               END-IF
           END-IF.
      *
      *    º´»Ò∂‚≥€§Œæ√»Ò¿«∑◊ªª
           COMPUTE   LNK-SYU-JIHI-TOTAL =  (LNK-SYU-JIHI-TAXNASI(1)  +
                                            LNK-SYU-JIHI-TAXNASI(2)  +
                                            LNK-SYU-JIHI-TAXNASI(3)  +
                                            LNK-SYU-JIHI-TAXNASI(4)  +
                                            LNK-SYU-JIHI-TAXNASI(5)).
           COMPUTE   LNK-SYU-JIHI-TOTAL-TAX = (LNK-SYU-JIHI-TAXARI(1) +
                                               LNK-SYU-JIHI-TAXARI(2) +
                                               LNK-SYU-JIHI-TAXARI(3) +
                                               LNK-SYU-JIHI-TAXARI(4) +
                                               LNK-SYU-JIHI-TAXARI(5)).
           COMPUTE   LNK-SYU-JIHI-TAX = LNK-SYU-JIHI-TOTAL-TAX * 0.05.
      *
      *----(01.00.02) LINE ADD START -------------------------------
      *     ›∏±≈¨Õ—≥∞∂‚≥€§Œ≤√ªª
           MOVE       ZERO              TO  LNK-SYU-TGMONEY(12).
           MOVE       ZERO              TO  LNK-SYU-TGMONEY-TAX(12).
           PERFORM    VARYING   HKNGAI-IDX   FROM   1   BY   1
                      UNTIL     HKNGAI-IDX   >     11
                      ADD       LNK-SYU-TGMONEY(HKNGAI-IDX)
                                            TO  LNK-SYU-TGMONEY(12)
                      ADD       LNK-SYU-TGMONEY-TAX(HKNGAI-IDX)
                                        TO  LNK-SYU-TGMONEY-TAX(12)
           END-PERFORM.
           COMPUTE  LNK-SYU-TGMONEY-TAX(12)  =  LNK-SYU-TGMONEY-TAX(12)
                                             *  1.05.
      *----(01.00.02) LINE ADD START -------------------------------
      *    ¿¡µ·∂‚≥€§Œ∑◊ªª° ƒ¥¿∞∂‚¥ﬁ§ﬁ§∫°À
           COMPUTE    LNK-SYU-SKYMONEY  =   LNK-SYU-SKYMONEY    +
      *----(01.00.02) LINE ADD START -------------------------------
                                            LNK-SYU-TGMONEY(12) +
      *----(01.00.02) LINE ADD START -------------------------------
                                            LNK-SYU-TGMONEY-TAX(12) +
                                            LNK-SYU-JIHI-TOTAL  +
                                            LNK-SYU-JIHI-TOTAL-TAX  +
                                            LNK-SYU-JIHI-TAX.
      *
      *    º´»Ò ›∏±§Œ ‰Ωı∂Ë ¨§¨≤›¿«§ŒæÏπÁ°¢æ√»Ò¿«∑◊ªª§Úπ‘§¶
           IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" ) AND
               ( COMB-HOJOKBN           =  "1" )
      *
              COMPUTE  LNK-SYU-SKYMONEY   =  LNK-SYU-SKYMONEY
                                          *  1.05
      *
           END-IF.     
      *
      *    …¬±°∏∫Ã»§Œ∑◊ªª° º´»Ò§ÚΩ¸§Ø°À
           IF     LNK-SYU-SKYMONEY         NOT  =   ZERO
           AND    COMB-SYU-HKNKOHSBTKBN    NOT  =   "8" 
                   INITIALIZE                           PTINF-REC
                   MOVE    LNK-SYU-HOSPID       TO      PTINF-HOSPID
                   MOVE    LNK-SYU-PTID         TO      PTINF-PTID
                   MOVE    PTINF-REC            TO      MCPDATA-REC
                   MOVE    "DBSELECT"           TO      MCP-FUNC
                   MOVE    "PTINF-KEY"          TO      ORC-DBPATH
                   CALL    "ORCMCPSUB"           USING   MCPAREA
                                                         ORCMCPAREA
                                                         MCPDATA-REC
                   IF      MCP-RC               =       ZERO
                       MOVE    "PTINF-KEY"      TO      ORC-DBPATH
                       PERFORM  PTINF-READ-SEC
                       IF       MCP-RC          =       ZERO
                           PERFORM   GENMEN-KEISAN-SEC
                       ELSE
                           DISPLAY  "PTINF FETCH ERR"
                       END-IF
                   ELSE
                       DISPLAY   "PTINF SELECT ERR"
                   END-IF
      *
                   MOVE    "DBCLOSE"            TO  MCP-FUNC
                   MOVE    "PTINF-KEY"          TO  ORC-DBPATH
                   CALL    "ORCMCPSUB"           USING
                                                 MCPAREA
                                                 ORCMCPAREA
                                                 MCPDATA-REC
           END-IF.
      *
      *    ¿¡µ·∂‚≥€§Œ∑◊ªª° œ´∫“ ›∏±≈¨Õ—ª˛§Œ±ﬂ∑˙§∆π‡Ã‹≤√ªª°À
           IF   (WK-HKNKBN               =    "1")   AND
                (LNK-SYU-SYUHKNNUM       =    "971")  
                 MOVE    ZERO      TO       LNK-SYU-SKYMONEY
           COMPUTE    LNK-SYU-SKYMONEY  =   LNK-SYU-SKYMONEY    +
                                            LNK-SYU-TGMONEY(12) +
                                            LNK-SYU-TGMONEY-TAX(12) +
                                            LNK-SYU-JIHI-TOTAL  +
                                            LNK-SYU-JIHI-TOTAL-TAX  +
                                            LNK-SYU-JIHI-TAX
           END-IF.
      *
      *----(01.00.19) LINE ADD START --------------------------
      *    º´«Â¿’ ›∏±§ŒæÏπÁ°¢œ´∫“±ﬂ∑˙§∆π‡Ã‹§ÿ§Œ≤√ªªŒ®∑◊ªªƒ…≤√
           IF   (WK-HKNKBN               =    "1")   AND
                (LNK-SYU-SYUHKNNUM       =    "973")
                 COMPUTE  LNK-SYU-RSISHOSHIN-MONEY  =
                          LNK-SYU-RSISHOSHIN-MONEY  *  WK-KSNRATE      
                 COMPUTE  LNK-SYU-RSISAISHIN-MONEY  =
                          LNK-SYU-RSISAISHIN-MONEY  *  WK-KSNRATE
      *          COMPUTE  LNK-SYU-RSISDO-MONEY      =
      *                   LNK-SYU-RSISDO-MONEY      *  WK-KSNRATE
                 COMPUTE    LNK-SYU-SKYMONEY  =   LNK-SYU-SKYMONEY  +
                                            LNK-SYU-RSISHOSHIN-MONEY +
                                            LNK-SYU-RSISAISHIN-MONEY +
                                            LNK-SYU-RSISDO-MONEY     +
                                            LNK-SYU-RSIETC-MONEY
           END-IF.
      *----(01.00.19) LINE ADD END ----------------------------
      *
      *    ¿¡µ·∂‚≥€§Œ∑◊ªª° ƒ¥¿∞∂‚§Œ≤√∏∫ªª°À
           COMPUTE    LNK-SYU-SKYMONEY  =   LNK-SYU-SKYMONEY    +
                                            LNK-SYU-CHOSEI.
      *
       MAIN-EXT.
           EXIT PROGRAM
           STOP RUN.
      ******************************************************************
      *        …¬±°∏∫Ã»∑◊ªªΩËÕ˝                                    *
      ******************************************************************
       GENMEN-KEISAN-SEC          SECTION.
      *
           IF   PTINF-DISCOUNT  NOT =   SPACE  AND  "00"
               INITIALIZE                         SYS-1026-REC
               MOVE    "1026"               TO    SYS-1026-KANRICD
               MOVE    PTINF-DISCOUNT-KBN   TO    SYS-1026-KBNCD
               MOVE    LNK-SYU-SRYYMD       TO    ORC-DBYMD
               MOVE    SYS-1026-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "SYSKANRI-KEY"       TO    ORC-DBPATH
               CALL    "ORCMCPSUB"    USING        MCPAREA
                                                   ORCMCPAREA
                                                   MCPDATA-REC
               IF      MCP-RC               =     ZERO
                   MOVE     "SYSKANRI-KEY"  TO    ORC-DBPATH
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
                       MOVE   SYS-1026-KBNCD  TO  LNK-SYU-DISCOUNT-KBN
                       MOVE   SYS-1026-DISCOUNT-BODY
                                              TO  LNK-SYU-DISCOUNT-BODY
                   END-IF
               END-IF
      *
               MOVE    "DBCLOSE"            TO  MCP-FUNC
               MOVE    "SYSKANRI-KEY"       TO  ORC-DBPATH
               CALL    "ORCMCPSUB"           USING
                                             MCPAREA
                                             ORCMCPAREA
                                             MCPDATA-REC
      *
               INITIALIZE                         SYS-1027-REC
               MOVE    "1027"               TO    SYS-1027-KANRICD
               MOVE    PTINF-DISCOUNT       TO    SYS-1027-KBNCD
               MOVE    LNK-SYU-SRYYMD       TO    ORC-DBYMD
               MOVE    SYS-1027-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "SYSKANRI-KEY"       TO    ORC-DBPATH
               CALL    "ORCMCPSUB"    USING       MCPAREA
                                                  ORCMCPAREA
                                                  MCPDATA-REC
               IF      MCP-RC               =     ZERO
                   MOVE     "SYSKANRI-KEY"  TO    ORC-DBPATH
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
                       EVALUATE  SYS-1027-TEIRITU
                           WHEN  "1"
                               MOVE    ZERO    TO   WK-RATE
                               COMPUTE  WK-RATE  =  
                                        (100 - SYS-1027-DISCOUNT-RATE)
                                        /  100
                               COMPUTE    LNK-SYU-SKYMONEY  =
                                          LNK-SYU-SKYMONEY  *
                                          WK-RATE
                               COMPUTE    LNK-SYU-SKYMONEY  =
                                          LNK-SYU-SKYMONEY  +  5
                               COMPUTE    LNK-SYU-SKYMONEY  =
                                          LNK-SYU-SKYMONEY  / 10
                               COMPUTE    LNK-SYU-SKYMONEY  =
                                          LNK-SYU-SKYMONEY  * 10
                           WHEN  "2"
                               IF   SYS-1027-DISCOUNT-RATE >= 
                                                     LNK-SYU-SKYMONEY
                                    MOVE    ZERO   TO   LNK-SYU-SKYMONEY
                               ELSE
                                    COMPUTE    LNK-SYU-SKYMONEY  =
                                               LNK-SYU-SKYMONEY  -
                                               SYS-1027-DISCOUNT-RATE
                               END-IF
                       END-EVALUATE
                       MOVE   SYS-1027-KBNCD   TO
                                               LNK-SYU-DISCOUNT-RATEKBN
                       MOVE   SYS-1027-TEIRITU TO
                                               LNK-SYU-DISCOUNT-TEIRITU
                       MOVE  SYS-1027-DISCOUNT-RATE  TO
                                               LNK-SYU-DISCOUNT-RATE
                   END-IF
               END-IF
      *
               MOVE    "DBCLOSE"            TO  MCP-FUNC
               MOVE    "SYSKANRI-KEY"       TO  ORC-DBPATH
               CALL    "ORCMCPSUB"           USING
                                             MCPAREA
                                             ORCMCPAREA
                                             MCPDATA-REC
           END-IF.
      *
       GENMEN-KEISAN-EXT.
           EXIT.
      ******************************************************************
      *         ›∏±ª≤æ»…Ù ¨≥ŒƒÍΩËÕ˝                                    *
      ******************************************************************
       100-KAKUTEI-SEC          SECTION.
      *
           MOVE    SPACE                TO      FLG-SANSHOU.
           MOVE    SPACE                TO      FLG-SANSHOU2.
           MOVE    SPACE                TO      FLG-SANSHOU3.     
      *
           INITIALIZE                           TNKRRK-REC.
           MOVE    LNK-SYU-HOSPID       TO      TNKRRK-HOSPID.
           MOVE    LNK-SYU-PTID         TO      TNKRRK-PTID.
           MOVE    TNKRRK-REC           TO      MCPDATA-REC.
           MOVE    "DBSELECT"           TO      MCP-FUNC.
           MOVE    "TNKRRK-KEY2"        TO      ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING   MCPAREA
                                                 ORCMCPAREA
                                                 MCPDATA-REC.
           IF      MCP-RC               =       ZERO
               MOVE    "TNKRRK-KEY2"    TO      ORC-DBPATH
               PERFORM  TNKRRK-READ-SEC
               PERFORM  UNTIL
                          (FLG-TNKRRK     =    1)    OR
                         ((TNKRRK-STYMD   <=   LNK-SYU-SRYYMD)  AND
                          (LNK-SYU-SRYYMD <=   TNKRRK-EDYMD))
                   PERFORM   TNKRRK-READ-SEC
               END-PERFORM
           ELSE
               MOVE    1                TO      FLG-TNKRRK
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "TNKRRK-KEY2"        TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *
           INITIALIZE                           TSYRRK-REC.
           MOVE    LNK-SYU-HOSPID       TO      TSYRRK-HOSPID.
           MOVE    LNK-SYU-PTID         TO      TSYRRK-PTID.
           MOVE    TSYRRK-REC           TO      MCPDATA-REC.
           MOVE    "DBSELECT"           TO      MCP-FUNC.
           MOVE    "TSYRRK-KEY2"        TO      ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING   MCPAREA
                                                 ORCMCPAREA
                                                 MCPDATA-REC.
           IF      MCP-RC               =       ZERO
               MOVE    "TSYRRK-KEY2"    TO      ORC-DBPATH
               PERFORM  TSYRRK-READ-SEC
               PERFORM  UNTIL
                       (FLG-TSYRRK      =    1)    OR
                      ((TSYRRK-NINSTYMD <=   LNK-SYU-SRYYMD)  AND
                       (LNK-SYU-SRYYMD  <=   TSYRRK-NINEDYMD))
                   PERFORM   TSYRRK-READ-SEC
               END-PERFORM
           ELSE
               MOVE    1                TO      FLG-TSYRRK
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "TSYRRK-KEY2"        TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *
           IF  LNK-SYU-SRYYMD(1:6)          <  "200210"
              EVALUATE   FLG-TSYRRK       ALSO     FLG-TNKRRK
                 WHEN    1                ALSO     0
                 WHEN    1                ALSO     1
                         MOVE     "1"     TO       FLG-SANSHOU
                 WHEN    0                ALSO     1
                         MOVE     "2"     TO       FLG-SANSHOU
                 WHEN    0                ALSO     0
                         MOVE     "3"     TO       FLG-SANSHOU
              END-EVALUATE
           ELSE
              EVALUATE   FLG-TSYRRK       ALSO     FLG-TNKRRK
                 WHEN    1                ALSO     1
                         MOVE     "1"     TO       FLG-SANSHOU
                 WHEN    0                ALSO     1
                         MOVE     "2"     TO       FLG-SANSHOU
                 WHEN    0                ALSO     0
                 WHEN    1                ALSO     0
                         MOVE     "3"     TO       FLG-SANSHOU
              END-EVALUATE
           END-IF.
      *
           IF   ( LNK-SYU-KOH1HKNNUM     =  SPACE OR "027" )
           AND  ( LNK-SYU-KOH2HKNNUM     =  SPACE          )
           AND  ( LNK-SYU-KOH3HKNNUM     =  SPACE          )
           AND  ( LNK-SYU-KOH4HKNNUM     =  SPACE          )
                         MOVE     "1"     TO       FLG-SANSHOU
           END-IF.
      *
      *    ∏¯»Ò…È√¥…Ù ¨∏°∫˜Õ—§Œª≤æ»…Ù ¨•ª•√•»° À‹øÕ§«∏«ƒÍ°À
      ***  MOVE       "1"       TO    FLG-SANSHOU2.
      *
           IF  LNK-SYU-SRYYMD(1:6)          <  "200210"
              EVALUATE   FLG-TSYRRK       ALSO     FLG-TNKRRK
                 WHEN    1                ALSO     0
                 WHEN    1                ALSO     1
                         MOVE     "1"     TO       FLG-SANSHOU2
                 WHEN    0                ALSO     1
                         MOVE     "2"     TO       FLG-SANSHOU2
                 WHEN    0                ALSO     0
                         MOVE     "3"     TO       FLG-SANSHOU2
              END-EVALUATE
           ELSE
              EVALUATE   FLG-TSYRRK       ALSO     FLG-TNKRRK
                 WHEN    1                ALSO     1
                         MOVE     "1"     TO       FLG-SANSHOU2
                 WHEN    0                ALSO     1
                         MOVE     "2"     TO       FLG-SANSHOU2
                 WHEN    0                ALSO     0
                 WHEN    1                ALSO     0
                         MOVE     "3"     TO       FLG-SANSHOU2
              END-EVALUATE
           END-IF.
      *
           EVALUATE    FLG-TSYRRK       ALSO     FLG-TNKRRK        
               WHEN    1                ALSO     1                 
                       MOVE    SPACE    TO       FLG-SANSHOU3      
               WHEN    0                ALSO     1                 
                       MOVE     "2"     TO       FLG-SANSHOU3      
               WHEN    0                ALSO     0                 
               WHEN    1                ALSO     0
                       MOVE     "1"     TO       FLG-SANSHOU3      
           END-EVALUATE.                                    
      *
       100-KAKUTEI-EXT.
           EXIT.
      ******************************************************************
      *         ›∏±…È√¥≥€ªªƒÍΩËÕ˝                                      *
      ******************************************************************
       200-HKNFTN-SANTEI-SEC          SECTION.
      *
           MOVE    SPACE                 TO    SHOHOUSEN-AREA
                                               HOKEN-MAX-AREA
                                               HOKEN-KAISU-AREA
                                               HOKEN-KAISU-TABLE
                                               HOKEN-FUTAN-AREA
                                               HOKEN-ZAN-AREA
                                               WK-YAKFTN.
           INITIALIZE                          SHOHOUSEN-AREA
                                               HOKEN-MAX-AREA
                                               HOKEN-KAISU-AREA
                                               HOKEN-KAISU-TABLE
                                               HOKEN-FUTAN-AREA
                                               HOKEN-ZAN-AREA
                                               WK-YAKFTN.
      *
      *    ¥µº‘…È√¥∂‚ªªΩ–¡∞§Œ£±£∞£∞°Û…È√¥≥€ªªΩ–
           MOVE      ZERO         TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX     FROM    1   BY  1
                     UNTIL     IDX         >   11
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                                      (LNK-SYU-HKNTEN (IDX) * 10)
           END-PERFORM.
      *
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘§Œ…È√¥æÂ∏¬ªªƒÍ•®•Í•¢ΩÈ¥¸≤Ω
      *
           INITIALIZE    WK-SYUHKN-TAIHI-AREA.
           IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   SPACE)   AND
               (LNK-SYU-SRYYMD(1:6)          >=  "200210")
      *        ø≤§ø§≠§Íœ∑øÕ∫ﬂ¬¡ÌπÁø«Œ≈Œ¡° ±°∆‚ΩË ˝§ª§Û§Ú∏Ú…’§π§Î°À
               INITIALIZE                           SRYACT-REC
               MOVE    LNK-SYU-HOSPID       TO      SRY-HOSPID
               MOVE    LNK-SYU-NYUGAIKBN    TO      SRY-NYUGAIKBN
               MOVE    LNK-SYU-PTID         TO      SRY-PTID
               MOVE    LNK-SYU-SRYYMD(1:6)  TO      SRY-SRYYM
               MOVE    "114701210"          TO      SRY-SRYCD(1)
               MOVE    "114701210"          TO      SRY-SRYCD(2)
               MOVE    "114701210"          TO      SRY-SRYCD(3)
               MOVE    "114701210"          TO      SRY-SRYCD(4)
               MOVE    "114701210"          TO      SRY-SRYCD(5)
               MOVE    SRYACT-REC           TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "SRYACT-KEY7"        TO      ORC-DBPATH
               CALL    "ORCMCPSUB"           USING   MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
               IF      MCP-RC               =       ZERO
                   MOVE    "SRYACT-KEY7"    TO      ORC-DBPATH 
                   PERFORM   SRYACT-READ-SEC
                   IF      FLG-SRYACT       =       ZERO
                       INITIALIZE                   SRYACCT-REC
                       MOVE    SRY-HOSPID       TO   ACCT-HOSPID
                       MOVE    SRY-NYUGAIKBN    TO   ACCT-NYUGAIKBN
                       MOVE    SRY-SRYKA        TO   ACCT-SRYKA
                       MOVE    SRY-PTID         TO   ACCT-PTID
                       MOVE    SRY-SRYYM        TO   ACCT-SRYYM
                       MOVE    SRY-ZAINUM       TO   ACCT-ZAINUM
                       MOVE    SRYACCT-REC      TO   MCPDATA-REC
                       MOVE    "DBSELECT"       TO   MCP-FUNC
                       MOVE    "SRYACCT-KEY5"   TO   ORC-DBPATH
                       CALL    "ORCMCPSUB"           USING
                                                     MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
                       IF      MCP-RC           =       ZERO
                           MOVE    "SRYACCT-KEY5"   TO  ORC-DBPATH 
                           PERFORM   SRYACCT-READ-SEC
                           IF      FLG-SRYACCT  =       ZERO
                               IF  (ACCT-ZAITEN   NOT =  ZERO)  AND
                                   (ACCT-ZAIKAISU NOT =  ZERO)
                                   MOVE  "1"    TO   
                                            LNK-S01-KOUREI-ZAITAKU-KBN
                               MOVE    "DBCLOSE"       TO  MCP-FUNC
                               MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                               CALL    "ORCMCPSUB"         USING
                                                           MCPAREA
                                                           ORCMCPAREA
                                                           MCPDATA-REC
                           ELSE
                               MOVE    "DBCLOSE"       TO  MCP-FUNC
                               MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                               CALL    "ORCMCPSUB"         USING
                                                           MCPAREA
                                                           ORCMCPAREA
                                                           MCPDATA-REC
                           END-IF
                       ELSE
                           MOVE    "DBCLOSE"       TO  MCP-FUNC
                           MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                           CALL    "ORCMCPSUB"         USING
                                                       MCPAREA
                                                       ORCMCPAREA
                                                       MCPDATA-REC
                       END-IF
                   ELSE
                       MOVE    "DBCLOSE"            TO  MCP-FUNC
                       MOVE    "SRYACT-KEY7"        TO  ORC-DBPATH
                       CALL    "ORCMCPSUB"          USING
                                                    MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
                   END-IF
               ELSE
                   MOVE    "DBCLOSE"        TO      MCP-FUNC
                   MOVE    "SRYACT-KEY7"    TO      ORC-DBPATH
                   CALL    "ORCMCPSUB"      USING   MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
               END-IF
      *        ø≤§ø§≠§Íœ∑øÕ∫ﬂ¬¡ÌπÁø«Œ≈Œ¡° ±°∆‚ΩË ˝§ª§Û§Ú∏Ú…’§∑§ §§°À
               INITIALIZE                           SRYACT-REC
               MOVE    LNK-SYU-HOSPID       TO      SRY-HOSPID
               MOVE    LNK-SYU-NYUGAIKBN    TO      SRY-NYUGAIKBN
               MOVE    LNK-SYU-PTID         TO      SRY-PTID
               MOVE    LNK-SYU-SRYYMD(1:6)  TO      SRY-SRYYM
               MOVE    "114701710"          TO      SRY-SRYCD(1)
               MOVE    "114701710"          TO      SRY-SRYCD(2)
               MOVE    "114701710"          TO      SRY-SRYCD(3)
               MOVE    "114701710"          TO      SRY-SRYCD(4)
               MOVE    "114701710"          TO      SRY-SRYCD(5)
               MOVE    SRYACT-REC           TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "SRYACT-KEY7"        TO      ORC-DBPATH
               CALL    "ORCMCPSUB"           USING   MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
               IF      MCP-RC               =       ZERO
                   MOVE    "SRYACT-KEY7"    TO      ORC-DBPATH 
                   PERFORM   SRYACT-READ-SEC
                   IF      FLG-SRYACT       =       ZERO
                       INITIALIZE                   SRYACCT-REC
                       MOVE    SRY-HOSPID       TO   ACCT-HOSPID
                       MOVE    SRY-NYUGAIKBN    TO   ACCT-NYUGAIKBN
                       MOVE    SRY-SRYKA        TO   ACCT-SRYKA
                       MOVE    SRY-PTID         TO   ACCT-PTID
                       MOVE    SRY-SRYYM        TO   ACCT-SRYYM
                       MOVE    SRY-ZAINUM       TO   ACCT-ZAINUM
                       MOVE    SRYACCT-REC      TO   MCPDATA-REC
                       MOVE    "DBSELECT"       TO   MCP-FUNC
                       MOVE    "SRYACCT-KEY5"   TO   ORC-DBPATH
                       CALL    "ORCMCPSUB"           USING
                                                     MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
                       IF      MCP-RC           =       ZERO
                           MOVE    "SRYACCT-KEY5"   TO  ORC-DBPATH 
                           PERFORM   SRYACCT-READ-SEC
                           IF      FLG-SRYACCT  =       ZERO
                               IF  (ACCT-ZAITEN   NOT =  ZERO)  AND
                                   (ACCT-ZAIKAISU NOT =  ZERO)
                                   MOVE  "1"    TO   
                                            LNK-S01-KOUREI-ZAITAKU-KBN
                               MOVE    "DBCLOSE"       TO  MCP-FUNC
                               MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                               CALL    "ORCMCPSUB"         USING
                                                           MCPAREA
                                                           ORCMCPAREA
                                                           MCPDATA-REC
                           ELSE
                               MOVE    "DBCLOSE"       TO  MCP-FUNC
                               MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                               CALL    "ORCMCPSUB"         USING
                                                           MCPAREA
                                                           ORCMCPAREA
                                                           MCPDATA-REC
                           END-IF
                       ELSE
                           MOVE    "DBCLOSE"       TO  MCP-FUNC
                           MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                           CALL    "ORCMCPSUB"         USING
                                                       MCPAREA
                                                       ORCMCPAREA
                                                       MCPDATA-REC
                       END-IF
                   ELSE
                       MOVE    "DBCLOSE"            TO  MCP-FUNC
                       MOVE    "SRYACT-KEY7"        TO  ORC-DBPATH
                       CALL    "ORCMCPSUB"          USING
                                                    MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
                   END-IF
               ELSE
                   MOVE    "DBCLOSE"        TO      MCP-FUNC
                   MOVE    "SRYACT-KEY7"    TO      ORC-DBPATH
                   CALL    "ORCMCPSUB"      USING   MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
               END-IF
      *        ∫ﬂ¬Àˆ¥¸∞ÂŒ≈¡ÌπÁø«Œ≈Œ¡° ±°≥∞°À
               INITIALIZE                           SRYACT-REC
               MOVE    LNK-SYU-HOSPID       TO      SRY-HOSPID
               MOVE    LNK-SYU-NYUGAIKBN    TO      SRY-NYUGAIKBN
               MOVE    LNK-SYU-PTID         TO      SRY-PTID
               MOVE    LNK-SYU-SRYYMD(1:6)  TO      SRY-SRYYM
               MOVE    "114007610"          TO      SRY-SRYCD(1)
               MOVE    "114007610"          TO      SRY-SRYCD(2)
               MOVE    "114007610"          TO      SRY-SRYCD(3)
               MOVE    "114007610"          TO      SRY-SRYCD(4)
               MOVE    "114007610"          TO      SRY-SRYCD(5)
               MOVE    SRYACT-REC           TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "SRYACT-KEY7"        TO      ORC-DBPATH
               CALL    "ORCMCPSUB"           USING   MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
               IF      MCP-RC               =       ZERO
                   MOVE    "SRYACT-KEY7"    TO      ORC-DBPATH 
                   PERFORM   SRYACT-READ-SEC
                   IF      FLG-SRYACT       =       ZERO
                       INITIALIZE                   SRYACCT-REC
                       MOVE    SRY-HOSPID       TO   ACCT-HOSPID
                       MOVE    SRY-NYUGAIKBN    TO   ACCT-NYUGAIKBN
                       MOVE    SRY-SRYKA        TO   ACCT-SRYKA
                       MOVE    SRY-PTID         TO   ACCT-PTID
                       MOVE    SRY-SRYYM        TO   ACCT-SRYYM
                       MOVE    SRY-ZAINUM       TO   ACCT-ZAINUM
                       MOVE    SRYACCT-REC      TO   MCPDATA-REC
                       MOVE    "DBSELECT"       TO   MCP-FUNC
                       MOVE    "SRYACCT-KEY5"   TO   ORC-DBPATH
                       CALL    "ORCMCPSUB"           USING
                                                     MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
                       IF      MCP-RC           =       ZERO
                           MOVE    "SRYACCT-KEY5"   TO  ORC-DBPATH 
                           PERFORM   SRYACCT-READ-SEC
                           IF      FLG-SRYACCT  =       ZERO
                               IF  (ACCT-ZAITEN   NOT =  ZERO)  AND
                                   (ACCT-ZAIKAISU NOT =  ZERO)
                                   MOVE  "1"    TO   
                                            LNK-S01-KOUREI-ZAITAKU-KBN
                               MOVE    "DBCLOSE"       TO  MCP-FUNC
                               MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                               CALL    "ORCMCPSUB"         USING
                                                           MCPAREA
                                                           ORCMCPAREA
                                                           MCPDATA-REC
                           ELSE
                               MOVE    "DBCLOSE"       TO  MCP-FUNC
                               MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                               CALL    "ORCMCPSUB"         USING
                                                           MCPAREA
                                                           ORCMCPAREA
                                                           MCPDATA-REC
                           END-IF
                       ELSE
                           MOVE    "DBCLOSE"       TO  MCP-FUNC
                           MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                           CALL    "ORCMCPSUB"         USING
                                                       MCPAREA
                                                       ORCMCPAREA
                                                       MCPDATA-REC
                       END-IF
                   ELSE
                       MOVE    "DBCLOSE"            TO  MCP-FUNC
                       MOVE    "SRYACT-KEY7"        TO  ORC-DBPATH
                       CALL    "ORCMCPSUB"          USING
                                                    MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
                   END-IF
               ELSE
                   MOVE    "DBCLOSE"        TO      MCP-FUNC
                   MOVE    "SRYACT-KEY7"    TO      ORC-DBPATH
                   CALL    "ORCMCPSUB"      USING   MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
               END-IF
      *        ∫ﬂ¬Àˆ¥¸∞ÂŒ≈¡ÌπÁø«Œ≈Œ¡° ±°∆‚°À
               INITIALIZE                           SRYACT-REC
               MOVE    LNK-SYU-HOSPID       TO      SRY-HOSPID
               MOVE    LNK-SYU-NYUGAIKBN    TO      SRY-NYUGAIKBN
               MOVE    LNK-SYU-PTID         TO      SRY-PTID
               MOVE    LNK-SYU-SRYYMD(1:6)  TO      SRY-SRYYM
               MOVE    "114007710"          TO      SRY-SRYCD(1)
               MOVE    "114007710"          TO      SRY-SRYCD(2)
               MOVE    "114007710"          TO      SRY-SRYCD(3)
               MOVE    "114007710"          TO      SRY-SRYCD(4)
               MOVE    "114007710"          TO      SRY-SRYCD(5)
               MOVE    SRYACT-REC           TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "SRYACT-KEY7"        TO      ORC-DBPATH
               CALL    "ORCMCPSUB"           USING   MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
               IF      MCP-RC               =       ZERO
                   MOVE    "SRYACT-KEY7"    TO      ORC-DBPATH 
                   PERFORM   SRYACT-READ-SEC
                   IF      FLG-SRYACT       =       ZERO
                       INITIALIZE                   SRYACCT-REC
                       MOVE    SRY-HOSPID       TO   ACCT-HOSPID
                       MOVE    SRY-NYUGAIKBN    TO   ACCT-NYUGAIKBN
                       MOVE    SRY-SRYKA        TO   ACCT-SRYKA
                       MOVE    SRY-PTID         TO   ACCT-PTID
                       MOVE    SRY-SRYYM        TO   ACCT-SRYYM
                       MOVE    SRY-ZAINUM       TO   ACCT-ZAINUM
                       MOVE    SRYACCT-REC      TO   MCPDATA-REC
                       MOVE    "DBSELECT"       TO   MCP-FUNC
                       MOVE    "SRYACCT-KEY5"   TO   ORC-DBPATH
                       CALL    "ORCMCPSUB"           USING
                                                     MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
                       IF      MCP-RC           =       ZERO
                           MOVE    "SRYACCT-KEY5"   TO  ORC-DBPATH 
                           PERFORM   SRYACCT-READ-SEC
                           IF      FLG-SRYACCT  =       ZERO
                               IF  (ACCT-ZAITEN   NOT =  ZERO)  AND
                                   (ACCT-ZAIKAISU NOT =  ZERO)
                                   MOVE  "1"    TO   
                                            LNK-S01-KOUREI-ZAITAKU-KBN
                               MOVE    "DBCLOSE"       TO  MCP-FUNC
                               MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                               CALL    "ORCMCPSUB"         USING
                                                           MCPAREA
                                                           ORCMCPAREA
                                                           MCPDATA-REC
                           ELSE
                               MOVE    "DBCLOSE"       TO  MCP-FUNC
                               MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                               CALL    "ORCMCPSUB"         USING
                                                           MCPAREA
                                                           ORCMCPAREA
                                                           MCPDATA-REC
                           END-IF
                       ELSE
                           MOVE    "DBCLOSE"       TO  MCP-FUNC
                           MOVE    "SRYACCT-KEY5"  TO  ORC-DBPATH
                           CALL    "ORCMCPSUB"         USING
                                                       MCPAREA
                                                       ORCMCPAREA
                                                       MCPDATA-REC
                       END-IF
                   ELSE
                       MOVE    "DBCLOSE"            TO  MCP-FUNC
                       MOVE    "SRYACT-KEY7"        TO  ORC-DBPATH
                       CALL    "ORCMCPSUB"          USING
                                                    MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
                   END-IF
               ELSE
                   MOVE    "DBCLOSE"        TO      MCP-FUNC
                   MOVE    "SRYACT-KEY7"    TO      ORC-DBPATH
                   CALL    "ORCMCPSUB"      USING   MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
               END-IF
      *        ¥µº‘«ØŒ∑◊ªª
               INITIALIZE                           PTINF-REC
               MOVE    LNK-SYU-HOSPID       TO      PTINF-HOSPID
               MOVE    LNK-SYU-PTID         TO      PTINF-PTID
               MOVE    PTINF-REC            TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "PTINF-KEY"          TO      ORC-DBPATH
               CALL    "ORCMCPSUB"          USING   MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
               IF      MCP-RC               =       ZERO
                   MOVE    "PTINF-KEY"      TO      ORC-DBPATH
                   PERFORM  PTINF-READ-SEC
               ELSE
                   DISPLAY   "PTINF SELECT ERR"
      *
                   INITIALIZE                   PTINF-REC
               END-IF
      *
               MOVE    "DBCLOSE"            TO  MCP-FUNC
               MOVE    "PTINF-KEY"          TO  ORC-DBPATH
               CALL    "ORCMCPSUB"          USING
                                            MCPAREA
                                            ORCMCPAREA
                                            MCPDATA-REC
               INITIALIZE                  ORCSAGECHKAREA
               MOVE    LNK-SYU-HOSPID  TO  AGECHK-HOSPID
               MOVE    LNK-SYU-PTID    TO  AGECHK-PTID
               MOVE    LNK-SYU-SRYYMD  TO  AGECHK-SRYYMD
               MOVE    PTINF-BIRTHDAY  TO  AGECHK-BIRTHDAY
               CALL    "ORCSAGECHK"        USING
                                           ORCSAGECHKAREA
               IF      AGECHK-RC       =   ZERO
                   IF  ( AGECHK-NENREI   >=  70 ) OR
                      (( AGECHK-NENREI   >=  65 AND                  
                         COMB-KOH1HKNNUM  = "027"))                  
                       CONTINUE
                   ELSE
                       MOVE  SPACE   TO  LNK-S01-KOUREI-ZAITAKU-KBN
                   END-IF
               ELSE
                   DISPLAY  "PTINF AGE-CHK ERR " LNK-SYU-PTID
      *
                   MOVE  SPACE       TO  LNK-S01-KOUREI-ZAITAKU-KBN
               END-IF
           END-IF.
           IF   LNK-S01-KOUREI-ZAITAKU-KBN   =  "1"
               IF  COMB-SYU-HKNKOHSBTKBN   =   "8"
                   MOVE  SPACE       TO  LNK-S01-KOUREI-ZAITAKU-KBN
               END-IF
               IF  COMB-HKNNUM  =  SPACE  OR  "971"  OR  "973"
                   MOVE  SPACE       TO  LNK-S01-KOUREI-ZAITAKU-KBN
               END-IF
           END-IF.
      *
           IF    LNK-SYU-SRYYMD(1:6)          >=  "200210"
      *        ¥µº‘«ØŒ∑◊ªª
               INITIALIZE                           PTINF-REC
               MOVE    LNK-SYU-HOSPID       TO      PTINF-HOSPID
               MOVE    LNK-SYU-PTID         TO      PTINF-PTID
               MOVE    PTINF-REC            TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "PTINF-KEY"          TO      ORC-DBPATH
               CALL    "ORCMCPSUB"          USING   MCPAREA
                                                    ORCMCPAREA
                                                    MCPDATA-REC
               IF      MCP-RC               =       ZERO
                   MOVE    "PTINF-KEY"      TO      ORC-DBPATH
                   PERFORM  PTINF-READ-SEC
               ELSE
                   DISPLAY   "PTINF SELECT ERR"
      *
                   INITIALIZE                   PTINF-REC
               END-IF
      *
               MOVE    "DBCLOSE"            TO  MCP-FUNC
               MOVE    "PTINF-KEY"          TO  ORC-DBPATH
               CALL    "ORCMCPSUB"          USING
                                            MCPAREA
                                            ORCMCPAREA
                                            MCPDATA-REC
               INITIALIZE                  ORCSAGECHKAREA
               MOVE    LNK-SYU-HOSPID  TO  AGECHK-HOSPID
               MOVE    LNK-SYU-PTID    TO  AGECHK-PTID
               MOVE    LNK-SYU-SRYYMD  TO  AGECHK-SRYYMD
               MOVE    PTINF-BIRTHDAY  TO  AGECHK-BIRTHDAY
               CALL    "ORCSAGECHK"        USING
                                           ORCSAGECHKAREA
               IF      AGECHK-RC       =   ZERO
                   IF  ( AGECHK-NENREI   >=  70 ) OR
                      (( AGECHK-NENREI   >=  65 AND                  
                         COMB-KOH1HKNNUM  = "027"))                  
                       MOVE    "1"     TO  FLG-KOUREI-KBN
                   END-IF
               ELSE
                   DISPLAY  "PTINF AGE-CHK ERR " LNK-SYU-PTID
      *
                   MOVE    SPACE       TO  FLG-KOUREI-KBN
               END-IF
           END-IF.
           IF   FLG-KOUREI-KBN  =  "1"
               IF  COMB-SYU-HKNKOHSBTKBN   =   "8"
                   MOVE  SPACE       TO  FLG-KOUREI-KBN
               END-IF
               IF  COMB-HKNNUM  =  SPACE  OR  "971"  OR  "973"
                   MOVE  SPACE       TO  FLG-KOUREI-KBN
               END-IF
           END-IF.   
      *----(01.00.23) LINE ADD END   --------------------------
      *
      *     ›∏±»÷πÊ•∆°º•÷•Î§´§È∏¯»Ò§Œ…È√¥æÂ∏¬≤ÛøÙ§»æÂ∏¬∂‚≥€§ŒºË∆¿
           PERFORM         210-HOKEN-KAISU-SEC.
      *
      *    ø«Œ≈∑Ó∆‚§Œº˝«º•ﬁ•π•ø§´§È∏¯»ÒÀË§Œª»Õ—≤ÛøÙ§»¥µº‘…È√¥∂‚≥€§Œ
      *    Œﬂ∑◊§Úƒ¥∫∫
           PERFORM         220-SYUNOU-SEC.
      *
      *     ›∏±°¶∏¯»Ò§Œ…È√¥∂‚∑◊ªª
           PERFORM         230-FTNKIN-SEC.
      *
       200-HKNFTN-SANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *         ›∏±°¶∏¯»Ò§Œ¿ﬂƒÍæÂ∏¬≤ÛøÙ§»æÂ∏¬∂‚≥€§ŒºË∆¿                *
      ******************************************************************
       210-HOKEN-KAISU-SEC           SECTION.
      *
      *    ∞ÂŒ≈µ°¥ÿ§«§Œœ∑øÕ ›∏±…È√¥ºÔ Ã§Ú•∑•π•∆•‡¥…Õ˝•ﬁ•π•ø§Ë§ÍºË∆¿
           IF    (COMB-KOH1-HKNKOHSBTKBN   =   "3")   OR
                 (COMB-KOH2-HKNKOHSBTKBN   =   "3")   OR
                 (COMB-KOH3-HKNKOHSBTKBN   =   "3")   OR
                 (COMB-KOH4-HKNKOHSBTKBN   =   "3")
               PERFORM    2101-ROUJIN-HKN-HANTEI-SEC
           END-IF.
      *
      *    ∞ÂŒ≈µ°¥ÿ§¨ø«Œ≈ΩÍ§ŒæÏπÁ°¢≥∫≈ˆ¥µº‘§Œ≥∫≈ˆ∑Ó§À±°≥∞ΩË ˝§¨£±≈Ÿ§«§‚
      *    §¢§√§ø§´∏°∫˜§π§Î
           IF     SYS-1001-HOSPSBT      =     "2"
               PERFORM    2102-SHOHOUSEN-HANTEI-SEC
           END-IF.
      *
      *    *∏¯»Ò£±§ŒæÂ∏¬≤ÛøÙ° ∂‚≥€°ÀºËπ˛§ﬂ
           IF (COMB-KOH1HKNNUM           NOT =  SPACE)    AND
              (COMB-KOH1-GAIJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPID        TO    HKN-HOSPID
               MOVE   COMB-KOH1HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH1HKNNUM    =     "027"
                   IF    LNK-SYU-SRYYMD  >=    "20021001"
                       MOVE     COMB-KOH1PAYKBN     TO  WK-PAYKBN
                   ELSE
                       MOVE     SYS-1001-HOSPSBT    TO  WK-PAYKBN(1:1)
                       MOVE     SYS-1001-ROUPAYKBN  TO  WK-PAYKBN(2:1)
                   END-IF
               ELSE
                       MOVE     "00"         TO    WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "HKNNUM-KEY2"      TO    ORC-DBPATH
               CALL   "ORCMCPSUB"         USING MCPAREA
                                                ORCMCPAREA
                                                MCPDATA-REC
               IF      MCP-RC            =     ZERO
                   MOVE    "HKNNUM-KEY2" TO    ORC-DBPATH
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                       OR
                    ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            =  HKN-PAYKBN))
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   2103-KOH1-KAISU-SEC
                   END-IF
               END-IF
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "HKNNUM-KEY2"        TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *
      *    *∏¯»Ò£≤§ŒæÂ∏¬≤ÛøÙ° ∂‚≥€°ÀºËπ˛§ﬂ
           IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
              (COMB-KOH2-GAIJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPID        TO    HKN-HOSPID
               MOVE   COMB-KOH2HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH2HKNNUM    =     "027"
                   MOVE     SYS-1001-HOSPSBT    TO  WK-PAYKBN(1:1)
                   MOVE     SYS-1001-ROUPAYKBN  TO  WK-PAYKBN(2:1)
               ELSE
                   MOVE     "00"                TO  WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "HKNNUM-KEY2"      TO    ORC-DBPATH
               CALL   "ORCMCPSUB"         USING MCPAREA
                                                ORCMCPAREA
                                                MCPDATA-REC
               IF      MCP-RC            =     ZERO
                   MOVE    "HKNNUM-KEY2" TO    ORC-DBPATH
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                      OR
                    ((HKN-TEKSTYMD(1:6)   <= LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <= HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            = HKN-PAYKBN))
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   2104-KOH2-KAISU-SEC
                   END-IF
               END-IF
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "HKNNUM-KEY2"        TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *
      *    *∏¯»Ò£≥§ŒæÂ∏¬≤ÛøÙ° ∂‚≥€°ÀºËπ˛§ﬂ
           IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
              (COMB-KOH3-GAIJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPID        TO    HKN-HOSPID
               MOVE   COMB-KOH3HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH3HKNNUM    =     "027"
                   MOVE     SYS-1001-HOSPSBT    TO  WK-PAYKBN(1:1)
                   MOVE     SYS-1001-ROUPAYKBN  TO  WK-PAYKBN(2:1)
               ELSE
                   MOVE     "00"                TO  WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "HKNNUM-KEY2"      TO    ORC-DBPATH
               CALL   "ORCMCPSUB"         USING MCPAREA
                                                ORCMCPAREA
                                                MCPDATA-REC
               IF      MCP-RC            =     ZERO
                   MOVE    "HKNNUM-KEY2" TO    ORC-DBPATH
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                      OR
                    ((HKN-TEKSTYMD(1:6)   <= LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <= HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            = HKN-PAYKBN))
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   2105-KOH3-KAISU-SEC
                   END-IF
               END-IF
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "HKNNUM-KEY2"        TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *
      *    *∏¯»Ò£¥§ŒæÂ∏¬≤ÛøÙ° ∂‚≥€°ÀºËπ˛§ﬂ
           IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
              (COMB-KOH4-GAIJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPID        TO    HKN-HOSPID
               MOVE   COMB-KOH4HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH4HKNNUM    =     "027"
                   MOVE     SYS-1001-HOSPSBT    TO  WK-PAYKBN(1:1)
                   MOVE     SYS-1001-ROUPAYKBN  TO  WK-PAYKBN(2:1)
               ELSE
                   MOVE     "00"                TO  WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "HKNNUM-KEY2"      TO    ORC-DBPATH
               CALL   "ORCMCPSUB"         USING MCPAREA
                                                ORCMCPAREA
                                                MCPDATA-REC
               IF      MCP-RC            =     ZERO
                   MOVE    "HKNNUM-KEY2" TO    ORC-DBPATH
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                       OR
                    ((HKN-TEKSTYMD(1:6)   <= LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <= HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            = HKN-PAYKBN))
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   2106-KOH4-KAISU-SEC
                   END-IF
               END-IF
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "HKNNUM-KEY2"        TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘§ŒºÁ ›∏±æÂ∏¬≥€ªªƒÍ
      *
           IF  LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
               IF  COMB-KOH1-HKNKOHSBTKBN   =   "3"
                   EVALUATE   COMB-KOH1PAYKBN
                       WHEN   "01"
                           MOVE  "1"          TO   COMB-KOH1-GAIJGNKBN
                           IF  FLG-SANSHOU3     =   SPACE               
                               MOVE   12000   TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           ELSE
                               MOVE    8000   TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           END-IF
                       WHEN   "02"
                           MOVE  "1"          TO   COMB-KOH1-GAIJGNKBN
                           MOVE   40200       TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                   END-EVALUATE
               ELSE
                   EVALUATE   COMB-HOJOKBN
                       WHEN   "1"
                       WHEN   "9"
                           IF  FLG-SANSHOU3      =   SPACE              
                               MOVE   12000   TO   MAX-KIN-SYU-M
                           ELSE
                               MOVE    8000   TO   MAX-KIN-SYU-M
                           END-IF
                       WHEN   "2"
                       WHEN   "8"
                           MOVE   40200       TO   MAX-KIN-SYU-M
                   END-EVALUATE
               END-IF
           END-IF.
      *----(01.00.23) LINE ADD END   --------------------------
      *
      *
       210-HOKEN-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        •∑•π•∆•‡¥…Õ˝•∆°º•÷•Î§Ë§Íœ∑øÕ ›∏±§ŒªŸ ß ˝À°§ÚºË∆¿        *
      ******************************************************************
       2101-ROUJIN-HKN-HANTEI-SEC           SECTION.
      *
           INITIALIZE                         SYS-1001-REC.
           MOVE    "1001"               TO    SYS-1001-KANRICD.
           MOVE    "*"                  TO    SYS-1001-KBNCD.
           MOVE    LNK-SYU-SRYYMD       TO    ORC-DBYMD.
           MOVE    SYS-1001-REC         TO    MCPDATA-REC.
           MOVE    "DBSELECT"           TO    MCP-FUNC.
           MOVE    "SYSKANRI-KEY"       TO    ORC-DBPATH.
           CALL    "ORCMCPSUB"    USING        MCPAREA
                                               ORCMCPAREA
                                               MCPDATA-REC.
           IF      MCP-RC               =     ZERO
               MOVE     "SYSKANRI-KEY"  TO    ORC-DBPATH
               PERFORM   SYSKANRI-READ-SEC
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "SYSKANRI-KEY"       TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *
       2101-ROUJIN-HKN-HANTEI-EXT.
           EXIT.
      *
      ***************************************************************
      *        º˝«º•∆°º•÷•Î§´§È±°∆‚ΩË ˝°¢±°≥∞ΩË ˝§Œ»ΩƒÍ             *
      ***************************************************************
       2102-SHOHOUSEN-HANTEI-SEC           SECTION.
      *
           IF      LNK-SYU-INGAISHOHOKBN  =      "1"
               MOVE       "1"             TO     FLG-INGAI
           ELSE
             MOVE    LNK-SYU-HOSPID       TO     SYU-HOSPID
             MOVE    LNK-SYU-NYUGAIKBN    TO     SYU-NYUGAIKBN
             MOVE    LNK-SYU-PTID         TO     SYU-PTID
             MOVE    SYU-SYUNOU-REC       TO     MCPDATA-REC 
             MOVE    "DBSELECT"           TO     MCP-FUNC
             MOVE    "SYUNOU-KEY2"        TO     ORC-DBPATH
             CALL    "ORCMCPSUB"           USING  MCPAREA
                                                  ORCMCPAREA
                                                  MCPDATA-REC
             IF      MCP-RC               =      ZERO
                 MOVE    "SYUNOU-KEY2"    TO     ORC-DBPATH
                 PERFORM  SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                     IF (LNK-SYU-SRYYMD(1:6) = SYU-SRYYMD(1:6)) AND
                        (SYU-DENPJTIKBN  NOT =   "3")
                         IF   SYU-INGAISHOHOKBN   =     "1"
                              MOVE   "1"  TO     FLG-INGAI
                         ELSE
                              MOVE   "1"  TO     FLG-INNAI
                         END-IF
                     END-IF
                     MOVE      "SYUNOU-KEY2"  TO     ORC-DBPATH
                     PERFORM   SYUNOU-READ-SEC
                 END-PERFORM
             END-IF
             MOVE    "DBCLOSE"            TO  MCP-FUNC
             MOVE    "SYUNOU-KEY2"        TO  ORC-DBPATH
             CALL    "ORCMCPSUB"           USING
                                           MCPAREA
                                           ORCMCPAREA
                                           MCPDATA-REC
           END-IF.
      *
       2102-SHOHOUSEN-HANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *        ∏¯»Ò£±° ∂‚≥€°ÀºËπ˛§ﬂΩËÕ˝                                *
      ******************************************************************
       2103-KOH1-KAISU-SEC           SECTION.
      *
           EVALUATE   FLG-SANSHOU2
               WHEN   "1"
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        END-IF
               WHEN   "2"
                        MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                        MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-TSY-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        ELSE
                              MOVE  HKN-TSY-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        END-IF
               WHEN   "3"
                        MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                        MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-TNK-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        ELSE
                              MOVE  HKN-TNK-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        END-IF
           END-EVALUATE.
      *
           IF     COMB-KOH1HKNNUM    =     "027"
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        END-IF
           END-IF.
      *
       2103-KOH1-KAISU-EXT.
           EXIT.
      ******************************************************************
      *        ∏¯»Ò£≤° ∂‚≥€°ÀºËπ˛§ﬂΩËÕ˝                                *
      ******************************************************************
       2104-KOH2-KAISU-SEC           SECTION.
      *
           EVALUATE   FLG-SANSHOU2
               WHEN   "1"
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        END-IF
               WHEN   "2"
                        MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                        MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-TSY-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        ELSE
                              MOVE  HKN-TSY-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        END-IF
               WHEN   "3"
                        MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                        MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-TNK-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        ELSE
                              MOVE  HKN-TNK-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        END-IF
           END-EVALUATE.
      *
       2104-KOH2-KAISU-EXT.
           EXIT.
      ******************************************************************
      *        ∏¯»Ò£≥° ∂‚≥€°ÀºËπ˛§ﬂΩËÕ˝                                *
      ******************************************************************
       2105-KOH3-KAISU-SEC           SECTION.
      *
           EVALUATE   FLG-SANSHOU2
               WHEN   "1"
                        MOVE  HKN-HON-GAIDJGNCNT TO   MAX-KAI-KOHI3-D
                        MOVE  HKN-HON-GAIMJGNCNT TO   MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-GAIDJGNGAK TO   MAX-KIN-KOHI3-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        END-IF
               WHEN   "2"
                        MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                        MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-TSY-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        ELSE
                              MOVE  HKN-TSY-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        END-IF
               WHEN   "3"
                        MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                        MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-TNK-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        ELSE
                              MOVE  HKN-TNK-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        END-IF
           END-EVALUATE.
      *
       2105-KOH3-KAISU-EXT.
           EXIT.
      ******************************************************************
      *        ∏¯»Ò£¥° ∂‚≥€°ÀºËπ˛§ﬂΩËÕ˝                                *
      ******************************************************************
       2106-KOH4-KAISU-SEC           SECTION.
      *
           EVALUATE   FLG-SANSHOU2
               WHEN   "1"
                        MOVE  HKN-HON-GAIDJGNCNT TO   MAX-KAI-KOHI4-D
                        MOVE  HKN-HON-GAIMJGNCNT TO   MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-GAIDJGNGAK TO   MAX-KIN-KOHI4-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        END-IF
               WHEN   "2"
                        MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                        MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-TSY-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        ELSE
                              MOVE  HKN-TSY-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        END-IF
               WHEN   "3"
                        MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                        MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                        IF    FLG-INGAI          =   "1"
                              MOVE  HKN-TNK-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        ELSE
                              MOVE  HKN-TNK-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        END-IF
           END-EVALUATE.
      *
       2106-KOH4-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ø«Œ≈∑Ó∆‚§Œº˝«º•ﬁ•π•ø§´§È∏¯»ÒÀË§Œª»Õ—≤ÛøÙ§»¥µº‘…È√¥∂‚≥€§Œ
      *    Œﬂ∑◊§Úƒ¥∫∫
      ******************************************************************
       220-SYUNOU-SEC           SECTION.
      *
           IF  (COMB-KOH1-GAIJGNKBN        =       "1")      OR
               (COMB-KOH2-GAIJGNKBN        =       "1")      OR
               (COMB-KOH3-GAIJGNKBN        =       "1")      OR
               (COMB-KOH4-GAIJGNKBN        =       "1")      OR
               (LNK-S01-KOUREI-ZAITAKU-KBN =       "1")      OR
               (FLG-KOUREI-KBN             =       "1")
               INITIALIZE                         SYU-SYUNOU-REC
               MOVE    LNK-SYU-HOSPID     TO      SYU-HOSPID
               MOVE    LNK-SYU-NYUGAIKBN  TO      SYU-NYUGAIKBN
               MOVE    LNK-SYU-PTID       TO      SYU-PTID
               MOVE    SYU-SYUNOU-REC     TO      MCPDATA-REC
               MOVE    "DBSELECT"         TO      MCP-FUNC
               MOVE    "SYUNOU-KEY2"      TO      ORC-DBPATH
               CALL    "ORCMCPSUB"         USING   MCPAREA
                                                   ORCMCPAREA
                                                   MCPDATA-REC
               IF      MCP-RC             =       ZERO
                   MOVE    "SYUNOU-KEY2"  TO      ORC-DBPATH
                   PERFORM  SYUNOU-READ-SEC
                   PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                     IF (LNK-SYU-SRYYMD(1:6) = SYU-SRYYMD(1:6)) AND
                        (SYU-DENPJTIKBN  NOT =  "3")
                             PERFORM        2201-SYUNOU-COUNT-SEC
                     END-IF
                     MOVE           "SYUNOU-KEY2"    TO   ORC-DBPATH
                     PERFORM        SYUNOU-READ-SEC
                   END-PERFORM
                   MOVE        LNK-SYU-SRYYMD(7:2)   TO   IDX2X
                   MOVE        KOHI1-TBL(IDX2) TO    KAISU-KOHI1-D
                   MOVE        KOHI2-TBL(IDX2) TO    KAISU-KOHI2-D
                   MOVE        KOHI3-TBL(IDX2) TO    KAISU-KOHI3-D
                   MOVE        KOHI4-TBL(IDX2) TO    KAISU-KOHI4-D
                   MOVE        KOHI1-TBL(32)   TO    KAISU-KOHI1-M
                   MOVE        KOHI2-TBL(32)   TO    KAISU-KOHI2-M
                   MOVE        KOHI3-TBL(32)   TO    KAISU-KOHI3-M
                   MOVE        KOHI4-TBL(32)   TO    KAISU-KOHI4-M
               ELSE
                   MOVE    12              TO        LNK-S01-RC
               END-IF
           END-IF.
      *
           MOVE    "DBCLOSE"               TO  MCP-FUNC.
           MOVE    "SYUNOU-KEY2"           TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"              USING
                                            MCPAREA
                                            ORCMCPAREA
                                            MCPDATA-REC.
      *
       220-SYUNOU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ø«Œ≈∑Ó§Œº˝«º•ﬁ•π•ø§´§È∏¯»Ò§Œ≤ÛøÙ° ∂‚≥€°À•´•¶•Û•»
      ******************************************************************
       2201-SYUNOU-COUNT-SEC          SECTION.
      *
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘
      *
           MOVE     ZERO     TO     FLG-ZAITAKU.                         
      *
           IF  LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
      **       IF  LNK-SYU-SYUHKNNUM    =  SYU-SYUHKNNUM
               IF ( SYU-SYUHKNNUM       =  "971" OR "973" OR SPACE )
               OR ( SYU-SYUHKNNUM(1:2)  =  "98"                    )
      *
                 CONTINUE
      *
               ELSE
      *
                 IF COMB-KOH1HKNNUM      =    "027"
                      COMPUTE  WK-SYU-SYUCOMPFTN  =                     
                                        SYU-KOH1COMPFTN    +   5        
                      COMPUTE  WK-SYU-SYUCOMPFTN  =                     
                                        WK-SYU-SYUCOMPFTN  /  10        
                      COMPUTE  WK-SYU-SYUCOMPFTN  =                     
                                        WK-SYU-SYUCOMPFTN  *  10        
                      IF  (SYU-KOH2HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH3HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH4HKNNUM     NOT = SPACE)              
                        MOVE     SYU-KOH-FTN  TO  WK-SYU-SYUCOMPFTN     
                        IF  FTN-KOH-XXX  <  12000                       
                          ADD  WK-SYU-SYUCOMPFTN  TO  FTN-KOH-XXX       
                          IF   FTN-KOH-XXX     >   12000                
                             MOVE   12000   TO   FTN-KOH-XXX            
                          END-IF                                        
                        END-IF                        
                      END-IF                                            
                      IF     LNK-SYU-SRYYMD(7:2)    =  SYU-SRYYMD(7:2)  
                          ADD   WK-SYU-SYUCOMPFTN TO   FTN-KOHI1-D      
                      END-IF                                            
                      ADD   WK-SYU-SYUCOMPFTN     TO   FTN-KOHI1-M      
                      MOVE  1                     TO   FLG-ZAITAKU      
                 ELSE                                                   
                      COMPUTE  WK-SYU-SYUCOMPFTN  =                     
                                        SYU-SYUCOMPFTN     +   5        
                      COMPUTE  WK-SYU-SYUCOMPFTN  =                     
                                        WK-SYU-SYUCOMPFTN  /  10        
                      COMPUTE  WK-SYU-SYUCOMPFTN  =                     
                                        WK-SYU-SYUCOMPFTN  *  10        
                      IF  (SYU-KOH1HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH2HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH3HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH4HKNNUM     NOT = SPACE)              
                        MOVE     SYU-KOH-FTN  TO  WK-SYU-SYUCOMPFTN     
                        IF  FTN-KOH-XXX    <  12000                     
                          ADD  WK-SYU-SYUCOMPFTN  TO  FTN-KOH-XXX       
                          IF   FTN-KOH-XXX     >   12000                
                             MOVE   12000   TO   FTN-KOH-XXX            
                          END-IF                                        
                        END-IF                                  
                      END-IF                                            
                      ADD   WK-SYU-SYUCOMPFTN     TO   FTN-SYU-M        
                 END-IF                                                 
      *
               END-IF
           END-IF.
           IF   ( LNK-S01-KOUREI-ZAITAKU-KBN   NOT =   "1" )
           AND  ( FLG-KOUREI-KBN                   =   "1" )
      *
      **       IF  LNK-SYU-SYUHKNNUM    =  SYU-SYUHKNNUM
               IF ( SYU-SYUHKNNUM       =  "971" OR "973" OR SPACE )
               OR ( SYU-SYUHKNNUM(1:2)  =  "98"                    )
      *
                 CONTINUE
      *
               ELSE
      *
                 IF COMB-KOH1HKNNUM      =    "027"
                      IF  (SYU-KOH2HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH3HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH4HKNNUM     NOT = SPACE)              
                        MOVE     SYU-KOH-FTN  TO  WK-SYU-SYUCOMPFTN     
                        IF  FTN-KOH-XXX  <  12000                       
                          ADD  WK-SYU-SYUCOMPFTN  TO  FTN-KOH-XXX       
                          IF   FTN-KOH-XXX     >   12000                
                             MOVE   12000   TO   FTN-KOH-XXX            
                          END-IF                                        
                        END-IF                                          
                      END-IF                                            
                 ELSE                                                   
                      IF  (SYU-KOH1HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH2HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH3HKNNUM     NOT = SPACE)              
                      OR  (SYU-KOH4HKNNUM     NOT = SPACE)              
                        MOVE     SYU-KOH-FTN  TO  WK-SYU-SYUCOMPFTN     
                        IF  FTN-KOH-XXX    <  12000                     
                          ADD  WK-SYU-SYUCOMPFTN  TO  FTN-KOH-XXX       
                          IF   FTN-KOH-XXX     >   12000                
                             MOVE   12000   TO   FTN-KOH-XXX            
                          END-IF                                        
                        END-IF                                          
                      END-IF                                            
                 END-IF
      *
               END-IF                                                 
      *
           END-IF.
      *----(01.00.23) LINE ADD END   --------------------------
      *
      *    ∏¯»Ò£±•´•¶•Û•»
           IF  (COMB-KOH1HKNNUM               NOT =   SPACE)  AND
               (COMB-KOH1-GAIJGNKBN           =       "1"  )  AND
               (FLG-ZAITAKU                   =       ZERO )            
               IF        (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM)   OR
                         (LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM)   OR
                         (LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM)   OR
                         (LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM)
                   MOVE   SYU-SRYYMD(7:2)     TO   IDX2X
                   IF    (MAX-KAI-KOHI1-D     NOT = ZERO)  AND
                         (KOHI1-TBL(IDX2)     >=    MAX-KAI-KOHI1-D)
                       CONTINUE
                   ELSE
                       IF  KOHI1-TBL(IDX2)   =  ZERO
                           ADD     1      TO    KOHI1-TBL(IDX2)
                           ADD     1      TO    KOHI1-TBL(32)
                       END-IF
                   END-IF
                   IF        LNK-SYU-SRYYMD(7:2)    =  SYU-SRYYMD(7:2)
                       EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                                    TO  FTN-KOHI1-D
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                                 ADD   SYU-KOH2HKNFTNMONEY
                                                    TO  FTN-KOHI1-D
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                                 ADD   SYU-KOH3HKNFTNMONEY
                                                    TO  FTN-KOHI1-D
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                                 ADD   SYU-KOH4HKNFTNMONEY
                                                    TO  FTN-KOHI1-D
                       END-EVALUATE
                   END-IF
                   EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                   END-EVALUATE
               END-IF
           END-IF.
      *    ∏¯»Ò£≤•´•¶•Û•»
           IF  (COMB-KOH2HKNNUM               NOT = SPACE)   AND
               (COMB-KOH2-GAIJGNKBN           =     "1")     
               IF        (LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM)   OR
                         (LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM)   OR
                         (LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM)   OR
                         (LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM)
                   MOVE   SYU-SRYYMD(7:2)     TO    IDX2X
                   IF    (MAX-KAI-KOHI2-D     NOT = ZERO)  AND
                         (KOHI2-TBL(IDX2)     >=    MAX-KAI-KOHI2-D)
                       CONTINUE
                   ELSE
                       IF  KOHI2-TBL(IDX2)   =  ZERO
                           ADD     1      TO    KOHI2-TBL(IDX2)
                           ADD     1      TO    KOHI2-TBL(32)
                       END-IF
                   END-IF
                   IF        LNK-SYU-SRYYMD(7:2) =  SYU-SRYYMD(7:2)
                       EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                                    TO  FTN-KOHI2-D
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                                 ADD   SYU-KOH2HKNFTNMONEY
                                                    TO  FTN-KOHI2-D
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                                 ADD   SYU-KOH3HKNFTNMONEY
                                                    TO  FTN-KOHI2-D
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                                 ADD   SYU-KOH4HKNFTNMONEY
                                                    TO  FTN-KOHI2-D
                       END-EVALUATE
                   END-IF
                   EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                   END-EVALUATE
               END-IF
           END-IF.
      *    ∏¯»Ò£≥•´•¶•Û•»
           IF  (COMB-KOH3HKNNUM               NOT = SPACE)   AND
               (COMB-KOH3-GAIJGNKBN           =     "1")     
               IF        (LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM)   OR
                         (LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM)   OR
                         (LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM)   OR
                         (LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM)
                   MOVE   SYU-SRYYMD(7:2)     TO    IDX2X
                   IF    (MAX-KAI-KOHI3-D     NOT = ZERO)  AND
                         (KOHI3-TBL(IDX2)     >=    MAX-KAI-KOHI3-D)
                       CONTINUE
                   ELSE
                       IF  KOHI3-TBL(IDX2)   =  ZERO
                           ADD     1      TO    KOHI3-TBL(IDX2)
                           ADD     1      TO    KOHI3-TBL(32)
                       END-IF
                   END-IF
                   IF        LNK-SYU-SRYYMD(7:2)   =   SYU-SRYYMD(7:2)
                       EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                                    TO  FTN-KOHI3-D
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                                 ADD   SYU-KOH2HKNFTNMONEY
                                                    TO  FTN-KOHI3-D
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                                 ADD   SYU-KOH3HKNFTNMONEY
                                                    TO  FTN-KOHI3-D
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                                 ADD   SYU-KOH4HKNFTNMONEY
                                                    TO  FTN-KOHI3-D
                       END-EVALUATE
                   END-IF
                   EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                   END-EVALUATE
               END-IF
           END-IF.
      *    ∏¯»Ò£¥•´•¶•Û•»
           IF  (COMB-KOH4HKNNUM               NOT = SPACE)   AND
               (COMB-KOH4-GAIJGNKBN           =     "1")     
               IF        (LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM)   OR
                         (LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM)   OR
                         (LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM)   OR
                         (LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM)
                   MOVE   SYU-SRYYMD(7:2)     TO    IDX2X
                   IF    (MAX-KAI-KOHI4-D     NOT = ZERO)  AND
                         (KOHI4-TBL(IDX2)     >=    MAX-KAI-KOHI4-D)
                       CONTINUE
                   ELSE
                       IF  KOHI4-TBL(IDX2)   =  ZERO
                           ADD     1      TO    KOHI4-TBL(IDX2)
                           ADD     1      TO    KOHI4-TBL(32)
                       END-IF
                   END-IF
                   IF        LNK-SYU-SRYYMD(7:2)   =  SYU-SRYYMD(7:2)
                       EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                                    TO  FTN-KOHI4-D
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                                 ADD   SYU-KOH2HKNFTNMONEY
                                                    TO  FTN-KOHI4-D
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                                 ADD   SYU-KOH3HKNFTNMONEY
                                                    TO  FTN-KOHI4-D
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                                 ADD   SYU-KOH4HKNFTNMONEY
                                                    TO  FTN-KOHI4-D
                       END-EVALUATE
                   END-IF
                   EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                   END-EVALUATE
               END-IF
           END-IF.
      *
       2201-SYUNOU-COUNT-EXT.
           EXIT.
      *
      ******************************************************************
      *     ›∏±°¶∏¯»Ò§Œ…È√¥∂‚∑◊ªª
      ******************************************************************
       230-FTNKIN-SEC           SECTION.
      *
      *
      *    ªªƒÍ≤ƒ«Ω•’•È•∞§ŒΩÈ¥¸≤Ω
           MOVE     SPACE                  TO     FLG-SANTEI1
                                                  FLG-SANTEI2
                                                  FLG-SANTEI3
                                                  FLG-SANTEI4.
      *
      *    ≤·µÓ§Œ¥µº‘…È√¥≤ÛøÙ§»æÂ∏¬≤ÛøÙ§Œ»Ê≥”
           IF       MAX-KAI-KOHI1-D        NOT =  ZERO
               IF   KAISU-KOHI1-D          >=     MAX-KAI-KOHI1-D
                    MOVE     "1"           TO     FLG-SANTEI1
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI2-D        NOT =  ZERO
               IF   KAISU-KOHI2-D          >=     MAX-KAI-KOHI2-D
                    MOVE     "1"           TO     FLG-SANTEI2
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI3-D        NOT =  ZERO
               IF   KAISU-KOHI3-D          >=     MAX-KAI-KOHI3-D
                    MOVE     "1"           TO     FLG-SANTEI3
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI4-D        NOT =  ZERO
               IF   KAISU-KOHI4-D          >=     MAX-KAI-KOHI4-D
                    MOVE     "1"           TO     FLG-SANTEI4
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI1-M        NOT =  ZERO
               IF   KAISU-KOHI1-M          >=     MAX-KAI-KOHI1-M
                    MOVE     "1"           TO     FLG-SANTEI1
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI2-M        NOT =  ZERO
               IF   KAISU-KOHI2-M          >=     MAX-KAI-KOHI2-M
                    MOVE     "1"           TO     FLG-SANTEI2
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI3-M        NOT =  ZERO
               IF   KAISU-KOHI3-M          >=     MAX-KAI-KOHI3-M
                    MOVE     "1"           TO     FLG-SANTEI3
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI4-M        NOT =  ZERO
               IF   KAISU-KOHI4-M          >=     MAX-KAI-KOHI4-M
                    MOVE     "1"           TO     FLG-SANTEI4
               END-IF
           END-IF.
      *
      *    ≤·µÓ§Œ¥µº‘ ›∏±…È√¥Œﬂ∑◊≥€§»æÂ∏¬∂‚≥€§Œ»Ê≥”
      *
           IF       MAX-KIN-KOHI1-D        NOT =  ZERO
               IF   FTN-KOHI1-D            >=     MAX-KIN-KOHI1-D
                    MOVE     "1"           TO     FLG-SANTEI1
               END-IF
           END-IF.
           IF       MAX-KIN-KOHI2-D        NOT =  ZERO
               IF   FTN-KOHI2-D            >=     MAX-KIN-KOHI2-D
                    MOVE     "1"           TO     FLG-SANTEI2
               END-IF
           END-IF.
           IF       MAX-KIN-KOHI3-D        NOT =  ZERO
               IF   FTN-KOHI3-D            >=     MAX-KIN-KOHI3-D
                    MOVE     "1"           TO     FLG-SANTEI3
               END-IF
           END-IF.
           IF       MAX-KIN-KOHI4-D        NOT =  ZERO
               IF   FTN-KOHI4-D            >=     MAX-KIN-KOHI4-D
                    MOVE     "1"           TO     FLG-SANTEI4
               END-IF
           END-IF.
      *
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘
      *
           IF   LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
               IF  MAX-KIN-SYU-M           NOT =  ZERO
                   IF  FTN-SYU-M           >=     MAX-KIN-SYU-M
                       MOVE  "1"           TO     FLG-SANTEI-SYU
                   END-IF
               END-IF
           END-IF.
      *----(01.00.23) LINE ADD END   --------------------------
           IF       MAX-KIN-KOHI1-M        NOT =  ZERO
               IF   FTN-KOHI1-M            >=     MAX-KIN-KOHI1-M
                    MOVE     "1"           TO     FLG-SANTEI1
               END-IF
           END-IF.
           IF       MAX-KIN-KOHI2-M        NOT =  ZERO
               IF   FTN-KOHI2-M            >=     MAX-KIN-KOHI2-M
                    MOVE     "1"           TO     FLG-SANTEI2
               END-IF
           END-IF.
           IF       MAX-KIN-KOHI3-M        NOT =  ZERO
               IF   FTN-KOHI3-M            >=     MAX-KIN-KOHI3-M
                    MOVE     "1"           TO     FLG-SANTEI3
               END-IF
           END-IF.
           IF       MAX-KIN-KOHI4-M        NOT =  ZERO
               IF   FTN-KOHI4-M            >=     MAX-KIN-KOHI4-M
                    MOVE     "1"           TO     FLG-SANTEI4
               END-IF
           END-IF.
      *
      *     ›∏±° ∏¯»Ò°À•∆°º•÷•Î§Œ¥µº‘…È√¥æÂ∏¬≥€§»≈ˆ∑Ó§Œ¥µº‘…È√¥Œﬂ∑◊≥€
      *    §´§ÈªªƒÍ≤ƒ«Ωªƒ≥€§ÚªªΩ–§π§Î
      *
           IF  FLG-SANTEI1               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI1-D
           ELSE
               IF (COMB-KOH1HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH1-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI1-D       NOT = ZERO
                       IF   FTN-KOHI1-D           >=  MAX-KIN-KOHI1-D
                            MOVE     ZERO         TO  ZAN-KOHI1-D
                       ELSE
                            COMPUTE  ZAN-KOHI1-D  =   MAX-KIN-KOHI1-D -
                                                      FTN-KOHI1-D
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI2               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI2-D
           ELSE
               IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH2-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI2-D       NOT = ZERO
                       IF   FTN-KOHI2-D           >=  MAX-KIN-KOHI2-D
                            MOVE     ZERO         TO  ZAN-KOHI2-D
                       ELSE
                            COMPUTE  ZAN-KOHI2-D  =   MAX-KIN-KOHI2-D -
                                                      FTN-KOHI2-D
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI3               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI3-D
           ELSE
               IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH3-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI3-D       NOT = ZERO
                       IF   FTN-KOHI3-D           >=  MAX-KIN-KOHI3-D
                            MOVE     ZERO         TO  ZAN-KOHI3-D
                       ELSE
                            COMPUTE  ZAN-KOHI3-D  =   MAX-KIN-KOHI3-D -
                                                      FTN-KOHI3-D
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI4               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI4-D
           ELSE
               IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH4-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI4-D       NOT = ZERO
                       IF   FTN-KOHI4-D           >=  MAX-KIN-KOHI4-D
                            MOVE     ZERO         TO  ZAN-KOHI4-D
                       ELSE
                            COMPUTE  ZAN-KOHI4-D  =   MAX-KIN-KOHI4-D -
                                                      FTN-KOHI4-D
                       END-IF
                   END-IF
               END-IF
           END-IF.
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘
      *
           IF   LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
               IF  FLG-SANTEI-SYU            =   "1"                  
                       MOVE  ZERO        TO      ZAN-SYU-M            
               ELSE                                                   
                   IF  FTN-SYU-M         >=    MAX-KIN-SYU-M          
                       MOVE  ZERO        TO      ZAN-SYU-M
                   ELSE
                       COMPUTE  ZAN-SYU-M  =   MAX-KIN-SYU-M  -
                                               FTN-SYU-M
                   END-IF
               END-IF
           END-IF.
      *----(01.00.23) LINE ADD END   --------------------------
           IF  FLG-SANTEI1               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI1-M
           ELSE
               IF (COMB-KOH1HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH1-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI1-M       NOT = ZERO
                       IF   FTN-KOHI1-M           >=  MAX-KIN-KOHI1-M
                            MOVE     ZERO         TO  ZAN-KOHI1-M
                       ELSE
                            COMPUTE  ZAN-KOHI1-M  =   MAX-KIN-KOHI1-M -
                                                      FTN-KOHI1-M
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI2               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI2-M
           ELSE
               IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH2-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI2-M       NOT = ZERO
                       IF   FTN-KOHI2-M           >=  MAX-KIN-KOHI2-M
                            MOVE     ZERO         TO  ZAN-KOHI2-M
                       ELSE
                            COMPUTE  ZAN-KOHI2-M  =   MAX-KIN-KOHI2-M -
                                                      FTN-KOHI2-M
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI3               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI3-M
           ELSE
               IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH3-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI3-M       NOT = ZERO
                       IF   FTN-KOHI3-M           >=  MAX-KIN-KOHI3-M
                            MOVE     ZERO         TO  ZAN-KOHI3-M
                       ELSE
                            COMPUTE  ZAN-KOHI3-M  =   MAX-KIN-KOHI3-M -
                                                      FTN-KOHI3-M
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI4               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI4-M
           ELSE
               IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH4-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI4-M       NOT = ZERO
                       IF   FTN-KOHI4-M           >=  MAX-KIN-KOHI4-M
                            MOVE     ZERO         TO  ZAN-KOHI4-M
                       ELSE
                            COMPUTE  ZAN-KOHI4-M  =   MAX-KIN-KOHI4-M -
                                                      FTN-KOHI4-M
                       END-IF
                   END-IF
               END-IF
           END-IF.
      *
      *    ∆¸§Œ¥µº‘…È√¥≤ƒ«Ωªƒ≥€§»∑Ó§Œ¥µº‘…È√¥≤ƒ«Ωªƒ≥€§Ú»Ê≥”§∑§∆
      *    √Õ§ŒæÆ§µ§§§€§¶§Ú•ª•√•»§π§Î
           IF (COMB-KOH1HKNNUM              NOT = SPACE)    AND
              (COMB-KOH1-GAIJGNKBN          =     "1")
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)
                     IF    ZAN-KOHI1-D            >    ZAN-KOHI1-M
                           MOVE   ZAN-KOHI1-M     TO   ZAN-KOHI1
                     ELSE
                           MOVE   ZAN-KOHI1-D     TO   ZAN-KOHI1
                     END-IF
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI1-M   =       ZERO)
                           MOVE   ZAN-KOHI1-D     TO   ZAN-KOHI1
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)
                           MOVE   ZAN-KOHI1-M     TO   ZAN-KOHI1
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND
                         (MAX-KIN-KOHI1-M   =       ZERO)
                           MOVE   ZERO            TO   ZAN-KOHI1
               END-EVALUATE
           END-IF.
      *
           IF (COMB-KOH2HKNNUM              NOT = SPACE)    AND
              (COMB-KOH2-GAIJGNKBN          =     "1")
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI2-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI2-M   NOT =   ZERO)
                     IF    ZAN-KOHI2-D            >    ZAN-KOHI2-M
                           MOVE   ZAN-KOHI2-M     TO   ZAN-KOHI2
                     ELSE
                           MOVE   ZAN-KOHI2-D     TO   ZAN-KOHI2
                     END-IF
                   WHEN  (MAX-KIN-KOHI2-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI2-M   =       ZERO)
                           MOVE   ZAN-KOHI2-D     TO   ZAN-KOHI2
                   WHEN  (MAX-KIN-KOHI2-D   =       ZERO)   AND
                         (MAX-KIN-KOHI2-M   NOT =   ZERO)
                           MOVE   ZAN-KOHI2-M     TO   ZAN-KOHI2
                   WHEN  (MAX-KIN-KOHI2-D   =       ZERO)   AND
                         (MAX-KIN-KOHI2-M   =       ZERO)
                           MOVE   ZERO            TO   ZAN-KOHI2
               END-EVALUATE
           END-IF.
      *
           IF (COMB-KOH3HKNNUM              NOT = SPACE)    AND
              (COMB-KOH3-GAIJGNKBN          =     "1")
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI3-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI3-M   NOT =   ZERO)
                     IF    ZAN-KOHI3-D            >    ZAN-KOHI3-M
                           MOVE   ZAN-KOHI3-M     TO   ZAN-KOHI3
                     ELSE
                           MOVE   ZAN-KOHI3-D     TO   ZAN-KOHI3
                     END-IF
                   WHEN  (MAX-KIN-KOHI3-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI3-M   =       ZERO)
                           MOVE   ZAN-KOHI3-D     TO   ZAN-KOHI3
                   WHEN  (MAX-KIN-KOHI3-D   =       ZERO)   AND
                         (MAX-KIN-KOHI3-M   NOT =   ZERO)
                           MOVE   ZAN-KOHI3-M     TO   ZAN-KOHI3
                   WHEN  (MAX-KIN-KOHI3-D   =       ZERO)   AND
                         (MAX-KIN-KOHI3-M   =       ZERO)
                           MOVE   ZERO            TO   ZAN-KOHI3
               END-EVALUATE
           END-IF.
      *
           IF (COMB-KOH4HKNNUM              NOT = SPACE)    AND
              (COMB-KOH4-GAIJGNKBN          =     "1")
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI4-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI4-M   NOT =   ZERO)
                     IF    ZAN-KOHI4-D            >    ZAN-KOHI4-M
                           MOVE   ZAN-KOHI4-M     TO   ZAN-KOHI4
                     ELSE
                           MOVE   ZAN-KOHI4-D     TO   ZAN-KOHI4
                     END-IF
                   WHEN  (MAX-KIN-KOHI4-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI4-M   =       ZERO)
                           MOVE   ZAN-KOHI4-D     TO   ZAN-KOHI4
                   WHEN  (MAX-KIN-KOHI4-D   =       ZERO)   AND
                         (MAX-KIN-KOHI4-M   NOT =   ZERO)
                           MOVE   ZAN-KOHI4-M     TO   ZAN-KOHI4
                   WHEN  (MAX-KIN-KOHI4-D   =       ZERO)   AND
                         (MAX-KIN-KOHI4-M   =       ZERO)
                           MOVE   ZERO            TO   ZAN-KOHI4
               END-EVALUATE
           END-IF.
      *
      *     ›∏±°¶∏¯»ÒÀË§Œ¥µº‘…È√¥∂‚≥€§Œ∑◊ªª
           IF    ((COMB-KOH1-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH1HKNNUM           =   "027")) OR 
                 ((COMB-KOH2-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH2HKNNUM           =   "027")) OR 
                 ((COMB-KOH3-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH3HKNNUM           =   "027")) OR 
                 ((COMB-KOH4-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH4HKNNUM           =   "027")) 
                  CONTINUE
           ELSE
               IF    COMB-HKNNUM             NOT =       SPACE
                  PERFORM    2301-SYUHOKEN-KEISAN-SEC
               END-IF
           END-IF.
      *
      *----(2002/03/13  éÕé›é∫é≥)---------------------------------------
      *
           MOVE     ZERO     TO     WK-TOKUTEI-COMPFTN3.
      *
           PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                      UNTIL    (KOH-IDX    >      4)
               IF   COMB-KOHHKNNUM(KOH-IDX)  NOT =  SPACE
                    PERFORM    2302-KOH-HKNREAD-SEC
                    IF   COMB-KOH-GAIJGNKBN(KOH-IDX)  =  "1"
                         PERFORM   2303-KOH-KEISAN-SEC
                    ELSE
                         PERFORM   2304-KOH-KEISAN-SEC
                    END-IF
           END-PERFORM.
      *-------------------------------------------------------------
      *
      *     ∏¯»Ò√±∞Ã§«∑◊ªª§∑§ø¥µº‘…È√¥∂‚≥€§´§È∫«æÆ§Œ√Õ§Ú¡™¬Ú•ª•√•»
            PERFORM   2314-FTNKIN-HIKAKU-SEC.
      *
       230-FTNKIN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ºÁ ›∏±§Œ¥µº‘…È√¥∂‚≥€∑◊ªª                                *
      ******************************************************************
       2301-SYUHOKEN-KEISAN-SEC           SECTION.
      *
      *    ≥∫≈ˆ ›∏±»÷πÊ•∆°º•÷•Î§Œ∏°∫˜
           INITIALIZE                      HKNNUM-REC.
           MOVE   COMB-HOSPID        TO    HKN-HOSPID.
           MOVE   COMB-HKNNUM        TO    HKN-HKNNUM.
           MOVE   "00"               TO    WK-PAYKBN.
           MOVE   HKNNUM-REC         TO    MCPDATA-REC.
           MOVE   "DBSELECT"         TO    MCP-FUNC.
           MOVE   "HKNNUM-KEY2"      TO    ORC-DBPATH.
           CALL   "ORCMCPSUB"         USING MCPAREA
                                            ORCMCPAREA
                                            MCPDATA-REC.
           IF      MCP-RC            =     ZERO
               MOVE    "HKNNUM-KEY2" TO    ORC-DBPATH
               PERFORM  HKNNUM-READ-SEC
               PERFORM  UNTIL
                 (FLG-HKNNUM     =    1)                       OR
                ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                 (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6))   AND
                 (WK-PAYKBN            =  HKN-PAYKBN))
                   PERFORM   HKNNUM-READ-SEC
               END-PERFORM
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "HKNNUM-KEY2"        TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *
      *     ›∏±¡»πÁ§ª•∆°º•÷•Î§Œ ‰Ωı∂Ë ¨§´§È¥µº‘§Œ…È√¥≥‰πÁ§Ú ›∏±»÷πÊ
      *    •∆°º•÷•Î§À∫∆•ª•√•»° πÒ ›§Œ§ﬂ°À
           IF    COMB-HKNNUM           =    "060"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "0"
                          MOVE   ZERO      TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "1"
                          MOVE   10        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "2"
                          MOVE   20        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "3"
                          MOVE   30        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
      *----(01.00.20) LINE ADD START --------------------------
      *    ∑Ú ›§Œπ‚Œº‘§À§ƒ§§§∆§‚ ‰Ωı∂Ë ¨§Ë§Í…È√¥≥‰πÁ•ª•√•»
           ELSE
               EVALUATE   COMB-HOJOKBN
                   WHEN   "9"
                          MOVE   10        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "8"
                          MOVE   20        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
      *----(01.00.20) LINE ADD END   --------------------------
           END-IF.
      *
      *----(01.00.21) LINE ADD START --------------------------
      *    «ØŒ£≥∫–Ã§À˛
           IF      LNK-SYU-SRYYMD       >=      "20021001"
               INITIALIZE                           PTINF-REC
               MOVE    LNK-SYU-HOSPID       TO      PTINF-HOSPID
               MOVE    LNK-SYU-PTID         TO      PTINF-PTID
               MOVE    PTINF-REC            TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "PTINF-KEY"          TO      ORC-DBPATH
               CALL    "ORCMCPSUB"           USING   MCPAREA
                                                     ORCMCPAREA
                                                     MCPDATA-REC
               IF      MCP-RC               =       ZERO
                   MOVE    "PTINF-KEY"      TO      ORC-DBPATH
                   PERFORM  PTINF-READ-SEC
                   IF       MCP-RC          =       ZERO
                        MOVE   PTINF-BIRTHDAY   TO  WRK-YMDS1
                        MOVE   LNK-SYU-SRYYMD   TO  WRK-YMDS2
                        MOVE   ZERO             TO  WRK-NENREI
                        COMPUTE  WRK-NENREI     =   WRK-YYS2
                                                -   WRK-YYS1
                        IF   WRK-YMDS1(5:4)     >   WRK-YMDS2(5:4)
                             ADD   -1           TO  WRK-NENREI
                        END-IF
                        IF   WRK-NENREI         =   3
                        AND  WRK-YMDS1(5:4)    <=   WRK-YMDS2(5:4)
                            IF    WRK-YMDS1(5:2)  = WRK-YMDS2(5:2)
                                  IF   WRK-YMDS1(7:2)  NOT = "01"
                                       ADD   -1     TO  WRK-NENREI
                                  END-IF
                            END-IF
                        END-IF
                   ELSE
                        DISPLAY  "PTINF FETCH ERR"
                        MOVE     ZERO   TO      WRK-NENREI
                   END-IF
               ELSE
                   DISPLAY   "PTINF SELECT ERR"
                   MOVE     ZERO   TO      WRK-NENREI
               END-IF
      *
               MOVE    "DBCLOSE"            TO  MCP-FUNC
               MOVE    "PTINF-KEY"          TO  ORC-DBPATH
               CALL    "ORCMCPSUB"           USING
                                             MCPAREA
                                             ORCMCPAREA
                                             MCPDATA-REC
      *
               IF      WRK-NENREI         <     3
                   IF   COMB-HKNNUM       =     "060"
                       IF   COMB-HOJOKBN  =     "0"  OR  "1"
                           CONTINUE
                       ELSE
                           MOVE   20      TO   HKN-HON-GAIKFTNRATE
                                               HKN-KZK-GAIKFTNRATE
                                               HKN-TSY-GAIKFTNRATE
                                               HKN-TNK-GAIKFTNRATE
                       END-IF
                   ELSE
                       IF    HKN-HKNKOHSBTKBN  =  "1" 
                           MOVE   20      TO   HKN-HON-GAIKFTNRATE
                                               HKN-KZK-GAIKFTNRATE
                                               HKN-TSY-GAIKFTNRATE
                                               HKN-TNK-GAIKFTNRATE
                       END-IF 
                   END-IF
               END-IF
           END-IF.
      *----(01.00.21) LINE ADD END   --------------------------
      *
      *     ›∏±¡»πÁ§ª•∆°º•÷•Î§Œ ‰Ωı∂Ë ¨§´§È¥µº‘§Œ…È√¥≥‰πÁ§Ú ›∏±»÷πÊ
      *    •∆°º•÷•Î§À∫∆•ª•√•»° ¡•∞˜ ›∏±ª˛°À
           IF    COMB-HKNNUM           =    "002"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "1"
                   WHEN   "2"
                   WHEN   "3"
                   WHEN   "A"
                   WHEN   "B"
                   WHEN   "C"
                   WHEN   "D"
                   WHEN   "E"
                   WHEN   "F"
                          MOVE   ZERO      TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
           END-IF.
      *     ›∏±¡»πÁ§ª•∆°º•÷•Î§Œ ‰Ωı∂Ë ¨§´§È¥µº‘§Œ…È√¥≥‰πÁ§Ú ›∏±»÷πÊ
      *    •∆°º•÷•Î§À∫∆•ª•√•»° ∂¶∫—¡»πÁ ›∏±ª˛°À
           IF    COMB-HKNNUM    =    "031" OR "032" OR "033" OR "034"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "2"
                   WHEN   "B"
                   WHEN   "E"  
                          MOVE   ZERO      TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
           END-IF.
      *
      *    ° £◊£À°›£»£À£Œ£À£¬£Œ°°∂ı«Ú°ß∞Â ›°°£±°ßœ´∫“°°£≤°ßº´«Â¿’°À
           EVALUATE   WK-HKNKBN
             WHEN   SPACE
      *    …È√¥∂‚≥€§Œ∑◊ªª
      ***      EVALUATE   FLG-SANSHOU
      ***        WHEN   "1"
                   IF   COMB-HONKZKKBN        =   "1"
                        IF    HKN-HON-GAIKFTNRATE     NOT =    ZERO
                              COMPUTE   WK-FUTANWARI  =
                                        HKN-HON-GAIKFTNRATE  /  100
                              COMPUTE   LNK-SYU-SYUCOMPFTN  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN2
                              COMPUTE   LNK-SYU-SYUCOMPFTN =
                                        LNK-SYU-SYUCOMPFTN  +  5
                              COMPUTE   WK-FTN      =
                                        LNK-SYU-SYUCOMPFTN  /  10
                              COMPUTE   LNK-SYU-SYUCOMPFTN =
                                        WK-FTN   *  10
                        END-IF
                        MOVE  HKN-HON-GAIYKZFTNKBN
                                             TO   LNK-SYU-SYUYKZFTNKBN
                        IF    HKN-HON-GAIYKZFTNKBN  NOT =  "0"
                            MOVE  YAKFTN-SOGOKEI
                                             TO   LNK-SYU-SYUCOMPYKZFTN
                            IF    HKN-HON-GAIYKZFTNKBN  =  "1"
                                  MOVE  YAKFTN-SOGOKEI
                                             TO   WK-SYU-YAKFTN
                            END-IF
                        END-IF
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘
      *
                        IF   LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
                            IF  ZAN-SYU-M     <     WK-TOKUTEI-COMPFTN2 
                                MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
                                                     WK-TOKUTEI-COMPFTN 
                            ELSE                                        
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                            END-IF
                        ELSE
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                        END-IF
      *----(01.00.23) LINE ADD END   --------------------------
                        COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                                  LNK-SYU-SYUCOMPFTN     +
                                  LNK-SYU-SYUCOMPYKZFTN
                   ELSE
                        IF    HKN-KZK-GAIKFTNRATE     NOT =    ZERO
                              COMPUTE   WK-FUTANWARI  =
                                        HKN-KZK-GAIKFTNRATE  /  100
                              COMPUTE   LNK-SYU-SYUCOMPFTN  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN2
                              COMPUTE   LNK-SYU-SYUCOMPFTN =
                                        LNK-SYU-SYUCOMPFTN  +  5
                              COMPUTE   WK-FTN      =
                                        LNK-SYU-SYUCOMPFTN  /  10
                              COMPUTE   LNK-SYU-SYUCOMPFTN =
                                        WK-FTN   *  10
                        END-IF
                        MOVE  HKN-KZK-GAIYKZFTNKBN
                                             TO   LNK-SYU-SYUYKZFTNKBN
                        IF    HKN-KZK-GAIYKZFTNKBN  NOT =  "0"
                            MOVE  YAKFTN-SOGOKEI
                                             TO   LNK-SYU-SYUCOMPYKZFTN
                            IF    HKN-KZK-GAIYKZFTNKBN  =  "1"
                                  MOVE  YAKFTN-SOGOKEI
                                             TO   WK-SYU-YAKFTN
                            END-IF
                        END-IF
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘
      *
                        IF   LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
                            IF  ZAN-SYU-M     <     WK-TOKUTEI-COMPFTN2 
                                MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
                                                     WK-TOKUTEI-COMPFTN 
                            ELSE                                        
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                            END-IF
                        ELSE
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                        END-IF
      *----(01.00.23) LINE ADD END   --------------------------
                        COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                                  LNK-SYU-SYUCOMPFTN     +
                                  LNK-SYU-SYUCOMPYKZFTN
                   END-IF
      ***        WHEN   "2"
      ***          IF    HKN-TSY-GAIKFTNRATE     NOT =    ZERO
      ***                COMPUTE   WK-FUTANWARI  =
      ***                          HKN-TSY-GAIKFTNRATE  /  100
      ***                COMPUTE   LNK-SYU-SYUCOMPFTN  =
      ***                          WK-ZENGAKU   *  WK-FUTANWARI
      ***                MOVE      LNK-SYU-SYUCOMPFTN
      ***                                    TO WK-TOKUTEI-COMPFTN2
      ***                COMPUTE   LNK-SYU-SYUCOMPFTN =
      ***                          LNK-SYU-SYUCOMPFTN  +  5
      ***                COMPUTE   WK-FTN      =
      ***                          LNK-SYU-SYUCOMPFTN  /  10
      ***                COMPUTE   LNK-SYU-SYUCOMPFTN =
      ***                          WK-FTN   *  10
      ***          END-IF
      ***          MOVE  HKN-TSY-GAIYKZFTNKBN
      ***                               TO   LNK-SYU-SYUYKZFTNKBN
      ***          IF    HKN-TSY-GAIYKZFTNKBN  NOT =  "0"
      ***              MOVE  YAKFTN-SOGOKEI
      ***                               TO   LNK-SYU-SYUCOMPYKZFTN
      ***          END-IF
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘
      *
      ***          IF   LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
      ***              IF  ZAN-SYU-M     <     WK-TOKUTEI-COMPFTN2      
      ***                  MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
      ***                                       WK-TOKUTEI-COMPFTN      
      ***              ELSE                                             
      ***                  MOVE WK-TOKUTEI-COMPFTN2                     
      ***                                        TO  WK-TOKUTEI-COMPFTN 
      ***              END-IF
      ***          ELSE
      ***                  MOVE WK-TOKUTEI-COMPFTN2              
      ***                                        TO  WK-TOKUTEI-COMPFTN 
      ***          END-IF
      *----(01.00.23) LINE ADD END   --------------------------
      ***          COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
      ***                    LNK-SYU-SYUCOMPFTN     +
      ***                    LNK-SYU-SYUCOMPYKZFTN
      ***        WHEN   "3"
      ***          IF    HKN-TNK-GAIKFTNRATE     NOT =    ZERO
      ***                COMPUTE   WK-FUTANWARI  =
      ***                          HKN-TNK-GAIKFTNRATE  /  100
      ***                COMPUTE   LNK-SYU-SYUCOMPFTN  =
      ***                          WK-ZENGAKU   *  WK-FUTANWARI
      ***                MOVE      LNK-SYU-SYUCOMPFTN
      ***                                   TO WK-TOKUTEI-COMPFTN2
      ***                COMPUTE   LNK-SYU-SYUCOMPFTN =
      ***                          LNK-SYU-SYUCOMPFTN  +  5
      ***                COMPUTE   WK-FTN      =
      ***                          LNK-SYU-SYUCOMPFTN  /  10
      ***                COMPUTE   LNK-SYU-SYUCOMPFTN =
      ***                          WK-FTN   *  10
      ***          END-IF
      ***          MOVE  HKN-TNK-GAIYKZFTNKBN
      ***                               TO   LNK-SYU-SYUYKZFTNKBN
      ***          IF    HKN-TNK-GAIYKZFTNKBN  NOT =  "0"
      ***              MOVE  YAKFTN-SOGOKEI
      ***                               TO   LNK-SYU-SYUCOMPYKZFTN
      ***          END-IF
      *----(01.00.23) LINE ADD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘
      *
      ***          IF   LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
      ***              IF  ZAN-SYU-M     <     WK-TOKUTEI-COMPFTN2      
      ***                  MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
      ***                                       WK-TOKUTEI-COMPFTN      
      ***              ELSE                                             
      ***                  MOVE WK-TOKUTEI-COMPFTN2                     
      ***                                        TO  WK-TOKUTEI-COMPFTN 
      ***              END-IF
      ***          ELSE
      ***                  MOVE WK-TOKUTEI-COMPFTN2                
      ***                                        TO  WK-TOKUTEI-COMPFTN 
      ***          END-IF
      *----(01.00.23) LINE ADD END   --------------------------
      ***          COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
      ***                    LNK-SYU-SYUCOMPFTN     +
      ***                    LNK-SYU-SYUCOMPYKZFTN
      ***      END-EVALUATE
             WHEN   "1"
      *        •∑•π•∆•‡¥…Õ˝•ﬁ•π•ø° £¥£∞£∞£±°À§´§È≈¿øÙ√±≤¡§ŒºË∆¿
               INITIALIZE                         SYS-4001-REC
               MOVE    "4001"               TO    SYS-4001-KANRICD
               MOVE    "*"                  TO    SYS-4001-KBNCD
               MOVE    LNK-SYU-SRYYMD       TO    ORC-DBYMD
               MOVE    SYS-4001-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "SYSKANRI-KEY"       TO    ORC-DBPATH
               CALL    "ORCMCPSUB"    USING       MCPAREA
                                                  ORCMCPAREA
                                                  MCPDATA-REC
               IF      MCP-RC               =     ZERO
                   MOVE     "SYSKANRI-KEY"  TO    ORC-DBPATH
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
      *----(01.00.19) LINE ADD START --------------------------
                     IF    SYS-4001-KSNRATE(1:2)   =    SPACE
                            MOVE     100        TO   WK-KSNRATE9
                            COMPUTE  WK-KSNRATE   =  WK-KSNRATE9  /  100
                     ELSE
                            COMPUTE  WK-KSNRATE9  =  SYS-4001-KSNRATE
                                                  +  100 
                            COMPUTE  WK-KSNRATE   =  WK-KSNRATE9  /  100
                     END-IF  
      *----(01.00.19) LINE ADD END   --------------------------
                     IF     LNK-SYU-SYUHKNNUM       =  "971"
                       EVALUATE  SYS-4001-TENKBN
                           WHEN  "1"
                               COMPUTE  WK-ZENGAKU  =  
                                        WK-ZENGAKU  / 10 * 11.5
                           WHEN  "2"
                               COMPUTE  WK-ZENGAKU  =  
                                        WK-ZENGAKU  / 10 * 12.0
                       END-EVALUATE
                     ELSE
      *----(01.00.19) LINE ADD START --------------------------
                       EVALUATE  SYS-4001-TENKBN
                           WHEN  "1"
                              COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  /  10  
                              MOVE  LNK-S01-SYUTEN  TO  WK-ZENGAKU-SYU
                              COMPUTE  WK-ZENGAKU-YAK = WK-ZENGAKU 
                                                      - LNK-S01-SYUTEN
                              COMPUTE  WK-ZENGAKU-SYU = WK-ZENGAKU-SYU
                                                      * 11.5
                              COMPUTE  WK-ZENGAKU-SYU = WK-ZENGAKU-SYU
                                                      * WK-KSNRATE
                              COMPUTE  WK-ZENGAKU-YAK = WK-ZENGAKU-YAK
                                                      * 11.5
                              COMPUTE  WK-ZENGAKU     = WK-ZENGAKU-SYU
                                                      + WK-ZENGAKU-YAK
                           WHEN  "2"
                              COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  /  10  
                              MOVE  LNK-S01-SYUTEN  TO  WK-ZENGAKU-SYU
                              COMPUTE  WK-ZENGAKU-YAK = WK-ZENGAKU 
                                                      - LNK-S01-SYUTEN
                              COMPUTE  WK-ZENGAKU-SYU = WK-ZENGAKU-SYU
                                                      * 12.0
                              COMPUTE  WK-ZENGAKU-SYU = WK-ZENGAKU-SYU
                                                      * WK-KSNRATE
                              COMPUTE  WK-ZENGAKU-YAK = WK-ZENGAKU-YAK
                                                      * 12.0
                              COMPUTE  WK-ZENGAKU     = WK-ZENGAKU-SYU
                                                      + WK-ZENGAKU-YAK
                       END-EVALUATE
      *----(01.00.19) LINE ADD END   --------------------------
                     END-IF 
                   END-IF
               END-IF
      *
               MOVE    "DBCLOSE"            TO  MCP-FUNC
               MOVE    "SYSKANRI-KEY"       TO  ORC-DBPATH
               CALL    "ORCMCPSUB"           USING
                                             MCPAREA
                                             ORCMCPAREA
                                             MCPDATA-REC
      *
               COMPUTE   WK-FUTANWARI  =
                         HKN-HON-GAIKFTNRATE  /  100
               COMPUTE   LNK-SYU-SYUCOMPFTN  =
                         WK-ZENGAKU   *  WK-FUTANWARI
      *         COMPUTE   LNK-SYU-SYUCOMPFTN =
      *                   LNK-SYU-SYUCOMPFTN  +  5
      *         COMPUTE   WK-FTN      =
      *                   LNK-SYU-SYUCOMPFTN  /  10
      *         COMPUTE   LNK-SYU-SYUCOMPFTN =
      *                   WK-FTN   *  10
               MOVE  HKN-HON-GAIYKZFTNKBN
                                   TO   LNK-SYU-SYUYKZFTNKBN
               IF    HKN-HON-GAIYKZFTNKBN  NOT =  "0"
                     MOVE  YAKFTN-SOGOKEI
                                   TO   LNK-SYU-SYUCOMPYKZFTN
               IF    HKN-HON-GAIYKZFTNKBN  =  "1"
                     MOVE  YAKFTN-SOGOKEI
                                   TO   WK-SYU-YAKFTN
               END-IF
               COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                         LNK-SYU-SYUCOMPFTN     +
                         LNK-SYU-SYUCOMPYKZFTN
           END-EVALUATE.
      *
       2301-SYUHOKEN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ∏¯»Ò§Œ ›∏±»÷πÊ•∆°º•÷•Î∏°∫˜                              *
      ******************************************************************
       2302-KOH-HKNREAD-SEC           SECTION.
      *
      *    ≥∫≈ˆ ›∏±»÷πÊ•∆°º•÷•Î§Œ∏°∫˜
           INITIALIZE                      HKNNUM-REC.
           MOVE   COMB-HOSPID        TO    HKN-HOSPID.
           MOVE   COMB-KOHHKNNUM(KOH-IDX)
                                     TO    HKN-HKNNUM.
      *----(01.00.22) LINE MOD START --------------------------
           IF     COMB-KOHHKNNUM(KOH-IDX)  =     "027"
               IF   LNK-SYU-SRYYMD    >=   "20021001"
                  MOVE     COMB-KOH1PAYKBN     TO  WK-PAYKBN
               ELSE
                  MOVE     SYS-1001-HOSPSBT    TO  WK-PAYKBN(1:1)
                  MOVE     SYS-1001-ROUPAYKBN  TO  WK-PAYKBN(2:1)
               END-IF
           ELSE
                   MOVE     "00"         TO    WK-PAYKBN
           END-IF.
      *----(01.00.22) LINE MOD END   --------------------------
           MOVE   HKNNUM-REC         TO    MCPDATA-REC.
           MOVE   "DBSELECT"         TO    MCP-FUNC.
           MOVE   "HKNNUM-KEY2"      TO    ORC-DBPATH.
           CALL   "ORCMCPSUB"         USING MCPAREA
                                            ORCMCPAREA
                                            MCPDATA-REC.
           IF      MCP-RC            =     ZERO
               MOVE    "HKNNUM-KEY2" TO    ORC-DBPATH
               PERFORM  HKNNUM-READ-SEC
               PERFORM  UNTIL
                 (FLG-HKNNUM     =    1)                       OR
                ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                 (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6))   AND
                 (WK-PAYKBN            =  HKN-PAYKBN))
                   PERFORM   HKNNUM-READ-SEC
               END-PERFORM
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "HKNNUM-KEY2"        TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
           MOVE       ZERO                TO   WK-GAIKFTNRATE.
           MOVE       SPACE               TO   WK-GAIYKZFTNKBN.
           EVALUATE   FLG-SANSHOU2
               WHEN   "1"
                   MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                   MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
               WHEN   "2"
                   MOVE    HKN-TSY-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                   MOVE    HKN-TSY-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
               WHEN   "3"
                   MOVE    HKN-TNK-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                   MOVE    HKN-TNK-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
           END-EVALUATE.
      *
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "027"
                   MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                   MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
           END-IF.
      *
       2302-KOH-HKNREAD-EXT.
           EXIT.
      *
      ******************************************************************
      *        ∏¯»Ò§Œ¥µº‘…È√¥∂‚≥€∑◊ªª° æÂ∏¬≥€§¢§Í°À                    *
      ******************************************************************
       2303-KOH-KEISAN-SEC           SECTION.
      *
      *    …È√¥∂‚≥€§Œ∑◊ªª
           IF  WK-GAIKFTNRATE     NOT =    ZERO
               COMPUTE   WK-FUTANWARI  =
                              WK-GAIKFTNRATE  /  100
               COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                         WK-ZENGAKU   *  WK-FUTANWARI
               IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"           
                    MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)                 
                                            TO WK-TOKUTEI-COMPFTN3      
               END-IF                                                   
               IF ((HKN-HKNKOHSBTKBN     =       "3")    AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX)  NOT =  "027")) OR
                  ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "051" ) OR
                  ( HKN-RECEFTNDSPKBN            =      "2"   )
                   CONTINUE
               ELSE
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  / 10
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             WK-FTN   *  10
               END-IF
               IF  ( LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" )                
               OR  ( FLG-KOUREI-KBN               =   "1" )
                IF    LNK-SYU-KOH-HKNNUM(KOH-IDX)  NOT =  "027"         
                  COMPUTE  FTN-KOH-YYY  =  12000  -  FTN-KOH-XXX        
                  IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)  >  FTN-KOH-YYY      
                    MOVE  FTN-KOH-YYY TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)  
                  END-IF                                                
                END-IF                                                  
               END-IF                                                   
               PERFORM    KOHHI-HIKAKU-SEC
               IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)   >
                                            ZAN-KOHI-T(KOH-IDX)
                     MOVE   ZAN-KOHI-T(KOH-IDX)   TO
                                          LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     MOVE   ZERO        TO  ZAN-KOHI-T(KOH-IDX)
                     IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"     
                          MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)           
                                            TO WK-TOKUTEI-COMPFTN3      
                     END-IF                                             
               ELSE
                     COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
                              ZAN-KOHI-T(KOH-IDX)    -
                              LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
               MOVE  WK-GAIYKZFTNKBN
                                TO   LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
               EVALUATE   WK-GAIYKZFTNKBN
                   WHEN   "0"
                       MOVE  ZERO  TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                   WHEN   "1"
                       MOVE  YAKFTN-SOGOKEI   TO
                                LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                WK-KOH-YAKFTN-T(KOH-IDX)
                   WHEN   "2"
                       IF    YAKFTN-SOGOKEI  >  ZAN-KOHI-T(KOH-IDX)
                             MOVE   ZAN-KOHI-T(KOH-IDX)  TO  
                                       LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                             MOVE   ZERO    TO
                                            ZAN-KOHI-T(KOH-IDX)
                       ELSE
                             MOVE  YAKFTN-SOGOKEI  TO
                                       LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                             COMPUTE  ZAN-KOHI-T(KOH-IDX)   =
                                      ZAN-KOHI-T(KOH-IDX)   -
                                      LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                       END-IF
                   WHEN   "3"
                       MOVE  YAKFTN-SOGOKEI TO  LNK-SYU-KOH-COMPYKZFTN
                                                            (KOH-IDX)
               END-EVALUATE
               COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                         LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
           ELSE
               IF      ((HKN-HKNKOHSBTKBN     =       "3")    AND
                        (LNK-SYU-KOH-HKNNUM(KOH-IDX)  NOT =  "027")) OR
                       ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "051" ) OR
                       ( HKN-RECEFTNDSPKBN            =      "2"   )
                   IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN  TO  LNK-SYU-SYUCOMPFTN
                   END-IF
               END-IF
               IF     (((HKN-HKNKOHSBTKBN     =       "3")    AND       
                        (LNK-SYU-KOH-HKNNUM(KOH-IDX)  NOT =  "027")) OR 
                       ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "051" ) OR 
                       ( HKN-RECEFTNDSPKBN            =      "2"   ))   
               AND    (  LNK-SYU-KOH-HKNNUM(1)        =   "027"     )   
                   IF    WK-TOKUTEI-COMPFTN3   NOT =    ZERO            
                       MOVE   WK-TOKUTEI-COMPFTN3                       
                                            TO  LNK-SYU-KOH-COMPFTN(1)  
                   END-IF                                               
               END-IF                                                   
               IF    LNK-SYU-SYUCOMPFTN   NOT =    ZERO
                   IF  (( LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"     ) 
                   OR   ( FLG-KOUREI-KBN               =   "1"     ))
                   AND (  LNK-SYU-KOH-HKNNUM(KOH-IDX)  NOT =  "027" )       
                       COMPUTE  FTN-KOH-YYY  =  12000  -  FTN-KOH-XXX   
                       IF  LNK-SYU-SYUCOMPFTN  >  FTN-KOH-YYY           
                         MOVE  FTN-KOH-YYY         TO  FTN-KOH-ZZZ      
                       ELSE                                             
                         MOVE  LNK-SYU-SYUCOMPFTN  TO  FTN-KOH-ZZZ      
                       END-IF                                           
                       IF    FTN-KOH-ZZZ      >    ZAN-KOHI-T(KOH-IDX)  
                           MOVE  ZAN-KOHI-T(KOH-IDX)                    
                                            TO  LNK-SYU-KOH-COMPFTN     
                                                         (KOH-IDX)      
                           MOVE   ZERO      TO  ZAN-KOHI-T(KOH-IDX)     
                           PERFORM    KOHHI-HIKAKU-SEC                  
                       ELSE                                             
                           MOVE  FTN-KOH-ZZZ                            
                                            TO  LNK-SYU-KOH-COMPFTN     
                                                         (KOH-IDX)      
                           COMPUTE    ZAN-KOHI-T(KOH-IDX)  =            
                                      ZAN-KOHI-T(KOH-IDX)  -            
                                      LNK-SYU-KOH-COMPFTN(KOH-IDX)      
                           PERFORM    KOHHI-HIKAKU-SEC                  
                       END-IF                                           
                   ELSE                                                 
                       IF    LNK-SYU-SYUCOMPFTN  >  ZAN-KOHI-T(KOH-IDX)  
                           MOVE   ZAN-KOHI-T(KOH-IDX)
                                            TO  LNK-SYU-KOH-COMPFTN
                                                         (KOH-IDX)
                           MOVE   ZERO      TO  ZAN-KOHI-T(KOH-IDX)
                           PERFORM    KOHHI-HIKAKU-SEC
                       ELSE
                           MOVE  LNK-SYU-SYUCOMPFTN                         
                                            TO  LNK-SYU-KOH-COMPFTN
                                                         (KOH-IDX)
                           COMPUTE    ZAN-KOHI-T(KOH-IDX)  =
                                      ZAN-KOHI-T(KOH-IDX)  -
                                      LNK-SYU-KOH-COMPFTN(KOH-IDX)
                           PERFORM    KOHHI-HIKAKU-SEC
                       END-IF 
                   END-IF                                               
               ELSE
                 IF    LNK-SYU-KOH-COMPFTN(1)   NOT =    ZERO
                   IF  (( LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"     ) 
                   OR   ( FLG-KOUREI-KBN               =   "1"     ))
                   AND (  LNK-SYU-KOH-HKNNUM(KOH-IDX)  NOT =  "027" )
                       COMPUTE  FTN-KOH-YYY  =  12000  -  FTN-KOH-XXX   
                       IF  LNK-SYU-KOH-COMPFTN(1) >  FTN-KOH-YYY        
                         MOVE  FTN-KOH-YYY            TO  FTN-KOH-ZZZ   
                       ELSE                                             
                         MOVE  LNK-SYU-KOH-COMPFTN(1) TO  FTN-KOH-ZZZ   
                       END-IF                                           
      *************    IF WK-ZENGAKU    >    ZAN-KOHI-T(KOH-IDX)        
                       IF FTN-KOH-ZZZ   >    ZAN-KOHI-T(KOH-IDX)        
                          MOVE   ZAN-KOHI-T(KOH-IDX)                    
                                       TO  LNK-SYU-KOH-COMPFTN(KOH-IDX) 
                          MOVE   ZERO  TO  ZAN-KOHI-T(KOH-IDX)          
                          PERFORM    KOHHI-HIKAKU-SEC                   
                       ELSE                                             
      *************       MOVE   WK-ZENGAKU   TO  LNK-SYU-KOH-COMPFTN   
      *************                                         (KOH-IDX)   
                          MOVE   FTN-KOH-ZZZ  TO  LNK-SYU-KOH-COMPFTN   
                                                            (KOH-IDX)   
                          PERFORM    KOHHI-HIKAKU-SEC                   
                          COMPUTE   ZAN-KOHI-T(KOH-IDX)  =              
                                    ZAN-KOHI-T(KOH-IDX)  -              
                                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        
                       END-IF                                           
                   ELSE                                                 
      *************    IF WK-ZENGAKU    >    ZAN-KOHI-T(KOH-IDX)
                       IF LNK-SYU-KOH-COMPFTN(1) >  ZAN-KOHI-T(KOH-IDX)
                          MOVE   ZAN-KOHI-T(KOH-IDX)
                                       TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                          MOVE   ZERO  TO  ZAN-KOHI-T(KOH-IDX)
                          PERFORM    KOHHI-HIKAKU-SEC
                       ELSE
      *************       MOVE   WK-ZENGAKU   TO  LNK-SYU-KOH-COMPFTN
      *************                                         (KOH-IDX)
                          MOVE   LNK-SYU-KOH-COMPFTN(1)  
                                              TO  LNK-SYU-KOH-COMPFTN
                                                            (KOH-IDX)
                          PERFORM    KOHHI-HIKAKU-SEC
                          COMPUTE   ZAN-KOHI-T(KOH-IDX)  =
                                    ZAN-KOHI-T(KOH-IDX)  -
                                    LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                   END-IF
                 END-IF                                               
               END-IF
               MOVE  WK-GAIYKZFTNKBN   TO  LNK-SYU-KOH-YKZFTNKBN
                                                        (KOH-IDX)
               IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                             ZAN-KOHI-T(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             ZAN-KOHI-T(KOH-IDX)  /  10
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                             WK-FTN   *  10
               END-IF
               EVALUATE   WK-GAIYKZFTNKBN
                   WHEN   "0"
                       MOVE  ZERO  TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                   WHEN   "1"
                       MOVE  YAKFTN-SOGOKEI
                                   TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                   WHEN   "2"
                       IF    YAKFTN-SOGOKEI  >  ZAN-KOHI-T(KOH-IDX)
                             MOVE   ZAN-KOHI-T(KOH-IDX)  
                                   TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                             MOVE   ZERO    TO  ZAN-KOHI-T(KOH-IDX)
                       ELSE
                             MOVE  YAKFTN-SOGOKEI  TO
                                       LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                             COMPUTE  ZAN-KOHI-T(KOH-IDX)   =
                                      ZAN-KOHI-T(KOH-IDX)   -
                                      LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                       END-IF
                   WHEN   "3"
                       MOVE  YAKFTN-SOGOKEI
                                   TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
               END-EVALUATE
               COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                         LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
               IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =   "051"
                    MOVE  YAKFTN-SOGOKEI   TO
                                       LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                    COMPUTE   WK-FTN  =
                              LNK-SYU-KOH-COMPFTN(KOH-IDX)  +
                              WK-KOH-YAKFTN-T(KOH-IDX)
                    IF        WK-FTN    >  995
                        MOVE  1000   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  ZERO   TO   WK-KOH-YAKFTN-T(KOH-IDX)
                    ELSE
                        MOVE  WK-FTN TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  ZERO   TO   WK-KOH-YAKFTN-T(KOH-IDX)
                    END-IF
               END-IF
           END-IF.
      *
       2303-KOH-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ∏¯»Ò§Œ¥µº‘…È√¥∂‚≥€∑◊ªª° æÂ∏¬≥€§ §∑°À                  *
      ******************************************************************
       2304-KOH-KEISAN-SEC           SECTION.
      *
      *    …È√¥∂‚≥€§Œ∑◊ªª
           IF  WK-GAIKFTNRATE     NOT =    ZERO
               COMPUTE   WK-FUTANWARI  =
                              WK-GAIKFTNRATE  /  100
               COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                         WK-ZENGAKU   *  WK-FUTANWARI
               IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"           
                    MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)                 
                                            TO WK-TOKUTEI-COMPFTN3      
               END-IF                                         
      **       IF    LNK-SYU-KOH-HKNNUM(KOH-IDX)  =   "051"       
               IF ((HKN-HKNKOHSBTKBN     =       "3")    AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX)  NOT =  "027")) OR
                  ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "051" ) OR
                  ( HKN-RECEFTNDSPKBN            =      "2"   )
                   CONTINUE
               ELSE
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  /  10
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =  WK-FTN
                                                              *  10
               END-IF
               IF  ( LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" )             
               OR  ( FLG-KOUREI-KBN               =   "1" )
                IF    LNK-SYU-KOH-HKNNUM(KOH-IDX)  NOT =  "027"         
                  COMPUTE  FTN-KOH-YYY  =  12000  -  FTN-KOH-XXX        
                  IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)  >  FTN-KOH-YYY      
                    MOVE  FTN-KOH-YYY TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)  
                  END-IF                                                
                END-IF                                                  
               END-IF                                                   
               MOVE  WK-GAIYKZFTNKBN TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
           END-IF.
           PERFORM    KOHHI-HIKAKU-SEC.
           EVALUATE   WK-GAIYKZFTNKBN
               WHEN   "0"
                   MOVE  ZERO  TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
               WHEN   "1"
                   MOVE  YAKFTN-SOGOKEI
                               TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                   WK-KOH-YAKFTN-T(KOH-IDX)
               WHEN   "2"
                   MOVE  YAKFTN-SOGOKEI
                               TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                   WK-KOH-YAKFTN-T(KOH-IDX)
               WHEN   "3"
                   MOVE  YAKFTN-SOGOKEI
                               TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
           END-EVALUATE.
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX).
      *
       2304-KOH-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ∏¯»Ò√±∞Ã§«∑◊ªª§∑§ø¥µº‘…È√¥∂‚§Ú»Ê≥”
      ******************************************************************
       KOHHI-HIKAKU-SEC           SECTION.
      *
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN(1) < LNK-SYU-KOH-COMPFTN(2)
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  LNK-SYU-KOH-COMPFTN(2)
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN(2) < LNK-SYU-KOH-COMPFTN(3)
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  LNK-SYU-KOH-COMPFTN(3)
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN(3) < LNK-SYU-KOH-COMPFTN(4)
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  LNK-SYU-KOH-COMPFTN(4)
                   END-IF
           END-EVALUATE.
      *
       KOHHI-HIKAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ∏¯»Ò√±∞Ã§«∑◊ªª§∑§ø¥µº‘…È√¥∂‚§´§È∫«æÆ§Œ√Õ§Ú¡™¬Ú•ª•√•»
      ******************************************************************
       2314-FTNKIN-HIKAKU-SEC         SECTION.
      *
      *    ¿¡µ·≥€»Ê≥”
           MOVE    ZERO               TO    WK-KNJFTNKIN.
      *    ºÁ ›∏±§Œ§ﬂ
           IF (COMB-KOH1HKNNUM              =    SPACE)    AND
              (COMB-KOH2HKNNUM              =    SPACE)    AND
              (COMB-KOH3HKNNUM              =    SPACE)    AND
              (COMB-KOH4HKNNUM              =    SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN    TO   WK-KNJFTNKIN
               MOVE   LNK-SYU-SYUCOMPYKZFTN TO   LNK-SYU-YKZ-FTN
           END-IF.
      *    ∏¯»Ò£±§Œ§ﬂ
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN   TO    WK-KNJFTNKIN
               MOVE   WK-KOH1-YAKFTN        TO    LNK-SYU-YKZ-FTN
           END-IF.
      *    ∏¯»Ò£±§»∏¯»Ò£≤
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    LNK-SYU-KOH1COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH2COMPFTN TO  WK-KNJFTNKIN
               END-IF
               MOVE    WK-KOH1-YAKFTN       TO    LNK-SYU-YKZ-FTN
               IF  WK-KOH2-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH2-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
           END-IF.
      *    ∏¯»Ò£±§»∏¯»Ò£≤§»∏¯»Ò£≥
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    LNK-SYU-KOH1COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH2COMPFTN     TO  WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH3COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH3COMPFTN TO  WK-KNJFTNKIN
               END-IF
               MOVE    WK-KOH1-YAKFTN       TO    LNK-SYU-YKZ-FTN
               IF  WK-KOH2-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH2-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
               IF  WK-KOH3-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH3-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
           END-IF.
      *    ∏¯»Ò£±§»∏¯»Ò£≤§»∏¯»Ò£≥§»∏¯»Ò£¥
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE    LNK-SYU-KOH1COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH2COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH3COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH3COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH4COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH4COMPFTN TO  WK-KNJFTNKIN
               END-IF
               MOVE    WK-KOH1-YAKFTN       TO    LNK-SYU-YKZ-FTN
               IF  WK-KOH2-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH2-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
               IF  WK-KOH3-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH3-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
               IF  WK-KOH4-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH4-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
           END-IF.
      *
           IF   LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"   
           AND  COMB-KOH1HKNNUM        NOT   =   "027" 
               MOVE    LNK-SYU-SYUCOMPFTN     TO  WK-KNJFTNKIN
               IF   LNK-SYU-KOH1HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH1COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH1COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF   LNK-SYU-KOH2HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH2COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH2COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF   LNK-SYU-KOH3HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH3COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH3COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF   LNK-SYU-KOH4HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH4COMPFTN      <     WK-KNJFTNKIN
                   MOVE   LNK-SYU-KOH4COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF     LNK-SYU-SYUCOMPFTN   =  WK-KNJFTNKIN               
                  IF  LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                    MOVE  LNK-SYU-SYUCOMPFTN   TO   LNK-SYU-KOH1COMPFTN  
                  END-IF
                  IF  LNK-SYU-KOH2HKNNUM   NOT =  SPACE
                    MOVE  LNK-SYU-SYUCOMPFTN   TO   LNK-SYU-KOH2COMPFTN  
                  END-IF
                  IF  LNK-SYU-KOH3HKNNUM   NOT =  SPACE
                    MOVE  LNK-SYU-SYUCOMPFTN   TO   LNK-SYU-KOH3COMPFTN  
                  END-IF
                  IF  LNK-SYU-KOH4HKNNUM   NOT =  SPACE
                    MOVE  LNK-SYU-SYUCOMPFTN   TO   LNK-SYU-KOH4COMPFTN  
                  END-IF
               END-IF                                                    
           END-IF.
      *
      *    º˝«º•∆°º•÷•Î§Œ¿¡µ·≥€§Ú•ª•√•»
           MOVE    WK-KNJFTNKIN             TO  LNK-SYU-SKYMONEY.
      *
      *    º˝«º•∆°º•÷•Î§Œ∏¯»ÒÀË§Œ¥µº‘…È√¥∂‚≥€§Ú•ª•√•»§π§Î
           IF   (COMB-KOH1HKNNUM         NOT = SPACE)   AND
                (COMB-KOH1-GAIJGNKBN     =     "1")
               IF   COMB-KOH1-HKNKOHSBTKBN   NOT =    "3"
                    MOVE   WK-KNJFTNKIN  TO  LNK-SYU-KOH1HKNFTNMONEY
                    IF     LNK-SYU-KOH1YKZFTNKBN   =    "2"
                           COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =
                                    LNK-SYU-KOH1HKNFTNMONEY  +
                                    LNK-SYU-KOH1COMPYKZFTN
                    END-IF
               ELSE
                    IF     COMB-KOH1HKNNUM     =    "027"
                        MOVE   LNK-SYU-KOH1COMPFTN
                                         TO  LNK-SYU-KOH1HKNFTNMONEY
                    ELSE
                        MOVE   WK-KNJFTNKIN  TO LNK-SYU-KOH1HKNFTNMONEY
                    END-IF
               END-IF
           END-IF.
           IF   (COMB-KOH2HKNNUM        NOT = SPACE)   AND
                (COMB-KOH2-GAIJGNKBN    =     "1")
               IF   COMB-KOH2-HKNKOHSBTKBN   NOT =    "3"
                    MOVE   WK-KNJFTNKIN  TO  LNK-SYU-KOH2HKNFTNMONEY
                    IF     LNK-SYU-KOH2YKZFTNKBN   =    "2"
                           COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =
                                    LNK-SYU-KOH2HKNFTNMONEY  +
                                    LNK-SYU-KOH2COMPYKZFTN
                    END-IF
               ELSE
                    IF     COMB-KOH2HKNNUM     =    "027"
                        MOVE   LNK-SYU-KOH2COMPFTN
                                         TO  LNK-SYU-KOH2HKNFTNMONEY
                    ELSE
                        MOVE   WK-KNJFTNKIN  TO LNK-SYU-KOH2HKNFTNMONEY
                    END-IF
               END-IF
           END-IF.
           IF   (COMB-KOH3HKNNUM        NOT = SPACE)   AND
                (COMB-KOH3-GAIJGNKBN    =     "1")
               IF   COMB-KOH3-HKNKOHSBTKBN   NOT =    "3"
                    MOVE   WK-KNJFTNKIN  TO  LNK-SYU-KOH3HKNFTNMONEY
                    IF     LNK-SYU-KOH3YKZFTNKBN   =    "2"
                           COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =
                                    LNK-SYU-KOH3HKNFTNMONEY  +
                                    LNK-SYU-KOH3COMPYKZFTN
                    END-IF
               ELSE
                    IF     COMB-KOH3HKNNUM     =    "027"
                        MOVE   LNK-SYU-KOH3COMPFTN
                                         TO  LNK-SYU-KOH3HKNFTNMONEY
                    ELSE
                        MOVE   WK-KNJFTNKIN  TO LNK-SYU-KOH3HKNFTNMONEY
                    END-IF
               END-IF
           END-IF.
           IF   (COMB-KOH4HKNNUM        NOT = SPACE)   AND
                (COMB-KOH4-GAIJGNKBN    =     "1")
               IF   COMB-KOH4-HKNKOHSBTKBN   NOT =    "3"
                    MOVE   WK-KNJFTNKIN  TO  LNK-SYU-KOH4HKNFTNMONEY
                    IF     LNK-SYU-KOH4YKZFTNKBN   =    "2"
                           COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =
                                    LNK-SYU-KOH4HKNFTNMONEY  +
                                    LNK-SYU-KOH4COMPYKZFTN
                    END-IF
               ELSE
                    IF     COMB-KOH4HKNNUM     =    "027"
                        MOVE   LNK-SYU-KOH4COMPFTN
                                         TO  LNK-SYU-KOH4HKNFTNMONEY
                    ELSE
                        MOVE   WK-KNJFTNKIN  TO LNK-SYU-KOH4HKNFTNMONEY
                    END-IF
               END-IF
           END-IF.
      *
       2314-FTNKIN-HIKAKU-EXT.
           EXIT.
      ******************************************************************
      *        ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒªªƒÍΩËÕ˝                                *
      ******************************************************************
       YAKFTN-SANTEI-SEC              SECTION.
      *
           MOVE      SPACE       TO      YAKFTN-AREA.
           INITIALIZE                    YAKFTN-AREA.
      *
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚ƒßº˝≤ƒ«Ω§Œ»ΩƒÍ
           PERFORM YAKFTN-HANTEI-SEC.
      *
           IF      FLG-YAKFTN    =    SPACE
      *
      *      ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚•∆°º•÷•Î§Œ•ª•√•»
             PERFORM        YAKFTN-TABLE-SET-SEC
      *
      *      ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚•∆°º•÷•Î§Ú∫∆∏°∫˜§∑§∆∆±∞ÏÃÙ∫ﬁ§ŒºÔŒ‡øÙ§Ú∏∫ªª
             PERFORM YAKFTN-KAISUU-HENSYU-SEC
      *
      *      ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚•∆°º•÷•Î§Ú∫∆∏°∫˜§∑§∆∫ﬁ»÷πÊ Ã§ŒÃÙ∫ﬁøÙ§Ú∑◊ªª
             PERFORM YAKFTN-SAI-KEISAN-SEC
      *
      *      ∫ﬁ»÷πÊ Ã§ŒÃÙ∫ﬁøÙ§Ë§ÍÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§Ú∑◊ªª
             PERFORM YAKFTN-KINGAKU-KEISAN-SEC
      *
      *       ›∏±¿⁄§Í¬ÿ§®ª˛§Œ∑—¬≥ø«Œ≈∆˛Œœ§¨§µ§Ï§øæÏπÁ§Œ¡∞∆˛Œœ ¨
      *      §ŒÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒªªΩ–
             IF      LNK-SYU-CONTKBN     =    "2"
                 PERFORM YAKFTN-CONT-SEC
             END-IF
      *
      *      ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒæÂ∏¬≥€§ÚºÁ ›∏±§Œ…È√¥∂‚≥€§ﬁ§«§»§π§Î
             PERFORM YAKFTN-JOUGEN-HANTEI-SEC
           END-IF.
      *
       YAKFTN-SANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *     «ØŒ°¢ ›∏±∆‚Õ∆§´§ÈÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚ªªƒÍ≤ƒ«Ω¥µº‘§«§¢§Î§´»ΩƒÍ   *
      ******************************************************************
       YAKFTN-HANTEI-SEC           SECTION.
      *
           MOVE    SPACE                TO      FLG-YAKFTN.
      *
      *    «ØŒ£∂∫ÕÃ§À˛
           INITIALIZE                           PTINF-REC.
           MOVE    LNK-SYU-HOSPID       TO      PTINF-HOSPID.
           MOVE    LNK-SYU-PTID         TO      PTINF-PTID.
           MOVE    PTINF-REC            TO      MCPDATA-REC.
           MOVE    "DBSELECT"           TO      MCP-FUNC.
           MOVE    "PTINF-KEY"          TO      ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING   MCPAREA
                                                 ORCMCPAREA
                                                 MCPDATA-REC.
           IF      MCP-RC               =       ZERO
               MOVE    "PTINF-KEY"      TO      ORC-DBPATH
               PERFORM  PTINF-READ-SEC
               IF       MCP-RC          =       ZERO
                    MOVE   PTINF-BIRTHDAY   TO  WRK-YMDS1
                    MOVE   LNK-SYU-SRYYMD   TO  WRK-YMDS2
                    MOVE   ZERO             TO  WRK-NENREI
                    COMPUTE  WRK-NENREI     =   WRK-YYS2
                                            -   WRK-YYS1
                    IF   WRK-YMDS1(5:4)     >   WRK-YMDS2(5:4)
                         ADD   -1           TO  WRK-NENREI
                    END-IF
                    IF   WRK-NENREI         =   70 
                    AND  WRK-YMDS1(5:4)    <=   WRK-YMDS2(5:4)
                            IF    WRK-YMDS1(5:2)  = WRK-YMDS2(5:2)
                                  IF   WRK-YMDS1(7:2)  NOT = "01"
                                       ADD   -1     TO  WRK-NENREI
                                  END-IF
                            END-IF
                    END-IF
               ELSE
                    DISPLAY  "PTINF FETCH ERR"
                    MOVE     ZERO   TO      WRK-NENREI
               END-IF
           ELSE
               DISPLAY   "PTINF SELECT ERR"
               MOVE     ZERO   TO      WRK-NENREI
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "PTINF-KEY"          TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *
      *----(01.00.20) LINE MOD START --------------------------
      *     IF      WRK-NENREI         <     6
      *         MOVE    "1"            TO      FLG-YAKFTN
      *     END-IF.
           IF     (WRK-NENREI         <     6)   OR
                  (WRK-NENREI         >=    70)
               MOVE    "1"            TO      FLG-YAKFTN
           END-IF.
      *----(01.00.20) LINE MOD END   --------------------------
      *
      *    ¡•∞˜ ›∏±§Œ≥∫≈ˆº‘°ßø¶Ã≥æÂ
      *                    °ß≤º¡•∏Â£≥•ˆ∑Ó∞ ∆‚
      *                    °ßƒÃ∂–∫“≥≤
           IF     (COMB-HKNNUM        =     "002")   AND
                  (COMB-HOJOKBN       =  "1"  OR  "2"  OR  "3"  OR
                                         "A"  OR  "B"  OR  "C"  OR
                                         "D"  OR  "E"  OR  "F"    )
               MOVE    "1"            TO      FLG-YAKFTN
           END-IF.
      *
      *    ∂¶∫—¡»πÁ ›∏±§Œ≥∫≈ˆº‘°ß≤º¡•∏Â£≥•ˆ∑Ó∞ ∆‚
           IF     (COMB-HKNNUM  = "031" OR "032" OR "033" OR "034") AND
                  (COMB-HOJOKBN =  "2"  OR  "B"  OR  "E"          )
               MOVE    "1"            TO      FLG-YAKFTN
           END-IF.
      *
      *    œ∑øÕ ›∏±ºıµÎº‘° £∂£µ∫Õ∞ æÂ¥ﬁ§‡°À
           IF     COMB-KOH1HKNNUM  = "027"
               MOVE    "1"            TO      FLG-YAKFTN
           END-IF.
      *
       YAKFTN-HANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *     ∞˙§≠≈œ§∑•—•È•·•ø§´§ÈÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚•∆°º•÷•Î§ÿ§Œ•ª•√•»ΩËÕ˝   *
      ******************************************************************
       YAKFTN-TABLE-SET-SEC           SECTION.
      *
           MOVE    ZERO                 TO      Y-IDX3.
           PERFORM VARYING     Y-IDX    FROM    1   BY  1
                   UNTIL      (Y-IDX        >       3)
             PERFORM VARYING     Y-IDX2    FROM    1   BY  1
                     UNTIL    (Y-IDX2       >       40)
               IF    (LNK-S01-SRYKBN(Y-IDX Y-IDX2)  NOT =  SPACE) AND
                     (LNK-S01-SRYCD(Y-IDX Y-IDX2) (1:1) =  "6")
                   ADD        1     TO    Y-IDX3
                   MOVE  LNK-S01-SRYKBN (Y-IDX Y-IDX2)
                                         TO    LNK-S02-SRYKBN (Y-IDX3)
                   MOVE  LNK-S01-ZAIBAN (Y-IDX Y-IDX2)
                                         TO    LNK-S02-ZAIBAN (Y-IDX3)
                   MOVE  LNK-S01-SRYCD  (Y-IDX Y-IDX2)
                                         TO    LNK-S02-SRYCD  (Y-IDX3)
                   MOVE  LNK-S01-SURYOU (Y-IDX Y-IDX2)
                                         TO    LNK-S02-SURYOU (Y-IDX3)
                   MOVE  LNK-S01-KAISUU (Y-IDX Y-IDX2)
                                         TO    LNK-S02-KAISUU (Y-IDX3)
                   MOVE  LNK-S01-TENSUU (Y-IDX Y-IDX2)
                                         TO    LNK-S02-TENSUU (Y-IDX3)
               END-IF
             END-PERFORM
           END-PERFORM.
      *
           PERFORM VARYING     Y-IDX    FROM    1   BY  1
                   UNTIL      (LNK-S02-SRYKBN(Y-IDX)    =   SPACE) OR
                              (Y-IDX                    >   40   )
               MOVE  LNK-S02-SRYKBN (Y-IDX) TO YAKFTN-SRYKBN (Y-IDX)
               MOVE  LNK-S02-ZAIBAN (Y-IDX) TO YAKFTN-ZAIBAN (Y-IDX)
               MOVE  LNK-S02-SRYCD  (Y-IDX) TO YAKFTN-SRYCD  (Y-IDX)
               MOVE  LNK-S02-TENSUU (Y-IDX) TO YAKFTN-TENSUU (Y-IDX)
               IF    LNK-S02-SRYKBN(Y-IDX)  =  "22"
                     MOVE    1              TO LNK-S02-KAISUU(Y-IDX)
               END-IF
               MOVE  LNK-S02-KAISUU (Y-IDX) TO YAKFTN-MAX    (Y-IDX)
               MOVE  LNK-S02-KAISUU (Y-IDX) TO Y-IDX3
               PERFORM VARYING     Y-IDX2   FROM    1   BY  1
                       UNTIL       Y-IDX2   >       Y-IDX3
                    MOVE    1      TO    YAKFTN-KAISUU   (Y-IDX Y-IDX2)
              END-PERFORM
           END-PERFORM.
      *
      *----(01.00.04) LINE ADD START -------------------------------------
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒæÂ∏¬≥€»ΩƒÍÕ—§Àø«Œ≈∂Ë ¨ Ã§ŒÃÙ∫ﬁ≈¿øÙ§ÚºË∆¿
           PERFORM VARYING     Y-IDX    FROM    1   BY  1
                   UNTIL      (Y-IDX                    >   40   )  OR
                              (LNK-S02-SRYKBN(Y-IDX)    =   SPACE)
               PERFORM   VARYING   Y-IDX2    FROM   1   BY   1
                         UNTIL     Y-IDX2    >          40
                        IF   LNK-S02-ZAIBAN(Y-IDX)  =  
                                              WK-TOYAKU-ZAIBAN(Y-IDX2)
                             MOVE   41      TO   Y-IDX2
                        ELSE
                          IF   WK-TOYAKU-ZAIBAN(Y-IDX2)    =   ZERO
                              MOVE   LNK-S02-SRYKBN(Y-IDX) TO
                                              WK-TOYAKU-SRYKBN(Y-IDX2)
                              MOVE   LNK-S02-ZAIBAN(Y-IDX) TO
                                              WK-TOYAKU-ZAIBAN(Y-IDX2)
                              IF     LNK-S02-SRYKBN(Y-IDX)  =  "21" OR
                                                               "22"
                                  COMPUTE    WK-TOYAKU-ZAITEN(Y-IDX2)
                                          =  LNK-S02-TENSUU(Y-IDX)
                                          *  LNK-S02-KAISUU(Y-IDX)
                              ELSE
                                  MOVE   LNK-S02-TENSUU(Y-IDX) TO
                                              WK-TOYAKU-ZAITEN(Y-IDX2)
                              END-IF
                              MOVE   41       TO   Y-IDX2
                          END-IF
                        END-IF
               END-PERFORM
           END-PERFORM.
           PERFORM    VARYING    Y-IDX   FROM  1   BY   1
                      UNTIL     (Y-IDX       >   40)    OR
                                (WK-TOYAKU-SRYKBN(Y-IDX)   =    SPACE)
                  EVALUATE    WK-TOYAKU-SRYKBN(Y-IDX)
                      WHEN    "21"
                          ADD   WK-TOYAKU-ZAITEN(Y-IDX)    TO
                                                    WK-TOYAKU-TENSU(1)
                      WHEN    "22"
                          ADD   WK-TOYAKU-ZAITEN(Y-IDX)    TO
                                                    WK-TOYAKU-TENSU(2)
                      WHEN    "23"
                          ADD   WK-TOYAKU-ZAITEN(Y-IDX)    TO
                                                    WK-TOYAKU-TENSU(3)
                  END-EVALUATE
           END-PERFORM.
           COMPUTE    WK-TOYAKU-TENSU(1)  =  WK-TOYAKU-TENSU(1) *  10.
           COMPUTE    WK-TOYAKU-TENSU(2)  =  WK-TOYAKU-TENSU(2) *  10.
           COMPUTE    WK-TOYAKU-TENSU(3)  =  WK-TOYAKU-TENSU(3) *  10.
      *               
      *----(01.00.04) LINE ADD END   -------------------------------------
      *
       YAKFTN-TABLE-SET-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚•∆°º•÷•Î§Ú∫∆∏°∫˜§∑§∆∆±∞ÏÃÙ∫ﬁ§ŒºÔŒ‡øÙ§Ú∑◊ªª    *
      ******************************************************************
       YAKFTN-KAISUU-HENSYU-SEC          SECTION.
      *
      *        ø«Œ≈∂Ë ¨°¶ø«Œ≈•≥°º•…§« ¬§”¬ÿ§®
      *
      *   (2001/03/07  é¬é≤é∂)
           MOVE   YAKFTN-TABLE      TO    YAKFTN-TABLE2.
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                   UNTIL      (YAKFTN-SRYKBN2(Y-IDX)    =   SPACE)  OR
                              (Y-IDX                   >   39   )
               COMPUTE Y-IDX2  =   Y-IDX       +   1
               PERFORM VARYING     Y-IDX3  FROM    Y-IDX2  BY  1
                       UNTIL      (YAKFTN-SRYKBN2(Y-IDX3) = SPACE)  OR
                                  (Y-IDX3              >   40   )
                   IF      YAKFTN-KEY2 (Y-IDX) > YAKFTN-KEY2 (Y-IDX3)
                       MOVE    YAKFTN-TBL-OCC2(Y-IDX)   TO
                                               WK-SRT-YAKFTN-TABLE
                       MOVE    YAKFTN-TBL-OCC2(Y-IDX3)  TO
                                               YAKFTN-TBL-OCC2(Y-IDX)
                       MOVE    WK-SRT-YAKFTN-TABLE     TO
                                               YAKFTN-TBL-OCC2(Y-IDX3)
                   END-IF
               END-PERFORM
           END-PERFORM.       
           MOVE   YAKFTN-TABLE2     TO    YAKFTN-TABLE.
      *   (2001/03/07  é¬é≤é∂ éµé‹éÿ)
      *//     PERFORM VARYING     Y-IDX   FROM    1   BY  1
      *//             UNTIL      (YAKFTN-SRYKBN(Y-IDX)    =   SPACE)  OR
      *//                        (Y-IDX                   >   39   )
      *//         COMPUTE Y-IDX2  =   Y-IDX       +   1
      *//        PERFORM VARYING     Y-IDX3  FROM    Y-IDX2  BY  1
      *//                 UNTIL      (YAKFTN-SRYKBN(Y-IDX3) = SPACE)  OR
      *//                            (Y-IDX3              >   40   )
      *//             IF      YAKFTN-KEY (Y-IDX) > YAKFTN-KEY (Y-IDX3)
      *//                 MOVE    YAKFTN-TBL-OCC(Y-IDX)   TO
      *//                                         WK-SRT-YAKFTN-TABLE
      *//                 MOVE    YAKFTN-TBL-OCC(Y-IDX3)  TO
      *//                                         YAKFTN-TBL-OCC(Y-IDX)
      *//                 MOVE    WK-SRT-YAKFTN-TABLE     TO
      *//                                         YAKFTN-TBL-OCC(Y-IDX3)
      *//            END-IF
      *//         END-PERFORM
      *//     END-PERFORM.       
      *
      *     DISPLAY  "*****  é∫é∞éƒéﬁé≈é◊éÀéﬁé∂é¥é∫éﬁ *******".
      *     PERFORM   VARYING  DSP-IDX   FROM   1   BY   1
      *                UNTIL  DSP-IDX   >   10
      *         DISPLAY  "YAKFTN-SRYCD(DSP-IDX)  = "
      *                                   YAKFTN-SRYCD(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAIBAN(DSP-IDX) = "
      *                                   YAKFTN-ZAIBAN(DSP-IDX)
      *         DISPLAY  "YAKFTN-TENSUU(DSP-IDX) = "
      *                                   YAKFTN-TENSUU(DSP-IDX)
      *       PERFORM    VARYING   DSP-IDX2   FROM  1  BY  1
      *                  UNTIL     DSP-IDX2   >   5  
      *         DISPLAY "YAKFTN-KAISUU(" DSP-IDX ":" DSP-IDX2 ") = "
      *                           YAKFTN-KAISUU(DSP-IDX DSP-IDX2)
      *       END-PERFORM
      *     END-PERFORM.                             
      *               
      *
      *        ø«Œ≈∂Ë ¨°¶ø«Œ≈•≥°º•… Ã§À…˛Õ—¥¸¥÷§Œ ‘Ω∏
           MOVE    ZERO                 TO  WK-KAISUU-TABLE
           MOVE    1                    TO  Y-IDX
           PERFORM UNTIL      (YAKFTN-SRYKBN(Y-IDX)   =   SPACE)   OR
                              (Y-IDX                   >   40  )
               MOVE    YAKFTN-KEY   (Y-IDX)     TO  WK-KEY-SRY
               MOVE    YAKFTN-KAISUU-TABLE(Y-IDX)
                                                TO  WK-KAISUU-TABLE
               MOVE    YAKFTN-TENSUU(Y-IDX)
                                                TO  WK-YAKFTN-TENSUU
               ADD     1                        TO  Y-IDX
               PERFORM UNTIL      (YAKFTN-SRYKBN(Y-IDX)  =  SPACE) OR
                                  (Y-IDX                 >  40   ) OR
                                  (WK-KEY-SRY              NOT =
                                                  YAKFTN-KEY (Y-IDX))
      *
                   PERFORM VARYING Y-IDX3  FROM    1   BY  1
                           UNTIL   Y-IDX3  >       YAKFTN-MAX (Y-IDX)
                       IF      WK-KAISUU    (Y-IDX3)   =   1
                             AND  YAKFTN-TENSUU(Y-IDX)  >  20   AND
                                  WK-YAKFTN-TENSUU      >  20
                           MOVE  ZERO  TO  YAKFTN-KAISUU(Y-IDX Y-IDX3)
                       END-IF
      *                 IF  YAKFTN-TENSUU (Y-IDX)  <=   20
      *                     MOVE  1     TO  YAKFTN-KAISUU(Y-IDX Y-IDX3)
      *                 END-IF
                   END-PERFORM
      *
                   PERFORM VARYING Y-IDX3  FROM    1   BY  1
                           UNTIL   Y-IDX3  > YAKFTN-MAX (Y-IDX)
                       IF      YAKFTN-KAISUU(Y-IDX Y-IDX3) =  1
                           MOVE    1       TO  WK-KAISUU   (Y-IDX3)
                       END-IF
                   END-PERFORM
      *
                   MOVE    YAKFTN-TENSUU(Y-IDX)    TO  WK-YAKFTN-TENSUU
                   ADD     1                       TO  Y-IDX
              END-PERFORM
      *
           END-PERFORM.       
      *
      *     DISPLAY  "*****  éÃé∏é÷é≥é∑é∂é›éÕé›éºé’é≥é∫éﬁ *******".
      *     PERFORM   VARYING  DSP-IDX   FROM   1   BY   1
      *                UNTIL  DSP-IDX   >   10
      *         DISPLAY  "YAKFTN-SRYCD(DSP-IDX)  = "
      *                                   YAKFTN-SRYCD(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAIBAN(DSP-IDX) = "
      *                                   YAKFTN-ZAIBAN(DSP-IDX)
      *         DISPLAY  "YAKFTN-TENSUU(DSP-IDX) = "
      *                                   YAKFTN-TENSUU(DSP-IDX)
      *       PERFORM    VARYING   DSP-IDX2   FROM  1  BY  1
      *                  UNTIL     DSP-IDX2   >   5  
      *         DISPLAY "YAKFTN-KAISUU(" DSP-IDX ":" DSP-IDX2 ") = "
      *                           YAKFTN-KAISUU(DSP-IDX DSP-IDX2)
      *       END-PERFORM
      *     END-PERFORM.                             
      *               
      *
       YAKFTN-KAISUU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚•∆°º•÷•Î§Ú∫∆∏°∫˜§∑§∆∫ﬁ»÷πÊ Ã§ŒÃÙ∫ﬁøÙ§Ú∑◊ªª    *
      ******************************************************************
       YAKFTN-SAI-KEISAN-SEC                SECTION.
      *
      *        ∫ﬁ»÷πÊ§« ¬§”¬ÿ§®
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                   UNTIL      (YAKFTN-SRYKBN(Y-IDX)  =  SPACE) OR
                              (Y-IDX                 >  39   )
               COMPUTE Y-IDX2  =   Y-IDX       +   1
               PERFORM VARYING     Y-IDX3  FROM    Y-IDX2  BY  1
                       UNTIL      (YAKFTN-SRYKBN(Y-IDX3) = SPACE)  OR
                                  (Y-IDX3                >   40 )
                   IF     YAKFTN-ZAIBAN(Y-IDX) > YAKFTN-ZAIBAN(Y-IDX3)
                       MOVE    YAKFTN-TBL-OCC(Y-IDX)  TO
                                                WK-SRT-YAKFTN-TABLE
                       MOVE    YAKFTN-TBL-OCC(Y-IDX3) TO
                                                YAKFTN-TBL-OCC(Y-IDX)
                       MOVE    WK-SRT-YAKFTN-TABLE    TO
                                                YAKFTN-TBL-OCC(Y-IDX3)
                   END-IF
               END-PERFORM
           END-PERFORM.       
      *
      *
      *     DISPLAY  "*****  éªéﬁé≤é éﬁé›é∫éﬁé≥é≈é◊éÀéﬁé∂é¥é∫éﬁ*******".
      *     PERFORM   VARYING  DSP-IDX   FROM   1   BY   1
      *                UNTIL  DSP-IDX   >   10
      *         DISPLAY  "YAKFTN-SRYCD(DSP-IDX)  = "
      *                                   YAKFTN-SRYCD(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAIBAN(DSP-IDX) = "
      *                                   YAKFTN-ZAIBAN(DSP-IDX)
      *         DISPLAY  "YAKFTN-TENSUU(DSP-IDX) = "
      *                                   YAKFTN-TENSUU(DSP-IDX)
      *       PERFORM    VARYING   DSP-IDX2   FROM  1  BY  1
      *                  UNTIL     DSP-IDX2   >   5  
      *         DISPLAY "YAKFTN-KAISUU(" DSP-IDX ":" DSP-IDX2 ") = "
      *                           YAKFTN-KAISUU(DSP-IDX DSP-IDX2)
      *       END-PERFORM
      *     END-PERFORM.                             
      *               
      *        ∫ﬁ»÷πÊ Ã§ÀÃÙ∫ﬁøÙ§Ú∑◊ªª
      *----(01.00.03) LINE ADD START -------------------------------------
           MOVE    ZERO                 TO  FLG-ZAIGATAKBN
      *----(01.00.03) LINE ADD END   -------------------------------------
           MOVE    1                    TO  Y-IDX
           MOVE    ZERO                 TO  Y-IDX4
           PERFORM UNTIL      (YAKFTN-SRYKBN(Y-IDX)   =   SPACE)   OR
                              (Y-IDX                   >   40  )
               ADD     1                        TO  Y-IDX4
               MOVE    YAKFTN-SRYKBN  (Y-IDX)   TO
                                           YAKFTN-ZAI-SRYKBN  (Y-IDX4)
               MOVE    YAKFTN-ZAIBAN  (Y-IDX)   TO
                                           YAKFTN-ZAI-ZAIBAN  (Y-IDX4)
               MOVE    YAKFTN-SRYCD   (Y-IDX)   TO
                                           YAKFTN-ZAI-SRYCD   (Y-IDX4)
               MOVE    YAKFTN-TENSUU  (Y-IDX)   TO
                                           YAKFTN-ZAI-TENSUU  (Y-IDX4)
               MOVE    YAKFTN-ZAIBAN  (Y-IDX)   TO
                                           WK-KEY-ZAIBAN
               MOVE    ZERO                     TO
                                           WK-ZAI-KAISUU-TABLE
      *-------------------------------------------------------------------
           MOVE    ZERO                 TO  FLG-ZAIGATAKBN
      *----(01.00.03) LINE ADD END   -------------------------------------
              PERFORM UNTIL  (YAKFTN-SRYKBN(Y-IDX)  =  SPACE)   OR
                             (Y-IDX                 >  40   )   OR
                             (WK-KEY-ZAIBAN   NOT =
                                                YAKFTN-ZAIBAN(Y-IDX))
      *
      *----(01.00.03) LINE ADD START -------------------------------------
                 MOVE    ZERO                    TO  FLG-ADDKBN
      *
      *        ° ∆‚…˛ÃÙ∫ﬁ§Œ∫ÆπÁ°À
                 IF      YAKFTN-SRYKBN (Y-IDX)   =   "21"
                     INITIALIZE                      TNS-TENSU-REC
                     MOVE    YAKFTN-SRYCD (Y-IDX)    TO  TNS-SRYCD
                     MOVE    LNK-SYU-SRYYMD          TO  ORC-DBYMD
                     PERFORM TENSU-READ-SEC
                     IF      TNS-ZAIGATAKBN          =   "1" OR
                                                         "2" OR
                                                         "3"
                        IF      FLG-ZAIGATAKBN       =   1
                            MOVE    1                TO  FLG-ADDKBN
                        END-IF
                        MOVE    1                    TO  FLG-ZAIGATAKBN
                     END-IF        
                 END-IF
                 IF     FLG-ADDKBN              =   ZERO
      *----(01.00.03) LINE ADD END   -------------------------------------
                    PERFORM VARYING Y-IDX3  FROM    1   BY  1
                            UNTIL   Y-IDX3  >       YAKFTN-MAX (Y-IDX)
                        IF      YAKFTN-KAISUU(Y-IDX Y-IDX3)   >   0
                            ADD     YAKFTN-KAISUU(Y-IDX Y-IDX3)
                                            TO  WK-ZAI-KAISUU (Y-IDX3)
                            IF      Y-IDX3    >  YAKFTN-ZAI-MAX(Y-IDX4)
                                MOVE Y-IDX3  TO  YAKFTN-ZAI-MAX(Y-IDX4)
                            END-IF
                        END-IF
                    END-PERFORM
                END-IF    
      *
                ADD     1                       TO  Y-IDX      
              END-PERFORM
              MOVE    WK-ZAI-KAISUU-TABLE     TO
                                      YAKFTN-ZAI-KAISUU-TABLE (Y-IDX4)
           END-PERFORM.
      *
      *     DISPLAY "*** ZAIBANGTOU BETSU YAKUZAISUU KEISANGO  ***".
      *
      *     PERFORM   VARYING  DSP-IDX   FROM   1   BY   1
      *                UNTIL  DSP-IDX   >   10
      *         DISPLAY  "YAKFTN-ZAI-SRYCD(DSP-IDX)  = "
      *                                   YAKFTN-ZAI-SRYCD(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAI-ZAIBAN(DSP-IDX) = "
      *                                   YAKFTN-ZAI-ZAIBAN(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAI-TENSUU(DSP-IDX) = "
      *                                   YAKFTN-ZAI-TENSUU(DSP-IDX)
      *       PERFORM    VARYING   DSP-IDX2   FROM  1  BY  1
      *                  UNTIL     DSP-IDX2   >   5  
      *         DISPLAY "YAKFTN-ZAI-KAISUU(" DSP-IDX ":" DSP-IDX2 ") = "
      *                           YAKFTN-ZAI-KAISUU(DSP-IDX DSP-IDX2)
      *       END-PERFORM
      *     END-PERFORM.                             
      *               
      *
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                   UNTIL   (YAKFTN-ZAI-SRYKBN(Y-IDX)   =   SPACE)  OR
                           (Y-IDX                      >   40  )
      *        ° £≤£∞≈¿∞ ≤º¬–±˛°À
               IF      YAKFTN-ZAI-TENSUU (Y-IDX)   <=  20
                   PERFORM VARYING Y-IDX2  FROM    1   BY  1
                           UNTIL   Y-IDX2  >     YAKFTN-ZAI-MAX(Y-IDX)
                       IF      YAKFTN-ZAI-KAISUU (Y-IDX Y-IDX2) >   0
                           MOVE    1               TO
                                     YAKFTN-ZAI-KAISUU (Y-IDX Y-IDX2)
                       END-IF
                   END-PERFORM
               END-IF
      *        ° ≥∞Õ—ÃÙ§Œ∫ÆπÁ°À
               IF      YAKFTN-ZAI-SRYKBN (Y-IDX)   =   "23"
                   PERFORM VARYING Y-IDX2  FROM    1   BY  1
                           UNTIL   Y-IDX2  >    YAKFTN-ZAI-MAX(Y-IDX)
                       IF      YAKFTN-ZAI-KAISUU (Y-IDX Y-IDX2) >   0
                           MOVE    1               TO
                                     YAKFTN-ZAI-KAISUU (Y-IDX Y-IDX2)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM.
      *
       YAKFTN-SAI-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚•∆°º•÷•Î§Ú∫∆∏°∫˜§∑§∆∫ﬁ»÷πÊ Ã§ŒÃÙ∫ﬁøÙ§Ú∑◊ªª    *
      ******************************************************************
       YAKFTN-KINGAKU-KEISAN-SEC                SECTION.
      *
      *----(01.00.01) LINE MOD START -------------------------------
      *
      *    MOVE    ZERO                 TO  YAKFTN-SOGOKEI
      *
      *    PERFORM VARYING     Y-IDX   FROM    1   BY  1
      *          UNTIL      (YAKFTN-ZAI-SRYKBN(Y-IDX)   =   SPACE)   OR
      *                       (Y-IDX                      >   40  )
      *      PERFORM VARYING Y-IDX2  FROM    1   BY  1
      *              UNTIL   Y-IDX2  >       YAKFTN-ZAI-MAX(Y-IDX)
      *          IF      YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2)    >   0
      *              EVALUATE    TRUE
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) =   1
      *                      MOVE    ZERO             TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) = 2 OR 3
      *                      MOVE    30               TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21" AND
      *                      YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) =  4 OR 5
      *                      MOVE    60               TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) >  5
      *                      MOVE    100              TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "22" 
      *                      COMPUTE  WK-FUTAN    =   
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2)  *   10
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "23" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) =   1
      *	                     MOVE     50              TO  WK-FUTAN    
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "23" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) =   2
      *                     MOVE     100              TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =  "23" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) >   2
      *                     MOVE     150              TO  WK-FUTAN
      *              END-EVALUATE
      *              ADD     WK-FUTAN             TO  YAKFTN-SOGOKEI
      *          END-IF
      *      END-PERFORM
      *    END-PERFORM.
      *
      *
           MOVE    ZERO                 TO  YAKFTN-SOGOKEI
      *
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                 UNTIL      (YAKFTN-ZAI-SRYKBN(Y-IDX)   =   SPACE)   OR
                              (Y-IDX                      >   40  )
             PERFORM VARYING Y-IDX2  FROM    1   BY  1
                     UNTIL   Y-IDX2  >       YAKFTN-ZAI-MAX(Y-IDX)
                 IF      YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2)    >   0
                     EVALUATE    TRUE
                         WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21"
                               ADD  YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) TO
                                    YAKFTN-TOTAL-KAISUU(1 Y-IDX2)
                         WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "22"
                               ADD  YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) TO
                                    YAKFTN-TOTAL-KAISUU(2 Y-IDX2)
                         WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "23"
                               ADD  YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) TO
                                    YAKFTN-TOTAL-KAISUU(3 Y-IDX2)
                     END-EVALUATE
                 END-IF
             END-PERFORM
           END-PERFORM.
      *
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                   UNTIL     (Y-IDX               >   3  )
             PERFORM VARYING Y-IDX2  FROM    1   BY  1
                     UNTIL    (Y-IDX2              >       180)
                 IF      YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2)    >   0
                     EVALUATE    TRUE
                         WHEN  Y-IDX       =     1     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   1
                             MOVE    ZERO             TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) = 2
                             MOVE    30               TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) = 3
                             MOVE    30               TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                             YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   4
                             MOVE    60               TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                             YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   5
                             MOVE    60               TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) >  5
                             MOVE    100              TO  WK-FUTAN
                         WHEN  Y-IDX       =     2 
                             COMPUTE  WK-FUTAN    =   
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2)  *  10
                         WHEN  Y-IDX       =     3     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   1
      	                     MOVE     50              TO  WK-FUTAN    
                         WHEN  Y-IDX       =     3     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   2
                            MOVE     100              TO  WK-FUTAN
                         WHEN  Y-IDX       =     3     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) >   2
                            MOVE     150              TO  WK-FUTAN
                     END-EVALUATE
                     EVALUATE    Y-IDX
                         WHEN    1
                                ADD    WK-FUTAN   TO  WK-NAI-FUTAN
                         WHEN    2
                                ADD    WK-FUTAN   TO  WK-TON-FUTAN
                         WHEN    3
                                ADD    WK-FUTAN   TO  WK-GAI-FUTAN
                     END-EVALUATE
      *----(01.00.04) LINE DEL START -------------------------------
      ***           ADD     WK-FUTAN             TO  YAKFTN-SOGOKEI
      *----(01.00.04) LINE DEL END   -------------------------------
                 END-IF
             END-PERFORM
           END-PERFORM.
      *----(01.00.01) LINE MOD END   -------------------------------
      *
      *----(01.00.04) LINE ADD START -------------------------------
      **     IF    WK-TOYAKU-TENSU(1)     <   WK-NAI-FUTAN
      **          MOVE    WK-TOYAKU-TENSU(1)   TO   WK-NAI-FUTAN
      **     END-IF. 
      **     IF    WK-TOYAKU-TENSU(2)     <   WK-TON-FUTAN
      **           MOVE    WK-TOYAKU-TENSU(2)   TO   WK-TON-FUTAN
      **     END-IF. 
      **     IF    WK-TOYAKU-TENSU(3)     <   WK-GAI-FUTAN
      **           MOVE    WK-TOYAKU-TENSU(3)   TO   WK-GAI-FUTAN
      **     END-IF. 
           COMPUTE   YAKFTN-SOGOKEI   =   WK-NAI-FUTAN   +
                                          WK-TON-FUTAN   +
                                          WK-GAI-FUTAN.
           COMPUTE   WK-TOYAKU-TENSU(4)   =    WK-TOYAKU-TENSU(1)    +
                                               WK-TOYAKU-TENSU(2)    +
                                               WK-TOYAKU-TENSU(3).
           IF        YAKFTN-SOGOKEI       >    WK-TOYAKU-TENSU(4)
               MOVE  WK-TOYAKU-TENSU(4)   TO   YAKFTN-SOGOKEI
           END-IF.
      *----(01.00.04) LINE ADD END   -------------------------------
      *      
       YAKFTN-KINGAKU-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *     ›∏±¿⁄§Í¬ÿ§®ª˛§Œ∑—¬≥ø«Œ≈∆˛Œœ§¨§µ§Ï§øæÏπÁ§Œ¡∞∆˛Œœ ¨
      *    §ŒÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒªªΩ–° º˝«º•∆°º•÷•Î§Ë§Í°À
      ******************************************************************
       YAKFTN-CONT-SEC                SECTION.
      *
           MOVE    LNK-SYU-HOSPID       TO     SYU-HOSPID.
           MOVE    LNK-SYU-NYUGAIKBN    TO     SYU-NYUGAIKBN.
           MOVE    LNK-SYU-PTID         TO     SYU-PTID.
           MOVE    LNK-SYU-DOUJI-DENPNUM TO    SYU-DOUJI-DENPNUM.
           MOVE    SYU-SYUNOU-REC       TO     MCPDATA-REC.
           MOVE    "DBSELECT"           TO     MCP-FUNC.
           MOVE    "SYUNOU-KEY3"        TO     ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING  MCPAREA
                                                ORCMCPAREA
                                                MCPDATA-REC.
           IF      MCP-RC               =      ZERO
               MOVE    "SYUNOU-KEY3"    TO     ORC-DBPATH
               PERFORM  SYUNOU-READ-SEC
               PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                 DISPLAY  "LNK-SYU-DENPNUM = " LNK-SYU-DENPNUM
                 IF    LNK-SYU-DENPNUM   NOT =    1
                   IF  LNK-SYU-DENPNUM   >   SYU-DENPNUM
                     IF  WK-CONT-YAKFTNKIN1    =    ZERO
                         MOVE   SYU-RESE-YKZ-FTN
                                          TO     WK-CONT-YAKFTNKIN1
                     ELSE
                         MOVE   SYU-RESE-YKZ-FTN
                                          TO     WK-CONT-YAKFTNKIN2
                     END-IF
                   END-IF
                   MOVE      "SYUNOU-KEY3"  TO     ORC-DBPATH
                   PERFORM    SYUNOU-READ-SEC
                 ELSE
                   IF  WK-CONT-YAKFTNKIN1    =    ZERO
                       MOVE   SYU-RESE-YKZ-FTN
                                        TO     WK-CONT-YAKFTNKIN1
                   ELSE
                       MOVE   SYU-RESE-YKZ-FTN
                                        TO     WK-CONT-YAKFTNKIN2
                   END-IF
                   MOVE      "SYUNOU-KEY3"  TO     ORC-DBPATH
                   PERFORM   SYUNOU-READ-SEC
                 END-IF
               END-PERFORM
           END-IF.
      *
           MOVE    "DBCLOSE"            TO  MCP-FUNC.
           MOVE    "SYUNOU-KEY3"        TO  ORC-DBPATH.
           CALL    "ORCMCPSUB"           USING
                                         MCPAREA
                                         ORCMCPAREA
                                         MCPDATA-REC.
      *    •»°º•ø•Î§ŒÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§´§È¡∞ø«Œ≈§ŒÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§Ú∏∫ªª
           COMPUTE   YAKFTN-SOGOKEI   =   YAKFTN-SOGOKEI
                                      -   WK-CONT-YAKFTNKIN1
                                      -   WK-CONT-YAKFTNKIN2.
      *
       YAKFTN-CONT-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒæÂ∏¬≥€§ÚºÁ ›∏±§Œ ›∏±…È√¥∂‚≥€§ﬁ§«§»§π§Î      *
      ******************************************************************
       YAKFTN-JOUGEN-HANTEI-SEC                SECTION.
      *
           MOVE    ZERO                 TO  YAKFTN-JOUGEN
      *
           IF    (COMB-KOH1-HKNKOHSBTKBN   =   "3")   OR
                 (COMB-KOH2-HKNKOHSBTKBN   =   "3")   OR
                 (COMB-KOH3-HKNKOHSBTKBN   =   "3")   OR
                 (COMB-KOH4-HKNKOHSBTKBN   =   "3")
               CONTINUE
           ELSE
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPID        TO    HKN-HOSPID
               MOVE   COMB-HKNNUM        TO    HKN-HKNNUM
               MOVE   "00"               TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "HKNNUM-KEY2"      TO    ORC-DBPATH
               CALL   "ORCMCPSUB"         USING MCPAREA
                                                ORCMCPAREA
                                                MCPDATA-REC
               IF      MCP-RC            =     ZERO
                   MOVE    "HKNNUM-KEY2" TO    ORC-DBPATH
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL 
                     (FLG-HKNNUM     =    1)                       OR
                    ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            =  HKN-PAYKBN))
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM     =       0
                       PERFORM   YAKFTN-JOUGEN-SANTEI-SEC
                       IF    YAKFTN-SOGOKEI     >=   YAKFTN-JOUGEN
                           MOVE    YAKFTN-JOUGEN   TO  YAKFTN-SOGOKEI
                       END-IF
                   END-IF
               END-IF
      *
               MOVE    "DBCLOSE"         TO  MCP-FUNC
               MOVE    "HKNNUM-KEY2"     TO  ORC-DBPATH
               CALL    "ORCMCPSUB"        USING
                                          MCPAREA
                                          ORCMCPAREA
                                          MCPDATA-REC
      *
           END-IF.
      *
       YAKFTN-JOUGEN-HANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÃÙ∫ﬁ∞Ï…Ù…È√¥∂‚§ŒæÂ∏¬≥€§ÚªªƒÍ§π§Î                            *
      ******************************************************************
       YAKFTN-JOUGEN-SANTEI-SEC                SECTION.
      *
           MOVE    ZERO             TO    YAKFTN-JOUGEN.
      *    ¥µº‘…È√¥∂‚ªªΩ–¡∞§Œ£±£∞£∞°Û…È√¥≥€ªªΩ–
           MOVE      ZERO         TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX     FROM    1   BY  1
                     UNTIL     IDX         >   11
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                                      (LNK-SYU-HKNTEN (IDX) * 10)
           END-PERFORM.
      *     ›∏±¡»πÁ§ª•∆°º•÷•Î§Œ ‰Ωı∂Ë ¨§´§È ›∏±§Œ…È√¥≥‰πÁ§Ú ›∏±»÷πÊ
      *    •∆°º•÷•Î§À∫∆•ª•√•»
           IF    COMB-HKNNUM           =    "060"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "0"
                          MOVE   100       TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "1"
                          MOVE   90        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "2"
                          MOVE   80        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "3"
                          MOVE   70        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
           ELSE
               COMPUTE   HKN-HON-GAIKFTNRATE
                         =  100  -  HKN-HON-GAIKFTNRATE
               COMPUTE   HKN-KZK-GAIKFTNRATE
                         =  100  -  HKN-KZK-GAIKFTNRATE
               COMPUTE   HKN-TSY-GAIKFTNRATE
                         =  100  -  HKN-TSY-GAIKFTNRATE
               COMPUTE   HKN-TNK-GAIKFTNRATE
                         =  100  -  HKN-TNK-GAIKFTNRATE
           END-IF.
      *
           EVALUATE    FLG-SANSHOU
               WHEN    "1"
                   IF   COMB-HONKZKKBN    =   "1"
                       IF   HKN-HON-GAIKFTNRATE  NOT =   ZERO
                            COMPUTE    WK-FUTANWARI  =
                                           HKN-HON-GAIKFTNRATE  /  100
                            COMPUTE    YAKFTN-JOUGEN    =
                                           WK-ZENGAKU * WK-FUTANWARI
                       END-IF
                   ELSE
                       IF   HKN-KZK-GAIKFTNRATE  NOT =   ZERO
                            COMPUTE    WK-FUTANWARI  =
                                           HKN-KZK-GAIKFTNRATE  /  100
                            COMPUTE    YAKFTN-JOUGEN    =
                                           WK-ZENGAKU * WK-FUTANWARI
                       END-IF
                   END-IF
               WHEN    "2"
                   IF   HKN-TSY-GAIKFTNRATE     NOT =   ZERO
                        COMPUTE    WK-FUTANWARI  =
                                       HKN-TSY-GAIKFTNRATE
                                                      /  100
                        COMPUTE    YAKFTN-JOUGEN    =
                                       WK-ZENGAKU * WK-FUTANWARI
                   END-IF
               WHEN    "3"
                   IF   HKN-TNK-GAIKFTNRATE     NOT =   ZERO
                        COMPUTE    WK-FUTANWARI  =
                                       HKN-TNK-GAIKFTNRATE
                                                      /  100
                        COMPUTE    YAKFTN-JOUGEN    =
                                       WK-ZENGAKU * WK-FUTANWARI
                   END-IF
           END-EVALUATE.
      *
       YAKFTN-JOUGEN-SANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    «Ø∂‚Õ˙ŒÚ∆…π˛
      *****************************************************************
       TNKRRK-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TNKRRK-REC
               MOVE    ZERO            TO  FLG-TNKRRK
           ELSE
               INITIALIZE                  TNKRRK-REC
               MOVE    1               TO  FLG-TNKRRK
           END-IF
      *
           .
       TNKRRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ƒ„ΩÍ∆¿º‘Õ˙ŒÚ∆…π˛
      *****************************************************************
       TSYRRK-READ-SEC          SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TSYRRK-REC
               MOVE    ZERO            TO  FLG-TSYRRK
           ELSE
               INITIALIZE                  TSYRRK-REC
               MOVE    1               TO  FLG-TSYRRK
           END-IF
      *
           .
       TSYRRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±»÷πÊ•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       HKNNUM-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNNUM-REC
               MOVE    ZERO            TO  FLG-HKNNUM
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
      *
           .
       HKNNUM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *     ›∏±¡»πÁ§ª•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       HKNCOMBI-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNCOMBI-REC
               MOVE    ZERO            TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                  HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           .
       HKNCOMBI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ø«Œ≈≤Ò∑◊•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       SRYACCT-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACCT-REC
               MOVE    ZERO            TO  FLG-SRYACCT
           ELSE
               INITIALIZE                  SRYACCT-REC
               MOVE    1               TO  FLG-SRYACCT
           END-IF
      *
           .
       SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ø«Œ≈π‘∞Ÿ•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       SRYACT-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    •∑•π•∆•‡¥…Õ˝•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       SYSKANRI-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYS-1001-REC
                                           SYS-1026-REC
                                           SYS-1027-REC
                                           SYS-4001-REC
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               INITIALIZE                  SYS-1001-REC
                                           SYS-1026-REC
                                           SYS-1027-REC
                                           SYS-4001-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       SYSKANRI-READ-EXT.
           EXIT.
      *****************************************************************
      *    º˝«º•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       SYUNOU-READ-SEC          SECTION.
      *
       SYUNOU-READ-100.
      *----(01.00.23) LINE MOD START --------------------------
      * ø¿Æ£±£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *π‚Œº‘§Œ∫ﬂ¬¡ÌπÁ°¶∫ﬂ¬Àˆ¥¸ªªƒÍ¥µº‘
      *
           IF  LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
               MOVE    "DBFETCH"           TO  MCP-FUNC
               CALL    "ORCMCPSUB"          USING
                                            MCPAREA
                                            ORCMCPAREA
                                            MCPDATA-REC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC     TO  SYU-SYUNOU-REC
                   IF     (LNK-S01-SAIKEISAN-KBN    =   "1")    AND
                          (LNK-S01-SAIKEISAN-DENPYO =   SYU-DENPNUM)
                           GO    TO    SYUNOU-READ-100
                   ELSE
                           MOVE    ZERO    TO  FLG-SYUNOU
                   END-IF
               ELSE
                   INITIALIZE                  SYU-SYUNOU-REC
                   MOVE    1               TO  FLG-SYUNOU
               END-IF
           ELSE
               MOVE    "DBFETCH"           TO  MCP-FUNC
               CALL    "ORCMCPSUB"          USING
                                            MCPAREA
                                            ORCMCPAREA
                                            MCPDATA-REC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC     TO  SYU-SYUNOU-REC
                   IF     (LNK-S01-SAIKEISAN-KBN    =   "1")    AND
                          (LNK-S01-SAIKEISAN-DENPYO <=   SYU-DENPNUM)
                           GO    TO    SYUNOU-READ-100
                   ELSE
                           MOVE    ZERO    TO  FLG-SYUNOU
                   END-IF
               ELSE
                   INITIALIZE                  SYU-SYUNOU-REC
                   MOVE    1               TO  FLG-SYUNOU
               END-IF
           END-IF.
      *----(01.00.23) LINE MOD END   --------------------------
      *
       SYUNOU-READ-EXT.
           EXIT.
      
      *****************************************************************
      *    ¥µº‘æ Û∆…π˛
      *****************************************************************
       PTINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTINF-REC
               MOVE    ZERO            TO  FLG-PTINF
           ELSE
               INITIALIZE                  PTINF-REC
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           .
       PTINF-READ-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ≈¿øÙ•ﬁ•π•ø°º∆…π˛° ºÁ•≠°º°À
      *****************************************************************
       TENSU-READ-SEC         SECTION.
      *
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "DBSELECT"          TO  MCP-FUNC
           MOVE    "TENSU-KEY"         TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    "DBFETCH"           TO  MCP-FUNC
               MOVE    "TENSU-KEY"         TO  ORC-DBPATH
               CALL    "ORCMCPSUB"          USING
                                            MCPAREA
                                            ORCMCPAREA
                                            MCPDATA-REC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
                   MOVE    ZERO                TO  FLG-TENSU
               ELSE
                   MOVE    1                   TO  FLG-TENSU
                   INITIALIZE                  TNS-TENSU-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-TENSU
               INITIALIZE                  TNS-TENSU-REC
           END-IF
      *
           MOVE    "DBCLOSE"           TO  MCP-FUNC
           MOVE    "TENSU-KEY"         TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
      *
           .
       TENSU-READ-EXT.
           EXIT.
