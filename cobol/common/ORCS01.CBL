      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this licence along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION      DIVISION.
       PROGRAM-ID.         ORCS01.
      ****************************************************************
      *    OS           LINUX                                         
      *                                                               
      *    PROGRAM      ORCS01  /  負担金額算定サブ                   
      *                          （新老人保険対応）                   
      *  管理者            : 
      *  作成日付    作業者        記述
      *  00/12/01    MCC−小豆沢   新規作成
      ****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  01.00.01    MCC−小豆沢  01/06/05  薬剤一部負担金の算定ロジック
      *                                     修正
      *  01.00.02    MCC−小豆沢  01/06/11  今回請求額に保険適用外金額の
      *                                     加算もれ
      *  01.00.03    MCC−藤原    01/07/10  投薬のとき剤型区分でまとめる
      *  01.00.04    MCC−小豆沢  01/08/08  薬剤一部負担金の算定ロジック
      *                                     修正(上限チェック追加)
      *  01.00.05    MCC−小豆沢  01/10/17  薬剤一部負担金の算定ロジック
      *                                     修正(屯服薬剤の回数を１にセット)
      *  01.00.06    MCC−小豆沢  01/10/21  薬剤一部負担金の算定ロジック
      *                                     修正(上限金額の算出を処方薬剤の
      *                                          合計値に変更)
      *  01.00.07    MCC−小豆沢  01/10/25  薬剤一部負担金の算定ロジック
      *                                     修正(ＥＶＡＬＵＡＴＥのＷＨＥＮ
      *                                          条件を変更)
      *  01.00.08    MCC−小豆沢  02/01/09  患者負担無し、薬剤一部負担有り
      *                                     の公費使用時の請求金額算定を修正
      *  01.00.09    MCC−小豆沢  02/01/23  内服薬剤混合時の薬剤一部負担金
      *                                     算定を修正
      *  01.00.10    MCC−小豆沢  02/02/05  老人負担と公費負担の計算前クリア
      *                                     を追加
      *  01.00.11    MCC−小豆沢  02/03/07  薬剤一部負担金の計算時に剤点数が
      *                                     ２０点であれば同一薬剤のまとめ
      *                                     (種類数のカウント)をしないように
      *                                     修正
      *  01.00.12    MCC−小豆沢  02/02/12  老人４１保険の入力時にレセプトの
      *                                     患者負担額を１０円未満四捨五入を 
      *                                     行なわない金額にした
      *                                     (公費１の上限額あり限定で追加)
      *  01.00.13    MCC−小豆沢  02/02/13  患者負担区分に３：固定額を追加
      *  01.00.14    MCC−小豆沢  02/04/12  労災保険対応
      *                                     再計算時に診療区分毎の点数集計
      *                                     から円建て項目分の点数を減算する
      *  01.00.15    MCC−小豆沢  02/09/06  特定疾患の公費患者のレセプト
      *                                     一部負担金額を円単位で記載するよう
      *                                     修正（四捨五入処理をスキップ）
      *                                     ※患者負担金は１０円未満四捨五入
      *  01.00.16    MCC−小豆沢  02/09/09  労災保険対応
      *                                     労災保険時は患者請求額を無条件に
      *                                     ゼロ円とする
      *  01.00.17    MCC−小豆沢  02/09/10  老人４１保険の入力時にレセプトの
      *                                     患者負担額を１０円未満四捨五入を 
      *                                     行なわない条件に定額制の場合も
      *                                     追加した
      *  01.00.18    MCC−小豆沢  02/09/17  特定疾患レセプトの患者負担額の
      *                                     計算を訂正
      *  01.00.19    MCC−門脇    02/09/17  自賠責保険対応
      *  01.00.20    MCC−小豆沢  02/09/17  （平成１４年１０月改正対応）
      *                                     健保の高齢者について補助区分より
      *                                     負担割合をセット
      *  01.00.21    MCC−小豆沢  02/09/17  （平成１４年１０月改正対応）
      *                                     ３歳未満の患者については保険の
      *                                     負担割合を２割とする
      *                                     但し国保等で補助区分に１割が選択
      *                                     された場合、そちらを優先すること
      *  01.00.22    MCC−小豆沢  02/09/19  （平成１４年１０月改正対応）
      *                                     老人保険の８・９割対応
      *  01.00.23    MCC−小豆沢  02/09/25  （平成１４年１０月改正対応）
      *                                     寝たきり老人在宅総合診療料と
      *                                     在宅末期医療総合診療料の算定
      *                                     高齢者ついて負担額の上限を設定
      *  01.00.24    NACL−門脇   02/10/08  （平成１４年１０月改正対応）
      *                                     追加修正
      *  01.00.25    NACL−門脇   02/10/28  訂正時の減免算定修正
      *  01.00.26    NACL−小豆沢 02/12/05  ６５歳以上の寝たきり老人について
      *                                     薬剤負担金を算定しないよう修正
      *  01.00.27    NACL−小豆沢 02/12/20  ６５歳以上の寝たきり老人について
      *                                     薬剤負担金を算定しないよう修正
      *                                     （フラグ初期化位置変更）
      *  01.00.28    NACL−門脇   03/02/06  自費保険の課税対応
      *  01.00.29    NACL−門脇   03/03/07  老人限度額の集計変更
      *  01.00.30    NACL−門脇   03/03/24  平成１５年４月１日改正対応
      *                                     ＜薬剤一部負担金廃止＞
      *  01.00.31    NACL−門脇   03/03/25  更正・育成等の患者公費負担対応
      *  01.00.32    NACL−門脇   03/04/11  労災・自賠責負担金計算変更
      *                                     （労災非指定医療機関対応含む）
      *  01.00.33    NACL−門脇   03/04/15  自賠責文書料消費税対応
      *  01.00.34    NACL−門脇   03/04/16  船員保険（被保険者）＋通勤災害
      *                                     ＋初診時　対応
      *  01.00.35    NACL-門脇    03/05/07  地方老人の負担額の四捨五入の設定
      *                                     を保険番号マスタの設定で行う。
      *  01.00.36    NACL-門脇    03/05/12  自賠責の患者請求しない＜０％＞
      *                                     場合の対応
      *  01.00.37    NACL-門脇    03/05/21  減免の端数設定対応
      *  01.00.38    NACL-門脇    03/05/22  自賠責の療養担当手当対応
      *  01.00.39    NACL-門脇    03/06/06  消費税端数対応
      *  01.00.40    NACL-門脇    03/07/01  レセ記載用一部負担金編集修正
      *  01.00.41    NACL-門脇    03/08/27  特定疾患改正対応
      *  01.00.42    NACL-小豆沢  03/09/02  福岡県地方公費対応
      *  01.00.43    NACL-門脇    03/10/02  東京都地方公費対応
      *  01.00.44    NACL-小豆沢  03/11/19  患者負担金独自プログラム組込み
      *  01.00.45    NACL-門脇    04/01/14  診療行為の包括分は除く
      *                                     SRYACCT5→31
      *  01.00.46    NACL-門脇    04/01/15  消費税項目等追加項目編集
      *  01.00.47    NACL-門脇    04/02/10  生保の公費負担限度額設定
      *  01.00.48    NACL-小豆沢  04/02/19  福岡患者の給付外エリア初期化
      *  01.00.49    NACL-門脇    04/03/12  公費負担円単位編集
      *  01.00.50    NACL-門脇    04/04/06  在総診フラグ編集修正
      *  01.00.51    NACL-門脇    04/07/27  国保負担割合編集修正
      *  01.00.52    NACL-門脇    04/07/27  新潟県地方公費対応
      *  01.00.53    NACL-門脇    04/08/04  同一保険番号対応
      *
      *  01.01.01    NACL-門脇    04/08/10  複数保険・複数科入力対応
      *  01.01.02    NACL-門脇    04/08/20  兵庫県地方公費対応
      *  01.01.03    NACL-門脇    04/08/23  広島県地方公費対応
      *  01.01.04    NACL-門脇    04/09/07  １０円未満四捨五入しない場合
      *                                     の修正
      *  01.01.05    NACL-門脇    04/09/07  北海道地方公費対応
      *  01.01.06    NACL-門脇    04/09/08  生保単独の限度額修正
      *  01.01.07    NACL-門脇    04/09/09  山形県地方公費対応
      *  01.01.08    NACL-門脇    04/09/10  熊本県地方公費対応
      *  01.01.09    NACL-門脇    04/09/24  請求額端数処理対応
      *  01.01.10    NACL-門脇    04/10/01  自賠責特定器材等消費税対応
      *  01.01.11    NACL-門脇    04/10/21  公費四捨五入しない場合の修正
      *  01.01.12    NACL-門脇    04/11/15  公費月上限額取得修正
      *  01.01.13    NACL-門脇    04/11/24  埼玉県４１老人が長期と併用の
      *                                     場合、１００００円上限とする
      *  01.01.14    NACL-門脇    04/11/25  福島県乳幼児特殊計算対応
      *  01.01.15    NACL-門脇    05/01/14  岡山県乳幼児特殊計算対応
      *  01.01.16    NACL-門脇    05/03/04  静岡県母子障害が長期と併用の
      *                                     場合、１００００円上限とする
      *  01.01.17    NACL-門脇    05/03/23  保険組合せの上限区分編集
      *  01.02.01    NACL-門脇    05/03/24  小児特定上限対応
      *  01.02.02    NACL-門脇    05/03/30  大阪府地方公費＋長期対応
      *  01.02.03    NACL-門脇    05/04/13  静岡県地方公費対応
      *  01.02.04    NACL-門脇    05/05/06  茨城県地方公費対応
      *  01.02.05    NACL-門脇    05/06/09  低所得情報編集修正
      *  01.02.06    NACL-門脇    05/06/21  更生・育成が長期と併用の場合の対応
      *  01.02.07    NACL-門脇    05/06/22  兵庫県地方公費対応
      *  01.02.08    NACL-門脇    05/06/27  加算率３桁対応
      *  01.02.09    NACL-門脇    05/07/01  埼玉県新座市対応
      *  01.02.10    NACL-門脇    05/07/08  福井県地方公費対応
      *  01.02.11    NACL-門脇    05/07/12  秋田県地方公費対応
      *  01.02.12    NACL-小豆沢  05/07/15  自費１０項目対応
      *  01.02.13    NACL-門脇    05/07/19  収納項目追加に伴う修正
      *  01.02.14    NACL-門脇    05/08/25  福島、岡山、埼玉特殊計算修正
      *  01.02.15    NACL-門脇    05/08/26  長期についての算定修正
      *  01.02.16    NACL-門脇    05/09/01  省庁対応
      *  01.02.17    NACL-門脇    05/09/15  島根県地方公費対応
      *  01.02.18    NACL-門脇    05/09/21  全国土木建築、全国板金業＋
      *                                     精神、結核対応
      *  01.02.19    NACL-門脇    05/10/03  宮城県地方公費対応
      *  01.02.20    NACL-門脇    06/01/17  高齢者の主保険又は２７老人情報
      *                                     （円単位）修正
      *  01.02.21    NACL-門脇    06/02/17  特別療養費対応
      *  01.02.22    NACL-門脇    06/02/22  自費保険計算・集計先編集修正
      *  01.03.01    NACL-門脇    06/03/09  いわき市重心対応
      *  01.03.02    NACL-門脇    06/03/09  東京都マル障＋長期対応
      *  01.03.03    NACL-門脇    06/03/20  自立支援法対応
      *  01.03.04    NACL-門脇    06/03/30  自立支援法（高額療養費現物対応）
      *  01.03.05    NACL-門脇    06/04/04  在総診対象編集修正
      *  02.09.01    NACL-門脇    06/04/19  岩手県地方公費対応
      *  02.09.02    NACL-門脇    06/05/02  自立支援神戸市対応
      *  02.09.03    NACL-門脇    06/05/18  岡山県西粟倉村退職者国保２割対応
      *  02.09.04    NACL-門脇    06/06/09  自立支援神戸市対応修正
      *  02.09.05    NACL-門脇    06/06/12  自立支援の上限額がある場合の
      *                                     高齢者、長期に関する負担計算修正
      *  02.09.06    NACL-門脇    06/06/22  平成１８年４月以降の全国土木建築、
      *                                     全国板金業＋０２１精神対応
      *  03.01.01    NACL-門脇    06/07/06  領収書対応
      *  03.02.01    NACL-門脇    06/07/31  高齢者上限額経過措置対応
      *  03.02.02    NACL-門脇    06/08/17  茨城県地方公費対応
      *  03.02.03    NACL-門脇    06/08/18  岡山県地方公費１０月改正対応
      *  03.02.04    NACL-門脇    06/09/05  健康保険法１０月改正対応
      *  03.02.05    NACL-門脇    06/09/16  山梨県地方公費対応
      *  03.02.06    NACL-門脇    06/09/20  大分県地方公費１０月改正対応
      *  03.02.07    NACL-門脇    06/09/25  愛知県地方公費１０月改正対応
      *  03.02.08    NACL-門脇    06/10/02  東京都地方公費１０月改正対応
      *  03.02.09    NACL-門脇    06/10/03  神奈川県地方公費１０月改正対応
      *  03.03.01    NACL-門脇    06/10/17  減額・免除・支払猶予対応
      *  03.03.02    NACL-門脇    06/10/18  北海道地方公費対応
      *  03.03.03    NACL-門脇    06/10/23  地方公費保険番号マスタ低所得
      *                                     低年金タブ有効化対応
      *  03.03.04    NACL-門脇    06/10/30  障害児施設医療・療養介護医療
      *                                     対応
      *  03.03.05    NACL-門脇    06/11/02  減額・免除・支払猶予対応
      *  03.03.06    NACL-門脇    06/11/08  岡山県地方公費１０月改正対応
      *  03.03.07    NACL-門脇    06/11/09  高齢者で低所得かつ全国公費を
      *                                     もつ場合の上限額編集修正
      *  03.04.01    NACL-門脇    06/11/20  高額委任払い制度対応
      *  03.04.02    NACL-門脇    06/11/24  宮城県地方公費１０月改正対応
      *  03.04.03    NACL-門脇    06/12/01  自賠責健保準拠対応
      *  03.04.04    NACL-門脇    06/12/26  東京理容等＋精神、結核対応
      *  03.04.05    NACL-門脇    07/01/25  消費税総額表示対応
      *  03.04.06    NACL-門脇    07/02/05  北海道旭川市対応
      *  03.04.07    NACL-門脇    07/02/14  福島県飯館村対応
      *  03.04.08    NACL-門脇    07/03/19  高額現物給付対応
      *  03.04.09    NACL-門脇    07/03/22  埼玉県地方公費対応
      *                                     （川口・春日部市）
      *  03.04.10    NACL-門脇    07/04/26  広島県重心＋長期対応
      *  03.04.11    NACL-門脇    07/05/08  北海道旭川市対応
      *  03.04.12    NACL-門脇    07/06/13  現物給付高額４回目公費併用時対応
      *  03.05.00    NACL-多々納  07/04/26  グループ診療対応
      *  03.05.01    NACL-門脇    07/07/13  北海道地方公費対応
      *  03.05.02    NACL-門脇    07/07/20  北海道４１老人現物給付対応
      *  03.05.03    NACL-門脇    07/07/31  ７０歳未満現物給付保険者毎で計算
      *  03.05.04    NACL-門脇    07/08/01  所得情報取扱い機能強化対応
      *  03.05.05    NACL-門脇    07/08/01  月途中の所得情報変更対応
      *  03.05.06    NACL-門脇    07/08/10  北海道４１老人現物給付対応修正
      *  03.05.07    NACL-門脇    07/09/03  減額減免全国公費対応
      *  03.05.08    NACL-門脇    07/09/12  東京都マル子対応
      *  03.05.09    NACL-門脇    07/09/13  所沢市乳幼児対応
      *  03.05.10    NACL-門脇    07/09/27  特定保険者＋精神、結核対応修正
      *                                     （老人は対象外とする）
      *  04.01.01    NACL-門脇    07/10/05  患者減免自費対応
      *  04.01.02    NACL-門脇    07/10/24  自賠責特定器材等消費税対象外設定
      *                                     項目数拡張対応
      *  04.01.03    NACL-門脇    07/10/25  公務災害対応
      *  04.01.04    NACL-門脇    07/12/03  北海道特定疾患（道単独事業）対応
      *  04.01.05    NACL-門脇    07/12/07  公害対応
      *  04.01.06    NACL-門脇    08/01/17  高齢者３割在総診計算修正
      *  04.01.07    NACL-門脇    08/01/18  埼玉県川島町地方公費対応
      *  04.01.08    NACL-門脇    08/01/31  大阪府２８０追加に伴う修正
      *  04.02.01    NACL-門脇    08/02/29  平成２０年４月改正対応
      *  04.02.02    NACL-門脇    08/03/06  生保一部負担金編集修正
      *  04.02.03    NACL-門脇    08/03/21  肝炎治療対応
      *  04.02.04    NACL-門脇    08/03/24  神奈川県４１老人対応
      *  04.02.05    NACL-門脇    08/03/24  宮城県乳幼児、北海道精神補助の
      *                                     変則対応終了
      *  04.02.06    NACL-門脇    08/03/24  鳥取県地方公費対応
      *  04.02.07    NACL-門脇    08/03/25  大阪府地方公費対応
      *  04.02.08    NACL-門脇    08/04/08  北海道道老廃止
      *  04.02.09    NACL-門脇    08/04/24  埼玉県志木市地方公費対応
      *  04.02.10    NACL-門脇    08/04/28  埼玉県川越市地方公費対応
      *  04.02.11    NACL-門脇    08/05/01  後期高齢者月途中保険者変更対応
      *  04.02.12    NACL-門脇    08/05/22  在総診判定条件修正
      *  04.02.13    NACL-門脇    08/05/29  現物給付保険者単位条件追加
      *  04.02.14    NACL-門脇    08/06/24  後期高齢者の現物給付対象編集修正
      *  04.02.15    NACL-門脇    08/06/30  高齢者一般経過措置延長対応
      *  04.02.16    NACL-門脇    08/08/28  佐賀県地方公費対応（乳幼児）
      *  04.02.17    NACL-門脇    08/09/01  徳島県地方公費対応（乳幼児）
      *  04.02.18    NACL-門脇    08/09/09  建設連合組合＋精神、結核対応
      *  04.02.19    NACL-門脇    08/10/02  北海道特定疾患対応
      *  04.02.20    NACL-門脇    08/10/06  広島県地方公費対応
      *  04.02.21    NACL-門脇    08/10/22  神戸市地方公費大阪府対応
      *  04.02.22    NACL-門脇    08/11/05  鳥取県地方公費対応
      *  04.02.23    NACL-門脇    08/11/10  広島県地方公費対応
      *  04.02.24    NACL-門脇    08/11/13  現物給付合算条件修正（任継、継続）
      *
      *  04.03.01    NACL-門脇    08/09/25  自賠責０９５９３の集計先対応
      *  04.03.02    NACL-門脇    08/11/26  兵庫県医師国保組合＋精神、結核対応
      *  04.03.03    NACL-門脇    08/12/08  福岡県地方公費対応修正
      *  04.03.04    NACL-門脇    08/12/09  大阪府地方公費対応
      *  04.03.05    NACL-門脇    08/12/16  平成２１年１月改正対応
      *  04.03.06    NACL-門脇    09/01/20  大阪府地方公費対応
      *  04.03.07    NACL-門脇    09/02/26  広島県地方公費対応
      *  04.03.08    NACL-門脇    09/02/26  ７５歳以上の前期高齢者対応
      *  04.03.09    NACL-門脇    09/03/13  前期高齢者の高額計算対応
      *  04.03.10    NACL-門脇    09/03/27  マル長対応
      *  04.03.11    NACL-門脇    09/04/01  埼玉県地方公費対応
      *
      *  04.04.01    NACL-門脇    09/02/17  地方公費の公費付加情報対応
      *  04.04.02    NACL-門脇    09/04/13  平成２１年５月改正対応
      *  04.04.03    NACL-門脇    09/04/15  東京都地方公費
      *                                     平成２１年４月改正対応
      *  04.04.04    NACL-門脇    09/06/01  平成２１年５月改正対応
      *                                     （東京都１５１）
      *  04.04.05    NACL-門脇    09/06/11  ７０歳未満の高額計算対応
      *  04.04.06    NACL-門脇    09/09/03  全国土木＋精神、結核対応
      *                                     （奈良県）
      *  04.04.07    NACL-門脇    09/09/07  愛知県単独５１対応
      *  04.04.08    NACL-門脇    09/09/17  東京都マル子対応
      *                                     （平成２１年１０月診療〜）
      *  04.04.09    NACL-門脇    09/10/01  埼玉県地方公費対応
      *  04.04.10    NACL-門脇    09/10/09  兵庫県地方公費対応
      *  04.04.11    NACL-門脇    09/10/13  上限額１円単位の対応（７９等）
      *  04.04.12    NACL-門脇    09/10/15  累計ベース計算対応
      *  04.04.13    NACL-門脇    09/11/12  東京都地方公費神奈川県対応
      *  04.04.14    NACL-門脇    09/11/13  熊本県地方公費対応
      *  04.04.15    NACL-門脇    09/11/19  自賠責健保準拠療養担当手当対応
      *  04.04.16    NACL-門脇    09/12/02  平成２１年５月改正対応
      *                                     （５２の対象負担者番号追加）
      *  04.04.17    NACL-門脇    09/12/08  累計ベース計算対応（京都府）
      *  04.04.18    NACL-門脇    09/12/14  埼玉県地方公費対応
      *                                     （新座・朝霞・和光・志木市）
      *  04.04.19    NACL-門脇    09/12/14  大阪府地方公費対応
      *  04.04.20    NACL-門脇    09/12/15  埼玉県地方公費対応（八潮市）
      *  04.04.21    NACL-門脇    09/12/25  埼玉県地方公費対応（新座市）
      *  04.04.22    NACL-門脇    09/12/25  埼玉県地方公費対応（朝霞市）
      *  04.04.23    NACL-門脇    10/03/05  ７０歳代前半の特例措置延長対応
      *  04.04.24    NACL-門脇    10/03/09  前期高齢者の高額計算修正
      *  04.04.25    NACL-門脇    10/04/14  埼玉県地方公費対応（行田市）
      *  04.04.26    NACL-門脇    10/05/21  茨城県地方公費対応
      *  04.04.27    NACL-門脇    10/07/20  肝炎複数公費対応
      *  04.04.28    NACL-門脇    10/08/06  自立支援栃木県独自対応
      *  04.04.29    NACL-門脇    10/08/23  高齢非該当対応
      *  04.04.30    NACL-門脇    10/08/27  秋田県地方公費対応
      *  04.04.31    NACL-門脇    10/09/02  長崎県地方公費対応
      *  04.04.32    NACL-門脇    10/11/09  大分県地方公費対応
      *  04.04.33    NACL-門脇    10/11/12  神戸市地方公費千葉県対応
      *  04.04.34    NACL-門脇    10/11/15  宮城県地方公費対応
      *  04.04.35    NACL-門脇    10/12/06  埼玉県地方公費対応
      *  04.04.36    NACL-門脇    11/01/19  ７０歳未満現物給付時の計算修正
      *
      *  04.05.01    NACL-門脇    09/06/16  一括再計算方法選択機能対応
      *  04.05.02    NACL-門脇    09/06/22  数量小数５桁対応
      *  04.05.03    NACL-門脇    09/06/25  保険、自費それぞれの請求額端数
      *                                     設定機能
      *  04.05.04    NACL-多々納  09/12/15  調整金２対応
      *  04.05.05    NACL-門脇    10/01/07  治験対応
      *  04.05.06    NACL-門脇    10/01/26  東京都マル子追加対応
      *  04.05.07    NACL-門脇    10/03/26  一括再計算方法選択機能対応修正
      *  04.05.08    NACL-門脇    11/02/18  ７０歳代前半の特例措置延長対応
      *  04.05.09    NACL-門脇    11/02/28  長崎県地方公費対応
      *  04.05.10    NACL-門脇    11/03/02  山梨県地方公費対応
      *  04.05.11    NACL-門脇    11/03/04  群馬県地方公費対応
      *  04.05.12    NACL-門脇    11/03/09  福島県地方公費対応
      *  04.05.13    NACL-門脇    11/03/28  特定保険者＋精神、結核対応
      *                                     (233064)平成２３年３月まで
      *  04.05.14    NACL-門脇    11/04/07  特定保険者＋精神、結核対応
      *                                     (133280)平成２３年３月まで
      *  04.05.15    NACL-門脇    11/04/14  ７０歳未満現物給付計算修正
      *                                     自立支援(999999)の月途中変更時
      *  04.05.16    NACL-門脇    11/05/11  マル長計算修正
      *  04.05.17    NACL-門脇    11/07/19  広島県地方公費対応
      *  04.05.18    NACL-門脇    11/09/07  茨城県地方公費対応
      *  04.05.19    NACL-門脇    11/10/05  岡山県西粟倉村退職者国保２割対応
      *                                     修正（平成２３年９月まで）
      *  04.05.20    NACL-門脇    11/11/02  大阪府地方公費対応
      *  04.05.21    NACL-門脇    11/11/09  同日再入院食事対応
      *  04.05.22    NACL-門脇    11/11/17  埼玉県地方公費対応（松伏町）
      *  04.05.23    NACL-門脇    11/12/01  宮城県地方公費対応（仙台市）
      *  04.05.24    NACL-門脇    11/12/02  神戸市地方公費京都府対応
      *  04.05.25    NACL-門脇    11/12/05  特定保険者＋精神、結核対応
      *                                     (283077)平成２３年１１月まで
      *  04.05.26    NACL-門脇    12/01/16  群馬県地方公費対応
      *  04.05.27    NACL-門脇    12/02/08  宮城県地方公費対応（仙台市）修正
      *  04.05.28    NACL-門脇    12/02/10  東京都地方公費対応（マル都）修正
      *  04.05.29    NACL-門脇    12/02/20  福島県地方公費対応（田村市）
      *  04.05.30    NACL-門脇    12/02/20  東京都地方公費対応（マル都）対応
      *  04.05.31    NACL-門脇    12/03/05  ７０歳代前半の特例措置延長対応
      *  04.05.32    NACL-門脇    12/03/05  特定保険者＋精神、結核対応
      *                                     平成２４年３月まで
      *  04.05.33    NACL-門脇    12/03/09  改正対応：外来現物給付対応
      *  04.05.34    NACL-門脇    12/03/15  千葉県地方公費対応
      *  04.05.35    NACL-門脇    12/03/23  熊本県地方公費対応
      *  04.05.36    NACL-門脇    12/04/27  大阪府地方公費＋長期対応
      *  04.05.37    NACL-門脇    12/05/01  減（割）計算対応
      *  04.05.38    NACL-門脇    12/05/02  現物給付（高齢者）＋長期
      *                                     ・低所得者の計算修正
      *                                     ・一括再計算メッセージ表示の対
      *                                       象外とする
      *  04.05.39    NACL-門脇    12/05/16  愛知・三重県地方公費対応
      *  04.05.40    NACL-門脇    12/05/30  災害対応（日雇特例被保険者）
      *  04.05.41    NACL-門脇    12/06/05  広島県地方公費対応
      *  04.05.42    NACL-門脇    12/06/19  広島県地方公費＋長期対応
      *  04.05.43    NACL-門脇    12/06/29  大分県地方公費福岡県対応
      *  04.05.44    NACL-門脇    12/07/04  広島県地方公費対応
      *  04.05.45    NACL-門脇    12/09/18  熊本県地方公費対応
      *  04.05.46    NACL-門脇    12/09/19  福島県地方公費対応
      *  04.05.47    NACL-門脇    12/09/26  秋田県地方公費対応
      *  04.05.48    NACL-門脇    12/10/01  埼玉県地方公費対応
      *  04.05.49    NACL-門脇    12/10/09  大分県地方公費対応
      *                                     （システム管理２０１０設定追加）
      *  04.05.50    NACL-門脇    12/10/11  複数科まとめ時の収納読み飛ばし
      *                                     条件修正
      *  04.05.51    NACL-門脇    12/11/05  北海道旭川市対応
      *  04.05.52    NACL-門脇    12/11/16  大阪府地方公費対応
      *  04.05.53    NACL-門脇    12/12/10  神戸市地方公費高知県対応
      *  04.05.54    NACL-門脇    12/12/10  ７５歳到達月の特例非該当対応
      *  04.05.55    NACL-門脇    12/12/19  大阪府地方公費対応
      *
      *  04.06.01    NACL-門脇    10/09/02  出産育児一時金直接支払制度（外来）
      *  04.06.02    NACL-門脇    10/11/08  主保険＋マル長の請求対応
      *  04.06.03    NACL-門脇    12/07/30  高額委任払い制度上限額０円対応
      *  04.06.04    NACL-門脇    12/11/20  特記事項０１（公）に関わる窓口計算・
      *                                     レセプト一部負担金記載対応
      *  04.06.05    NACL-門脇    13/02/18  労災レセ電対応
      *                                     （新診療行為コード対応）
      *  04.06.06    NACL-門脇    13/03/01  ７０歳代前半の特例措置延長対応
      *  04.06.07    NACL-門脇    13/03/05  北海道地方公費対応
      *  04.06.08    NACL-門脇    13/05/02  埼玉県地方公費対応
      *  04.06.09    NACL-門脇    13/08/08  山口県地方公費対応
      *  04.06.10    NACL-門脇    13/09/17  宮城県地方公費対応
      *  04.06.11    NACL-門脇    13/10/16  滋賀県地方公費対応
      *  04.06.12    NACL-門脇    13/11/28  後期高齢の月途中県外転出対応
      *
      *  04.07.01    NACL-門脇    11/09/01  システム管理２０１０機能追加対応
      *  04.07.02    NACL-門脇    11/10/17  法定外現物給付対応（法別１０、２１）
      *  04.07.03    NACL-門脇    12/04/26  減免計算対象区分（自費分のみ）対応
      *  04.07.04    NACL-門脇    12/08/27  システム管理２０１０機能追加対応
      *  04.07.05    NACL-門脇    12/11/15  システム管理２０１０機能追加対応
      *  04.07.06    NACL-門脇    13/07/01  システム管理２０１０機能追加対応
      *  04.07.07    NACL-門脇    13/07/10  自賠責（第三者行為）対応
      *  04.07.08    NACL-門脇    13/11/11  減額（円）の対応
      *  04.07.09    NACL-門脇    14/01/28  東京都地方公費収納項目編集修正
      *  04.07.10    NACL-門脇    14/02/19  自賠責（第三者行為）対応
      *                                     （負担金額１０円未満四捨五入）
      *  04.07.11    NACL-門脇    14/02/21  公務災害（労災準拠）の点数単価設定
      *                                     対応
      *  04.07.12    NACL-門脇    14/03/04  平成２６年４月改正対応
      *  04.07.13    NACL-門脇    14/05/02  前期高齢者２割（低所得・低年金）の
      *                                     上限額修正
      *  04.07.14    NACL-門脇    14/05/15  船員等の下船後は、限度額認定証が
      *                                     ないものとみなす
      *  04.07.15    NACL-門脇    14/07/17  マル長患者で、月途中に公費が追加と
      *                                     なった場合の対応
      *  04.07.16    NACL-門脇    14/07/31  第三者行為の現物給付対応
      *  04.07.17    NACL-門脇    14/08/08  特定負有＋特定負有の負担金計算対応
      *  04.07.18    NACL-門脇    14/08/11  ７５歳以上の海外居住者２割対応
      *  04.07.19    NACL-門脇    14/11/04  平成２７年１月改正対応
      *                                     （０５４、０５２対応）
      *                                     （高額療養費対応）
      *  04.07.20    NACL-門脇    14/12/09  東京都地方公費神奈川県対応
      *  04.07.21    NACL-門脇    15/01/05  東京都地方公費対応
      *  04.07.22    NACL-門脇    15/01/21  難病複数対応
      *  04.07.23    NACL-門脇    15/01/26  平成２７年１月改正対応
      *                                     （都道府県独自難病対応）
      *  04.07.24    NACL-門脇    15/02/02  システム管理２０１０機能追加対応
      *  04.07.25    NACL-門脇    15/03/04  東京都地方公費対応
      *  04.07.26    NACL-門脇    15/04/03  愛知県地方公費対応
      *  04.07.27    NACL-門脇    15/04/09  全国公費併用時の特別計算修正
      *  04.07.28    NACL-門脇    15/05/07  システム管理２０１０の
      *                                     「現物給付対象者の特別計算」
      *                                     「長期併用時の特別計算」
      *                                     「負担金未発生分の回数カウント」
      *                                     の機能について、診療済みデータ
      *                                     のセレクト条件修正
      *  04.07.29    NACL-門脇    15/05/28  神戸市地方公費神奈川県対応
      *  04.07.30    NACL-門脇    15/06/08  難病の実施機関番号追加対応（６０２）
      *  04.07.31    NACL-門脇    15/06/29  高額委任払の＋アルファーの
      *                                     負担金計算対応（保険番号９６４）
      *  04.07.32    NACL-門脇    15/08/07  システム管理２０１０−長期併用時の
      *                                     特別計算（外来）について、
      *                                     回上限額設定のある公費も対象とする
      *  04.07.37    NACL-門脇    15/08/31  長期併用時の特別計算の関係で、
      *                                     千葉県の前期高齢（１割）の
      *                                     長期の一部負担金は１割計算で行う
      *  04.07.38    NACL-門脇    15/09/02  東京都地方公費対応
      *
      *  04.08.01    NACL-門脇    15/10/05  難病特記事項対応
      *  04.08.02    NACL-門脇    15/10/08  システム管理２０１０機能追加対応
      *  04.08.03    NACL-門脇    15/11/11  北海道地方公費対応
      *  04.08.04    NACL-門脇    15/11/27  全国公費が月上限額に達する日の
      *                                     地方公費一部負担金編集対応
      *  04.08.05    NACL-門脇    15/12/01  現物給付の一括再計算メッセージ
      *                                     表示の条件修正（訂正時）
      *  04.08.06    NACL-門脇    16/03/14  システム管理２０１０
      *                                     月途中受給者証変更時負担金計算
      *                                     神戸市対応
      *  04.08.07    NACL-門脇    16/04/27  東京都地方公費対応
      *  04.08.08    NACL-門脇    16/05/30  １９原爆一般の特殊計算対応
      *  04.08.09    NACL-門脇    16/06/28  熊本県地方公費対応
      *  04.08.10    NACL-門脇    16/07/21  ７０歳未満現物給付の高額公費適用
      *                                     チェック
      *  04.08.11    NACL-門脇    16/07/26  現物給付対象者の一括再計算該当
      *                                     判定修正
      *  04.08.12    NACL-門脇    16/07/27  日・月上限額設定のない地方公費
      *                                     ＋マル長の負担金計算対応
      *  04.08.13    NACL-門脇    16/10/18  設定額を助成する負担金計算修正
      *  04.08.14    NACL-門脇    16/11/11  減額（円超）の対応
      *  04.08.15    NACL-門脇    16/11/12  徳島県地方公費対応
      *  04.08.16    NACL-門脇    17/02/10  大阪府地方公費対応
      *  04.08.17    NACL-門脇    17/06/02  減免（減額（割））の負担金計算・
      *                                     レセプト対応
      *  04.08.18    NACL-門脇    17/06/02  熊本県地方公費負担金計算対応
      *                                     （減免（減額（割））適用時）
      *  04.08.19    NACL-門脇    17/06/29  平成２９年８月改正
      *                                     （高額療養費制度の見直し）
      *  04.08.20    NACL-門脇    17/07/14  和歌山県地方公費対応
      *  04.08.21    NACL-門脇    17/09/15  福島県地方公費対応
      *  04.08.22    NACL-門脇    17/10/12  大阪府地方公費対応
      *  04.08.23    NACL-門脇    17/10/18  入院料と異なる保険組み合わせ
      *                                     での食事算定対応
      *  04.08.24    NACL-門脇    17/12/07  熊本県地方公費対応
      *  04.08.25    NACL-門脇    17/12/15  第三者行為現物給付に関わる
      *                                     負担金計算対応
      *  04.08.26    NACL-門脇    18/04/04  難病負担者番号追加対応
      *  04.08.27    NACL-門脇    18/05/15  ７０歳未満現物給付計算修正
      *  04.08.28    NACL-門脇    18/05/31  計算金額桁数チェック
      *  04.08.29    NACL-門脇    18/07/02  平成３０年８月改正
      *                                     （高額療養費制度の見直し）
      *  04.08.30    NACL-門脇    18/07/11  北海道旭川市対応修正
      *  04.08.31    NACL-門脇    18/07/26  ７０歳未満現物給付＋公費の
      *                                     負担金計算修正
      *  04.08.32    NACL-門脇    18/09/13  北海道地方公費対応
      *****************************************************************
       ENVIRONMENT         DIVISION.
       CONFIGURATION       SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                DIVISION.
       FILE                        SECTION.
      *
       WORKING-STORAGE SECTION.
      *
       01  FLG-AREA.
           03  FLG-SYUNOU              PIC 9(01).
           03  FLG-HKNNUM              PIC 9(01).
           03  FLG-PTHKNINF            PIC 9(01).
           03  FLG-HKNCOMBI            PIC 9(01).
           03  FLG-SYSKANRI            PIC 9(01).
           03  FLG-PTINF               PIC 9(01).
           03  FLG-PTKOHINF            PIC 9(01).
           03  FLG-SRYACCT             PIC 9(01).
           03  FLG-SRYACT              PIC 9(01).
           03  FLG-PTKOHFTNETC         PIC 9(01).
           03  FLG-NYUGAI              PIC 9(01).
           03  FLG-NYUGAI2             PIC 9(01).
           03  FLG-SANSHOU             PIC X(01).
           03  FLG-SANSHOU2            PIC X(01).
           03  FLG-SANSHOU3            PIC X(01).                       
           03  FLG-SANTEI1             PIC X(01).
           03  FLG-SANTEI2             PIC X(01).
           03  FLG-SANTEI3             PIC X(01).
           03  FLG-SANTEI4             PIC X(01).
           03  FLG-FTNKIN1             PIC X(01).
           03  FLG-FTNKIN2             PIC X(01).
           03  FLG-FTNKIN3             PIC X(01).
           03  FLG-SHOHOZUMI           PIC X(01).
           03  FLG-YAKFTN              PIC X(01).
           03  FLG-KUMAMOTO            PIC X(01).
           03  FLG-TAIGAI              PIC X(01).
      *
           03  FLG-ZAIGATAKBN          PIC 9(01).
           03  FLG-TENSU               PIC 9(01).
           03  FLG-ADDKBN              PIC 9(01). 
      *
           03  FLG-LOCALRJN            PIC 9(01).
           03  FLG-NOCOUNT             PIC 9(01).
           03  FLG-GRPNYURYOKU         PIC 9(01).
           03  FLG-GENMEN              PIC 9(01).
           03  FLG-SEISINJYO           PIC 9(01).
           03  FLG-TOKUREI-HKNJYA      PIC 9(01).
           03  FLG-MIYAGI              PIC 9(01).
           03  FLG-KEIKASOCHI-IPAN     PIC 9(01).
           03  FLG-TOKYO               PIC 9(01).
           03  FLG-HIKAKU              PIC 9(01).
           03  FLG-HIKAKU2             PIC 9(01).
           03  FLG-HIKAKU3             PIC 9(01).
           03  FLG-HIKAKU4             PIC 9(01).
           03  FLG-KOHININBARAI        PIC 9(01).
           03  FLG-KOHYONKAIME         PIC 9(01).
           03  FLG-GENBUTU70           PIC 9(01).
           03  FLG-GENBUTU70-KBN       PIC 9(02).
           03  FLG-GEN70-TOKUSYU       PIC 9(01).
           03  FLG-SYUKEI              PIC 9(01).
           03  FLG-SYUKEI2             PIC 9(01).
           03  FLG-SYUKEI3             PIC 9(01).
           03  FLG-GENBUTU-TAISYODATA  PIC 9(01).
           03  FLG-GENBUTU-OK          PIC 9(01).
           03  FLG-KENPOJYUNKYO        PIC 9(01).
           03  FLG-SYUGAKUMAE          PIC 9(01).
           03  FLG-TAISYO              PIC 9(01).
           03  FLG-ZENKI-TOKUREI       PIC 9(01).
           03  FLG-ZAIARI              PIC 9(01).
           03  FLG-CHECK-OK            PIC 9(01).
           03  FLG-TOKU75              PIC 9(01).
           03  FLG-TOKU75-KIZON        PIC 9(01).
           03  FLG-TOKU75-CYO          PIC 9(01).
           03  FLG-KEISAN-TAI2         PIC 9(01).
           03  FLG-RUITAISYO           PIC 9(01).
           03  FLG-KOKI-HIGAITO        PIC 9(01).
           03  FLG-CYOKI-ARI           PIC 9(01).
           03  FLG-TOKUSITU            PIC 9(01).
           03  FLG-TOKUSITU-XXX        PIC 9(01).
           03  FLG-TOKUSITU-KBN        PIC 9(02).
           03  FLG-MARUKO              PIC 9(01).
           03  FLG-RUIKEIYO            PIC 9(01).
           03  FLG-RUIKEIYO2           PIC 9(01).
           03  FLG-IKTKEISANKBN        PIC 9(01).
           03  FLG-KOHFUKA-HENSYU      PIC 9(01).
           03  FLG-MARUTOARI           PIC 9(01).
           03  FLG-MARUTOARI2          PIC 9(01).
           03  FLG-FTNRATE100          PIC 9(01).
           03  FLG-KUMAMOTO-CYO        PIC 9(01).
           03  FLG-KOREI-HIGAITO       PIC 9(01).
           03  FLG-OITA-GENBUTU70      PIC 9(01).
           03  FLG-OITA-SYUKEI         PIC 9(01).
           03  FLG-SAIGAI-TAISYO       PIC 9(01).
           03  FLG-SYUNOU-HKN-HANTEI   PIC 9(01).
           03  FLG-HANBETU             PIC 9(01).
           03  FLG-HANBETU2            PIC 9(01).
           03  FLG-ICHIBU-JYOSEI       PIC 9(01).
           03  FLG-ZEROKOGAITO         PIC 9(01).
           03  FLG-PTRSIINF            PIC 9(01).
           03  FLG-KOMURSI             PIC 9(01).
           03  FLG-DAISAN-GENBUTU      PIC 9(01).
           03  FLG-DAISAN-GENBUTU2     PIC 9(01).
           03  FLG-ARI                 PIC 9(01).
           03  FLG-OK                  PIC 9(01).
           03  FLG-HOKKAIDO            PIC 9(01).
           03  FLG-NG                  PIC 9(01).
           03  FLG-TAINFTN             PIC 9(01).
           03  FLG-TAINFTN2            PIC 9(01).
           03  FLG-JGNGAK-CHECK        PIC 9(01).
           03  FLG-JGNGAK-CHECK2       PIC 9(01).
           03  FLG-GENGAKU-HENSYU      PIC 9(01).
           03  FLG-WAKAYAMA-HANTEI     PIC 9(01).
           03  FLG-IRYOKEIKBN          PIC 9(01).
           03  FLG-KOUREI-GENEKIKBN    PIC 9(01).
           03  FLG-GENBUTU-CHECK       PIC 9(01).
           03  FLG-GENBUTU-CHECK-ERR   PIC 9(01).
      *
      *    添え字領域
       01  IDX-AREA.
           03  IDX                     PIC  9(02)  VALUE  ZERO.
           03  IDY                     PIC  9(02)  VALUE  ZERO.
           03  IDZ                     PIC  9(02)  VALUE  ZERO.
           03  IDX2X                   PIC  X(02).
           03  IDX2R                   REDEFINES    IDX2X.
               05  IDX2                PIC  9(02).
           03  IDX3                    PIC  9(02).
           03  IDX4                    PIC  9(03).
           03  IDX5                    PIC  9(03).
           03  IDX6                    PIC  9(03).
           03  IDX7                    PIC  9(03).
           03  IDX8                    PIC  9(03).
           03  IDX9                    PIC  9(03).
           03  IDX10                   PIC  9(03).
           03  IDX11                   PIC  9(02).
           03  IDX12                   PIC  9(02).
           03  IDX13                   PIC  9(03).
           03  IDX14                   PIC  9(03).
           03  IDX16                   PIC  9(03).
           03  IDX17                   PIC  9(03).
           03  IDX19                   PIC  9(03).
           03  Y-IDX                   PIC  9(03)  VALUE  ZERO.
           03  Y-IDX2                  PIC  9(03)  VALUE  ZERO.
           03  Y-IDX3                  PIC  9(03)  VALUE  ZERO.
           03  Y-IDX4                  PIC  9(03)  VALUE  ZERO.
           03  Y-IDX5                  PIC  9(03)  VALUE  ZERO.
           03  HKNGAI-IDX              PIC  9(02)  VALUE  ZERO.
           03  DSP-IDX                 PIC  9(02)  VALUE  ZERO.
           03  DSP-IDX2                PIC  9(02)  VALUE  ZERO.
           03  KOH-IDX                 PIC  9(02)  VALUE  ZERO.
           03  GEN-IDX                 PIC  9(02).
           03  SYOTOKU-IDX             PIC  9(02).
           03  CHECK-IDX               PIC  9(02).
           03  CHECK-IDX2              PIC  9(02).
           03  KOHFUKA-IDX             PIC  9(02).
           03  KOHFUKA-IDX2            PIC  9(01).
           03  IDX-CYO                 PIC  9(03).
           03  IDX-CYO2                PIC  9(03).
      *
       01  WRK-AREA.
           03  WK-KNJFTNKIN            PIC 9(10).
           03  WK-KNJFTNKIN-ENTANI     PIC 9(08)V9(01).
           03  WK-ENTANI               PIC 9(08).
           03  WK-ENTANI2              PIC 9(08).
           03  WK-CYOKI                PIC 9(08).
           03  WK-CYOKI-ENTANI         PIC 9(08).
           03  WK-CYOKI-ZAN            PIC 9(08).
           03  WK-CYOKI-ZAN-ENTANI     PIC 9(08).
           03  WK-ZENGAKU              PIC 9(10).
           03  WK-ZENGAKU-SYU          PIC 9(10).
           03  WK-ZENGAKU-YAK          PIC 9(10).
           03  WK-FTNKIN1              PIC 9(10).
           03  WK-FTNKIN2              PIC 9(10).
           03  WK-FTNKIN3              PIC 9(10).
           03  WK-FUTANWARI            PIC 9V99.
           03  WK-FUTANWARI2           PIC 9V99.
           03  WK-SEIKYUGK             PIC 9(10).
           03  WK-YAKFTN-TENSUU        PIC 9(10).
           03  WK-GAIKFTNRATE          PIC 9(03).
           03  WK-GAIKFTNRATE2         PIC 9(03).
           03  WK-GAIKFTNRATE-TOKUSYU  PIC 9(03).
           03  WK-GAIKFTNRATE019       PIC 9(03).
           03  WK-GAIYKZFTNKBN         PIC X(01).
           03  WK-GAIKKOTGAK           PIC 9(06).
           03  WK-TOKUTEI-COMPFTN      PIC 9(08).
           03  WK-TOKUTEI-COMPFTN2     PIC 9(08).
           03  WK-TOKUTEI-COMPFTN3     PIC 9(08).
           03  WK-TOKUTEI-COMPFTN4     PIC 9(08).
           03  WK-HANGAKU-COMPFTN      PIC 9(07).
           03  WK-HANGAKU-ENTANI       PIC 9(07)V9(01).
           03  WK-GENMEN-KEISAN        PIC 9(10).
           03  WK-GENMEN-KEISAN2       PIC 9(10).
           03  WK-MIYAGI-COMPFTN       PIC 9(07).
           03  WK-SEISIN-COMPFTN       PIC 9(07).
           03  WK-JYOSEIGAKU           PIC 9(07).
           03  WK-KEISU                PIC 9V99.
           03  WK-JIHIGAKU             PIC 9(10).
           03  WK-JIHIGAKU2            PIC 9(10).
           03  WK-JIHIGAKU3            PIC 9(10).
           03  WK-JIHIFTN              PIC 9V99.
           03  WK-ZAN-JIRITU           PIC 9(08).
           03  WK-KOH-GENDOGAKU        PIC 9(07).
           03  WK-GEN70-GENDOGAKU      PIC 9(07).
           03  WK-GEN70-GENDOGAKU2     PIC 9(07).
           03  WK-SKYMONEY-ZEI         PIC 9(07).
           03  WK-RSIETC-ZEITAISYO     PIC 9(07).
           03  WK-KEISAN-JIBAI         PIC 9(07).
           03  WK-GENBUTU-HKNKIN       PIC 9(10).
           03  WK-GENBUTU-HKNKIN2      PIC 9(10).
           03  WK-GENBUTU-HKNKIN3      PIC 9(10).
           03  WK-GENBUTU-SYUMAXKIN    PIC 9(10).
           03  WK-GENBUTU-FTNKIN       PIC 9(10).
           03  WK-GENBUTU-SKYMONEY     PIC 9(10).
           03  WK-SEIHO-GENDO          PIC 9(07).
           03  WK-SEIHO-GENDO70        PIC 9(07).
           03  WK-CYOKI-GENDO          PIC 9(07).
           03  WK-CYOKI-GENDO2         PIC 9(07).
           03  WK-KOH-GENDOGAKU-TOKU75 PIC 9(07).
           03  WK-GEN70-GENDOGAKU-TOKU75
                                       PIC 9(07).
           03  WK-SEIHO-GENDO-TOKU75   PIC 9(07).
           03  WK-SEIHO-GENDO70-TOKU75 PIC 9(07).
           03  WK-CYOKI-GENDO-TOKU75   PIC 9(07).
           03  WK-CYOKI-GENDO2-TOKU75  PIC 9(07).
           03  WK-CYOKI-TOKU75         PIC 9(08).
           03  WK-CYOKI-ENTANI-TOKU75  PIC 9(08).
           03  WK-CYOKI-ZAN-XXX        PIC 9(08).
           03  WK-HIKAKU-KINGAKU       PIC 9(07).
           03  WK-KEISAN-FTNRATE       PIC 9(03).
           03  WK-CYOKI-HIKAKU1        PIC 9(08).
           03  WK-CYOKI-HIKAKU2        PIC 9(08).
           03  WK-CYOKI-HIKAKU3        PIC 9(08).
           03  WK-CYOKI-HIKAKU9        PIC 9(08).
           03  WK-SKYCHK-KEISAN        PIC 9(10).
           03  WK-SKYCHK-KEISAN2       PIC 9(10).
           03  WK-SKYCHK-KEISAN3       PIC 9(10).
           03  WK-SKYCHK-KEISAN4       PIC 9(10).
           03  WK-SKYCHK-KEISAN5       PIC 9(10).
           03  WK-SKYCHK-KEISAN7       PIC 9(10).
           03  WK-SKYCHK-KEISAN8       PIC 9(10).
           03  WK-SKYCHK-KEISAN9       PIC 9(10).
           03  WK-SKYCHK-KEISAN10      PIC 9(10).
           03  WK-S1                   PIC 9(03).
           03  WK-S2                   PIC 9(03).
           03  WK-S3                   PIC 9V99999.
           03  WK-S4                   PIC 9V99.
           03  WK-S5                   PIC 9V99.
      *    調整金再計算
           03  WRK-SYU-CHOSEI          PIC S9(07).
           03  WRK-SYU-CHOSEI2         PIC S9(07).
      *
           03  WK-END                  PIC 9(08).
           03  WK-KEISAN               PIC S9(07).
           03  WK-KEISAN2              PIC 9(07).
           03  WK-KEISAN-EN            PIC 9(07)V9(01).
           03  WK-KEISAN-JYOSEI        PIC 9(07).
           03  WK-KEISAN-JYOSEI2       PIC 9(07).
           03  WK-KEISAN-JYOSEI3       PIC 9(07).
           03  WK-KEISAN-JYOSEI-EN     PIC 9(07)V9(01).
           03  WK-RYOYO                PIC 9(07).
           03  WK-4001-KSNRATE9        PIC 9(03).
           03  WK-4001-KSNRATE         PIC 9V99.
           03  WK-4001-TAXKBN          PIC X(01).
           03  WK-4001-TAXKBN-KZI      PIC X(01).
           03  WK-4001-SYUTENTANKA     PIC 9(02).
           03  WK-4001-YKZTENTANKA     PIC 9(02).
           03  WK-4001-KOMUTENTANKA    PIC 9(02).
      *
           03  WK-ERR                  PIC 9(01).
           03  WK-UERR                 PIC 9(01).
           03  WK-PAYKBN               PIC X(02).
           03  WK-1001-HOSPSBT         PIC 9(01).
           03  WK-1001-ROUPAYKBN       PIC X(01).
           03  WK-1001-JIHIPOSITION    PIC X(01).
           03  WK-1001-CHIHOUNUMKBN    PIC X(01).
           03  WK-1001-GENTAIKBN       PIC X(01).
           03  WK-1001-DAISANKBN       PIC X(01).
      *
           03  WK-1039-IKTSORTKBN      PIC X(01).
      *
           03  WK-GAIJGNKBN            PIC X(01).
           03  WK-GAIJGNGAK            PIC 9(07).
      *
           03  WK-KOHJGNGET-TBL.
               05  WK-KOHJGNGET-OCC              OCCURS   4.
                 06  WK-KOHJGNGET-TAISYOKBN      PIC 9(01).
                 06  WK-KOHJGNGET-TEKSTYMD       PIC X(08).
                 06  WK-KOHJGNGET-TEKIYOFLG      PIC 9(01).
      *
           03  WK-SYS2010-TBL.
               05  WK-SYS2010-OCC                OCCURS   4.
                 06  WK-2010-JGNFTNKBN           PIC X(01).
                 06  WK-2010-JYUHENKBN           PIC X(01).
                 06  WK-2010-JYUHEN-TAIKBN       PIC X(01).
                 06  WK-2010-IRYOKEIKBN-G        PIC X(01).
                 06  WK-2010-IRYOKEIKBN-G-XXX    PIC X(01).
                 06  WK-2010-KINJYOKBN-G         PIC X(01).
                 06  WK-2010-KAICNTKBN-G         PIC X(01).
                 06  WK-2010-CYOKEIKBN-G         PIC X(01).
                 06  WK-2010-GNBKEIKBN-K-G       PIC X(01).
                 06  WK-2010-ZENKEIKBN-G         PIC X(01).
                 06  WK-2010-SINKEIKBN-G         PIC X(01).
                 06  WK-2010-SYOKEIKBN-G         PIC X(01).
                 06  WK-2010-NINNASIKBN          PIC X(01).
                 06  WK-2010-NINJYOKBN           PIC X(01).
                 06  WK-2010-KOGAKKEIKBN         PIC X(01).
                 06  WK-2010-INNAIKBN            PIC X(01).
                 06  WK-2010-JIRITUKBN           PIC X(01).
                 06  WK-2010-ZENKEI2KBN-G        PIC X(01).
                 06  WK-2010-SYOKEI2KBN-G        PIC X(01).
      *
      *    保険区分（空白：医保、１：労災自賠、２：公害）
           03  WK-HKNKBN               PIC X(01).
      *
      *    患者負担計算時の四捨五入用ワーク
           03  WK-FTN                  PIC 9(10).
      *
      *    病院割引額計算時の割引率用ワーク
           03  WK-RATE                 PIC 9(1)V9(2).
      *
      *    請求額金額端数区分（減免有り）
           03  WK-HASU1001-KBN         PIC X(1).
      *    請求額金額端数区分（減免無し・保険分）
           03  WK-HASU1001-KBN2        PIC X(1).
      *    請求額金額端数区分（減免無し・自費分）
           03  WK-HASU1001-KBN2J       PIC X(1).
      *
      *    請求額金額端数区分：労災　（減免無し・保険分）
           03  WK-HASU1001-KBN3        PIC X(1).
      *    請求額金額端数区分　　　　（減免無し・自費分）
           03  WK-HASU1001-KBN3J       PIC X(1).
      *    請求額金額端数区分：自賠責（減免無し・保険分）
           03  WK-HASU1001-KBN4        PIC X(1).
      *    請求額金額端数区分　　　　（減免無し・自費分）
           03  WK-HASU1001-KBN4J       PIC X(1).
      *    請求額金額端数区分：公害　（減免無し・自費分）
           03  WK-HASU1001-KBN5J       PIC X(1).
      *    請求額金額端数区分：第三者行為（減免無し・保険分）
           03  WK-HASU1001-KBN6        PIC X(1).
      *    請求額金額端数区分　　　　　　（減免無し・自費分）
           03  WK-HASU1001-KBN6J       PIC X(1).
      *    請求額金額端数区分：ＷＫ　（減免無し・保険分）
           03  WK-HASU1001-KBN-WK      PIC X(1).
      *    請求額金額端数区分　　　　（減免無し・自費分）
           03  WK-HASU1001-KBN-WKJ     PIC X(1).
      *
           03  WK-HASU-KBN             PIC X(1).
      *
      *    消費税端数区分
           03  WK-TAX1001-KBN          PIC X(1).
      *
      *    県番号
           03  WK-1001-PREFNUM         PIC 9(2).
      *
      *    福岡県地方公費負担区分・主保険の負担割合
           03  WK-KOH-FTNKBN           PIC X(1).
           03  WK-KOH-FTNRATE          PIC 9(3).
      *
           03  WK-TAIHI-DENPNUMXX-OCC.
               05  WK-TAIHI-DENPNUMXX  PIC 9(7)    OCCURS   4.
      *
           03  WK-TAIHI-RECEFTNDSPKBN-OCC.
               05  WK-TAIHI-RECEFTNDSPKBN
                                       PIC X(1)    OCCURS   4.
      *
           03  WK-TAIHI-FTNGAKEN-OCC.
               05  WK-TAIHI-FTNGAKEN   PIC 9(1)    OCCURS   4.
      *
           03  WK-TAIHI-JGNGAKEN-OCC.
               05  WK-TAIHI-JGNGAKEN   PIC 9(7)    OCCURS   4.
      *
           03  WK-TAIHI-JGNKOHFLG-OCC.
             04  WK-TAIHI-JGNKOHFLG-OCC2           OCCURS   4.
               05  WK-TAIHI-JGNKOHFLG  PIC 9(1).
               05  WK-TAIHI-GAIRAIFTN  PIC 9(7).
               05  WK-TAIHI-NYUINFTN   PIC 9(7).
               05  WK-TAIHI-TAINFTN    PIC 9(7).
               05  WK-TAIHI-GAIRAIDAY  PIC X(2).
               05  WK-TAIHI-GAIRAIDAY2 PIC X(2).
      *
      *    システム管理２０１０設定額未満・以上で異なる負担金計算
      *    設定「３」「４」用
           03  WK-TAIHI-IRYOKEIKBNINF-OCC.
               05  WK-TAIHI-FTN-KOHI-M        PIC 9(08)  OCCURS   4.
               05  WK-TAIHI-ZAN-KOHI-M        PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI-M    PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI1-M   PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI2-M   PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI3-M   PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI4-M   PIC 9(08).
               05  WK-TAIHI-KARI-COMPFTN      PIC 9(08).
      *
      *    特殊計算用
           03  WK-TOKUSYU-COMPFTN      PIC 9(07).
           03  WK-TOKUSYU-COMPFTN2     PIC 9(07).
           03  WK-TOKUSYU-ENTANI       PIC 9(07)V9(01).
           03  WK-TOKUSYU              PIC 9(07).
           03  WK-TOKUSYU2             PIC 9(07).
           03  WK-TAIHI-TOKU1          PIC 9(07)V9(01).
           03  WK-TAIHI-TOKU2          PIC 9(07).
      *
      *    自賠責特定器材等消費税対象外コード
           03  WK-4003-TAIGAI.
               05  WK-4003-TAIGAI-OCC      OCCURS  50.
                 06  WK-4003-TAIGAI-SRYCD  PIC  X(09).
      *
      *    自賠責その他コード（０９５９１．９２．９３）の診療行為コード等
           03  WK-SONOTA91.
               05  WK-SONOTA91-OCC         OCCURS  20.
                 06  WK-SONOTA91-SRYCD     PIC  X(09).
                 06  WK-SONOTA91-ZAIKAISU  PIC  9(07).
                 06  WK-SONOTA91-TANKA     PIC  9(07).
           03  WK-SONOTA92.
               05  WK-SONOTA92-OCC         OCCURS  20.
                 06  WK-SONOTA92-SRYCD     PIC  X(09).
                 06  WK-SONOTA92-ZAIKAISU  PIC  9(07).
                 06  WK-SONOTA92-TANKA     PIC  9(07).
           03  WK-SONOTA93.
               05  WK-SONOTA93-OCC         OCCURS  20.
                 06  WK-SONOTA93-SRYCD     PIC  X(09).
                 06  WK-SONOTA93-ZAIKAISU  PIC  9(07).
                 06  WK-SONOTA93-TANKA     PIC  9(07).
      *
           03  WK-JIRITU-TBL.
               05  WK-JIRITU-OCC           OCCURS   4.
                 06  WK-JIRITU-CYUKANSOU   PIC  9(01).
                 06  WK-JIRITU-TAFTNRUIKEI PIC  9(07).
      *
                 06  WK-CHIHOU-TAFTNRUIKEI PIC  9(07).
                 06  WK-KANEN-TAFTNRUIKEI  PIC  9(07).
                 06  WK-TOKUSITU-TAFTNRUIKEI
                                           PIC  9(07).
      *
           03  WK-JIRITU-SRYYMD            PIC  X(08).
      *
           03  WK-OITA-HKNFTNMONEY         PIC  9(07).
           03  WK-OITA-CYOFTN              PIC  9(07).
           03  WK-OITA-CYOFTN-KON          PIC  9(07).
           03  WK-OITA-KEISAN              PIC  9(07).
           03  WK-OITA-KEISAN2             PIC  9(07).
           03  WK-OITA-KEISAN3             PIC  9(07).
      *
           03  WK-GENGAKUKBN               PIC  9(01).
           03  WK-GENGAKUKBN-KEISAN        PIC  9(01).
           03  WK-GENGAKU-KOHID            PIC  9(10).
           03  WK-GENGAKU-RITU             PIC  9(03).
           03  WK-GENGAKU-RITUX            PIC  9(03).
           03  WK-GENGAKU-KIN              PIC  9(07).
           03  WK-GENGAKU-KIN2             PIC  9(07).
           03  WK-GENGAKU-KIN2-ENTANI      PIC  9(07)V9(01).
           03  WK-GENGAKU-GAK              PIC  9(07).
           03  WK-GENGAKU-GAK-ENTANI       PIC  9(07)V9(01).
           03  WK-GENGAKU-GAK2             PIC  9(07).
           03  WK-GENGAKU-GAK2-ENTANI      PIC  9(07)V9(01).
           03  WK-GENGAKU-GAK8             PIC  9(07).
           03  WK-GENGAKU-GAK8-ENTANI      PIC  9(07)V9(01).
           03  WK-GENGAKU-GAK9             PIC  9(07).
           03  WK-GENGAKU-GAK9-ENTANI      PIC  9(07)V9(01).
           03  WK-GENGAKU-TEN-TBL.
               05  WK-GENGAKU-TEN-OCC      OCCURS   100.
                 06  WK-GENGAKU-TEN        PIC  9(07).
                 06  WK-GENGAKU-FTN        PIC  9(07).
                 06  WK-GENGAKU-FTN-ENTANI PIC  9(07)V9(01).
      *
           03  WK-KOHININBARAI-KOHID       PIC  9(10).
           03  WK-KOHININBARAI-JKYSNUM     PIC  X(20).
      *
           03  WK-HKNJANUM-TBL.
               05  WK-HKNJANUM             PIC  X(08).
               05  WK-HONKZKKBN            PIC  X(01).
               05  WK-KIGO                 PIC  X(80).
               05  WK-NUM                  PIC  X(80).
           03  WK-HKNJANUM2-TBL.
               05  WK-HKNJANUM2            PIC  X(08).
               05  WK-HONKZKKBN2           PIC  X(01).
               05  WK-KIGO2                PIC  X(80).
               05  WK-NUM2                 PIC  X(80).
           03  WK-HKNJANUM3-TBL.
               05  WK-HKNJANUM3            PIC  X(08).
               05  WK-HONKZKKBN3           PIC  X(01).
               05  WK-KIGO3                PIC  X(80).
               05  WK-NUM3                 PIC  X(80).
           03  WK-HKNJANUM4-TBL.
               05  WK-HKNJANUM4            PIC  X(08).
               05  WK-HONKZKKBN4           PIC  X(01).
               05  WK-KIGO4                PIC  X(80).
               05  WK-NUM4                 PIC  X(80).
           03  WK-HKNJANUM5-TBL.
               05  WK-HKNJANUM5            PIC  X(08).
               05  WK-HONKZKKBN5           PIC  X(01).
               05  WK-KIGO5                PIC  X(80).
               05  WK-NUM5                 PIC  X(80).
           03  WK-HKNJANUM6-TBL.
               05  WK-HKNJANUM6            PIC  X(08).
               05  WK-HONKZKKBN6           PIC  X(01).
               05  WK-KIGO6                PIC  X(80).
               05  WK-NUM6                 PIC  X(80).
      *
           03  WK-CONTKBN                  PIC  X(01).
           03  WK-CONTKBN2                 PIC  X(01).
      *
           03  WK-DOTANDOKU-TBL.
               05  WK-DOTANDOKU-OCC        OCCURS   4.
                 06  WK-DOTANDOKU          PIC  9(01).
      *
           03  WK-TOKATUKAI-TBL.
               05  WK-TOKATUKAI-OCC        OCCURS   4.
                 06  WK-TOKATUKAI          PIC  9(01).
      *
           03  WK-KOHNUM                   PIC  X(03).
      *
           03  WK-KANAGAWA41-FTNRATE       PIC  9(03).
           03  WK-TOTORI-JIRITU            PIC  9(01).
      *
           03  WK-ZAITAKU-SRYCD            PIC  X(09).
      *
           03  WK-KOUREI-ZAITAKU-KBN       PIC  X(01).
      *
           03  WK-SRYCD                    PIC  X(09).
      *
           03  WK-RSISDO-MONEY             PIC  9(09).
           03  WK-RSISDO-MONEY2            PIC  9(09).
      *
           03  WK-CHECK-FTNJANUM           PIC  X(08).
           03  WK-CHECK-FTNJANUM2          PIC  X(08).
           03  WK-CHECK-JKYSNUM            PIC  X(20).
           03  WK-CHECK-JKYSNUM2           PIC  X(20).
      *
           03  WK-KOH-FTNJANUM             PIC  X(08).
      *
           03  WK-BIRTHDAY                 PIC  X(08).
      *
           03  WK-TOKU75-BIRTHDAY          PIC  X(08).
           03  WK-TOKU75-TEKSTYMD          PIC  X(08).
           03  WK-TOKU75-TEKEDYMD          PIC  X(08).
      *
           03  WK-TOTAL-KINGAKU2           PIC  9(09).
           03  WK-TOTAL-KINGAKU2-EN        PIC  9(09).
           03  WK-TOTAL-KINGAKU3           PIC  9(09).
      *
           03  WK-CYO-OKIKAE-TBL.
               05  WK-CYO-OKIKAE-OCC       OCCURS   4.
                 06  WK-CYO-OKIKAE         PIC  9(01).
      *
           03  WK-RUI-TBL.
               05  WK-RUI-FTN1-M           PIC  9(07).
               05  WK-RUI-FTN1-M-TOKU75    PIC  9(07).
               05  WK-RUI-FTN1-M-JI        PIC  9(07).
               05  WK-RUI-FTN1-M-JI-TOKU75 PIC  9(07).
      *
               05  WK-RUI-FTN1-M2            PIC  9(07).
               05  WK-RUI-FTN1-M2-TOKU75     PIC  9(07).
               05  WK-RUI-FTN1-M2-JI         PIC  9(07).
               05  WK-RUI-FTN1-M2-JI-TOKU75  PIC  9(07).
      *
               05  WK-RUI-FTN1-M3            PIC  9(07)V9(01).
               05  WK-RUI-FTN1-M3-TOKU75     PIC  9(07)V9(01).
               05  WK-RUI-FTN1-M3-JI         PIC  9(07)V9(01).
               05  WK-RUI-FTN1-M3-JI-TOKU75  PIC  9(07)V9(01).
      *
               05  WK-RUI-FTN1-M4            PIC  9(07).
               05  WK-RUI-FTN1-M4-TOKU75     PIC  9(07).
               05  WK-RUI-FTN1-M4-JI         PIC  9(07).
               05  WK-RUI-FTN1-M4-JI-TOKU75  PIC  9(07).
      *
               05  WK-RUI-FTN2-M           PIC  9(07).
               05  WK-RUI-FTN2-M2          PIC  9(07).
               05  WK-RUI-FTN2-M3          PIC  9(07).
      *
               05  WK-RUI-FTN2-M3-XXX      PIC  9(07)V9(01).
               05  WK-ZAN-FTN2-M3-XXX      PIC  9(07)V9(01).
      *
               05  WK-RUI-FTNRATE          PIC  9(03).
               05  WK-RUI-FTNRATE-KOH1     PIC  9(03).
               05  WK-RUI-COMPFTN          PIC  9(07).
               05  WK-RUI-COMPFTN-XXX      PIC  9(07).
               05  WK-RUI-HKNFTNMONEY      PIC  9(07).
               05  WK-RUI-COMPFTN-ENTANI   PIC  9(07)V9(01).
               05  WK-RUI-COMPFTN-ENTANI2  PIC  9(07).
               05  WK-RUI-TAISYO           PIC  9(01).
      *
               05  WK-RUI-TAIHI-HKNFTNMONEY
                                           PIC  9(07).
               05  WK-RUI-TAIHI-COMPFTN    PIC  9(07).
               05  WK-RUI-TAIHI-COMPFTN-ENTANI
                                           PIC  9(07)V9(01).
               05  WK-RUI-ZENGAKU          PIC  9(10).
      *
           03  WK-MARUKO-TBL.
               05  WK-MARUKO-M             PIC  9(09).
               05  WK-MARUKO-ME            PIC  9(09)V9(01).
               05  WK-MARUKO-KIN           PIC  9(09).
               05  WK-MARUKO-FTN           PIC  9(09).
               05  WK-MARUKO-FTN2          PIC  9(09).
               05  WK-MARUKO-XX            PIC  9(09).
               05  WK-MARUKO-COMPFTN       PIC  9(09).
               05  WK-MARUKO-COMPFTN-E     PIC  9(09)V9(01).
      *
           03  WK-GEN70-YMD.
               05  WK-GEN70-YM             PIC  9(06).
               05  WK-GEN70-DD             PIC  9(02).
           03  WK-GEN70-YMD-ED.
               05  WK-GEN70-YM-ED          PIC  9(06).
               05  WK-GEN70-DD-ED          PIC  9(02).
      *
           03  WK-SYOUKAN-FTNRATE          PIC  9(03).
           03  WK-MARUTOARI-COMPFTN        PIC  9(07).
      *
           03  WK-KUMAMOTO-SYUCOMPFTN      PIC  9(07).
           03  WK-KUMAMOTO-HANTEIKIN       PIC  9(10).
           03  WK-KUMAMOTO-HANTEIJGN       PIC  9(10).
      *
           03  WK-WAKAYAMA-SYUCOMPFTN      PIC  9(07).
           03  WK-WAKAYAMA-HANTEIKIN       PIC  9(10).
           03  WK-WAKAYAMA-HANTEIKIN2      PIC  9(10).
           03  WK-WAKAYAMA-HANTEITEN       PIC  9(10).
           03  WK-WAKAYAMA-HANTEIJGN       PIC  9(10).
           03  WK-WAKAYAMA-KEISAN          PIC  9(10).
      *
           03  WK-MAX-KIN-D                PIC  9(08).
      *
      *    ７０歳未満現物給付の収納データ退避（公費併用分）
           03  WK-SYUNOU-GENBUTU70-TABLE.
               05  WK-SYUNOU-GENBUTU70-OCC              OCCURS  50.
                 06  WK-SYUNOU-GENBUTU70-HKNCOMBINUM    PIC  X(04).
                 06  WK-SYUNOU-GENBUTU70-TOTALTEN       PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-SYUHKNNUM      PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH1HKNNUM     PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH1COMPFTN    PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-KOH2HKNNUM     PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH2COMPFTN    PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-KOH3HKNNUM     PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH3COMPFTN    PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-KOH4HKNNUM     PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH4COMPFTN    PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-SKYMONEY       PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-GASSANFLG      PIC  9(01).
                 06  WK-SYUNOU-GENBUTU70-HANTEIFLG      PIC  9(01).
      *    ７０歳未満現物給付の収納データ退避（主保険単独分）
           03  WK-SYUNOU-GENBUTU70T-TABLE.
                 06  WK-SYUNOU-GENBUTU70T-TOTALTEN      PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70T-SKYMONEY      PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70T-HANTEIFLG     PIC  9(01).
      *
           03  WK-SYUNOU-GENBUTU70-KEISAN               PIC  9(10).
           03  WK-SYUNOU-GENBUTU70-FTNRATE              PIC  9(03).
           03  WK-SYUNOU-GENBUTU70-MSG                  PIC  9(01).
      *
           03  WK-SYUNOU-GENBUTU-JGNFLG                 PIC  9(01).
           03  WK-SYUNOU-GENBUTU-KR-SKYMONEY            PIC  9(07).
           03  WK-SYUNOU-GENBUTU-KR-SKYMONEY2           PIC  9(07).
           03  WK-SYUNOU-GENBUTU-KR-SYUHKNFLG           PIC  9(01).
      *
           03  WK-SYUNOU-GENBUTU-SECMONEY-MAE           PIC  9(07).
           03  WK-SYUNOU-GENBUTU-TOTALTEN-MAE           PIC  9(07).
      *
           03  WK-SHOHOUSEN-HKNCOMBINUM-TBL.
               05  WK-SHOHOUSEN-HKNCOMBINUM-OCC         OCCURS 50.
                 07  WK-SHOHOUSEN-HKNCOMBINUM           PIC  9(04).
      *
           03  WK-INNAI-SANSHOU-TBL.
               05  WK-INNAI-SANSHOU-OCC                 OCCURS  4.
                 07  WK-INNAI-SANSHOU                   PIC  9(01).
      *
           03  WK-JYOSEI-KOHIKIN                        PIC 9(07).
           03  WK-JYOSEI-KOHIKIN2                       PIC 9(07).
           03  WK-JYOSEI-KOHIKIN3                       PIC 9(07).
           03  WK-JYOSEI-KOHIKIN-ZENGAKU                PIC 9(07).
           03  WK-JYOSEI-KOHIKIN-EN                     PIC 9(07)V9(01).
           03  WK-JYOSEI-KOHIKIN-KEI                    PIC 9(07).
           03  WK-JYOSEI-KOHIKIN-RUI                    PIC 9(07).
           03  WK-JYOSEI-KOHIKIN-RUI2                   PIC 9(07).
           03  WK-JYOSEI-KOHIKIN-RUI3                   PIC 9(07).
      *
           03  WK-CHECK-TEKYMD.
               05  WK-CHECK-TEKYM                       PIC 9(06).
               05  WK-CHECK-TEKDD                       PIC 9(02).
           03  WK-CHECK2-TEKYMD.
               05  WK-CHECK2-TEKYM                      PIC 9(06).
               05  WK-CHECK2-TEKDD                      PIC 9(02).
      *
           03  WK-HBTNUM-TBL.
               05  WK-HBTNUM-OCC                        OCCURS   4.
                 06  WK-HBTNUM                          PIC X(02).
      *
           03  WK-CHECK2010-TBL.
               05  WK-CHECK2010-OCC                     OCCURS 100.
                 06  WK-CHECK2010-HKNCOMBINUM           PIC X(04).
                 06  WK-CHECK2010-OCC2                  OCCURS   4.
                   07  WK-CHECK2010-JYUHENKBN           PIC X(01).
                   07  WK-CHECK2010-JYUHEN-TAIKBN       PIC X(01).
                   07  WK-CHECK2010-HBTNUM              PIC X(02).
                   07  WK-CHECK2010-NG                  PIC X(01).
      *
           03  WK-CHECK2010X-TBL.
               05  WK-CHECK2010X-OCC                    OCCURS   4.
                 06  WK-CHECK2010X-JYUHENKBN            PIC X(01).
                 06  WK-CHECK2010X-JYUHEN-TAIKBN        PIC X(01).
                 06  WK-CHECK2010X-HBTNUM               PIC X(02).
                 06  WK-CHECK2010X-NG                   PIC X(01).
                 06  WK-CHECK2010X-TAISYOIDX            PIC 9(01).
      *
           03  WK-GNBKEIKBN-K-TBL.
               05  WK-GNBKEIKBN-K-OCC                   OCCURS   5.
                 06  WK-GNBKEIKBN-K-KBN                 PIC 9(01).
                 06  WK-GNBKEIKBN-K-KIN                 PIC 9(09).
                 06  WK-GNBKEIKBN-K-KIN-EN              PIC 9(09).
                 06  WK-GNBKEIKBN-K-FLG                 PIC 9(01).
      *
           03  WK-NYNSHOKAISU                           PIC 9(02).
      *
           03  WK-TAIHI-COMPFTN-149                     PIC 9(07).
      *
           03  WK-IRYOKEIKBN-HANTEITEN                  PIC 9(08).
           03  WK-IRYOKEIKBN-MAXTEN                     PIC 9(08).
      *
       01  SHOHOUSEN-AREA.
           03  FLG-INNAI               PIC X(01).
           03  FLG-INGAI               PIC X(01).
      *
      *    公費の患者負担上限回数と上限金額の退避用エリア
       01  HOKEN-MAX-AREA.
           03  MAX-KAI-KOHI1-D         PIC 9(05).
           03  MAX-KAI-KOHI2-D         PIC 9(05).
           03  MAX-KAI-KOHI3-D         PIC 9(05).
           03  MAX-KAI-KOHI4-D         PIC 9(05).
           03  MAX-KAI-KOHI1-M         PIC 9(05).
           03  MAX-KAI-KOHI2-M         PIC 9(05).
           03  MAX-KAI-KOHI3-M         PIC 9(05).
           03  MAX-KAI-KOHI4-M         PIC 9(05).
           03  MAX-KIN-KOHI1-D         PIC 9(08).
           03  MAX-KIN-KOHI2-D         PIC 9(08).
           03  MAX-KIN-KOHI3-D         PIC 9(08).
           03  MAX-KIN-KOHI4-D         PIC 9(08).
           03  MAX-KIN-KOHI1-M         PIC 9(08).
           03  MAX-KIN-KOHI2-M         PIC 9(08).
           03  MAX-KIN-KOHI3-M         PIC 9(08).
           03  MAX-KIN-KOHI4-M         PIC 9(08).
           03  MAX-KIN-KOHI1-K         PIC 9(08).
           03  MAX-KIN-KOHI2-K         PIC 9(08).
           03  MAX-KIN-KOHI3-K         PIC 9(08).
           03  MAX-KIN-KOHI4-K         PIC 9(08).
           03  TEI-KIN-KOHI1-K         PIC 9(08).
           03  TEI-KIN-KOHI2-K         PIC 9(08).
           03  TEI-KIN-KOHI3-K         PIC 9(08).
           03  TEI-KIN-KOHI4-K         PIC 9(08).
           03  MAX-KIN-KOHI1-M-TOKU75  PIC 9(08).
           03  MAX-KIN-KOHI2-M-TOKU75  PIC 9(08).
           03  MAX-KIN-KOHI3-M-TOKU75  PIC 9(08).
           03  MAX-KIN-KOHI4-M-TOKU75  PIC 9(08).
      *
      *    公費の使用回数カウント用エリア
       01  HOKEN-KAISU-AREA.
           03  KAISU-KOHI1-D           PIC 9(05).
           03  KAISU-KOHI2-D           PIC 9(05).
           03  KAISU-KOHI3-D           PIC 9(05).
           03  KAISU-KOHI4-D           PIC 9(05).
           03  KAISU-KOHI1-M           PIC 9(05).
           03  KAISU-KOHI2-M           PIC 9(05).
           03  KAISU-KOHI3-M           PIC 9(05).
           03  KAISU-KOHI4-M           PIC 9(05).
      *
       01  HOKEN-KAISU-TABLE.
           03  HOKEN-KAISU-TBL.
             04 HOKEN-KAISU-TBL2       OCCURS  32.
               05  KOHI1-TBL           PIC 9(02).
               05  KOHI2-TBL           PIC 9(02).
               05  KOHI3-TBL           PIC 9(02).
               05  KOHI4-TBL           PIC 9(02).
           03  HOKEN-KAISU-TBL-R   REDEFINES   HOKEN-KAISU-TBL.
             04 HOKEN-KAISU-TBL2-R     OCCURS  32.
               05  KOHI-TBL            PIC 9(02)   OCCURS   4.
      *
      *    公費の患者負担済み金額の加算用エリア
       01  HOKEN-FUTAN-AREA.
           03  FTN-KOHI1-D             PIC 9(08).
           03  FTN-KOHI2-D             PIC 9(08).
           03  FTN-KOHI3-D             PIC 9(08).
           03  FTN-KOHI4-D             PIC 9(08).
           03  FTN-KOHI1-D-K           PIC 9(08).
           03  FTN-KOHI2-D-K           PIC 9(08).
           03  FTN-KOHI3-D-K           PIC 9(08).
           03  FTN-KOHI4-D-K           PIC 9(08).
           03  FTN-KOHI1-M             PIC 9(08).
           03  FTN-KOHI2-M             PIC 9(08).
           03  FTN-KOHI3-M             PIC 9(08).
           03  FTN-KOHI4-M             PIC 9(08).
           03  FTN-KOHI1-M-JI          PIC 9(08).
           03  FTN-KOHI2-M-JI          PIC 9(08).
           03  FTN-KOHI3-M-JI          PIC 9(08).
           03  FTN-KOHI4-M-JI          PIC 9(08).
           03  FTN-CYOKI-M-JI          PIC 9(08).
           03  FTN-CYOKI-M-JI-TOKU75   PIC 9(08).
           03  FTN-KOHI1-M-JI-TOKU75   PIC 9(08).
           03  FTN-KOHI1-M-TOKU75      PIC 9(08).
           03  FTN-KOHI2-M-TOKU75      PIC 9(08).
           03  FTN-KOHI3-M-TOKU75      PIC 9(08).
           03  FTN-KOHI4-M-TOKU75      PIC 9(08).
      *
      *    公費のレセプト負担区分四捨五入しない場合,
      *    レセ記載金額の加算用エリア
       01  HOKEN-FUTAN-AREA2.                                           
           03  FTN-KOHI1-D2            PIC 9(08).                       
           03  FTN-KOHI2-D2            PIC 9(08).                       
           03  FTN-KOHI3-D2            PIC 9(08).                       
           03  FTN-KOHI4-D2            PIC 9(08).                       
           03  FTN-KOHI1-D2-K          PIC 9(08).                       
           03  FTN-KOHI2-D2-K          PIC 9(08).                       
           03  FTN-KOHI3-D2-K          PIC 9(08).                       
           03  FTN-KOHI4-D2-K          PIC 9(08). 
           03  FTN-KOHI1-M2            PIC 9(08).                       
           03  FTN-KOHI2-M2            PIC 9(08).                       
           03  FTN-KOHI3-M2            PIC 9(08).                       
           03  FTN-KOHI4-M2            PIC 9(08).                       
           03  FTN-KOHI1-M2-JI         PIC 9(08).                       
           03  FTN-KOHI2-M2-JI         PIC 9(08).                       
           03  FTN-KOHI3-M2-JI         PIC 9(08).                       
           03  FTN-KOHI4-M2-JI         PIC 9(08).   
           03  FTN-CYOKI-M2-JI         PIC 9(08).
           03  FTN-CYOKI-M2-JI-TOKU75  PIC 9(08).
           03  FTN-KOHI1-M2-JI-TOKU75  PIC 9(08).
           03  FTN-KOHI1-M2-TOKU75     PIC 9(08).
           03  FTN-KOHI2-M2-TOKU75     PIC 9(08).
           03  FTN-KOHI3-M2-TOKU75     PIC 9(08).
           03  FTN-KOHI4-M2-TOKU75     PIC 9(08).
      *
      *    公費の負担金額円単位用
       01  HOKEN-FUTAN-AREA3.                                     
           03  FTN-KOHI1-D3            PIC 9(08).                 
           03  FTN-KOHI2-D3            PIC 9(08).                 
           03  FTN-KOHI3-D3            PIC 9(08).                 
           03  FTN-KOHI4-D3            PIC 9(08).                 
           03  FTN-KOHI1-D3-K          PIC 9(08).                 
           03  FTN-KOHI2-D3-K          PIC 9(08).                 
           03  FTN-KOHI3-D3-K          PIC 9(08).                 
           03  FTN-KOHI4-D3-K          PIC 9(08).                 
           03  FTN-KOHI1-M3            PIC 9(08).                 
           03  FTN-KOHI2-M3            PIC 9(08).                 
           03  FTN-KOHI3-M3            PIC 9(08).                 
           03  FTN-KOHI4-M3            PIC 9(08).                 
           03  FTN-KOHI1-M3-JI         PIC 9(08).                 
           03  FTN-KOHI2-M3-JI         PIC 9(08).                 
           03  FTN-KOHI3-M3-JI         PIC 9(08).                 
           03  FTN-KOHI4-M3-JI         PIC 9(08).                 
           03  FTN-CYOKI-M3-JI         PIC 9(08).
           03  FTN-CYOKI-M3-JI-TOKU75  PIC 9(08).
           03  FTN-KOHI1-M3-JI-TOKU75  PIC 9(08).
           03  FTN-KOHI1-M3-TOKU75     PIC 9(08).
           03  FTN-KOHI2-M3-TOKU75     PIC 9(08).
           03  FTN-KOHI3-M3-TOKU75     PIC 9(08).
           03  FTN-KOHI4-M3-TOKU75     PIC 9(08).
      *
      *    公費の患者負担可能な残額算定用エリア
       01  HOKEN-ZAN-AREA.
           03  ZAN-KOHI1-D             PIC 9(08).
           03  ZAN-KOHI2-D             PIC 9(08).
           03  ZAN-KOHI3-D             PIC 9(08).
           03  ZAN-KOHI4-D             PIC 9(08).
           03  ZAN-KOHI1-M             PIC 9(08).
           03  ZAN-KOHI2-M             PIC 9(08).
           03  ZAN-KOHI3-M             PIC 9(08).
           03  ZAN-KOHI4-M             PIC 9(08).
           03  ZAN-KOHI1-M-TOKU75      PIC 9(08).
           03  ZAN-KOHI2-M-TOKU75      PIC 9(08).
           03  ZAN-KOHI3-M-TOKU75      PIC 9(08).
           03  ZAN-KOHI4-M-TOKU75      PIC 9(08).
           03  ZAN-KOHI-AREA.
             05  ZAN-KOHI1             PIC 9(08).
             05  ZAN-KOHI2             PIC 9(08).
             05  ZAN-KOHI3             PIC 9(08).
             05  ZAN-KOHI4             PIC 9(08).
           03  ZAN-KOHI-TBL  REDEFINES  ZAN-KOHI-AREA
                                        OCCURS  4.
             05  ZAN-KOHI-T            PIC 9(08).
      *
      *    公費のレセプト負担区分四捨五入しない場合,
      *    レセ記載可能な残額算定用エリア
       01  HOKEN-ZAN-AREA2.                                             
           03  ZAN-KOHI1-D2            PIC 9(08).                       
           03  ZAN-KOHI2-D2            PIC 9(08).                       
           03  ZAN-KOHI3-D2            PIC 9(08).                       
           03  ZAN-KOHI4-D2            PIC 9(08).                       
           03  ZAN-KOHI1-M2            PIC 9(08).                       
           03  ZAN-KOHI2-M2            PIC 9(08).                       
           03  ZAN-KOHI3-M2            PIC 9(08).                       
           03  ZAN-KOHI4-M2            PIC 9(08).                       
           03  ZAN-KOHI1-M2-TOKU75     PIC 9(08).
           03  ZAN-KOHI2-M2-TOKU75     PIC 9(08).
           03  ZAN-KOHI3-M2-TOKU75     PIC 9(08).
           03  ZAN-KOHI4-M2-TOKU75     PIC 9(08).
           03  ZAN-KOHI-AREA2.                                          
             05  ZAN-KOHI12            PIC 9(08).                       
             05  ZAN-KOHI22            PIC 9(08).                       
             05  ZAN-KOHI32            PIC 9(08).                       
             05  ZAN-KOHI42            PIC 9(08).                       
           03  ZAN-KOHI-TBL2 REDEFINES  ZAN-KOHI-AREA2                  
                                        OCCURS  4.                      
             05  ZAN-KOHI-T2           PIC 9(08).                       
      *
      *    公費の負担金額円単位用
       01  HOKEN-ZAN-AREA3.                                       
           03  ZAN-KOHI1-D3            PIC 9(08).                 
           03  ZAN-KOHI2-D3            PIC 9(08).                 
           03  ZAN-KOHI3-D3            PIC 9(08).                 
           03  ZAN-KOHI4-D3            PIC 9(08).                 
           03  ZAN-KOHI1-M3            PIC 9(08).                 
           03  ZAN-KOHI2-M3            PIC 9(08).                 
           03  ZAN-KOHI3-M3            PIC 9(08).                 
           03  ZAN-KOHI4-M3            PIC 9(08).                 
           03  ZAN-KOHI1-M3-TOKU75     PIC 9(08).
           03  ZAN-KOHI2-M3-TOKU75     PIC 9(08).
           03  ZAN-KOHI3-M3-TOKU75     PIC 9(08).
           03  ZAN-KOHI4-M3-TOKU75     PIC 9(08).
           03  ZAN-KOHI-AREA3.                                          
             05  ZAN-KOHI13            PIC 9(08).                 
             05  ZAN-KOHI23            PIC 9(08).                 
             05  ZAN-KOHI33            PIC 9(08).                 
             05  ZAN-KOHI43            PIC 9(08).                 
           03  ZAN-KOHI-TBL3 REDEFINES  ZAN-KOHI-AREA3                  
                                        OCCURS  4.                      
             05  ZAN-KOHI-T3           PIC 9(08).                 
      *
      *    公費のレセプト負担区分四捨五入しない場合,
      *    レセ記載金額退避用エリア
       01  WK-KOH-COMPFTN-AREA.                                         
           03  WK-KOH-COMPFTN          PIC 9(07)                        
                                        OCCURS  4.                      
      *
      *    患者年齢算出用エリア
       01  WRK-NENREI-AREA.
           03  WRK-NENREI              PIC 9(03).
           03  WRK-YMDS1.
               05  WRK-YYS1            PIC 9(04).
               05  WRK-MMS1            PIC 9(02).
               05  WRK-DDS1            PIC 9(02).
           03  WRK-YMDS2.
               05  WRK-YYS2            PIC 9(04).
               05  WRK-MMS2            PIC 9(02).
               05  WRK-DDS2            PIC 9(02).
      *
      *平成１４年１０月改正対応
      *高齢者の在宅総合・在宅末期算定患者の負担上限算定エリア
      *
       01  WK-SYUHKN-TAIHI-AREA.
           03  MAX-KIN-SYU-M           PIC 9(08).
           03  FTN-SYU-M               PIC 9(08).
           03  ZAN-SYU-M               PIC 9(08).
           03  FLG-SANTEI-SYU          PIC X(01).
           03  WK-SYU-SYUCOMPFTN       PIC 9(08).                       
           03  FLG-ZAITAKU             PIC 9(01).                       
           03  FLG-KOUREI-KBN          PIC X(01).                       
      *
           03  FTN-KOHI1-D-ENTANI      PIC 9(08).                       
           03  FTN-KOHI1-M-ENTANI      PIC 9(08).                       
           03  ZAN-KOHI1-D-ENTANI      PIC 9(08).                       
           03  ZAN-KOHI1-M-ENTANI      PIC 9(08).                       
           03  ZAN-KOHI1-ENTANI        PIC 9(08).                       
      *
           03  FTN-SYU-M-ENTANI        PIC 9(08).                       
           03  ZAN-SYU-M-ENTANI        PIC 9(08).                       
      *
           03  FLG-SANTEI1-ENTANI      PIC X(01).                       
           03  FLG-SANTEI-SYU-ENTANI   PIC X(01).                       
      *
           03  FLG-ROUJINHOKEN         PIC X(01).
      *
           03  FLG-KOUGAKUCYO          PIC 9(01).
           03  FLG-KOUGAKUCYO2         PIC 9(01).
           03  FLG-KOUGAKUCYO3         PIC 9(01).
           03  FLG-KOUGAKUCYO-JIRITU   PIC 9(01).
           03  FLG-KOUGAKUCYO-ININ     PIC 9(01).
           03  FLG-KOUGAKUCYO-GEN70    PIC 9(01).
           03  FLG-KOUGAKUCYO-GEN70K   PIC 9(01).
           03  FLG-KOUGAKUCYO-OITA     PIC 9(01).
           03  FLG-FTNGAKEN            PIC 9(01).
           03  FLG-IRYOHI              PIC 9(01).
           03  FLG-IRYOHI2             PIC 9(01).
           03  FLG-IRYOHI70            PIC 9(02).
           03  FLG-IRYOHI70K           PIC 9(02).
           03  FLG-IRYOHIKG            PIC 9(01).
           03  FLG-IRYOHIKG2           PIC 9(01).
           03  WK-IRYOHI               PIC 9(08).
           03  WK-IRYOHI2              PIC 9(08).
           03  WK-KOUREI-IRYOHI        PIC 9(08).
           03  WK-KOUREI-IRYOHI2       PIC 9(08).
           03  WK-KOUREI-IRYOHI70      PIC 9(08).
           03  WK-KOUREI-IRYOHI70K     PIC 9(08).
           03  WK-KOUREI-IRYOHI70X     PIC 9(08).
           03  WK-KOUREI-IRYOHI70-JYOGAI
                                       PIC 9(08).
           03  WK-KOUREI-IRYOHI70K-TOKU75
                                       PIC 9(08).
           03  FLG-KOUGAKUCYO-GEN70K-TOKU75
                                       PIC 9(01).
      *
      *地方公費用フラグ
       01  WK-CHIHOU-FLG-TAIHI-AREA.
           03  WK-CHIHOU-FLG-TAIHI-OCC OCCURS  4.
               05  FLG-CHIHOU          PIC X(01).
               05  FLG-CHIHOU2         PIC X(01).
               05  FLG-CHIHOU3         PIC X(01).
      *
      *償還払い地方公費フラグ
       01  WK-SYOUKAN-FLG-TAIHI-AREA.
           03  FLG-SYOUKAN             PIC X(01)  OCCURS  4.
      *
      *    薬剤一部負担金（公費別計算）退避領域
       01  WK-YAKFTN.
           03  WK-SYU-YAKFTN           PIC 9(08).
           03  WK-KOH-YAKFTN-AREA.
             05  WK-KOH1-YAKFTN        PIC 9(08).
             05  WK-KOH2-YAKFTN        PIC 9(08).
             05  WK-KOH3-YAKFTN        PIC 9(08).
             05  WK-KOH4-YAKFTN        PIC 9(08).
           03  WK-KOH-YAKFTN-TBL    REDEFINES  WK-KOH-YAKFTN-AREA
                                               OCCURS  4.
             05  WK-KOH-YAKFTN-T       PIC 9(08).
      *
      *    薬剤一部負担金計算エリア
       01  YAKFTN-AREA.
      *        パラメタからの受け取り用（複数保険組合せ用）
           03  LNK-S02-TBL         OCCURS   40.
               07  LNK-S02-SRYKBN       PIC  X(02).
               07  LNK-S02-ZAIBAN       PIC  9(08).
               07  LNK-S02-SRYCD        PIC  X(09).
               07  LNK-S02-SURYOU       PIC  9(05)V9(05).
               07  LNK-S02-KAISUU       PIC  9(03).
               07  LNK-S02-TENSUU       PIC  9(07).
      *        パラメタからの受け取り用
           03  YAKFTN-TABLE.
               05  YAKFTN-TBL-OCC       OCCURS  40.
                   07  YAKFTN-KEY.
                       09  YAKFTN-SRYKBN
                                          PIC X(02).
                       09  YAKFTN-SRYCD   PIC X(09).
                   07  YAKFTN-ZAIBAN      PIC 9(08).
                   07  YAKFTN-TENSUU      PIC 9(07).
                   07  YAKFTN-KAISUU-TABLE.
                       09  YAKFTN-KAISUU  PIC 9(02)  OCCURS 180.
                   07  YAKFTN-MAX         PIC 9(03).
           03  YAKFTN-TABLE2.
               05  YAKFTN-TBL-OCC2       OCCURS  40.
                   07  YAKFTN-KEY2.
                       09  YAKFTN-SRYKBN2
                                          PIC X(02).
                       09  YAKFTN-SRYCD2   PIC X(09).
                       09  YAKFTN-ZAIBAN2  PIC 9(08).
                   07  YAKFTN-TENSUU2      PIC 9(07).
                   07  YAKFTN-KAISUU-TABLE2.
                       09  YAKFTN-KAISUU2  PIC 9(02)  OCCURS 180.
                   07  YAKFTN-MAX2         PIC 9(03).
      *        剤番号別薬剤数計算用
           03  YAKFTN-ZAI-TABLE.
               05  YAKFTN-ZAI-TBL-OCC   OCCURS  40.
                   07  YAKFTN-ZAI-SRYKBN
                                        PIC X(02).
                   07  YAKFTN-ZAI-SRYCD PIC X(09).
                   07  YAKFTN-ZAI-ZAIBAN
                                        PIC 9(08).
                   07  YAKFTN-ZAI-TENSUU
                                        PIC 9(07).
                   07  YAKFTN-ZAI-KAISUU-TABLE.
                       09  YAKFTN-ZAI-KAISUU
                                        PIC 9(02)    OCCURS 180.
                   07  YAKFTN-ZAI-MAX   PIC 9(03).
      *        一日処方分の薬剤計算用
           03  YAKFTN-TOTAL-TABLE.
               05  YAKFTN-TOTAL-TBL-OCC   OCCURS   3.
                   07  YAKFTN-TOTAL-KAISUU  PIC  9(2)  OCCURS  180.
      *        並び替え用ワーク
           03  WK-SRT-YAKFTN-TABLE.
               05  WK-SRT-YAKFTN-KEY.
                   07  WK-SRT-YAKFTN-SRYKBN     PIC X(02).
                   07  WK-SRT-YAKFTN-SRYCD      PIC X(09).
               05  WK-SRT-YAKFTN-ZAIBAN         PIC 9(08).
               05  WK-SRT-YAKFTN-TENSUU         PIC 9(07).
               05  WK-SRT-YAKFTN-KAISUU         PIC 9(02)  OCCURS 180.
               05  WK-SRT-YAKFTN-MAX            PIC 9(03).
      *
           03  WK-KEY-SRY.
               05  WK-KEY-SRYKBN          PIC X(02).
               05  WK-KEY-SRYCD           PIC X(09).
           03  WK-KEY-ZAIBAN              PIC 9(08).  
      *        服用期間編集用ワーク
           03  WK-KAISUU-TABLE.
               05  WK-KAISUU           PIC 9(02)    OCCURS 180.
           03  WK-ZAI-KAISUU-TABLE.
               05  WK-ZAI-KAISUU       PIC 9(02)    OCCURS 180.
           03  WK-KINGAK               PIC 9(07).
           03  YAKFTN-SOGOKEI          PIC 9(07).
           03  WK-FUTAN                PIC 9(05).
           03  YAKFTN-JOUGEN           PIC 9(07).
      *    保険変更時の継続入力用の薬剤一部負担金領域
           03  WK-CONT-YAKFTNAREA.
               05  WK-CONT-YAKFTNKIN1  PIC 9(07).
               05  WK-CONT-YAKFTNKIN2  PIC 9(07).
      *
           03  WK-KBNBETSU-YAKUZAI.
               05  WK-TOYAKU-TENSU     PIC 9(10)    OCCURS  4.
           03  WK-TOYAKU-ZAIBAN-AREA   OCCURS  40.
               05  WK-TOYAKU-SRYKBN    PIC X(02).
               05  WK-TOYAKU-ZAIBAN    PIC 9(08).
               05  WK-TOYAKU-ZAITEN    PIC 9(07).
           03  WK-NAI-FUTAN            PIC 9(05).
           03  WK-TON-FUTAN            PIC 9(05).
           03  WK-GAI-FUTAN            PIC 9(05).
      *
      *    在総診判定用テーブル（２００６年３月まで）
       01  TBL-ZAITAKU-AREA.
           03  FILLER          PIC X(09)   VALUE    "114701210".
           03  FILLER          PIC X(09)   VALUE    "114701710".
           03  FILLER          PIC X(09)   VALUE    "114007610".
           03  FILLER          PIC X(09)   VALUE    "114007710".
      *
       01  TBL-ZAITAKU-R       REDEFINES   TBL-ZAITAKU-AREA.
           03  TBL-ZAITAKU     PIC X(09)   OCCURS    4.
      *
       01  TBL-ZAITAKU-MAX     PIC 9(02)   VALUE     4.
      *
      *    在総診判定用テーブル（２００６年４月から）
       01  TBL-ZAITAKU2-AREA.
           03  FILLER          PIC X(09)   VALUE    "114007610".
           03  FILLER          PIC X(09)   VALUE    "114007710".
           03  FILLER          PIC X(09)   VALUE    "114012210".
           03  FILLER          PIC X(09)   VALUE    "114012310".
           03  FILLER          PIC X(09)   VALUE    "114012410".
           03  FILLER          PIC X(09)   VALUE    "114007510".
      *
       01  TBL-ZAITAKU2-R      REDEFINES   TBL-ZAITAKU2-AREA.
           03  TBL-ZAITAKU2    PIC X(09)   OCCURS    6.
      *
       01  TBL-ZAITAKU2-MAX    PIC 9(02)   VALUE     6.
      *
      *    在総診判定用テーブル（２００８年４月から）
       01  TBL-ZAITAKU3-AREA.
           03  FILLER          PIC X(09)   VALUE    "114007610".
           03  FILLER          PIC X(09)   VALUE    "114007710".
           03  FILLER          PIC X(09)   VALUE    "114012210".
           03  FILLER          PIC X(09)   VALUE    "114012310".
           03  FILLER          PIC X(09)   VALUE    "114012410".
           03  FILLER          PIC X(09)   VALUE    "114007510".
      *
           03  FILLER          PIC X(09)   VALUE    "114013010".
           03  FILLER          PIC X(09)   VALUE    "114013110".
           03  FILLER          PIC X(09)   VALUE    "114013210".
           03  FILLER          PIC X(09)   VALUE    "114013310".
      *
       01  TBL-ZAITAKU3-R      REDEFINES   TBL-ZAITAKU3-AREA.
           03  TBL-ZAITAKU3    PIC X(09)   OCCURS   10.
      *
       01  TBL-ZAITAKU3-MAX    PIC 9(02)   VALUE    10.
      *
      *    減額・免除・支払猶予判定用テーブル
       01  TBL-GENGAKU-AREA.
           03  FILLER          PIC X(03)   VALUE    "960".
           03  FILLER          PIC X(03)   VALUE    "961".
           03  FILLER          PIC X(03)   VALUE    "962".
           03  FILLER          PIC X(03)   VALUE    "963".
           03  FILLER          PIC X(03)   VALUE    "953".
      *
       01  TBL-GENGAKU-R       REDEFINES   TBL-GENGAKU-AREA.
           03  TBL-GENGAKU     PIC X(03)   OCCURS    5.
      *
       01  TBL-GENGAKU-MAX     PIC 9(02)   VALUE     5.
      *
      *    ７０歳未満現物給付判定用テーブル
       01  TBL-GENBUTU70-AREA.
           03  FILLER          PIC X(03)   VALUE    "966".
           03  FILLER          PIC X(03)   VALUE    "967".
      *
       01  TBL-GENBUTU70-R     REDEFINES   TBL-GENBUTU70-AREA.
           03  TBL-GENBUTU70   PIC X(03)   OCCURS    2.
      *
       01  TBL-GENBUTU70-MAX   PIC 9(02)   VALUE     2.
      *
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    収納マスター
       01  SYU-SYUNOU-REC.
           COPY    "CPSYUNOU.INC".
      *
      *    日別収納マスタ
       01  SYU-SYUDAY-REC.
           COPY    "CPSYUDAY.INC".
      *
      *    保険組み合わせ
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *    ワーク保険組み合わせ
       01  WRK-HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC"
                               REPLACING  //COMB-// BY //WRK-COMB-//.
      *
      *    保険番号
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *    ワーク保険番号
       01  WRK-HKNNUM-REC.
           COPY    "CPHKNNUM.INC"
                               REPLACING  //HKN-// BY //WRK-HKN-//.
      *
      *    点数
           COPY    "CPTENSU.INC".
      *
      *    システム管理
           COPY    "CPSK1001.INC".
           COPY    "CPSK1026.INC".
           COPY    "CPSK1027.INC".
           COPY    "CPSK1037.INC".
           COPY    "CPSK1039.INC".
           COPY    "CPSK2010.INC".
           COPY    "CPSK2012.INC".
           COPY    "CPSK4001.INC".
           COPY    "CPSK4003.INC".
      *
      *    患者情報
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    診療会計
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    診療行為
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    患者公費情報
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *
      *    患者保険情報
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *
      *    労災患者保険情報
       01  PTRSIINF-REC.
           COPY    "CPPTRSIINF.INC".
      *
      *    患者公費負担他院データ
       01  PTKOHFTNETC-REC.
           COPY    "CPPTKOHFTNETC.INC".
      *
      *****************************************************************
      *    サブプロ用　領域
      *****************************************************************
      *
      *    保険算定用年齢・割合計算サブ
           COPY    "CPORCSAGECHK.INC".
      *
      *    公費付加情報取得サブ
           COPY    "CPORCSKOHPLUS.INC".
      *
      *    公費月上限額取得サブ
           COPY    "CPORCSJGNGET.INC".
      *
      *    患者所得情報編集サブ
           COPY    "CPORCSSYOTOKU.INC".
      *
      *    特定疾患等算定判定サブ
           COPY    "CPORCSSRHKOH.INC".
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      ***  COPY    "CPORCMCP.INC".
      /
      ***
       LINKAGE             SECTION.
           COPY  "MCPAREA".
           COPY  "CPORCS01.INC".
       01  LNK-SYU-SYUNOU-REC.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //LNK-SYU-//.
       01  LNK2-SYUNOU-REC-T.
        02 LNK2-SYUNOU-REC      OCCURS 15.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //LNK2-SYU-//.
      *
           COPY  "COMMON-SPA".
      /
       PROCEDURE           DIVISION  USING
                                     MCPAREA
                                     LNK-ORCS01-REC
                                     LNK-SYU-SYUNOU-REC
                                     LNK2-SYUNOU-REC-T
                                     SPA-AREA.
      *
      ******************************************************************
      *        依頼制御処理
      ******************************************************************
       MAIN-RTN            SECTION.
       MAIN-000.
      *
      ***  MOVE    ZERO            TO  LNK-S01-RC.
           MOVE    LNK-S01-IDX     TO  IDY.
           MOVE    SPACE           TO  WRK-AREA.
           INITIALIZE                  WRK-AREA.
           MOVE    ZERO            TO  LNK-SYU-RJN-FTN
                                       LNK-SYU-KOH-FTN
                                       LNK-SYU-KOH-FTN-ENTANI
                                       LNK-SYU-YKZ-FTN
                                       LNK-SYU-HKNTEKMONEY.
           MOVE    ZERO            TO  LNK-SYU-SYUHKNFTNMONEY
                                       LNK-SYU-SYUCOMPFTN
                                       LNK-SYU-SYUCOMPFTN-ENTANI
                                       LNK-SYU-SYUCOMPYKZFTN
                                       LNK-SYU-SYUCOMPTOTAL.
           MOVE    SPACE    TO  LNK-SYU-SYUYKZFTNKBN.
           INITIALIZE    WK-SYUHKN-TAIHI-AREA.
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   4
                  MOVE    ZERO     TO  LNK-SYU-KOH-HKNFTNMONEY(IDX)
                                       LNK-SYU-KOH-COMPFTN(IDX)
                                       LNK-SYU-KOH-COMPFTN-ENTANI(IDX)
                                       LNK-SYU-KOH-COMPYKZFTN(IDX)
                                       LNK-SYU-KOH-COMPTOTAL(IDX)
                  MOVE    SPACE    TO  LNK-SYU-KOH-YKZFTNKBN(IDX)
                                       
           END-PERFORM.
           MOVE    ZERO            TO  LNK-SYU-TGMONEY-TAX-SAI
                                       LNK-SYU-RSI-TAX-SAI
                                       LNK-SYU-RSI-TOTAL
                                       LNK-SYU-RSIJIBAI-SKYMONEY
                                       LNK-SYU-SKYMONEY-TAX-SAI.
           MOVE    SPACE           TO  LNK-SYU-ZAITAKU.
           MOVE    SPACE           TO  LNK-SYU-DISCOUNT-KBN
                                       LNK-SYU-DISCOUNT-BODY
                                       LNK-SYU-DISCOUNT-RATEKBN
                                       LNK-SYU-DISCOUNT-TEIRITU.
           MOVE    ZERO            TO  LNK-SYU-DISCOUNT-RATE.
           MOVE    ZERO            TO  LNK-SYU-DISCOUNT-MONEY.
           MOVE    ZERO            TO  LNK-SYU-NYNSHOKAISU.
           MOVE    SPACE           TO  LNK-SYU-KOHTAIYKZKBN.
           MOVE    ZERO            TO  LNK-SYU-YKZKENNUM.
           MOVE    ZERO            TO  LNK-SYU-SECMONEY.
           MOVE    SPACE           TO  LNK-SYU-SAIKEISANKBN.
           MOVE    SPACE           TO  LNK-SYU-HKNTEKKBN.
      *
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   14
                  MOVE    ZERO     TO  LNK-SYU-SHOKUJI(IDX)
                                       LNK-SYU-SHOKUJI-NISSU(IDX)
           END-PERFORM.              
           MOVE    ZERO            TO  LNK-SYU-JYO-HKNFTNMONEY.
           MOVE    ZERO            TO  LNK-SYU-JYO-COMPFTN.
           MOVE    ZERO            TO  LNK-SYU-JYO-COMPFTN-ENTANI.
           MOVE    ZERO            TO  LNK-SYU-TAX-TAISHOU.
      *
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   3
                  MOVE    ZERO     TO  LNK-SYU-SKJ-FTNGAKU(IDX)
                                       LNK-SYU-SKJ-FTNDAY(IDX)
           END-PERFORM.
      *
           MOVE    ZERO            TO  FLG-SEISINJYO
                                       FLG-TOKUREI-HKNJYA.
      *
           INITIALIZE                  WK-HBTNUM-TBL.
           INITIALIZE                  WK-CHECK2010-TBL.
      *
      *    システム管理１００１の取り込み
           PERFORM    SYS1001-READ-SEC.
      *
           MOVE   SYS-1001-DISCOUNT-HASU-KBN  TO   WK-HASU1001-KBN.
           IF   WK-HASU1001-KBN  =  SPACE
              MOVE   "1"                      TO   WK-HASU1001-KBN
           END-IF.
           MOVE   SYS-1001-DISCOUNT-HASU-KBN2 TO   WK-HASU1001-KBN2.
           IF   WK-HASU1001-KBN2 =  SPACE
              MOVE   "4"                      TO   WK-HASU1001-KBN2
           END-IF.
           MOVE   SYS-1001-DISCOUNT-HASU-KBN2J TO  WK-HASU1001-KBN2J.
           IF   WK-HASU1001-KBN2J = SPACE
              MOVE   "0"                       TO  WK-HASU1001-KBN2J
           END-IF.
      *
           MOVE   SYS-1001-DISCOUNT-HASU-KBN3 TO   WK-HASU1001-KBN3.
           IF   WK-HASU1001-KBN3 =  SPACE
              MOVE   "4"                      TO   WK-HASU1001-KBN3
           END-IF.
           MOVE   SYS-1001-DISCOUNT-HASU-KBN3J TO  WK-HASU1001-KBN3J.
           IF   WK-HASU1001-KBN3J = SPACE
              MOVE   "0"                       TO  WK-HASU1001-KBN3J
           END-IF.
      *
           MOVE   SYS-1001-DISCOUNT-HASU-KBN4 TO   WK-HASU1001-KBN4.
           IF   WK-HASU1001-KBN4 =  SPACE
              MOVE   "4"                      TO   WK-HASU1001-KBN4
           END-IF.
           MOVE   SYS-1001-DISCOUNT-HASU-KBN4J TO  WK-HASU1001-KBN4J.
           IF   WK-HASU1001-KBN4J = SPACE
              MOVE   "0"                       TO  WK-HASU1001-KBN4J
           END-IF.
      *
           MOVE   SYS-1001-DISCOUNT-HASU-KBN5J TO  WK-HASU1001-KBN5J.
           IF   WK-HASU1001-KBN5J = SPACE
              MOVE   "4"                       TO  WK-HASU1001-KBN5J
           END-IF.
      *
           MOVE   SYS-1001-DISCOUNT-HASU-KBN6 TO   WK-HASU1001-KBN6.
           IF   WK-HASU1001-KBN6 =  SPACE
              MOVE   WK-HASU1001-KBN4         TO   WK-HASU1001-KBN6
           END-IF.
           MOVE   SYS-1001-DISCOUNT-HASU-KBN6J TO  WK-HASU1001-KBN6J.
           IF   WK-HASU1001-KBN6J = SPACE
              MOVE   WK-HASU1001-KBN4J         TO  WK-HASU1001-KBN6J
           END-IF.
      *
           MOVE   SYS-1001-TAX-HASU-KBN       TO   WK-TAX1001-KBN.
           IF   WK-TAX1001-KBN = SPACE
              MOVE   "2"                      TO   WK-TAX1001-KBN
           END-IF.
           MOVE   SYS-1001-PREFNUM            TO   WK-1001-PREFNUM.
           MOVE   SYS-1001-HOSPSBT            TO   WK-1001-HOSPSBT.
           MOVE   SYS-1001-ROUPAYKBN          TO   WK-1001-ROUPAYKBN.
           MOVE   SYS-1001-JIHIPOSITION       TO   WK-1001-JIHIPOSITION.
           MOVE   SYS-1001-CHIHOUNUMKBN       TO   WK-1001-CHIHOUNUMKBN.
           MOVE   SYS-1001-GENTAIKBN          TO   WK-1001-GENTAIKBN.
           MOVE   SYS-1001-DAISANKBN          TO   WK-1001-DAISANKBN.
           IF   WK-1001-DAISANKBN = SPACE
              MOVE   "2"                      TO   WK-1001-DAISANKBN
           END-IF.
      *
      *    システム管理１０３９の取り込み
           PERFORM    SYS1039-READ-SEC.
      *
      *    消費税計算の係数設定
           IF  LNK-SYU-SRYYMD(1:6) >= "201404"
               MOVE       8      TO  WK-S1
               MOVE     108      TO  WK-S2
               MOVE     0.08     TO  WK-S4
               MOVE     1.08     TO  WK-S5
           ELSE
               MOVE       5      TO  WK-S1
               MOVE     105      TO  WK-S2
               MOVE     0.05     TO  WK-S4
               MOVE     1.05     TO  WK-S5
           END-IF.
           EVALUATE  WK-TAX1001-KBN
               WHEN      "1"
                 MOVE   0.50000  TO  WK-S3
               WHEN      "2"
                 MOVE   0.00000  TO  WK-S3
               WHEN      "3"
                 MOVE   0.99999  TO  WK-S3
           END-EVALUATE.
      *
      *    保険組合せマスタの検索
           INITIALIZE                           HKNCOMBI-REC.
           MOVE    LNK-SYU-HOSPNUM      TO      COMB-HOSPNUM.
           MOVE    LNK-SYU-PTID         TO      COMB-PTID.
           MOVE    LNK-SYU-HKNCOMBINUM  TO      COMB-HKNCOMBINUM.
           MOVE    HKNCOMBI-REC         TO      MCPDATA-REC.
           MOVE    "DBSELECT"           TO      MCP-FUNC.
           MOVE    "tbl_hkncombi"       TO      MCP-TABLE.
           MOVE    "key"                TO      MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_hkncombi"   TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM   HKNCOMBI-READ-SEC
               IF      FLG-HKNCOMBI     =       1
                   DISPLAY "HKNCOMBI DBFETCH ERR"
                   MOVE     10             TO   LNK-S01-RC
                   MOVE    "tbl_hkncombi"  TO   MCP-TABLE
                   MOVE    "key"           TO   MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
                   GO   TO              MAIN-EXT
               END-IF
           ELSE
               MOVE    1                TO      FLG-HKNCOMBI
               DISPLAY "HKNCOMBI DBSELECT ERR"
               MOVE     10              TO      LNK-S01-RC
               MOVE    "tbl_hkncombi"   TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
               GO   TO                  MAIN-EXT
           END-IF.
           MOVE    "tbl_hkncombi"       TO       MCP-TABLE.
           MOVE    "key"                TO       MCP-PATHNAME.
           PERFORM  DB-CLOSE-SEC.
      *
           MOVE     ZERO                TO   FLG-DAISAN-GENBUTU.
           IF  (LNK-SYU-SRYYMD(1:6)    >=    "201204")
           AND (COMB-KOH1HKNNUM         =    "970"   )
              INITIALIZE                     PTRSIINF-REC
              MOVE    COMB-HOSPNUM      TO   PTRSI-HOSPNUM
              MOVE    COMB-PTID         TO   PTRSI-PTID
              MOVE    COMB-KOH1ID       TO   PTRSI-KOHID
              MOVE    PTRSIINF-REC      TO   MCPDATA-REC
              MOVE    "DBSELECT"        TO   MCP-FUNC
              MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
              MOVE    "key"             TO   MCP-PATHNAME
              CALL    "ORCDBMAIN"       USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
              IF      MCP-RC  =  ZERO
                MOVE    "tbl_ptrsiinf"  TO   MCP-TABLE
                MOVE    "key"           TO   MCP-PATHNAME
                PERFORM  PTRSIINF-READ-SEC
                IF    FLG-PTRSIINF     =  ZERO
      *           現物給付対象とする
                  IF     PTRSI-DAISAN-GENBTKBN  =  "2"
                     MOVE     1         TO   FLG-DAISAN-GENBUTU
                  END-IF
                END-IF
              END-IF
              MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
              MOVE    "key"             TO   MCP-PATHNAME
              PERFORM  DB-CLOSE-SEC
           END-IF.
      *
      *    保険組合せマスタの参照部分確定
           PERFORM   100-KAKUTEI-SEC.
      *
      *    自費保険のデータ編集
           MOVE      ZERO    TO    WK-SKYMONEY-ZEI.
           PERFORM   104-JIHIHOKEN-DATA-HENSYU-SEC.
      *    保険組合せの上限区分編集
           PERFORM   105-JYOGENKBN-HENSYU-SEC.
      *
      *    保険組合せマスタから主保険の保険種類を判定
      *    （空白：医保、１：労災自賠、２：公害）
           MOVE     SPACE               TO       WK-HKNKBN.
           EVALUATE    COMB-SYU-HKNKOHSBTKBN
               WHEN    "4"
                       MOVE    "1"      TO       WK-HKNKBN
           END-EVALUATE.
           IF   COMB-HKNNUM  = "975"
                       MOVE    "2"      TO       WK-HKNKBN
           END-IF.
      *
      *    薬剤一部負担金の計算処理
           MOVE         ZERO              TO     LNK-SYU-YKZ-FTN.
           MOVE         ZERO              TO     LNK-SYU-RESE-YKZ-FTN.
           IF    LNK-SYU-SRYYMD(1:6)   <   "200304"
                PERFORM      YAKFTN-SANTEI-SEC
           ELSE
                MOVE      SPACE       TO      YAKFTN-AREA
                INITIALIZE                    YAKFTN-AREA
           END-IF.
           MOVE         YAKFTN-SOGOKEI    TO     LNK-SYU-RESE-YKZ-FTN.
           EVALUATE     FLG-SANSHOU
               WHEN     "1"
                   IF  COMB-GAI-YKZFTNKBN      NOT =   "0"
                       MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                       IF     COMB-GAI-YKZFTNKBN     =   "1"
                            MOVE   YAKFTN-SOGOKEI  TO  LNK-SYU-YKZ-FTN
                       END-IF
      *             ELSE
      *                 MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                   END-IF
               WHEN     "2"
                   IF  COMB-TSY-GAIYKZFTNKBN   NOT =   "0"
                       MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                       IF   COMB-TSY-GAIYKZFTNKBN  =   "1"
                            MOVE   YAKFTN-SOGOKEI  TO  LNK-SYU-YKZ-FTN
                       END-IF
      *             ELSE
      *                 MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                   END-IF
               WHEN     "3"
                   IF  COMB-TNK-GAIYKZFTNKBN   NOT =   "0"
                       MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                       IF   COMB-TNK-GAIYKZFTNKBN  =   "1"
                            MOVE   YAKFTN-SOGOKEI  TO  LNK-SYU-YKZ-FTN
                       END-IF
      *             ELSE
      *                 MOVE   YAKFTN-SOGOKEI   TO  LNK-SYU-RESE-YKZ-FTN
                   END-IF
           END-EVALUATE.
      *
      *    患者負担額の算定
           PERFORM       200-HKNFTN-SANTEI-SEC
           EVALUATE      FLG-SANSHOU
               WHEN      "1"
                   IF   (COMB-GAI-FTNKBN       =    "2")    AND
                        (COMB-GAI-YKZFTNKBN    =    "2")
                         MOVE   ZERO        TO   WK-KNJFTNKIN
                                                 WK-KNJFTNKIN-ENTANI
                                                 LNK-SYU-SKYMONEY
                   END-IF
               WHEN      "2"
                   IF   (COMB-TSY-GAIFTNKBN    =    "2")    AND
                        (COMB-TSY-GAIYKZFTNKBN =    "2")
                         MOVE   ZERO        TO   WK-KNJFTNKIN
                                                 WK-KNJFTNKIN-ENTANI
                                                 LNK-SYU-SKYMONEY
                   END-IF
               WHEN      "3"
                   IF   (COMB-TNK-GAIFTNKBN    =    "2")    AND
                        (COMB-TNK-GAIYKZFTNKBN =    "2")
                         MOVE   ZERO        TO   WK-KNJFTNKIN
                                                 WK-KNJFTNKIN-ENTANI
                                                 LNK-SYU-SKYMONEY
                   END-IF
           END-EVALUATE.
           EVALUATE      FLG-SANSHOU
               WHEN      "1"
                   IF    COMB-GAI-YKZFTNKBN    =    "0"   OR  "3"
                         MOVE   ZERO        TO      LNK-SYU-YKZ-FTN
                   END-IF
               WHEN      "2"
                   IF    COMB-TSY-GAIYKZFTNKBN    =    "0"   OR  "3"
                         MOVE   ZERO        TO      LNK-SYU-YKZ-FTN
                   END-IF
               WHEN      "3"
                   IF    COMB-TNK-GAIYKZFTNKBN    =    "0"   OR  "3"
                         MOVE   ZERO        TO      LNK-SYU-YKZ-FTN
                   END-IF
           END-EVALUATE.
      *
      *    算出請求額の１０円未満四捨五入（薬剤一部負担金も含む）
      *    ※労災保険の場合は四捨五入を行わない
           IF     (LNK-SYU-SKYMONEY      NOT =   ZERO)   OR
                  (LNK-SYU-YKZ-FTN       NOT =   ZERO)
               IF   WK-HKNKBN                =   SPACE
                 IF   FLG-KUMAMOTO           =   "1"
                 OR   COMB-SYU-HKNKOHSBTKBN  =   "8"
                 OR   FLG-KOUGAKUCYO         =    1
                 OR   FLG-KOUGAKUCYO2        =    1
                 OR   FLG-KOUGAKUCYO3        =    1
                 OR   FLG-KOUGAKUCYO-JIRITU  =    1
                 OR   FLG-KOUGAKUCYO-ININ    =    1
                 OR   FLG-KOUGAKUCYO-GEN70   =    1
                 OR   FLG-KOUGAKUCYO-GEN70K  =    1
                 OR   FLG-KOUGAKUCYO-OITA    =    1
                 OR   FLG-FTNGAKEN           =    1
                 OR   COMB-SYU-HKNKOHSBTKBN  =   "9"
                   COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +
                                               LNK-SYU-YKZ-FTN
                 ELSE
                   COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +
                                               LNK-SYU-YKZ-FTN
                   COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +  5
                   COMPUTE  WK-SEIKYUGK      = LNK-SYU-SKYMONEY  /  10
                   COMPUTE  LNK-SYU-SKYMONEY = WK-SEIKYUGK       *  10
                 END-IF
               ELSE
                   COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +
                                               LNK-SYU-YKZ-FTN
               END-IF 
           END-IF.
      *
           IF   WK-HKNKBN  =   "1" OR "2"
              IF     LNK-SYU-YKZ-FTN    NOT =    ZERO
                   COMPUTE  LNK-SYU-RSIJIBAI-SKYMONEY =
                            LNK-SYU-RSIJIBAI-SKYMONEY +
                            LNK-SYU-YKZ-FTN
              END-IF
           END-IF.
      *
      *    主保険・老人・公費の判別
      *      （主保険）
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)    AND
                  (LNK-SYU-KOH1HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH2HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH3HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH4HKNNUM    =       SPACE)
                   MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-HKNTEKMONEY
                   IF     LNK-SYU-YKZ-FTN    NOT =   ZERO
                          COMPUTE  LNK-SYU-HKNTEKMONEY  =
                                   LNK-SYU-HKNTEKMONEY  -
                                   LNK-SYU-YKZ-FTN
                   END-IF
           END-IF.
      *       （老人） 
      *
           IF     (LNK-SYU-KOH1HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH2HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH3HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH4HKNNUM    =   SPACE)
                   CONTINUE
           ELSE
               IF      COMB-KOH1-HKNKOHSBTKBN    =       "3"
                  IF  (COMB-KOH2-HKNKOHSBTKBN    =     SPACE)  AND
                      (COMB-KOH3-HKNKOHSBTKBN    =     SPACE)  AND
                      (COMB-KOH4-HKNKOHSBTKBN    =     SPACE)
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-RJN-FTN
                       IF     LNK-SYU-YKZ-FTN    NOT =   ZERO
                               COMPUTE  LNK-SYU-RJN-FTN  =
                                        LNK-SYU-RJN-FTN  -
                                        LNK-SYU-YKZ-FTN
                       END-IF
                  ELSE
      *            （公費）
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-KOH-FTN
                       IF     LNK-SYU-YKZ-FTN    NOT =   ZERO
                               COMPUTE  LNK-SYU-KOH-FTN  =
                                        LNK-SYU-KOH-FTN  -
                                        LNK-SYU-YKZ-FTN
                       END-IF
                       MOVE    WK-KNJFTNKIN-ENTANI
                                          TO   LNK-SYU-KOH-FTN-ENTANI
                  END-IF
               ELSE
      *            （公費）
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-KOH-FTN
                       IF     LNK-SYU-YKZ-FTN    NOT =   ZERO
                               COMPUTE  LNK-SYU-KOH-FTN  =
                                        LNK-SYU-KOH-FTN  -
                                        LNK-SYU-YKZ-FTN
                       END-IF
                       MOVE    WK-KNJFTNKIN-ENTANI
                                          TO   LNK-SYU-KOH-FTN-ENTANI
               END-IF
           END-IF.
      *
      *    自費金額の消費税計算
           COMPUTE   LNK-SYU-JIHI-TOTAL =  (LNK-SYU-JIHI-TAXNASI(1)  +
                                            LNK-SYU-JIHI-TAXNASI(2)  +
                                            LNK-SYU-JIHI-TAXNASI(3)  +
                                            LNK-SYU-JIHI-TAXNASI(4)  +
                                            LNK-SYU-JIHI-TAXNASI(5)  +
                                            LNK-SYU-JIHI-TAXNASI(6)  +
                                            LNK-SYU-JIHI-TAXNASI(7)  +
                                            LNK-SYU-JIHI-TAXNASI(8)  +
                                            LNK-SYU-JIHI-TAXNASI(9)  +
                                            LNK-SYU-JIHI-TAXNASI(10)).
           COMPUTE  LNK-SYU-JIHI-TOTAL-TAX = (LNK-SYU-JIHI-TAXARI(1) +
                                              LNK-SYU-JIHI-TAXARI(2) +
                                              LNK-SYU-JIHI-TAXARI(3) +
                                              LNK-SYU-JIHI-TAXARI(4) +
                                              LNK-SYU-JIHI-TAXARI(5) +
                                              LNK-SYU-JIHI-TAXARI(6) +
                                              LNK-SYU-JIHI-TAXARI(7) +
                                              LNK-SYU-JIHI-TAXARI(8) +
                                              LNK-SYU-JIHI-TAXARI(9) +
                                              LNK-SYU-JIHI-TAXARI(10)).
      *
      *    保険適用外金額の加算
           MOVE       ZERO              TO  LNK-SYU-TGMONEY(17).
           MOVE       ZERO              TO  LNK-SYU-TGMONEY-TAX(17).
           PERFORM    VARYING   HKNGAI-IDX   FROM   1   BY   1
                      UNTIL     HKNGAI-IDX   >     16
                      ADD       LNK-SYU-TGMONEY(HKNGAI-IDX)
                                            TO  LNK-SYU-TGMONEY(17)
                      ADD       LNK-SYU-TGMONEY-TAX(HKNGAI-IDX)
                                        TO  LNK-SYU-TGMONEY-TAX(17)
           END-PERFORM.
      *
           MOVE      LNK-SYU-SKYMONEY   TO  WK-SKYCHK-KEISAN7.
      *
           IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
             COMPUTE  WK-SKYCHK-KEISAN8  =  LNK-SYU-TGMONEY(17)
                                         +  LNK-SYU-TGMONEY-TAX(17)
                                         +  LNK-SYU-JIHI-TOTAL
                                         +  LNK-SYU-JIHI-TOTAL-TAX
      *
             COMPUTE    LNK-SYU-JIHI-TAX =
                       (LNK-SYU-JIHI-TOTAL-TAX  * WK-S1 / WK-S2)
                                                        + WK-S3
             COMPUTE    LNK-SYU-TGMONEY-TAX-SAI   =
                       (LNK-SYU-TGMONEY-TAX(17) * WK-S1 / WK-S2)
                                                        + WK-S3
             IF   WK-HKNKBN  =   "1" OR "2"
                  COMPUTE    LNK-SYU-RSIJIBAI-SKYMONEY  =
                             LNK-SYU-RSIJIBAI-SKYMONEY  +
                             LNK-SYU-TGMONEY(17)        +
                             LNK-SYU-TGMONEY-TAX(17)    +
                             LNK-SYU-JIHI-TOTAL         +
                             LNK-SYU-JIHI-TOTAL-TAX
             END-IF
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9" ) AND
                 ( COMB-HOJOKBN           =  "1"        )
                 COMPUTE  LNK-SYU-TAX-TAISHOU     =
                          LNK-SYU-HKNTEKMONEY     +
                          LNK-SYU-TGMONEY-TAX(17) +
                          LNK-SYU-JIHI-TOTAL-TAX
             ELSE
                 COMPUTE  LNK-SYU-TAX-TAISHOU     =
                          LNK-SYU-TGMONEY-TAX(17) +
                          LNK-SYU-JIHI-TOTAL-TAX
             END-IF
             COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                     (LNK-SYU-TAX-TAISHOU * WK-S1 / WK-S2)
                                                  + WK-S3
           ELSE
             COMPUTE  WK-SKYCHK-KEISAN8  =  LNK-SYU-TGMONEY(17)
                                         +  LNK-SYU-TGMONEY-TAX(17)
                                         +  LNK-SYU-JIHI-TOTAL
                                         +  LNK-SYU-JIHI-TOTAL-TAX
                                         +  LNK-SYU-JIHI-TAX
      *
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9" ) AND
                 ( COMB-HOJOKBN           =  "1"        )
              CONTINUE
             ELSE
              COMPUTE   LNK-SYU-JIHI-TAX =
                       (LNK-SYU-JIHI-TOTAL-TAX  * WK-S4) + WK-S3
              COMPUTE   LNK-SYU-TGMONEY-TAX-SAI   =
                       (LNK-SYU-TGMONEY-TAX(17) * WK-S4) + WK-S3
              COMPUTE   LNK-SYU-TGMONEY-TAX(17)   = 
                       (LNK-SYU-TGMONEY-TAX(17) * WK-S5) + WK-S3
             END-IF
             IF   WK-HKNKBN  =   "1" OR "2"
                  COMPUTE    LNK-SYU-RSIJIBAI-SKYMONEY  =
                             LNK-SYU-RSIJIBAI-SKYMONEY  +
                             LNK-SYU-TGMONEY(17)        +
                             LNK-SYU-TGMONEY-TAX(17)    +
                             LNK-SYU-JIHI-TOTAL         +
                             LNK-SYU-JIHI-TOTAL-TAX     +
                             LNK-SYU-JIHI-TAX
             END-IF
      *      自費保険の補助区分が課税の場合、消費税計算を行う
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9" ) AND
                 ( COMB-HOJOKBN           =  "1"        )
               COMPUTE  WK-SKYCHK-KEISAN3 =  WK-SKYCHK-KEISAN7
                                          +  WK-SKYCHK-KEISAN8
               COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                      ( WK-SKYCHK-KEISAN3 *  WK-S4 ) + WK-S3
               COMPUTE  WK-SKYCHK-KEISAN4 =
                      ( WK-SKYCHK-KEISAN3 *  WK-S5 ) + WK-S3
               COMPUTE  WK-SKYCHK-KEISAN5 =
                        WK-SKYCHK-KEISAN4 -  WK-SKYCHK-KEISAN3
               COMPUTE  WK-SKYCHK-KEISAN8 =  WK-SKYCHK-KEISAN8
                                          +  WK-SKYCHK-KEISAN5
             ELSE
               COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                        LNK-SYU-JIHI-TAX          +
                        LNK-SYU-TGMONEY-TAX-SAI
             END-IF
           END-IF.
      *
      *    減免計算・請求額端数計算（労災・自賠責・公害を除く）
           MOVE     ZERO      TO    FLG-GENMEN.
           IF  (LNK-SYU-SYUHKNNUM         =    "971" OR "973" OR "975")
           OR  (LNK-SYU-KOH1HKNNUM        =    "970"                  )
                   CONTINUE
           ELSE
      *            減免計算
                   INITIALIZE                           PTINF-REC
                   MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM
                   MOVE    LNK-SYU-PTID         TO      PTINF-PTID
                   MOVE    PTINF-REC            TO      MCPDATA-REC
                   MOVE    "DBSELECT"           TO      MCP-FUNC
                   MOVE    "tbl_ptinf"          TO      MCP-TABLE
                   MOVE    "key"                TO      MCP-PATHNAME
                   CALL    "ORCDBMAIN"          USING   MCPAREA
                                                        MCPDATA-REC
                                                        SPA-AREA
                   IF      MCP-RC               =       ZERO
                       MOVE    "tbl_ptinf"      TO      MCP-TABLE
                       MOVE    "key"            TO      MCP-PATHNAME
                       PERFORM  PTINF-READ-SEC
                       IF       MCP-RC          =       ZERO
                           PERFORM   300-GENMEN-KEISAN-SEC
                       ELSE
                           DISPLAY  "PTINF FETCH ERR"
                       END-IF
                   ELSE
                       DISPLAY   "PTINF SELECT ERR"
                   END-IF
      *
                   MOVE    "tbl_ptinf"          TO       MCP-TABLE
                   MOVE    "key"                TO       MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
      *
      *            請求額端数計算（減免無し）
                   IF    FLG-GENMEN  =  ZERO
                     MOVE  WK-HASU1001-KBN2   TO  WK-HASU1001-KBN-WK
                     MOVE  WK-HASU1001-KBN2J  TO  WK-HASU1001-KBN-WKJ
                     PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
                   END-IF
           END-IF.
      *
      *    請求金額の計算（労災）
           IF    LNK-SYU-SYUHKNNUM       =    "971"
             IF    LNK-SYU-PTFTNRATE  =  100
               COMPUTE    WK-SKYCHK-KEISAN7        =
                          WK-SKYCHK-KEISAN7        +
                          LNK-SYU-RSISHOSHIN-MONEY +
                          LNK-SYU-RSISAISHIN-MONEY +
                          LNK-SYU-RSISDO-MONEY     +
                          LNK-SYU-RSIETC-MONEY
               COMPUTE    LNK-SYU-RSI-TOTAL        =
                          LNK-SYU-RSISHOSHIN-MONEY +
                          LNK-SYU-RSISAISHIN-MONEY +
                          LNK-SYU-RSISDO-MONEY     +
                          LNK-SYU-RSIETC-MONEY
             END-IF
      *
             MOVE  WK-HASU1001-KBN3   TO  WK-HASU1001-KBN-WK
             MOVE  WK-HASU1001-KBN3J  TO  WK-HASU1001-KBN-WKJ
             PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
      *
             COMPUTE      LNK-SYU-RSIJIBAI-SKYMONEY  =
                          LNK-SYU-RSIJIBAI-SKYMONEY  +
                          LNK-SYU-RSISHOSHIN-MONEY   +
                          LNK-SYU-RSISAISHIN-MONEY   +
                          LNK-SYU-RSISDO-MONEY       +
                          LNK-SYU-RSIETC-MONEY
           END-IF.
      *
      *    請求金額の計算（自賠責）
           MOVE     ZERO      TO   WK-RSIETC-ZEITAISYO.
           IF    LNK-SYU-SYUHKNNUM       =    "973"
             PERFORM   500-JIBAI-SONOTA-HENSYU-SEC
      *
             IF   FLG-KENPOJYUNKYO      =     ZERO
               COMPUTE  LNK-SYU-RSISHOSHIN-MONEY =
                       (LNK-SYU-RSISHOSHIN-MONEY *  WK-4001-KSNRATE)
                                                 +  0.5
               COMPUTE  LNK-SYU-RSISAISHIN-MONEY =
                       (LNK-SYU-RSISAISHIN-MONEY *  WK-4001-KSNRATE)
                                                 +  0.5
               IF   LNK-SYU-SRYYMD(1:6)  >=   "201307"
                 COMPUTE  LNK-SYU-RSISDO-MONEY =
                         (LNK-SYU-RSISDO-MONEY *  WK-4001-KSNRATE)
                                               +  0.5
                 COMPUTE  LNK-SYU-RSIETC-MONEY =
                          LNK-SYU-RSIETC-MONEY -
                          LNK-S01-KYUKYU(IDY)
                 COMPUTE  WK-KEISAN            =
                         (LNK-S01-KYUKYU(IDY)  *  WK-4001-KSNRATE)
                                               +  0.5
                 COMPUTE  LNK-SYU-RSIETC-MONEY =
                          LNK-SYU-RSIETC-MONEY +  WK-KEISAN
               ELSE
                 COMPUTE  WK-RSISDO-MONEY2     =
                         (WK-RSISDO-MONEY      *  WK-4001-KSNRATE)
                                               +  0.5
                 COMPUTE  LNK-SYU-RSISDO-MONEY =
                          LNK-SYU-RSISDO-MONEY +
                          WK-RSISDO-MONEY2
               END-IF
             END-IF
      *
             IF    LNK-SYU-PTFTNRATE  =  100
               COMPUTE    WK-SKYCHK-KEISAN7        =
                          WK-SKYCHK-KEISAN7        +
                          LNK-SYU-RSISHOSHIN-MONEY +
                          LNK-SYU-RSISAISHIN-MONEY +
                          LNK-SYU-RSISDO-MONEY     +
                          LNK-SYU-RSIETC-MONEY
               COMPUTE    LNK-SYU-RSI-TOTAL        =
                          LNK-SYU-RSISHOSHIN-MONEY +
                          LNK-SYU-RSISAISHIN-MONEY +
                          LNK-SYU-RSISDO-MONEY     +
                          LNK-SYU-RSIETC-MONEY
               IF    LNK-SYU-SRYYMD(1:6)  >=  "200704"
                 COMPUTE  LNK-SYU-TAX-TAISHOU      =
                          LNK-SYU-TGMONEY-TAX(17)  +
                          LNK-SYU-JIHI-TOTAL-TAX   +
                          WK-RSIETC-ZEITAISYO
                 COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI =
                         (LNK-SYU-TAX-TAISHOU * WK-S1 / WK-S2)
                                                      + WK-S3
               ELSE
                 COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI =
                          LNK-SYU-SKYMONEY-TAX-SAI +
                          LNK-SYU-RSI-TAX-SAI
               END-IF
             END-IF
      *
             MOVE  WK-HASU1001-KBN4   TO  WK-HASU1001-KBN-WK
             MOVE  WK-HASU1001-KBN4J  TO  WK-HASU1001-KBN-WKJ
             PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
      *
             COMPUTE      LNK-SYU-RSIJIBAI-SKYMONEY  =
                          LNK-SYU-RSIJIBAI-SKYMONEY  +
                          LNK-SYU-RSISHOSHIN-MONEY   +
                          LNK-SYU-RSISAISHIN-MONEY   +
                          LNK-SYU-RSISDO-MONEY       +
                          LNK-SYU-RSIETC-MONEY
           END-IF.
      *
      *    請求金額の計算（公害）
           IF    LNK-SYU-SYUHKNNUM       =    "975"
              MOVE  "4"                TO  WK-HASU1001-KBN-WK
              MOVE  WK-HASU1001-KBN5J  TO  WK-HASU1001-KBN-WKJ
              PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
           END-IF.
      *
      *    請求金額の計算（第三者行為）
           IF    LNK-SYU-KOH1HKNNUM      =    "970"
              INITIALIZE                       SYS-4001-REC
              MOVE    "4001"               TO  SYS-4001-KANRICD
              MOVE    "*"                  TO  SYS-4001-KBNCD
              MOVE    LNK-SYU-HOSPNUM      TO  SYS-4001-HOSPNUM
              MOVE    LNK-SYU-SRYYMD       TO  SYS-4001-STYUKYMD
              MOVE    LNK-SYU-SRYYMD       TO  SYS-4001-EDYUKYMD
              MOVE    SYS-4001-REC         TO  MCPDATA-REC
              MOVE    "DBSELECT"           TO  MCP-FUNC
              MOVE    "tbl_syskanri"       TO  MCP-TABLE
              MOVE    "key10"              TO  MCP-PATHNAME
              CALL    "ORCDBMAIN"          USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
              IF      MCP-RC               =   ZERO
                MOVE     "tbl_syskanri"    TO  MCP-TABLE
                MOVE     "key10"           TO  MCP-PATHNAME
                PERFORM   SYSKANRI-READ-SEC
                IF    MCP-RC               =   ZERO
                  MOVE SYS-4001-TAXKBN     TO  WK-4001-TAXKBN
                  MOVE SYS-4001-TAXKBN-KZI TO  WK-4001-TAXKBN-KZI
                END-IF
              END-IF
              MOVE    "tbl_syskanri"       TO  MCP-TABLE
              MOVE    "key10"              TO  MCP-PATHNAME
              PERFORM  DB-CLOSE-SEC
      *
              PERFORM  500-JIBAI-SONOTA-HENSYU-SEC
      *
              IF    LNK-SYU-PTFTNRATE      =   ZERO
                CONTINUE
              ELSE
                COMPUTE  WK-SKYCHK-KEISAN7        =
                         WK-SKYCHK-KEISAN7        +
                         LNK-SYU-RSISHOSHIN-MONEY +
                         LNK-SYU-RSISAISHIN-MONEY +
                         LNK-SYU-RSISDO-MONEY     +
                         LNK-SYU-RSIETC-MONEY
                COMPUTE  LNK-SYU-RSI-TOTAL        =
                         LNK-SYU-RSISHOSHIN-MONEY +
                         LNK-SYU-RSISAISHIN-MONEY +
                         LNK-SYU-RSISDO-MONEY     +
                         LNK-SYU-RSIETC-MONEY
                COMPUTE  LNK-SYU-TAX-TAISHOU      =
                         LNK-SYU-TGMONEY-TAX(17)  +
                         LNK-SYU-JIHI-TOTAL-TAX   +
                         WK-RSIETC-ZEITAISYO
                COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                        (LNK-SYU-TAX-TAISHOU * WK-S1 / WK-S2)
                                                     + WK-S3
              END-IF
      *
              MOVE  WK-HASU1001-KBN6   TO  WK-HASU1001-KBN-WK
              MOVE  WK-HASU1001-KBN6J  TO  WK-HASU1001-KBN-WKJ
              PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
      *
              COMPUTE    LNK-SYU-RSIJIBAI-SKYMONEY  =
                         LNK-SYU-RSIJIBAI-SKYMONEY  +
                         LNK-SYU-TGMONEY(17)        +
                         LNK-SYU-TGMONEY-TAX(17)    +
                         LNK-SYU-JIHI-TOTAL         +
                         LNK-SYU-JIHI-TOTAL-TAX     +
                         LNK-SYU-RSISHOSHIN-MONEY   +
                         LNK-SYU-RSISAISHIN-MONEY   +
                         LNK-SYU-RSISDO-MONEY       +
                         LNK-SYU-RSIETC-MONEY
           END-IF.
      *
      *    患者負担金　独自計算対応
      *
           INITIALIZE                         SYS-1037-REC.
           MOVE    "1037"               TO    SYS-1037-KANRICD.
           MOVE    "*"                  TO    SYS-1037-KBNCD.
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-1037-HOSPNUM.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1037-STYUKYMD.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1037-EDYUKYMD.
           MOVE    SYS-1037-REC         TO    MCPDATA-REC.
           MOVE    "DBSELECT"           TO    MCP-FUNC.
           MOVE    "tbl_syskanri"       TO    MCP-TABLE.
           MOVE    "key10"              TO    MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =     ZERO
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key10"         TO    MCP-PATHNAME
               PERFORM   SYSKANRI-READ-SEC
               IF    MCP-RC             =     ZERO
                   IF   LNK-SYU-HOSPNUM   =    SYS-1037-HOSPNUM
                       IF  SYS-1037-PGID NOT = SPACE
                          CALL   SYS-1037-PGID   USING
                                                 MCPAREA
                                                 LNK-SYU-SYUNOU-REC
                                                 SPA-AREA
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
           MOVE     "tbl_syskanri"  TO    MCP-TABLE.
           MOVE     "key10"         TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    請求金額の計算（調整金の加減算）
      ***  COMPUTE    LNK-SYU-SKYMONEY  =   LNK-SYU-SKYMONEY    +
      ***                                   LNK-SYU-CHOSEI.
           COMPUTE    WK-KEISAN         =   LNK-SYU-SKYMONEY    +
                                            LNK-SYU-CHOSEI.
           IF   WK-KEISAN  <  ZERO
               MOVE     LNK-SYU-CHOSEI      TO  WRK-SYU-CHOSEI
               COMPUTE  LNK-SYU-CHOSEI  =   LNK-SYU-SKYMONEY
                                        *   -1
      *!!!!
               IF       LNK-SYU-CHOSEI2        =   ZERO
                   MOVE    LNK-SYU-CHOSEI      TO  LNK-SYU-CHOSEI1
                   MOVE    ZERO                TO  LNK-SYU-CHOSEI2
               ELSE
                   MOVE    LNK-SYU-CHOSEI2     TO  WRK-SYU-CHOSEI2
                   COMPUTE LNK-SYU-CHOSEI2     =   WRK-SYU-CHOSEI2
                                               -  (WRK-SYU-CHOSEI
                                               -   LNK-SYU-CHOSEI )
               END-IF
      *!!!!
               MOVE   ZERO            TO   LNK-SYU-SKYMONEY
           ELSE
               MOVE   WK-KEISAN       TO   LNK-SYU-SKYMONEY
           END-IF.
      *
           IF    ((LNK-SYU-SYUHKNNUM   NOT =   SPACE     ) AND
                  (LNK-SYU-KOH1HKNNUM  =   "972" OR "974") AND
                  (LNK-SYU-KOH2HKNNUM  =       SPACE     ))
           OR    ( LNK-SYU-KOH1HKNNUM  =   "970"          )
              MOVE     "1"     TO     LNK-SYU-HKNTEKKBN
           END-IF.
      *
      *****+++++++++++++++++++
      *
      *    計算金額桁数チェック
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201204"
      *      主保険又は公費の負担割合計算額
             IF  (LNK-SYU-SYUHKNNUM   =  "971" OR "973" OR "975")
             OR  (LNK-SYU-KOH1HKNNUM  =  "970"                  )
               IF   LNK-SYU-KOH1HKNNUM  =  "970"
      *          <COMPFTN>
      *          # 四捨五入
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN9 +  5
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
                 IF   WK-SKYCHK-KEISAN  >  9999999
                   MOVE      "1"          TO   LNK-S01-SKYCHKFLG
                 END-IF
      *          <RSIJIBAI-SKYMONEY>
                 MOVE  WK-SKYCHK-KEISAN10 TO  WK-SKYCHK-KEISAN
               ELSE
      *          <RSIJIBAI-SKYMONEY>
                 MOVE  WK-SKYCHK-KEISAN9  TO  WK-SKYCHK-KEISAN
               END-IF
               COMPUTE    WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN
                                            + WK-SKYCHK-KEISAN8
                                            + LNK-SYU-RSISHOSHIN-MONEY
                                            + LNK-SYU-RSISAISHIN-MONEY
                                            + LNK-SYU-RSISDO-MONEY
                                            + LNK-SYU-RSIETC-MONEY
               IF   WK-SKYCHK-KEISAN  >  9999999
                 MOVE      "1"          TO   LNK-S01-SKYCHKFLG
               END-IF
             ELSE
      *        <COMPFTN>
      *        # 四捨五入
               COMPUTE    WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN9 +  5
               COMPUTE    WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
               COMPUTE    WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               IF   WK-SKYCHK-KEISAN  >  9999999
                 MOVE      "1"          TO   LNK-S01-SKYCHKFLG
               END-IF
             END-IF
           END-IF.
      *
           IF  LNK-S01-SKYCHKFLG  NOT =  SPACE
                 MOVE     12     TO     LNK-S01-RC
           END-IF.
      *****+++++++++++++++++++
      *
       MAIN-EXT.
           EXIT PROGRAM
           STOP RUN.
      *
      ******************************************************************
      *        減免計算処理                                            *
      ******************************************************************
       300-GENMEN-KEISAN-SEC          SECTION.
      *
           IF   PTINF-DISCOUNT  NOT =   SPACE  AND  "00"
      *
               INITIALIZE                         SYS-1026-REC
               MOVE    "1026"               TO    SYS-1026-KANRICD
               MOVE    PTINF-DISCOUNT-KBN   TO    SYS-1026-KBNCD
               MOVE    LNK-SYU-HOSPNUM      TO    SYS-1026-HOSPNUM
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1026-STYUKYMD
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1026-EDYUKYMD
               MOVE    SYS-1026-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "tbl_syskanri"       TO    MCP-TABLE
               MOVE    "key10"              TO    MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =     ZERO
                   MOVE     "tbl_syskanri"  TO    MCP-TABLE
                   MOVE     "key10"         TO    MCP-PATHNAME
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
                       MOVE   SYS-1026-KBNCD  TO  LNK-SYU-DISCOUNT-KBN
                       MOVE   SYS-1026-DISCOUNT-BODY
                                              TO  LNK-SYU-DISCOUNT-BODY
                   END-IF
               END-IF
      *
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key10"         TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
      *
               INITIALIZE                         SYS-1027-REC
               MOVE    "1027"               TO    SYS-1027-KANRICD
               MOVE    PTINF-DISCOUNT       TO    SYS-1027-KBNCD
               MOVE    LNK-SYU-HOSPNUM      TO    SYS-1027-HOSPNUM
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1027-STYUKYMD
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1027-EDYUKYMD
               MOVE    SYS-1027-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "tbl_syskanri"       TO    MCP-TABLE
               MOVE    "key10"              TO    MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =     ZERO
                   MOVE     "tbl_syskanri"  TO    MCP-TABLE
                   MOVE     "key10"         TO    MCP-PATHNAME
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
      *
                     IF   (SYS-1027-TEIRITU        NOT =  SPACE)
                     AND  (SYS-1027-DISCOUNT-RATE  NOT =  ZERO )
                      IF   (LNK-SYU-SRYYMD(1:6)   < "200704"  )
                      AND  (COMB-SYU-HKNKOHSBTKBN = "8" OR "9")
                      AND  (COMB-HOJOKBN          = "1"       )
                       IF  WK-1001-GENTAIKBN  =  "2" OR "3"
                           CONTINUE
                       ELSE
                           PERFORM  3001-GENMEN-KEISAN2-SEC
                       END-IF
                      ELSE
                       IF  WK-1001-GENTAIKBN  =  "2"
                         IF  COMB-SYU-HKNKOHSBTKBN  =  "8"
                           CONTINUE
                         ELSE
                           PERFORM  3001-GENMEN-KEISAN2-SEC
                         END-IF
                       ELSE
                           PERFORM  3001-GENMEN-KEISAN2-SEC
                       END-IF
                      END-IF
                     END-IF
      *
                   END-IF
               END-IF
      *
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key10"         TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           END-IF.
      *
       300-GENMEN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        減免計算処理                                            *
      ******************************************************************
       3001-GENMEN-KEISAN2-SEC          SECTION.
      *
           COMPUTE   WK-SKYCHK-KEISAN   =   WK-SKYCHK-KEISAN7
                                        +   WK-SKYCHK-KEISAN8
           MOVE      ZERO               TO  WK-SKYCHK-KEISAN2
      *
           EVALUATE  WK-1001-GENTAIKBN
             WHEN      "2"
               MOVE  WK-SKYCHK-KEISAN7  TO  WK-SKYCHK-KEISAN
               MOVE  WK-SKYCHK-KEISAN8  TO  WK-SKYCHK-KEISAN2
             WHEN      "3"
               MOVE  WK-SKYCHK-KEISAN8  TO  WK-SKYCHK-KEISAN
               MOVE  WK-SKYCHK-KEISAN7  TO  WK-SKYCHK-KEISAN2
           END-EVALUATE
      *
           EVALUATE  SYS-1027-TEIRITU
             WHEN  "1"
               MOVE      WK-SKYCHK-KEISAN
                                 TO   WK-GENMEN-KEISAN
               MOVE      ZERO    TO   WK-RATE
               COMPUTE   WK-RATE = (100 - SYS-1027-DISCOUNT-RATE)
                                 /  100
               COMPUTE   WK-SKYCHK-KEISAN = WK-SKYCHK-KEISAN
                                          * WK-RATE
               COMPUTE   WK-GENMEN-KEISAN2  =  WK-GENMEN-KEISAN
                                            -  WK-SKYCHK-KEISAN
             WHEN  "2"
               IF   SYS-1027-DISCOUNT-RATE  >=  WK-SKYCHK-KEISAN
                 MOVE    WK-SKYCHK-KEISAN
                                 TO   WK-GENMEN-KEISAN2
                 MOVE    ZERO    TO   WK-SKYCHK-KEISAN
               ELSE
                 MOVE    SYS-1027-DISCOUNT-RATE
                                 TO   WK-GENMEN-KEISAN2
                 COMPUTE WK-SKYCHK-KEISAN = WK-SKYCHK-KEISAN
                                          - SYS-1027-DISCOUNT-RATE
               END-IF
           END-EVALUATE
      *
           IF    WK-1001-GENTAIKBN  =  "2" OR "3"
             IF  (WK-HASU1001-KBN    =  WK-HASU1001-KBN2)
             AND (WK-HASU1001-KBN2J  =  "0"             )
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN
                                          + WK-SKYCHK-KEISAN2
             END-IF
           END-IF
      *
           EVALUATE  WK-HASU1001-KBN
             WHEN  "1"
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  +  5
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
             WHEN  "2"
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
             WHEN  "3"
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  +  9
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
             WHEN  "4"
               CONTINUE
           END-EVALUATE
      *
           IF    WK-1001-GENTAIKBN  =  "2" OR "3"
             IF  (WK-HASU1001-KBN    =  WK-HASU1001-KBN2)
             AND (WK-HASU1001-KBN2J  =  "0"             )
               CONTINUE
             ELSE
               EVALUATE  WK-1001-GENTAIKBN
                 WHEN      "2"
                   IF   WK-HASU1001-KBN2J = "0"
                     MOVE  WK-HASU1001-KBN2   TO  WK-HASU-KBN
                   ELSE
                     MOVE  WK-HASU1001-KBN2J  TO  WK-HASU-KBN
                   END-IF
                 WHEN      "3"
                   MOVE    WK-HASU1001-KBN2   TO  WK-HASU-KBN
               END-EVALUATE
               EVALUATE   WK-HASU-KBN
                 WHEN  "1"
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 +  5
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
                 WHEN  "2"
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
                 WHEN  "3"
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 +  9
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
                 WHEN  "4"
                   CONTINUE
               END-EVALUATE
               COMPUTE      WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN
                                              + WK-SKYCHK-KEISAN2
             END-IF
           END-IF
      *
           MOVE   WK-SKYCHK-KEISAN        TO   LNK-SYU-SKYMONEY
      *
           MOVE   SYS-1027-KBNCD          TO   LNK-SYU-DISCOUNT-RATEKBN
           MOVE   SYS-1027-TEIRITU        TO   LNK-SYU-DISCOUNT-TEIRITU
           MOVE   SYS-1027-DISCOUNT-RATE  TO   LNK-SYU-DISCOUNT-RATE
           MOVE   WK-GENMEN-KEISAN2       TO   LNK-SYU-DISCOUNT-MONEY
      *
           MOVE     1                     TO   FLG-GENMEN
      *
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201204"
             IF  LNK-S01-SKYCHKFLG  =  SPACE
             AND WK-SKYCHK-KEISAN   >  9999999
               MOVE    "2"     TO   LNK-S01-SKYCHKFLG
             END-IF
             IF  WK-GENMEN-KEISAN2  >  9999999
               MOVE    "1"     TO   LNK-S01-SKYCHKFLG
             END-IF
           END-IF
      *
           .
      *
       3001-GENMEN-KEISAN2-EXT.
           EXIT.
      *
      ******************************************************************
      *        請求額端数計算処理（減免無し）
      ******************************************************************
       400-SEIKYU-HASUU-KEISAN-SEC          SECTION.
      *
           IF  WK-HASU1001-KBN-WKJ  =  "0"
             COMPUTE      WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN7
                                            + WK-SKYCHK-KEISAN8
             EVALUATE   WK-HASU1001-KBN-WK
               WHEN  "1"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  +  5
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "2"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "3"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  +  9
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "4"
                 CONTINUE
             END-EVALUATE
           ELSE
             EVALUATE   WK-HASU1001-KBN-WK
               WHEN  "1"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN7 +  5
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "2"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN7 / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "3"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN7 +  9
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "4"
                 MOVE  WK-SKYCHK-KEISAN7  TO  WK-SKYCHK-KEISAN
             END-EVALUATE
             EVALUATE   WK-HASU1001-KBN-WKJ
               WHEN  "1"
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN8 +  5
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
               WHEN  "2"
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN8 / 10
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
               WHEN  "3"
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN8 +  9
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
               WHEN  "4"
                 MOVE  WK-SKYCHK-KEISAN8  TO  WK-SKYCHK-KEISAN2
             END-EVALUATE
             COMPUTE      WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN
                                            + WK-SKYCHK-KEISAN2
           END-IF
      *
           MOVE  WK-SKYCHK-KEISAN  TO  LNK-SYU-SKYMONEY
      *
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201204"
             IF  LNK-S01-SKYCHKFLG  =  SPACE
             AND WK-SKYCHK-KEISAN   >  9999999
               MOVE    "2"     TO   LNK-S01-SKYCHKFLG
             END-IF
           END-IF
      *
           .
      *
       400-SEIKYU-HASUU-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        自賠責その他コード情報の編集（０９５９１．９２．９３）
      ******************************************************************
       500-JIBAI-SONOTA-HENSYU-SEC          SECTION.
      *
           INITIALIZE            WK-4003-TAIGAI.
      *
           MOVE    ZERO    TO    WK-RSISDO-MONEY
                                 WK-RSISDO-MONEY2.
      *
      *    システム管理マスタ（４００３）から消費税対象外コード取得
      *
           IF   WK-4001-TAXKBN-KZI   =   "2"
              INITIALIZE                         SYS-4003-REC
              MOVE    "4003"               TO    SYS-4003-KANRICD
              MOVE    "*"                  TO    SYS-4003-KBNCD
              MOVE    LNK-SYU-HOSPNUM      TO    SYS-4003-HOSPNUM
              MOVE    LNK-SYU-SRYYMD       TO    SYS-4003-STYUKYMD
              MOVE    LNK-SYU-SRYYMD       TO    SYS-4003-EDYUKYMD
              MOVE    SYS-4003-REC         TO    MCPDATA-REC
              MOVE    "DBSELECT"           TO    MCP-FUNC
              MOVE    "tbl_syskanri"       TO    MCP-TABLE
              MOVE    "key10"              TO    MCP-PATHNAME
              CALL    "ORCDBMAIN"          USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
              IF      MCP-RC               =     ZERO
                  MOVE     "tbl_syskanri"  TO    MCP-TABLE
                  MOVE     "key10"         TO    MCP-PATHNAME
                  PERFORM   SYSKANRI-READ-SEC
                  IF    MCP-RC             =     ZERO
                     PERFORM   VARYING   IDX8    FROM   1   BY   1
                                UNTIL   (IDX8                 >    50 )
                                  OR    (SYS-4003-SRYCD(IDX8) =  SPACE)
                          MOVE    SYS-4003-SRYCD(IDX8)
                                        TO   WK-4003-TAIGAI-SRYCD(IDX8)
                     END-PERFORM
                  END-IF
              END-IF
      *
              MOVE     "tbl_syskanri"  TO    MCP-TABLE
              MOVE     "key10"         TO    MCP-PATHNAME
              PERFORM   DB-CLOSE-SEC
           END-IF.
      *
      *    コード別に退避
      *
           INITIALIZE              WK-SONOTA91.
           INITIALIZE              WK-SONOTA92.
           INITIALIZE              WK-SONOTA93.
           MOVE     ZERO      TO   IDX5.
           MOVE     ZERO      TO   IDX6.
           MOVE     ZERO      TO   IDX7.
      *
           PERFORM   VARYING   IDX4    FROM   1   BY   1
                      UNTIL   (IDX4                           >    20 )
                       OR     (LNK-S01-SONOTA-SRYCD(IDY IDX4) =  SPACE)
                 EVALUATE      LNK-S01-SONOTA-SRYCD(IDY IDX4)(1:5)
                    WHEN   "09591"
                       ADD     1     TO   IDX5
                       MOVE    LNK-S01-SONOTA-SRYCD(IDY IDX4)
                                     TO   WK-SONOTA91-SRYCD(IDX5)
                       MOVE    LNK-S01-SONOTA-ZAIKAISU(IDY IDX4)
                                     TO   WK-SONOTA91-ZAIKAISU(IDX5)
                       MOVE    LNK-S01-SONOTA-TANKA(IDY IDX4)
                                     TO   WK-SONOTA91-TANKA(IDX5)
                    WHEN   "09592"
                       ADD     1     TO   IDX6
                       MOVE    LNK-S01-SONOTA-SRYCD(IDY IDX4)
                                     TO   WK-SONOTA92-SRYCD(IDX6)
                       MOVE    LNK-S01-SONOTA-ZAIKAISU(IDY IDX4)
                                     TO   WK-SONOTA92-ZAIKAISU(IDX6)
                       MOVE    LNK-S01-SONOTA-TANKA(IDY IDX4)
                                     TO   WK-SONOTA92-TANKA(IDX6)
                    WHEN   "09593"
                       MOVE     SPACE    TO    FLG-TAIGAI
                       PERFORM  VARYING  IDX8    FROM   1   BY   1
                            UNTIL  (IDX8                       >   50  )
                              OR   (WK-4003-TAIGAI-SRYCD(IDX8) =  SPACE)
                              OR   (FLG-TAIGAI                 =  "1"  )
                         IF   WK-4003-TAIGAI-SRYCD(IDX8)  =
                                         LNK-S01-SONOTA-SRYCD(IDY IDX4)
                              MOVE    "1"     TO    FLG-TAIGAI
                         END-IF
                       END-PERFORM
      *
                       MOVE  LNK-S01-SONOTA-SRYCD(IDY IDX4) TO WK-SRYCD
                       PERFORM TENSU-READ-SEC
                       IF   TNS-NAMECHGKBN  =  ZERO OR 5
                          CONTINUE
                       ELSE
                          COMPUTE  WK-KEISAN  =
                                   LNK-S01-SONOTA-ZAIKAISU(IDY IDX4) *
                                   LNK-S01-SONOTA-TANKA(IDY IDX4)
                          IF  LNK-SYU-RSIETC-MONEY >= WK-KEISAN
                              COMPUTE  LNK-SYU-RSIETC-MONEY =
                                       LNK-SYU-RSIETC-MONEY -
                                       WK-KEISAN
                          ELSE
                              MOVE   ZERO   TO   LNK-SYU-RSIETC-MONEY
                          END-IF
                          IF  LNK-SYU-SRYYMD(1:6)  >=   "201307"
                           EVALUATE  TNS-NAMECHGKBN
                            WHEN        1
                              COMPUTE  LNK-SYU-RSISHOSHIN-MONEY =
                                       LNK-SYU-RSISHOSHIN-MONEY +
                                       WK-KEISAN
                            WHEN        2
                              COMPUTE  LNK-SYU-RSISAISHIN-MONEY =
                                       LNK-SYU-RSISAISHIN-MONEY +
                                       WK-KEISAN
                            WHEN        3
                              COMPUTE  LNK-SYU-RSISDO-MONEY     =
                                       LNK-SYU-RSISDO-MONEY     +
                                       WK-KEISAN
                            WHEN        4
                              COMPUTE  LNK-SYU-RSIETC-MONEY     =
                                       LNK-SYU-RSIETC-MONEY     +
                                       WK-KEISAN
                              COMPUTE  LNK-S01-KYUKYU(IDY)      =
                                       LNK-S01-KYUKYU(IDY)      +
                                       WK-KEISAN
                           END-EVALUATE
                          ELSE
                           EVALUATE  TNS-NAMECHGKBN
                            WHEN        1
                            WHEN        4
                              COMPUTE  LNK-SYU-RSISHOSHIN-MONEY =
                                       LNK-SYU-RSISHOSHIN-MONEY +
                                       WK-KEISAN
                            WHEN        2
                              COMPUTE  LNK-SYU-RSISAISHIN-MONEY =
                                       LNK-SYU-RSISAISHIN-MONEY +
                                       WK-KEISAN
                            WHEN        3
                              IF   FLG-KENPOJYUNKYO  =  ZERO
                                COMPUTE  WK-RSISDO-MONEY        =
                                         WK-RSISDO-MONEY        +
                                         WK-KEISAN
                              ELSE
                                COMPUTE  LNK-SYU-RSISDO-MONEY   =
                                         LNK-SYU-RSISDO-MONEY   +
                                         WK-KEISAN
                              END-IF
                           END-EVALUATE
                          END-IF
                          MOVE       "1"     TO    FLG-TAIGAI
                       END-IF
      *
                       IF   FLG-TAIGAI  =  SPACE
                          ADD     1     TO   IDX7
                          MOVE    LNK-S01-SONOTA-SRYCD(IDY IDX4)
                                        TO   WK-SONOTA93-SRYCD(IDX7)
                          MOVE    LNK-S01-SONOTA-ZAIKAISU(IDY IDX4)
                                        TO   WK-SONOTA93-ZAIKAISU(IDX7)
                          MOVE    LNK-S01-SONOTA-TANKA(IDY IDX4)
                                        TO   WK-SONOTA93-TANKA(IDX7)
                       END-IF
                 END-EVALUATE
           END-PERFORM.
      *
      *    文書料消費税計算
      *
           IF   WK-4001-TAXKBN   =   "2"
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    20 )
                              OR    (WK-SONOTA91-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA91-TANKA(IDX4)  *  WK-S4)  +  WK-S3
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA91-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA91-TANKA(IDX4)    *
                              WK-SONOTA91-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    20 )
                              OR    (WK-SONOTA92-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA92-TANKA(IDX4)  *  WK-S4)  +  WK-S3
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA92-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA92-TANKA(IDX4)    *
                              WK-SONOTA92-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
           END-IF.
      *
      *    特定器材等消費税計算
      *
           IF   WK-4001-TAXKBN-KZI   =   "2"
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    20 )
                              OR    (WK-SONOTA93-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA93-TANKA(IDX4)  *  WK-S4)  +  WK-S3
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA93-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA93-TANKA(IDX4)    *
                              WK-SONOTA93-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
           END-IF.
      *
       500-JIBAI-SONOTA-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        保険参照部分確定処理                                    *
      ******************************************************************
       100-KAKUTEI-SEC          SECTION.
      *
           MOVE    SPACE              TO  FLG-SANSHOU
           MOVE    SPACE              TO  FLG-SANSHOU2
           MOVE    SPACE              TO  FLG-SANSHOU3
      *
           IF    LNK-SYU-SRYYMD(1:6)   <  "200304"
              MOVE     "1"            TO  FLG-SANSHOU
           END-IF
      *
           IF  (LNK-SYU-SYUHKNNUM = "971" OR "973" OR "975"
                                 OR "068" OR "069" OR "040"  )
           OR  (LNK-SYU-SYUHKNNUM(1:2) = "98" OR "90" OR "91")
             CONTINUE
           ELSE
             INITIALIZE                     ORCSSYOTOKUAREA
             MOVE  LNK-SYU-HOSPNUM      TO  LNK-SYOTOKU-HOSPNUM
             MOVE  LNK-SYU-PTID         TO  LNK-SYOTOKU-PTID
             MOVE  LNK-SYU-SRYYMD(1:6)  TO  LNK-SYOTOKU-SRYYM
             MOVE  SPACE                TO  LNK-SYOTOKU-SKJCHKFLG
      *
             CALL    "ORCSSYOTOKU"      USING  ORCSSYOTOKUAREA
                                               SPA-AREA
      *
             IF    LNK-SYOTOKU-RC    =   ZERO
                IF    LNK-SYU-SRYYMD(1:6)   >=  "200604"
                  MOVE   LNK-SYU-SRYYMD(7:2)  TO  SYOTOKU-IDX
                ELSE
                  MOVE   1                    TO  SYOTOKU-IDX
                END-IF
      *       （主保険・全国公費）
                MOVE   LNK-SYOTOKU-SYUKBN(SYOTOKU-IDX)
                                              TO  FLG-SANSHOU3
      *       （地方公費）
                MOVE   LNK-SYOTOKU-CHIKBN(SYOTOKU-IDX)
                                              TO  FLG-SANSHOU2
             END-IF
      *
             EVALUATE   FLG-SANSHOU2
               WHEN     SPACE
                    MOVE     "1"      TO  FLG-SANSHOU2
               WHEN     "2"
                    MOVE     "2"      TO  FLG-SANSHOU2
               WHEN     "1"
               WHEN     "4"
                    MOVE     "3"      TO  FLG-SANSHOU2
             END-EVALUATE
           END-IF
      *
           .
      *
       100-KAKUTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *    自費保険のデータ編集                                *
      ******************************************************************
       104-JIHIHOKEN-DATA-HENSYU-SEC          SECTION.
      *
           IF   (COMB-HKNNUM            NOT =   SPACE     )
           AND  (COMB-SYU-HKNKOHSBTKBN      =   "8"       )
           AND  (WK-1001-JIHIPOSITION   NOT =   "2"       )
           AND  (LNK-S01-BUNBENJIHIKBN      =   "1"       )
           AND  (LNK-SYU-SRYYMD(1:6)       >=   "200604"  )
               MOVE   "2"    TO   WK-1001-JIHIPOSITION
           END-IF
      *
           IF   (COMB-HKNNUM            NOT =   SPACE   )
           AND  (COMB-SYU-HKNKOHSBTKBN      =   "8"     )
           AND  (LNK-SYU-SRYYMD(1:6)       >=   "200904")
               PERFORM   VARYING   IDX9    FROM    1   BY  1
                          UNTIL    IDX9       >   17
                  MOVE  LNK-SYU-HKNTEN(IDX9)  TO  LNK-SYU-MONEY (IDX9)
               END-PERFORM
           ELSE
               PERFORM   VARYING   IDX9    FROM    1   BY  1
                          UNTIL    IDX9       >   17
                  MOVE  ZERO                  TO  LNK-SYU-MONEY (IDX9)
               END-PERFORM
           END-IF
      *
           IF  ((COMB-HKNNUM            NOT =   SPACE   ) AND
                (COMB-SYU-HKNKOHSBTKBN      =   "8"     ) AND
                (WK-1001-JIHIPOSITION       =   "2"     ) AND
                (LNK-SYU-SRYYMD(1:6)       >=   "200604"))
           OR  ((COMB-HKNNUM            NOT =   SPACE   ) AND
                (COMB-SYU-HKNKOHSBTKBN      =   "8"     ) AND
                (WK-1001-JIHIPOSITION   NOT =   "2"     ) AND
                (COMB-HOJOKBN               =   "1"     ) AND
                (LNK-SYU-SRYYMD(1:6)       >=   "200704"))
           OR  ((COMB-HKNNUM            NOT =   SPACE   ) AND
                (COMB-SYU-HKNKOHSBTKBN      =   "9"     ) AND
                (COMB-HOJOKBN               =   "1"     ) AND
                (LNK-SYU-SRYYMD(1:6)       >=   "200704"))
      *
      *      該当保険番号テーブルの検索
             INITIALIZE                      HKNNUM-REC
             MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
             MOVE   COMB-HKNNUM        TO    HKN-HKNNUM
             MOVE   "00"               TO    WK-PAYKBN
             MOVE   HKNNUM-REC         TO    MCPDATA-REC
             MOVE   "DBSELECT"         TO    MCP-FUNC
             MOVE   "tbl_hknnum"       TO    MCP-TABLE
             MOVE   "key2"             TO    MCP-PATHNAME
             CALL   "ORCDBMAIN"        USING MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
             IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"  TO    MCP-TABLE
                 MOVE    "key2"        TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                  ( FLG-HKNNUM           =  1                   ) OR
                  ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                   (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6)  ) AND
                   (WK-PAYKBN            =  HKN-PAYKBN         ))
                     MOVE     "tbl_hknnum"  TO    MCP-TABLE
                     MOVE     "key2"        TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
             END-IF
      *
             MOVE     "tbl_hknnum"  TO    MCP-TABLE
             MOVE     "key2"        TO    MCP-PATHNAME
             PERFORM   DB-CLOSE-SEC
      *
             IF  HKN-TENTNK   =   ZERO
                 MOVE     10      TO      HKN-TENTNK
             END-IF
      *
             IF   COMB-HONKZKKBN        =   "1"
               IF  HKN-HON-GAIKFTNRATE   NOT =   ZERO
                  IF  HKN-TENTNK   =   10
                      COMPUTE  WK-JIHIFTN   =
                               HKN-HON-GAIKFTNRATE  /  100
                  ELSE
                      MOVE       1     TO      WK-JIHIFTN
                  END-IF
               ELSE
                  MOVE     ZERO        TO      WK-JIHIFTN
               END-IF
             ELSE
               IF  HKN-KZK-GAIKFTNRATE   NOT =   ZERO
                  IF  HKN-TENTNK   =   10
                      COMPUTE  WK-JIHIFTN   =
                               HKN-KZK-GAIKFTNRATE  /  100
                  ELSE
                      MOVE       1     TO      WK-JIHIFTN
                  END-IF
               ELSE
                  MOVE     ZERO        TO      WK-JIHIFTN
               END-IF
             END-IF
      *
             IF     WK-JIHIFTN    NOT =    ZERO
               PERFORM   VARYING   IDX9    FROM    1   BY  1
                          UNTIL    IDX9       >   17
                 IF   (LNK-SYU-SRYYMD(1:6)       >=   "200704")
                 AND  (COMB-HOJOKBN               =   "1"     )
                    COMPUTE WK-JIHIGAKU   =
                            LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK
                    COMPUTE WK-JIHIGAKU2  =
                            WK-JIHIGAKU           *  WK-JIHIFTN
                    COMPUTE WK-JIHIGAKU3  =
                           (WK-JIHIGAKU2  *  WK-S4) + WK-S3
                    IF    IDX9  =  17
                       MOVE   ZERO  TO  WK-JIHIGAKU2
                       MOVE   ZERO  TO  WK-JIHIGAKU3
                    END-IF
                    IF   (COMB-SYU-HKNKOHSBTKBN =   "8")
                    AND  (WK-1001-JIHIPOSITION  =   "2")
                       COMPUTE LNK-SYU-TGMONEY-TAX(IDX9) =
                               LNK-SYU-TGMONEY-TAX(IDX9) + WK-JIHIGAKU2
                                                         + WK-JIHIGAKU3
                       MOVE    ZERO    TO      LNK-SYU-HKNTEN(IDX9)
                       ADD     WK-JIHIGAKU2
                                       TO      LNK-SYU-JYO-COMPFTN
                       ADD     WK-JIHIGAKU3
                                       TO      LNK-SYU-JYO-COMPFTN
                    ELSE
                       COMPUTE WK-SKYMONEY-ZEI = WK-SKYMONEY-ZEI
                                               + WK-JIHIGAKU3
                    END-IF
                 ELSE
                    COMPUTE WK-JIHIGAKU   =
                            LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK
                    COMPUTE WK-JIHIGAKU2  =
                            WK-JIHIGAKU           *  WK-JIHIFTN
                    IF    IDX9  =  17
                       MOVE   ZERO  TO  WK-JIHIGAKU2
                    END-IF
                    COMPUTE LNK-SYU-TGMONEY(IDX9) =
                            LNK-SYU-TGMONEY(IDX9) +  WK-JIHIGAKU2
                    MOVE    ZERO    TO      LNK-SYU-HKNTEN(IDX9)
                    ADD     WK-JIHIGAKU2
                                    TO      LNK-SYU-JYO-COMPFTN
                 END-IF
               END-PERFORM
             END-IF
      *
           END-IF
      *
           .
      *
       104-JIHIHOKEN-DATA-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    保険組合せの上限区分編集                                *
      ******************************************************************
       105-JYOGENKBN-HENSYU-SEC          SECTION.
      *
           MOVE    SPACE    TO   COMB-KOH1-GAIJGNKBN.
           MOVE    SPACE    TO   COMB-KOH2-GAIJGNKBN.
           MOVE    SPACE    TO   COMB-KOH3-GAIJGNKBN.
           MOVE    SPACE    TO   COMB-KOH4-GAIJGNKBN.
      *
           MOVE    ZERO     TO   FLG-FTNRATE100.
      *
      *    公費１の上限区分編集
           IF  COMB-KOH1HKNNUM           NOT =  SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH1HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH1HKNNUM    =     "027"
                   IF    LNK-SYU-SRYYMD  >=    "20021001"
                       MOVE     COMB-KOH1PAYKBN     TO  WK-PAYKBN
                   ELSE
                       MOVE     WK-1001-HOSPSBT     TO  WK-PAYKBN(1:1)
                       MOVE     WK-1001-ROUPAYKBN   TO  WK-PAYKBN(2:1)
                   END-IF
               ELSE
                       MOVE     "00"         TO    WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                   MOVE    "tbl_hknnum"  TO    MCP-TABLE
                   MOVE    "key2"        TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                       OR
                    ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            =  HKN-PAYKBN))
                       MOVE    "tbl_hknnum"  TO    MCP-TABLE
                       MOVE    "key2"        TO    MCP-PATHNAME
                       PERFORM  HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   1051-JYOGENKBN-CHECK-SEC
                          MOVE   WK-GAIJGNKBN  TO  COMB-KOH1-GAIJGNKBN
      *
                          IF  (COMB-KOH1HKNNUM(1:1) >=  "1")
                          AND (COMB-KOH1HKNNUM(1:1) <=  "8")
                          AND (WK-SYOUKAN-FTNRATE    =  100)
                             MOVE    1    TO   FLG-FTNRATE100
                          END-IF
      *
                          IF  (COMB-KOH1HKNNUM(1:1) >=  "1")
                          AND (COMB-KOH1HKNNUM(1:1) <=  "8")
                             MOVE  HKN-HBTNUM  TO  WK-HBTNUM(1)
                          END-IF
                   END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    公費２の上限区分編集
           IF  COMB-KOH2HKNNUM           NOT = SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH2HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                   MOVE    "tbl_hknnum"  TO    MCP-TABLE
                   MOVE    "key2"        TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                      OR
                    ((HKN-TEKSTYMD(1:6)   <= LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <= HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            = HKN-PAYKBN))
                       MOVE    "tbl_hknnum"  TO    MCP-TABLE
                       MOVE    "key2"        TO    MCP-PATHNAME
                       PERFORM  HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   1051-JYOGENKBN-CHECK-SEC
                          MOVE   WK-GAIJGNKBN  TO  COMB-KOH2-GAIJGNKBN
      *
                          IF  (COMB-KOH2HKNNUM(1:1) >=  "1")
                          AND (COMB-KOH2HKNNUM(1:1) <=  "8")
                          AND (WK-SYOUKAN-FTNRATE    =  100)
                             MOVE    2    TO   FLG-FTNRATE100
                          END-IF
      *
                          IF  (COMB-KOH2HKNNUM(1:1) >=  "1")
                          AND (COMB-KOH2HKNNUM(1:1) <=  "8")
                             MOVE  HKN-HBTNUM  TO  WK-HBTNUM(2)
                          END-IF
                   END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    公費３の上限区分編集
           IF  COMB-KOH3HKNNUM           NOT = SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH3HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                   MOVE    "tbl_hknnum"  TO    MCP-TABLE
                   MOVE    "key2"        TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                      OR
                    ((HKN-TEKSTYMD(1:6)   <= LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <= HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            = HKN-PAYKBN))
                       MOVE    "tbl_hknnum"  TO    MCP-TABLE
                       MOVE    "key2"        TO    MCP-PATHNAME
                       PERFORM  HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   1051-JYOGENKBN-CHECK-SEC
                          MOVE   WK-GAIJGNKBN  TO  COMB-KOH3-GAIJGNKBN
      *
                          IF  (COMB-KOH3HKNNUM(1:1) >=  "1")
                          AND (COMB-KOH3HKNNUM(1:1) <=  "8")
                          AND (WK-SYOUKAN-FTNRATE    =  100)
                             MOVE    3    TO   FLG-FTNRATE100
                          END-IF
      *
                          IF  (COMB-KOH3HKNNUM(1:1) >=  "1")
                          AND (COMB-KOH3HKNNUM(1:1) <=  "8")
                             MOVE  HKN-HBTNUM  TO  WK-HBTNUM(3)
                          END-IF
                   END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    公費４の上限区分編集
           IF  COMB-KOH4HKNNUM           NOT = SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH4HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                   MOVE    "tbl_hknnum"  TO    MCP-TABLE
                   MOVE    "key2"        TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                       OR
                    ((HKN-TEKSTYMD(1:6)   <= LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <= HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            = HKN-PAYKBN))
                       MOVE    "tbl_hknnum"  TO    MCP-TABLE
                       MOVE    "key2"        TO    MCP-PATHNAME
                       PERFORM  HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   1051-JYOGENKBN-CHECK-SEC
                          MOVE   WK-GAIJGNKBN  TO  COMB-KOH4-GAIJGNKBN
      *
                          IF  (COMB-KOH4HKNNUM(1:1) >=  "1")
                          AND (COMB-KOH4HKNNUM(1:1) <=  "8")
                          AND (WK-SYOUKAN-FTNRATE    =  100)
                             MOVE    4    TO   FLG-FTNRATE100
                          END-IF
      *
                          IF  (COMB-KOH4HKNNUM(1:1) >=  "1")
                          AND (COMB-KOH4HKNNUM(1:1) <=  "8")
                             MOVE  HKN-HBTNUM  TO  WK-HBTNUM(4)
                          END-IF
                   END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
       105-JYOGENKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    保険組合せの上限区分チェック                                *
      ******************************************************************
       1051-JYOGENKBN-CHECK-SEC           SECTION.
      *
           MOVE     SPACE     TO    WK-GAIJGNKBN.
           MOVE     ZERO      TO    WK-SYOUKAN-FTNRATE.
      *
           IF    HKN-HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      IF   HKN-HON-GAIMNAIJGNGAK  NOT = ZERO
                      OR   HKN-HON-GAIMGAIJGNGAK  NOT = ZERO
                      OR   HKN-HON-GAIMJGNCNT     NOT = ZERO
                      OR   HKN-HON-GAIDJGNGAK     NOT = ZERO
                      OR   HKN-HON-GAIDJGNCNT     NOT = ZERO
                      OR   HKN-HON-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                      END-IF
                      MOVE HKN-HON-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                 WHEN   "2"
                      IF   HKN-TSY-GAIFTNKBN      =  "0"
                        IF   HKN-HON-GAIMNAIJGNGAK  NOT = ZERO
                        OR   HKN-HON-GAIMGAIJGNGAK  NOT = ZERO
                        OR   HKN-HON-GAIMJGNCNT     NOT = ZERO
                        OR   HKN-HON-GAIDJGNGAK     NOT = ZERO
                        OR   HKN-HON-GAIDJGNCNT     NOT = ZERO
                        OR   HKN-HON-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                        END-IF
                        MOVE HKN-HON-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                      ELSE
                        IF   HKN-TSY-GAIMNAIJGNGAK  NOT = ZERO
                        OR   HKN-TSY-GAIMGAIJGNGAK  NOT = ZERO
                        OR   HKN-TSY-GAIMJGNCNT     NOT = ZERO
                        OR   HKN-TSY-GAIDJGNGAK     NOT = ZERO
                        OR   HKN-TSY-GAIDJGNCNT     NOT = ZERO
                        OR   HKN-TSY-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                        END-IF
                        MOVE HKN-TSY-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-GAIFTNKBN       =  "0"
                        IF   HKN-HON-GAIMNAIJGNGAK  NOT = ZERO
                        OR   HKN-HON-GAIMGAIJGNGAK  NOT = ZERO
                        OR   HKN-HON-GAIMJGNCNT     NOT = ZERO
                        OR   HKN-HON-GAIDJGNGAK     NOT = ZERO
                        OR   HKN-HON-GAIDJGNCNT     NOT = ZERO
                        OR   HKN-HON-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                        END-IF
                        MOVE HKN-HON-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                      ELSE
                        IF   HKN-TNK-GAIMNAIJGNGAK  NOT = ZERO
                        OR   HKN-TNK-GAIMGAIJGNGAK  NOT = ZERO
                        OR   HKN-TNK-GAIMJGNCNT     NOT = ZERO
                        OR   HKN-TNK-GAIDJGNGAK     NOT = ZERO
                        OR   HKN-TNK-GAIDJGNCNT     NOT = ZERO
                        OR   HKN-TNK-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                        END-IF
                        MOVE HKN-TNK-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  28                      ) AND
                   ( HKN-HKNNUM        = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  11                      ) AND
                   ( HKN-HKNNUM        = "344"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( HKN-HKNNUM        = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( HKN-HKNNUM        = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( HKN-HKNNUM        = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( HKN-HKNNUM        = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  19                      ) AND
                   ( HKN-HKNNUM        = "141"                    ))
               OR (( WK-1001-PREFNUM   =  23                      ) AND
                   ( HKN-HKNNUM        = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      IF   HKN-HON-GAIMNAIJGNGAK  NOT = ZERO
                      OR   HKN-HON-GAIMGAIJGNGAK  NOT = ZERO
                      OR   HKN-HON-GAIMJGNCNT     NOT = ZERO
                      OR   HKN-HON-GAIDJGNGAK     NOT = ZERO
                      OR   HKN-HON-GAIDJGNCNT     NOT = ZERO
                      OR   HKN-HON-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                      END-IF
                      MOVE HKN-HON-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                   WHEN   "2"
                      IF   HKN-TSY-GAIFTNKBN      =  "0"
                        IF   HKN-HON-GAIMNAIJGNGAK  NOT = ZERO
                        OR   HKN-HON-GAIMGAIJGNGAK  NOT = ZERO
                        OR   HKN-HON-GAIMJGNCNT     NOT = ZERO
                        OR   HKN-HON-GAIDJGNGAK     NOT = ZERO
                        OR   HKN-HON-GAIDJGNCNT     NOT = ZERO
                        OR   HKN-HON-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                        END-IF
                        MOVE HKN-HON-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                      ELSE
                        IF   HKN-TSY-GAIMNAIJGNGAK  NOT = ZERO
                        OR   HKN-TSY-GAIMGAIJGNGAK  NOT = ZERO
                        OR   HKN-TSY-GAIMJGNCNT     NOT = ZERO
                        OR   HKN-TSY-GAIDJGNGAK     NOT = ZERO
                        OR   HKN-TSY-GAIDJGNCNT     NOT = ZERO
                        OR   HKN-TSY-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                        END-IF
                        MOVE HKN-TSY-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-GAIFTNKBN       =  "0"
                        IF   HKN-HON-GAIMNAIJGNGAK  NOT = ZERO
                        OR   HKN-HON-GAIMGAIJGNGAK  NOT = ZERO
                        OR   HKN-HON-GAIMJGNCNT     NOT = ZERO
                        OR   HKN-HON-GAIDJGNGAK     NOT = ZERO
                        OR   HKN-HON-GAIDJGNCNT     NOT = ZERO
                        OR   HKN-HON-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                        END-IF
                        MOVE HKN-HON-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                      ELSE
                        IF   HKN-TNK-GAIMNAIJGNGAK  NOT = ZERO
                        OR   HKN-TNK-GAIMGAIJGNGAK  NOT = ZERO
                        OR   HKN-TNK-GAIMJGNCNT     NOT = ZERO
                        OR   HKN-TNK-GAIDJGNGAK     NOT = ZERO
                        OR   HKN-TNK-GAIDJGNCNT     NOT = ZERO
                        OR   HKN-TNK-GAIKJGNGAK     NOT = ZERO
                             MOVE     "1"      TO     WK-GAIJGNKBN
                        END-IF
                        MOVE HKN-TNK-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
                      END-IF
                 END-EVALUATE
               ELSE
                 IF   HKN-HON-GAIMNAIJGNGAK  NOT = ZERO
                 OR   HKN-HON-GAIMGAIJGNGAK  NOT = ZERO
                 OR   HKN-HON-GAIMJGNCNT     NOT = ZERO
                 OR   HKN-HON-GAIDJGNGAK     NOT = ZERO
                 OR   HKN-HON-GAIDJGNCNT     NOT = ZERO
                 OR   HKN-HON-GAIKJGNGAK     NOT = ZERO
                        MOVE     "1"      TO     WK-GAIJGNKBN
                 END-IF
                 MOVE HKN-HON-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
               END-IF
             END-IF
           ELSE
             IF   HKN-HON-GAIMNAIJGNGAK  NOT = ZERO
             OR   HKN-HON-GAIMGAIJGNGAK  NOT = ZERO
             OR   HKN-HON-GAIMJGNCNT     NOT = ZERO
             OR   HKN-HON-GAIDJGNGAK     NOT = ZERO
             OR   HKN-HON-GAIDJGNCNT     NOT = ZERO
             OR   HKN-HON-GAIKJGNGAK     NOT = ZERO
                        MOVE     "1"      TO     WK-GAIJGNKBN
             END-IF
             MOVE HKN-HON-GAIKFTNRATE TO WK-SYOUKAN-FTNRATE
           END-IF.
      *
           IF     (WK-1001-PREFNUM         =  43           ) AND
                  (HKN-HKNNUM              = "343"         ) AND
                  (LNK-SYU-SRYYMD(1:6)    >= "201204"      )
                        MOVE     "1"      TO     WK-GAIJGNKBN
           END-IF.
      *
           IF      HKN-HKNNUM  =  "149"
             IF   (WK-1001-PREFNUM       =  36                    )
             AND  (COMB-HKNNUM       NOT = SPACE                  )
             AND  (COMB-KOH1HKNNUM(1:1)  = "0"                    )
             AND  (COMB-KOH1HKNNUM   NOT = "010"                  )
             AND  (COMB-KOH2HKNNUM       = "149"                  )
             AND  (COMB-KOH3HKNNUM       = SPACE OR "972" OR "974")
             AND  (COMB-KOH4HKNNUM       = SPACE                  )
             AND  (LNK-SYU-SRYYMD(1:6)  >= "201610"               )
                        MOVE     SPACE    TO     WK-GAIJGNKBN
             END-IF
           END-IF.
      *
       1051-JYOGENKBN-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *        保険負担額算定処理                                      *
      ******************************************************************
       200-HKNFTN-SANTEI-SEC          SECTION.
      *
           MOVE    SPACE                 TO    SHOHOUSEN-AREA
                                               HOKEN-MAX-AREA
                                               HOKEN-KAISU-AREA
                                               HOKEN-KAISU-TABLE
                                               HOKEN-FUTAN-AREA
                                               HOKEN-FUTAN-AREA2        
                                               HOKEN-FUTAN-AREA3
                                               HOKEN-ZAN-AREA
                                               HOKEN-ZAN-AREA2          
                                               HOKEN-ZAN-AREA3
                                               WK-YAKFTN
           INITIALIZE                          SHOHOUSEN-AREA
                                               HOKEN-MAX-AREA
                                               HOKEN-KAISU-AREA
                                               HOKEN-KAISU-TABLE
                                               HOKEN-FUTAN-AREA
                                               HOKEN-FUTAN-AREA2        
                                               HOKEN-FUTAN-AREA3
                                               HOKEN-ZAN-AREA
                                               HOKEN-ZAN-AREA2          
                                               HOKEN-ZAN-AREA3
                                               WK-YAKFTN
           MOVE    ALL"9"                TO    WK-KOH-COMPFTN-AREA     
      *
      *平成１４年１０月改正対応
      *高齢者の在宅総合・在宅末期算定患者の負担上限算定エリア初期化
      *
           INITIALIZE    WK-SYUHKN-TAIHI-AREA
           INITIALIZE    WK-TAIHI-IRYOKEIKBNINF-OCC
      *
           PERFORM       2006-PTHKNINF-KENSAKU-SEC
      *
           PERFORM       2008-SYSKAN2010-HENSYU-SEC
      *
           PERFORM       2007-TAISYOKBN-HENSYU-SEC
      *
      *    公費単独で老人保険入力があるかチェック
           IF      COMB-HKNNUM          =   SPACE
                IF   LNK-SYU-SRYYMD(1:6)  >=   "200804"
                     MOVE   "968"   TO  WK-KOHNUM
                ELSE
                     MOVE   "027"   TO  WK-KOHNUM
                END-IF
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    WK-KOHNUM            TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF      PTKOH-TEKSTYMD(1:6)  <=
                                                 LNK-SYU-SRYYMD(1:6)
                        AND     LNK-SYU-SRYYMD(1:6)  <=
                                                 PTKOH-TEKEDYMD(1:6)
                        AND     PTKOH-SAKJOKBN   =  SPACE
                           MOVE   "1"           TO  FLG-ROUJINHOKEN
                           MOVE    1            TO  FLG-PTKOHINF     
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF   
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
           MOVE      ZERO       TO    FLG-KENPOJYUNKYO
                                      FLG-SYUGAKUMAE
           MOVE      SPACE      TO    WK-BIRTHDAY
           IF    LNK-SYU-SRYYMD(1:6)    >=   "200210"
      *        患者年齢計算
               INITIALIZE                           PTINF-REC
               MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM
               MOVE    LNK-SYU-PTID         TO      PTINF-PTID
               MOVE    PTINF-REC            TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "tbl_ptinf"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptinf"      TO      MCP-TABLE
                   MOVE    "key"            TO      MCP-PATHNAME
                   PERFORM  PTINF-READ-SEC
               ELSE
                   DISPLAY "PTINF SELECT ERR"
                   INITIALIZE      PTINF-REC
               END-IF
               MOVE    "tbl_ptinf"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
               MOVE    PTINF-BIRTHDAY  TO  WK-BIRTHDAY
      *
               INITIALIZE                  ORCSAGECHKAREA
               MOVE    LNK-SYU-HOSPNUM TO  AGECHK-HOSPNUM
               MOVE    LNK-SYU-PTID    TO  AGECHK-PTID
               MOVE    LNK-SYU-SRYYMD  TO  AGECHK-SRYYMD
               MOVE    PTINF-BIRTHDAY  TO  AGECHK-BIRTHDAY
               MOVE    LNK-SYU-HKNCOMBINUM 
                                       TO  AGECHK-HKNCOMBINUM
               MOVE    LNK-SYU-NYUGAIKBN
                                       TO  AGECHK-NYUGAIKBN
               CALL    "ORCSAGECHK"        USING
                                           ORCSAGECHKAREA
                                           SPA-AREA
               IF      AGECHK-RC       =   ZERO
                   IF  ( AGECHK-NENREI   >=  70      ) OR
                       ( AGECHK-NENREI   >=  65  AND
                         COMB-KOH1HKNNUM  = "027"    ) OR
      ***              ( AGECHK-NENREI   >=  65  AND
      ***                FLG-ROUJINHOKEN  = "1"      ) OR
      ***              ( AGECHK-NENREI   >=  65  AND
      ***                COMB-HKNNUM      = "039"    )
                       ( FLG-ROUJINHOKEN  = "1"      ) OR
                       ( COMB-HKNNUM      = "039"    )
                       MOVE    "1"     TO  FLG-KOUREI-KBN
                   END-IF
                   IF    LNK-S01-SAIKEISAN-KBN  =   "1"
                     MOVE   AGECHK-FTNRATE  TO  LNK-SYU-PTFTNRATE
                   END-IF
                   IF    WK-HKNKBN              =   "1"
                     IF     AGECHK-HKNKBN   =   4  OR  5
                         MOVE     1         TO  FLG-KENPOJYUNKYO
                     END-IF
                   END-IF
                   MOVE     AGECHK-SYUGAKUKBN
                                            TO  FLG-SYUGAKUMAE
               ELSE
                   DISPLAY  "PTINF AGE-CHK ERR " LNK-SYU-PTID
               END-IF
           END-IF
      *
      *    高齢非該当者
           MOVE      ZERO     TO    FLG-KOREI-HIGAITO
           IF   (FLG-KOUREI-KBN   = "1"            )
           AND  (AGECHK-NENREI   >=  70            )
             IF  (COMB-HKNNUM                =   SPACE   )
             OR  (COMB-SYU-HKNKOHSBTKBN  = "8" OR "9"    )
             OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                                        OR "040" OR "039"
                                        OR "068" OR "069")
                CONTINUE
             ELSE
              IF ( COMB-HKNNUM      = "060"           )
              OR ((COMB-HKNNUM  NOT = "060"          ) AND
                  (COMB-HOJOKBN     = SPACE          ))
                INITIALIZE                     PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
                MOVE    "976"              TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC       TO  MCPDATA-REC
                MOVE    "DBSELECT"         TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                MOVE    "key4"             TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"        USING  MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
                IF      MCP-RC             =   ZERO
                  MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                  MOVE    "key4"           TO  MCP-PATHNAME
                  PERFORM  PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                    IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                    AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                    AND (PTKOH-SAKJOKBN   =  SPACE         )
                       MOVE    1           TO  FLG-KOREI-HIGAITO
                       MOVE    SPACE       TO  FLG-KOUREI-KBN
                       MOVE    1           TO  FLG-PTKOHINF
                    ELSE
                       MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                       MOVE    "key4"          TO  MCP-PATHNAME
                       PERFORM  PTKOHINF-READ-SEC
                    END-IF
                  END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                MOVE    "key4"             TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
             END-IF
           END-IF
      *
      *    自賠責・療養担当手当用特例処理
      *    （自賠責の場合、７点を８４円に読み替える）
      *    （療養担当手当：１月１回の算定）
           IF    LNK-SYU-SYUHKNNUM       =    "973"
           AND   LNK-S01-RYOYO(IDY)  NOT =    ZERO
           AND   FLG-KENPOJYUNKYO        =    ZERO
               COMPUTE  LNK-SYU-HKNTEN (16)  =  LNK-SYU-HKNTEN (16)
                                             -  LNK-S01-RYOYO(IDY)
               COMPUTE  LNK-SYU-HKNTEN (17)  =  LNK-SYU-HKNTEN (17)
                                             -  LNK-S01-RYOYO(IDY)
      *
               COMPUTE  WK-RYOYO  =  LNK-S01-RYOYO(IDY)  /   7
      *
               COMPUTE  LNK-SYU-RSIETC-MONEY =  LNK-SYU-RSIETC-MONEY
                                             +  ( 84 *  WK-RYOYO )
           END-IF
      *
      *    前期高齢者（７０歳〜７４歳）
           MOVE      ZERO       TO    FLG-ZENKI-TOKUREI
           IF    LNK-SYU-SRYYMD(1:6)    >=   "200804"
           AND   LNK-SYU-SRYYMD(1:6)    <=   "201903"
             IF  (COMB-HKNNUM                =   SPACE   )
             OR  (COMB-SYU-HKNKOHSBTKBN  = "8" OR "9"    )
             OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                               OR "068" OR "069" OR "040"
                                                 OR "039")
             OR  (AGECHK-NENREI         <     70         )
      ***    OR  (AGECHK-NENREI         >     74         )
             OR  (FLG-KOREI-HIGAITO     =      1         )
               CONTINUE
             ELSE
               IF  (COMB-HOJOKBN  =  "1"  OR  "9")
               AND (WK-BIRTHDAY   <  "19440402"  )
                  MOVE    1     TO    FLG-ZENKI-TOKUREI
               END-IF
             END-IF
           END-IF
      *
      *    特定疾患等の判定
           PERFORM  2005-TOKUSITU-HANTEI-SEC
      *
      *    ７０歳未満高額現物給付対象者
           MOVE      ZERO     TO    FLG-GENBUTU70
           MOVE      ZERO     TO    FLG-GENBUTU70-KBN
           MOVE   "00000000"  TO    WK-GEN70-YMD
           MOVE   "99999999"  TO    WK-GEN70-YMD-ED
           IF     LNK-SYU-SRYYMD(1:6)       >=  "200704"
             IF  (FLG-KOUREI-KBN             =   "1"     )
             OR  (COMB-HKNNUM                =   SPACE   )
             OR  (COMB-SYU-HKNKOHSBTKBN  = "8" OR "9"    )
             OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                               OR "068" OR "069" OR "040")
             OR  ((COMB-KOH1HKNNUM     =  "970"         ) AND
                  (FLG-DAISAN-GENBUTU  =   ZERO         ))
               CONTINUE
             ELSE
               PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                          UNTIL   (GEN-IDX    >    TBL-GENBUTU70-MAX)
                            OR    (FLG-GENBUTU70   NOT = ZERO       )
                 INITIALIZE                         PTKOHINF-REC
                 MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
                 MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
                 MOVE    TBL-GENBUTU70(GEN-IDX) TO  PTKOH-KOHNUM
                 MOVE    PTKOHINF-REC           TO  MCPDATA-REC
                 MOVE    "DBSELECT"             TO  MCP-FUNC
                 MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
                 MOVE    "key4"                 TO  MCP-PATHNAME
                 CALL    "ORCDBMAIN"            USING  MCPAREA
                                                       MCPDATA-REC
                                                       SPA-AREA
                 IF      MCP-RC               =       ZERO
                     MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                     MOVE    "key4"             TO  MCP-PATHNAME
                     PERFORM  PTKOHINF-READ-SEC
                     PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           EVALUATE   GEN-IDX
                             WHEN        1
                               MOVE    1   TO  FLG-GENBUTU70
                               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                                IF  PTKOH-JKYSNUM(1:2) = "イ"
                                 MOVE  12  TO  FLG-GENBUTU70-KBN
                                ELSE
                                 MOVE  11  TO  FLG-GENBUTU70-KBN
                                END-IF
                               END-IF
                               IF   (LNK-SYU-SRYYMD(1:6) >= "201204")
                               AND  (FLG-SANSHOU3     NOT =  SPACE  )
                                 MOVE  SPACE  TO  FLG-SANSHOU3
                               END-IF
                             WHEN        2
                               IF    FLG-SANSHOU3  =  SPACE
                                 MOVE  2   TO  FLG-GENBUTU70
                                 IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                                  IF  PTKOH-JKYSNUM(1:2) = "エ"
                                   MOVE 22 TO  FLG-GENBUTU70-KBN
                                  ELSE
                                   MOVE 21 TO  FLG-GENBUTU70-KBN
                                  END-IF
                                 END-IF
                               ELSE
                                 MOVE  3   TO  FLG-GENBUTU70
                                 IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                                   MOVE 31 TO  FLG-GENBUTU70-KBN
                                 END-IF
                               END-IF
                           END-EVALUATE
                           MOVE    1       TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                           MOVE    "key4"             TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                     END-PERFORM
                 END-IF
                 MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                 MOVE    "key4"             TO  MCP-PATHNAME
                 PERFORM  DB-CLOSE-SEC
               END-PERFORM
      *
               IF   (COMB-HKNNUM   =  "002"                )
               AND  (COMB-HOJOKBN  =  "1" OR "2" OR "3" OR
                                      "A" OR "B" OR "C" OR
                                      "D" OR "E" OR "F" OR
                                      "G" OR "H" OR "I"    )
                    MOVE    ZERO            TO  FLG-GENBUTU70
                    MOVE    ZERO            TO  FLG-GENBUTU70-KBN
               END-IF
               IF   (COMB-HKNNUM   =  "031" OR "032" OR "033" OR "034")
               AND  (COMB-HOJOKBN  =  "2" OR "B" OR "E" OR "H"        )
                    MOVE    ZERO            TO  FLG-GENBUTU70
                    MOVE    ZERO            TO  FLG-GENBUTU70-KBN
               END-IF
      *
               IF    FLG-GENBUTU70      =  ZERO
                 IF  FLG-TOKUSITU   NOT =  ZERO
                    MOVE    FLG-TOKUSITU    TO  FLG-GENBUTU70
                    IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                      MOVE  FLG-TOKUSITU-KBN
                                            TO  FLG-GENBUTU70-KBN
                    END-IF
                    IF   (LNK-SYU-SRYYMD(1:6) >= "201204")
                    AND  (FLG-TOKUSITU         =  1      )
                    AND  (FLG-SANSHOU3     NOT =  SPACE  )
                      MOVE  SPACE  TO  FLG-SANSHOU3
                    END-IF
                 END-IF
               END-IF
               IF    FLG-GENBUTU70      =  ZERO
                 IF  FLG-MARUKO     NOT =  ZERO
                    MOVE    FLG-MARUKO      TO  FLG-GENBUTU70
                 END-IF
               END-IF
      *
               IF    FLG-GENBUTU70  NOT =  ZERO
                 IF   (FLG-TOKUSITU   NOT =  ZERO)
                 OR   (FLG-MARUKO     NOT =  ZERO)
                   MOVE  LNK-SYU-SRYYMD(1:6)    TO  WK-GEN70-YM
                   MOVE  01                     TO  WK-GEN70-DD
                   MOVE  LNK-SYU-SRYYMD(1:6)    TO  WK-GEN70-YM-ED
                   MOVE  31                     TO  WK-GEN70-DD-ED
                 ELSE
                   MOVE  LNK-SYU-SRYYMD(1:6)    TO  WK-GEN70-YM
                   IF   PTKOH-TEKSTYMD(1:6)   =  LNK-SYU-SRYYMD(1:6)
                      MOVE  PTKOH-TEKSTYMD(7:2) TO  WK-GEN70-DD
                   ELSE
                      MOVE  01                  TO  WK-GEN70-DD
                   END-IF
                   MOVE  LNK-SYU-SRYYMD(1:6)    TO  WK-GEN70-YM-ED
                   IF   LNK-SYU-SRYYMD(1:6)   =  PTKOH-TEKEDYMD(1:6)
                      MOVE  PTKOH-TEKEDYMD(7:2) TO  WK-GEN70-DD-ED
                   ELSE
                      MOVE  31                  TO  WK-GEN70-DD-ED
                   END-IF
                 END-IF
               END-IF
      *
             END-IF
           END-IF
      *
           MOVE     SPACE     TO     WK-KOUREI-ZAITAKU-KBN
           MOVE     ZERO      TO     FLG-ZAIARI
           IF   FLG-KOUREI-KBN        =   SPACE
             IF  (FLG-GENBUTU70     NOT =   ZERO   )
             AND (LNK-SYU-SRYYMD(1:6)  <=  "201203")
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200804"
                  PERFORM   2003-ZAITAKU-HENSYU200804-SEC
               ELSE
                  PERFORM   2002-ZAITAKU-HENSYU200604-SEC
               END-IF
               IF   FLG-ZAIARI  =  ZERO
                 IF LNK-S01-KOUREI-ZAITAKU-KBN  =  SPACE
                   MOVE   ZERO   TO  FLG-GENBUTU70
                 END-IF
               ELSE
                 IF WK-KOUREI-ZAITAKU-KBN       =  SPACE
                   MOVE   ZERO   TO  FLG-GENBUTU70
                 END-IF
               END-IF
             END-IF
             MOVE   SPACE   TO   LNK-S01-KOUREI-ZAITAKU-KBN
           ELSE
            IF    LNK-SYU-SRYYMD(1:6)   >=   "201204"
              MOVE   "1"    TO   LNK-S01-KOUREI-ZAITAKU-KBN
            ELSE
             IF   LNK-SYU-SRYYMD(1:6)   >=   "200804"
                  PERFORM   2003-ZAITAKU-HENSYU200804-SEC
             ELSE
               IF LNK-SYU-SRYYMD(1:6)   >=   "200604"
                  PERFORM   2002-ZAITAKU-HENSYU200604-SEC
               ELSE
                  PERFORM   2001-ZAITAKU-HENSYU-SEC
               END-IF
             END-IF
             IF   FLG-ZAIARI  =  ZERO
               CONTINUE
             ELSE
               IF WK-KOUREI-ZAITAKU-KBN       =  SPACE
                 MOVE   SPACE  TO  LNK-S01-KOUREI-ZAITAKU-KBN
               ELSE
                 MOVE   "1"    TO  LNK-S01-KOUREI-ZAITAKU-KBN
               END-IF
             END-IF
            END-IF
           END-IF
      *
           IF     (LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"       )
           AND    (LNK-SYU-SRYYMD(1:6)        >=  "201204"  )
           AND    (COMB-HOJOKBN        =   "3" OR "6" OR "7")
           AND    (FLG-SANSHOU3            NOT =   SPACE    )
                   MOVE  SPACE       TO  FLG-SANSHOU3
           END-IF
      *
           IF   LNK-S01-KOUREI-ZAITAKU-KBN   =  "1"
               IF  COMB-SYU-HKNKOHSBTKBN   =   "8" OR "9"
                   MOVE  SPACE       TO  LNK-S01-KOUREI-ZAITAKU-KBN
               END-IF
               IF  COMB-HKNNUM  =  "971"  OR  "973"  OR  "975"
                               OR  "068"  OR  "069"  OR  "040"
                   MOVE  SPACE       TO  LNK-S01-KOUREI-ZAITAKU-KBN
               END-IF
               IF    COMB-KOH1HKNNUM     =  "970"
               AND   FLG-DAISAN-GENBUTU  =   ZERO
                   MOVE  SPACE       TO  LNK-S01-KOUREI-ZAITAKU-KBN
               END-IF
           END-IF
      *
           IF   FLG-KOUREI-KBN  =  "1"
               IF  COMB-SYU-HKNKOHSBTKBN   =   "8" OR "9"
                   MOVE  SPACE       TO  FLG-KOUREI-KBN
               END-IF
               IF  COMB-HKNNUM  =  "971"  OR  "973"  OR  "975"
                               OR  "068"  OR  "069"  OR  "040"
                   MOVE  SPACE       TO  FLG-KOUREI-KBN
               END-IF
               IF    COMB-KOH1HKNNUM     =  "970"
               AND   FLG-DAISAN-GENBUTU  =   ZERO
                   MOVE  SPACE       TO  FLG-KOUREI-KBN
               END-IF
           END-IF
      *
      *    高齢者現役並み所得者適用区分
           MOVE      ZERO     TO    FLG-KOUREI-GENEKIKBN
           IF    (LNK-SYU-SRYYMD(1:6)         >=  "201808")
           AND   (LNK-S01-KOUREI-ZAITAKU-KBN   =  "1"     )
             MOVE    1        TO    FLG-KOUREI-GENEKIKBN
      *
             INITIALIZE                       PTKOHINF-REC
             MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
             MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
             MOVE    "946"                TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC         TO  MCPDATA-REC
             MOVE    "DBSELECT"           TO  MCP-FUNC
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             CALL    "ORCDBMAIN"          USING  MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                 IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                 AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                 AND (PTKOH-SAKJOKBN   =  SPACE         )
                   IF  (PTKOH-JKYSNUM(1:2) = "２")
                   OR  (PTKOH-JKYSNUM(1:1) = "2" )
                       MOVE  2  TO  FLG-KOUREI-GENEKIKBN
                   ELSE
                     IF  (PTKOH-JKYSNUM(1:2) = "１")
                     OR  (PTKOH-JKYSNUM(1:1) = "1" )
                       MOVE  3  TO  FLG-KOUREI-GENEKIKBN
                     ELSE
                       MOVE  1  TO  FLG-KOUREI-GENEKIKBN
                     END-IF
                   END-IF
                   MOVE    1    TO  FLG-PTKOHINF
                 ELSE
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key4"             TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                 END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
             MOVE    "key4"             TO  MCP-PATHNAME
             PERFORM  DB-CLOSE-SEC
           END-IF
      *
           IF      FLG-GENBUTU70           NOT =  ZERO
             IF  LNK-SYU-SRYYMD(1:6) >= "201501"
               MOVE   FLG-GENBUTU70-KBN   TO   LNK-SYU-SKJ-FTNGAKU(2)
             ELSE
               MOVE   FLG-GENBUTU70       TO   LNK-SYU-SKJ-FTNGAKU(2)
             END-IF
           END-IF
      ***  IF     (FLG-KOUREI-KBN              =  "1")
           IF     (LNK-S01-KOUREI-ZAITAKU-KBN  =  "1")
           AND    (LNK-SYU-SRYYMD(1:6)    >= "200904")
              IF    COMB-HOJOKBN    =   "3" OR "6" OR "7"
                    MOVE    1        TO  LNK-SYU-SKJ-FTNGAKU(2)
                    IF  LNK-SYU-SRYYMD(1:6)  >= "201808"
                      EVALUATE  FLG-KOUREI-GENEKIKBN
                        WHEN       1
                          MOVE   1   TO  LNK-SYU-SKJ-FTNGAKU(2)
                        WHEN       2
                          MOVE  12   TO  LNK-SYU-SKJ-FTNGAKU(2)
                        WHEN       3
                          MOVE  13   TO  LNK-SYU-SKJ-FTNGAKU(2)
                      END-EVALUATE
                    END-IF
              ELSE
                IF  FLG-SANSHOU3    =   SPACE
                    MOVE    2        TO  LNK-SYU-SKJ-FTNGAKU(2)
                ELSE
                    MOVE    3        TO  LNK-SYU-SKJ-FTNGAKU(2)
                END-IF
              END-IF
           END-IF
      *
           IF    ((LNK-S01-KOUREI-ZAITAKU-KBN  =  "1" ) OR 
                  (FLG-GENBUTU70           NOT =  ZERO))
           AND   ( LNK-SYU-SRYYMD(1:6)   <=   "201203" )
              MOVE      "1"          TO  LNK-SYU-ZAITAKU
           END-IF
      *
      *    一般経過措置対象者
           MOVE      ZERO     TO    FLG-KEIKASOCHI-IPAN
           IF  (LNK-S01-KOUREI-ZAITAKU-KBN    =   "1"    )
           AND (LNK-SYU-SRYYMD(1:6)          >=  "200608")
           AND (LNK-SYU-SRYYMD(1:6)          <=  "200812")
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "978"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD(1:6)  <=
                                                 LNK-SYU-SRYYMD(1:6))
                        AND (LNK-SYU-SRYYMD(1:6)  <=
                                                 PTKOH-TEKEDYMD(1:6))
                        AND (PTKOH-SAKJOKBN   =  SPACE              )
                           MOVE    1         TO  FLG-KEIKASOCHI-IPAN
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
      *    減額・免除・支払猶予対象者
           MOVE     ZERO     TO     WK-GENGAKUKBN
           MOVE     ZERO     TO     WK-GENGAKUKBN-KEISAN
           MOVE     ZERO     TO     WK-GENGAKU-KOHID
           MOVE     ZERO     TO     FLG-SAIGAI-TAISYO
      *
           IF  ((LNK-SYU-SRYYMD(1:6)       >=  "200610") AND
                (COMB-HKNNUM            NOT =   SPACE  ))
           OR  ( LNK-SYU-SRYYMD(1:6)       >=  "201101" )
      *
            IF  (COMB-SYU-HKNKOHSBTKBN   =  "8" OR "9"  )
            OR  (COMB-HKNNUM  =  "971" OR "973" OR "975")
            OR  (COMB-KOH1HKNNUM  =  "970"              )
              CONTINUE
            ELSE
              PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                         UNTIL   (GEN-IDX    >    TBL-GENGAKU-MAX)
                           OR    (WK-GENGAKUKBN   NOT = ZERO     )
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    TBL-GENGAKU(GEN-IDX) TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           EVALUATE   GEN-IDX
                             WHEN        1
                               MOVE    1     TO  WK-GENGAKUKBN
                               MOVE   PTKOH-KOHID
                                             TO  WK-GENGAKU-KOHID
                             WHEN        2
                               MOVE    2     TO  WK-GENGAKUKBN
                               MOVE   PTKOH-KOHID
                                             TO  WK-GENGAKU-KOHID
                             WHEN        3
                               MOVE    3     TO  WK-GENGAKUKBN
                             WHEN        4
                               MOVE    4     TO  WK-GENGAKUKBN
                             WHEN        5
                               MOVE    5     TO  WK-GENGAKUKBN
                               MOVE   PTKOH-KOHID
                                             TO  WK-GENGAKU-KOHID
                           END-EVALUATE
      *
                           IF     WK-GENGAKUKBN       =  1
                             IF   PTKOH-FTNJANUM(1:1) = "1"
                               MOVE    1     TO  WK-GENGAKUKBN-KEISAN
                             END-IF
                             IF   PTKOH-FTNJANUM(1:1) = "2"
                               MOVE    2     TO  WK-GENGAKUKBN-KEISAN
                             END-IF
                           END-IF
      *
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-PERFORM
      *
              IF    LNK-SYU-SRYYMD(1:6)  >=  "201101"
                INITIALIZE                     PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
                MOVE    "959"              TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC       TO  MCPDATA-REC
                MOVE    "DBSELECT"         TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                MOVE    "key4"             TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"        USING  MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
                IF      MCP-RC   =    ZERO
                  MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                  MOVE    "key4"           TO  MCP-PATHNAME
                  PERFORM  PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                    IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                    AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                    AND (PTKOH-SAKJOKBN   =  SPACE         )
                      MOVE     1           TO  FLG-SAIGAI-TAISYO
                      MOVE     1           TO  FLG-PTKOHINF
                    ELSE
                      MOVE  "tbl_ptkohinf" TO  MCP-TABLE
                      MOVE  "key4"         TO  MCP-PATHNAME
                      PERFORM  PTKOHINF-READ-SEC
                    END-IF
                  END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                MOVE    "key4"             TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
            END-IF
      *
            IF   (WK-GENGAKUKBN        =   2      )
            AND  (LNK-SYU-SRYYMD(1:6)  <  "201204")
                   MOVE     ZERO    TO    WK-GENGAKUKBN
            END-IF
            IF  (COMB-HKNNUM  =   SPACE                 )
            OR  (COMB-HKNNUM  =  "068" OR "069" OR "040")
              IF  (WK-GENGAKUKBN      =   3 OR 4)
              AND (FLG-SAIGAI-TAISYO  =   1     )
                   CONTINUE
              ELSE
                   MOVE     ZERO    TO    WK-GENGAKUKBN
              END-IF
            END-IF
            IF   COMB-HKNNUM  =  "004"
              IF  WK-HKNJANUM(1:4) = "0404"
                   CONTINUE
              ELSE
                   MOVE     ZERO    TO    WK-GENGAKUKBN
              END-IF
            END-IF
      *
            MOVE   WK-GENGAKUKBN    TO    LNK-SYU-YKZKENNUM
      *
           END-IF
      *
      *    高額委任払い制度対象者
           MOVE      ZERO     TO    FLG-KOHININBARAI
           MOVE      ZERO     TO    WK-KOHININBARAI-KOHID
           MOVE      SPACE    TO    WK-KOHININBARAI-JKYSNUM
           IF   LNK-S01-KOUREI-ZAITAKU-KBN    =   "1"
                CONTINUE
           ELSE
            IF   (COMB-HKNNUM      NOT =  SPACE         )
            AND  (COMB-KOH1HKNNUM      =  SPACE OR "027"
                                                OR "970")
            AND  (COMB-KOH2HKNNUM      =  SPACE         )
            AND  (COMB-KOH3HKNNUM      =  SPACE         )
            AND  (COMB-KOH4HKNNUM      =  SPACE         )
              IF  (COMB-SYU-HKNKOHSBTKBN =  "8" OR "9"    )
              OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                                OR "068" OR "069" OR "040")
              OR  (COMB-KOH1HKNNUM       =  "970"         )
                CONTINUE
              ELSE
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "964"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           MOVE    1         TO  FLG-KOHININBARAI
                           MOVE   PTKOH-KOHID
                                             TO  WK-KOHININBARAI-KOHID
                           MOVE   PTKOH-JKYSNUM
                                         TO  WK-KOHININBARAI-JKYSNUM
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
            END-IF
           END-IF
      *
      *    高額４回目以降対象者
           MOVE      ZERO     TO    FLG-KOHYONKAIME
           IF  ( FLG-GENBUTU70           NOT =  ZERO )
           OR  ((FLG-KOHININBARAI            =   1  ) AND
                (LNK-SYU-SRYYMD(1:6)  >=  "201501"  ))
           OR  ((LNK-S01-KOUREI-ZAITAKU-KBN  =  "1" ) AND
                (LNK-SYU-SRYYMD(1:6)  >=  "201808"  ))
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "965"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           MOVE    1         TO  FLG-KOHYONKAIME
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
           MOVE    ZERO     TO    FLG-OITA-GENBUTU70
           IF    WK-2010-NINNASIKBN(1)  NOT = SPACE
             IF  (LNK-SYU-KOH2HKNNUM  = "972" OR "974")
             OR  (LNK-SYU-KOH3HKNNUM  = "972" OR "974")
             OR  (LNK-SYU-KOH4HKNNUM  = "972" OR "974")
             OR  (FLG-KOUREI-KBN             =   "1"  )
                CONTINUE
             ELSE
                IF    FLG-GENBUTU70   =  ZERO
                  IF    WK-2010-NINNASIKBN(1)  =
                                            "1" OR "2" OR "5" OR "6"
                    MOVE       2     TO    FLG-GENBUTU70
                    MOVE       1     TO    FLG-OITA-GENBUTU70
                    IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                      IF   WK-2010-NINNASIKBN(1)  =  "1" OR "2"
                        MOVE   21    TO    FLG-GENBUTU70-KBN
                      ELSE
                        MOVE   22    TO    FLG-GENBUTU70-KBN
                      END-IF
                    END-IF
                  ELSE
                    IF  FLG-SANSHOU2   =  "2" OR "3"
                       MOVE    3     TO    FLG-GENBUTU70
                       IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                         MOVE  31    TO    FLG-GENBUTU70-KBN
                       END-IF
                       MOVE    1     TO    FLG-OITA-GENBUTU70
                    ELSE
                       MOVE    2     TO    FLG-GENBUTU70
                       MOVE    1     TO    FLG-OITA-GENBUTU70
                       IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                         IF   WK-2010-NINNASIKBN(1)  =  "3" OR "4"
                           MOVE  21  TO    FLG-GENBUTU70-KBN
                         ELSE
                           MOVE  22  TO    FLG-GENBUTU70-KBN
                         END-IF
                       END-IF
                    END-IF
                  END-IF
                  IF    WK-2010-NINNASIKBN(1)  =
                                            "2" OR "4" OR "6" OR "8"
                    INITIALIZE                       PTKOHINF-REC
                    MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                    MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                    MOVE    "965"                TO  PTKOH-KOHNUM
                    MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                    MOVE    "DBSELECT"           TO  MCP-FUNC
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    CALL    "ORCDBMAIN"          USING  MCPAREA
                                                        MCPDATA-REC
                                                        SPA-AREA
                    IF      MCP-RC               =       ZERO
                      MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                      MOVE    "key4"           TO  MCP-PATHNAME
                      PERFORM  PTKOHINF-READ-SEC
                      PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                          MOVE    1         TO  FLG-KOHYONKAIME
                          MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                          MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                          MOVE    "key4"           TO  MCP-PATHNAME
                          PERFORM  PTKOHINF-READ-SEC
                        END-IF
                      END-PERFORM
                    END-IF
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  DB-CLOSE-SEC
                  END-IF
                END-IF
             END-IF
           END-IF
      *
      *    当月７５歳到達者
      *    （既に０３９となっている場合、１日が誕生日、
      *      ２月２９日が誕生日、公費単独を除く）
           MOVE      ZERO       TO    FLG-TOKU75
                                      FLG-TOKU75-KIZON
           MOVE      SPACE      TO    WK-TOKU75-BIRTHDAY
           MOVE      ZERO       TO    FLG-KOKI-HIGAITO
           IF   (FLG-KOUREI-KBN          =   "1"     )
           AND  (COMB-HKNNUM         NOT =   SPACE   )
           AND  (LNK-SYU-SRYYMD(1:6)    >=   "200901")
               INITIALIZE                       PTKOHINF-REC
               MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
               MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
               MOVE    "977"                TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC         TO  MCPDATA-REC
               MOVE    "DBSELECT"           TO  MCP-FUNC
               MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
               MOVE    "key4"               TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING  MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                   MOVE    "key4"           TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                   PERFORM  UNTIL   FLG-PTKOHINF    =   1
                     IF  (PTKOH-TEKSTYMD(1:6)  <=
                                              LNK-SYU-SRYYMD(1:6))
                     AND (LNK-SYU-SRYYMD(1:6)  <=
                                              PTKOH-TEKEDYMD(1:6))
                     AND (PTKOH-SAKJOKBN   =  SPACE              )
                        MOVE    1       TO  FLG-KOKI-HIGAITO
                        MOVE    1       TO  FLG-PTKOHINF
                     ELSE
                        MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                        MOVE    "key4"           TO  MCP-PATHNAME
                        PERFORM  PTKOHINF-READ-SEC
                     END-IF
                   END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
               MOVE    "key4"           TO  MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
               INITIALIZE                      ORCSAGECHKAREA
               MOVE    LNK-SYU-HOSPNUM     TO  AGECHK-HOSPNUM
               MOVE    LNK-SYU-PTID        TO  AGECHK-PTID
               MOVE    LNK-SYU-SRYYMD(1:6) TO  AGECHK-SRYYMD(1:6)
               MOVE    "01"                TO  AGECHK-SRYYMD(7:2)
               MOVE    PTINF-BIRTHDAY      TO  AGECHK-BIRTHDAY
      *        MOVE    LNK-SYU-HKNCOMBINUM TO  AGECHK-HKNCOMBINUM
      *        MOVE    LNK-SYU-NYUGAIKBN   TO  AGECHK-NYUGAIKBN
               CALL    "ORCSAGECHK"        USING
                                           ORCSAGECHKAREA
                                           SPA-AREA
               IF      AGECHK-RC       =   ZERO
                   IF  ( AGECHK-NENREI        =  74                 )
                   AND ( AGECHK-ROUJIN2       =  0                  )
                   AND ( PTINF-BIRTHDAY(5:2)  = LNK-SYU-SRYYMD(5:2) )
                   AND ( PTINF-BIRTHDAY(7:2)  NOT =   "01"          )
                   AND ( PTINF-BIRTHDAY(5:4)  NOT =   "0229"        )
                   AND ( FLG-KOKI-HIGAITO         =    ZERO         )
                       MOVE   1    TO    FLG-TOKU75
                       MOVE   PTINF-BIRTHDAY
                                   TO    WK-TOKU75-BIRTHDAY
                   END-IF
                   IF  ( AGECHK-NENREI       >=  75 )
                   OR  ( AGECHK-ROUJIN2       =  1  )
                       MOVE   1    TO    FLG-TOKU75-KIZON
                   END-IF
               ELSE
                   DISPLAY  "PTINF AGE-CHK ERR " LNK-SYU-PTID
               END-IF
           END-IF
      *
      *    当月７５歳到達者の被扶養者
           IF   (LNK-SYU-SRYYMD(1:6)       >=  "200901" )
           AND  (COMB-HKNNUM            NOT =   SPACE   )
             IF (COMB-SYU-HKNKOHSBTKBN   =  "8" OR "9"  )
             OR (COMB-HKNNUM  =  "971" OR "973" OR "975"
                              OR "068" OR "069" OR "040")
             OR ((COMB-KOH1HKNNUM     =  "970"         ) AND
                 (FLG-DAISAN-GENBUTU  =   ZERO         ))
             OR (FLG-TOKU75                 =    1      )
             OR (FLG-TOKU75-KIZON           =    1      )
                CONTINUE
             ELSE
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "969"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD(1:6) = LNK-SYU-SRYYMD(1:6))
                      AND (LNK-SYU-SRYYMD(1:6) = PTKOH-TEKEDYMD(1:6))
                      AND (PTKOH-SAKJOKBN      = SPACE              )
                         IF  PTKOH-TEKSTYMD(5:4)   NOT =  "0229"
                           IF  FLG-KOUREI-KBN =  "1"
                              MOVE  2   TO   FLG-TOKU75
                           ELSE
                              MOVE  3   TO   FLG-TOKU75
                           END-IF
                           MOVE  PTKOH-TEKSTYMD
                                        TO   WK-TOKU75-BIRTHDAY
                         END-IF
                         MOVE    1      TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                         MOVE    "key4"           TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                      END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
             END-IF
           END-IF
      *
      *    ７５歳到達月の特例非該当
           IF   FLG-TOKU75   =  1  OR  2  OR  3
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "954"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           MOVE    ZERO      TO  FLG-TOKU75
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
      *    ０１公該当
           MOVE      ZERO     TO    FLG-ZEROKOGAITO
           IF   LNK-SYU-SRYYMD(1:6)  >=  "201204"
             IF  ((FLG-GENBUTU70           NOT =   ZERO) AND
                  (FLG-OITA-GENBUTU70          =   ZERO))
             OR  ((LNK-S01-KOUREI-ZAITAKU-KBN  =   "1" ) AND
                  (COMB-HKNNUM             NOT =  SPACE))
               IF   (COMB-HKNNUM     NOT =  SPACE)
               AND  (COMB-KOH1HKNNUM     =  SPACE
                                         OR "970")
               AND  (COMB-KOH2HKNNUM     =  SPACE)
               AND  (COMB-KOH3HKNNUM     =  SPACE)
               AND  (COMB-KOH4HKNNUM     =  SPACE)
                 IF  (COMB-SYU-HKNKOHSBTKBN =  "8" OR "9"    )
                 OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                                   OR "068" OR "069" OR "040")
                 OR  ((COMB-KOH1HKNNUM      =  "970"        ) AND
                      (FLG-DAISAN-GENBUTU   =   ZERO        ))
                   CONTINUE
                 ELSE
                   INITIALIZE                        PTKOHINF-REC
                   MOVE    LNK-SYU-HOSPNUM       TO  PTKOH-HOSPNUM
                   MOVE    LNK-SYU-PTID          TO  PTKOH-PTID
                   MOVE    "955"                 TO  PTKOH-KOHNUM
                   MOVE    PTKOHINF-REC          TO  MCPDATA-REC
                   MOVE    "DBSELECT"            TO  MCP-FUNC
                   MOVE    "tbl_ptkohinf"        TO  MCP-TABLE
                   MOVE    "key4"                TO  MCP-PATHNAME
                   CALL    "ORCDBMAIN"           USING  MCPAREA
                                                        MCPDATA-REC
                                                        SPA-AREA
                   IF      MCP-RC   =   ZERO
                     MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                     MOVE    "key4"              TO  MCP-PATHNAME
                     PERFORM  PTKOHINF-READ-SEC
                     PERFORM  UNTIL   FLG-PTKOHINF   =   1
                       IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                       AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                       AND (PTKOH-SAKJOKBN   =  SPACE         )
                         MOVE     1    TO   FLG-ZEROKOGAITO
                         MOVE     1    TO   FLG-PTKOHINF
                       ELSE
                         MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                         MOVE    "key4"          TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                       END-IF
                     END-PERFORM
                   END-IF
                   MOVE      "tbl_ptkohinf"      TO  MCP-TABLE
                   MOVE      "key4"              TO  MCP-PATHNAME
                   PERFORM    DB-CLOSE-SEC
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           MOVE      ZERO          TO    FLG-CYOKI-ARI
           IF   LNK-SYU-SRYYMD(1:6)  >=  "200905"
             IF  (LNK-S01-KOUREI-ZAITAKU-KBN    =   "1")
             OR  (FLG-GENBUTU70             NOT =  ZERO)
             OR  (FLG-TOKU75                NOT =  ZERO)
               CONTINUE
             ELSE
               IF  ( COMB-HKNNUM      NOT =  SPACE     )
               AND ((COMB-KOH1HKNNUM  = "972" OR "974") OR
                    (COMB-KOH2HKNNUM  = "972" OR "974") OR
                    (COMB-KOH3HKNNUM  = "972" OR "974") OR
                    (COMB-KOH4HKNNUM  = "972" OR "974"))
                 IF  FLG-KOUREI-KBN =  "1"
                    MOVE    1      TO    FLG-CYOKI-ARI
                 ELSE
                    MOVE    2      TO    FLG-CYOKI-ARI
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF    (FLG-GENBUTU70   NOT =  ZERO)
           AND   (FLG-KOHININBARAI    =    1 )
              MOVE   ZERO     TO    FLG-KOHININBARAI
           END-IF
      *
      *    公費負担限度額のセット
      *    ＜特定疾患給付対象療養は所得区分に準ずるが、一般所得の
      *      金額を超える上限額が平成２６年１２月まではなかった。＞
      *    ＜高齢者の上位所得者について、平成２７年１月以降で、
      *      一般所得の金額を超える上限額ができた為、修正した。  ＞
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201808"
               IF   (FLG-TOKUSITU-XXX      =   1      )
               AND  (COMB-HOJOKBN =  "3" OR "6" OR "7")
                 MOVE   80100   TO    WK-KOH-GENDOGAKU
               ELSE
                 MOVE   18000   TO    WK-KOH-GENDOGAKU
               END-IF
           ELSE
             IF  LNK-SYU-SRYYMD(1:6)  >=  "201708"
               IF   (FLG-TOKUSITU-XXX      =   1      )
               AND  (COMB-HOJOKBN =  "3" OR "6" OR "7")
                 MOVE   57600   TO    WK-KOH-GENDOGAKU
               ELSE
                 MOVE   14000   TO    WK-KOH-GENDOGAKU
               END-IF
             ELSE
               IF   (FLG-TOKUSITU-XXX      =   1      )
               AND  (COMB-HOJOKBN =  "3" OR "6" OR "7")
               AND  (LNK-SYU-SRYYMD(1:6)  >=  "201501")
                 MOVE   44400   TO    WK-KOH-GENDOGAKU
               ELSE
                 MOVE   12000   TO    WK-KOH-GENDOGAKU
               END-IF
             END-IF
           END-IF
           IF  FLG-SANSHOU3  NOT =  SPACE
             MOVE      8000   TO    WK-KOH-GENDOGAKU
           END-IF
      *
           IF   ( COMB-KOH1HKNNUM  =   "972" )
           OR   ( COMB-KOH2HKNNUM  =   "972" )
           OR   ( COMB-KOH3HKNNUM  =   "972" )
           OR   ( COMB-KOH4HKNNUM  =   "972" )
              IF   WK-KOH-GENDOGAKU > 10000
                 MOVE   10000   TO  WK-KOH-GENDOGAKU
              END-IF
           END-IF
           IF   ( COMB-KOH1HKNNUM  =   "974" )
           OR   ( COMB-KOH2HKNNUM  =   "974" )
           OR   ( COMB-KOH3HKNNUM  =   "974" )
           OR   ( COMB-KOH4HKNNUM  =   "974" )
              IF   WK-KOH-GENDOGAKU > 20000
                 MOVE   20000   TO  WK-KOH-GENDOGAKU
              END-IF
           END-IF
      *
           IF     FLG-GENBUTU70   NOT =  ZERO
              EVALUATE   FLG-GENBUTU70
                WHEN        1
                WHEN        2
                  MOVE     80100   TO   WK-GEN70-GENDOGAKU
                  IF  FLG-TOKUSITU-XXX  = 1
                    CONTINUE
                  ELSE
                    IF  FLG-KOHYONKAIME = 1
                      MOVE 44400   TO   WK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
                WHEN        3
                  MOVE     35400   TO   WK-GEN70-GENDOGAKU
                  IF  FLG-TOKUSITU-XXX  = 1
                    CONTINUE
                  ELSE
                    IF  FLG-KOHYONKAIME = 1
                      MOVE 24600   TO   WK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
              END-EVALUATE
              IF   ( COMB-KOH1HKNNUM  =   "972" )
              OR   ( COMB-KOH2HKNNUM  =   "972" )
              OR   ( COMB-KOH3HKNNUM  =   "972" )
              OR   ( COMB-KOH4HKNNUM  =   "972" )
                 IF   WK-GEN70-GENDOGAKU > 10000
                    MOVE   10000   TO  WK-GEN70-GENDOGAKU
                 END-IF
              END-IF
              IF   ( COMB-KOH1HKNNUM  =   "974" )
              OR   ( COMB-KOH2HKNNUM  =   "974" )
              OR   ( COMB-KOH3HKNNUM  =   "974" )
              OR   ( COMB-KOH4HKNNUM  =   "974" )
                 IF   WK-GEN70-GENDOGAKU > 20000
                    MOVE   20000   TO  WK-GEN70-GENDOGAKU
                 END-IF
              END-IF
           ELSE
              IF  (FLG-TOKU75     =   3)
              OR  (FLG-CYOKI-ARI  =   2)
                 MOVE   ZERO       TO  WK-GEN70-GENDOGAKU
                 IF   ( COMB-KOH1HKNNUM  =   "972" )
                 OR   ( COMB-KOH2HKNNUM  =   "972" )
                 OR   ( COMB-KOH3HKNNUM  =   "972" )
                 OR   ( COMB-KOH4HKNNUM  =   "972" )
                    MOVE   10000   TO  WK-GEN70-GENDOGAKU
                 END-IF
                 IF   ( COMB-KOH1HKNNUM  =   "974" )
                 OR   ( COMB-KOH2HKNNUM  =   "974" )
                 OR   ( COMB-KOH3HKNNUM  =   "974" )
                 OR   ( COMB-KOH4HKNNUM  =   "974" )
                    MOVE   20000   TO  WK-GEN70-GENDOGAKU
                 END-IF
              END-IF
           END-IF
      *
           MOVE       8000       TO     WK-SEIHO-GENDO
           IF  FLG-KOHYONKAIME = 1
              MOVE   24600       TO     WK-SEIHO-GENDO70
           ELSE
              MOVE   35400       TO     WK-SEIHO-GENDO70
           END-IF
      *
           IF   (LNK-S01-KOUREI-ZAITAKU-KBN    =   "1" )
           AND  (FLG-SANSHOU3              NOT =  SPACE)
             MOVE     8000       TO     WK-CYOKI-GENDO
           ELSE
             MOVE    10000       TO     WK-CYOKI-GENDO
           END-IF
           MOVE      20000       TO     WK-CYOKI-GENDO2
      *
           COMPUTE  WK-KOH-GENDOGAKU-TOKU75   = 
                    WK-KOH-GENDOGAKU          /  2
           COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                    WK-GEN70-GENDOGAKU        /  2
           COMPUTE  WK-SEIHO-GENDO-TOKU75     =
                    WK-SEIHO-GENDO            /  2
           COMPUTE  WK-SEIHO-GENDO70-TOKU75   =
                    WK-SEIHO-GENDO70          /  2
           COMPUTE  WK-CYOKI-GENDO-TOKU75     =
                    WK-CYOKI-GENDO            /  2
           COMPUTE  WK-CYOKI-GENDO2-TOKU75    =
                    WK-CYOKI-GENDO2           /  2
      *
      *    減額（割合・金額）の取込み処理
      *    公費負担限度額の減額
           IF    WK-GENGAKUKBN    NOT  =   ZERO
             PERFORM       2004-GENGAKU-GET-SEC
             IF  WK-GENGAKUKBN-KEISAN  =   ZERO
               PERFORM     2004X-KOHGENDO-GEN-SEC
             END-IF
           END-IF
      *
      *    現物給付（主保険単独分）フラグセット
           IF  (LNK-SYU-SRYYMD(1:6)  >= "201204")
           AND (COMB-HKNNUM       NOT =  SPACE  )
           AND (COMB-KOH1HKNNUM       =  SPACE  )
           AND (COMB-KOH2HKNNUM       =  SPACE  )
           AND (COMB-KOH3HKNNUM       =  SPACE  )
           AND (COMB-KOH4HKNNUM       =  SPACE  )
             IF (FLG-GENBUTU70           NOT =   ZERO)
             OR (LNK-S01-KOUREI-ZAITAKU-KBN  =   "1" )
                MOVE    "1"    TO    LNK-SYU-SAIKEISANKBN
             END-IF
           END-IF
      *
      *    保険番号テーブルから公費の負担上限回数と上限金額の取得
           PERFORM         210-HOKEN-KAISU-SEC
      *
      *    診療月内の収納マスタから公費毎の使用回数と患者負担金額の
      *    累計を調査
           PERFORM         220-SYUNOU-SEC
      *
      *    保険・公費の負担金計算
           PERFORM         230-FTNKIN-SEC
      *
           .
      *
       200-HKNFTN-SANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *        在総診判定（２００６年４月まで）                        *
      ******************************************************************
       2001-ZAITAKU-HENSYU-SEC           SECTION.
      *
           PERFORM   VARYING   IDX10   FROM    1   BY  1
                      UNTIL  ( IDX10    >   TBL-ZAITAKU-MAX      )
                       OR    ( WK-KOUREI-ZAITAKU-KBN  = "1"      )
      *
             MOVE     TBL-ZAITAKU(IDX10)     TO   WK-ZAITAKU-SRYCD
             PERFORM  20011-ZAITAKU-HANTEI-SEC
      *
           END-PERFORM
      *
           .
      *
       2001-ZAITAKU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        在総診判定
      ******************************************************************
       20011-ZAITAKU-HANTEI-SEC           SECTION.
      *
           INITIALIZE                           SRYACT-REC
           MOVE    LNK-SYU-HOSPNUM      TO      SRY-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN    TO      SRY-NYUGAIKBN
           MOVE    LNK-SYU-PTID         TO      SRY-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)  TO      SRY-SRYYM
           MOVE    WK-ZAITAKU-SRYCD     TO      SRY-SRYCD(1)
           MOVE    WK-ZAITAKU-SRYCD     TO      SRY-SRYCD(2)
           MOVE    WK-ZAITAKU-SRYCD     TO      SRY-SRYCD(3)
           MOVE    WK-ZAITAKU-SRYCD     TO      SRY-SRYCD(4)
           MOVE    WK-ZAITAKU-SRYCD     TO      SRY-SRYCD(5)
           MOVE    SRYACT-REC           TO      MCPDATA-REC
           MOVE    "DBSELECT"           TO      MCP-FUNC
           MOVE    "tbl_sryact"         TO      MCP-TABLE
           MOVE    "key7"               TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key7"           TO      MCP-PATHNAME
               PERFORM   SRYACT-READ-SEC
               PERFORM   UNTIL   FLG-SRYACT   =    1
                   INITIALIZE                   SRYACCT-REC
                   MOVE    SRY-HOSPNUM      TO   ACCT-HOSPNUM
                   MOVE    SRY-NYUGAIKBN    TO   ACCT-NYUGAIKBN
                   MOVE    SRY-SRYKA        TO   ACCT-SRYKA
                   MOVE    SRY-PTID         TO   ACCT-PTID
                   MOVE    SRY-SRYYM        TO   ACCT-SRYYM
                   MOVE    SRY-ZAINUM       TO   ACCT-ZAINUM
                   MOVE    SRYACCT-REC      TO   MCPDATA-REC
                   MOVE    "DBSELECT"       TO   MCP-FUNC
                   MOVE    "tbl_sryacct"    TO   MCP-TABLE
                   MOVE    "key31"          TO   MCP-PATHNAME
                   CALL    "ORCDBMAIN"      USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                   IF      MCP-RC           =       ZERO
                       MOVE    "tbl_sryacct" TO  MCP-TABLE
                       MOVE    "key31"       TO  MCP-PATHNAME
                       PERFORM   SRYACCT-READ-SEC
                       IF      FLG-SRYACCT  =       ZERO
                           IF  (ACCT-ZAITEN   NOT =  ZERO)  AND
                               (ACCT-ZAIKAISU NOT =  ZERO)
      *                      保険組合せマスタの検索
                             MOVE     1      TO  FLG-ZAIARI
                             INITIALIZE             WRK-HKNCOMBI-REC
                             MOVE ACCT-HOSPNUM   TO WRK-COMB-HOSPNUM
                             MOVE ACCT-PTID      TO WRK-COMB-PTID
                             MOVE ACCT-HKNCOMBI  TO WRK-COMB-HKNCOMBINUM
                             MOVE WRK-HKNCOMBI-REC
                                                 TO MCPDATA-REC
                             MOVE "DBSELECT"     TO MCP-FUNC
                             MOVE "tbl_hkncombi" TO MCP-TABLE
                             MOVE "key"          TO MCP-PATHNAME
                             CALL "ORCDBMAIN" USING MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                             IF    MCP-RC  =  ZERO
                               MOVE "tbl_hkncombi" TO MCP-TABLE
                               MOVE "key"          TO MCP-PATHNAME
                               PERFORM HKNCOMBI-READ2-SEC
                               IF  FLG-HKNCOMBI = ZERO
                                 IF (WRK-COMB-HKNNUM = "971" OR "973" OR
                                                       "975" OR "068" OR
                                                       "069" OR "040")
                                 OR (WRK-COMB-SYU-HKNKOHSBTKBN =  "8"
                                                               OR "9")
                                 OR (WRK-COMB-KOH1HKNNUM  =  "970"   )
                                   CONTINUE
                                 ELSE
                                   MOVE   "1"    TO
                                        WK-KOUREI-ZAITAKU-KBN
                                 END-IF
                               END-IF
                             END-IF
                             MOVE "tbl_hkncombi" TO MCP-TABLE
                             MOVE "key"          TO MCP-PATHNAME
                             PERFORM DB-CLOSE-SEC
                           END-IF
                       END-IF
                   END-IF
                   MOVE    "tbl_sryacct" TO  MCP-TABLE
                   MOVE    "key31"       TO  MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
      *
                   MOVE    "tbl_sryact"  TO  MCP-TABLE
                   MOVE    "key7"        TO  MCP-PATHNAME
                   PERFORM   SRYACT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_sryact"         TO      MCP-TABLE
           MOVE    "key7"               TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           .
      *
       20011-ZAITAKU-HANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *        在総診判定（２００６年４月から）                        *
      ******************************************************************
       2002-ZAITAKU-HENSYU200604-SEC           SECTION.
      *
           PERFORM   VARYING   IDX10   FROM    1   BY  1
                      UNTIL  ( IDX10    >   TBL-ZAITAKU2-MAX     )
                       OR    ( WK-KOUREI-ZAITAKU-KBN  = "1"      )
      *
             MOVE     TBL-ZAITAKU2(IDX10)    TO   WK-ZAITAKU-SRYCD
             PERFORM  20011-ZAITAKU-HANTEI-SEC
      *
           END-PERFORM
      *
           .
      *
       2002-ZAITAKU-HENSYU200604-EXT.
           EXIT.
      *
      ******************************************************************
      *        在総診判定（２００８年４月から）                        *
      ******************************************************************
       2003-ZAITAKU-HENSYU200804-SEC           SECTION.
      *
           PERFORM   VARYING   IDX10   FROM    1   BY  1
                      UNTIL  ( IDX10    >   TBL-ZAITAKU3-MAX     )
                       OR    ( WK-KOUREI-ZAITAKU-KBN  = "1"      )
      *
             MOVE     TBL-ZAITAKU3(IDX10)    TO   WK-ZAITAKU-SRYCD
             PERFORM  20011-ZAITAKU-HANTEI-SEC
      *
           END-PERFORM
      *
           .
      *
       2003-ZAITAKU-HENSYU200804-EXT.
           EXIT.
      *
      ******************************************************************
      *        減額（割合・金額）の取込み処理                          *
      ******************************************************************
       2004-GENGAKU-GET-SEC           SECTION.
      *
           IF   WK-GENGAKUKBN   =   1   OR   2   OR   5
      *
                MOVE       ZERO           TO  WK-GENGAKU-RITU
                                              WK-GENGAKU-KIN
      *
      *         公費月上限額取得
                INITIALIZE                    LNK-ORCSJGNGET-REC
                MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
                MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
                MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
                EVALUATE   WK-GENGAKUKBN
                  WHEN         1
                     MOVE    "960"        TO  LNK-ORCSJGNGET-KOHHKNNUM
                  WHEN         2
                     MOVE    "961"        TO  LNK-ORCSJGNGET-KOHHKNNUM
                  WHEN         5
                     MOVE    "953"        TO  LNK-ORCSJGNGET-KOHHKNNUM
                END-EVALUATE
                MOVE  WK-GENGAKU-KOHID    TO  LNK-ORCSJGNGET-KOHID
                MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
      *
                CALL    "ORCSJGNGET"      USING
                                          LNK-ORCSJGNGET-REC
                                          SPA-AREA
      *
                IF    LNK-ORCSJGNGET-RC   =   ZERO
                    EVALUATE   WK-GENGAKUKBN
                      WHEN          1
                         MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                          TO  WK-GENGAKU-RITU
                         IF   WK-GENGAKU-RITU  >  100
                             MOVE   100   TO  WK-GENGAKU-RITU
                         END-IF
                      WHEN          2
                      WHEN          5
                         MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                          TO  WK-GENGAKU-KIN
                         COMPUTE  WK-GENGAKU-KIN =
                                  WK-GENGAKU-KIN +  5
                         COMPUTE  WK-GENGAKU-KIN =
                                  WK-GENGAKU-KIN /  10
                         COMPUTE  WK-GENGAKU-KIN =
                                  WK-GENGAKU-KIN *  10
                    END-EVALUATE
                END-IF
      *
           END-IF
      *
           .
      *
       2004-GENGAKU-GET-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費負担限度額の減額                                    *
      ******************************************************************
       2004X-KOHGENDO-GEN-SEC           SECTION.
      *
           IF   WK-KOH-GENDOGAKU  NOT = ZERO
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   WK-KOH-GENDOGAKU
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  WK-KOH-GENDOGAKU  =
                             WK-KOH-GENDOGAKU  *
                             WK-GENGAKU-RITUX  /
                             100
                  END-IF
                WHEN          2
                  IF  WK-KOH-GENDOGAKU < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   WK-KOH-GENDOGAKU
                  ELSE
                    COMPUTE  WK-KOH-GENDOGAKU  =
                             WK-KOH-GENDOGAKU  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   WK-KOH-GENDOGAKU
                WHEN          5
                  IF  WK-KOH-GENDOGAKU > WK-GENGAKU-KIN
                    COMPUTE  WK-KOH-GENDOGAKU  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  WK-KOH-GENDOGAKU =
                       WK-KOH-GENDOGAKU +  5
              COMPUTE  WK-KOH-GENDOGAKU =
                       WK-KOH-GENDOGAKU /  10
              COMPUTE  WK-KOH-GENDOGAKU =
                       WK-KOH-GENDOGAKU *  10
           END-IF
      *
           IF   WK-GEN70-GENDOGAKU  NOT = ZERO
              IF   WK-GEN70-GENDOGAKU  = 80100
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     END-IF
                   WHEN          2
                     IF  WK-GEN70-GENDOGAKU < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU
                   WHEN          5
                     IF  WK-GEN70-GENDOGAKU > WK-GENGAKU-KIN
                       MOVE   WK-GENGAKU-KIN
                                     TO   WK-GEN70-GENDOGAKU
                     END-IF
                 END-EVALUATE
              ELSE
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     ELSE
                       COMPUTE  WK-GENGAKU-RITUX =
                                100 - WK-GENGAKU-RITU
                       COMPUTE  WK-GEN70-GENDOGAKU  =
                                WK-GEN70-GENDOGAKU  *
                                WK-GENGAKU-RITUX  /
                                100
                     END-IF
                   WHEN          2
                     IF  WK-GEN70-GENDOGAKU < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     ELSE
                       COMPUTE  WK-GEN70-GENDOGAKU =
                                WK-GEN70-GENDOGAKU -
                                WK-GENGAKU-KIN
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU
                   WHEN          5
                     IF  WK-GEN70-GENDOGAKU > WK-GENGAKU-KIN
                       COMPUTE  WK-GEN70-GENDOGAKU =
                                WK-GENGAKU-KIN
                     END-IF
                 END-EVALUATE
                 COMPUTE  WK-GEN70-GENDOGAKU =
                          WK-GEN70-GENDOGAKU +  5
                 COMPUTE  WK-GEN70-GENDOGAKU =
                          WK-GEN70-GENDOGAKU /  10
                 COMPUTE  WK-GEN70-GENDOGAKU =
                          WK-GEN70-GENDOGAKU *  10
              END-IF
           END-IF
      *
           EVALUATE   WK-GENGAKUKBN
             WHEN          1
               IF  WK-GENGAKU-RITU = 100
                 MOVE   ZERO   TO   WK-SEIHO-GENDO
                                    WK-SEIHO-GENDO70
                                    WK-CYOKI-GENDO
                                    WK-CYOKI-GENDO2
               ELSE
                 COMPUTE  WK-GENGAKU-RITUX =
                          100 - WK-GENGAKU-RITU
                 COMPUTE  WK-SEIHO-GENDO    =
                          WK-SEIHO-GENDO    *
                          WK-GENGAKU-RITUX  /
                          100
                 COMPUTE  WK-SEIHO-GENDO70  =
                          WK-SEIHO-GENDO70  *
                          WK-GENGAKU-RITUX  /
                          100
                 COMPUTE  WK-CYOKI-GENDO    =
                          WK-CYOKI-GENDO    *
                          WK-GENGAKU-RITUX  /
                          100
                 COMPUTE  WK-CYOKI-GENDO2   =
                          WK-CYOKI-GENDO2   *
                          WK-GENGAKU-RITUX  /
                          100
               END-IF
             WHEN          2
               IF  WK-SEIHO-GENDO < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-SEIHO-GENDO
               ELSE
                 COMPUTE  WK-SEIHO-GENDO     =
                          WK-SEIHO-GENDO     -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-SEIHO-GENDO70 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-SEIHO-GENDO70
               ELSE
                 COMPUTE  WK-SEIHO-GENDO70   =
                          WK-SEIHO-GENDO70   -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-CYOKI-GENDO
               ELSE
                 COMPUTE  WK-CYOKI-GENDO     =
                          WK-CYOKI-GENDO     -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO2 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-CYOKI-GENDO2
               ELSE
                 COMPUTE  WK-CYOKI-GENDO2    =
                          WK-CYOKI-GENDO2    -
                          WK-GENGAKU-KIN
               END-IF
             WHEN          3
             WHEN          4
               MOVE     ZERO   TO   WK-SEIHO-GENDO
                                    WK-SEIHO-GENDO70
                                    WK-CYOKI-GENDO
                                    WK-CYOKI-GENDO2
             WHEN          5
               IF  WK-SEIHO-GENDO > WK-GENGAKU-KIN
                 COMPUTE  WK-SEIHO-GENDO     =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-SEIHO-GENDO70 > WK-GENGAKU-KIN
                 COMPUTE  WK-SEIHO-GENDO70   =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO > WK-GENGAKU-KIN
                 COMPUTE  WK-CYOKI-GENDO     =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO2 > WK-GENGAKU-KIN
                 COMPUTE  WK-CYOKI-GENDO2    =
                          WK-GENGAKU-KIN
               END-IF
           END-EVALUATE
           COMPUTE  WK-SEIHO-GENDO   =
                    WK-SEIHO-GENDO   +  5
           COMPUTE  WK-SEIHO-GENDO   =
                    WK-SEIHO-GENDO   /  10
           COMPUTE  WK-SEIHO-GENDO   =
                    WK-SEIHO-GENDO   *  10
           COMPUTE  WK-SEIHO-GENDO70 =
                    WK-SEIHO-GENDO70 +  5
           COMPUTE  WK-SEIHO-GENDO70 =
                    WK-SEIHO-GENDO70 /  10
           COMPUTE  WK-SEIHO-GENDO70 =
                    WK-SEIHO-GENDO70 *  10
           COMPUTE  WK-CYOKI-GENDO   =
                    WK-CYOKI-GENDO   +  5
           COMPUTE  WK-CYOKI-GENDO   =
                    WK-CYOKI-GENDO   /  10
           COMPUTE  WK-CYOKI-GENDO   =
                    WK-CYOKI-GENDO   *  10
           COMPUTE  WK-CYOKI-GENDO2  =
                    WK-CYOKI-GENDO2  +  5
           COMPUTE  WK-CYOKI-GENDO2  =
                    WK-CYOKI-GENDO2  /  10
           COMPUTE  WK-CYOKI-GENDO2  =
                    WK-CYOKI-GENDO2  *  10
      **
           IF   WK-KOH-GENDOGAKU-TOKU75  NOT = ZERO
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   WK-KOH-GENDOGAKU-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  WK-KOH-GENDOGAKU-TOKU75  =
                             WK-KOH-GENDOGAKU-TOKU75  *
                             WK-GENGAKU-RITUX         /
                             100
                  END-IF
                WHEN          2
                  IF  WK-KOH-GENDOGAKU-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   WK-KOH-GENDOGAKU-TOKU75
                  ELSE
                    COMPUTE  WK-KOH-GENDOGAKU-TOKU75   =
                             WK-KOH-GENDOGAKU-TOKU75   -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   WK-KOH-GENDOGAKU-TOKU75
                WHEN          5
                  IF  WK-KOH-GENDOGAKU-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  WK-KOH-GENDOGAKU-TOKU75   =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  WK-KOH-GENDOGAKU-TOKU75 =
                       WK-KOH-GENDOGAKU-TOKU75 +  5
              COMPUTE  WK-KOH-GENDOGAKU-TOKU75 =
                       WK-KOH-GENDOGAKU-TOKU75 /  10
              COMPUTE  WK-KOH-GENDOGAKU-TOKU75 =
                       WK-KOH-GENDOGAKU-TOKU75 *  10
           END-IF
      *
           IF   WK-GEN70-GENDOGAKU-TOKU75  NOT = ZERO
              IF   WK-GEN70-GENDOGAKU-TOKU75  = 40050
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                     END-IF
                   WHEN          2
                     IF  WK-GEN70-GENDOGAKU-TOKU75 < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                   WHEN          5
                     IF  WK-GEN70-GENDOGAKU-TOKU75 > WK-GENGAKU-KIN
                       MOVE   WK-GENGAKU-KIN
                                     TO   WK-GEN70-GENDOGAKU-TOKU75
                     END-IF
                 END-EVALUATE
              ELSE
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                     ELSE
                       COMPUTE  WK-GENGAKU-RITUX =
                                100 - WK-GENGAKU-RITU
                       COMPUTE  WK-GEN70-GENDOGAKU-TOKU75  =
                                WK-GEN70-GENDOGAKU-TOKU75  *
                                WK-GENGAKU-RITUX           /
                                100
                     END-IF
                   WHEN          2
                     IF  WK-GEN70-GENDOGAKU-TOKU75 < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                     ELSE
                       COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                                WK-GEN70-GENDOGAKU-TOKU75 -
                                WK-GENGAKU-KIN
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                   WHEN          5
                     IF  WK-GEN70-GENDOGAKU-TOKU75 > WK-GENGAKU-KIN
                       COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                                WK-GENGAKU-KIN
                     END-IF
                 END-EVALUATE
                 COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                          WK-GEN70-GENDOGAKU-TOKU75 +  5
                 COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                          WK-GEN70-GENDOGAKU-TOKU75 /  10
                 COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                          WK-GEN70-GENDOGAKU-TOKU75 *  10
              END-IF
           END-IF
      *
           EVALUATE   WK-GENGAKUKBN
             WHEN          1
               IF  WK-GENGAKU-RITU = 100
                 MOVE   ZERO   TO   WK-SEIHO-GENDO-TOKU75
                                    WK-SEIHO-GENDO70-TOKU75
                                    WK-CYOKI-GENDO-TOKU75
                                    WK-CYOKI-GENDO2-TOKU75
               ELSE
                 COMPUTE  WK-GENGAKU-RITUX =
                          100 - WK-GENGAKU-RITU
                 COMPUTE  WK-SEIHO-GENDO-TOKU75    =
                          WK-SEIHO-GENDO-TOKU75    *
                          WK-GENGAKU-RITUX         /
                          100
                 COMPUTE  WK-SEIHO-GENDO70-TOKU75  =
                          WK-SEIHO-GENDO70-TOKU75  *
                          WK-GENGAKU-RITUX         /
                          100
                 COMPUTE  WK-CYOKI-GENDO-TOKU75    =
                          WK-CYOKI-GENDO-TOKU75    *
                          WK-GENGAKU-RITUX         /
                          100
                 COMPUTE  WK-CYOKI-GENDO2-TOKU75   =
                          WK-CYOKI-GENDO2-TOKU75   *
                          WK-GENGAKU-RITUX         /
                          100
               END-IF
             WHEN          2
               IF  WK-SEIHO-GENDO-TOKU75 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-SEIHO-GENDO-TOKU75
               ELSE
                 COMPUTE  WK-SEIHO-GENDO-TOKU75  =
                          WK-SEIHO-GENDO-TOKU75  -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-SEIHO-GENDO70-TOKU75 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-SEIHO-GENDO70-TOKU75
               ELSE
                 COMPUTE  WK-SEIHO-GENDO70-TOKU75  =
                          WK-SEIHO-GENDO70-TOKU75  -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO-TOKU75 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-CYOKI-GENDO-TOKU75
               ELSE
                 COMPUTE  WK-CYOKI-GENDO-TOKU75    =
                          WK-CYOKI-GENDO-TOKU75    -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO2-TOKU75 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-CYOKI-GENDO2-TOKU75
               ELSE
                 COMPUTE  WK-CYOKI-GENDO2-TOKU75   =
                          WK-CYOKI-GENDO2-TOKU75   -
                          WK-GENGAKU-KIN
               END-IF
             WHEN          3
             WHEN          4
               MOVE     ZERO   TO   WK-SEIHO-GENDO-TOKU75
                                    WK-SEIHO-GENDO70-TOKU75
                                    WK-CYOKI-GENDO-TOKU75
                                    WK-CYOKI-GENDO2-TOKU75
             WHEN          5
               IF  WK-SEIHO-GENDO-TOKU75 > WK-GENGAKU-KIN
                 COMPUTE  WK-SEIHO-GENDO-TOKU75  =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-SEIHO-GENDO70-TOKU75 > WK-GENGAKU-KIN
                 COMPUTE  WK-SEIHO-GENDO70-TOKU75  =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO-TOKU75 > WK-GENGAKU-KIN
                 COMPUTE  WK-CYOKI-GENDO-TOKU75    =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO2-TOKU75 > WK-GENGAKU-KIN
                 COMPUTE  WK-CYOKI-GENDO2-TOKU75   =
                          WK-GENGAKU-KIN
               END-IF
           END-EVALUATE
           COMPUTE  WK-SEIHO-GENDO-TOKU75   =
                    WK-SEIHO-GENDO-TOKU75   +  5
           COMPUTE  WK-SEIHO-GENDO-TOKU75   =
                    WK-SEIHO-GENDO-TOKU75   /  10
           COMPUTE  WK-SEIHO-GENDO-TOKU75   =
                    WK-SEIHO-GENDO-TOKU75   *  10
           COMPUTE  WK-SEIHO-GENDO70-TOKU75 =
                    WK-SEIHO-GENDO70-TOKU75 +  5
           COMPUTE  WK-SEIHO-GENDO70-TOKU75 =
                    WK-SEIHO-GENDO70-TOKU75 /  10
           COMPUTE  WK-SEIHO-GENDO70-TOKU75 =
                    WK-SEIHO-GENDO70-TOKU75 *  10
           COMPUTE  WK-CYOKI-GENDO-TOKU75   =
                    WK-CYOKI-GENDO-TOKU75   +  5
           COMPUTE  WK-CYOKI-GENDO-TOKU75   =
                    WK-CYOKI-GENDO-TOKU75   /  10
           COMPUTE  WK-CYOKI-GENDO-TOKU75   =
                    WK-CYOKI-GENDO-TOKU75   *  10
           COMPUTE  WK-CYOKI-GENDO2-TOKU75  =
                    WK-CYOKI-GENDO2-TOKU75  +  5
           COMPUTE  WK-CYOKI-GENDO2-TOKU75  =
                    WK-CYOKI-GENDO2-TOKU75  /  10
           COMPUTE  WK-CYOKI-GENDO2-TOKU75  =
                    WK-CYOKI-GENDO2-TOKU75  *  10
      *
           .
      *
       2004X-KOHGENDO-GEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の判定
      *****************************************************************
       2005-TOKUSITU-HANTEI-SEC               SECTION.
      *
           MOVE     ZERO      TO    FLG-TOKUSITU
           MOVE     ZERO      TO    FLG-TOKUSITU-XXX
           MOVE     ZERO      TO    FLG-TOKUSITU-KBN
           IF   (LNK-SYU-SRYYMD(1:6)       >=  "200905" )
           AND  (COMB-HKNNUM            NOT =   SPACE   )
             IF (COMB-SYU-HKNKOHSBTKBN   =  "8" OR "9"  )
             OR (COMB-HKNNUM  =  "971" OR "973" OR "975"
                              OR "068" OR "069" OR "040")
             OR ((COMB-KOH1HKNNUM     =  "970"         ) AND
                 (FLG-DAISAN-GENBUTU  =   ZERO         ))
               CONTINUE
             ELSE
               MOVE   SPACE   TO    WK-KOH-FTNJANUM
               IF  ( COMB-KOH1HKNNUM = "051" OR "052" OR "091" )
               OR  ((COMB-KOH1HKNNUM      =  "054"            ) AND
                    (LNK-SYU-SRYYMD(1:6) >=  "201501"         ))
               OR  ( COMB-KOH2HKNNUM = "051" OR "091"          )
               OR  ((COMB-KOH2HKNNUM      =  "054"            ) AND
                    (LNK-SYU-SRYYMD(1:6) >=  "201501"         ))
               OR  ( WK-TOKATUKAI(1) =  1                      )
                  INITIALIZE                     PTKOHINF-REC
                  MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
                  MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
                  IF  ( COMB-KOH1HKNNUM = "051" OR "052" OR "091" )
                  OR  ((COMB-KOH1HKNNUM      =  "054"            ) AND
                       (LNK-SYU-SRYYMD(1:6) >=  "201501"         ))
                  OR  ( WK-TOKATUKAI(1) =  1                      )
                    MOVE  COMB-KOH1ID        TO  PTKOH-KOHID
                  ELSE
                    MOVE  COMB-KOH2ID        TO  PTKOH-KOHID
                  END-IF
                  MOVE    PTKOHINF-REC       TO  MCPDATA-REC
                  MOVE    "DBSELECT"         TO  MCP-FUNC
                  MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                  MOVE    "key8"             TO  MCP-PATHNAME
                  CALL    "ORCDBMAIN"        USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                  IF      MCP-RC  =  ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key8"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    IF       FLG-PTKOHINF    =   ZERO
                       MOVE  PTKOH-FTNJANUM  TO  WK-KOH-FTNJANUM
                    END-IF
                  END-IF
                  MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                  MOVE    "key8"             TO  MCP-PATHNAME
                  PERFORM  DB-CLOSE-SEC
               END-IF
               IF (((COMB-KOH1HKNNUM = "051" OR "091"      ) OR
                    (COMB-KOH2HKNNUM = "051" OR "091"      ) OR
                    (WK-TOKATUKAI(1) =  1                  )) AND
                   ( WK-KOH-FTNJANUM(5:3) = "601" OR "602"  ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "51"            ))
               OR (((COMB-KOH1HKNNUM = "052"               ) OR
                    (WK-TOKATUKAI(1) =  1                  )) AND
                   ( WK-KOH-FTNJANUM(5:2) = "60"            ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "52"            ) AND
                   ( LNK-SYU-SRYYMD(1:6) <= "201412"        ))
               OR (((COMB-KOH1HKNNUM = "052"               ) OR
                    (WK-TOKATUKAI(1) =  1                  )) AND
                   ( WK-KOH-FTNJANUM(5:2) = "80" OR "70"    ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "52"            ) AND
                   ( LNK-SYU-SRYYMD(1:6) >= "201501"        ))
               OR (((COMB-KOH1HKNNUM = "054"               ) OR
                    (COMB-KOH2HKNNUM = "054"               )) AND
                   ( WK-KOH-FTNJANUM(5:3) = "601" OR "501"
                                                  OR "602"  ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "54"            ) AND
                   ( LNK-SYU-SRYYMD(1:6) >= "201501"        ))
               OR (((COMB-KOH1HKNNUM = "054"               ) OR
                    (COMB-KOH2HKNNUM = "054"               )) AND
                   ( WK-KOH-FTNJANUM(5:1) = "7" OR "8"      ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "54"            ) AND
                   ( LNK-SYU-SRYYMD(1:6) >= "201804"        ))
               OR (  WK-KOHJGNGET-TEKIYOFLG(1) =  1          )
                 IF     FLG-KOUREI-KBN   =   "1"
                   IF    COMB-HOJOKBN    =   "3" OR "6" OR "7"
                         MOVE    1    TO   FLG-TOKUSITU
                   ELSE
                     IF  FLG-SANSHOU3    =   SPACE
                        MOVE     2    TO   FLG-TOKUSITU
                     ELSE
                        MOVE     3    TO   FLG-TOKUSITU
                     END-IF
                   END-IF
                 ELSE
                   PERFORM  20051-TOKUSITU-HENSYU-SEC
                 END-IF
                 IF   FLG-TOKUSITU  NOT = ZERO
                   MOVE       1         TO   FLG-TOKUSITU-XXX
                   IF     FLG-KOUREI-KBN   =   "1"
                     IF   LNK-SYU-TOTAL-HKNTEN  NOT = ZERO
                       MOVE   1         TO   LNK-SYU-SKJ-FTNDAY(3)
                     END-IF
                   ELSE
                     IF   LNK-SYU-TOTAL-HKNTEN  NOT = ZERO
                       MOVE  "1"        TO   LNK-S01-TOKUSYU-SAI-KBN
                       MOVE   1         TO   LNK-SYU-SKJ-FTNDAY(3)
                     END-IF
                   END-IF
                 END-IF
               ELSE
                 IF     FLG-KOUREI-KBN   =   "1"
                   CONTINUE
                 ELSE
                  IF    LNK-S01-TOKUSYU-SAI-KBN  =  "1"
                      PERFORM  20051-TOKUSITU-HENSYU-SEC
                  ELSE
                   INITIALIZE                      SSRHKOH-AREA
                   MOVE    LNK-SYU-PTID        TO  SSRHKOH-PTID
                   MOVE    LNK-SYU-NYUGAIKBN   TO  SSRHKOH-NYUGAIKBN
                   MOVE    LNK-SYU-SRYYMD(1:6) TO  SSRHKOH-SRYYM
                   MOVE    LNK-SYU-HKNCOMBINUM TO  SSRHKOH-HKNCOMBI
                   CALL    "ORCSSRHKOH"        USING
                                               SSRHKOH-AREA
                                               SPA-AREA
                   IF   SSRHKOH-RC  =  1
                      PERFORM  20051-TOKUSITU-HENSYU-SEC
                   END-IF
                  END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           MOVE     ZERO        TO   FLG-MARUKO
           IF  (WK-1001-PREFNUM  =  13            )
           AND (COMB-HKNNUM  NOT =  SPACE         )
           AND (COMB-HKNNUM  NOT = "060" AND "067")
           AND (COMB-KOH1HKNNUM  = "588"          )
           AND (LNK-SYU-SRYYMD(1:6) >= "200710"   )
           AND (LNK-SYU-SRYYMD(1:6) <= "200909"   )
                   MOVE    2    TO   FLG-MARUKO
           END-IF
      *
           .
       2005-TOKUSITU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集
      *****************************************************************
       20051-TOKUSITU-HENSYU-SEC               SECTION.
      *
           INITIALIZE                         PTKOHINF-REC
           MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
           MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
           MOVE    "966"                  TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC           TO  MCPDATA-REC
           MOVE    "DBSELECT"             TO  MCP-FUNC
           MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
           MOVE    "key4"                 TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"            USING  MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                  AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                  AND (PTKOH-SAKJOKBN   =  SPACE         )
                     MOVE    1    TO  FLG-TOKUSITU
                     IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                      IF  PTKOH-JKYSNUM(1:2) = "イ"
                       MOVE  12   TO  FLG-TOKUSITU-KBN
                      ELSE
                       MOVE  11   TO  FLG-TOKUSITU-KBN
                      END-IF
                     END-IF
                     MOVE    1    TO  FLG-PTKOHINF
                  ELSE
                     MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                     MOVE    "key4"          TO  MCP-PATHNAME
                     PERFORM  PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key4"             TO  MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           IF    FLG-TOKUSITU  =  ZERO
               INITIALIZE                         PTKOHINF-REC
               MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
               MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
               MOVE    "967"                  TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC           TO  MCPDATA-REC
               MOVE    "DBSELECT"             TO  MCP-FUNC
               MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
               MOVE    "key4"                 TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"            USING  MCPAREA
                                                     MCPDATA-REC
                                                     SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key4"             TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                   PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                      AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                      AND (PTKOH-SAKJOKBN   =  SPACE         )
                         IF  FLG-SANSHOU3    =   SPACE
                             MOVE    2    TO   FLG-TOKUSITU
                             IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                              IF  PTKOH-JKYSNUM(1:2) = "エ"
                               MOVE  22   TO   FLG-TOKUSITU-KBN
                              ELSE
                               MOVE  21   TO   FLG-TOKUSITU-KBN
                              END-IF
                             END-IF
                         ELSE
                             MOVE    3    TO   FLG-TOKUSITU
                             IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                               MOVE  31   TO   FLG-TOKUSITU-KBN
                             END-IF
                         END-IF
                         MOVE        1    TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                         MOVE    "key4"          TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                      END-IF
                   END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
           END-IF
      *
      ***
      *
           IF    FLG-TOKUSITU  =  ZERO
               INITIALIZE                         PTKOHINF-REC
               MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
               MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
               MOVE    "956"                  TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC           TO  MCPDATA-REC
               MOVE    "DBSELECT"             TO  MCP-FUNC
               MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
               MOVE    "key4"                 TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"            USING  MCPAREA
                                                     MCPDATA-REC
                                                     SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key4"             TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                   PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                      AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                      AND (PTKOH-SAKJOKBN   =  SPACE         )
                         MOVE    1    TO  FLG-TOKUSITU
                         IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                          IF  PTKOH-JKYSNUM(1:2) = "イ"
                           MOVE  12   TO  FLG-TOKUSITU-KBN
                          ELSE
                           MOVE  11   TO  FLG-TOKUSITU-KBN
                          END-IF
                         END-IF
                         MOVE    1    TO  FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                         MOVE    "key4"          TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                      END-IF
                   END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
           END-IF
      *
           IF    FLG-TOKUSITU  =  ZERO
               INITIALIZE                         PTKOHINF-REC
               MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
               MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
               MOVE    "957"                  TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC           TO  MCPDATA-REC
               MOVE    "DBSELECT"             TO  MCP-FUNC
               MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
               MOVE    "key4"                 TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"            USING  MCPAREA
                                                     MCPDATA-REC
                                                     SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key4"             TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                   PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                      AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                      AND (PTKOH-SAKJOKBN   =  SPACE         )
                         IF  FLG-SANSHOU3    =   SPACE
                             MOVE    2    TO   FLG-TOKUSITU
                             IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                              IF  PTKOH-JKYSNUM(1:2) = "エ"
                               MOVE  22   TO   FLG-TOKUSITU-KBN
                              ELSE
                               MOVE  21   TO   FLG-TOKUSITU-KBN
                              END-IF
                             END-IF
                         ELSE
                             MOVE    3    TO   FLG-TOKUSITU
                             IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                               MOVE  31   TO   FLG-TOKUSITU-KBN
                             END-IF
                         END-IF
                         MOVE        1    TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                         MOVE    "key4"          TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                      END-IF
                   END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
           END-IF
      *
           .
       20051-TOKUSITU-HENSYU-EXT.
           EXIT.
      *
      ***************************************************************
      *        患者保険情報検索
      ***************************************************************
       2006-PTHKNINF-KENSAKU-SEC           SECTION.
      *
           MOVE   ZERO               TO    FLG-SEISINJYO
                                           FLG-TOKUREI-HKNJYA
           MOVE   SPACE              TO    WK-HKNJANUM-TBL
           MOVE   SPACE              TO    WK-CONTKBN
           MOVE   SPACE              TO    WK-TOKU75-TEKSTYMD
           MOVE   SPACE              TO    WK-TOKU75-TEKEDYMD
      *
           INITIALIZE                      PTHKNINF-REC
           MOVE   COMB-HOSPNUM       TO    PTHKN-HOSPNUM
           MOVE   COMB-PTID          TO    PTHKN-PTID
           MOVE   COMB-HKNID         TO    PTHKN-HKNID
           MOVE   PTHKNINF-REC       TO    MCPDATA-REC
           MOVE   "DBSELECT"         TO    MCP-FUNC
           MOVE   "tbl_pthkninf"     TO    MCP-TABLE
           MOVE   "key"              TO    MCP-PATHNAME
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_pthkninf"     TO    MCP-TABLE
               MOVE    "key"              TO    MCP-PATHNAME
               PERFORM  PTHKNINF-READ-SEC
               IF      FLG-PTHKNINF   =     ZERO
                  IF   PTHKN-HKNJANUM      = "67330753"
                      MOVE    1      TO    FLG-TOKUREI-HKNJYA
                  END-IF
                  MOVE    PTHKN-HKNJANUM   TO    WK-HKNJANUM
                  MOVE    PTHKN-HONKZKKBN  TO    WK-HONKZKKBN
      ***         MOVE    PTHKN-KIGO       TO    WK-KIGO
      ***         MOVE    PTHKN-NUM        TO    WK-NUM
                  MOVE    PTHKN-CONTKBN    TO    WK-CONTKBN
                  MOVE    PTHKN-TEKSTYMD   TO    WK-TOKU75-TEKSTYMD
                  MOVE    PTHKN-TEKEDYMD   TO    WK-TOKU75-TEKEDYMD
               END-IF
           END-IF
      *
           MOVE     "tbl_pthkninf"   TO    MCP-TABLE
           MOVE     "key"            TO    MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
      *    法定外現物給付
           IF  (PTHKN-HKNJANUM   NOT =   SPACE    )
           AND (COMB-KOH1HKNNUM  =  "010" OR "021")
             IF     LNK-SYU-SRYYMD(1:6) >= "200804"
               INITIALIZE                   SYS-2012-REC
               MOVE    "2012"           TO  SYS-2012-KANRICD
               MOVE    PTHKN-HKNJANUM   TO  SYS-2012-KBNCD
               MOVE    LNK-SYU-HOSPNUM  TO  SYS-2012-HOSPNUM
               MOVE    LNK-SYU-SRYYMD   TO  SYS-2012-STYUKYMD
               MOVE    LNK-SYU-SRYYMD   TO  SYS-2012-EDYUKYMD
               MOVE    SYS-2012-REC     TO  MCPDATA-REC
               MOVE    "DBSELECT"       TO  MCP-FUNC
               MOVE    "tbl_syskanri"   TO  MCP-TABLE
               MOVE    "key10"          TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"  USING   MCPAREA
                                            MCPDATA-REC
                                            SPA-AREA
               IF      MCP-RC         =   ZERO
                  MOVE  "tbl_syskanri"  TO  MCP-TABLE
                  MOVE  "key10"         TO  MCP-PATHNAME
                  PERFORM      SYSKANRI-READ-SEC
               ELSE
                  INITIALIZE   SYS-2012-REC
               END-IF
               PERFORM   20061-HBTNUMKBN-HENSYU-SEC
               MOVE     "tbl_syskanri"  TO  MCP-TABLE
               MOVE     "key10"         TO  MCP-PATHNAME
               PERFORM      DB-CLOSE-SEC
             ELSE
               PERFORM   20062-HBTNUMKBN-HENSYU2-SEC
               PERFORM   20063-HBTNUMKBN-HENSYU3-SEC
             END-IF
           END-IF
      *
           .
      *
       2006-PTHKNINF-KENSAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    法定外現物給付の設定編集
      ******************************************************************
       20061-HBTNUMKBN-HENSYU-SEC          SECTION.
      *
           IF   COMB-KOH1HKNNUM  =  "010"
             EVALUATE  SYS-2012-HBTNUM10KBN
               WHEN      SPACE
                 PERFORM   20062-HBTNUMKBN-HENSYU2-SEC
                 PERFORM   20063-HBTNUMKBN-HENSYU3-SEC
               WHEN      "0"
      ******     システム管理２０１２デフォルト設定なしの為
      ******     救済措置
                 PERFORM   20063-HBTNUMKBN-HENSYU3-SEC
               WHEN      "1"
                 MOVE       1     TO    FLG-SEISINJYO
             END-EVALUATE
           END-IF
      *
           IF   COMB-KOH1HKNNUM  =  "021"
             EVALUATE  SYS-2012-HBTNUM21KBN
               WHEN      SPACE
                 PERFORM   20062-HBTNUMKBN-HENSYU2-SEC
                 PERFORM   20063-HBTNUMKBN-HENSYU3-SEC
               WHEN      "0"
      ******     システム管理２０１２デフォルト設定なしの為
      ******     救済措置
                 PERFORM   20063-HBTNUMKBN-HENSYU3-SEC
               WHEN      "1"
                 MOVE       1     TO    FLG-SEISINJYO
             END-EVALUATE
           END-IF
      *
           .
      *
       20061-HBTNUMKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    法定外現物給付の設定編集２
      ******************************************************************
       20062-HBTNUMKBN-HENSYU2-SEC          SECTION.
      *
           CONTINUE
      *
           .
      *
       20062-HBTNUMKBN-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *    法定外現物給付の設定編集３
      ******************************************************************
       20063-HBTNUMKBN-HENSYU3-SEC          SECTION.
      *
           IF ((PTHKN-HKNJANUM(1:6)  =  "233064" OR "133280") AND
               (LNK-SYU-SRYYMD(1:6) <=  "201103"            ))
           OR ((PTHKN-HKNJANUM(1:6)  =  "283077"            ) AND
               (LNK-SYU-SRYYMD(1:6) <=  "201111"            ))
           OR ((PTHKN-HKNJANUM(1:6)  =
                "133033" OR "133041" OR "133066" OR "133074" OR
                "133090" OR "133116" OR "133132" OR "133140" OR
                "133157" OR "133165" OR "133173" OR "133181" OR
                "133199" OR "133207" OR "133223" OR "133249" OR
                "133256" OR "133272"                        ) AND
               (LNK-SYU-SRYYMD(1:6) <=  "201203"            ))
              IF  (WK-1001-PREFNUM     =  29     )
              AND (PTHKN-HKNJANUM(1:6) = "133033")
                CONTINUE
              ELSE
                IF   COMB-KOH1HKNNUM  =  "010" OR "021"
                    MOVE    1      TO    FLG-SEISINJYO
                END-IF
              END-IF
           END-IF
      *
           .
      *
       20063-HBTNUMKBN-HENSYU3-EXT.
           EXIT.
      *
      ******************************************************************
      *    地方公費の上限額入力対象区分編集                            *
      ******************************************************************
       2007-TAISYOKBN-HENSYU-SEC           SECTION.
      *
           INITIALIZE        WK-TOKATUKAI-TBL
           IF ((WK-1001-PREFNUM      =  13     ) AND
               (COMB-KOH1HKNNUM      = "151"   ) AND
               (LNK-SYU-SRYYMD(1:6) >= "200905"))
           OR ((WK-1001-PREFNUM      =  23     ) AND
               (COMB-KOH1HKNNUM      = "191"   ) AND
               (LNK-SYU-SRYYMD(1:6) >= "200910"))
           OR ((WK-1001-PREFNUM   =  23 OR 24  ) AND
               (COMB-KOH1HKNNUM      = "152"   ) AND
               (LNK-SYU-SRYYMD(1:6) >= "201104"))
               MOVE    1     TO    WK-TOKATUKAI(1)
           END-IF
      *
           INITIALIZE        WK-KOHJGNGET-TBL
           PERFORM   VARYING   IDX-CYO   FROM    1   BY  1
                      UNTIL    IDX-CYO     >     4
             IF   COMB-KOHHKNNUM(IDX-CYO)(1:1)  >=  "1" AND <=  "8"
                INITIALIZE                    PTKOHINF-REC
                MOVE  LNK-SYU-HOSPNUM     TO  PTKOH-HOSPNUM
                MOVE  LNK-SYU-PTID        TO  PTKOH-PTID
                MOVE  COMB-KOHID(IDX-CYO) TO  PTKOH-KOHID
                MOVE  PTKOHINF-REC        TO  MCPDATA-REC
                MOVE  "DBSELECT"          TO  MCP-FUNC
                MOVE  "tbl_ptkohinf"      TO  MCP-TABLE
                MOVE  "key8"              TO  MCP-PATHNAME
                CALL  "ORCDBMAIN"         USING  MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
                IF    MCP-RC              =   ZERO
                  MOVE  "tbl_ptkohinf"    TO  MCP-TABLE
                  MOVE  "key8"            TO  MCP-PATHNAME
                  PERFORM  PTKOHINF-READ-SEC
                  IF    FLG-PTKOHINF  =   ZERO
                     MOVE   PTKOH-TEKSTYMD
                                TO  WK-KOHJGNGET-TEKSTYMD(IDX-CYO)
                  END-IF
                END-IF
                MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
                MOVE    "key8"            TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
      *
                INITIALIZE                    LNK-ORCSJGNGET-REC
                MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
                MOVE  COMB-KOHHKNNUM(IDX-CYO)
                                          TO  LNK-ORCSJGNGET-KOHHKNNUM
                MOVE  WK-KOHJGNGET-TEKSTYMD(IDX-CYO)
                                          TO  LNK-ORCSJGNGET-TEKSTYMD
                MOVE  WK-1001-PREFNUM     TO  LNK-ORCSJGNGET-PREFNUM
                MOVE   "1"                TO  LNK-ORCSJGNGET-HENFLG
                CALL  "ORCSJGNGET"        USING
                                          LNK-ORCSJGNGET-REC
                                          SPA-AREA
                IF    LNK-ORCSJGNGET-RC   =   ZERO
                   MOVE   LNK-ORCSJGNGET-TAISYOKBN
                                TO  WK-KOHJGNGET-TAISYOKBN(IDX-CYO)
                   IF  (LNK-SYU-SRYYMD(1:6)     >=  "201501")
                   AND (IDX-CYO                  =   1      )
                   AND (LNK-ORCSJGNGET-TEKIYOFLG =   1      )
                   AND (WK-TOKATUKAI(IDX-CYO)    =   ZERO   )
                     MOVE   1   TO  WK-KOHJGNGET-TEKIYOFLG(IDX-CYO)
      ***************MOVE   1   TO  WK-TOKATUKAI(IDX-CYO)
                   END-IF
                END-IF
             END-IF
           END-PERFORM
      *
           .
      *
       2007-TAISYOKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    システム管理２０１０の編集                                  *
      ******************************************************************
       2008-SYSKAN2010-HENSYU-SEC           SECTION.
      *
           INITIALIZE        WK-SYS2010-TBL
           PERFORM   VARYING   IDX-CYO   FROM    1   BY  1
                      UNTIL    IDX-CYO     >     4
             IF   COMB-KOHHKNNUM(IDX-CYO)(1:1)  >=  "1" AND <=  "8"
               IF     LNK-SYU-SRYYMD(1:6) >= "200804"
                 INITIALIZE                   SYS-2010-REC
                 MOVE    "2010"           TO  SYS-2010-KANRICD
                 MOVE    COMB-KOHHKNNUM(IDX-CYO)
                                          TO  SYS-2010-KBNCD
                 MOVE    LNK-SYU-HOSPNUM  TO  SYS-2010-HOSPNUM
                 MOVE    LNK-SYU-SRYYMD   TO  SYS-2010-STYUKYMD
                 MOVE    LNK-SYU-SRYYMD   TO  SYS-2010-EDYUKYMD
                 MOVE    SYS-2010-REC     TO  MCPDATA-REC
                 MOVE    "DBSELECT"       TO  MCP-FUNC
                 MOVE    "tbl_syskanri"   TO  MCP-TABLE
                 MOVE    "key10"          TO  MCP-PATHNAME
                 CALL    "ORCDBMAIN"  USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
                 IF      MCP-RC         =   ZERO
                    MOVE  "tbl_syskanri"  TO  MCP-TABLE
                    MOVE  "key10"         TO  MCP-PATHNAME
                    PERFORM      SYSKANRI-READ-SEC
                 ELSE
                    INITIALIZE   SYS-2010-REC
                 END-IF
                 PERFORM   20081-SYSKAN2010-SET-SEC
                 MOVE     "tbl_syskanri"  TO  MCP-TABLE
                 MOVE     "key10"         TO  MCP-PATHNAME
                 PERFORM   DB-CLOSE-SEC
               ELSE
                 PERFORM   20082-SYSKAN2010-SET2-SEC
                 PERFORM   20083-SYSKAN2010-SET3-SEC
                 PERFORM   20084-SYSKAN2010-SET4-SEC
               END-IF
               IF  WK-2010-IRYOKEIKBN-G(IDX-CYO) = "1"
                 PERFORM   20089-KIZONHKNNUM-CHECK-SEC
               END-IF
               PERFORM     2008A-SYSKAN2010-KURIA-SEC
             END-IF
           END-PERFORM
      *
           .
      *
       2008-SYSKAN2010-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    システム管理２０１０のセット                                *
      ******************************************************************
       20081-SYSKAN2010-SET-SEC           SECTION.
      *
           EVALUATE  SYS-2010-JGNFTNKBN
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       42
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =  "180"
                     MOVE    "1"    TO  WK-2010-JGNFTNKBN(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-JGNFTNKBN(IDX-CYO)
           END-EVALUATE
      *
           MOVE      SYS-2010-JYUHENKBN
                                    TO  WK-2010-JYUHENKBN(IDX-CYO)
           MOVE      SYS-2010-JYUHEN-TAIKBN
                                    TO  WK-2010-JYUHEN-TAIKBN(IDX-CYO)
      *
           EVALUATE  SYS-2010-IRYOKEIKBN-G
             WHEN      SPACE
               PERFORM    20082-SYSKAN2010-SET2-SEC
             WHEN       "1"
               EVALUATE   SYS-2010-IRYOKEI-TAIKBN-G
                 WHEN      "0"
                     MOVE    "1"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
                 WHEN      "1"
                     IF    FLG-SANSHOU2   = "2"  OR  "3"
                       MOVE  "1"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
                     END-IF
               END-EVALUATE
             WHEN       "2"
               EVALUATE   SYS-2010-IRYOKEI-TAIKBN-G
                 WHEN      "0"
                     MOVE    "2"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
                 WHEN      "1"
                     IF    FLG-SANSHOU2   = "2"  OR  "3"
                       MOVE  "2"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
                     END-IF
               END-EVALUATE
             WHEN       "3"
               EVALUATE   SYS-2010-IRYOKEI-TAIKBN-G
                 WHEN      "0"
                     MOVE    "3"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
                 WHEN      "1"
                     IF    FLG-SANSHOU2   = "2"  OR  "3"
                       MOVE  "3"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
                     END-IF
               END-EVALUATE
             WHEN       "4"
               EVALUATE   SYS-2010-IRYOKEI-TAIKBN-G
                 WHEN      "0"
                     MOVE    "4"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
                 WHEN      "1"
                     IF    FLG-SANSHOU2   = "2"  OR  "3"
                       MOVE  "4"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
                     END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KINJYOKBN-G
             WHEN      SPACE
               PERFORM    20084-SYSKAN2010-SET4-SEC
             WHEN       "0"
                 IF ((WK-1001-PREFNUM         =   33     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =  "285"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200110" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200609" ))
                       MOVE  "1"    TO  WK-2010-KINJYOKBN-G(IDX-CYO)
                 END-IF
             WHEN       "1"
                       MOVE  "1"    TO  WK-2010-KINJYOKBN-G(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAICNTKBN-G
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       27
                   IF   COMB-KOHHKNNUM(IDX-CYO) NOT = "100" AND "200"
                     MOVE    "1"    TO  WK-2010-KAICNTKBN-G(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-KAICNTKBN-G(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-CYOKEIKBN-G
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       27
                   IF   COMB-KOHHKNNUM(IDX-CYO) NOT = "100" AND "200"
                     MOVE    "1"    TO  WK-2010-CYOKEIKBN-G(IDX-CYO)
                   END-IF
                 WHEN       34
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                            "191" OR "291" OR "491"
                     MOVE    "4"    TO  WK-2010-CYOKEIKBN-G(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-CYOKEIKBN-G(IDX-CYO)
             WHEN       "2"
                     MOVE    "2"    TO  WK-2010-CYOKEIKBN-G(IDX-CYO)
             WHEN       "3"
                     MOVE    "3"    TO  WK-2010-CYOKEIKBN-G(IDX-CYO)
             WHEN       "4"
                     MOVE    "4"    TO  WK-2010-CYOKEIKBN-G(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-GNBKEIKBN-K-G
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       34
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                            "191" OR "291" OR "491"
                     MOVE    "1"    TO  WK-2010-GNBKEIKBN-K-G(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-GNBKEIKBN-K-G(IDX-CYO)
             WHEN       "2"
                     MOVE    "2"    TO  WK-2010-GNBKEIKBN-K-G(IDX-CYO)
           END-EVALUATE
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "200904"
             EVALUATE  SYS-2010-ZENKEIKBN-G
               WHEN      SPACE
                 EVALUATE   WK-1001-PREFNUM
                   WHEN       13
                     IF   COMB-KOHHKNNUM(IDX-CYO)  =  "588"
                       IF   LNK-SYU-SRYYMD(1:6)  <= "201509"
                         MOVE  "1"    TO  WK-2010-ZENKEIKBN-G(IDX-CYO)
                       END-IF
                     ELSE
                       IF   LNK-SYU-SRYYMD(1:6)  <= "201412"
                         MOVE  "1"    TO  WK-2010-ZENKEIKBN-G(IDX-CYO)
                       END-IF
                     END-IF
                   WHEN       26
                   WHEN       33
                       MOVE    "1"    TO  WK-2010-ZENKEIKBN-G(IDX-CYO)
                   WHEN       43
                     IF   LNK-SYU-SRYYMD(1:6)  >= "200912"
                       MOVE    "1"    TO  WK-2010-ZENKEIKBN-G(IDX-CYO)
                     END-IF
                 END-EVALUATE
               WHEN       "0"
                 EVALUATE   WK-1001-PREFNUM
                   WHEN       13
                     IF   COMB-KOHHKNNUM(IDX-CYO)  =  "588"
                       IF   LNK-SYU-SRYYMD(1:6)  <= "201509"
                         MOVE  "1"    TO  WK-2010-ZENKEIKBN-G(IDX-CYO)
                       END-IF
                     ELSE
                       IF   LNK-SYU-SRYYMD(1:6)  <= "201412"
                         MOVE  "1"    TO  WK-2010-ZENKEIKBN-G(IDX-CYO)
                       END-IF
                     END-IF
                 END-EVALUATE
               WHEN       "1"
                       MOVE    "1"    TO  WK-2010-ZENKEIKBN-G(IDX-CYO)
             END-EVALUATE
           END-IF
      *
           EVALUATE  SYS-2010-SINKEIKBN-G
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       08
                   IF   LNK-SYU-SRYYMD(1:6)      >=  "201103"
                     MOVE    "1"    TO  WK-2010-SINKEIKBN-G(IDX-CYO)
                   END-IF
                 WHEN       13
                   IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "588"   )
                   AND (LNK-SYU-SRYYMD(1:6)      >=  "200910")
                     MOVE    "1"    TO  WK-2010-SINKEIKBN-G(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-SINKEIKBN-G(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-SYOKEIKBN-G
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       01
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                   "142" OR "143" OR "144" OR "364"
                                         OR "190" OR "291" OR "292"
                     MOVE    "1"    TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
                   END-IF
                 WHEN       04
                   IF  (COMB-KOHHKNNUM(IDX-CYO)   =
                                   "263" OR "363" OR "463" OR "563")
                   AND (LNK-SYU-SRYYMD(1:6)      >= "201201"       )
                     MOVE    "1"    TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
                   END-IF
                 WHEN       34
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =  "390"
                     MOVE    "1"    TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
           END-EVALUATE
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201010"
             EVALUATE  SYS-2010-NINNASIKBN
               WHEN      SPACE
                 EVALUATE   WK-1001-PREFNUM
                   WHEN       04
                     IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                              "583" OR "683" OR "783"
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "363" OR "563")
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201201"       )
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "263" OR "463")
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201201"       )
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                         MOVE  "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                     END-IF
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "763"         )
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201310"       )
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "663"         )
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201310"       )
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                         MOVE  "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                     END-IF
                   WHEN       10
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =
                                              "145" OR "245" OR "146"
                                           OR "246" OR "143" OR "243")
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201104"       )
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                       OR ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  "8"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                     END-IF
                   WHEN       11
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "772"         )
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201304"       )
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                   WHEN       12
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =
                                              "263" OR "363" OR "463")
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201203"       )
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                   WHEN       40
                     IF   COMB-KOHHKNNUM(IDX-CYO)   =  "383"
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                   WHEN       44
                     IF   COMB-KOHHKNNUM(IDX-CYO)   =  "183" OR "283"
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                 END-EVALUATE
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
               WHEN       "5"
               WHEN       "6"
               WHEN       "7"
               WHEN       "8"
                 EVALUATE   SYS-2010-NINNASI-TAIKBN
                   WHEN      "0"
                       MOVE  SYS-2010-NINNASIKBN
                                      TO  WK-2010-NINNASIKBN(IDX-CYO)
                   WHEN      "1"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                       OR ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINNASIKBN
                                      TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                   WHEN      "2"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                         MOVE  SYS-2010-NINNASIKBN
                                      TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                   WHEN      "3"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINNASIKBN
                                      TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201104"
             EVALUATE  SYS-2010-NINJYOKBN
               WHEN      SPACE
               WHEN       "0"
                 EVALUATE   WK-1001-PREFNUM
                   WHEN       10
                     IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                              "145" OR "245" OR "146"
                                           OR "246" OR "143" OR "243"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                       OR ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         IF   LNK-SYU-SRYYMD(1:6) <= "201412"
                           MOVE  "2"    TO  WK-2010-NINJYOKBN(IDX-CYO)
                         END-IF
                       END-IF
                     END-IF
                 END-EVALUATE
               WHEN       "1"
               WHEN       "2"
                 EVALUATE   SYS-2010-NINJYO-TAIKBN
                   WHEN      "0"
                       MOVE  SYS-2010-NINJYOKBN
                                      TO  WK-2010-NINJYOKBN(IDX-CYO)
                   WHEN      "1"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                       OR ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINJYOKBN
                                      TO  WK-2010-NINJYOKBN(IDX-CYO)
                       END-IF
                   WHEN      "2"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                         MOVE  SYS-2010-NINJYOKBN
                                      TO  WK-2010-NINJYOKBN(IDX-CYO)
                       END-IF
                   WHEN      "3"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINJYOKBN
                                      TO  WK-2010-NINJYOKBN(IDX-CYO)
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201204"
             EVALUATE  SYS-2010-KOGAKKEIKBN
               WHEN       "1"
                 EVALUATE   SYS-2010-KOGAKKEI-TAIKBN
                   WHEN      "0"
                       MOVE    "1"    TO  WK-2010-KOGAKKEIKBN(IDX-CYO)
                   WHEN      "1"
                       IF   LNK-SYU-SYUHKNNUM = "060" OR "067" OR "039"
                         MOVE  "1"    TO  WK-2010-KOGAKKEIKBN(IDX-CYO)
                       END-IF
                   WHEN      "2"
                       IF  (LNK-SYU-SYUHKNNUM  NOT = SPACE)
                       AND (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039")
                         MOVE  "1"    TO  WK-2010-KOGAKKEIKBN(IDX-CYO)
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           EVALUATE  SYS-2010-INNAIKBN
             WHEN      "1"
                 MOVE    "1"          TO  WK-2010-INNAIKBN(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-JIRITUKBN
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       12
                 WHEN       14
                 WHEN       26
                 WHEN       27
                 WHEN       28
                 WHEN       39
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =  "100" OR "200"
                     MOVE    "1"    TO  WK-2010-JIRITUKBN(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-JIRITUKBN(IDX-CYO)
           END-EVALUATE
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201501"
             EVALUATE  SYS-2010-ZENKEI2KBN-G
               WHEN     "1"
                 EVALUATE   SYS-2010-ZENKEI2-TAIKBN-G
                   WHEN      "0"
                     MOVE    "1"    TO  WK-2010-ZENKEI2KBN-G(IDX-CYO)
                   WHEN      "1"
                     IF   LNK-SYU-SYUHKNNUM = "060" OR "067" OR "039"
                       MOVE  "1"    TO  WK-2010-ZENKEI2KBN-G(IDX-CYO)
                     END-IF
                   WHEN      "2"
                     IF   LNK-SYU-SYUHKNNUM = "060" OR "067" OR "039"
                       CONTINUE
                     ELSE
                       MOVE  "1"    TO  WK-2010-ZENKEI2KBN-G(IDX-CYO)
                     END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           EVALUATE  SYS-2010-SYOKEI2KBN-G
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       01
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                   "642" OR "643" OR "644" OR "743"
                     MOVE    "1"    TO  WK-2010-SYOKEI2KBN-G(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-SYOKEI2KBN-G(IDX-CYO)
           END-EVALUATE
      *
           .
      *
       20081-SYSKAN2010-SET-EXT.
           EXIT.
      *
      ******************************************************************
      *    システム管理２０１０のセット２                              *
      ******************************************************************
       20082-SYSKAN2010-SET2-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       07
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "245"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200412" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "246"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "445" OR "545"
                                            OR "645"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
               END-IF
             WHEN       11
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "343" OR "342"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200507" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "344"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200507" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "181" OR "182" OR "183" OR "281"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200704" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "543" OR "582"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200710" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "381"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200801" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "481" OR "482" OR "743" OR "442"
                                            OR "542"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "483"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "383"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201001" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "681" OR "682"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "781"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "783"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201004" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "372" OR "373"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201101" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "462" OR "562" OR "662" OR "762"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201112" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
               END-IF
             WHEN       43
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "341" OR "442"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200912" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           .
      *
       20082-SYSKAN2010-SET2-EXT.
           EXIT.
      *
      ******************************************************************
      *    システム管理２０１０のセット３                              *
      ******************************************************************
       20083-SYSKAN2010-SET3-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       27
               IF   COMB-KOHHKNNUM(IDX-CYO) NOT = "100" AND "200"
                 MOVE    "1"    TO  WK-2010-KAICNTKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       27
               IF   COMB-KOHHKNNUM(IDX-CYO) NOT = "100" AND "200"
                 MOVE    "1"    TO  WK-2010-CYOKEIKBN-G(IDX-CYO)
               END-IF
             WHEN       34
               IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                        "191" OR "291" OR "491"
                 MOVE    "4"    TO  WK-2010-CYOKEIKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       01
               IF  (COMB-KOHHKNNUM(IDX-CYO)   =
                               "142" OR "143" OR "144" OR "364")
               AND (LNK-SYU-SRYYMD(1:6)      >= "200410"       )
                 MOVE    "1"    TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
               END-IF
               IF  (COMB-KOHHKNNUM(IDX-CYO)   =
                                        "190" OR "291" OR "292")
               AND (LNK-SYU-SRYYMD(1:6)      >= "200708"       )
                 MOVE    "1"    TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
               END-IF
             WHEN       34
               IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "390"         )
               AND (LNK-SYU-SRYYMD(1:6)      >= "200410"       )
                 MOVE    "1"    TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       12
             WHEN       14
             WHEN       26
             WHEN       27
             WHEN       28
             WHEN       39
               IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "100" OR "200")
               AND (LNK-SYU-SRYYMD(1:6)      >= "200604"       )
                 MOVE    "1"    TO  WK-2010-JIRITUKBN(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE  SYS-2010-SYOKEI2KBN-G
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       01
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                   "642" OR "643" OR "644" OR "743"
                     MOVE    "1"    TO  WK-2010-SYOKEI2KBN-G(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-SYOKEI2KBN-G(IDX-CYO)
           END-EVALUATE
      *
           .
      *
       20083-SYSKAN2010-SET3-EXT.
           EXIT.
      *
      ******************************************************************
      *    システム管理２０１０のセット４                              *
      ******************************************************************
       20084-SYSKAN2010-SET4-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       13
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "182" OR "382"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                 MOVE    "1"    TO  WK-2010-KINJYOKBN-G(IDX-CYO)
               END-IF
             WHEN       14
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "182"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                 MOVE    "1"    TO  WK-2010-KINJYOKBN-G(IDX-CYO)
               END-IF
             WHEN       33
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "285"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200110" ) AND
                   (LNK-SYU-SRYYMD(1:6)    <= "200609" ))
                 MOVE    "1"    TO  WK-2010-KINJYOKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           .
      *
       20084-SYSKAN2010-SET4-EXT.
           EXIT.
      *
      ******************************************************************
      *    既存分保険番号チェック                                      *
      ******************************************************************
       20089-KIZONHKNNUM-CHECK-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       07
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "245"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200412" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "246"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "445" OR "545"
                                            OR "645"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-G-XXX(IDX-CYO)
               END-IF
             WHEN       11
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "343" OR "342"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200507" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "344"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200507" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "181" OR "182" OR "183" OR "281"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200704" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "543" OR "582"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200710" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "381"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200801" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "481" OR "482" OR "743" OR "442"
                                            OR "542"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "483"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "383"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201001" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "681" OR "682"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "781"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "783"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201004" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "372" OR "373"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201101" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "462" OR "562" OR "662" OR "762"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201112" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-G-XXX(IDX-CYO)
               END-IF
             WHEN       43
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "341" OR "442"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200912" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-G-XXX(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           .
      *
       20089-KIZONHKNNUM-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *    システム管理２０１０のセットクリア                          *
      ******************************************************************
       2008A-SYSKAN2010-KURIA-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       07
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "245"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200412" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "246"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "445" OR "545"
                                            OR "645"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201210" ))
                 MOVE    SPACE  TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
               END-IF
             WHEN       11
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "343" OR "342"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200507" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "344"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200507" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "181" OR "182" OR "183" OR "281"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200704" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "543" OR "582"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200710" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "381"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200801" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "481" OR "482" OR "743" OR "442"
                                            OR "542"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "483"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "383"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201001" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "681" OR "682"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "781"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "783"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201004" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "372" OR "373"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201101" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "462" OR "562" OR "662" OR "762"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201112" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201210" ))
                 MOVE    SPACE  TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
               END-IF
             WHEN       43
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "341" OR "442"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200912" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201210" ))
                 MOVE    SPACE  TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
           IF    FLG-FTNRATE100 = IDX-CYO
                 MOVE    SPACE  TO  WK-2010-IRYOKEIKBN-G(IDX-CYO)
           END-IF
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       13
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "182" OR "382"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200610" ))
                 MOVE    SPACE  TO  WK-2010-KINJYOKBN-G(IDX-CYO)
               END-IF
             WHEN       14
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "182"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200610" ))
                 MOVE    SPACE  TO  WK-2010-KINJYOKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
           IF    FLG-FTNRATE100 = IDX-CYO
                 MOVE    SPACE  TO  WK-2010-KINJYOKBN-G(IDX-CYO)
           END-IF
      *
           IF   (WK-2010-IRYOKEIKBN-G(IDX-CYO)  NOT = SPACE)
           AND  (WK-2010-KINJYOKBN-G(IDX-CYO)   NOT = SPACE)
                 MOVE    SPACE  TO  WK-2010-KINJYOKBN-G(IDX-CYO)
           END-IF
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       43
               IF   LNK-SYU-SRYYMD(1:6)     < "200912"
                 MOVE    SPACE  TO  WK-2010-ZENKEIKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
           IF   (WK-2010-IRYOKEIKBN-G(IDX-CYO)  NOT = SPACE)
           OR   (WK-2010-KINJYOKBN-G(IDX-CYO)   NOT = SPACE)
                 MOVE    SPACE  TO  WK-2010-ZENKEIKBN-G(IDX-CYO)
           END-IF
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       08
               IF   LNK-SYU-SRYYMD(1:6)     < "201103"
                 MOVE    SPACE  TO  WK-2010-SINKEIKBN-G(IDX-CYO)
               END-IF
             WHEN       13
               IF  (COMB-KOHHKNNUM(IDX-CYO) =  "588"  )
               AND (LNK-SYU-SRYYMD(1:6)     < "200910")
                 MOVE    SPACE  TO  WK-2010-SINKEIKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       01
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                      "142" OR "143" OR "144" OR "364")
               AND (LNK-SYU-SRYYMD(1:6)     < "200410")
                 MOVE    SPACE  TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
               END-IF
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                               "190" OR "291" OR "292")
               AND (LNK-SYU-SRYYMD(1:6)     < "200708")
                 MOVE    SPACE  TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
               END-IF
             WHEN       04
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                      "263" OR "363" OR "463" OR "563")
               AND (LNK-SYU-SRYYMD(1:6)     < "201201")
                 MOVE    SPACE  TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
               END-IF
             WHEN       34
               IF  (COMB-KOHHKNNUM(IDX-CYO) =  "390"  )
               AND (LNK-SYU-SRYYMD(1:6)     < "200410")
                 MOVE    SPACE  TO  WK-2010-SYOKEIKBN-G(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       04
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                      "363" OR "563" OR "263" OR "463")
               AND (LNK-SYU-SRYYMD(1:6)     < "201201")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                                        "663" OR "763")
               AND (LNK-SYU-SRYYMD(1:6)     < "201310")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
             WHEN       10
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                               "145" OR "245" OR "146"
                            OR "246" OR "143" OR "243")
               AND (LNK-SYU-SRYYMD(1:6)     < "201104")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
             WHEN       11
               IF  (COMB-KOHHKNNUM(IDX-CYO) =  "772"  )
               AND (LNK-SYU-SRYYMD(1:6)     < "201304")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
             WHEN       12
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                               "263" OR "363" OR "463")
               AND (LNK-SYU-SRYYMD(1:6)     < "201203")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       12
             WHEN       14
             WHEN       26
             WHEN       27
             WHEN       28
             WHEN       39
               IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "100" OR "200")
               AND (LNK-SYU-SRYYMD(1:6)       <  "200604"      )
                 MOVE    SPACE  TO  WK-2010-JIRITUKBN(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           .
      *
       2008A-SYSKAN2010-KURIA-EXT.
           EXIT.
      *
      ******************************************************************
      *        保険・公費の設定上限回数と上限金額の取得                *
      ******************************************************************
       210-HOKEN-KAISU-SEC           SECTION.
      *
           INITIALIZE       WK-CHIHOU-FLG-TAIHI-AREA.
      *
           PERFORM    210B-TOKU75-SETTEI-SEC.
      *
           MOVE      ZERO      TO      WK-KANAGAWA41-FTNRATE.
      *
           MOVE      ZERO      TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX9    FROM    1   BY  1
                     UNTIL     IDX9       >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                            (LNK-SYU-HKNTEN (IDX9) *  10)
           END-PERFORM.
      *
           MOVE     ZERO         TO   FLG-IKTKEISANKBN.
           IF    LNK-SYU-SRYYMD(1:6)   >=  "200804"
             PERFORM   VARYING   IDX-CYO   FROM    1   BY  1
                        UNTIL    IDX-CYO     >     4
                IF ( WK-2010-IRYOKEIKBN-G(IDX-CYO)
                                         NOT = SPACE          )
                OR ((WK-1001-PREFNUM         =  43           ) AND
                    (COMB-KOHHKNNUM(IDX-CYO) = "143" OR "342") AND
                    (LNK-SYU-SRYYMD(1:6)    >= "200912"      ))
                OR ((WK-1001-PREFNUM         =  43           ) AND
                    (COMB-KOHHKNNUM(IDX-CYO) = "443"         ) AND
                    (LNK-SYU-SRYYMD(1:6)    >= "201608"      ))
                  MOVE     1     TO   FLG-IKTKEISANKBN
                END-IF
             END-PERFORM
           END-IF.
      *
           IF ((COMB-KOH1HKNNUM       NOT =  SPACE )  AND
               (COMB-KOH1-GAIJGNKBN       =   "1"  ))
           OR ((COMB-KOH2HKNNUM       NOT =  SPACE )  AND
               (COMB-KOH2-GAIJGNKBN       =   "1"  ))
           OR ((COMB-KOH3HKNNUM       NOT =  SPACE )  AND
               (COMB-KOH3-GAIJGNKBN       =   "1"  ))
           OR ((COMB-KOH4HKNNUM       NOT =  SPACE )  AND
               (COMB-KOH4-GAIJGNKBN       =   "1"  ))
               PERFORM    2102-SHOHOUSEN-HANTEI-SEC
           END-IF.
      *
           INITIALIZE        WK-CYO-OKIKAE-TBL.
           IF    LNK-SYU-SRYYMD(1:6)   >=  "200905"
             PERFORM   VARYING   IDX-CYO   FROM    1   BY  1
                        UNTIL    IDX-CYO     >     4
               IF   COMB-KOHHKNNUM(IDX-CYO)(1:1)  >=  "1" AND <=  "8"
                  IF ( WK-2010-IRYOKEIKBN-G(IDX-CYO)
                                                   =  "1" OR "2")
                  OR ( WK-KOHJGNGET-TAISYOKBN(IDX-CYO)
                                               NOT =  ZERO      )
                  OR ( WK-2010-KINJYOKBN-G(IDX-CYO)   =  "1"    )
                  OR ((WK-1001-PREFNUM         =  43           ) AND
                      (COMB-KOHHKNNUM(IDX-CYO) = "143" OR "342") AND
                      (LNK-SYU-SRYYMD(1:6)    >= "200912"      ))
                  OR ((WK-1001-PREFNUM         =  43           ) AND
                      (COMB-KOHHKNNUM(IDX-CYO) = "443"         ) AND
                      (LNK-SYU-SRYYMD(1:6)    >= "201608"      ))
                    MOVE     ZERO     TO   WK-CYO-OKIKAE(IDX-CYO)
                  ELSE
                    MOVE     1        TO   WK-CYO-OKIKAE(IDX-CYO)
                  END-IF
               END-IF
             END-PERFORM
           END-IF.
      *
      *    *公費１の上限回数（金額）取込み
           IF (COMB-KOH1HKNNUM           NOT =  SPACE)    AND
              (COMB-KOH1-GAIJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH1HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH1HKNNUM    =     "027"
                   IF    LNK-SYU-SRYYMD  >=    "20021001"
                       MOVE     COMB-KOH1PAYKBN     TO  WK-PAYKBN
                   ELSE
                       MOVE     WK-1001-HOSPSBT     TO  WK-PAYKBN(1:1)
                       MOVE     WK-1001-ROUPAYKBN   TO  WK-PAYKBN(2:1)
                   END-IF
               ELSE
                       MOVE     "00"         TO    WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                   MOVE    "tbl_hknnum"  TO    MCP-TABLE
                   MOVE    "key2"        TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                       OR
                    ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            =  HKN-PAYKBN))
                       MOVE    "tbl_hknnum"  TO    MCP-TABLE
                       MOVE    "key2"        TO    MCP-PATHNAME
                       PERFORM  HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   2103-KOH1-KAISU-SEC
                   END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF     COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8"
                    MOVE   "1"        TO    FLG-CHIHOU2(1)
               END-IF
      *
               IF    (COMB-KOH1HKNNUM       =  "021"   )
               AND   (LNK-SYU-SRYYMD(1:6)   >= "200604")
                  CONTINUE
               ELSE
                 IF  ((LNK-S01-KOUREI-ZAITAKU-KBN =       "1")  OR
                      (FLG-KOUREI-KBN             =       "1"))
                 AND ( COMB-KOH1HKNNUM       =  "010" OR "021")
                      MOVE   WK-KOH-GENDOGAKU
                                     TO    MAX-KIN-KOHI1-M
                      MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                      IF  FLG-TOKU75 = 1 OR 2
                        MOVE  WK-KOH-GENDOGAKU-TOKU75
                                     TO    MAX-KIN-KOHI1-M-TOKU75
                      END-IF
                 END-IF
                 IF ((FLG-GENBUTU70   NOT =   ZERO) AND
                     (COMB-KOH1HKNNUM     =  "010"))
                 OR ((FLG-TOKU75-CYO      =   3   ) AND
                     (COMB-KOH1HKNNUM     =  "010"))
                 OR ((FLG-CYOKI-ARI       =   2   ) AND
                     (COMB-KOH1HKNNUM     =  "010"))
                    MOVE     WK-GEN70-GENDOGAKU
                                     TO    MAX-KIN-KOHI1-M
                    MOVE      "1"    TO    COMB-KOH1-GAIJGNKBN
                    EVALUATE  WK-GEN70-GENDOGAKU
                      WHEN       80100
                        MOVE  WK-ZENGAKU TO WK-KOUREI-IRYOHI70K
                        MOVE  1          TO FLG-IRYOHI70K
                    END-EVALUATE
                    IF  FLG-TOKU75 = 3
                        MOVE     WK-GEN70-GENDOGAKU-TOKU75
                                     TO    MAX-KIN-KOHI1-M-TOKU75
                        EVALUATE  WK-GEN70-GENDOGAKU-TOKU75
                          WHEN       40050
                            MOVE  WK-ZENGAKU TO
                                  WK-KOUREI-IRYOHI70K-TOKU75
                        END-EVALUATE
                    END-IF
                 END-IF
      *
                 IF    COMB-KOH1HKNNUM       =  "010" OR "021"
                     IF    FLG-SEISINJYO  =   1
                        MOVE   ZERO   TO    MAX-KIN-KOHI1-M
                        MOVE   SPACE  TO    COMB-KOH1-GAIJGNKBN
                        MOVE   ZERO   TO    FLG-IRYOHI70K
                     END-IF
                 END-IF
               END-IF
      *
               IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
                    (FLG-KOUREI-KBN               =       "1" ))
               AND ( COMB-KOH1HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH1HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   12000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(1)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH1HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH1HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH1HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH1HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF    WK-CYO-OKIKAE(1)  =  1
                   IF (COMB-KOH2HKNNUM         = "972") OR
                      (COMB-KOH3HKNNUM         = "972") OR
                      (COMB-KOH4HKNNUM         = "972")
                      MOVE   10000   TO    MAX-KIN-KOHI1-M
                      MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(1)
                      MOVE    "1"    TO    FLG-CHIHOU3(1)
                   END-IF
                   IF (COMB-KOH2HKNNUM         = "974") OR
                      (COMB-KOH3HKNNUM         = "974") OR
                      (COMB-KOH4HKNNUM         = "974")
                      MOVE   20000   TO    MAX-KIN-KOHI1-M
                      MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(1)
                      MOVE    "1"    TO    FLG-CHIHOU3(1)
                   END-IF
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  42     )
               AND (COMB-KOH1HKNNUM       = "280"   )
               AND (LNK-S01-JIKANGAI      = "1"     )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201104")
                    MOVE    800    TO    MAX-KIN-KOHI1-D
                    MOVE   1600    TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-GAIJGNKBN
                    MOVE   SPACE   TO    FLG-CHIHOU(1)
                    MOVE   SPACE   TO    FLG-CHIHOU3(1)
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  35 OR 34)
               AND (COMB-KOH1HKNNUM       = "781"    )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201309" )
                   IF  MAX-KIN-KOHI1-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI1-M
                      MOVE  "1"        TO   COMB-KOH1-GAIJGNKBN
                   END-IF
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  23              )
               AND (COMB-KOH1HKNNUM       = "581" OR "681" OR
                                            "781" OR "271"   )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201504"         )
                   IF  MAX-KIN-KOHI1-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI1-M
                      MOVE  "1"        TO   COMB-KOH1-GAIJGNKBN
                   END-IF
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  30     )
               AND (COMB-HKNNUM       NOT = SPACE   )
               AND (COMB-KOH1HKNNUM       = "281"   )
               AND (COMB-KOH2HKNNUM       = SPACE   )
               AND (COMB-KOH3HKNNUM       = SPACE   )
               AND (COMB-KOH4HKNNUM       = SPACE   )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201708")
                   IF  MAX-KIN-KOHI1-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI1-M
                      MOVE  "1"        TO   COMB-KOH1-GAIJGNKBN
                   END-IF
               END-IF
      *
           END-IF.
      *
      *    *公費２の上限回数（金額）取込み
           IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
              (COMB-KOH2-GAIJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH2HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                   MOVE    "tbl_hknnum"  TO    MCP-TABLE
                   MOVE    "key2"        TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                      OR
                    ((HKN-TEKSTYMD(1:6)   <= LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <= HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            = HKN-PAYKBN))
                       MOVE     "tbl_hknnum"  TO    MCP-TABLE
                       MOVE     "key2"        TO    MCP-PATHNAME
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   2104-KOH2-KAISU-SEC
                   END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF     COMB-KOH2HKNNUM(1:1) >= "1" AND <= "8"
                    MOVE   "1"        TO    FLG-CHIHOU2(2)
               END-IF
      *
               IF    (COMB-KOH2HKNNUM       =  "021"   )
               AND   (LNK-SYU-SRYYMD(1:6)   >= "200604")
                  CONTINUE
               ELSE
                 IF  ((LNK-S01-KOUREI-ZAITAKU-KBN =       "1")  OR
                      (FLG-KOUREI-KBN             =       "1"))
                 AND ( COMB-KOH2HKNNUM       =  "010" OR "021")
                      MOVE   WK-KOH-GENDOGAKU
                                     TO    MAX-KIN-KOHI2-M
                      MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
                    (FLG-KOUREI-KBN               =       "1" ))
               AND ( COMB-KOH2HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH2HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   12000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(2)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH2HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH2HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH2HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH2HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF    WK-CYO-OKIKAE(2)  =  1
                   IF (COMB-KOH1HKNNUM         = "972") OR
                      (COMB-KOH3HKNNUM         = "972") OR
                      (COMB-KOH4HKNNUM         = "972")
                      MOVE   10000   TO    MAX-KIN-KOHI2-M
                      MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(2)
                      MOVE    "1"    TO    FLG-CHIHOU3(2)
                   END-IF
                   IF (COMB-KOH1HKNNUM         = "974") OR
                      (COMB-KOH3HKNNUM         = "974") OR
                      (COMB-KOH4HKNNUM         = "974")
                      MOVE   20000   TO    MAX-KIN-KOHI2-M
                      MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(2)
                      MOVE    "1"    TO    FLG-CHIHOU3(2)
                   END-IF
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  42     )
               AND (COMB-KOH2HKNNUM       = "280"   )
               AND (LNK-S01-JIKANGAI      = "1"     )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201104")
                    MOVE    800    TO    MAX-KIN-KOHI2-D
                    MOVE   1600    TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-GAIJGNKBN
                    MOVE   SPACE   TO    FLG-CHIHOU(2)
                    MOVE   SPACE   TO    FLG-CHIHOU3(2)
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  35 OR 34)
               AND (COMB-KOH2HKNNUM       = "781"    )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201309" )
                   IF  MAX-KIN-KOHI2-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI2-M
                      MOVE  "1"        TO   COMB-KOH2-GAIJGNKBN
                   END-IF
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  23              )
               AND (COMB-KOH2HKNNUM       = "581" OR "681" OR
                                            "781" OR "271"   )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201504"         )
                   IF  MAX-KIN-KOHI2-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI2-M
                      MOVE  "1"        TO   COMB-KOH2-GAIJGNKBN
                   END-IF
               END-IF
      *
           END-IF.
      *
      *    *公費３の上限回数（金額）取込み
           IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
              (COMB-KOH3-GAIJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH3HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                   MOVE    "tbl_hknnum"  TO    MCP-TABLE
                   MOVE    "key2"        TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                      OR
                    ((HKN-TEKSTYMD(1:6)   <= LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <= HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            = HKN-PAYKBN))
                       MOVE     "tbl_hknnum"  TO    MCP-TABLE
                       MOVE     "key2"        TO    MCP-PATHNAME
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   2105-KOH3-KAISU-SEC
                   END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF     COMB-KOH3HKNNUM(1:1) >= "1" AND <= "8"
                    MOVE   "1"        TO    FLG-CHIHOU2(3)
               END-IF
      *
               IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
                    (FLG-KOUREI-KBN               =       "1" ))
               AND ( COMB-KOH3HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH3HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   12000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(3)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH3HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH3HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH3HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH3HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF    WK-CYO-OKIKAE(3)  =  1
                   IF (COMB-KOH1HKNNUM         = "972") OR
                      (COMB-KOH2HKNNUM         = "972") OR
                      (COMB-KOH4HKNNUM         = "972")
                      MOVE   10000   TO    MAX-KIN-KOHI3-M
                      MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(3)
                      MOVE    "1"    TO    FLG-CHIHOU3(3)
                   END-IF
                   IF (COMB-KOH1HKNNUM         = "974") OR
                      (COMB-KOH2HKNNUM         = "974") OR
                      (COMB-KOH4HKNNUM         = "974")
                      MOVE   20000   TO    MAX-KIN-KOHI3-M
                      MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(3)
                      MOVE    "1"    TO    FLG-CHIHOU3(3)
                   END-IF
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  42     )
               AND (COMB-KOH3HKNNUM       = "280"   )
               AND (LNK-S01-JIKANGAI      = "1"     )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201104")
                    MOVE    800    TO    MAX-KIN-KOHI3-D
                    MOVE   1600    TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-GAIJGNKBN
                    MOVE   SPACE   TO    FLG-CHIHOU(3)
                    MOVE   SPACE   TO    FLG-CHIHOU3(3)
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  35 OR 34)
               AND (COMB-KOH3HKNNUM       = "781"    )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201309" )
                   IF  MAX-KIN-KOHI3-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI3-M
                      MOVE  "1"        TO   COMB-KOH3-GAIJGNKBN
                   END-IF
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  23              )
               AND (COMB-KOH3HKNNUM       = "581" OR "681" OR
                                            "781" OR "271"   )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201504"         )
                   IF  MAX-KIN-KOHI3-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI3-M
                      MOVE  "1"        TO   COMB-KOH3-GAIJGNKBN
                   END-IF
               END-IF
      *
           END-IF.
      *
      *    *公費４の上限回数（金額）取込み
           IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
              (COMB-KOH4-GAIJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH4HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                   MOVE    "tbl_hknnum"  TO    MCP-TABLE
                   MOVE    "key2"        TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                     (FLG-HKNNUM     =    1)                       OR
                    ((HKN-TEKSTYMD(1:6)   <= LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <= HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            = HKN-PAYKBN))
                       MOVE     "tbl_hknnum"  TO    MCP-TABLE
                       MOVE     "key2"        TO    MCP-PATHNAME
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM         =       0
                          PERFORM   2106-KOH4-KAISU-SEC
                   END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF     COMB-KOH4HKNNUM(1:1) >= "1" AND <= "8"
                    MOVE   "1"        TO    FLG-CHIHOU2(4)
               END-IF
      *
               IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
                    (FLG-KOUREI-KBN               =       "1" ))
               AND ( COMB-KOH4HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH4HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   12000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(4)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH4HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH4HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH4HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH4HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                 END-IF
               END-IF
      *
               IF    WK-CYO-OKIKAE(4)  =  1
                   IF (COMB-KOH1HKNNUM         = "972") OR
                      (COMB-KOH2HKNNUM         = "972") OR
                      (COMB-KOH3HKNNUM         = "972")
                      MOVE   10000   TO    MAX-KIN-KOHI4-M
                      MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(4)
                      MOVE    "1"    TO    FLG-CHIHOU3(4)
                   END-IF
                   IF (COMB-KOH1HKNNUM         = "974") OR
                      (COMB-KOH2HKNNUM         = "974") OR
                      (COMB-KOH3HKNNUM         = "974")
                      MOVE   20000   TO    MAX-KIN-KOHI4-M
                      MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(4)
                      MOVE    "1"    TO    FLG-CHIHOU3(4)
                   END-IF
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  42     )
               AND (COMB-KOH4HKNNUM       = "280"   )
               AND (LNK-S01-JIKANGAI      = "1"     )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201104")
                    MOVE    800    TO    MAX-KIN-KOHI4-D
                    MOVE   1600    TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-GAIJGNKBN
                    MOVE   SPACE   TO    FLG-CHIHOU(4)
                    MOVE   SPACE   TO    FLG-CHIHOU3(4)
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  35 OR 34)
               AND (COMB-KOH4HKNNUM       = "781"    )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201309" )
                   IF  MAX-KIN-KOHI4-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI4-M
                      MOVE  "1"        TO   COMB-KOH4-GAIJGNKBN
                   END-IF
               END-IF
      *
               IF  (WK-1001-PREFNUM       =  23              )
               AND (COMB-KOH4HKNNUM       = "581" OR "681" OR
                                            "781" OR "271"   )
               AND (LNK-SYU-SRYYMD(1:6)  >= "201504"         )
                   IF  MAX-KIN-KOHI4-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI4-M
                      MOVE  "1"        TO   COMB-KOH4-GAIJGNKBN
                   END-IF
               END-IF
      *
           END-IF.
      *
      *    北海道・特定疾患（０５１）（道単独事業）
      *
           INITIALIZE        WK-DOTANDOKU-TBL.
      *
           IF     (WK-1001-PREFNUM         =  01     )
           AND    (LNK-SYU-SRYYMD(1:6)    >= "200510")
           AND    (LNK-SYU-SRYYMD(1:6)    <  "200810")
      *
             PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                         UNTIL    KOH-IDX      >    4
      *
              IF  COMB-KOHHKNNUM(KOH-IDX) = "051"
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    COMB-KOHID(KOH-IDX)  TO  PTKOH-KOHID
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key8"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key8"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    IF       FLG-PTKOHINF    =       ZERO
                      IF (PTKOH-JKYSNUM(1:2) >= "91" AND <= "95")
                      OR (PTKOH-JKYSNUM(1:2) >= "71" AND <= "88")
                         MOVE    1    TO   WK-DOTANDOKU(KOH-IDX)
                      END-IF
                    END-IF
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key8"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
      *
             END-PERFORM
      *
           END-IF.
      *
      *    患者公費負担（金額）取り込み
           IF    LNK-SYU-SRYYMD(1:6)   <   "200304"
               CONTINUE
           ELSE
               PERFORM   2107-KOHFTN-KINGAKU-SEC
           END-IF.
      *
           IF  (FLG-GENBUTU70       NOT =   ZERO  )
           AND (FLG-OITA-GENBUTU70      =   ZERO  )
           AND (LNK-SYU-SRYYMD(1:6)    >= "201204")
             IF    (COMB-KOH1HKNNUM(1:1) = "0" )
             OR    (COMB-KOH2HKNNUM(1:1) = "0" )
             OR    (COMB-KOH3HKNNUM(1:1) = "0" )
             OR    (COMB-KOH4HKNNUM(1:1) = "0" )
             OR    (COMB-KOH1HKNNUM(1:2) = "99")
             OR    (COMB-KOH2HKNNUM(1:2) = "99")
             OR    (COMB-KOH3HKNNUM(1:2) = "99")
             OR    (COMB-KOH4HKNNUM(1:2) = "99")
               CONTINUE
             ELSE
               IF  (COMB-KOH1HKNNUM(1:1)   >= "1" AND <= "8")
               AND (WK-2010-KOGAKKEIKBN(1)  = "1"           )
                   MOVE     9     TO    LNK-SYU-SKJ-FTNGAKU(3)
               END-IF
             END-IF
           END-IF.
      *
      *    ７０歳未満現物給付の収納マスタ検索
           INITIALIZE         WK-SYUNOU-GENBUTU70-TABLE.
           INITIALIZE         WK-SYUNOU-GENBUTU70T-TABLE.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-KEISAN.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-FTNRATE.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-MSG.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU-JGNFLG.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU-KR-SKYMONEY.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU-KR-SKYMONEY2.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU-KR-SYUHKNFLG.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU-SECMONEY-MAE.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU-TOTALTEN-MAE.
           IF    LNK-SYU-SRYYMD(1:6)   >=  "201204"
             PERFORM       210E-SYUNOU-FTNRATE-HENSYU-SEC
             IF  (FLG-GENBUTU70           NOT =   ZERO)
             AND (FLG-OITA-GENBUTU70          =   ZERO)
               PERFORM     210C-SYUNOU-GEN70-KENSAKU-SEC
               PERFORM     210D-SYUNOU-GEN70-HENSYU-SEC
             END-IF
             IF  (LNK-S01-KOUREI-ZAITAKU-KBN  =   "1" )
             AND (COMB-HKNNUM             NOT =  SPACE)
               PERFORM     210C-SYUNOU-GEN70-KENSAKU-SEC
             END-IF
           END-IF.
      *
      *    和歌山県地方公費（２８１）に関わる収納マスタ検索
           MOVE   ZERO   TO   FLG-WAKAYAMA-HANTEI.
           MOVE   ZERO   TO   WK-WAKAYAMA-HANTEIKIN.
           MOVE   ZERO   TO   WK-WAKAYAMA-HANTEITEN.
           IF  (WK-1001-PREFNUM       =  30     )
           AND (COMB-HKNNUM       NOT = SPACE   )
           AND (COMB-KOH1HKNNUM       = "281"   )
           AND (COMB-KOH2HKNNUM       = SPACE   )
           AND (COMB-KOH3HKNNUM       = SPACE   )
           AND (COMB-KOH4HKNNUM       = SPACE   )
           AND (LNK-SYU-SRYYMD(1:6)  >= "201708")
             IF  (LNK-S01-KOUREI-ZAITAKU-KBN  =  "1")
             OR  (FLG-KOUREI-KBN              =  "1")
               CONTINUE
             ELSE
               PERFORM     210F-SYUNOU-CHIHOU-KENSAKU-SEC
             END-IF
           END-IF.
      *
      *平成１４年１０月改正対応
      *高齢者の在宅総合・在宅末期算定患者の主保険上限額算定
      *
           MOVE   ZERO   TO   WK-GENBUTU-SYUMAXKIN.
           MOVE   ZERO   TO   WK-WAKAYAMA-HANTEIJGN.
      *
           IF  LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
               IF  COMB-KOH1-HKNKOHSBTKBN   =   "3"
                   EVALUATE   COMB-KOH1PAYKBN
                       WHEN   "01"
                           MOVE  "1"          TO   COMB-KOH1-GAIJGNKBN
                           IF  FLG-SANSHOU3     =   SPACE               
                               MOVE   12000   TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           ELSE
                               MOVE    8000   TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           END-IF
                       WHEN   "02"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           MOVE  "1"          TO   COMB-KOH1-GAIJGNKBN
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                              MOVE   12000    TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           ELSE
                              MOVE   44400    TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           END-IF
                         ELSE
                           MOVE  "1"          TO   COMB-KOH1-GAIJGNKBN
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                              MOVE   12000    TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           ELSE
                              MOVE   40200    TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           END-IF
                         END-IF
                       WHEN   "03"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           MOVE  "1"          TO   COMB-KOH1-GAIJGNKBN
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                              MOVE   12000    TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           ELSE
                              MOVE   44400    TO   MAX-KIN-KOHI1-D
                                                   MAX-KIN-KOHI1-M
                           END-IF
                         END-IF
                   END-EVALUATE
               ELSE
                 IF   FLG-ZEROKOGAITO   =   1
                   IF    LNK-SYU-SRYYMD(1:6)  >=  "201808"
                       MOVE   18000   TO   MAX-KIN-SYU-M
                   ELSE
                     IF  LNK-SYU-SRYYMD(1:6)  >=  "201708"
                       MOVE   14000   TO   MAX-KIN-SYU-M
                     ELSE
                       MOVE   12000   TO   MAX-KIN-SYU-M
                     END-IF
                   END-IF
                 ELSE
                   EVALUATE   COMB-HOJOKBN
                       WHEN   "1"
                       WHEN   "4"
                       WHEN   "9"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "201808"
                             IF  FLG-SANSHOU3      =   SPACE
                                 MOVE   18000   TO   MAX-KIN-SYU-M
                             ELSE
                                 MOVE    8000   TO   MAX-KIN-SYU-M
                             END-IF
                         ELSE
                           IF  LNK-SYU-SRYYMD(1:6)   >=  "201708"
                             IF  FLG-SANSHOU3      =   SPACE
                                 MOVE   14000   TO   MAX-KIN-SYU-M
                             ELSE
                                 MOVE    8000   TO   MAX-KIN-SYU-M
                             END-IF
                           ELSE
                             IF  FLG-SANSHOU3      =   SPACE              
                                 MOVE   12000   TO   MAX-KIN-SYU-M
                             ELSE
                                 MOVE    8000   TO   MAX-KIN-SYU-M
                             END-IF
                           END-IF
                         END-IF
                       WHEN   "2"
                       WHEN   "5"
                       WHEN   "8"
                        IF        LNK-SYU-SRYYMD(1:6)   >=  "201808"
                                IF  FLG-SANSHOU3   =   SPACE
                                  MOVE   18000   TO   MAX-KIN-SYU-M
                                ELSE
                                  MOVE    8000   TO   MAX-KIN-SYU-M
                                END-IF
                        ELSE
                          IF      LNK-SYU-SRYYMD(1:6)   >=  "201708"
                                IF  FLG-SANSHOU3   =   SPACE
                                  MOVE   14000   TO   MAX-KIN-SYU-M
                                ELSE
                                  MOVE    8000   TO   MAX-KIN-SYU-M
                                END-IF
                          ELSE
                           IF     LNK-SYU-SRYYMD(1:6)   >=  "200804"
                                IF  FLG-SANSHOU3   =   SPACE
                                  MOVE   12000   TO   MAX-KIN-SYU-M
                                ELSE
                                  MOVE    8000   TO   MAX-KIN-SYU-M
                                END-IF
                           ELSE
                            IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                              IF   FLG-KEIKASOCHI-IPAN  =  1
                                  MOVE   12000   TO   MAX-KIN-SYU-M
                              ELSE
                                  MOVE   44400   TO   MAX-KIN-SYU-M
                              END-IF
                            ELSE
                              IF   FLG-KEIKASOCHI-IPAN  =  1
                                  MOVE   12000   TO   MAX-KIN-SYU-M
                              ELSE
                                  MOVE   40200   TO   MAX-KIN-SYU-M
                              END-IF
                            END-IF
                           END-IF
                          END-IF
                        END-IF
                       WHEN   "3"
                       WHEN   "6"
                       WHEN   "7"
                        IF       LNK-SYU-SRYYMD(1:6)   >=  "201808"
                          EVALUATE   FLG-KOUREI-GENEKIKBN
                            WHEN         1
                              MOVE     252600   TO   MAX-KIN-SYU-M
                              IF  FLG-KOHYONKAIME = 1
                                 MOVE  140100   TO   MAX-KIN-SYU-M
                              END-IF
                            WHEN         2
                              MOVE     167400   TO   MAX-KIN-SYU-M
                              IF  FLG-KOHYONKAIME = 1
                                 MOVE   93000   TO   MAX-KIN-SYU-M
                              END-IF
                            WHEN         3
                              MOVE      80100   TO   MAX-KIN-SYU-M
                              IF  FLG-KOHYONKAIME = 1
                                 MOVE   44400   TO   MAX-KIN-SYU-M
                              END-IF
                          END-EVALUATE
                          IF  (COMB-KOH1HKNNUM  =  SPACE OR "970")
                          AND (COMB-KOH2HKNNUM  =  SPACE         )
                          AND (COMB-KOH3HKNNUM  =  SPACE         )
                          AND (COMB-KOH4HKNNUM  =  SPACE         )
                          AND (FLG-KOHYONKAIME  =  ZERO          )
                            MOVE    WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                            EVALUATE   FLG-KOUREI-GENEKIKBN
                              WHEN         1
                                MOVE    1       TO   FLG-IRYOHIKG
                              WHEN         2
                                MOVE    2       TO   FLG-IRYOHIKG
                              WHEN         3
                                MOVE    3       TO   FLG-IRYOHIKG
                            END-EVALUATE
                          END-IF
                        ELSE
                          IF     LNK-SYU-SRYYMD(1:6)   >=  "201708"
                                 MOVE   57600   TO   MAX-KIN-SYU-M
                          ELSE
                            IF   LNK-SYU-SRYYMD(1:6)   >=  "200610"
                              IF   FLG-KEIKASOCHI-IPAN  =  1
                                 MOVE   12000   TO   MAX-KIN-SYU-M
                              ELSE
                                 MOVE   44400   TO   MAX-KIN-SYU-M
                              END-IF
                            END-IF
                          END-IF
                        END-IF
                   END-EVALUATE
                 END-IF
                 IF    FLG-TOKU75  =  1 OR 2
                    COMPUTE  MAX-KIN-SYU-M  =
                             MAX-KIN-SYU-M  /  2
                 END-IF
                 MOVE    MAX-KIN-SYU-M   TO  WK-GENBUTU-SYUMAXKIN
               END-IF
           END-IF.
      *
           IF  ( LNK-S01-KOUREI-ZAITAKU-KBN   =       "1"  )
           AND ( COMB-HKNNUM            NOT   =     SPACE  )
      *
                IF   COMB-KOH1HKNNUM      =    "027"
                   IF (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH4HKNNUM(1:2)   =     "99"))
                   OR (( COMB-KOH2HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(2)        =      1  ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(2)        =      1  ) AND
                       ( COMB-KOH3HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                          CONTINUE
                   ELSE
                    IF   ( COMB-KOH2HKNNUM   =   "012" )
                    OR   ( COMB-KOH3HKNNUM   =   "012" )
                    OR   ( COMB-KOH4HKNNUM   =   "012" )
                          IF   MAX-KIN-KOHI1-M   >  8000
                            MOVE   8000    TO   MAX-KIN-KOHI1-D
                                                MAX-KIN-KOHI1-M
                          END-IF
                    ELSE
                     IF   ( COMB-KOH2HKNNUM  =   "972" )
                     OR   ( COMB-KOH3HKNNUM  =   "972" )
                     OR   ( COMB-KOH4HKNNUM  =   "972" )
                          IF   MAX-KIN-KOHI1-M   >  10000
                            MOVE   10000   TO   MAX-KIN-KOHI1-D
                                                MAX-KIN-KOHI1-M
                          END-IF
                     ELSE
                      IF  (COMB-KOH2HKNNUM(1:1) = "0")
                      OR  (COMB-KOH3HKNNUM(1:1) = "0")
                      OR  (COMB-KOH4HKNNUM(1:1) = "0")
                          CONTINUE
                      ELSE
                        IF  (COMB-KOH2HKNNUM = "974")
                        OR  (COMB-KOH3HKNNUM = "974")
                        OR  (COMB-KOH4HKNNUM = "974")
                          IF   MAX-KIN-KOHI1-M   >  20000
                            MOVE   20000   TO   MAX-KIN-KOHI1-D
                                                MAX-KIN-KOHI1-M
                          END-IF
                        END-IF
                      END-IF
                     END-IF
                    END-IF
                   END-IF
                ELSE
                   IF (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM        =    SPACE) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH2HKNNUM        =    SPACE) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(1)        =      1  ) AND
                       ( COMB-KOH2HKNNUM        =    SPACE) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(1)        =      1  ) AND
                       ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                        IF  (COMB-HOJOKBN  =  "3" OR "6" OR "7")
                        AND (FLG-KOHYONKAIME        =   ZERO   )
                        AND (LNK-SYU-SRYYMD(1:6)   >=  "201808")
                          MOVE    WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                          EVALUATE   FLG-KOUREI-GENEKIKBN
                            WHEN         1
                              MOVE    1       TO   FLG-IRYOHIKG2
                            WHEN         2
                              MOVE    2       TO   FLG-IRYOHIKG2
                            WHEN         3
                              MOVE    3       TO   FLG-IRYOHIKG2
                          END-EVALUATE
                        END-IF
                   ELSE
                    IF   ( COMB-KOH1HKNNUM   =   "012" OR "025" )
                    OR   ( COMB-KOH2HKNNUM   =   "012" OR "025" )
                    OR   ( COMB-KOH3HKNNUM   =   "012" OR "025" )
                    OR   ( COMB-KOH4HKNNUM   =   "012" OR "025" )
                        IF    FLG-TOKU75  =  1 OR 2
                          IF   MAX-KIN-SYU-M   >  4000
                            MOVE   4000    TO   MAX-KIN-SYU-M
                          END-IF
                        ELSE
                          IF   MAX-KIN-SYU-M   >  8000
                            MOVE   8000    TO   MAX-KIN-SYU-M
                          END-IF
                        END-IF
                    ELSE
                     IF  ((COMB-KOH1HKNNUM  =   "972"        ) OR
                          (COMB-KOH2HKNNUM  =   "972"        ) OR
                          (COMB-KOH3HKNNUM  =   "972"        ) OR
                          (COMB-KOH4HKNNUM  =   "972"        ))
                     AND ( WK-SYUNOU-GENBUTU-KR-SYUHKNFLG
                                                       = ZERO )
                        IF    FLG-TOKU75  =  1 OR 2
                          IF   MAX-KIN-SYU-M   >  5000
                            MOVE   5000    TO   MAX-KIN-SYU-M
                          END-IF
                        ELSE
                          IF   MAX-KIN-SYU-M   >  10000
                            MOVE   10000   TO   MAX-KIN-SYU-M
                          END-IF
                        END-IF
                     ELSE
                      IF  (COMB-KOH1HKNNUM(1:1) = "0")
                      OR  (COMB-KOH2HKNNUM(1:1) = "0")
                      OR  (COMB-KOH3HKNNUM(1:1) = "0")
                      OR  (COMB-KOH4HKNNUM(1:1) = "0")
                        IF  (COMB-HOJOKBN  =  "3" OR "6" OR "7")
                        AND (FLG-TOKUSITU-XXX       =   1      )
                        AND (FLG-KOHYONKAIME        =   ZERO   )
                        AND (LNK-SYU-SRYYMD(1:6)   >=  "201808")
                          MOVE    WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                          EVALUATE   FLG-KOUREI-GENEKIKBN
                            WHEN         1
                              MOVE    4       TO   FLG-IRYOHIKG2
                            WHEN         2
                              MOVE    5       TO   FLG-IRYOHIKG2
                            WHEN         3
                              MOVE    6       TO   FLG-IRYOHIKG2
                          END-EVALUATE
                        END-IF
      *                 今まで置き換えていなかったのでH30.8から対応
                        IF  (COMB-HOJOKBN  =  "3" OR "6" OR "7")
                        AND (FLG-TOKUSITU-XXX       =   ZERO   )
                        AND (LNK-SYU-SRYYMD(1:6)   >=  "201808")
                          IF    FLG-TOKU75  =  1 OR 2
                            MOVE     9000     TO   MAX-KIN-SYU-M
                          ELSE
                            MOVE    18000     TO   MAX-KIN-SYU-M
                          END-IF
                        END-IF
                      ELSE
                        IF  ((COMB-KOH1HKNNUM  =   "974"        ) OR
                             (COMB-KOH2HKNNUM  =   "974"        ) OR
                             (COMB-KOH3HKNNUM  =   "974"        ) OR
                             (COMB-KOH4HKNNUM  =   "974"        ))
                        AND ( WK-SYUNOU-GENBUTU-KR-SYUHKNFLG
                                                          = ZERO )
                          IF    FLG-TOKU75  =  1 OR 2
                            IF   MAX-KIN-SYU-M   >  10000
                              MOVE   10000   TO   MAX-KIN-SYU-M
                            END-IF
                          ELSE
                            IF   MAX-KIN-SYU-M   >  20000
                              MOVE   20000   TO   MAX-KIN-SYU-M
                            END-IF
                          END-IF
                        END-IF
                      END-IF
                     END-IF
                    END-IF
                   END-IF
                END-IF
      *
           END-IF.
      *
           IF  FLG-GENBUTU70   NOT =   ZERO
      *
               IF   FLG-ZEROKOGAITO   =   1
                    MOVE     80100   TO   MAX-KIN-SYU-M
               ELSE
                IF   LNK-SYU-SRYYMD(1:6) >=  "201501"
                 EVALUATE   FLG-GENBUTU70
                  WHEN        1
                    EVALUATE  FLG-GENBUTU70-KBN
                      WHEN      11
                        MOVE     252600  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE  140100  TO   MAX-KIN-SYU-M
                        END-IF
                      WHEN      12
                        MOVE     167400  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE   93000  TO   MAX-KIN-SYU-M
                        END-IF
                    END-EVALUATE
                  WHEN        2
                    EVALUATE  FLG-GENBUTU70-KBN
                      WHEN      21
                        MOVE      80100  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE   44400  TO   MAX-KIN-SYU-M
                        END-IF
                      WHEN      22
                        MOVE      57600  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE   44400  TO   MAX-KIN-SYU-M
                        END-IF
                    END-EVALUATE
                  WHEN        3
                    EVALUATE  FLG-GENBUTU70-KBN
                      WHEN      31
                        MOVE      35400  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE   24600  TO   MAX-KIN-SYU-M
                        END-IF
                    END-EVALUATE
                 END-EVALUATE
                ELSE
                 EVALUATE   FLG-GENBUTU70
                  WHEN        1
                    MOVE    150000   TO   MAX-KIN-SYU-M
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  83400   TO   MAX-KIN-SYU-M
                    END-IF
                  WHEN        2
                    MOVE     80100   TO   MAX-KIN-SYU-M
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  44400   TO   MAX-KIN-SYU-M
                    END-IF
                  WHEN        3
                    MOVE     35400   TO   MAX-KIN-SYU-M
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  24600   TO   MAX-KIN-SYU-M
                    END-IF
                 END-EVALUATE
                END-IF
               END-IF
               IF    FLG-TOKU75  =  3
                      COMPUTE  MAX-KIN-SYU-M  =
                               MAX-KIN-SYU-M  /  2
               END-IF
               MOVE    MAX-KIN-SYU-M   TO  WK-GENBUTU-SYUMAXKIN
      *
               IF  (COMB-KOH1HKNNUM    =  SPACE
                                       OR "970")
               AND (COMB-KOH2HKNNUM    =  SPACE)
               AND (COMB-KOH3HKNNUM    =  SPACE)
               AND (COMB-KOH4HKNNUM    =  SPACE)
                  EVALUATE  MAX-KIN-SYU-M
                   WHEN      150000
                   WHEN       75000
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  1           TO  FLG-IRYOHI70
                   WHEN       80100
                   WHEN       40050
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  2           TO  FLG-IRYOHI70
                   WHEN      252600
                   WHEN      126300
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  7           TO  FLG-IRYOHI70
                   WHEN      167400
                   WHEN       83700
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  8           TO  FLG-IRYOHI70
                  END-EVALUATE
               END-IF
      *
               IF (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM        =    SPACE) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM(1:2)   =     "99") AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH3HKNNUM(1:2)   =     "99") AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:2)   =     "99") AND
                   ( COMB-KOH2HKNNUM        =    SPACE) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( WK-DOTANDOKU(1)        =      1  ) AND
                   ( COMB-KOH2HKNNUM        =    SPACE) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( WK-DOTANDOKU(1)        =      1  ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
                   IF  (WK-1001-PREFNUM  =  01            )
                   AND (COMB-HKNNUM  NOT = "060" AND "067")
                   AND (COMB-KOH1HKNNUM  =  "141" OR "241")
                   AND (LNK-SYU-SRYYMD(1:6)   <=  "200803")
                     MOVE     80100   TO   MAX-KIN-SYU-M
                     IF  FLG-KOHYONKAIME = 1
                        MOVE  44400   TO   MAX-KIN-SYU-M
                     END-IF
                   END-IF
                   IF  LNK-SYU-SRYYMD(1:6)  >=  "200905"
                   AND FLG-TOKUSITU-XXX      =   1
                    IF   LNK-SYU-SRYYMD(1:6) >=  "201501"
                     EVALUATE   FLG-GENBUTU70
                       WHEN        1
                        EVALUATE  FLG-GENBUTU70-KBN
                          WHEN      11
                            IF    FLG-TOKU75  =  3
                              MOVE   126300   TO  MAX-KIN-SYU-M
                            ELSE
                              MOVE   252600   TO  MAX-KIN-SYU-M
                            END-IF
                          WHEN      12
                            IF    FLG-TOKU75  =  3
                              MOVE    83700   TO  MAX-KIN-SYU-M
                            ELSE
                              MOVE   167400   TO  MAX-KIN-SYU-M
                            END-IF
                        END-EVALUATE
                       WHEN        2
                        EVALUATE  FLG-GENBUTU70-KBN
                          WHEN      21
                            IF    FLG-TOKU75  =  3
                              MOVE    40050   TO  MAX-KIN-SYU-M
                            ELSE
                              MOVE    80100   TO  MAX-KIN-SYU-M
                            END-IF
                          WHEN      22
                            IF    FLG-TOKU75  =  3
                              MOVE    28800   TO  MAX-KIN-SYU-M
                            ELSE
                              MOVE    57600   TO  MAX-KIN-SYU-M
                            END-IF
                        END-EVALUATE
                       WHEN        3
                        EVALUATE  FLG-GENBUTU70-KBN
                          WHEN      31
                            IF    FLG-TOKU75  =  3
                              MOVE    17700   TO  MAX-KIN-SYU-M
                            ELSE
                              MOVE    35400   TO  MAX-KIN-SYU-M
                            END-IF
                        END-EVALUATE
                     END-EVALUATE
                    ELSE
                     EVALUATE   FLG-GENBUTU70
                       WHEN        1
                        IF    FLG-TOKU75  =  3
                          MOVE   75000    TO  MAX-KIN-SYU-M
                        ELSE
                          MOVE   150000   TO  MAX-KIN-SYU-M
                        END-IF
                       WHEN        2
                        IF    FLG-TOKU75  =  3
                          MOVE   40050    TO  MAX-KIN-SYU-M
                        ELSE
                          MOVE   80100    TO  MAX-KIN-SYU-M
                        END-IF
                       WHEN        3
                        IF    FLG-TOKU75  =  3
                          MOVE   17700    TO  MAX-KIN-SYU-M
                        ELSE
                          MOVE   35400    TO  MAX-KIN-SYU-M
                        END-IF
                     END-EVALUATE
                    END-IF
                   END-IF
                   EVALUATE  MAX-KIN-SYU-M
                     WHEN      150000
                     WHEN       75000
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  3           TO  FLG-IRYOHI70
                     WHEN       80100
                     WHEN       40050
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  4           TO  FLG-IRYOHI70
                     WHEN      252600
                     WHEN      126300
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  9           TO  FLG-IRYOHI70
                     WHEN      167400
                     WHEN       83700
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  10          TO  FLG-IRYOHI70
                   END-EVALUATE
               ELSE
                IF   ( COMB-KOH1HKNNUM   =   "012" OR "025" )
                OR   ( COMB-KOH2HKNNUM   =   "012" OR "025" )
                OR   ( COMB-KOH3HKNNUM   =   "012" OR "025" )
                OR   ( COMB-KOH4HKNNUM   =   "012" OR "025" )
      ****         IF  FLG-KOHYONKAIME = 1
      ****            MOVE  24600   TO   WK-GEN70-GENDOGAKU2
      ****         ELSE
                      MOVE  35400   TO   WK-GEN70-GENDOGAKU2
      ****         END-IF
                   IF    FLG-TOKU75  =  3
                      COMPUTE  WK-GEN70-GENDOGAKU2  =
                               WK-GEN70-GENDOGAKU2  /  2
                   END-IF
                   IF MAX-KIN-SYU-M  >   WK-GEN70-GENDOGAKU2
                      MOVE WK-GEN70-GENDOGAKU2
                                    TO   MAX-KIN-SYU-M
                   END-IF
                ELSE
                 IF   ( COMB-KOH1HKNNUM  =   "972" )
                 OR   ( COMB-KOH2HKNNUM  =   "972" )
                 OR   ( COMB-KOH3HKNNUM  =   "972" )
                 OR   ( COMB-KOH4HKNNUM  =   "972" )
                      IF    FLG-TOKU75  =  3
                        IF   MAX-KIN-SYU-M   >  5000
                          MOVE   5000    TO   MAX-KIN-SYU-M
                        END-IF
                      ELSE
                        IF   MAX-KIN-SYU-M   >  10000
                          MOVE   10000   TO   MAX-KIN-SYU-M
                        END-IF
                      END-IF
                 ELSE
                  IF  ( COMB-KOH1HKNNUM  =   "974" )
                  OR  ( COMB-KOH2HKNNUM  =   "974" )
                  OR  ( COMB-KOH3HKNNUM  =   "974" )
                  OR  ( COMB-KOH4HKNNUM  =   "974" )
                      IF    FLG-TOKU75  =  3
                        IF   MAX-KIN-SYU-M   >  10000
                          MOVE   10000   TO   MAX-KIN-SYU-M
                        END-IF
                      ELSE
                        IF   MAX-KIN-SYU-M   >  20000
                          MOVE   20000   TO   MAX-KIN-SYU-M
                        END-IF
                      END-IF
                  ELSE
                    IF  (COMB-KOH1HKNNUM(1:1) = "0")
                    OR  (COMB-KOH2HKNNUM(1:1) = "0")
                    OR  (COMB-KOH3HKNNUM(1:1) = "0")
                    OR  (COMB-KOH4HKNNUM(1:1) = "0")
                      IF  LNK-SYU-SRYYMD(1:6)  >=  "200905"
                      AND FLG-TOKUSITU-XXX      =   1
                       IF   LNK-SYU-SRYYMD(1:6) >=  "201501"
                        EVALUATE   FLG-GENBUTU70
                          WHEN        1
                           EVALUATE  FLG-GENBUTU70-KBN
                             WHEN      11
                               IF    FLG-TOKU75  =  3
                                 MOVE   126300   TO  MAX-KIN-SYU-M
                               ELSE
                                 MOVE   252600   TO  MAX-KIN-SYU-M
                               END-IF
                             WHEN      12
                               IF    FLG-TOKU75  =  3
                                 MOVE    83700   TO  MAX-KIN-SYU-M
                               ELSE
                                 MOVE   167400   TO  MAX-KIN-SYU-M
                               END-IF
                           END-EVALUATE
                          WHEN        2
                           EVALUATE  FLG-GENBUTU70-KBN
                             WHEN      21
                               IF    FLG-TOKU75  =  3
                                 MOVE    40050   TO  MAX-KIN-SYU-M
                               ELSE
                                 MOVE    80100   TO  MAX-KIN-SYU-M
                               END-IF
                             WHEN      22
                               IF    FLG-TOKU75  =  3
                                 MOVE    28800   TO  MAX-KIN-SYU-M
                               ELSE
                                 MOVE    57600   TO  MAX-KIN-SYU-M
                               END-IF
                           END-EVALUATE
                          WHEN        3
                           EVALUATE  FLG-GENBUTU70-KBN
                             WHEN      31
                               IF    FLG-TOKU75  =  3
                                 MOVE    17700   TO  MAX-KIN-SYU-M
                               ELSE
                                 MOVE    35400   TO  MAX-KIN-SYU-M
                               END-IF
                           END-EVALUATE
                        END-EVALUATE
                       ELSE
                        EVALUATE   FLG-GENBUTU70
                          WHEN        1
                           IF    FLG-TOKU75  =  3
                             MOVE   75000    TO  MAX-KIN-SYU-M
                           ELSE
                             MOVE   150000   TO  MAX-KIN-SYU-M
                           END-IF
                          WHEN        2
                           IF    FLG-TOKU75  =  3
                             MOVE   40050    TO  MAX-KIN-SYU-M
                           ELSE
                             MOVE   80100    TO  MAX-KIN-SYU-M
                           END-IF
                          WHEN        3
                           IF    FLG-TOKU75  =  3
                             MOVE   17700    TO  MAX-KIN-SYU-M
                           ELSE
                             MOVE   35400    TO  MAX-KIN-SYU-M
                           END-IF
                        END-EVALUATE
                       END-IF
                       EVALUATE  MAX-KIN-SYU-M
                         WHEN      150000
                         WHEN       75000
                           MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                           MOVE  5           TO  FLG-IRYOHI70
                         WHEN       80100
                         WHEN       40050
                           MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                           MOVE  6           TO  FLG-IRYOHI70
                         WHEN      252600
                         WHEN      126300
                           MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                           MOVE  11          TO  FLG-IRYOHI70
                         WHEN      167400
                         WHEN       83700
                           MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                           MOVE  12          TO  FLG-IRYOHI70
                       END-EVALUATE
                      ELSE
                       IF  FLG-IRYOHI70  =  1 OR 2 OR 7 OR 8
                        IF   FLG-IRYOHI70 = 1 OR 7 OR 8
                          IF    FLG-TOKU75  =  3
                            MOVE   40050   TO   MAX-KIN-SYU-M
                          ELSE
                            MOVE   80100   TO   MAX-KIN-SYU-M
                          END-IF
                        END-IF
                        MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70
                        MOVE   6           TO   FLG-IRYOHI70
                       END-IF
                      END-IF
                    END-IF
                  END-IF
                 END-IF
                END-IF
               END-IF
      *
           END-IF.
      *
           IF   FLG-TOKU75-CYO  =  1 OR 2 OR 3
             IF (COMB-KOH1HKNNUM  =  "972")
             OR (COMB-KOH2HKNNUM  =  "972")
             OR (COMB-KOH3HKNNUM  =  "972")
             OR (COMB-KOH4HKNNUM  =  "972")
                  MOVE   5000   TO   MAX-KIN-SYU-M
             END-IF
             IF (COMB-KOH1HKNNUM  =  "974")
             OR (COMB-KOH2HKNNUM  =  "974")
             OR (COMB-KOH3HKNNUM  =  "974")
             OR (COMB-KOH4HKNNUM  =  "974")
                  MOVE   10000  TO   MAX-KIN-SYU-M
             END-IF
           END-IF.
      *
           IF   FLG-CYOKI-ARI   =  1 OR 2
             IF (COMB-KOH1HKNNUM  =  "972")
             OR (COMB-KOH2HKNNUM  =  "972")
             OR (COMB-KOH3HKNNUM  =  "972")
             OR (COMB-KOH4HKNNUM  =  "972")
                  MOVE   10000  TO   MAX-KIN-SYU-M
             END-IF
             IF (COMB-KOH1HKNNUM  =  "974")
             OR (COMB-KOH2HKNNUM  =  "974")
             OR (COMB-KOH3HKNNUM  =  "974")
             OR (COMB-KOH4HKNNUM  =  "974")
                  MOVE   20000  TO   MAX-KIN-SYU-M
             END-IF
           END-IF.
      *
           MOVE   MAX-KIN-SYU-M   TO   WK-WAKAYAMA-HANTEIJGN.
      *
      *    主保険の減額
      *    長期の減額
           IF    WK-GENGAKUKBN     NOT  =   ZERO
           AND   WK-GENGAKUKBN-KEISAN   =   ZERO
               PERFORM   2109-KOHFTN-KINGAKU-GEN-SEC
           END-IF.
      *
      *    高額委任払い金額取り込み
           IF    FLG-KOHININBARAI       =   1
               PERFORM   210A-KOHININBARAI-KINGAKU-SEC
           END-IF.
      *
      *    ４１老人上限額編集処理等
           PERFORM    2108-ROUJIN41-JYOGEN-HENSYU-SEC.
      *
       210-HOKEN-KAISU-EXT.
           EXIT.
      *
      ***************************************************************
      *        収納テーブルから院内処方、院外処方の判定             *
      ***************************************************************
       2102-SHOHOUSEN-HANTEI-SEC           SECTION.
      *
           IF      LNK-SYU-INGAISHOHOKBN  =      "1"
               MOVE       "1"             TO     FLG-INGAI
           ELSE
             INITIALIZE                          SYU-SYUNOU-REC
             MOVE    LNK-SYU-HOSPNUM      TO     SYU-HOSPNUM
             MOVE    LNK-SYU-NYUGAIKBN    TO     SYU-NYUGAIKBN
             MOVE    LNK-SYU-PTID         TO     SYU-PTID
             MOVE    LNK-SYU-SRYYMD(1:6)  TO     SYU-SRYYMD(1:6)
             MOVE    "__"                 TO     SYU-SRYYMD(7:2)
             MOVE    SYU-SYUNOU-REC       TO     MCPDATA-REC 
             MOVE    "DBSELECT"           TO     MCP-FUNC
             MOVE    "tbl_syunou"         TO     MCP-TABLE
             MOVE    "key14"              TO     MCP-PATHNAME
             CALL    "ORCDBMAIN"          USING  MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
             IF      MCP-RC               =      ZERO
                 MOVE    "tbl_syunou"     TO     MCP-TABLE
                 MOVE    "key14"          TO     MCP-PATHNAME
                 PERFORM  SYUNOU-READ3-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                     IF   SYU-DENPJTIKBN  NOT =   "3"
                         IF   SYU-INGAISHOHOKBN   =     "1"
                              MOVE   "1"  TO     FLG-INGAI
                         ELSE
                              MOVE   "1"  TO     FLG-INNAI
                         END-IF
                     END-IF
                     MOVE     "tbl_syunou"  TO   MCP-TABLE
                     MOVE     "key14"       TO   MCP-PATHNAME
                     PERFORM   SYUNOU-READ3-SEC
                 END-PERFORM
             END-IF
             MOVE     "tbl_syunou"  TO   MCP-TABLE
             MOVE     "key14"       TO   MCP-PATHNAME
             PERFORM   DB-CLOSE-SEC
           END-IF.
      *
           INITIALIZE      WK-INNAI-SANSHOU-TBL.
           PERFORM   VARYING   IDX-CYO   FROM    1   BY  1
                      UNTIL    IDX-CYO     >     4
             INITIALIZE    WK-SHOHOUSEN-HKNCOMBINUM-TBL
             IF   WK-2010-INNAIKBN(IDX-CYO)  =  "1"
             AND  FLG-INGAI                  =  SPACE
               MOVE        9     TO    WK-INNAI-SANSHOU(IDX-CYO)
               IF    LNK-SYU-TYK-HKNTEN  NOT =  ZERO
                 MOVE      1     TO    WK-INNAI-SANSHOU(IDX-CYO)
               ELSE
                 PERFORM   21021-SHOHOUSEN-HANTEI2-SEC
               END-IF
             END-IF
           END-PERFORM.
      *
       2102-SHOHOUSEN-HANTEI-EXT.
           EXIT.
      *
      ***************************************************************
      *        収納テーブルから院内処方、院外処方の判定             *
      ***************************************************************
       21021-SHOHOUSEN-HANTEI2-SEC           SECTION.
      *
           INITIALIZE                         WRK-HKNCOMBI-REC
           MOVE    LNK-SYU-HOSPNUM       TO   WRK-COMB-HOSPNUM
           MOVE    LNK-SYU-PTID          TO   WRK-COMB-PTID
           MOVE    COMB-KOHID(IDX-CYO)   TO   WRK-COMB-KOHID(1)
           MOVE    COMB-KOHID(IDX-CYO)   TO   WRK-COMB-KOHID(2)
           MOVE    COMB-KOHID(IDX-CYO)   TO   WRK-COMB-KOHID(3)
           MOVE    COMB-KOHID(IDX-CYO)   TO   WRK-COMB-KOHID(4)
           MOVE    WRK-HKNCOMBI-REC      TO   MCPDATA-REC
           MOVE    "DBSELECT"            TO   MCP-FUNC
           MOVE    "tbl_hkncombi"        TO   MCP-TABLE
           MOVE    "key4"                TO   MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC   =    ZERO
             MOVE    "tbl_hkncombi"      TO   MCP-TABLE
             MOVE    "key4"              TO   MCP-PATHNAME
             PERFORM  HKNCOMBI-READ2-SEC
      *
             MOVE     ZERO               TO   IDX-CYO2
             PERFORM  UNTIL (IDX-CYO2       >=    50)
                       OR   (FLG-HKNCOMBI    =    1 )
               IF   (WRK-COMB-DELKBN         =  SPACE                 )
               AND  (WRK-COMB-TEKSTYMD(1:6) <=  LNK-SYU-SRYYMD(1:6)   )
               AND  (LNK-SYU-SRYYMD(1:6)    <=  WRK-COMB-TEKEDYMD(1:6))
                 ADD     1               TO   IDX-CYO2
                 MOVE   WRK-COMB-HKNCOMBINUM
                            TO  WK-SHOHOUSEN-HKNCOMBINUM(IDX-CYO2)
               END-IF
               MOVE    "tbl_hkncombi"    TO   MCP-TABLE
               MOVE    "key4"            TO   MCP-PATHNAME
               PERFORM  HKNCOMBI-READ2-SEC
             END-PERFORM
           END-IF
           MOVE    "tbl_hkncombi"        TO   MCP-TABLE
           MOVE    "key4"                TO   MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           INITIALIZE                           SYU-SYUNOU-REC
           MOVE    LNK-SYU-HOSPNUM          TO  SYU-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN        TO  SYU-NYUGAIKBN
           MOVE    LNK-SYU-PTID             TO  SYU-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)      TO  SYU-SRYYMD(1:6)
           MOVE    "__"                     TO  SYU-SRYYMD(7:2)
           MOVE    COMB-KOHHKNNUM(IDX-CYO)  TO  SYU-KOH-HKNNUM(1)
           MOVE    COMB-KOHHKNNUM(IDX-CYO)  TO  SYU-KOH-HKNNUM(2)
           MOVE    COMB-KOHHKNNUM(IDX-CYO)  TO  SYU-KOH-HKNNUM(3)
           MOVE    COMB-KOHHKNNUM(IDX-CYO)  TO  SYU-KOH-HKNNUM(4)
           MOVE    SYU-SYUNOU-REC           TO  MCPDATA-REC 
           MOVE    "DBSELECT"               TO  MCP-FUNC
           MOVE    "tbl_syunou"             TO  MCP-TABLE
           MOVE    "key25"                  TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"              USING  MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
           IF      MCP-RC   =    ZERO
             MOVE    "tbl_syunou"           TO  MCP-TABLE
             MOVE    "key25"                TO  MCP-PATHNAME
             PERFORM  SYUNOU-READ3-SEC
             PERFORM  UNTIL  (FLG-SYUNOU                =  1 )
                        OR   (WK-INNAI-SANSHOU(IDX-CYO) =  1 )
               IF   SYU-DENPJTIKBN  NOT =   "3"
                 PERFORM  VARYING  IDX-CYO2   FROM  1  BY  1
                           UNTIL  (IDX-CYO2              >  50 )
                             OR   (WK-SHOHOUSEN-HKNCOMBINUM(IDX-CYO2)
                                                         = ZERO)
                   IF  SYU-HKNCOMBINUM =
                               WK-SHOHOUSEN-HKNCOMBINUM(IDX-CYO2)
                     IF    SYU-TYK-HKNTEN  NOT =  ZERO
                        MOVE   1      TO   WK-INNAI-SANSHOU(IDX-CYO)
                     END-IF
                     MOVE      50     TO   IDX-CYO2
                   END-IF
                 END-PERFORM
               END-IF
               MOVE     "tbl_syunou"  TO   MCP-TABLE
               MOVE     "key25"       TO   MCP-PATHNAME
               PERFORM   SYUNOU-READ3-SEC
             END-PERFORM
           END-IF
           MOVE     "tbl_syunou"  TO   MCP-TABLE
           MOVE     "key25"       TO   MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
       21021-SHOHOUSEN-HANTEI2-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費１（金額）取込み処理                                *
      ******************************************************************
       2103-KOH1-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH1HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                    MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                    MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                    MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                    MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                    MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                    IF  (FLG-INGAI           = "1")
                    OR  (WK-INNAI-SANSHOU(1) =  9 )
                          MOVE  HKN-HON-GAIMGAIJGNGAK
                                             TO  MAX-KIN-KOHI1-M
                    ELSE
                          MOVE  HKN-HON-GAIMNAIJGNGAK
                                             TO  MAX-KIN-KOHI1-M
                    END-IF
                 WHEN   "2"
                    IF   HKN-TSY-GAIFTNKBN      =  "0"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(1) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      END-IF
                    ELSE
                      MOVE  HKN-TSY-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                      MOVE  HKN-TSY-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                      MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                      MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                      MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(1) =  9 )
                            MOVE  HKN-TSY-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      ELSE
                            MOVE  HKN-TSY-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      END-IF
                    END-IF
                 WHEN   "3"
                    IF  HKN-TNK-GAIFTNKBN       =  "0"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(1) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      END-IF
                    ELSE
                      MOVE  HKN-TNK-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                      MOVE  HKN-TNK-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                      MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                      MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                      MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(1) =  9 )
                            MOVE  HKN-TNK-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      ELSE
                            MOVE  HKN-TNK-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      END-IF
                    END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH1HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  11                      ) AND
                   ( COMB-KOH1HKNNUM   = "344"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH1HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH1HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH1HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH1HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  19                      ) AND
                   ( COMB-KOH1HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  23                      ) AND
                   ( COMB-KOH1HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(1) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI1-M
                      END-IF
                   WHEN   "2"
                      IF   HKN-TSY-GAIFTNKBN      =  "0"
                        MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                        MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(1) =  9 )
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        END-IF
                      ELSE
                        MOVE  HKN-TSY-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                        MOVE  HKN-TSY-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                        MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                        MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(1) =  9 )
                              MOVE  HKN-TSY-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        ELSE
                              MOVE  HKN-TSY-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        END-IF
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-GAIFTNKBN       =  "0"
                        MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                        MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(1) =  9 )
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        END-IF
                      ELSE
                        MOVE  HKN-TNK-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                        MOVE  HKN-TNK-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                        MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                        MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(1) =  9 )
                              MOVE  HKN-TNK-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        ELSE
                              MOVE  HKN-TNK-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI1-M
                        END-IF
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
                 MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
                 MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
                 MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
                 MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
                 IF  (FLG-INGAI           = "1")
                 OR  (WK-INNAI-SANSHOU(1) =  9 )
                       MOVE  HKN-HON-GAIMGAIJGNGAK
                                          TO  MAX-KIN-KOHI1-M
                 ELSE
                       MOVE  HKN-HON-GAIMNAIJGNGAK
                                          TO  MAX-KIN-KOHI1-M
                 END-IF
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI1-K
             MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI1-K
             MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI1-D
             MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI1-M
             MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI1-D
             IF  (FLG-INGAI           = "1")
             OR  (WK-INNAI-SANSHOU(1) =  9 )
                   MOVE  HKN-HON-GAIMGAIJGNGAK
                                      TO  MAX-KIN-KOHI1-M
             ELSE
                   MOVE  HKN-HON-GAIMNAIJGNGAK
                                      TO  MAX-KIN-KOHI1-M
             END-IF
           END-IF.
           MOVE    MAX-KIN-KOHI1-M    TO  WK-TAIHI-MAX-KIN-KOHI1-M.
      *
           IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
                (FLG-KOUREI-KBN               =       "1" ))
           AND ( COMB-KOH1HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH1HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                                    20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI1-M             >   12000           )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH1HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    12000   TO    MAX-KIN-KOHI1-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH1HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH1HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH1HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH1HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF    WK-CYO-OKIKAE(1)  =  1
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
                IF   MAX-KIN-KOHI1-M   NOT = ZERO
                  IF   MAX-KIN-KOHI1-M   >   10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI1-D   NOT = ZERO
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
                  END-IF
                END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
                IF   MAX-KIN-KOHI1-M   NOT = ZERO
                  IF   MAX-KIN-KOHI1-M   >   20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI1-D   NOT = ZERO
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
                  END-IF
                END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM       =  14      ) AND
               ( COMB-KOH1HKNNUM       = "141"    ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200804" )
               MOVE   HKN-HON-GAIKFTNRATE   TO   WK-KANAGAWA41-FTNRATE
           END-IF.
      *
           IF  FLG-TOKU75 = 1 OR 2 OR 3
              IF  COMB-KOH1HKNNUM = "972"
                  MOVE   5000    TO    MAX-KIN-KOHI1-M-TOKU75
              END-IF
              IF  COMB-KOH1HKNNUM = "974"
                  MOVE   10000   TO    MAX-KIN-KOHI1-M-TOKU75
              END-IF
           END-IF.
      *
       2103-KOH1-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費２（金額）取込み処理                                *
      ******************************************************************
       2104-KOH2-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH2HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                    MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                    MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                    MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                    MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                    MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                    IF  (FLG-INGAI           = "1")
                    OR  (WK-INNAI-SANSHOU(2) =  9 )
                          MOVE  HKN-HON-GAIMGAIJGNGAK
                                             TO  MAX-KIN-KOHI2-M
                    ELSE
                          MOVE  HKN-HON-GAIMNAIJGNGAK
                                             TO  MAX-KIN-KOHI2-M
                    END-IF
                 WHEN   "2"
                    IF   HKN-TSY-GAIFTNKBN      =  "0"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(2) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      END-IF
                    ELSE
                      MOVE  HKN-TSY-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                      MOVE  HKN-TSY-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                      MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                      MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                      MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(2) =  9 )
                            MOVE  HKN-TSY-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      ELSE
                            MOVE  HKN-TSY-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      END-IF
                    END-IF
                 WHEN   "3"
                    IF  HKN-TNK-GAIFTNKBN       =  "0"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(2) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      END-IF
                    ELSE
                      MOVE  HKN-TNK-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                      MOVE  HKN-TNK-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                      MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                      MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                      MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(2) =  9 )
                            MOVE  HKN-TNK-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      ELSE
                            MOVE  HKN-TNK-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      END-IF
                    END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH2HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  11                      ) AND
                   ( COMB-KOH2HKNNUM   = "344"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH2HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH2HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH2HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH2HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  19                      ) AND
                   ( COMB-KOH2HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  23                      ) AND
                   ( COMB-KOH2HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(2) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI2-M
                      END-IF
                   WHEN   "2"
                      IF   HKN-TSY-GAIFTNKBN      =  "0"
                        MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                        MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(2) =  9 )
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        END-IF
                      ELSE
                        MOVE  HKN-TSY-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                        MOVE  HKN-TSY-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                        MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                        MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(2) =  9 )
                              MOVE  HKN-TSY-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        ELSE
                              MOVE  HKN-TSY-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        END-IF
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-GAIFTNKBN       =  "0"
                        MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                        MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(2) =  9 )
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        END-IF
                      ELSE
                        MOVE  HKN-TNK-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                        MOVE  HKN-TNK-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                        MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                        MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(2) =  9 )
                              MOVE  HKN-TNK-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        ELSE
                              MOVE  HKN-TNK-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI2-M
                        END-IF
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
                 MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
                 MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
                 MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
                 MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
                 IF  (FLG-INGAI           = "1")
                 OR  (WK-INNAI-SANSHOU(2) =  9 )
                       MOVE  HKN-HON-GAIMGAIJGNGAK
                                          TO  MAX-KIN-KOHI2-M
                 ELSE
                       MOVE  HKN-HON-GAIMNAIJGNGAK
                                          TO  MAX-KIN-KOHI2-M
                 END-IF
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI2-K
             MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI2-K
             MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI2-D
             MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI2-M
             MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI2-D
             IF  (FLG-INGAI           = "1")
             OR  (WK-INNAI-SANSHOU(2) =  9 )
                   MOVE  HKN-HON-GAIMGAIJGNGAK
                                      TO  MAX-KIN-KOHI2-M
             ELSE
                   MOVE  HKN-HON-GAIMNAIJGNGAK
                                      TO  MAX-KIN-KOHI2-M
             END-IF
           END-IF.
           MOVE    MAX-KIN-KOHI2-M    TO  WK-TAIHI-MAX-KIN-KOHI2-M.
      *
           IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
                (FLG-KOUREI-KBN               =       "1" ))
           AND ( COMB-KOH2HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH2HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                                    20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI2-M             >   12000           )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH2HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    12000   TO    MAX-KIN-KOHI2-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH2HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH2HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH2HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH2HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF    WK-CYO-OKIKAE(2)  =  1
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
                IF   MAX-KIN-KOHI2-M   NOT = ZERO
                  IF   MAX-KIN-KOHI2-M   >   10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI2-D   NOT = ZERO
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
                  END-IF
                END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
                IF   MAX-KIN-KOHI2-M   NOT = ZERO
                  IF   MAX-KIN-KOHI2-M   >   20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI2-D   NOT = ZERO
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
                  END-IF
                END-IF
             END-IF
           END-IF.
      *
           IF  FLG-TOKU75 = 1 OR 2 OR 3
              IF  COMB-KOH2HKNNUM = "972"
                  MOVE   5000    TO    MAX-KIN-KOHI2-M-TOKU75
              END-IF
              IF  COMB-KOH2HKNNUM = "974"
                  MOVE   10000   TO    MAX-KIN-KOHI2-M-TOKU75
              END-IF
           END-IF.
      *
       2104-KOH2-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費３（金額）取込み処理                                *
      ******************************************************************
       2105-KOH3-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH3HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                    MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                    MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                    MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                    MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                    MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                    IF  (FLG-INGAI           = "1")
                    OR  (WK-INNAI-SANSHOU(3) =  9 )
                          MOVE  HKN-HON-GAIMGAIJGNGAK
                                             TO  MAX-KIN-KOHI3-M
                    ELSE
                          MOVE  HKN-HON-GAIMNAIJGNGAK
                                             TO  MAX-KIN-KOHI3-M
                    END-IF
                 WHEN   "2"
                    IF   HKN-TSY-GAIFTNKBN      =  "0"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(3) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      END-IF
                    ELSE
                      MOVE  HKN-TSY-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                      MOVE  HKN-TSY-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                      MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                      MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                      MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(3) =  9 )
                            MOVE  HKN-TSY-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      ELSE
                            MOVE  HKN-TSY-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      END-IF
                    END-IF
                 WHEN   "3"
                    IF  HKN-TNK-GAIFTNKBN       =  "0"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(3) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      END-IF
                    ELSE
                      MOVE  HKN-TNK-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                      MOVE  HKN-TNK-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                      MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                      MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                      MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(3) =  9 )
                            MOVE  HKN-TNK-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      ELSE
                            MOVE  HKN-TNK-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      END-IF
                    END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH3HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  11                      ) AND
                   ( COMB-KOH3HKNNUM   = "344"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH3HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH3HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH3HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH3HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  19                      ) AND
                   ( COMB-KOH3HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  23                      ) AND
                   ( COMB-KOH3HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(3) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI3-M
                      END-IF
                   WHEN   "2"
                      IF   HKN-TSY-GAIFTNKBN      =  "0"
                        MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                        MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(3) =  9 )
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        END-IF
                      ELSE
                        MOVE  HKN-TSY-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                        MOVE  HKN-TSY-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                        MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                        MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(3) =  9 )
                              MOVE  HKN-TSY-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        ELSE
                              MOVE  HKN-TSY-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        END-IF
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-GAIFTNKBN       =  "0"
                        MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                        MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(3) =  9 )
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        END-IF
                      ELSE
                        MOVE  HKN-TNK-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                        MOVE  HKN-TNK-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                        MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                        MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(3) =  9 )
                              MOVE  HKN-TNK-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        ELSE
                              MOVE  HKN-TNK-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI3-M
                        END-IF
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
                 MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
                 MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
                 MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
                 MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
                 IF  (FLG-INGAI           = "1")
                 OR  (WK-INNAI-SANSHOU(3) =  9 )
                       MOVE  HKN-HON-GAIMGAIJGNGAK
                                          TO  MAX-KIN-KOHI3-M
                 ELSE
                       MOVE  HKN-HON-GAIMNAIJGNGAK
                                          TO  MAX-KIN-KOHI3-M
                 END-IF
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI3-K
             MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI3-K
             MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI3-D
             MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI3-M
             MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI3-D
             IF  (FLG-INGAI           = "1")
             OR  (WK-INNAI-SANSHOU(3) =  9 )
                   MOVE  HKN-HON-GAIMGAIJGNGAK
                                      TO  MAX-KIN-KOHI3-M
             ELSE
                   MOVE  HKN-HON-GAIMNAIJGNGAK
                                      TO  MAX-KIN-KOHI3-M
             END-IF
           END-IF.
           MOVE    MAX-KIN-KOHI3-M    TO  WK-TAIHI-MAX-KIN-KOHI3-M.
      *
           IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
                (FLG-KOUREI-KBN               =       "1" ))
           AND ( COMB-KOH3HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH3HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                                    20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI3-M             >   12000           )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH3HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    12000   TO    MAX-KIN-KOHI3-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH3HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH3HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH3HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH3HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF    WK-CYO-OKIKAE(3)  =  1
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
                IF   MAX-KIN-KOHI3-M   NOT = ZERO
                  IF   MAX-KIN-KOHI3-M   >   10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI3-D   NOT = ZERO
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
                  END-IF
                END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
                IF   MAX-KIN-KOHI3-M   NOT = ZERO
                  IF   MAX-KIN-KOHI3-M   >   20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI3-D   NOT = ZERO
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
                  END-IF
                END-IF
             END-IF
           END-IF.
      *
           IF  FLG-TOKU75 = 1 OR 2 OR 3
              IF  COMB-KOH3HKNNUM = "972"
                  MOVE   5000    TO    MAX-KIN-KOHI3-M-TOKU75
              END-IF
              IF  COMB-KOH3HKNNUM = "974"
                  MOVE   10000   TO    MAX-KIN-KOHI3-M-TOKU75
              END-IF
           END-IF.
      *
       2105-KOH3-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費４（金額）取込み処理                                *
      ******************************************************************
       2106-KOH4-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH4HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                    MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                    MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                    MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                    MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                    MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                    IF  (FLG-INGAI           = "1")
                    OR  (WK-INNAI-SANSHOU(4) =  9 )
                          MOVE  HKN-HON-GAIMGAIJGNGAK
                                             TO  MAX-KIN-KOHI4-M
                    ELSE
                          MOVE  HKN-HON-GAIMNAIJGNGAK
                                             TO  MAX-KIN-KOHI4-M
                    END-IF
                 WHEN   "2"
                    IF   HKN-TSY-GAIFTNKBN      =  "0"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(4) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      END-IF
                    ELSE
                      MOVE  HKN-TSY-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                      MOVE  HKN-TSY-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                      MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                      MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                      MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(4) =  9 )
                            MOVE  HKN-TSY-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      ELSE
                            MOVE  HKN-TSY-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      END-IF
                    END-IF
                 WHEN   "3"
                    IF  HKN-TNK-GAIFTNKBN       =  "0"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(4) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      END-IF
                    ELSE
                      MOVE  HKN-TNK-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                      MOVE  HKN-TNK-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                      MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                      MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                      MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(4) =  9 )
                            MOVE  HKN-TNK-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      ELSE
                            MOVE  HKN-TNK-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      END-IF
                    END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH4HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  11                      ) AND
                   ( COMB-KOH4HKNNUM   = "344"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH4HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH4HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH4HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH4HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  19                      ) AND
                   ( COMB-KOH4HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  23                      ) AND
                   ( COMB-KOH4HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                      MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                      MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                      MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                      MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                      IF  (FLG-INGAI           = "1")
                      OR  (WK-INNAI-SANSHOU(4) =  9 )
                            MOVE  HKN-HON-GAIMGAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      ELSE
                            MOVE  HKN-HON-GAIMNAIJGNGAK
                                               TO  MAX-KIN-KOHI4-M
                      END-IF
                   WHEN   "2"
                      IF   HKN-TSY-GAIFTNKBN      =  "0"
                        MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                        MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(4) =  9 )
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        END-IF
                      ELSE
                        MOVE  HKN-TSY-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                        MOVE  HKN-TSY-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                        MOVE  HKN-TSY-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                        MOVE  HKN-TSY-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TSY-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(4) =  9 )
                              MOVE  HKN-TSY-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        ELSE
                              MOVE  HKN-TSY-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        END-IF
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-GAIFTNKBN       =  "0"
                        MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                        MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                        MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                        MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(4) =  9 )
                              MOVE  HKN-HON-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        ELSE
                              MOVE  HKN-HON-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        END-IF
                      ELSE
                        MOVE  HKN-TNK-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                        MOVE  HKN-TNK-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                        MOVE  HKN-TNK-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                        MOVE  HKN-TNK-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TNK-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                        IF  (FLG-INGAI           = "1")
                        OR  (WK-INNAI-SANSHOU(4) =  9 )
                              MOVE  HKN-TNK-GAIMGAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        ELSE
                              MOVE  HKN-TNK-GAIMNAIJGNGAK
                                                 TO  MAX-KIN-KOHI4-M
                        END-IF
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
                 MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
                 MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
                 MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
                 MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
                 IF  (FLG-INGAI           = "1")
                 OR  (WK-INNAI-SANSHOU(4) =  9 )
                       MOVE  HKN-HON-GAIMGAIJGNGAK
                                          TO  MAX-KIN-KOHI4-M
                 ELSE
                       MOVE  HKN-HON-GAIMNAIJGNGAK
                                          TO  MAX-KIN-KOHI4-M
                 END-IF
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-GAIKKOTGAK TO  TEI-KIN-KOHI4-K
             MOVE  HKN-HON-GAIKJGNGAK TO  MAX-KIN-KOHI4-K
             MOVE  HKN-HON-GAIDJGNCNT TO  MAX-KAI-KOHI4-D
             MOVE  HKN-HON-GAIMJGNCNT TO  MAX-KAI-KOHI4-M
             MOVE  HKN-HON-GAIDJGNGAK TO  MAX-KIN-KOHI4-D
             IF  (FLG-INGAI           = "1")
             OR  (WK-INNAI-SANSHOU(4) =  9 )
                   MOVE  HKN-HON-GAIMGAIJGNGAK
                                      TO  MAX-KIN-KOHI4-M
             ELSE
                   MOVE  HKN-HON-GAIMNAIJGNGAK
                                      TO  MAX-KIN-KOHI4-M
             END-IF
           END-IF.
           MOVE    MAX-KIN-KOHI4-M    TO  WK-TAIHI-MAX-KIN-KOHI4-M.
      *
           IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
                (FLG-KOUREI-KBN               =       "1" ))
           AND ( COMB-KOH4HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH4HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                                    20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI4-M             >   12000           )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH4HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    12000   TO    MAX-KIN-KOHI4-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH4HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH4HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH4HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH4HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF    WK-CYO-OKIKAE(4)  =  1
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
                IF   MAX-KIN-KOHI4-M   NOT = ZERO
                  IF   MAX-KIN-KOHI4-M   >   10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI4-D   NOT = ZERO
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
                  END-IF
                END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
                IF   MAX-KIN-KOHI4-M   NOT = ZERO
                  IF   MAX-KIN-KOHI4-M   >   20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI4-D   NOT = ZERO
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
                  END-IF
                END-IF
             END-IF
           END-IF.
      *
           IF  FLG-TOKU75 = 1 OR 2 OR 3
              IF  COMB-KOH4HKNNUM = "972"
                  MOVE   5000    TO    MAX-KIN-KOHI4-M-TOKU75
              END-IF
              IF  COMB-KOH4HKNNUM = "974"
                  MOVE   10000   TO    MAX-KIN-KOHI4-M-TOKU75
              END-IF
           END-IF.
      *
       2106-KOH4-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        患者公費負担（金額）取込み処理                                *
      ******************************************************************
       2107-KOHFTN-KINGAKU-SEC           SECTION.
      *
           INITIALIZE                   WK-TAIHI-JGNGAKEN-OCC.
           INITIALIZE                   WK-TAIHI-JGNKOHFLG-OCC.
      *
           INITIALIZE                   WK-JIRITU-TBL.
           MOVE       ZERO     TO       WK-TOTORI-JIRITU.
      *
           PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                      UNTIL    (KOH-IDX    >      4)
      *
             IF ( COMB-KOHHKNNUM(KOH-IDX)      = "015" OR "016" 
                                                       OR "012"      )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "051"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200310")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "052"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200504")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "021"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200604")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "024" OR "079" )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200610")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "038" OR "025" )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200804")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "054"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "201501")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                              >= "1" AND <= "8" )  AND
                 (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)  NOT =  ZERO  )    )
      *
                MOVE       ZERO           TO  WK-GAIJGNGAK
      *
      *         公費月上限額取得
                INITIALIZE                    LNK-ORCSJGNGET-REC
                MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
                MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
                MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
                MOVE  COMB-KOHHKNNUM(KOH-IDX)
                                          TO  LNK-ORCSJGNGET-KOHHKNNUM
                MOVE  COMB-KOHID(KOH-IDX) TO  LNK-ORCSJGNGET-KOHID
                MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
                IF  COMB-KOHHKNNUM(KOH-IDX)(1:1)  >=  "1" AND <=  "8"
                   MOVE  WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                          TO  LNK-ORCSJGNGET-SETKBN
                   MOVE  WK-KOHJGNGET-TEKIYOFLG(KOH-IDX)
                                          TO  LNK-ORCSJGNGET-SETKBN2
                END-IF
      *
                CALL    "ORCSJGNGET"      USING
                                          LNK-ORCSJGNGET-REC
                                          SPA-AREA
      *
                IF    LNK-ORCSJGNGET-RC   =   ZERO
      *
                   IF  (LNK-SYU-SRYYMD(1:6)     >= "200804"      )
                   AND (COMB-KOHHKNNUM(KOH-IDX)  = "015" OR "016"
                                                         OR "021")
                      IF  LNK-ORCSJGNGET-GAIJGNGAK
                                 = 9999999 OR 999999 OR 40200
                          CONTINUE
                      ELSE
                          MOVE    1    TO    WK-TOTORI-JIRITU
                      END-IF
                   END-IF
      *            全国公費の減額
                   IF    WK-GENGAKUKBN    NOT  =   ZERO
                   AND   WK-GENGAKUKBN-KEISAN  =   ZERO
                       PERFORM   21071-KOHFTN-KINGAKU-GEN-SEC
                   END-IF
                   MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                          TO  WK-GAIJGNGAK
                   EVALUATE   KOH-IDX
                      WHEN  1
                        MOVE   WK-GAIJGNGAK        TO   MAX-KIN-KOHI1-M
                        MOVE   WK-GAIJGNGAK        TO
                                            WK-TAIHI-JGNGAKEN(KOH-IDX)
                        MOVE     "1"   TO    COMB-KOH1-GAIJGNKBN
                        IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" ) OR
                            (FLG-KOUREI-KBN               =   "1" )
                            IF  COMB-KOHHKNNUM(KOH-IDX) = "012" OR "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI1-M > WK-SEIHO-GENDO)
                                MOVE  WK-SEIHO-GENDO
                                                 TO   MAX-KIN-KOHI1-M
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                IF  WK-GAIJGNGAK > WK-SEIHO-GENDO-TOKU75
                                  MOVE  WK-SEIHO-GENDO-TOKU75
                                         TO   MAX-KIN-KOHI1-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI1-M-TOKU75
                                END-IF
                              END-IF
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) = "038") AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200804"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "052" OR "054"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "201501"))
                              OR  ((WK-TOKATUKAI(KOH-IDX)   =  1   ) AND
                                   (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                            =  2   ))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI1-M    >
                                                      WK-KOH-GENDOGAKU)
                                 AND ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                             = "0" ) OR
                                      (WK-TOKATUKAI(KOH-IDX) =  1  )  )
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                   MOVE  WK-KOH-GENDOGAKU
                                                 TO   MAX-KIN-KOHI1-M
                                 END-IF
                                 IF  (FLG-TOKU75 = 1 OR 2          )
                                 AND ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                             = "0") OR
                                      (WK-TOKATUKAI(KOH-IDX) =  1 ))
                                   IF  WK-GAIJGNGAK >
                                             WK-KOH-GENDOGAKU-TOKU75
                                     MOVE  WK-KOH-GENDOGAKU-TOKU75
                                         TO   MAX-KIN-KOHI1-M-TOKU75
                                   ELSE
                                     MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI1-M-TOKU75
                                   END-IF
                                 END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(1)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(1)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                            IF    COMB-KOHHKNNUM(KOH-IDX) = "012"
                                                         OR "025"
                              IF  MAX-KIN-KOHI1-M > WK-SEIHO-GENDO70
                                MOVE WK-SEIHO-GENDO70
                                     TO MAX-KIN-KOHI1-M
                              END-IF
                              IF    FLG-TOKU75 = 3
                                IF  WK-GAIJGNGAK >
                                             WK-SEIHO-GENDO70-TOKU75
                                  MOVE  WK-SEIHO-GENDO70-TOKU75
                                         TO   MAX-KIN-KOHI1-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI1-M-TOKU75
                                END-IF
                              END-IF
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) = "038") AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200804"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "052" OR "054"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "201501"))
                              OR  ((WK-TOKATUKAI(KOH-IDX)   =  1   ) AND
                                   (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                            =  2   ))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI1-M    >
                                                    WK-GEN70-GENDOGAKU)
                                 AND ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                             = "0" ) OR
                                      (WK-TOKATUKAI(KOH-IDX) =  1  )  )
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                   MOVE  WK-GEN70-GENDOGAKU
                                      TO MAX-KIN-KOHI1-M
                                 END-IF
                                 IF  (FLG-TOKU75 = 3               )
                                 AND ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                             = "0") OR
                                      (WK-TOKATUKAI(KOH-IDX) =  1 ))
                                   IF  WK-GAIJGNGAK >
                                             WK-GEN70-GENDOGAKU-TOKU75
                                     MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                         TO   MAX-KIN-KOHI1-M-TOKU75
                                   ELSE
                                     MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI1-M-TOKU75
                                   END-IF
                                 END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                 >= "1" AND <= "8")
                        AND (WK-TOKATUKAI(KOH-IDX)  =  ZERO       )
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                         NOT = 2  )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200905"      )
                            IF (COMB-KOH2HKNNUM = "972") OR
                               (COMB-KOH3HKNNUM = "972") OR
                               (COMB-KOH4HKNNUM = "972")
                             IF   MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO
                               MOVE  WK-CYOKI-GENDO
                                                 TO  MAX-KIN-KOHI1-M
                             END-IF
                            END-IF
                            IF (COMB-KOH2HKNNUM = "974") OR
                               (COMB-KOH3HKNNUM = "974") OR
                               (COMB-KOH4HKNNUM = "974")
                             IF   MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO2
                               MOVE  WK-CYOKI-GENDO2
                                                 TO  MAX-KIN-KOHI1-M
                             END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI1-M = 9999999 OR 999999
                              MOVE  1  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  ZERO
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                            ELSE
                              MOVE  2  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                            END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                >=  "1" AND <=  "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX) =   2 )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF  (COMB-KOH1HKNNUM      = "038"     )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200804"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-KANEN-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF  (COMB-KOH1HKNNUM      = "052" OR "054")
                        AND (LNK-SYU-SRYYMD(1:6) >= "201501"      )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-TOKUSITU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" ) OR
                            (FLG-KOUREI-KBN               =   "1" )
                         IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                         AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                         AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  1        )
                            IF    MAX-KIN-KOHI1-M    >  WK-KOH-GENDOGAKU
                                MOVE  WK-KOH-GENDOGAKU
                                                   TO   MAX-KIN-KOHI1-M
                            END-IF
                            IF  FLG-TOKU75 = 1 OR 2
                              IF  WK-GAIJGNGAK >
                                        WK-KOH-GENDOGAKU-TOKU75
                                MOVE  WK-KOH-GENDOGAKU-TOKU75
                                    TO   MAX-KIN-KOHI1-M-TOKU75
                              ELSE
                                MOVE  WK-GAIJGNGAK
                                    TO   MAX-KIN-KOHI1-M-TOKU75
                              END-IF
                            END-IF
                         END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                         IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                         AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  1        )
                            IF    MAX-KIN-KOHI1-M  >  WK-GEN70-GENDOGAKU
                              MOVE    WK-GEN70-GENDOGAKU
                                      TO MAX-KIN-KOHI1-M
                              EVALUATE  WK-GEN70-GENDOGAKU
                               WHEN       80100
                                 MOVE  WK-ZENGAKU TO WK-KOUREI-IRYOHI70K
                                 MOVE  2          TO FLG-IRYOHI70K
                              END-EVALUATE
                            END-IF
                            IF  FLG-TOKU75 = 3
                              IF  WK-GAIJGNGAK >
                                        WK-GEN70-GENDOGAKU-TOKU75
                                MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                    TO   MAX-KIN-KOHI1-M-TOKU75
                              ELSE
                                MOVE  WK-GAIJGNGAK
                                    TO   MAX-KIN-KOHI1-M-TOKU75
                              END-IF
                              EVALUATE  WK-GEN70-GENDOGAKU-TOKU75
                               WHEN       40050
                                 MOVE  WK-ZENGAKU TO
                                       WK-KOUREI-IRYOHI70K-TOKU75
                              END-EVALUATE
                            END-IF
                         END-IF
                        END-IF
                        IF  ( COMB-KOH1HKNNUM  = "015" OR "016"
                                                       OR "021" )
                        AND ((COMB-KOH2HKNNUM  = "972") OR
                             (COMB-KOH3HKNNUM  = "972") OR
                             (COMB-KOH4HKNNUM  = "972")         )
                          IF  (LNK-SYU-SRYYMD(1:6)   >= "200604")
                          AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  2)
                           CONTINUE
                          ELSE
                           IF   MAX-KIN-KOHI1-M   >  WK-CYOKI-GENDO
                              MOVE  WK-CYOKI-GENDO  TO  MAX-KIN-KOHI1-M
                              MOVE  ZERO   TO  WK-KOUREI-IRYOHI70K
                              MOVE  ZERO            TO  FLG-IRYOHI70K
                           END-IF
                          END-IF
                        END-IF
                        IF  ( COMB-KOH1HKNNUM  = "015" OR "016"
                                                       OR "021" )
                        AND ((COMB-KOH2HKNNUM  = "974") OR
                             (COMB-KOH3HKNNUM  = "974") OR
                             (COMB-KOH4HKNNUM  = "974")         )
                          IF  (LNK-SYU-SRYYMD(1:6)   >= "200604")
                          AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  2)
                           CONTINUE
                          ELSE
                           IF   MAX-KIN-KOHI1-M   >  WK-CYOKI-GENDO2
                              MOVE  WK-CYOKI-GENDO2 TO  MAX-KIN-KOHI1-M
                              MOVE  ZERO   TO  WK-KOUREI-IRYOHI70K
                              MOVE  ZERO            TO  FLG-IRYOHI70K
                           END-IF
                          END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI1-M = 9999999 OR 999999
                              IF  LNK-SYU-SRYYMD(1:6)  >= "200610"
                                MOVE  80100   TO   MAX-KIN-KOHI1-M
                                MOVE  WK-ZENGAKU  TO  WK-IRYOHI
                                MOVE  1           TO  FLG-IRYOHI
                              ELSE
                                MOVE  72300   TO   MAX-KIN-KOHI1-M
                                MOVE  WK-ZENGAKU  TO  WK-IRYOHI
                                MOVE  1           TO  FLG-IRYOHI
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                          IF   WK-2010-JIRITUKBN(2) =  "1"
                            MOVE  TEI-KIN-KOHI2-K  TO  TEI-KIN-KOHI1-K
                            MOVE  MAX-KIN-KOHI2-K  TO  MAX-KIN-KOHI1-K
                            MOVE  MAX-KAI-KOHI2-D  TO  MAX-KAI-KOHI1-D
                            MOVE  MAX-KAI-KOHI2-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI2-D  TO  MAX-KIN-KOHI1-D
                            IF   FLG-CHIHOU2(2) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI1-M
                            ELSE
                              MOVE MAX-KIN-KOHI2-M TO  MAX-KIN-KOHI1-M
                            END-IF
                            MOVE  ZERO           TO  WK-IRYOHI
                            MOVE  ZERO           TO  FLG-IRYOHI
                            MOVE  ZERO   TO WK-KOUREI-IRYOHI70K
                            MOVE  ZERO   TO FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                          IF   WK-2010-JIRITUKBN(3) =  "1"
                            MOVE  TEI-KIN-KOHI3-K  TO  TEI-KIN-KOHI1-K
                            MOVE  MAX-KIN-KOHI3-K  TO  MAX-KIN-KOHI1-K
                            MOVE  MAX-KAI-KOHI3-D  TO  MAX-KAI-KOHI1-D
                            MOVE  MAX-KAI-KOHI3-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI3-D  TO  MAX-KIN-KOHI1-D
                            IF   FLG-CHIHOU2(3) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI1-M
                            ELSE
                              MOVE MAX-KIN-KOHI3-M TO  MAX-KIN-KOHI1-M
                            END-IF
                            MOVE  ZERO           TO  WK-IRYOHI
                            MOVE  ZERO           TO  FLG-IRYOHI
                            MOVE  ZERO   TO WK-KOUREI-IRYOHI70K
                            MOVE  ZERO   TO FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                          IF   WK-2010-JIRITUKBN(4) =  "1"
                            MOVE  TEI-KIN-KOHI4-K  TO  TEI-KIN-KOHI1-K
                            MOVE  MAX-KIN-KOHI4-K  TO  MAX-KIN-KOHI1-K
                            MOVE  MAX-KAI-KOHI4-D  TO  MAX-KAI-KOHI1-D
                            MOVE  MAX-KAI-KOHI4-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI4-D  TO  MAX-KIN-KOHI1-D
                            IF   FLG-CHIHOU2(4) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI1-M
                            ELSE
                              MOVE MAX-KIN-KOHI4-M TO  MAX-KIN-KOHI1-M
                            END-IF
                            MOVE  ZERO           TO  WK-IRYOHI
                            MOVE  ZERO           TO  FLG-IRYOHI
                            MOVE  ZERO   TO WK-KOUREI-IRYOHI70K
                            MOVE  ZERO   TO FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                        END-IF
                        IF  (WK-1001-PREFNUM      =  09     )
                        AND (COMB-KOH1HKNNUM      = "016"   )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200604")
                          IF   COMB-KOH2HKNNUM =  "116" OR "216"
                            MOVE  TEI-KIN-KOHI2-K  TO  TEI-KIN-KOHI1-K
                            MOVE  MAX-KIN-KOHI2-K  TO  MAX-KIN-KOHI1-K
                            MOVE  MAX-KAI-KOHI2-D  TO  MAX-KAI-KOHI1-D
                            MOVE  MAX-KAI-KOHI2-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI2-D  TO  MAX-KIN-KOHI1-D
                            MOVE  MAX-KIN-KOHI2-M  TO  MAX-KIN-KOHI1-M
                            MOVE  ZERO           TO  WK-IRYOHI
                            MOVE  ZERO           TO  FLG-IRYOHI
                            MOVE  ZERO   TO WK-KOUREI-IRYOHI70K
                            MOVE  ZERO   TO FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                          IF   COMB-KOH3HKNNUM =  "116" OR "216"
                            MOVE  TEI-KIN-KOHI3-K  TO  TEI-KIN-KOHI1-K
                            MOVE  MAX-KIN-KOHI3-K  TO  MAX-KIN-KOHI1-K
                            MOVE  MAX-KAI-KOHI3-D  TO  MAX-KAI-KOHI1-D
                            MOVE  MAX-KAI-KOHI3-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI3-D  TO  MAX-KIN-KOHI1-D
                            MOVE  MAX-KIN-KOHI3-M  TO  MAX-KIN-KOHI1-M
                            MOVE  ZERO           TO  WK-IRYOHI
                            MOVE  ZERO           TO  FLG-IRYOHI
                            MOVE  ZERO   TO WK-KOUREI-IRYOHI70K
                            MOVE  ZERO   TO FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                          IF   COMB-KOH4HKNNUM =  "116" OR "216"
                            MOVE  TEI-KIN-KOHI4-K  TO  TEI-KIN-KOHI1-K
                            MOVE  MAX-KIN-KOHI4-K  TO  MAX-KIN-KOHI1-K
                            MOVE  MAX-KAI-KOHI4-D  TO  MAX-KAI-KOHI1-D
                            MOVE  MAX-KAI-KOHI4-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI4-D  TO  MAX-KIN-KOHI1-D
                            MOVE  MAX-KIN-KOHI4-M  TO  MAX-KIN-KOHI1-M
                            MOVE  ZERO           TO  WK-IRYOHI
                            MOVE  ZERO           TO  FLG-IRYOHI
                            MOVE  ZERO   TO WK-KOUREI-IRYOHI70K
                            MOVE  ZERO   TO FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                        END-IF
                      WHEN  2
                        MOVE   WK-GAIJGNGAK        TO   MAX-KIN-KOHI2-M
                        MOVE   WK-GAIJGNGAK        TO
                                            WK-TAIHI-JGNGAKEN(KOH-IDX)
                        MOVE     "1"   TO    COMB-KOH2-GAIJGNKBN
                        IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" ) OR
                            (FLG-KOUREI-KBN               =   "1" )
                            IF  COMB-KOHHKNNUM(KOH-IDX) = "012" OR "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI2-M > WK-SEIHO-GENDO)
                                MOVE  WK-SEIHO-GENDO
                                                 TO   MAX-KIN-KOHI2-M
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                IF  WK-GAIJGNGAK > WK-SEIHO-GENDO-TOKU75
                                  MOVE  WK-SEIHO-GENDO-TOKU75
                                         TO   MAX-KIN-KOHI2-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI2-M-TOKU75
                                END-IF
                              END-IF
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "054"                   ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "201501"))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI2-M    >
                                                      WK-KOH-GENDOGAKU)
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                                 = "0")
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                   MOVE  WK-KOH-GENDOGAKU
                                                 TO   MAX-KIN-KOHI2-M
                                 END-IF
                                 IF  (FLG-TOKU75 = 1 OR 2          )
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                                   IF  WK-GAIJGNGAK >
                                             WK-KOH-GENDOGAKU-TOKU75
                                     MOVE  WK-KOH-GENDOGAKU-TOKU75
                                         TO   MAX-KIN-KOHI2-M-TOKU75
                                   ELSE
                                     MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI2-M-TOKU75
                                   END-IF
                                 END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(2)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(2)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                            IF    COMB-KOHHKNNUM(KOH-IDX) = "012"
                                                         OR "025"
                              IF  MAX-KIN-KOHI2-M > WK-SEIHO-GENDO70
                                MOVE WK-SEIHO-GENDO70
                                     TO MAX-KIN-KOHI2-M
                              END-IF
                              IF    FLG-TOKU75 = 3
                                IF  WK-GAIJGNGAK >
                                             WK-SEIHO-GENDO70-TOKU75
                                  MOVE  WK-SEIHO-GENDO70-TOKU75
                                         TO   MAX-KIN-KOHI2-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI2-M-TOKU75
                                END-IF
                              END-IF
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "054"                   ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "201501"))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI2-M    >
                                                    WK-GEN70-GENDOGAKU)
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                                 = "0")
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                   MOVE  WK-GEN70-GENDOGAKU
                                      TO MAX-KIN-KOHI2-M
                                 END-IF
                                 IF  (FLG-TOKU75 = 3               )
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                                   IF  WK-GAIJGNGAK >
                                             WK-GEN70-GENDOGAKU-TOKU75
                                     MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                         TO   MAX-KIN-KOHI2-M-TOKU75
                                   ELSE
                                     MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI2-M-TOKU75
                                   END-IF
                                 END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                 >= "1" AND <= "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                         NOT = 2  )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200905"      )
                            IF (COMB-KOH1HKNNUM = "972") OR
                               (COMB-KOH3HKNNUM = "972") OR
                               (COMB-KOH4HKNNUM = "972")
                             IF   MAX-KIN-KOHI2-M  >  WK-CYOKI-GENDO
                               MOVE  WK-CYOKI-GENDO
                                                 TO  MAX-KIN-KOHI2-M
                             END-IF
                            END-IF
                            IF (COMB-KOH1HKNNUM = "974") OR
                               (COMB-KOH3HKNNUM = "974") OR
                               (COMB-KOH4HKNNUM = "974")
                             IF   MAX-KIN-KOHI2-M  >  WK-CYOKI-GENDO2
                               MOVE  WK-CYOKI-GENDO2
                                                 TO  MAX-KIN-KOHI2-M
                             END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI2-M = 9999999 OR 999999
                              MOVE  1  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  ZERO
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                            ELSE
                              MOVE  2  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                            END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                >=  "1" AND <=  "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX) =   2 )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF  (COMB-KOH2HKNNUM      = "054"   )
                        AND (LNK-SYU-SRYYMD(1:6) >= "201501")
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-TOKUSITU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" ) OR
                            (FLG-KOUREI-KBN               =   "1" )
                         IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                         AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                         AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  1        )
                            IF    MAX-KIN-KOHI2-M    >  WK-KOH-GENDOGAKU
                                MOVE  WK-KOH-GENDOGAKU
                                                   TO   MAX-KIN-KOHI2-M
                            END-IF
                         END-IF
                        END-IF
                        IF  ( COMB-KOH2HKNNUM  = "015" OR "016"
                                                       OR "021" )
                        AND ((COMB-KOH1HKNNUM  = "972") OR
                             (COMB-KOH3HKNNUM  = "972") OR
                             (COMB-KOH4HKNNUM  = "972")         )
                          IF  (LNK-SYU-SRYYMD(1:6)   >= "200604")
                          AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  2)
                           CONTINUE
                          ELSE
                           IF   MAX-KIN-KOHI2-M   >  WK-CYOKI-GENDO
                              MOVE  WK-CYOKI-GENDO  TO  MAX-KIN-KOHI2-M
                           END-IF
                          END-IF
                        END-IF
                        IF  ( COMB-KOH2HKNNUM  = "015" OR "016"
                                                       OR "021" )
                        AND ((COMB-KOH1HKNNUM  = "974") OR
                             (COMB-KOH3HKNNUM  = "974") OR
                             (COMB-KOH4HKNNUM  = "974")         )
                          IF  (LNK-SYU-SRYYMD(1:6)   >= "200604")
                          AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  2)
                           CONTINUE
                          ELSE
                           IF   MAX-KIN-KOHI2-M   >  WK-CYOKI-GENDO2
                              MOVE  WK-CYOKI-GENDO2 TO  MAX-KIN-KOHI2-M
                           END-IF
                          END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI2-M = 9999999 OR 999999
                              IF  LNK-SYU-SRYYMD(1:6)  >= "200610"
                                MOVE  80100   TO   MAX-KIN-KOHI2-M
                              ELSE
                                MOVE  72300   TO   MAX-KIN-KOHI2-M
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                          IF   WK-2010-JIRITUKBN(3) =  "1"
                            MOVE  TEI-KIN-KOHI3-K  TO  TEI-KIN-KOHI2-K
                            MOVE  MAX-KIN-KOHI3-K  TO  MAX-KIN-KOHI2-K
                            MOVE  MAX-KAI-KOHI3-D  TO  MAX-KAI-KOHI2-D
                            MOVE  MAX-KAI-KOHI3-M  TO  MAX-KAI-KOHI2-M
                            MOVE  MAX-KIN-KOHI3-D  TO  MAX-KIN-KOHI2-D
                            IF   FLG-CHIHOU2(3) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI2-M
                            ELSE
                              MOVE MAX-KIN-KOHI3-M TO  MAX-KIN-KOHI2-M
                            END-IF
                            MOVE  ZERO           TO  WK-IRYOHI
                            MOVE  ZERO           TO  FLG-IRYOHI
                          END-IF
                          IF   WK-2010-JIRITUKBN(4) =  "1"
                            MOVE  TEI-KIN-KOHI4-K  TO  TEI-KIN-KOHI2-K
                            MOVE  MAX-KIN-KOHI4-K  TO  MAX-KIN-KOHI2-K
                            MOVE  MAX-KAI-KOHI4-D  TO  MAX-KAI-KOHI2-D
                            MOVE  MAX-KAI-KOHI4-M  TO  MAX-KAI-KOHI2-M
                            MOVE  MAX-KIN-KOHI4-D  TO  MAX-KIN-KOHI2-D
                            IF   FLG-CHIHOU2(4) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI2-M
                            ELSE
                              MOVE MAX-KIN-KOHI4-M TO  MAX-KIN-KOHI2-M
                            END-IF
                            MOVE  ZERO           TO  WK-IRYOHI
                            MOVE  ZERO           TO  FLG-IRYOHI
                          END-IF
                        END-IF
                      WHEN  3
                        MOVE   WK-GAIJGNGAK        TO   MAX-KIN-KOHI3-M
                        MOVE   WK-GAIJGNGAK        TO
                                            WK-TAIHI-JGNGAKEN(KOH-IDX)
                        MOVE     "1"   TO    COMB-KOH3-GAIJGNKBN
                        IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" ) OR
                            (FLG-KOUREI-KBN               =   "1" )
                            IF  COMB-KOHHKNNUM(KOH-IDX) = "012" OR "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI3-M > WK-SEIHO-GENDO)
                                MOVE  WK-SEIHO-GENDO
                                                 TO   MAX-KIN-KOHI3-M
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                IF  WK-GAIJGNGAK > WK-SEIHO-GENDO-TOKU75
                                  MOVE  WK-SEIHO-GENDO-TOKU75
                                         TO   MAX-KIN-KOHI3-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI3-M-TOKU75
                                END-IF
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI3-M    >
                                                   WK-KOH-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                MOVE  WK-KOH-GENDOGAKU
                                              TO   MAX-KIN-KOHI3-M
                              END-IF
                              IF  (FLG-TOKU75 = 1 OR 2          )
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                           = "0")
                                IF  WK-GAIJGNGAK >
                                          WK-KOH-GENDOGAKU-TOKU75
                                  MOVE  WK-KOH-GENDOGAKU-TOKU75
                                      TO   MAX-KIN-KOHI3-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                      TO   MAX-KIN-KOHI3-M-TOKU75
                                END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(3)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(3)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                            IF    COMB-KOHHKNNUM(KOH-IDX) = "012"
                                                         OR "025"
                              IF  MAX-KIN-KOHI3-M > WK-SEIHO-GENDO70
                                MOVE WK-SEIHO-GENDO70
                                     TO MAX-KIN-KOHI3-M
                              END-IF
                              IF    FLG-TOKU75 = 3
                                IF  WK-GAIJGNGAK >
                                             WK-SEIHO-GENDO70-TOKU75
                                  MOVE  WK-SEIHO-GENDO70-TOKU75
                                         TO   MAX-KIN-KOHI3-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI3-M-TOKU75
                                END-IF
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI3-M    >
                                                 WK-GEN70-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                MOVE  WK-GEN70-GENDOGAKU
                                   TO MAX-KIN-KOHI3-M
                              END-IF
                              IF  (FLG-TOKU75 = 3               )
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                           = "0")
                                IF  WK-GAIJGNGAK >
                                          WK-GEN70-GENDOGAKU-TOKU75
                                  MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                      TO   MAX-KIN-KOHI3-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                      TO   MAX-KIN-KOHI3-M-TOKU75
                                END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                 >= "1" AND <= "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                         NOT = 2  )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200905"      )
                            IF (COMB-KOH1HKNNUM = "972") OR
                               (COMB-KOH2HKNNUM = "972") OR
                               (COMB-KOH4HKNNUM = "972")
                             IF   MAX-KIN-KOHI3-M  >  WK-CYOKI-GENDO
                               MOVE  WK-CYOKI-GENDO
                                                 TO  MAX-KIN-KOHI3-M
                             END-IF
                            END-IF
                            IF (COMB-KOH1HKNNUM = "974") OR
                               (COMB-KOH2HKNNUM = "974") OR
                               (COMB-KOH4HKNNUM = "974")
                             IF   MAX-KIN-KOHI3-M  >  WK-CYOKI-GENDO2
                               MOVE  WK-CYOKI-GENDO2
                                                 TO  MAX-KIN-KOHI3-M
                             END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                >=  "1" AND <=  "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX) =   2 )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                      WHEN  4
                        MOVE   WK-GAIJGNGAK        TO   MAX-KIN-KOHI4-M
                        MOVE   WK-GAIJGNGAK        TO
                                            WK-TAIHI-JGNGAKEN(KOH-IDX)
                        MOVE     "1"   TO    COMB-KOH4-GAIJGNKBN
                        IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" ) OR
                            (FLG-KOUREI-KBN               =   "1" )
                            IF  COMB-KOHHKNNUM(KOH-IDX) = "012" OR "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI4-M > WK-SEIHO-GENDO)
                                MOVE  WK-SEIHO-GENDO
                                                 TO   MAX-KIN-KOHI4-M
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                IF  WK-GAIJGNGAK > WK-SEIHO-GENDO-TOKU75
                                  MOVE  WK-SEIHO-GENDO-TOKU75
                                         TO   MAX-KIN-KOHI4-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI4-M-TOKU75
                                END-IF
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI4-M    >
                                                   WK-KOH-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                MOVE  WK-KOH-GENDOGAKU
                                              TO   MAX-KIN-KOHI4-M
                              END-IF
                              IF  (FLG-TOKU75 = 1 OR 2          )
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                           = "0")
                                IF  WK-GAIJGNGAK >
                                          WK-KOH-GENDOGAKU-TOKU75
                                  MOVE  WK-KOH-GENDOGAKU-TOKU75
                                      TO   MAX-KIN-KOHI4-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                      TO   MAX-KIN-KOHI4-M-TOKU75
                                END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(4)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(4)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                            IF    COMB-KOHHKNNUM(KOH-IDX) = "012"
                                                         OR "025"
                              IF  MAX-KIN-KOHI4-M > WK-SEIHO-GENDO70
                                MOVE WK-SEIHO-GENDO70
                                     TO MAX-KIN-KOHI4-M
                              END-IF
                              IF    FLG-TOKU75 = 3
                                IF  WK-GAIJGNGAK >
                                             WK-SEIHO-GENDO70-TOKU75
                                  MOVE  WK-SEIHO-GENDO70-TOKU75
                                         TO   MAX-KIN-KOHI4-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                         TO   MAX-KIN-KOHI4-M-TOKU75
                                END-IF
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI4-M    >
                                                 WK-GEN70-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                MOVE  WK-GEN70-GENDOGAKU
                                   TO MAX-KIN-KOHI4-M
                              END-IF
                              IF  (FLG-TOKU75 = 3               )
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                           = "0")
                                IF  WK-GAIJGNGAK >
                                          WK-GEN70-GENDOGAKU-TOKU75
                                  MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                      TO   MAX-KIN-KOHI4-M-TOKU75
                                ELSE
                                  MOVE  WK-GAIJGNGAK
                                      TO   MAX-KIN-KOHI4-M-TOKU75
                                END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                 >= "1" AND <= "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                         NOT = 2  )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200905"      )
                            IF (COMB-KOH1HKNNUM = "972") OR
                               (COMB-KOH2HKNNUM = "972") OR
                               (COMB-KOH3HKNNUM = "972")
                             IF   MAX-KIN-KOHI4-M  >  WK-CYOKI-GENDO
                               MOVE  WK-CYOKI-GENDO
                                                 TO  MAX-KIN-KOHI4-M
                             END-IF
                            END-IF
                            IF (COMB-KOH1HKNNUM = "974") OR
                               (COMB-KOH2HKNNUM = "974") OR
                               (COMB-KOH3HKNNUM = "974")
                             IF   MAX-KIN-KOHI4-M  >  WK-CYOKI-GENDO2
                               MOVE  WK-CYOKI-GENDO2
                                                 TO  MAX-KIN-KOHI4-M
                             END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                >=  "1" AND <=  "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX) =   2 )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                   END-EVALUATE
                END-IF
      *
             END-IF
      *
      ***
      *
             IF  (KOH-IDX                =  1      )
             AND (MAX-KIN-KOHI1-M    NOT = ZERO    )
             AND (LNK-SYU-SRYYMD(1:6)   >= "201501")
                IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                       "015" OR "016" OR "021") AND
                     (WK-JIRITU-CYUKANSOU(KOH-IDX)    =  2    ))
                OR  ( COMB-KOHHKNNUM(KOH-IDX) = "052" OR "054"
                                    OR "024" OR "079" OR "038" )
      **********OR  ( COMB-KOHHKNNUM(KOH-IDX) = "051"          )
      **********OR  ( WK-TOKATUKAI(KOH-IDX)           =  1     )
      **********OR  ( WK-KOHJGNGET-TEKIYOFLG(KOH-IDX) =  1     )
      *
                   MOVE    1     TO     WK-TAIHI-JGNKOHFLG(KOH-IDX)
      *
                END-IF
             END-IF
      *
           END-PERFORM.
      *
      *    １９原爆一般
      *
           MOVE     ZERO   TO   WK-GAIKFTNRATE019.
      *
           IF    (COMB-HKNNUM            =  SPACE   )
           AND   (COMB-KOH1HKNNUM        =  "019"   )
           AND   (COMB-KOH2HKNNUM        =  SPACE   )
           AND   (COMB-KOH3HKNNUM        =  SPACE   )
           AND   (COMB-KOH4HKNNUM        =  SPACE   )
           AND   (LNK-SYU-SRYYMD(1:6)   >=  "201604")
             INITIALIZE                    LNK-ORCSJGNGET-REC
             MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
             MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
             MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
             MOVE  COMB-KOHHKNNUM(1)   TO  LNK-ORCSJGNGET-KOHHKNNUM
             MOVE  COMB-KOHID(1)       TO  LNK-ORCSJGNGET-KOHID
             MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
             IF  COMB-KOHHKNNUM(1)(1:1)  >=  "1" AND <=  "8"
               MOVE  WK-KOHJGNGET-TAISYOKBN(1)
                                       TO  LNK-ORCSJGNGET-SETKBN
               MOVE  WK-KOHJGNGET-TEKIYOFLG(1)
                                       TO  LNK-ORCSJGNGET-SETKBN2
             END-IF
             CALL    "ORCSJGNGET"      USING
                                       LNK-ORCSJGNGET-REC
                                       SPA-AREA
             IF    LNK-ORCSJGNGET-RC    =  ZERO
               IF    WK-GENGAKUKBN  NOT =  ZERO
                 MOVE     ZERO     TO     WK-GAIKFTNRATE019
               ELSE
                 MOVE     LNK-ORCSJGNGET-GAIJGNGAK
                                   TO     WK-GAIKFTNRATE019
               END-IF
             END-IF
           END-IF.
      *
       2107-KOHFTN-KINGAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    全国公費の減額
      ******************************************************************
       21071-KOHFTN-KINGAKU-GEN-SEC           SECTION.
      *
           IF  ((COMB-KOHHKNNUM(KOH-IDX)(1:1)  =  "0"  ) AND
                (WK-DOTANDOKU(KOH-IDX)         =  ZERO ) AND
                (LNK-ORCSJGNGET-GAIJGNGAK  NOT =  ZERO ))
           OR  ((WK-TOKATUKAI(KOH-IDX)         =  1    ) AND
                (LNK-ORCSJGNGET-GAIJGNGAK  NOT =  ZERO ))
           OR  ((WK-KOHJGNGET-TEKIYOFLG(KOH-IDX)
                                               =  1    ) AND
                (LNK-ORCSJGNGET-GAIJGNGAK  NOT =  ZERO ))
      *
             IF  LNK-ORCSJGNGET-GAIJGNGAK = 9999999 OR 999999
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   LNK-ORCSJGNGET-GAIJGNGAK
                     END-IF
                   WHEN          2
                     CONTINUE
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   LNK-ORCSJGNGET-GAIJGNGAK
                   WHEN          5
                     MOVE     WK-GENGAKU-KIN
                                     TO   LNK-ORCSJGNGET-GAIJGNGAK
                 END-EVALUATE
             ELSE
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   LNK-ORCSJGNGET-GAIJGNGAK
                     ELSE
                       COMPUTE  WK-GENGAKU-RITUX =
                                100 - WK-GENGAKU-RITU
                       COMPUTE  LNK-ORCSJGNGET-GAIJGNGAK  =
                                LNK-ORCSJGNGET-GAIJGNGAK  *
                                WK-GENGAKU-RITUX          /
                                100
                     END-IF
                   WHEN          2
                     IF  LNK-ORCSJGNGET-GAIJGNGAK < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   LNK-ORCSJGNGET-GAIJGNGAK
                     ELSE
                       COMPUTE  LNK-ORCSJGNGET-GAIJGNGAK  =
                                LNK-ORCSJGNGET-GAIJGNGAK  -
                                WK-GENGAKU-KIN
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   LNK-ORCSJGNGET-GAIJGNGAK
                   WHEN          5
                     IF  LNK-ORCSJGNGET-GAIJGNGAK > WK-GENGAKU-KIN
                       COMPUTE  LNK-ORCSJGNGET-GAIJGNGAK  =
                                WK-GENGAKU-KIN
                     END-IF
                 END-EVALUATE
                 COMPUTE  LNK-ORCSJGNGET-GAIJGNGAK =
                          LNK-ORCSJGNGET-GAIJGNGAK +  5
                 COMPUTE  LNK-ORCSJGNGET-GAIJGNGAK =
                          LNK-ORCSJGNGET-GAIJGNGAK /  10
                 COMPUTE  LNK-ORCSJGNGET-GAIJGNGAK =
                          LNK-ORCSJGNGET-GAIJGNGAK *  10
             END-IF
      *
           END-IF
      *
           .
      *
       21071-KOHFTN-KINGAKU-GEN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ４１老人上限額編集処理
      ******************************************************************
       2108-ROUJIN41-JYOGEN-HENSYU-SEC           SECTION.
      *
           IF  ( LNK-SYU-SRYYMD(1:6)   >=   "200905")
           AND ((COMB-KOH1HKNNUM = "972" OR "974") OR
                (COMB-KOH2HKNNUM = "972" OR "974") OR
                (COMB-KOH3HKNNUM = "972" OR "974") OR
                (COMB-KOH4HKNNUM = "972" OR "974")  )
            CONTINUE
           ELSE
            IF   LNK-SYU-SRYYMD(1:6)   >=   "200804"
             IF  (WK-1001-PREFNUM  =   14                    )
             AND (COMB-KOH1HKNNUM  =  "141" OR "142" OR "143")
               IF      FLG-GENBUTU70   NOT =   ZERO
                 MOVE   WK-ZENGAKU    TO    WK-KOUREI-IRYOHI70K
                 IF     COMB-KOH1HKNNUM  =  "141"
                    EVALUATE   WK-KANAGAWA41-FTNRATE
                      WHEN      10
                          MOVE    11       TO    FLG-IRYOHI70K
                      WHEN      20
                          MOVE    13       TO    FLG-IRYOHI70K
                    END-EVALUATE
                 ELSE
                    MOVE          12       TO    FLG-IRYOHI70K
                 END-IF
               ELSE
                 MOVE   WK-ZENGAKU    TO    WK-IRYOHI
                 IF     COMB-KOH1HKNNUM  =  "141"
                    EVALUATE   WK-KANAGAWA41-FTNRATE
                      WHEN      10
                          MOVE     1       TO    FLG-IRYOHI2
                      WHEN      20
                          MOVE     3       TO    FLG-IRYOHI2
                    END-EVALUATE
                 ELSE
                    MOVE           2       TO    FLG-IRYOHI2
                 END-IF
               END-IF
             END-IF
            ELSE
             IF  (WK-1001-PREFNUM  =   14                    )
             AND (COMB-KOH1HKNNUM  =  "141" OR "142" OR "143")
             AND (LNK-SYU-SRYYMD(1:6)   >=   "200610"        )
               IF      FLG-GENBUTU70   NOT =   ZERO
                 MOVE   WK-ZENGAKU   TO    WK-KOUREI-IRYOHI70K
                 IF     COMB-KOH1HKNNUM  =  "141"
                    MOVE    11       TO    FLG-IRYOHI70K
                 ELSE
                    MOVE    12       TO    FLG-IRYOHI70K
                 END-IF
               ELSE
                 MOVE   WK-ZENGAKU   TO    WK-IRYOHI
                 IF     COMB-KOH1HKNNUM  =  "141"
                    MOVE     1       TO    FLG-IRYOHI2
                 ELSE
                    MOVE     2       TO    FLG-IRYOHI2
                 END-IF
               END-IF
             END-IF
            END-IF
           END-IF
      *
           IF  (WK-1001-PREFNUM       =    43     )
           AND (LNK-SYU-SRYYMD(1:6)  >=   "200912")
           AND ((COMB-KOH1HKNNUM = "143" OR "342") OR
                (COMB-KOH2HKNNUM = "143" OR "342") OR
                (COMB-KOH3HKNNUM = "143" OR "342") OR
                (COMB-KOH4HKNNUM = "143" OR "342"))
           AND ((COMB-KOH1HKNNUM = "972" OR "974") OR
                (COMB-KOH2HKNNUM = "972" OR "974") OR
                (COMB-KOH3HKNNUM = "972" OR "974") OR
                (COMB-KOH4HKNNUM = "972" OR "974"))
             IF  (COMB-KOH1HKNNUM = "143" OR "342")
             AND (MAX-KIN-KOHI1-M  NOT = ZERO     )
               COMPUTE   MAX-KIN-KOHI1-M  =
                        (MAX-KIN-SYU-M / 3) + 0.9
             END-IF
             IF  (COMB-KOH2HKNNUM = "143" OR "342")
             AND (MAX-KIN-KOHI2-M  NOT = ZERO     )
               COMPUTE   MAX-KIN-KOHI2-M  =
                        (MAX-KIN-SYU-M / 3) + 0.9
             END-IF
             IF  (COMB-KOH3HKNNUM = "143" OR "342")
             AND (MAX-KIN-KOHI3-M  NOT = ZERO     )
               COMPUTE   MAX-KIN-KOHI3-M  =
                        (MAX-KIN-SYU-M / 3) + 0.9
             END-IF
             IF  (COMB-KOH4HKNNUM = "143" OR "342")
             AND (MAX-KIN-KOHI4-M  NOT = ZERO     )
               COMPUTE   MAX-KIN-KOHI4-M  =
                        (MAX-KIN-SYU-M / 3) + 0.9
             END-IF
           END-IF
      *
           .
      *
       2108-ROUJIN41-JYOGEN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        主保険の減額                                            *
      *        長期の減額                                              *
      ******************************************************************
       2109-KOHFTN-KINGAKU-GEN-SEC           SECTION.
      *
           IF  LNK-S01-KOUREI-ZAITAKU-KBN   =  "1"
      *
              IF   COMB-KOH1HKNNUM          =  "027"
                 IF   MAX-KIN-KOHI1-M   NOT =  ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-D
                                             MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-KOHI1-D     =
                                   MAX-KIN-KOHI1-D     *
                                   WK-GENGAKU-RITUX    /
                                   100
                          COMPUTE  MAX-KIN-KOHI1-M     =
                                   MAX-KIN-KOHI1-M     *
                                   WK-GENGAKU-RITUX    /
                                   100
                        END-IF
                     WHEN          2
                        IF  MAX-KIN-KOHI1-D < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-D
                        ELSE
                          COMPUTE  MAX-KIN-KOHI1-D  =
                                   MAX-KIN-KOHI1-D  -
                                   WK-GENGAKU-KIN
                        END-IF
                        IF  MAX-KIN-KOHI1-M < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  MAX-KIN-KOHI1-M  =
                                   MAX-KIN-KOHI1-M  -
                                   WK-GENGAKU-KIN
                        END-IF
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-KOHI1-D
                                           MAX-KIN-KOHI1-M
                     WHEN          5
                        IF  MAX-KIN-KOHI1-D > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-KOHI1-D  =
                                   WK-GENGAKU-KIN
                        END-IF
                        IF  MAX-KIN-KOHI1-M > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-KOHI1-M  =
                                   WK-GENGAKU-KIN
                        END-IF
                   END-EVALUATE
                   COMPUTE  MAX-KIN-KOHI1-D =
                            MAX-KIN-KOHI1-D +  5
                   COMPUTE  MAX-KIN-KOHI1-D =
                            MAX-KIN-KOHI1-D /  10
                   COMPUTE  MAX-KIN-KOHI1-D =
                            MAX-KIN-KOHI1-D *  10
                   COMPUTE  MAX-KIN-KOHI1-M =
                            MAX-KIN-KOHI1-M +  5
                   COMPUTE  MAX-KIN-KOHI1-M =
                            MAX-KIN-KOHI1-M /  10
                   COMPUTE  MAX-KIN-KOHI1-M =
                            MAX-KIN-KOHI1-M *  10
                 END-IF
              ELSE
                 IF   MAX-KIN-SYU-M     NOT =  ZERO
                 AND  FLG-IRYOHIKG          =  ZERO
                 AND  FLG-IRYOHIKG2         =  ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-SYU-M       =
                                   MAX-KIN-SYU-M       *
                                   WK-GENGAKU-RITUX    /
                                   100
                        END-IF
                     WHEN          2
                        IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  MAX-KIN-SYU-M  =
                                   MAX-KIN-SYU-M  -
                                   WK-GENGAKU-KIN
                        END-IF
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-SYU-M
                     WHEN          5
                        IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-SYU-M  =
                                   WK-GENGAKU-KIN
                        END-IF
                   END-EVALUATE
                   COMPUTE  MAX-KIN-SYU-M =
                            MAX-KIN-SYU-M +  5
                   COMPUTE  MAX-KIN-SYU-M =
                            MAX-KIN-SYU-M /  10
                   COMPUTE  MAX-KIN-SYU-M =
                            MAX-KIN-SYU-M *  10
                 END-IF
              END-IF
      *
           END-IF
      *
           IF  FLG-GENBUTU70   NOT =   ZERO
      *
             IF   MAX-KIN-SYU-M     NOT =  ZERO
             AND  FLG-IRYOHI70          =  ZERO
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-SYU-M       =
                                  MAX-KIN-SYU-M       *
                                  WK-GENGAKU-RITUX    /
                                  100
                       END-IF
                    WHEN          2
                       IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  MAX-KIN-SYU-M  =
                                  MAX-KIN-SYU-M  -
                                  WK-GENGAKU-KIN
                       END-IF
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-SYU-M
                    WHEN          5
                       IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                         COMPUTE  MAX-KIN-SYU-M  =
                                  WK-GENGAKU-KIN
                       END-IF
                  END-EVALUATE
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M +  5
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M /  10
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M *  10
             END-IF
      *
           END-IF
      *
           IF   (LNK-S01-KOUREI-ZAITAKU-KBN   =  "1" )
           OR   (FLG-GENBUTU70            NOT =  ZERO)
      *
             IF    WK-GENBUTU-SYUMAXKIN   NOT =  ZERO
               EVALUATE   WK-GENGAKUKBN
                 WHEN          1
                    IF  WK-GENGAKU-RITU = 100
                      MOVE   ZERO   TO   WK-GENBUTU-SYUMAXKIN
                    ELSE
                      COMPUTE  WK-GENGAKU-RITUX =
                               100 - WK-GENGAKU-RITU
                      COMPUTE  WK-GENBUTU-SYUMAXKIN  =
                               WK-GENBUTU-SYUMAXKIN  *
                               WK-GENGAKU-RITUX      /
                               100
                    END-IF
                 WHEN          2
                    IF  WK-GENBUTU-SYUMAXKIN < WK-GENGAKU-KIN
                      MOVE   ZERO   TO   WK-GENBUTU-SYUMAXKIN
                    ELSE
                      COMPUTE  WK-GENBUTU-SYUMAXKIN  =
                               WK-GENBUTU-SYUMAXKIN  -
                               WK-GENGAKU-KIN
                    END-IF
                 WHEN          3
                 WHEN          4
                    MOVE   ZERO   TO   WK-GENBUTU-SYUMAXKIN
                 WHEN          5
                    IF  WK-GENBUTU-SYUMAXKIN > WK-GENGAKU-KIN
                      COMPUTE  WK-GENBUTU-SYUMAXKIN  =
                               WK-GENGAKU-KIN
                    END-IF
               END-EVALUATE
               COMPUTE  WK-GENBUTU-SYUMAXKIN =
                        WK-GENBUTU-SYUMAXKIN +  5
               COMPUTE  WK-GENBUTU-SYUMAXKIN =
                        WK-GENBUTU-SYUMAXKIN /  10
               COMPUTE  WK-GENBUTU-SYUMAXKIN =
                        WK-GENBUTU-SYUMAXKIN *  10
             END-IF
      *
           END-IF
      *
           IF  (FLG-TOKU75-CYO   =   1 OR 2 OR 3)
           OR  (FLG-CYOKI-ARI    =   1 OR 2     )
      *
             IF   MAX-KIN-SYU-M     NOT =  ZERO
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-SYU-M       =
                                  MAX-KIN-SYU-M       *
                                  WK-GENGAKU-RITUX    /
                                  100
                       END-IF
                    WHEN          2
                       IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  MAX-KIN-SYU-M  =
                                  MAX-KIN-SYU-M  -
                                  WK-GENGAKU-KIN
                       END-IF
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-SYU-M
                    WHEN          5
                       IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                         COMPUTE  MAX-KIN-SYU-M  =
                                  WK-GENGAKU-KIN
                       END-IF
                  END-EVALUATE
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M +  5
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M /  10
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M *  10
             END-IF
      *
           END-IF
      *
      ***********
      *
           IF   COMB-KOH1HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                                       MAX-KIN-KOHI1-M-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI1-M    =
                             MAX-KIN-KOHI1-M    *
                             WK-GENGAKU-RITUX   /
                             100
                    COMPUTE  MAX-KIN-KOHI1-M-TOKU75    =
                             MAX-KIN-KOHI1-M-TOKU75    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  IF  MAX-KIN-KOHI1-M < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                  ELSE
                    COMPUTE  MAX-KIN-KOHI1-M  =
                             MAX-KIN-KOHI1-M  -
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI1-M-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI1-M-TOKU75
                  ELSE
                    COMPUTE  MAX-KIN-KOHI1-M-TOKU75  =
                             MAX-KIN-KOHI1-M-TOKU75  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI1-M
                                       MAX-KIN-KOHI1-M-TOKU75
                WHEN          5
                  IF  MAX-KIN-KOHI1-M > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI1-M  =
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI1-M-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI1-M-TOKU75  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI1-M =
                       MAX-KIN-KOHI1-M +  5
              COMPUTE  MAX-KIN-KOHI1-M =
                       MAX-KIN-KOHI1-M /  10
              COMPUTE  MAX-KIN-KOHI1-M =
                       MAX-KIN-KOHI1-M *  10
              COMPUTE  MAX-KIN-KOHI1-M-TOKU75 =
                       MAX-KIN-KOHI1-M-TOKU75 +  5
              COMPUTE  MAX-KIN-KOHI1-M-TOKU75 =
                       MAX-KIN-KOHI1-M-TOKU75 /  10
              COMPUTE  MAX-KIN-KOHI1-M-TOKU75 =
                       MAX-KIN-KOHI1-M-TOKU75 *  10
           END-IF
      *
           IF   COMB-KOH2HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI2-M
                                       MAX-KIN-KOHI2-M-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI2-M    =
                             MAX-KIN-KOHI2-M    *
                             WK-GENGAKU-RITUX   /
                             100
                    COMPUTE  MAX-KIN-KOHI2-M-TOKU75    =
                             MAX-KIN-KOHI2-M-TOKU75    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  IF  MAX-KIN-KOHI2-M < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI2-M
                  ELSE
                    COMPUTE  MAX-KIN-KOHI2-M  =
                             MAX-KIN-KOHI2-M  -
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI2-M-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI2-M-TOKU75
                  ELSE
                    COMPUTE  MAX-KIN-KOHI2-M-TOKU75  =
                             MAX-KIN-KOHI2-M-TOKU75  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI2-M
                                       MAX-KIN-KOHI2-M-TOKU75
                WHEN          5
                  IF  MAX-KIN-KOHI2-M > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI2-M  =
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI2-M-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI2-M-TOKU75  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI2-M =
                       MAX-KIN-KOHI2-M +  5
              COMPUTE  MAX-KIN-KOHI2-M =
                       MAX-KIN-KOHI2-M /  10
              COMPUTE  MAX-KIN-KOHI2-M =
                       MAX-KIN-KOHI2-M *  10
              COMPUTE  MAX-KIN-KOHI2-M-TOKU75 =
                       MAX-KIN-KOHI2-M-TOKU75 +  5
              COMPUTE  MAX-KIN-KOHI2-M-TOKU75 =
                       MAX-KIN-KOHI2-M-TOKU75 /  10
              COMPUTE  MAX-KIN-KOHI2-M-TOKU75 =
                       MAX-KIN-KOHI2-M-TOKU75 *  10
           END-IF
      *
           IF   COMB-KOH3HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI3-M
                                       MAX-KIN-KOHI3-M-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI3-M    =
                             MAX-KIN-KOHI3-M    *
                             WK-GENGAKU-RITUX   /
                             100
                    COMPUTE  MAX-KIN-KOHI3-M-TOKU75    =
                             MAX-KIN-KOHI3-M-TOKU75    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  IF  MAX-KIN-KOHI3-M < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI3-M
                  ELSE
                    COMPUTE  MAX-KIN-KOHI3-M  =
                             MAX-KIN-KOHI3-M  -
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI3-M-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI3-M-TOKU75
                  ELSE
                    COMPUTE  MAX-KIN-KOHI3-M-TOKU75  =
                             MAX-KIN-KOHI3-M-TOKU75  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI3-M
                                       MAX-KIN-KOHI3-M-TOKU75
                WHEN          5
                  IF  MAX-KIN-KOHI3-M > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI3-M  =
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI3-M-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI3-M-TOKU75  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI3-M =
                       MAX-KIN-KOHI3-M +  5
              COMPUTE  MAX-KIN-KOHI3-M =
                       MAX-KIN-KOHI3-M /  10
              COMPUTE  MAX-KIN-KOHI3-M =
                       MAX-KIN-KOHI3-M *  10
              COMPUTE  MAX-KIN-KOHI3-M-TOKU75 =
                       MAX-KIN-KOHI3-M-TOKU75 +  5
              COMPUTE  MAX-KIN-KOHI3-M-TOKU75 =
                       MAX-KIN-KOHI3-M-TOKU75 /  10
              COMPUTE  MAX-KIN-KOHI3-M-TOKU75 =
                       MAX-KIN-KOHI3-M-TOKU75 *  10
           END-IF
      *
           IF   COMB-KOH4HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI4-M
                                       MAX-KIN-KOHI4-M-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI4-M    =
                             MAX-KIN-KOHI4-M    *
                             WK-GENGAKU-RITUX   /
                             100
                    COMPUTE  MAX-KIN-KOHI4-M-TOKU75    =
                             MAX-KIN-KOHI4-M-TOKU75    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  IF  MAX-KIN-KOHI4-M < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI4-M
                  ELSE
                    COMPUTE  MAX-KIN-KOHI4-M  =
                             MAX-KIN-KOHI4-M  -
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI4-M-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI4-M-TOKU75
                  ELSE
                    COMPUTE  MAX-KIN-KOHI4-M-TOKU75  =
                             MAX-KIN-KOHI4-M-TOKU75  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI4-M
                                       MAX-KIN-KOHI4-M-TOKU75
                WHEN          5
                  IF  MAX-KIN-KOHI4-M > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI4-M  =
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI4-M-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI4-M-TOKU75  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI4-M =
                       MAX-KIN-KOHI4-M +  5
              COMPUTE  MAX-KIN-KOHI4-M =
                       MAX-KIN-KOHI4-M /  10
              COMPUTE  MAX-KIN-KOHI4-M =
                       MAX-KIN-KOHI4-M *  10
              COMPUTE  MAX-KIN-KOHI4-M-TOKU75 =
                       MAX-KIN-KOHI4-M-TOKU75 +  5
              COMPUTE  MAX-KIN-KOHI4-M-TOKU75 =
                       MAX-KIN-KOHI4-M-TOKU75 /  10
              COMPUTE  MAX-KIN-KOHI4-M-TOKU75 =
                       MAX-KIN-KOHI4-M-TOKU75 *  10
           END-IF
      *
           .
      *
       2109-KOHFTN-KINGAKU-GEN-EXT.
           EXIT.
      *
      ******************************************************************
      *        患者公費負担（高額委任払い金額取り込み）取込み処理
      ******************************************************************
       210A-KOHININBARAI-KINGAKU-SEC           SECTION.
      *
      *    公費月上限額取得
           INITIALIZE                    LNK-ORCSJGNGET-REC
           MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
           MOVE    "964"             TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE  WK-KOHININBARAI-KOHID
                                     TO  LNK-ORCSJGNGET-KOHID
           MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
      *
           CALL    "ORCSJGNGET"      USING
                                     LNK-ORCSJGNGET-REC
                                     SPA-AREA
      *
           IF    LNK-ORCSJGNGET-RC   =   ZERO
      ***     IF      LNK-ORCSJGNGET-GAIJGNGAK  =  ZERO
      ***        MOVE    ZERO        TO  FLG-KOHININBARAI
      ***     ELSE
                 IF   COMB-KOH1HKNNUM      =  "027"
                   MOVE    "1"       TO  COMB-KOH1-GAIJGNKBN
                   MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                     TO  MAX-KIN-KOHI1-D
                                         MAX-KIN-KOHI1-M
                 ELSE
                   MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                     TO  MAX-KIN-SYU-M
                 END-IF
                 MOVE    1           TO  FLG-KOUGAKUCYO-ININ
      ***     END-IF
           ELSE
                 MOVE    ZERO        TO  FLG-KOHININBARAI
           END-IF
      *
           IF   (FLG-KOHININBARAI      =    1      )
           AND  (LNK-SYU-SRYYMD(1:6)  >=   "201501")
             IF    MAX-KIN-SYU-M = 9999999 OR 999999
               CONTINUE
             ELSE
               EVALUATE   WK-KOHININBARAI-JKYSNUM(1:2)
                 WHEN      "ア"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   140100     TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   252600     TO  MAX-KIN-SYU-M
                      MOVE   WK-ZENGAKU TO  WK-KOUREI-IRYOHI70
                      MOVE   7          TO  FLG-IRYOHI70
                   END-IF
                 WHEN      "イ"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   93000      TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   167400     TO  MAX-KIN-SYU-M
                      MOVE   WK-ZENGAKU TO  WK-KOUREI-IRYOHI70
                      MOVE   8          TO  FLG-IRYOHI70
                   END-IF
                 WHEN      "ウ"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   44400      TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   80100      TO  MAX-KIN-SYU-M
                      MOVE   WK-ZENGAKU TO  WK-KOUREI-IRYOHI70
                      MOVE   2          TO  FLG-IRYOHI70
                   END-IF
                 WHEN      "エ"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   44400      TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   57600      TO  MAX-KIN-SYU-M
                   END-IF
                 WHEN      "オ"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   24600      TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   35400      TO  MAX-KIN-SYU-M
                   END-IF
               END-EVALUATE
             END-IF
           END-IF
      *
           .
      *
       210A-KOHININBARAI-KINGAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ７５歳到達月の特例設定                                      *
      ******************************************************************
       210B-TOKU75-SETTEI-SEC           SECTION.
      *
           MOVE     ZERO     TO   FLG-TOKU75-CYO
      *
           EVALUATE   FLG-TOKU75
             WHEN        1
             WHEN        2
               IF   LNK-S01-KOUREI-ZAITAKU-KBN   =  "1"
                 CONTINUE
               ELSE
                 IF (COMB-KOH1HKNNUM = "972" OR "974")
                 OR (COMB-KOH2HKNNUM = "972" OR "974")
                 OR (COMB-KOH3HKNNUM = "972" OR "974")
                 OR (COMB-KOH4HKNNUM = "972" OR "974")
                 OR (COMB-KOH1HKNNUM(1:1) = "0"      )
                 OR (COMB-KOH2HKNNUM(1:1) = "0"      )
                 OR (COMB-KOH3HKNNUM(1:1) = "0"      )
                 OR (COMB-KOH4HKNNUM(1:1) = "0"      )
                 OR (WK-TOKATUKAI(1) =  1            )
                    IF (COMB-KOH1HKNNUM = "972" OR "974")
                    OR (COMB-KOH2HKNNUM = "972" OR "974")
                    OR (COMB-KOH3HKNNUM = "972" OR "974")
                    OR (COMB-KOH4HKNNUM = "972" OR "974")
                       MOVE  FLG-TOKU75  TO  FLG-TOKU75-CYO
                    END-IF
                 ELSE
                       MOVE     9        TO  FLG-TOKU75
                 END-IF
               END-IF
             WHEN        3
               IF   FLG-GENBUTU70   NOT =  ZERO
                 CONTINUE
               ELSE
                 IF (COMB-KOH1HKNNUM = "972" OR "974")
                 OR (COMB-KOH2HKNNUM = "972" OR "974")
                 OR (COMB-KOH3HKNNUM = "972" OR "974")
                 OR (COMB-KOH4HKNNUM = "972" OR "974")
                       MOVE  FLG-TOKU75  TO  FLG-TOKU75-CYO
                 ELSE
                       MOVE     9        TO  FLG-TOKU75
                 END-IF
               END-IF
           END-EVALUATE
      *
           IF   FLG-TOKU75  = 1 OR 2 OR 3
              MOVE    FLG-TOKU75   TO   LNK-SYU-SKJ-FTNDAY(1)
              IF      WK-TOKU75-BIRTHDAY  NOT =  SPACE
                MOVE  WK-TOKU75-BIRTHDAY(7:2)
                                   TO   LNK-SYU-SKJ-FTNDAY(2)
              END-IF
              IF      FLG-KOHININBARAI    =    1
                MOVE  ZERO         TO   FLG-KOHININBARAI
              END-IF
           END-IF
      *
           .
      *
       210B-TOKU75-SETTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *    ７０歳未満現物給付の収納マスタ検索
      ******************************************************************
       210C-SYUNOU-GEN70-KENSAKU-SEC           SECTION.
      *
           INITIALIZE                         SYU-SYUNOU-REC
           MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN    TO    SYU-NYUGAIKBN
           MOVE    LNK-SYU-PTID         TO    SYU-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
           MOVE    "__"                 TO    SYU-SRYYMD(7:2)
           MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
           MOVE    "DBSELECT"           TO    MCP-FUNC
           MOVE    "tbl_syunou"         TO    MCP-TABLE
           MOVE    "key26"              TO    MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
           IF      MCP-RC   =   ZERO
             MOVE      "tbl_syunou"     TO    MCP-TABLE
             MOVE      "key26"          TO    MCP-PATHNAME
             PERFORM    SYUNOU-READ2-SEC
             PERFORM  UNTIL  (FLG-SYUNOU  =  "1")
               IF   SYU-DENPJTIKBN   NOT =  "3"
                 PERFORM  210C1-SYUNOU-GEN70-CNT-SEC
               END-IF
               MOVE    "tbl_syunou"     TO    MCP-TABLE
               MOVE    "key26"          TO    MCP-PATHNAME
               PERFORM  SYUNOU-READ2-SEC
             END-PERFORM
           END-IF
           MOVE        "tbl_syunou"     TO    MCP-TABLE
           MOVE        "key26"          TO    MCP-PATHNAME
           PERFORM      DB-CLOSE-SEC
      *
           PERFORM    VARYING   IDZ    FROM   1   BY   1
                       UNTIL   (IDZ    >    15)
                         OR    (LNK2-SYU-SRYYMD(IDZ) =  SPACE)
             IF   (LNK-S01-RETRY-FLG  =  SPACE)
             AND  (LNK-S01-IDX2       <   IDZ )
               CONTINUE
             ELSE
               MOVE     LNK2-SYUNOU-REC(IDZ)  TO  SYU-SYUNOU-REC
               PERFORM  210C1-SYUNOU-GEN70-CNT-SEC
             END-IF
           END-PERFORM
      *
           .
      *
       210C-SYUNOU-GEN70-KENSAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ７０歳未満現物給付の収納マスタ金額編集
      ******************************************************************
       210C1-SYUNOU-GEN70-CNT-SEC          SECTION.
      *
      *    収納保険情報編集
           MOVE    ZERO   TO   FLG-GENBUTU-CHECK
           PERFORM  2202B-SYUNOU-HKN-HENSYU-SEC
           IF   FLG-SYUNOU-HKN-HANTEI  =  1
             GO   TO   210C1-SYUNOU-GEN70-CNT-EXT
           END-IF
      *
           MOVE    ZERO   TO   FLG-DAISAN-GENBUTU2
           IF  (SYU-KOH1HKNNUM      =  "970"   )
           AND (SYU-SKJ-FTNGAKU(2)  =   ZERO   )
           AND (SYU-SRYYMD(1:6)    >=  "201204")
              PERFORM  2202F-DAISAN-GENBUTU-CHECK-SEC
           END-IF
      *
           IF (SYU-SYUHKNNUM       =  "971" OR "973" OR "975"
                                   OR "068" OR "069" OR "040")
           OR (SYU-SYUHKNNUM(1:2)  =  "98"  OR "90"  OR "91" )
           OR ((COMB-KOH1HKNNUM    NOT  =  "970"            ) AND
               (SYU-KOH1HKNNUM          =  "970"            ) AND
               (SYU-SKJ-FTNGAKU(2) NOT  =   ZERO            ) AND
               (SYU-PTFTNRATE           =   ZERO            ) AND
               (LNK-S01-IKTGENKEIFLG    =   SPACE OR "1"    ))
           OR ((SYU-KOH1HKNNUM          =  "970"            ) AND
               (SYU-SKJ-FTNGAKU(2)      =   ZERO            ) AND
               (FLG-DAISAN-GENBUTU2     =   ZERO            ))
           OR ((SYU-KOH1HKNNUM          =  "970"            ) AND
               (SYU-SKJ-FTNGAKU(2)      =   ZERO            ) AND
               (FLG-DAISAN-GENBUTU2     =   1               ) AND
               (SYU-PTFTNRATE           =   ZERO            ) AND
               (LNK-S01-IKTGENKEIFLG    =   SPACE OR "1"    ))
             CONTINUE
           ELSE
             IF   (SYU-SYUHKNNUM      NOT = SPACE     )
             AND  (COMB-HKNNUM        NOT = SPACE     )
             AND  (LNK-SYU-YKZKENNUM = SYU-YKZKENNUM  )
             AND  (WK-HKNJANUM2-TBL  = WK-HKNJANUM-TBL)
               IF  LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"
                 IF    (SYU-KOH1HKNNUM = SPACE
                                      OR "970")
                 AND   (SYU-KOH2HKNNUM = SPACE)
                 AND   (SYU-KOH3HKNNUM = SPACE)
                 AND   (SYU-KOH4HKNNUM = SPACE)
                   IF   SYU-KOH1HKNNUM = "970"
      *****          ADD   SYU-KOH-FTN
                     ADD   SYU-SYUCOMPFTN
                               TO  WK-SYUNOU-GENBUTU-KR-SKYMONEY
                                   WK-SYUNOU-GENBUTU-KR-SKYMONEY2
                   ELSE
                     ADD   SYU-HKNTEKMONEY
                               TO  WK-SYUNOU-GENBUTU-KR-SKYMONEY
                                   WK-SYUNOU-GENBUTU-KR-SKYMONEY2
                   END-IF
                   IF   SYU-SKJ-FTNGAKU(1) =  1
                     MOVE   1  TO  WK-SYUNOU-GENBUTU-JGNFLG
                   END-IF
                   MOVE     1  TO  WK-SYUNOU-GENBUTU-KR-SYUHKNFLG
                 ELSE
                   ADD   SYU-KOH-FTN
                               TO  WK-SYUNOU-GENBUTU-KR-SKYMONEY
                   IF   (SYU-KOH2HKNNUM  =  SPACE)
                   AND  (SYU-KOH3HKNNUM  =  SPACE)
                   AND  (SYU-KOH4HKNNUM  =  SPACE)
                     ADD   SYU-KOH-FTN
                               TO  WK-SYUNOU-GENBUTU-KR-SKYMONEY2
                   ELSE
      ***            ADD   SYU-KOH1COMPFTN
                     ADD   SYU-KOH1HKNFTNMONEY
                               TO  WK-SYUNOU-GENBUTU-KR-SKYMONEY2
                   END-IF
                 END-IF
               ELSE
                 MOVE     ZERO      TO     FLG-HANBETU
                 IF    (SYU-KOH1HKNNUM = SPACE
                                      OR "970")
                 AND   (SYU-KOH2HKNNUM = SPACE)
                 AND   (SYU-KOH3HKNNUM = SPACE)
                 AND   (SYU-KOH4HKNNUM = SPACE)
                   ADD   SYU-TOTAL-HKNTEN      TO
                                   WK-SYUNOU-GENBUTU70T-TOTALTEN
                   IF   SYU-KOH1HKNNUM = "970"
      *****          ADD   SYU-KOH-FTN         TO
                     ADD   SYU-SYUCOMPFTN      TO
                                   WK-SYUNOU-GENBUTU70T-SKYMONEY
                   ELSE
                     ADD   SYU-HKNTEKMONEY     TO
                                   WK-SYUNOU-GENBUTU70T-SKYMONEY
                   END-IF
                   IF   SYU-SKJ-FTNGAKU(1) =  1
                     MOVE   1  TO  WK-SYUNOU-GENBUTU-JGNFLG
                   END-IF
                 ELSE
                   PERFORM VARYING IDX13  FROM   1   BY   1
                            UNTIL (IDX13   >    50                  )
                             OR   (WK-SYUNOU-GENBUTU70-HKNCOMBINUM
                                                     (IDX13) = SPACE)
                     IF  SYU-HKNCOMBINUM =
                               WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                       ADD   SYU-TOTAL-HKNTEN  TO
                               WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
                       ADD   SYU-KOH1COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH1COMPFTN(IDX13)
                       ADD   SYU-KOH2COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH2COMPFTN(IDX13)
                       ADD   SYU-KOH3COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH3COMPFTN(IDX13)
                       ADD   SYU-KOH4COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH4COMPFTN(IDX13)
                       ADD   SYU-KOH-FTN       TO
                               WK-SYUNOU-GENBUTU70-SKYMONEY(IDX13)
                       IF    SYU-SKJ-FTNGAKU(3)  =  9
                          MOVE    9            TO
                               WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13)
                       END-IF
                       MOVE  1                 TO  FLG-HANBETU
                       MOVE  50                TO  IDX13
                     END-IF
                   END-PERFORM
                   IF    FLG-HANBETU  =  ZERO
                       MOVE  SYU-HKNCOMBINUM   TO
                               WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                       ADD   SYU-TOTAL-HKNTEN  TO
                               WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
                       MOVE  SYU-SYUHKNNUM     TO
                               WK-SYUNOU-GENBUTU70-SYUHKNNUM(IDX13)
                       MOVE  SYU-KOH1HKNNUM    TO
                               WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13)
                       ADD   SYU-KOH1COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH1COMPFTN(IDX13)
                       MOVE  SYU-KOH2HKNNUM    TO
                               WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13)
                       ADD   SYU-KOH2COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH2COMPFTN(IDX13)
                       MOVE  SYU-KOH3HKNNUM    TO
                               WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13)
                       ADD   SYU-KOH3COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH3COMPFTN(IDX13)
                       MOVE  SYU-KOH4HKNNUM    TO
                               WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13)
                       ADD   SYU-KOH4COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH4COMPFTN(IDX13)
                       ADD   SYU-KOH-FTN       TO
                               WK-SYUNOU-GENBUTU70-SKYMONEY(IDX13)
                       IF    SYU-SKJ-FTNGAKU(3)  =  9
                          MOVE    9            TO
                               WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13)
                       END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
      *
       210C1-SYUNOU-GEN70-CNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    ７０歳未満現物給付のデータ編集
      ******************************************************************
       210D-SYUNOU-GEN70-HENSYU-SEC          SECTION.
      *
      *    主保険単独分の計算
           COMPUTE  WK-FUTANWARI  =  WK-SYUNOU-GENBUTU70-FTNRATE
                                  /  100
           COMPUTE  WK-SYUNOU-GENBUTU70-KEISAN
                      =  WK-SYUNOU-GENBUTU70T-TOTALTEN
                      *  10
                      *  WK-FUTANWARI
           IF    FLG-TOKU75  =  3
             IF  WK-SYUNOU-GENBUTU70-KEISAN >= 10500
               MOVE    1    TO    WK-SYUNOU-GENBUTU70T-HANTEIFLG
             END-IF
           ELSE
             IF  WK-SYUNOU-GENBUTU70-KEISAN >= 21000
               MOVE    1    TO    WK-SYUNOU-GENBUTU70T-HANTEIFLG
             END-IF
           END-IF
      *
      *    公費併用分の計算
           PERFORM   VARYING   IDX13   FROM   1   BY   1
                      UNTIL   (IDX13     >   50                      )
                        OR    (WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                                                              = SPACE)
             IF  (WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13) =
                                                  "972" OR "974")
             AND (WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13) =  SPACE)
             AND (WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13) =  SPACE)
             AND (WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13) =  SPACE)
               CONTINUE
             ELSE
               COMPUTE  WK-FUTANWARI  =  WK-SYUNOU-GENBUTU70-FTNRATE
                                      /  100
               COMPUTE  WK-SYUNOU-GENBUTU70-KEISAN
                          =  WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
                          *  10
                          *  WK-FUTANWARI
               IF ((WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH1COMPFTN(IDX13)
                                       NOT = ZERO           ))
               OR ((WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH2COMPFTN(IDX13)
                                       NOT = ZERO           ))
               OR ((WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH3COMPFTN(IDX13)
                                       NOT = ZERO           ))
               OR ((WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH4COMPFTN(IDX13)
                                       NOT = ZERO           ))
                 IF  FLG-TOKU75  =  3
                   IF  WK-SYUNOU-GENBUTU70-KEISAN >= 10500
                     MOVE  1  TO  WK-SYUNOU-GENBUTU70-HANTEIFLG(IDX13)
                   END-IF
                 ELSE
                   IF  WK-SYUNOU-GENBUTU70-KEISAN >= 21000
                     MOVE  1  TO  WK-SYUNOU-GENBUTU70-HANTEIFLG(IDX13)
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           .
      *
       210D-SYUNOU-GEN70-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    負担割合の編集
      ******************************************************************
       210E-SYUNOU-FTNRATE-HENSYU-SEC          SECTION.
      *
      *    負担割合
      *
           MOVE         30    TO   WK-SYUNOU-GENBUTU70-FTNRATE
           IF    COMB-HKNNUM   =   "060" OR "039"
             EVALUATE   COMB-HOJOKBN
               WHEN   "0"
                 MOVE   ZERO  TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "1"
               WHEN   "4"
                 MOVE   10    TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "2"
               WHEN   "5"
                 MOVE   20    TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "3"
               WHEN   "6"
                 MOVE   30    TO   WK-SYUNOU-GENBUTU70-FTNRATE
             END-EVALUATE
           ELSE
             EVALUATE   COMB-HOJOKBN
               WHEN   "9"
                 MOVE   10    TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "8"
                 MOVE   20    TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "7"
                 MOVE   30    TO   WK-SYUNOU-GENBUTU70-FTNRATE
             END-EVALUATE
           END-IF
      *
      *    義務教育就学前
           IF    LNK-SYU-SRYYMD   >=  "20080401"
             IF  FLG-SYUGAKUMAE    =   1
               IF   COMB-HKNNUM    =  "060"
                 IF   COMB-HOJOKBN   =  "0"  OR  "1"  OR  "4"
                   CONTINUE
                 ELSE
                   MOVE   20  TO   WK-SYUNOU-GENBUTU70-FTNRATE
                 END-IF
               ELSE
                   MOVE   20  TO   WK-SYUNOU-GENBUTU70-FTNRATE
               END-IF
             END-IF
           END-IF
      *
           IF    COMB-HKNNUM                =    "002"
      *****AND   LNK-S01-SENINFLG(IDY)  NOT =    "1"
             EVALUATE   COMB-HOJOKBN
               WHEN   "1"
               WHEN   "2"
               WHEN   "3"
               WHEN   "A"
               WHEN   "B"
               WHEN   "C"
               WHEN   "D"
               WHEN   "E"
               WHEN   "F"
               WHEN   "G"
               WHEN   "H"
               WHEN   "I"
                   MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-FTNRATE
             END-EVALUATE
           END-IF
      *
           IF    COMB-HKNNUM   =  "031" OR "032" OR "033" OR "034"
             EVALUATE   COMB-HOJOKBN
               WHEN   "2"
               WHEN   "B"
               WHEN   "E"
               WHEN   "H"
                   MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-FTNRATE
             END-EVALUATE
           END-IF
      *
           .
      *
       210E-SYUNOU-FTNRATE-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    和歌山県地方公費（２８１）に関わる収納マスタ検索
      ******************************************************************
       210F-SYUNOU-CHIHOU-KENSAKU-SEC           SECTION.
      *
           INITIALIZE                         SYU-SYUNOU-REC
           MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN    TO    SYU-NYUGAIKBN
           MOVE    LNK-SYU-PTID         TO    SYU-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
           MOVE    "__"                 TO    SYU-SRYYMD(7:2)
           MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
           MOVE    "DBSELECT"           TO    MCP-FUNC
           MOVE    "tbl_syunou"         TO    MCP-TABLE
           MOVE    "key26"              TO    MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
           IF      MCP-RC   =   ZERO
             MOVE      "tbl_syunou"     TO    MCP-TABLE
             MOVE      "key26"          TO    MCP-PATHNAME
             PERFORM    SYUNOU-READ3-SEC
             PERFORM  UNTIL  (FLG-SYUNOU  =  "1")
               IF   SYU-DENPJTIKBN   NOT =  "3"
                 PERFORM  210F1-SYUNOU-CHIHOU-HENSYU-SEC
               END-IF
               MOVE    "tbl_syunou"     TO    MCP-TABLE
               MOVE    "key26"          TO    MCP-PATHNAME
               PERFORM  SYUNOU-READ3-SEC
             END-PERFORM
           END-IF
           MOVE        "tbl_syunou"     TO    MCP-TABLE
           MOVE        "key26"          TO    MCP-PATHNAME
           PERFORM      DB-CLOSE-SEC
      *
           PERFORM    VARYING   IDZ    FROM   1   BY   1
                       UNTIL   (IDZ    >    15)
                         OR    (LNK2-SYU-SRYYMD(IDZ) =  SPACE)
               MOVE     LNK2-SYUNOU-REC(IDZ)  TO  SYU-SYUNOU-REC
               PERFORM  210F1-SYUNOU-CHIHOU-HENSYU-SEC
           END-PERFORM
      *
           .
      *
       210F-SYUNOU-CHIHOU-KENSAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    和歌山県地方公費（２８１）に関わる編集
      ******************************************************************
       210F1-SYUNOU-CHIHOU-HENSYU-SEC           SECTION.
      *
      *    収納保険情報編集
           MOVE    ZERO   TO   FLG-GENBUTU-CHECK
           PERFORM  2202B-SYUNOU-HKN-HENSYU-SEC
           IF   FLG-SYUNOU-HKN-HANTEI  =  1
             GO   TO   210F1-SYUNOU-CHIHOU-HENSYU-EXT
           END-IF
      *
           IF   (LNK-SYU-YKZKENNUM  =  SYU-YKZKENNUM  )
           AND  (WK-HKNJANUM6-TBL   =  WK-HKNJANUM-TBL)
              IF   (SYU-SYUHKNNUM  NOT = SPACE          )
              AND  (SYU-KOH1HKNNUM     = "281"          )
              AND  (SYU-KOH2HKNNUM     = SPACE          )
              AND  (SYU-KOH3HKNNUM     = SPACE          )
              AND  (SYU-KOH4HKNNUM     = SPACE          )
              AND  (WK-HKNJANUM2-TBL   = WK-HKNJANUM-TBL)
                COMPUTE  WK-FUTANWARI = WK-SYUNOU-GENBUTU70-FTNRATE
                                      / 100
                COMPUTE  WK-WAKAYAMA-HANTEIKIN2 = SYU-TOTAL-HKNTEN
                                                * 10
                                                * WK-FUTANWARI
                COMPUTE  WK-WAKAYAMA-HANTEIKIN  =
                         WK-WAKAYAMA-HANTEIKIN  +
                         WK-WAKAYAMA-HANTEIKIN2
                COMPUTE  WK-WAKAYAMA-HANTEITEN  =
                         WK-WAKAYAMA-HANTEITEN  +
                         SYU-TOTAL-HKNTEN
              ELSE
                MOVE     1     TO    FLG-WAKAYAMA-HANTEI
              END-IF
           END-IF
      *
           .
      *
       210F1-SYUNOU-CHIHOU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    診療月内の収納マスタから公費毎の使用回数と患者負担金額の
      *    累計を調査
      ******************************************************************
       220-SYUNOU-SEC           SECTION.
      *
           MOVE     ZERO        TO    FLG-NYUGAI.
           MOVE     ZERO        TO    FLG-NYUGAI2.
           MOVE     ZERO        TO    FLG-TOKYO.
           MOVE     ZERO        TO    FLG-GEN70-TOKUSYU.
      *
           INITIALIZE                 WK-TAIHI-DENPNUMXX-OCC.
           MOVE     ZERO        TO    FLG-GRPNYURYOKU.
           MOVE     ZERO        TO    WK-CYOKI.
           MOVE     ZERO        TO    WK-CYOKI-ENTANI.
           MOVE     ZERO        TO    WK-CYOKI-TOKU75.
           MOVE     ZERO        TO    WK-CYOKI-ENTANI-TOKU75.
      *
           MOVE     ZERO        TO    WK-OITA-HKNFTNMONEY.
           MOVE     ZERO        TO    WK-OITA-CYOFTN.
      *
           INITIALIZE                 WK-GNBKEIKBN-K-TBL.
      *
           MOVE     ZERO        TO    FLG-SYUKEI2.
      *
           MOVE     ZERO        TO    WK-GENBUTU-HKNKIN.
      *
           MOVE     ZERO        TO    WK-KUMAMOTO-HANTEIKIN.
      *
           MOVE     ZERO        TO    FLG-OITA-SYUKEI.
      *
           INITIALIZE                 WK-MARUKO-TBL.
           INITIALIZE                 WK-RUI-TBL.
           MOVE     ZERO        TO    FLG-RUIKEIYO.
           MOVE     ZERO        TO    FLG-RUIKEIYO2.
      *
           MOVE     ZERO        TO    WK-JYOSEI-KOHIKIN-RUI.
           MOVE     ZERO        TO    WK-JYOSEI-KOHIKIN-RUI2.
           MOVE     ZERO        TO    WK-JYOSEI-KOHIKIN-RUI3.
      *
           MOVE     ZERO        TO    WK-IRYOKEIKBN-HANTEITEN.
      *
           INITIALIZE                 WK-GENGAKU-TEN-TBL.
           MOVE     ZERO        TO    IDX14.
      *
           IF    COMB-KOH1HKNNUM     =  "970"
               IF   (FLG-GENBUTU70           NOT =  ZERO)
               OR   (LNK-S01-KOUREI-ZAITAKU-KBN  =  "1" )
                   MOVE  "1"    TO    WK-1001-DAISANKBN
               END-IF
           END-IF.
      *
      *    保険組み合わせ適用開始日チェック
           MOVE      LNK-SYU-SRYYMD(1:6)    TO   WK-CHECK-TEKYM.
           IF   COMB-TEKSTYMD(1:6)  >=  LNK-SYU-SRYYMD(1:6)
              MOVE   COMB-TEKSTYMD(7:2)     TO   WK-CHECK-TEKDD
           ELSE
              MOVE   01                     TO   WK-CHECK-TEKDD
           END-IF.
      *
           PERFORM     2205-FLG-HENSYU-SEC.
      *
           IF  (COMB-KOH1-GAIJGNKBN         =  "1"         )
           OR  (COMB-KOH2-GAIJGNKBN         =  "1"         )
           OR  (COMB-KOH3-GAIJGNKBN         =  "1"         )
           OR  (COMB-KOH4-GAIJGNKBN         =  "1"         )
           OR  (WK-2010-IRYOKEIKBN-G(1)     =  "3" OR "4"  )
           OR  (WK-2010-IRYOKEIKBN-G(2)     =  "3" OR "4"  )
           OR  (WK-2010-IRYOKEIKBN-G(3)     =  "3" OR "4"  )
           OR  (WK-2010-IRYOKEIKBN-G(4)     =  "3" OR "4"  )
           OR  (LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"         )
           OR  (FLG-KOUREI-KBN              =  "1"         )
           OR  (FLG-KOHININBARAI            =   1          )
           OR  (FLG-GENBUTU70           NOT =  ZERO        )
           OR  (FLG-TOKU75-CYO              =   1 OR 2 OR 3)
           OR  (FLG-CYOKI-ARI               =   1 OR 2     )
           OR  (LNK-SYU-YKZKENNUM           =   2 OR 5     )
      *
               IF   WK-1001-PREFNUM       =     32
               AND  LNK-SYU-SRYYMD(1:6)   <    "200510"
                    IF    LNK-SYU-KOH1HKNNUM = "190" OR "191"
                        MOVE     1    TO     FLG-NYUGAI2
                    END-IF
                    IF    LNK-SYU-KOH2HKNNUM = "190" OR "191"
                        MOVE     2    TO     FLG-NYUGAI2
                    END-IF
                    IF    LNK-SYU-KOH3HKNNUM = "190" OR "191"
                        MOVE     3    TO     FLG-NYUGAI2
                    END-IF
                    IF    LNK-SYU-KOH4HKNNUM = "190" OR "191"
                        MOVE     4    TO     FLG-NYUGAI2
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200604"
                    IF   (LNK-SYU-KOH1HKNNUM  = "015" OR "016" OR "021")
                    AND  (WK-JIRITU-CYUKANSOU(1)   =  2                )
                        MOVE     1    TO     FLG-NYUGAI
                        MOVE  WK-JIRITU-TAFTNRUIKEI(1) TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
                        IF    WK-TAIHI-JGNKOHFLG(1) = 1
                          MOVE  WK-JIRITU-TAFTNRUIKEI(1)
                                                TO WK-TAIHI-TAINFTN(1)
                        END-IF
                    END-IF
                    IF   (LNK-SYU-KOH2HKNNUM  = "015" OR "016" OR "021")
                    AND  (WK-JIRITU-CYUKANSOU(2)   =  2                )
                        MOVE     2    TO     FLG-NYUGAI
                        MOVE  WK-JIRITU-TAFTNRUIKEI(2) TO FTN-KOHI2-M
                                                          FTN-KOHI2-M2
                                                          FTN-KOHI2-M3
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200610"
                    IF   LNK-SYU-KOH1HKNNUM  = "024" OR "079"
                        MOVE     1    TO     FLG-NYUGAI
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM  = "024" OR "079"
                        MOVE     2    TO     FLG-NYUGAI
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200804"
                    IF   LNK-SYU-KOH1HKNNUM  = "038"
                        MOVE     1    TO     FLG-NYUGAI
                        MOVE  WK-KANEN-TAFTNRUIKEI(1)  TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
                        IF    WK-TAIHI-JGNKOHFLG(1) = 1
                          MOVE  WK-KANEN-TAFTNRUIKEI(1)
                                                TO WK-TAIHI-TAINFTN(1)
                        END-IF
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "201501"
                    IF   LNK-SYU-KOH1HKNNUM  = "052" OR "054"
                        MOVE     1    TO     FLG-NYUGAI
                        MOVE  WK-TOKUSITU-TAFTNRUIKEI(1)
                                                       TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
                        IF    WK-TAIHI-JGNKOHFLG(1) = 1
                          MOVE  WK-TOKUSITU-TAFTNRUIKEI(1)
                                                TO WK-TAIHI-TAINFTN(1)
                        END-IF
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM  = "054"
                        MOVE     2    TO     FLG-NYUGAI
                        MOVE  WK-TOKUSITU-TAFTNRUIKEI(2)
                                                       TO FTN-KOHI2-M
                                                          FTN-KOHI2-M2
                                                          FTN-KOHI2-M3
                    END-IF
               END-IF
      *
               IF  (LNK-SYU-KOH1HKNNUM(1:1)  >=  "1" AND <=  "8")
               AND (WK-KOHJGNGET-TAISYOKBN(1) =   2             )
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(1) TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM(1:1)  >=  "1" AND <=  "8")
               AND (WK-KOHJGNGET-TAISYOKBN(2) =   2             )
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(2) TO FTN-KOHI2-M
                                                          FTN-KOHI2-M2
                                                          FTN-KOHI2-M3
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM(1:1)  >=  "1" AND <=  "8")
               AND (WK-KOHJGNGET-TAISYOKBN(3) =   2             )
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(3) TO FTN-KOHI3-M
                                                          FTN-KOHI3-M2
                                                          FTN-KOHI3-M3
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM(1:1)  >=  "1" AND <=  "8")
               AND (WK-KOHJGNGET-TAISYOKBN(4) =   2             )
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(4) TO FTN-KOHI4-M
                                                          FTN-KOHI4-M2
                                                          FTN-KOHI4-M3
               END-IF
      *
               PERFORM     2204-JGNFTNKBN-HENSYU-SEC
      *
               IF    FLG-NYUGAI    NOT =   ZERO
               OR    FLG-NYUGAI2   NOT =   ZERO
                 INITIALIZE                         SYU-SYUNOU-REC
                 MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
                 MOVE    LNK-SYU-PTID         TO    SYU-PTID
                 MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
                 MOVE    "__"                 TO    SYU-SRYYMD(7:2)
                 MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
                 MOVE    "DBSELECT"           TO    MCP-FUNC
                 MOVE    "tbl_syunou"         TO    MCP-TABLE
                 MOVE    "key30"              TO    MCP-PATHNAME
                 CALL    "ORCDBMAIN"          USING MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                 IF      MCP-RC             =       ZERO
                     MOVE    "tbl_syunou"     TO    MCP-TABLE
                     MOVE    "key30"          TO    MCP-PATHNAME
                     PERFORM  SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                       IF   SYU-DENPJTIKBN  NOT =  "3"
                          IF   SYU-NYUGAIKBN    =  "1"
                            IF   SYU-DAYINFFLG  =  "1"
                               PERFORM     SYUDAY-READ-SEC
                            ELSE
                               INITIALIZE  SYU-SYUDAY-REC
                            END-IF
                          ELSE
                               INITIALIZE  SYU-SYUDAY-REC
                          END-IF
                          PERFORM     2202-SYUNOU-COUNT-SEC
                       END-IF
                       MOVE     "tbl_syunou"  TO    MCP-TABLE
                       MOVE     "key30"       TO    MCP-PATHNAME
                       PERFORM   SYUNOU-READ-SEC
                     END-PERFORM
                     MOVE        LNK-SYU-SRYYMD(7:2)   TO   IDX2X
                     MOVE        KOHI1-TBL(IDX2) TO    KAISU-KOHI1-D
                     MOVE        KOHI2-TBL(IDX2) TO    KAISU-KOHI2-D
                     MOVE        KOHI3-TBL(IDX2) TO    KAISU-KOHI3-D
                     MOVE        KOHI4-TBL(IDX2) TO    KAISU-KOHI4-D
                     MOVE        KOHI1-TBL(32)   TO    KAISU-KOHI1-M
                     MOVE        KOHI2-TBL(32)   TO    KAISU-KOHI2-M
                     MOVE        KOHI3-TBL(32)   TO    KAISU-KOHI3-M
                     MOVE        KOHI4-TBL(32)   TO    KAISU-KOHI4-M
                 END-IF
      *
                 MOVE     "tbl_syunou"  TO   MCP-TABLE
                 MOVE     "key30"       TO   MCP-PATHNAME
                 PERFORM   DB-CLOSE-SEC
               ELSE
                 INITIALIZE                         SYU-SYUNOU-REC
                 MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
                 MOVE    LNK-SYU-NYUGAIKBN    TO    SYU-NYUGAIKBN
                 MOVE    LNK-SYU-PTID         TO    SYU-PTID
                 MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
                 MOVE    "__"                 TO    SYU-SRYYMD(7:2)
                 MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
                 MOVE    "DBSELECT"           TO    MCP-FUNC
                 MOVE    "tbl_syunou"         TO    MCP-TABLE
                 MOVE    "key26"              TO    MCP-PATHNAME
                 CALL    "ORCDBMAIN"          USING MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                 IF      MCP-RC             =       ZERO
                     MOVE    "tbl_syunou"     TO    MCP-TABLE
                     MOVE    "key26"          TO    MCP-PATHNAME
                     PERFORM  SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                       IF   SYU-DENPJTIKBN  NOT =  "3"
                               INITIALIZE  SYU-SYUDAY-REC
                               PERFORM     2202-SYUNOU-COUNT-SEC
                       END-IF
                       MOVE     "tbl_syunou"  TO    MCP-TABLE
                       MOVE     "key26"       TO    MCP-PATHNAME
                       PERFORM   SYUNOU-READ-SEC
                     END-PERFORM
                     MOVE        LNK-SYU-SRYYMD(7:2)   TO   IDX2X
                     MOVE        KOHI1-TBL(IDX2) TO    KAISU-KOHI1-D
                     MOVE        KOHI2-TBL(IDX2) TO    KAISU-KOHI2-D
                     MOVE        KOHI3-TBL(IDX2) TO    KAISU-KOHI3-D
                     MOVE        KOHI4-TBL(IDX2) TO    KAISU-KOHI4-D
                     MOVE        KOHI1-TBL(32)   TO    KAISU-KOHI1-M
                     MOVE        KOHI2-TBL(32)   TO    KAISU-KOHI2-M
                     MOVE        KOHI3-TBL(32)   TO    KAISU-KOHI3-M
                     MOVE        KOHI4-TBL(32)   TO    KAISU-KOHI4-M
                 END-IF
      *
                 MOVE     "tbl_syunou"  TO   MCP-TABLE
                 MOVE     "key26"       TO   MCP-PATHNAME
                 PERFORM   DB-CLOSE-SEC
               END-IF
      *
               PERFORM    VARYING   IDZ    FROM   1   BY   1
                           UNTIL  (IDZ    >    15)
                             OR   (LNK2-SYU-SRYYMD(IDZ) =  SPACE)
                 IF   (LNK-S01-RETRY-FLG  =  SPACE)
                 AND  (LNK-S01-IDX2       <   IDZ )
                   CONTINUE
                 ELSE
                   MOVE   1                     TO  FLG-GRPNYURYOKU
      *
                   MOVE   LNK2-SYUNOU-REC(IDZ)  TO  SYU-SYUNOU-REC
                   INITIALIZE     SYU-SYUDAY-REC
                   PERFORM        2202-SYUNOU-COUNT-SEC
                 END-IF
               END-PERFORM
      *
           END-IF.
      *
           IF     FLG-GENBUTU70   NOT =   ZERO
              IF     FLG-IRYOHI70 =
                      1 OR 3 OR 5 OR 7 OR 8 OR 9 OR 10 OR 11 OR 12
                IF    FLG-TOKU75  =  3
                  IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                    EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF  WK-KOUREI-IRYOHI70  >  421000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 421000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                     WHEN      12
                       IF  WK-KOUREI-IRYOHI70  >  279000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 279000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                    END-EVALUATE
                  ELSE
                       IF  WK-KOUREI-IRYOHI70  >  250000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 250000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                  END-IF
                ELSE
                  IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                    EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF  WK-KOUREI-IRYOHI70  >  842000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 842000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                     WHEN      12
                       IF  WK-KOUREI-IRYOHI70  >  558000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 558000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                    END-EVALUATE
                  ELSE
                       IF  WK-KOUREI-IRYOHI70  >  500000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 500000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                  END-IF
                END-IF
              END-IF
      *
              IF     FLG-IRYOHI70 =  2 OR 4 OR 6
                IF    FLG-TOKU75  =  3
                       IF  WK-KOUREI-IRYOHI70  >  133500
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 133500 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                ELSE
                       IF  WK-KOUREI-IRYOHI70  >  267000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 267000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                END-IF
              END-IF
      *
              EVALUATE   FLG-IRYOHI70K
                WHEN         1
                  IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K   >  1935690
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                  END-IF
                  IF  FLG-TOKU75  =  3
                  AND WK-KOUREI-IRYOHI70K-TOKU75 >  133500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K-TOKU75 - 133500 )
                                                        * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M-TOKU75
                                             =   MAX-KIN-KOHI1-M-TOKU75
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K-TOKU75   >  967890
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K-TOKU75
                   END-IF
                  END-IF
                WHEN         2
                  IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K   >   860340
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                  END-IF
                  IF  FLG-TOKU75  =  3
                  AND WK-KOUREI-IRYOHI70K-TOKU75 >  133500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K-TOKU75 - 133500 )
                                                        * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M-TOKU75
                                             =   MAX-KIN-KOHI1-M-TOKU75
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K-TOKU75   >  430140
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K-TOKU75
                   END-IF
                  END-IF
                WHEN        11
                  IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K   >   860340
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                  END-IF
                WHEN        12
                  IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                  END-IF
                WHEN        13
                  IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K   >   407520
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                  END-IF
              END-EVALUATE
      *
              IF  (FLG-IRYOHI70   NOT =  ZERO    )
              OR  (FLG-IRYOHI70K      =  1  OR  2)
                IF   WK-GENGAKUKBN    NOT =  ZERO
                AND  WK-GENGAKUKBN-KEISAN =  ZERO
                     PERFORM   2203-KOHFTN-KINGAKU-GEN2-SEC
                END-IF
              END-IF
           ELSE
              IF    LNK-SYU-SRYYMD(1:6)  >= "200610"
                EVALUATE   FLG-IRYOHI
                  WHEN         1
                    IF  WK-IRYOHI  >  267000
                      COMPUTE WK-IRYOHI2 =
                           (( WK-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                      COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                                +   WK-IRYOHI2
                      IF   WK-IRYOHI   >   860340
                        MOVE  1    TO    FLG-KOUGAKUCYO-JIRITU
                      END-IF
                    END-IF
                END-EVALUATE
      *
                EVALUATE   FLG-IRYOHI2
                  WHEN         1
                    IF  WK-IRYOHI  >  267000
                      COMPUTE WK-IRYOHI2 =
                           (( WK-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                      COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                                +   WK-IRYOHI2
                      IF   WK-IRYOHI   >   860340
                        MOVE  1    TO    FLG-KOUGAKUCYO2
                      END-IF
                    END-IF
                  WHEN         2
                    IF  WK-IRYOHI  >  267000
                      COMPUTE WK-IRYOHI2 =
                           (( WK-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                      COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                                +   WK-IRYOHI2
                      MOVE    1    TO    FLG-KOUGAKUCYO2
                    END-IF
                  WHEN         3
                    IF  WK-IRYOHI  >  267000
                      COMPUTE WK-IRYOHI2 =
                           (( WK-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                      COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                                +   WK-IRYOHI2
                      IF   WK-IRYOHI   >   407520
                        MOVE  1    TO    FLG-KOUGAKUCYO2
                      END-IF
                   END-IF
                END-EVALUATE
      *
                EVALUATE   FLG-IRYOHIKG
                  WHEN         1
                    IF   FLG-TOKU75  =  1 OR 2
                      IF   WK-KOUREI-IRYOHI  >  421000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 421000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO
                      END-IF
                    ELSE
                      IF   WK-KOUREI-IRYOHI  >  842000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 842000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO
                      END-IF
                    END-IF
                  WHEN         2
                    IF   FLG-TOKU75  =  1 OR 2
                      IF   WK-KOUREI-IRYOHI  >  279000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 279000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO
                      END-IF
                    ELSE
                      IF   WK-KOUREI-IRYOHI  >  558000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 558000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO
                      END-IF
                    END-IF
                  WHEN         3
                    IF   FLG-TOKU75  =  1 OR 2
                      IF   WK-KOUREI-IRYOHI  >  133500
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 133500 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO
                      END-IF
                    ELSE
                      IF   WK-KOUREI-IRYOHI  >  267000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO
                      END-IF
                    END-IF
                END-EVALUATE
      *
                EVALUATE   FLG-IRYOHIKG2
                  WHEN         1
                  WHEN         4
                    IF   FLG-TOKU75  =  1 OR 2
                      IF   WK-KOUREI-IRYOHI  >  421000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 421000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO3
                      END-IF
                    ELSE
                      IF   WK-KOUREI-IRYOHI  >  842000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 842000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO3
                      END-IF
                    END-IF
                  WHEN         2
                  WHEN         5
                    IF   FLG-TOKU75  =  1 OR 2
                      IF   WK-KOUREI-IRYOHI  >  279000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 279000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO3
                      END-IF
                    ELSE
                      IF   WK-KOUREI-IRYOHI  >  558000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 558000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO3
                      END-IF
                    END-IF
                  WHEN         3
                  WHEN         6
                    IF   FLG-TOKU75  =  1 OR 2
                      IF   WK-KOUREI-IRYOHI  >  133500
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 133500 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO3
                      END-IF
                    ELSE
                      IF   WK-KOUREI-IRYOHI  >  267000
                        COMPUTE WK-KOUREI-IRYOHI2 =
                             (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 )
                                                             + 0.5
                        COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                               + WK-KOUREI-IRYOHI2
                        MOVE   1   TO   FLG-KOUGAKUCYO3
                      END-IF
                    END-IF
                END-EVALUATE
              ELSE
                EVALUATE   FLG-IRYOHI
                  WHEN         1
                    IF  WK-IRYOHI  >  241000
                      COMPUTE WK-IRYOHI2 =
                           (( WK-IRYOHI  - 241000 ) * 0.01 ) + 0.5
                      COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                                +   WK-IRYOHI2
                      IF   WK-IRYOHI   >   776540
                        MOVE  1    TO    FLG-KOUGAKUCYO-JIRITU
                      END-IF
                    END-IF
                END-EVALUATE
              END-IF
      *
              IF  (FLG-IRYOHI         =  1   )
              OR  (FLG-IRYOHIKG   NOT =  ZERO)
              OR  (FLG-IRYOHIKG2  NOT =  ZERO)
                IF   WK-GENGAKUKBN    NOT =  ZERO
                AND  WK-GENGAKUKBN-KEISAN =  ZERO
                   PERFORM   2203-KOHFTN-KINGAKU-GEN2-SEC
                END-IF
              END-IF
           END-IF.
      *
           IF   (FLG-KOHININBARAI      =    1      )
           AND  (LNK-SYU-SRYYMD(1:6)  >=   "201501")
              EVALUATE   FLG-IRYOHI70
                WHEN        7
                  IF  WK-KOUREI-IRYOHI70  >  842000
                    COMPUTE WK-KOUREI-IRYOHI70X =
                         (( WK-KOUREI-IRYOHI70  - 842000 ) * 0.01 )
                                                           + 0.5
                    COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                           + WK-KOUREI-IRYOHI70X
                    MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                  END-IF
                WHEN        8
                  IF  WK-KOUREI-IRYOHI70  >  558000
                    COMPUTE WK-KOUREI-IRYOHI70X =
                         (( WK-KOUREI-IRYOHI70  - 558000 ) * 0.01 )
                                                           + 0.5
                    COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                           + WK-KOUREI-IRYOHI70X
                    MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                  END-IF
                WHEN        2
                  IF  WK-KOUREI-IRYOHI70  >  267000
                    COMPUTE WK-KOUREI-IRYOHI70X =
                         (( WK-KOUREI-IRYOHI70  - 267000 ) * 0.01 )
                                                           + 0.5
                    COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                           + WK-KOUREI-IRYOHI70X
                    MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                  END-IF
              END-EVALUATE
           END-IF.
      *
       220-SYUNOU-EXT.
           EXIT.
      *
      ******************************************************************
      *        診療月の収納マスタから公費の回数（金額）カウント
      ******************************************************************
       2202-SYUNOU-COUNT-SEC          SECTION.
      *
      *    収納保険情報編集
           MOVE     1     TO   FLG-GENBUTU-CHECK.
           MOVE     ZERO  TO   FLG-GENBUTU-CHECK-ERR.
           PERFORM  2202B-SYUNOU-HKN-HENSYU-SEC.
           IF   FLG-SYUNOU-HKN-HANTEI  =  1
             GO   TO   2202-SYUNOU-COUNT-EXT
           END-IF.
      *
      *    公費ＩＤ編集
           PERFORM  22027-KOHID-HENSYU-SEC.
      *
           IF  (( WK-1001-PREFNUM     =  44            ) AND
                ( LNK-SYU-SRYYMD(1:6) >= "200610"      ) AND
                ( LNK-SYU-SRYYMD(1:6) <  "201010"      ) AND
                ((LNK-SYU-KOH1HKNNUM  = "183" OR "283") OR
                 (LNK-SYU-KOH2HKNNUM  = "183" OR "283") OR
                 (LNK-SYU-KOH3HKNNUM  = "183" OR "283") OR
                 (LNK-SYU-KOH4HKNNUM  = "183" OR "283")) AND
                ((SYU-KOH1HKNNUM      = "183" OR "283") OR
                 (SYU-KOH2HKNNUM      = "183" OR "283") OR
                 (SYU-KOH3HKNNUM      = "183" OR "283") OR
                 (SYU-KOH4HKNNUM      = "183" OR "283")))
           OR  (((WK-2010-NINNASIKBN(1) NOT = SPACE   ) OR
                 (WK-2010-NINJYOKBN(1)  NOT = SPACE   )) AND
                ( LNK-SYU-KOH1HKNNUM  = SYU-KOH1HKNNUM
                                     OR SYU-KOH2HKNNUM
                                     OR SYU-KOH3HKNNUM
                                     OR SYU-KOH4HKNNUM ))
           OR  (((WK-2010-NINNASIKBN(2) NOT = SPACE   ) OR
                 (WK-2010-NINJYOKBN(2)  NOT = SPACE   )) AND
                ( LNK-SYU-KOH2HKNNUM  = SYU-KOH1HKNNUM
                                     OR SYU-KOH2HKNNUM
                                     OR SYU-KOH3HKNNUM
                                     OR SYU-KOH4HKNNUM ))
           OR  (((WK-2010-NINNASIKBN(3) NOT = SPACE   ) OR
                 (WK-2010-NINJYOKBN(3)  NOT = SPACE   )) AND
                ( LNK-SYU-KOH3HKNNUM  = SYU-KOH1HKNNUM
                                     OR SYU-KOH2HKNNUM
                                     OR SYU-KOH3HKNNUM
                                     OR SYU-KOH4HKNNUM ))
           OR  (((WK-2010-NINNASIKBN(4) NOT = SPACE   ) OR
                 (WK-2010-NINJYOKBN(4)  NOT = SPACE   )) AND
                ( LNK-SYU-KOH4HKNNUM  = SYU-KOH1HKNNUM
                                     OR SYU-KOH2HKNNUM
                                     OR SYU-KOH3HKNNUM
                                     OR SYU-KOH4HKNNUM ))
             IF   SYU-NYUGAIKBN   =  "2"
               COMPUTE  SYU-KOH-FTN         =  SYU-KOH-FTN
                                            -  SYU-JYO-COMPFTN
               COMPUTE  SYU-KOH-FTN-ENTANI  =  SYU-KOH-FTN-ENTANI
                                            -  SYU-JYO-COMPFTN
             END-IF
           END-IF.
      *
           IF   ((WK-2010-SYOKEI2KBN-G(1) = "1"        ) AND
                 (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                                     OR  SYU-KOH2HKNNUM
                                     OR  SYU-KOH3HKNNUM
                                     OR  SYU-KOH4HKNNUM))
           OR   ((WK-2010-SYOKEI2KBN-G(2) = "1"        ) AND
                 (LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                                     OR  SYU-KOH2HKNNUM
                                     OR  SYU-KOH3HKNNUM
                                     OR  SYU-KOH4HKNNUM))
           OR   ((WK-2010-SYOKEI2KBN-G(3) = "1"        ) AND
                 (LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                                     OR  SYU-KOH2HKNNUM
                                     OR  SYU-KOH3HKNNUM
                                     OR  SYU-KOH4HKNNUM))
           OR   ((WK-2010-SYOKEI2KBN-G(4) = "1"        ) AND
                 (LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                                     OR  SYU-KOH2HKNNUM
                                     OR  SYU-KOH3HKNNUM
                                     OR  SYU-KOH4HKNNUM))
             IF   SYU-NYUGAIKBN   =  "2"
               COMPUTE  SYU-KOH-FTN         =  SYU-KOH-FTN
                                            +  SYU-JYO-COMPFTN
               COMPUTE  SYU-KOH-FTN-ENTANI  =  SYU-KOH-FTN-ENTANI
                                            +  SYU-JYO-COMPFTN-ENTANI
             END-IF
           END-IF.
      *
           IF  (WK-1001-PREFNUM          =  43      ) AND
               (LNK-SYU-SRYYMD(1:6)     >= "200912" )
             IF   SYU-NYUGAIKBN   =  "2"
              IF  ((LNK-SYU-KOH1HKNNUM  = "143" OR "342") OR
                   (LNK-SYU-KOH2HKNNUM  = "143" OR "342") OR
                   (LNK-SYU-KOH3HKNNUM  = "143" OR "342") OR
                   (LNK-SYU-KOH4HKNNUM  = "143" OR "342"))
              AND ((SYU-KOH1HKNNUM      = "143" OR "342") OR
                   (SYU-KOH2HKNNUM      = "143" OR "342") OR
                   (SYU-KOH3HKNNUM      = "143" OR "342") OR
                   (SYU-KOH4HKNNUM      = "143" OR "342"))
                 COMPUTE  WK-KUMAMOTO-HANTEIKIN  =
                          WK-KUMAMOTO-HANTEIKIN  +  SYU-JYO-HKNFTNMONEY
              END-IF
             END-IF
           END-IF.
      *
           IF  (WK-1001-PREFNUM          =  43      ) AND
               (LNK-SYU-SRYYMD(1:6)     >= "201608" )
             IF   SYU-NYUGAIKBN   =  "2"
              IF  ((LNK-SYU-KOH1HKNNUM  = "443") OR
                   (LNK-SYU-KOH2HKNNUM  = "443") OR
                   (LNK-SYU-KOH3HKNNUM  = "443") OR
                   (LNK-SYU-KOH4HKNNUM  = "443"))
              AND ((SYU-KOH1HKNNUM      = "443") OR
                   (SYU-KOH2HKNNUM      = "443") OR
                   (SYU-KOH3HKNNUM      = "443") OR
                   (SYU-KOH4HKNNUM      = "443"))
                 COMPUTE  WK-KUMAMOTO-HANTEIKIN  =
                          WK-KUMAMOTO-HANTEIKIN  +  SYU-JYO-HKNFTNMONEY
              END-IF
             END-IF
           END-IF.
      *
           IF   (WK-1001-PREFNUM       =  35 OR 34)
           AND  (LNK-SYU-SRYYMD(1:6)  >= "201309" )
             IF  ((LNK-SYU-KOH1HKNNUM  = "781") OR
                  (LNK-SYU-KOH2HKNNUM  = "781") OR
                  (LNK-SYU-KOH3HKNNUM  = "781") OR
                  (LNK-SYU-KOH4HKNNUM  = "781"))
             AND ((SYU-KOH1HKNNUM      = "781") OR
                  (SYU-KOH2HKNNUM      = "781") OR
                  (SYU-KOH3HKNNUM      = "781") OR
                  (SYU-KOH4HKNNUM      = "781"))
               IF   (SYU-NYUGAIKBN          =  "2"    )
               AND  (SYU-JYO-HKNFTNMONEY    =  9999999)
                 COMPUTE   SYU-KOH-FTN         =  SYU-JYO-COMPFTN
                 COMPUTE   SYU-KOH-FTN-ENTANI  =  SYU-JYO-COMPFTN-ENTANI
      *
                 ADD   SYU-JYO-COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI
                 IF    SYU-KOH1HKNNUM  = "781"
                   ADD SYU-KOH1HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH1COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH2HKNNUM  = "781"
                   ADD SYU-KOH2HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH2COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH3HKNNUM  = "781"
                   ADD SYU-KOH3HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH3COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH4HKNNUM  = "781"
                   ADD SYU-KOH4HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH4COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
               END-IF
             END-IF
           END-IF.
      *
           IF   (WK-1001-PREFNUM       =  23     )
           AND  (LNK-SYU-SRYYMD(1:6)  >= "201504")
             IF  ((LNK-SYU-KOH1HKNNUM  = "581" OR "681" OR
                                         "781" OR "271"   ) OR
                  (LNK-SYU-KOH2HKNNUM  = "581" OR "681" OR
                                         "781" OR "271"   ) OR
                  (LNK-SYU-KOH3HKNNUM  = "581" OR "681" OR
                                         "781" OR "271"   ) OR
                  (LNK-SYU-KOH4HKNNUM  = "581" OR "681" OR
                                         "781" OR "271"   ))
             AND ((SYU-KOH1HKNNUM      = "581" OR "681" OR
                                         "781" OR "271"   ) OR
                  (SYU-KOH2HKNNUM      = "581" OR "681" OR
                                         "781" OR "271"   ) OR
                  (SYU-KOH3HKNNUM      = "581" OR "681" OR
                                         "781" OR "271"   ) OR
                  (SYU-KOH4HKNNUM      = "581" OR "681" OR
                                         "781" OR "271"   ))
               IF   (SYU-NYUGAIKBN          =  "2"    )
               AND  (SYU-JYO-HKNFTNMONEY    =  9999999)
                 COMPUTE   SYU-KOH-FTN         =  SYU-JYO-COMPFTN
                 COMPUTE   SYU-KOH-FTN-ENTANI  =  SYU-JYO-COMPFTN-ENTANI
      *
                 ADD   SYU-JYO-COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI
                 IF    SYU-KOH1HKNNUM  = "581" OR "681" OR
                                         "781" OR "271"
                   ADD SYU-KOH1HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH1COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH2HKNNUM  = "581" OR "681" OR
                                         "781" OR "271"
                   ADD SYU-KOH2HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH2COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH3HKNNUM  = "581" OR "681" OR
                                         "781" OR "271"
                   ADD SYU-KOH3HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH3COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH4HKNNUM  = "581" OR "681" OR
                                         "781" OR "271"
                   ADD SYU-KOH4HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH4COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
               END-IF
             END-IF
           END-IF.
      *
      *平成１４年１０月改正対応
      *高齢者の在宅総合・在宅末期算定患者
      *
           MOVE     ZERO     TO     FLG-ZAITAKU.                         
           MOVE     ZERO     TO     FLG-SYUKEI.
           MOVE     ZERO     TO     FLG-SYUKEI3.
           MOVE     ZERO     TO     FLG-TAISYO.
      *
           IF   SYU-NYUGAIKBN  =  "2"
             IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1")
             OR  (FLG-KOHININBARAI             =    1 )
             OR  (FLG-GENBUTU70            NOT =  ZERO)
             OR  (FLG-TOKU75-CYO         = 1 OR 2 OR 3)
             OR  (FLG-CYOKI-ARI          = 1 OR 2     )
      *
              IF  LNK-SYU-YKZKENNUM  =  SYU-YKZKENNUM
      *
               MOVE    ZERO   TO   FLG-DAISAN-GENBUTU2
               IF  (SYU-KOH1HKNNUM      =  "970"   )
               AND (SYU-SKJ-FTNGAKU(2)  =   ZERO   )
               AND (SYU-SRYYMD(1:6)    >=  "201204")
                  PERFORM  2202F-DAISAN-GENBUTU-CHECK-SEC
               END-IF
      *
               IF ( SYU-SYUHKNNUM       =  "971" OR "973" OR "975"
                                        OR "068" OR "069" OR "040" )
               OR ( SYU-SYUHKNNUM(1:2)  =  "98"  OR "90"  OR "91"  )
               OR ((COMB-KOH1HKNNUM     NOT  =  "970"             ) AND
                   (SYU-KOH1HKNNUM           =  "970"             ) AND
                   (SYU-SKJ-FTNGAKU(2)  NOT  =   ZERO             ) AND
                   (SYU-PTFTNRATE            =   ZERO             ) AND
                   (LNK-S01-IKTGENKEIFLG     =   SPACE OR "1"     ))
               OR ((SYU-KOH1HKNNUM           =  "970"             ) AND
                   (SYU-SKJ-FTNGAKU(2)       =   ZERO             ) AND
                   (FLG-DAISAN-GENBUTU2      =   ZERO             ))
               OR ((SYU-KOH1HKNNUM           =  "970"             ) AND
                   (SYU-SKJ-FTNGAKU(2)       =   ZERO             ) AND
                   (FLG-DAISAN-GENBUTU2      =   1                ) AND
                   (SYU-PTFTNRATE            =   ZERO             ) AND
                   (LNK-S01-IKTGENKEIFLG     =   SPACE OR "1"     ))
      *
                 IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =  "1" ) OR
                      (FLG-GENBUTU70            NOT = ZERO ))
                 AND ( COMB-HKNNUM              NOT = SPACE )
                 AND ( SYU-SYUHKNNUM            NOT = SPACE )
                 AND ( WK-HKNJANUM2-TBL  =  WK-HKNJANUM-TBL )
                 AND ( LNK-SYU-SRYYMD(1:6)      >= "201204" )
                 AND ( LNK-SYU-TOTAL-HKNTEN     NOT = ZERO  )
                 AND ( SYU-TOTAL-HKNTEN         NOT = ZERO  )
                   IF  (COMB-KOH1HKNNUM    NOT  =  "970")
                   AND (SYU-KOH1HKNNUM          =  "970")
                   AND (SYU-SKJ-FTNGAKU(2) NOT  =   ZERO)
                   AND (SYU-PTFTNRATE           =   ZERO)
                     MOVE  4    TO  WK-SYUNOU-GENBUTU70-MSG
                   END-IF
                   IF  (SYU-KOH1HKNNUM          =  "970")
                   AND (SYU-SKJ-FTNGAKU(2)      =   ZERO)
                   AND (FLG-DAISAN-GENBUTU2     =   1   )
                   AND (SYU-PTFTNRATE           =   ZERO)
                     MOVE  4    TO  WK-SYUNOU-GENBUTU70-MSG
                   END-IF
                 END-IF
      *
               ELSE
      *
                 IF COMB-KOH1HKNNUM      =    "027"
                      MOVE     SYU-KOH1COMPFTN  TO  WK-SYU-SYUCOMPFTN
      ***
                      IF    SYU-KOH1HKNNUM               =  "027"
                       IF   LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
                        IF  (SYU-KOH2HKNNUM     NOT = SPACE)              
                        OR  (SYU-KOH3HKNNUM     NOT = SPACE)              
                        OR  (SYU-KOH4HKNNUM     NOT = SPACE)              
                          MOVE     SYU-KOH-FTN  TO  WK-SYU-SYUCOMPFTN     
                        END-IF                                            
                        IF     LNK-SYU-SRYYMD(7:2)   =  SYU-SRYYMD(7:2)  
                          ADD   WK-SYU-SYUCOMPFTN TO   FTN-KOHI1-D      
                        END-IF                                          
                        ADD   WK-SYU-SYUCOMPFTN   TO   FTN-KOHI1-M      
      *
                        COMPUTE WK-ENTANI = SYU-KOH1COMPFTN-ENTANI + 0.9
                        IF  (SYU-KOH2HKNNUM     NOT = SPACE)
                        OR  (SYU-KOH3HKNNUM     NOT = SPACE)
                        OR  (SYU-KOH4HKNNUM     NOT = SPACE)
                          COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                        END-IF
                        IF     LNK-SYU-SRYYMD(7:2)   =  SYU-SRYYMD(7:2)
                          ADD   WK-ENTANI     TO   FTN-KOHI1-D-ENTANI
                        END-IF
                        ADD   WK-ENTANI       TO   FTN-KOHI1-M-ENTANI
                       END-IF
                       IF   FLG-KOHININBARAI  =    1
                        IF  (SYU-KOH2HKNNUM   =  SPACE)
                        AND (SYU-KOH3HKNNUM   =  SPACE)
                        AND (SYU-KOH4HKNNUM   =  SPACE)
                         IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                          IF  LNK-SYU-SRYYMD(7:2)  =  SYU-SRYYMD(7:2)
                            ADD   WK-SYU-SYUCOMPFTN TO   FTN-KOHI1-D
                          END-IF
                          ADD   WK-SYU-SYUCOMPFTN   TO   FTN-KOHI1-M
      *
                          COMPUTE WK-ENTANI =
                                  SYU-KOH1COMPFTN-ENTANI + 0.9
                          IF  LNK-SYU-SRYYMD(7:2)  =  SYU-SRYYMD(7:2)
                            ADD   WK-ENTANI     TO   FTN-KOHI1-D-ENTANI
                          END-IF
                          ADD   WK-ENTANI       TO   FTN-KOHI1-M-ENTANI
                         END-IF
                        END-IF
                       END-IF
                       MOVE  1                     TO   FLG-ZAITAKU      
                      END-IF
                 ELSE                                                   
                      PERFORM  2202C-CYOKI-HANTEI-SEC
      *
                      MOVE     SYU-SYUCOMPFTN   TO  WK-SYU-SYUCOMPFTN
      ***
                      IF   (SYU-SYUHKNNUM      NOT = SPACE)
                      AND  (COMB-HKNNUM        NOT = SPACE)
                       IF   LNK-S01-KOUREI-ZAITAKU-KBN   =   "1"
                        PERFORM   22025-KOUREI-SYU-HENSYU-SEC
                       END-IF
                       IF   FLG-KOHININBARAI  =    1
                        IF  (SYU-KOH1HKNNUM   =  SPACE)
                        AND (SYU-KOH2HKNNUM   =  SPACE)
                        AND (SYU-KOH3HKNNUM   =  SPACE)
                        AND (SYU-KOH4HKNNUM   =  SPACE)
                         IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                          ADD   WK-SYU-SYUCOMPFTN TO  FTN-SYU-M
      *
                          COMPUTE WK-ENTANI =
                                  SYU-SYUCOMPFTN-ENTANI + 0.9
                          ADD   WK-ENTANI         TO  FTN-SYU-M-ENTANI
                          IF   (FLG-IRYOHI70  =  2 OR 7 OR 8      )
                          AND  (LNK-SYU-SRYYMD(1:6)  >=   "201501")
                            COMPUTE   WK-KOUREI-IRYOHI70  =
                                      WK-KOUREI-IRYOHI70  +
                                     (SYU-HKNTEN (17) * 10)
                          END-IF
                         END-IF
                        END-IF
                       END-IF
                       IF  FLG-GENBUTU70    NOT =  ZERO
                        PERFORM   22024-GEN70-SYU-HENSYU-SEC
                       END-IF
                       IF  FLG-TOKU75-CYO = 1 OR 2 OR 3
                        PERFORM   22028-TOKU75-CYO-HENSYU-SEC
                       END-IF
                       IF  FLG-CYOKI-ARI  = 1 OR 2
                        PERFORM   22029-CYOKI-ARI-HENSYU-SEC
                       END-IF
                      END-IF
                 END-IF                                                 
      *
               END-IF
      *
              END-IF
             END-IF
      *
             IF      LNK-SYU-KOH1HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22026-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
             IF      LNK-SYU-KOH2HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22026-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
             IF      LNK-SYU-KOH3HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22026-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
             IF      LNK-SYU-KOH4HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22026-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
      *
             IF (FLG-GENBUTU70          NOT =   ZERO)
             OR (FLG-TOKU75-CYO             =    3  )
             OR (FLG-CYOKI-ARI              =    2  )
               IF    FLG-MARUKO  =  2
                 IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
                 OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                 OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                 OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                   IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                     COMPUTE   WK-MARUKO-XX    =
                               SYU-KOH1COMPFTN +  5
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    /  10
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    *  10
                     ADD  WK-MARUKO-XX            TO  WK-MARUKO-M
                     ADD  SYU-KOH1COMPFTN-ENTANI  TO  WK-MARUKO-ME
                     COMPUTE   WK-MARUKO-KIN   =
                               WK-MARUKO-KIN   +
                              (SYU-HKNTEN (17) * 10)
                   END-IF
                   IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                     COMPUTE   WK-MARUKO-XX    =
                               SYU-KOH2COMPFTN +  5
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    /  10
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    *  10
                     ADD  WK-MARUKO-XX            TO  WK-MARUKO-M
                     ADD  SYU-KOH2COMPFTN-ENTANI  TO  WK-MARUKO-ME
                     COMPUTE   WK-MARUKO-KIN   =
                               WK-MARUKO-KIN   +
                              (SYU-HKNTEN (17) * 10)
                   END-IF
                   IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                     COMPUTE   WK-MARUKO-XX    =
                               SYU-KOH3COMPFTN +  5
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    /  10
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    *  10
                     ADD  WK-MARUKO-XX            TO  WK-MARUKO-M
                     ADD  SYU-KOH3COMPFTN-ENTANI  TO  WK-MARUKO-ME
                     COMPUTE   WK-MARUKO-KIN   =
                               WK-MARUKO-KIN   +
                              (SYU-HKNTEN (17) * 10)
                   END-IF
                   IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                     COMPUTE   WK-MARUKO-XX    =
                               SYU-KOH4COMPFTN +  5
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    /  10
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    *  10
                     ADD  WK-MARUKO-XX            TO  WK-MARUKO-M
                     ADD  SYU-KOH4COMPFTN-ENTANI  TO  WK-MARUKO-ME
                     COMPUTE   WK-MARUKO-KIN   =
                               WK-MARUKO-KIN   +
                              (SYU-HKNTEN (17) * 10)
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
             IF   (LNK-SYU-YKZKENNUM  =  SYU-YKZKENNUM  )
             AND  (SYU-YKZKENNUM      =   2 OR 5        )
             AND  (WK-HKNJANUM4-TBL   =  WK-HKNJANUM-TBL)
               IF  (LNK-S01-SAIKEISAN-KBN   =   "1")
               AND (LNK-SYU-DENPNUM     NOT =  ZERO)
               AND (LNK-SYU-DENPNUM  <  SYU-DENPNUM)
                 CONTINUE
               ELSE
                 ADD     1                 TO  IDX14
                 IF   IDX14 <= 100
                   MOVE  SYU-TOTAL-HKNTEN  TO  WK-GENGAKU-TEN(IDX14)
                   IF    SYU-YKZKENNUM  =   5
                     IF   (SYU-SYUHKNNUM   NOT =  SPACE)
                     AND  (SYU-KOH1HKNNUM      =  SPACE)
                     AND  (SYU-KOH2HKNNUM      =  SPACE)
                     AND  (SYU-KOH3HKNNUM      =  SPACE)
                     AND  (SYU-KOH4HKNNUM      =  SPACE)
                       MOVE  SYU-SYUCOMPFTN
                                   TO  WK-GENGAKU-FTN(IDX14)
                       MOVE  SYU-SYUCOMPFTN-ENTANI
                                   TO  WK-GENGAKU-FTN-ENTANI(IDX14)
                     ELSE
                       MOVE  SYU-KOH-FTN
                                   TO  WK-GENGAKU-FTN(IDX14)
                       MOVE  SYU-KOH-FTN-ENTANI
                                   TO  WK-GENGAKU-FTN-ENTANI(IDX14)
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
             PERFORM  VARYING  IDX19  FROM  1  BY  1
                       UNTIL   IDX19   >    4
               IF  (WK-2010-GNBKEIKBN-K-G(IDX19)    =  "2"  )
               AND (LNK-S01-KOUREI-ZAITAKU-KBN      =  "1"  )
               AND (COMB-KOH1HKNNUM   NOT =  "972" AND "974")
               AND (COMB-KOH2HKNNUM   NOT =  "972" AND "974")
               AND (COMB-KOH3HKNNUM   NOT =  "972" AND "974")
               AND (COMB-KOH4HKNNUM   NOT =  "972" AND "974")
               AND (FLG-KEISAN-TAI2                 =   1   )
                 EVALUATE  IDX19
                   WHEN      1
                     IF (MAX-KIN-KOHI1-D  NOT =  ZERO)
                     OR (MAX-KIN-KOHI1-K  NOT =  ZERO)
                       PERFORM   2202D-GNBKEIKBN-K-HENSYU-SEC
                     END-IF
                   WHEN      2
                     IF (MAX-KIN-KOHI2-D  NOT =  ZERO)
                     OR (MAX-KIN-KOHI2-K  NOT =  ZERO)
                       PERFORM   2202D-GNBKEIKBN-K-HENSYU-SEC
                     END-IF
                   WHEN      3
                     IF (MAX-KIN-KOHI3-D  NOT =  ZERO)
                     OR (MAX-KIN-KOHI3-K  NOT =  ZERO)
                       PERFORM   2202D-GNBKEIKBN-K-HENSYU-SEC
                     END-IF
                   WHEN      4
                     IF (MAX-KIN-KOHI4-D  NOT =  ZERO)
                     OR (MAX-KIN-KOHI4-K  NOT =  ZERO)
                       PERFORM   2202D-GNBKEIKBN-K-HENSYU-SEC
                     END-IF
                 END-EVALUATE
               END-IF
             END-PERFORM
      *
             IF   (LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"      )
             AND  (COMB-KOH1HKNNUM   NOT =  "972" AND "974")
             AND  (COMB-KOH2HKNNUM   NOT =  "972" AND "974")
             AND  (COMB-KOH3HKNNUM   NOT =  "972" AND "974")
             AND  (COMB-KOH4HKNNUM   NOT =  "972" AND "974")
             AND  (LNK-SYU-SRYYMD(1:6)        >=  "201204" )
                IF  (WK-2010-GNBKEIKBN-K-G(1)  NOT =  "2")
                AND (WK-2010-GNBKEIKBN-K-G(2)  NOT =  "2")
                AND (WK-2010-GNBKEIKBN-K-G(3)  NOT =  "2")
                AND (WK-2010-GNBKEIKBN-K-G(4)  NOT =  "2")
                AND (FLG-KEISAN-TAI2               =   1 )
                       MOVE      5    TO   IDX19
                       PERFORM   2202D-GNBKEIKBN-K-HENSYU-SEC
                END-IF
             END-IF
      *
           END-IF.
      *
      *    公費１カウント
           IF ((COMB-KOH1HKNNUM           NOT =  SPACE) AND
               (COMB-KOH1-GAIJGNKBN           =  "1"  ) AND
               (FLG-ZAITAKU                   =  ZERO ))
           OR ( WK-2010-IRYOKEIKBN-G(1)  =  "3" OR "4" )
           OR ((FLG-IRYOHI70    =  3 OR  4 OR  5 OR  6
                                OR 9 OR 10 OR 11 OR 12) AND
               (COMB-KOH1HKNNUM           NOT =  SPACE))
           OR ((FLG-IRYOHIKG2             NOT =  ZERO ) AND
               (COMB-KOH1HKNNUM           NOT =  SPACE))
           OR ( FLG-OITA-SYUKEI          =    1        )
             IF  ( SYU-NYUGAIKBN              =   "2"   )
             OR  ((SYU-NYUGAIKBN              =   "1"  ) AND
                  (FLG-NYUGAI                 =    1   ))
             OR  ((SYU-NYUGAIKBN              =   "1"  ) AND
                  (FLG-NYUGAI2                =    1   ))
               IF   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
      *
                  IF   SYU-NYUGAIKBN  =   "2"
                   IF  FLG-GENBUTU70    NOT =  ZERO
                    IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                     IF   FLG-IRYOHI70  =  3 OR  4 OR  5 OR  6
                                        OR 9 OR 10 OR 11 OR 12
                       IF  FLG-SYUKEI  =  ZERO
                         COMPUTE  WK-KOUREI-IRYOHI70  =
                                  WK-KOUREI-IRYOHI70  +
                                 (SYU-HKNTEN (17) * 10)
                         MOVE     1    TO      FLG-SYUKEI
                       END-IF
                       IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                           (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                       OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                           (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                       OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                           (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                          MOVE    1    TO      FLG-SYUKEI2
                          COMPUTE  WK-KOUREI-IRYOHI70-JYOGAI =
                                   WK-KOUREI-IRYOHI70-JYOGAI +
                                  (SYU-HKNTEN (17) * 10)
                       END-IF
                     ELSE
                       IF    FLG-OITA-SYUKEI  =   1
                         COMPUTE  WK-KOUREI-IRYOHI70  =
                                  WK-KOUREI-IRYOHI70  +
                                 (SYU-HKNTEN (17) * 10)
                         IF ((LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM ) AND
                             (COMB-KOH1ID        = WRK-COMB-KOH2ID))
                         OR ((LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM ) AND
                             (COMB-KOH1ID        = WRK-COMB-KOH3ID))
                         OR ((LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM ) AND
                             (COMB-KOH1ID        = WRK-COMB-KOH4ID))
                          MOVE    1    TO      FLG-SYUKEI2
                          COMPUTE  WK-KOUREI-IRYOHI70-JYOGAI =
                                   WK-KOUREI-IRYOHI70-JYOGAI +
                                  (SYU-HKNTEN (17) * 10)
                         END-IF
                       END-IF
                     END-IF
                    END-IF
                    IF  (FLG-SYUKEI3       =  ZERO)
                    AND (FLG-IRYOHI70K NOT =  ZERO)
                      COMPUTE  WK-KOUREI-IRYOHI70K =
                               WK-KOUREI-IRYOHI70K +
                              (SYU-HKNTEN (17) * 10)
                      IF   FLG-RUITAISYO  =  1
                         COMPUTE  WK-KOUREI-IRYOHI70K-TOKU75 =
                                  WK-KOUREI-IRYOHI70K-TOKU75 +
                                 (SYU-HKNTEN (17) * 10)
                      END-IF
                      MOVE     1    TO      FLG-SYUKEI3
                    END-IF
                   ELSE
                    IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                     IF   FLG-IRYOHIKG2  NOT =  ZERO
                       IF  FLG-SYUKEI  =  ZERO
                         COMPUTE  WK-KOUREI-IRYOHI  =
                                  WK-KOUREI-IRYOHI  +
                                 (SYU-HKNTEN (17) * 10)
                         MOVE     1    TO      FLG-SYUKEI
                       END-IF
                     END-IF
                    END-IF
                    IF   (FLG-IRYOHI         =  1   )
                    OR   (FLG-IRYOHI2    NOT =  ZERO)
                         COMPUTE  WK-IRYOHI  =
                                  WK-IRYOHI  +
                                 (SYU-HKNTEN (17) * 10)
                    END-IF
                   END-IF
                  END-IF
      *
                  IF   SYU-NYUGAIKBN  =   "2"
                   MOVE   SYU-SRYYMD(7:2)     TO   IDX2X
                   MOVE   1                   TO   IDX3
                   IF   (MAX-KIN-KOHI1-D    NOT =  ZERO)
                   OR   (MAX-KIN-KOHI1-M    NOT =  ZERO)
                       MOVE  MAX-KIN-KOHI1-D  TO   WK-MAX-KIN-D
                       PERFORM   22021-KAISU-COUNT-SEC
                   ELSE
                       PERFORM   22022-KAISU-COUNT2-SEC
                   END-IF
                  END-IF
      *
                  IF   SYU-NYUGAIKBN  =   "1"
                   MOVE   LNK-SYU-SRYYMD(7:2) TO   IDX2X
                   MOVE   1                   TO   IDX3
                   IF  MAX-KIN-KOHI1-D    NOT =  ZERO
                       PERFORM   2202A-KAISU-COUNT3-SEC
                   END-IF
                  END-IF
      *
                   IF   WK-2010-IRYOKEIKBN-G(1)  NOT = SPACE
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH1HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           COMPUTE  WK-TOKUSYU  = SYU-JYO-COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-TOKUSYU2 = SYU-KOH1COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-KEISAN   =
                                    WK-TOKUSYU  - WK-TOKUSYU2
                           ADD      WK-KEISAN   TO   FTN-SYU-M-ENTANI
                         END-IF
                         EVALUATE   WK-2010-IRYOKEIKBN-G(1)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(1)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH2HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           COMPUTE  WK-TOKUSYU  = SYU-JYO-COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-TOKUSYU2 = SYU-KOH2COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-KEISAN   =
                                    WK-TOKUSYU  - WK-TOKUSYU2
                           ADD      WK-KEISAN   TO   FTN-SYU-M-ENTANI
                         END-IF
                         EVALUATE   WK-2010-IRYOKEIKBN-G(1)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(1)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH3HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           COMPUTE  WK-TOKUSYU  = SYU-JYO-COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-TOKUSYU2 = SYU-KOH3COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-KEISAN   =
                                    WK-TOKUSYU  - WK-TOKUSYU2
                           ADD      WK-KEISAN   TO   FTN-SYU-M-ENTANI
                         END-IF
                         EVALUATE   WK-2010-IRYOKEIKBN-G(1)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(1)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH4HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           COMPUTE  WK-TOKUSYU  = SYU-JYO-COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-TOKUSYU2 = SYU-KOH4COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-KEISAN   =
                                    WK-TOKUSYU  - WK-TOKUSYU2
                           ADD      WK-KEISAN   TO   FTN-SYU-M-ENTANI
                         END-IF
                         EVALUATE   WK-2010-IRYOKEIKBN-G(1)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(1)
                         END-EVALUATE
                      END-IF
                      IF   WK-2010-IRYOKEIKBN-G(1) = "2"
                         COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                                   WK-IRYOKEIKBN-HANTEITEN  +
                                   SYU-TOTAL-HKNTEN
                      END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                      MOVE  SYU-KOH1HKNFTNMONEY
                                      TO  WK-RUI-TAIHI-HKNFTNMONEY
                      MOVE  SYU-KOH1COMPFTN
                                      TO  WK-RUI-TAIHI-COMPFTN
                      MOVE  SYU-KOH1COMPFTN-ENTANI
                                      TO  WK-RUI-TAIHI-COMPFTN-ENTANI
                   END-IF
      *
                   IF   WK-2010-KINJYOKBN-G(1)  = "1"
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-SYU-M
                          COMPUTE  FTN-SYU-M = FTN-SYU-M
                                             - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH1COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH1COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  WK-TOKUSYU  TO  FTN-SYU-M-ENTANI
                          COMPUTE WK-KEISAN =
                                  SYU-KOH-FTN-ENTANI + 0.9
                          COMPUTE FTN-SYU-M-ENTANI =
                                  FTN-SYU-M-ENTANI - WK-KEISAN
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-SYU-M
                          COMPUTE  FTN-SYU-M = FTN-SYU-M
                                             - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH2COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH2COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  WK-TOKUSYU  TO  FTN-SYU-M-ENTANI
                          COMPUTE WK-KEISAN =
                                  SYU-KOH-FTN-ENTANI + 0.9
                          COMPUTE FTN-SYU-M-ENTANI =
                                  FTN-SYU-M-ENTANI - WK-KEISAN
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-SYU-M
                          COMPUTE  FTN-SYU-M = FTN-SYU-M
                                             - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH3COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH3COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  WK-TOKUSYU  TO  FTN-SYU-M-ENTANI
                          COMPUTE WK-KEISAN =
                                  SYU-KOH-FTN-ENTANI + 0.9
                          COMPUTE FTN-SYU-M-ENTANI =
                                  FTN-SYU-M-ENTANI - WK-KEISAN
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-SYU-M
                          COMPUTE  FTN-SYU-M = FTN-SYU-M
                                             - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH4COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH4COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  WK-TOKUSYU  TO  FTN-SYU-M-ENTANI
                          COMPUTE WK-KEISAN =
                                  SYU-KOH-FTN-ENTANI + 0.9
                          COMPUTE FTN-SYU-M-ENTANI =
                                  FTN-SYU-M-ENTANI - WK-KEISAN
                        END-IF
                      END-IF
                   END-IF
      *
                   IF   WK-2010-SYOKEI2KBN-G(1) = "1"
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH1HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH1COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH2HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH2COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH3HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH3COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH4HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH4COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH4COMPFTN-ENTANI
                      END-IF
                   END-IF
      *
                   IF  (SYU-NYUGAIKBN                   =  "2"  )
                   AND (WK-2010-GNBKEIKBN-K-G(1)        =  "1"  )
                   AND (LNK-S01-KOUREI-ZAITAKU-KBN      =  "1"  )
                   AND (COMB-KOH1HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH2HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH3HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH4HKNNUM   NOT =  "972" AND "974")
                   AND (FLG-KEISAN-TAI2                 =   1   )
                   AND ((MAX-KIN-KOHI1-D  NOT =  ZERO          ) OR
                        (MAX-KIN-KOHI1-K  NOT =  ZERO          ))
                       MOVE      1    TO   IDX19
                       PERFORM   2202D-GNBKEIKBN-K-HENSYU-SEC
                   END-IF
      *
                   IF ((WK-1001-PREFNUM          =  44      ) AND
                       (LNK-SYU-KOH1HKNNUM  = "183" OR "283") AND
                       (LNK-SYU-SRYYMD(1:6)     >= "200610" ) AND
                       (LNK-SYU-SRYYMD(1:6)     <  "201010" ))
                   OR ( WK-2010-NINNASIKBN(1)  NOT = SPACE   )
                   OR ( WK-2010-NINJYOKBN(1)   NOT = SPACE   )
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                                               OR  SYU-KOH2HKNNUM
                                               OR  SYU-KOH3HKNNUM
                                               OR  SYU-KOH4HKNNUM
                         ADD   SYU-JYO-HKNFTNMONEY
                                        TO  WK-OITA-HKNFTNMONEY
                         ADD   SYU-JYO-COMPFTN
                                        TO  WK-OITA-CYOFTN
                      END-IF
                   END-IF
      *
                   IF   (SYU-NYUGAIKBN        =  "2"            )
                   AND  (LNK-SYU-SRYYMD(7:2)  =  SYU-SRYYMD(7:2))
                       EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                                    TO  FTN-KOHI1-D
                                 IF  SYU-KOH1YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI1-D2 =              
                                            FTN-KOHI1-D2     +          
                                            SYU-KOH1COMPFTN  +          
                                            SYU-KOH1COMPYKZFTN          
                                   COMPUTE  FTN-KOHI1-D3 =              
                                            FTN-KOHI1-D3            +   
                                            SYU-KOH1COMPFTN-ENTANI  +   
                                            SYU-KOH1COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH1COMPFTN                
                                                    TO  FTN-KOHI1-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI1-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH1HKNFTNMONEY
                                                      TO  FTN-KOHI1-D-K
                                   IF  SYU-KOH1YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI1-D2-K =            
                                              FTN-KOHI1-D2-K   +          
                                              SYU-KOH1COMPFTN  +          
                                              SYU-KOH1COMPYKZFTN          
                                     COMPUTE  FTN-KOHI1-D3-K =          
                                              FTN-KOHI1-D3-K          + 
                                              SYU-KOH1COMPFTN-ENTANI  + 
                                              SYU-KOH1COMPYKZFTN      + 
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH1COMPFTN                
                                                      TO  FTN-KOHI1-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI1-D3-K 
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                                 ADD   SYU-KOH2HKNFTNMONEY
                                                    TO  FTN-KOHI1-D
                                 IF  SYU-KOH2YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI1-D2 =              
                                            FTN-KOHI1-D2     +          
                                            SYU-KOH2COMPFTN  +          
                                            SYU-KOH2COMPYKZFTN          
                                   COMPUTE  FTN-KOHI1-D3 =              
                                            FTN-KOHI1-D3            +   
                                            SYU-KOH2COMPFTN-ENTANI  +   
                                            SYU-KOH2COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH2COMPFTN                
                                                    TO  FTN-KOHI1-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI1-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH2HKNFTNMONEY
                                                      TO  FTN-KOHI1-D-K
                                   IF  SYU-KOH2YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI1-D2-K =            
                                              FTN-KOHI1-D2-K   +          
                                              SYU-KOH2COMPFTN  +          
                                              SYU-KOH2COMPYKZFTN          
                                     COMPUTE  FTN-KOHI1-D3-K =            
                                              FTN-KOHI1-D3-K          +   
                                              SYU-KOH2COMPFTN-ENTANI  +   
                                              SYU-KOH2COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH2COMPFTN                
                                                      TO  FTN-KOHI1-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI1-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                                 ADD   SYU-KOH3HKNFTNMONEY
                                                    TO  FTN-KOHI1-D
                                 IF  SYU-KOH3YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI1-D2 =              
                                            FTN-KOHI1-D2     +          
                                            SYU-KOH3COMPFTN  +          
                                            SYU-KOH3COMPYKZFTN          
                                   COMPUTE  FTN-KOHI1-D3 =              
                                            FTN-KOHI1-D3            +   
                                            SYU-KOH3COMPFTN-ENTANI  +   
                                            SYU-KOH3COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH3COMPFTN                
                                                    TO  FTN-KOHI1-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI1-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH3HKNFTNMONEY
                                                      TO  FTN-KOHI1-D-K
                                   IF  SYU-KOH3YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI1-D2-K =            
                                              FTN-KOHI1-D2-K   +          
                                              SYU-KOH3COMPFTN  +          
                                              SYU-KOH3COMPYKZFTN          
                                     COMPUTE  FTN-KOHI1-D3-K =          
                                              FTN-KOHI1-D3-K          +   
                                              SYU-KOH3COMPFTN-ENTANI  +   
                                              SYU-KOH3COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH3COMPFTN                
                                                      TO  FTN-KOHI1-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI1-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                                 ADD   SYU-KOH4HKNFTNMONEY
                                                    TO  FTN-KOHI1-D
                                 IF  SYU-KOH4YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI1-D2 =              
                                            FTN-KOHI1-D2     +          
                                            SYU-KOH4COMPFTN  +          
                                            SYU-KOH4COMPYKZFTN          
                                   COMPUTE  FTN-KOHI1-D3 =              
                                            FTN-KOHI1-D3            +   
                                            SYU-KOH4COMPFTN-ENTANI  +   
                                            SYU-KOH4COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH4COMPFTN                
                                                    TO  FTN-KOHI1-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI1-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH4HKNFTNMONEY
                                                      TO  FTN-KOHI1-D-K
                                   IF  SYU-KOH4YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI1-D2-K =            
                                              FTN-KOHI1-D2-K   +          
                                              SYU-KOH4COMPFTN  +          
                                              SYU-KOH4COMPYKZFTN          
                                     COMPUTE  FTN-KOHI1-D3-K =          
                                              FTN-KOHI1-D3-K          +   
                                              SYU-KOH4COMPFTN-ENTANI  +   
                                              SYU-KOH4COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH4COMPFTN                
                                                      TO  FTN-KOHI1-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI1-D3-K    
                                   END-IF                                
                                 END-IF
                       END-EVALUATE
                   END-IF
      *
                   IF   SYU-NYUGAIKBN        =  "1"
                       EVALUATE  TRUE
                         WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 1)
                                          TO  FTN-KOHI1-D
                           ADD   SDAY-COMPFTN(IDX2 1)
                                          TO  FTN-KOHI1-D2
                           ADD   SDAY-COMPFTNWK(IDX2 1)
                                          TO  FTN-KOHI1-D3
                         WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 2)
                                          TO  FTN-KOHI1-D
                           ADD   SDAY-COMPFTN(IDX2 2)
                                          TO  FTN-KOHI1-D2
                           ADD   SDAY-COMPFTNWK(IDX2 2)
                                          TO  FTN-KOHI1-D3
                         WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 3)
                                          TO  FTN-KOHI1-D
                           ADD   SDAY-COMPFTN(IDX2 3)
                                          TO  FTN-KOHI1-D2
                           ADD   SDAY-COMPFTNWK(IDX2 3)
                                          TO  FTN-KOHI1-D3
                         WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 4)
                                          TO  FTN-KOHI1-D
                           ADD   SDAY-COMPFTN(IDX2 4)
                                          TO  FTN-KOHI1-D2
                           ADD   SDAY-COMPFTNWK(IDX2 4)
                                          TO  FTN-KOHI1-D3
                       END-EVALUATE
                   END-IF
      *
                   EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             IF  SYU-KOH1YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI1-M2 =                  
                                        FTN-KOHI1-M2     +              
                                        SYU-KOH1COMPFTN  +              
                                        SYU-KOH1COMPYKZFTN              
                               COMPUTE  FTN-KOHI1-M3 =                  
                                        FTN-KOHI1-M3            +       
                                        SYU-KOH1COMPFTN-ENTANI  +       
                                        SYU-KOH1COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH1COMPFTN                    
                                                TO  FTN-KOHI1-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3        
                             END-IF                                     
                             IF  (FLG-RUIKEIYO =  1              )
                             AND (LNK-SYU-KOH2HKNNUM
                                               =  SYU-KOH2HKNNUM )
                             AND (COMB-KOH2ID  =  WRK-COMB-KOH2ID)
                             AND (WK-HKNJANUM3-TBL
                                               =  WK-HKNJANUM-TBL)
                              IF WK-2010-KINJYOKBN-G(1) = "1"
                               ADD   WK-RUI-TAIHI-HKNFTNMONEY
                                                TO  WK-RUI-FTN1-M
                               IF  SYU-NYNSHOKAISU  =  9
                                  ADD  WK-RUI-TAIHI-HKNFTNMONEY
                                                TO  WK-RUI-FTN1-M2
                               ELSE
                                  ADD  WK-RUI-TAIHI-COMPFTN
                                                TO  WK-RUI-FTN1-M2
                               END-IF
                               ADD   WK-RUI-TAIHI-COMPFTN-ENTANI
                                                TO  WK-RUI-FTN1-M3
                               COMPUTE WK-ENTANI =
                                       WK-RUI-TAIHI-COMPFTN-ENTANI
                                                              + 0.9
                               ADD   WK-ENTANI  TO  WK-RUI-FTN1-M4
                              ELSE
                               ADD   SYU-KOH1HKNFTNMONEY
                                                TO  WK-RUI-FTN1-M
                               IF  SYU-NYNSHOKAISU  =  9
                                  ADD  SYU-KOH1HKNFTNMONEY
                                                TO  WK-RUI-FTN1-M2
                               ELSE
                                  ADD  SYU-KOH1COMPFTN
                                                TO  WK-RUI-FTN1-M2
                               END-IF
                               ADD   SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-RUI-FTN1-M3
                               COMPUTE WK-ENTANI =
                                       SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  WK-RUI-FTN1-M4
                              END-IF
                             END-IF
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(1)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                             "024" OR "079"        ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200804") AND
                                 (LNK-SYU-KOH1HKNNUM    =  "038"   ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "201501") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "052" OR "054"         ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-KOH1HKNNUM(1:1)
                                                 >= "1" AND <=  "8") AND
                                 (WK-KOHJGNGET-TAISYOKBN(1)
                                                           =  2    ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                                ADD   SYU-KOH1HKNFTNMONEY
                                                   TO  FTN-KOHI1-M-JI
                                ADD   SYU-KOH1COMPFTN
                                                   TO  FTN-KOHI1-M2-JI
                                COMPUTE WK-ENTANI =
                                          SYU-KOH1COMPFTN-ENTANI + 0.9
                                ADD   WK-ENTANI    TO  FTN-KOHI1-M3-JI
                                IF  (FLG-RUIKEIYO =  1              )
                                AND (LNK-SYU-KOH2HKNNUM
                                                  =  SYU-KOH2HKNNUM )
                                AND (COMB-KOH2ID  =  WRK-COMB-KOH2ID)
                                AND (WK-HKNJANUM3-TBL
                                                  =  WK-HKNJANUM-TBL)
                                  ADD   SYU-KOH1HKNFTNMONEY
                                                   TO  WK-RUI-FTN1-M-JI
                                  IF  SYU-NYNSHOKAISU  =  9
                                     ADD  SYU-KOH1HKNFTNMONEY
                                                   TO  WK-RUI-FTN1-M2-JI
                                  ELSE
                                     ADD  SYU-KOH1COMPFTN
                                                   TO  WK-RUI-FTN1-M2-JI
                                  END-IF
                                  ADD   SYU-KOH1COMPFTN-ENTANI
                                                   TO  WK-RUI-FTN1-M3-JI
                                  COMPUTE WK-ENTANI =
                                        SYU-KOH1COMPFTN-ENTANI + 0.9
                                  ADD   WK-ENTANI  TO  WK-RUI-FTN1-M4-JI
                                END-IF
                                IF   FLG-RUITAISYO  =  1
                                  ADD   SYU-KOH1HKNFTNMONEY
                                            TO  FTN-KOHI1-M-JI-TOKU75
                                  ADD   SYU-KOH1COMPFTN
                                            TO  FTN-KOHI1-M2-JI-TOKU75
                                  COMPUTE WK-ENTANI =
                                          SYU-KOH1COMPFTN-ENTANI + 0.9
                                  ADD   WK-ENTANI
                                            TO  FTN-KOHI1-M3-JI-TOKU75
                                  IF  (FLG-RUIKEIYO =  1              )
                                  AND (LNK-SYU-KOH2HKNNUM
                                                    =  SYU-KOH2HKNNUM )
                                  AND (COMB-KOH2ID  =  WRK-COMB-KOH2ID)
                                  AND (WK-HKNJANUM3-TBL
                                                    =  WK-HKNJANUM-TBL)
                                    ADD   SYU-KOH1HKNFTNMONEY
                                            TO  WK-RUI-FTN1-M-JI-TOKU75
                                    IF  SYU-NYNSHOKAISU  =  9
                                       ADD  SYU-KOH1HKNFTNMONEY
                                            TO  WK-RUI-FTN1-M2-JI-TOKU75
                                    ELSE
                                       ADD  SYU-KOH1COMPFTN
                                            TO  WK-RUI-FTN1-M2-JI-TOKU75
                                    END-IF
                                    ADD   SYU-KOH1COMPFTN-ENTANI
                                            TO  WK-RUI-FTN1-M3-JI-TOKU75
                                    COMPUTE WK-ENTANI =
                                          SYU-KOH1COMPFTN-ENTANI + 0.9
                                    ADD   WK-ENTANI
                                            TO  WK-RUI-FTN1-M4-JI-TOKU75
                                  END-IF
                                END-IF
                             END-IF
                             IF  (LNK-SYU-KOH1HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(1)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH1SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI1-M
                                                    FTN-KOHI1-M2
                                                    FTN-KOHI1-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH1HKNNUM(1:1) = "0" ) OR
                                  (WK-TOKATUKAI(1)         =  1  ) OR
                                  (LNK-SYU-KOH1HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH1HKNFTNMONEY
                                        TO  FTN-KOHI1-M-TOKU75
                               ADD   SYU-KOH1COMPFTN
                                        TO  FTN-KOHI1-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI1-M3-TOKU75
                               IF  (FLG-RUIKEIYO =  1              )
                               AND (LNK-SYU-KOH2HKNNUM
                                                 =  SYU-KOH2HKNNUM )
                               AND (COMB-KOH2ID  =  WRK-COMB-KOH2ID)
                               AND (WK-HKNJANUM3-TBL
                                                 =  WK-HKNJANUM-TBL)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                        TO  WK-RUI-FTN1-M-TOKU75
                                 IF  SYU-NYNSHOKAISU  =  9
                                    ADD  SYU-KOH1HKNFTNMONEY
                                        TO  WK-RUI-FTN1-M2-TOKU75
                                 ELSE
                                    ADD  SYU-KOH1COMPFTN
                                        TO  WK-RUI-FTN1-M2-TOKU75
                                 END-IF
                                 ADD   SYU-KOH1COMPFTN-ENTANI
                                        TO  WK-RUI-FTN1-M3-TOKU75
                                 COMPUTE WK-ENTANI =
                                       SYU-KOH1COMPFTN-ENTANI + 0.9
                                 ADD   WK-ENTANI
                                        TO  WK-RUI-FTN1-M4-TOKU75
                               END-IF
                             END-IF
                             IF    WK-TAIHI-JGNKOHFLG(1) = 1
                               PERFORM  2202E-JGNKOH-TAIHI-HENSYU-SEC
                             END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             IF  SYU-KOH2YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI1-M2 =                  
                                        FTN-KOHI1-M2     +              
                                        SYU-KOH2COMPFTN  +              
                                        SYU-KOH2COMPYKZFTN              
                               COMPUTE  FTN-KOHI1-M3 =                  
                                        FTN-KOHI1-M3            +       
                                        SYU-KOH2COMPFTN-ENTANI  +       
                                        SYU-KOH2COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH2COMPFTN                    
                                                TO  FTN-KOHI1-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3        
                             END-IF                                     
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(1)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                             "024" OR "079"        ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "201501") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                             "054"                 ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-KOH1HKNNUM(1:1)
                                                 >= "1" AND <=  "8") AND
                                 (WK-KOHJGNGET-TAISYOKBN(1)
                                                           =  2    ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                                ADD   SYU-KOH2HKNFTNMONEY
                                                   TO  FTN-KOHI1-M-JI
                                ADD   SYU-KOH2COMPFTN
                                                   TO  FTN-KOHI1-M2-JI
                                COMPUTE WK-ENTANI =
                                          SYU-KOH2COMPFTN-ENTANI + 0.9
                                ADD   WK-ENTANI    TO  FTN-KOHI1-M3-JI
                             END-IF
                             IF  (LNK-SYU-KOH1HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(1)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH2SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI1-M
                                                    FTN-KOHI1-M2
                                                    FTN-KOHI1-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH1HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH1HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH2HKNFTNMONEY
                                        TO  FTN-KOHI1-M-TOKU75
                               ADD   SYU-KOH2COMPFTN
                                        TO  FTN-KOHI1-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI1-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             IF  SYU-KOH3YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI1-M2 =                  
                                        FTN-KOHI1-M2     +              
                                        SYU-KOH3COMPFTN  +              
                                        SYU-KOH3COMPYKZFTN              
                               COMPUTE  FTN-KOHI1-M3 =                  
                                        FTN-KOHI1-M3            +       
                                        SYU-KOH3COMPFTN-ENTANI  +       
                                        SYU-KOH3COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH3COMPFTN                    
                                                TO  FTN-KOHI1-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH1HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(1)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH3SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI1-M
                                                    FTN-KOHI1-M2
                                                    FTN-KOHI1-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH1HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH1HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH3HKNFTNMONEY
                                        TO  FTN-KOHI1-M-TOKU75
                               ADD   SYU-KOH3COMPFTN
                                        TO  FTN-KOHI1-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI1-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             IF  SYU-KOH4YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI1-M2 =                  
                                        FTN-KOHI1-M2     +              
                                        SYU-KOH4COMPFTN  +              
                                        SYU-KOH4COMPYKZFTN              
                               COMPUTE  FTN-KOHI1-M3 =                  
                                        FTN-KOHI1-M3            +       
                                        SYU-KOH4COMPFTN-ENTANI  +       
                                        SYU-KOH4COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH4COMPFTN                    
                                                TO  FTN-KOHI1-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH1HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(1)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH4SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI1-M
                                                    FTN-KOHI1-M2
                                                    FTN-KOHI1-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH1HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH1HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH4HKNFTNMONEY
                                        TO  FTN-KOHI1-M-TOKU75
                               ADD   SYU-KOH4COMPFTN
                                        TO  FTN-KOHI1-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI1-M3-TOKU75
                             END-IF
                   END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *
      *    公費２カウント
           IF ((COMB-KOH2HKNNUM           NOT =  SPACE) AND
               (COMB-KOH2-GAIJGNKBN           =  "1"  ))
           OR ( WK-2010-IRYOKEIKBN-G(2)  =  "3" OR "4" )
           OR ((FLG-IRYOHIKG2     =   4  OR  5  OR  6 ) AND
               (COMB-KOH2HKNNUM           NOT =  SPACE))
           OR ((FLG-IRYOHI70  = 5 OR 6 OR 11 OR 12    ) AND
               (COMB-KOH2HKNNUM           NOT =  SPACE))
           OR ( FLG-RUIKEIYO             =    1        )
             IF  ( SYU-NYUGAIKBN              =   "2"   )
             OR  ((SYU-NYUGAIKBN              =   "1"  ) AND
                  (FLG-NYUGAI                 =    2   ))
             OR  ((SYU-NYUGAIKBN              =   "1"  ) AND
                  (FLG-NYUGAI2                =    2   ))
               IF   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH4ID))
      *
                  IF   SYU-NYUGAIKBN  =   "2"
                   IF  FLG-GENBUTU70    NOT =  ZERO
                    IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                     IF   (FLG-IRYOHI70 =  5 OR 6 OR 11 OR 12  )
                     AND  (FLG-SYUKEI   =  ZERO                )
                       IF ( WK-2010-IRYOKEIKBN-G(2) NOT = SPACE )
                       OR ( WK-2010-KINJYOKBN-G(2)   =  "1"     )
                       OR ((WK-1001-PREFNUM    =  43           ) AND
                           (LNK-SYU-KOH2HKNNUM = "143" OR "342") AND
                           (LNK-SYU-SRYYMD(1:6)  >=  "200912"  ))
                       OR ((WK-1001-PREFNUM    =  43           ) AND
                           (LNK-SYU-KOH2HKNNUM = "443"         ) AND
                           (LNK-SYU-SRYYMD(1:6)  >=  "201608"  ))
                       OR ( FLG-FTNRATE100     =  2             )
                         COMPUTE  WK-KOUREI-IRYOHI70  =
                                  WK-KOUREI-IRYOHI70  +
                                 (SYU-HKNTEN (17) * 10)
                       END-IF
                     END-IF
                    END-IF
                   ELSE
                    IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                     IF   (FLG-IRYOHIKG2  =  4 OR 5 OR 6)
                     AND  (FLG-SYUKEI     =  ZERO       )
                       IF ( WK-2010-IRYOKEIKBN-G(2) NOT = SPACE )
                       OR ( WK-2010-KINJYOKBN-G(2)   =  "1"     )
                       OR ((WK-1001-PREFNUM    =  43           ) AND
                           (LNK-SYU-KOH2HKNNUM = "143" OR "342") AND
                           (LNK-SYU-SRYYMD(1:6)  >=  "200912"  ))
                       OR ((WK-1001-PREFNUM    =  43           ) AND
                           (LNK-SYU-KOH2HKNNUM = "443"         ) AND
                           (LNK-SYU-SRYYMD(1:6)  >=  "201608"  ))
                       OR ( FLG-FTNRATE100     =  2             )
                         COMPUTE  WK-KOUREI-IRYOHI  =
                                  WK-KOUREI-IRYOHI  +
                                 (SYU-HKNTEN (17) * 10)
                       END-IF
                     END-IF
                    END-IF
                   END-IF
                  END-IF
      *
                  IF   SYU-NYUGAIKBN  =   "2"
                   MOVE   SYU-SRYYMD(7:2)     TO    IDX2X
                   MOVE   2                   TO    IDX3
                   IF   (MAX-KIN-KOHI2-D    NOT =  ZERO)
                   OR   (MAX-KIN-KOHI2-M    NOT =  ZERO)
                       MOVE  MAX-KIN-KOHI2-D  TO    WK-MAX-KIN-D
                       PERFORM   22021-KAISU-COUNT-SEC
                   ELSE
                       PERFORM   22022-KAISU-COUNT2-SEC
                   END-IF
                  END-IF
      *
                  IF   SYU-NYUGAIKBN  =   "1"
                   MOVE   LNK-SYU-SRYYMD(7:2) TO   IDX2X
                   MOVE   2                   TO   IDX3
                   IF  MAX-KIN-KOHI2-D    NOT =  ZERO
                       PERFORM   2202A-KAISU-COUNT3-SEC
                   END-IF
                  END-IF
      *
                   IF   WK-2010-IRYOKEIKBN-G(2)  NOT = SPACE
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(2)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(2)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(2)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(2)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(2)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(2)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(2)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(2)
                         END-EVALUATE
                      END-IF
                      IF   WK-2010-IRYOKEIKBN-G(2) = "2"
                         COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                                   WK-IRYOKEIKBN-HANTEITEN  +
                                   SYU-TOTAL-HKNTEN
                      END-IF
                   END-IF
      *
                   IF   WK-2010-KINJYOKBN-G(2)  = "1"
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-KOHI1-M
                          COMPUTE  FTN-KOHI1-M = FTN-KOHI1-M
                                               - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH1COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH1COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  WK-TOKUSYU  TO  FTN-KOHI1-M-ENTANI
                          COMPUTE WK-KEISAN =
                                  SYU-KOH-FTN-ENTANI + 0.9
                          COMPUTE FTN-KOHI1-M-ENTANI =
                                  FTN-KOHI1-M-ENTANI - WK-KEISAN
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-KOHI1-M
                          COMPUTE  FTN-KOHI1-M = FTN-KOHI1-M
                                               - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH2COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH2COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  WK-TOKUSYU  TO  FTN-KOHI1-M-ENTANI
                          COMPUTE WK-KEISAN =
                                  SYU-KOH-FTN-ENTANI + 0.9
                          COMPUTE FTN-KOHI1-M-ENTANI =
                                  FTN-KOHI1-M-ENTANI - WK-KEISAN
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-KOHI1-M
                          COMPUTE  FTN-KOHI1-M = FTN-KOHI1-M
                                               - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH3COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH3COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  WK-TOKUSYU  TO  FTN-KOHI1-M-ENTANI
                          COMPUTE WK-KEISAN =
                                  SYU-KOH-FTN-ENTANI + 0.9
                          COMPUTE FTN-KOHI1-M-ENTANI =
                                  FTN-KOHI1-M-ENTANI - WK-KEISAN
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-KOHI1-M
                          COMPUTE  FTN-KOHI1-M = FTN-KOHI1-M
                                               - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH4COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH4COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  WK-TOKUSYU  TO  FTN-KOHI1-M-ENTANI
                          COMPUTE WK-KEISAN =
                                  SYU-KOH-FTN-ENTANI + 0.9
                          COMPUTE FTN-KOHI1-M-ENTANI =
                                  FTN-KOHI1-M-ENTANI - WK-KEISAN
                        END-IF
                      END-IF
                   END-IF
      *
                   IF   WK-2010-SYOKEI2KBN-G(2) = "1"
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH1HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH1COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH2HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH2COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH3HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH3COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH4HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH4COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH4COMPFTN-ENTANI
                      END-IF
                   END-IF
      *
                   IF ((LNK-SYU-KOH2HKNNUM  = "972" OR "974") AND
                       (WK-2010-CYOKEIKBN-G(1) NOT = SPACE  ) AND
                       (MAX-KIN-KOHI1-D     NOT =  ZERO     ) AND
                       (WK-1039-IKTSORTKBN  =  "0"  OR SPACE) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"      ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO     ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM  ))
                   OR ((LNK-SYU-KOH2HKNNUM  = "972" OR "974") AND
                       (WK-2010-CYOKEIKBN-G(1) NOT = SPACE  ) AND
                       (MAX-KIN-KOHI1-D     NOT =  ZERO     ) AND
                       (WK-1039-IKTSORTKBN  =  "1"          ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE    ) AND
                       (LNK-SYU-SRYYMD      <  SYU-SRYYMD   ))
                   OR ((LNK-SYU-KOH2HKNNUM  = "972" OR "974") AND
                       (WK-2010-CYOKEIKBN-G(1) NOT = SPACE  ) AND
                       (MAX-KIN-KOHI1-D     NOT =  ZERO     ) AND
                       (WK-1039-IKTSORTKBN  =  "1"          ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"      ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE    ) AND
                       (LNK-SYU-SRYYMD      =  SYU-SRYYMD   ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO     ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM  ))
                   OR ((LNK-SYU-KOH2HKNNUM  = "972" OR "974") AND
                       (WK-2010-CYOKEIKBN-G(1) NOT = SPACE  ) AND
                       (MAX-KIN-KOHI1-K     NOT =  ZERO     ) AND
                       (WK-1039-IKTSORTKBN  =  "0"  OR SPACE) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"      ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO     ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM  ))
                   OR ((LNK-SYU-KOH2HKNNUM  = "972" OR "974") AND
                       (WK-2010-CYOKEIKBN-G(1) NOT = SPACE  ) AND
                       (MAX-KIN-KOHI1-K     NOT =  ZERO     ) AND
                       (WK-1039-IKTSORTKBN  =  "1"          ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE    ) AND
                       (LNK-SYU-SRYYMD      <  SYU-SRYYMD   ))
                   OR ((LNK-SYU-KOH2HKNNUM  = "972" OR "974") AND
                       (WK-2010-CYOKEIKBN-G(1) NOT = SPACE  ) AND
                       (MAX-KIN-KOHI1-K     NOT =  ZERO     ) AND
                       (WK-1039-IKTSORTKBN  =  "1"          ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"      ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE    ) AND
                       (LNK-SYU-SRYYMD      =  SYU-SRYYMD   ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO     ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM  ))
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                         MOVE     ZERO   TO   SYU-KOH1HKNFTNMONEY
                                              SYU-KOH1COMPFTN
                                              SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                         MOVE     ZERO   TO   SYU-KOH2HKNFTNMONEY
                                              SYU-KOH2COMPFTN
                                              SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM
                         MOVE     ZERO   TO   SYU-KOH3HKNFTNMONEY
                                              SYU-KOH3COMPFTN
                                              SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM
                         MOVE     ZERO   TO   SYU-KOH4HKNFTNMONEY
                                              SYU-KOH4COMPFTN
                                              SYU-KOH4COMPFTN-ENTANI
                      END-IF
                   END-IF
      *
                   IF  (SYU-NYUGAIKBN                   =  "2"  )
                   AND (WK-2010-GNBKEIKBN-K-G(2)        =  "1"  )
                   AND (LNK-S01-KOUREI-ZAITAKU-KBN      =  "1"  )
                   AND (COMB-KOH1HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH2HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH3HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH4HKNNUM   NOT =  "972" AND "974")
                   AND (FLG-KEISAN-TAI2                 =   1   )
                   AND ((MAX-KIN-KOHI2-D  NOT =  ZERO          ) OR
                        (MAX-KIN-KOHI2-K  NOT =  ZERO          ))
                       MOVE      2    TO   IDX19
                       PERFORM   2202D-GNBKEIKBN-K-HENSYU-SEC
                   END-IF
      *
                   IF ((WK-1001-PREFNUM          =  44      ) AND
                       (LNK-SYU-KOH2HKNNUM  = "183" OR "283") AND
                       (LNK-SYU-SRYYMD(1:6)     >= "200610" ) AND
                       (LNK-SYU-SRYYMD(1:6)     <  "201010" ))
                   OR ( WK-2010-NINNASIKBN(2)  NOT = SPACE   )
                   OR ( WK-2010-NINJYOKBN(2)   NOT = SPACE   )
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                                               OR  SYU-KOH2HKNNUM
                                               OR  SYU-KOH3HKNNUM
                                               OR  SYU-KOH4HKNNUM
                         ADD   SYU-JYO-HKNFTNMONEY
                                        TO  WK-OITA-HKNFTNMONEY
                         ADD   SYU-JYO-COMPFTN
                                        TO  WK-OITA-CYOFTN
                      END-IF
                   END-IF
      *
                   IF   (SYU-NYUGAIKBN        =  "2"            )
                   AND  (LNK-SYU-SRYYMD(7:2)  =  SYU-SRYYMD(7:2))
                       EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                                    TO  FTN-KOHI2-D
                                 IF  SYU-KOH1YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI2-D2 =              
                                            FTN-KOHI2-D2     +          
                                            SYU-KOH1COMPFTN  +          
                                            SYU-KOH1COMPYKZFTN          
                                   COMPUTE  FTN-KOHI2-D3 =              
                                            FTN-KOHI2-D3            +   
                                            SYU-KOH1COMPFTN-ENTANI  +   
                                            SYU-KOH1COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH1COMPFTN                
                                                    TO  FTN-KOHI2-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI2-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH1HKNFTNMONEY
                                                      TO  FTN-KOHI2-D-K
                                   IF  SYU-KOH1YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI2-D2-K =            
                                              FTN-KOHI2-D2-K   +          
                                              SYU-KOH1COMPFTN  +          
                                              SYU-KOH1COMPYKZFTN          
                                     COMPUTE  FTN-KOHI2-D3-K =          
                                              FTN-KOHI2-D3-K          +   
                                              SYU-KOH1COMPFTN-ENTANI  +   
                                              SYU-KOH1COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH1COMPFTN                
                                                      TO  FTN-KOHI2-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI2-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                                 ADD   SYU-KOH2HKNFTNMONEY
                                                    TO  FTN-KOHI2-D
                                 IF  SYU-KOH2YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI2-D2 =              
                                            FTN-KOHI2-D2     +          
                                            SYU-KOH2COMPFTN  +          
                                            SYU-KOH2COMPYKZFTN          
                                   COMPUTE  FTN-KOHI2-D3 =              
                                            FTN-KOHI2-D3            +   
                                            SYU-KOH2COMPFTN-ENTANI  +   
                                            SYU-KOH2COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH2COMPFTN                
                                                    TO  FTN-KOHI2-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI2-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH2HKNFTNMONEY
                                                      TO  FTN-KOHI2-D-K
                                   IF  SYU-KOH2YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI2-D2-K =            
                                              FTN-KOHI2-D2-K   +          
                                              SYU-KOH2COMPFTN  +          
                                              SYU-KOH2COMPYKZFTN          
                                     COMPUTE  FTN-KOHI2-D3-K =          
                                              FTN-KOHI2-D3-K          +   
                                              SYU-KOH2COMPFTN-ENTANI  +   
                                              SYU-KOH2COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH2COMPFTN                
                                                      TO  FTN-KOHI2-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI2-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                                 ADD   SYU-KOH3HKNFTNMONEY
                                                    TO  FTN-KOHI2-D
                                 IF  SYU-KOH3YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI2-D2 =              
                                            FTN-KOHI2-D2     +          
                                            SYU-KOH3COMPFTN  +          
                                            SYU-KOH3COMPYKZFTN          
                                   COMPUTE  FTN-KOHI2-D3 =              
                                            FTN-KOHI2-D3            +   
                                            SYU-KOH3COMPFTN-ENTANI  +   
                                            SYU-KOH3COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH3COMPFTN                
                                                    TO  FTN-KOHI2-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI2-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH3HKNFTNMONEY
                                                      TO  FTN-KOHI2-D-K
                                   IF  SYU-KOH3YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI2-D2-K =            
                                              FTN-KOHI2-D2-K   +          
                                              SYU-KOH3COMPFTN  +          
                                              SYU-KOH3COMPYKZFTN          
                                     COMPUTE  FTN-KOHI2-D3-K =          
                                              FTN-KOHI2-D3-K          +   
                                              SYU-KOH3COMPFTN-ENTANI  +   
                                              SYU-KOH3COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH3COMPFTN                
                                                      TO  FTN-KOHI2-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI2-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                                 ADD   SYU-KOH4HKNFTNMONEY
                                                    TO  FTN-KOHI2-D
                                 IF  SYU-KOH4YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI2-D2 =              
                                            FTN-KOHI2-D2     +          
                                            SYU-KOH4COMPFTN  +          
                                            SYU-KOH4COMPYKZFTN          
                                   COMPUTE  FTN-KOHI2-D3 =              
                                            FTN-KOHI2-D3            +   
                                            SYU-KOH4COMPFTN-ENTANI  +   
                                            SYU-KOH4COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH4COMPFTN                
                                                    TO  FTN-KOHI2-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI2-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH4HKNFTNMONEY
                                                      TO  FTN-KOHI2-D-K
                                   IF  SYU-KOH4YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI2-D2-K =            
                                              FTN-KOHI2-D2-K   +          
                                              SYU-KOH4COMPFTN  +          
                                              SYU-KOH4COMPYKZFTN          
                                     COMPUTE  FTN-KOHI2-D3-K =          
                                              FTN-KOHI2-D3-K          +   
                                              SYU-KOH4COMPFTN-ENTANI  +   
                                              SYU-KOH4COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH4COMPFTN                
                                                      TO  FTN-KOHI2-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI2-D3-K    
                                   END-IF                                
                                 END-IF
                       END-EVALUATE
                   END-IF
      *
                   IF   SYU-NYUGAIKBN        =  "1"
                       EVALUATE  TRUE
                         WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 1)
                                          TO  FTN-KOHI2-D
                           ADD   SDAY-COMPFTN(IDX2 1)
                                          TO  FTN-KOHI2-D2
                           ADD   SDAY-COMPFTNWK(IDX2 1)
                                          TO  FTN-KOHI2-D3
                         WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 2)
                                          TO  FTN-KOHI2-D
                           ADD   SDAY-COMPFTN(IDX2 2)
                                          TO  FTN-KOHI2-D2
                           ADD   SDAY-COMPFTNWK(IDX2 2)
                                          TO  FTN-KOHI2-D3
                         WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 3)
                                          TO  FTN-KOHI2-D
                           ADD   SDAY-COMPFTN(IDX2 3)
                                          TO  FTN-KOHI2-D2
                           ADD   SDAY-COMPFTNWK(IDX2 3)
                                          TO  FTN-KOHI2-D3
                         WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 4)
                                          TO  FTN-KOHI2-D
                           ADD   SDAY-COMPFTN(IDX2 4)
                                          TO  FTN-KOHI2-D2
                           ADD   SDAY-COMPFTNWK(IDX2 4)
                                          TO  FTN-KOHI2-D3
                       END-EVALUATE
                   END-IF
      *
                   EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             IF  SYU-KOH1YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI2-M2 =                  
                                        FTN-KOHI2-M2     +              
                                        SYU-KOH1COMPFTN  +              
                                        SYU-KOH1COMPYKZFTN              
                               COMPUTE  FTN-KOHI2-M3 =                  
                                        FTN-KOHI2-M3            +       
                                        SYU-KOH1COMPFTN-ENTANI  +       
                                        SYU-KOH1COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH1COMPFTN                    
                                                TO  FTN-KOHI2-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3        
                             END-IF                                     
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(2)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                             "024" OR "079"        ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "201501") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                             "054"                 ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-KOH2HKNNUM(1:1)
                                                 >= "1" AND <=  "8") AND
                                 (WK-KOHJGNGET-TAISYOKBN(2)
                                                           =  2    ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                                ADD   SYU-KOH1HKNFTNMONEY
                                                   TO  FTN-KOHI2-M-JI
                                ADD   SYU-KOH1COMPFTN
                                                   TO  FTN-KOHI2-M2-JI
                                COMPUTE WK-ENTANI =
                                          SYU-KOH1COMPFTN-ENTANI + 0.9
                                ADD   WK-ENTANI    TO  FTN-KOHI2-M3-JI
                             END-IF
                             IF  (LNK-SYU-KOH2HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(2)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH1SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI2-M
                                                    FTN-KOHI2-M2
                                                    FTN-KOHI2-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH2HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH2HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH1HKNFTNMONEY
                                        TO  FTN-KOHI2-M-TOKU75
                               ADD   SYU-KOH1COMPFTN
                                        TO  FTN-KOHI2-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI2-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             IF  SYU-KOH2YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI2-M2 =                  
                                        FTN-KOHI2-M2     +              
                                        SYU-KOH2COMPFTN  +              
                                        SYU-KOH2COMPYKZFTN              
                               COMPUTE  FTN-KOHI2-M3 =                  
                                        FTN-KOHI2-M3            +       
                                        SYU-KOH2COMPFTN-ENTANI  +       
                                        SYU-KOH2COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH2COMPFTN                    
                                                TO  FTN-KOHI2-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3        
                             END-IF                                     
                             IF  (FLG-RUIKEIYO =  1              )
                             AND (LNK-SYU-KOH1HKNNUM
                                               =  SYU-KOH1HKNNUM )
                             AND (COMB-KOH1ID  =  WRK-COMB-KOH1ID)
                             AND (WK-HKNJANUM3-TBL
                                               =  WK-HKNJANUM-TBL)
                               IF  (COMB-KOH2-GAIJGNKBN = SPACE)
                               AND (SYU-KOH2HKNFTNMONEY = ZERO )
                                 IF  (WK-1001-PREFNUM    =  43  )
                                 AND (LNK-SYU-KOH2HKNNUM = "143"
                                                        OR "342")
                                 AND (LNK-SYU-SRYYMD(1:6)
                                                    <=  "200911")
                                   MOVE  SYU-KOH2COMPFTN  TO
                                           SYU-KOH2HKNFTNMONEY
                                 ELSE
                                   COMPUTE SYU-KOH2HKNFTNMONEY =
                                           SYU-KOH2COMPFTN     +  5
                                   COMPUTE SYU-KOH2HKNFTNMONEY =
                                           SYU-KOH2HKNFTNMONEY / 10
                                   COMPUTE SYU-KOH2HKNFTNMONEY =
                                           SYU-KOH2HKNFTNMONEY * 10
                                 END-IF
                               END-IF
                               ADD SYU-KOH2HKNFTNMONEY
                                                TO  WK-RUI-FTN2-M
                               ADD SYU-KOH2COMPFTN
                                                TO  WK-RUI-FTN2-M2
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD WK-ENTANI    TO  WK-RUI-FTN2-M3
                               ADD SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-RUI-FTN2-M3-XXX
                               COMPUTE  WK-RUI-ZENGAKU =
                                        WK-RUI-ZENGAKU +
                                       (SYU-HKNTEN (17) * 10)
                             END-IF
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(2)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                             "024" OR "079"        ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "201501") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                             "054"                 ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                             OR ((LNK-SYU-KOH2HKNNUM(1:1)
                                                 >= "1" AND <=  "8") AND
                                 (WK-KOHJGNGET-TAISYOKBN(2)
                                                           =  2    ) AND
                                 (SYU-NYUGAIKBN            = "2"   ))
                                ADD   SYU-KOH2HKNFTNMONEY
                                                   TO  FTN-KOHI2-M-JI
                                ADD   SYU-KOH2COMPFTN
                                                   TO  FTN-KOHI2-M2-JI
                                COMPUTE WK-ENTANI =
                                          SYU-KOH2COMPFTN-ENTANI + 0.9
                                ADD   WK-ENTANI    TO  FTN-KOHI2-M3-JI
                             END-IF
                             IF  (LNK-SYU-KOH2HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(2)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH2SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI2-M
                                                    FTN-KOHI2-M2
                                                    FTN-KOHI2-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH2HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH2HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH2HKNFTNMONEY
                                        TO  FTN-KOHI2-M-TOKU75
                               ADD   SYU-KOH2COMPFTN
                                        TO  FTN-KOHI2-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI2-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             IF  SYU-KOH3YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI2-M2 =                  
                                        FTN-KOHI2-M2     +              
                                        SYU-KOH3COMPFTN  +              
                                        SYU-KOH3COMPYKZFTN              
                               COMPUTE  FTN-KOHI2-M3 =                  
                                        FTN-KOHI2-M3            +       
                                        SYU-KOH3COMPFTN-ENTANI  +       
                                        SYU-KOH3COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH3COMPFTN                    
                                                TO  FTN-KOHI2-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH2HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(2)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH3SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI2-M
                                                    FTN-KOHI2-M2
                                                    FTN-KOHI2-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH2HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH2HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH3HKNFTNMONEY
                                        TO  FTN-KOHI2-M-TOKU75
                               ADD   SYU-KOH3COMPFTN
                                        TO  FTN-KOHI2-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI2-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             IF  SYU-KOH4YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI2-M2 =                  
                                        FTN-KOHI2-M2     +              
                                        SYU-KOH4COMPFTN  +              
                                        SYU-KOH4COMPYKZFTN              
                               COMPUTE  FTN-KOHI2-M3 =                  
                                        FTN-KOHI2-M3            +       
                                        SYU-KOH4COMPFTN-ENTANI  +       
                                        SYU-KOH4COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH4COMPFTN                    
                                                TO  FTN-KOHI2-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH2HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(2)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH4SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI2-M
                                                    FTN-KOHI2-M2
                                                    FTN-KOHI2-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH2HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH2HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH4HKNFTNMONEY
                                        TO  FTN-KOHI2-M-TOKU75
                               ADD   SYU-KOH4COMPFTN
                                        TO  FTN-KOHI2-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI2-M3-TOKU75
                             END-IF
                   END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *    公費３カウント
           IF ((COMB-KOH3HKNNUM           NOT =  SPACE) AND
               (COMB-KOH3-GAIJGNKBN           =  "1"  ))
           OR ( WK-2010-IRYOKEIKBN-G(3)  =  "3" OR "4" )
             IF  ( SYU-NYUGAIKBN              =   "2"   )
             OR  ((SYU-NYUGAIKBN              =   "1"  ) AND
                  (FLG-NYUGAI                 =    3   ))
             OR  ((SYU-NYUGAIKBN              =   "1"  ) AND
                  (FLG-NYUGAI2                =    3   ))
               IF   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH4ID))
      *
                  IF   SYU-NYUGAIKBN  =   "2"
                   MOVE   SYU-SRYYMD(7:2)     TO    IDX2X
                   MOVE   3                   TO    IDX3
                   IF   (MAX-KIN-KOHI3-D    NOT =  ZERO)
                   OR   (MAX-KIN-KOHI3-M    NOT =  ZERO)
                       MOVE  MAX-KIN-KOHI3-D  TO    WK-MAX-KIN-D
                       PERFORM   22021-KAISU-COUNT-SEC
                   ELSE
                       PERFORM   22022-KAISU-COUNT2-SEC
                   END-IF
                  END-IF
      *
                  IF   SYU-NYUGAIKBN  =   "1"
                   MOVE   LNK-SYU-SRYYMD(7:2) TO   IDX2X
                   MOVE   3                   TO   IDX3
                   IF  MAX-KIN-KOHI3-D    NOT =  ZERO
                       PERFORM   2202A-KAISU-COUNT3-SEC
                   END-IF
                  END-IF
      *
                   IF   WK-2010-IRYOKEIKBN-G(3)  NOT = SPACE
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(3)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(3)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(3)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(3)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(3)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(3)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(3)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(3)
                         END-EVALUATE
                      END-IF
                      IF   WK-2010-IRYOKEIKBN-G(3) = "2"
                         COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                                   WK-IRYOKEIKBN-HANTEITEN  +
                                   SYU-TOTAL-HKNTEN
                      END-IF
                   END-IF
      *
                   IF   WK-2010-KINJYOKBN-G(3)  = "1"
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH1COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH1COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH2COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH2COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH3COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH3COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH4COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH4COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                        END-IF
                      END-IF
                   END-IF
      *
                   IF   WK-2010-SYOKEI2KBN-G(3) = "1"
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH1HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH1COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH2HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH2COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH3HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH3COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH4HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH4COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH4COMPFTN-ENTANI
                      END-IF
                   END-IF
      *
                   IF ((LNK-SYU-KOH3HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-D     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-D     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "0"  OR SPACE  ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"        ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO       ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM    ))
                   OR ((LNK-SYU-KOH3HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-D     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-D     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "1"            ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE      ) AND
                       (LNK-SYU-SRYYMD      <  SYU-SRYYMD     ))
                   OR ((LNK-SYU-KOH3HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-D     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-D     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "1"            ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"        ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE      ) AND
                       (LNK-SYU-SRYYMD      =  SYU-SRYYMD     ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO       ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM    ))
                   OR ((LNK-SYU-KOH3HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-K     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-K     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "0"  OR SPACE  ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"        ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO       ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM    ))
                   OR ((LNK-SYU-KOH3HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-K     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-K     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "1"            ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE      ) AND
                       (LNK-SYU-SRYYMD      <  SYU-SRYYMD     ))
                   OR ((LNK-SYU-KOH3HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-K     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-K     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "1"            ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"        ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE      ) AND
                       (LNK-SYU-SRYYMD      =  SYU-SRYYMD     ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO       ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM    ))
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                         MOVE     ZERO   TO   SYU-KOH1HKNFTNMONEY
                                              SYU-KOH1COMPFTN
                                              SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM
                         MOVE     ZERO   TO   SYU-KOH2HKNFTNMONEY
                                              SYU-KOH2COMPFTN
                                              SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM
                         MOVE     ZERO   TO   SYU-KOH3HKNFTNMONEY
                                              SYU-KOH3COMPFTN
                                              SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM
                         MOVE     ZERO   TO   SYU-KOH4HKNFTNMONEY
                                              SYU-KOH4COMPFTN
                                              SYU-KOH4COMPFTN-ENTANI
                      END-IF
                   END-IF
      *
                   IF  (SYU-NYUGAIKBN                   =  "2"  )
                   AND (WK-2010-GNBKEIKBN-K-G(3)        =  "1"  )
                   AND (LNK-S01-KOUREI-ZAITAKU-KBN      =  "1"  )
                   AND (COMB-KOH1HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH2HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH3HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH4HKNNUM   NOT =  "972" AND "974")
                   AND (FLG-KEISAN-TAI2                 =   1   )
                   AND ((MAX-KIN-KOHI3-D  NOT =  ZERO          ) OR
                        (MAX-KIN-KOHI3-K  NOT =  ZERO          ))
                       MOVE      3    TO   IDX19
                       PERFORM   2202D-GNBKEIKBN-K-HENSYU-SEC
                   END-IF
      *
                   IF ((WK-1001-PREFNUM          =  44      ) AND
                       (LNK-SYU-KOH3HKNNUM  = "183" OR "283") AND
                       (LNK-SYU-SRYYMD(1:6)     >= "200610" ) AND
                       (LNK-SYU-SRYYMD(1:6)     <  "201010" ))
                   OR ( WK-2010-NINNASIKBN(3)  NOT = SPACE   )
                   OR ( WK-2010-NINJYOKBN(3)   NOT = SPACE   )
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                                               OR  SYU-KOH2HKNNUM
                                               OR  SYU-KOH3HKNNUM
                                               OR  SYU-KOH4HKNNUM
                         ADD   SYU-JYO-HKNFTNMONEY
                                        TO  WK-OITA-HKNFTNMONEY
                         ADD   SYU-JYO-COMPFTN
                                        TO  WK-OITA-CYOFTN
                      END-IF
                   END-IF
      *
                   IF   (SYU-NYUGAIKBN        =  "2"            )
                   AND  (LNK-SYU-SRYYMD(7:2)  =  SYU-SRYYMD(7:2))
                       EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                                    TO  FTN-KOHI3-D
                                 IF  SYU-KOH1YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI3-D2 =              
                                            FTN-KOHI3-D2     +          
                                            SYU-KOH1COMPFTN  +          
                                            SYU-KOH1COMPYKZFTN          
                                   COMPUTE  FTN-KOHI3-D3 =              
                                            FTN-KOHI3-D3            +   
                                            SYU-KOH1COMPFTN-ENTANI  +   
                                            SYU-KOH1COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH1COMPFTN                
                                                    TO  FTN-KOHI3-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI3-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH1HKNFTNMONEY
                                                      TO  FTN-KOHI3-D-K
                                   IF  SYU-KOH1YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI3-D2-K =            
                                              FTN-KOHI3-D2-K   +          
                                              SYU-KOH1COMPFTN  +          
                                              SYU-KOH1COMPYKZFTN          
                                     COMPUTE  FTN-KOHI3-D3-K =          
                                              FTN-KOHI3-D3-K          +   
                                              SYU-KOH1COMPFTN-ENTANI  +   
                                              SYU-KOH1COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH1COMPFTN                
                                                      TO  FTN-KOHI3-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI3-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                                 ADD   SYU-KOH2HKNFTNMONEY
                                                    TO  FTN-KOHI3-D
                                 IF  SYU-KOH2YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI3-D2 =              
                                            FTN-KOHI3-D2     +          
                                            SYU-KOH2COMPFTN  +          
                                            SYU-KOH2COMPYKZFTN          
                                   COMPUTE  FTN-KOHI3-D3 =              
                                            FTN-KOHI3-D3            +   
                                            SYU-KOH2COMPFTN-ENTANI  +   
                                            SYU-KOH2COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH2COMPFTN                
                                                    TO  FTN-KOHI3-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI3-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH2HKNFTNMONEY
                                                      TO  FTN-KOHI3-D-K
                                   IF  SYU-KOH2YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI3-D2-K =            
                                              FTN-KOHI3-D2-K   +          
                                              SYU-KOH2COMPFTN  +          
                                              SYU-KOH2COMPYKZFTN          
                                     COMPUTE  FTN-KOHI3-D3-K =          
                                              FTN-KOHI3-D3-K          +   
                                              SYU-KOH2COMPFTN-ENTANI  +   
                                              SYU-KOH2COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH2COMPFTN                
                                                      TO  FTN-KOHI3-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI3-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                                 ADD   SYU-KOH3HKNFTNMONEY
                                                    TO  FTN-KOHI3-D
                                 IF  SYU-KOH3YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI3-D2 =              
                                            FTN-KOHI3-D2     +          
                                            SYU-KOH3COMPFTN  +          
                                            SYU-KOH3COMPYKZFTN          
                                   COMPUTE  FTN-KOHI3-D3 =              
                                            FTN-KOHI3-D3            +   
                                            SYU-KOH3COMPFTN-ENTANI  +   
                                            SYU-KOH3COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH3COMPFTN                
                                                    TO  FTN-KOHI3-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI3-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH3HKNFTNMONEY
                                                      TO  FTN-KOHI3-D-K
                                   IF  SYU-KOH3YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI3-D2-K =            
                                              FTN-KOHI3-D2-K   +          
                                              SYU-KOH3COMPFTN  +          
                                              SYU-KOH3COMPYKZFTN          
                                     COMPUTE  FTN-KOHI3-D3-K =          
                                              FTN-KOHI3-D3-K          +   
                                              SYU-KOH3COMPFTN-ENTANI  +   
                                              SYU-KOH3COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH3COMPFTN                
                                                      TO  FTN-KOHI3-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI3-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                                 ADD   SYU-KOH4HKNFTNMONEY
                                                    TO  FTN-KOHI3-D
                                 IF  SYU-KOH4YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI3-D2 =              
                                            FTN-KOHI3-D2     +          
                                            SYU-KOH4COMPFTN  +          
                                            SYU-KOH4COMPYKZFTN          
                                   COMPUTE  FTN-KOHI3-D3 =              
                                            FTN-KOHI3-D3            +   
                                            SYU-KOH4COMPFTN-ENTANI  +   
                                            SYU-KOH4COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH4COMPFTN                
                                                    TO  FTN-KOHI3-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI3-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH4HKNFTNMONEY
                                                      TO  FTN-KOHI3-D-K
                                   IF  SYU-KOH4YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI3-D2-K =            
                                              FTN-KOHI3-D2-K   +          
                                              SYU-KOH4COMPFTN  +          
                                              SYU-KOH4COMPYKZFTN          
                                     COMPUTE  FTN-KOHI3-D3-K =          
                                              FTN-KOHI3-D3-K          +   
                                              SYU-KOH4COMPFTN-ENTANI  +   
                                              SYU-KOH4COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH4COMPFTN                
                                                      TO  FTN-KOHI3-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI3-D3-K    
                                   END-IF                                
                                 END-IF
                       END-EVALUATE
                   END-IF
      *
                   IF   SYU-NYUGAIKBN        =  "1"
                       EVALUATE  TRUE
                         WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 1)
                                          TO  FTN-KOHI3-D
                           ADD   SDAY-COMPFTN(IDX2 1)
                                          TO  FTN-KOHI3-D2
                           ADD   SDAY-COMPFTNWK(IDX2 1)
                                          TO  FTN-KOHI3-D3
                         WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 2)
                                          TO  FTN-KOHI3-D
                           ADD   SDAY-COMPFTN(IDX2 2)
                                          TO  FTN-KOHI3-D2
                           ADD   SDAY-COMPFTNWK(IDX2 2)
                                          TO  FTN-KOHI3-D3
                         WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 3)
                                          TO  FTN-KOHI3-D
                           ADD   SDAY-COMPFTN(IDX2 3)
                                          TO  FTN-KOHI3-D2
                           ADD   SDAY-COMPFTNWK(IDX2 3)
                                          TO  FTN-KOHI3-D3
                         WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 4)
                                          TO  FTN-KOHI3-D
                           ADD   SDAY-COMPFTN(IDX2 4)
                                          TO  FTN-KOHI3-D2
                           ADD   SDAY-COMPFTNWK(IDX2 4)
                                          TO  FTN-KOHI3-D3
                       END-EVALUATE
                   END-IF
      *
                   EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             IF  SYU-KOH1YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI3-M2 =                  
                                        FTN-KOHI3-M2     +              
                                        SYU-KOH1COMPFTN  +              
                                        SYU-KOH1COMPYKZFTN              
                               COMPUTE  FTN-KOHI3-M3 =                  
                                        FTN-KOHI3-M3            +       
                                        SYU-KOH1COMPFTN-ENTANI  +       
                                        SYU-KOH1COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH1COMPFTN                    
                                                TO  FTN-KOHI3-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH3HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(3)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH1SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI3-M
                                                    FTN-KOHI3-M2
                                                    FTN-KOHI3-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH3HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH3HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH1HKNFTNMONEY
                                        TO  FTN-KOHI3-M-TOKU75
                               ADD   SYU-KOH1COMPFTN
                                        TO  FTN-KOHI3-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI3-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             IF  SYU-KOH2YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI3-M2 =                  
                                        FTN-KOHI3-M2     +              
                                        SYU-KOH2COMPFTN  +              
                                        SYU-KOH2COMPYKZFTN              
                               COMPUTE  FTN-KOHI3-M3 =                  
                                        FTN-KOHI3-M3            +       
                                        SYU-KOH2COMPFTN-ENTANI  +       
                                        SYU-KOH2COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH2COMPFTN                    
                                                TO  FTN-KOHI3-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH3HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(3)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH2SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI3-M
                                                    FTN-KOHI3-M2
                                                    FTN-KOHI3-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH3HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH3HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH2HKNFTNMONEY
                                        TO  FTN-KOHI3-M-TOKU75
                               ADD   SYU-KOH2COMPFTN
                                        TO  FTN-KOHI3-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI3-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             IF  SYU-KOH3YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI3-M2 =                  
                                        FTN-KOHI3-M2     +              
                                        SYU-KOH3COMPFTN  +              
                                        SYU-KOH3COMPYKZFTN              
                               COMPUTE  FTN-KOHI3-M3 =                  
                                        FTN-KOHI3-M3            +       
                                        SYU-KOH3COMPFTN-ENTANI  +       
                                        SYU-KOH3COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH3COMPFTN                    
                                                TO  FTN-KOHI3-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH3HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(3)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH3SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI3-M
                                                    FTN-KOHI3-M2
                                                    FTN-KOHI3-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH3HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH3HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH3HKNFTNMONEY
                                        TO  FTN-KOHI3-M-TOKU75
                               ADD   SYU-KOH3COMPFTN
                                        TO  FTN-KOHI3-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI3-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             IF  SYU-KOH4YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI3-M2 =                  
                                        FTN-KOHI3-M2     +              
                                        SYU-KOH4COMPFTN  +              
                                        SYU-KOH4COMPYKZFTN              
                               COMPUTE  FTN-KOHI3-M3 =                  
                                        FTN-KOHI3-M3            +       
                                        SYU-KOH4COMPFTN-ENTANI  +       
                                        SYU-KOH4COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH4COMPFTN                    
                                                TO  FTN-KOHI3-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH3HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(3)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH4SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI3-M
                                                    FTN-KOHI3-M2
                                                    FTN-KOHI3-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH3HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH3HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH4HKNFTNMONEY
                                        TO  FTN-KOHI3-M-TOKU75
                               ADD   SYU-KOH4COMPFTN
                                        TO  FTN-KOHI3-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI3-M3-TOKU75
                             END-IF
                   END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *    公費４カウント
           IF ((COMB-KOH4HKNNUM           NOT =  SPACE) AND
               (COMB-KOH4-GAIJGNKBN           =  "1"  ))
           OR ( WK-2010-IRYOKEIKBN-G(4)  =  "3" OR "4" )
             IF  ( SYU-NYUGAIKBN              =   "2"   )
             OR  ((SYU-NYUGAIKBN              =   "1"  ) AND
                  (FLG-NYUGAI                 =    4   ))
             OR  ((SYU-NYUGAIKBN              =   "1"  ) AND
                  (FLG-NYUGAI2                =    4   ))
               IF   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH4ID))
      *
                  IF   SYU-NYUGAIKBN  =   "2"
                   MOVE   SYU-SRYYMD(7:2)     TO    IDX2X
                   MOVE   4                   TO    IDX3
                   IF   (MAX-KIN-KOHI4-D    NOT =  ZERO)
                   OR   (MAX-KIN-KOHI4-M    NOT =  ZERO)
                       MOVE  MAX-KIN-KOHI4-D  TO    WK-MAX-KIN-D
                       PERFORM   22021-KAISU-COUNT-SEC
                   ELSE
                       PERFORM   22022-KAISU-COUNT2-SEC
                   END-IF
                  END-IF
      *
                  IF   SYU-NYUGAIKBN  =   "1"
                   MOVE   LNK-SYU-SRYYMD(7:2) TO   IDX2X
                   MOVE   4                   TO   IDX3
                   IF  MAX-KIN-KOHI4-D    NOT =  ZERO
                       PERFORM   2202A-KAISU-COUNT3-SEC
                   END-IF
                  END-IF
      *
                   IF   WK-2010-IRYOKEIKBN-G(4)  NOT = SPACE
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(4)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(4)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(4)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(4)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(4)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(4)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-G(4)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(4)
                         END-EVALUATE
                      END-IF
                      IF   WK-2010-IRYOKEIKBN-G(4) = "2"
                         COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                                   WK-IRYOKEIKBN-HANTEITEN  +
                                   SYU-TOTAL-HKNTEN
                      END-IF
                   END-IF
      *
                   IF   WK-2010-KINJYOKBN-G(4)  = "1"
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH1COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH1COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH2COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH2COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH3COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH3COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH4COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH4COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                        END-IF
                      END-IF
                   END-IF
      *
                   IF   WK-2010-SYOKEI2KBN-G(4) = "1"
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH1HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH1COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH2HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH2COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH3HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH3COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM
                        ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH4HKNFTNMONEY
                        ADD  SYU-JYO-COMPFTN     TO SYU-KOH4COMPFTN
                        ADD  SYU-JYO-COMPFTN-ENTANI
                                              TO SYU-KOH4COMPFTN-ENTANI
                      END-IF
                   END-IF
      *
                   IF ((LNK-SYU-KOH4HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-D     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-D     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(3) NOT = SPACE) AND
                         (MAX-KIN-KOHI3-D     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "0"  OR SPACE  ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"        ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO       ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM    ))
                   OR ((LNK-SYU-KOH4HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-D     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-D     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(3) NOT = SPACE) AND
                         (MAX-KIN-KOHI3-D     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "1"            ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE      ) AND
                       (LNK-SYU-SRYYMD      <  SYU-SRYYMD     ))
                   OR ((LNK-SYU-KOH4HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-D     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-D     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(3) NOT = SPACE) AND
                         (MAX-KIN-KOHI3-D     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "1"            ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"        ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE      ) AND
                       (LNK-SYU-SRYYMD      =  SYU-SRYYMD     ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO       ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM    ))
                   OR ((LNK-SYU-KOH4HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-K     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-K     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(3) NOT = SPACE) AND
                         (MAX-KIN-KOHI3-K     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "0"  OR SPACE  ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"        ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO       ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM    ))
                   OR ((LNK-SYU-KOH4HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-K     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-K     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(3) NOT = SPACE) AND
                         (MAX-KIN-KOHI3-K     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "1"            ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE      ) AND
                       (LNK-SYU-SRYYMD      <  SYU-SRYYMD     ))
                   OR ((LNK-SYU-KOH4HKNNUM  = "972" OR "974"  ) AND
                       (((WK-2010-CYOKEIKBN-G(1) NOT = SPACE) AND
                         (MAX-KIN-KOHI1-K     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(2) NOT = SPACE) AND
                         (MAX-KIN-KOHI2-K     NOT =  ZERO   )) OR
                        ((WK-2010-CYOKEIKBN-G(3) NOT = SPACE) AND
                         (MAX-KIN-KOHI3-K     NOT =  ZERO   ))) AND
                       (WK-1039-IKTSORTKBN  =  "1"            ) AND
                       (LNK-S01-SAIKEISAN-KBN   =  "1"        ) AND
                       (LNK-SYU-SRYYMD      NOT =  SPACE      ) AND
                       (LNK-SYU-SRYYMD      =  SYU-SRYYMD     ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO       ) AND
                       (LNK-SYU-DENPNUM     <  SYU-DENPNUM    ))
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                         MOVE     ZERO   TO   SYU-KOH1HKNFTNMONEY
                                              SYU-KOH1COMPFTN
                                              SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM
                         MOVE     ZERO   TO   SYU-KOH2HKNFTNMONEY
                                              SYU-KOH2COMPFTN
                                              SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM
                         MOVE     ZERO   TO   SYU-KOH3HKNFTNMONEY
                                              SYU-KOH3COMPFTN
                                              SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM
                         MOVE     ZERO   TO   SYU-KOH4HKNFTNMONEY
                                              SYU-KOH4COMPFTN
                                              SYU-KOH4COMPFTN-ENTANI
                      END-IF
                   END-IF
      *
                   IF  (SYU-NYUGAIKBN                   =  "2"  )
                   AND (WK-2010-GNBKEIKBN-K-G(4)        =  "1"  )
                   AND (LNK-S01-KOUREI-ZAITAKU-KBN      =  "1"  )
                   AND (COMB-KOH1HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH2HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH3HKNNUM   NOT =  "972" AND "974")
                   AND (COMB-KOH4HKNNUM   NOT =  "972" AND "974")
                   AND (FLG-KEISAN-TAI2                 =   1   )
                   AND ((MAX-KIN-KOHI4-D  NOT =  ZERO          ) OR
                        (MAX-KIN-KOHI4-K  NOT =  ZERO          ))
                       MOVE      4    TO   IDX19
                       PERFORM   2202D-GNBKEIKBN-K-HENSYU-SEC
                   END-IF
      *
                   IF ((WK-1001-PREFNUM          =  44      ) AND
                       (LNK-SYU-KOH4HKNNUM  = "183" OR "283") AND
                       (LNK-SYU-SRYYMD(1:6)     >= "200610" ) AND
                       (LNK-SYU-SRYYMD(1:6)     <  "201010" ))
                   OR ( WK-2010-NINNASIKBN(4)  NOT = SPACE   )
                   OR ( WK-2010-NINJYOKBN(4)   NOT = SPACE   )
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                                               OR  SYU-KOH2HKNNUM
                                               OR  SYU-KOH3HKNNUM
                                               OR  SYU-KOH4HKNNUM
                         ADD   SYU-JYO-HKNFTNMONEY
                                        TO  WK-OITA-HKNFTNMONEY
                         ADD   SYU-JYO-COMPFTN
                                        TO  WK-OITA-CYOFTN
                      END-IF
                   END-IF
      *
                   IF   (SYU-NYUGAIKBN        =  "2"            )
                   AND  (LNK-SYU-SRYYMD(7:2)  =  SYU-SRYYMD(7:2))
                       EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                                    TO  FTN-KOHI4-D
                                 IF  SYU-KOH1YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI4-D2 =              
                                            FTN-KOHI4-D2     +          
                                            SYU-KOH1COMPFTN  +          
                                            SYU-KOH1COMPYKZFTN          
                                   COMPUTE  FTN-KOHI4-D3 =              
                                            FTN-KOHI4-D3            +   
                                            SYU-KOH1COMPFTN-ENTANI  +   
                                            SYU-KOH1COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH1COMPFTN                
                                                    TO  FTN-KOHI4-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI4-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH1HKNFTNMONEY
                                                      TO  FTN-KOHI4-D-K
                                   IF  SYU-KOH1YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI4-D2-K =            
                                              FTN-KOHI4-D2-K   +          
                                              SYU-KOH1COMPFTN  +          
                                              SYU-KOH1COMPYKZFTN          
                                     COMPUTE  FTN-KOHI4-D3-K =          
                                              FTN-KOHI4-D3-K          +   
                                              SYU-KOH1COMPFTN-ENTANI  +   
                                              SYU-KOH1COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH1COMPFTN                
                                                      TO  FTN-KOHI4-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI4-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                                 ADD   SYU-KOH2HKNFTNMONEY
                                                    TO  FTN-KOHI4-D
                                 IF  SYU-KOH2YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI4-D2 =              
                                            FTN-KOHI4-D2     +          
                                            SYU-KOH2COMPFTN  +          
                                            SYU-KOH2COMPYKZFTN          
                                   COMPUTE  FTN-KOHI4-D3 =              
                                            FTN-KOHI4-D3            +   
                                            SYU-KOH2COMPFTN-ENTANI  +   
                                            SYU-KOH2COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH2COMPFTN                
                                                    TO  FTN-KOHI4-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI4-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH2HKNFTNMONEY
                                                      TO  FTN-KOHI4-D-K
                                   IF  SYU-KOH2YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI4-D2-K =            
                                              FTN-KOHI4-D2-K   +          
                                              SYU-KOH2COMPFTN  +          
                                              SYU-KOH2COMPYKZFTN          
                                     COMPUTE  FTN-KOHI4-D3-K =          
                                              FTN-KOHI4-D3-K          +   
                                              SYU-KOH2COMPFTN-ENTANI  +   
                                              SYU-KOH2COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH2COMPFTN                
                                                      TO  FTN-KOHI4-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI4-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                                 ADD   SYU-KOH3HKNFTNMONEY
                                                    TO  FTN-KOHI4-D
                                 IF  SYU-KOH3YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI4-D2 =              
                                            FTN-KOHI4-D2     +          
                                            SYU-KOH3COMPFTN  +          
                                            SYU-KOH3COMPYKZFTN          
                                   COMPUTE  FTN-KOHI4-D3 =              
                                            FTN-KOHI4-D3            +   
                                            SYU-KOH3COMPFTN-ENTANI  +   
                                            SYU-KOH3COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH3COMPFTN                
                                                    TO  FTN-KOHI4-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI4-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH3HKNFTNMONEY
                                                      TO  FTN-KOHI4-D-K
                                   IF  SYU-KOH3YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI4-D2-K =            
                                              FTN-KOHI4-D2-K   +          
                                              SYU-KOH3COMPFTN  +          
                                              SYU-KOH3COMPYKZFTN          
                                     COMPUTE  FTN-KOHI4-D3-K =          
                                              FTN-KOHI4-D3-K          +   
                                              SYU-KOH3COMPFTN-ENTANI  +   
                                              SYU-KOH3COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH3COMPFTN                
                                                      TO  FTN-KOHI4-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI4-D3-K    
                                   END-IF                                
                                 END-IF
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                                 ADD   SYU-KOH4HKNFTNMONEY
                                                    TO  FTN-KOHI4-D
                                 IF  SYU-KOH4YKZFTNKBN   =    "2"       
                                   COMPUTE  FTN-KOHI4-D2 =              
                                            FTN-KOHI4-D2     +          
                                            SYU-KOH4COMPFTN  +          
                                            SYU-KOH4COMPYKZFTN          
                                   COMPUTE  FTN-KOHI4-D3 =              
                                            FTN-KOHI4-D3            +   
                                            SYU-KOH4COMPFTN-ENTANI  +   
                                            SYU-KOH4COMPYKZFTN      +   
                                            0.9
                                 ELSE                                   
                                   ADD   SYU-KOH4COMPFTN                
                                                    TO  FTN-KOHI4-D2    
                                   COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                                   ADD   WK-ENTANI  TO  FTN-KOHI4-D3    
                                 END-IF                                 
                                 IF  ((LNK-SYU-GRP-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-GRP-DENPNUM
                                                 =  SYU-GRP-DENPNUM))
                                 OR  ((LNK-SYU-FUKU-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-FUKU-DENPNUM
                                                 =  SYU-FUKU-DENPNUM))
                                 OR  ((LNK-SYU-DOUJI-DENPNUM
                                                       NOT =  ZERO ) AND
                                      (LNK-SYU-DOUJI-DENPNUM
                                                 =  SYU-DOUJI-DENPNUM))
                                 OR  ( FLG-GRPNYURYOKU     =  1       )
                                   ADD   SYU-KOH4HKNFTNMONEY
                                                      TO  FTN-KOHI4-D-K
                                   IF  SYU-KOH4YKZFTNKBN   =    "2"       
                                     COMPUTE  FTN-KOHI4-D2-K =            
                                              FTN-KOHI4-D2-K   +          
                                              SYU-KOH4COMPFTN  +          
                                              SYU-KOH4COMPYKZFTN          
                                     COMPUTE  FTN-KOHI4-D3-K =            
                                              FTN-KOHI4-D3-K          +   
                                              SYU-KOH4COMPFTN-ENTANI  +   
                                              SYU-KOH4COMPYKZFTN      +   
                                              0.9
                                   ELSE                                   
                                     ADD   SYU-KOH4COMPFTN                
                                                      TO  FTN-KOHI4-D2-K    
                                     COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                                     ADD   WK-ENTANI  TO  FTN-KOHI4-D3-K    
                                   END-IF                                
                                 END-IF
                       END-EVALUATE
                   END-IF
      *
                   IF   SYU-NYUGAIKBN        =  "1"
                       EVALUATE  TRUE
                         WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 1)
                                          TO  FTN-KOHI4-D
                           ADD   SDAY-COMPFTN(IDX2 1)
                                          TO  FTN-KOHI4-D2
                           ADD   SDAY-COMPFTNWK(IDX2 1)
                                          TO  FTN-KOHI4-D3
                         WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 2)
                                          TO  FTN-KOHI4-D
                           ADD   SDAY-COMPFTN(IDX2 2)
                                          TO  FTN-KOHI4-D2
                           ADD   SDAY-COMPFTNWK(IDX2 2)
                                          TO  FTN-KOHI4-D3
                         WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 3)
                                          TO  FTN-KOHI4-D
                           ADD   SDAY-COMPFTN(IDX2 3)
                                          TO  FTN-KOHI4-D2
                           ADD   SDAY-COMPFTNWK(IDX2 3)
                                          TO  FTN-KOHI4-D3
                         WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                           MOVE  LNK-SYU-SRYYMD(7:2)  TO   IDX2X
                           ADD   SDAY-FTNMONEY(IDX2 4)
                                          TO  FTN-KOHI4-D
                           ADD   SDAY-COMPFTN(IDX2 4)
                                          TO  FTN-KOHI4-D2
                           ADD   SDAY-COMPFTNWK(IDX2 4)
                                          TO  FTN-KOHI4-D3
                       END-EVALUATE
                   END-IF
      *
                   EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             IF  SYU-KOH1YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI4-M2 =                  
                                        FTN-KOHI4-M2     +              
                                        SYU-KOH1COMPFTN  +              
                                        SYU-KOH1COMPYKZFTN              
                               COMPUTE  FTN-KOHI4-M3 =                  
                                        FTN-KOHI4-M3            +       
                                        SYU-KOH1COMPFTN-ENTANI  +       
                                        SYU-KOH1COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH1COMPFTN                    
                                                TO  FTN-KOHI4-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH4HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(4)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH1SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI4-M
                                                    FTN-KOHI4-M2
                                                    FTN-KOHI4-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH4HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH4HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH1HKNFTNMONEY
                                        TO  FTN-KOHI4-M-TOKU75
                               ADD   SYU-KOH1COMPFTN
                                        TO  FTN-KOHI4-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI4-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             IF  SYU-KOH2YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI4-M2 =                  
                                        FTN-KOHI4-M2     +              
                                        SYU-KOH2COMPFTN  +              
                                        SYU-KOH2COMPYKZFTN              
                               COMPUTE  FTN-KOHI4-M3 =                  
                                        FTN-KOHI4-M3            +       
                                        SYU-KOH2COMPFTN-ENTANI  +       
                                        SYU-KOH2COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH2COMPFTN                    
                                                TO  FTN-KOHI4-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH4HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(4)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH2SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI4-M
                                                    FTN-KOHI4-M2
                                                    FTN-KOHI4-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH4HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH4HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH2HKNFTNMONEY
                                        TO  FTN-KOHI4-M-TOKU75
                               ADD   SYU-KOH2COMPFTN
                                        TO  FTN-KOHI4-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI4-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             IF  SYU-KOH3YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI4-M2 =                  
                                        FTN-KOHI4-M2     +              
                                        SYU-KOH3COMPFTN  +              
                                        SYU-KOH3COMPYKZFTN              
                               COMPUTE  FTN-KOHI4-M3 =                  
                                        FTN-KOHI4-M3            +       
                                        SYU-KOH3COMPFTN-ENTANI  +       
                                        SYU-KOH3COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH3COMPFTN                    
                                                TO  FTN-KOHI4-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH4HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(4)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH3SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI4-M
                                                    FTN-KOHI4-M2
                                                    FTN-KOHI4-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH4HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH4HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH3HKNFTNMONEY
                                        TO  FTN-KOHI4-M-TOKU75
                               ADD   SYU-KOH3COMPFTN
                                        TO  FTN-KOHI4-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI4-M3-TOKU75
                             END-IF
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             IF  SYU-KOH4YKZFTNKBN   =    "2"           
                               COMPUTE  FTN-KOHI4-M2 =                  
                                        FTN-KOHI4-M2     +              
                                        SYU-KOH4COMPFTN  +              
                                        SYU-KOH4COMPYKZFTN              
                               COMPUTE  FTN-KOHI4-M3 =                  
                                        FTN-KOHI4-M3            +       
                                        SYU-KOH4COMPFTN-ENTANI  +       
                                        SYU-KOH4COMPYKZFTN      +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH4COMPFTN                    
                                                TO  FTN-KOHI4-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3        
                             END-IF                                     
                             IF  (LNK-SYU-KOH4HKNNUM(1:1)
                                                >=  "1" AND <=  "8")
                             AND (WK-KOHJGNGET-TAISYOKBN(4)  =   2 )
                             AND (SYU-NYUGAIKBN         =  "1"     )
                             AND (SYU-KOH4SKJ-FTNKBN    =  "2"     )
                                ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI4-M
                                                    FTN-KOHI4-M2
                                                    FTN-KOHI4-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH4HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH4HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH4HKNFTNMONEY
                                        TO  FTN-KOHI4-M-TOKU75
                               ADD   SYU-KOH4COMPFTN
                                        TO  FTN-KOHI4-M2-TOKU75
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI
                                        TO  FTN-KOHI4-M3-TOKU75
                             END-IF
                   END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *
       2202-SYUNOU-COUNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    回数カウント
      ******************************************************************
       22021-KAISU-COUNT-SEC           SECTION.
      *
           MOVE     ZERO     TO     FLG-NOCOUNT.
           IF   FLG-GRPNYURYOKU   =   ZERO
               PERFORM    22023-KAISU-SELECT-SEC
           END-IF.
      *
           IF    WK-2010-KAICNTKBN-G(IDX3)  =  "1"
             MOVE     ZERO     TO     FLG-NOCOUNT
             IF ((WK-1039-IKTSORTKBN     =  "0" OR SPACE) AND
                 (LNK-S01-SAIKEISAN-KBN  =  "1"         ) AND
                 (LNK-SYU-DENPNUM    NOT =  ZERO        ) AND
                 (LNK-SYU-DENPNUM    <  SYU-DENPNUM     ))
             OR ((WK-1039-IKTSORTKBN     =  "1"         ) AND
                 (LNK-SYU-SRYYMD     NOT =  SPACE       ) AND
                 (LNK-SYU-SRYYMD     <  SYU-SRYYMD      ))
             OR ((WK-1039-IKTSORTKBN     =  "1"         ) AND
                 (LNK-S01-SAIKEISAN-KBN  =  "1"         ) AND
                 (LNK-SYU-SRYYMD     NOT =  SPACE       ) AND
                 (LNK-SYU-SRYYMD     =  SYU-SRYYMD      ) AND
                 (LNK-SYU-DENPNUM    NOT =  ZERO        ) AND
                 (LNK-SYU-DENPNUM    <  SYU-DENPNUM     ))
                MOVE    1      TO     FLG-NOCOUNT
             END-IF
           END-IF.
      *
           IF     FLG-NOCOUNT          =  ZERO
           AND    FLG-GRPNYURYOKU      =  ZERO
      *
             IF    KOHI-TBL(IDX2 IDX3)  =  ZERO
             AND   SYU-HKNTEN(17)   NOT =  ZERO
      *
               IF   SYU-GRP-DENPNUM   NOT  =  ZERO
      *
                 IF  (WK-TAIHI-DENPNUMXX(IDX3) =  SYU-GRP-DENPNUM)
                 AND (WK-TAIHI-DENPNUMXX(IDX3)   NOT = ZERO      )
                     CONTINUE
                 ELSE
                     ADD   1    TO   KOHI-TBL(IDX2 IDX3)
                     IF   SYU-SRYYMD  NOT =  LNK-SYU-SRYYMD
                         ADD   1    TO   KOHI-TBL(32 IDX3)
                     END-IF
                     MOVE  SYU-GRP-DENPNUM
                                TO   WK-TAIHI-DENPNUMXX(IDX3)
                 END-IF
      *
               ELSE
      *          まとめ入力以外で、継続等で入力したものはカウントしない
                 IF  ((SYU-DOUJI-DENPNUM      NOT =  ZERO)  AND
                      (LNK-SYU-DOUJI-DENPNUM  NOT =  ZERO)  AND
                      (SYU-DOUJI-DENPNUM =
                                    LNK-SYU-DOUJI-DENPNUM))
                 OR  ((SYU-FUKU-DENPNUM       NOT =  ZERO)  AND
                      (LNK-SYU-FUKU-DENPNUM   NOT =  ZERO)  AND
                      (SYU-FUKU-DENPNUM  =
                                    LNK-SYU-FUKU-DENPNUM ))
                   CONTINUE
                 ELSE
                   IF  (SYU-DOUJI-DENPNUM      NOT =  ZERO)
                   OR  (SYU-FUKU-DENPNUM       NOT =  ZERO)
                         IF  (SYU-DOUJI-DENPNUM      NOT =  ZERO   )
                           IF  (WK-TAIHI-DENPNUMXX(IDX3)     =
                                                SYU-DOUJI-DENPNUM  )
                           AND (WK-TAIHI-DENPNUMXX(IDX3) NOT = ZERO)
                               CONTINUE
                           ELSE
                               ADD   1    TO  KOHI-TBL(IDX2 IDX3)
                               IF   SYU-SRYYMD  NOT =  LNK-SYU-SRYYMD
                                   ADD   1    TO   KOHI-TBL(32 IDX3)
                               END-IF
                               MOVE  SYU-DOUJI-DENPNUM
                                          TO  WK-TAIHI-DENPNUMXX(IDX3)
                           END-IF
                         END-IF
                         IF  (SYU-FUKU-DENPNUM       NOT =  ZERO   )
                           IF  (WK-TAIHI-DENPNUMXX(IDX3)     =
                                                SYU-FUKU-DENPNUM   )
                           AND (WK-TAIHI-DENPNUMXX(IDX3) NOT = ZERO)
                               CONTINUE
                           ELSE
                               ADD   1    TO  KOHI-TBL(IDX2 IDX3)
                               IF   SYU-SRYYMD  NOT =  LNK-SYU-SRYYMD
                                   ADD   1    TO   KOHI-TBL(32 IDX3)
                               END-IF
                               MOVE  SYU-FUKU-DENPNUM
                                          TO  WK-TAIHI-DENPNUMXX(IDX3)
                           END-IF
                         END-IF
                   ELSE
                               ADD   1    TO   KOHI-TBL(IDX2 IDX3)
                               IF   SYU-SRYYMD  NOT =  LNK-SYU-SRYYMD
                                   ADD   1    TO   KOHI-TBL(32 IDX3)
                               END-IF
                   END-IF
      *
                 END-IF
      *
               END-IF
      *
             ELSE
      *
               IF  SYU-HKNTEN(17)   NOT =  ZERO
      *
                 IF   SYU-GRP-DENPNUM   NOT  =  ZERO
      *
                   IF  (WK-TAIHI-DENPNUMXX(IDX3) =  SYU-GRP-DENPNUM)
                   AND (WK-TAIHI-DENPNUMXX(IDX3)   NOT = ZERO      )
                       CONTINUE
                   ELSE
                       ADD   1    TO   KOHI-TBL(IDX2 IDX3)
                       MOVE  SYU-GRP-DENPNUM
                                  TO   WK-TAIHI-DENPNUMXX(IDX3)
                   END-IF
      *
                 ELSE
      *            まとめ入力以外で、継続等で入力したものはカウントしない
                   IF  ((SYU-DOUJI-DENPNUM      NOT =  ZERO)  AND
                        (LNK-SYU-DOUJI-DENPNUM  NOT =  ZERO)  AND
                        (SYU-DOUJI-DENPNUM =
                                      LNK-SYU-DOUJI-DENPNUM))
                   OR  ((SYU-FUKU-DENPNUM       NOT =  ZERO)  AND
                        (LNK-SYU-FUKU-DENPNUM   NOT =  ZERO)  AND
                        (SYU-FUKU-DENPNUM  =
                                      LNK-SYU-FUKU-DENPNUM ))
                     CONTINUE
                   ELSE
                     IF  (SYU-DOUJI-DENPNUM      NOT =  ZERO)
                     OR  (SYU-FUKU-DENPNUM       NOT =  ZERO)
                           IF  (SYU-DOUJI-DENPNUM      NOT =  ZERO   )
                             IF  (WK-TAIHI-DENPNUMXX(IDX3)     =
                                                  SYU-DOUJI-DENPNUM  )
                             AND (WK-TAIHI-DENPNUMXX(IDX3) NOT = ZERO)
                                 CONTINUE
                             ELSE
                                 ADD   1    TO  KOHI-TBL(IDX2 IDX3)
                                 MOVE  SYU-DOUJI-DENPNUM
                                            TO  WK-TAIHI-DENPNUMXX(IDX3)
                             END-IF
                           END-IF
                           IF  (SYU-FUKU-DENPNUM       NOT =  ZERO   )
                             IF  (WK-TAIHI-DENPNUMXX(IDX3)     =
                                                  SYU-FUKU-DENPNUM   )
                             AND (WK-TAIHI-DENPNUMXX(IDX3) NOT = ZERO)
                                 CONTINUE
                             ELSE
                                 ADD   1    TO  KOHI-TBL(IDX2 IDX3)
                                 MOVE  SYU-FUKU-DENPNUM
                                            TO  WK-TAIHI-DENPNUMXX(IDX3)
                             END-IF
                           END-IF
                     ELSE
                                 ADD   1    TO   KOHI-TBL(IDX2 IDX3)
                     END-IF
      *
                   END-IF
      *
                 END-IF
      *
               END-IF
      *
             END-IF
      *
           END-IF.
      *
       22021-KAISU-COUNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    回数カウント判定２
      ******************************************************************
       22022-KAISU-COUNT2-SEC           SECTION.
      *
           MOVE     ZERO     TO     FLG-NOCOUNT.
           IF   FLG-GRPNYURYOKU   =   ZERO
               PERFORM    22023-KAISU-SELECT-SEC
           END-IF.
      *
           IF    WK-2010-KAICNTKBN-G(IDX3)  =  "1"
             MOVE     ZERO     TO     FLG-NOCOUNT
             IF ((WK-1039-IKTSORTKBN     =  "0" OR SPACE) AND
                 (LNK-S01-SAIKEISAN-KBN  =  "1"         ) AND
                 (LNK-SYU-DENPNUM    NOT =  ZERO        ) AND
                 (LNK-SYU-DENPNUM    <  SYU-DENPNUM     ))
             OR ((WK-1039-IKTSORTKBN     =  "1"         ) AND
                 (LNK-SYU-SRYYMD     NOT =  SPACE       ) AND
                 (LNK-SYU-SRYYMD     <  SYU-SRYYMD      ))
             OR ((WK-1039-IKTSORTKBN     =  "1"         ) AND
                 (LNK-S01-SAIKEISAN-KBN  =  "1"         ) AND
                 (LNK-SYU-SRYYMD     NOT =  SPACE       ) AND
                 (LNK-SYU-SRYYMD     =  SYU-SRYYMD      ) AND
                 (LNK-SYU-DENPNUM    NOT =  ZERO        ) AND
                 (LNK-SYU-DENPNUM    <  SYU-DENPNUM     ))
                MOVE    1      TO     FLG-NOCOUNT
             END-IF
           END-IF.
      *
           IF     FLG-NOCOUNT          =  ZERO
           AND    FLG-GRPNYURYOKU      =  ZERO
      *
             IF  SYU-HKNTEN(17)   NOT =  ZERO
      *
               IF   SYU-GRP-DENPNUM   NOT  =  ZERO
      *
                 IF  (WK-TAIHI-DENPNUMXX(IDX3) =  SYU-GRP-DENPNUM)
                 AND (WK-TAIHI-DENPNUMXX(IDX3)   NOT = ZERO      )
                     CONTINUE
                 ELSE
                     ADD   1    TO   KOHI-TBL(IDX2 IDX3)
                     ADD   1    TO   KOHI-TBL(32 IDX3)
                     MOVE  SYU-GRP-DENPNUM
                                TO   WK-TAIHI-DENPNUMXX(IDX3)
                 END-IF
      *
               ELSE
      *          まとめ入力以外で、継続等で入力したものはカウントしない
                 IF  ((SYU-DOUJI-DENPNUM      NOT =  ZERO)  AND
                      (LNK-SYU-DOUJI-DENPNUM  NOT =  ZERO)  AND
                      (SYU-DOUJI-DENPNUM =
                                    LNK-SYU-DOUJI-DENPNUM))
                 OR  ((SYU-FUKU-DENPNUM       NOT =  ZERO)  AND
                      (LNK-SYU-FUKU-DENPNUM   NOT =  ZERO)  AND
                      (SYU-FUKU-DENPNUM  =
                                    LNK-SYU-FUKU-DENPNUM ))
                   CONTINUE
                 ELSE
                   IF  (SYU-DOUJI-DENPNUM      NOT =  ZERO)
                   OR  (SYU-FUKU-DENPNUM       NOT =  ZERO)
                         IF  (SYU-DOUJI-DENPNUM      NOT =  ZERO   )
                           IF  (WK-TAIHI-DENPNUMXX(IDX3)     =
                                                SYU-DOUJI-DENPNUM  )
                           AND (WK-TAIHI-DENPNUMXX(IDX3) NOT = ZERO)
                               CONTINUE
                           ELSE
                               ADD   1    TO  KOHI-TBL(IDX2 IDX3)
                               ADD   1    TO  KOHI-TBL(32 IDX3)
                               MOVE  SYU-DOUJI-DENPNUM
                                          TO  WK-TAIHI-DENPNUMXX(IDX3)
                           END-IF
                         END-IF
                         IF  (SYU-FUKU-DENPNUM       NOT =  ZERO   )
                           IF  (WK-TAIHI-DENPNUMXX(IDX3)     =
                                                SYU-FUKU-DENPNUM   )
                           AND (WK-TAIHI-DENPNUMXX(IDX3) NOT = ZERO)
                               CONTINUE
                           ELSE
                               ADD   1    TO  KOHI-TBL(IDX2 IDX3)
                               ADD   1    TO  KOHI-TBL(32 IDX3)
                               MOVE  SYU-FUKU-DENPNUM
                                          TO  WK-TAIHI-DENPNUMXX(IDX3)
                           END-IF
                         END-IF
                   ELSE
                               ADD   1    TO   KOHI-TBL(IDX2 IDX3)
                               ADD   1    TO   KOHI-TBL(32 IDX3)
                   END-IF
      *
                 END-IF
      *
               END-IF
      *
             END-IF
      *
           END-IF.
      *
       22022-KAISU-COUNT2-EXT.
           EXIT.
      *
      ******************************************************************
      *    回数カウント判定
      ******************************************************************
       22023-KAISU-SELECT-SEC           SECTION.
      *
           EVALUATE  IDX3
               WHEN    1 
                  EVALUATE  TRUE
                       WHEN  LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM
                         IF  SYU-KOH1HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM
                         IF  SYU-KOH2HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM
                         IF  SYU-KOH3HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM
                         IF  SYU-KOH4HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                  END-EVALUATE
               WHEN    2 
                  EVALUATE  TRUE
                       WHEN  LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM
                         IF  SYU-KOH1HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM
                         IF  SYU-KOH2HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM
                         IF  SYU-KOH3HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM
                         IF  SYU-KOH4HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                  END-EVALUATE
               WHEN    3 
                  EVALUATE  TRUE
                       WHEN  LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM
                         IF  SYU-KOH1HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM
                         IF  SYU-KOH2HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM
                         IF  SYU-KOH3HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM
                         IF  SYU-KOH4HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                  END-EVALUATE
               WHEN    4 
                  EVALUATE  TRUE
                       WHEN  LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM
                         IF  SYU-KOH1HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM
                         IF  SYU-KOH2HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM
                         IF  SYU-KOH3HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                       WHEN  LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM
                         IF  SYU-KOH4HKNFTNMONEY = ZERO
                             MOVE   1    TO    FLG-NOCOUNT
                         END-IF
                  END-EVALUATE
           END-EVALUATE.
      *
       22023-KAISU-SELECT-EXT.
           EXIT.
      *
      ******************************************************************
      *    ７０歳未満現物給付の主保険分編集
      ******************************************************************
       22024-GEN70-SYU-HENSYU-SEC          SECTION.
      *
           IF  (COMB-KOH1HKNNUM  =  SPACE
                                 OR "970")
           AND (COMB-KOH2HKNNUM  =  SPACE)
           AND (COMB-KOH3HKNNUM  =  SPACE)
           AND (COMB-KOH4HKNNUM  =  SPACE)
             IF  (SYU-KOH1HKNNUM     =  SPACE
                                     OR "970")
             AND (SYU-KOH2HKNNUM     =  SPACE)
             AND (SYU-KOH3HKNNUM     =  SPACE)
             AND (SYU-KOH4HKNNUM     =  SPACE)
               IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                 COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
                 IF    FLG-IRYOHI70  =  1 OR 2 OR 7 OR 8
                   COMPUTE   WK-KOUREI-IRYOHI70  =
                             WK-KOUREI-IRYOHI70  +
                            (SYU-HKNTEN (17) * 10)
                 END-IF
                 COMPUTE     WK-GENBUTU-HKNKIN   =
                             WK-GENBUTU-HKNKIN   +
                            (SYU-HKNTEN (17) * 10)
                 MOVE   ZERO  TO  FLG-TAISYO
                 IF  (LNK-SYU-SRYYMD(1:6)         >=  "201204")
                 AND (LNK-SYU-TOTAL-HKNTEN     NOT =   ZERO   )
                 AND (SYU-TOTAL-HKNTEN         NOT =   ZERO   )
                   IF  (COMB-KOH1HKNNUM    NOT = "970")
                   AND (SYU-KOH1HKNNUM         = "970")
                   AND (SYU-SKJ-FTNGAKU(2) NOT =  ZERO)
                   AND (SYU-PTFTNRATE      NOT =  ZERO)
                     MOVE  4  TO  WK-SYUNOU-GENBUTU70-MSG
                   END-IF
                   IF  (SYU-KOH1HKNNUM       =  "970")
                   AND (SYU-SKJ-FTNGAKU(2)   =   ZERO)
                   AND (FLG-DAISAN-GENBUTU2  =   1   )
                   AND (SYU-PTFTNRATE    NOT =   ZERO)
                     MOVE  4  TO  WK-SYUNOU-GENBUTU70-MSG
                   END-IF
                 END-IF
                 IF    (LNK-S01-IKTCHECKFLG   = "1")
                 AND   (LNK-S01-IKTGENKEIFLG  = "2")
                   IF  (COMB-KOH1HKNNUM  =  SPACE)
                   AND (SYU-KOH1HKNNUM   =  "970")
                     COMPUTE  WK-FUTANWARI =
                              WK-SYUNOU-GENBUTU70-FTNRATE / 100
                     COMPUTE  WK-SYU-SYUCOMPFTN = SYU-TOTAL-HKNTEN
                                                * 10
                                                * WK-FUTANWARI
                     COMPUTE  WK-SYU-SYUCOMPFTN =
                              WK-SYU-SYUCOMPFTN +  5
                     COMPUTE  WK-SYU-SYUCOMPFTN =
                              WK-SYU-SYUCOMPFTN / 10
                     COMPUTE  WK-SYU-SYUCOMPFTN =
                              WK-SYU-SYUCOMPFTN * 10
                   END-IF
                 END-IF
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             ELSE
               MOVE     ZERO  TO  FLG-HANBETU2
               IF  (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
               AND (LNK-SYU-SRYYMD(1:6)  >=  "201204" )
                 PERFORM  220241-GEN70-KOH-CHECK-SEC
               END-IF
               IF ((WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL) AND
                   (LNK-SYU-SRYYMD(1:6)  <=  "201203" ))
               OR ((SYU-KOH1HKNNUM   = "972" OR "974" ) AND
                   (SYU-KOH2HKNNUM   = SPACE          ) AND
                   (SYU-KOH3HKNNUM   = SPACE          ) AND
                   (SYU-KOH4HKNNUM   = SPACE          ) AND
                   (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL) AND
                   (LNK-SYU-SRYYMD(1:6)  >=  "201204" ))
               OR ( FLG-HANBETU2     =    1  OR  9     )
                 MOVE  SYU-KOH-FTN    TO  WK-SYU-SYUCOMPFTN
                 COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                 IF    FLG-IRYOHI70  =  1 OR 2 OR 7 OR 8
                   COMPUTE   WK-KOUREI-IRYOHI70  =
                             WK-KOUREI-IRYOHI70  +
                            (SYU-HKNTEN (17) * 10)
                 END-IF
                 IF ((SYU-KOH1HKNNUM = "972" OR "974") AND
                     (SYU-KOH2HKNNUM = SPACE         ) AND
                     (SYU-KOH3HKNNUM = SPACE         ) AND
                     (SYU-KOH4HKNNUM = SPACE         ))
                 OR ( FLG-HANBETU2   =  9             )
                    COMPUTE     WK-GENBUTU-HKNKIN   =
                                WK-GENBUTU-HKNKIN   +
                               (SYU-HKNTEN (17) * 10)
                 END-IF
                 MOVE   ZERO  TO  FLG-TAISYO
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             END-IF
           ELSE
             IF  (SYU-KOH1HKNNUM     =  SPACE
                                     OR "970")
             AND (SYU-KOH2HKNNUM     =  SPACE)
             AND (SYU-KOH3HKNNUM     =  SPACE)
             AND (SYU-KOH4HKNNUM     =  SPACE)
               IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
      ***        COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
      ***        IF    FLG-IRYOHI70  =  3 OR  4 OR  5 OR  6
      ***                            OR 9 OR 10 OR 11 OR 12
      ***          COMPUTE   WK-KOUREI-IRYOHI70  =
      ***                    WK-KOUREI-IRYOHI70  +
      ***                   (SYU-HKNTEN (17) * 10)
      ***        END-IF
      ***        MOVE   ZERO  TO  FLG-TAISYO
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
                 IF  (LNK-SYU-SRYYMD(1:6)         >=  "201204")
                 AND (WK-SYUNOU-GENBUTU70-MSG  NOT =   4 AND 5)
                 AND (LNK-SYU-TOTAL-HKNTEN     NOT =   ZERO   )
                 AND (SYU-TOTAL-HKNTEN         NOT =   ZERO   )
                   IF  ((COMB-KOH1HKNNUM  = "972" OR "974") AND
                        (COMB-KOH2HKNNUM  = SPACE         ) AND
                        (COMB-KOH3HKNNUM  = SPACE         ) AND
                        (COMB-KOH4HKNNUM  = SPACE         ))
                   OR  ((LNK-SYU-SKJ-FTNGAKU(3) =  9      ) AND
                        (LNK-SYU-SRYYMD(1:6)  >=  "201204"))
                       MOVE   1    TO  WK-SYUNOU-GENBUTU70-MSG
                   ELSE
                     IF  WK-SYUNOU-GENBUTU70T-HANTEIFLG =  1
                       MOVE   2    TO  WK-SYUNOU-GENBUTU70-MSG
                     END-IF
                   END-IF
                 END-IF
                 IF  (LNK-SYU-SRYYMD(1:6)         >=  "201204")
                 AND (LNK-SYU-TOTAL-HKNTEN     NOT =   ZERO   )
                 AND (SYU-TOTAL-HKNTEN         NOT =   ZERO   )
                   IF  (COMB-KOH1HKNNUM    NOT = "970")
                   AND (SYU-KOH1HKNNUM         = "970")
                   AND (SYU-SKJ-FTNGAKU(2) NOT =  ZERO)
                   AND (SYU-PTFTNRATE      NOT =  ZERO)
                       MOVE   4    TO  WK-SYUNOU-GENBUTU70-MSG
                   END-IF
                   IF  (SYU-KOH1HKNNUM       =  "970")
                   AND (SYU-SKJ-FTNGAKU(2)   =   ZERO)
                   AND (FLG-DAISAN-GENBUTU2  =   1   )
                   AND (SYU-PTFTNRATE    NOT =   ZERO)
                       MOVE   4    TO  WK-SYUNOU-GENBUTU70-MSG
                   END-IF
                 END-IF
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             ELSE
               IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                 IF    FLG-MARUKO  =  ZERO
                    IF  (FLG-FTNRATE100          =   1            )
                    AND (LNK-SYU-KOH2HKNNUM  NOT = "972" AND "974")
                    AND (LNK-SYU-KOH3HKNNUM  NOT = "972" AND "974")
                    AND (LNK-SYU-KOH4HKNNUM  NOT = "972" AND "974")
                      IF ( LNK-SYU-SRYYMD(1:6)  <=  "201203"    )
                      OR ((LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM ) AND
                          (COMB-KOH1ID        = WRK-COMB-KOH1ID) AND
                          (LNK-SYU-SRYYMD(1:6)  >=  "201204"   ))
                      OR ((LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM ) AND
                          (COMB-KOH1ID        = WRK-COMB-KOH2ID) AND
                          (LNK-SYU-SRYYMD(1:6)  >=  "201204"   ))
                      OR ((LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM ) AND
                          (COMB-KOH1ID        = WRK-COMB-KOH3ID) AND
                          (LNK-SYU-SRYYMD(1:6)  >=  "201204"   ))
                      OR ((LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM ) AND
                          (COMB-KOH1ID        = WRK-COMB-KOH4ID) AND
                          (LNK-SYU-SRYYMD(1:6)  >=  "201204"   ))
                        IF   FLG-IRYOHI70     =  3 OR 4 OR 9 OR 10
                          COMPUTE  WK-KOUREI-IRYOHI70  =
                                   WK-KOUREI-IRYOHI70  +
                                  (SYU-HKNTEN (17) * 10)
                          MOVE   1   TO  FLG-SYUKEI
                        END-IF
                      END-IF
                      MOVE  SYU-KOH-FTN    TO  WK-SYU-SYUCOMPFTN
                      COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                      MOVE   ZERO  TO  FLG-TAISYO
                    ELSE
                      IF  (LNK-SYU-KOH1HKNNUM
                                           = "015" OR "016" OR "021")
                      AND (WK-JIRITU-CYUKANSOU(1)   =  1            )
                      AND (LNK-SYU-KOH2HKNNUM  NOT = "972" AND "974")
                      AND (LNK-SYU-KOH3HKNNUM  NOT = "972" AND "974")
                      AND (LNK-SYU-KOH4HKNNUM  NOT = "972" AND "974")
                      AND (SYU-NYNSHOKAISU          =  1            )
                      AND (SYU-KOH2HKNNUM      NOT = "972" AND "974")
                      AND (SYU-KOH3HKNNUM      NOT = "972" AND "974")
                      AND (SYU-KOH4HKNNUM      NOT = "972" AND "974")
                      AND (LNK-SYU-KOH1HKNNUM      =  SYU-KOH1HKNNUM)
                        IF   FLG-IRYOHI70  =  5 OR 6 OR 11 OR 12
                          COMPUTE  WK-KOUREI-IRYOHI70  =
                                   WK-KOUREI-IRYOHI70  +
                                  (SYU-HKNTEN (17) * 10)
                          MOVE   1   TO  FLG-SYUKEI
                        END-IF
                        IF   FLG-IRYOHI70K NOT = ZERO
                          COMPUTE  WK-KOUREI-IRYOHI70K =
                                   WK-KOUREI-IRYOHI70K +
                                  (SYU-HKNTEN (17) * 10)
                          IF   FLG-RUITAISYO  =  1
                             COMPUTE  WK-KOUREI-IRYOHI70K-TOKU75 =
                                      WK-KOUREI-IRYOHI70K-TOKU75 +
                                     (SYU-HKNTEN (17) * 10)
                          END-IF
                          MOVE   1   TO  FLG-SYUKEI3
                        END-IF
                      END-IF
                      IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                           (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                           (COMB-KOH4HKNNUM   =  "972" OR "974"))
                      AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                      AND ( SYU-KOH2HKNNUM    =   SPACE         )
                      AND ( SYU-KOH3HKNNUM    =   SPACE         )
                      AND ( SYU-KOH4HKNNUM    =   SPACE         )
                      AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                         MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                         MOVE    ZERO            TO  WK-ENTANI
                         MOVE    1               TO  FLG-TAISYO
                      ELSE
                         MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                         COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                         MOVE    ZERO            TO  FLG-TAISYO
                      END-IF
                      IF  ( FLG-TOKYO           =  1    )
                      AND ((COMB-KOH2HKNNUM     = "974") OR
                           (COMB-KOH3HKNNUM     = "974") OR
                           (COMB-KOH4HKNNUM     = "974"))
                      AND ( COMB-KOH1HKNNUM NOT =
                                         SYU-KOH1HKNNUM )
                         MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                         MOVE    ZERO            TO  WK-ENTANI
                         MOVE    1               TO  FLG-TAISYO
                      END-IF
                    END-IF
                 ELSE
                   IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                     MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                     MOVE   ZERO  TO  WK-ENTANI
                     MOVE   1     TO  FLG-TAISYO
                   ELSE
                     MOVE  SYU-KOH-FTN    TO  WK-SYU-SYUCOMPFTN
                     COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                     MOVE   ZERO  TO  FLG-TAISYO
                   END-IF
                 END-IF
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             END-IF
           END-IF
           ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
           ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
      *
           IF  (FLG-GENBUTU-CHECK-ERR        =   1)
           AND (WK-SYUNOU-GENBUTU70-MSG  NOT =   4)
             MOVE    5    TO    WK-SYUNOU-GENBUTU70-MSG
           END-IF
      *
           .
      *
       22024-GEN70-SYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ７０歳未満現物給付の公費併用分合算対象チェック
      ******************************************************************
       220241-GEN70-KOH-CHECK-SEC          SECTION.
      *
           PERFORM VARYING IDX13  FROM   1   BY   1
                    UNTIL (IDX13   >    50                       )
                     OR   (WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                                                          = SPACE)
             IF    SYU-HKNCOMBINUM =
                         WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
               IF    WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13) =  9
                   MOVE  9   TO  FLG-HANBETU2
               ELSE
                 IF  WK-SYUNOU-GENBUTU70-HANTEIFLG(IDX13) =  1
                   MOVE  1   TO  FLG-HANBETU2
                 END-IF
               END-IF
               MOVE    50    TO  IDX13
             END-IF
           END-PERFORM
      *
           .
      *
       220241-GEN70-KOH-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *    高齢者の主保険分編集
      ******************************************************************
       22025-KOUREI-SYU-HENSYU-SEC          SECTION.
      *
           IF     COMB-HKNNUM     = "039"
             IF   (SYU-SYUHKNNUM    =  "039"         )
             AND  (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
               IF  (SYU-KOH1HKNNUM     =  SPACE OR "970")
               AND (SYU-KOH2HKNNUM     =  SPACE         )
               AND (SYU-KOH3HKNNUM     =  SPACE         )
               AND (SYU-KOH4HKNNUM     =  SPACE         )
                   COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
                   MOVE    ZERO            TO  FLG-TAISYO
                   IF  (LNK-SYU-SRYYMD(1:6)         >=  "201204")
                   AND (WK-SYUNOU-GENBUTU70-MSG  NOT =   4 AND 6)
                   AND (COMB-HKNNUM              NOT =   SPACE  )
                   AND (COMB-KOH1HKNNUM          NOT =   SPACE  )
                   AND (COMB-KOH1HKNNUM          NOT =   "970"  )
                   AND (LNK-SYU-TOTAL-HKNTEN     NOT =   ZERO   )
                   AND (SYU-TOTAL-HKNTEN         NOT =   ZERO   )
                     MOVE    3    TO  WK-SYUNOU-GENBUTU70-MSG
                   END-IF
                   IF  (LNK-SYU-SRYYMD(1:6)         >=  "201204")
                   AND (LNK-SYU-TOTAL-HKNTEN     NOT =   ZERO   )
                   AND (SYU-TOTAL-HKNTEN         NOT =   ZERO   )
                     IF  (COMB-KOH1HKNNUM    NOT = "970")
                     AND (SYU-KOH1HKNNUM         = "970")
                     AND (SYU-SKJ-FTNGAKU(2) NOT =  ZERO)
                     AND (SYU-PTFTNRATE      NOT =  ZERO)
                       MOVE  4    TO  WK-SYUNOU-GENBUTU70-MSG
                     END-IF
                     IF  (SYU-KOH1HKNNUM       =  "970")
                     AND (SYU-SKJ-FTNGAKU(2)   =   ZERO)
                     AND (FLG-DAISAN-GENBUTU2  =   1   )
                     AND (SYU-PTFTNRATE    NOT =   ZERO)
                       MOVE  4    TO  WK-SYUNOU-GENBUTU70-MSG
                     END-IF
                   END-IF
                   IF    (LNK-S01-IKTCHECKFLG   = "1")
                   AND   (LNK-S01-IKTGENKEIFLG  = "2")
                     IF  (COMB-KOH1HKNNUM  =  SPACE)
                     AND (SYU-KOH1HKNNUM   =  "970")
                       COMPUTE  WK-FUTANWARI =
                                WK-SYUNOU-GENBUTU70-FTNRATE / 100
                       COMPUTE  WK-SYU-SYUCOMPFTN = SYU-TOTAL-HKNTEN
                                                  * 10
                                                  * WK-FUTANWARI
                       COMPUTE  WK-SYU-SYUCOMPFTN =
                                WK-SYU-SYUCOMPFTN +  5
                       COMPUTE  WK-SYU-SYUCOMPFTN =
                                WK-SYU-SYUCOMPFTN / 10
                       COMPUTE  WK-SYU-SYUCOMPFTN =
                                WK-SYU-SYUCOMPFTN * 10
                     END-IF
                   END-IF
                   IF  (COMB-KOH1HKNNUM  = "972" OR "974")
                   AND (COMB-KOH2HKNNUM  = SPACE         )
                   AND (COMB-KOH3HKNNUM  = SPACE         )
                   AND (COMB-KOH4HKNNUM  = SPACE         )
                      MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                      MOVE    ZERO            TO  WK-ENTANI
                      MOVE    1               TO  FLG-TAISYO
                   END-IF
               ELSE
                   IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                        (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                        (COMB-KOH4HKNNUM   =  "972" OR "974"))
                   AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                   AND ( SYU-KOH2HKNNUM    =   SPACE         )
                   AND ( SYU-KOH3HKNNUM    =   SPACE         )
                   AND ( SYU-KOH4HKNNUM    =   SPACE         )
                   AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                      MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                      MOVE    ZERO            TO  WK-ENTANI
                      MOVE    1               TO  FLG-TAISYO
                   ELSE
                      MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                      COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI  + 0.9
                      MOVE    ZERO            TO  FLG-TAISYO
                   END-IF
               END-IF
               ADD   WK-SYU-SYUCOMPFTN      TO  FTN-SYU-M
               ADD   WK-ENTANI              TO  FTN-SYU-M-ENTANI
               IF  (COMB-KOH1HKNNUM    =  SPACE OR "970")
               AND (COMB-KOH2HKNNUM    =  SPACE         )
               AND (COMB-KOH3HKNNUM    =  SPACE         )
               AND (COMB-KOH4HKNNUM    =  SPACE         )
               AND (SYU-KOH1HKNNUM     =  SPACE OR "970")
               AND (SYU-KOH2HKNNUM     =  SPACE         )
               AND (SYU-KOH3HKNNUM     =  SPACE         )
               AND (SYU-KOH4HKNNUM     =  SPACE         )
               AND (FLG-IRYOHIKG   NOT =  ZERO          )
                 COMPUTE   WK-KOUREI-IRYOHI  =
                           WK-KOUREI-IRYOHI  +
                          (SYU-HKNTEN (17)   * 10)
               END-IF
             ELSE
               MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
               MOVE   ZERO    TO    WK-ENTANI
               MOVE   1       TO    FLG-TAISYO
             END-IF
           ELSE
             IF    LNK-SYU-SRYYMD(1:6)  >= "200804"
               IF   (SYU-SYUHKNNUM   NOT =  "039"      )
               AND  (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
                 IF  (SYU-KOH1HKNNUM     =  SPACE OR "970")
                 AND (SYU-KOH2HKNNUM     =  SPACE         )
                 AND (SYU-KOH3HKNNUM     =  SPACE         )
                 AND (SYU-KOH4HKNNUM     =  SPACE         )
                      COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
                      MOVE    ZERO            TO  FLG-TAISYO
                      IF  (LNK-SYU-SRYYMD(1:6)         >=  "201204")
                      AND (WK-SYUNOU-GENBUTU70-MSG  NOT =   4 AND 6)
                      AND (COMB-HKNNUM              NOT =   SPACE  )
                      AND (COMB-KOH1HKNNUM          NOT =   SPACE  )
                      AND (COMB-KOH1HKNNUM          NOT =   "970"  )
                      AND (LNK-SYU-TOTAL-HKNTEN     NOT =   ZERO   )
                      AND (SYU-TOTAL-HKNTEN         NOT =   ZERO   )
                        MOVE    3    TO  WK-SYUNOU-GENBUTU70-MSG
                      END-IF
                      IF  (LNK-SYU-SRYYMD(1:6)         >=  "201204")
                      AND (LNK-SYU-TOTAL-HKNTEN     NOT =   ZERO   )
                      AND (SYU-TOTAL-HKNTEN         NOT =   ZERO   )
                        IF  (COMB-KOH1HKNNUM    NOT = "970")
                        AND (SYU-KOH1HKNNUM         = "970")
                        AND (SYU-SKJ-FTNGAKU(2) NOT =  ZERO)
                        AND (SYU-PTFTNRATE      NOT =  ZERO)
                          MOVE  4    TO  WK-SYUNOU-GENBUTU70-MSG
                        END-IF
                        IF  (SYU-KOH1HKNNUM       =  "970")
                        AND (SYU-SKJ-FTNGAKU(2)   =   ZERO)
                        AND (FLG-DAISAN-GENBUTU2  =   1   )
                        AND (SYU-PTFTNRATE    NOT =   ZERO)
                          MOVE  4    TO  WK-SYUNOU-GENBUTU70-MSG
                        END-IF
                      END-IF
                      IF    (LNK-S01-IKTCHECKFLG   = "1")
                      AND   (LNK-S01-IKTGENKEIFLG  = "2")
                        IF  (COMB-KOH1HKNNUM  =  SPACE)
                        AND (SYU-KOH1HKNNUM   =  "970")
                          COMPUTE  WK-FUTANWARI =
                                   WK-SYUNOU-GENBUTU70-FTNRATE / 100
                          COMPUTE  WK-SYU-SYUCOMPFTN = SYU-TOTAL-HKNTEN
                                                     * 10
                                                     * WK-FUTANWARI
                          COMPUTE  WK-SYU-SYUCOMPFTN =
                                   WK-SYU-SYUCOMPFTN +  5
                          COMPUTE  WK-SYU-SYUCOMPFTN =
                                   WK-SYU-SYUCOMPFTN / 10
                          COMPUTE  WK-SYU-SYUCOMPFTN =
                                   WK-SYU-SYUCOMPFTN * 10
                        END-IF
                      END-IF
                      IF  (COMB-KOH1HKNNUM  = "972" OR "974")
                      AND (COMB-KOH2HKNNUM  = SPACE         )
                      AND (COMB-KOH3HKNNUM  = SPACE         )
                      AND (COMB-KOH4HKNNUM  = SPACE         )
                         MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                         MOVE    ZERO            TO  WK-ENTANI
                         MOVE    1               TO  FLG-TAISYO
                      END-IF
                 ELSE
                      IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                           (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                           (COMB-KOH4HKNNUM   =  "972" OR "974"))
                      AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                      AND ( SYU-KOH2HKNNUM    =   SPACE         )
                      AND ( SYU-KOH3HKNNUM    =   SPACE         )
                      AND ( SYU-KOH4HKNNUM    =   SPACE         )
                      AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                         MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                         MOVE    ZERO            TO  WK-ENTANI
                         MOVE    1               TO  FLG-TAISYO
                      ELSE
                         MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                         COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI  + 0.9
                         MOVE    ZERO            TO  FLG-TAISYO
                      END-IF
                 END-IF
                 ADD   WK-SYU-SYUCOMPFTN       TO  FTN-SYU-M
                 ADD   WK-ENTANI               TO  FTN-SYU-M-ENTANI
                 IF  (COMB-KOH1HKNNUM    =  SPACE OR "970")
                 AND (COMB-KOH2HKNNUM    =  SPACE         )
                 AND (COMB-KOH3HKNNUM    =  SPACE         )
                 AND (COMB-KOH4HKNNUM    =  SPACE         )
                 AND (SYU-KOH1HKNNUM     =  SPACE OR "970")
                 AND (SYU-KOH2HKNNUM     =  SPACE         )
                 AND (SYU-KOH3HKNNUM     =  SPACE         )
                 AND (SYU-KOH4HKNNUM     =  SPACE         )
                 AND (FLG-IRYOHIKG   NOT =  ZERO          )
                   COMPUTE   WK-KOUREI-IRYOHI  =
                             WK-KOUREI-IRYOHI  +
                            (SYU-HKNTEN (17)   * 10)
                 END-IF
               ELSE
                 MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                 MOVE   ZERO    TO    WK-ENTANI
                 MOVE   1       TO    FLG-TAISYO
               END-IF
             ELSE
               IF  (SYU-KOH1HKNNUM     NOT = SPACE)
               OR  (SYU-KOH2HKNNUM     NOT = SPACE)
               OR  (SYU-KOH3HKNNUM     NOT = SPACE)
               OR  (SYU-KOH4HKNNUM     NOT = SPACE)
                  MOVE   SYU-KOH-FTN    TO   WK-SYU-SYUCOMPFTN
               END-IF
               ADD   WK-SYU-SYUCOMPFTN  TO   FTN-SYU-M
      *
               COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
               IF  (SYU-KOH1HKNNUM     NOT = SPACE)
               OR  (SYU-KOH2HKNNUM     NOT = SPACE)
               OR  (SYU-KOH3HKNNUM     NOT = SPACE)
               OR  (SYU-KOH4HKNNUM     NOT = SPACE)
                  COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
               END-IF
               ADD   WK-ENTANI          TO   FTN-SYU-M-ENTANI
             END-IF
           END-IF
      *
           IF  (FLG-GENBUTU-CHECK-ERR        =   1)
           AND (WK-SYUNOU-GENBUTU70-MSG  NOT =   4)
             MOVE    6    TO    WK-SYUNOU-GENBUTU70-MSG
           END-IF
      *
           .
      *
       22025-KOUREI-SYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    長期の負担編集
      ******************************************************************
       22026-CYOKI-FTN-HENSYU-SEC          SECTION.
      *
           COMPUTE WK-CYOKI        =  WK-CYOKI
                                   +  SYU-KOH-FTN
           COMPUTE WK-CYOKI-ENTANI =  WK-CYOKI-ENTANI
                                   + (SYU-KOH-FTN-ENTANI + 0.9)
      *
           IF  (LNK-SYU-SRYYMD(1:6) >=  "200604"       )
           AND (SYU-KOH1HKNNUM   NOT =  "015" AND "016"
                                              AND "024")
           AND (SYU-KOH2HKNNUM   NOT =  "015" AND "016"
                                              AND "024")
              ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M-JI
              ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M2-JI
              COMPUTE  WK-ENTANI =  SYU-KOH-FTN-ENTANI + 0.9
              ADD   WK-ENTANI    TO  FTN-CYOKI-M3-JI
           END-IF
      *
           IF   FLG-RUITAISYO  =  1
             COMPUTE WK-CYOKI-TOKU75 =  WK-CYOKI-TOKU75
                                     +  SYU-KOH-FTN
             COMPUTE WK-CYOKI-ENTANI-TOKU75
                                     =  WK-CYOKI-ENTANI-TOKU75
                                     + (SYU-KOH-FTN-ENTANI + 0.9)
      *
             IF  (SYU-KOH1HKNNUM   NOT =  "015" AND "016"
                                                AND "024")
                ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M-JI-TOKU75
                ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M2-JI-TOKU75
                COMPUTE  WK-ENTANI =  SYU-KOH-FTN-ENTANI + 0.9
                ADD   WK-ENTANI    TO  FTN-CYOKI-M3-JI-TOKU75
             END-IF
           END-IF
      *
           .
      *
       22026-CYOKI-FTN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    公費ＩＤ編集
      ******************************************************************
       22027-KOHID-HENSYU-SEC          SECTION.
      *
      *    自立支援（精神通院、更生、育成）
           IF    LNK-SYU-SRYYMD(1:6)         >= "200604"
              MOVE  LNK-SYU-SRYYMD(1:6)  TO  WK-JIRITU-SRYYMD(1:6)
              MOVE  "01"                 TO  WK-JIRITU-SRYYMD(7:2)
              IF     SYU-KOH1HKNNUM  =  "015" OR "016" OR "021"
                IF   (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM  )
                AND  (COMB-KOH1ID     NOT =  WRK-COMB-KOH1ID )
                AND  (WK-JIRITU-CYUKANSOU(1)   =  2          )
                AND  (SYU-NYNSHOKAISU      NOT =  1          )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                END-IF
                IF   (LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM  )
                AND  (COMB-KOH2ID     NOT =  WRK-COMB-KOH1ID )
                AND  (WK-JIRITU-CYUKANSOU(2)   =  2          )
                AND  (SYU-NYNSHOKAISU      NOT =  1          )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                END-IF
              END-IF
              IF     SYU-KOH2HKNNUM  =  "015" OR "016" OR "021"
                IF   (LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM  )
                AND  (COMB-KOH1ID     NOT =  WRK-COMB-KOH2ID )
                AND  (WK-JIRITU-CYUKANSOU(1)   =  2          )
                AND  (SYU-NYNSHOKAISU      NOT =  1          )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                END-IF
                IF   (LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM  )
                AND  (COMB-KOH2ID     NOT =  WRK-COMB-KOH2ID )
                AND  (WK-JIRITU-CYUKANSOU(2)   =  2          )
                AND  (SYU-NYNSHOKAISU      NOT =  1          )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                END-IF
              END-IF
              IF     SYU-KOH1HKNNUM  =  "015" OR "016" OR "021"
                IF   (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM    )
                AND  (COMB-KOH1ID     NOT =  WRK-COMB-KOH1ID   )
                AND  (WK-JIRITU-CYUKANSOU(1)   =  1            )
                AND  (LNK-SYU-KOH2HKNNUM  NOT = "972" AND "974")
                AND  (LNK-SYU-KOH3HKNNUM  NOT = "972" AND "974")
                AND  (LNK-SYU-KOH4HKNNUM  NOT = "972" AND "974")
                AND  (SYU-NYNSHOKAISU          =  1            )
                AND  (SYU-KOH2HKNNUM      NOT = "972" AND "974")
                AND  (SYU-KOH3HKNNUM      NOT = "972" AND "974")
                AND  (SYU-KOH4HKNNUM      NOT = "972" AND "974")
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                END-IF
              END-IF
           END-IF
      *
      ***
      *
           PERFORM   VARYING   KOHFUKA-IDX   FROM   1   BY   1
                      UNTIL    KOHFUKA-IDX    >     4
             IF ((LNK-SYU-SRYYMD(1:6)         >=  "200310") AND
                 (SYU-KOH-HKNNUM(KOHFUKA-IDX)  =  "051"   ))
             OR ((LNK-SYU-SRYYMD(1:6)         >=  "200504") AND
                 (LNK-SYU-SRYYMD(1:6)         <=  "201412") AND
                 (SYU-KOH-HKNNUM(KOHFUKA-IDX)  =  "052"   ))
             OR ((LNK-SYU-SRYYMD(1:6)         >=  "200804") AND
                 (SYU-KOH-HKNNUM(KOHFUKA-IDX)  =  "038"   ))
             OR ((LNK-SYU-SRYYMD(1:6)         >=  "201501") AND
                 (SYU-KOH-HKNNUM(KOHFUKA-IDX)  =  "054"   ))
                MOVE   1   TO   FLG-KOHFUKA-HENSYU
                PERFORM   220272-KOHFUKA-HENSYU1-SEC
             END-IF
           END-PERFORM
      *
           INITIALIZE           WK-CHECK2010X-TBL
           IF     LNK-SYU-SRYYMD(1:6) >= "200804"
                PERFORM    220277-SYU-CHECK2010-SEC
                PERFORM    220278-SYU-CHECKHBT-SEC
           END-IF
      *
           PERFORM   VARYING   KOHFUKA-IDX   FROM   1   BY   1
                      UNTIL    KOHFUKA-IDX    >     4
             IF    SYU-KOH-HKNNUM(KOHFUKA-IDX)(1:1) >= "1" AND <= "8"
               IF     LNK-SYU-SRYYMD(1:6) >= "200804"
                 PERFORM   220275-JYUHENKBN-HENSYU-SEC
               ELSE
                 PERFORM   220276-JYUHENKBN-HENSYU2-SEC
               END-IF
             END-IF
           END-PERFORM
      *
           .
      *
       22027-KOHID-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    公費情報チェック
      ******************************************************************
       220271-KOHINF-CHECK-SEC          SECTION.
      *
           MOVE    ZERO               TO  FLG-CHECK-OK
           MOVE    SPACE              TO  WK-CHECK-FTNJANUM
                                          WK-CHECK-FTNJANUM2
                                          WK-CHECK-JKYSNUM
                                          WK-CHECK-JKYSNUM2
      *
           INITIALIZE                     PTKOHINF-REC
           MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
           MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
           MOVE    COMB-KOHID(CHECK-IDX)
                                      TO  PTKOH-KOHID
           MOVE    PTKOHINF-REC       TO  MCPDATA-REC
           MOVE    "DBSELECT"         TO  MCP-FUNC
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key8"             TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING  MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM  PTKOHINF-READ-SEC
             IF       FLG-PTKOHINF    =   ZERO
               MOVE   PTKOH-FTNJANUM  TO  WK-CHECK-FTNJANUM
               MOVE   PTKOH-JKYSNUM   TO  WK-CHECK-JKYSNUM
             END-IF
           END-IF
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key8"             TO  MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           INITIALIZE                     PTKOHINF-REC
           MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
           MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
           MOVE    WRK-COMB-KOHID(CHECK-IDX2)
                                      TO  PTKOH-KOHID
           MOVE    PTKOHINF-REC       TO  MCPDATA-REC
           MOVE    "DBSELECT"         TO  MCP-FUNC
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key8"             TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING  MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM  PTKOHINF-READ-SEC
             IF       FLG-PTKOHINF    =   ZERO
               MOVE   PTKOH-FTNJANUM  TO  WK-CHECK-FTNJANUM2
               MOVE   PTKOH-JKYSNUM   TO  WK-CHECK-JKYSNUM2
             END-IF
           END-IF
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key8"             TO  MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           IF ( WK-CHECK-FTNJANUM(3:5)  =  WK-CHECK-FTNJANUM2(3:5) )
           OR ((WK-CHECK-FTNJANUM(3:5)  =
                "28401" OR "28402" OR "28403" OR "28405" OR
                "28406" OR "28407" OR "28408" OR "28409" OR
                "28410" OR "28411"                         ) AND
               (WK-CHECK-FTNJANUM2(3:5) =
                "28401" OR "28402" OR "28403" OR "28405" OR
                "28406" OR "28407" OR "28408" OR "28409" OR
                "28410" OR "28411"                         )       )
               MOVE       1           TO  FLG-CHECK-OK
           END-IF
      *
           .
      *
       220271-KOHINF-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *    公費付加情報編集（１）
      ******************************************************************
       220272-KOHFUKA-HENSYU1-SEC          SECTION.
      *
           EVALUATE   KOHFUKA-IDX
             WHEN        1
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH1ID     NOT =  WRK-COMB-KOH1ID))
               OR ( WK-CHECK2010X-TAISYOIDX(1)   =  1      )
                IF  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
      ***       OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
      ***            (COMB-KOH2ID         =  WRK-COMB-KOH2ID) AND
      ***            (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                 CONTINUE
                ELSE
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                     MOVE   LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                      MOVE  LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
                END-IF
               END-IF
               IF ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH2ID     NOT =  WRK-COMB-KOH1ID))
               OR ( WK-CHECK2010X-TAISYOIDX(1)   =  2      )
                IF  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                 CONTINUE
                ELSE
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                     MOVE   LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                      MOVE  LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
                END-IF
               END-IF
               IF ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH3ID     NOT =  WRK-COMB-KOH1ID))
               OR ( WK-CHECK2010X-TAISYOIDX(1)   =  3      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH3ID    TO  WRK-COMB-KOH1ID
                     MOVE   LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH1ID
                      MOVE  LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH4ID     NOT =  WRK-COMB-KOH1ID))
               OR ( WK-CHECK2010X-TAISYOIDX(1)   =  4      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH4ID    TO  WRK-COMB-KOH1ID
                     MOVE   LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH1ID
                      MOVE  LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        2
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH1ID     NOT =  WRK-COMB-KOH2ID))
               OR ( WK-CHECK2010X-TAISYOIDX(2)   =  1      )
                IF  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                 CONTINUE
                ELSE
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                     MOVE   LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                      MOVE  LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
                END-IF
               END-IF
               IF ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH2ID     NOT =  WRK-COMB-KOH2ID))
               OR ( WK-CHECK2010X-TAISYOIDX(2)   =  2      )
                IF  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                 CONTINUE
                ELSE
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                     MOVE   LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                      MOVE  LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
                END-IF
               END-IF
               IF ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH3ID     NOT =  WRK-COMB-KOH2ID))
               OR ( WK-CHECK2010X-TAISYOIDX(2)   =  3      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH3ID    TO  WRK-COMB-KOH2ID
                     MOVE   LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH2ID
                      MOVE  LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH4ID     NOT =  WRK-COMB-KOH2ID))
               OR ( WK-CHECK2010X-TAISYOIDX(2)   =  4      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH4ID    TO  WRK-COMB-KOH2ID
                     MOVE   LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH2ID
                      MOVE  LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        3
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH1ID     NOT =  WRK-COMB-KOH3ID))
               OR ( WK-CHECK2010X-TAISYOIDX(3)   =  1      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH3ID
                     MOVE   LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH3ID
                      MOVE  LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH2ID     NOT =  WRK-COMB-KOH3ID))
               OR ( WK-CHECK2010X-TAISYOIDX(3)   =  2      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH3ID
                     MOVE   LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH3ID
                      MOVE  LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH3ID     NOT =  WRK-COMB-KOH3ID))
               OR ( WK-CHECK2010X-TAISYOIDX(3)   =  3      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH3ID    TO  WRK-COMB-KOH3ID
                     MOVE   LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH3ID
                      MOVE  LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH4ID     NOT =  WRK-COMB-KOH3ID))
               OR ( WK-CHECK2010X-TAISYOIDX(3)   =  4      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH4ID    TO  WRK-COMB-KOH3ID
                     MOVE   LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH3ID
                      MOVE  LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        4
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH1ID     NOT =  WRK-COMB-KOH4ID))
               OR ( WK-CHECK2010X-TAISYOIDX(4)   =  1      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH4ID
                     MOVE   LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH4ID
                      MOVE  LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH2ID     NOT =  WRK-COMB-KOH4ID))
               OR ( WK-CHECK2010X-TAISYOIDX(4)   =  2      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH4ID
                     MOVE   LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH4ID
                      MOVE  LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH3ID     NOT =  WRK-COMB-KOH4ID))
               OR ( WK-CHECK2010X-TAISYOIDX(4)   =  3      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH3ID    TO  WRK-COMB-KOH4ID
                     MOVE   LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH4ID
                      MOVE  LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH4ID     NOT =  WRK-COMB-KOH4ID))
               OR ( WK-CHECK2010X-TAISYOIDX(4)   =  4      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH4ID    TO  WRK-COMB-KOH4ID
                     MOVE   LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH4ID
                      MOVE  LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
           END-EVALUATE
      *
           IF   WK-1001-PREFNUM  =  28
               PERFORM  220273-KOHFUKA-HENSYU2-SEC
           END-IF
      *
           .
      *
       220272-KOHFUKA-HENSYU1-EXT.
           EXIT.
      *
      ******************************************************************
      *    公費付加情報編集（２）
      ******************************************************************
       220273-KOHFUKA-HENSYU2-SEC          SECTION.
      *
           EVALUATE   KOHFUKA-IDX
             WHEN        1
               IF ((SYU-KOH1HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                     MOVE    LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                       MOVE  LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH1HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                     MOVE    LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                       MOVE  LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH1HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH3ID    TO  WRK-COMB-KOH1ID
                     MOVE    LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH1ID
                       MOVE  LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH1HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH4ID    TO  WRK-COMB-KOH1ID
                     MOVE    LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH1ID
                       MOVE  LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        2
               IF ((SYU-KOH2HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                     MOVE    LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                       MOVE  LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH2HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                     MOVE    LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                       MOVE  LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH2HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH3ID    TO  WRK-COMB-KOH2ID
                     MOVE    LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH2ID
                       MOVE  LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH2HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH4ID    TO  WRK-COMB-KOH2ID
                     MOVE    LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH2ID
                       MOVE  LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        3
               IF ((SYU-KOH3HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH1ID    TO  WRK-COMB-KOH3ID
                     MOVE    LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH3ID
                       MOVE  LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH3HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH2ID    TO  WRK-COMB-KOH3ID
                     MOVE    LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH3ID
                       MOVE  LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH3HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH3ID    TO  WRK-COMB-KOH3ID
                     MOVE    LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH3ID
                       MOVE  LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH3HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH4ID    TO  WRK-COMB-KOH3ID
                     MOVE    LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH3ID
                       MOVE  LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        4
               IF ((SYU-KOH4HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH1ID    TO  WRK-COMB-KOH4ID
                     MOVE    LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH4ID
                       MOVE  LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH4HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH2ID    TO  WRK-COMB-KOH4ID
                     MOVE    LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH4ID
                       MOVE  LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH4HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH3ID    TO  WRK-COMB-KOH4ID
                     MOVE    LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH4ID
                       MOVE  LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH4HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH4ID    TO  WRK-COMB-KOH4ID
                     MOVE    LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220271-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH4ID
                       MOVE  LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
           END-EVALUATE
      *
           .
      *
       220273-KOHFUKA-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *    公費付加情報編集（３）
      ******************************************************************
       220274-KOHFUKA-HENSYU3-SEC          SECTION.
      *
           EVALUATE   KOHFUKA-IDX
             WHEN        1
               IF  (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH1ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH1ID
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH1ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH1ID
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH1ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH1ID
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH1ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH1ID
               END-IF
             WHEN        2
               IF  (LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH2ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH2ID
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH2ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH2ID
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH2ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH2ID
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH2ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH2ID
               END-IF
             WHEN        3
               IF  (LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH3ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH3ID
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH3ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH3ID
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH3ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH3ID
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH3ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH3ID
               END-IF
             WHEN        4
               IF  (LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH4ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH4ID
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH4ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH4ID
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH4ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH4ID
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH4ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH4ID
               END-IF
           END-EVALUATE
      *
           .
      *
       220274-KOHFUKA-HENSYU3-EXT.
           EXIT.
      *
      ******************************************************************
      *    月途中受給者証変更時負担計算の設定編集
      ******************************************************************
       220275-JYUHENKBN-HENSYU-SEC          SECTION.
      *
           EVALUATE  WK-CHECK2010X-JYUHENKBN(KOHFUKA-IDX)
             WHEN      SPACE
             WHEN      "0"
                 PERFORM   220276-JYUHENKBN-HENSYU2-SEC
             WHEN      "1"
             WHEN      "2"
                 MOVE  WK-CHECK2010X-JYUHENKBN(KOHFUKA-IDX)
                                           TO  FLG-KOHFUKA-HENSYU
                 PERFORM   220272-KOHFUKA-HENSYU1-SEC
             WHEN      "3"
                 CONTINUE
             WHEN      "4"
             WHEN      "6"
                 IF ( WK-HKNJANUM2  =  WK-HKNJANUM        )
                 OR ((WK-HKNJANUM2  =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ) AND
                     (WK-HKNJANUM   =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ))
                   MOVE   1   TO   FLG-KOHFUKA-HENSYU
                   PERFORM   220272-KOHFUKA-HENSYU1-SEC
                 ELSE
      *            保険者変更時
                   PERFORM   220274-KOHFUKA-HENSYU3-SEC
                 END-IF
             WHEN      "5"
                 IF ( WK-HKNJANUM2  =  WK-HKNJANUM        )
                 OR ((WK-HKNJANUM2  =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ) AND
                     (WK-HKNJANUM   =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ))
                   MOVE   2   TO   FLG-KOHFUKA-HENSYU
                   PERFORM   220272-KOHFUKA-HENSYU1-SEC
                 ELSE
      *            保険者変更時
                   PERFORM   220274-KOHFUKA-HENSYU3-SEC
                 END-IF
             WHEN      "Z"
                 IF ((COMB-KOH1HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH1HKNNUM = WRK-COMB-KOH1HKNNUM) AND
                     (COMB-KOH1ID     = WRK-COMB-KOH1ID    ))
                 OR ((COMB-KOH1HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH1HKNNUM = WRK-COMB-KOH2HKNNUM) AND
                     (COMB-KOH1ID     = WRK-COMB-KOH2ID    ))
                 OR ((COMB-KOH1HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH1HKNNUM = WRK-COMB-KOH3HKNNUM) AND
                     (COMB-KOH1ID     = WRK-COMB-KOH3ID    ))
                 OR ((COMB-KOH1HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH1HKNNUM = WRK-COMB-KOH4HKNNUM) AND
                     (COMB-KOH1ID     = WRK-COMB-KOH4ID    ))
                 OR ((COMB-KOH2HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH2HKNNUM = WRK-COMB-KOH1HKNNUM) AND
                     (COMB-KOH2ID     = WRK-COMB-KOH1ID    ))
                 OR ((COMB-KOH2HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH2HKNNUM = WRK-COMB-KOH2HKNNUM) AND
                     (COMB-KOH2ID     = WRK-COMB-KOH2ID    ))
                 OR ((COMB-KOH2HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH2HKNNUM = WRK-COMB-KOH3HKNNUM) AND
                     (COMB-KOH2ID     = WRK-COMB-KOH3ID    ))
                 OR ((COMB-KOH2HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH2HKNNUM = WRK-COMB-KOH4HKNNUM) AND
                     (COMB-KOH2ID     = WRK-COMB-KOH4ID    ))
                 OR ((COMB-KOH3HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH3HKNNUM = WRK-COMB-KOH1HKNNUM) AND
                     (COMB-KOH3ID     = WRK-COMB-KOH1ID    ))
                 OR ((COMB-KOH3HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH3HKNNUM = WRK-COMB-KOH2HKNNUM) AND
                     (COMB-KOH3ID     = WRK-COMB-KOH2ID    ))
                 OR ((COMB-KOH3HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH3HKNNUM = WRK-COMB-KOH3HKNNUM) AND
                     (COMB-KOH3ID     = WRK-COMB-KOH3ID    ))
                 OR ((COMB-KOH3HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH3HKNNUM = WRK-COMB-KOH4HKNNUM) AND
                     (COMB-KOH3ID     = WRK-COMB-KOH4ID    ))
                 OR ((COMB-KOH4HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH4HKNNUM = WRK-COMB-KOH1HKNNUM) AND
                     (COMB-KOH4ID     = WRK-COMB-KOH1ID    ))
                 OR ((COMB-KOH4HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH4HKNNUM = WRK-COMB-KOH2HKNNUM) AND
                     (COMB-KOH4ID     = WRK-COMB-KOH2ID    ))
                 OR ((COMB-KOH4HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH4HKNNUM = WRK-COMB-KOH3HKNNUM) AND
                     (COMB-KOH4ID     = WRK-COMB-KOH3ID    ))
                 OR ((COMB-KOH4HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH4HKNNUM = WRK-COMB-KOH4HKNNUM) AND
                     (COMB-KOH4ID     = WRK-COMB-KOH4ID    ))
                   CONTINUE
                 ELSE
                   PERFORM   220274-KOHFUKA-HENSYU3-SEC
                 END-IF
           END-EVALUATE
      *
           .
      *
       220275-JYUHENKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    月途中受給者証変更時負担計算の設定編集２
      ******************************************************************
       220276-JYUHENKBN-HENSYU2-SEC          SECTION.
      *
           IF   WK-1001-PREFNUM             =  08 OR 31
               MOVE   1   TO   FLG-KOHFUKA-HENSYU
               PERFORM   220272-KOHFUKA-HENSYU1-SEC
           END-IF
           IF  (WK-1001-PREFNUM             =  34                    )
           AND (SYU-KOH-HKNNUM(KOHFUKA-IDX) = "191" OR "291" OR "491")
               MOVE   2   TO   FLG-KOHFUKA-HENSYU
               PERFORM   220272-KOHFUKA-HENSYU1-SEC
           END-IF
           IF ((WK-1001-PREFNUM             =  41           ) AND
               (SYU-KOH-HKNNUM(KOHFUKA-IDX) = "181"         ))
           OR ((WK-1001-PREFNUM             =  36           ) AND
               (SYU-KOH-HKNNUM(KOHFUKA-IDX) = "245" OR "445"))
             IF   WK-HKNJANUM2  =  WK-HKNJANUM
               MOVE   1   TO   FLG-KOHFUKA-HENSYU
               PERFORM   220272-KOHFUKA-HENSYU1-SEC
             ELSE
      *        保険者変更時
               PERFORM   220274-KOHFUKA-HENSYU3-SEC
             END-IF
           END-IF
      *
           .
      *
       220276-JYUHENKBN-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *    収納データのシステム管理２０１０設定チェック
      ******************************************************************
       220277-SYU-CHECK2010-SEC          SECTION.
      *
           MOVE     ZERO     TO    FLG-ARI
           PERFORM  VARYING  IDX16  FROM  1  BY  1
                     UNTIL  (IDX16                            >  100 )
                      OR    (WK-CHECK2010-HKNCOMBINUM(IDX16)  = SPACE)
                      OR    (FLG-ARI                          =  1   )
             IF  SYU-HKNCOMBINUM = WK-CHECK2010-HKNCOMBINUM(IDX16)
               MOVE    1     TO    FLG-ARI
               PERFORM  VARYING  IDX17  FROM  1  BY  1
                         UNTIL  (IDX17                     >  4   )
                          OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
                 IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
                   MOVE  WK-CHECK2010-JYUHENKBN(IDX16 IDX17)
                             TO    WK-CHECK2010X-JYUHENKBN(IDX17)
                   MOVE  WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17)
                             TO    WK-CHECK2010X-JYUHEN-TAIKBN(IDX17)
                   MOVE  WK-CHECK2010-HBTNUM(IDX16 IDX17)
                             TO    WK-CHECK2010X-HBTNUM(IDX17)
                   MOVE  WK-CHECK2010-NG(IDX16 IDX17)
                             TO    WK-CHECK2010X-NG(IDX17)
                 END-IF
               END-PERFORM
             END-IF
           END-PERFORM
           IF    FLG-ARI  =   ZERO
           AND   IDX16   <=   100
             MOVE  SYU-HKNCOMBINUM  TO  WK-CHECK2010-HKNCOMBINUM(IDX16)
             PERFORM  VARYING  IDX17  FROM  1  BY  1
                       UNTIL  (IDX17                     >  4   )
                        OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
               IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
                 PERFORM   2202771-SYU-CHECK2010-XXX-SEC
               END-IF
             END-PERFORM
      *
             PERFORM  VARYING  IDX17  FROM  1  BY  1
                       UNTIL  (IDX17                     >  4   )
                        OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
               IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
                 PERFORM   2202772-SYU-CHECK2010-YYY-SEC
               END-IF
             END-PERFORM
      *
             PERFORM  VARYING  IDX17  FROM  1  BY  1
                       UNTIL  (IDX17                     >  4   )
                        OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
               IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
                 MOVE  WK-CHECK2010-JYUHENKBN(IDX16 IDX17)
                             TO    WK-CHECK2010X-JYUHENKBN(IDX17)
                 MOVE  WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17)
                             TO    WK-CHECK2010X-JYUHEN-TAIKBN(IDX17)
                 MOVE  WK-CHECK2010-HBTNUM(IDX16 IDX17)
                             TO    WK-CHECK2010X-HBTNUM(IDX17)
                 MOVE  WK-CHECK2010-NG(IDX16 IDX17)
                             TO    WK-CHECK2010X-NG(IDX17)
               END-IF
             END-PERFORM
           END-IF
      *
           .
      *
       220277-SYU-CHECK2010-EXT.
           EXIT.
      *
      ******************************************************************
      *    収納データのシステム管理２０１０設定チェック
      ******************************************************************
       2202771-SYU-CHECK2010-XXX-SEC          SECTION.
      *
           INITIALIZE                   SYS-2010-REC
           MOVE    "2010"           TO  SYS-2010-KANRICD
           MOVE    WRK-COMB-KOHHKNNUM(IDX17)
                                    TO  SYS-2010-KBNCD
           MOVE    SYU-HOSPNUM      TO  SYS-2010-HOSPNUM
           MOVE    SYU-SRYYMD       TO  SYS-2010-STYUKYMD
           MOVE    SYU-SRYYMD       TO  SYS-2010-EDYUKYMD
           MOVE    SYS-2010-REC     TO  MCPDATA-REC
           MOVE    "DBSELECT"       TO  MCP-FUNC
           MOVE    "tbl_syskanri"   TO  MCP-TABLE
           MOVE    "key10"          TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"  USING   MCPAREA
                                        MCPDATA-REC
                                        SPA-AREA
           IF      MCP-RC   =   ZERO
             MOVE  "tbl_syskanri"   TO  MCP-TABLE
             MOVE  "key10"          TO  MCP-PATHNAME
             PERFORM      SYSKANRI-READ-SEC
             MOVE  SYS-2010-JYUHENKBN
                            TO  WK-CHECK2010-JYUHENKBN(IDX16 IDX17)
      *
             IF ((COMB-KOH1HKNNUM  =  WRK-COMB-KOHHKNNUM(IDX17)) AND
                 (COMB-KOH1ID      =  WRK-COMB-KOHID(IDX17)    ) AND
                 (FLG-CHIHOU3(1)   =  "1"                      ))
             OR ((COMB-KOH2HKNNUM  =  WRK-COMB-KOHHKNNUM(IDX17)) AND
                 (COMB-KOH2ID      =  WRK-COMB-KOHID(IDX17)    ) AND
                 (FLG-CHIHOU3(2)   =  "1"                      ))
             OR ((COMB-KOH3HKNNUM  =  WRK-COMB-KOHHKNNUM(IDX17)) AND
                 (COMB-KOH3ID      =  WRK-COMB-KOHID(IDX17)    ) AND
                 (FLG-CHIHOU3(3)   =  "1"                      ))
             OR ((COMB-KOH4HKNNUM  =  WRK-COMB-KOHHKNNUM(IDX17)) AND
                 (COMB-KOH4ID      =  WRK-COMB-KOHID(IDX17)    ) AND
                 (FLG-CHIHOU3(4)   =  "1"                      ))
               MOVE   "Z"   TO  WK-CHECK2010-JYUHENKBN(IDX16 IDX17)
             END-IF
      *
             MOVE  SYS-2010-JYUHEN-TAIKBN
                            TO  WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17)
             IF    SYS-2010-JYUHEN-TAIKBN  =  "1"
               INITIALIZE                     HKNNUM-REC
               MOVE   SYU-HOSPNUM         TO  HKN-HOSPNUM
               MOVE   WRK-COMB-KOHHKNNUM(IDX17)
                                          TO  HKN-HKNNUM
               MOVE   "00"                TO  HKN-PAYKBN
               MOVE   SYU-SRYYMD(1:6)     TO  HKN-TEKSTYMD(1:6)
                                              HKN-TEKEDYMD(1:6)
               MOVE   "01"                TO  HKN-TEKSTYMD(7:2)
                                              HKN-TEKEDYMD(7:2)
               MOVE   HKNNUM-REC          TO  MCPDATA-REC
               MOVE   "DBSELECT"          TO  MCP-FUNC
               MOVE   "tbl_hknnum"        TO  MCP-TABLE
               MOVE   "key"               TO  MCP-PATHNAME
               CALL   "ORCDBMAIN"         USING   MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
               IF      MCP-RC       =   ZERO
                 MOVE "tbl_hknnum"        TO  MCP-TABLE
                 MOVE "key"               TO  MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 IF    FLG-HKNNUM   =   ZERO
                   MOVE   HKN-HBTNUM
                            TO  WK-CHECK2010-HBTNUM(IDX16 IDX17)
                 END-IF
               END-IF
               MOVE   "tbl_hknnum"        TO  MCP-TABLE
               MOVE   "key"               TO  MCP-PATHNAME
               PERFORM    DB-CLOSE-SEC
             END-IF
           END-IF
           MOVE    "tbl_syskanri"   TO  MCP-TABLE
           MOVE    "key10"          TO  MCP-PATHNAME
           PERFORM        DB-CLOSE-SEC
      *
           .
      *
       2202771-SYU-CHECK2010-XXX-EXT.
           EXIT.
      *
      ******************************************************************
      *    収納データのシステム管理２０１０設定チェック
      ******************************************************************
       2202772-SYU-CHECK2010-YYY-SEC          SECTION.
      *
           IF  (WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17) =  "1"  )
           AND (WK-CHECK2010-HBTNUM(IDX16 IDX17)    NOT =  SPACE)
             EVALUATE  IDX17
               WHEN       1
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 1) =
                             WK-CHECK2010-HBTNUM(IDX16 2)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 1) =
                             WK-CHECK2010-HBTNUM(IDX16 3)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 1) =
                             WK-CHECK2010-HBTNUM(IDX16 4)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 1)
                 END-IF
               WHEN       2
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 2) =
                             WK-CHECK2010-HBTNUM(IDX16 1)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 2) =
                             WK-CHECK2010-HBTNUM(IDX16 3)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 2) =
                             WK-CHECK2010-HBTNUM(IDX16 4)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 2)
                 END-IF
               WHEN       3
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 3) =
                             WK-CHECK2010-HBTNUM(IDX16 1)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 3) =
                             WK-CHECK2010-HBTNUM(IDX16 2)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 3) =
                             WK-CHECK2010-HBTNUM(IDX16 4)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 3)
                 END-IF
               WHEN       4
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 4) =
                             WK-CHECK2010-HBTNUM(IDX16 1)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 4) =
                             WK-CHECK2010-HBTNUM(IDX16 2)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 4) =
                             WK-CHECK2010-HBTNUM(IDX16 3)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 4)
                 END-IF
             END-EVALUATE
           END-IF
      *
           IF   WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17) =
                        "A" OR "B" OR "C" OR "D" OR "E" OR
                        "F" OR "G" OR "H" OR "I" OR "J"
             EVALUATE  IDX17
               WHEN       1
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 1)
                 END-IF
               WHEN       2
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 2)
                 END-IF
               WHEN       3
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 3)
                 END-IF
               WHEN       4
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 4)
                 END-IF
             END-EVALUATE
           END-IF
      *
           .
      *
       2202772-SYU-CHECK2010-YYY-EXT.
           EXIT.
      *
      ******************************************************************
      *    収納データの法別番号等のチェック
      ******************************************************************
       220278-SYU-CHECKHBT-SEC          SECTION.
      *
           PERFORM  VARYING  IDX17  FROM  1  BY  1
                     UNTIL  (IDX17                     >  4   )
                      OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
             IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
               IF  WRK-COMB-KOHHKNNUM(IDX17) =  COMB-KOHHKNNUM(1)
                                            OR  COMB-KOHHKNNUM(2)
                                            OR  COMB-KOHHKNNUM(3)
                                            OR  COMB-KOHHKNNUM(4)
                 CONTINUE
               ELSE
                 IF  (WK-CHECK2010X-JYUHEN-TAIKBN(IDX17)  =  "1"  )
                 AND (WK-CHECK2010X-HBTNUM(IDX17)     NOT =  SPACE)
                 AND (WK-CHECK2010X-NG(IDX17)             =  SPACE)
                   PERFORM  VARYING  IDX16  FROM  1  BY  1
                             UNTIL  (IDX16                 >  4   )
                              OR    (COMB-KOHHKNNUM(IDX16) = SPACE)
                     IF  (WK-CHECK2010X-JYUHEN-TAIKBN(IDX17) =
                                     WK-2010-JYUHEN-TAIKBN(IDX16))
                     AND (WK-CHECK2010X-HBTNUM(IDX17) =
                                     WK-HBTNUM(IDX16)            )
                     AND (WK-CHECK2010X-JYUHENKBN(IDX17) =
                                     WK-2010-JYUHENKBN(IDX16)    )
                        PERFORM   2202781-SYU-CHECKHBT-XXX-SEC
                        MOVE   4       TO   IDX16
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 IF  (WK-CHECK2010X-JYUHEN-TAIKBN(IDX17)  =
                              "A" OR "B" OR "C" OR "D" OR "E" OR
                              "F" OR "G" OR "H" OR "I" OR "J"     )
                 AND (WK-CHECK2010X-NG(IDX17)             =  SPACE)
                   PERFORM  VARYING  IDX16  FROM  1  BY  1
                             UNTIL  (IDX16                 >  4   )
                              OR    (COMB-KOHHKNNUM(IDX16) = SPACE)
                     IF  (WK-CHECK2010X-JYUHEN-TAIKBN(IDX17) =
                                     WK-2010-JYUHEN-TAIKBN(IDX16))
                     AND (WK-CHECK2010X-JYUHENKBN(IDX17) =
                                     WK-2010-JYUHENKBN(IDX16)    )
                        PERFORM   2202782-SYU-CHECKHBT-YYY-SEC
                        MOVE   4       TO   IDX16
                     END-IF
                   END-PERFORM
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           .
      *
       220278-SYU-CHECKHBT-EXT.
           EXIT.
      *
      ******************************************************************
      *    収納データの法別番号等のチェック
      ******************************************************************
       2202781-SYU-CHECKHBT-XXX-SEC          SECTION.
      *
           EVALUATE  IDX16
             WHEN      1
               IF ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-HBTNUM(1)         = WK-HBTNUM(2)            ) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-HBTNUM(1)         = WK-HBTNUM(3)            ) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(3)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-HBTNUM(1)         = WK-HBTNUM(4)            ) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    1    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      2
               IF ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-HBTNUM(2)         = WK-HBTNUM(1)            ) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-HBTNUM(2)         = WK-HBTNUM(3)            ) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(3)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-HBTNUM(2)         = WK-HBTNUM(4)            ) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    2    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      3
               IF ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-HBTNUM(3)         = WK-HBTNUM(1)            ) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-HBTNUM(3)         = WK-HBTNUM(2)            ) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-HBTNUM(3)         = WK-HBTNUM(4)            ) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    3    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      4
               IF ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-HBTNUM(4)         = WK-HBTNUM(1)            ) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-HBTNUM(4)         = WK-HBTNUM(2)            ) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-HBTNUM(4)         = WK-HBTNUM(3)            ) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(3)    ))
                 CONTINUE
               ELSE
                 MOVE    4    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
           END-EVALUATE
      *
           .
      *
       2202781-SYU-CHECKHBT-XXX-EXT.
           EXIT.
      *
      ******************************************************************
      *    収納データの法別番号等のチェック
      ******************************************************************
       2202782-SYU-CHECKHBT-YYY-SEC          SECTION.
      *
           EVALUATE  IDX16
             WHEN      1
               IF ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(3)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    1    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      2
               IF ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(3)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    2    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      3
               IF ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    3    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      4
               IF ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(3)    ))
                 CONTINUE
               ELSE
                 MOVE    4    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
           END-EVALUATE
      *
           .
      *
       2202782-SYU-CHECKHBT-YYY-EXT.
           EXIT.
      *
      ******************************************************************
      *    ７５歳到達月の特例（現物給付でない場合、長期あり）
      ******************************************************************
       22028-TOKU75-CYO-HENSYU-SEC          SECTION.
      *
           EVALUATE   FLG-TOKU75-CYO
             WHEN         1
             WHEN         2
               IF     COMB-HKNNUM     = "039"
                 IF  ( SYU-SYUHKNNUM   = "039"          )
                 AND ( WK-HKNJANUM2-TBL
                                       = WK-HKNJANUM-TBL)
                 AND ((SYU-KOH1HKNNUM  = "972" OR "974") OR
                      (SYU-KOH2HKNNUM  = "972" OR "974") OR
                      (SYU-KOH3HKNNUM  = "972" OR "974") OR
                      (SYU-KOH4HKNNUM  = "972" OR "974"))
                    IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH4HKNNUM   =  "972" OR "974"))
                    AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                    AND ( SYU-KOH2HKNNUM    =   SPACE         )
                    AND ( SYU-KOH3HKNNUM    =   SPACE         )
                    AND ( SYU-KOH4HKNNUM    =   SPACE         )
                    AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                      MOVE  ZERO                TO   WK-SYU-SYUCOMPFTN
                      MOVE  ZERO                TO   WK-ENTANI
                      MOVE  1                   TO   FLG-TAISYO
                    ELSE
                      MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                      ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                      COMPUTE  WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                      ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                      MOVE  ZERO                TO   FLG-TAISYO
                    END-IF
                 ELSE
                      MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                      MOVE   ZERO    TO    WK-ENTANI
                      MOVE   1       TO    FLG-TAISYO
                 END-IF
               ELSE
                 IF  ( SYU-SYUHKNNUM   NOT =  "039"      )
                 AND ( WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
                 AND ((SYU-KOH1HKNNUM   = "972" OR "974") OR
                      (SYU-KOH2HKNNUM   = "972" OR "974") OR
                      (SYU-KOH3HKNNUM   = "972" OR "974") OR
                      (SYU-KOH4HKNNUM   = "972" OR "974"))
                    IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH4HKNNUM   =  "972" OR "974"))
                    AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                    AND ( SYU-KOH2HKNNUM    =   SPACE         )
                    AND ( SYU-KOH3HKNNUM    =   SPACE         )
                    AND ( SYU-KOH4HKNNUM    =   SPACE         )
                    AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                      MOVE  ZERO                TO   WK-SYU-SYUCOMPFTN
                      MOVE  ZERO                TO   WK-ENTANI
                      MOVE  1                   TO   FLG-TAISYO
                    ELSE
                      MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                      ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                      COMPUTE  WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                      ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                      MOVE  ZERO                TO   FLG-TAISYO
                    END-IF
                 ELSE
                      MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                      MOVE   ZERO    TO    WK-ENTANI
                      MOVE   1       TO    FLG-TAISYO
                 END-IF
               END-IF
             WHEN         3
               IF  ( WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
               AND ((SYU-KOH1HKNNUM   = "972" OR "974") OR
                    (SYU-KOH2HKNNUM   = "972" OR "974") OR
                    (SYU-KOH3HKNNUM   = "972" OR "974") OR
                    (SYU-KOH4HKNNUM   = "972" OR "974"))
                 IF    FLG-MARUKO  =  ZERO
                   IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                        (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                        (COMB-KOH4HKNNUM   =  "972" OR "974"))
                   AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                   AND ( SYU-KOH2HKNNUM    =   SPACE         )
                   AND ( SYU-KOH3HKNNUM    =   SPACE         )
                   AND ( SYU-KOH4HKNNUM    =   SPACE         )
                   AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                      MOVE  ZERO                TO   WK-SYU-SYUCOMPFTN
                      MOVE  ZERO                TO   WK-ENTANI
                      MOVE  1                   TO   FLG-TAISYO
                   ELSE
                      MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                      ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                      COMPUTE  WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                      ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                      MOVE  ZERO                TO   FLG-TAISYO
                   END-IF
                 ELSE
                   IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                      MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                      MOVE   ZERO    TO    WK-ENTANI
                      MOVE   1       TO    FLG-TAISYO
                   ELSE
                      MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                      ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                      COMPUTE  WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                      ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                      MOVE   ZERO               TO   FLG-TAISYO
                   END-IF
                 END-IF
               ELSE
                      MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                      MOVE   ZERO    TO    WK-ENTANI
                      MOVE   1       TO    FLG-TAISYO
               END-IF
           END-EVALUATE
      *
           .
      *
       22028-TOKU75-CYO-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    その他（長期あり）
      ******************************************************************
       22029-CYOKI-ARI-HENSYU-SEC          SECTION.
      *
           EVALUATE   FLG-CYOKI-ARI
             WHEN         1
               IF     COMB-HKNNUM     = "039"
                 IF  ( SYU-SYUHKNNUM   = "039"          )
                 AND ( WK-HKNJANUM2-TBL
                                       = WK-HKNJANUM-TBL)
                 AND ((SYU-KOH1HKNNUM  = "972" OR "974") OR
                      (SYU-KOH2HKNNUM  = "972" OR "974") OR
                      (SYU-KOH3HKNNUM  = "972" OR "974") OR
                      (SYU-KOH4HKNNUM  = "972" OR "974"))
                    IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH4HKNNUM   =  "972" OR "974"))
                    AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                    AND ( SYU-KOH2HKNNUM    =   SPACE         )
                    AND ( SYU-KOH3HKNNUM    =   SPACE         )
                    AND ( SYU-KOH4HKNNUM    =   SPACE         )
                    AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                      MOVE  ZERO                TO   WK-SYU-SYUCOMPFTN
                      MOVE  ZERO                TO   WK-ENTANI
                      MOVE  1                   TO   FLG-TAISYO
                    ELSE
                      MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                      ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                      COMPUTE  WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                      ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                      MOVE  ZERO                TO   FLG-TAISYO
                    END-IF
                 ELSE
                      MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                      MOVE   ZERO    TO    WK-ENTANI
                      MOVE   1       TO    FLG-TAISYO
                 END-IF
               ELSE
                 IF  ( SYU-SYUHKNNUM   NOT =  "039"      )
                 AND ( WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
                 AND ((SYU-KOH1HKNNUM   = "972" OR "974") OR
                      (SYU-KOH2HKNNUM   = "972" OR "974") OR
                      (SYU-KOH3HKNNUM   = "972" OR "974") OR
                      (SYU-KOH4HKNNUM   = "972" OR "974"))
                    IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH4HKNNUM   =  "972" OR "974"))
                    AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                    AND ( SYU-KOH2HKNNUM    =   SPACE         )
                    AND ( SYU-KOH3HKNNUM    =   SPACE         )
                    AND ( SYU-KOH4HKNNUM    =   SPACE         )
                    AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                      MOVE  ZERO                TO   WK-SYU-SYUCOMPFTN
                      MOVE  ZERO                TO   WK-ENTANI
                      MOVE  1                   TO   FLG-TAISYO
                    ELSE
                      MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                      ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                      COMPUTE  WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                      ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                      MOVE  ZERO                TO   FLG-TAISYO
                    END-IF
                 ELSE
                      MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                      MOVE   ZERO    TO    WK-ENTANI
                      MOVE   1       TO    FLG-TAISYO
                 END-IF
               END-IF
             WHEN         2
               IF  ( WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
               AND ((SYU-KOH1HKNNUM   = "972" OR "974") OR
                    (SYU-KOH2HKNNUM   = "972" OR "974") OR
                    (SYU-KOH3HKNNUM   = "972" OR "974") OR
                    (SYU-KOH4HKNNUM   = "972" OR "974"))
                 IF    FLG-MARUKO  =  ZERO
                    IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                         (COMB-KOH4HKNNUM   =  "972" OR "974"))
                    AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                    AND ( SYU-KOH2HKNNUM    =   SPACE         )
                    AND ( SYU-KOH3HKNNUM    =   SPACE         )
                    AND ( SYU-KOH4HKNNUM    =   SPACE         )
                    AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                      MOVE  ZERO                TO   WK-SYU-SYUCOMPFTN
                      MOVE  ZERO                TO   WK-ENTANI
                      MOVE  1                   TO   FLG-TAISYO
                    ELSE
                      MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                      ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                      COMPUTE  WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                      ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                      MOVE  ZERO                TO   FLG-TAISYO
                    END-IF
                 ELSE
                   IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                      MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                      MOVE   ZERO    TO    WK-ENTANI
                      MOVE   1       TO    FLG-TAISYO
                   ELSE
                      MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                      ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                      COMPUTE  WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                      ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                      MOVE   ZERO               TO   FLG-TAISYO
                   END-IF
                 END-IF
               ELSE
                      MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                      MOVE   ZERO    TO    WK-ENTANI
                      MOVE   1       TO    FLG-TAISYO
               END-IF
           END-EVALUATE
      *
           .
      *
       22029-CYOKI-ARI-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    回数カウント（入院）
      ******************************************************************
       2202A-KAISU-COUNT3-SEC           SECTION.
      *
           EVALUATE  TRUE
             WHEN  LNK-SYU-KOH-HKNNUM(IDX3) = SYU-KOH1HKNNUM
                MOVE   1    TO    IDX12
             WHEN  LNK-SYU-KOH-HKNNUM(IDX3) = SYU-KOH2HKNNUM
                MOVE   2    TO    IDX12
             WHEN  LNK-SYU-KOH-HKNNUM(IDX3) = SYU-KOH3HKNNUM
                MOVE   3    TO    IDX12
             WHEN  LNK-SYU-KOH-HKNNUM(IDX3) = SYU-KOH4HKNNUM
                MOVE   4    TO    IDX12
           END-EVALUATE
      *
           PERFORM   VARYING  IDX11  FROM  1  BY  1
                      UNTIL   IDX11   >   31
             IF  (KOHI-TBL(IDX11 IDX3)         =  ZERO      )
             AND (SYU-DAY(IDX11) =  "1" OR "2" OR "8" OR "9")
             AND (SYU-KOH-HKNFTNMONEY(IDX12)   NOT = ZERO   )
             AND (SDAY-SANTEIFLG(IDX11 IDX12)  =   1        )
             AND (IDX11                    NOT =  IDX2      )
                ADD    1    TO    KOHI-TBL(IDX11 IDX3)
                ADD    1    TO    KOHI-TBL(32 IDX3)
             END-IF
           END-PERFORM
      *
           .
      *
       2202A-KAISU-COUNT3-EXT.
           EXIT.
      *
      ******************************************************************
      *    収納保険情報編集
      ******************************************************************
       2202B-SYUNOU-HKN-HENSYU-SEC           SECTION.
      *
           MOVE    ZERO               TO   FLG-SYUNOU-HKN-HANTEI
      *    保険組合せマスタの検索
           INITIALIZE                      WRK-HKNCOMBI-REC
           MOVE    SYU-HOSPNUM        TO   WRK-COMB-HOSPNUM
           MOVE    SYU-PTID           TO   WRK-COMB-PTID
           MOVE    SYU-HKNCOMBINUM    TO   WRK-COMB-HKNCOMBINUM
           MOVE    WRK-HKNCOMBI-REC   TO   MCPDATA-REC
           MOVE    "DBSELECT"         TO   MCP-FUNC
           MOVE    "tbl_hkncombi"     TO   MCP-TABLE
           MOVE    "key"              TO   MCP-PATHNAME
           CALL    "ORCDBMAIN"     USING   MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_hkncombi" TO   MCP-TABLE
               MOVE    "key"          TO   MCP-PATHNAME
               PERFORM  HKNCOMBI-READ2-SEC
               IF      FLG-HKNCOMBI     =       1
                   DISPLAY "HKNCOMBI DBFETCH ERR"
                   MOVE     10             TO   LNK-S01-RC
                   MOVE    "tbl_hkncombi"  TO   MCP-TABLE
                   MOVE    "key"           TO   MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
                   MOVE     1              TO   FLG-SYUNOU-HKN-HANTEI
               END-IF
           ELSE
               MOVE    1              TO   FLG-HKNCOMBI
               DISPLAY "HKNCOMBI DBSELECT ERR"
               MOVE     10            TO   LNK-S01-RC
               MOVE    "tbl_hkncombi" TO   MCP-TABLE
               MOVE    "key"          TO   MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
               MOVE     1             TO   FLG-SYUNOU-HKN-HANTEI
           END-IF
           IF  FLG-SYUNOU-HKN-HANTEI = ZERO
               MOVE    "tbl_hkncombi" TO   MCP-TABLE
               MOVE    "key"          TO   MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
           END-IF
      *
           MOVE   SPACE              TO    WK-HKNJANUM2-TBL
           MOVE   SPACE              TO    WK-CONTKBN2
           INITIALIZE                      PTHKNINF-REC
           MOVE   WRK-COMB-HOSPNUM   TO    PTHKN-HOSPNUM
           MOVE   WRK-COMB-PTID      TO    PTHKN-PTID
           MOVE   WRK-COMB-HKNID     TO    PTHKN-HKNID
           MOVE   PTHKNINF-REC       TO    MCPDATA-REC
           MOVE   "DBSELECT"         TO    MCP-FUNC
           MOVE   "tbl_pthkninf"     TO    MCP-TABLE
           MOVE   "key"              TO    MCP-PATHNAME
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_pthkninf"     TO    MCP-TABLE
               MOVE    "key"              TO    MCP-PATHNAME
               PERFORM  PTHKNINF-READ-SEC
               IF      FLG-PTHKNINF   =     ZERO
                  MOVE  PTHKN-HKNJANUM    TO    WK-HKNJANUM2
                  MOVE  PTHKN-HONKZKKBN   TO    WK-HONKZKKBN2
      ***         MOVE  PTHKN-KIGO        TO    WK-KIGO2
      ***         MOVE  PTHKN-NUM         TO    WK-NUM2
                  MOVE  PTHKN-CONTKBN     TO    WK-CONTKBN2
               END-IF
           END-IF
           MOVE     "tbl_pthkninf"   TO    MCP-TABLE
           MOVE     "key"            TO    MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           IF  (WK-CONTKBN   NOT = SPACE)
           OR  (WK-CONTKBN2  NOT = SPACE)
              IF  (WK-HKNJANUM2  = WK-HKNJANUM )
              AND (WK-HONKZKKBN2 = WK-HONKZKKBN)
                MOVE  WK-KIGO       TO  WK-KIGO2
                MOVE  WK-NUM        TO  WK-NUM2
              END-IF
           END-IF
      *
           IF  (FLG-KOUREI-KBN   =   "1" )
           OR  (COMB-HKNNUM      =  "060")
              IF   WK-HKNJANUM2  = WK-HKNJANUM
                MOVE  WK-HONKZKKBN  TO  WK-HONKZKKBN2
                MOVE  WK-KIGO       TO  WK-KIGO2
                MOVE  WK-NUM        TO  WK-NUM2
              END-IF
           END-IF
      *
           MOVE   WK-HKNJANUM2-TBL      TO  WK-HKNJANUM3-TBL
           MOVE   WK-HKNJANUM2-TBL      TO  WK-HKNJANUM5-TBL
           MOVE   WK-HKNJANUM2-TBL      TO  WK-HKNJANUM6-TBL
      *
           IF    (COMB-HKNNUM      =   "039")
           AND   (SYU-SYUHKNNUM    =   "039")
             IF   LNK-SYU-SRYYMD(1:6) >= "201204"
               IF   WK-HKNJANUM2(1:4)  =  WK-HKNJANUM(1:4)
                 MOVE  WK-HKNJANUM-TBL  TO  WK-HKNJANUM2-TBL
               END-IF
             ELSE
                 MOVE  WK-HKNJANUM-TBL  TO  WK-HKNJANUM2-TBL
             END-IF
           END-IF
      *
           MOVE    ZERO   TO   FLG-RUITAISYO
           EVALUATE  FLG-TOKU75
             WHEN        1
             WHEN        2
                 IF    COMB-HKNNUM    = "039"
                   IF  SYU-SYUHKNNUM  = "039"
                     IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                          MOVE    1    TO   FLG-RUITAISYO
                     END-IF
                   END-IF
                 ELSE
                   IF  FLG-TOKU75     =   1
                     IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                          MOVE    1    TO   FLG-RUITAISYO
                     END-IF
                   ELSE
                     IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                       IF ((WK-TOKU75-BIRTHDAY <= LNK-SYU-SRYYMD) AND
                           (WK-TOKU75-BIRTHDAY <= SYU-SRYYMD    ))
                       OR ((WK-TOKU75-BIRTHDAY >  LNK-SYU-SRYYMD) AND
                           (WK-TOKU75-BIRTHDAY >  SYU-SRYYMD    ))
                          MOVE    1    TO   FLG-RUITAISYO
                       ELSE
                          MOVE   "9"   TO   WK-HONKZKKBN2
                          MOVE  SPACE  TO   WK-KIGO2
                          MOVE  SPACE  TO   WK-NUM2
                       END-IF
                     END-IF
                   END-IF
                 END-IF
             WHEN        3
                 IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                   IF ((WK-TOKU75-BIRTHDAY <= LNK-SYU-SRYYMD) AND
                       (WK-TOKU75-BIRTHDAY <= SYU-SRYYMD    ))
                   OR ((WK-TOKU75-BIRTHDAY >  LNK-SYU-SRYYMD) AND
                       (WK-TOKU75-BIRTHDAY >  SYU-SRYYMD    ))
                      MOVE    1    TO   FLG-RUITAISYO
                   ELSE
                      MOVE   "9"   TO   WK-HONKZKKBN2
                      MOVE  SPACE  TO   WK-KIGO2
                      MOVE  SPACE  TO   WK-NUM2
                   END-IF
                 END-IF
           END-EVALUATE
      *
           IF     COMB-HKNNUM      =   "039"
             CONTINUE
           ELSE
             MOVE   WK-HKNJANUM2-TBL  TO  WK-HKNJANUM3-TBL
           END-IF
      *
           IF  (FLG-GENBUTU70    NOT =  ZERO)
           AND (FLG-OITA-GENBUTU70   =  ZERO)
               IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                 IF  ((SYU-SRYYMD  <  WK-GEN70-YMD   ) AND
                      (SYU-SKJ-FTNGAKU(2)     = ZERO ))
                 OR  ((SYU-SRYYMD  >  WK-GEN70-YMD-ED) AND
                      (SYU-SKJ-FTNGAKU(2)     = ZERO ))
                 OR  ((SYU-SKJ-FTNGAKU(2) NOT = ZERO ) AND
                      (SYU-SKJ-FTNGAKU(2) NOT =
                             LNK-SYU-SKJ-FTNGAKU(2)  ))
                    MOVE   "9"   TO   WK-HONKZKKBN2
                    MOVE  SPACE  TO   WK-KIGO2
                    MOVE  SPACE  TO   WK-NUM2
                 END-IF
                 IF    FLG-GENBUTU-CHECK =  1
                   IF   (COMB-HKNID    NOT =  ZERO              )
                   AND  (COMB-HKNID        =  WRK-COMB-HKNID    )
                   AND  (LNK-SYU-SKJ-FTNGAKU(2)
                                       NOT =  SYU-SKJ-FTNGAKU(2))
                      MOVE    1    TO   FLG-GENBUTU-CHECK-ERR
                   END-IF
                   IF   (SYU-SKJ-FTNGAKU(2)   =  ZERO           )
                   AND  (WK-GEN70-YMD        <=  SYU-SRYYMD     )
                   AND  (SYU-SRYYMD          <=  WK-GEN70-YMD-ED)
                      MOVE    1    TO   FLG-GENBUTU-CHECK-ERR
                   END-IF
                 END-IF
               END-IF
           END-IF
      ***  IF  FLG-KOUREI-KBN              =  "1"
           IF  LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"
               IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                 IF   (SYU-SKJ-FTNGAKU(2) NOT = ZERO)
                 AND  (SYU-SKJ-FTNGAKU(2) NOT =
                             LNK-SYU-SKJ-FTNGAKU(2) )
                    MOVE   "9"   TO   WK-HONKZKKBN2
                    MOVE  SPACE  TO   WK-KIGO2
                    MOVE  SPACE  TO   WK-NUM2
                 END-IF
                 IF    FLG-GENBUTU-CHECK =  1
                   IF   (COMB-HKNID    NOT =  ZERO              )
                   AND  (COMB-HKNID        =  WRK-COMB-HKNID    )
                   AND  (LNK-SYU-SKJ-FTNGAKU(2)
                                       NOT =  SYU-SKJ-FTNGAKU(2))
                      MOVE    1    TO   FLG-GENBUTU-CHECK-ERR
                   END-IF
                 END-IF
               END-IF
           END-IF
           IF  ( LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"  )
           OR  ( FLG-KOUREI-KBN              =  "1"  )
           OR  ((FLG-GENBUTU70           NOT =  ZERO) AND
                (FLG-OITA-GENBUTU70          =  ZERO))
               CONTINUE
           ELSE
               IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                 IF    SYU-SKJ-FTNGAKU(2) NOT = ZERO
                    MOVE   "9"   TO   WK-HONKZKKBN2
                    MOVE  SPACE  TO   WK-KIGO2
                    MOVE  SPACE  TO   WK-NUM2
                 END-IF
               END-IF
           END-IF
      *
           IF     COMB-HKNNUM      =   "039"
      ***    IF  FLG-KOUREI-KBN              =  "1"
             IF  LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"
               IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM5-TBL
                 IF   (SYU-SKJ-FTNGAKU(2) NOT = ZERO)
                 AND  (SYU-SKJ-FTNGAKU(2) NOT =
                             LNK-SYU-SKJ-FTNGAKU(2) )
                    MOVE   "9"   TO   WK-HONKZKKBN5
                    MOVE  SPACE  TO   WK-KIGO5
                    MOVE  SPACE  TO   WK-NUM5
                 END-IF
               END-IF
             END-IF
             MOVE   WK-HKNJANUM5-TBL  TO  WK-HKNJANUM4-TBL
           ELSE
             MOVE   WK-HKNJANUM2-TBL  TO  WK-HKNJANUM4-TBL
           END-IF
      *
           MOVE      ZERO        TO  FLG-KEISAN-TAI2
           IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM4-TBL
               MOVE     1        TO  FLG-KEISAN-TAI2
           END-IF
      *
      ***
      *
      *    保険組み合わせ適用開始日チェック
           MOVE      SYU-SRYYMD(1:6)        TO   WK-CHECK2-TEKYM
           IF   WRK-COMB-TEKSTYMD(1:6)  >=  SYU-SRYYMD(1:6)
              MOVE   WRK-COMB-TEKSTYMD(7:2) TO   WK-CHECK2-TEKDD
           ELSE
              MOVE   01                     TO   WK-CHECK2-TEKDD
           END-IF
      *
           .
      *
       2202B-SYUNOU-HKN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    長期の判定
      ******************************************************************
       2202C-CYOKI-HANTEI-SEC          SECTION.
      *
           IF  ( WK-HKNJANUM-TBL   =   WK-HKNJANUM2-TBL)
           AND ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                (COMB-KOH4HKNNUM   =  "972" OR "974")  )
           AND ( SYU-KOH1HKNNUM    =  "972" OR "974"   )
           AND ( SYU-KOH2HKNNUM    =   SPACE           )
           AND ( SYU-KOH3HKNNUM    =   SPACE           )
           AND ( SYU-KOH4HKNNUM    =   SPACE           )
           AND ( LNK-SYU-TOTAL-HKNTEN     NOT = ZERO   )
           AND ( SYU-TOTAL-HKNTEN         NOT = ZERO   )
           AND ( LNK-SYU-SRYYMD(1:6)  >=  "201204"     )
             IF ((COMB-KOH2HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH2ID         =  WRK-COMB-KOH1ID))
             OR ((COMB-KOH3HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH3ID         =  WRK-COMB-KOH1ID))
             OR ((COMB-KOH4HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH4ID         =  WRK-COMB-KOH1ID))
               IF   WK-CHECK-TEKYMD  >  WK-CHECK2-TEKYMD
                 IF   LNK-S01-SAIKEISAN-KBN   =   SPACE
                   IF  (LNK-SYU-SRYYMD      NOT = SPACE)
                   AND (LNK-SYU-SRYYMD   <  SYU-SRYYMD )
                     MOVE   "1"    TO  LNK-SYU-KOHTAIYKZKBN
                   END-IF
                 ELSE
                   IF ((LNK-SYU-SRYYMD      NOT = SPACE) AND
                       (LNK-SYU-SRYYMD   <  SYU-SRYYMD ))
                   OR ((LNK-SYU-SRYYMD      NOT = SPACE) AND
                       (LNK-SYU-SRYYMD   =  SYU-SRYYMD ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO) AND
                       (LNK-SYU-DENPNUM  <  SYU-DENPNUM))
                     MOVE   "1"    TO  LNK-SYU-KOHTAIYKZKBN
                   END-IF
                 END-IF
               ELSE
                     MOVE   "1"    TO  LNK-SYU-KOHTAIYKZKBN
               END-IF
               IF   SYU-NYNSHOKAISU  =   8
                     MOVE   "1"    TO  LNK-SYU-KOHTAIYKZKBN
               END-IF
             END-IF
           END-IF
      *
           IF  ( WK-HKNJANUM-TBL   =   WK-HKNJANUM2-TBL)
           AND ( COMB-KOH1HKNNUM   =  "972" OR "974"   )
           AND ( COMB-KOH2HKNNUM   =   SPACE           )
           AND ( COMB-KOH3HKNNUM   =   SPACE           )
           AND ( COMB-KOH4HKNNUM   =   SPACE           )
           AND ((SYU-KOH2HKNNUM    =  "972" OR "974") OR
                (SYU-KOH3HKNNUM    =  "972" OR "974") OR
                (SYU-KOH4HKNNUM    =  "972" OR "974")  )
           AND ( LNK-SYU-TOTAL-HKNTEN     NOT = ZERO   )
           AND ( SYU-TOTAL-HKNTEN         NOT = ZERO   )
           AND ( LNK-SYU-SRYYMD(1:6)  >=  "201204"     )
             IF ((COMB-KOH1HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
             OR ((COMB-KOH1HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
             OR ((COMB-KOH1HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
               IF   WK-CHECK-TEKYMD  <  WK-CHECK2-TEKYMD
                 IF   LNK-S01-SAIKEISAN-KBN   =   SPACE
                   IF  (LNK-SYU-SRYYMD      NOT = SPACE)
                   AND (LNK-SYU-SRYYMD   <  SYU-SRYYMD )
                     CONTINUE
                   ELSE
                     MOVE   "1"    TO  LNK-SYU-KOHTAIYKZKBN
                   END-IF
                 ELSE
                   IF ((LNK-SYU-SRYYMD      NOT = SPACE) AND
                       (LNK-SYU-SRYYMD   <  SYU-SRYYMD ))
                   OR ((LNK-SYU-SRYYMD      NOT = SPACE) AND
                       (LNK-SYU-SRYYMD   =  SYU-SRYYMD ) AND
                       (LNK-SYU-DENPNUM     NOT =  ZERO) AND
                       (LNK-SYU-DENPNUM  <  SYU-DENPNUM))
                     CONTINUE
                   ELSE
                     MOVE   "1"    TO  LNK-SYU-KOHTAIYKZKBN
                   END-IF
                 END-IF
               ELSE
                     MOVE   "1"    TO  LNK-SYU-KOHTAIYKZKBN
               END-IF
             END-IF
           END-IF
      *
      *****
      *
           IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                (COMB-KOH4HKNNUM   =  "972" OR "974"))
           AND ((SYU-KOH2HKNNUM    =  "972" OR "974") OR
                (SYU-KOH3HKNNUM    =  "972" OR "974") OR
                (SYU-KOH4HKNNUM    =  "972" OR "974"))
               MOVE  "99999999"  TO  WK-CHECK2-TEKYMD
           END-IF
      *
           IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                (COMB-KOH4HKNNUM   =  "972" OR "974"))
           AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
           AND ( SYU-KOH2HKNNUM    =   SPACE         )
           AND ( SYU-KOH3HKNNUM    =   SPACE         )
           AND ( SYU-KOH4HKNNUM    =   SPACE         )
             IF   WK-CHECK-TEKYMD  >  WK-CHECK2-TEKYMD
               IF   LNK-S01-SAIKEISAN-KBN   =   SPACE
                 IF  (LNK-SYU-SRYYMD      NOT = SPACE)
                 AND (LNK-SYU-SRYYMD   <  SYU-SRYYMD )
                   MOVE  "99999999"  TO  WK-CHECK2-TEKYMD
                 END-IF
               ELSE
                 IF ((LNK-SYU-SRYYMD      NOT = SPACE) AND
                     (LNK-SYU-SRYYMD   <  SYU-SRYYMD ))
                 OR ((LNK-SYU-SRYYMD      NOT = SPACE) AND
                     (LNK-SYU-SRYYMD   =  SYU-SRYYMD ) AND
                     (LNK-SYU-DENPNUM     NOT =  ZERO) AND
                     (LNK-SYU-DENPNUM  <  SYU-DENPNUM))
                   MOVE  "99999999"  TO  WK-CHECK2-TEKYMD
                 END-IF
               END-IF
             END-IF
             IF   SYU-NYNSHOKAISU  =   8
                   MOVE  "99999999"  TO  WK-CHECK2-TEKYMD
             END-IF
           END-IF
      *
           IF  ( COMB-KOH1HKNNUM        =  "972" OR "974" )
           AND ( COMB-KOH2HKNNUM        =   SPACE         )
           AND ( COMB-KOH3HKNNUM        =   SPACE         )
           AND ( COMB-KOH4HKNNUM        =   SPACE         )
           AND ((SYU-KOH2HKNNUM         =  "972" OR "974") OR
                (SYU-KOH3HKNNUM         =  "972" OR "974") OR
                (SYU-KOH4HKNNUM         =  "972" OR "974"))
             IF   WK-CHECK-TEKYMD  <  WK-CHECK2-TEKYMD
               IF   LNK-S01-SAIKEISAN-KBN   =   SPACE
                 IF  (LNK-SYU-SRYYMD      NOT = SPACE)
                 AND (LNK-SYU-SRYYMD   <  SYU-SRYYMD )
                   CONTINUE
                 ELSE
                   MOVE    8     TO  LNK-SYU-NYNSHOKAISU
                 END-IF
               ELSE
                 IF ((LNK-SYU-SRYYMD      NOT = SPACE) AND
                     (LNK-SYU-SRYYMD   <  SYU-SRYYMD ))
                 OR ((LNK-SYU-SRYYMD      NOT = SPACE) AND
                     (LNK-SYU-SRYYMD   =  SYU-SRYYMD ) AND
                     (LNK-SYU-DENPNUM     NOT =  ZERO) AND
                     (LNK-SYU-DENPNUM  <  SYU-DENPNUM))
                   CONTINUE
                 ELSE
                   MOVE    8     TO  LNK-SYU-NYNSHOKAISU
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
      *
       2202C-CYOKI-HANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *    現物給付対象者の特別計算（高齢者）の編集
      ******************************************************************
       2202D-GNBKEIKBN-K-HENSYU-SEC          SECTION.
      *
           IF ((WK-1039-IKTSORTKBN     =  "0" OR SPACE) AND
               (LNK-S01-SAIKEISAN-KBN  =  "1"         ) AND
               (LNK-SYU-DENPNUM    NOT =  ZERO        ) AND
               (LNK-SYU-DENPNUM    <  SYU-DENPNUM     ))
           OR ((WK-1039-IKTSORTKBN     =  "1"         ) AND
               (LNK-SYU-SRYYMD     NOT =  SPACE       ) AND
               (LNK-SYU-SRYYMD     <  SYU-SRYYMD      ))
           OR ((WK-1039-IKTSORTKBN     =  "1"         ) AND
               (LNK-S01-SAIKEISAN-KBN  =  "1"         ) AND
               (LNK-SYU-SRYYMD     NOT =  SPACE       ) AND
               (LNK-SYU-SRYYMD     =  SYU-SRYYMD      ) AND
               (LNK-SYU-DENPNUM    NOT =  ZERO        ) AND
               (LNK-SYU-DENPNUM    <  SYU-DENPNUM     ))
           OR ( SYU-KOH1HKNNUM     =  "972" OR "974"   )
           OR ( SYU-KOH2HKNNUM     =  "972" OR "974"   )
           OR ( SYU-KOH3HKNNUM     =  "972" OR "974"   )
           OR ( SYU-KOH4HKNNUM     =  "972" OR "974"   )
           OR ((IDX19                  =  5           ) AND
               (SYU-KOH1HKNNUM     NOT =  SPACE       ) AND
               (SYU-SKJ-FTNGAKU(3) NOT =  8           ))
               CONTINUE
           ELSE
               MOVE     ZERO       TO    WK-KEISAN-FTNRATE
               EVALUATE   COMB-HOJOKBN
                 WHEN   "1"
                 WHEN   "4"
                 WHEN   "9"
                   MOVE     10     TO    WK-KEISAN-FTNRATE
                   IF  FLG-SANSHOU3   =   SPACE
                      MOVE   2     TO    WK-GNBKEIKBN-K-KBN(IDX19)
                   ELSE
                      MOVE   3     TO    WK-GNBKEIKBN-K-KBN(IDX19)
                   END-IF
                 WHEN   "2"
                 WHEN   "5"
                 WHEN   "8"
                   MOVE     20     TO    WK-KEISAN-FTNRATE
                   IF  FLG-SANSHOU3   =   SPACE
                      MOVE   2     TO    WK-GNBKEIKBN-K-KBN(IDX19)
                   ELSE
                      MOVE   3     TO    WK-GNBKEIKBN-K-KBN(IDX19)
                   END-IF
                 WHEN   "3"
                 WHEN   "6"
                 WHEN   "7"
                   MOVE     30     TO    WK-KEISAN-FTNRATE
                   IF   FLG-KEIKASOCHI-IPAN  =  1
                      MOVE   2     TO    WK-GNBKEIKBN-K-KBN(IDX19)
                   ELSE
                      MOVE   1     TO    WK-GNBKEIKBN-K-KBN(IDX19)
                   END-IF
               END-EVALUATE
               COMPUTE  WK-FUTANWARI  =  WK-KEISAN-FTNRATE  /  100
               COMPUTE  WK-TOTAL-KINGAKU2 =
                        SYU-TOTAL-HKNTEN  * 10 * WK-FUTANWARI
               COMPUTE  WK-TOTAL-KINGAKU2 =
                        WK-TOTAL-KINGAKU2 +  5
               COMPUTE  WK-TOTAL-KINGAKU2 =
                        WK-TOTAL-KINGAKU2 / 10
               COMPUTE  WK-TOTAL-KINGAKU2 =
                        WK-TOTAL-KINGAKU2 * 10
               COMPUTE  WK-TOTAL-KINGAKU2-EN =
                        SYU-TOTAL-HKNTEN  * 10 * WK-FUTANWARI
               ADD  WK-TOTAL-KINGAKU2
                                  TO  WK-GNBKEIKBN-K-KIN(IDX19)
               ADD  WK-TOTAL-KINGAKU2-EN
                                  TO  WK-GNBKEIKBN-K-KIN-EN(IDX19)
               IF  (IDX19                  =  5    )
               AND (SYU-KOH1HKNNUM     NOT =  SPACE)
               AND (SYU-SKJ-FTNGAKU(3)     =  8    )
                    MOVE    1     TO  WK-GNBKEIKBN-K-FLG(IDX19)
               END-IF
           END-IF
      *
           .
      *
       2202D-GNBKEIKBN-K-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    月上限額のある全国公費の一部負担金退避編集
      ******************************************************************
       2202E-JGNKOH-TAIHI-HENSYU-SEC          SECTION.
      *
           IF  SYU-NYUGAIKBN = "1"
                   IF    SYU-KOH1HKNFTNMONEY  NOT = ZERO
                   OR    SYU-KOH1COMPFTN      NOT = ZERO
                     MOVE  9999999       TO  WK-TAIHI-NYUINFTN(1)
                   END-IF
           ELSE
             IF  WK-HKNJANUM3-TBL = WK-HKNJANUM-TBL
               IF   (LNK-S01-SAIKEISAN-KBN      =  "1" )
               AND  (LNK-S01-IKTKEISANKBN   NOT =  "1" )
               AND  (LNK-SYU-DENPNUM        NOT =  ZERO)
               AND  (LNK-SYU-DENPNUM   <    SYU-DENPNUM)
                   IF     SYU-KOH1HKNFTNMONEY   NOT = ZERO
                   OR     SYU-KOH1COMPFTN       NOT = ZERO
                     MOVE  9999999       TO  WK-TAIHI-GAIRAIFTN(1)
                   END-IF
               ELSE
                 IF  LNK-SYU-SRYYMD    <    SYU-SRYYMD
                   IF     SYU-KOH1HKNFTNMONEY   NOT = ZERO
                   OR     SYU-KOH1COMPFTN       NOT = ZERO
                     MOVE  9999999       TO  WK-TAIHI-GAIRAIFTN(1)
                   END-IF
                 ELSE
                   IF  (  SYU-KOH1HKNFTNMONEY   NOT = ZERO         )
                   AND (( WK-TAIHI-GAIRAIDAY(1)     = SPACE       ) OR
                        ((WK-TAIHI-GAIRAIDAY(1) NOT = SPACE      ) AND
                         (WK-TAIHI-GAIRAIDAY(1) < SYU-SRYYMD(7:2))))
                     MOVE  SYU-SRYYMD(7:2)
                                         TO  WK-TAIHI-GAIRAIDAY(1)
                   END-IF
                 END-IF
               END-IF
             ELSE
                   IF     SYU-KOH1HKNFTNMONEY   NOT = ZERO
                   OR     SYU-KOH1COMPFTN       NOT = ZERO
                     MOVE  9999999       TO  WK-TAIHI-GAIRAIFTN(1)
                   END-IF
             END-IF
           END-IF
      *
           .
      *
       2202E-JGNKOH-TAIHI-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    診療済みの第三者行為の現物給付対象チェック
      ******************************************************************
       2202F-DAISAN-GENBUTU-CHECK-SEC          SECTION.
      *
           INITIALIZE                     PTRSIINF-REC
           MOVE    WRK-COMB-HOSPNUM  TO   PTRSI-HOSPNUM
           MOVE    WRK-COMB-PTID     TO   PTRSI-PTID
           MOVE    WRK-COMB-KOH1ID   TO   PTRSI-KOHID
           MOVE    PTRSIINF-REC      TO   MCPDATA-REC
           MOVE    "DBSELECT"        TO   MCP-FUNC
           MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
           MOVE    "key"             TO   MCP-PATHNAME
           CALL    "ORCDBMAIN"       USING   MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_ptrsiinf"  TO   MCP-TABLE
             MOVE    "key"           TO   MCP-PATHNAME
             PERFORM  PTRSIINF-READ-SEC
             IF    FLG-PTRSIINF     =  ZERO
      *        現物給付対象とする
               IF     PTRSI-DAISAN-GENBTKBN  =  "2"
                  MOVE     1         TO   FLG-DAISAN-GENBUTU2
               END-IF
             END-IF
           END-IF
           MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
           MOVE    "key"             TO   MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           .
      *
       2202F-DAISAN-GENBUTU-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *        主保険の減額（＋＠）                                    *
      *        全国公費の減額（＋＠）                                  *
      ******************************************************************
       2203-KOHFTN-KINGAKU-GEN2-SEC           SECTION.
      *
           IF  FLG-GENBUTU70   NOT =   ZERO
             IF  (FLG-IRYOHI70   NOT =  ZERO)
             AND (MAX-KIN-SYU-M  NOT =  ZERO)
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-SYU-M       =
                                 (MAX-KIN-SYU-M       *
                                  WK-GENGAKU-RITUX    /
                                  100) + 0.5
                       END-IF
                    WHEN          2
                       IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  MAX-KIN-SYU-M  =
                                  MAX-KIN-SYU-M  -
                                  WK-GENGAKU-KIN
                       END-IF
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-SYU-M
                    WHEN          5
                       IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                         COMPUTE  MAX-KIN-SYU-M  =
                                  WK-GENGAKU-KIN
                       END-IF
                  END-EVALUATE
                  IF   MAX-KIN-SYU-M  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-GEN70
                  END-IF
             END-IF
             IF  (FLG-IRYOHI70K    =  1  OR  2)
             AND (MAX-KIN-KOHI1-M  NOT =  ZERO)
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-KOHI1-M     =
                                 (MAX-KIN-KOHI1-M     *
                                  WK-GENGAKU-RITUX    /
                                  100) + 0.5
                       END-IF
                    WHEN          2
                       IF  MAX-KIN-KOHI1-M < WK-GENGAKU-KIN
                         MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                       ELSE
                         COMPUTE  MAX-KIN-KOHI1-M  =
                                  MAX-KIN-KOHI1-M  -
                                  WK-GENGAKU-KIN
                       END-IF
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                    WHEN          5
                       IF  MAX-KIN-KOHI1-M > WK-GENGAKU-KIN
                         COMPUTE  MAX-KIN-KOHI1-M  =
                                  WK-GENGAKU-KIN
                       END-IF
                  END-EVALUATE
                  IF   MAX-KIN-KOHI1-M  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-GEN70K
                  END-IF
             END-IF
             IF  (FLG-IRYOHI70K           =  1  OR  2)
             AND (MAX-KIN-KOHI1-M-TOKU75  NOT =  ZERO)
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-KOHI1-M-TOKU75
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-KOHI1-M-TOKU75     =
                                 (MAX-KIN-KOHI1-M-TOKU75     *
                                  WK-GENGAKU-RITUX    /
                                  100) + 0.5
                       END-IF
                    WHEN          2
                       IF  MAX-KIN-KOHI1-M-TOKU75 < WK-GENGAKU-KIN
                         MOVE   ZERO   TO   MAX-KIN-KOHI1-M-TOKU75
                       ELSE
                         COMPUTE  MAX-KIN-KOHI1-M-TOKU75  =
                                  MAX-KIN-KOHI1-M-TOKU75  -
                                  WK-GENGAKU-KIN
                       END-IF
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-KOHI1-M-TOKU75
                    WHEN          5
                       IF  MAX-KIN-KOHI1-M-TOKU75 > WK-GENGAKU-KIN
                         COMPUTE  MAX-KIN-KOHI1-M-TOKU75  =
                                  WK-GENGAKU-KIN
                       END-IF
                  END-EVALUATE
                  IF   MAX-KIN-KOHI1-M-TOKU75  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-GEN70K-TOKU75
                  END-IF
             END-IF
           ELSE
             IF  (FLG-IRYOHI       =  1       )
             AND (MAX-KIN-KOHI1-M  NOT =  ZERO)
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-KOHI1-M     =
                                 (MAX-KIN-KOHI1-M     *
                                  WK-GENGAKU-RITUX    /
                                  100) + 0.5
                       END-IF
                    WHEN          2
                       IF  MAX-KIN-KOHI1-M < WK-GENGAKU-KIN
                         MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                       ELSE
                         COMPUTE  MAX-KIN-KOHI1-M  =
                                  MAX-KIN-KOHI1-M  -
                                  WK-GENGAKU-KIN
                       END-IF
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                    WHEN          5
                       IF  MAX-KIN-KOHI1-M > WK-GENGAKU-KIN
                         COMPUTE  MAX-KIN-KOHI1-M  =
                                  WK-GENGAKU-KIN
                       END-IF
                  END-EVALUATE
                  IF   MAX-KIN-KOHI1-M  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-JIRITU
                  END-IF
             END-IF
             IF  ((FLG-IRYOHIKG   NOT =  ZERO) OR
                  (FLG-IRYOHIKG2  NOT =  ZERO))
             AND ( MAX-KIN-SYU-M  NOT =  ZERO )
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-SYU-M       =
                                 (MAX-KIN-SYU-M       *
                                  WK-GENGAKU-RITUX    /
                                  100) + 0.5
                       END-IF
                    WHEN          2
                       IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  MAX-KIN-SYU-M  =
                                  MAX-KIN-SYU-M  -
                                  WK-GENGAKU-KIN
                       END-IF
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-SYU-M
                    WHEN          5
                       IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                         COMPUTE  MAX-KIN-SYU-M  =
                                  WK-GENGAKU-KIN
                       END-IF
                  END-EVALUATE
                  IF   MAX-KIN-SYU-M  =  ZERO
                     IF   FLG-IRYOHIKG   NOT =  ZERO
                       MOVE     ZERO   TO   FLG-KOUGAKUCYO
                     END-IF
                     IF   FLG-IRYOHIKG2  NOT =  ZERO
                       MOVE     ZERO   TO   FLG-KOUGAKUCYO3
                     END-IF
                  END-IF
             END-IF
           END-IF
      *
           .
      *
       2203-KOHFTN-KINGAKU-GEN2-EXT.
           EXIT.
      *
      ******************************************************************
      *    日・月上限額負担計算区分編集
      ******************************************************************
       2204-JGNFTNKBN-HENSYU-SEC          SECTION.
      *
           PERFORM   VARYING   KOHFUKA-IDX2   FROM   1   BY   1
                      UNTIL    KOHFUKA-IDX2    >     4
      *
             IF    (LNK-SYU-KOH-HKNNUM(KOHFUKA-IDX2)(1:1)
                                               >= "1" AND <= "8")
             AND   (WK-KOHJGNGET-TAISYOKBN(KOHFUKA-IDX2)   =  2 )
                  MOVE    KOHFUKA-IDX2     TO  FLG-NYUGAI2
             ELSE
               IF  (LNK-SYU-KOH-HKNNUM(KOHFUKA-IDX2)(1:1)
                                               >= "1" AND <= "8")
               AND (LNK-SYU-SRYYMD(1:6)        >= "201010"      )
                  EVALUATE  WK-2010-JGNFTNKBN(KOHFUKA-IDX2)
                    WHEN      "1"
                         MOVE  KOHFUKA-IDX2  TO  FLG-NYUGAI2
                  END-EVALUATE
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
      *
       2204-JGNFTNKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    各種フラグ編集
      ******************************************************************
       2205-FLG-HENSYU-SEC          SECTION.
      *
           IF  (WK-1001-PREFNUM  =  13           )
           AND (COMB-HKNNUM      = "060" OR "067")
           AND (COMB-KOH1HKNNUM  = "588"         )
           AND (LNK-SYU-SRYYMD(1:6) >= "200710"  )
           AND (LNK-SYU-SRYYMD(1:6) <= "200909"  )
              IF (FLG-GENBUTU70    NOT =   ZERO)
              OR (FLG-TOKU75-CYO       =    3  )
              OR (FLG-CYOKI-ARI        =    2  )
                   MOVE    2    TO   FLG-MARUKO
              END-IF
           END-IF
      *
           IF  (WK-2010-NINNASIKBN(1)  NOT = SPACE)
           OR  (WK-2010-NINJYOKBN(1)   NOT = SPACE)
              IF ((FLG-IRYOHI70        =  ZERO) AND
                  (FLG-KOHYONKAIME     =   1  ) AND
                  (FLG-OITA-GENBUTU70  =  ZERO) AND
                  (FLG-GENBUTU70       =   1  ))
              OR ((FLG-IRYOHI70        =  ZERO) AND
                  (FLG-OITA-GENBUTU70  =   1  ) AND
                  (FLG-GENBUTU70   =  2 OR 3  ))
                   MOVE    1    TO   FLG-OITA-SYUKEI
              END-IF
           END-IF
      *
           IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
             IF   (FLG-TOKU75-CYO   =   1 OR 2 OR 3  )
             OR   (FLG-CYOKI-ARI    =   1 OR 2       )
             OR   (LNK-S01-KOUREI-ZAITAKU-KBN  = "1" )
             OR   (FLG-GENBUTU70   NOT =  ZERO       )
               IF   WK-2010-KINJYOKBN-G(1) = "1"
                 MOVE    1    TO   FLG-TOKYO
               END-IF
             END-IF
             IF   (LNK-S01-KOUREI-ZAITAKU-KBN  = "1" )
             AND  (LNK-SYU-KOH1HKNNUM  =  "027"      )
               IF   WK-2010-KINJYOKBN-G(2) = "1"
                 MOVE    2    TO   FLG-TOKYO
               END-IF
             END-IF
           END-IF
      *
           IF   LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (WK-2010-IRYOKEIKBN-G(1)
                                        NOT = SPACE          )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
      ***        IF   WK-2010-IRYOKEIKBN-G-XXX(1) = "1"
      ***          IF  (WK-1001-PREFNUM     =   11      )
      ***          AND (LNK-SYU-KOH1HKNNUM  =
      ***                        "542" OR "682" OR "562" OR
      ***                        "462" OR "662" OR "762")
      ***            MOVE    1    TO   FLG-GEN70-TOKUSYU
      ***          END-IF
      ***        ELSE
                     MOVE    1    TO   FLG-GEN70-TOKUSYU
      ***        END-IF
              END-IF
           END-IF
      *
           IF   FLG-GENBUTU70         NOT =  ZERO
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (WK-2010-IRYOKEIKBN-G(1)
                                        NOT = SPACE          )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
                     MOVE    1    TO   FLG-GEN70-TOKUSYU
              END-IF
           END-IF
      *
           IF  (COMB-HKNNUM         NOT =  SPACE)
           AND (WK-2010-ZENKEIKBN-G(2)  =  "1"  )
                IF ( LNK-SYU-KOH-HKNNUM(1) =
                     "015" OR "016" OR "021" OR "024" OR
                     "038" OR "051" OR "052" OR "079"    )
                OR ((LNK-SYU-KOH-HKNNUM(1) = "054"      ) AND
                    (LNK-SYU-SRYYMD(1:6)  >= "201501"   ))
                OR ( WK-TOKATUKAI(1)       =   1         )
                OR ((WK-1001-PREFNUM       =  13        ) AND
                    (LNK-SYU-KOH-HKNNUM(1) =
                     "183" OR "283" OR "383" OR "483"   ))
                   MOVE    1    TO   FLG-RUIKEIYO
                END-IF
           END-IF
      *
           IF  (LNK-SYU-SRYYMD(1:6)  >= "200904")
           AND (COMB-HKNNUM       NOT =  SPACE  )
           AND (COMB-KOH2HKNNUM   NOT =  SPACE  )
                IF   WK-2010-KINJYOKBN-G(1) = "1"
                   MOVE    1    TO   FLG-RUIKEIYO
                END-IF
           END-IF
      *
           IF   (LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"      )
           AND  (COMB-KOH1HKNNUM   NOT =  "972" AND "974")
           AND  (COMB-KOH2HKNNUM   NOT =  "972" AND "974")
           AND  (COMB-KOH3HKNNUM   NOT =  "972" AND "974")
           AND  (COMB-KOH4HKNNUM   NOT =  "972" AND "974")
           AND  (LNK-SYU-SRYYMD(1:6)        >=  "201204" )
              IF  (( WK-2010-GNBKEIKBN-K-G(1)  =  "2" ) AND
                   ((MAX-KIN-KOHI1-D  NOT =  ZERO) OR
                    (MAX-KIN-KOHI1-K  NOT =  ZERO)    ))
              OR  (( WK-2010-GNBKEIKBN-K-G(2)  =  "2" ) AND
                   ((MAX-KIN-KOHI2-D  NOT =  ZERO) OR
                    (MAX-KIN-KOHI2-K  NOT =  ZERO)    ))
              OR  (( WK-2010-GNBKEIKBN-K-G(3)  =  "2" ) AND
                   ((MAX-KIN-KOHI3-D  NOT =  ZERO) OR
                    (MAX-KIN-KOHI3-K  NOT =  ZERO)    ))
              OR  (( WK-2010-GNBKEIKBN-K-G(4)  =  "2" ) AND
                   ((MAX-KIN-KOHI4-D  NOT =  ZERO) OR
                    (MAX-KIN-KOHI4-K  NOT =  ZERO)    ))
                     MOVE    8    TO   LNK-SYU-SKJ-FTNGAKU(3)
              END-IF
           END-IF
      *
           .
      *
       2205-FLG-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    保険・公費の負担金計算
      ******************************************************************
       230-FTNKIN-SEC           SECTION.
      *
      *    算定可能フラグの初期化
           MOVE     SPACE                  TO     FLG-SANTEI1
                                                  FLG-SANTEI2
                                                  FLG-SANTEI3
                                                  FLG-SANTEI4.
      *
      *    過去の患者負担回数と上限回数の比較
           IF       MAX-KAI-KOHI1-D        NOT =  ZERO
               IF   KAISU-KOHI1-D          >=     MAX-KAI-KOHI1-D
                    MOVE     "1"           TO     FLG-SANTEI1
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI2-D        NOT =  ZERO
               IF   KAISU-KOHI2-D          >=     MAX-KAI-KOHI2-D
                    MOVE     "1"           TO     FLG-SANTEI2
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI3-D        NOT =  ZERO
               IF   KAISU-KOHI3-D          >=     MAX-KAI-KOHI3-D
                    MOVE     "1"           TO     FLG-SANTEI3
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI4-D        NOT =  ZERO
               IF   KAISU-KOHI4-D          >=     MAX-KAI-KOHI4-D
                    MOVE     "1"           TO     FLG-SANTEI4
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI1-M        NOT =  ZERO
               IF   KAISU-KOHI1-M          >=     MAX-KAI-KOHI1-M
                    MOVE     "1"           TO     FLG-SANTEI1
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI2-M        NOT =  ZERO
               IF   KAISU-KOHI2-M          >=     MAX-KAI-KOHI2-M
                    MOVE     "1"           TO     FLG-SANTEI2
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI3-M        NOT =  ZERO
               IF   KAISU-KOHI3-M          >=     MAX-KAI-KOHI3-M
                    MOVE     "1"           TO     FLG-SANTEI3
               END-IF
           END-IF.
           IF       MAX-KAI-KOHI4-M        NOT =  ZERO
               IF   KAISU-KOHI4-M          >=     MAX-KAI-KOHI4-M
                    MOVE     "1"           TO     FLG-SANTEI4
               END-IF
           END-IF.
      *
      *    過去の患者保険負担累計額と上限金額の比較
      *
      ***     IF       MAX-KIN-KOHI1-D        NOT =  ZERO
      ***         IF   FTN-KOHI1-D            >=     MAX-KIN-KOHI1-D
      ***              MOVE     "1"           TO     FLG-SANTEI1
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI2-D        NOT =  ZERO
      ***         IF   FTN-KOHI2-D            >=     MAX-KIN-KOHI2-D
      ***              MOVE     "1"           TO     FLG-SANTEI2
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI3-D        NOT =  ZERO
      ***         IF   FTN-KOHI3-D            >=     MAX-KIN-KOHI3-D
      ***              MOVE     "1"           TO     FLG-SANTEI3
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI4-D        NOT =  ZERO
      ***         IF   FTN-KOHI4-D            >=     MAX-KIN-KOHI4-D
      ***              MOVE     "1"           TO     FLG-SANTEI4
      ***         END-IF
      ***     END-IF.
      *
      *----(01.00.23) LINE ADD START --------------------------
      *平成１４年１０月改正対応
      *高齢者の在宅総合・在宅末期算定患者
      *
           IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1")
           OR  (FLG-KOHININBARAI             =    1 )
           OR  (FLG-GENBUTU70            NOT =  ZERO)
           OR  (FLG-TOKU75-CYO         = 1 OR 2 OR 3)
           OR  (FLG-CYOKI-ARI          = 1 OR 2     )
               IF  MAX-KIN-SYU-M           NOT =  ZERO
                   IF  FTN-SYU-M           >=     MAX-KIN-SYU-M
                       MOVE  "1"           TO     FLG-SANTEI-SYU
                   END-IF
               END-IF
           END-IF.
      *----(01.00.23) LINE ADD END   --------------------------
      ***     IF       MAX-KIN-KOHI1-M        NOT =  ZERO
      ***         IF   FTN-KOHI1-M            >=     MAX-KIN-KOHI1-M
      ***              MOVE     "1"           TO     FLG-SANTEI1
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI2-M        NOT =  ZERO
      ***         IF   FTN-KOHI2-M            >=     MAX-KIN-KOHI2-M
      ***              MOVE     "1"           TO     FLG-SANTEI2
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI3-M        NOT =  ZERO
      ***         IF   FTN-KOHI3-M            >=     MAX-KIN-KOHI3-M
      ***              MOVE     "1"           TO     FLG-SANTEI3
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI4-M        NOT =  ZERO
      ***         IF   FTN-KOHI4-M            >=     MAX-KIN-KOHI4-M
      ***              MOVE     "1"           TO     FLG-SANTEI4
      ***         END-IF
      ***     END-IF.
      *
      *    保険（公費）テーブルの患者負担上限額と当月の患者負担累計額
      *    から算定可能残額を算出する
      *
           IF  FLG-SANTEI1               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI1-D
                                               ZAN-KOHI1-D2             
                                               ZAN-KOHI1-D3             
           ELSE
               IF (COMB-KOH1HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH1-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI1-D       NOT = ZERO
                       IF   FTN-KOHI1-D           >=  MAX-KIN-KOHI1-D
                            MOVE     ZERO         TO  ZAN-KOHI1-D
                       ELSE
                            COMPUTE  ZAN-KOHI1-D  =   MAX-KIN-KOHI1-D -
                                                      FTN-KOHI1-D
                       END-IF
                       IF  COMB-KOH1HKNNUM    =   "027"                 
                            MOVE     ZERO         TO  ZAN-KOHI1-D2      
                       ELSE                                             
                         IF   FTN-KOHI1-D2        >=  MAX-KIN-KOHI1-D   
                            MOVE     ZERO         TO  ZAN-KOHI1-D2      
                         ELSE                                           
                            COMPUTE  ZAN-KOHI1-D2 =   MAX-KIN-KOHI1-D - 
                                                      FTN-KOHI1-D2      
                         END-IF                                         
                       END-IF                                           
                       IF  COMB-KOH1HKNNUM    =   "027"                 
                            MOVE     ZERO         TO  ZAN-KOHI1-D3      
                       ELSE                                             
                         IF   FTN-KOHI1-D3        >=  MAX-KIN-KOHI1-D   
                            MOVE     ZERO         TO  ZAN-KOHI1-D3      
                         ELSE                                           
                            COMPUTE  ZAN-KOHI1-D3 =   MAX-KIN-KOHI1-D - 
                                                      FTN-KOHI1-D3      
                         END-IF                                         
                       END-IF                       
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI2               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI2-D
                                               ZAN-KOHI2-D2             
                                               ZAN-KOHI2-D3             
           ELSE
               IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH2-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI2-D       NOT = ZERO
                       IF   FTN-KOHI2-D           >=  MAX-KIN-KOHI2-D
                            MOVE     ZERO         TO  ZAN-KOHI2-D
                       ELSE
                            COMPUTE  ZAN-KOHI2-D  =   MAX-KIN-KOHI2-D -
                                                      FTN-KOHI2-D
                       END-IF
                       IF   FTN-KOHI2-D2          >=  MAX-KIN-KOHI2-D   
                            MOVE     ZERO         TO  ZAN-KOHI2-D2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI2-D2 =   MAX-KIN-KOHI2-D - 
                                                      FTN-KOHI2-D2      
                       END-IF                                           
                       IF   FTN-KOHI2-D3          >=  MAX-KIN-KOHI2-D   
                            MOVE     ZERO         TO  ZAN-KOHI2-D3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI2-D3 =   MAX-KIN-KOHI2-D - 
                                                      FTN-KOHI2-D3      
                       END-IF              
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI3               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI3-D
                                               ZAN-KOHI3-D2             
                                               ZAN-KOHI3-D3             
           ELSE
               IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH3-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI3-D       NOT = ZERO
                       IF   FTN-KOHI3-D           >=  MAX-KIN-KOHI3-D
                            MOVE     ZERO         TO  ZAN-KOHI3-D
                       ELSE
                            COMPUTE  ZAN-KOHI3-D  =   MAX-KIN-KOHI3-D -
                                                      FTN-KOHI3-D
                       END-IF
                       IF   FTN-KOHI3-D2          >=  MAX-KIN-KOHI3-D   
                            MOVE     ZERO         TO  ZAN-KOHI3-D2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI3-D2 =   MAX-KIN-KOHI3-D - 
                                                      FTN-KOHI3-D2      
                       END-IF                                           
                       IF   FTN-KOHI3-D3          >=  MAX-KIN-KOHI3-D   
                            MOVE     ZERO         TO  ZAN-KOHI3-D3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI3-D3 =   MAX-KIN-KOHI3-D - 
                                                      FTN-KOHI3-D3      
                       END-IF   
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI4               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI4-D
                                               ZAN-KOHI4-D2             
                                               ZAN-KOHI4-D3             
           ELSE
               IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH4-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI4-D       NOT = ZERO
                       IF   FTN-KOHI4-D           >=  MAX-KIN-KOHI4-D
                            MOVE     ZERO         TO  ZAN-KOHI4-D
                       ELSE
                            COMPUTE  ZAN-KOHI4-D  =   MAX-KIN-KOHI4-D -
                                                      FTN-KOHI4-D
                       END-IF
                       IF   FTN-KOHI4-D2          >=  MAX-KIN-KOHI4-D   
                            MOVE     ZERO         TO  ZAN-KOHI4-D2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI4-D2 =   MAX-KIN-KOHI4-D - 
                                                      FTN-KOHI4-D2      
                       END-IF                                           
                       IF   FTN-KOHI4-D3          >=  MAX-KIN-KOHI4-D   
                            MOVE     ZERO         TO  ZAN-KOHI4-D3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI4-D3 =   MAX-KIN-KOHI4-D - 
                                                      FTN-KOHI4-D3      
                       END-IF   
                   END-IF
               END-IF
           END-IF.
      *
      *平成１４年１０月改正対応
      *高齢者の在宅総合・在宅末期算定患者
      *
           IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1")
           OR  (FLG-KOHININBARAI             =    1 )
           OR  (FLG-GENBUTU70            NOT =  ZERO)
           OR  (FLG-TOKU75-CYO         = 1 OR 2 OR 3)
           OR  (FLG-CYOKI-ARI          = 1 OR 2     )
               IF  FLG-SANTEI-SYU            =   "1"                  
                       MOVE  ZERO        TO      ZAN-SYU-M            
               ELSE                                                   
                   IF  FTN-SYU-M         >=    MAX-KIN-SYU-M          
                       MOVE  ZERO        TO      ZAN-SYU-M
                   ELSE
                       COMPUTE  ZAN-SYU-M  =   MAX-KIN-SYU-M  -
                                               FTN-SYU-M
                   END-IF
               END-IF
           END-IF.
      *
      *    熊本県地方公費公費上限編集
           IF  ( WK-1001-PREFNUM       =  43      )
           AND ( LNK-SYU-SRYYMD(1:6)  >= "201204" )
           AND ((COMB-KOH1HKNNUM = "343"         ) OR
                (COMB-KOH2HKNNUM = "343"         ) OR
                (COMB-KOH3HKNNUM = "343"         ) OR
                (COMB-KOH4HKNNUM = "343"         ))
      *
             IF  COMB-KOH1HKNNUM  =  "343"
               MOVE   99999990    TO  MAX-KIN-KOHI1-M
             END-IF
             IF  COMB-KOH2HKNNUM  =  "343"
               MOVE   99999990    TO  MAX-KIN-KOHI2-M
             END-IF
             IF  COMB-KOH3HKNNUM  =  "343"
               MOVE   99999990    TO  MAX-KIN-KOHI3-M
             END-IF
             IF  COMB-KOH4HKNNUM  =  "343"
               MOVE   99999990    TO  MAX-KIN-KOHI4-M
             END-IF
      *
             IF    (LNK-S01-KOUREI-ZAITAKU-KBN  = "1")
             OR    (FLG-KOUREI-KBN              = "1")
               CONTINUE
             ELSE
               IF  (COMB-KOH1HKNNUM  = "972" OR "974")
               OR  (COMB-KOH2HKNNUM  = "972" OR "974")
               OR  (COMB-KOH3HKNNUM  = "972" OR "974")
               OR  (COMB-KOH4HKNNUM  = "972" OR "974")
                     IF  COMB-KOH1HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI1-M
                     END-IF
                     IF  COMB-KOH2HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI2-M
                     END-IF
                     IF  COMB-KOH3HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI3-M
                     END-IF
                     IF  COMB-KOH4HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI4-M
                     END-IF
               ELSE
                 IF  FLG-GENBUTU70   NOT =   ZERO
                   IF ((COMB-KOH1HKNNUM(1:1) = "0"            ) AND
                       (COMB-KOH1HKNNUM  NOT = "012" AND "025"))
                   OR ((COMB-KOH2HKNNUM(1:1) = "0"            ) AND
                       (COMB-KOH2HKNNUM  NOT = "012" AND "025"))
                   OR ((COMB-KOH3HKNNUM(1:1) = "0"            ) AND
                       (COMB-KOH3HKNNUM  NOT = "012" AND "025"))
                   OR ((COMB-KOH4HKNNUM(1:1) = "0"            ) AND
                       (COMB-KOH4HKNNUM  NOT = "012" AND "025"))
                     CONTINUE
                   ELSE
                     IF  COMB-KOH1HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI1-M
                     END-IF
                     IF  COMB-KOH2HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI2-M
                     END-IF
                     IF  COMB-KOH3HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI3-M
                     END-IF
                     IF  COMB-KOH4HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI4-M
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
           END-IF.
      *
           IF  FLG-SANTEI1               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI1-M
                                               ZAN-KOHI1-M2             
                                               ZAN-KOHI1-M3             
               MOVE     ZERO             TO    ZAN-KOHI1-M-TOKU75
                                               ZAN-KOHI1-M2-TOKU75
                                               ZAN-KOHI1-M3-TOKU75
           ELSE
               IF (COMB-KOH1HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH1-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI1-M       NOT = ZERO
                       IF   FTN-KOHI1-M           >=  MAX-KIN-KOHI1-M
                            MOVE     ZERO         TO  ZAN-KOHI1-M
                       ELSE
                            COMPUTE  ZAN-KOHI1-M  =   MAX-KIN-KOHI1-M -
                                                      FTN-KOHI1-M
                       END-IF
                       IF  COMB-KOH1HKNNUM    =   "027"                 
                            MOVE     ZERO         TO  ZAN-KOHI1-M2      
                       ELSE                                             
                         IF   FTN-KOHI1-M2        >=  MAX-KIN-KOHI1-M   
                            MOVE     ZERO         TO  ZAN-KOHI1-M2      
                         ELSE                                           
                            COMPUTE  ZAN-KOHI1-M2 =   MAX-KIN-KOHI1-M - 
                                                      FTN-KOHI1-M2      
                         END-IF                                         
                       END-IF                                           
                       IF  COMB-KOH1HKNNUM    =   "027"                 
                            MOVE     ZERO         TO  ZAN-KOHI1-M3      
                       ELSE                                             
                         IF   FTN-KOHI1-M3        >=  MAX-KIN-KOHI1-M   
                            MOVE     ZERO         TO  ZAN-KOHI1-M3      
                         ELSE                                           
                            COMPUTE  ZAN-KOHI1-M3 =   MAX-KIN-KOHI1-M - 
                                                      FTN-KOHI1-M3      
                         END-IF                                         
                       END-IF       
                   END-IF
                   IF  MAX-KIN-KOHI1-M-TOKU75       NOT = ZERO
                       IF  FTN-KOHI1-M-TOKU75  >= MAX-KIN-KOHI1-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI1-M-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI1-M-TOKU75     =
                                     MAX-KIN-KOHI1-M-TOKU75 -
                                     FTN-KOHI1-M-TOKU75
                       END-IF
                       IF  FTN-KOHI1-M2-TOKU75 >= MAX-KIN-KOHI1-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI1-M2-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI1-M2-TOKU75    =
                                     MAX-KIN-KOHI1-M-TOKU75 -
                                     FTN-KOHI1-M2-TOKU75
                       END-IF
                       IF  FTN-KOHI1-M3-TOKU75 >= MAX-KIN-KOHI1-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI1-M3-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI1-M3-TOKU75    =
                                     MAX-KIN-KOHI1-M-TOKU75 -
                                     FTN-KOHI1-M3-TOKU75
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI2               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI2-M
                                               ZAN-KOHI2-M2             
                                               ZAN-KOHI2-M3             
               MOVE     ZERO             TO    ZAN-KOHI2-M-TOKU75
                                               ZAN-KOHI2-M2-TOKU75
                                               ZAN-KOHI2-M3-TOKU75
           ELSE
               IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH2-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI2-M       NOT = ZERO
                       IF   FTN-KOHI2-M           >=  MAX-KIN-KOHI2-M
                            MOVE     ZERO         TO  ZAN-KOHI2-M
                       ELSE
                            COMPUTE  ZAN-KOHI2-M  =   MAX-KIN-KOHI2-M -
                                                      FTN-KOHI2-M
                       END-IF
                       IF   FTN-KOHI2-M2          >=  MAX-KIN-KOHI2-M   
                            MOVE     ZERO         TO  ZAN-KOHI2-M2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI2-M2 =   MAX-KIN-KOHI2-M - 
                                                      FTN-KOHI2-M2      
                       END-IF                                           
                       IF   FTN-KOHI2-M3          >=  MAX-KIN-KOHI2-M   
                            MOVE     ZERO         TO  ZAN-KOHI2-M3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI2-M3 =   MAX-KIN-KOHI2-M - 
                                                      FTN-KOHI2-M3      
                       END-IF   
                   END-IF
                   IF  MAX-KIN-KOHI2-M-TOKU75       NOT = ZERO
                       IF  FTN-KOHI2-M-TOKU75  >= MAX-KIN-KOHI2-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI2-M-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI2-M-TOKU75     =
                                     MAX-KIN-KOHI2-M-TOKU75 -
                                     FTN-KOHI2-M-TOKU75
                       END-IF
                       IF  FTN-KOHI2-M2-TOKU75 >= MAX-KIN-KOHI2-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI2-M2-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI2-M2-TOKU75    =
                                     MAX-KIN-KOHI2-M-TOKU75 -
                                     FTN-KOHI2-M2-TOKU75
                       END-IF
                       IF  FTN-KOHI2-M3-TOKU75 >= MAX-KIN-KOHI2-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI2-M3-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI2-M3-TOKU75    =
                                     MAX-KIN-KOHI2-M-TOKU75 -
                                     FTN-KOHI2-M3-TOKU75
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI3               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI3-M
                                               ZAN-KOHI3-M2             
                                               ZAN-KOHI3-M3             
               MOVE     ZERO             TO    ZAN-KOHI3-M-TOKU75
                                               ZAN-KOHI3-M2-TOKU75
                                               ZAN-KOHI3-M3-TOKU75
           ELSE
               IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH3-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI3-M       NOT = ZERO
                       IF   FTN-KOHI3-M           >=  MAX-KIN-KOHI3-M
                            MOVE     ZERO         TO  ZAN-KOHI3-M
                       ELSE
                            COMPUTE  ZAN-KOHI3-M  =   MAX-KIN-KOHI3-M -
                                                      FTN-KOHI3-M
                       END-IF
                       IF   FTN-KOHI3-M2          >=  MAX-KIN-KOHI3-M   
                            MOVE     ZERO         TO  ZAN-KOHI3-M2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI3-M2 =   MAX-KIN-KOHI3-M - 
                                                      FTN-KOHI3-M2      
                       END-IF                                           
                       IF   FTN-KOHI3-M3          >=  MAX-KIN-KOHI3-M   
                            MOVE     ZERO         TO  ZAN-KOHI3-M3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI3-M3 =   MAX-KIN-KOHI3-M - 
                                                      FTN-KOHI3-M3      
                       END-IF   
                   END-IF
                   IF  MAX-KIN-KOHI3-M-TOKU75       NOT = ZERO
                       IF  FTN-KOHI3-M-TOKU75  >= MAX-KIN-KOHI3-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI3-M-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI3-M-TOKU75     =
                                     MAX-KIN-KOHI3-M-TOKU75 -
                                     FTN-KOHI3-M-TOKU75
                       END-IF
                       IF  FTN-KOHI3-M2-TOKU75 >= MAX-KIN-KOHI3-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI3-M2-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI3-M2-TOKU75    =
                                     MAX-KIN-KOHI3-M-TOKU75 -
                                     FTN-KOHI3-M2-TOKU75
                       END-IF
                       IF  FTN-KOHI3-M3-TOKU75 >= MAX-KIN-KOHI3-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI3-M3-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI3-M3-TOKU75    =
                                     MAX-KIN-KOHI3-M-TOKU75 -
                                     FTN-KOHI3-M3-TOKU75
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI4               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI4-M
                                               ZAN-KOHI4-M2             
                                               ZAN-KOHI4-M3             
               MOVE     ZERO             TO    ZAN-KOHI4-M-TOKU75
                                               ZAN-KOHI4-M2-TOKU75
                                               ZAN-KOHI4-M3-TOKU75
           ELSE
               IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH4-GAIJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI4-M       NOT = ZERO
                       IF   FTN-KOHI4-M           >=  MAX-KIN-KOHI4-M
                            MOVE     ZERO         TO  ZAN-KOHI4-M
                       ELSE
                            COMPUTE  ZAN-KOHI4-M  =   MAX-KIN-KOHI4-M -
                                                      FTN-KOHI4-M
                       END-IF
                       IF   FTN-KOHI4-M2          >=  MAX-KIN-KOHI4-M   
                            MOVE     ZERO         TO  ZAN-KOHI4-M2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI4-M2 =   MAX-KIN-KOHI4-M - 
                                                      FTN-KOHI4-M2      
                       END-IF                                           
                       IF   FTN-KOHI4-M3          >=  MAX-KIN-KOHI4-M   
                            MOVE     ZERO         TO  ZAN-KOHI4-M3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI4-M3 =   MAX-KIN-KOHI4-M - 
                                                      FTN-KOHI4-M3      
                       END-IF  
                   END-IF
                   IF  MAX-KIN-KOHI4-M-TOKU75       NOT = ZERO
                       IF  FTN-KOHI4-M-TOKU75  >= MAX-KIN-KOHI4-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI4-M-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI4-M-TOKU75     =
                                     MAX-KIN-KOHI4-M-TOKU75 -
                                     FTN-KOHI4-M-TOKU75
                       END-IF
                       IF  FTN-KOHI4-M2-TOKU75 >= MAX-KIN-KOHI4-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI4-M2-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI4-M2-TOKU75    =
                                     MAX-KIN-KOHI4-M-TOKU75 -
                                     FTN-KOHI4-M2-TOKU75
                       END-IF
                       IF  FTN-KOHI4-M3-TOKU75 >= MAX-KIN-KOHI4-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI4-M3-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI4-M3-TOKU75    =
                                     MAX-KIN-KOHI4-M-TOKU75 -
                                     FTN-KOHI4-M3-TOKU75
                       END-IF
                   END-IF
               END-IF
           END-IF.
      *
      *    日の患者負担可能残額と月の患者負担可能残額を比較して
      *    値の小さいほうをセットする
           IF (COMB-KOH1HKNNUM              NOT = SPACE)    AND
              (COMB-KOH1-GAIJGNKBN          =     "1")
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)
                     IF    ZAN-KOHI1-D            >    ZAN-KOHI1-M
                           MOVE   ZAN-KOHI1-M     TO   ZAN-KOHI1
                     ELSE
                           MOVE   ZAN-KOHI1-D     TO   ZAN-KOHI1
                     END-IF
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI1-M   =       ZERO)
                           MOVE   ZAN-KOHI1-D     TO   ZAN-KOHI1
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)
                           MOVE   ZAN-KOHI1-M     TO   ZAN-KOHI1
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND
                         (MAX-KIN-KOHI1-M   =       ZERO)
                           MOVE   ZERO            TO   ZAN-KOHI1
               END-EVALUATE
               IF   (MAX-KIN-KOHI1-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI1-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI1   =   SPACE
                   IF    MAX-KIN-KOHI1-K  NOT =  ZERO
                          IF   FTN-KOHI1-D-K     >=  MAX-KIN-KOHI1-K
                            MOVE     ZERO         TO  ZAN-KOHI1
                          ELSE
                            COMPUTE  ZAN-KOHI1   =   MAX-KIN-KOHI1-K
                                                 -   FTN-KOHI1-D-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI1-K     TO   ZAN-KOHI1
                   ELSE
                     IF    TEI-KIN-KOHI1-K  NOT =  ZERO
                          IF   FTN-KOHI1-D-K     >=  TEI-KIN-KOHI1-K
                            MOVE     ZERO         TO  ZAN-KOHI1
                          ELSE
                            COMPUTE  ZAN-KOHI1   =   TEI-KIN-KOHI1-K
                                                 -   FTN-KOHI1-D-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI1-K     TO   ZAN-KOHI1
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE                                          
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)               
                     IF    ZAN-KOHI1-D2           >    ZAN-KOHI1-M2     
                           MOVE   ZAN-KOHI1-M2    TO   ZAN-KOHI12       
                     ELSE                                               
                           MOVE   ZAN-KOHI1-D2    TO   ZAN-KOHI12       
                     END-IF                                             
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI1-M   =       ZERO)               
                           MOVE   ZAN-KOHI1-D2    TO   ZAN-KOHI12       
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)               
                           MOVE   ZAN-KOHI1-M2    TO   ZAN-KOHI12       
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI1-M   =       ZERO)               
                           MOVE   ZERO            TO   ZAN-KOHI12       
               END-EVALUATE                                             
               IF   (MAX-KIN-KOHI1-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI1-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI1   =   SPACE
                   IF    MAX-KIN-KOHI1-K  NOT =  ZERO
                          IF   FTN-KOHI1-D2-K    >=  MAX-KIN-KOHI1-K
                            MOVE     ZERO         TO  ZAN-KOHI12
                          ELSE
                            COMPUTE  ZAN-KOHI12  =   MAX-KIN-KOHI1-K
                                                 -   FTN-KOHI1-D2-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI1-K     TO   ZAN-KOHI12
                   ELSE
                     IF    TEI-KIN-KOHI1-K  NOT =  ZERO
                          IF   FTN-KOHI1-D2-K    >=  TEI-KIN-KOHI1-K
                            MOVE     ZERO         TO  ZAN-KOHI12
                          ELSE
                            COMPUTE  ZAN-KOHI12  =   TEI-KIN-KOHI1-K
                                                 -   FTN-KOHI1-D2-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI1-K     TO   ZAN-KOHI12
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE                                          
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)               
                     IF    ZAN-KOHI1-D3           >    ZAN-KOHI1-M3     
                           MOVE   ZAN-KOHI1-M3    TO   ZAN-KOHI13       
                     ELSE                                               
                           MOVE   ZAN-KOHI1-D3    TO   ZAN-KOHI13       
                     END-IF                                             
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI1-M   =       ZERO)               
                           MOVE   ZAN-KOHI1-D3    TO   ZAN-KOHI13       
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)               
                           MOVE   ZAN-KOHI1-M3    TO   ZAN-KOHI13       
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI1-M   =       ZERO)               
                           MOVE   ZERO            TO   ZAN-KOHI13       
               END-EVALUATE                                             
               IF   (MAX-KIN-KOHI1-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI1-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI1   =   SPACE
                   IF    MAX-KIN-KOHI1-K  NOT =  ZERO
                          IF   FTN-KOHI1-D3-K    >=  MAX-KIN-KOHI1-K
                            MOVE     ZERO         TO  ZAN-KOHI13
                          ELSE
                            COMPUTE  ZAN-KOHI13  =   MAX-KIN-KOHI1-K
                                                 -   FTN-KOHI1-D3-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI1-K     TO   ZAN-KOHI13
                   ELSE
                     IF    TEI-KIN-KOHI1-K  NOT =  ZERO
                          IF   FTN-KOHI1-D3-K    >=  TEI-KIN-KOHI1-K
                            MOVE     ZERO         TO  ZAN-KOHI13
                          ELSE
                            COMPUTE  ZAN-KOHI13  =   TEI-KIN-KOHI1-K
                                                 -   FTN-KOHI1-D3-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI1-K     TO   ZAN-KOHI13
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI1-M          NOT =   ZERO) AND
                         (MAX-KIN-KOHI1-M-TOKU75   NOT =   ZERO)
                     IF    ZAN-KOHI1   >    ZAN-KOHI1-M-TOKU75
                        MOVE   ZAN-KOHI1-M-TOKU75   TO   ZAN-KOHI1
                        MOVE   ZAN-KOHI1-M2-TOKU75  TO   ZAN-KOHI12
                        MOVE   ZAN-KOHI1-M3-TOKU75  TO   ZAN-KOHI13
                        IF  FLG-KOUGAKUCYO-GEN70K = 1
                          MOVE  ZERO  TO  FLG-KOUGAKUCYO-GEN70K
                        END-IF
                        IF  FLG-KOUGAKUCYO-GEN70K-TOKU75 = 1
                          MOVE  1     TO  FLG-KOUGAKUCYO-GEN70K
                          MOVE  ZERO  TO  FLG-KOUGAKUCYO-GEN70K-TOKU75
                        END-IF
                     ELSE
                        IF  FLG-KOUGAKUCYO-GEN70K-TOKU75 = 1
                          MOVE  ZERO  TO  FLG-KOUGAKUCYO-GEN70K-TOKU75
                        END-IF
                     END-IF
               END-EVALUATE
      ****
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604"       ) AND
                   ( COMB-KOH1HKNNUM = "015" OR "016" OR "021") AND
                   ( WK-JIRITU-CYUKANSOU(1) =   2             ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610"       ) AND
                   ( COMB-KOH1HKNNUM = "024" OR "079"         ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200804"       ) AND
                   ( COMB-KOH1HKNNUM = "038"                  ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "201501"       ) AND
                   ( COMB-KOH1HKNNUM = "052" OR "054"         ))
               OR (( COMB-KOH1HKNNUM(1:1)  >= "1" AND <=  "8" ) AND
                   ( WK-KOHJGNGET-TAISYOKBN(1)  =  2          ))
                   IF  ((COMB-KOH2HKNNUM  = "972") OR
                        (COMB-KOH3HKNNUM  = "972") OR
                        (COMB-KOH4HKNNUM  = "972"))
                   AND ( MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO)
                      IF    FTN-KOHI1-M-JI   >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((COMB-KOH2HKNNUM  = "974") OR
                        (COMB-KOH3HKNNUM  = "974") OR
                        (COMB-KOH4HKNNUM  = "974"))
                   AND ( MAX-KIN-KOHI1-M  > WK-CYOKI-GENDO2)
                      IF    FTN-KOHI1-M-JI   >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" ) OR
                        (FLG-KOUREI-KBN               =   "1" ))
                   AND ( MAX-KIN-KOHI1-M  >  WK-KOH-GENDOGAKU  )
                     IF   (WK-TOKATUKAI(1)            =  ZERO)
                     AND  (WK-KOHJGNGET-TEKIYOFLG(1)  =  ZERO)
                     AND  (WK-KOHJGNGET-TAISYOKBN(1)  =   2  )
                      CONTINUE
                     ELSE
                      IF    FTN-KOHI1-M-JI   >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                     END-IF
                   END-IF
                   IF  ( FLG-GENBUTU70   NOT =   ZERO          )
                   AND ( MAX-KIN-KOHI1-M  >  WK-GEN70-GENDOGAKU)
                     IF   (WK-TOKATUKAI(1)            =  ZERO)
                     AND  (WK-KOHJGNGET-TEKIYOFLG(1)  =  ZERO)
                     AND  (WK-KOHJGNGET-TAISYOKBN(1)  =   2  )
                      CONTINUE
                     ELSE
                      IF    FTN-KOHI1-M-JI   >=   WK-GEN70-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-GEN70-GENDOGAKU
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-GEN70-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-GEN70-GENDOGAKU
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-GEN70-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-GEN70-GENDOGAKU
                                              - FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                     END-IF
                   END-IF
               END-IF
      *+++
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH2HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH1HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH2HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***             IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M-JI
      ***             END-IF
      ***             IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      ***             END-IF
      ***             IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M2-JI
      ***             END-IF
      ***             IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      ***             END-IF
      ***             IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M3-JI
      ***             END-IF
      ***             IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
      ***             END-IF
      ***      END-IF
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH2HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH1HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH2HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***             IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M-JI
      ***             END-IF
      ***             IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      ***             END-IF
      ***             IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M2-JI
      ***             END-IF
      ***             IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      ***             END-IF
      ***             IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M3-JI
      ***             END-IF
      ***             IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
      ***             END-IF
      ***      END-IF
      *+++
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604"       ) AND
                   ( COMB-KOH1HKNNUM = "015" OR "016" OR "021") AND
                   ( WK-JIRITU-CYUKANSOU(1) =   2             ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610"       ) AND
                   ( COMB-KOH1HKNNUM = "024" OR "079"         ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200804"       ) AND
                   ( COMB-KOH1HKNNUM = "038"                  ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "201501"       ) AND
                   ( COMB-KOH1HKNNUM = "052" OR "054"         ))
               OR (( WK-TOKATUKAI(1)            =  1          ) AND
                   ( WK-KOHJGNGET-TAISYOKBN(1)  =  2          ))
                 IF  FLG-TOKU75 = 1 OR 2 OR 3
                   IF  ((COMB-KOH2HKNNUM  = "972") OR
                        (COMB-KOH3HKNNUM  = "972") OR
                        (COMB-KOH4HKNNUM  = "972"))
                   AND ( MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO-TOKU75  )
                      IF    FTN-KOHI1-M-JI-TOKU75
                                          >= WK-CYOKI-GENDO-TOKU75
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
                                              - FTN-KOHI1-M-JI-TOKU75
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
                        IF    FTN-KOHI1-M2-JI-TOKU75
                                            >= WK-CYOKI-GENDO-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
                                                - FTN-KOHI1-M2-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
                        IF    FTN-KOHI1-M3-JI-TOKU75
                                            >= WK-CYOKI-GENDO-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
                                                - FTN-KOHI1-M3-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((COMB-KOH2HKNNUM  = "974") OR
                        (COMB-KOH3HKNNUM  = "974") OR
                        (COMB-KOH4HKNNUM  = "974"))
                   AND ( MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO2-TOKU75 )
                      IF    FTN-KOHI1-M-JI-TOKU75
                                          >= WK-CYOKI-GENDO2-TOKU75
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
                                              - FTN-KOHI1-M-JI-TOKU75
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
                        IF    FTN-KOHI1-M2-JI-TOKU75
                                            >= WK-CYOKI-GENDO2-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
                                                - FTN-KOHI1-M2-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
                        IF    FTN-KOHI1-M3-JI-TOKU75
                                            >= WK-CYOKI-GENDO2-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
                                                - FTN-KOHI1-M3-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" ) OR
                        (FLG-KOUREI-KBN               =   "1" ))
                   AND ( FLG-TOKU75 = 1 OR 2                   )
                   AND ( MAX-KIN-KOHI1-M  >
                                      WK-KOH-GENDOGAKU-TOKU75  )
                      IF    FTN-KOHI1-M-JI-TOKU75
                                          >= WK-KOH-GENDOGAKU-TOKU75
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU-TOKU75
                                              - FTN-KOHI1-M-JI-TOKU75
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
                        IF    FTN-KOHI1-M2-JI-TOKU75
                                            >= WK-KOH-GENDOGAKU-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU
                                             = WK-KOH-GENDOGAKU-TOKU75
                                             - FTN-KOHI1-M2-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
                        IF    FTN-KOHI1-M3-JI-TOKU75
                                            >= WK-KOH-GENDOGAKU-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU
                                             = WK-KOH-GENDOGAKU-TOKU75
                                             - FTN-KOHI1-M3-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((FLG-GENBUTU70   NOT =   ZERO         ) OR
                        (FLG-TOKU75-CYO      =    3           ))
                   AND ( FLG-TOKU75 = 3                        )
                   AND ( MAX-KIN-KOHI1-M  >
                                      WK-GEN70-GENDOGAKU-TOKU75)
                      IF    FTN-KOHI1-M-JI-TOKU75
                                          >= WK-GEN70-GENDOGAKU-TOKU75
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU
                                           = WK-GEN70-GENDOGAKU-TOKU75
                                           - FTN-KOHI1-M-JI-TOKU75
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
                        IF    FTN-KOHI1-M2-JI-TOKU75
                                            >= WK-GEN70-GENDOGAKU-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU
                                             = WK-GEN70-GENDOGAKU-TOKU75
                                             - FTN-KOHI1-M2-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
                        IF    FTN-KOHI1-M3-JI-TOKU75
                                            >= WK-GEN70-GENDOGAKU-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU
                                             = WK-GEN70-GENDOGAKU-TOKU75
                                             - FTN-KOHI1-M3-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
                 END-IF
               END-IF
      *+++
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH2HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH1HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH2HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***        IF  FLG-TOKU75 = 1 OR 2 OR 3
      ***             IF    FTN-CYOKI-M-JI-TOKU75
      ***                            >=   WK-CYOKI-GENDO-TOKU75
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
      ***                                     - FTN-CYOKI-M-JI-TOKU75
      ***             END-IF
      ***             IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
      ***               IF    FTN-CYOKI-M2-JI-TOKU75
      ***                                   >= WK-CYOKI-GENDO-TOKU75
      ***                 MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***               ELSE
      ***                 COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
      ***                                       - FTN-CYOKI-M2-JI-TOKU75
      ***               END-IF
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
      ***               IF    FTN-CYOKI-M3-JI-TOKU75
      ***                                   >= WK-CYOKI-GENDO-TOKU75
      ***                 MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***               ELSE
      ***                 COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
      ***                                       - FTN-CYOKI-M3-JI-TOKU75
      ***               END-IF
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
      ***             END-IF
      ***        END-IF
      ***      END-IF
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH2HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH1HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH2HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***        IF  FLG-TOKU75 = 1 OR 2 OR 3
      ***             IF    FTN-CYOKI-M-JI-TOKU75
      ***                            >=   WK-CYOKI-GENDO2-TOKU75
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
      ***                                     - FTN-CYOKI-M-JI-TOKU75
      ***             END-IF
      ***             IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
      ***               IF    FTN-CYOKI-M2-JI-TOKU75
      ***                                   >= WK-CYOKI-GENDO2-TOKU75
      ***                 MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***               ELSE
      ***                 COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
      ***                                       - FTN-CYOKI-M2-JI-TOKU75
      ***               END-IF
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
      ***               IF    FTN-CYOKI-M3-JI-TOKU75
      ***                                   >= WK-CYOKI-GENDO2-TOKU75
      ***                 MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***               ELSE
      ***                 COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
      ***                                       - FTN-CYOKI-M3-JI-TOKU75
      ***               END-IF
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
      ***             END-IF
      ***        END-IF
      ***      END-IF
           END-IF.
      *
           IF (COMB-KOH2HKNNUM              NOT = SPACE)    AND
              (COMB-KOH2-GAIJGNKBN          =     "1")
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI2-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI2-M   NOT =   ZERO)
                     IF    ZAN-KOHI2-D            >    ZAN-KOHI2-M
                           MOVE   ZAN-KOHI2-M     TO   ZAN-KOHI2
                     ELSE
                           MOVE   ZAN-KOHI2-D     TO   ZAN-KOHI2
                     END-IF
                   WHEN  (MAX-KIN-KOHI2-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI2-M   =       ZERO)
                           MOVE   ZAN-KOHI2-D     TO   ZAN-KOHI2
                   WHEN  (MAX-KIN-KOHI2-D   =       ZERO)   AND
                         (MAX-KIN-KOHI2-M   NOT =   ZERO)
                           MOVE   ZAN-KOHI2-M     TO   ZAN-KOHI2
                   WHEN  (MAX-KIN-KOHI2-D   =       ZERO)   AND
                         (MAX-KIN-KOHI2-M   =       ZERO)
                           MOVE   ZERO            TO   ZAN-KOHI2
               END-EVALUATE
               IF   (MAX-KIN-KOHI2-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI2-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI2   =   SPACE
                   IF    MAX-KIN-KOHI2-K  NOT =  ZERO
                          IF   FTN-KOHI2-D-K     >=  MAX-KIN-KOHI2-K
                            MOVE     ZERO         TO  ZAN-KOHI2
                          ELSE
                            COMPUTE  ZAN-KOHI2   =   MAX-KIN-KOHI2-K
                                                 -   FTN-KOHI2-D-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI2-K     TO   ZAN-KOHI2
                   ELSE
                     IF    TEI-KIN-KOHI2-K  NOT =  ZERO
                          IF   FTN-KOHI2-D-K     >=  TEI-KIN-KOHI2-K
                            MOVE     ZERO         TO  ZAN-KOHI2
                          ELSE
                            COMPUTE  ZAN-KOHI2   =   TEI-KIN-KOHI2-K
                                                 -   FTN-KOHI2-D-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI2-K     TO   ZAN-KOHI2
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE                                          
                   WHEN  (MAX-KIN-KOHI2-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI2-M   NOT =   ZERO)               
                     IF    ZAN-KOHI2-D2           >    ZAN-KOHI2-M2     
                           MOVE   ZAN-KOHI2-M2    TO   ZAN-KOHI22       
                     ELSE                                               
                           MOVE   ZAN-KOHI2-D2    TO   ZAN-KOHI22       
                     END-IF                                             
                   WHEN  (MAX-KIN-KOHI2-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI2-M   =       ZERO)               
                           MOVE   ZAN-KOHI2-D2    TO   ZAN-KOHI22       
                   WHEN  (MAX-KIN-KOHI2-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI2-M   NOT =   ZERO)               
                           MOVE   ZAN-KOHI2-M2    TO   ZAN-KOHI22       
                   WHEN  (MAX-KIN-KOHI2-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI2-M   =       ZERO)               
                           MOVE   ZERO            TO   ZAN-KOHI22       
               END-EVALUATE                                             
               IF   (MAX-KIN-KOHI2-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI2-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI2   =   SPACE
                   IF    MAX-KIN-KOHI2-K  NOT =  ZERO
                          IF   FTN-KOHI2-D2-K    >=  MAX-KIN-KOHI2-K
                            MOVE     ZERO         TO  ZAN-KOHI22
                          ELSE
                            COMPUTE  ZAN-KOHI22  =   MAX-KIN-KOHI2-K
                                                 -   FTN-KOHI2-D2-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI2-K     TO   ZAN-KOHI22
                   ELSE
                     IF    TEI-KIN-KOHI2-K  NOT =  ZERO
                          IF   FTN-KOHI2-D2-K    >=  TEI-KIN-KOHI2-K
                            MOVE     ZERO         TO  ZAN-KOHI22
                          ELSE
                            COMPUTE  ZAN-KOHI22  =   TEI-KIN-KOHI2-K
                                                 -   FTN-KOHI2-D2-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI2-K     TO   ZAN-KOHI22
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE                                          
                   WHEN  (MAX-KIN-KOHI2-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI2-M   NOT =   ZERO)               
                     IF    ZAN-KOHI2-D3           >    ZAN-KOHI2-M3     
                           MOVE   ZAN-KOHI2-M3    TO   ZAN-KOHI23       
                     ELSE                                               
                           MOVE   ZAN-KOHI2-D3    TO   ZAN-KOHI23       
                     END-IF                                             
                   WHEN  (MAX-KIN-KOHI2-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI2-M   =       ZERO)               
                           MOVE   ZAN-KOHI2-D3    TO   ZAN-KOHI23       
                   WHEN  (MAX-KIN-KOHI2-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI2-M   NOT =   ZERO)               
                           MOVE   ZAN-KOHI2-M3    TO   ZAN-KOHI23       
                   WHEN  (MAX-KIN-KOHI2-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI2-M   =       ZERO)               
                           MOVE   ZERO            TO   ZAN-KOHI23       
               END-EVALUATE                                             
               IF   (MAX-KIN-KOHI2-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI2-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI2   =   SPACE
                   IF    MAX-KIN-KOHI2-K  NOT =  ZERO
                          IF   FTN-KOHI2-D3-K    >=  MAX-KIN-KOHI2-K
                            MOVE     ZERO         TO  ZAN-KOHI23
                          ELSE
                            COMPUTE  ZAN-KOHI23  =   MAX-KIN-KOHI2-K
                                                 -   FTN-KOHI2-D3-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI2-K     TO   ZAN-KOHI23
                   ELSE
                     IF    TEI-KIN-KOHI2-K  NOT =  ZERO
                          IF   FTN-KOHI2-D3-K    >=  TEI-KIN-KOHI2-K
                            MOVE     ZERO         TO  ZAN-KOHI23
                          ELSE
                            COMPUTE  ZAN-KOHI23  =   TEI-KIN-KOHI2-K
                                                 -   FTN-KOHI2-D3-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI2-K     TO   ZAN-KOHI23
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI2-M          NOT =   ZERO) AND
                         (MAX-KIN-KOHI2-M-TOKU75   NOT =   ZERO)
                     IF    ZAN-KOHI2   >    ZAN-KOHI2-M-TOKU75
                        MOVE   ZAN-KOHI2-M-TOKU75   TO   ZAN-KOHI2
                        MOVE   ZAN-KOHI2-M2-TOKU75  TO   ZAN-KOHI22
                        MOVE   ZAN-KOHI2-M3-TOKU75  TO   ZAN-KOHI23
                     END-IF
               END-EVALUATE
      ****
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604"       ) AND
                   ( COMB-KOH2HKNNUM = "015" OR "016" OR "021") AND
                   ( WK-JIRITU-CYUKANSOU(2) =   2             ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610"       ) AND
                   ( COMB-KOH2HKNNUM = "024" OR "079"         ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "201501"       ) AND
                   ( COMB-KOH2HKNNUM = "054"                  ))
               OR (( COMB-KOH2HKNNUM(1:1)  >= "1" AND <=  "8" ) AND
                   ( WK-KOHJGNGET-TAISYOKBN(2)  =  2          ))
                   IF  ((COMB-KOH1HKNNUM  = "972") OR
                        (COMB-KOH3HKNNUM  = "972") OR
                        (COMB-KOH4HKNNUM  = "972"))
                   AND ( MAX-KIN-KOHI2-M  >  WK-CYOKI-GENDO)
                      IF    FTN-KOHI2-M-JI   >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI2-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-KOHI2-M2-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI2-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-KOHI2-M3-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI2-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
                      END-IF
                   END-IF
                   IF  ((COMB-KOH1HKNNUM  = "974") OR
                        (COMB-KOH3HKNNUM  = "974") OR
                        (COMB-KOH4HKNNUM  = "974"))
                   AND ( MAX-KIN-KOHI2-M  > WK-CYOKI-GENDO2)
                      IF    FTN-KOHI2-M-JI   >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI2-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-KOHI2-M2-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI2-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-KOHI2-M3-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI2-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
                      END-IF
                   END-IF
                   IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" ) OR
                        (FLG-KOUREI-KBN               =   "1" ))
                   AND ( MAX-KIN-KOHI2-M  >  WK-KOH-GENDOGAKU  )
                     IF    WK-KOHJGNGET-TAISYOKBN(2)  =   2
                      CONTINUE
                     ELSE
                      IF    FTN-KOHI2-M-JI   >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI2-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-KOHI2-M2-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI2-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-KOHI2-M3-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI2-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
                      END-IF
                     END-IF
                   END-IF
               END-IF
      *+++
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH2HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH1HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH2HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH1HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***             IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M-JI
      ***             END-IF
      ***             IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
      ***             END-IF
      ***             IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M2-JI
      ***             END-IF
      ***             IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
      ***             END-IF
      ***             IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M3-JI
      ***             END-IF
      ***             IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
      ***             END-IF
      ***      END-IF
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH2HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH1HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH2HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH1HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***             IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M-JI
      ***             END-IF
      ***             IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
      ***             END-IF
      ***             IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M2-JI
      ***             END-IF
      ***             IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
      ***             END-IF
      ***             IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M3-JI
      ***             END-IF
      ***             IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
      ***             END-IF
      ***      END-IF
      ****
           END-IF.
      *
           IF (COMB-KOH3HKNNUM              NOT = SPACE)    AND
              (COMB-KOH3-GAIJGNKBN          =     "1")
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI3-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI3-M   NOT =   ZERO)
                     IF    ZAN-KOHI3-D            >    ZAN-KOHI3-M
                           MOVE   ZAN-KOHI3-M     TO   ZAN-KOHI3
                     ELSE
                           MOVE   ZAN-KOHI3-D     TO   ZAN-KOHI3
                     END-IF
                   WHEN  (MAX-KIN-KOHI3-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI3-M   =       ZERO)
                           MOVE   ZAN-KOHI3-D     TO   ZAN-KOHI3
                   WHEN  (MAX-KIN-KOHI3-D   =       ZERO)   AND
                         (MAX-KIN-KOHI3-M   NOT =   ZERO)
                           MOVE   ZAN-KOHI3-M     TO   ZAN-KOHI3
                   WHEN  (MAX-KIN-KOHI3-D   =       ZERO)   AND
                         (MAX-KIN-KOHI3-M   =       ZERO)
                           MOVE   ZERO            TO   ZAN-KOHI3
               END-EVALUATE
               IF   (MAX-KIN-KOHI3-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI3-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI3   =   SPACE
                   IF    MAX-KIN-KOHI3-K  NOT =  ZERO
                          IF   FTN-KOHI3-D-K     >=  MAX-KIN-KOHI3-K
                            MOVE     ZERO         TO  ZAN-KOHI3
                          ELSE
                            COMPUTE  ZAN-KOHI3   =   MAX-KIN-KOHI3-K
                                                 -   FTN-KOHI3-D-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI3-K     TO   ZAN-KOHI3
                   ELSE
                     IF    TEI-KIN-KOHI3-K  NOT =  ZERO
                          IF   FTN-KOHI3-D-K     >=  TEI-KIN-KOHI3-K
                            MOVE     ZERO         TO  ZAN-KOHI3
                          ELSE
                            COMPUTE  ZAN-KOHI3   =   TEI-KIN-KOHI3-K
                                                 -   FTN-KOHI3-D-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI3-K     TO   ZAN-KOHI3
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE                                          
                   WHEN  (MAX-KIN-KOHI3-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI3-M   NOT =   ZERO)               
                     IF    ZAN-KOHI3-D2           >    ZAN-KOHI3-M2     
                           MOVE   ZAN-KOHI3-M2    TO   ZAN-KOHI32       
                     ELSE                                               
                           MOVE   ZAN-KOHI3-D2    TO   ZAN-KOHI32       
                     END-IF                                             
                   WHEN  (MAX-KIN-KOHI3-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI3-M   =       ZERO)               
                           MOVE   ZAN-KOHI3-D2    TO   ZAN-KOHI32       
                   WHEN  (MAX-KIN-KOHI3-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI3-M   NOT =   ZERO)               
                           MOVE   ZAN-KOHI3-M2    TO   ZAN-KOHI32       
                   WHEN  (MAX-KIN-KOHI3-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI3-M   =       ZERO)               
                           MOVE   ZERO            TO   ZAN-KOHI32       
               END-EVALUATE                                             
               IF   (MAX-KIN-KOHI3-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI3-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI3   =   SPACE
                   IF    MAX-KIN-KOHI3-K  NOT =  ZERO
                          IF   FTN-KOHI3-D2-K    >=  MAX-KIN-KOHI3-K
                            MOVE     ZERO         TO  ZAN-KOHI32
                          ELSE
                            COMPUTE  ZAN-KOHI32  =   MAX-KIN-KOHI3-K
                                                 -   FTN-KOHI3-D2-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI3-K     TO   ZAN-KOHI32
                   ELSE
                     IF    TEI-KIN-KOHI3-K  NOT =  ZERO
                          IF   FTN-KOHI3-D2-K    >=  TEI-KIN-KOHI3-K
                            MOVE     ZERO         TO  ZAN-KOHI32
                          ELSE
                            COMPUTE  ZAN-KOHI32  =   TEI-KIN-KOHI3-K
                                                 -   FTN-KOHI3-D2-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI3-K     TO   ZAN-KOHI32
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE                                          
                   WHEN  (MAX-KIN-KOHI3-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI3-M   NOT =   ZERO)               
                     IF    ZAN-KOHI3-D3           >    ZAN-KOHI3-M3     
                           MOVE   ZAN-KOHI3-M3    TO   ZAN-KOHI33       
                     ELSE                                               
                           MOVE   ZAN-KOHI3-D3    TO   ZAN-KOHI33       
                     END-IF                                             
                   WHEN  (MAX-KIN-KOHI3-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI3-M   =       ZERO)               
                           MOVE   ZAN-KOHI3-D3    TO   ZAN-KOHI33       
                   WHEN  (MAX-KIN-KOHI3-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI3-M   NOT =   ZERO)               
                           MOVE   ZAN-KOHI3-M3    TO   ZAN-KOHI33       
                   WHEN  (MAX-KIN-KOHI3-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI3-M   =       ZERO)               
                           MOVE   ZERO            TO   ZAN-KOHI33       
               END-EVALUATE                                             
               IF   (MAX-KIN-KOHI3-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI3-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI3   =   SPACE
                   IF    MAX-KIN-KOHI3-K  NOT =  ZERO
                          IF   FTN-KOHI3-D3-K    >=  MAX-KIN-KOHI3-K
                            MOVE     ZERO         TO  ZAN-KOHI33
                          ELSE
                            COMPUTE  ZAN-KOHI33  =   MAX-KIN-KOHI3-K
                                                 -   FTN-KOHI3-D3-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI3-K     TO   ZAN-KOHI33
                   ELSE
                     IF    TEI-KIN-KOHI3-K  NOT =  ZERO
                          IF   FTN-KOHI3-D3-K    >=  TEI-KIN-KOHI3-K
                            MOVE     ZERO         TO  ZAN-KOHI33
                          ELSE
                            COMPUTE  ZAN-KOHI33  =   TEI-KIN-KOHI3-K
                                                 -   FTN-KOHI3-D3-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI3-K     TO   ZAN-KOHI33
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI3-M          NOT =   ZERO) AND
                         (MAX-KIN-KOHI3-M-TOKU75   NOT =   ZERO)
                     IF    ZAN-KOHI3   >    ZAN-KOHI3-M-TOKU75
                        MOVE   ZAN-KOHI3-M-TOKU75   TO   ZAN-KOHI3
                        MOVE   ZAN-KOHI3-M2-TOKU75  TO   ZAN-KOHI32
                        MOVE   ZAN-KOHI3-M3-TOKU75  TO   ZAN-KOHI33
                     END-IF
               END-EVALUATE
           END-IF.
      *
           IF (COMB-KOH4HKNNUM              NOT = SPACE)    AND
              (COMB-KOH4-GAIJGNKBN          =     "1")
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI4-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI4-M   NOT =   ZERO)
                     IF    ZAN-KOHI4-D            >    ZAN-KOHI4-M
                           MOVE   ZAN-KOHI4-M     TO   ZAN-KOHI4
                     ELSE
                           MOVE   ZAN-KOHI4-D     TO   ZAN-KOHI4
                     END-IF
                   WHEN  (MAX-KIN-KOHI4-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI4-M   =       ZERO)
                           MOVE   ZAN-KOHI4-D     TO   ZAN-KOHI4
                   WHEN  (MAX-KIN-KOHI4-D   =       ZERO)   AND
                         (MAX-KIN-KOHI4-M   NOT =   ZERO)
                           MOVE   ZAN-KOHI4-M     TO   ZAN-KOHI4
                   WHEN  (MAX-KIN-KOHI4-D   =       ZERO)   AND
                         (MAX-KIN-KOHI4-M   =       ZERO)
                           MOVE   ZERO            TO   ZAN-KOHI4
               END-EVALUATE
               IF   (MAX-KIN-KOHI4-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI4-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI4   =   SPACE
                   IF    MAX-KIN-KOHI4-K  NOT =  ZERO
                          IF   FTN-KOHI4-D-K     >=  MAX-KIN-KOHI4-K
                            MOVE     ZERO         TO  ZAN-KOHI4
                          ELSE
                            COMPUTE  ZAN-KOHI4   =   MAX-KIN-KOHI4-K
                                                 -   FTN-KOHI4-D-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI4-K     TO   ZAN-KOHI4
                   ELSE
                     IF    TEI-KIN-KOHI4-K  NOT =  ZERO
                          IF   FTN-KOHI4-D-K     >=  TEI-KIN-KOHI4-K
                            MOVE     ZERO         TO  ZAN-KOHI4
                          ELSE
                            COMPUTE  ZAN-KOHI4   =   TEI-KIN-KOHI4-K
                                                 -   FTN-KOHI4-D-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI4-K     TO   ZAN-KOHI4
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE                                          
                   WHEN  (MAX-KIN-KOHI4-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI4-M   NOT =   ZERO)               
                     IF    ZAN-KOHI4-D2           >    ZAN-KOHI4-M2     
                           MOVE   ZAN-KOHI4-M2    TO   ZAN-KOHI42       
                     ELSE                                               
                           MOVE   ZAN-KOHI4-D2    TO   ZAN-KOHI42       
                     END-IF                                             
                   WHEN  (MAX-KIN-KOHI4-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI4-M   =       ZERO)               
                           MOVE   ZAN-KOHI4-D2    TO   ZAN-KOHI42       
                   WHEN  (MAX-KIN-KOHI4-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI4-M   NOT =   ZERO)               
                           MOVE   ZAN-KOHI4-M2    TO   ZAN-KOHI42       
                   WHEN  (MAX-KIN-KOHI4-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI4-M   =       ZERO)               
                           MOVE   ZERO            TO   ZAN-KOHI42       
               END-EVALUATE                                             
               IF   (MAX-KIN-KOHI4-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI4-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI4   =   SPACE
                   IF    MAX-KIN-KOHI4-K  NOT =  ZERO
                          IF   FTN-KOHI4-D2-K    >=  MAX-KIN-KOHI4-K
                            MOVE     ZERO         TO  ZAN-KOHI42
                          ELSE
                            COMPUTE  ZAN-KOHI42  =   MAX-KIN-KOHI4-K
                                                 -   FTN-KOHI4-D2-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI4-K     TO   ZAN-KOHI42
                   ELSE
                     IF    TEI-KIN-KOHI4-K  NOT =  ZERO
                          IF   FTN-KOHI4-D2-K    >=  TEI-KIN-KOHI4-K
                            MOVE     ZERO         TO  ZAN-KOHI42
                          ELSE
                            COMPUTE  ZAN-KOHI42  =   TEI-KIN-KOHI4-K
                                                 -   FTN-KOHI4-D2-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI4-K     TO   ZAN-KOHI42
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE                                          
                   WHEN  (MAX-KIN-KOHI4-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI4-M   NOT =   ZERO)               
                     IF    ZAN-KOHI4-D3           >    ZAN-KOHI4-M3     
                           MOVE   ZAN-KOHI4-M3    TO   ZAN-KOHI43       
                     ELSE                                               
                           MOVE   ZAN-KOHI4-D3    TO   ZAN-KOHI43       
                     END-IF                                             
                   WHEN  (MAX-KIN-KOHI4-D   NOT =   ZERO)   AND         
                         (MAX-KIN-KOHI4-M   =       ZERO)               
                           MOVE   ZAN-KOHI4-D3    TO   ZAN-KOHI43       
                   WHEN  (MAX-KIN-KOHI4-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI4-M   NOT =   ZERO)               
                           MOVE   ZAN-KOHI4-M3    TO   ZAN-KOHI43       
                   WHEN  (MAX-KIN-KOHI4-D   =       ZERO)   AND         
                         (MAX-KIN-KOHI4-M   =       ZERO)               
                           MOVE   ZERO            TO   ZAN-KOHI43       
               END-EVALUATE                                             
               IF   (MAX-KIN-KOHI4-D    NOT =  ZERO)
               OR   (MAX-KIN-KOHI4-M    NOT =  ZERO)
                    CONTINUE
               ELSE
                 IF    FLG-SANTEI4   =   SPACE
                   IF    MAX-KIN-KOHI4-K  NOT =  ZERO
                          IF   FTN-KOHI4-D3-K    >=  MAX-KIN-KOHI4-K
                            MOVE     ZERO         TO  ZAN-KOHI43
                          ELSE
                            COMPUTE  ZAN-KOHI43  =   MAX-KIN-KOHI4-K
                                                 -   FTN-KOHI4-D3-K
                          END-IF
      ***                 MOVE    MAX-KIN-KOHI4-K     TO   ZAN-KOHI43
                   ELSE
                     IF    TEI-KIN-KOHI4-K  NOT =  ZERO
                          IF   FTN-KOHI4-D3-K    >=  TEI-KIN-KOHI4-K
                            MOVE     ZERO         TO  ZAN-KOHI43
                          ELSE
                            COMPUTE  ZAN-KOHI43  =   TEI-KIN-KOHI4-K
                                                 -   FTN-KOHI4-D3-K
                          END-IF
      ***                 MOVE    TEI-KIN-KOHI4-K     TO   ZAN-KOHI43
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI4-M          NOT =   ZERO) AND
                         (MAX-KIN-KOHI4-M-TOKU75   NOT =   ZERO)
                     IF    ZAN-KOHI4   >    ZAN-KOHI4-M-TOKU75
                        MOVE   ZAN-KOHI4-M-TOKU75   TO   ZAN-KOHI4
                        MOVE   ZAN-KOHI4-M2-TOKU75  TO   ZAN-KOHI42
                        MOVE   ZAN-KOHI4-M3-TOKU75  TO   ZAN-KOHI43
                     END-IF
               END-EVALUATE
           END-IF.
      *
      *    主保険負担金額の円単位　残金額計算
           IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1")
           OR  (FLG-KOHININBARAI             =    1 )
           OR  (FLG-GENBUTU70            NOT =  ZERO)
           OR  (FLG-TOKU75-CYO         = 1 OR 2 OR 3)
           OR  (FLG-CYOKI-ARI          = 1 OR 2     )
                PERFORM    2302-SYUENTANI-ZAN-KEISAN-SEC
           END-IF.
      *
      *    大阪府地方公費＋長期の地方公費残額置き換え
           PERFORM   2308-ZANOKIKAE-HENSYU-SEC.
      *
      *    保険・公費毎の患者負担金額の計算
           MOVE     ZERO     TO    WK-KOH-FTNRATE.
           MOVE     ZERO     TO    WK-GAIKFTNRATE-TOKUSYU.
           MOVE     ZERO     TO    FLG-GENBUTU-TAISYODATA.
           MOVE     ZERO     TO    WK-KUMAMOTO-SYUCOMPFTN.
           MOVE     ZERO     TO    WK-WAKAYAMA-SYUCOMPFTN.
           MOVE     ZERO     TO    WK-SKYCHK-KEISAN9.
           MOVE     ZERO     TO    WK-SKYCHK-KEISAN10.
           IF    ((COMB-KOH1-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH1HKNNUM           =   "027")) OR 
                 ((COMB-KOH2-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH2HKNNUM           =   "027")) OR 
                 ((COMB-KOH3-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH3HKNNUM           =   "027")) OR 
                 ((COMB-KOH4-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH4HKNNUM           =   "027")) 
                  CONTINUE
           ELSE
               IF    COMB-HKNNUM             NOT =       SPACE
                  PERFORM    2303-SYUHOKEN-KEISAN-SEC
               END-IF
           END-IF.
      *
           MOVE     ZERO     TO     WK-TOKUTEI-COMPFTN3.
           MOVE     SPACE    TO     FLG-KUMAMOTO.
           MOVE     ZERO     TO     FLG-KUMAMOTO-CYO.
           MOVE     ZERO     TO     WK-KUMAMOTO-HANTEIJGN.
           INITIALIZE               WK-TAIHI-RECEFTNDSPKBN-OCC.
      *
           INITIALIZE               WK-SYOUKAN-FLG-TAIHI-AREA.
           INITIALIZE               WK-TAIHI-FTNGAKEN-OCC.
      *
           MOVE    ZERO      TO     WK-NYNSHOKAISU.
      *
           MOVE    ZERO      TO     WK-TOKUSYU-COMPFTN.
           MOVE    9999999   TO     WK-TOKUSYU-COMPFTN2.
           MOVE    ZERO      TO     WK-TOKUSYU-ENTANI.
      *
           MOVE    9999999   TO     WK-MIYAGI-COMPFTN.
           MOVE    9999999   TO     WK-SEISIN-COMPFTN.
      *
           MOVE    ZERO      TO     FLG-MARUTOARI.
           MOVE    ZERO      TO     FLG-MARUTOARI2.
           MOVE    ZERO      TO     WK-MARUTOARI-COMPFTN.
      *
           MOVE    ZERO      TO     WK-CYOKI-ZAN.
           MOVE    ZERO      TO     WK-CYOKI-ZAN-ENTANI.
           IF   (COMB-KOH1HKNNUM     = "972") OR
                (COMB-KOH2HKNNUM     = "972") OR
                (COMB-KOH3HKNNUM     = "972") OR
                (COMB-KOH4HKNNUM     = "972")
                 IF   WK-CYOKI         >   WK-CYOKI-GENDO
                    MOVE   ZERO   TO   WK-CYOKI-ZAN
                 ELSE
                    COMPUTE WK-CYOKI-ZAN  =  WK-CYOKI-GENDO
                                          -  WK-CYOKI
                 END-IF
                 IF   WK-CYOKI-ENTANI  >   WK-CYOKI-GENDO
                    MOVE   ZERO   TO   WK-CYOKI-ZAN-ENTANI
                 ELSE
                    COMPUTE WK-CYOKI-ZAN-ENTANI =  WK-CYOKI-GENDO
                                                -  WK-CYOKI-ENTANI
                 END-IF
                 IF  (FLG-TOKU75 = 1 OR 2 OR 3)
                   IF   WK-CYOKI-TOKU75 >   WK-CYOKI-GENDO-TOKU75
                     MOVE   ZERO   TO   WK-CYOKI-ZAN-XXX
                   ELSE
                     COMPUTE WK-CYOKI-ZAN-XXX
                                   =  WK-CYOKI-GENDO-TOKU75
                                   -  WK-CYOKI-TOKU75
                   END-IF
                   IF   WK-CYOKI-ZAN > WK-CYOKI-ZAN-XXX
                     MOVE  WK-CYOKI-ZAN-XXX
                                  TO  WK-CYOKI-ZAN
                     IF   WK-CYOKI-ENTANI-TOKU75
                                    > WK-CYOKI-GENDO-TOKU75
                       MOVE   ZERO   TO   WK-CYOKI-ZAN-XXX
                     ELSE
                       COMPUTE WK-CYOKI-ZAN-XXX
                                   =  WK-CYOKI-GENDO-TOKU75
                                   -  WK-CYOKI-ENTANI-TOKU75
                     END-IF
                     MOVE  WK-CYOKI-ZAN-XXX
                                  TO  WK-CYOKI-ZAN-ENTANI
                   END-IF
                 END-IF
           END-IF.
           IF   (COMB-KOH1HKNNUM     = "974") OR
                (COMB-KOH2HKNNUM     = "974") OR
                (COMB-KOH3HKNNUM     = "974") OR
                (COMB-KOH4HKNNUM     = "974")
                 IF   WK-CYOKI         >   WK-CYOKI-GENDO2
                    MOVE   ZERO   TO   WK-CYOKI-ZAN
                 ELSE
                    COMPUTE WK-CYOKI-ZAN  =  WK-CYOKI-GENDO2
                                          -  WK-CYOKI
                 END-IF
                 IF   WK-CYOKI-ENTANI  >   WK-CYOKI-GENDO2
                    MOVE   ZERO   TO   WK-CYOKI-ZAN-ENTANI
                 ELSE
                    COMPUTE WK-CYOKI-ZAN-ENTANI =  WK-CYOKI-GENDO2
                                                -  WK-CYOKI-ENTANI
                 END-IF
                 IF  (FLG-TOKU75 = 1 OR 2 OR 3)
                   IF   WK-CYOKI-TOKU75 >   WK-CYOKI-GENDO2-TOKU75
                     MOVE   ZERO   TO   WK-CYOKI-ZAN-XXX
                   ELSE
                     COMPUTE WK-CYOKI-ZAN-XXX
                                   =  WK-CYOKI-GENDO2-TOKU75
                                   -  WK-CYOKI-TOKU75
                   END-IF
                   IF   WK-CYOKI-ZAN > WK-CYOKI-ZAN-XXX
                     MOVE  WK-CYOKI-ZAN-XXX
                                  TO  WK-CYOKI-ZAN
                     IF   WK-CYOKI-ENTANI-TOKU75
                                    > WK-CYOKI-GENDO2-TOKU75
                       MOVE   ZERO   TO   WK-CYOKI-ZAN-XXX
                     ELSE
                       COMPUTE WK-CYOKI-ZAN-XXX
                                   =  WK-CYOKI-GENDO2-TOKU75
                                   -  WK-CYOKI-ENTANI-TOKU75
                     END-IF
                     MOVE  WK-CYOKI-ZAN-XXX
                                  TO  WK-CYOKI-ZAN-ENTANI
                   END-IF
                 END-IF
           END-IF.
      *
           PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                      UNTIL    (KOH-IDX    >      4)
               IF   COMB-KOHHKNNUM(KOH-IDX)  NOT =  SPACE
                    PERFORM    2304-KOH-HKNREAD-SEC
                    IF   COMB-KOH-GAIJGNKBN(KOH-IDX)  =  "1"
                         PERFORM   2305-KOH-KEISAN-SEC
                    ELSE
                         PERFORM   2306-KOH-KEISAN2-SEC
                    END-IF
               END-IF
           END-PERFORM.
      *
      *     公費単位で計算した患者負担金額から最小の値を選択セット
            PERFORM   2307-FTNKIN-HIKAKU-SEC.
      *
       230-FTNKIN-EXT.
           EXIT.
      *
      ******************************************************************
      *        主保険負担金額の円単位　残金額計算
      ******************************************************************
       2302-SYUENTANI-ZAN-KEISAN-SEC           SECTION.
      *
      *    算定可能フラグの初期化
           MOVE     SPACE                  TO     FLG-SANTEI1-ENTANI
                                                  FLG-SANTEI-SYU-ENTANI.
      *
      *    過去の患者保険負担累計額と上限金額の比較
      *
           IF   COMB-KOH1HKNNUM      =    "027"
             IF       MAX-KIN-KOHI1-D        NOT =  ZERO
               IF   FTN-KOHI1-D-ENTANI     >=     MAX-KIN-KOHI1-D
                       MOVE     "1"       TO     FLG-SANTEI1-ENTANI
               END-IF
             END-IF
             IF       MAX-KIN-KOHI1-M        NOT =  ZERO
               IF   FTN-KOHI1-M-ENTANI     >=     MAX-KIN-KOHI1-M
                       MOVE     "1"       TO     FLG-SANTEI1-ENTANI
               END-IF
             END-IF
           END-IF.
      *
           IF         MAX-KIN-SYU-M          NOT =  ZERO
               IF  FTN-SYU-M-ENTANI        >=     MAX-KIN-SYU-M
                      MOVE  "1"           TO     FLG-SANTEI-SYU-ENTANI
               END-IF
           END-IF.
      *
      *    保険（公費）テーブルの患者負担上限額と当月の患者負担累計額
      *    から算定可能残額を算出する
      *
           IF  FLG-SANTEI1-ENTANI          =     "1"
               MOVE     ZERO             TO    ZAN-KOHI1-D-ENTANI
                                               ZAN-KOHI1-M-ENTANI
           ELSE
               IF  COMB-KOH1HKNNUM           =   "027"
                   IF       MAX-KIN-KOHI1-D       NOT = ZERO
                     COMPUTE  ZAN-KOHI1-D-ENTANI =   MAX-KIN-KOHI1-D
                                                 -   FTN-KOHI1-D-ENTANI
                   END-IF
                   IF       MAX-KIN-KOHI1-M       NOT = ZERO
                     COMPUTE  ZAN-KOHI1-M-ENTANI =   MAX-KIN-KOHI1-M
                                                 -   FTN-KOHI1-M-ENTANI
                   END-IF
               END-IF
           END-IF.
      *
           IF  FLG-SANTEI-SYU-ENTANI         =     "1"
               MOVE     ZERO             TO    ZAN-SYU-M-ENTANI
           ELSE
               IF       MAX-KIN-SYU-M    NOT = ZERO
                     COMPUTE  ZAN-SYU-M-ENTANI  =   MAX-KIN-SYU-M
                                                -   FTN-SYU-M-ENTANI
               END-IF
           END-IF.
      *
           IF  COMB-KOH1HKNNUM           =   "027"
      *
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)
                     IF    ZAN-KOHI1-D-ENTANI  >    ZAN-KOHI1-M-ENTANI
                        MOVE   ZAN-KOHI1-M-ENTANI  TO  ZAN-KOHI1-ENTANI
                     ELSE
                        MOVE   ZAN-KOHI1-D-ENTANI  TO  ZAN-KOHI1-ENTANI
                     END-IF
                   WHEN  (MAX-KIN-KOHI1-D   NOT =   ZERO)   AND
                         (MAX-KIN-KOHI1-M   =       ZERO)
                        MOVE   ZAN-KOHI1-D-ENTANI  TO   ZAN-KOHI1-ENTANI
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND
                         (MAX-KIN-KOHI1-M   NOT =   ZERO)
                        MOVE   ZAN-KOHI1-M-ENTANI  TO   ZAN-KOHI1-ENTANI
                   WHEN  (MAX-KIN-KOHI1-D   =       ZERO)   AND
                         (MAX-KIN-KOHI1-M   =       ZERO)
                        MOVE   ZERO                TO   ZAN-KOHI1-ENTANI
               END-EVALUATE
      *
           END-IF.
      *
       2302-SYUENTANI-ZAN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        主保険の患者負担金額計算                                *
      ******************************************************************
       2303-SYUHOKEN-KEISAN-SEC           SECTION.
      *
      *    該当保険番号テーブルの検索
           INITIALIZE                      HKNNUM-REC.
           MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM.
           MOVE   COMB-HKNNUM        TO    HKN-HKNNUM.
           MOVE   "00"               TO    WK-PAYKBN.
           MOVE   HKNNUM-REC         TO    MCPDATA-REC.
           MOVE   "DBSELECT"         TO    MCP-FUNC.
           MOVE   "tbl_hknnum"       TO    MCP-TABLE.
           MOVE   "key2"             TO    MCP-PATHNAME.
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA.
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  HKNNUM-READ-SEC
               PERFORM  UNTIL
                 (FLG-HKNNUM     =    1)                       OR
                ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                 (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6))   AND
                 (WK-PAYKBN            =  HKN-PAYKBN))
                   MOVE     "tbl_hknnum"  TO    MCP-TABLE
                   MOVE     "key2"        TO    MCP-PATHNAME
                   PERFORM   HKNNUM-READ-SEC
               END-PERFORM
               IF   FLG-HKNNUM   =    1
                 MOVE     11         TO    LNK-S01-RC
               END-IF
           ELSE
               MOVE       11         TO    LNK-S01-RC
           END-IF.
      *
           MOVE     "tbl_hknnum"  TO    MCP-TABLE.
           MOVE     "key2"        TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    保険組合せテーブルの補助区分から患者の負担割合を保険番号
      *    テーブルに再セット（国保のみ）
           IF    COMB-HKNNUM           =    "060" OR "039"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "0"
                          MOVE   ZERO      TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "1"
                   WHEN   "4"
                          MOVE   10        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "2"
                   WHEN   "5"
                          MOVE   20        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "3"
                   WHEN   "6"
                          MOVE   30        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
      *
      *    健保の高齢者についても補助区分より負担割合セット
           ELSE
               EVALUATE   COMB-HOJOKBN
                   WHEN   "9"
                          MOVE   10        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "8"
                          MOVE   20        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "7"
                          MOVE   30        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
      *
           END-IF.
      *
      *    岡山県西粟倉村退職者国保（前期高齢者を除く）
           IF  (FLG-TOKUREI-HKNJYA    =     1    )
           AND (COMB-HOJOKBN          =   SPACE  )
           AND (LNK-SYU-SRYYMD(1:6)  <=  "201109")
                 MOVE   20      TO   HKN-HON-GAIKFTNRATE
                                     HKN-KZK-GAIKFTNRATE
                                     HKN-TSY-GAIKFTNRATE
                                     HKN-TNK-GAIKFTNRATE
           END-IF.
      *
      *    年齢３歳未満
           IF      LNK-SYU-SRYYMD       >=      "20021001"
           AND     LNK-SYU-SRYYMD       <=      "20080331"
               INITIALIZE                           PTINF-REC
               MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM
               MOVE    LNK-SYU-PTID         TO      PTINF-PTID
               MOVE    PTINF-REC            TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "tbl_ptinf"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptinf"      TO      MCP-TABLE
                   MOVE    "key"            TO      MCP-PATHNAME
                   PERFORM  PTINF-READ-SEC
                   IF       MCP-RC          =       ZERO
                        MOVE   PTINF-BIRTHDAY   TO  WRK-YMDS1
                        MOVE   LNK-SYU-SRYYMD   TO  WRK-YMDS2
                        MOVE   ZERO             TO  WRK-NENREI
                        COMPUTE  WRK-NENREI     =   WRK-YYS2
                                                -   WRK-YYS1
                        IF   WRK-YMDS1(5:4)     >   WRK-YMDS2(5:4)
                             ADD   -1           TO  WRK-NENREI
                        END-IF
                        IF   WRK-NENREI         =   3
                        AND  WRK-YMDS1(5:4)    <=   WRK-YMDS2(5:4)
                            IF    WRK-YMDS1(5:2)  = WRK-YMDS2(5:2)
                                  IF   WRK-YMDS1(7:2)  NOT = "01"
                                       ADD   -1     TO  WRK-NENREI
                                  END-IF
                            END-IF
                        END-IF
                   ELSE
                        DISPLAY  "PTINF FETCH ERR"
                        MOVE     ZERO   TO      WRK-NENREI
                   END-IF
               ELSE
                   DISPLAY   "PTINF SELECT ERR"
                   MOVE     ZERO   TO      WRK-NENREI
               END-IF
      *
               MOVE    "tbl_ptinf"          TO       MCP-TABLE
               MOVE    "key"                TO       MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
               IF      WRK-NENREI         <     3
                   IF   COMB-HKNNUM       =     "060"
                       IF   COMB-HOJOKBN  =     "0"  OR  "1"
                                                     OR  "4"
                           CONTINUE
                       ELSE
                           MOVE   20      TO   HKN-HON-GAIKFTNRATE
                                               HKN-KZK-GAIKFTNRATE
                                               HKN-TSY-GAIKFTNRATE
                                               HKN-TNK-GAIKFTNRATE
                       END-IF
                   ELSE
                       IF    HKN-HKNKOHSBTKBN  =  "1" 
                           MOVE   20      TO   HKN-HON-GAIKFTNRATE
                                               HKN-KZK-GAIKFTNRATE
                                               HKN-TSY-GAIKFTNRATE
                                               HKN-TNK-GAIKFTNRATE
                       END-IF 
                   END-IF
               END-IF
           END-IF.
      *    義務教育就学前
           IF      LNK-SYU-SRYYMD       >=      "20080401"
               IF      FLG-SYUGAKUMAE    =       1
                   IF   COMB-HKNNUM       =     "060"
                       IF   COMB-HOJOKBN  =     "0"  OR  "1"
                                                     OR  "4"
                           CONTINUE
                       ELSE
                           MOVE   20      TO   HKN-HON-GAIKFTNRATE
                                               HKN-KZK-GAIKFTNRATE
                                               HKN-TSY-GAIKFTNRATE
                                               HKN-TNK-GAIKFTNRATE
                       END-IF
                   ELSE
                       IF    HKN-HKNKOHSBTKBN  =  "1" 
                           MOVE   20      TO   HKN-HON-GAIKFTNRATE
                                               HKN-KZK-GAIKFTNRATE
                                               HKN-TSY-GAIKFTNRATE
                                               HKN-TNK-GAIKFTNRATE
                       END-IF 
                   END-IF
               END-IF
           END-IF.
      *
      *    保険組合せテーブルの補助区分から患者の負担割合を保険番号
      *    テーブルに再セット（船員保険時）
           IF    COMB-HKNNUM                =    "002"
           AND   LNK-S01-SENINFLG(IDY)  NOT =    "1"  
               EVALUATE   COMB-HOJOKBN
                   WHEN   "1"
                   WHEN   "2"
                   WHEN   "3"
                   WHEN   "A"
                   WHEN   "B"
                   WHEN   "C"
                   WHEN   "D"
                   WHEN   "E"
                   WHEN   "F"
                   WHEN   "G"
                   WHEN   "H"
                   WHEN   "I"
                          MOVE   ZERO      TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
           END-IF.
      *    保険組合せテーブルの補助区分から患者の負担割合を保険番号
      *    テーブルに再セット（共済組合保険時）
           IF    COMB-HKNNUM    =    "031" OR "032" OR "033" OR "034"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "2"
                   WHEN   "B"
                   WHEN   "E"  
                   WHEN   "H"
                          MOVE   ZERO      TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
           END-IF.
      *
      *    特別療養費
           IF    COMB-HKNNUM    =    "068" OR "069" OR "040"
                          MOVE   100       TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
           END-IF.
      *
      *    患者負担金算出前の１００％負担額算出
           IF    (WK-HKNKBN         =   "1"  OR  "2")
           OR    (COMB-HKNNUM(1:1)  =   "0"         )
                 MOVE    10    TO      HKN-TENTNK
           ELSE
             IF   HKN-TENTNK   =   ZERO
                 MOVE    10    TO      HKN-TENTNK
             END-IF
           END-IF.
           MOVE      ZERO      TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX9    FROM    1   BY  1
                     UNTIL     IDX9       >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                            (LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK)
           END-PERFORM.
      *
           IF   (COMB-SYU-HKNKOHSBTKBN  =   "8" OR "9")
           AND  (HKN-TENTNK              NOT =   10   )
               IF   HKN-HON-GAIKFTNRATE     NOT =   ZERO
                   MOVE     100       TO   HKN-HON-GAIKFTNRATE
               END-IF
               IF   HKN-KZK-GAIKFTNRATE     NOT =   ZERO
                   MOVE     100       TO   HKN-KZK-GAIKFTNRATE
               END-IF
           END-IF.
      *
      *    （ＷＫ−ＨＫＮＫＢＮ　空白：医保　１：労災　２：自賠責）
           EVALUATE   WK-HKNKBN
             WHEN   SPACE
               IF   COMB-HONKZKKBN        =   "1"
                        MOVE  HKN-HON-GAIKFTNRATE
                                         TO  WK-KOH-FTNRATE
                                             WK-GAIKFTNRATE-TOKUSYU
                        IF    HKN-HON-GAIKFTNRATE     NOT =    ZERO
                              COMPUTE   WK-FUTANWARI  =
                                        HKN-HON-GAIKFTNRATE  /  100
                              COMPUTE   LNK-SYU-SYUCOMPFTN  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   LNK-SYU-SYUCOMPFTN-ENTANI  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   WK-SKYCHK-KEISAN9 =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   WK-SKYCHK-KEISAN9 =
                                        WK-SKYCHK-KEISAN9 +
                                        WK-SKYMONEY-ZEI
                              IF (FLG-GENBUTU70          NOT =   ZERO)
                              OR (FLG-TOKU75-CYO             =    3  )
                              OR (FLG-CYOKI-ARI              =    2  )
                                IF   FLG-MARUKO  =  2
                                   COMPUTE  WK-MARUKO-XX    =
                                            WK-ZENGAKU      +
                                            WK-MARUKO-KIN
                                   COMPUTE  WK-MARUKO-FTN   =
                                            WK-MARUKO-XX    *
                                            WK-FUTANWARI
                                END-IF
                              END-IF
                              IF   LNK-S01-SENINFLG(IDY)    =  "1"      
                                IF LNK-SYU-SYUCOMPFTN       >  200      
                                   MOVE   200  TO
                                           LNK-SYU-SYUCOMPFTN
                                           LNK-SYU-SYUCOMPFTN-ENTANI
                                END-IF                                  
                              END-IF                                    
                              IF ((COMB-SYU-HKNKOHSBTKBN     = "8" ) AND
                                  (WK-1001-JIHIPOSITION  NOT = "2" ) AND
                                  (COMB-HOJOKBN              = "1" ) AND
                                  (LNK-SYU-SRYYMD(1:6)  >= "200704"))
                              OR ((COMB-SYU-HKNKOHSBTKBN     = "9" ) AND
                                  (COMB-HOJOKBN              = "1" ) AND
                                  (LNK-SYU-SRYYMD(1:6)  >= "200704"))
                                 COMPUTE  LNK-SYU-SYUCOMPFTN =
                                          LNK-SYU-SYUCOMPFTN +
                                          WK-SKYMONEY-ZEI
                                 COMPUTE  LNK-SYU-SYUCOMPFTN-ENTANI =
                                          LNK-SYU-SYUCOMPFTN-ENTANI +
                                          WK-SKYMONEY-ZEI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN4
                              MOVE      LNK-SYU-SYUCOMPFTN
                                              TO WK-WAKAYAMA-SYUCOMPFTN
      *                       減額
                              MOVE      WK-KOH-FTNRATE
                                                 TO WK-GAIKFTNRATE2
                              PERFORM   23032-SYU-GENGAKU-HENSYU-SEC
                              IF  WK-GENGAKUKBN  NOT =  ZERO
                                  MOVE  WK-GENGAKU-GAK
                                          TO  LNK-SYU-SYUCOMPFTN
                                  MOVE  WK-GENGAKU-GAK-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN2
                              IF ((COMB-SYU-HKNKOHSBTKBN  =  "8"  ) AND
                                  (WK-1001-JIHIPOSITION   =  "3"  ) AND
                                  (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR ( COMB-SYU-HKNKOHSBTKBN  =  "9"   )
                                 CONTINUE
                              ELSE
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           LNK-SYU-SYUCOMPFTN  +  5
                                 COMPUTE   WK-FTN      =
                                           LNK-SYU-SYUCOMPFTN  /  10
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           WK-FTN   *  10
                              END-IF
                              MOVE  LNK-SYU-SYUCOMPFTN  TO
                                              WK-KUMAMOTO-SYUCOMPFTN
                        END-IF
                        MOVE  HKN-HON-GAIYKZFTNKBN
                                             TO   LNK-SYU-SYUYKZFTNKBN
                        IF    HKN-HON-GAIYKZFTNKBN  NOT =  "0"
                            MOVE  YAKFTN-SOGOKEI
                                             TO   LNK-SYU-SYUCOMPYKZFTN
                            IF    HKN-HON-GAIYKZFTNKBN  =  "1"
                                  MOVE  YAKFTN-SOGOKEI
                                             TO   WK-SYU-YAKFTN
                            END-IF
                        END-IF
      *
                        IF    FLG-GENBUTU70          NOT =  ZERO
                          IF  FLG-TOKU75  =  3
                            IF  WK-TOKUTEI-COMPFTN4  >=  10500
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (COMB-KOH1HKNNUM        =  SPACE
                                                        OR "970")
                            AND (COMB-KOH2HKNNUM        =  SPACE)
                            AND (COMB-KOH3HKNNUM        =  SPACE)
                            AND (COMB-KOH4HKNNUM        =  SPACE)
                            AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                            AND (WK-GENBUTU-HKNKIN  NOT =  ZERO )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  10500
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                          ELSE
                            IF  WK-TOKUTEI-COMPFTN4  >=  21000
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (COMB-KOH1HKNNUM        =  SPACE
                                                        OR "970")
                            AND (COMB-KOH2HKNNUM        =  SPACE)
                            AND (COMB-KOH3HKNNUM        =  SPACE)
                            AND (COMB-KOH4HKNNUM        =  SPACE)
                            AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                            AND (WK-GENBUTU-HKNKIN  NOT =  ZERO )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  21000
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                          END-IF
                        END-IF
      *
      *平成１４年１０月改正対応
      *高齢者の在宅総合・在宅末期算定患者
      *
                        IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1")
                        OR  (FLG-KOHININBARAI             =    1 )
                        OR  (FLG-GENBUTU70            NOT =  ZERO)
                        OR  (FLG-TOKU75-CYO         = 1 OR 2 OR 3)
                        OR  (FLG-CYOKI-ARI          = 1 OR 2     )
                         IF  (FLG-GENBUTU70      NOT =  ZERO )
                         AND (COMB-KOH1HKNNUM        =  SPACE
                                                     OR "970")
                         AND (COMB-KOH2HKNNUM        =  SPACE)
                         AND (COMB-KOH3HKNNUM        =  SPACE)
                         AND (COMB-KOH4HKNNUM        =  SPACE)
                         AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                         AND (LNK-SYU-SRYYMD(1:6) >= "201204")
                            MOVE WK-TOKUTEI-COMPFTN2
                                                 TO  WK-TOKUTEI-COMPFTN
                            IF    FLG-KOUGAKUCYO-GEN70 =    1
                               MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                            END-IF
                         ELSE
                            IF  ZAN-SYU-M     <=    WK-TOKUTEI-COMPFTN2 
                                MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
                                                     WK-TOKUTEI-COMPFTN 
                                IF ((FLG-GENBUTU70  NOT =  ZERO) AND
                                    (COMB-KOH1HKNNUM    = SPACE
                                                       OR "970") AND
                                    (COMB-KOH2HKNNUM    = SPACE) AND
                                    (COMB-KOH3HKNNUM    = SPACE) AND
                                    (COMB-KOH4HKNNUM    = SPACE) AND
                                    (LNK-SYU-SRYYMD(1:6)
                                                    >= "201204"))
                                OR ((LNK-S01-KOUREI-ZAITAKU-KBN
                                                        =  "1" ) AND
                                    (COMB-KOH1HKNNUM    = SPACE
                                                       OR "970") AND
                                    (COMB-KOH2HKNNUM    = SPACE) AND
                                    (COMB-KOH3HKNNUM    = SPACE) AND
                                    (COMB-KOH4HKNNUM    = SPACE) AND
                                    (LNK-SYU-SRYYMD(1:6)
                                                    >= "201204"))
                                  MOVE   1  TO   LNK-SYU-SKJ-FTNGAKU(1)
                                END-IF
                            ELSE                                        
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                                IF    FLG-KOUGAKUCYO-ININ  =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-ININ
                                END-IF
                                IF    FLG-KOUGAKUCYO-GEN70 =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                                END-IF
                                IF    FLG-KOUGAKUCYO       =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO
                                END-IF
                                IF    FLG-KOUGAKUCYO3      =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO3
                                END-IF
                            END-IF
                            IF  ZAN-SYU-M-ENTANI
                                              <     WK-TOKUTEI-COMPFTN2
                                MOVE  ZAN-SYU-M-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                            END-IF
                         END-IF
                        ELSE
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                        END-IF
                        COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                                  LNK-SYU-SYUCOMPFTN     +
                                  LNK-SYU-SYUCOMPYKZFTN
                        IF   COMB-KOH1HKNNUM  =  "970"
                          MOVE    WK-TOKUTEI-COMPFTN
                                        TO  LNK-SYU-RSIJIBAI-SKYMONEY
                          IF   WK-1001-DAISANKBN     =  "1"
                          AND  FLG-KOUGAKUCYO-GEN70  =  ZERO
                          AND  FLG-KOUGAKUCYO        =  ZERO
                            COMPUTE LNK-SYU-RSIJIBAI-SKYMONEY =
                                    LNK-SYU-RSIJIBAI-SKYMONEY +  5
                            COMPUTE WK-FTN      =
                                    LNK-SYU-RSIJIBAI-SKYMONEY /  10
                            COMPUTE LNK-SYU-RSIJIBAI-SKYMONEY =
                                    WK-FTN   *  10
                          END-IF
                          MOVE    LNK-SYU-RSIJIBAI-SKYMONEY
                                        TO  WK-SKYCHK-KEISAN10
                        END-IF
               ELSE
                        MOVE  HKN-KZK-GAIKFTNRATE
                                         TO  WK-KOH-FTNRATE
                                             WK-GAIKFTNRATE-TOKUSYU
                        IF    HKN-KZK-GAIKFTNRATE     NOT =    ZERO
                              COMPUTE   WK-FUTANWARI  =
                                        HKN-KZK-GAIKFTNRATE  /  100
                              COMPUTE   LNK-SYU-SYUCOMPFTN  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   LNK-SYU-SYUCOMPFTN-ENTANI  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   WK-SKYCHK-KEISAN9 =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   WK-SKYCHK-KEISAN9 =
                                        WK-SKYCHK-KEISAN9 +
                                        WK-SKYMONEY-ZEI
                              IF (FLG-GENBUTU70          NOT =   ZERO)
                              OR (FLG-TOKU75-CYO             =    3  )
                              OR (FLG-CYOKI-ARI              =    2  )
                                IF   FLG-MARUKO  =  2
                                   COMPUTE  WK-MARUKO-XX    =
                                            WK-ZENGAKU      +
                                            WK-MARUKO-KIN
                                   COMPUTE  WK-MARUKO-FTN   =
                                            WK-MARUKO-XX    *
                                            WK-FUTANWARI
                                END-IF
                              END-IF
                              IF ((COMB-SYU-HKNKOHSBTKBN     = "8" ) AND
                                  (WK-1001-JIHIPOSITION  NOT = "2" ) AND
                                  (COMB-HOJOKBN              = "1" ) AND
                                  (LNK-SYU-SRYYMD(1:6)  >= "200704"))
                              OR ((COMB-SYU-HKNKOHSBTKBN     = "9" ) AND
                                  (COMB-HOJOKBN              = "1" ) AND
                                  (LNK-SYU-SRYYMD(1:6)  >= "200704"))
                                 COMPUTE  LNK-SYU-SYUCOMPFTN =
                                          LNK-SYU-SYUCOMPFTN +
                                          WK-SKYMONEY-ZEI
                                 COMPUTE  LNK-SYU-SYUCOMPFTN-ENTANI =
                                          LNK-SYU-SYUCOMPFTN-ENTANI +
                                          WK-SKYMONEY-ZEI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN4
                              MOVE      LNK-SYU-SYUCOMPFTN
                                              TO WK-WAKAYAMA-SYUCOMPFTN
      *                       減額
                              MOVE      WK-KOH-FTNRATE
                                                 TO WK-GAIKFTNRATE2
                              PERFORM   23032-SYU-GENGAKU-HENSYU-SEC
                              IF  WK-GENGAKUKBN  NOT =  ZERO
                                  MOVE  WK-GENGAKU-GAK
                                          TO  LNK-SYU-SYUCOMPFTN
                                  MOVE  WK-GENGAKU-GAK-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN2
                              IF ((COMB-SYU-HKNKOHSBTKBN  =  "8"  ) AND
                                  (WK-1001-JIHIPOSITION   =  "3"  ) AND
                                  (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR ( COMB-SYU-HKNKOHSBTKBN  =  "9"   )
                                 CONTINUE
                              ELSE
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           LNK-SYU-SYUCOMPFTN  +  5
                                 COMPUTE   WK-FTN      =
                                           LNK-SYU-SYUCOMPFTN  /  10
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           WK-FTN   *  10
                              END-IF
                              MOVE  LNK-SYU-SYUCOMPFTN  TO
                                              WK-KUMAMOTO-SYUCOMPFTN
                        END-IF
                        MOVE  HKN-KZK-GAIYKZFTNKBN
                                             TO   LNK-SYU-SYUYKZFTNKBN
                        IF    HKN-KZK-GAIYKZFTNKBN  NOT =  "0"
                            MOVE  YAKFTN-SOGOKEI
                                             TO   LNK-SYU-SYUCOMPYKZFTN
                            IF    HKN-KZK-GAIYKZFTNKBN  =  "1"
                                  MOVE  YAKFTN-SOGOKEI
                                             TO   WK-SYU-YAKFTN
                            END-IF
                        END-IF
      *
                        IF    FLG-GENBUTU70          NOT =  ZERO
                          IF  FLG-TOKU75  =  3
                            IF  WK-TOKUTEI-COMPFTN4  >=  10500
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (COMB-KOH1HKNNUM        =  SPACE
                                                        OR "970")
                            AND (COMB-KOH2HKNNUM        =  SPACE)
                            AND (COMB-KOH3HKNNUM        =  SPACE)
                            AND (COMB-KOH4HKNNUM        =  SPACE)
                            AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                            AND (WK-GENBUTU-HKNKIN  NOT =  ZERO )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  10500
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                          ELSE
                            IF  WK-TOKUTEI-COMPFTN4  >=  21000
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (COMB-KOH1HKNNUM        =  SPACE
                                                        OR "970")
                            AND (COMB-KOH2HKNNUM        =  SPACE)
                            AND (COMB-KOH3HKNNUM        =  SPACE)
                            AND (COMB-KOH4HKNNUM        =  SPACE)
                            AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                            AND (WK-GENBUTU-HKNKIN  NOT =  ZERO )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  21000
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                          END-IF
                        END-IF
      *
      *平成１４年１０月改正対応
      *高齢者の在宅総合・在宅末期算定患者
      *
                        IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =   "1")
                        OR  (FLG-KOHININBARAI             =    1 )
                        OR  (FLG-GENBUTU70            NOT =  ZERO)
                        OR  (FLG-TOKU75-CYO         = 1 OR 2 OR 3)
                        OR  (FLG-CYOKI-ARI          = 1 OR 2     )
                         IF  (FLG-GENBUTU70      NOT =  ZERO )
                         AND (COMB-KOH1HKNNUM        =  SPACE
                                                     OR "970")
                         AND (COMB-KOH2HKNNUM        =  SPACE)
                         AND (COMB-KOH3HKNNUM        =  SPACE)
                         AND (COMB-KOH4HKNNUM        =  SPACE)
                         AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                         AND (LNK-SYU-SRYYMD(1:6) >= "201204")
                            MOVE WK-TOKUTEI-COMPFTN2
                                                 TO  WK-TOKUTEI-COMPFTN
                            IF    FLG-KOUGAKUCYO-GEN70 =    1
                               MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                            END-IF
                         ELSE
                            IF  ZAN-SYU-M     <=    WK-TOKUTEI-COMPFTN2 
                                MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
                                                     WK-TOKUTEI-COMPFTN 
                                IF ((FLG-GENBUTU70  NOT =  ZERO) AND
                                    (COMB-KOH1HKNNUM    = SPACE
                                                       OR "970") AND
                                    (COMB-KOH2HKNNUM    = SPACE) AND
                                    (COMB-KOH3HKNNUM    = SPACE) AND
                                    (COMB-KOH4HKNNUM    = SPACE) AND
                                    (LNK-SYU-SRYYMD(1:6)
                                                    >= "201204"))
                                OR ((LNK-S01-KOUREI-ZAITAKU-KBN
                                                        =  "1" ) AND
                                    (COMB-KOH1HKNNUM    = SPACE
                                                       OR "970") AND
                                    (COMB-KOH2HKNNUM    = SPACE) AND
                                    (COMB-KOH3HKNNUM    = SPACE) AND
                                    (COMB-KOH4HKNNUM    = SPACE) AND
                                    (LNK-SYU-SRYYMD(1:6)
                                                    >= "201204"))
                                  MOVE   1  TO   LNK-SYU-SKJ-FTNGAKU(1)
                                END-IF
                            ELSE                                        
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                                IF    FLG-KOUGAKUCYO-ININ  =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-ININ
                                END-IF
                                IF    FLG-KOUGAKUCYO-GEN70 =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                                END-IF
                                IF    FLG-KOUGAKUCYO       =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO
                                END-IF
                                IF    FLG-KOUGAKUCYO3      =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO3
                                END-IF
                            END-IF
                            IF  ZAN-SYU-M-ENTANI
                                              <     WK-TOKUTEI-COMPFTN2
                                MOVE  ZAN-SYU-M-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                            END-IF
                         END-IF
                        ELSE
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                        END-IF
                        COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                                  LNK-SYU-SYUCOMPFTN     +
                                  LNK-SYU-SYUCOMPYKZFTN
                        IF   COMB-KOH1HKNNUM  =  "970"
                          MOVE    WK-TOKUTEI-COMPFTN
                                        TO  LNK-SYU-RSIJIBAI-SKYMONEY
                          IF   WK-1001-DAISANKBN     =  "1"
                          AND  FLG-KOUGAKUCYO-GEN70  =  ZERO
                          AND  FLG-KOUGAKUCYO        =  ZERO
                            COMPUTE LNK-SYU-RSIJIBAI-SKYMONEY =
                                    LNK-SYU-RSIJIBAI-SKYMONEY +  5
                            COMPUTE WK-FTN      =
                                    LNK-SYU-RSIJIBAI-SKYMONEY /  10
                            COMPUTE LNK-SYU-RSIJIBAI-SKYMONEY =
                                    WK-FTN   *  10
                          END-IF
                          MOVE    LNK-SYU-RSIJIBAI-SKYMONEY
                                        TO  WK-SKYCHK-KEISAN10
                        END-IF
               END-IF
             WHEN   "1"
      *        システム管理マスタ（４００１）から点数単価の取得
               INITIALIZE                         SYS-4001-REC
               MOVE    "4001"               TO    SYS-4001-KANRICD
               MOVE    "*"                  TO    SYS-4001-KBNCD
               MOVE    LNK-SYU-HOSPNUM      TO    SYS-4001-HOSPNUM
               MOVE    LNK-SYU-SRYYMD       TO    SYS-4001-STYUKYMD
               MOVE    LNK-SYU-SRYYMD       TO    SYS-4001-EDYUKYMD
               MOVE    SYS-4001-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "tbl_syskanri"       TO    MCP-TABLE
               MOVE    "key10"              TO    MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =     ZERO
                   MOVE     "tbl_syskanri"  TO    MCP-TABLE
                   MOVE     "key10"         TO    MCP-PATHNAME
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
      *
                     IF    SYS-4001-KSNRATE1(1:3)   =  SPACE
                        IF    SYS-4001-KSNRATE(1:2)   =    SPACE
                            MOVE     100        TO   WK-4001-KSNRATE9
                            COMPUTE  WK-4001-KSNRATE   =
                                           WK-4001-KSNRATE9  /  100
                        ELSE
                            COMPUTE  WK-4001-KSNRATE9  =
                                           SYS-4001-KSNRATE  +  100
                            COMPUTE  WK-4001-KSNRATE   =
                                           WK-4001-KSNRATE9  /  100
                        END-IF
                     ELSE
                       MOVE SYS-4001-KSNRATE1   TO   WK-4001-KSNRATE9
                       COMPUTE  WK-4001-KSNRATE   =
                                           WK-4001-KSNRATE9  /  100
                     END-IF
                     MOVE   SYS-4001-TAXKBN     TO   WK-4001-TAXKBN
                     MOVE   SYS-4001-TAXKBN-KZI TO   WK-4001-TAXKBN-KZI
                     IF     SYS-4001-SYUTENTANKA-X  =  SPACE
                        MOVE  ZERO   TO  WK-4001-SYUTENTANKA
                     ELSE
                        MOVE  SYS-4001-SYUTENTANKA
                                     TO  WK-4001-SYUTENTANKA
                     END-IF
                     IF     SYS-4001-YKZTENTANKA-X  =  SPACE
                        MOVE  ZERO   TO  WK-4001-YKZTENTANKA
                     ELSE
                        MOVE  SYS-4001-YKZTENTANKA
                                     TO  WK-4001-YKZTENTANKA
                     END-IF
                     IF     SYS-4001-KOMUTENTANKA-X =  SPACE
                        MOVE  ZERO   TO  WK-4001-KOMUTENTANKA
                     ELSE
                        MOVE  SYS-4001-KOMUTENTANKA
                                     TO  WK-4001-KOMUTENTANKA
                     END-IF
                     IF     LNK-SYU-SYUHKNNUM       =  "971" OR "973"   
                       IF   LNK-SYU-PTFTNRATE       =   100             
                         MOVE     100      TO   HKN-HON-GAIKFTNRATE     
                                                HKN-KZK-GAIKFTNRATE     
                                                HKN-TSY-GAIKFTNRATE     
                                                HKN-TNK-GAIKFTNRATE     
                       ELSE                                             
                         MOVE     ZERO     TO   HKN-HON-GAIKFTNRATE     
                                                HKN-KZK-GAIKFTNRATE     
                                                HKN-TSY-GAIKFTNRATE     
                                                HKN-TNK-GAIKFTNRATE     
                       END-IF                                           
                     END-IF                                             
                     IF     LNK-SYU-SYUHKNNUM       =  "971"
                       IF    FLG-KENPOJYUNKYO  =  ZERO
                         MOVE   ZERO   TO   FLG-KOMURSI
                         IF  (SYS-4001-KOMURSITANKAKBN     =  "2"  )
                         AND (SYS-4001-KOMURSITANKA-G  NOT =  SPACE)
                           PERFORM   23031-PTRSIINF-KENSAKU-SEC
                         END-IF
                         IF   FLG-KOMURSI  =   1
                             COMPUTE      WK-ZENGAKU  =
                                         (WK-ZENGAKU  / 10
                                           *  SYS-4001-KOMURSITANKA)
                         ELSE
                             EVALUATE  SYS-4001-TENKBN
                               WHEN  "1"
                                 COMPUTE  WK-ZENGAKU  =  
                                         (WK-ZENGAKU  / 10 * 11.5)
                               WHEN  "2"
                                 COMPUTE  WK-ZENGAKU  =  
                                         (WK-ZENGAKU  / 10 * 12.0)
                             END-EVALUATE
                         END-IF
                       ELSE
                         COMPUTE WK-ZENGAKU =
                                (WK-ZENGAKU / 10 * WK-4001-KOMUTENTANKA)
                       END-IF
                     ELSE
                       IF    FLG-KENPOJYUNKYO  =  ZERO
                         EVALUATE  SYS-4001-TENKBN
                           WHEN  "1"
                              COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  /  10  
                              MOVE  LNK-S01-SYUTEN(IDY)
                                                TO  WK-ZENGAKU-SYU
                              COMPUTE  WK-ZENGAKU-YAK
                                                  = WK-ZENGAKU 
                                                  - LNK-S01-SYUTEN(IDY)
                              COMPUTE  WK-ZENGAKU-SYU =                 
                               (WK-ZENGAKU-SYU * 11.5 * WK-4001-KSNRATE)
                                                      + 0.5             
                              COMPUTE  WK-ZENGAKU-YAK =                 
                                (WK-ZENGAKU-YAK * 11.5)                 
                                                      + 0.5             
                              COMPUTE  WK-ZENGAKU     = WK-ZENGAKU-SYU
                                                      + WK-ZENGAKU-YAK
                           WHEN  "2"
                              COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  /  10  
                              MOVE  LNK-S01-SYUTEN(IDY)
                                                TO  WK-ZENGAKU-SYU
                              COMPUTE  WK-ZENGAKU-YAK
                                                  = WK-ZENGAKU 
                                                  - LNK-S01-SYUTEN(IDY)
                              COMPUTE  WK-ZENGAKU-SYU =                 
                               (WK-ZENGAKU-SYU * 12.0 * WK-4001-KSNRATE)
                                                      + 0.5             
                              COMPUTE  WK-ZENGAKU-YAK =                 
                                (WK-ZENGAKU-YAK * 12.0)                 
                                                      + 0.5             
                              COMPUTE  WK-ZENGAKU     = WK-ZENGAKU-SYU
                                                      + WK-ZENGAKU-YAK
                         END-EVALUATE
                       ELSE
                         COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  /  10
                         MOVE  LNK-S01-SYUTEN(IDY)
                                           TO  WK-ZENGAKU-SYU
                         COMPUTE  WK-ZENGAKU-YAK
                                             = WK-ZENGAKU
                                             - LNK-S01-SYUTEN(IDY)
                         COMPUTE  WK-ZENGAKU-SYU =
                                 (WK-ZENGAKU-SYU * WK-4001-SYUTENTANKA)
                                                 + 0.5
                         COMPUTE  WK-ZENGAKU-YAK =
                                 (WK-ZENGAKU-YAK * WK-4001-YKZTENTANKA)
                                                 + 0.5
                         COMPUTE  WK-ZENGAKU     = WK-ZENGAKU-SYU
                                                 + WK-ZENGAKU-YAK
                       END-IF
                     END-IF 
                   END-IF
               END-IF
      *
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key10"         TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
      *
               MOVE      WK-ZENGAKU     TO    LNK-SYU-RSIJIBAI-SKYMONEY
                                              WK-SKYCHK-KEISAN9
      *
               COMPUTE   WK-FUTANWARI  =
                         HKN-HON-GAIKFTNRATE  /  100
               COMPUTE   LNK-SYU-SYUCOMPFTN  =
                         WK-ZENGAKU   *  WK-FUTANWARI
      *         COMPUTE   LNK-SYU-SYUCOMPFTN =
      *                   LNK-SYU-SYUCOMPFTN  +  5
      *         COMPUTE   WK-FTN      =
      *                   LNK-SYU-SYUCOMPFTN  /  10
      *         COMPUTE   LNK-SYU-SYUCOMPFTN =
      *                   WK-FTN   *  10
               MOVE  HKN-HON-GAIYKZFTNKBN
                                   TO   LNK-SYU-SYUYKZFTNKBN
               IF    HKN-HON-GAIYKZFTNKBN  NOT =  "0"
                     MOVE  YAKFTN-SOGOKEI
                                   TO   LNK-SYU-SYUCOMPYKZFTN
                  IF    HKN-HON-GAIYKZFTNKBN  =  "1"
                     MOVE  YAKFTN-SOGOKEI
                                   TO   WK-SYU-YAKFTN
                  END-IF
               END-IF
               COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                         LNK-SYU-SYUCOMPFTN     +
                         LNK-SYU-SYUCOMPYKZFTN
             WHEN   "2"
               MOVE     ZERO           TO  HKN-HON-GAIKFTNRATE
                                           HKN-KZK-GAIKFTNRATE
                                           HKN-TSY-GAIKFTNRATE
                                           HKN-TNK-GAIKFTNRATE
      *
               COMPUTE  WK-ZENGAKU     =   WK-ZENGAKU  /  10
               MOVE     LNK-S01-SYUTEN(IDY)  TO  WK-ZENGAKU-SYU
               COMPUTE  WK-ZENGAKU-YAK =   WK-ZENGAKU
                                       -   LNK-S01-SYUTEN(IDY)
               COMPUTE  WK-ZENGAKU-SYU =   WK-ZENGAKU-SYU * 15
               COMPUTE  WK-ZENGAKU-YAK =   WK-ZENGAKU-YAK * 10
               COMPUTE  WK-ZENGAKU     =   WK-ZENGAKU-SYU
                                       +   WK-ZENGAKU-YAK
      *
               MOVE      WK-ZENGAKU    TO  LNK-SYU-RSIJIBAI-SKYMONEY
                                           WK-SKYCHK-KEISAN9
      *
               COMPUTE   WK-FUTANWARI  =
                         HKN-HON-GAIKFTNRATE  /  100
               COMPUTE   LNK-SYU-SYUCOMPFTN  =
                         WK-ZENGAKU    *  WK-FUTANWARI
      *
               MOVE  HKN-HON-GAIYKZFTNKBN
                                   TO   LNK-SYU-SYUYKZFTNKBN
               IF    HKN-HON-GAIYKZFTNKBN  NOT =  "0"
                     MOVE  YAKFTN-SOGOKEI
                                   TO   LNK-SYU-SYUCOMPYKZFTN
                  IF    HKN-HON-GAIYKZFTNKBN  =  "1"
                     MOVE  YAKFTN-SOGOKEI
                                   TO   WK-SYU-YAKFTN
                  END-IF
               END-IF
               COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                         LNK-SYU-SYUCOMPFTN     +
                         LNK-SYU-SYUCOMPYKZFTN
           END-EVALUATE.
      *
       2303-SYUHOKEN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        労災の保険区分取得                                      *
      ******************************************************************
       23031-PTRSIINF-KENSAKU-SEC           SECTION.
      *
           INITIALIZE                     PTRSIINF-REC
           MOVE    COMB-HOSPNUM      TO   PTRSI-HOSPNUM
           MOVE    COMB-PTID         TO   PTRSI-PTID
           MOVE    COMB-HKNID        TO   PTRSI-HKNID
           MOVE    PTRSIINF-REC      TO   MCPDATA-REC
           MOVE    "DBSELECT"        TO   MCP-FUNC
           MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
           MOVE    "key"             TO   MCP-PATHNAME
           CALL    "ORCDBMAIN"       USING   MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_ptrsiinf"  TO   MCP-TABLE
             MOVE    "key"           TO   MCP-PATHNAME
             PERFORM  PTRSIINF-READ-SEC
             IF    FLG-PTRSIINF     =  ZERO
               IF     PTRSI-HKNKBN  =  "5"
                  MOVE     1         TO   FLG-KOMURSI
               END-IF
             END-IF
           END-IF
           MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
           MOVE    "key"             TO   MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           .
      *
       23031-PTRSIINF-KENSAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    主保険一部負担金減額
      ******************************************************************
       23032-SYU-GENGAKU-HENSYU-SEC           SECTION.
      *
           EVALUATE  WK-GENGAKUKBN
             WHEN      1
               IF  WK-GENGAKUKBN-KEISAN  =  2
                 IF    WK-GENGAKU-RITU   =  ZERO
                     MOVE  LNK-SYU-SYUCOMPFTN
                                 TO  WK-GENGAKU-GAK
                     MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                 TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   IF  WK-GAIKFTNRATE2  <= WK-GENGAKU-RITU
                     MOVE  ZERO  TO  WK-GENGAKU-GAK
                     MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                     MOVE  ZERO  TO  WK-MARUKO-FTN
                   ELSE
                     COMPUTE  WK-FUTANWARI2   =
                              WK-GENGAKU-RITU / 100
                     COMPUTE  WK-GENGAKU-GAK2 =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     COMPUTE  WK-GENGAKU-GAK2-ENTANI =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     COMPUTE  WK-MARUKO-FTN2  =
                              WK-MARUKO-XX    * WK-FUTANWARI2
                     IF  LNK-SYU-SYUCOMPFTN
                                 > WK-GENGAKU-GAK2
                       COMPUTE WK-GENGAKU-GAK     =
                               LNK-SYU-SYUCOMPFTN -
                               WK-GENGAKU-GAK2
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK
                     END-IF
                     IF  LNK-SYU-SYUCOMPFTN-ENTANI
                                 > WK-GENGAKU-GAK2-ENTANI
                       COMPUTE WK-GENGAKU-GAK-ENTANI     =
                               LNK-SYU-SYUCOMPFTN-ENTANI -
                               WK-GENGAKU-GAK2-ENTANI
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                     END-IF
                     IF  WK-MARUKO-FTN
                                 > WK-MARUKO-FTN2
                       COMPUTE WK-MARUKO-FTN      =
                               WK-MARUKO-FTN      -
                               WK-MARUKO-FTN2
                     ELSE
                       MOVE  ZERO  TO  WK-MARUKO-FTN
                     END-IF
                   END-IF
                 END-IF
               ELSE
                 IF  WK-GENGAKU-RITU = 100
                   MOVE  ZERO  TO  WK-GENGAKU-GAK
                   MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                   MOVE  ZERO  TO  WK-MARUKO-FTN
                 ELSE
                   COMPUTE  WK-GENGAKU-RITUX =
                            100 - WK-GENGAKU-RITU
                   COMPUTE  WK-GENGAKU-GAK      =
                            LNK-SYU-SYUCOMPFTN  *
                            WK-GENGAKU-RITUX    /
                            100
                   COMPUTE  WK-GENGAKU-GAK-ENTANI     =
                            LNK-SYU-SYUCOMPFTN-ENTANI *
                            WK-GENGAKU-RITUX          /
                            100
                   COMPUTE  WK-MARUKO-FTN       =
                            WK-MARUKO-FTN       *
                            WK-GENGAKU-RITUX    /
                            100
                 END-IF
               END-IF
             WHEN      2
               PERFORM   230321-GENGAKU-ZAN1-SEC
             WHEN      3
             WHEN      4
               MOVE  ZERO  TO  WK-GENGAKU-GAK
               MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
               MOVE  ZERO  TO  WK-MARUKO-FTN
             WHEN      5
               PERFORM   230322-GENGAKU-ZAN2-SEC
           END-EVALUATE
      *
           .
       23032-SYU-GENGAKU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        減免残計算１                                            *
      ******************************************************************
       230321-GENGAKU-ZAN1-SEC           SECTION.
      *
           MOVE  ZERO  TO WK-GENGAKU-GAK9
           MOVE  ZERO  TO WK-GENGAKU-GAK9-ENTANI
           PERFORM VARYING IDX14 FROM 1 BY 1
                    UNTIL  IDX14   >  100
             COMPUTE  WK-GENGAKU-GAK8       =
                      WK-GENGAKU-TEN(IDX14) *
                      10                    *
                      WK-FUTANWARI
             COMPUTE  WK-GENGAKU-GAK8 = WK-GENGAKU-GAK8 +   5
             COMPUTE  WK-GENGAKU-GAK8 = WK-GENGAKU-GAK8 /  10
             COMPUTE  WK-GENGAKU-GAK8 = WK-GENGAKU-GAK8 *  10
             COMPUTE  WK-GENGAKU-GAK8-ENTANI  =
                      WK-GENGAKU-TEN(IDX14)   *
                      10                      *
                      WK-FUTANWARI
             ADD  WK-GENGAKU-GAK8         TO  WK-GENGAKU-GAK9
             ADD  WK-GENGAKU-GAK8-ENTANI  TO  WK-GENGAKU-GAK9-ENTANI
           END-PERFORM
      *
           IF  WK-GENGAKU-KIN <= WK-GENGAKU-GAK9
             MOVE   ZERO  TO  WK-GENGAKU-KIN2
           ELSE
             COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN
                                      - WK-GENGAKU-GAK9
           END-IF
           IF  WK-GENGAKU-KIN <= WK-GENGAKU-GAK9-ENTANI
             MOVE   ZERO  TO  WK-GENGAKU-KIN2-ENTANI
           ELSE
             COMPUTE  WK-GENGAKU-KIN2-ENTANI = WK-GENGAKU-KIN
                                             - WK-GENGAKU-GAK9-ENTANI
           END-IF
      *
           IF  LNK-SYU-SYUCOMPFTN < WK-GENGAKU-KIN2
             MOVE   ZERO  TO  WK-GENGAKU-GAK
           ELSE
             COMPUTE  WK-GENGAKU-GAK = LNK-SYU-SYUCOMPFTN
                                     - WK-GENGAKU-KIN2
           END-IF
           IF  LNK-SYU-SYUCOMPFTN-ENTANI < WK-GENGAKU-KIN2-ENTANI
             MOVE   ZERO  TO  WK-GENGAKU-GAK-ENTANI
           ELSE
             COMPUTE  WK-GENGAKU-GAK-ENTANI = LNK-SYU-SYUCOMPFTN-ENTANI
                                            - WK-GENGAKU-KIN2-ENTANI
           END-IF
           IF  WK-MARUKO-FTN < WK-GENGAKU-KIN2
             MOVE   ZERO  TO  WK-MARUKO-FTN
           ELSE
             COMPUTE  WK-MARUKO-FTN = WK-MARUKO-FTN
                                    - WK-GENGAKU-KIN2
           END-IF
      *
           .
      *
       230321-GENGAKU-ZAN1-EXT.
           EXIT.
      *
      ******************************************************************
      *        減免残計算２                                            *
      ******************************************************************
       230322-GENGAKU-ZAN2-SEC           SECTION.
      *
           MOVE  ZERO  TO WK-GENGAKU-GAK9
           MOVE  ZERO  TO WK-GENGAKU-GAK9-ENTANI
           PERFORM VARYING IDX14 FROM 1 BY 1
                    UNTIL  IDX14   >  100
             ADD  WK-GENGAKU-FTN(IDX14)   TO  WK-GENGAKU-GAK9
             ADD  WK-GENGAKU-FTN-ENTANI(IDX14)
                                          TO  WK-GENGAKU-GAK9-ENTANI
           END-PERFORM
      *
           IF  WK-GENGAKU-KIN <= WK-GENGAKU-GAK9
             MOVE   ZERO  TO  WK-GENGAKU-KIN2
           ELSE
             COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN
                                      - WK-GENGAKU-GAK9
           END-IF
           IF  WK-GENGAKU-KIN <= WK-GENGAKU-GAK9-ENTANI
             MOVE   ZERO  TO  WK-GENGAKU-KIN2-ENTANI
           ELSE
             COMPUTE  WK-GENGAKU-KIN2-ENTANI = WK-GENGAKU-KIN
                                             - WK-GENGAKU-GAK9-ENTANI
           END-IF
      *
           IF  LNK-SYU-SYUCOMPFTN < WK-GENGAKU-KIN2
             MOVE   LNK-SYU-SYUCOMPFTN      TO  WK-GENGAKU-GAK
           ELSE
             MOVE   WK-GENGAKU-KIN2         TO  WK-GENGAKU-GAK
           END-IF
           IF  LNK-SYU-SYUCOMPFTN-ENTANI < WK-GENGAKU-KIN2-ENTANI
             MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO  WK-GENGAKU-GAK-ENTANI
           ELSE
             MOVE   WK-GENGAKU-KIN2-ENTANI  TO  WK-GENGAKU-GAK-ENTANI
           END-IF
           IF  WK-MARUKO-FTN < WK-GENGAKU-KIN2
             CONTINUE
           ELSE
             MOVE   WK-GENGAKU-KIN2         TO  WK-MARUKO-FTN
           END-IF
      *
           .
      *
       230322-GENGAKU-ZAN2-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費の保険番号テーブル検索                              *
      ******************************************************************
       2304-KOH-HKNREAD-SEC           SECTION.
      *
      *    該当保険番号テーブルの検索
           INITIALIZE                      HKNNUM-REC.
           MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM.
           MOVE   COMB-KOHHKNNUM(KOH-IDX)
                                     TO    HKN-HKNNUM.
      *
           IF     COMB-KOHHKNNUM(KOH-IDX)  =     "027"
               IF   LNK-SYU-SRYYMD    >=   "20021001"
                  MOVE     COMB-KOH1PAYKBN     TO  WK-PAYKBN
               ELSE
                  MOVE     WK-1001-HOSPSBT     TO  WK-PAYKBN(1:1)
                  MOVE     WK-1001-ROUPAYKBN   TO  WK-PAYKBN(2:1)
               END-IF
           ELSE
                   MOVE     "00"         TO    WK-PAYKBN
           END-IF.
      *
           MOVE   HKNNUM-REC         TO    MCPDATA-REC.
           MOVE   "DBSELECT"         TO    MCP-FUNC.
           MOVE   "tbl_hknnum"       TO    MCP-TABLE.
           MOVE   "key2"             TO    MCP-PATHNAME.
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA.
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  HKNNUM-READ-SEC
               PERFORM  UNTIL
                 (FLG-HKNNUM     =    1)                       OR
                ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                 (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6))   AND
                 (WK-PAYKBN            =  HKN-PAYKBN))
                   MOVE     "tbl_hknnum"  TO    MCP-TABLE
                   MOVE     "key2"        TO    MCP-PATHNAME
                   PERFORM   HKNNUM-READ-SEC
               END-PERFORM
               IF   FLG-HKNNUM   =    1
                 MOVE     11         TO    LNK-S01-RC
               END-IF
           ELSE
               MOVE       11         TO    LNK-S01-RC
           END-IF.
      *
           MOVE     "tbl_hknnum"  TO    MCP-TABLE.
           MOVE     "key2"        TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    患者負担金算出前の１００％負担額算出
           IF    (COMB-KOHHKNNUM(KOH-IDX)(1:1)   =   "0"           )
           OR    (COMB-KOHHKNNUM(KOH-IDX)        =   "972" OR "974")
                 MOVE    10    TO      HKN-TENTNK
           ELSE
             IF   HKN-TENTNK   =   ZERO
                 MOVE    10    TO      HKN-TENTNK
             END-IF
           END-IF.
           MOVE      ZERO      TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX9    FROM    1   BY  1
                     UNTIL     IDX9       >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                            (LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK)
           END-PERFORM.
      *
           MOVE       ZERO                TO   WK-GAIKFTNRATE.
           MOVE       SPACE               TO   WK-GAIYKZFTNKBN.
           MOVE       ZERO                TO   WK-GAIKKOTGAK.
      *
           IF    COMB-KOHHKNNUM(KOH-IDX)(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-HON-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                 WHEN   "2"
                    IF   HKN-TSY-GAIFTNKBN      =  "0"
                      MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-HON-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                    ELSE
                      MOVE    HKN-TSY-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-TSY-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-TSY-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                    END-IF
                 WHEN   "3"
                    IF  HKN-TNK-GAIFTNKBN       =  "0"
                      MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-HON-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                    ELSE
                      MOVE    HKN-TNK-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-TNK-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-TNK-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                    END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  28                    ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  =
                                  "241" OR "180" OR "182" OR
                                  "143" OR "185" OR "127"       ) AND
                   ( LNK-SYU-SRYYMD(1:6)     >= "200507"        ))
               OR (( WK-1001-PREFNUM   =  11                    ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "344"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)     >= "200507"        ))
               OR (( WK-1001-PREFNUM   =  05                    ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "374" OR "474"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)     >= "200508"        ))
               OR (( WK-1001-PREFNUM   =  32                    ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "191" OR "391"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)     >= "200510"        ))
               OR (( WK-1001-PREFNUM   =  28                    ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "100"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)     >= "200604"        ))
               OR (( WK-1001-PREFNUM   =  33                    ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  =
                                  "141" OR "285" OR "485" OR
                                  "180" OR "186"                ) AND
                   ( LNK-SYU-SRYYMD(1:6)     >= "200610"        ))
               OR (( WK-1001-PREFNUM   =  19                    ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141"           ))
               OR (( WK-1001-PREFNUM   =  23                    ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)     >= "200610"        ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-HON-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                   WHEN   "2"
                    IF   HKN-TSY-GAIFTNKBN      =  "0"
                      MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-HON-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                    ELSE
                      MOVE    HKN-TSY-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-TSY-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-TSY-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                    END-IF
                   WHEN   "3"
                    IF  HKN-TNK-GAIFTNKBN       =  "0"
                      MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-HON-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                    ELSE
                      MOVE    HKN-TNK-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                      MOVE    HKN-TNK-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                      MOVE    HKN-TNK-GAIKKOTGAK   TO   WK-GAIKKOTGAK
                    END-IF
                 END-EVALUATE
               ELSE
                 MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
                 MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
                 MOVE    HKN-HON-GAIKKOTGAK   TO   WK-GAIKKOTGAK
               END-IF
             END-IF
           ELSE
             MOVE    HKN-HON-GAIKFTNRATE  TO   WK-GAIKFTNRATE
             MOVE    HKN-HON-GAIYKZFTNKBN TO   WK-GAIYKZFTNKBN
             MOVE    HKN-HON-GAIKKOTGAK   TO   WK-GAIKKOTGAK
           END-IF.
      *
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "027"
             MOVE    HKN-HON-GAIKFTNRATE  TO   WK-KOH-FTNRATE
             MOVE    "1"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
      *
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "012"
           AND  LNK-SYU-SRYYMD(1:6)     >=  "200604"
             MOVE    "2"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
      *
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "025"
             MOVE    "2"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
      *
           IF  (COMB-KOHHKNNUM(KOH-IDX)  =  "970")
           AND (LNK-SYU-PTFTNRATE    NOT =  ZERO )
             MOVE    LNK-SYU-PTFTNRATE    TO   WK-GAIKFTNRATE
             IF   WK-1001-DAISANKBN  = "2"
               MOVE  "2"                  TO   HKN-RECEFTNDSPKBN
             END-IF
           END-IF.
           IF  (COMB-KOHHKNNUM(KOH-IDX)  =  "970")
           AND (LNK-SYU-PTFTNRATE        =  ZERO )
             IF   WK-1001-DAISANKBN  = "2"
               MOVE  "2"                  TO   HKN-RECEFTNDSPKBN
             END-IF
           END-IF.
      *
           IF  (KOH-IDX                  =    1           )
           AND (COMB-KOHHKNNUM(KOH-IDX)  =  "010" OR "021")
              IF    (COMB-KOHHKNNUM(KOH-IDX)  =  "021"   )
              AND   (LNK-SYU-SRYYMD(1:6)     >=  "200604")
                 CONTINUE
              ELSE
                 IF   FLG-SEISINJYO  =  1
                   MOVE     ZERO     TO    WK-GAIKFTNRATE
                 END-IF
              END-IF
           END-IF.
      *
           IF  (COMB-HKNNUM              =  SPACE  )
           AND (COMB-KOHHKNNUM(KOH-IDX)  =  "010"  )
           AND (WK-GENGAKUKBN            =   3 OR 4)
           AND (FLG-SAIGAI-TAISYO        =   1     )
                   MOVE     SPACE    TO    COMB-KOH-GAIJGNKBN(KOH-IDX)
                   MOVE     ZERO     TO    WK-GAIKFTNRATE
           END-IF.
           IF  (COMB-HKNNUM              =  SPACE  )
           AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                >=  "1" AND <=  "8")
           AND (WK-GENGAKUKBN            =   3 OR 4)
           AND (FLG-SAIGAI-TAISYO        =   1     )
                   MOVE     SPACE    TO    COMB-KOH-GAIJGNKBN(KOH-IDX)
                   MOVE     ZERO     TO    WK-GAIKFTNRATE
           END-IF.
      *
           IF   (WK-1001-PREFNUM         =  35 OR 34)
           AND  (COMB-KOHHKNNUM(KOH-IDX) = "781"    )
           AND  (LNK-SYU-SRYYMD(1:6)    >= "201309" )
                   MOVE     ZERO     TO    WK-GAIKFTNRATE
                   MOVE     SPACE    TO    FLG-CHIHOU(KOH-IDX)
           END-IF.
      *
           IF   (WK-1001-PREFNUM         =  23              )
           AND  (COMB-KOHHKNNUM(KOH-IDX) = "581" OR "681" OR
                                           "781" OR "271"   )
           AND  (LNK-SYU-SRYYMD(1:6)    >= "201504"         )
                   MOVE     ZERO     TO    WK-GAIKFTNRATE
                   MOVE     SPACE    TO    FLG-CHIHOU(KOH-IDX)
           END-IF.
      *
      *    福岡県の地方公費対応（公費付加情報の取得）
           MOVE     SPACE     TO     WK-KOH-FTNKBN.
           IF     (WK-1001-PREFNUM           =       40)    AND
                  (COMB-KOHHKNNUM(KOH-IDX)(1:1)  >= "1")    AND
                  (COMB-KOHHKNNUM(KOH-IDX)(1:1)  <= "8")
               PERFORM     23041-KOHPLUS-FUKUOKA-SEC
           END-IF.
      *
           IF   FLG-CHIHOU(KOH-IDX)  =  "1"
               IF    WK-GAIKFTNRATE  =  ZERO
                    MOVE    SPACE   TO  COMB-KOH-GAIJGNKBN(KOH-IDX)
               END-IF
           END-IF.
      *
           IF  ((WK-1001-PREFNUM         =  01           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) = "121"         ) AND
                (LNK-SYU-SRYYMD(1:6)    >= "200604"      ) AND
                (LNK-SYU-SRYYMD(1:6)    <= "200803"      ))
           OR  ((WK-1001-PREFNUM         =  13           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
                (LNK-SYU-SRYYMD(1:6)    >= "200710"      ) AND
                (LNK-SYU-SRYYMD(1:6)    <= "200909"      ))
           OR  ((WK-1001-PREFNUM         =  31           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) = "281" OR "282"
                                                 OR "283") AND
                (LNK-SYU-SRYYMD(1:6)    >= "200804"      ) AND
                (WK-TOTORI-JIRITU        =  1            ))
                    MOVE    SPACE   TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
                    MOVE    ZERO    TO   WK-GAIKFTNRATE
                    MOVE    "0"     TO   WK-GAIYKZFTNKBN
                    MOVE    ZERO    TO   WK-GAIKKOTGAK
           END-IF.
      *
           MOVE     ZERO            TO   FLG-HOKKAIDO.
           IF   (WK-1001-PREFNUM         =  01     )
           AND  (COMB-KOHHKNNUM(KOH-IDX) = "221"   )
           AND  (LNK-SYU-SRYYMD(1:6)    >= "200604")
              IF  (KOH-IDX                     >   1  )
              AND (COMB-KOHHKNNUM(KOH-IDX - 1) = "021")
              AND (WK-GAIKFTNRATE              =   5  )
                    MOVE    1       TO   FLG-HOKKAIDO
      *
                    MOVE    SPACE   TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
                    MOVE    ZERO    TO   WK-GAIKFTNRATE
                    MOVE    "0"     TO   WK-GAIYKZFTNKBN
                    MOVE    ZERO    TO   WK-GAIKKOTGAK
              END-IF
           END-IF.
      *
           IF  ((WK-2010-SYOKEIKBN-G(KOH-IDX)  =  "1"    ) AND
                (LNK-S01-SYOSINFLG             =  SPACE  ))
           OR  ((WK-2010-SINKEIKBN-G(KOH-IDX)  =  "1"    ) AND
                (LNK-S01-SINSATUFLG            =  SPACE  ))
           OR  ((WK-2010-SINKEIKBN-G(KOH-IDX)  =  "1"    ) AND
                (LNK-S01-SINSATUFLG2           =  "1"    ))
                    MOVE    SPACE   TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
                    MOVE    ZERO    TO   WK-GAIKFTNRATE
                    MOVE    "0"     TO   WK-GAIYKZFTNKBN
                    MOVE    ZERO    TO   WK-GAIKKOTGAK
           END-IF.
      *
           MOVE     ZERO            TO   FLG-ICHIBU-JYOSEI.
           IF  (WK-2010-SYOKEI2KBN-G(KOH-IDX) = "1"  )
           AND (LNK-S01-SYOSINFLG         NOT = SPACE)
                    MOVE     1      TO   FLG-ICHIBU-JYOSEI
      **************MOVE     2      TO   FLG-ICHIBU-JYOSEI
           END-IF.
      *
           IF     (WK-1001-PREFNUM         =  13           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200910"      )
               IF    ((WK-2010-SINKEIKBN-G(KOH-IDX)  =  "1"  ) AND
                      (LNK-S01-SINSATUFLG            =  SPACE))
               OR    ((WK-2010-SINKEIKBN-G(KOH-IDX)  =  "1"  ) AND
                      (LNK-S01-SINSATUFLG2           =  "1"  ))
                    CONTINUE
               ELSE
                    MOVE    WK-GAIKFTNRATE-TOKUSYU
                                    TO   WK-GAIKFTNRATE
                    MOVE      ZERO      TO      WK-ZENGAKU
                    PERFORM   VARYING   IDX9    FROM    1   BY  1
                               UNTIL    IDX9     >     16
                      IF  IDX9  =  4
                        COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  +
                                (LNK-SYU-SHOHOU-SAI   *  HKN-TENTNK)
                      ELSE
                        COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  +
                                (LNK-SYU-HKNTEN(IDX9) *  HKN-TENTNK)
                      END-IF
                    END-PERFORM
               END-IF
           END-IF.
      *
           IF     (WK-1001-PREFNUM         =  43           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342") AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200912"      )
            MOVE       "1"       TO   LNK-S01-TOKUSYU-SAI-KBN
            IF    COMB-KOH-GAIJGNKBN(KOH-IDX)  =  SPACE
             MOVE      ZERO      TO   WK-KUMAMOTO-SYUCOMPFTN
            ELSE
             IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =  "1")
             OR  (FLG-KOUREI-KBN               =  "1")
               MOVE      100     TO   WK-GAIKFTNRATE
               MOVE    SPACE     TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
               MOVE    ZERO      TO   WK-KUMAMOTO-SYUCOMPFTN
             ELSE
               COMPUTE  WK-KUMAMOTO-HANTEIKIN = WK-KUMAMOTO-HANTEIKIN
                                              + WK-KUMAMOTO-SYUCOMPFTN
               IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                   (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                   (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                   (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                 MOVE      1          TO   FLG-KUMAMOTO-CYO
               ELSE
                 EVALUATE   KOH-IDX
                   WHEN       1
                     MOVE  MAX-KIN-KOHI1-M  TO  WK-KUMAMOTO-HANTEIJGN
                   WHEN       2
                     MOVE  MAX-KIN-KOHI2-M  TO  WK-KUMAMOTO-HANTEIJGN
                   WHEN       3
                     MOVE  MAX-KIN-KOHI3-M  TO  WK-KUMAMOTO-HANTEIJGN
                   WHEN       4
                     MOVE  MAX-KIN-KOHI4-M  TO  WK-KUMAMOTO-HANTEIJGN
                 END-EVALUATE
                 IF   WK-KUMAMOTO-HANTEIKIN  >= WK-KUMAMOTO-HANTEIJGN
                   MOVE      100     TO   WK-GAIKFTNRATE
                   MOVE    SPACE     TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
                   IF  FLG-GENBUTU70  NOT =  ZERO
                      MOVE   "1"     TO   FLG-SYOUKAN(KOH-IDX)
                   END-IF
                 END-IF
               END-IF
             END-IF
            END-IF
           END-IF.
           IF     (WK-1001-PREFNUM         =  43           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "343"         ) AND
                  (LNK-SYU-SRYYMD(1:6)    >= "201204"      )
             IF  (LNK-S01-KOUREI-ZAITAKU-KBN  = "1")
             OR  (FLG-KOUREI-KBN              = "1")
               MOVE      100     TO   WK-GAIKFTNRATE
               MOVE    SPACE     TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
             END-IF
           END-IF.
      *
           IF     (WK-1001-PREFNUM         =  43           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "443"         ) AND
                  (LNK-SYU-SRYYMD(1:6)    >= "201608"      )
            MOVE       "1"       TO   LNK-S01-TOKUSYU-SAI-KBN
            IF    COMB-KOH-GAIJGNKBN(KOH-IDX)  =  SPACE
             MOVE      ZERO      TO   WK-KUMAMOTO-SYUCOMPFTN
            ELSE
             IF  (LNK-S01-KOUREI-ZAITAKU-KBN   =  "1")
             OR  (FLG-KOUREI-KBN               =  "1")
               MOVE      100     TO   WK-GAIKFTNRATE
               MOVE    SPACE     TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
               MOVE    ZERO      TO   WK-KUMAMOTO-SYUCOMPFTN
             ELSE
               IF  (COMB-KOH1HKNNUM  =  "443")
               AND (COMB-KOH2HKNNUM  =  SPACE)
               AND (COMB-KOH3HKNNUM  =  SPACE)
               AND (COMB-KOH4HKNNUM  =  SPACE)
                 COMPUTE  WK-KUMAMOTO-HANTEIKIN = WK-KUMAMOTO-HANTEIKIN
                                                + WK-KUMAMOTO-SYUCOMPFTN
                 MOVE  MAX-KIN-KOHI1-M  TO  WK-KUMAMOTO-HANTEIJGN
                 IF   WK-KUMAMOTO-HANTEIKIN  >= WK-KUMAMOTO-HANTEIJGN
                   MOVE    100     TO   WK-GAIKFTNRATE
                   MOVE  SPACE     TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
                   IF  FLG-GENBUTU70  NOT =  ZERO
                      MOVE   "1"   TO   FLG-SYOUKAN(KOH-IDX)
                   END-IF
                 END-IF
               ELSE
                 MOVE      100     TO   WK-GAIKFTNRATE
                 MOVE    SPACE     TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
                 IF    FLG-GENBUTU70  NOT =  ZERO
                    MOVE     "1"   TO   FLG-SYOUKAN(KOH-IDX)
                 END-IF
               END-IF
             END-IF
            END-IF
           END-IF.
      *
           IF    (WK-1001-PREFNUM         =  30     )
           AND   (COMB-KOHHKNNUM(KOH-IDX) = "281"   )
           AND   (LNK-SYU-SRYYMD(1:6)    >= "201708")
             IF  (COMB-HKNNUM       NOT = SPACE)
             AND (COMB-KOH1HKNNUM       = "281")
             AND (COMB-KOH2HKNNUM       = SPACE)
             AND (COMB-KOH3HKNNUM       = SPACE)
             AND (COMB-KOH4HKNNUM       = SPACE)
               IF  (LNK-S01-KOUREI-ZAITAKU-KBN  =  "1")
               OR  (FLG-KOUREI-KBN              =  "1")
                 MOVE     100     TO    WK-GAIKFTNRATE
                 MOVE     SPACE   TO    COMB-KOH-GAIJGNKBN(KOH-IDX)
                 MOVE     ZERO    TO    WK-WAKAYAMA-SYUCOMPFTN
               ELSE
                 IF  FLG-WAKAYAMA-HANTEI  =  ZERO
                   COMPUTE WK-WAKAYAMA-HANTEIKIN  =
                           WK-WAKAYAMA-HANTEIKIN  +
                           WK-WAKAYAMA-SYUCOMPFTN
                   COMPUTE WK-WAKAYAMA-HANTEITEN  =
                           WK-WAKAYAMA-HANTEITEN  +
                           LNK-SYU-TOTAL-HKNTEN
                   IF  FLG-GENBUTU70  NOT =  ZERO
                     IF  WK-WAKAYAMA-HANTEIKIN  >  WK-WAKAYAMA-HANTEIJGN
                       MOVE     100    TO   WK-GAIKFTNRATE
                       MOVE     SPACE  TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
                       IF  FLG-GENBUTU70  NOT =  ZERO
                         MOVE   "1"    TO   FLG-SYOUKAN(KOH-IDX)
                       END-IF
                     ELSE
                       MOVE     ZERO   TO   WK-GAIKFTNRATE
                     END-IF
                   ELSE
                     IF  WK-WAKAYAMA-HANTEITEN  >  26700
                       MOVE     100    TO   WK-GAIKFTNRATE
                       MOVE     SPACE  TO   COMB-KOH-GAIJGNKBN(KOH-IDX)
                       IF  FLG-GENBUTU70  NOT =  ZERO
                         MOVE   "1"    TO   FLG-SYOUKAN(KOH-IDX)
                       END-IF
                     ELSE
                       MOVE     ZERO   TO   WK-GAIKFTNRATE
                     END-IF
                   END-IF
                 ELSE
                   MOVE     100     TO    WK-GAIKFTNRATE
                   MOVE     SPACE   TO    COMB-KOH-GAIJGNKBN(KOH-IDX)
                   IF  FLG-GENBUTU70  NOT =  ZERO
                     MOVE   "1"     TO    FLG-SYOUKAN(KOH-IDX)
                   END-IF
                 END-IF
               END-IF
             ELSE
               MOVE     100     TO    WK-GAIKFTNRATE
               MOVE     SPACE   TO    COMB-KOH-GAIJGNKBN(KOH-IDX)
               MOVE     ZERO    TO    WK-WAKAYAMA-SYUCOMPFTN
               IF  FLG-GENBUTU70  NOT =  ZERO
                 MOVE   "1"     TO    FLG-SYOUKAN(KOH-IDX)
               END-IF
             END-IF
           END-IF.
      *
           MOVE      ZERO      TO        FLG-MIYAGI.
           IF     (WK-1001-PREFNUM         =  04           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "183" OR "383" 
                                                   OR "483") AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200510"      ) AND
                  (LNK-SYU-SRYYMD(1:6)    <= "200803"      )
      *
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    COMB-KOHHKNNUM(KOH-IDX)
                                             TO  PTKOH-KOHNUM
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKSTYMD
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKEDYMD
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key6"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key6"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF   PTKOH-KOHID  =  COMB-KOHID(KOH-IDX)
                           EVALUATE  PTKOH-FTNJANUM(1:7)
                             WHEN    "8304102"
                               MOVE    1    TO  FLG-MIYAGI
                             WHEN    "8304125"
                              IF  LNK-SYU-SRYYMD(1:6) >= "200610"
                               CONTINUE
                              ELSE
                               MOVE    2    TO  FLG-MIYAGI
                              END-IF
                           END-EVALUATE
                           MOVE    1        TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key6"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key6"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF.
      *
           IF   WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"
                COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                          WK-IRYOKEIKBN-HANTEITEN  +
                          LNK-SYU-TOTAL-HKNTEN
      *
                EVALUATE   KOH-IDX
                  WHEN        1
                    MOVE  MAX-KIN-KOHI1-M  TO  WK-IRYOKEIKBN-MAXTEN
                  WHEN        2
                    MOVE  MAX-KIN-KOHI2-M  TO  WK-IRYOKEIKBN-MAXTEN
                  WHEN        3
                    MOVE  MAX-KIN-KOHI3-M  TO  WK-IRYOKEIKBN-MAXTEN
                  WHEN        4
                    MOVE  MAX-KIN-KOHI4-M  TO  WK-IRYOKEIKBN-MAXTEN
                END-EVALUATE
           END-IF.
      *
      *    システム管理２０１０設定額未満・以上で異なる負担金計算
      *    設定「３」「４」のチェック
           IF   WK-2010-IRYOKEIKBN-G(KOH-IDX) = "3" OR "4"
                MOVE      "1"     TO    LNK-S01-TOKUSYU-SAI-KBN
                PERFORM   23044-IRYOKEIKBN-CHECK-SEC
           END-IF.
      *
           IF  (COMB-KOHHKNNUM(KOH-IDX)(1:2)  = "99"  ) AND
               (WK-GAIKFTNRATE                =  ZERO )
                    MOVE    WK-KOH-FTNRATE   TO   WK-GAIKFTNRATE
           END-IF.
      *
           IF  (LNK-SYU-SRYYMD(1:6)     >= "200604"               )
           AND (COMB-KOHHKNNUM(KOH-IDX)  = "015" OR "016" OR "021")
           AND (WK-JIRITU-CYUKANSOU(KOH-IDX)   =  1               )
                   MOVE    1       TO  LNK-SYU-NYNSHOKAISU
           END-IF.
      *
           IF  ((LNK-S01-KOUREI-ZAITAKU-KBN      =     "1" ) OR
                (FLG-GENBUTU70               NOT =   ZERO  ))
           AND ( COMB-KOHHKNNUM(KOH-IDX)(1:1)   >=     "1"  )
           AND ( COMB-KOHHKNNUM(KOH-IDX)(1:1)   <=     "8"  )
           AND ( COMB-KOH-GAIJGNKBN(KOH-IDX)     =   SPACE  )
           AND ( WK-GAIKFTNRATE                  =     100
                                                OR      30  )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
      *
           IF    FLG-GENBUTU70   NOT =  ZERO
             IF   WK-2010-KINJYOKBN-G(KOH-IDX)   = "1"
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
             END-IF
             IF   WK-2010-IRYOKEIKBN-G(KOH-IDX)  = "1" OR "2"
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
             END-IF
           END-IF.
      *
           IF   WK-GAIKFTNRATE  NOT =  ZERO
             IF (WK-GAIKFTNRATE-TOKUSYU  =  ZERO          )
             OR (WK-GAIKFTNRATE-TOKUSYU  >  WK-GAIKFTNRATE)
               MOVE   WK-GAIKFTNRATE   TO   WK-GAIKFTNRATE-TOKUSYU
             END-IF
           END-IF.
           IF  (COMB-HKNNUM   NOT = SPACE)
           AND (WK-KOH-FTNRATE    = ZERO )
               MOVE   ZERO             TO   WK-GAIKFTNRATE-TOKUSYU
           END-IF.
      *
      *    累計ベース計算
           IF    FLG-RUIKEIYO   =  1
             EVALUATE  KOH-IDX
               WHEN      1
                 IF    WK-KOH-FTNRATE   NOT = ZERO
                   IF  WK-GAIKFTNRATE   NOT = ZERO
                     MOVE  WK-GAIKFTNRATE    TO  WK-RUI-FTNRATE
                     MOVE  WK-GAIKFTNRATE    TO  WK-RUI-FTNRATE-KOH1
                   ELSE
                     MOVE  WK-KOH-FTNRATE    TO  WK-RUI-FTNRATE
                     MOVE  ZERO              TO  WK-RUI-FTNRATE-KOH1
                   END-IF
                 END-IF
               WHEN      2
                 IF   (WK-RUI-FTNRATE     NOT = ZERO               )
                 AND  (LNK-SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8")
                 AND  (WK-TOKATUKAI(2)        = ZERO               )
                   IF  WK-GAIKFTNRATE     NOT = ZERO
                     IF   WK-RUI-FTNRATE  >  WK-GAIKFTNRATE
                       IF COMB-KOH-GAIJGNKBN(2)  =  "1"
                         IF (MAX-KIN-KOHI2-M  NOT = ZERO)
                         OR (MAX-KIN-KOHI2-D  NOT = ZERO)
                           MOVE   1    TO  WK-RUI-TAISYO
                           PERFORM   23042-FTNGAK-HENSYU-SEC
                           MOVE   1    TO  FLG-RUIKEIYO2
                           PERFORM   23043-ZAN-HENSYU-SEC
                         END-IF
                       ELSE
                         MOVE   1    TO  WK-RUI-TAISYO
                         MOVE  "1"   TO  COMB-KOH-GAIJGNKBN(2)
                         PERFORM   23042-FTNGAK-HENSYU-SEC
                         MOVE   2    TO  FLG-RUIKEIYO2
                         PERFORM   23043-ZAN-HENSYU-SEC
                       END-IF
                     ELSE
                       IF   WK-RUI-FTNRATE  =  WK-GAIKFTNRATE
                         IF COMB-KOH-GAIJGNKBN(2)  =  "1"
                           IF  (MAX-KIN-KOHI2-D  NOT = ZERO)
                           AND (MAX-KIN-KOHI2-D  NOT =
                                            MAX-KIN-KOHI2-M)
                             MOVE   1    TO  WK-RUI-TAISYO
                             PERFORM   23042-FTNGAK-HENSYU-SEC
                             MOVE   1    TO  FLG-RUIKEIYO2
                             PERFORM   23043-ZAN-HENSYU-SEC
                           END-IF
                         END-IF
                       END-IF
                     END-IF
                   ELSE
                     IF COMB-KOH-GAIJGNKBN(2)  =  "1"
                       IF  (MAX-KIN-KOHI2-D  NOT = ZERO)
                       AND (MAX-KIN-KOHI2-D  NOT =
                                        MAX-KIN-KOHI2-M)
                         IF   WK-RUI-FTNRATE-KOH1  NOT = ZERO
                           MOVE WK-RUI-FTNRATE-KOH1 TO WK-GAIKFTNRATE
                         END-IF
                         MOVE   1    TO  WK-RUI-TAISYO
                         PERFORM   23042-FTNGAK-HENSYU-SEC
                         MOVE   1    TO  FLG-RUIKEIYO2
                         PERFORM   23043-ZAN-HENSYU-SEC
                       END-IF
                       IF  (WK-1001-PREFNUM       =  43           )
                       AND (LNK-SYU-KOH-HKNNUM(2) = "143" OR "342")
                       AND (LNK-SYU-SRYYMD(1:6)  >= "200912"      )
                         MOVE   1    TO  WK-RUI-TAISYO
                         PERFORM   23042-FTNGAK-HENSYU-SEC
                         IF  FLG-KUMAMOTO-CYO  =  1
                           MOVE   1    TO  FLG-RUIKEIYO2
                         ELSE
                           MOVE   2    TO  FLG-RUIKEIYO2
                         END-IF
                         PERFORM   23043-ZAN-HENSYU-SEC
                       END-IF
                       IF  (WK-1001-PREFNUM       =  43           )
                       AND (LNK-SYU-KOH-HKNNUM(2) = "343"         )
                       AND (LNK-SYU-SRYYMD(1:6)  >= "201204"      )
                         MOVE   1    TO  WK-RUI-TAISYO
                         PERFORM   23042-FTNGAK-HENSYU-SEC
                         MOVE   1    TO  FLG-RUIKEIYO2
                         PERFORM   23043-ZAN-HENSYU-SEC
                       END-IF
                     ELSE
                       IF  (WK-1001-PREFNUM       =  43           )
                       AND (LNK-SYU-KOH-HKNNUM(2) = "143" OR "342")
                       AND (LNK-SYU-SRYYMD(1:6)  <= "200911"      )
                           MOVE   1    TO  WK-RUI-TAISYO
                           MOVE  "1"   TO  COMB-KOH-GAIJGNKBN(2)
                           PERFORM   23042-FTNGAK-HENSYU-SEC
                           MOVE   2    TO  FLG-RUIKEIYO2
                           PERFORM   23043-ZAN-HENSYU-SEC
                       END-IF
                       IF  (WK-1001-PREFNUM       =  13     )
                       AND (LNK-SYU-KOH-HKNNUM(2) = "588"   )
                       AND (LNK-SYU-SRYYMD(1:6)  <= "200909")
                         IF ( WK-KOH-FTNRATE  = 10             )
                         OR ((WK-KOH-FTNRATE  > 10            ) AND
                             (LNK-SYU-KOH-HKNNUM(1)
                                     = "038" OR "051" OR "052"))
                           MOVE   1    TO  WK-RUI-TAISYO
                           MOVE  "1"   TO  COMB-KOH-GAIJGNKBN(2)
                           PERFORM   23042-FTNGAK-HENSYU-SEC
                           MOVE   2    TO  FLG-RUIKEIYO2
                           PERFORM   23043-ZAN-HENSYU-SEC
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF.
      *
           IF  (KOH-IDX               =  2   )
           AND (WK-RUI-TAISYO         =  1   )
           AND (WK-2010-KINJYOKBN-G(1)
                                      = "1"  )
           AND (WK-GAIKFTNRATE    NOT =  ZERO)
           AND (COMB-KOH-GAIJGNKBN(2) = "1"  )
             MOVE       1    TO   FLG-MARUTOARI
             IF MAX-KIN-KOHI2-D       =  ZERO
               MOVE     1    TO   FLG-MARUTOARI2
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +  WK-RUI-ZENGAKU
             END-IF
           END-IF.
      *
           IF   COMB-KOH-GAIJGNKBN(KOH-IDX)  =  "1"
             IF   WK-GAIKFTNRATE  NOT =  ZERO
                 COMPUTE  WK-FUTANWARI      =  WK-GAIKFTNRATE
                                            /  100
                 COMPUTE  WK-SKYCHK-KEISAN  =  WK-ZENGAKU
                                            *  WK-FUTANWARI
                 IF  WK-SKYCHK-KEISAN9 < WK-SKYCHK-KEISAN
                   MOVE  WK-SKYCHK-KEISAN  TO  WK-SKYCHK-KEISAN9
                 END-IF
             ELSE
               IF  (COMB-KOHHKNNUM(KOH-IDX) = "972" OR "974")
               AND (FLG-ZENKI-TOKUREI       =  1            )
                 COMPUTE  WK-SKYCHK-KEISAN  =  WK-ZENGAKU
                                            *  0.2
                 IF  WK-SKYCHK-KEISAN9 < WK-SKYCHK-KEISAN
                   MOVE  WK-SKYCHK-KEISAN  TO  WK-SKYCHK-KEISAN9
                 END-IF
               END-IF
             END-IF
           ELSE
             IF   WK-GAIKFTNRATE  NOT =  ZERO
                 COMPUTE  WK-FUTANWARI      =  WK-GAIKFTNRATE
                                            /  100
                 COMPUTE  WK-SKYCHK-KEISAN  =  WK-ZENGAKU
                                            *  WK-FUTANWARI
                 IF  WK-SKYCHK-KEISAN9 < WK-SKYCHK-KEISAN
                   MOVE  WK-SKYCHK-KEISAN  TO  WK-SKYCHK-KEISAN9
                 END-IF
             ELSE
               IF  (COMB-KOHHKNNUM(KOH-IDX) = "019")
               AND (WK-GAIKFTNRATE019   NOT = ZERO )
                 COMPUTE  WK-FUTANWARI      =  WK-GAIKFTNRATE019
                                            /  100
                 COMPUTE  WK-SKYCHK-KEISAN  =  WK-ZENGAKU
                                            *  WK-FUTANWARI
                 IF  WK-SKYCHK-KEISAN9 < WK-SKYCHK-KEISAN
                   MOVE  WK-SKYCHK-KEISAN  TO  WK-SKYCHK-KEISAN9
                 END-IF
               END-IF
             END-IF
           END-IF.
      *
       2304-KOH-HKNREAD-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費付加情報の取得（福岡県対応）                  *
      ******************************************************************
       23041-KOHPLUS-FUKUOKA-SEC           SECTION.
      *
           INITIALIZE                  ORCSKOHPLUS-AREA
           MOVE    LNK-SYU-HOSPNUM TO  LNK-SKOHPLUS-HOSPNUM
           MOVE    WK-1001-PREFNUM TO  LNK-SKOHPLUS-PREFNUM
           MOVE    LNK-SYU-PTID    TO  LNK-SKOHPLUS-PTID
           MOVE    LNK-SYU-HKNCOMBINUM
                                   TO  LNK-SKOHPLUS-HKNCOMBI
           MOVE    LNK-SYU-SRYYMD  TO  LNK-SKOHPLUS-SRYYMD
           CALL    "ORCSKOHPLUS"       USING
                                       ORCSKOHPLUS-AREA
                                       SPA-AREA
           IF      LNK-SKOHPLUS-RC =   ZERO
               MOVE   LNK-SKOHPLUS-FTNKBN    TO   WK-KOH-FTNKBN
               MOVE   WK-KOH-FTNRATE         TO   WK-GAIKFTNRATE
               IF     WK-GAIKFTNRATE  =  ZERO
                      MOVE    SPACE   TO  COMB-KOH-GAIJGNKBN(KOH-IDX)
               END-IF
           END-IF
           IF  (LNK-SKOHPLUS-RC     = ZERO)
           AND (LNK-SKOHPLUS-FTNKBN = "1" )
           AND (WK-GAIKFTNRATE  NOT = ZERO)
               CONTINUE
           ELSE
               MOVE    ZERO   TO   LNK-SYU-KYUFUGAI-SHOSHIN-TEN
                                   LNK-SYU-KYUFUGAI-SIDOU-TEN
                                   LNK-SYU-KYUFUGAI-OSIN1-TEN
                                   LNK-SYU-KYUFUGAI-OSIN2-TEN
                                   LNK-SYU-KYUFUGAI-OSIN3-TEN
                                   LNK-SYU-KYUFUGAI-GOKEI-TEN
           END-IF
      *
           .
      *
       23041-KOHPLUS-FUKUOKA-EXT.
           EXIT.
      *
      ******************************************************************
      *        負担額編集
      ******************************************************************
       23042-FTNGAK-HENSYU-SEC           SECTION.
      *
           IF    LNK-SYU-KOH1COMPFTN  >  LNK-SYU-SYUCOMPFTN
              MOVE   LNK-SYU-SYUCOMPFTN    TO   WK-RUI-COMPFTN-XXX
           ELSE
              MOVE   LNK-SYU-KOH1COMPFTN   TO   WK-RUI-COMPFTN-XXX
           END-IF
      *
           COMPUTE  WK-RUI-HKNFTNMONEY  =
                    WK-RUI-COMPFTN-XXX  +   5
           COMPUTE  WK-RUI-HKNFTNMONEY  =
                    WK-RUI-HKNFTNMONEY  /  10
           COMPUTE  WK-RUI-HKNFTNMONEY  =
                    WK-RUI-HKNFTNMONEY  *  10
      *
           IF    LNK-SYU-KOH1COMPFTN-ENTANI
                                      >  LNK-SYU-SYUCOMPFTN-ENTANI
              MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                           TO   WK-RUI-COMPFTN-ENTANI
           ELSE
              MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                           TO   WK-RUI-COMPFTN-ENTANI
           END-IF
           COMPUTE  WK-RUI-COMPFTN-ENTANI2 =
                    WK-RUI-COMPFTN-ENTANI  + 0.9
      *
           IF   LNK-SYU-NYNSHOKAISU  =  9
                COMPUTE  WK-RUI-COMPFTN  =  LNK-SYU-KOH1COMPFTN  +   5
                COMPUTE  WK-RUI-COMPFTN  =  WK-RUI-COMPFTN       /  10
                COMPUTE  WK-RUI-COMPFTN  =  WK-RUI-COMPFTN       *  10
           ELSE
              IF    WK-KOH-COMPFTN(1)  =  ALL"9"
                IF     LNK-SYU-KOH1COMPFTN    >  LNK-SYU-SYUCOMPFTN
                  MOVE   LNK-SYU-SYUCOMPFTN  TO   WK-RUI-COMPFTN
                ELSE
                  MOVE   LNK-SYU-KOH1COMPFTN TO   WK-RUI-COMPFTN
                END-IF
              ELSE
                IF     WK-KOH-COMPFTN(1)      >  LNK-SYU-SYUCOMPFTN
                  MOVE   LNK-SYU-SYUCOMPFTN  TO   WK-RUI-COMPFTN
                ELSE
                  MOVE   WK-KOH-COMPFTN(1)   TO   WK-RUI-COMPFTN
                END-IF
              END-IF
           END-IF
      *
           IF ((LNK-SYU-KOH1HKNNUM  =  "015" OR "016" OR "021") AND
               (WK-JIRITU-CYUKANSOU(1)   =  2                 ))
           OR ( LNK-SYU-KOH1HKNNUM  =  "024" OR "079" OR "038" )
           OR ((LNK-SYU-KOH1HKNNUM  =  "052" OR "054"         ) AND
               (LNK-SYU-SRYYMD(1:6)     >= "201501"           ))
           OR ((WK-TOKATUKAI(1)              =  1             ) AND
               (WK-KOHJGNGET-TAISYOKBN(1)    =  2             ))
              IF  FLG-TOKU75  = 1 OR 2 OR 3
               ADD  WK-RUI-FTN1-M-JI-TOKU75  TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2-JI-TOKU75 TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3-JI-TOKU75 TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4-JI-TOKU75 TO  WK-RUI-COMPFTN-ENTANI2
              ELSE
               ADD  WK-RUI-FTN1-M-JI         TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2-JI        TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3-JI        TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4-JI        TO  WK-RUI-COMPFTN-ENTANI2
              END-IF
           ELSE
            IF   WK-2010-KINJYOKBN-G(1) = "1"
               ADD  WK-RUI-FTN1-M            TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2           TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3           TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4           TO  WK-RUI-COMPFTN-ENTANI2
            ELSE
              IF  FLG-TOKU75  = 1 OR 2 OR 3
               ADD  WK-RUI-FTN1-M-TOKU75     TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2-TOKU75    TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3-TOKU75    TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4-TOKU75    TO  WK-RUI-COMPFTN-ENTANI2
              ELSE
               ADD  WK-RUI-FTN1-M            TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2           TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3           TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4           TO  WK-RUI-COMPFTN-ENTANI2
              END-IF
            END-IF
           END-IF
      *
           .
      *
       23042-FTNGAK-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        残編集
      ******************************************************************
       23043-ZAN-HENSYU-SEC           SECTION.
      *
           IF  WK-RUI-HKNFTNMONEY   NOT =  ZERO
               IF   WK-RUI-FTN2-M         >=  WK-RUI-HKNFTNMONEY
                    MOVE     ZERO         TO  ZAN-KOHI2-M
               ELSE
                    COMPUTE  ZAN-KOHI2-M  =   WK-RUI-HKNFTNMONEY -
                                              WK-RUI-FTN2-M
               END-IF
               EVALUATE  FLG-RUIKEIYO2
                 WHEN       1
                   IF  ZAN-KOHI2   >  ZAN-KOHI2-M
                     MOVE   ZAN-KOHI2-M      TO  ZAN-KOHI2
                   END-IF
                 WHEN       2
                   MOVE     ZAN-KOHI2-M      TO  ZAN-KOHI2
               END-EVALUATE
           ELSE
               MOVE   ZERO      TO  ZAN-KOHI2
           END-IF
      *
           IF  WK-RUI-COMPFTN   NOT =  ZERO
               IF   WK-RUI-FTN2-M2        >=  WK-RUI-COMPFTN
                    MOVE     ZERO         TO  ZAN-KOHI2-M2
               ELSE
                    COMPUTE  ZAN-KOHI2-M2 =   WK-RUI-COMPFTN -
                                              WK-RUI-FTN2-M2
               END-IF
               EVALUATE  FLG-RUIKEIYO2
                 WHEN       1
                   IF  ZAN-KOHI22  >  ZAN-KOHI2-M2
                     MOVE   ZAN-KOHI2-M2     TO  ZAN-KOHI22
                   END-IF
                 WHEN       2
                   MOVE     ZAN-KOHI2-M2     TO  ZAN-KOHI22
               END-EVALUATE
           ELSE
               MOVE   ZERO      TO  ZAN-KOHI22
           END-IF
      *
           IF  WK-RUI-COMPFTN-ENTANI2  NOT =  ZERO
               IF   WK-RUI-FTN2-M3        >=  WK-RUI-COMPFTN-ENTANI2
                    MOVE     ZERO         TO  ZAN-KOHI2-M3
               ELSE
                    COMPUTE  ZAN-KOHI2-M3 =   WK-RUI-COMPFTN-ENTANI2 -
                                              WK-RUI-FTN2-M3
               END-IF
               EVALUATE  FLG-RUIKEIYO2
                 WHEN       1
                   IF  ZAN-KOHI23  >  ZAN-KOHI2-M3
                     MOVE   ZAN-KOHI2-M3     TO  ZAN-KOHI23
                   END-IF
                 WHEN       2
                   MOVE     ZAN-KOHI2-M3     TO  ZAN-KOHI23
               END-EVALUATE
           ELSE
               MOVE   ZERO      TO  ZAN-KOHI23
           END-IF
      *
           .
      *
       23043-ZAN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        システム管理２０１０設定額未満・以上で異なる負担金計算
      *        設定「３」「４」のチェック
      ******************************************************************
       23044-IRYOKEIKBN-CHECK-SEC           SECTION.
      *
           MOVE       ZERO         TO   FLG-IRYOKEIKBN
      *
           EVALUATE   WK-2010-IRYOKEIKBN-G(KOH-IDX)
             WHEN     "3"
                MOVE      21000    TO   WK-TAIHI-MAX-KIN-KOHI-M
             WHEN     "4"
                MOVE      20000    TO   WK-TAIHI-MAX-KIN-KOHI-M
           END-EVALUATE
      *
           IF  WK-TAIHI-FTN-KOHI-M(KOH-IDX) >= WK-TAIHI-MAX-KIN-KOHI-M
                MOVE      ZERO     TO   WK-TAIHI-ZAN-KOHI-M
           ELSE
                COMPUTE   WK-TAIHI-ZAN-KOHI-M       =
                          WK-TAIHI-MAX-KIN-KOHI-M   -
                          WK-TAIHI-FTN-KOHI-M(KOH-IDX)
           END-IF
      *
           IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
                MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                   TO   WK-TOKUSYU-ENTANI
           ELSE
                MOVE  WK-ZENGAKU   TO   WK-TOKUSYU-ENTANI
           END-IF
      *
           IF   HKN-RECEFTNDSPKBN  =  "2"
             IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
                MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                   TO   WK-TOKUSYU-COMPFTN2
             ELSE
                MOVE  WK-ZENGAKU   TO   WK-TOKUSYU-COMPFTN2
             END-IF
           END-IF
      *
           IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
             IF  (FLG-KOUGAKUCYO3      =     1)
             OR  (FLG-KOUGAKUCYO-GEN70 =     1)
               MOVE  LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU
             ELSE
               COMPUTE  WK-TOKUSYU = LNK-SYU-SYUCOMPFTN +  5
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU         / 10
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU         * 10
             END-IF
      *
             IF  ( KOH-IDX  =  1                            )
             AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
               IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI1
                   MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI2
                   MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI3
                   MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI4
                   MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF  WK-TOKUSYU >= WK-TAIHI-ZAN-KOHI-M
                 MOVE   1                  TO  FLG-IRYOKEIKBN
                 MOVE   WK-TOKUSYU         TO  WK-TAIHI-KARI-COMPFTN
               ELSE
                 MOVE   ZERO               TO  FLG-IRYOKEIKBN
                 MOVE   ZERO               TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             ELSE
               IF  WK-TOKUSYU >= WK-TAIHI-ZAN-KOHI-M
                 MOVE   1                  TO  FLG-IRYOKEIKBN
                 MOVE   LNK-SYU-SYUCOMPFTN TO  WK-TAIHI-KARI-COMPFTN
               ELSE
                 MOVE   ZERO               TO  FLG-IRYOKEIKBN
                 MOVE   ZERO               TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             END-IF
      *
             EVALUATE   KOH-IDX
               WHEN   2
                 IF  LNK-SYU-KOH-COMPFTN(1) <  WK-TAIHI-KARI-COMPFTN
                 AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                   MOVE  LNK-SYU-KOH-COMPFTN(1)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
               WHEN   3
                 IF  LNK-SYU-KOH-COMPFTN(2) <  WK-TAIHI-KARI-COMPFTN
                   MOVE  LNK-SYU-KOH-COMPFTN(2)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
               WHEN   4
                 IF  LNK-SYU-KOH-COMPFTN(3) <  WK-TAIHI-KARI-COMPFTN
                   MOVE  LNK-SYU-KOH-COMPFTN(3)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
             END-EVALUATE
      *
             MOVE    LNK-SYU-SYUCOMPFTN    TO  WK-TOKUSYU-COMPFTN
      *
             IF    KOH-IDX  >  1
               COMPUTE  WK-TOKUSYU = WK-TAIHI-KARI-COMPFTN +  5
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU            / 10
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU            * 10
               IF  WK-TOKUSYU  >=  WK-TAIHI-ZAN-KOHI-M
                 CONTINUE
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             END-IF
           ELSE
             COMPUTE  WK-TOKUSYU = WK-ZENGAKU +  5
             COMPUTE  WK-TOKUSYU = WK-TOKUSYU / 10
             COMPUTE  WK-TOKUSYU = WK-TOKUSYU * 10
      *
             IF  ( KOH-IDX  =  1                            )
             AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
               IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI1
                   MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI2
                   MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI3
                   MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI4
                   MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF  WK-TOKUSYU >= WK-TAIHI-ZAN-KOHI-M
                 MOVE   1                  TO  FLG-IRYOKEIKBN
                 MOVE   WK-TOKUSYU         TO  WK-TAIHI-KARI-COMPFTN
               ELSE
                 MOVE   ZERO               TO  FLG-IRYOKEIKBN
                 MOVE   ZERO               TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             ELSE
               IF  WK-TOKUSYU >= WK-TAIHI-ZAN-KOHI-M
                 MOVE   1                  TO  FLG-IRYOKEIKBN
                 MOVE   WK-ZENGAKU         TO  WK-TAIHI-KARI-COMPFTN
               ELSE
                 MOVE   ZERO               TO  FLG-IRYOKEIKBN
                 MOVE   ZERO               TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             END-IF
      *
             EVALUATE   KOH-IDX
               WHEN   2
                 IF  LNK-SYU-KOH-COMPFTN(1) <  WK-TAIHI-KARI-COMPFTN
                 AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                   MOVE  LNK-SYU-KOH-COMPFTN(1)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
               WHEN   3
                 IF  LNK-SYU-KOH-COMPFTN(2) <  WK-TAIHI-KARI-COMPFTN
                   MOVE  LNK-SYU-KOH-COMPFTN(2)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
               WHEN   4
                 IF  LNK-SYU-KOH-COMPFTN(3) <  WK-TAIHI-KARI-COMPFTN
                   MOVE  LNK-SYU-KOH-COMPFTN(3)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
             END-EVALUATE
      *
             MOVE    WK-ZENGAKU            TO  WK-TOKUSYU-COMPFTN
      *
             IF    KOH-IDX  >  1
               COMPUTE  WK-TOKUSYU = WK-TAIHI-KARI-COMPFTN +  5
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU            / 10
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU            * 10
               IF  WK-TOKUSYU  >=  WK-TAIHI-ZAN-KOHI-M
                 CONTINUE
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             END-IF
           END-IF
      *
      ***
      *
           EVALUATE   KOH-IDX
             WHEN   2
               IF  LNK-SYU-KOH-COMPFTN(1) <  WK-TOKUSYU-COMPFTN
               AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                 MOVE  LNK-SYU-KOH-COMPFTN(1)
                                         TO  WK-TOKUSYU-COMPFTN
               END-IF
             WHEN   3
               IF  LNK-SYU-KOH-COMPFTN(2) <  WK-TOKUSYU-COMPFTN
                 MOVE  LNK-SYU-KOH-COMPFTN(2)
                                         TO  WK-TOKUSYU-COMPFTN
               END-IF
             WHEN   4
               IF  LNK-SYU-KOH-COMPFTN(3) <  WK-TOKUSYU-COMPFTN
                 MOVE  LNK-SYU-KOH-COMPFTN(3)
                                         TO  WK-TOKUSYU-COMPFTN
               END-IF
           END-EVALUATE
      *
           IF    HKN-RECEFTNDSPKBN  =  "2"
             EVALUATE   KOH-IDX
               WHEN   2
                 IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(1) <  WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                     MOVE  LNK-SYU-KOH-COMPFTN(1)
                                             TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(1)      <  WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                     MOVE  WK-KOH-COMPFTN(1) TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN   3
                 IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(2) <  WK-TOKUSYU-COMPFTN2
                     MOVE  LNK-SYU-KOH-COMPFTN(2)
                                             TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(2)      <  WK-TOKUSYU-COMPFTN2
                     MOVE  WK-KOH-COMPFTN(2) TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN   4
                 IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(3) <  WK-TOKUSYU-COMPFTN2
                     MOVE  LNK-SYU-KOH-COMPFTN(3)
                                             TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(3)      <  WK-TOKUSYU-COMPFTN2
                     MOVE  WK-KOH-COMPFTN(3) TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF
      *
           EVALUATE   KOH-IDX
             WHEN   2
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                          <  WK-TOKUSYU-ENTANI
               AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                 MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                         TO  WK-TOKUSYU-ENTANI
               END-IF
             WHEN   3
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                          <  WK-TOKUSYU-ENTANI
                 MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                         TO  WK-TOKUSYU-ENTANI
               END-IF
             WHEN   4
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                          <  WK-TOKUSYU-ENTANI
                 MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                         TO  WK-TOKUSYU-ENTANI
               END-IF
           END-EVALUATE
      *
           IF   FLG-IRYOKEIKBN  =  1
             MOVE        100     TO  WK-GAIKFTNRATE
             MOVE      SPACE     TO  COMB-KOH-GAIJGNKBN(KOH-IDX)
             IF  FLG-GENBUTU70  NOT =  ZERO
               MOVE    "1"       TO  FLG-SYOUKAN(KOH-IDX)
             END-IF
           ELSE
             IF  (WK-1001-PREFNUM               = 11               )
             AND (COMB-KOHHKNNUM(KOH-IDX) = "344" OR "483" OR "683"
                                         OR "783" OR "673" OR "773")
             AND (FLG-SANSHOU2                  = "2" OR "3"       )
             AND (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "3"              )
               EVALUATE   KOH-IDX
                 WHEN       1
                   IF  (WK-TAIHI-MAX-KIN-KOHI1-M
                                         =  WK-TAIHI-MAX-KIN-KOHI-M)
                   AND (WK-GAIKFTNRATE   =  ZERO                   )
                     MOVE  SPACE  TO  COMB-KOH-GAIJGNKBN(KOH-IDX)
                   END-IF
                 WHEN       2
                   IF  (WK-TAIHI-MAX-KIN-KOHI2-M
                                         =  WK-TAIHI-MAX-KIN-KOHI-M)
                   AND (WK-GAIKFTNRATE   =  ZERO                   )
                     MOVE  SPACE  TO  COMB-KOH-GAIJGNKBN(KOH-IDX)
                   END-IF
                 WHEN       3
                   IF  (WK-TAIHI-MAX-KIN-KOHI3-M
                                         =  WK-TAIHI-MAX-KIN-KOHI-M)
                   AND (WK-GAIKFTNRATE   =  ZERO                   )
                     MOVE  SPACE  TO  COMB-KOH-GAIJGNKBN(KOH-IDX)
                   END-IF
                 WHEN       4
                   IF  (WK-TAIHI-MAX-KIN-KOHI4-M
                                         =  WK-TAIHI-MAX-KIN-KOHI-M)
                   AND (WK-GAIKFTNRATE   =  ZERO                   )
                     MOVE  SPACE  TO  COMB-KOH-GAIJGNKBN(KOH-IDX)
                   END-IF
               END-EVALUATE
             END-IF
           END-IF
      *
           .
      *
       23044-IRYOKEIKBN-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費の患者負担金額計算（上限額あり）                    *
      ******************************************************************
       2305-KOH-KEISAN-SEC           SECTION.
      *
      *    負担金額の計算
           IF  WK-GAIKFTNRATE     NOT =    ZERO
      *
               COMPUTE   WK-FUTANWARI  =
                              WK-GAIKFTNRATE  /  100
               IF    WK-KOH-FTNKBN   NOT =  SPACE
                 EVALUATE  WK-KOH-FTNKBN
                    WHEN  "1"
                      COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                      COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                    WHEN  "2"
                      MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                      MOVE    ZERO   TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                      MOVE    ZERO   TO   LNK-SYU-KYUFUGAI-SHOSHIN-TEN
                                          LNK-SYU-KYUFUGAI-SIDOU-TEN
                                          LNK-SYU-KYUFUGAI-OSIN1-TEN
                                          LNK-SYU-KYUFUGAI-OSIN2-TEN
                                          LNK-SYU-KYUFUGAI-OSIN3-TEN
                                          LNK-SYU-KYUFUGAI-GOKEI-TEN
                 END-EVALUATE
               ELSE
                 COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
                 COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
               END-IF
               IF  ((LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0"  ) AND
                    (WK-DOTANDOKU(KOH-IDX)             =  ZERO ))
               OR  ( WK-TOKATUKAI(KOH-IDX)             =  1     )
               OR  ( WK-KOHJGNGET-TEKIYOFLG(KOH-IDX)   =  1     )
      *             減額
                    MOVE      999   TO     WK-GAIKFTNRATE2
                    MOVE      1     TO     FLG-GENGAKU-HENSYU
                    PERFORM   23059-KOH-GENGAKU-HENSYU-SEC
                    IF  WK-GENGAKUKBN  NOT =  ZERO
                        MOVE  WK-GENGAKU-GAK
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  WK-GENGAKU-GAK-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                    END-IF
                    IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "027"
                        MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)                 
                                            TO WK-TOKUTEI-COMPFTN3      
                    END-IF
               END-IF                                                   
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                  ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                  ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN
                                        TO  LNK-SYU-SYUCOMPFTN
                   END-IF
                   IF    LNK-SYU-KOH-HKNNUM(1)    =    "027"
                     IF  WK-TOKUTEI-COMPFTN3  NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN3
                                        TO  LNK-SYU-KOH-COMPFTN(1)
                     END-IF
                   END-IF
               ELSE
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  / 10
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             WK-FTN   *  10
               END-IF
      *
               IF  (KOH-IDX               =  2   )
               AND (WK-RUI-TAISYO         =  1   )
               AND (WK-2010-KINJYOKBN-G(1)
                                          = "1"  )
               AND (FLG-MARUTOARI         =  1   )
               AND (FLG-MARUTOARI2        =  1   )
                 IF  HKN-RECEFTNDSPKBN  =  "2"
                   MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  TO
                                        WK-MARUTOARI-COMPFTN
                   IF  LNK-SYU-KOH-COMPFTN(KOH-IDX) >
                                              WK-RUI-FTN2-M2
                     COMPUTE LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                             WK-RUI-FTN2-M2
                   ELSE
                     MOVE  ZERO  TO
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN(KOH-IDX) >
                                              WK-RUI-FTN2-M
                     COMPUTE LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                             WK-RUI-FTN2-M
                   ELSE
                     MOVE  ZERO  TO
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) >
                                            WK-RUI-FTN2-M3-XXX
                   COMPUTE LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                           WK-RUI-FTN2-M3-XXX
                 ELSE
                   MOVE  ZERO  TO
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               END-IF
      *
               IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =   "1" )  OR         
                    (FLG-KOHININBARAI             =    1  ))            
               AND ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "027" )            
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      ZAN-KOHI1-ENTANI            
                     MOVE   ZAN-KOHI1-ENTANI       TO                   
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) 
                 END-IF                                                 
               ELSE                                                     
                IF  (KOH-IDX         =   2)
                AND (WK-RUI-TAISYO   =   1)
                AND (FLG-RUIKEIYO2   =   2)
                 IF    WK-RUI-FTN2-M3-XXX  >=  WK-RUI-COMPFTN-ENTANI
                     MOVE     ZERO         TO  WK-ZAN-FTN2-M3-XXX
                 ELSE
                     COMPUTE  WK-ZAN-FTN2-M3-XXX
                                            =  WK-RUI-COMPFTN-ENTANI -
                                               WK-RUI-FTN2-M3-XXX
                 END-IF
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      WK-ZAN-FTN2-M3-XXX
                     MOVE   WK-ZAN-FTN2-M3-XXX     TO
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                ELSE
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      ZAN-KOHI-T3(KOH-IDX)        
                     MOVE   ZAN-KOHI-T3(KOH-IDX)   TO                   
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) 
                 END-IF                                                 
                END-IF
               END-IF                                                   
      *
               IF    FLG-ICHIBU-JYOSEI  =   1
                   IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                      MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                      MOVE  ZERO  TO
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   ELSE
                      MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                      COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                               580
                   END-IF
               END-IF
      *
               IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                IF  (KOH-IDX               =  2   )
                AND (WK-RUI-TAISYO         =  1   )
                AND (WK-2010-KINJYOKBN-G(1)
                                           = "1"  )
                AND (FLG-MARUTOARI         =  1   )
                 CONTINUE
                ELSE
                 IF    FLG-ICHIBU-JYOSEI  =  1
                 AND   KOH-IDX            =  1
                   IF  LNK-SYU-SYUCOMPFTN-ENTANI
                             >   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     COMPUTE  WK-KEISAN-JYOSEI-EN          =
                              LNK-SYU-SYUCOMPFTN-ENTANI    -
                              LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     IF  WK-KEISAN-JYOSEI-EN
                             <   LNK-SYU-JYO-COMPFTN-ENTANI
                       MOVE   WK-KEISAN-JYOSEI-EN
                                 TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   ELSE
                     MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   END-IF
                 END-IF
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      LNK-SYU-SYUCOMPFTN-ENTANI
                     MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                END-IF
               END-IF
      *
               PERFORM    23053-KOHHI-HIKAKU3-SEC
      *
               IF    FLG-ICHIBU-JYOSEI  =   2
                   IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                      MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                      MOVE  ZERO  TO
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   ELSE
                      MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                      COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                               580
                   END-IF
               END-IF
      *
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                  ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                  ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                 IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)   >                 
                                            ZAN-KOHI-T2(KOH-IDX)        
                     MOVE   ZAN-KOHI-T2(KOH-IDX)   TO                   
                                          WK-KOH-COMPFTN(KOH-IDX)       
                 ELSE
                     MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)   TO
                                          WK-KOH-COMPFTN(KOH-IDX)       
                 END-IF                                                 
      *
                 IF   (FLG-ICHIBU-JYOSEI     =  1      )
                 AND  (LNK-SYU-SRYYMD(1:6)  >= "201808")
                   IF   WK-KOH-COMPFTN(KOH-IDX)  <  580
                      MOVE  ZERO  TO
                               WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                      COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                               WK-KOH-COMPFTN(KOH-IDX) -
                               580
                   END-IF
                 END-IF
      *
                 IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  IF  (KOH-IDX               =  2   )
                  AND (WK-RUI-TAISYO         =  1   )
                  AND (WK-2010-KINJYOKBN-G(1)
                                             = "1"  )
                  AND (FLG-MARUTOARI         =  1   )
                   CONTINUE
                  ELSE
                   IF  WK-KOH-COMPFTN(KOH-IDX)
                                       >  LNK-SYU-SYUCOMPFTN-ENTANI
                     MOVE   LNK-SYU-SYUCOMPFTN-ENTANI      TO
                                          WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                  END-IF
                 END-IF
      *
                 PERFORM    23052-KOHHI-HIKAKU2-SEC
      *
                 IF    FLG-ICHIBU-JYOSEI  =  2
                   IF   WK-KOH-COMPFTN(KOH-IDX)  <  580
                      MOVE  ZERO  TO
                               WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                      COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                               WK-KOH-COMPFTN(KOH-IDX) -
                               580
                   END-IF
                 END-IF
               END-IF
      *
               IF    LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0"
                 MOVE   ZERO   TO   WK-MIYAGI-COMPFTN
                 IF  LNK-SYU-KOH-HKNNUM(KOH-IDX)  = "021" OR
                                                    "015" OR "016" OR
                                                    "024" OR "079"
                    MOVE  WK-KOH-COMPFTN(KOH-IDX) TO  WK-MIYAGI-COMPFTN
                 END-IF
               END-IF
               IF    LNK-SYU-KOH-HKNNUM(KOH-IDX)       =  "021"
                    MOVE  WK-KOH-COMPFTN(KOH-IDX) TO  WK-SEISIN-COMPFTN
               END-IF
      *
               IF  (KOH-IDX               =  2   )
               AND (WK-RUI-TAISYO         =  1   )
               AND (WK-2010-KINJYOKBN-G(1)
                                          = "1"  )
               AND (FLG-MARUTOARI         =  1   )
               AND (FLG-MARUTOARI2        =  1   )
                 IF  HKN-RECEFTNDSPKBN  =  "2"
                   IF  WK-MARUTOARI-COMPFTN > WK-RUI-FTN2-M
                     COMPUTE LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             WK-MARUTOARI-COMPFTN          -
                             WK-RUI-FTN2-M
                   ELSE
                     MOVE  ZERO  TO
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
               END-IF
      *
               IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)   >
                                            ZAN-KOHI-T(KOH-IDX)
                     MOVE   ZAN-KOHI-T(KOH-IDX)   TO
                                          LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"     
                          MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)           
                                            TO WK-TOKUTEI-COMPFTN3      
                     END-IF                                             
               ELSE
                     IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"
                        IF    FLG-KOUGAKUCYO-ININ  =    1
                              MOVE   ZERO  TO  FLG-KOUGAKUCYO-ININ
                        END-IF
                     END-IF 
               END-IF
      *
               IF    FLG-ICHIBU-JYOSEI  =   1
                   IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                WK-KEISAN-JYOSEI              / 10
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                WK-KEISAN-JYOSEI              * 10
                      MOVE  WK-KEISAN-JYOSEI
                                  TO  LNK-SYU-JYO-HKNFTNMONEY
                                      LNK-SYU-JYO-COMPFTN
                      MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   ELSE
                      MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                      LNK-SYU-JYO-COMPFTN
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                               580
                   END-IF
               END-IF
      *
               IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                IF  (KOH-IDX               =  2   )
                AND (WK-RUI-TAISYO         =  1   )
                AND (WK-2010-KINJYOKBN-G(1)
                                           = "1"  )
                AND (FLG-MARUTOARI         =  1   )
                 CONTINUE
                ELSE
                 IF    FLG-ICHIBU-JYOSEI  =  1
                 AND   KOH-IDX            =  1
                   IF  LNK-SYU-SYUCOMPFTN
                             >   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     COMPUTE  WK-KEISAN-JYOSEI             =
                              LNK-SYU-SYUCOMPFTN           +  5
                     COMPUTE  WK-KEISAN-JYOSEI             =
                              WK-KEISAN-JYOSEI             / 10
                     COMPUTE  WK-KEISAN-JYOSEI             =
                              WK-KEISAN-JYOSEI             * 10
                     COMPUTE  WK-KEISAN-JYOSEI2            =
                              LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                     COMPUTE  WK-KEISAN-JYOSEI2            =
                              WK-KEISAN-JYOSEI2            / 10
                     COMPUTE  WK-KEISAN-JYOSEI2            =
                              WK-KEISAN-JYOSEI2            * 10
                     COMPUTE  WK-KEISAN-JYOSEI3            =
                              WK-KEISAN-JYOSEI             -
                              WK-KEISAN-JYOSEI2
                     IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                       MOVE   WK-KEISAN-JYOSEI3
                                 TO  LNK-SYU-JYO-HKNFTNMONEY
                                     LNK-SYU-JYO-COMPFTN
                     END-IF
                   ELSE
                     MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                     LNK-SYU-JYO-COMPFTN
                   END-IF
                 END-IF
                 IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     >  LNK-SYU-SYUCOMPFTN
                   MOVE   LNK-SYU-SYUCOMPFTN  TO
                                    LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
                END-IF
               END-IF
      *
               PERFORM    23051-KOHHI-HIKAKU-SEC
      *
               IF    FLG-ICHIBU-JYOSEI  =   2
                   IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                WK-KEISAN-JYOSEI              / 10
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                WK-KEISAN-JYOSEI              * 10
                      MOVE  WK-KEISAN-JYOSEI
                                  TO  LNK-SYU-JYO-HKNFTNMONEY
                                      LNK-SYU-JYO-COMPFTN
                      MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   ELSE
                      MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                      LNK-SYU-JYO-COMPFTN
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                               580
                   END-IF
               END-IF
      *
               MOVE       ZERO    TO  FLG-JGNGAK-CHECK
               PERFORM    23058-JGNGAK-CHECK-SEC
      *
               COMPUTE    ZAN-KOHI-T(KOH-IDX)    =
                          ZAN-KOHI-T(KOH-IDX)    -
                          LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
               IF   (LNK-SYU-KOH-HKNNUM(KOH-IDX)         =
                                                 "024" OR "079")
               AND  (WK-TAIHI-JGNGAKEN(KOH-IDX)(7:1) NOT = "0" )
               AND  (LNK-SYU-KOH-COMPFTN(KOH-IDX)    NOT = ZERO)
               AND  (ZAN-KOHI-T(KOH-IDX)                 = ZERO)
                  MOVE     1    TO    WK-TAIHI-FTNGAKEN(KOH-IDX)
               END-IF
      *
               MOVE  WK-GAIYKZFTNKBN
                                TO   LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
               IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO                 
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =                      
      ***                    ZAN-KOHI-T(KOH-IDX)  +  5                  
                             ZAN-KOHI-T(KOH-IDX)  +  4                  
                   COMPUTE   WK-FTN      =                              
                             ZAN-KOHI-T(KOH-IDX)  /  10                 
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =                      
                             WK-FTN   *  10                             
               END-IF                                                   
               EVALUATE   WK-GAIYKZFTNKBN
                   WHEN   "0"
                       MOVE  ZERO  TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                   WHEN   "1"
                       MOVE  YAKFTN-SOGOKEI   TO
                                LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                WK-KOH-YAKFTN-T(KOH-IDX)
                   WHEN   "2"
                       IF    YAKFTN-SOGOKEI  >  ZAN-KOHI-T(KOH-IDX)
                             MOVE   ZAN-KOHI-T(KOH-IDX)  TO  
                                       LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                             MOVE   ZERO    TO
                                            ZAN-KOHI-T(KOH-IDX)
                       ELSE
                             MOVE  YAKFTN-SOGOKEI  TO
                                       LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                             COMPUTE  ZAN-KOHI-T(KOH-IDX)   =
                                      ZAN-KOHI-T(KOH-IDX)   -
                                      LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                       END-IF
                   WHEN   "3"
                       MOVE  YAKFTN-SOGOKEI TO  LNK-SYU-KOH-COMPYKZFTN
                                                            (KOH-IDX)
               END-EVALUATE
               COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                         LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
           ELSE
               IF  ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          )
               OR  ( HKN-RECEFTNDSPKBN           = "2"            )
               OR  ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                    (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                 IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX)  =  "1" OR "2")
                 AND  (LNK-SYU-SRYYMD(1:6)           >= "201801"   )
                   CONTINUE
                 ELSE
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF  WK-TOKUTEI-COMPFTN  NOT =  ZERO
                     MOVE  WK-TOKUTEI-COMPFTN
                                          TO  LNK-SYU-SYUCOMPFTN
                   END-IF
                   IF  LNK-SYU-KOH-HKNNUM(1)   =  "027"
                     IF  WK-TOKUTEI-COMPFTN3  NOT =  ZERO
                       MOVE  WK-TOKUTEI-COMPFTN3
                                          TO  LNK-SYU-KOH-COMPFTN(1)
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
      *        特殊計算（限度を超えた場合、患者負担発生（全額））
      *
               IF   WK-2010-IRYOKEIKBN-G(KOH-IDX)  =  "1" OR "2"
                  MOVE     "1"     TO    LNK-S01-TOKUSYU-SAI-KBN
                  PERFORM   23054-TOKUSYU-SANTEI-SEC
                  GO    TO  2305-KOH-KEISAN-EXT
               END-IF
      *        特殊計算（限度を超えた場合、患者負担発生（超えた額））
      *********（岡山県）
      *********（東京都）
               IF   WK-2010-KINJYOKBN-G(KOH-IDX)   =  "1"
                  PERFORM   23055-TOKUSYU-SANTEI2-SEC
                  GO    TO  2305-KOH-KEISAN-EXT
               END-IF
      *        特殊計算（２割又は３割の額を算出後、半額を患者負担とする）
      *********（秋田県）
               IF  (WK-1001-PREFNUM             =  05             ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "374" OR "474"
                                                        OR "280"  ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200508" )
                  PERFORM   23056-TOKUSYU-SANTEI3-SEC
                  GO    TO  2305-KOH-KEISAN-EXT
               END-IF
      *        特殊計算（長期の計算）
               IF  (LNK-SYU-SRYYMD(1:6)        >= "200804"      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "972" OR "974")
                  PERFORM   23057-TOKUSYU-SANTEI4-SEC
                  GO    TO  2305-KOH-KEISAN-EXT
               END-IF
      *        特殊計算
      *********（熊本県）
               IF ((WK-1001-PREFNUM             =  43           ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "143" OR "342") AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200912"      ))
               OR ((WK-1001-PREFNUM             =  43           ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "443"         ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "201608"      ))
                  MOVE   1    TO  WK-TAIHI-FTNGAKEN(KOH-IDX)
                  MOVE  "1"   TO  WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                  PERFORM   23061-KUMAMOTO-KOHI2-SEC
                  GO    TO  2305-KOH-KEISAN-EXT
               END-IF
               IF  (WK-1001-PREFNUM             =  43           ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "343"         ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "201204"      )
                  PERFORM   23061-KUMAMOTO-KOHI3-SEC
                  GO    TO  2305-KOH-KEISAN-EXT
               END-IF
      *        特殊計算
      *********（山口県）
               IF  (WK-1001-PREFNUM             =  35 OR 34     ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "781"         ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "201309"      )
                  PERFORM   23065-JYOSEI-KOHI-SEC
                  GO    TO  2305-KOH-KEISAN-EXT
               END-IF
      *********（愛知県）
               IF  (WK-1001-PREFNUM             =  23           ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) =
                                "581" OR "681" OR "781" OR "271") AND
                   (LNK-SYU-SRYYMD(1:6)        >= "201504"      )
                  PERFORM   23066-JYOSEI-KOHI2-SEC
                  GO    TO  2305-KOH-KEISAN-EXT
               END-IF
      *********（和歌山県）
               IF  (WK-1001-PREFNUM             =  30           ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "281"         ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "201708"      )
                  PERFORM   23068-JYOSEI-KOHI3-SEC
                  GO    TO  2305-KOH-KEISAN-EXT
               END-IF
      *
               IF  (KOH-IDX         =   2)
               AND (WK-RUI-TAISYO   =   1)
               AND (FLG-RUIKEIYO2   =   2)
                 IF  (WK-1001-PREFNUM         =  43           )
                 AND (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342")
                 AND (LNK-SYU-SRYYMD(1:6)    <= "200911"      )
                      MOVE  "1"  TO  FLG-KUMAMOTO
                      MOVE  "1"  TO  WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                      PERFORM   23061-KUMAMOTO-KOHI-SEC
                      PERFORM   2306A-RUIKEIYO-HENSYU-SEC
                      GO    TO  2305-KOH-KEISAN-EXT
                 END-IF
                 IF  (WK-1001-PREFNUM         =  13     )
                 AND (COMB-KOHHKNNUM(KOH-IDX) = "588"   )
                 AND (LNK-SYU-SRYYMD(1:6)    >= "200710")
                 AND (LNK-SYU-SRYYMD(1:6)    <= "200909")
                      PERFORM   23064-TOKYO-KOHI-SEC
                      PERFORM   2306A-RUIKEIYO-HENSYU-SEC
                      GO    TO  2305-KOH-KEISAN-EXT
                 END-IF
               END-IF
      *
               IF    FLG-ICHIBU-JYOSEI  =   1
                 IF  LNK-SYU-SYUHKNNUM  NOT =  SPACE
                   COMPUTE  WK-FUTANWARI = WK-KOH-FTNRATE / 100
                 ELSE
                   COMPUTE  WK-FUTANWARI = 100            / 100
                 END-IF
                 COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                          WK-ZENGAKU * WK-FUTANWARI
      *
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >  ZAN-KOHI-T3(KOH-IDX)
                   MOVE  ZAN-KOHI-T3(KOH-IDX)
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                               TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   MOVE  ZERO  TO
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                            580
                 END-IF
      *
                 IF    LNK-SYU-SYUHKNNUM  NOT =  SPACE
                   IF  KOH-IDX  =  1
                     IF  LNK-SYU-SYUCOMPFTN-ENTANI
                               >   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       COMPUTE  WK-KEISAN-JYOSEI-EN          =
                                LNK-SYU-SYUCOMPFTN-ENTANI    -
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       IF  WK-KEISAN-JYOSEI-EN
                               <   LNK-SYU-JYO-COMPFTN-ENTANI
                         MOVE   WK-KEISAN-JYOSEI-EN
                                   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   END-IF
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                               >   LNK-SYU-SYUCOMPFTN-ENTANI
                       MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                 END-IF
               ELSE
                 IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                       IF    LNK-SYU-SYUCOMPFTN-ENTANI
                                                 >  ZAN-KOHI-T3(KOH-IDX)
                           MOVE   ZAN-KOHI-T3(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       ELSE
                           MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                 ELSE
                   IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                   AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                       IF    LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                 >  ZAN-KOHI-T3(KOH-IDX)
                           MOVE   ZAN-KOHI-T3(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       ELSE
                           MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                   ELSE
                       IF    WK-ZENGAKU   >  ZAN-KOHI-T3(KOH-IDX)
                           MOVE   ZAN-KOHI-T3(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       ELSE
                           MOVE   WK-ZENGAKU
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                   END-IF
                 END-IF
               END-IF
      *
               PERFORM    23053-KOHHI-HIKAKU3-SEC
      *
               IF    FLG-ICHIBU-JYOSEI  =   2
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                               TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   MOVE  ZERO  TO
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                            580
                 END-IF
               END-IF
      *
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                  ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                  ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                 IF   (FLG-ICHIBU-JYOSEI     =  1      )
                 AND  (LNK-SYU-SRYYMD(1:6)  >= "201808")
                   IF  LNK-SYU-SYUHKNNUM  NOT =  SPACE
                     COMPUTE  WK-FUTANWARI = WK-KOH-FTNRATE / 100
                   ELSE
                     COMPUTE  WK-FUTANWARI = 100            / 100
                   END-IF
                   COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                            WK-ZENGAKU * WK-FUTANWARI
      *
                   IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                       >  ZAN-KOHI-T2(KOH-IDX)
                     MOVE  ZAN-KOHI-T2(KOH-IDX)
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   IF  WK-KOH-COMPFTN(KOH-IDX)  <  580
                     MOVE  ZERO  TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                              WK-KOH-COMPFTN(KOH-IDX) -
                              580
                   END-IF
      *
                   IF    LNK-SYU-SYUHKNNUM  NOT =  SPACE
                     IF    WK-KOH-COMPFTN(KOH-IDX)
                                 >   LNK-SYU-SYUCOMPFTN-ENTANI
                         MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
                     END-IF
                   END-IF
                 ELSE
                   IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                   AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                         IF   LNK-SYU-SYUCOMPFTN-ENTANI
                                             >= ZAN-KOHI-T2(KOH-IDX)
                           MOVE  ZAN-KOHI-T2(KOH-IDX)
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         ELSE
                           MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         END-IF
                   ELSE
                     IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                     AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                         IF   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                             >  ZAN-KOHI-T2(KOH-IDX)
                           MOVE  ZAN-KOHI-T2(KOH-IDX)
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         ELSE
                           MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         END-IF
                     ELSE
                         IF   WK-ZENGAKU     >  ZAN-KOHI-T2(KOH-IDX)
                           MOVE  ZAN-KOHI-T2(KOH-IDX)
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         ELSE
                           MOVE  WK-ZENGAKU
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         END-IF
                     END-IF
                   END-IF
                 END-IF
      *
                 PERFORM 23052-KOHHI-HIKAKU2-SEC
      *
                 IF    FLG-ICHIBU-JYOSEI  =   2
                   IF  WK-KOH-COMPFTN(KOH-IDX)  <  580
                     MOVE  ZERO  TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                              WK-KOH-COMPFTN(KOH-IDX) -
                              580
                   END-IF
                 END-IF
               END-IF
      *
               IF    LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0"
                 MOVE   ZERO   TO   WK-MIYAGI-COMPFTN
                 IF  LNK-SYU-KOH-HKNNUM(KOH-IDX)  = "015" OR "016" OR
                                                    "051" OR "052"
                    MOVE  WK-KOH-COMPFTN(KOH-IDX) TO  WK-MIYAGI-COMPFTN
                 END-IF
               END-IF
      *
               IF    FLG-ICHIBU-JYOSEI  =   1
                 IF  LNK-SYU-SYUHKNNUM  NOT =  SPACE
                   COMPUTE  WK-FUTANWARI = WK-KOH-FTNRATE / 100
                 ELSE
                   COMPUTE  WK-FUTANWARI = 100            / 100
                 END-IF
                 COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                          WK-ZENGAKU * WK-FUTANWARI
                 IF  HKN-RECEFTNDSPKBN  =  "2"
                   CONTINUE
                 ELSE
                   COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  / 10
                   COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  * 10
                 END-IF
      *
                 IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     >  ZAN-KOHI-T(KOH-IDX)
                   MOVE  ZAN-KOHI-T(KOH-IDX)
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
                 IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              WK-KEISAN-JYOSEI              / 10
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              WK-KEISAN-JYOSEI              * 10
                    MOVE  WK-KEISAN-JYOSEI
                                TO  LNK-SYU-JYO-HKNFTNMONEY
                                    LNK-SYU-JYO-COMPFTN
                    MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                    MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                    LNK-SYU-JYO-COMPFTN
                    COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                             580
                 END-IF
      *
                 IF    LNK-SYU-SYUHKNNUM  NOT =  SPACE
                   IF  KOH-IDX  =  1
                     IF  LNK-SYU-SYUCOMPFTN
                               >   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       COMPUTE  WK-KEISAN-JYOSEI             =
                                LNK-SYU-SYUCOMPFTN           +  5
                       COMPUTE  WK-KEISAN-JYOSEI             =
                                WK-KEISAN-JYOSEI             / 10
                       COMPUTE  WK-KEISAN-JYOSEI             =
                                WK-KEISAN-JYOSEI             * 10
                       COMPUTE  WK-KEISAN-JYOSEI2            =
                                LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                       COMPUTE  WK-KEISAN-JYOSEI2            =
                                WK-KEISAN-JYOSEI2            / 10
                       COMPUTE  WK-KEISAN-JYOSEI2            =
                                WK-KEISAN-JYOSEI2            * 10
                       COMPUTE  WK-KEISAN-JYOSEI3            =
                                WK-KEISAN-JYOSEI             -
                                WK-KEISAN-JYOSEI2
                       IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                         MOVE   WK-KEISAN-JYOSEI3
                                   TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                     END-IF
                   END-IF
                   IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)
                               >   LNK-SYU-SYUCOMPFTN
                       MOVE  LNK-SYU-SYUCOMPFTN
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
               ELSE
                 IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                     IF  LNK-SYU-SYUCOMPFTN > ZAN-KOHI-T(KOH-IDX)
                       MOVE   ZAN-KOHI-T(KOH-IDX)
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                       MOVE   LNK-SYU-SYUCOMPFTN
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                 ELSE
                   IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                   AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                     IF  LNK-SYU-KOH-COMPFTN(1) > ZAN-KOHI-T(KOH-IDX)
                       MOVE   ZAN-KOHI-T(KOH-IDX)
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                       MOVE   LNK-SYU-KOH-COMPFTN(1)
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                   ELSE
                     IF  WK-ZENGAKU > ZAN-KOHI-T(KOH-IDX)
                       MOVE   ZAN-KOHI-T(KOH-IDX)
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                       MOVE   WK-ZENGAKU
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               PERFORM   23051-KOHHI-HIKAKU-SEC
      *
               IF    FLG-ICHIBU-JYOSEI  =   2
                 IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              WK-KEISAN-JYOSEI              / 10
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              WK-KEISAN-JYOSEI              * 10
                    MOVE  WK-KEISAN-JYOSEI
                                TO  LNK-SYU-JYO-HKNFTNMONEY
                                    LNK-SYU-JYO-COMPFTN
                    MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                    MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                    LNK-SYU-JYO-COMPFTN
                    COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                             580
                 END-IF
               END-IF
      *
               MOVE      1       TO  FLG-JGNGAK-CHECK
               PERFORM   23058-JGNGAK-CHECK-SEC
      *
               COMPUTE   ZAN-KOHI-T(KOH-IDX)  =
                         ZAN-KOHI-T(KOH-IDX)  -
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
               IF   (LNK-SYU-KOH-HKNNUM(KOH-IDX)         =
                                                 "012" OR "025")
               AND  (WK-TAIHI-JGNGAKEN(KOH-IDX)(7:1) NOT = "0" )
               AND  (LNK-SYU-KOH-COMPFTN(KOH-IDX)    NOT = ZERO)
               AND  (ZAN-KOHI-T(KOH-IDX)                 = ZERO)
                  MOVE     1    TO    WK-TAIHI-FTNGAKEN(KOH-IDX)
               END-IF
      *
               MOVE  WK-GAIYKZFTNKBN   TO  LNK-SYU-KOH-YKZFTNKBN
                                                        (KOH-IDX)
               IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
      ***                    ZAN-KOHI-T(KOH-IDX)  +  5
                             ZAN-KOHI-T(KOH-IDX)  +  4
                   COMPUTE   WK-FTN      =
                             ZAN-KOHI-T(KOH-IDX)  /  10
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                             WK-FTN   *  10
               END-IF
               EVALUATE   WK-GAIYKZFTNKBN
                   WHEN   "0"
                       MOVE  ZERO  TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                   WHEN   "1"
                       MOVE  YAKFTN-SOGOKEI
                                   TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                   WHEN   "2"
                       IF    YAKFTN-SOGOKEI  >  ZAN-KOHI-T(KOH-IDX)
                             MOVE   ZAN-KOHI-T(KOH-IDX)  
                                   TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                             MOVE   ZERO    TO  ZAN-KOHI-T(KOH-IDX)
                       ELSE
                             MOVE  YAKFTN-SOGOKEI  TO
                                       LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                       WK-KOH-YAKFTN-T(KOH-IDX)
                             COMPUTE  ZAN-KOHI-T(KOH-IDX)   =
                                      ZAN-KOHI-T(KOH-IDX)   -
                                      LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                       END-IF
                   WHEN   "3"
                       MOVE  YAKFTN-SOGOKEI
                                   TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
               END-EVALUATE
               COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                         LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
               IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =   "051"
               AND  LNK-SYU-SRYYMD(1:6)          <  "200310"
                    MOVE  YAKFTN-SOGOKEI   TO
                                       LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                    COMPUTE   WK-FTN  =
                              LNK-SYU-KOH-COMPFTN(KOH-IDX)  +
                              WK-KOH-YAKFTN-T(KOH-IDX)
                    IF        WK-FTN    >  1000
                        MOVE  1000   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  ZERO   TO   WK-KOH-YAKFTN-T(KOH-IDX)
                    ELSE
                        MOVE  WK-FTN TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  ZERO   TO   WK-KOH-YAKFTN-T(KOH-IDX)
                    END-IF
               END-IF
           END-IF.
      *
       2305-KOH-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費単位で計算した患者負担金を比較
      ******************************************************************
       23051-KOHHI-HIKAKU-SEC           SECTION.
      *
           IF   ( LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974" )
           OR   ((KOH-IDX         =   2) AND
                 (WK-RUI-TAISYO   =   1)                        )
             IF  (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974")
             AND (LNK-SYU-SRYYMD(1:6)         <  "200804"      )
             AND (LNK-SYU-KOH-HKNNUM(1)       =  "027"         )
               IF  LNK-SYU-KOH-COMPFTN(1) < LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   MOVE  LNK-SYU-KOH-COMPFTN(1)
                                        TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
             END-IF
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH1HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN(1)
                                   >     LNK-SYU-KOH-COMPFTN(2)
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 LNK-SYU-KOH-COMPFTN(1)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        / 10
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        * 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 LNK-SYU-KOH-COMPFTN(2)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       / 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       * 10
                       COMPUTE   WK-KEISAN-JYOSEI3       =
                                 WK-KEISAN-JYOSEI        -
                                 WK-KEISAN-JYOSEI2
                       IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                         MOVE  WK-KEISAN-JYOSEI3
                                   TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN(1) < LNK-SYU-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  LNK-SYU-KOH-COMPFTN(2)
                   END-IF
               WHEN    3
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH2HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN(2)
                                   >     LNK-SYU-KOH-COMPFTN(3)
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 LNK-SYU-KOH-COMPFTN(2)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        / 10
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        * 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 LNK-SYU-KOH-COMPFTN(3)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       / 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       * 10
                       COMPUTE   WK-KEISAN-JYOSEI3       =
                                 WK-KEISAN-JYOSEI        -
                                 WK-KEISAN-JYOSEI2
                       IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                         MOVE  WK-KEISAN-JYOSEI3
                                   TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN(2) < LNK-SYU-KOH-COMPFTN(3)
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  LNK-SYU-KOH-COMPFTN(3)
                   END-IF
               WHEN    4
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH3HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN(3)
                                   >     LNK-SYU-KOH-COMPFTN(4)
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 LNK-SYU-KOH-COMPFTN(3)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        / 10
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        * 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 LNK-SYU-KOH-COMPFTN(4)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       / 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       * 10
                       COMPUTE   WK-KEISAN-JYOSEI3       =
                                 WK-KEISAN-JYOSEI        -
                                 WK-KEISAN-JYOSEI2
                       IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                         MOVE  WK-KEISAN-JYOSEI3
                                   TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN(3) < LNK-SYU-KOH-COMPFTN(4)
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  LNK-SYU-KOH-COMPFTN(4)
                   END-IF
             END-EVALUATE
           END-IF.
      *
       23051-KOHHI-HIKAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費単位で計算した患者負担金を比較
      *        （レセ記載金額退避用エリア用）
      ******************************************************************
       23052-KOHHI-HIKAKU2-SEC           SECTION.                             
      *
           IF   ( LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974" )
           OR   ((KOH-IDX         =   2) AND
                 (WK-RUI-TAISYO   =   1)                        )
             IF  (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974")
             AND (LNK-SYU-SRYYMD(1:6)         <  "200804"      )
             AND (LNK-SYU-KOH-HKNNUM(1)       =  "027"         )
               IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                 IF  LNK-SYU-KOH-COMPFTN(1) < WK-KOH-COMPFTN(KOH-IDX)
                     MOVE  LNK-SYU-KOH-COMPFTN(1)
                                          TO  WK-KOH-COMPFTN(KOH-IDX)
                 END-IF
               ELSE
                 IF  WK-KOH-COMPFTN(1)      < WK-KOH-COMPFTN(KOH-IDX)
                     MOVE  WK-KOH-COMPFTN(1)
                                          TO  WK-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
             END-IF
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                IF   LNK-SYU-NYNSHOKAISU  =  9
                OR   WK-NYNSHOKAISU       =  9
                   COMPUTE WK-KEISAN = LNK-SYU-KOH-COMPFTN(1) +  5
                   COMPUTE WK-KEISAN = WK-KEISAN              / 10
                   COMPUTE WK-KEISAN = WK-KEISAN              * 10
                   IF  WK-KEISAN < WK-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  WK-KEISAN      TO  WK-KOH-COMPFTN(2)
                   END-IF
                ELSE
                 IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-KOH-COMPFTN(2)
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(1)      < WK-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  WK-KOH-COMPFTN(1)
                                            TO  WK-KOH-COMPFTN(2)
                   END-IF
                 END-IF
                END-IF
               WHEN    3
                 IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-KOH-COMPFTN(3)
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-KOH-COMPFTN(3)
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(2)      < WK-KOH-COMPFTN(3)
                       MOVE  WK-KOH-COMPFTN(2)
                                            TO  WK-KOH-COMPFTN(3)
                   END-IF
                 END-IF
               WHEN    4
                 IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-KOH-COMPFTN(4)
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-KOH-COMPFTN(4)
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(3)      < WK-KOH-COMPFTN(4)
                       MOVE  WK-KOH-COMPFTN(3)
                                            TO  WK-KOH-COMPFTN(4)
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF.
      *
       23052-KOHHI-HIKAKU2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        公費単位で計算した患者負担金を比較
      *        （円単位）
      ******************************************************************
       23053-KOHHI-HIKAKU3-SEC           SECTION.
      *
           IF   ( LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974" )
           OR   ((KOH-IDX         =   2) AND
                 (WK-RUI-TAISYO   =   1)                        )
             IF  (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974")
             AND (LNK-SYU-SRYYMD(1:6)         <  "200804"      )
             AND (LNK-SYU-KOH-HKNNUM(1)       =  "027"         )
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                               <     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
             END-IF
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH1HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                   >     LNK-SYU-KOH-COMPFTN-ENTANI(2)
                       COMPUTE  WK-KEISAN-JYOSEI-EN =
                                LNK-SYU-KOH-COMPFTN-ENTANI(1) -
                                LNK-SYU-KOH-COMPFTN-ENTANI(2)
                       IF WK-KEISAN-JYOSEI-EN
                                       < LNK-SYU-JYO-COMPFTN-ENTANI
                         MOVE  WK-KEISAN-JYOSEI-EN
                                   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                   <     LNK-SYU-KOH-COMPFTN-ENTANI(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                   END-IF
               WHEN    3
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH2HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                   >     LNK-SYU-KOH-COMPFTN-ENTANI(3)
                       COMPUTE  WK-KEISAN-JYOSEI-EN =
                                LNK-SYU-KOH-COMPFTN-ENTANI(2) -
                                LNK-SYU-KOH-COMPFTN-ENTANI(3)
                       IF WK-KEISAN-JYOSEI-EN
                                       < LNK-SYU-JYO-COMPFTN-ENTANI
                         MOVE  WK-KEISAN-JYOSEI-EN
                                   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                   <     LNK-SYU-KOH-COMPFTN-ENTANI(3)
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                   END-IF
               WHEN    4
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH3HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                   >     LNK-SYU-KOH-COMPFTN-ENTANI(4)
                       COMPUTE  WK-KEISAN-JYOSEI-EN =
                                LNK-SYU-KOH-COMPFTN-ENTANI(3) -
                                LNK-SYU-KOH-COMPFTN-ENTANI(4)
                       IF WK-KEISAN-JYOSEI-EN
                                       < LNK-SYU-JYO-COMPFTN-ENTANI
                         MOVE  WK-KEISAN-JYOSEI-EN
                                   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                   <     LNK-SYU-KOH-COMPFTN-ENTANI(4)
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                   END-IF
             END-EVALUATE
           END-IF.
      *
       23053-KOHHI-HIKAKU3-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（限度を超えた場合、患者負担発生（全額））
      ******************************************************************
       23054-TOKUSYU-SANTEI-SEC           SECTION.
      *
           MOVE       ZERO         TO   FLG-IRYOKEIKBN
      *
           IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
             IF  (FLG-KOUGAKUCYO3      =     1)
             OR  (FLG-KOUGAKUCYO-GEN70 =     1)
               MOVE  LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU
             ELSE
               COMPUTE WK-TOKUSYU = LNK-SYU-SYUCOMPFTN +  5
               COMPUTE WK-TOKUSYU = WK-TOKUSYU         / 10
               COMPUTE WK-TOKUSYU = WK-TOKUSYU         * 10
             END-IF
      *
             IF  ( KOH-IDX  =  1                            )
             AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
               IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI1
                   MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI2
                   MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI3
                   MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI4
                   MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"  ) AND
                    (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
               OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"  ) AND
                    (WK-IRYOKEIKBN-HANTEITEN
                                   >= WK-IRYOKEIKBN-MAXTEN))
                 MOVE   1      TO  FLG-IRYOKEIKBN
                 MOVE   WK-TOKUSYU
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
             ELSE
               IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"  ) AND
                    (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
               OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"  ) AND
                    (WK-IRYOKEIKBN-HANTEITEN
                                   >= WK-IRYOKEIKBN-MAXTEN))
                 MOVE   1      TO  FLG-IRYOKEIKBN
                 MOVE   LNK-SYU-SYUCOMPFTN
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
             END-IF
             PERFORM    23051-KOHHI-HIKAKU-SEC
             MOVE       LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU-COMPFTN
      *
             IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1")
             AND  (KOH-IDX                       >  1 )
               COMPUTE WK-TOKUSYU = LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
               COMPUTE WK-TOKUSYU = WK-TOKUSYU                   / 10
               COMPUTE WK-TOKUSYU = WK-TOKUSYU                   * 10
               IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                 CONTINUE
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
             END-IF
           ELSE
             IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND (LNK-SYU-KOH1HKNNUM        =   "027")
               COMPUTE  WK-TOKUSYU = LNK-SYU-KOH-COMPFTN(1) +  5
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU             / 10
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU             * 10
      *
               IF  ( KOH-IDX  =  2                            )
               AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                 IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI1
                     MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI2
                     MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI3
                     MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI4
                     MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"  ) AND
                      (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"  ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                     >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   1      TO  FLG-IRYOKEIKBN
                   MOVE   WK-TOKUSYU
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               ELSE
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"  ) AND
                      (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"  ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                     >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   1      TO  FLG-IRYOKEIKBN
                   MOVE   LNK-SYU-KOH-COMPFTN(1)
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
               PERFORM    23051-KOHHI-HIKAKU-SEC
               MOVE       LNK-SYU-KOH-COMPFTN(1)  TO  WK-TOKUSYU-COMPFTN
      *
               IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1")
               AND  (KOH-IDX                       >  2 )
                 COMPUTE WK-TOKUSYU = LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                 COMPUTE WK-TOKUSYU = WK-TOKUSYU                   / 10
                 COMPUTE WK-TOKUSYU = WK-TOKUSYU                   * 10
                 IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                   CONTINUE
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
             ELSE
               COMPUTE WK-TOKUSYU = WK-ZENGAKU +  5
               COMPUTE WK-TOKUSYU = WK-TOKUSYU / 10
               COMPUTE WK-TOKUSYU = WK-TOKUSYU * 10
      *
               IF  ( KOH-IDX  =  1                            )
               AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                 IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI1
                     MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI2
                     MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI3
                     MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI4
                     MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"  ) AND
                      (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"  ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                     >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   1      TO  FLG-IRYOKEIKBN
                   MOVE   WK-TOKUSYU
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               ELSE
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"  ) AND
                      (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"  ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                     >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   1      TO  FLG-IRYOKEIKBN
                   MOVE   WK-ZENGAKU
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
               PERFORM    23051-KOHHI-HIKAKU-SEC
               MOVE       WK-ZENGAKU  TO  WK-TOKUSYU-COMPFTN
      *
               IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1")
               AND  (KOH-IDX                       >  1 )
                 COMPUTE WK-TOKUSYU = LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                 COMPUTE WK-TOKUSYU = WK-TOKUSYU                   / 10
                 COMPUTE WK-TOKUSYU = WK-TOKUSYU                   *  10
                 IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                   CONTINUE
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF    HKN-RECEFTNDSPKBN      =  "2"
           AND   LNK-SYU-SRYYMD(1:6)   <=  "201712"
             IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
               IF  ( KOH-IDX  =  1                            )
               AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                 MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO  WK-TAIHI-TOKU2
                 IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU2    >   ZAN-KOHI13
                     MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU2
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU2    >   ZAN-KOHI23
                     MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU2
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU2    >   ZAN-KOHI33
                     MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU2
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU2    >   ZAN-KOHI43
                     MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU2
                   END-IF
                 END-IF
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                      (WK-TAIHI-TOKU2 >= ZAN-KOHI-T2(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   WK-TAIHI-TOKU2
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                 END-IF
               ELSE
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                      (LNK-SYU-SYUCOMPFTN-ENTANI
                                      >= ZAN-KOHI-T2(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
               PERFORM    23052-KOHHI-HIKAKU2-SEC
               MOVE       LNK-SYU-SYUCOMPFTN-ENTANI
                                 TO  WK-TOKUSYU-COMPFTN2
      *
               IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1")
               AND  (KOH-IDX                       >  1 )
                 IF  WK-KOH-COMPFTN(KOH-IDX) >= ZAN-KOHI-T2(KOH-IDX)
                   CONTINUE
                 ELSE
                   MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
             ELSE
               IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND (LNK-SYU-KOH1HKNNUM        =   "027")
                 IF  ( KOH-IDX  =  2                            )
                 AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                   MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                     TO  WK-TAIHI-TOKU2
                   IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                     IF   WK-TAIHI-TOKU2    >   ZAN-KOHI13
                       MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU2
                     END-IF
                   END-IF
                   IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                     IF   WK-TAIHI-TOKU2    >   ZAN-KOHI23
                       MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU2
                     END-IF
                   END-IF
                   IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                     IF   WK-TAIHI-TOKU2    >   ZAN-KOHI33
                       MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU2
                     END-IF
                   END-IF
                   IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                     IF   WK-TAIHI-TOKU2    >   ZAN-KOHI43
                       MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU2
                     END-IF
                   END-IF
                   IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                        (WK-TAIHI-TOKU2 >= ZAN-KOHI-T2(KOH-IDX)))
                   OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                        (WK-IRYOKEIKBN-HANTEITEN
                                        >= WK-IRYOKEIKBN-MAXTEN))
                     MOVE   WK-TAIHI-TOKU2
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 ELSE
                   IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                        (LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                        >= ZAN-KOHI-T2(KOH-IDX)))
                   OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                        (WK-IRYOKEIKBN-HANTEITEN
                                        >= WK-IRYOKEIKBN-MAXTEN))
                     MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
                 PERFORM    23052-KOHHI-HIKAKU2-SEC
                 MOVE       LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                   TO  WK-TOKUSYU-COMPFTN2
      *
                 IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1")
                 AND  (KOH-IDX                       >  2 )
                   IF  WK-KOH-COMPFTN(KOH-IDX) >= ZAN-KOHI-T2(KOH-IDX)
                     CONTINUE
                   ELSE
                     MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
               ELSE
                 IF  ( KOH-IDX  =  1                            )
                 AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                   MOVE   WK-ZENGAKU  TO  WK-TAIHI-TOKU2
                   IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                     IF   WK-TAIHI-TOKU2    >   ZAN-KOHI13
                       MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU2
                     END-IF
                   END-IF
                   IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                     IF   WK-TAIHI-TOKU2    >   ZAN-KOHI23
                       MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU2
                     END-IF
                   END-IF
                   IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                     IF   WK-TAIHI-TOKU2    >   ZAN-KOHI33
                       MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU2
                     END-IF
                   END-IF
                   IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                     IF   WK-TAIHI-TOKU2    >   ZAN-KOHI43
                       MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU2
                     END-IF
                   END-IF
                   IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                        (WK-TAIHI-TOKU2 >= ZAN-KOHI-T2(KOH-IDX)))
                   OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                        (WK-IRYOKEIKBN-HANTEITEN
                                        >= WK-IRYOKEIKBN-MAXTEN))
                     MOVE   WK-TAIHI-TOKU2
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 ELSE
                   IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                        (WK-ZENGAKU     >= ZAN-KOHI-T2(KOH-IDX)))
                   OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                        (WK-IRYOKEIKBN-HANTEITEN
                                        >= WK-IRYOKEIKBN-MAXTEN))
                     MOVE   WK-ZENGAKU
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
                 PERFORM    23052-KOHHI-HIKAKU2-SEC
                 MOVE       WK-ZENGAKU
                                   TO  WK-TOKUSYU-COMPFTN2
      *
                 IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1")
                 AND  (KOH-IDX                       >  1 )
                   IF  WK-KOH-COMPFTN(KOH-IDX) >= ZAN-KOHI-T2(KOH-IDX)
                     CONTINUE
                   ELSE
                     MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF        (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND       (LNK-SYU-KOH1HKNNUM    NOT =   "027")
             IF  ( KOH-IDX  =  1                            )
             AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO  WK-TAIHI-TOKU1
               IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                 IF   WK-TAIHI-TOKU1    >   ZAN-KOHI13
                   MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU1
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                 IF   WK-TAIHI-TOKU1    >   ZAN-KOHI23
                   MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU1
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                 IF   WK-TAIHI-TOKU1    >   ZAN-KOHI33
                   MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU1
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                 IF   WK-TAIHI-TOKU1    >   ZAN-KOHI43
                   MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU1
                 END-IF
               END-IF
               IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                    (WK-TAIHI-TOKU1 >= ZAN-KOHI-T3(KOH-IDX)))
               OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                    (WK-IRYOKEIKBN-HANTEITEN
                                    >= WK-IRYOKEIKBN-MAXTEN))
                 MOVE   WK-TAIHI-TOKU1
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)  >=  "201801"
                 IF   FLG-IRYOKEIKBN  =  1
                    MOVE  WK-TAIHI-TOKU1
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                    MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               END-IF
             ELSE
               IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                    (LNK-SYU-SYUCOMPFTN-ENTANI
                                    >= ZAN-KOHI-T3(KOH-IDX)))
               OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                    (WK-IRYOKEIKBN-HANTEITEN
                                    >= WK-IRYOKEIKBN-MAXTEN))
                 MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)  >=  "201801"
                 IF   FLG-IRYOKEIKBN  =  1
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE   ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               END-IF
             END-IF
             PERFORM    23053-KOHHI-HIKAKU3-SEC
             MOVE       LNK-SYU-SYUCOMPFTN-ENTANI
                               TO  WK-TOKUSYU-ENTANI
      *
             IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1")
             AND  (KOH-IDX                       >  1 )
             AND  (LNK-SYU-SRYYMD(1:6)    <=  "201712")
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                      >=  ZAN-KOHI-T3(KOH-IDX)
                 CONTINUE
               ELSE
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
             END-IF
           ELSE
             IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND   (LNK-SYU-KOH1HKNNUM        =   "027")
               IF  ( KOH-IDX  =  2                            )
               AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                 MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                   TO  WK-TAIHI-TOKU1
                 IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI13
                     MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI23
                     MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI33
                     MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI43
                     MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                      (WK-TAIHI-TOKU1 >= ZAN-KOHI-T3(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE  WK-TAIHI-TOKU1
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF   LNK-SYU-SRYYMD(1:6)  >=  "201801"
                   IF   FLG-IRYOKEIKBN  =  1
                     MOVE  WK-TAIHI-TOKU1
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   ELSE
                     MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                 END-IF
               ELSE
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                      (LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                      >= ZAN-KOHI-T3(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF   LNK-SYU-SRYYMD(1:6)  >=  "201801"
                   IF   FLG-IRYOKEIKBN  =  1
                     MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   ELSE
                     MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                 END-IF
               END-IF
               PERFORM    23053-KOHHI-HIKAKU3-SEC
               MOVE       LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                TO  WK-TOKUSYU-ENTANI
      *
               IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1")
               AND  (KOH-IDX                       >  2 )
               AND  (LNK-SYU-SRYYMD(1:6)    <=  "201712")
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                        >=  ZAN-KOHI-T3(KOH-IDX)
                   CONTINUE
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               END-IF
             ELSE
               IF  ( KOH-IDX  =  1                            )
               AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                 MOVE   WK-ZENGAKU  TO  WK-TAIHI-TOKU1
                 IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI13
                     MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI23
                     MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI33
                     MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI43
                     MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                      (WK-TAIHI-TOKU1 >= ZAN-KOHI-T3(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE  WK-TAIHI-TOKU1
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF   LNK-SYU-SRYYMD(1:6)  >=  "201801"
                   IF   FLG-IRYOKEIKBN  =  1
                     MOVE  WK-TAIHI-TOKU1
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   ELSE
                     MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                 END-IF
               ELSE
                 IF  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1"   ) AND
                      (WK-ZENGAKU     >= ZAN-KOHI-T3(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-G(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE  WK-ZENGAKU
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF   LNK-SYU-SRYYMD(1:6)  >=  "201801"
                   IF   FLG-IRYOKEIKBN  =  1
                     MOVE  WK-ZENGAKU
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   ELSE
                     MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                 END-IF
               END-IF
               PERFORM    23053-KOHHI-HIKAKU3-SEC
               MOVE       WK-ZENGAKU
                                TO  WK-TOKUSYU-ENTANI
      *
               IF   (WK-2010-IRYOKEIKBN-G(KOH-IDX) = "1")
               AND  (KOH-IDX                       >  1 )
               AND  (LNK-SYU-SRYYMD(1:6)    <=  "201712")
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                        >=  ZAN-KOHI-T3(KOH-IDX)
                   CONTINUE
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           MOVE  WK-GAIYKZFTNKBN   TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
           MOVE  ZERO              TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
      *    公費単位で計算した患者負担金を比較
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
           END-EVALUATE
      *
      *    公費単位で計算した患者負担金を比較
      *    （レセ記載金額退避用エリア用）
           IF    HKN-RECEFTNDSPKBN      =  "2"
           AND   LNK-SYU-SRYYMD(1:6)   <=  "201712"
             EVALUATE    KOH-IDX
               WHEN    2
                 IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(1)      < WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  WK-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    3
                 IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(2)      < WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    4
                 IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(3)      < WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF
      *
      *    公費単位で計算した患者負担金を比較
      *    （円単位）
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                   <     WK-TOKUSYU-ENTANI
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
           END-EVALUATE
      *
      ***  IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
      ***       (FLG-KOUREI-KBN               =       "1" ))
      ***  AND ( COMB-HKNNUM            NOT   =     SPACE  )
      ***    IF   WK-2010-IRYOKEIKBN-G-XXX(KOH-IDX) = "1"
      ***      IF  (WK-1001-PREFNUM             =  11           )
      ***      AND (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "542" OR "682"
      ***                                      OR "462" OR "562"
      ***                                      OR "662" OR "762")
      ***        CONTINUE
      ***      ELSE
      ***        MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
      ***                        LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
      ***                        WK-TOKUSYU-COMPFTN
      ***                        WK-TOKUSYU-ENTANI
      ***        IF    HKN-RECEFTNDSPKBN    =  "2"
      ***          MOVE  ZERO  TO  WK-KOH-COMPFTN(KOH-IDX)
      ***                          WK-TOKUSYU-COMPFTN2
      ***        END-IF
      ***        COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
      ***                  LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
      ***                  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      ***      END-IF
      ***    END-IF
      ***  END-IF
      *
           .
      *
       23054-TOKUSYU-SANTEI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（限度を超えた場合、患者負担発生（超えた額））
      ******************************************************************
       23055-TOKUSYU-SANTEI2-SEC           SECTION.
      *
           IF        (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND       (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   PERFORM    23053-KOHHI-HIKAKU3-SEC
      *
                   IF  ( KOH-IDX  =  1                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >   ZAN-KOHI-T3(KOH-IDX)
                       COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                                ZAN-KOHI-T3(KOH-IDX)
                   ELSE
                       MOVE   ZERO  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                                 WK-TOKUSYU-ENTANI
           ELSE
               IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                   MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   PERFORM    23053-KOHHI-HIKAKU3-SEC
      *
                   IF  ( KOH-IDX  =  2                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >   ZAN-KOHI-T3(KOH-IDX)
                       COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                                ZAN-KOHI-T3(KOH-IDX)
                   ELSE
                       MOVE   ZERO  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)  TO
                                                  WK-TOKUSYU-ENTANI
               ELSE
                   MOVE   WK-ZENGAKU  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   PERFORM    23053-KOHHI-HIKAKU3-SEC
      *
                   IF  ( KOH-IDX  =  1                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >   ZAN-KOHI-T3(KOH-IDX)
                       COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                                ZAN-KOHI-T3(KOH-IDX)
                   ELSE
                       MOVE   ZERO  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                   MOVE   WK-ZENGAKU   TO   WK-TOKUSYU-ENTANI
               END-IF
           END-IF
      **
           IF    HKN-RECEFTNDSPKBN      =  "2"
              IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                             TO  WK-KOH-COMPFTN(KOH-IDX)
                   PERFORM    23052-KOHHI-HIKAKU2-SEC
      *
                   IF  ( KOH-IDX  =  1                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T2(KOH-IDX)
                       COMPUTE  WK-KOH-COMPFTN(KOH-IDX)  =
                                WK-KOH-COMPFTN(KOH-IDX)  -
                                ZAN-KOHI-T2(KOH-IDX)
                   ELSE
                       MOVE   ZERO    TO   WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                              TO  WK-TOKUSYU-COMPFTN2
              ELSE
                IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                AND (LNK-SYU-KOH1HKNNUM        =   "027")
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                            TO   WK-KOH-COMPFTN(KOH-IDX)
                   PERFORM    23052-KOHHI-HIKAKU2-SEC
      *
                   IF  ( KOH-IDX  =  2                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T2(KOH-IDX)
                       COMPUTE  WK-KOH-COMPFTN(KOH-IDX)  =
                                WK-KOH-COMPFTN(KOH-IDX)  -
                                ZAN-KOHI-T2(KOH-IDX)
                   ELSE
                       MOVE   ZERO    TO   WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                 TO  WK-TOKUSYU-COMPFTN2
                ELSE
                   MOVE   WK-ZENGAKU  TO   WK-KOH-COMPFTN(KOH-IDX)
                   PERFORM    23052-KOHHI-HIKAKU2-SEC
      *
                   IF  ( KOH-IDX  =  1                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T2(KOH-IDX)
                       COMPUTE  WK-KOH-COMPFTN(KOH-IDX)  =
                                WK-KOH-COMPFTN(KOH-IDX)  -
                                ZAN-KOHI-T2(KOH-IDX)
                   ELSE
                       MOVE   ZERO    TO   WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   MOVE   WK-ZENGAKU  TO   WK-TOKUSYU-COMPFTN2
                END-IF
              END-IF
           END-IF
      **
           IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  IF  (FLG-KOUGAKUCYO3      =     1)
                  OR  (FLG-KOUGAKUCYO-GEN70 =     1)
                    MOVE  LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU
                  ELSE
                    COMPUTE  WK-TOKUSYU =  LNK-SYU-SYUCOMPFTN  +   5
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU          /  10
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU          *  10
                  END-IF
      *
                  MOVE  WK-TOKUSYU  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  PERFORM    23051-KOHHI-HIKAKU-SEC
      *
                  IF  ( KOH-IDX  =  1                            )
                  AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI1
                          MOVE   ZAN-KOHI1
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI2
                          MOVE   ZAN-KOHI2
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI3
                          MOVE   ZAN-KOHI3
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI4
                          MOVE   ZAN-KOHI4
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                  END-IF
      *
                  IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                            ZAN-KOHI-T(KOH-IDX)
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                               ZAN-KOHI-T(KOH-IDX)
                  ELSE
                      MOVE   ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  END-IF
                  MOVE   LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU-COMPFTN
           ELSE
              IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND (LNK-SYU-KOH1HKNNUM        =   "027")
                  COMPUTE  WK-TOKUSYU =  LNK-SYU-KOH-COMPFTN(1)  +   5
                  COMPUTE  WK-TOKUSYU =  WK-TOKUSYU              /  10
                  COMPUTE  WK-TOKUSYU =  WK-TOKUSYU              *  10
      *
                  MOVE  WK-TOKUSYU  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  PERFORM    23051-KOHHI-HIKAKU-SEC
      *
                  IF  ( KOH-IDX  =  2                            )
                  AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI1
                          MOVE   ZAN-KOHI1
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI2
                          MOVE   ZAN-KOHI2
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI3
                          MOVE   ZAN-KOHI3
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI4
                          MOVE   ZAN-KOHI4
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                  END-IF
      *
                  IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                            ZAN-KOHI-T(KOH-IDX)
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                               ZAN-KOHI-T(KOH-IDX)
                  ELSE
                      MOVE   ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  END-IF
                  MOVE   LNK-SYU-KOH-COMPFTN(1) TO  WK-TOKUSYU-COMPFTN
              ELSE
                  COMPUTE  WK-TOKUSYU =  WK-ZENGAKU  +   5
                  COMPUTE  WK-TOKUSYU =  WK-TOKUSYU  /  10
                  COMPUTE  WK-TOKUSYU =  WK-TOKUSYU  *  10
      *
                  MOVE  WK-TOKUSYU  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  PERFORM    23051-KOHHI-HIKAKU-SEC
      *
                  IF  ( KOH-IDX  =  1                            )
                  AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI1
                          MOVE   ZAN-KOHI1
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI2
                          MOVE   ZAN-KOHI2
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI3
                          MOVE   ZAN-KOHI3
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI4
                          MOVE   ZAN-KOHI4
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                  END-IF
      *
                  IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                            ZAN-KOHI-T(KOH-IDX)
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                               ZAN-KOHI-T(KOH-IDX)
                  ELSE
                      MOVE   ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  END-IF
                  MOVE   WK-ZENGAKU  TO   WK-TOKUSYU-COMPFTN
              END-IF
           END-IF
      **
           MOVE  WK-GAIYKZFTNKBN   TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
           MOVE  ZERO              TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
      *    公費単位で計算した患者負担金を比較
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
           END-EVALUATE
      *
      *    公費単位で計算した患者負担金を比較
      *    （レセ記載金額退避用エリア用）
           IF    HKN-RECEFTNDSPKBN      =  "2"
             EVALUATE    KOH-IDX
               WHEN    2
                 IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(1)      < WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  WK-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    3
                 IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(2)      < WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    4
                 IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(3)      < WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF
      *
      *    公費単位で計算した患者負担金を比較
      *    （円単位）
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                   <     WK-TOKUSYU-ENTANI
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
           END-EVALUATE
      *
           .
      *
       23055-TOKUSYU-SANTEI2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（２割又は３割の額を算出後、半額を患者負担とする）
      ******************************************************************
       23056-TOKUSYU-SANTEI3-SEC           SECTION.
      *
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  COMPUTE     WK-HANGAKU-ENTANI     =
                              LNK-SYU-SYUCOMPFTN-ENTANI      *  0.5
           ELSE
             IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                    COMPUTE   WK-HANGAKU-ENTANI     =
                              LNK-SYU-KOH-COMPFTN-ENTANI(1)  *  0.5
             ELSE
                    COMPUTE   WK-HANGAKU-ENTANI     =
                              WK-ZENGAKU  *  0.5
             END-IF
           END-IF
      *
           IF    WK-HANGAKU-ENTANI  >  ZAN-KOHI-T3(KOH-IDX)
               MOVE   ZAN-KOHI-T3(KOH-IDX)
                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           ELSE
               MOVE   WK-HANGAKU-ENTANI
                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           PERFORM    23053-KOHHI-HIKAKU3-SEC
      *
      *
           IF     HKN-RECEFTNDSPKBN          =  "2"
      *
              IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                      COMPUTE   WK-HANGAKU-COMPFTN   =
                               (LNK-SYU-SYUCOMPFTN-ENTANI     *  0.5)
                                                              +  0.5
              ELSE
                IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                      COMPUTE   WK-HANGAKU-COMPFTN   =
                               (LNK-SYU-KOH-COMPFTN-ENTANI(1) *  0.5)
                                                              +  0.5
                ELSE
                      COMPUTE   WK-HANGAKU-COMPFTN   =
                               (WK-ZENGAKU  *  0.5)
                                            +  0.5
                END-IF
              END-IF
      *
              IF    WK-HANGAKU-COMPFTN  >  ZAN-KOHI-T2(KOH-IDX)
                  MOVE   ZAN-KOHI-T2(KOH-IDX)
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
              ELSE
                  MOVE  WK-HANGAKU-COMPFTN
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
              END-IF
      *
              PERFORM    23052-KOHHI-HIKAKU2-SEC
      *
           END-IF
      *
      *
           IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   COMPUTE   WK-HANGAKU-COMPFTN   =
      ***                    LNK-SYU-SYUCOMPFTN      *  0.5
                            (WK-TOKUTEI-COMPFTN      *  0.5)
                                                     +  0.5
           ELSE
             IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                   COMPUTE   WK-HANGAKU-COMPFTN   =
      ***                    LNK-SYU-KOH-COMPFTN(1)  *  0.5
                            (WK-TOKUTEI-COMPFTN3     *  0.5)
                                                     +  0.5
             ELSE
                   COMPUTE   WK-HANGAKU-COMPFTN   =
                            (WK-ZENGAKU  *  0.5)
                                         +  0.5
             END-IF
           END-IF
      *
           IF    WK-HANGAKU-COMPFTN  >  ZAN-KOHI-T(KOH-IDX)
               MOVE   ZAN-KOHI-T(KOH-IDX)
                             TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
           ELSE
               MOVE  WK-HANGAKU-COMPFTN
                             TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
           PERFORM    23051-KOHHI-HIKAKU-SEC
      *
      *
           MOVE  WK-GAIYKZFTNKBN   TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
           MOVE  ZERO              TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           .
       23056-TOKUSYU-SANTEI3-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（長期の計算）
      ******************************************************************
       23057-TOKUSYU-SANTEI4-SEC           SECTION.
      *
           IF    FLG-ZENKI-TOKUREI  =  1
             IF   ( WK-1001-PREFNUM      =  27      )
             OR   ((LNK-SYU-SRYYMD(1:6) >= "201508") AND
                   (WK-1001-PREFNUM      =  12     ))
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     =  WK-ZENGAKU  *  0.1
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     =  WK-ZENGAKU  *  0.1
             ELSE
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     =  WK-ZENGAKU  *  0.2
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     =  WK-ZENGAKU  *  0.2
             END-IF
           ELSE
             IF  COMB-HKNNUM        =  SPACE
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                   =  WK-ZENGAKU
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                   =  WK-ZENGAKU
             ELSE
               COMPUTE  WK-FUTANWARI   = WK-KOH-FTNRATE  /  100
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                   =  WK-ZENGAKU  *  WK-FUTANWARI
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                   =  WK-ZENGAKU  *  WK-FUTANWARI
             END-IF
           END-IF
      *
      *    減額
           IF  COMB-HKNNUM  =  SPACE
             CONTINUE
           ELSE
             IF    FLG-ZENKI-TOKUREI  =  1
               MOVE    10               TO   WK-GAIKFTNRATE2
             ELSE
               MOVE    WK-KOH-FTNRATE   TO   WK-GAIKFTNRATE2
             END-IF
             MOVE      ZERO             TO   FLG-GENGAKU-HENSYU
             PERFORM   23059-KOH-GENGAKU-HENSYU-SEC
             IF  WK-GENGAKUKBN  NOT =  ZERO
                 MOVE  WK-GENGAKU-GAK
                        TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 MOVE  WK-GENGAKU-GAK-ENTANI
                        TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
           END-IF
      *
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
           COMPUTE  WK-FTN      =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX) / 10
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                    WK-FTN   *  10
      *
           IF LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) > ZAN-KOHI-T3(KOH-IDX)
              MOVE  ZAN-KOHI-T3(KOH-IDX)  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           IF LNK-SYU-KOH-COMPFTN(KOH-IDX) > ZAN-KOHI-T(KOH-IDX)
              MOVE  ZAN-KOHI-T(KOH-IDX)   TO
                                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
              MOVE  ZERO                  TO ZAN-KOHI-T(KOH-IDX)
           ELSE
              COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
                       ZAN-KOHI-T(KOH-IDX)    -
                       LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
           MOVE  WK-GAIYKZFTNKBN  TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
      *
           IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
      ***                ZAN-KOHI-T(KOH-IDX) +   5
                         ZAN-KOHI-T(KOH-IDX) +   4
               COMPUTE   WK-FTN      =
                         ZAN-KOHI-T(KOH-IDX) /  10
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                         WK-FTN   *  10
           END-IF
      *
           MOVE  ZERO  TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           .
       23057-TOKUSYU-SANTEI4-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        全国公費が月上限額に達するかチェック
      ******************************************************************
       23058-JGNGAK-CHECK-SEC           SECTION.
      *
           MOVE       ZERO     TO     FLG-JGNGAK-CHECK2
      *
           IF     WK-TAIHI-JGNKOHFLG(KOH-IDX)       =   1
             MOVE     ZERO     TO     FLG-NG
             IF     FLG-JGNGAK-CHECK  =  ZERO
               COMPUTE  WK-KEISAN     =  WK-ZENGAKU  *  WK-FUTANWARI
               COMPUTE  WK-KEISAN-EN  =  WK-ZENGAKU  *  WK-FUTANWARI
      *        減額
               MOVE      999   TO     WK-GAIKFTNRATE2
               MOVE      1     TO     FLG-GENGAKU-HENSYU
               PERFORM   230582-KOH-GENGAKU-HENSYU-SEC
               IF  WK-GENGAKUKBN  NOT =  ZERO
                 MOVE   WK-GENGAKU-GAK          TO   WK-KEISAN
                 MOVE   WK-GENGAKU-GAK-ENTANI   TO   WK-KEISAN-EN
               END-IF
               COMPUTE  WK-KEISAN   =  WK-KEISAN   +  5
               COMPUTE  WK-KEISAN   =  WK-KEISAN   / 10
               COMPUTE  WK-KEISAN   =  WK-KEISAN   * 10
             END-IF
             IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
               IF  ( ZAN-KOHI-T3(KOH-IDX) = ZERO                 )
               OR  ((FLG-JGNGAK-CHECK     = ZERO                ) AND
                    (WK-KEISAN-EN        >= ZAN-KOHI-T3(KOH-IDX)) AND
                    (LNK-SYU-SYUCOMPFTN-ENTANI
                                         >= ZAN-KOHI-T3(KOH-IDX)))
               OR  ((FLG-JGNGAK-CHECK     = 1                   ) AND
                    (LNK-SYU-SYUCOMPFTN-ENTANI
                                         >= ZAN-KOHI-T3(KOH-IDX)))
                 CONTINUE
               ELSE
                 MOVE     1        TO     FLG-NG
               END-IF
             ELSE
               IF  ( ZAN-KOHI-T3(KOH-IDX) = ZERO                 )
               OR  ((FLG-JGNGAK-CHECK     = ZERO                ) AND
                    (WK-KEISAN-EN        >= ZAN-KOHI-T3(KOH-IDX)))
               OR  ((FLG-JGNGAK-CHECK     = 1                   ) AND
                    (WK-ZENGAKU          >= ZAN-KOHI-T3(KOH-IDX)))
                 CONTINUE
               ELSE
                 MOVE     1        TO     FLG-NG
               END-IF
             END-IF
      *
             IF     FLG-NG  =  ZERO
               COMPUTE  WK-KEISAN2  =  LNK-SYU-SYUCOMPFTN  +  5
               COMPUTE  WK-KEISAN2  =  WK-KEISAN2          / 10
               COMPUTE  WK-KEISAN2  =  WK-KEISAN2          * 10
               IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
                 IF  ( ZAN-KOHI-T(KOH-IDX)  =  ZERO        )
                 OR  ((FLG-JGNGAK-CHECK     =  ZERO       ) AND
                      (WK-KEISAN   >=  ZAN-KOHI-T(KOH-IDX)) AND
                      (WK-KEISAN2  >=  ZAN-KOHI-T(KOH-IDX)))
                 OR  ((FLG-JGNGAK-CHECK     =  1          ) AND
                      (WK-KEISAN2  >=  ZAN-KOHI-T(KOH-IDX)))
                    IF  ZAN-KOHI-T3(KOH-IDX) > ZAN-KOHI-T(KOH-IDX)
                       MOVE    1    TO   FLG-JGNGAK-CHECK2
                    END-IF
                 END-IF
               ELSE
                 IF  ( ZAN-KOHI-T(KOH-IDX)  =  ZERO        )
                 OR  ((FLG-JGNGAK-CHECK     =  ZERO       ) AND
                      (WK-KEISAN   >=  ZAN-KOHI-T(KOH-IDX)))
                 OR  ((FLG-JGNGAK-CHECK     =  1          ) AND
                      (WK-ZENGAKU  >=  ZAN-KOHI-T(KOH-IDX)))
                    IF  ZAN-KOHI-T3(KOH-IDX) > ZAN-KOHI-T(KOH-IDX)
                       MOVE    1    TO   FLG-JGNGAK-CHECK2
                    END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF    FLG-JGNGAK-CHECK2  =  1
             IF     WK-2010-ZENKEI2KBN-G(KOH-IDX + 1) =  "1"
                  IF  (WK-TAIHI-GAIRAIFTN(KOH-IDX)     = ZERO)
                  AND (WK-TAIHI-NYUINFTN(KOH-IDX)      = ZERO)
                  AND (WK-TAIHI-TAINFTN(KOH-IDX)   NOT = ZERO)
                     MOVE     ZERO     TO   FLG-TAINFTN
                     MOVE     ZERO     TO   FLG-TAINFTN2
                     PERFORM  230581-JGNGAK-CHECK2-SEC
                     IF    FLG-TAINFTN  =  1
                     OR    FLG-TAINFTN2 =  ZERO
                         CONTINUE
                     ELSE
                         MOVE    9     TO   LNK-SYU-NYNSHOKAISU
                     END-IF
                  END-IF
             ELSE
               IF  (  MAX-KIN-KOHI2-D  NOT =  ZERO  )
               OR  (  MAX-KIN-KOHI2-M  NOT =  ZERO  )
               OR  (( MAX-KIN-KOHI2-D      =  ZERO ) AND
                    ( MAX-KIN-KOHI2-M      =  ZERO ) AND
                    ((MAX-KIN-KOHI2-K  NOT =  ZERO) OR
                     (TEI-KIN-KOHI2-K  NOT =  ZERO)))
                  IF  (WK-TAIHI-GAIRAIFTN(KOH-IDX)     = ZERO)
                  AND (WK-TAIHI-NYUINFTN(KOH-IDX)      = ZERO)
                  AND (WK-TAIHI-TAINFTN(KOH-IDX)   NOT = ZERO)
                     MOVE     ZERO     TO   FLG-TAINFTN
                     MOVE     ZERO     TO   FLG-TAINFTN2
                     PERFORM  230581-JGNGAK-CHECK2-SEC
                     IF    FLG-TAINFTN  =  1
                     OR    FLG-TAINFTN2 =  ZERO
                         CONTINUE
                     ELSE
                       IF  ( ZAN-KOHI-T(KOH-IDX)        = ZERO  )
                       AND ( ZAN-KOHI-T3(KOH-IDX)   NOT = ZERO  )
                       AND ((WK-TAIHI-GAIRAIDAY(1)  NOT = SPACE) AND
                            (WK-TAIHI-GAIRAIDAY2(1) NOT = SPACE) AND
                            (WK-TAIHI-GAIRAIDAY(1)  <=
                                         WK-TAIHI-GAIRAIDAY2(1)))
                         MOVE    9     TO   WK-NYNSHOKAISU
                       END-IF
                     END-IF
                  END-IF
               END-IF
             END-IF
           END-IF
      *
           .
       23058-JGNGAK-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *        他一部負担のチェック
      ******************************************************************
       230581-JGNGAK-CHECK2-SEC           SECTION.
      *
           INITIALIZE                        PTKOHFTNETC-REC
           MOVE  LNK-SYU-HOSPNUM         TO  PTKOHFTNETC-HOSPNUM
           MOVE  LNK-SYU-PTID            TO  PTKOHFTNETC-PTID
           MOVE  COMB-KOHID(KOH-IDX)     TO  PTKOHFTNETC-KOHID
           MOVE  LNK-SYU-SRYYMD(1:6)     TO  PTKOHFTNETC-SRYYMD(1:6)
           MOVE  "__"                    TO  PTKOHFTNETC-SRYYMD(7:2)
           MOVE  PTKOHFTNETC-REC         TO  MCPDATA-REC
           MOVE  "DBSELECT"              TO  MCP-FUNC
           MOVE  "tbl_ptkohftnetc"       TO  MCP-TABLE
           MOVE  "key2"                  TO  MCP-PATHNAME
           CALL  "ORCDBMAIN"             USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF     MCP-RC   =    ZERO
             MOVE    "tbl_ptkohftnetc"   TO  MCP-TABLE
             MOVE    "key2"              TO  MCP-PATHNAME
             PERFORM  PTKOHFTNETC-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHFTNETC  =  1
               IF   LNK-SYU-SRYYMD  <=  PTKOHFTNETC-SRYYMD
               AND  PTKOHFTNETC-FTNMONEY  NOT = ZERO
                 MOVE     1              TO  FLG-TAINFTN
               ELSE
                 IF   LNK-SYU-SRYYMD  >  PTKOHFTNETC-SRYYMD
                 AND  PTKOHFTNETC-FTNMONEY  NOT = ZERO
                   MOVE  PTKOHFTNETC-SRYYMD(7:2)
                                         TO  WK-TAIHI-GAIRAIDAY2(1)
                 END-IF
               END-IF
               MOVE       1              TO  FLG-TAINFTN2
      *
               MOVE    "tbl_ptkohftnetc" TO  MCP-TABLE
               MOVE    "key2"            TO  MCP-PATHNAME
               PERFORM  PTKOHFTNETC-READ-SEC
             END-PERFORM
           END-IF
           MOVE      "tbl_ptkohftnetc"   TO  MCP-TABLE
           MOVE      "key2"              TO  MCP-PATHNAME
           PERFORM    DB-CLOSE-SEC
      *
           .
       230581-JGNGAK-CHECK2-EXT.
           EXIT.
      *
      ******************************************************************
      *    公費一部負担金減額
      ******************************************************************
       230582-KOH-GENGAKU-HENSYU-SEC           SECTION.
      *
           EVALUATE  WK-GENGAKUKBN
             WHEN        1
               IF  WK-GENGAKUKBN-KEISAN  =  2
                 IF    WK-GENGAKU-RITU     =  ZERO
                 OR    FLG-GENGAKU-HENSYU  =   1
                     MOVE  WK-KEISAN
                                 TO  WK-GENGAKU-GAK
                     MOVE  WK-KEISAN-EN
                                 TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   IF  WK-GAIKFTNRATE2  <= WK-GENGAKU-RITU
                     MOVE  ZERO  TO  WK-GENGAKU-GAK
                     MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                   ELSE
                     COMPUTE  WK-FUTANWARI2   =
                              WK-GENGAKU-RITU / 100
                     COMPUTE  WK-GENGAKU-GAK2 =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     COMPUTE  WK-GENGAKU-GAK2-ENTANI =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     IF  WK-KEISAN
                                 > WK-GENGAKU-GAK2
                       COMPUTE WK-GENGAKU-GAK  =
                               WK-KEISAN       -
                               WK-GENGAKU-GAK2
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK
                     END-IF
                     IF  WK-KEISAN-EN
                                 > WK-GENGAKU-GAK2-ENTANI
                       COMPUTE WK-GENGAKU-GAK-ENTANI  =
                               WK-KEISAN-EN           -
                               WK-GENGAKU-GAK2-ENTANI
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                     END-IF
                   END-IF
                 END-IF
               ELSE
                 IF  WK-GENGAKU-RITU = 100
                   MOVE  ZERO  TO  WK-GENGAKU-GAK
                   MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   COMPUTE  WK-GENGAKU-RITUX =
                            100 - WK-GENGAKU-RITU
                   COMPUTE  WK-GENGAKU-GAK               =
                            WK-KEISAN                    *
                            WK-GENGAKU-RITUX             /
                            100
                   COMPUTE  WK-GENGAKU-GAK-ENTANI        =
                            WK-KEISAN-EN                 *
                            WK-GENGAKU-RITUX             /
                            100
                 END-IF
               END-IF
             WHEN        2
               IF  WK-KEISAN         < WK-GENGAKU-KIN2
                 MOVE   ZERO   TO   WK-GENGAKU-GAK
               ELSE
                 COMPUTE  WK-GENGAKU-GAK                =
                          WK-KEISAN                     -
                          WK-GENGAKU-KIN2
               END-IF
               IF  WK-KEISAN-EN      < WK-GENGAKU-KIN2-ENTANI
                 MOVE   ZERO   TO   WK-GENGAKU-GAK-ENTANI
               ELSE
                 COMPUTE  WK-GENGAKU-GAK-ENTANI         =
                          WK-KEISAN-EN                  -
                          WK-GENGAKU-KIN2-ENTANI
               END-IF
             WHEN        3
             WHEN        4
                 MOVE  ZERO  TO  WK-GENGAKU-GAK
                 MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
             WHEN        5
               IF  WK-KEISAN         < WK-GENGAKU-KIN2
                 MOVE  WK-KEISAN
                             TO   WK-GENGAKU-GAK
               ELSE
                 MOVE  WK-GENGAKU-KIN2
                             TO   WK-GENGAKU-GAK
               END-IF
               IF  WK-KEISAN-EN      < WK-GENGAKU-KIN2-ENTANI
                 MOVE  WK-KEISAN-EN
                             TO   WK-GENGAKU-GAK-ENTANI
               ELSE
                 MOVE  WK-GENGAKU-KIN2-ENTANI
                             TO   WK-GENGAKU-GAK-ENTANI
               END-IF
           END-EVALUATE
      *
           .
       230582-KOH-GENGAKU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    公費一部負担金減額
      ******************************************************************
       23059-KOH-GENGAKU-HENSYU-SEC           SECTION.
      *
           EVALUATE  WK-GENGAKUKBN
             WHEN        1
               IF  WK-GENGAKUKBN-KEISAN  =  2
                 IF    WK-GENGAKU-RITU     =  ZERO
                 OR    FLG-GENGAKU-HENSYU  =   1
                     MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                 TO  WK-GENGAKU-GAK
                     MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                 TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   IF  WK-GAIKFTNRATE2  <= WK-GENGAKU-RITU
                     MOVE  ZERO  TO  WK-GENGAKU-GAK
                     MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                   ELSE
                     COMPUTE  WK-FUTANWARI2   =
                              WK-GENGAKU-RITU / 100
                     COMPUTE  WK-GENGAKU-GAK2 =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     COMPUTE  WK-GENGAKU-GAK2-ENTANI =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                 > WK-GENGAKU-GAK2
                       COMPUTE WK-GENGAKU-GAK               =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                               WK-GENGAKU-GAK2
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK
                     END-IF
                     IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                 > WK-GENGAKU-GAK2-ENTANI
                       COMPUTE WK-GENGAKU-GAK-ENTANI               =
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                               WK-GENGAKU-GAK2-ENTANI
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                     END-IF
                   END-IF
                 END-IF
               ELSE
                 IF  WK-GENGAKU-RITU = 100
                   MOVE  ZERO  TO  WK-GENGAKU-GAK
                   MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   COMPUTE  WK-GENGAKU-RITUX =
                            100 - WK-GENGAKU-RITU
                   COMPUTE  WK-GENGAKU-GAK               =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX) *
                            WK-GENGAKU-RITUX             /
                            100
                   COMPUTE  WK-GENGAKU-GAK-ENTANI               =
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) *
                            WK-GENGAKU-RITUX                    /
                            100
                 END-IF
               END-IF
             WHEN        2
               IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     < WK-GENGAKU-KIN2
                 MOVE   ZERO   TO   WK-GENGAKU-GAK
               ELSE
                 COMPUTE  WK-GENGAKU-GAK                =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                          WK-GENGAKU-KIN2
               END-IF
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     < WK-GENGAKU-KIN2-ENTANI
                 MOVE   ZERO   TO   WK-GENGAKU-GAK-ENTANI
               ELSE
                 COMPUTE  WK-GENGAKU-GAK-ENTANI               =
                          LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                          WK-GENGAKU-KIN2-ENTANI
               END-IF
             WHEN        3
             WHEN        4
                 MOVE  ZERO  TO  WK-GENGAKU-GAK
                 MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
             WHEN        5
               IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     < WK-GENGAKU-KIN2
                 MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                             TO   WK-GENGAKU-GAK
               ELSE
                 MOVE  WK-GENGAKU-KIN2
                             TO   WK-GENGAKU-GAK
               END-IF
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     < WK-GENGAKU-KIN2-ENTANI
                 MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                             TO   WK-GENGAKU-GAK-ENTANI
               ELSE
                 MOVE  WK-GENGAKU-KIN2-ENTANI
                             TO   WK-GENGAKU-GAK-ENTANI
               END-IF
           END-EVALUATE
      *
           .
       23059-KOH-GENGAKU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費の患者負担金額計算（上限額なし）                  *
      ******************************************************************
       2306-KOH-KEISAN2-SEC           SECTION.
      *
      *    負担金額の計算
           IF  WK-GAIKFTNRATE     NOT =    ZERO
      *
               COMPUTE   WK-FUTANWARI  =
                              WK-GAIKFTNRATE  /  100
               IF    WK-KOH-FTNKBN   NOT =  SPACE
                 EVALUATE  WK-KOH-FTNKBN
                    WHEN  "1"
                      COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                      COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                    WHEN  "2"
                      MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                      MOVE    ZERO   TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                      MOVE    ZERO   TO   LNK-SYU-KYUFUGAI-SHOSHIN-TEN
                                          LNK-SYU-KYUFUGAI-SIDOU-TEN
                                          LNK-SYU-KYUFUGAI-OSIN1-TEN
                                          LNK-SYU-KYUFUGAI-OSIN2-TEN
                                          LNK-SYU-KYUFUGAI-OSIN3-TEN
                                          LNK-SYU-KYUFUGAI-GOKEI-TEN
                 END-EVALUATE
               ELSE
                 COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
                 COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
               END-IF
      *
               IF    LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0"
                 MOVE   ZERO   TO   WK-MIYAGI-COMPFTN
                 IF  LNK-SYU-KOH-HKNNUM(KOH-IDX)  = "010" OR "021"
      ***                                       OR  "015" OR "016"
                    MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                            TO  WK-MIYAGI-COMPFTN
                 END-IF
               END-IF
      *
               IF  ((LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0"  ) AND
                    (WK-DOTANDOKU(KOH-IDX)             =  ZERO ))
               OR  ( WK-TOKATUKAI(KOH-IDX)             =  1     )
               OR  ( WK-KOHJGNGET-TEKIYOFLG(KOH-IDX)   =  1     )
      *             減額
                    MOVE      999   TO     WK-GAIKFTNRATE2
                    MOVE      1     TO     FLG-GENGAKU-HENSYU
                    PERFORM   23059-KOH-GENGAKU-HENSYU-SEC
                    IF  WK-GENGAKUKBN  NOT =  ZERO
                        MOVE  WK-GENGAKU-GAK
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  WK-GENGAKU-GAK-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                    END-IF
                    IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "027"
                        MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)                 
                                            TO WK-TOKUTEI-COMPFTN3      
                    END-IF
               END-IF                                         
               IF  (( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                    ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                    ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                     (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016")))
               AND (  WK-GAIKFTNRATE         NOT  =  100            )
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN
                                        TO  LNK-SYU-SYUCOMPFTN
                   END-IF
                   IF    LNK-SYU-KOH-HKNNUM(1)    =    "027"
                     IF  WK-TOKUTEI-COMPFTN3  NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN3
                                        TO  LNK-SYU-KOH-COMPFTN(1)
                     END-IF
                   END-IF
               ELSE
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  /  10
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =  WK-FTN
                                                              *  10
               END-IF
               MOVE  WK-GAIYKZFTNKBN TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
           ELSE
      *
             IF  ((WK-1001-PREFNUM         =  43           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342") AND
                  (LNK-SYU-SRYYMD(1:6)    <= "200911"      ))
             OR  ( FLG-MIYAGI   NOT =  ZERO                 )
             OR  ((WK-1001-PREFNUM         =  01           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "121"         ) AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200604"      ) AND
                  (LNK-SYU-SRYYMD(1:6)    <= "200803"      ))
             OR  ((WK-1001-PREFNUM         =  01           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "221"         ) AND
                  (FLG-HOKKAIDO            =  1            ))
             OR  ((WK-1001-PREFNUM         =  13           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200710"      ) AND
                  (LNK-SYU-SRYYMD(1:6)    <= "200909"      ))
             OR  ((COMB-KOHHKNNUM(KOH-IDX) = "019"         ) AND
                  (WK-GAIKFTNRATE019   NOT =  ZERO         ))
      *
               IF (WK-1001-PREFNUM         =  43           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342") AND
                  (LNK-SYU-SRYYMD(1:6)    <= "200911"      )
                  MOVE  "1"  TO  FLG-KUMAMOTO
                  MOVE  "1"  TO  WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                  PERFORM   23061-KUMAMOTO-KOHI-SEC
               END-IF
               IF  FLG-MIYAGI   NOT =  ZERO
                  PERFORM   23062-MIYAGI-KOHI-SEC
               END-IF
               IF (WK-1001-PREFNUM         =  01           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "121"         ) AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200604"      ) AND
                  (LNK-SYU-SRYYMD(1:6)    <= "200803"      )
                  PERFORM   23063-HOKAIDO-KOHI-SEC
               END-IF
               IF (WK-1001-PREFNUM         =  01           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "221"         ) AND
                  (FLG-HOKKAIDO            =  1            )
                  MOVE   1    TO  WK-TAIHI-FTNGAKEN(KOH-IDX)
                  PERFORM   23063-HOKAIDO-KOHI2-SEC
               END-IF
               IF (WK-1001-PREFNUM         =  13           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200710"      ) AND
                  (LNK-SYU-SRYYMD(1:6)    <= "200909"      )
                  PERFORM   23064-TOKYO-KOHI-SEC
               END-IF
               IF (COMB-KOHHKNNUM(KOH-IDX) = "019"         ) AND
                  (WK-GAIKFTNRATE019   NOT =  ZERO         )
                  PERFORM   23067-GENBAKU-KOHI-SEC
               END-IF
      *
             ELSE
      *
               IF    WK-GAIKKOTGAK  NOT =  ZERO
      *
                 MOVE  WK-GAIKKOTGAK TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
      *
                 IF  ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          )
                 OR  ( HKN-RECEFTNDSPKBN           = "2"            )
                 OR  ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                      (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF  WK-TOKUTEI-COMPFTN  NOT =  ZERO
                     MOVE  WK-TOKUTEI-COMPFTN
                                          TO  LNK-SYU-SYUCOMPFTN
                   END-IF
                   IF  LNK-SYU-KOH-HKNNUM(1)   =  "027"
                     IF  WK-TOKUTEI-COMPFTN3  NOT =  ZERO
                       MOVE  WK-TOKUTEI-COMPFTN3
                                          TO  LNK-SYU-KOH-COMPFTN(1)
                     END-IF
                   END-IF
                 END-IF
      *
                 IF    LNK-SYU-SYUCOMPFTN   NOT =    ZERO
                   IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)  
                                       >  LNK-SYU-SYUCOMPFTN      
                      MOVE  LNK-SYU-SYUCOMPFTN
                                       TO LNK-SYU-KOH-COMPFTN(KOH-IDX)  
                   END-IF                     
                 END-IF
      *
                 IF    LNK-SYU-SYUCOMPFTN-ENTANI   NOT =    ZERO        
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)              
                                       >  LNK-SYU-SYUCOMPFTN-ENTANI     
                      MOVE  LNK-SYU-SYUCOMPFTN-ENTANI                   
                                TO LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  
                   END-IF                                               
                 END-IF                                                 
      *
                 MOVE  WK-GAIYKZFTNKBN TO LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
      *
               END-IF
      *
             END-IF
      *
           END-IF.
      *
           IF   (WK-GAIKFTNRATE           =   ZERO )
           AND  (COMB-KOHHKNNUM(KOH-IDX)  =   "970")
           AND  (HKN-RECEFTNDSPKBN        =   "2"  )
             IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
               MOVE  WK-TOKUTEI-COMPFTN  TO  LNK-SYU-SYUCOMPFTN
             END-IF
           END-IF.
      *
           IF    FLG-ICHIBU-JYOSEI  =   1
               IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            WK-KEISAN-JYOSEI              / 10
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            WK-KEISAN-JYOSEI              * 10
                  MOVE  WK-KEISAN-JYOSEI
                              TO  LNK-SYU-JYO-HKNFTNMONEY
                                  LNK-SYU-JYO-COMPFTN
                  MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               ELSE
                  MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                  LNK-SYU-JYO-COMPFTN
                  COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                           LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                           580
               END-IF
               IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                  MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                              TO  LNK-SYU-JYO-COMPFTN-ENTANI
                  MOVE  ZERO  TO
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                  MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                  COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                           580
               END-IF
           END-IF.
      *
           IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND (LNK-SYU-KOH1HKNNUM    NOT =   "027")
             IF    FLG-ICHIBU-JYOSEI  =  1
             AND   KOH-IDX            =  1
               IF  LNK-SYU-SYUCOMPFTN
                         >   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 COMPUTE  WK-KEISAN-JYOSEI             =
                          LNK-SYU-SYUCOMPFTN           +  5
                 COMPUTE  WK-KEISAN-JYOSEI             =
                          WK-KEISAN-JYOSEI             / 10
                 COMPUTE  WK-KEISAN-JYOSEI             =
                          WK-KEISAN-JYOSEI             * 10
                 COMPUTE  WK-KEISAN-JYOSEI2            =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                 COMPUTE  WK-KEISAN-JYOSEI2            =
                          WK-KEISAN-JYOSEI2            / 10
                 COMPUTE  WK-KEISAN-JYOSEI2            =
                          WK-KEISAN-JYOSEI2            * 10
                 COMPUTE  WK-KEISAN-JYOSEI3            =
                          WK-KEISAN-JYOSEI             -
                          WK-KEISAN-JYOSEI2
                 IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                   MOVE   WK-KEISAN-JYOSEI3
                             TO  LNK-SYU-JYO-HKNFTNMONEY
                                 LNK-SYU-JYO-COMPFTN
                 END-IF
               ELSE
                 MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                 LNK-SYU-JYO-COMPFTN
               END-IF
               IF  LNK-SYU-SYUCOMPFTN-ENTANI
                         >   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 COMPUTE  WK-KEISAN-JYOSEI-EN          =
                          LNK-SYU-SYUCOMPFTN-ENTANI    -
                          LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 IF  WK-KEISAN-JYOSEI-EN
                         <   LNK-SYU-JYO-COMPFTN-ENTANI
                   MOVE   WK-KEISAN-JYOSEI-EN
                             TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 END-IF
               ELSE
                 MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
               END-IF
             END-IF
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                 >  LNK-SYU-SYUCOMPFTN
               MOVE   LNK-SYU-SYUCOMPFTN  TO
                                LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                 >  LNK-SYU-SYUCOMPFTN-ENTANI
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
           END-IF.
      *
           PERFORM    23053-KOHHI-HIKAKU3-SEC.
           PERFORM    23051-KOHHI-HIKAKU-SEC.
      *
           IF    FLG-ICHIBU-JYOSEI  =   2
               IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            WK-KEISAN-JYOSEI              / 10
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            WK-KEISAN-JYOSEI              * 10
                  MOVE  WK-KEISAN-JYOSEI
                              TO  LNK-SYU-JYO-HKNFTNMONEY
                                  LNK-SYU-JYO-COMPFTN
                  MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               ELSE
                  MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                  LNK-SYU-JYO-COMPFTN
                  COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                           LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                           580
               END-IF
               IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                  MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                              TO  LNK-SYU-JYO-COMPFTN-ENTANI
                  MOVE  ZERO  TO
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                  MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                  COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                           580
               END-IF
           END-IF.
      *
           EVALUATE   WK-GAIYKZFTNKBN
               WHEN   "0"
                   MOVE  ZERO  TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
               WHEN   "1"
                   MOVE  YAKFTN-SOGOKEI
                               TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                   WK-KOH-YAKFTN-T(KOH-IDX)
               WHEN   "2"
                   MOVE  YAKFTN-SOGOKEI
                               TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
                                   WK-KOH-YAKFTN-T(KOH-IDX)
               WHEN   "3"
                   MOVE  YAKFTN-SOGOKEI
                               TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
           END-EVALUATE.
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX).
      *
       2306-KOH-KEISAN2-EXT.
           EXIT.
      *
      ******************************************************************
      *        熊本県地方公費（１／３）計算
      ******************************************************************
       23061-KUMAMOTO-KOHI-SEC           SECTION.
      *
      *    負担金額の計算
      *
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-SYUCOMPFTN            +  5
                  COMPUTE   WK-FTN  =  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    /  10
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =  WK-FTN
                                                          *  10
           ELSE
             IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-KOH-COMPFTN(1)        +  5
                  COMPUTE   WK-FTN  =  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    /  10
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =  WK-FTN
                                                          *  10
             ELSE
                  MOVE    ZERO    TO    LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)   NOT  =  ZERO
                  MOVE      LNK-SYU-KOH-COMPFTN(KOH-IDX)  TO  WK-FTN
      *
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            ( WK-FTN  /  3 ) + 0.9
      *
                  COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                            ( WK-FTN  /  3 )
           END-IF
      *
           MOVE  WK-GAIYKZFTNKBN TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
      *
           .
      *
       23061-KUMAMOTO-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        熊本県地方公費（１／３）計算
      ******************************************************************
       23061-KUMAMOTO-KOHI2-SEC           SECTION.
      *
           PERFORM    23061-KUMAMOTO-KOHI-SEC
      *
           IF  ((KOH-IDX           =   2) AND
                (WK-RUI-TAISYO     =   1))
           OR  ( FLG-KUMAMOTO-CYO  =   1 )
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                               > ZAN-KOHI-T3(KOH-IDX)
                MOVE  ZAN-KOHI-T3(KOH-IDX)
                      TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                               > ZAN-KOHI-T(KOH-IDX)
                MOVE  ZAN-KOHI-T(KOH-IDX)
                      TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF
      *
           PERFORM   23053-KOHHI-HIKAKU3-SEC
           PERFORM   23051-KOHHI-HIKAKU-SEC
           MOVE  ZERO  TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           .
      *
       23061-KUMAMOTO-KOHI2-EXT.
           EXIT.
      *
      ******************************************************************
      *        熊本県地方公費（１／３）計算
      ******************************************************************
       23061-KUMAMOTO-KOHI3-SEC           SECTION.
      *
      *    負担金額の計算
      *
           IF     LNK-SYU-SYUHKNNUM     NOT =   SPACE
             COMPUTE    WK-FUTANWARI =  WK-KOH-FTNRATE  /  100
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        WK-ZENGAKU   *  WK-FUTANWARI
             COMPUTE    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                        WK-ZENGAKU   *  WK-FUTANWARI
      *      減額
             MOVE       WK-KOH-FTNRATE   TO   WK-GAIKFTNRATE2
             MOVE       ZERO             TO   FLG-GENGAKU-HENSYU
             PERFORM    23059-KOH-GENGAKU-HENSYU-SEC
             IF  WK-GENGAKUKBN  NOT =  ZERO
                 MOVE   WK-GENGAKU-GAK
                         TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 MOVE   WK-GENGAKU-GAK-ENTANI
                         TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) +   5
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) /  10
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) *  10
      *
             MOVE       LNK-SYU-KOH-COMPFTN(KOH-IDX)  TO  WK-FTN
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        (WK-FTN  /  3) +  5
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) /  10
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) *  10
             COMPUTE    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                        (WK-FTN  /  3 )
      *
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T(KOH-IDX)
                 MOVE   ZAN-KOHI-T(KOH-IDX)
                              TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 MOVE   1     TO  WK-TAIHI-FTNGAKEN(KOH-IDX)
             END-IF
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                              >  ZAN-KOHI-T3(KOH-IDX)
                 MOVE   ZAN-KOHI-T3(KOH-IDX)
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
           ELSE
             MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
             MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           MOVE  WK-GAIYKZFTNKBN TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
      *
           PERFORM   23053-KOHHI-HIKAKU3-SEC
           PERFORM   23051-KOHHI-HIKAKU-SEC
           MOVE  ZERO  TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           .
      *
       23061-KUMAMOTO-KOHI3-EXT.
           EXIT.
      *
      ******************************************************************
      *        宮城県地方公費計算（乳幼児）
      ******************************************************************
       23062-MIYAGI-KOHI-SEC           SECTION.
      *
           IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND  (LNK-SYU-KOH1HKNNUM    NOT =   "027")
              EVALUATE    FLG-MIYAGI
                WHEN         1
                    IF   LNK-SYU-SRYYMD(1:6)   <=    "200603"
                       MOVE   0.25    TO     WK-KEISU
                    END-IF
                    IF ( LNK-SYU-SRYYMD(1:6)    >=   "200604" ) AND
                       ( LNK-SYU-SRYYMD(1:6)    <=   "200703" )
                       MOVE   0.50    TO     WK-KEISU
                    END-IF
                    IF ( LNK-SYU-SRYYMD(1:6)    >=   "200704" ) AND
                       ( LNK-SYU-SRYYMD(1:6)    <=   "200803" )
                       MOVE   0.75    TO     WK-KEISU
                    END-IF
                    IF   LNK-SYU-SRYYMD(1:6)    >=   "200804"
                       MOVE   1.00    TO     WK-KEISU
                    END-IF
                WHEN         2
                    MOVE      0.50    TO     WK-KEISU
              END-EVALUATE
              IF    WK-MIYAGI-COMPFTN  NOT =  9999999
              AND   WK-TOKUTEI-COMPFTN  >  WK-MIYAGI-COMPFTN
                COMPUTE   WK-JYOSEIGAKU       =
                          WK-MIYAGI-COMPFTN   *  WK-KEISU
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                          WK-MIYAGI-COMPFTN   -  WK-JYOSEIGAKU
                COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                          WK-MIYAGI-COMPFTN   -  WK-JYOSEIGAKU
              ELSE
                COMPUTE   WK-JYOSEIGAKU       =
                          WK-TOKUTEI-COMPFTN  *  WK-KEISU
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  -  WK-JYOSEIGAKU
                COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  -  WK-JYOSEIGAKU
              END-IF
           ELSE
              MOVE     ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
              MOVE     ZERO    TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           IF   HKN-RECEFTNDSPKBN   =   "2"
                MOVE   "1"   TO   WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                    MOVE  WK-TOKUTEI-COMPFTN
                                     TO  LNK-SYU-SYUCOMPFTN
                END-IF
           ELSE
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                COMPUTE   WK-FTN      =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) /  10
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =  WK-FTN
                                                       *  10
           END-IF
      *
           MOVE  WK-GAIYKZFTNKBN   TO   LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
      *
           .
      *
       23062-MIYAGI-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        北海道地方公費計算（精神通院補助）
      ******************************************************************
       23063-HOKAIDO-KOHI-SEC           SECTION.
      *
           IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
               IF    WK-SEISIN-COMPFTN  NOT =  9999999
               AND   WK-TOKUTEI-COMPFTN  >  WK-SEISIN-COMPFTN
                COMPUTE   WK-JYOSEIGAKU       =
                          WK-SEISIN-COMPFTN   *  0.5
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                          WK-SEISIN-COMPFTN   -  WK-JYOSEIGAKU
                COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                          WK-SEISIN-COMPFTN   -  WK-JYOSEIGAKU
               ELSE
                COMPUTE   WK-JYOSEIGAKU       =
                          WK-TOKUTEI-COMPFTN  *  0.5
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  -  WK-JYOSEIGAKU
                COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  -  WK-JYOSEIGAKU
               END-IF
           ELSE
             IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND   (LNK-SYU-KOH1HKNNUM        =   "027")
               IF    WK-SEISIN-COMPFTN  NOT =  9999999
               AND   WK-TOKUTEI-COMPFTN3 >  WK-SEISIN-COMPFTN
                COMPUTE   WK-JYOSEIGAKU       =
                          WK-SEISIN-COMPFTN   *  0.5
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                          WK-SEISIN-COMPFTN   -  WK-JYOSEIGAKU
                COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                          WK-SEISIN-COMPFTN   -  WK-JYOSEIGAKU
               ELSE
                COMPUTE   WK-JYOSEIGAKU       =
                          WK-TOKUTEI-COMPFTN3 *  0.5
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN3 -  WK-JYOSEIGAKU
                COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN3 -  WK-JYOSEIGAKU
               END-IF
             ELSE
               MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
           END-IF
      *
           IF   HKN-RECEFTNDSPKBN   =   "2"
                MOVE   "1"   TO   WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                    MOVE  WK-TOKUTEI-COMPFTN
                                     TO  LNK-SYU-SYUCOMPFTN
                END-IF
                IF    LNK-SYU-KOH-HKNNUM(1)    =    "027"
                  IF  WK-TOKUTEI-COMPFTN3  NOT =    ZERO
                    MOVE  WK-TOKUTEI-COMPFTN3
                                     TO  LNK-SYU-KOH-COMPFTN(1)
                  END-IF
                END-IF
           ELSE
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                COMPUTE   WK-FTN      =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) /  10
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =  WK-FTN
                                                       *  10
           END-IF
      *
           MOVE  WK-GAIYKZFTNKBN   TO   LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
      *
           .
      *
       23063-HOKAIDO-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        北海道地方公費計算（精神通院補助）
      ******************************************************************
       23063-HOKAIDO-KOHI2-SEC           SECTION.
      *
           COMPUTE     LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                      (WK-KOH-COMPFTN(KOH-IDX - 1) / 2) + 0.9
      *
           COMPUTE     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                       LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           MOVE  WK-GAIYKZFTNKBN   TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
           MOVE  ZERO              TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           .
      *
       23063-HOKAIDO-KOHI2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        東京都地方公費マル子計算
      ******************************************************************
       23064-TOKYO-KOHI-SEC           SECTION.
      *
           IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  *   2  /  3
                COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  *   2  /  3
           ELSE
                MOVE   ZERO  TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                MOVE   ZERO  TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
      ***  IF   HKN-RECEFTNDSPKBN   =   "2"
      ***       MOVE   "1"   TO   WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
      ***       IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
      ***           MOVE  WK-TOKUTEI-COMPFTN
      ***                    TO   LNK-SYU-SYUCOMPFTN
      ***       END-IF
      ***  ELSE
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                COMPUTE   WK-FTN      =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) /  10
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =  WK-FTN
                                                       *  10
      ***  END-IF
      *
           IF (FLG-GENBUTU70     NOT =   ZERO)
           OR (FLG-TOKU75-CYO        =    3  )
           OR (FLG-CYOKI-ARI         =    2  )
             IF    FLG-MARUKO  =  2
               COMPUTE WK-MARUKO-FTN = WK-MARUKO-FTN +  5
               COMPUTE WK-MARUKO-FTN = WK-MARUKO-FTN / 10
               COMPUTE WK-MARUKO-FTN = WK-MARUKO-FTN * 10
               IF  ZAN-SYU-M  <=  WK-MARUKO-FTN
                  MOVE   ZAN-SYU-M       TO  WK-MARUKO-XX
               ELSE
                  MOVE   WK-MARUKO-FTN   TO  WK-MARUKO-XX
               END-IF
      *
               COMPUTE WK-MARUKO-COMPFTN   = WK-MARUKO-XX * 2 / 3
               COMPUTE WK-MARUKO-COMPFTN-E = WK-MARUKO-XX * 2 / 3
      *
               COMPUTE WK-MARUKO-COMPFTN = WK-MARUKO-COMPFTN +  5
               COMPUTE WK-MARUKO-COMPFTN = WK-MARUKO-COMPFTN / 10
               COMPUTE WK-MARUKO-COMPFTN = WK-MARUKO-COMPFTN * 10
      *
               IF   WK-MARUKO-COMPFTN    >  WK-MARUKO-M
                  COMPUTE  WK-MARUKO-COMPFTN   =  WK-MARUKO-COMPFTN
                                               -  WK-MARUKO-M
               ELSE
                  MOVE   ZERO  TO   WK-MARUKO-COMPFTN
               END-IF
               IF   WK-MARUKO-COMPFTN-E  >  WK-MARUKO-ME
                  COMPUTE  WK-MARUKO-COMPFTN-E =  WK-MARUKO-COMPFTN-E
                                               -  WK-MARUKO-ME
               ELSE
                  MOVE   ZERO  TO   WK-MARUKO-COMPFTN-E
               END-IF
      *
               IF  WK-MARUKO-COMPFTN  <=  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  MOVE   WK-MARUKO-COMPFTN
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  MOVE   WK-MARUKO-COMPFTN-E
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
             END-IF
           END-IF
      *
           MOVE  WK-GAIYKZFTNKBN   TO   LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
      *
           .
      *
       23064-TOKYO-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（患者負担の１／３を助成する）
      ******************************************************************
       23065-JYOSEI-KOHI-SEC           SECTION.
      *
           IF   LNK-SYU-SYUHKNNUM   NOT =  SPACE
              MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                  TO  WK-JYOSEI-KOHIKIN-EN
           ELSE
              MOVE   WK-ZENGAKU   TO  WK-JYOSEI-KOHIKIN-EN
                                      WK-JYOSEI-KOHIKIN-ZENGAKU
           END-IF
           IF   KOH-IDX  >   1
              IF   WK-JYOSEI-KOHIKIN-EN
                             > LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX - 1)
                 MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX - 1)
                                  TO  WK-JYOSEI-KOHIKIN-EN
              END-IF
           END-IF
           COMPUTE WK-JYOSEI-KOHIKIN2 = WK-JYOSEI-KOHIKIN-EN + 0.9
      *
      *    診療済み分を合算して計算
           COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
                                         + WK-JYOSEI-KOHIKIN-RUI
      *
           COMPUTE  WK-JYOSEI-KOHIKIN                   =
                   (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.5
           COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                    WK-JYOSEI-KOHIKIN-KEI               -
                    WK-JYOSEI-KOHIKIN
      *
      *    診療済み分を差し引く
           IF     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                          > WK-JYOSEI-KOHIKIN-RUI2
              COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                       LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                       WK-JYOSEI-KOHIKIN-RUI2
           ELSE
              MOVE   ZERO   TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                          > ZAN-KOHI-T3(KOH-IDX)
              MOVE   ZAN-KOHI-T3(KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
      *****
      *
           IF    HKN-RECEFTNDSPKBN      =  "2"
      *
             MOVE     "1"    TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
      *
      *      診療済み分を合算して計算
             COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
                                           + WK-JYOSEI-KOHIKIN-RUI
      *
             COMPUTE  WK-JYOSEI-KOHIKIN                   =
                     (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.5
             COMPUTE  WK-KOH-COMPFTN(KOH-IDX)             =
                      WK-JYOSEI-KOHIKIN-KEI               -
                      WK-JYOSEI-KOHIKIN
      *
      *      診療済み分を差し引く
             IF     WK-KOH-COMPFTN(KOH-IDX) > WK-JYOSEI-KOHIKIN-RUI2
                COMPUTE  WK-KOH-COMPFTN(KOH-IDX)          =
                         WK-KOH-COMPFTN(KOH-IDX)          -
                         WK-JYOSEI-KOHIKIN-RUI2
             ELSE
                MOVE   ZERO   TO   WK-KOH-COMPFTN(KOH-IDX)
             END-IF
      *
             IF     WK-KOH-COMPFTN(KOH-IDX) > ZAN-KOHI-T2(KOH-IDX)
                MOVE   ZAN-KOHI-T2(KOH-IDX)
                              TO   WK-KOH-COMPFTN(KOH-IDX)
             END-IF
      *
           END-IF
      *
      *****
      *
      *    診療済み分を合算して計算
      **>  COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
      **>                                + WK-JYOSEI-KOHIKIN-RUI
           COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
      *
           COMPUTE  WK-JYOSEI-KOHIKIN                   =
                   (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.5
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    WK-JYOSEI-KOHIKIN-KEI               -
                    WK-JYOSEI-KOHIKIN
      *
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        +  5
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        / 10
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        * 10
      *
      *    診療済み分を差し引く
      **>  IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      **>                                 > WK-JYOSEI-KOHIKIN-RUI3
      **>     COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)     =
      **>              LNK-SYU-KOH-COMPFTN(KOH-IDX)     -
      **>              WK-JYOSEI-KOHIKIN-RUI3
      **>  ELSE
      **>     MOVE   ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
      **>  END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                          > ZAN-KOHI-T(KOH-IDX)
              MOVE   ZAN-KOHI-T(KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
      *****
      *
           MOVE  WK-GAIYKZFTNKBN   TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
           MOVE  ZERO              TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           .
      *
       23065-JYOSEI-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（患者負担の２／３を助成する）
      ******************************************************************
       23066-JYOSEI-KOHI2-SEC           SECTION.
      *
           IF   LNK-SYU-SYUHKNNUM   NOT =  SPACE
              MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                  TO  WK-JYOSEI-KOHIKIN-EN
           ELSE
              MOVE   WK-ZENGAKU   TO  WK-JYOSEI-KOHIKIN-EN
                                      WK-JYOSEI-KOHIKIN-ZENGAKU
           END-IF
           IF   KOH-IDX  >   1
              IF   WK-JYOSEI-KOHIKIN-EN
                             > LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX - 1)
                 MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX - 1)
                                  TO  WK-JYOSEI-KOHIKIN-EN
              END-IF
           END-IF
           COMPUTE WK-JYOSEI-KOHIKIN2 = WK-JYOSEI-KOHIKIN-EN + 0.9
      *
      *    診療済み分を合算して計算
           COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
                                         + WK-JYOSEI-KOHIKIN-RUI
      *
           COMPUTE  WK-JYOSEI-KOHIKIN                   =
                   (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.9
           COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                    WK-JYOSEI-KOHIKIN
      *
      *    診療済み分を差し引く
           IF     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                          > WK-JYOSEI-KOHIKIN-RUI2
              COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                       LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                       WK-JYOSEI-KOHIKIN-RUI2
           ELSE
              MOVE   ZERO   TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                          > ZAN-KOHI-T3(KOH-IDX)
              MOVE   ZAN-KOHI-T3(KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
      *****
      *
           IF    HKN-RECEFTNDSPKBN      =  "2"
      *
             MOVE     "1"    TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
      *
      *      診療済み分を合算して計算
             COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
                                           + WK-JYOSEI-KOHIKIN-RUI
      *
             COMPUTE  WK-JYOSEI-KOHIKIN                   =
                     (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.9
             COMPUTE  WK-KOH-COMPFTN(KOH-IDX)             =
                      WK-JYOSEI-KOHIKIN
      *
      *      診療済み分を差し引く
             IF     WK-KOH-COMPFTN(KOH-IDX) > WK-JYOSEI-KOHIKIN-RUI2
                COMPUTE  WK-KOH-COMPFTN(KOH-IDX)          =
                         WK-KOH-COMPFTN(KOH-IDX)          -
                         WK-JYOSEI-KOHIKIN-RUI2
             ELSE
                MOVE   ZERO   TO   WK-KOH-COMPFTN(KOH-IDX)
             END-IF
      *
             IF     WK-KOH-COMPFTN(KOH-IDX) > ZAN-KOHI-T2(KOH-IDX)
                MOVE   ZAN-KOHI-T2(KOH-IDX)
                              TO   WK-KOH-COMPFTN(KOH-IDX)
             END-IF
      *
           END-IF
      *
      *****
      *
      *    診療済み分を合算して計算
      **>  COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
      **>                                + WK-JYOSEI-KOHIKIN-RUI
           COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
      *
           COMPUTE  WK-JYOSEI-KOHIKIN                   =
                   (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.9
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    WK-JYOSEI-KOHIKIN
      *
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        +  5
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        / 10
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        * 10
      *
      *    診療済み分を差し引く
      **>  IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      **>                                 > WK-JYOSEI-KOHIKIN-RUI3
      **>     COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)     =
      **>              LNK-SYU-KOH-COMPFTN(KOH-IDX)     -
      **>              WK-JYOSEI-KOHIKIN-RUI3
      **>  ELSE
      **>     MOVE   ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
      **>  END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                          > ZAN-KOHI-T(KOH-IDX)
              MOVE   ZAN-KOHI-T(KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
      *****
      *
           MOVE  WK-GAIYKZFTNKBN   TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
           MOVE  ZERO              TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           .
      *
       23066-JYOSEI-KOHI2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        １９原爆一般の特殊計算
      ******************************************************************
       23067-GENBAKU-KOHI-SEC           SECTION.
      *
           COMPUTE   WK-FUTANWARI  =  WK-GAIKFTNRATE019  /  100
           COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                     WK-ZENGAKU  *  WK-FUTANWARI
           COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                     WK-ZENGAKU  *  WK-FUTANWARI
      *
           COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
           COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)  /  10
           COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)  *  10
      *
           MOVE  WK-GAIYKZFTNKBN  TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
      *
           .
      *
       23067-GENBAKU-KOHI-EXT.
           EXIT.
      *
      ******************************************************************
      *        特殊計算（患者負担の２／３を助成する）
      ******************************************************************
       23068-JYOSEI-KOHI3-SEC           SECTION.
      *
           COMPUTE    WK-WAKAYAMA-KEISAN   =
                      WK-TOKUTEI-COMPFTN   *   2  /  3
      *
           COMPUTE    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                      WK-TOKUTEI-COMPFTN                  -
                      WK-WAKAYAMA-KEISAN
      *
           PERFORM    23053-KOHHI-HIKAKU3-SEC
      *
           IF  HKN-RECEFTNDSPKBN  =  "2"
      *
             COMPUTE  WK-WAKAYAMA-KEISAN   =
                      WK-TOKUTEI-COMPFTN   *   2  /  3
      *
             COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                      WK-TOKUTEI-COMPFTN      -
                      WK-WAKAYAMA-KEISAN
      *
             PERFORM  23052-KOHHI-HIKAKU2-SEC
      *
           END-IF
      *
           COMPUTE    WK-WAKAYAMA-KEISAN   =
                      WK-TOKUTEI-COMPFTN   *   2  /  3
      *
           COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                      WK-TOKUTEI-COMPFTN           -
                      WK-WAKAYAMA-KEISAN
      *
           PERFORM    23051-KOHHI-HIKAKU-SEC
      *
           MOVE  WK-GAIYKZFTNKBN   TO  LNK-SYU-KOH-YKZFTNKBN(KOH-IDX)
           MOVE  ZERO              TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           COMPUTE    LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                      LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                      LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           .
      *
       23068-JYOSEI-KOHI3-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        累計ベース計算時用
      ******************************************************************
       2306A-RUIKEIYO-HENSYU-SEC           SECTION.
      *
           IF    LNK-SYU-SYUHKNNUM     NOT =   SPACE
             IF  WK-RUI-FTN2-M3-XXX  >=  WK-RUI-COMPFTN-ENTANI
               MOVE     ZERO         TO  WK-ZAN-FTN2-M3-XXX
             ELSE
               COMPUTE  WK-ZAN-FTN2-M3-XXX
                                      =  WK-RUI-COMPFTN-ENTANI -
                                         WK-RUI-FTN2-M3-XXX
             END-IF
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                    > WK-ZAN-FTN2-M3-XXX
               MOVE  WK-ZAN-FTN2-M3-XXX
                           TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    > ZAN-KOHI-T(KOH-IDX)
               MOVE  ZAN-KOHI-T(KOH-IDX)
                           TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF
      *
           PERFORM   23053-KOHHI-HIKAKU3-SEC
           PERFORM   23051-KOHHI-HIKAKU-SEC
      *
           MOVE  ZERO              TO  LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)     +
                     LNK-SYU-KOH-COMPYKZFTN(KOH-IDX)
      *
           .
      *
       2306A-RUIKEIYO-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費単位で計算した患者負担金から最小の値を選択セット
      ******************************************************************
       2307-FTNKIN-HIKAKU-SEC         SECTION.
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE
               IF   LNK-SYU-KOH1HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH1COMPFTN-ENTANI  
                                 >   LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH1HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                TO  LNK-SYU-KOH1COMPFTN-ENTANI
                 END-IF
               END-IF
               IF   LNK-SYU-KOH2HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH2COMPFTN-ENTANI
                                 >   LNK-SYU-SYUCOMPFTN-ENTANI
                 IF ((LNK-SYU-SRYYMD(1:6)   >= "200804"      ) AND
                     (LNK-SYU-KOH2HKNNUM     = "972" OR "974"))
                 OR ((WK-RUI-TAISYO         =  1   ) AND
                     (WK-2010-KINJYOKBN-G(1)
                                            = "1"  ) AND
                     (FLG-MARUTOARI         =  1   ))
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                TO  LNK-SYU-KOH2COMPFTN-ENTANI
                 END-IF
               END-IF
               IF   LNK-SYU-KOH3HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH3COMPFTN-ENTANI
                                 >   LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH3HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                TO  LNK-SYU-KOH3COMPFTN-ENTANI
                 END-IF
               END-IF
               IF   LNK-SYU-KOH4HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH4COMPFTN-ENTANI
                                 >   LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH4HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                TO  LNK-SYU-KOH4COMPFTN-ENTANI
                 END-IF
               END-IF
           END-IF.
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE
               IF   LNK-SYU-KOH1HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH1COMPFTN      >   LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH1HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN TO  LNK-SYU-KOH1COMPFTN
                   COMPUTE   LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN     +
                             LNK-SYU-KOH1COMPYKZFTN
                   IF    WK-KOH-COMPFTN(1)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO   WK-KOH-COMPFTN(1)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH2HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH2COMPFTN      >   LNK-SYU-SYUCOMPFTN
                 IF ((LNK-SYU-SRYYMD(1:6)   >= "200804"      ) AND
                     (LNK-SYU-KOH2HKNNUM     = "972" OR "974"))
                 OR ((WK-RUI-TAISYO         =  1   ) AND
                     (WK-2010-KINJYOKBN-G(1)
                                            = "1"  ) AND
                     (FLG-MARUTOARI         =  1   ))
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN TO  LNK-SYU-KOH2COMPFTN
                   COMPUTE   LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN     +
                             LNK-SYU-KOH2COMPYKZFTN
                   IF    WK-KOH-COMPFTN(2)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO   WK-KOH-COMPFTN(2)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH3HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH3COMPFTN      >   LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH3HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN TO  LNK-SYU-KOH3COMPFTN
                   COMPUTE   LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN     +
                             LNK-SYU-KOH3COMPYKZFTN
                   IF    WK-KOH-COMPFTN(3)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO   WK-KOH-COMPFTN(3)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH4HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH4COMPFTN      >   LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH4HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN TO  LNK-SYU-KOH4COMPFTN
                   COMPUTE   LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN     +
                             LNK-SYU-KOH4COMPYKZFTN
                   IF    WK-KOH-COMPFTN(4)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO   WK-KOH-COMPFTN(4)
                   END-IF
                 END-IF
               END-IF
           END-IF.
      *
           IF    WK-RUI-TAISYO  =  1
             IF (COMB-KOH1HKNNUM   = "972" OR "974")
             OR (COMB-KOH2HKNNUM   = "972" OR "974")
             OR (COMB-KOH3HKNNUM   = "972" OR "974")
             OR (COMB-KOH4HKNNUM   = "972" OR "974")
                 PERFORM   23071X-FTNKIN-HIKAKU-CYOKI-SEC
             ELSE
                 PERFORM   23072X-FTNKIN-HIKAKU-TUJYO-SEC
             END-IF
           ELSE
             IF   (COMB-KOH1HKNNUM   = "972" OR "974")
             OR   (COMB-KOH2HKNNUM   = "972" OR "974")
             OR   (COMB-KOH3HKNNUM   = "972" OR "974")
             OR   (COMB-KOH4HKNNUM   = "972" OR "974")
                 PERFORM   23071-FTNKIN-HIKAKU-CYOKI-SEC
             ELSE
                 PERFORM   23072-FTNKIN-HIKAKU-TUJYO-SEC
             END-IF
           END-IF.
      *
           IF   (LNK-SYU-SRYYMD(1:6)   >= "200604")
           AND  (COMB-KOH1HKNNUM  = "021"         )
           AND  (FLG-SEISINJYO    =   1           )
              MOVE     ZERO     TO    WK-KNJFTNKIN
              MOVE     ZERO     TO    WK-KNJFTNKIN-ENTANI
           END-IF.
      *
      *    収納テーブルの請求額をセット
           MOVE    WK-KNJFTNKIN             TO  LNK-SYU-SKYMONEY.
      *
      *    大分県乳幼児特殊計算
      *    宮城県乳幼児特殊計算
      *    群馬県地方公費特殊計算
           PERFORM   23074-OITA-TOKUSYU-KEISAN-SEC.
      *
      *    収納テーブルの公費毎の患者負担金額をセットする
           IF    COMB-KOH1HKNNUM         NOT = SPACE
            IF    COMB-KOH1-GAIJGNKBN     =     "1"
             IF  ((LNK-S01-KOUREI-ZAITAKU-KBN   =       "1" ) OR
                  (FLG-KOUREI-KBN               =       "1" ))
             AND ( COMB-KOH1HKNNUM              =       "027")
                  CONTINUE
             ELSE
               IF  (( FLG-KOUGAKUCYO2    NOT =    ZERO  ) AND
                    ( FLG-IRYOHI2        NOT =    ZERO  ))
               OR  (( FLG-KOUGAKUCYO3    NOT =    ZERO  ) AND
                    ( FLG-IRYOHIKG2  =   1 OR 2 OR 3    ) AND
                    ( FLG-SYOUKAN(1)         =    "1"   ))
               OR  (  FLG-KOUGAKUCYO-JIRITU
                                         NOT =    ZERO   )
               OR  (  FLG-KOUGAKUCYO-GEN70K
                                         NOT =    ZERO   )
               OR  (( FLG-KOUGAKUCYO-GEN70
                                         NOT =    ZERO  ) AND
                    ( FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10  ) AND
                    ( FLG-SYOUKAN(1)         =    "1"   ))
               OR  (  WK-TAIHI-FTNGAKEN(1)   =     1     )
                    MOVE     LNK-SYU-KOH1COMPFTN  TO
                                          LNK-SYU-KOH1HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =                  
                                    LNK-SYU-KOH1COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =                  
                                    LNK-SYU-KOH1HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =                  
                                    LNK-SYU-KOH1HKNFTNMONEY *  10        
               END-IF
               IF     LNK-SYU-KOH1YKZFTNKBN   =    "2"
                      COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =
                               LNK-SYU-KOH1HKNFTNMONEY  +
                               LNK-SYU-KOH1COMPYKZFTN
               END-IF
             END-IF
            ELSE
             IF ((WK-1001-PREFNUM       =  43           ) AND
                 (COMB-KOH1HKNNUM       = "143" OR "342") AND
                 (LNK-SYU-SRYYMD(1:6)  <= "200911"      ))
             OR ((COMB-KOH1HKNNUM       = "970"         ) AND
                 (WK-1001-DAISANKBN     = "2"           ))
             OR ((FLG-KOUGAKUCYO-GEN70  NOT =  ZERO     ) AND
                 (COMB-KOH1HKNNUM       = "970"         ) AND
                 (WK-1001-DAISANKBN     = "1"           ))
             OR ((FLG-KOUGAKUCYO        NOT =  ZERO     ) AND
                 (COMB-KOH1HKNNUM       = "970"         ) AND
                 (WK-1001-DAISANKBN     = "1"           ))
             OR ( WK-TAIHI-FTNGAKEN(1)  =  1             )
             OR ((FLG-KOUGAKUCYO3       NOT =  ZERO     ) AND
                 (FLG-IRYOHIKG2   =   1 OR 2 OR 3       ) AND
                 (FLG-SYOUKAN(1)        = "1"           ))
             OR ((FLG-KOUGAKUCYO-GEN70  NOT =  ZERO     ) AND
                 (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10      ) AND
                 (FLG-SYOUKAN(1)        = "1"           ) AND
                 (LNK-SYU-SRYYMD(1:6)  >= "201708"      ))
               MOVE     LNK-SYU-KOH1COMPFTN  TO
                               LNK-SYU-KOH1HKNFTNMONEY
             ELSE
               COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =
                               LNK-SYU-KOH1COMPFTN     +   5
               COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =
                               LNK-SYU-KOH1HKNFTNMONEY /  10
               COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =
                               LNK-SYU-KOH1HKNFTNMONEY *  10
             END-IF
             IF     LNK-SYU-KOH1YKZFTNKBN   =    "2"
               COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =
                        LNK-SYU-KOH1HKNFTNMONEY  +
                        LNK-SYU-KOH1COMPYKZFTN
             END-IF
            END-IF
           END-IF.
           IF    COMB-KOH2HKNNUM         NOT = SPACE
            IF    COMB-KOH2-GAIJGNKBN     =     "1"
               IF  (  WK-TAIHI-FTNGAKEN(2)   =     1     )
               OR  (( WK-RUI-TAISYO          =     1    ) AND
                    ( FLG-KUMAMOTO           =    "1"   ))
               OR  (( FLG-KOUGAKUCYO-GEN70
                                         NOT =    ZERO  ) AND
                    ( FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12 ) AND
                    ( FLG-KOUGAKUCYO-GEN70K
                                         NOT =    ZERO  ) AND
                    ( FLG-SYOUKAN(2)         =    "1"   ))
                    MOVE     LNK-SYU-KOH2COMPFTN  TO
                                          LNK-SYU-KOH2HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =                  
                                    LNK-SYU-KOH2COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =                  
                                    LNK-SYU-KOH2HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =                  
                                    LNK-SYU-KOH2HKNFTNMONEY *  10        
               END-IF
               IF     LNK-SYU-KOH2YKZFTNKBN   =    "2"
                      COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =
                               LNK-SYU-KOH2HKNFTNMONEY  +
                               LNK-SYU-KOH2COMPYKZFTN
               END-IF
            ELSE
             IF ((WK-1001-PREFNUM       =  43           ) OR
                 (COMB-KOH2HKNNUM       = "143" OR "342") OR
                 (LNK-SYU-SRYYMD(1:6)  <= "200911"      ))
             OR ( WK-TAIHI-FTNGAKEN(2)  =  1             )
             OR ((FLG-KOUGAKUCYO-GEN70  NOT =    ZERO   ) AND
                 (FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12     ) AND
                 (FLG-KOUGAKUCYO-GEN70K NOT =    ZERO   ) AND
                 (FLG-SYOUKAN(2)        = "1"           ) AND
                 (LNK-SYU-SRYYMD(1:6)  >= "201708"      ))
               MOVE     LNK-SYU-KOH2COMPFTN  TO
                               LNK-SYU-KOH2HKNFTNMONEY
             ELSE
               COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =
                               LNK-SYU-KOH2COMPFTN     +   5
               COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =
                               LNK-SYU-KOH2HKNFTNMONEY /  10
               COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =
                               LNK-SYU-KOH2HKNFTNMONEY *  10
             END-IF
             IF     LNK-SYU-KOH2YKZFTNKBN   =    "2"
               COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =
                        LNK-SYU-KOH2HKNFTNMONEY  +
                        LNK-SYU-KOH2COMPYKZFTN
             END-IF
            END-IF
           END-IF.
           IF    COMB-KOH3HKNNUM         NOT = SPACE
            IF    COMB-KOH3-GAIJGNKBN     =     "1"
               IF  (WK-TAIHI-FTNGAKEN(3) = 1)
                    MOVE     LNK-SYU-KOH3COMPFTN  TO
                                          LNK-SYU-KOH3HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =                  
                                    LNK-SYU-KOH3COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =                  
                                    LNK-SYU-KOH3HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =                  
                                    LNK-SYU-KOH3HKNFTNMONEY *  10        
               END-IF
               IF     LNK-SYU-KOH3YKZFTNKBN   =    "2"
                      COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =
                               LNK-SYU-KOH3HKNFTNMONEY  +
                               LNK-SYU-KOH3COMPYKZFTN
               END-IF
            ELSE
             IF ((WK-1001-PREFNUM       =  43           ) OR
                 (COMB-KOH3HKNNUM       = "143" OR "342") OR
                 (LNK-SYU-SRYYMD(1:6)  <= "200911"      ))
             OR ( WK-TAIHI-FTNGAKEN(3)  =  1             )
               MOVE     LNK-SYU-KOH3COMPFTN  TO
                               LNK-SYU-KOH3HKNFTNMONEY
             ELSE
               COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =
                               LNK-SYU-KOH3COMPFTN     +   5
               COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =
                               LNK-SYU-KOH3HKNFTNMONEY /  10
               COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =
                               LNK-SYU-KOH3HKNFTNMONEY *  10
             END-IF
             IF     LNK-SYU-KOH3YKZFTNKBN   =    "2"
               COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =
                        LNK-SYU-KOH3HKNFTNMONEY  +
                        LNK-SYU-KOH3COMPYKZFTN
             END-IF
            END-IF
           END-IF.
           IF    COMB-KOH4HKNNUM         NOT = SPACE
            IF    COMB-KOH4-GAIJGNKBN     =     "1"
               IF  (WK-TAIHI-FTNGAKEN(4) = 1)
                    MOVE     LNK-SYU-KOH4COMPFTN  TO
                                          LNK-SYU-KOH4HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =                  
                                    LNK-SYU-KOH4COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =                  
                                    LNK-SYU-KOH4HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =                  
                                    LNK-SYU-KOH4HKNFTNMONEY *  10        
               END-IF
               IF     LNK-SYU-KOH4YKZFTNKBN   =    "2"
                      COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =
                               LNK-SYU-KOH4HKNFTNMONEY  +
                               LNK-SYU-KOH4COMPYKZFTN
               END-IF
            ELSE
             IF ((WK-1001-PREFNUM       =  43           ) OR
                 (COMB-KOH4HKNNUM       = "143" OR "342") OR
                 (LNK-SYU-SRYYMD(1:6)  <= "200911"      ))
             OR ( WK-TAIHI-FTNGAKEN(4)  =  1             )
               MOVE     LNK-SYU-KOH4COMPFTN  TO
                               LNK-SYU-KOH4HKNFTNMONEY
             ELSE
               COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =
                               LNK-SYU-KOH4COMPFTN     +   5
               COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =
                               LNK-SYU-KOH4HKNFTNMONEY /  10
               COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =
                               LNK-SYU-KOH4HKNFTNMONEY *  10
             END-IF
             IF     LNK-SYU-KOH4YKZFTNKBN   =    "2"
               COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =
                        LNK-SYU-KOH4HKNFTNMONEY  +
                        LNK-SYU-KOH4COMPYKZFTN
             END-IF
            END-IF
           END-IF.
      *
      *    レセ記載金額退避用エリアから収納項目へ編集
      *
           IF    COMB-KOH1HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(1)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(1) = SPACE
                AND  COMB-KOH1HKNNUM       NOT = "027"
                  IF  (( FLG-KOUGAKUCYO2    NOT =    ZERO  ) AND
                       ( FLG-IRYOHI2        NOT =    ZERO  ))
                  OR  (( FLG-KOUGAKUCYO3    NOT =    ZERO  ) AND
                       ( FLG-IRYOHIKG2  =   1 OR 2 OR 3    ) AND
                       ( FLG-SYOUKAN(1)         =    "1"   ))
                  OR  (  FLG-KOUGAKUCYO-JIRITU
                                            NOT =    ZERO   )
                  OR  (  FLG-KOUGAKUCYO-GEN70K
                                            NOT =    ZERO   )
                  OR  (( FLG-KOUGAKUCYO-GEN70
                                            NOT =    ZERO  ) AND
                       ( FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10  ) AND
                       ( FLG-SYOUKAN(1)         =    "1"   ))
                  OR  (( FLG-KOUGAKUCYO-GEN70  NOT = ZERO  ) AND
                       ( COMB-KOH1HKNNUM       = "970"     ) AND
                       ( WK-1001-DAISANKBN     = "1"       ))
                  OR  (( FLG-KOUGAKUCYO        NOT = ZERO  ) AND
                       ( COMB-KOH1HKNNUM       = "970"     ) AND
                       ( WK-1001-DAISANKBN     = "1"       ))
                  OR  (  WK-TAIHI-FTNGAKEN(1)  =  1         )
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN     +
                             LNK-SYU-KOH1COMPYKZFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(1)  TO   LNK-SYU-KOH1COMPFTN       
                COMPUTE   LNK-SYU-KOH1COMPTOTAL   =
                          LNK-SYU-KOH1COMPFTN     +
                          LNK-SYU-KOH1COMPYKZFTN
             END-IF
           END-IF.                                                      
      *
           IF    COMB-KOH2HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(2)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(2) = SPACE
                  IF  (( FLG-KOUGAKUCYO-GEN70
                                            NOT =    ZERO  ) AND
                       ( FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12 ) AND
                       ( FLG-KOUGAKUCYO-GEN70K
                                            NOT =    ZERO  ) AND
                       ( FLG-SYOUKAN(2)         =    "1"   ))
                  OR  (  WK-TAIHI-FTNGAKEN(2)   =     1     )
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN     +
                             LNK-SYU-KOH2COMPYKZFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(2)  TO   LNK-SYU-KOH2COMPFTN       
                COMPUTE   LNK-SYU-KOH2COMPTOTAL   =
                          LNK-SYU-KOH2COMPFTN     +
                          LNK-SYU-KOH2COMPYKZFTN
             END-IF
           END-IF.                                                      
      *
           IF    COMB-KOH3HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(3)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(3) = SPACE
                  IF (WK-TAIHI-FTNGAKEN(3) = 1)
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN     +
                             LNK-SYU-KOH3COMPYKZFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(3)  TO   LNK-SYU-KOH3COMPFTN       
                COMPUTE   LNK-SYU-KOH3COMPTOTAL   =
                          LNK-SYU-KOH3COMPFTN     +
                          LNK-SYU-KOH3COMPYKZFTN
             END-IF
           END-IF.                                                      
      *
           IF    COMB-KOH4HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(4)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(4) = SPACE
                  IF (WK-TAIHI-FTNGAKEN(4) = 1)
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN     +
                             LNK-SYU-KOH4COMPYKZFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(4)  TO   LNK-SYU-KOH4COMPFTN       
                COMPUTE   LNK-SYU-KOH4COMPTOTAL   =
                          LNK-SYU-KOH4COMPFTN     +
                          LNK-SYU-KOH4COMPYKZFTN
             END-IF
           END-IF.                                                      
      *
      *    特殊計算用金額退避編集
           PERFORM   23073-TOKUSYU-HENSYU-SEC.
      *
      *    主保険・老人保険の金額置き換え
           IF   COMB-HKNNUM            NOT =   SPACE
           AND  LNK-SYU-SYUCOMPFTN     NOT =    ZERO
           AND  FLG-KOUGAKUCYO         NOT =     1
           AND  FLG-KOUGAKUCYO3        NOT =     1
           AND  FLG-KOUGAKUCYO-ININ    NOT =     1
           AND  COMB-SYU-HKNKOHSBTKBN  NOT =    "8"
           AND  FLG-KOUGAKUCYO-GEN70   NOT =     1
           AND  COMB-SYU-HKNKOHSBTKBN  NOT =    "9"
      *
             IF  (COMB-KOH1HKNNUM       = "970")
             AND (WK-1001-DAISANKBN     = "2"  )
                 CONTINUE
             ELSE
                 COMPUTE   LNK-SYU-SYUCOMPFTN  =
                           LNK-SYU-SYUCOMPFTN  +  5
                 COMPUTE   WK-FTN      =
                           LNK-SYU-SYUCOMPFTN  / 10
                 COMPUTE   LNK-SYU-SYUCOMPFTN  =
                           WK-FTN   *  10
                 COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                           LNK-SYU-SYUCOMPFTN     +
                           LNK-SYU-SYUCOMPYKZFTN
             END-IF
      *
           END-IF.
      *
           IF   COMB-KOH1HKNNUM            =   "027"
           AND  LNK-SYU-KOH1COMPFTN    NOT =    ZERO
           AND  FLG-KOUGAKUCYO-ININ    NOT =     1
      *
                 COMPUTE   LNK-SYU-KOH1COMPFTN  =
                           LNK-SYU-KOH1COMPFTN  +  5
                 COMPUTE   WK-FTN      =
                           LNK-SYU-KOH1COMPFTN  / 10
                 COMPUTE   LNK-SYU-KOH1COMPFTN  =
                           WK-FTN   *  10
                 COMPUTE   LNK-SYU-KOH1COMPTOTAL   =
                           LNK-SYU-KOH1COMPFTN     +
                           LNK-SYU-KOH1COMPYKZFTN
      *
           END-IF.
      *
      *    ４１老人用
           IF   FLG-KOUGAKUCYO2        NOT =    ZERO
              IF   (FLG-IRYOHI2  NOT = ZERO)  AND  (FLG-HIKAKU = 1)
                  CONTINUE
              ELSE
                  MOVE     ZERO      TO    FLG-KOUGAKUCYO2
              END-IF
           END-IF.
           IF   FLG-KOUGAKUCYO-JIRITU  NOT =    ZERO
              IF   FLG-HIKAKU     =     1
                  CONTINUE
              ELSE
                  MOVE     ZERO      TO    FLG-KOUGAKUCYO-JIRITU
              END-IF
           END-IF.
      *
           IF   FLG-KOUGAKUCYO3        NOT =    ZERO
              IF  (FLG-IRYOHIKG2    =   1 OR 2 OR 3)
              AND (FLG-SYOUKAN(1)   =  "1"         )
              AND (FLG-HIKAKU       =   1          )
                  CONTINUE
              ELSE
                  MOVE    ZERO     TO    FLG-KOUGAKUCYO3
              END-IF
           END-IF.
      *
           IF   FLG-KOUGAKUCYO-GEN70    =    1
              EVALUATE  FLG-IRYOHI70
                WHEN      1
                WHEN      2
                WHEN      7
                WHEN      8
                    CONTINUE
                WHEN      3
                WHEN      4
                WHEN      9
                WHEN     10
                  IF  (FLG-SYOUKAN(1) =    "1")
                  AND (FLG-HIKAKU     =     1 )
                    CONTINUE
                  ELSE
                    MOVE    ZERO   TO    FLG-KOUGAKUCYO-GEN70
                  END-IF
                WHEN      5
                WHEN      6
                WHEN     11
                WHEN     12
                  IF  (FLG-KOUGAKUCYO-GEN70K NOT = ZERO)
                  AND (FLG-SYOUKAN(2) =    "1"         )
                  AND (FLG-HIKAKU2    =     2          )
                    CONTINUE
                  ELSE
                    MOVE    ZERO   TO    FLG-KOUGAKUCYO-GEN70
                  END-IF
              END-EVALUATE
           END-IF.
           IF   FLG-KOUGAKUCYO-GEN70K   =    1
               IF   FLG-HIKAKU     =     1
                    CONTINUE
               ELSE
                    MOVE    ZERO   TO    FLG-KOUGAKUCYO-GEN70K
               END-IF
           END-IF.
      *
           MOVE       ZERO         TO    FLG-FTNGAKEN.
           IF   WK-TAIHI-FTNGAKEN(1)    =    1
               IF   FLG-HIKAKU     =     1
                    MOVE    1      TO    FLG-FTNGAKEN
               END-IF
           END-IF.
           IF   WK-TAIHI-FTNGAKEN(2)    =    1
               IF   FLG-HIKAKU2    =     2
                    MOVE    1      TO    FLG-FTNGAKEN
               END-IF
           END-IF.
           IF   WK-TAIHI-FTNGAKEN(3)    =    1
               IF   FLG-HIKAKU3    =     3
                    MOVE    1      TO    FLG-FTNGAKEN
               END-IF
           END-IF.
           IF   WK-TAIHI-FTNGAKEN(4)    =    1
               IF   FLG-HIKAKU4    =     4
                    MOVE    1      TO    FLG-FTNGAKEN
               END-IF
           END-IF.
      *
           IF   LNK-SYU-KOH1HKNNUM      =   "970"
             IF   WK-1001-DAISANKBN  = "2"
                    MOVE    1      TO    FLG-FTNGAKEN
             END-IF
           END-IF.
      *
      *    現物給付に関する対象データフラグ編集
           PERFORM   23075-GENBUTU-TAISYODATA-SEC.
      *
      *    現物給付に関するメッセージフラグ編集
           PERFORM   23076-GENBUTU-MSG-HENSYU-SEC.
      *
       2307-FTNKIN-HIKAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *        長期併用時
      ******************************************************************
       23071-FTNKIN-HIKAKU-CYOKI-SEC         SECTION.
      *
      *    請求額比較
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    公費１のみ
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               IF  LNK-SYU-KOH2COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE    LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               IF  LNK-SYU-KOH2COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
               IF  LNK-SYU-KOH3COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE
               IF  LNK-SYU-SYUCOMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
           IF    WK-CYOKI-ZAN-ENTANI  <  WK-KNJFTNKIN-ENTANI
               MOVE   WK-CYOKI-ZAN-ENTANI   TO   WK-KNJFTNKIN-ENTANI
           END-IF
      *
      ****************************
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU2
           MOVE    ZERO               TO    FLG-HIKAKU3
           MOVE    ZERO               TO    FLG-HIKAKU4
      *    請求額比較
           MOVE    ZERO               TO    WK-KNJFTNKIN
      *
      *    公費１のみ
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN    TO    WK-KNJFTNKIN
               MOVE   WK-KOH1-YAKFTN        TO    LNK-SYU-YKZ-FTN
           END-IF
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    1                    TO    FLG-HIKAKU
               MOVE    LNK-SYU-KOH1COMPFTN  TO    WK-KNJFTNKIN
               MOVE    WK-KOH1-YAKFTN       TO    LNK-SYU-YKZ-FTN
               IF  WK-KOH2-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH2-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    1                    TO    FLG-HIKAKU
               MOVE    LNK-SYU-KOH1COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH2COMPFTN  =  WK-KNJFTNKIN
                     MOVE    2              TO    FLG-HIKAKU2
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU
                     MOVE    2              TO    FLG-HIKAKU2
                   END-IF
                   MOVE   LNK-SYU-KOH2COMPFTN     TO  WK-KNJFTNKIN
               END-IF
               MOVE    WK-KOH1-YAKFTN       TO    LNK-SYU-YKZ-FTN
               IF  WK-KOH2-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH2-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
               IF  WK-KOH3-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH3-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE    1                    TO    FLG-HIKAKU
               MOVE    LNK-SYU-KOH1COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH2COMPFTN  =  WK-KNJFTNKIN
                     MOVE    2              TO    FLG-HIKAKU2
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU
                     MOVE    2              TO    FLG-HIKAKU2
                   END-IF
                   MOVE   LNK-SYU-KOH2COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH3COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH3COMPFTN  =  WK-KNJFTNKIN
                     MOVE    3              TO    FLG-HIKAKU3
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU
                     MOVE   ZERO            TO    FLG-HIKAKU2
                     MOVE    3              TO    FLG-HIKAKU3
                   END-IF
                   MOVE   LNK-SYU-KOH3COMPFTN TO  WK-KNJFTNKIN
               END-IF
               MOVE    WK-KOH1-YAKFTN       TO    LNK-SYU-YKZ-FTN
               IF  WK-KOH2-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH2-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
               IF  WK-KOH3-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH3-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
               IF  WK-KOH4-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH4-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE
               IF  LNK-SYU-SYUCOMPFTN       <     WK-KNJFTNKIN
                   MOVE   ZERO                  TO   FLG-HIKAKU
                   MOVE   ZERO                  TO   FLG-HIKAKU2
                   MOVE   ZERO                  TO   FLG-HIKAKU3
                   MOVE   LNK-SYU-SYUCOMPFTN    TO   WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-SYUCOMPYKZFTN    <     LNK-SYU-YKZ-FTN
                   MOVE   LNK-SYU-SYUCOMPYKZFTN TO   LNK-SYU-YKZ-FTN
               END-IF
           END-IF
      *
           IF    WK-CYOKI-ZAN  <  WK-KNJFTNKIN
               MOVE     ZERO            TO     FLG-HIKAKU
               MOVE     ZERO            TO     FLG-HIKAKU2
               MOVE     ZERO            TO     FLG-HIKAKU3
               MOVE     WK-CYOKI-ZAN    TO     WK-KNJFTNKIN
           END-IF
      *
           .
      *
       23071-FTNKIN-HIKAKU-CYOKI-EXT.
           EXIT.
      *
      ******************************************************************
      *        長期併用時以外
      ******************************************************************
       23072-FTNKIN-HIKAKU-TUJYO-SEC         SECTION.
      *
      *    請求額比較
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    主保険のみ
           IF (COMB-KOH1HKNNUM              =    SPACE)    AND
              (COMB-KOH2HKNNUM              =    SPACE)    AND
              (COMB-KOH3HKNNUM              =    SPACE)    AND
              (COMB-KOH4HKNNUM              =    SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO   WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１のみ
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               IF  LNK-SYU-KOH2COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               IF  LNK-SYU-KOH2COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
               IF  LNK-SYU-KOH3COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE    LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               IF  LNK-SYU-KOH2COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
               IF  LNK-SYU-KOH3COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
               IF  LNK-SYU-KOH4COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH4COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE
               IF  LNK-SYU-SYUCOMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
      ****************************
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU2
           MOVE    ZERO               TO    FLG-HIKAKU3
           MOVE    ZERO               TO    FLG-HIKAKU4
      *    請求額比較
           MOVE    ZERO               TO    WK-KNJFTNKIN
      *    主保険のみ
           IF (COMB-KOH1HKNNUM              =    SPACE)    AND
              (COMB-KOH2HKNNUM              =    SPACE)    AND
              (COMB-KOH3HKNNUM              =    SPACE)    AND
              (COMB-KOH4HKNNUM              =    SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN    TO   WK-KNJFTNKIN
               MOVE   LNK-SYU-SYUCOMPYKZFTN TO   LNK-SYU-YKZ-FTN
           END-IF
      *    公費１のみ
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   1                     TO    FLG-HIKAKU
               MOVE   LNK-SYU-KOH1COMPFTN   TO    WK-KNJFTNKIN
               MOVE   WK-KOH1-YAKFTN        TO    LNK-SYU-YKZ-FTN
           END-IF
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    1                    TO    FLG-HIKAKU
               MOVE    LNK-SYU-KOH1COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH2COMPFTN  =  WK-KNJFTNKIN
                     MOVE    2              TO    FLG-HIKAKU2
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU
                     MOVE    2              TO    FLG-HIKAKU2
                   END-IF
                   MOVE   LNK-SYU-KOH2COMPFTN TO  WK-KNJFTNKIN
               END-IF
               MOVE    WK-KOH1-YAKFTN       TO    LNK-SYU-YKZ-FTN
               IF  WK-KOH2-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH2-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    1                    TO    FLG-HIKAKU
               MOVE    LNK-SYU-KOH1COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH2COMPFTN  =  WK-KNJFTNKIN
                     MOVE    2              TO    FLG-HIKAKU2
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU
                     MOVE    2              TO    FLG-HIKAKU2
                   END-IF
                   MOVE   LNK-SYU-KOH2COMPFTN     TO  WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH3COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH3COMPFTN  =  WK-KNJFTNKIN
                     MOVE    3              TO    FLG-HIKAKU3
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU
                     MOVE   ZERO            TO    FLG-HIKAKU2
                     MOVE    3              TO    FLG-HIKAKU3
                   END-IF
                   MOVE   LNK-SYU-KOH3COMPFTN TO  WK-KNJFTNKIN
               END-IF
               MOVE    WK-KOH1-YAKFTN       TO    LNK-SYU-YKZ-FTN
               IF  WK-KOH2-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH2-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
               IF  WK-KOH3-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH3-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE    1                    TO    FLG-HIKAKU
               MOVE    LNK-SYU-KOH1COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH2COMPFTN  =  WK-KNJFTNKIN
                     MOVE    2              TO    FLG-HIKAKU2
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU
                     MOVE    2              TO    FLG-HIKAKU2
                   END-IF
                   MOVE   LNK-SYU-KOH2COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH3COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH3COMPFTN  =  WK-KNJFTNKIN
                     MOVE    3              TO    FLG-HIKAKU3
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU
                     MOVE   ZERO            TO    FLG-HIKAKU2
                     MOVE    3              TO    FLG-HIKAKU3
                   END-IF
                   MOVE   LNK-SYU-KOH3COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH4COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH4COMPFTN  =  WK-KNJFTNKIN
                     MOVE    4              TO    FLG-HIKAKU4
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU
                     MOVE   ZERO            TO    FLG-HIKAKU2
                     MOVE   ZERO            TO    FLG-HIKAKU3
                     MOVE    4              TO    FLG-HIKAKU4
                   END-IF
                   MOVE   LNK-SYU-KOH4COMPFTN TO  WK-KNJFTNKIN
               END-IF
               MOVE    WK-KOH1-YAKFTN       TO    LNK-SYU-YKZ-FTN
               IF  WK-KOH2-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH2-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
               IF  WK-KOH3-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH3-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
               IF  WK-KOH4-YAKFTN           <     LNK-SYU-YKZ-FTN
                   MOVE   WK-KOH4-YAKFTN    TO    LNK-SYU-YKZ-FTN
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE
               IF  LNK-SYU-SYUCOMPFTN       <     WK-KNJFTNKIN
                   MOVE   ZERO                  TO   FLG-HIKAKU
                   MOVE   ZERO                  TO   FLG-HIKAKU2
                   MOVE   ZERO                  TO   FLG-HIKAKU3
                   MOVE   ZERO                  TO   FLG-HIKAKU4
                   MOVE   LNK-SYU-SYUCOMPFTN    TO   WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-SYUCOMPYKZFTN    <     LNK-SYU-YKZ-FTN
                   MOVE   LNK-SYU-SYUCOMPYKZFTN TO   LNK-SYU-YKZ-FTN
               END-IF
           END-IF
      *
           .
      *
       23072-FTNKIN-HIKAKU-TUJYO-EXT.
           EXIT.
      *
      ******************************************************************
      *        長期併用時（累計ベース計算用）
      ******************************************************************
       23071X-FTNKIN-HIKAKU-CYOKI-SEC         SECTION.
      *
      *    請求額比較
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE    LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               IF  LNK-SYU-KOH3COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
           IF  (WK-2010-KINJYOKBN-G(1) = "1")
           AND (FLG-MARUTOARI          =  1 )
             CONTINUE
           ELSE
             IF   COMB-KOH1HKNNUM        NOT   =   "027" 
             AND  COMB-HKNNUM            NOT   =   SPACE
               IF  LNK-SYU-SYUCOMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
             END-IF
           END-IF
      *
           IF    WK-CYOKI-ZAN-ENTANI  <  WK-KNJFTNKIN-ENTANI
               MOVE   WK-CYOKI-ZAN-ENTANI   TO   WK-KNJFTNKIN-ENTANI
           END-IF
      *
      ****************************
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU2
           MOVE    ZERO               TO    FLG-HIKAKU3
           MOVE    ZERO               TO    FLG-HIKAKU4
      *    請求額比較
           MOVE    ZERO               TO    WK-KNJFTNKIN
      *
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    2                    TO    FLG-HIKAKU2
               MOVE    LNK-SYU-KOH2COMPFTN  TO    WK-KNJFTNKIN
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE    2                    TO    FLG-HIKAKU2
               MOVE    LNK-SYU-KOH2COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH3COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH3COMPFTN  =  WK-KNJFTNKIN
                     MOVE    3              TO    FLG-HIKAKU3
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU2
                     MOVE    3              TO    FLG-HIKAKU3
                   END-IF
                   MOVE   LNK-SYU-KOH3COMPFTN     TO  WK-KNJFTNKIN
               END-IF
           END-IF
      *
           IF  (WK-2010-KINJYOKBN-G(1) = "1")
           AND (FLG-MARUTOARI          =  1 )
             CONTINUE
           ELSE
             IF   COMB-KOH1HKNNUM        NOT   =   "027" 
             AND  COMB-HKNNUM            NOT   =   SPACE
               IF  LNK-SYU-SYUCOMPFTN       <     WK-KNJFTNKIN
                   MOVE   ZERO                  TO   FLG-HIKAKU2
                   MOVE   ZERO                  TO   FLG-HIKAKU3
                   MOVE   LNK-SYU-SYUCOMPFTN    TO   WK-KNJFTNKIN
               END-IF
             END-IF
           END-IF
      *
           IF    WK-CYOKI-ZAN  <  WK-KNJFTNKIN
               MOVE     ZERO            TO     FLG-HIKAKU2
               MOVE     ZERO            TO     FLG-HIKAKU3
               MOVE     WK-CYOKI-ZAN    TO     WK-KNJFTNKIN
           END-IF
      *
           .
      *
       23071X-FTNKIN-HIKAKU-CYOKI-EXT.
           EXIT.
      *
      ******************************************************************
      *        長期併用時以外（累計ベース計算用）
      ******************************************************************
       23072X-FTNKIN-HIKAKU-TUJYO-SEC         SECTION.
      *
      *    請求額比較
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               IF  LNK-SYU-KOH3COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE    LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               IF  LNK-SYU-KOH3COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
               IF  LNK-SYU-KOH4COMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-KOH4COMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
           IF  (WK-2010-KINJYOKBN-G(1) = "1")
           AND (FLG-MARUTOARI          =  1 )
             CONTINUE
           ELSE
             IF   COMB-KOH1HKNNUM        NOT   =   "027" 
             AND  COMB-HKNNUM            NOT   =   SPACE
               IF  LNK-SYU-SYUCOMPFTN-ENTANI
                                      <     WK-KNJFTNKIN-ENTANI
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO    WK-KNJFTNKIN-ENTANI
               END-IF
             END-IF
           END-IF
      *
      ****************************
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU2
           MOVE    ZERO               TO    FLG-HIKAKU3
           MOVE    ZERO               TO    FLG-HIKAKU4
      *    請求額比較
           MOVE    ZERO               TO    WK-KNJFTNKIN
      *
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    2                    TO    FLG-HIKAKU2
               MOVE    LNK-SYU-KOH2COMPFTN  TO    WK-KNJFTNKIN
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE    2                    TO    FLG-HIKAKU2
               MOVE    LNK-SYU-KOH2COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH3COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH3COMPFTN  =  WK-KNJFTNKIN
                     MOVE    3              TO    FLG-HIKAKU3
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU2
                     MOVE    3              TO    FLG-HIKAKU3
                   END-IF
                   MOVE   LNK-SYU-KOH3COMPFTN     TO  WK-KNJFTNKIN
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE    2                    TO    FLG-HIKAKU2
               MOVE    LNK-SYU-KOH2COMPFTN  TO    WK-KNJFTNKIN
               IF  LNK-SYU-KOH3COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH3COMPFTN  =  WK-KNJFTNKIN
                     MOVE    3              TO    FLG-HIKAKU3
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU2
                     MOVE    3              TO    FLG-HIKAKU3
                   END-IF
                   MOVE   LNK-SYU-KOH3COMPFTN TO  WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH4COMPFTN      <=    WK-KNJFTNKIN
                   IF  LNK-SYU-KOH4COMPFTN  =  WK-KNJFTNKIN
                     MOVE    4              TO    FLG-HIKAKU4
                   ELSE
                     MOVE   ZERO            TO    FLG-HIKAKU2
                     MOVE   ZERO            TO    FLG-HIKAKU3
                     MOVE    4              TO    FLG-HIKAKU4
                   END-IF
                   MOVE   LNK-SYU-KOH4COMPFTN TO  WK-KNJFTNKIN
               END-IF
           END-IF
      *
           IF  (WK-2010-KINJYOKBN-G(1) = "1")
           AND (FLG-MARUTOARI          =  1 )
             CONTINUE
           ELSE
             IF   COMB-KOH1HKNNUM        NOT   =   "027" 
             AND  COMB-HKNNUM            NOT   =   SPACE
               IF  LNK-SYU-SYUCOMPFTN       <     WK-KNJFTNKIN
                   MOVE   ZERO                  TO   FLG-HIKAKU2
                   MOVE   ZERO                  TO   FLG-HIKAKU3
                   MOVE   ZERO                  TO   FLG-HIKAKU4
                   MOVE   LNK-SYU-SYUCOMPFTN    TO   WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-SYUCOMPYKZFTN    <     LNK-SYU-YKZ-FTN
                   MOVE   LNK-SYU-SYUCOMPYKZFTN TO   LNK-SYU-YKZ-FTN
               END-IF
             END-IF
           END-IF
      *
           .
      *
       23072X-FTNKIN-HIKAKU-TUJYO-EXT.
           EXIT.
      *
      ******************************************************************
      *        特殊計算用金額退避編集
      ******************************************************************
       23073-TOKUSYU-HENSYU-SEC         SECTION.
      *
           IF ( WK-2010-IRYOKEIKBN-G(1) NOT = SPACE )
           OR ( WK-2010-IRYOKEIKBN-G(2) NOT = SPACE )
           OR ( WK-2010-IRYOKEIKBN-G(3) NOT = SPACE )
           OR ( WK-2010-IRYOKEIKBN-G(4) NOT = SPACE )
           OR ( WK-2010-KINJYOKBN-G(1)      =  "1"  )
           OR ( WK-2010-KINJYOKBN-G(2)      =  "1"  )
           OR ( WK-2010-KINJYOKBN-G(3)      =  "1"  )
           OR ( WK-2010-KINJYOKBN-G(4)      =  "1"  )
      *
                    IF ((FLG-KOUGAKUCYO-GEN70  NOT = ZERO   ) AND
                        (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10   ) AND
                        ((WK-2010-IRYOKEIKBN-G(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-G(1)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO-GEN70  NOT = ZERO   ) AND
                        (FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12  ) AND
                        (FLG-KOUGAKUCYO-GEN70K NOT = ZERO   ) AND
                        ((WK-2010-IRYOKEIKBN-G(2)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-G(2)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO3       NOT = ZERO   ) AND
                        (FLG-IRYOHIKG2  =   1 OR 2 OR 3     ) AND
                        ((WK-2010-IRYOKEIKBN-G(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-G(1)   =  "1"  )))
                      CONTINUE
                    ELSE
                      COMPUTE  WK-TOKUSYU-COMPFTN   =
                               WK-TOKUSYU-COMPFTN   +    5
                      COMPUTE  WK-TOKUSYU-COMPFTN   =
                               WK-TOKUSYU-COMPFTN   /   10
                      COMPUTE  WK-TOKUSYU-COMPFTN   =
                               WK-TOKUSYU-COMPFTN   *   10
                    END-IF
      *
                    IF  ( WK-2010-IRYOKEIKBN-G(1)
                                               NOT = SPACE  )
                    OR  ( WK-2010-KINJYOKBN-G(1)   =  "1"   )
                    OR  ((LNK-SYU-SYUHKNNUM    NOT =  SPACE) AND
                         (LNK-SYU-KOH1HKNNUM       =  "027") AND
                         (WK-2010-IRYOKEIKBN-G(2)
                                               NOT = SPACE ))
                    OR  ((LNK-SYU-SYUHKNNUM    NOT =  SPACE) AND
                         (LNK-SYU-KOH1HKNNUM       =  "027") AND
                         (WK-2010-KINJYOKBN-G(2)   =  "1"  ))
                     IF  LNK-SYU-KOH1HKNNUM   = "972" OR "974"
                       IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         CONTINUE
                       ELSE
                         IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                              < WK-TOKUSYU-COMPFTN2
                            MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                           TO  WK-TOKUSYU-COMPFTN2
                         END-IF
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN(1)
                                              < WK-TOKUSYU-COMPFTN
                            MOVE  LNK-SYU-KOH-COMPFTN(1)
                                           TO  WK-TOKUSYU-COMPFTN
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                     END-IF
                     IF  LNK-SYU-KOH2HKNNUM   = "972" OR "974"
                       IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         CONTINUE
                       ELSE
                         IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                              < WK-TOKUSYU-COMPFTN2
                            MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                           TO  WK-TOKUSYU-COMPFTN2
                         END-IF
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN(2)
                                              < WK-TOKUSYU-COMPFTN
                            MOVE  LNK-SYU-KOH-COMPFTN(2)
                                           TO  WK-TOKUSYU-COMPFTN
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                     END-IF
                     IF  LNK-SYU-KOH3HKNNUM   = "972" OR "974"
                       IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         CONTINUE
                       ELSE
                         IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                              < WK-TOKUSYU-COMPFTN2
                            MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                           TO  WK-TOKUSYU-COMPFTN2
                         END-IF
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN(3)
                                              < WK-TOKUSYU-COMPFTN
                            MOVE  LNK-SYU-KOH-COMPFTN(3)
                                           TO  WK-TOKUSYU-COMPFTN
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                     END-IF
                     IF  LNK-SYU-KOH4HKNNUM   = "972" OR "974"
                       IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         CONTINUE
                       ELSE
                         IF  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                              < WK-TOKUSYU-COMPFTN2
                            MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                           TO  WK-TOKUSYU-COMPFTN2
                         END-IF
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN(4)
                                              < WK-TOKUSYU-COMPFTN
                            MOVE  LNK-SYU-KOH-COMPFTN(4)
                                           TO  WK-TOKUSYU-COMPFTN
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                     END-IF
                    END-IF
      *
                    IF ((FLG-KOUGAKUCYO-GEN70  NOT = ZERO   ) AND
                        (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10   ) AND
                        ((WK-2010-IRYOKEIKBN-G(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-G(1)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO-GEN70  NOT = ZERO   ) AND
                        (FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12  ) AND
                        (FLG-KOUGAKUCYO-GEN70K NOT = ZERO   ) AND
                        ((WK-2010-IRYOKEIKBN-G(2)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-G(2)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO3       NOT = ZERO   ) AND
                        (FLG-IRYOHIKG2  =   1 OR 2 OR 3     ) AND
                        ((WK-2010-IRYOKEIKBN-G(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-G(1)   =  "1"  )))
                      MOVE     WK-TOKUSYU-COMPFTN   TO
                                         LNK-SYU-JYO-HKNFTNMONEY
                    ELSE
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    WK-TOKUSYU-COMPFTN        +    5
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   /   10
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   *   10
                    END-IF
      *
                    IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         MOVE  WK-TOKUSYU-COMPFTN   TO
                                          LNK-SYU-JYO-COMPFTN
                    ELSE
                         MOVE  WK-TOKUSYU-COMPFTN2  TO
                                          LNK-SYU-JYO-COMPFTN
                    END-IF
      *
                    MOVE     WK-TOKUSYU-ENTANI    TO
                                        LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
           IF  (WK-1001-PREFNUM             =  43      )
           AND (LNK-SYU-SRYYMD(1:6)        >= "200912" )
           AND ((LNK-SYU-KOH1HKNNUM  =  "143" OR "342") OR
                (LNK-SYU-KOH2HKNNUM  =  "143" OR "342") OR
                (LNK-SYU-KOH3HKNNUM  =  "143" OR "342") OR
                (LNK-SYU-KOH4HKNNUM  =  "143" OR "342"))
             IF   WK-KUMAMOTO-SYUCOMPFTN  NOT = ZERO
                 MOVE  WK-KUMAMOTO-SYUCOMPFTN
                                           TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
           END-IF
      *
           IF  (WK-1001-PREFNUM             =  43      )
           AND (LNK-SYU-SRYYMD(1:6)        >= "201608" )
           AND ((LNK-SYU-KOH1HKNNUM  =  "443"         ) OR
                (LNK-SYU-KOH2HKNNUM  =  "443"         ) OR
                (LNK-SYU-KOH3HKNNUM  =  "443"         ) OR
                (LNK-SYU-KOH4HKNNUM  =  "443"         ))
             IF   WK-KUMAMOTO-SYUCOMPFTN  NOT = ZERO
               IF  (LNK-SYU-KOH1HKNNUM  =  "443")
               AND (LNK-SYU-KOH2HKNNUM  =  SPACE)
               AND (LNK-SYU-KOH3HKNNUM  =  SPACE)
               AND (LNK-SYU-KOH4HKNNUM  =  SPACE)
                   MOVE  WK-KUMAMOTO-SYUCOMPFTN
                                           TO  LNK-SYU-JYO-HKNFTNMONEY
               ELSE
                   COMPUTE  LNK-SYU-JYO-HKNFTNMONEY =
                            LNK-SYU-SKYMONEY        +  5
                   COMPUTE  LNK-SYU-JYO-HKNFTNMONEY =
                            LNK-SYU-JYO-HKNFTNMONEY / 10
                   COMPUTE  LNK-SYU-JYO-HKNFTNMONEY =
                            LNK-SYU-JYO-HKNFTNMONEY * 10
               END-IF
             END-IF
           END-IF
      *
           IF  (WK-1001-PREFNUM             =  35 OR 34)
           AND (LNK-SYU-SRYYMD(1:6)        >= "201309" )
           AND ((LNK-SYU-KOH1HKNNUM  =  "781") OR
                (LNK-SYU-KOH2HKNNUM  =  "781") OR
                (LNK-SYU-KOH3HKNNUM  =  "781") OR
                (LNK-SYU-KOH4HKNNUM  =  "781")         )
      *
             IF   LNK-SYU-SYUHKNNUM   NOT =  SPACE
               IF ((FLG-KOUGAKUCYO-GEN70  NOT = ZERO   ) AND
                   (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10   ) AND
                   (LNK-SYU-KOH1HKNNUM    = "781"      ))
               OR ((FLG-KOUGAKUCYO-GEN70  NOT = ZERO   ) AND
                   (FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12  ) AND
                   (FLG-KOUGAKUCYO-GEN70K NOT = ZERO   ) AND
                   (LNK-SYU-KOH2HKNNUM    = "781"      ))
               OR ((FLG-KOUGAKUCYO3       NOT = ZERO   ) AND
                   (FLG-IRYOHIKG2  =   1 OR 2 OR 3     ) AND
                   (LNK-SYU-KOH1HKNNUM    = "781"      ))
                 MOVE  LNK-SYU-SYUCOMPFTN       TO  WK-JYOSEI-KOHIKIN3
               ELSE
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          LNK-SYU-SYUCOMPFTN   +    5
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          WK-JYOSEI-KOHIKIN3   /   10
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          WK-JYOSEI-KOHIKIN3   *   10
               END-IF
             ELSE
                 MOVE  WK-JYOSEI-KOHIKIN-ZENGAKU
                                                TO  WK-JYOSEI-KOHIKIN3
             END-IF
      *
             IF   LNK-SYU-KOH2HKNNUM  =  "781"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(1)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(1)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
             IF   LNK-SYU-KOH3HKNNUM  =  "781"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(2)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(2)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
             IF   LNK-SYU-KOH4HKNNUM  =  "781"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(3)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(3)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
      *
             MOVE  9999999                TO  LNK-SYU-JYO-HKNFTNMONEY
             MOVE  WK-JYOSEI-KOHIKIN3     TO  LNK-SYU-JYO-COMPFTN
             MOVE  WK-JYOSEI-KOHIKIN2     TO  LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
           IF  (WK-1001-PREFNUM             =  23     )
           AND (LNK-SYU-SRYYMD(1:6)        >= "201504")
           AND ((LNK-SYU-KOH1HKNNUM  =
                     "581" OR "681" OR "781" OR "271") OR
                (LNK-SYU-KOH2HKNNUM  =
                     "581" OR "681" OR "781" OR "271") OR
                (LNK-SYU-KOH3HKNNUM  =
                     "581" OR "681" OR "781" OR "271") OR
                (LNK-SYU-KOH4HKNNUM  =
                     "581" OR "681" OR "781" OR "271"))
      *
             IF   LNK-SYU-SYUHKNNUM   NOT =  SPACE
               IF ((FLG-KOUGAKUCYO-GEN70  NOT = ZERO   ) AND
                   (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10   ) AND
                   (LNK-SYU-KOH1HKNNUM    =
                    "581" OR "681" OR "781" OR "271"   ))
               OR ((FLG-KOUGAKUCYO-GEN70  NOT = ZERO   ) AND
                   (FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12  ) AND
                   (FLG-KOUGAKUCYO-GEN70K NOT = ZERO   ) AND
                   (LNK-SYU-KOH2HKNNUM    =
                    "581" OR "681" OR "781" OR "271"   ))
               OR ((FLG-KOUGAKUCYO3       NOT = ZERO   ) AND
                   (FLG-IRYOHIKG2  =   1 OR 2 OR 3     ) AND
                   (LNK-SYU-KOH1HKNNUM    =
                    "581" OR "681" OR "781" OR "271"   ))
                 MOVE  LNK-SYU-SYUCOMPFTN       TO  WK-JYOSEI-KOHIKIN3
               ELSE
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          LNK-SYU-SYUCOMPFTN   +    5
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          WK-JYOSEI-KOHIKIN3   /   10
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          WK-JYOSEI-KOHIKIN3   *   10
               END-IF
             ELSE
                 MOVE  WK-JYOSEI-KOHIKIN-ZENGAKU
                                                TO  WK-JYOSEI-KOHIKIN3
             END-IF
      *
             IF   LNK-SYU-KOH2HKNNUM  =  "581" OR "681" OR
                                         "781" OR "271"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(1)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(1)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
             IF   LNK-SYU-KOH3HKNNUM  =  "581" OR "681" OR
                                         "781" OR "271"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(2)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(2)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
             IF   LNK-SYU-KOH4HKNNUM  =  "581" OR "681" OR
                                         "781" OR "271"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(3)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(3)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
      *
             MOVE  9999999                TO  LNK-SYU-JYO-HKNFTNMONEY
             MOVE  WK-JYOSEI-KOHIKIN3     TO  LNK-SYU-JYO-COMPFTN
             MOVE  WK-JYOSEI-KOHIKIN2     TO  LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
      ***
      *
           IF  (WK-1001-PREFNUM       =  36                    )
           AND (COMB-HKNNUM       NOT = SPACE                  )
           AND (COMB-KOH1HKNNUM(1:1)  = "0"                    )
           AND (COMB-KOH1HKNNUM   NOT = "010"                  )
           AND (COMB-KOH2HKNNUM       = "149"                  )
           AND (COMB-KOH3HKNNUM       = SPACE OR "972" OR "974")
           AND (COMB-KOH4HKNNUM       = SPACE                  )
           AND (LNK-SYU-SRYYMD(1:6)  >= "201610"               )
      *
             MOVE    ZERO    TO   FLG-HIKAKU
             MOVE    ZERO    TO   FLG-HIKAKU2
             MOVE    ZERO    TO   FLG-HIKAKU3
             MOVE    ZERO    TO   FLG-HIKAKU4
             MOVE    ZERO    TO   WK-TAIHI-COMPFTN-149
      *
      *      請求額に加算
             IF   COMB-KOH3HKNNUM  = "972" OR "974"
               IF    LNK-SYU-SYUCOMPFTN-ENTANI  <
                                           LNK-SYU-KOH1COMPFTN-ENTANI
                 IF  WK-CYOKI-ZAN-ENTANI  <  LNK-SYU-SYUCOMPFTN-ENTANI
                   ADD  WK-CYOKI-ZAN-ENTANI  TO  WK-KNJFTNKIN-ENTANI
                   MOVE WK-CYOKI-ZAN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 ELSE
                   ADD  LNK-SYU-SYUCOMPFTN-ENTANI
                                             TO  WK-KNJFTNKIN-ENTANI
                   MOVE LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 END-IF
               ELSE
                 IF  WK-CYOKI-ZAN-ENTANI  <  LNK-SYU-KOH1COMPFTN-ENTANI
                   ADD  WK-CYOKI-ZAN-ENTANI  TO  WK-KNJFTNKIN-ENTANI
                   MOVE WK-CYOKI-ZAN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 ELSE
                   ADD  LNK-SYU-KOH1COMPFTN-ENTANI
                                             TO  WK-KNJFTNKIN-ENTANI
                   MOVE LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 END-IF
               END-IF
               IF    LNK-SYU-SYUCOMPFTN  <  LNK-SYU-KOH1COMPFTN
                 IF  WK-CYOKI-ZAN  <  LNK-SYU-SYUCOMPFTN
                   ADD  WK-CYOKI-ZAN         TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE WK-CYOKI-ZAN         TO  LNK-SYU-JYO-COMPFTN
                 ELSE
                   ADD  LNK-SYU-SYUCOMPFTN   TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE LNK-SYU-SYUCOMPFTN   TO  LNK-SYU-JYO-COMPFTN
                 END-IF
               ELSE
                 IF  WK-CYOKI-ZAN  <  LNK-SYU-KOH1COMPFTN
                   ADD  WK-CYOKI-ZAN         TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE WK-CYOKI-ZAN         TO  LNK-SYU-JYO-COMPFTN
                 ELSE
                   ADD  LNK-SYU-KOH1COMPFTN  TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE LNK-SYU-KOH1COMPFTN  TO  LNK-SYU-JYO-COMPFTN
                 END-IF
               END-IF
      *
               MOVE    1                     TO  FLG-HIKAKU
               MOVE  LNK-SYU-KOH1COMPFTN     TO  WK-TAIHI-COMPFTN-149
               IF  LNK-SYU-SYUCOMPFTN  <  WK-TAIHI-COMPFTN-149
                   MOVE   ZERO               TO  FLG-HIKAKU
                   MOVE   LNK-SYU-SYUCOMPFTN TO  WK-TAIHI-COMPFTN-149
               END-IF
               IF  WK-CYOKI-ZAN  <  WK-TAIHI-COMPFTN-149
                   MOVE   ZERO               TO  FLG-HIKAKU
                   MOVE   WK-CYOKI-ZAN       TO  WK-TAIHI-COMPFTN-149
               END-IF
             ELSE
               IF    LNK-SYU-SYUCOMPFTN-ENTANI  <
                                           LNK-SYU-KOH1COMPFTN-ENTANI
                   ADD  LNK-SYU-SYUCOMPFTN-ENTANI
                                             TO  WK-KNJFTNKIN-ENTANI
                   MOVE LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
               ELSE
                   ADD  LNK-SYU-KOH1COMPFTN-ENTANI
                                             TO  WK-KNJFTNKIN-ENTANI
                   MOVE LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
               END-IF
               IF    LNK-SYU-SYUCOMPFTN  <  LNK-SYU-KOH1COMPFTN
                   ADD  LNK-SYU-SYUCOMPFTN   TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE LNK-SYU-SYUCOMPFTN   TO  LNK-SYU-JYO-COMPFTN
               ELSE
                   ADD  LNK-SYU-KOH1COMPFTN  TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE LNK-SYU-KOH1COMPFTN  TO  LNK-SYU-JYO-COMPFTN
               END-IF
      *
               MOVE    1                     TO  FLG-HIKAKU
               MOVE  LNK-SYU-KOH1COMPFTN     TO  WK-TAIHI-COMPFTN-149
               IF  LNK-SYU-SYUCOMPFTN  <  WK-TAIHI-COMPFTN-149
                   MOVE   ZERO               TO  FLG-HIKAKU
                   MOVE   LNK-SYU-SYUCOMPFTN TO  WK-TAIHI-COMPFTN-149
               END-IF
             END-IF
      *
           END-IF
      *
           .
      *
       23073-TOKUSYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        大分県乳幼児特殊計算
      *        宮城県乳幼児特殊計算
      *        群馬県地方公費特殊計算
      ******************************************************************
       23074-OITA-TOKUSYU-KEISAN-SEC         SECTION.
      *
           IF  ( WK-1001-PREFNUM             =  44      )
           AND ( LNK-SYU-SRYYMD(1:6)        >= "200610" )
           AND ( LNK-SYU-SRYYMD(1:6)        <  "201010" )
           AND ((LNK-SYU-KOH1HKNNUM   = "183" OR "283" ) OR
                (LNK-SYU-KOH2HKNNUM   = "183" OR "283" ) OR
                (LNK-SYU-KOH3HKNNUM   = "183" OR "283" ) OR
                (LNK-SYU-KOH4HKNNUM   = "183" OR "283" ))
      *
             IF   LNK-SYU-KOH1HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-SYUCOMPFTN     TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   LNK-SYU-KOH2HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-KOH-COMPFTN(1) TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   LNK-SYU-KOH3HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-KOH-COMPFTN(2) TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   LNK-SYU-KOH4HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-KOH-COMPFTN(3) TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
      *
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  +    5
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  /   10
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  *   10
      *
             MOVE     ZERO      TO     WK-OITA-CYOFTN-KON
      *
             IF     FLG-GENBUTU70    NOT =    ZERO
                IF  (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10    )
                AND (LNK-SYU-KOH1HKNNUM =  "183" OR "283")
                AND (FLG-SYUKEI2        =   ZERO         )
                  COMPUTE WK-FUTANWARI   = WK-KOH-FTNRATE  /  100
                  COMPUTE WK-OITA-KEISAN = WK-KOUREI-IRYOHI70
                                         * WK-FUTANWARI
                  COMPUTE  WK-OITA-KEISAN  =
                           WK-OITA-KEISAN  +    5
                  COMPUTE  WK-OITA-KEISAN  =
                           WK-OITA-KEISAN  /   10
                  COMPUTE  WK-OITA-KEISAN  =
                           WK-OITA-KEISAN  *   10
                  IF      MAX-KIN-SYU-M  > WK-OITA-KEISAN
                    MOVE   WK-OITA-KEISAN  TO  WK-OITA-KEISAN2
                  ELSE
                    MOVE   MAX-KIN-SYU-M   TO  WK-OITA-KEISAN2
                  END-IF
                  IF   WK-OITA-KEISAN2  >  80100
                    COMPUTE  WK-OITA-CYOFTN-KON  =  WK-OITA-KEISAN2
                                                 -  80100
                    IF  WK-OITA-CYOFTN-KON   >  WK-OITA-CYOFTN
                       COMPUTE WK-OITA-CYOFTN-KON  = WK-OITA-CYOFTN-KON
                                                   - WK-OITA-CYOFTN
                    ELSE
                       MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
                    END-IF
                  END-IF
                END-IF
                MOVE           ZERO    TO    LNK-SYU-JYO-HKNFTNMONEY
             ELSE
                IF ((LNK-SYU-KOH1HKNNUM   = "972" OR "974" ) OR
                    (LNK-SYU-KOH2HKNNUM   = "972" OR "974" ) OR
                    (LNK-SYU-KOH3HKNNUM   = "972" OR "974" ) OR
                    (LNK-SYU-KOH4HKNNUM   = "972" OR "974" ))
                  MOVE         ZERO    TO    LNK-SYU-JYO-HKNFTNMONEY
                ELSE
                  COMPUTE  WK-OITA-HKNFTNMONEY = WK-OITA-HKNFTNMONEY
                                               + LNK-SYU-JYO-HKNFTNMONEY
                  IF       WK-OITA-HKNFTNMONEY > 80100
                    COMPUTE  WK-OITA-CYOFTN-KON  =  WK-OITA-HKNFTNMONEY
                                                 -  80100
                    IF  WK-OITA-CYOFTN-KON   >  WK-OITA-CYOFTN
                       COMPUTE WK-OITA-CYOFTN-KON  = WK-OITA-CYOFTN-KON
                                                   - WK-OITA-CYOFTN
                    ELSE
                       MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
                    END-IF
                  END-IF
                END-IF
             END-IF
             PERFORM     230742-OITA-TOKUSYU-HENSYU2-SEC
      *
           END-IF
      *
           MOVE       ZERO      TO     WK-OITA-CYOFTN-KON
           IF   WK-2010-NINNASIKBN(1)  NOT =  SPACE
             IF   FLG-GENBUTU70   NOT =  ZERO
               IF  (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10)
               OR  (FLG-OITA-SYUKEI   =  1          )
      *          限度額認定証無し
                 IF      FLG-OITA-GENBUTU70   =    1
                    IF   FLG-OITA-SYUKEI  =  1
                      COMPUTE  WK-KOUREI-IRYOHI70  =
                               WK-KOUREI-IRYOHI70  +
                              (LNK-SYU-HKNTEN(17)  * 10)
                    END-IF
                    IF  LNK-SYU-SRYYMD(1:6)  <   "201104"
                      IF  FLG-SYUKEI2  =   ZERO
                        MOVE  ZERO  TO  WK-KOUREI-IRYOHI70-JYOGAI
                        MOVE  ZERO  TO  WK-OITA-HKNFTNMONEY
                        PERFORM  230741-OITA-TOKUSYU-HENSYU-SEC
                      END-IF
                    ELSE
                        PERFORM  230741-OITA-TOKUSYU-HENSYU-SEC
                    END-IF
                 END-IF
                 PERFORM         230742-OITA-TOKUSYU-HENSYU2-SEC
               END-IF
             END-IF
           END-IF
      *
           MOVE       ZERO      TO     WK-OITA-CYOFTN-KON
           IF   WK-2010-NINJYOKBN(1)   NOT =  SPACE
             IF   FLG-GENBUTU70   NOT =  ZERO
               IF  (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10)
               OR  (FLG-OITA-SYUKEI   =  1          )
      *          上位所得者
                 IF      FLG-GENBUTU70        =    1
                 AND     FLG-OITA-GENBUTU70   =   ZERO
                   PERFORM       230743-OITA-TOKUSYU-HENSYU3-SEC
                 END-IF
                 PERFORM         230742-OITA-TOKUSYU-HENSYU2-SEC
               END-IF
             END-IF
           END-IF
      *
      ***
      *
           IF     WK-2010-NINNASIKBN(2)  NOT =  SPACE
           OR     WK-2010-NINNASIKBN(3)  NOT =  SPACE
           OR     WK-2010-NINNASIKBN(4)  NOT =  SPACE
           OR     WK-2010-NINJYOKBN(2)   NOT =  SPACE
           OR     WK-2010-NINJYOKBN(3)   NOT =  SPACE
           OR     WK-2010-NINJYOKBN(4)   NOT =  SPACE
      *
             IF     WK-2010-NINNASIKBN(2)  NOT =  SPACE
             OR     WK-2010-NINJYOKBN(2)   NOT =  SPACE
                  MOVE  LNK-SYU-KOH-COMPFTN(1)
                                    TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF     WK-2010-NINNASIKBN(3)  NOT =  SPACE
             OR     WK-2010-NINJYOKBN(3)   NOT =  SPACE
                  MOVE  LNK-SYU-KOH-COMPFTN(2)
                                    TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF     WK-2010-NINNASIKBN(4)  NOT =  SPACE
             OR     WK-2010-NINJYOKBN(4)   NOT =  SPACE
                  MOVE  LNK-SYU-KOH-COMPFTN(3)
                                    TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
      *
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  +    5
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  /   10
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  *   10
      *
             IF  (LNK-SYU-KOH1HKNNUM   = "972" OR "974" )
             OR  (LNK-SYU-KOH2HKNNUM   = "972" OR "974" )
             OR  (LNK-SYU-KOH3HKNNUM   = "972" OR "974" )
             OR  (LNK-SYU-KOH4HKNNUM   = "972" OR "974" )
                MOVE      ZERO     TO    LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   WK-GENGAKUKBN    NOT  =   ZERO
                MOVE      ZERO     TO    LNK-SYU-JYO-HKNFTNMONEY
             END-IF
      *
           END-IF
      *
           .
      *
       23074-OITA-TOKUSYU-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *
      ******************************************************************
       230741-OITA-TOKUSYU-HENSYU-SEC         SECTION.
      *
           COMPUTE  WK-KOUREI-IRYOHI70  =  WK-KOUREI-IRYOHI70
                                        -  WK-KOUREI-IRYOHI70-JYOGAI
      *
           COMPUTE  WK-FUTANWARI    =  WK-KOH-FTNRATE  /  100
           COMPUTE  WK-OITA-KEISAN  =  WK-KOUREI-IRYOHI70
                                    *  WK-FUTANWARI
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  +    5
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  /   10
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  *   10
      *
           COMPUTE  WK-OITA-KEISAN  =  WK-OITA-KEISAN
                                    +  WK-OITA-HKNFTNMONEY
      *
           IF   WK-OITA-KEISAN   >  MAX-KIN-SYU-M
             COMPUTE  WK-OITA-CYOFTN-KON  =  WK-OITA-KEISAN
                                          -  MAX-KIN-SYU-M
             IF  WK-OITA-CYOFTN-KON   >  WK-OITA-CYOFTN
                COMPUTE WK-OITA-CYOFTN-KON  = WK-OITA-CYOFTN-KON
                                            - WK-OITA-CYOFTN
             ELSE
                MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
             END-IF
           END-IF
      *
           .
      *
       230741-OITA-TOKUSYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *
      ******************************************************************
       230742-OITA-TOKUSYU-HENSYU2-SEC         SECTION.
      *
           IF   WK-GENGAKUKBN    NOT  =   ZERO
             MOVE    ZERO    TO    LNK-SYU-JYO-HKNFTNMONEY
             MOVE    ZERO    TO    LNK-SYU-JYO-COMPFTN
             MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
           END-IF
      *
           IF      WK-OITA-CYOFTN-KON   NOT  =  ZERO
             MOVE    WK-OITA-CYOFTN-KON  TO  LNK-SYU-JYO-COMPFTN
      *      請求額に加算
             COMPUTE  LNK-SYU-SKYMONEY  =
                      LNK-SYU-SKYMONEY  +    5
             COMPUTE  LNK-SYU-SKYMONEY  =
                      LNK-SYU-SKYMONEY  /   10
             COMPUTE  LNK-SYU-SKYMONEY  =
                      LNK-SYU-SKYMONEY  *   10
             ADD     WK-OITA-CYOFTN-KON  TO  LNK-SYU-SKYMONEY
                                             WK-KNJFTNKIN
                                             WK-KNJFTNKIN-ENTANI
             MOVE    1                   TO  FLG-KOUGAKUCYO-OITA
           END-IF
      *
           .
      *
       230742-OITA-TOKUSYU-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *    設定が１又は２の場合の編集
      ******************************************************************
       230743-OITA-TOKUSYU-HENSYU3-SEC         SECTION.
      *
           IF   FLG-OITA-SYUKEI  =  1
             COMPUTE  WK-KOUREI-IRYOHI70  =
                      WK-KOUREI-IRYOHI70  +
                     (LNK-SYU-HKNTEN(17)  * 10)
           END-IF
      *
           IF   FLG-TOKU75  =  3
             IF   (FLG-IRYOHI70          =   ZERO)
             AND  (FLG-KOHYONKAIME       =    1  )
             AND  (WK-2010-NINJYOKBN(1)  =   "2" )
               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                  WHEN      11
                   MOVE   70050  TO  WK-OITA-KEISAN2
                   MOVE   22200  TO  WK-OITA-KEISAN3
                  WHEN      12
                   MOVE   46500  TO  WK-OITA-KEISAN2
                   MOVE   22200  TO  WK-OITA-KEISAN3
                 END-EVALUATE
               ELSE
                   MOVE   41700  TO  WK-OITA-KEISAN2
                   MOVE   22200  TO  WK-OITA-KEISAN3
               END-IF
             ELSE
               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                  WHEN      11
                   MOVE  126300  TO  WK-OITA-KEISAN2
                   MOVE   40050  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  421000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 421000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
                  WHEN      12
                   MOVE   83700  TO  WK-OITA-KEISAN2
                   MOVE   40050  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  279000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 279000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
                 END-EVALUATE
               ELSE
                   MOVE   75000  TO  WK-OITA-KEISAN2
                   MOVE   40050  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  250000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 250000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
               END-IF
               IF  WK-KOUREI-IRYOHI70  >  133500
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 133500)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN3 =
                             WK-OITA-KEISAN3 +
                             WK-KOUREI-IRYOHI70X
               END-IF
             END-IF
           ELSE
             IF   (FLG-IRYOHI70          =   ZERO)
             AND  (FLG-KOHYONKAIME       =    1  )
             AND  (WK-2010-NINJYOKBN(1)  =   "2" )
               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                  WHEN      11
                   MOVE  140100  TO  WK-OITA-KEISAN2
                   MOVE   44400  TO  WK-OITA-KEISAN3
                  WHEN      12
                   MOVE   93000  TO  WK-OITA-KEISAN2
                   MOVE   44400  TO  WK-OITA-KEISAN3
                 END-EVALUATE
               ELSE
                   MOVE   83400  TO  WK-OITA-KEISAN2
                   MOVE   44400  TO  WK-OITA-KEISAN3
               END-IF
             ELSE
               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                  WHEN      11
                   MOVE  252600  TO  WK-OITA-KEISAN2
                   MOVE   80100  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  842000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 842000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
                  WHEN      12
                   MOVE  167400  TO  WK-OITA-KEISAN2
                   MOVE   80100  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  558000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 558000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
                 END-EVALUATE
               ELSE
                   MOVE  150000  TO  WK-OITA-KEISAN2
                   MOVE   80100  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  500000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 500000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
               END-IF
               IF  WK-KOUREI-IRYOHI70  >  267000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 267000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN3 =
                             WK-OITA-KEISAN3 +
                             WK-KOUREI-IRYOHI70X
               END-IF
             END-IF
           END-IF
      *
           COMPUTE  WK-KOUREI-IRYOHI70         =
                    WK-KOUREI-IRYOHI70         -
                    WK-KOUREI-IRYOHI70-JYOGAI
      *
           COMPUTE  WK-FUTANWARI    =  WK-KOH-FTNRATE  /  100
           COMPUTE  WK-OITA-KEISAN  =  WK-KOUREI-IRYOHI70
                                    *  WK-FUTANWARI
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  +    5
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  /   10
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  *   10
      *
           COMPUTE  WK-OITA-KEISAN       =
                    WK-OITA-KEISAN       +
                    WK-OITA-HKNFTNMONEY
      *
           IF   WK-OITA-KEISAN   <  WK-OITA-KEISAN2
               MOVE   WK-OITA-KEISAN   TO   WK-OITA-KEISAN2
           END-IF
      ***  IF   WK-OITA-KEISAN   <  WK-OITA-KEISAN3
      ***      MOVE   WK-OITA-KEISAN   TO   WK-OITA-KEISAN3
      ***  END-IF
           IF   WK-OITA-KEISAN2  >  WK-OITA-KEISAN3
             COMPUTE   WK-OITA-CYOFTN-KON = WK-OITA-KEISAN2
                                          - WK-OITA-KEISAN3
             IF   WK-OITA-CYOFTN-KON  >  WK-OITA-CYOFTN
               COMPUTE WK-OITA-CYOFTN-KON = WK-OITA-CYOFTN-KON
                                          - WK-OITA-CYOFTN
             ELSE
               MOVE    ZERO            TO   WK-OITA-CYOFTN-KON
             END-IF
           END-IF
      *
           .
      *
       230743-OITA-TOKUSYU-HENSYU3-EXT.
           EXIT.
      *
      ******************************************************************
      *    現物給付に関する対象データフラグ編集
      ******************************************************************
       23075-GENBUTU-TAISYODATA-SEC         SECTION.
      *
           IF  (FLG-GENBUTU70       NOT =   ZERO  )
           AND (FLG-GENBUTU-TAISYODATA  =    1    )
           AND (FLG-OITA-GENBUTU70      =   ZERO  )
           AND (LNK-SYU-SRYYMD(1:6)    >= "201204")
             IF  (COMB-KOH1HKNNUM   =  SPACE
                                    OR "970")
             AND (COMB-KOH2HKNNUM   =  SPACE)
             AND (COMB-KOH3HKNNUM   =  SPACE)
             AND (COMB-KOH4HKNNUM   =  SPACE)
                MOVE    "9"    TO    LNK-SYU-KOHTAIYKZKBN
             END-IF
           END-IF
      *
           .
      *
       23075-GENBUTU-TAISYODATA-EXT.
           EXIT.
      *
      ******************************************************************
      *    現物給付に関するメッセージフラグ編集
      ******************************************************************
       23076-GENBUTU-MSG-HENSYU-SEC         SECTION.
      *
           IF ((FLG-GENBUTU70           NOT =   ZERO ) AND
               (FLG-OITA-GENBUTU70          =   ZERO ))
           OR ((LNK-S01-KOUREI-ZAITAKU-KBN  =   "1"  ) AND
               (COMB-HKNNUM             NOT =   SPACE))
             CONTINUE
           ELSE
             MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-MSG
           END-IF
      *
           IF  (WK-SYUNOU-GENBUTU70-MSG  NOT =  ZERO   )
           AND (LNK-S01-IKTGENKEIFLG         =  SPACE  )
           AND (LNK-S01-IKTJISSIFLG          =  SPACE  )
           AND (LNK-SYU-SRYYMD(1:6)         >= "201204")
             IF  (LNK-S01-SAIKEISAN-KBN           = "1"    )
             AND (WK-SYUNOU-GENBUTU-SECMONEY-MAE  =  9     )
             AND (LNK-SYU-TOTAL-HKNTEN  =
                             WK-SYUNOU-GENBUTU-TOTALTEN-MAE)
                  MOVE     9    TO   LNK-SYU-SECMONEY
             END-IF
           END-IF
      *
           IF  (WK-SYUNOU-GENBUTU70-MSG  NOT =  ZERO   )
           AND (LNK-S01-IKTGENKEIFLG         =  SPACE  )
           AND (LNK-S01-IKTJISSIFLG          =  SPACE  )
           AND (LNK-SYU-SRYYMD(1:6)         >= "201204")
             IF   ( WK-GENGAKUKBN  =  3  OR  4                )
             OR   ((LNK-S01-SAIKEISAN-KBN           = "1"    ) AND
                   (WK-SYUNOU-GENBUTU-SECMONEY-MAE  =  9     ) AND
                   (LNK-SYU-TOTAL-HKNTEN  =
                               WK-SYUNOU-GENBUTU-TOTALTEN-MAE))
               CONTINUE
             ELSE
               MOVE    ZERO    TO   WK-GENBUTU-SKYMONEY
               IF   FLG-KUMAMOTO           =   "1"
               OR   COMB-SYU-HKNKOHSBTKBN  =   "8"
               OR   FLG-KOUGAKUCYO         =    1
               OR   FLG-KOUGAKUCYO2        =    1
               OR   FLG-KOUGAKUCYO3        =    1
               OR   FLG-KOUGAKUCYO-JIRITU  =    1
               OR   FLG-KOUGAKUCYO-ININ    =    1
               OR   FLG-KOUGAKUCYO-GEN70   =    1
               OR   FLG-KOUGAKUCYO-GEN70K  =    1
               OR   FLG-KOUGAKUCYO-OITA    =    1
               OR   FLG-FTNGAKEN           =    1
               OR   COMB-SYU-HKNKOHSBTKBN  =   "9"
                 MOVE    LNK-SYU-SKYMONEY  TO  WK-GENBUTU-SKYMONEY
               ELSE
                 COMPUTE WK-GENBUTU-SKYMONEY = LNK-SYU-SKYMONEY    +  5
                 COMPUTE WK-GENBUTU-SKYMONEY = WK-GENBUTU-SKYMONEY / 10
                 COMPUTE WK-GENBUTU-SKYMONEY = WK-GENBUTU-SKYMONEY * 10
               END-IF
      *
               EVALUATE  WK-SYUNOU-GENBUTU70-MSG
                 WHEN       1
                     IF  ( WK-SYUNOU-GENBUTU-JGNFLG  =  1    )
                     OR  ((COMB-KOH1HKNNUM  = "972" OR "974") AND
                          (COMB-KOH2HKNNUM  = SPACE         ) AND
                          (COMB-KOH3HKNNUM  = SPACE         ) AND
                          (COMB-KOH4HKNNUM  = SPACE         ))
                       MOVE       "1"   TO   LNK-S01-GENBUTU-MSG-FLG
                       MOVE        1    TO   LNK-SYU-SECMONEY
                     ELSE
                       PERFORM    230761-GENBUTU-MSG-CHECK-SEC
                       PERFORM    230763-GENBUTU-MSG-CHECK3-SEC
                     END-IF
                 WHEN       2
                     IF    WK-SYUNOU-GENBUTU-JGNFLG  =  1
                       IF   LNK-SYU-SRYYMD(1:6)   >= "201205"
                         PERFORM    230761-GENBUTU-MSG-CHECK-SEC
                         MOVE       ZERO  TO   FLG-GENBUTU-OK
                         PERFORM    230762-GENBUTU-MSG-CHECK2-SEC
                         IF  LNK-S01-SAIKEISAN-KBN  = "1"
                           IF  FLG-GENBUTU-OK  =  1
                                 MOVE  "1"  TO  LNK-S01-GENBUTU-MSG-FLG
                                 MOVE   1   TO  LNK-SYU-SECMONEY
                           ELSE
                             EVALUATE  WK-SYUNOU-GENBUTU-SECMONEY-MAE
                              WHEN     1
                              WHEN     3
                              WHEN     4
                              WHEN     9
                                 MOVE  "1"  TO  LNK-S01-GENBUTU-MSG-FLG
                                 MOVE   3   TO  LNK-SYU-SECMONEY
                             END-EVALUATE
                           END-IF
                         ELSE
                           IF  FLG-GENBUTU-OK  =  1
                                 MOVE  "1"  TO  LNK-S01-GENBUTU-MSG-FLG
                                 MOVE   1   TO  LNK-SYU-SECMONEY
                           END-IF
                         END-IF
                       ELSE
                                 MOVE  "1"  TO  LNK-S01-GENBUTU-MSG-FLG
                                 MOVE   1   TO  LNK-SYU-SECMONEY
                       END-IF
                     ELSE
                       PERFORM    230761-GENBUTU-MSG-CHECK-SEC
                       MOVE       ZERO  TO   FLG-GENBUTU-OK
                       PERFORM    230762-GENBUTU-MSG-CHECK2-SEC
                       IF  FLG-GENBUTU-OK  =  1
                         PERFORM  230763-GENBUTU-MSG-CHECK3-SEC
                       END-IF
                     END-IF
                 WHEN       3
                     IF  ( WK-SYUNOU-GENBUTU-JGNFLG  =  1    )
                     OR  ((COMB-KOH1HKNNUM  = "972" OR "974") AND
                          (COMB-KOH2HKNNUM  = SPACE         ) AND
                          (COMB-KOH3HKNNUM  = SPACE         ) AND
                          (COMB-KOH4HKNNUM  = SPACE         ))
                       MOVE       "1"   TO   LNK-S01-GENBUTU-MSG-FLG
                       MOVE        2    TO   LNK-SYU-SECMONEY
                     ELSE
                       ADD    WK-GENBUTU-SKYMONEY  TO
                                  WK-SYUNOU-GENBUTU-KR-SKYMONEY
                       IF   (COMB-KOH2HKNNUM  =  SPACE)
                       AND  (COMB-KOH3HKNNUM  =  SPACE)
                       AND  (COMB-KOH4HKNNUM  =  SPACE)
                         ADD  WK-GENBUTU-SKYMONEY  TO
                                  WK-SYUNOU-GENBUTU-KR-SKYMONEY2
                       ELSE
      ***                ADD  LNK-SYU-KOH1COMPFTN  TO
                         ADD  LNK-SYU-KOH1HKNFTNMONEY  TO
                                  WK-SYUNOU-GENBUTU-KR-SKYMONEY2
                       END-IF
                       IF  (WK-GENBUTU-SYUMAXKIN  <=
                                WK-SYUNOU-GENBUTU-KR-SKYMONEY )
                       OR  (WK-GENBUTU-SYUMAXKIN  <=
                                WK-SYUNOU-GENBUTU-KR-SKYMONEY2)
                         MOVE     "1"   TO   LNK-S01-GENBUTU-MSG-FLG
                         MOVE      2    TO   LNK-SYU-SECMONEY
                       END-IF
                     END-IF
                 WHEN       4
                       MOVE       "1"   TO   LNK-S01-GENBUTU-MSG-FLG
                       MOVE        4    TO   LNK-SYU-SECMONEY
                 WHEN       5
                       MOVE       "1"   TO   LNK-S01-GENBUTU-MSG-FLG
                       MOVE        1    TO   LNK-SYU-SECMONEY
                 WHEN       6
                       MOVE       "1"   TO   LNK-S01-GENBUTU-MSG-FLG
                       MOVE        2    TO   LNK-SYU-SECMONEY
               END-EVALUATE
      *
             END-IF
           END-IF
      *
           IF ((FLG-GENBUTU70           NOT =   ZERO ) AND
               (FLG-OITA-GENBUTU70          =   ZERO ))
           OR ((LNK-S01-KOUREI-ZAITAKU-KBN  =   "1"  ) AND
               (COMB-HKNNUM             NOT =   SPACE))
             IF  (COMB-KOH1HKNNUM         =  "970"   )
             AND (COMB-KOH2HKNNUM         =  SPACE   )
             AND (COMB-KOH3HKNNUM         =  SPACE   )
             AND (COMB-KOH4HKNNUM         =  SPACE   )
             AND (LNK-S01-DAISANYUSENFLG  =  "1"     )
             AND (LNK-S01-IKTGENKEIFLG    =  SPACE   )
             AND (LNK-S01-IKTJISSIFLG     =  SPACE   )
             AND (LNK-SYU-SRYYMD(1:6)    >=  "201204")
               IF  WK-GENGAKUKBN  =  3 OR 4
                 CONTINUE
               ELSE
                 MOVE   "1"   TO   LNK-S01-GENBUTU-MSG-FLG
                 MOVE    6    TO   LNK-SYU-SECMONEY
               END-IF
             END-IF
           END-IF
      *
           IF  (LNK-S01-IKTGENKEIFLG         = "1"     )
           AND (LNK-SYU-SRYYMD(1:6)         >= "201205")
             IF ((FLG-GENBUTU70           NOT =   ZERO ) AND
                 (FLG-OITA-GENBUTU70          =   ZERO ))
             OR ((LNK-S01-KOUREI-ZAITAKU-KBN  =   "1"  ) AND
                 (COMB-HKNNUM             NOT =   SPACE))
               IF   WK-SYUNOU-GENBUTU-SECMONEY-MAE  =
                                          1 OR 2 OR 4 OR 9
                  MOVE     9    TO   LNK-SYU-SECMONEY
               END-IF
             END-IF
           END-IF
      *
           .
      *
       23076-GENBUTU-MSG-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    現物給付に関するメッセージフラグ編集チェック
      ******************************************************************
       230761-GENBUTU-MSG-CHECK-SEC         SECTION.
      *
           MOVE     ZERO      TO     FLG-HANBETU
           PERFORM VARYING IDX13  FROM   1   BY   1
                    UNTIL (IDX13   >    50                       )
                     OR   (WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                                                          = SPACE)
             IF    LNK-SYU-HKNCOMBINUM =
                         WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
               ADD   LNK-SYU-TOTAL-HKNTEN  TO
                           WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
               ADD   LNK-SYU-KOH1COMPFTN   TO
                           WK-SYUNOU-GENBUTU70-KOH1COMPFTN(IDX13)
               ADD   LNK-SYU-KOH2COMPFTN   TO
                           WK-SYUNOU-GENBUTU70-KOH2COMPFTN(IDX13)
               ADD   LNK-SYU-KOH3COMPFTN   TO
                           WK-SYUNOU-GENBUTU70-KOH3COMPFTN(IDX13)
               ADD   LNK-SYU-KOH4COMPFTN   TO
                           WK-SYUNOU-GENBUTU70-KOH4COMPFTN(IDX13)
               ADD   WK-GENBUTU-SKYMONEY   TO
                           WK-SYUNOU-GENBUTU70-SKYMONEY(IDX13)
               IF    LNK-SYU-SKJ-FTNGAKU(3) =  9
                  MOVE     9               TO
                           WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13)
               ELSE
                  MOVE     ZERO            TO
                           WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13)
               END-IF
               MOVE  1                 TO  FLG-HANBETU
               MOVE  50                TO  IDX13
             END-IF
           END-PERFORM
           IF   FLG-HANBETU   =   ZERO
               MOVE  LNK-SYU-HKNCOMBINUM   TO
                           WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
               ADD   LNK-SYU-TOTAL-HKNTEN  TO
                           WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
               MOVE  LNK-SYU-SYUHKNNUM     TO
                           WK-SYUNOU-GENBUTU70-SYUHKNNUM(IDX13)
               MOVE  LNK-SYU-KOH1HKNNUM    TO
                           WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13)
               ADD   LNK-SYU-KOH1COMPFTN   TO
                           WK-SYUNOU-GENBUTU70-KOH1COMPFTN(IDX13)
               MOVE  LNK-SYU-KOH2HKNNUM    TO
                           WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13)
               ADD   LNK-SYU-KOH2COMPFTN   TO
                           WK-SYUNOU-GENBUTU70-KOH2COMPFTN(IDX13)
               MOVE  LNK-SYU-KOH3HKNNUM    TO
                           WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13)
               ADD   LNK-SYU-KOH3COMPFTN   TO
                           WK-SYUNOU-GENBUTU70-KOH3COMPFTN(IDX13)
               MOVE  LNK-SYU-KOH4HKNNUM    TO
                           WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13)
               ADD   LNK-SYU-KOH4COMPFTN   TO
                           WK-SYUNOU-GENBUTU70-KOH4COMPFTN(IDX13)
               ADD   WK-GENBUTU-SKYMONEY   TO
                           WK-SYUNOU-GENBUTU70-SKYMONEY(IDX13)
               IF    LNK-SYU-SKJ-FTNGAKU(3) =  9
                  MOVE     9               TO
                           WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13)
               ELSE
                  MOVE     ZERO            TO
                           WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13)
               END-IF
           END-IF
      *
           .
      *
       230761-GENBUTU-MSG-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *    現物給付に関するメッセージフラグ編集チェック２
      ******************************************************************
       230762-GENBUTU-MSG-CHECK2-SEC         SECTION.
      *
      *    公費併用分の計算
           PERFORM   VARYING   IDX13   FROM   1   BY   1
                      UNTIL   (IDX13     >   50                      )
                        OR    (WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                                                              = SPACE)
             IF    LNK-SYU-HKNCOMBINUM =
                         WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
               COMPUTE  WK-FUTANWARI  =  WK-SYUNOU-GENBUTU70-FTNRATE
                                      /  100
               COMPUTE  WK-SYUNOU-GENBUTU70-KEISAN
                          =  WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
                          *  10
                          *  WK-FUTANWARI
               IF ((WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH1COMPFTN(IDX13)
                                       NOT = ZERO           ))
               OR ((WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH2COMPFTN(IDX13)
                                       NOT = ZERO           ))
               OR ((WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH3COMPFTN(IDX13)
                                       NOT = ZERO           ))
               OR ((WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH4COMPFTN(IDX13)
                                       NOT = ZERO           ))
                 IF  FLG-TOKU75  =  3
                   IF  WK-SYUNOU-GENBUTU70-KEISAN >= 10500
                     MOVE     1    TO
                                  WK-SYUNOU-GENBUTU70-HANTEIFLG(IDX13)
                     MOVE     1    TO   FLG-GENBUTU-OK
                   END-IF
                 ELSE
                   IF  WK-SYUNOU-GENBUTU70-KEISAN >= 21000
                     MOVE     1    TO
                                  WK-SYUNOU-GENBUTU70-HANTEIFLG(IDX13)
                     MOVE     1    TO   FLG-GENBUTU-OK
                   END-IF
                 END-IF
               END-IF
               MOVE         50     TO   IDX13
             END-IF
           END-PERFORM
      *
           .
      *
       230762-GENBUTU-MSG-CHECK2-EXT.
           EXIT.
      *
      ******************************************************************
      *    現物給付に関するメッセージフラグ編集チェック３
      ******************************************************************
       230763-GENBUTU-MSG-CHECK3-SEC         SECTION.
      *
           MOVE      ZERO      TO  WK-GENBUTU-FTNKIN
      *
      *    主保険単独分
            ADD   WK-SYUNOU-GENBUTU70T-SKYMONEY
                               TO  WK-GENBUTU-FTNKIN
      *
      *    公費併用分
           PERFORM   VARYING   IDX13   FROM   1   BY   1
                      UNTIL   (IDX13     >   50                      )
                        OR    (WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                                                              = SPACE)
             IF ((WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13) =
                                                  "972" OR "974") AND
                 (WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13) =  SPACE) AND
                 (WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13) =  SPACE) AND
                 (WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13) =  SPACE))
             OR ( WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13)  =   9    )
                 ADD   WK-SYUNOU-GENBUTU70-SKYMONEY(IDX13)
                               TO  WK-GENBUTU-FTNKIN
             ELSE
               IF   WK-SYUNOU-GENBUTU70-HANTEIFLG(IDX13) =  1
                 ADD   WK-SYUNOU-GENBUTU70-SKYMONEY(IDX13)
                               TO  WK-GENBUTU-FTNKIN
               END-IF
             END-IF
           END-PERFORM
      *
           IF  WK-GENBUTU-SYUMAXKIN  <  WK-GENBUTU-FTNKIN
             MOVE    "1"       TO   LNK-S01-GENBUTU-MSG-FLG
             MOVE     1        TO   LNK-SYU-SECMONEY
           END-IF
      *
           .
      *
       230763-GENBUTU-MSG-CHECK3-EXT.
           EXIT.
      *
      ******************************************************************
      *        大阪府地方公費＋長期の地方公費残額置き換え
      ******************************************************************
       2308-ZANOKIKAE-HENSYU-SEC           SECTION.
      *
           IF  (WK-2010-CYOKEIKBN-G(1) NOT = SPACE)
           AND ((MAX-KIN-KOHI1-D    NOT =  ZERO  ) OR
                (MAX-KIN-KOHI1-K    NOT =  ZERO  ))
                   PERFORM    23081-ZANOKIKAE-HENSYU1-SEC
           END-IF
           IF  (WK-2010-CYOKEIKBN-G(2) NOT = SPACE)
           AND ((MAX-KIN-KOHI2-D    NOT =  ZERO  ) OR
                (MAX-KIN-KOHI2-K    NOT =  ZERO  ))
              IF   WK-2010-CYOKEIKBN-G(2)  =  "3" OR "4"
                IF    COMB-KOH1HKNNUM    =  "015" OR "016"
                   CONTINUE
                ELSE
                   PERFORM    23082-ZANOKIKAE-HENSYU2-SEC
                END-IF
              ELSE
                   PERFORM    23082-ZANOKIKAE-HENSYU2-SEC
              END-IF
           END-IF
           IF  (WK-2010-CYOKEIKBN-G(3) NOT = SPACE)
           AND ((MAX-KIN-KOHI3-D    NOT =  ZERO  ) OR
                (MAX-KIN-KOHI3-K    NOT =  ZERO  ))
              IF   WK-2010-CYOKEIKBN-G(3)  =  "3" OR "4"
                IF   (COMB-KOH1HKNNUM    =  "015" OR "016")
                OR   (COMB-KOH2HKNNUM    =  "015" OR "016")
                   CONTINUE
                ELSE
                   PERFORM    23083-ZANOKIKAE-HENSYU3-SEC
                END-IF
              ELSE
                   PERFORM    23083-ZANOKIKAE-HENSYU3-SEC
              END-IF
           END-IF
      *
           PERFORM   VARYING   IDX19   FROM   1   BY   1
                      UNTIL    IDX19    >     4
              IF   WK-GNBKEIKBN-K-KBN(IDX19)  NOT =  ZERO
                 INITIALIZE                         HKNNUM-REC
                 MOVE   COMB-HOSPNUM          TO    HKN-HOSPNUM
                 MOVE   COMB-KOHHKNNUM(IDX19) TO    HKN-HKNNUM
                 MOVE   "00"                  TO    WK-PAYKBN
                 MOVE   HKNNUM-REC            TO    MCPDATA-REC
                 MOVE   "DBSELECT"            TO    MCP-FUNC
                 MOVE   "tbl_hknnum"          TO    MCP-TABLE
                 MOVE   "key2"                TO    MCP-PATHNAME
                 CALL   "ORCDBMAIN"           USING MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                 IF      MCP-RC               =     ZERO
                   MOVE    "tbl_hknnum"       TO    MCP-TABLE
                   MOVE    "key2"             TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL
                    ( FLG-HKNNUM           =  1                   ) OR
                    ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6)  ) AND
                     (WK-PAYKBN            =  HKN-PAYKBN         ))
                       MOVE     "tbl_hknnum"  TO    MCP-TABLE
                       MOVE     "key2"        TO    MCP-PATHNAME
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                 END-IF
                 MOVE      "tbl_hknnum"       TO    MCP-TABLE
                 MOVE      "key2"             TO    MCP-PATHNAME
                 PERFORM    DB-CLOSE-SEC
      *
                 IF    LNK-SYU-SRYYMD(1:6)  >=  "201808"
                     EVALUATE  WK-GNBKEIKBN-K-KBN(IDX19)
                       WHEN       1
                         EVALUATE   FLG-KOUREI-GENEKIKBN
                           WHEN       1
                             MOVE     252600   TO   WK-HIKAKU-KINGAKU
                             IF  FLG-KOHYONKAIME = 1
                                MOVE  140100   TO   WK-HIKAKU-KINGAKU
                             END-IF
                           WHEN       2
                             MOVE     167400   TO   WK-HIKAKU-KINGAKU
                             IF  FLG-KOHYONKAIME = 1
                                MOVE   93000   TO   WK-HIKAKU-KINGAKU
                             END-IF
                           WHEN       3
                             MOVE      80100   TO   WK-HIKAKU-KINGAKU
                             IF  FLG-KOHYONKAIME = 1
                                MOVE   44400   TO   WK-HIKAKU-KINGAKU
                             END-IF
                         END-EVALUATE
                       WHEN       2
                         MOVE    18000    TO    WK-HIKAKU-KINGAKU
                       WHEN       3
                         MOVE     8000    TO    WK-HIKAKU-KINGAKU
                     END-EVALUATE
                 ELSE
                   IF  LNK-SYU-SRYYMD(1:6)  >=  "201708"
                     EVALUATE  WK-GNBKEIKBN-K-KBN(IDX19)
                       WHEN       1
                         MOVE    57600    TO    WK-HIKAKU-KINGAKU
                       WHEN       2
                         MOVE    14000    TO    WK-HIKAKU-KINGAKU
                       WHEN       3
                         MOVE     8000    TO    WK-HIKAKU-KINGAKU
                     END-EVALUATE
                   ELSE
                     EVALUATE  WK-GNBKEIKBN-K-KBN(IDX19)
                       WHEN       1
                         MOVE    44400    TO    WK-HIKAKU-KINGAKU
                       WHEN       2
                         MOVE    12000    TO    WK-HIKAKU-KINGAKU
                       WHEN       3
                         MOVE     8000    TO    WK-HIKAKU-KINGAKU
                     END-EVALUATE
                   END-IF
                 END-IF
                 IF    FLG-TOKU75  =  1 OR 2
                   COMPUTE  WK-HIKAKU-KINGAKU  =
                            WK-HIKAKU-KINGAKU  /  2
                 END-IF
                 IF   WK-GNBKEIKBN-K-KIN(IDX19) > WK-HIKAKU-KINGAKU
                     MOVE   ZERO   TO  ZAN-KOHI-T(IDX19)
                 ELSE
                     COMPUTE WK-TOTAL-KINGAKU3 =
                             WK-HIKAKU-KINGAKU -
                             WK-GNBKEIKBN-K-KIN(IDX19)
                     IF  WK-TOTAL-KINGAKU3 < ZAN-KOHI-T(IDX19)
                       MOVE  WK-TOTAL-KINGAKU3 TO ZAN-KOHI-T(IDX19)
                     END-IF
                 END-IF
                 IF   HKN-RECEFTNDSPKBN   =  "2"
                   IF WK-GNBKEIKBN-K-KIN-EN(IDX19)
                                                > WK-HIKAKU-KINGAKU
                     MOVE   ZERO   TO  ZAN-KOHI-T2(IDX19)
                   ELSE
                     COMPUTE WK-TOTAL-KINGAKU3 =
                             WK-HIKAKU-KINGAKU -
                             WK-GNBKEIKBN-K-KIN-EN(IDX19)
                     IF  WK-TOTAL-KINGAKU3 < ZAN-KOHI-T2(IDX19)
                       MOVE  WK-TOTAL-KINGAKU3 TO ZAN-KOHI-T2(IDX19)
                     END-IF
                   END-IF
                 ELSE
                   IF WK-GNBKEIKBN-K-KIN(IDX19) > WK-HIKAKU-KINGAKU
                     MOVE   ZERO   TO  ZAN-KOHI-T2(IDX19)
                   ELSE
                     COMPUTE WK-TOTAL-KINGAKU3 =
                             WK-HIKAKU-KINGAKU -
                             WK-GNBKEIKBN-K-KIN(IDX19)
                     IF  WK-TOTAL-KINGAKU3 < ZAN-KOHI-T2(IDX19)
                       MOVE  WK-TOTAL-KINGAKU3 TO ZAN-KOHI-T2(IDX19)
                     END-IF
                   END-IF
                 END-IF
                 IF   WK-GNBKEIKBN-K-KIN-EN(IDX19)
                                                > WK-HIKAKU-KINGAKU
                     MOVE   ZERO   TO  ZAN-KOHI-T3(IDX19)
                 ELSE
                     COMPUTE WK-TOTAL-KINGAKU3 =
                             WK-HIKAKU-KINGAKU -
                             WK-GNBKEIKBN-K-KIN-EN(IDX19)
                     IF  WK-TOTAL-KINGAKU3 < ZAN-KOHI-T3(IDX19)
                       MOVE  WK-TOTAL-KINGAKU3 TO ZAN-KOHI-T3(IDX19)
                     END-IF
                 END-IF
              END-IF
           END-PERFORM
      *
           IF   WK-GNBKEIKBN-K-KBN(5)  NOT =  ZERO
           AND  WK-GNBKEIKBN-K-FLG(5)      =   1
              IF    LNK-SYU-SRYYMD(1:6)  >=  "201808"
                  EVALUATE  WK-GNBKEIKBN-K-KBN(5)
                    WHEN       1
                      EVALUATE   FLG-KOUREI-GENEKIKBN
                        WHEN       1
                          MOVE     252600   TO   WK-HIKAKU-KINGAKU
                          IF  FLG-KOHYONKAIME = 1
                             MOVE  140100   TO   WK-HIKAKU-KINGAKU
                          END-IF
                        WHEN       2
                          MOVE     167400   TO   WK-HIKAKU-KINGAKU
                          IF  FLG-KOHYONKAIME = 1
                             MOVE   93000   TO   WK-HIKAKU-KINGAKU
                          END-IF
                        WHEN       3
                          MOVE      80100   TO   WK-HIKAKU-KINGAKU
                          IF  FLG-KOHYONKAIME = 1
                             MOVE   44400   TO   WK-HIKAKU-KINGAKU
                          END-IF
                      END-EVALUATE
                    WHEN       2
                      MOVE    18000    TO    WK-HIKAKU-KINGAKU
                    WHEN       3
                      MOVE     8000    TO    WK-HIKAKU-KINGAKU
                  END-EVALUATE
              ELSE
                IF  LNK-SYU-SRYYMD(1:6)  >=  "201708"
                  EVALUATE  WK-GNBKEIKBN-K-KBN(5)
                    WHEN       1
                      MOVE    57600    TO    WK-HIKAKU-KINGAKU
                    WHEN       2
                      MOVE    14000    TO    WK-HIKAKU-KINGAKU
                    WHEN       3
                      MOVE     8000    TO    WK-HIKAKU-KINGAKU
                  END-EVALUATE
                ELSE
                  EVALUATE  WK-GNBKEIKBN-K-KBN(5)
                    WHEN       1
                      MOVE    44400    TO    WK-HIKAKU-KINGAKU
                    WHEN       2
                      MOVE    12000    TO    WK-HIKAKU-KINGAKU
                    WHEN       3
                      MOVE     8000    TO    WK-HIKAKU-KINGAKU
                  END-EVALUATE
                END-IF
              END-IF
              IF    FLG-TOKU75  =  1 OR 2
                COMPUTE  WK-HIKAKU-KINGAKU  =
                         WK-HIKAKU-KINGAKU  /  2
              END-IF
              IF  WK-GNBKEIKBN-K-KIN(5) >  WK-HIKAKU-KINGAKU
                  MOVE     ZERO    TO    ZAN-SYU-M
              ELSE
                  COMPUTE WK-TOTAL-KINGAKU3 =
                          WK-HIKAKU-KINGAKU -
                          WK-GNBKEIKBN-K-KIN(5)
                  IF  WK-TOTAL-KINGAKU3 < ZAN-SYU-M
                    MOVE  WK-TOTAL-KINGAKU3  TO  ZAN-SYU-M
                  END-IF
              END-IF
              IF   WK-GNBKEIKBN-K-KIN-EN(5) >  WK-HIKAKU-KINGAKU
                  MOVE     ZERO    TO    ZAN-SYU-M-ENTANI
              ELSE
                  COMPUTE WK-TOTAL-KINGAKU3 =
                          WK-HIKAKU-KINGAKU -
                          WK-GNBKEIKBN-K-KIN-EN(5)
                  IF  WK-TOTAL-KINGAKU3 < ZAN-SYU-M-ENTANI
                    MOVE  WK-TOTAL-KINGAKU3  TO  ZAN-SYU-M-ENTANI
                  END-IF
              END-IF
           END-IF
      *
           .
      *
       2308-ZANOKIKAE-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    置き換え編集１
      ******************************************************************
       23081-ZANOKIKAE-HENSYU1-SEC           SECTION.
      *
           IF   FLG-TOKU75 = 1 OR 2
             MOVE     1000    TO   WK-CYOKI-HIKAKU9
           ELSE
             MOVE     2000    TO   WK-CYOKI-HIKAKU9
           END-IF
      *
           IF   COMB-KOH2HKNNUM  =  "972" OR "974"
      *       低所の場合は残から２０００円又は１０００円を引く
              IF   (LNK-S01-KOUREI-ZAITAKU-KBN    =   "1" )
              AND  (FLG-SANSHOU3              NOT =  SPACE)
              AND  (COMB-KOH2HKNNUM               =  "972")
              AND  (WK-2010-CYOKEIKBN-G(1)  =  "2" OR "4" )
                 IF   ZAN-KOHI2   >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU1 = ZAN-KOHI2
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU1
                 END-IF
                 IF   ZAN-KOHI22  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU2 = ZAN-KOHI22
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU2
                 END-IF
                 IF   ZAN-KOHI23  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU3 = ZAN-KOHI23
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU3
                 END-IF
              ELSE
                 MOVE   ZAN-KOHI2   TO   WK-CYOKI-HIKAKU1
                 MOVE   ZAN-KOHI22  TO   WK-CYOKI-HIKAKU2
                 MOVE   ZAN-KOHI23  TO   WK-CYOKI-HIKAKU3
              END-IF
           END-IF
           IF   COMB-KOH3HKNNUM  =  "972" OR "974"
      *       低所の場合は残から２０００円又は１０００円を引く
              IF   (LNK-S01-KOUREI-ZAITAKU-KBN    =   "1" )
              AND  (FLG-SANSHOU3              NOT =  SPACE)
              AND  (COMB-KOH3HKNNUM               =  "972")
              AND  (WK-2010-CYOKEIKBN-G(1)  =  "2" OR "4" )
                 IF   ZAN-KOHI3   >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU1 = ZAN-KOHI3
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU1
                 END-IF
                 IF   ZAN-KOHI32  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU2 = ZAN-KOHI32
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU2
                 END-IF
                 IF   ZAN-KOHI33  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU3 = ZAN-KOHI33
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU3
                 END-IF
              ELSE
                 MOVE   ZAN-KOHI3   TO   WK-CYOKI-HIKAKU1
                 MOVE   ZAN-KOHI32  TO   WK-CYOKI-HIKAKU2
                 MOVE   ZAN-KOHI33  TO   WK-CYOKI-HIKAKU3
              END-IF
           END-IF
           IF   COMB-KOH4HKNNUM  =  "972" OR "974"
      *       低所の場合は残から２０００円又は１０００円を引く
              IF   (LNK-S01-KOUREI-ZAITAKU-KBN    =   "1" )
              AND  (FLG-SANSHOU3              NOT =  SPACE)
              AND  (COMB-KOH4HKNNUM               =  "972")
              AND  (WK-2010-CYOKEIKBN-G(1)  =  "2" OR "4" )
                 IF   ZAN-KOHI4   >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU1 = ZAN-KOHI4
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU1
                 END-IF
                 IF   ZAN-KOHI42  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU2 = ZAN-KOHI42
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU2
                 END-IF
                 IF   ZAN-KOHI43  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU3 = ZAN-KOHI43
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU3
                 END-IF
              ELSE
                 MOVE   ZAN-KOHI4   TO   WK-CYOKI-HIKAKU1
                 MOVE   ZAN-KOHI42  TO   WK-CYOKI-HIKAKU2
                 MOVE   ZAN-KOHI43  TO   WK-CYOKI-HIKAKU3
              END-IF
           END-IF
      *
           IF  (COMB-KOH2HKNNUM  =  "972" OR "974")
           OR  (COMB-KOH3HKNNUM  =  "972" OR "974")
           OR  (COMB-KOH4HKNNUM  =  "972" OR "974")
             IF   ZAN-KOHI1  >  WK-CYOKI-HIKAKU1
                 MOVE   WK-CYOKI-HIKAKU1   TO  ZAN-KOHI1
             END-IF
             IF   ZAN-KOHI12 >  WK-CYOKI-HIKAKU2
                 MOVE   WK-CYOKI-HIKAKU2   TO  ZAN-KOHI12
             END-IF
             IF   ZAN-KOHI13 >  WK-CYOKI-HIKAKU3
                 MOVE   WK-CYOKI-HIKAKU3   TO  ZAN-KOHI13
             END-IF
           END-IF
      *
           .
      *
       23081-ZANOKIKAE-HENSYU1-EXT.
           EXIT.
      *
      ******************************************************************
      *    置き換え編集２
      ******************************************************************
       23082-ZANOKIKAE-HENSYU2-SEC           SECTION.
      *
           IF   FLG-TOKU75 = 1 OR 2
             MOVE     1000    TO   WK-CYOKI-HIKAKU9
           ELSE
             MOVE     2000    TO   WK-CYOKI-HIKAKU9
           END-IF
      *
           IF   COMB-KOH3HKNNUM  =  "972" OR "974"
      *       低所の場合は残から２０００円又は１０００円を引く
              IF   (LNK-S01-KOUREI-ZAITAKU-KBN    =   "1" )
              AND  (FLG-SANSHOU3              NOT =  SPACE)
              AND  (COMB-KOH3HKNNUM               =  "972")
              AND  (WK-2010-CYOKEIKBN-G(2)  =  "2" OR "4" )
                 IF   ZAN-KOHI3   >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU1 = ZAN-KOHI3
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU1
                 END-IF
                 IF   ZAN-KOHI32  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU2 = ZAN-KOHI32
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU2
                 END-IF
                 IF   ZAN-KOHI33  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU3 = ZAN-KOHI33
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU3
                 END-IF
              ELSE
                 MOVE   ZAN-KOHI3   TO   WK-CYOKI-HIKAKU1
                 MOVE   ZAN-KOHI32  TO   WK-CYOKI-HIKAKU2
                 MOVE   ZAN-KOHI33  TO   WK-CYOKI-HIKAKU3
              END-IF
           END-IF
           IF   COMB-KOH4HKNNUM  =  "972" OR "974"
      *       低所の場合は残から２０００円又は１０００円を引く
              IF   (LNK-S01-KOUREI-ZAITAKU-KBN    =   "1" )
              AND  (FLG-SANSHOU3              NOT =  SPACE)
              AND  (COMB-KOH4HKNNUM               =  "972")
              AND  (WK-2010-CYOKEIKBN-G(2)  =  "2" OR "4" )
                 IF   ZAN-KOHI4   >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU1 = ZAN-KOHI4
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU1
                 END-IF
                 IF   ZAN-KOHI42  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU2 = ZAN-KOHI42
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU2
                 END-IF
                 IF   ZAN-KOHI43  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU3 = ZAN-KOHI43
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU3
                 END-IF
              ELSE
                 MOVE   ZAN-KOHI4   TO   WK-CYOKI-HIKAKU1
                 MOVE   ZAN-KOHI42  TO   WK-CYOKI-HIKAKU2
                 MOVE   ZAN-KOHI43  TO   WK-CYOKI-HIKAKU3
              END-IF
           END-IF
      *
           IF  (COMB-KOH3HKNNUM  =  "972" OR "974")
           OR  (COMB-KOH4HKNNUM  =  "972" OR "974")
             IF   ZAN-KOHI2  >  WK-CYOKI-HIKAKU1
                 MOVE   WK-CYOKI-HIKAKU1   TO  ZAN-KOHI2
             END-IF
             IF   ZAN-KOHI22 >  WK-CYOKI-HIKAKU2
                 MOVE   WK-CYOKI-HIKAKU2   TO  ZAN-KOHI22
             END-IF
             IF   ZAN-KOHI23 >  WK-CYOKI-HIKAKU3
                 MOVE   WK-CYOKI-HIKAKU3   TO  ZAN-KOHI23
             END-IF
           END-IF
      *
           .
      *
       23082-ZANOKIKAE-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *    置き換え編集３
      ******************************************************************
       23083-ZANOKIKAE-HENSYU3-SEC           SECTION.
      *
           IF   FLG-TOKU75 = 1 OR 2
             MOVE     1000    TO   WK-CYOKI-HIKAKU9
           ELSE
             MOVE     2000    TO   WK-CYOKI-HIKAKU9
           END-IF
      *
           IF   COMB-KOH4HKNNUM  =  "972" OR "974"
      *       低所の場合は残から２０００円又は１０００円を引く
              IF   (LNK-S01-KOUREI-ZAITAKU-KBN    =   "1" )
              AND  (FLG-SANSHOU3              NOT =  SPACE)
              AND  (COMB-KOH4HKNNUM               =  "972")
              AND  (WK-2010-CYOKEIKBN-G(3)  =  "2" OR "4" )
                 IF   ZAN-KOHI4   >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU1 = ZAN-KOHI4
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU1
                 END-IF
                 IF   ZAN-KOHI42  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU2 = ZAN-KOHI42
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU2
                 END-IF
                 IF   ZAN-KOHI43  >  WK-CYOKI-HIKAKU9
                   COMPUTE  WK-CYOKI-HIKAKU3 = ZAN-KOHI43
                                             - WK-CYOKI-HIKAKU9
                 ELSE
                   MOVE     ZERO    TO   WK-CYOKI-HIKAKU3
                 END-IF
              ELSE
                 MOVE   ZAN-KOHI4   TO   WK-CYOKI-HIKAKU1
                 MOVE   ZAN-KOHI42  TO   WK-CYOKI-HIKAKU2
                 MOVE   ZAN-KOHI43  TO   WK-CYOKI-HIKAKU3
              END-IF
           END-IF
      *
           IF  (COMB-KOH4HKNNUM  =  "972" OR "974")
             IF   ZAN-KOHI3  >  WK-CYOKI-HIKAKU1
                 MOVE   WK-CYOKI-HIKAKU1   TO  ZAN-KOHI3
             END-IF
             IF   ZAN-KOHI32 >  WK-CYOKI-HIKAKU2
                 MOVE   WK-CYOKI-HIKAKU2   TO  ZAN-KOHI32
             END-IF
             IF   ZAN-KOHI33 >  WK-CYOKI-HIKAKU3
                 MOVE   WK-CYOKI-HIKAKU3   TO  ZAN-KOHI33
             END-IF
           END-IF
      *
           .
      *
       23083-ZANOKIKAE-HENSYU3-EXT.
           EXIT.
      *
      ******************************************************************
      *        薬剤一部負担金の算定処理                                *
      ******************************************************************
       YAKFTN-SANTEI-SEC              SECTION.
      *
           MOVE      SPACE       TO      YAKFTN-AREA.
           INITIALIZE                    YAKFTN-AREA.
      *
      *    薬剤一部負担金徴収可能の判定
           PERFORM YAKFTN-HANTEI-SEC.
      *
           IF      FLG-YAKFTN    =    SPACE
      *
      *      薬剤一部負担金テーブルのセット
             PERFORM        YAKFTN-TABLE-SET-SEC
      *
      *      薬剤一部負担金テーブルを再検索して同一薬剤の種類数を減算
             PERFORM YAKFTN-KAISUU-HENSYU-SEC
      *
      *      薬剤一部負担金テーブルを再検索して剤番号別の薬剤数を計算
             PERFORM YAKFTN-SAI-KEISAN-SEC
      *
      *      剤番号別の薬剤数より薬剤一部負担金を計算
             PERFORM YAKFTN-KINGAKU-KEISAN-SEC
      *
      *      保険切り替え時の継続診療入力がされた場合の前入力分
      *      の薬剤一部負担金の算出
             IF      LNK-SYU-CONTKBN     =    "2"
                 PERFORM YAKFTN-CONT-SEC
             END-IF
      *
      *      薬剤一部負担金の上限額を主保険の負担金額までとする
             PERFORM YAKFTN-JOUGEN-HANTEI-SEC
           END-IF.
      *
       YAKFTN-SANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *     年齢、保険内容から薬剤一部負担金算定可能患者であるか判定   *
      ******************************************************************
       YAKFTN-HANTEI-SEC           SECTION.
      *
           MOVE    SPACE                TO      FLG-YAKFTN.
      *
      *    年齢６才未満
           INITIALIZE                           PTINF-REC.
           MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM.
           MOVE    LNK-SYU-PTID         TO      PTINF-PTID.
           MOVE    PTINF-REC            TO      MCPDATA-REC.
           MOVE    "DBSELECT"           TO      MCP-FUNC.
           MOVE    "tbl_ptinf"          TO      MCP-TABLE.
           MOVE    "key"                TO      MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptinf"      TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM  PTINF-READ-SEC
               IF       MCP-RC          =       ZERO
                    MOVE   PTINF-BIRTHDAY   TO  WRK-YMDS1
                    MOVE   LNK-SYU-SRYYMD   TO  WRK-YMDS2
                    MOVE   ZERO             TO  WRK-NENREI
                    COMPUTE  WRK-NENREI     =   WRK-YYS2
                                            -   WRK-YYS1
                    IF   WRK-YMDS1(5:4)     >   WRK-YMDS2(5:4)
                         ADD   -1           TO  WRK-NENREI
                    END-IF
                    IF   WRK-NENREI         =   70 
                    AND  WRK-YMDS1(5:4)    <=   WRK-YMDS2(5:4)
                            IF    WRK-YMDS1(5:2)  = WRK-YMDS2(5:2)
                                  IF   WRK-YMDS1(7:2)  NOT = "01"
                                       ADD   -1     TO  WRK-NENREI
                                  END-IF
                            END-IF
                    END-IF
               ELSE
                    DISPLAY  "PTINF FETCH ERR"
                    MOVE     ZERO   TO      WRK-NENREI
               END-IF
           ELSE
               DISPLAY   "PTINF SELECT ERR"
               MOVE     ZERO   TO      WRK-NENREI
           END-IF.
      *
           MOVE    "tbl_ptinf"          TO       MCP-TABLE.
           MOVE    "key"                TO       MCP-PATHNAME.
           PERFORM  DB-CLOSE-SEC.
      *
      *     IF      WRK-NENREI         <     6
      *         MOVE    "1"            TO      FLG-YAKFTN
      *     END-IF.
           IF     (WRK-NENREI         <     6)   OR
                  (WRK-NENREI         >=    70)
               MOVE    "1"            TO      FLG-YAKFTN
           END-IF.
      *
      *    船員保険の該当者：職務上
      *                    ：下船後３ヶ月以内
      *                    ：通勤災害
           IF     (COMB-HKNNUM        =     "002")   AND
                  (COMB-HOJOKBN       =  "1"  OR  "2"  OR  "3"  OR
                                         "A"  OR  "B"  OR  "C"  OR
                                         "D"  OR  "E"  OR  "F"    )
               MOVE    "1"            TO      FLG-YAKFTN
           END-IF.
      *
      *    共済組合保険の該当者：下船後３ヶ月以内
           IF     (COMB-HKNNUM  = "031" OR "032" OR "033" OR "034") AND
                  (COMB-HOJOKBN =  "2"  OR  "B"  OR  "E"          )
               MOVE    "1"            TO      FLG-YAKFTN
           END-IF.
      *
      *    老人保険受給者（６５才以上含む）
           IF     COMB-KOH1HKNNUM  = "027"
               MOVE    "1"            TO      FLG-YAKFTN
           END-IF.
      *
       YAKFTN-HANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *     引き渡しパラメタから薬剤一部負担金テーブルへのセット処理   *
      ******************************************************************
       YAKFTN-TABLE-SET-SEC           SECTION.
      *
           MOVE    ZERO                 TO      Y-IDX3.
           PERFORM VARYING     Y-IDX    FROM    1   BY  1
                   UNTIL      (Y-IDX        >       3)
             PERFORM VARYING     Y-IDX2    FROM    1   BY  1
                     UNTIL    (Y-IDX2       >       40)
               IF    (LNK-S01-SRYKBN(Y-IDX Y-IDX2)   NOT =  SPACE)
               AND   (LNK-S01-SRYCD (Y-IDX Y-IDX2) (1:1) =  "6"  )
                   ADD        1     TO    Y-IDX3
                   MOVE  LNK-S01-SRYKBN (Y-IDX Y-IDX2)
                                         TO    LNK-S02-SRYKBN (Y-IDX3)
                   MOVE  LNK-S01-ZAIBAN (Y-IDX Y-IDX2)
                                         TO    LNK-S02-ZAIBAN (Y-IDX3)
                   MOVE  LNK-S01-SRYCD  (Y-IDX Y-IDX2)
                                         TO    LNK-S02-SRYCD  (Y-IDX3)
                   MOVE  LNK-S01-SURYOU (Y-IDX Y-IDX2)
                                         TO    LNK-S02-SURYOU (Y-IDX3)
                   MOVE  LNK-S01-KAISUU (Y-IDX Y-IDX2)
                                         TO    LNK-S02-KAISUU (Y-IDX3)
                   MOVE  LNK-S01-TENSUU (Y-IDX Y-IDX2)
                                         TO    LNK-S02-TENSUU (Y-IDX3)
               END-IF
             END-PERFORM
           END-PERFORM.
      *
           PERFORM VARYING     Y-IDX    FROM    1   BY  1
                   UNTIL      (LNK-S02-SRYKBN(Y-IDX)    =   SPACE) OR
                              (Y-IDX                    >   40   )
               MOVE  LNK-S02-SRYKBN (Y-IDX) TO YAKFTN-SRYKBN (Y-IDX)
               MOVE  LNK-S02-ZAIBAN (Y-IDX) TO YAKFTN-ZAIBAN (Y-IDX)
               MOVE  LNK-S02-SRYCD  (Y-IDX) TO YAKFTN-SRYCD  (Y-IDX)
               MOVE  LNK-S02-TENSUU (Y-IDX) TO YAKFTN-TENSUU (Y-IDX)
               IF    LNK-S02-SRYKBN(Y-IDX)  =  "22"
                     MOVE    1              TO LNK-S02-KAISUU(Y-IDX)
               END-IF
               MOVE  LNK-S02-KAISUU (Y-IDX) TO YAKFTN-MAX    (Y-IDX)
               MOVE  LNK-S02-KAISUU (Y-IDX) TO Y-IDX3
               PERFORM VARYING     Y-IDX2   FROM    1   BY  1
                       UNTIL       Y-IDX2   >       Y-IDX3
                    MOVE    1      TO    YAKFTN-KAISUU   (Y-IDX Y-IDX2)
              END-PERFORM
           END-PERFORM.
      *
      *    薬剤一部負担金の上限額判定用に診療区分別の薬剤点数を取得
           PERFORM VARYING     Y-IDX    FROM    1   BY  1
                   UNTIL      (Y-IDX                    >   40   )  OR
                              (LNK-S02-SRYKBN(Y-IDX)    =   SPACE)
               PERFORM   VARYING   Y-IDX2    FROM   1   BY   1
                         UNTIL     Y-IDX2    >          40
                        IF   LNK-S02-ZAIBAN(Y-IDX)  =  
                                              WK-TOYAKU-ZAIBAN(Y-IDX2)
                             MOVE   41      TO   Y-IDX2
                        ELSE
                          IF   WK-TOYAKU-ZAIBAN(Y-IDX2)    =   ZERO
                              MOVE   LNK-S02-SRYKBN(Y-IDX) TO
                                              WK-TOYAKU-SRYKBN(Y-IDX2)
                              MOVE   LNK-S02-ZAIBAN(Y-IDX) TO
                                              WK-TOYAKU-ZAIBAN(Y-IDX2)
                              IF     LNK-S02-SRYKBN(Y-IDX)  =  "21" OR
                                                               "22"
                                  COMPUTE    WK-TOYAKU-ZAITEN(Y-IDX2)
                                          =  LNK-S02-TENSUU(Y-IDX)
                                          *  LNK-S02-KAISUU(Y-IDX)
                              ELSE
                                  MOVE   LNK-S02-TENSUU(Y-IDX) TO
                                              WK-TOYAKU-ZAITEN(Y-IDX2)
                              END-IF
                              MOVE   41       TO   Y-IDX2
                          END-IF
                        END-IF
               END-PERFORM
           END-PERFORM.
           PERFORM    VARYING    Y-IDX   FROM  1   BY   1
                      UNTIL     (Y-IDX       >   40)    OR
                                (WK-TOYAKU-SRYKBN(Y-IDX)   =    SPACE)
                  EVALUATE    WK-TOYAKU-SRYKBN(Y-IDX)
                      WHEN    "21"
                          ADD   WK-TOYAKU-ZAITEN(Y-IDX)    TO
                                                    WK-TOYAKU-TENSU(1)
                      WHEN    "22"
                          ADD   WK-TOYAKU-ZAITEN(Y-IDX)    TO
                                                    WK-TOYAKU-TENSU(2)
                      WHEN    "23"
                          ADD   WK-TOYAKU-ZAITEN(Y-IDX)    TO
                                                    WK-TOYAKU-TENSU(3)
                  END-EVALUATE
           END-PERFORM.
           COMPUTE    WK-TOYAKU-TENSU(1)  =  WK-TOYAKU-TENSU(1) *  10.
           COMPUTE    WK-TOYAKU-TENSU(2)  =  WK-TOYAKU-TENSU(2) *  10.
           COMPUTE    WK-TOYAKU-TENSU(3)  =  WK-TOYAKU-TENSU(3) *  10.
      *
       YAKFTN-TABLE-SET-EXT.
           EXIT.
      *
      ******************************************************************
      *    薬剤一部負担金テーブルを再検索して同一薬剤の種類数を計算    *
      ******************************************************************
       YAKFTN-KAISUU-HENSYU-SEC          SECTION.
      *
      *        診療区分・診療コードで並び替え
      *
           MOVE   YAKFTN-TABLE      TO    YAKFTN-TABLE2.
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                   UNTIL      (YAKFTN-SRYKBN2(Y-IDX)    =   SPACE)  OR
                              (Y-IDX                   >   39   )
               COMPUTE Y-IDX2  =   Y-IDX       +   1
               PERFORM VARYING     Y-IDX3  FROM    Y-IDX2  BY  1
                       UNTIL      (YAKFTN-SRYKBN2(Y-IDX3) = SPACE)  OR
                                  (Y-IDX3              >   40   )
                   IF      YAKFTN-KEY2 (Y-IDX) > YAKFTN-KEY2 (Y-IDX3)
                       MOVE    YAKFTN-TBL-OCC2(Y-IDX)   TO
                                               WK-SRT-YAKFTN-TABLE
                       MOVE    YAKFTN-TBL-OCC2(Y-IDX3)  TO
                                               YAKFTN-TBL-OCC2(Y-IDX)
                       MOVE    WK-SRT-YAKFTN-TABLE     TO
                                               YAKFTN-TBL-OCC2(Y-IDX3)
                   END-IF
               END-PERFORM
           END-PERFORM.       
           MOVE   YAKFTN-TABLE2     TO    YAKFTN-TABLE.
      *
      *//     PERFORM VARYING     Y-IDX   FROM    1   BY  1
      *//             UNTIL      (YAKFTN-SRYKBN(Y-IDX)    =   SPACE)  OR
      *//                        (Y-IDX                   >   39   )
      *//         COMPUTE Y-IDX2  =   Y-IDX       +   1
      *//        PERFORM VARYING     Y-IDX3  FROM    Y-IDX2  BY  1
      *//                 UNTIL      (YAKFTN-SRYKBN(Y-IDX3) = SPACE)  OR
      *//                            (Y-IDX3              >   40   )
      *//             IF      YAKFTN-KEY (Y-IDX) > YAKFTN-KEY (Y-IDX3)
      *//                 MOVE    YAKFTN-TBL-OCC(Y-IDX)   TO
      *//                                         WK-SRT-YAKFTN-TABLE
      *//                 MOVE    YAKFTN-TBL-OCC(Y-IDX3)  TO
      *//                                         YAKFTN-TBL-OCC(Y-IDX)
      *//                 MOVE    WK-SRT-YAKFTN-TABLE     TO
      *//                                         YAKFTN-TBL-OCC(Y-IDX3)
      *//            END-IF
      *//         END-PERFORM
      *//     END-PERFORM.       
      *
      *
      *     PERFORM   VARYING  DSP-IDX   FROM   1   BY   1
      *                UNTIL  DSP-IDX   >   10
      *         DISPLAY  "YAKFTN-SRYCD(DSP-IDX)  = "
      *                                   YAKFTN-SRYCD(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAIBAN(DSP-IDX) = "
      *                                   YAKFTN-ZAIBAN(DSP-IDX)
      *         DISPLAY  "YAKFTN-TENSUU(DSP-IDX) = "
      *                                   YAKFTN-TENSUU(DSP-IDX)
      *       PERFORM    VARYING   DSP-IDX2   FROM  1  BY  1
      *                  UNTIL     DSP-IDX2   >   5  
      *         DISPLAY "YAKFTN-KAISUU(" DSP-IDX ":" DSP-IDX2 ") = "
      *                           YAKFTN-KAISUU(DSP-IDX DSP-IDX2)
      *       END-PERFORM
      *     END-PERFORM.                             
      *               
      *
      *        診療区分・診療コード別に服用期間の編集
           MOVE    ZERO                 TO  WK-KAISUU-TABLE
           MOVE    1                    TO  Y-IDX
           PERFORM UNTIL      (YAKFTN-SRYKBN(Y-IDX)   =   SPACE)   OR
                              (Y-IDX                   >   40  )
               MOVE    YAKFTN-KEY   (Y-IDX)     TO  WK-KEY-SRY
               MOVE    YAKFTN-KAISUU-TABLE(Y-IDX)
                                                TO  WK-KAISUU-TABLE
               MOVE    YAKFTN-TENSUU(Y-IDX)
                                                TO  WK-YAKFTN-TENSUU
               ADD     1                        TO  Y-IDX
               PERFORM UNTIL      (YAKFTN-SRYKBN(Y-IDX)  =  SPACE) OR
                                  (Y-IDX                 >  40   ) OR
                                  (WK-KEY-SRY              NOT =
                                                  YAKFTN-KEY (Y-IDX))
      *
                   PERFORM VARYING Y-IDX3  FROM    1   BY  1
                           UNTIL   Y-IDX3  >       YAKFTN-MAX (Y-IDX)
                       IF      WK-KAISUU    (Y-IDX3)   =   1
                             AND  YAKFTN-TENSUU(Y-IDX)  >  20   AND
                                  WK-YAKFTN-TENSUU      >  20
                           MOVE  ZERO  TO  YAKFTN-KAISUU(Y-IDX Y-IDX3)
                       END-IF
      *                 IF  YAKFTN-TENSUU (Y-IDX)  <=   20
      *                     MOVE  1     TO  YAKFTN-KAISUU(Y-IDX Y-IDX3)
      *                 END-IF
                   END-PERFORM
      *
                   PERFORM VARYING Y-IDX3  FROM    1   BY  1
                           UNTIL   Y-IDX3  > YAKFTN-MAX (Y-IDX)
                       IF      YAKFTN-KAISUU(Y-IDX Y-IDX3) =  1
                           MOVE    1       TO  WK-KAISUU   (Y-IDX3)
                       END-IF
                   END-PERFORM
      *
                   MOVE    YAKFTN-TENSUU(Y-IDX)    TO  WK-YAKFTN-TENSUU
                   ADD     1                       TO  Y-IDX
              END-PERFORM
      *
           END-PERFORM.       
      *
      *
      *     PERFORM   VARYING  DSP-IDX   FROM   1   BY   1
      *                UNTIL  DSP-IDX   >   10
      *         DISPLAY  "YAKFTN-SRYCD(DSP-IDX)  = "
      *                                   YAKFTN-SRYCD(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAIBAN(DSP-IDX) = "
      *                                   YAKFTN-ZAIBAN(DSP-IDX)
      *         DISPLAY  "YAKFTN-TENSUU(DSP-IDX) = "
      *                                   YAKFTN-TENSUU(DSP-IDX)
      *       PERFORM    VARYING   DSP-IDX2   FROM  1  BY  1
      *                  UNTIL     DSP-IDX2   >   5  
      *         DISPLAY "YAKFTN-KAISUU(" DSP-IDX ":" DSP-IDX2 ") = "
      *                           YAKFTN-KAISUU(DSP-IDX DSP-IDX2)
      *       END-PERFORM
      *     END-PERFORM.                             
      *               
      *
       YAKFTN-KAISUU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    薬剤一部負担金テーブルを再検索して剤番号別の薬剤数を計算    *
      ******************************************************************
       YAKFTN-SAI-KEISAN-SEC                SECTION.
      *
      *        剤番号で並び替え
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                   UNTIL      (YAKFTN-SRYKBN(Y-IDX)  =  SPACE) OR
                              (Y-IDX                 >  39   )
               COMPUTE Y-IDX2  =   Y-IDX       +   1
               PERFORM VARYING     Y-IDX3  FROM    Y-IDX2  BY  1
                       UNTIL      (YAKFTN-SRYKBN(Y-IDX3) = SPACE)  OR
                                  (Y-IDX3                >   40 )
                   IF     YAKFTN-ZAIBAN(Y-IDX) > YAKFTN-ZAIBAN(Y-IDX3)
                       MOVE    YAKFTN-TBL-OCC(Y-IDX)  TO
                                                WK-SRT-YAKFTN-TABLE
                       MOVE    YAKFTN-TBL-OCC(Y-IDX3) TO
                                                YAKFTN-TBL-OCC(Y-IDX)
                       MOVE    WK-SRT-YAKFTN-TABLE    TO
                                                YAKFTN-TBL-OCC(Y-IDX3)
                   END-IF
               END-PERFORM
           END-PERFORM.       
      *
      *
      *
      *     PERFORM   VARYING  DSP-IDX   FROM   1   BY   1
      *                UNTIL  DSP-IDX   >   10
      *         DISPLAY  "YAKFTN-SRYCD(DSP-IDX)  = "
      *                                   YAKFTN-SRYCD(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAIBAN(DSP-IDX) = "
      *                                   YAKFTN-ZAIBAN(DSP-IDX)
      *         DISPLAY  "YAKFTN-TENSUU(DSP-IDX) = "
      *                                   YAKFTN-TENSUU(DSP-IDX)
      *       PERFORM    VARYING   DSP-IDX2   FROM  1  BY  1
      *                  UNTIL     DSP-IDX2   >   5  
      *         DISPLAY "YAKFTN-KAISUU(" DSP-IDX ":" DSP-IDX2 ") = "
      *                           YAKFTN-KAISUU(DSP-IDX DSP-IDX2)
      *       END-PERFORM
      *     END-PERFORM.                             
      *               
      *        剤番号別に薬剤数を計算
      *
           MOVE    ZERO                 TO  FLG-ZAIGATAKBN
      *
           MOVE    1                    TO  Y-IDX
           MOVE    ZERO                 TO  Y-IDX4
           PERFORM UNTIL      (YAKFTN-SRYKBN(Y-IDX)   =   SPACE)   OR
                              (Y-IDX                   >   40  )
               ADD     1                        TO  Y-IDX4
               MOVE    YAKFTN-SRYKBN  (Y-IDX)   TO
                                           YAKFTN-ZAI-SRYKBN  (Y-IDX4)
               MOVE    YAKFTN-ZAIBAN  (Y-IDX)   TO
                                           YAKFTN-ZAI-ZAIBAN  (Y-IDX4)
               MOVE    YAKFTN-SRYCD   (Y-IDX)   TO
                                           YAKFTN-ZAI-SRYCD   (Y-IDX4)
               MOVE    YAKFTN-TENSUU  (Y-IDX)   TO
                                           YAKFTN-ZAI-TENSUU  (Y-IDX4)
               MOVE    YAKFTN-ZAIBAN  (Y-IDX)   TO
                                           WK-KEY-ZAIBAN
               MOVE    ZERO                     TO
                                           WK-ZAI-KAISUU-TABLE
      *
               MOVE    ZERO                 TO  FLG-ZAIGATAKBN
      *
              PERFORM UNTIL  (YAKFTN-SRYKBN(Y-IDX)  =  SPACE)   OR
                             (Y-IDX                 >  40   )   OR
                             (WK-KEY-ZAIBAN   NOT =
                                                YAKFTN-ZAIBAN(Y-IDX))
      *
                 MOVE    ZERO                    TO  FLG-ADDKBN
      *
      *        （内服薬剤の混合）
                 IF      YAKFTN-SRYKBN (Y-IDX)   =   "21"
                     MOVE    YAKFTN-SRYCD (Y-IDX)    TO  WK-SRYCD
                     PERFORM TENSU-READ-SEC
                     IF      TNS-ZAIGATAKBN          =   "1" OR
                                                         "2" OR
                                                         "3"
                        IF      FLG-ZAIGATAKBN       =   1
                            MOVE    1                TO  FLG-ADDKBN
                        END-IF
                        MOVE    1                    TO  FLG-ZAIGATAKBN
                     END-IF        
                 END-IF
                 IF     FLG-ADDKBN              =   ZERO
                    PERFORM VARYING Y-IDX3  FROM    1   BY  1
                            UNTIL   Y-IDX3  >       YAKFTN-MAX (Y-IDX)
                        IF      YAKFTN-KAISUU(Y-IDX Y-IDX3)   >   0
                            ADD     YAKFTN-KAISUU(Y-IDX Y-IDX3)
                                            TO  WK-ZAI-KAISUU (Y-IDX3)
                            IF      Y-IDX3    >  YAKFTN-ZAI-MAX(Y-IDX4)
                                MOVE Y-IDX3  TO  YAKFTN-ZAI-MAX(Y-IDX4)
                            END-IF
                        END-IF
                    END-PERFORM
                END-IF    
      *
                ADD     1                       TO  Y-IDX      
              END-PERFORM
              MOVE    WK-ZAI-KAISUU-TABLE     TO
                                      YAKFTN-ZAI-KAISUU-TABLE (Y-IDX4)
           END-PERFORM.
      *
      *     DISPLAY "*** ZAIBANGTOU BETSU YAKUZAISUU KEISANGO  ***".
      *
      *     PERFORM   VARYING  DSP-IDX   FROM   1   BY   1
      *                UNTIL  DSP-IDX   >   10
      *         DISPLAY  "YAKFTN-ZAI-SRYCD(DSP-IDX)  = "
      *                                   YAKFTN-ZAI-SRYCD(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAI-ZAIBAN(DSP-IDX) = "
      *                                   YAKFTN-ZAI-ZAIBAN(DSP-IDX)
      *         DISPLAY  "YAKFTN-ZAI-TENSUU(DSP-IDX) = "
      *                                   YAKFTN-ZAI-TENSUU(DSP-IDX)
      *       PERFORM    VARYING   DSP-IDX2   FROM  1  BY  1
      *                  UNTIL     DSP-IDX2   >   5  
      *         DISPLAY "YAKFTN-ZAI-KAISUU(" DSP-IDX ":" DSP-IDX2 ") = "
      *                           YAKFTN-ZAI-KAISUU(DSP-IDX DSP-IDX2)
      *       END-PERFORM
      *     END-PERFORM.                             
      *               
      *
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                   UNTIL   (YAKFTN-ZAI-SRYKBN(Y-IDX)   =   SPACE)  OR
                           (Y-IDX                      >   40  )
      *        （２０点以下対応）
               IF      YAKFTN-ZAI-TENSUU (Y-IDX)   <=  20
                   PERFORM VARYING Y-IDX2  FROM    1   BY  1
                           UNTIL   Y-IDX2  >     YAKFTN-ZAI-MAX(Y-IDX)
                       IF      YAKFTN-ZAI-KAISUU (Y-IDX Y-IDX2) >   0
                           MOVE    1               TO
                                     YAKFTN-ZAI-KAISUU (Y-IDX Y-IDX2)
                       END-IF
                   END-PERFORM
               END-IF
      *        （外用薬の混合）
               IF      YAKFTN-ZAI-SRYKBN (Y-IDX)   =   "23"
                   PERFORM VARYING Y-IDX2  FROM    1   BY  1
                           UNTIL   Y-IDX2  >    YAKFTN-ZAI-MAX(Y-IDX)
                       IF      YAKFTN-ZAI-KAISUU (Y-IDX Y-IDX2) >   0
                           MOVE    1               TO
                                     YAKFTN-ZAI-KAISUU (Y-IDX Y-IDX2)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM.
      *
       YAKFTN-SAI-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *    薬剤一部負担金テーブルを再検索して剤番号別の薬剤数を計算    *
      ******************************************************************
       YAKFTN-KINGAKU-KEISAN-SEC                SECTION.
      *
      *----(01.00.01) LINE MOD START -------------------------------
      *
      *    MOVE    ZERO                 TO  YAKFTN-SOGOKEI
      *
      *    PERFORM VARYING     Y-IDX   FROM    1   BY  1
      *          UNTIL      (YAKFTN-ZAI-SRYKBN(Y-IDX)   =   SPACE)   OR
      *                       (Y-IDX                      >   40  )
      *      PERFORM VARYING Y-IDX2  FROM    1   BY  1
      *              UNTIL   Y-IDX2  >       YAKFTN-ZAI-MAX(Y-IDX)
      *          IF      YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2)    >   0
      *              EVALUATE    TRUE
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) =   1
      *                      MOVE    ZERO             TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) = 2 OR 3
      *                      MOVE    30               TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21" AND
      *                      YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) =  4 OR 5
      *                      MOVE    60               TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) >  5
      *                      MOVE    100              TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "22" 
      *                      COMPUTE  WK-FUTAN    =   
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2)  *   10
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "23" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) =   1
      *	                     MOVE     50              TO  WK-FUTAN    
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "23" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) =   2
      *                     MOVE     100              TO  WK-FUTAN
      *                  WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =  "23" AND
      *                        YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) >   2
      *                     MOVE     150              TO  WK-FUTAN
      *              END-EVALUATE
      *              ADD     WK-FUTAN             TO  YAKFTN-SOGOKEI
      *          END-IF
      *      END-PERFORM
      *    END-PERFORM.
      *
      *
           MOVE    ZERO                 TO  YAKFTN-SOGOKEI
      *
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                 UNTIL      (YAKFTN-ZAI-SRYKBN(Y-IDX)   =   SPACE)   OR
                              (Y-IDX                      >   40  )
             PERFORM VARYING Y-IDX2  FROM    1   BY  1
                     UNTIL   Y-IDX2  >       YAKFTN-ZAI-MAX(Y-IDX)
                 IF      YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2)    >   0
                     EVALUATE    TRUE
                         WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "21"
                               ADD  YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) TO
                                    YAKFTN-TOTAL-KAISUU(1 Y-IDX2)
                         WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "22"
                               ADD  YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) TO
                                    YAKFTN-TOTAL-KAISUU(2 Y-IDX2)
                         WHEN  YAKFTN-ZAI-SRYKBN(Y-IDX)    =   "23"
                               ADD  YAKFTN-ZAI-KAISUU(Y-IDX Y-IDX2) TO
                                    YAKFTN-TOTAL-KAISUU(3 Y-IDX2)
                     END-EVALUATE
                 END-IF
             END-PERFORM
           END-PERFORM.
      *
           PERFORM VARYING     Y-IDX   FROM    1   BY  1
                   UNTIL     (Y-IDX               >   3  )
             PERFORM VARYING Y-IDX2  FROM    1   BY  1
                     UNTIL    (Y-IDX2              >       180)
                 IF      YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2)    >   0
                     EVALUATE    TRUE
                         WHEN  Y-IDX       =     1     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   1
                             MOVE    ZERO             TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) = 2
                             MOVE    30               TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) = 3
                             MOVE    30               TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                             YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   4
                             MOVE    60               TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                             YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   5
                             MOVE    60               TO  WK-FUTAN
                         WHEN  Y-IDX       =     1     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) >  5
                             MOVE    100              TO  WK-FUTAN
                         WHEN  Y-IDX       =     2 
                             COMPUTE  WK-FUTAN    =   
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2)  *  10
                         WHEN  Y-IDX       =     3     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   1
      	                     MOVE     50              TO  WK-FUTAN    
                         WHEN  Y-IDX       =     3     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) =   2
                            MOVE     100              TO  WK-FUTAN
                         WHEN  Y-IDX       =     3     AND
                               YAKFTN-TOTAL-KAISUU(Y-IDX Y-IDX2) >   2
                            MOVE     150              TO  WK-FUTAN
                     END-EVALUATE
                     EVALUATE    Y-IDX
                         WHEN    1
                                ADD    WK-FUTAN   TO  WK-NAI-FUTAN
                         WHEN    2
                                ADD    WK-FUTAN   TO  WK-TON-FUTAN
                         WHEN    3
                                ADD    WK-FUTAN   TO  WK-GAI-FUTAN
                     END-EVALUATE
      ***           ADD     WK-FUTAN             TO  YAKFTN-SOGOKEI
                 END-IF
             END-PERFORM
           END-PERFORM.
      *
      **     IF    WK-TOYAKU-TENSU(1)     <   WK-NAI-FUTAN
      **          MOVE    WK-TOYAKU-TENSU(1)   TO   WK-NAI-FUTAN
      **     END-IF. 
      **     IF    WK-TOYAKU-TENSU(2)     <   WK-TON-FUTAN
      **           MOVE    WK-TOYAKU-TENSU(2)   TO   WK-TON-FUTAN
      **     END-IF. 
      **     IF    WK-TOYAKU-TENSU(3)     <   WK-GAI-FUTAN
      **           MOVE    WK-TOYAKU-TENSU(3)   TO   WK-GAI-FUTAN
      **     END-IF. 
           COMPUTE   YAKFTN-SOGOKEI   =   WK-NAI-FUTAN   +
                                          WK-TON-FUTAN   +
                                          WK-GAI-FUTAN.
           COMPUTE   WK-TOYAKU-TENSU(4)   =    WK-TOYAKU-TENSU(1)    +
                                               WK-TOYAKU-TENSU(2)    +
                                               WK-TOYAKU-TENSU(3).
           IF        YAKFTN-SOGOKEI       >    WK-TOYAKU-TENSU(4)
               MOVE  WK-TOYAKU-TENSU(4)   TO   YAKFTN-SOGOKEI
           END-IF.
      *      
       YAKFTN-KINGAKU-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *    保険切り替え時の継続診療入力がされた場合の前入力分
      *    の薬剤一部負担金の算出（収納テーブルより）
      ******************************************************************
       YAKFTN-CONT-SEC                SECTION.
      *
           MOVE    LNK-SYU-HOSPNUM      TO     SYU-HOSPNUM.
           MOVE    LNK-SYU-NYUGAIKBN    TO     SYU-NYUGAIKBN.
           MOVE    LNK-SYU-PTID         TO     SYU-PTID.
           MOVE    LNK-SYU-DOUJI-DENPNUM TO    SYU-DOUJI-DENPNUM.
           MOVE    SYU-SYUNOU-REC       TO     MCPDATA-REC.
           MOVE    "DBSELECT"           TO     MCP-FUNC.
           MOVE    "tbl_syunou"         TO     MCP-TABLE.
           MOVE    "key3"               TO     MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING  MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA.
           IF      MCP-RC               =      ZERO
               MOVE    "tbl_syunou"     TO     MCP-TABLE
               MOVE    "key3"           TO     MCP-PATHNAME
               PERFORM  SYUNOU-READ-SEC
               PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                 DISPLAY  "LNK-SYU-DENPNUM = " LNK-SYU-DENPNUM
                 IF    LNK-SYU-DENPNUM   NOT =    1
                   IF  LNK-SYU-DENPNUM   >   SYU-DENPNUM
                     IF  WK-CONT-YAKFTNKIN1    =    ZERO
                         MOVE   SYU-RESE-YKZ-FTN
                                          TO     WK-CONT-YAKFTNKIN1
                     ELSE
                         MOVE   SYU-RESE-YKZ-FTN
                                          TO     WK-CONT-YAKFTNKIN2
                     END-IF
                   END-IF
                   MOVE    "tbl_syunou"   TO     MCP-TABLE
                   MOVE    "key3"         TO     MCP-PATHNAME
                   PERFORM  SYUNOU-READ-SEC
                 ELSE
                   IF  WK-CONT-YAKFTNKIN1    =    ZERO
                       MOVE   SYU-RESE-YKZ-FTN
                                        TO     WK-CONT-YAKFTNKIN1
                   ELSE
                       MOVE   SYU-RESE-YKZ-FTN
                                        TO     WK-CONT-YAKFTNKIN2
                   END-IF
                   MOVE    "tbl_syunou"   TO     MCP-TABLE
                   MOVE    "key3"         TO     MCP-PATHNAME
                   PERFORM  SYUNOU-READ-SEC
                 END-IF
               END-PERFORM
           END-IF.
      *
           MOVE     "tbl_syunou"  TO   MCP-TABLE.
           MOVE     "key3"        TO   MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    トータルの薬剤一部負担金から前診療の薬剤一部負担金を減算
           COMPUTE   YAKFTN-SOGOKEI   =   YAKFTN-SOGOKEI
                                      -   WK-CONT-YAKFTNKIN1
                                      -   WK-CONT-YAKFTNKIN2.
      *
       YAKFTN-CONT-EXT.
           EXIT.
      *
      ******************************************************************
      *    薬剤一部負担金の上限額を主保険の保険負担金額までとする      *
      ******************************************************************
       YAKFTN-JOUGEN-HANTEI-SEC                SECTION.
      *
           MOVE    ZERO                 TO  YAKFTN-JOUGEN
      *
           IF    (COMB-KOH1-HKNKOHSBTKBN   =   "3")   OR
                 (COMB-KOH2-HKNKOHSBTKBN   =   "3")   OR
                 (COMB-KOH3-HKNKOHSBTKBN   =   "3")   OR
                 (COMB-KOH4-HKNKOHSBTKBN   =   "3")
               CONTINUE
           ELSE
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-HKNNUM        TO    HKN-HKNNUM
               MOVE   "00"               TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                   MOVE    "tbl_hknnum"  TO    MCP-TABLE
                   MOVE    "key2"        TO    MCP-PATHNAME
                   PERFORM  HKNNUM-READ-SEC
                   PERFORM  UNTIL 
                     (FLG-HKNNUM     =    1)                       OR
                    ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                     (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6))   AND
                     (WK-PAYKBN            =  HKN-PAYKBN))
                       MOVE     "tbl_hknnum"  TO    MCP-TABLE
                       MOVE     "key2"        TO    MCP-PATHNAME
                       PERFORM   HKNNUM-READ-SEC
                   END-PERFORM
                   IF     FLG-HKNNUM     =       0
                       PERFORM   YAKFTN-JOUGEN-SANTEI-SEC
                       IF    YAKFTN-SOGOKEI     >=   YAKFTN-JOUGEN
                           MOVE    YAKFTN-JOUGEN   TO  YAKFTN-SOGOKEI
                       END-IF
                   END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
      *
           END-IF.
      *
       YAKFTN-JOUGEN-HANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *    薬剤一部負担金の上限額を算定する                            *
      ******************************************************************
       YAKFTN-JOUGEN-SANTEI-SEC                SECTION.
      *
           MOVE    ZERO             TO    YAKFTN-JOUGEN.
      *    患者負担金算出前の１００％負担額算出
           MOVE      ZERO         TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX     FROM    1   BY  1
                     UNTIL     IDX         >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                                      (LNK-SYU-HKNTEN (IDX) * 10)
           END-PERFORM.
      *    保険組合せテーブルの補助区分から保険の負担割合を保険番号
      *    テーブルに再セット
           IF    COMB-HKNNUM           =    "060"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "0"
                          MOVE   100       TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "1"
                   WHEN   "4"
                          MOVE   90        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "2"
                   WHEN   "5"
                          MOVE   80        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
                   WHEN   "3"
                   WHEN   "6"
                          MOVE   70        TO   HKN-HON-GAIKFTNRATE
                                                HKN-KZK-GAIKFTNRATE
                                                HKN-TSY-GAIKFTNRATE
                                                HKN-TNK-GAIKFTNRATE
               END-EVALUATE
           ELSE
               COMPUTE   HKN-HON-GAIKFTNRATE
                         =  100  -  HKN-HON-GAIKFTNRATE
               COMPUTE   HKN-KZK-GAIKFTNRATE
                         =  100  -  HKN-KZK-GAIKFTNRATE
               COMPUTE   HKN-TSY-GAIKFTNRATE
                         =  100  -  HKN-TSY-GAIKFTNRATE
               COMPUTE   HKN-TNK-GAIKFTNRATE
                         =  100  -  HKN-TNK-GAIKFTNRATE
           END-IF.
      *
           EVALUATE    FLG-SANSHOU
               WHEN    "1"
                   IF   COMB-HONKZKKBN    =   "1"
                       IF   HKN-HON-GAIKFTNRATE  NOT =   ZERO
                            COMPUTE    WK-FUTANWARI  =
                                           HKN-HON-GAIKFTNRATE  /  100
                            COMPUTE    YAKFTN-JOUGEN    =
                                           WK-ZENGAKU * WK-FUTANWARI
                       END-IF
                   ELSE
                       IF   HKN-KZK-GAIKFTNRATE  NOT =   ZERO
                            COMPUTE    WK-FUTANWARI  =
                                           HKN-KZK-GAIKFTNRATE  /  100
                            COMPUTE    YAKFTN-JOUGEN    =
                                           WK-ZENGAKU * WK-FUTANWARI
                       END-IF
                   END-IF
               WHEN    "2"
                   IF   HKN-TSY-GAIKFTNRATE     NOT =   ZERO
                        COMPUTE    WK-FUTANWARI  =
                                       HKN-TSY-GAIKFTNRATE
                                                      /  100
                        COMPUTE    YAKFTN-JOUGEN    =
                                       WK-ZENGAKU * WK-FUTANWARI
                   END-IF
               WHEN    "3"
                   IF   HKN-TNK-GAIKFTNRATE     NOT =   ZERO
                        COMPUTE    WK-FUTANWARI  =
                                       HKN-TNK-GAIKFTNRATE
                                                      /  100
                        COMPUTE    YAKFTN-JOUGEN    =
                                       WK-ZENGAKU * WK-FUTANWARI
                   END-IF
           END-EVALUATE.
      *
       YAKFTN-JOUGEN-SANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険番号マスター読込
      *****************************************************************
       HKNNUM-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNNUM-REC
               MOVE    ZERO            TO  FLG-HKNNUM
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
      *
           .
       HKNNUM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスター読込
      *****************************************************************
       HKNCOMBI-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNCOMBI-REC
               MOVE    ZERO            TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                  HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           .
       HKNCOMBI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスター読込
      *****************************************************************
       HKNCOMBI-READ2-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  WRK-HKNCOMBI-REC
               MOVE    ZERO            TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                  WRK-HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           .
       HKNCOMBI-READ2-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスター読込
      *****************************************************************
       SRYACCT-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACCT-REC
               MOVE    ZERO            TO  FLG-SRYACCT
           ELSE
               INITIALIZE                  SRYACCT-REC
               MOVE    1               TO  FLG-SRYACCT
           END-IF
      *
           .
       SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療行為マスター読込
      *****************************************************************
       SRYACT-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       SRYACT-READ-EXT.
           EXIT.
      *
      ******************************************************************
      *    システム管理１００１読込
      ******************************************************************
       SYS1001-READ-SEC           SECTION.
      *
           INITIALIZE                         SYS-1001-REC.
           MOVE    "1001"               TO    SYS-1001-KANRICD.
           MOVE    "*"                  TO    SYS-1001-KBNCD.
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-1001-HOSPNUM.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1001-STYUKYMD.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1001-EDYUKYMD.
           MOVE    SYS-1001-REC         TO    MCPDATA-REC.
           MOVE    "DBSELECT"           TO    MCP-FUNC.
           MOVE    "tbl_syskanri"       TO    MCP-TABLE.
           MOVE    "key10"              TO    MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =     ZERO
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key10"         TO    MCP-PATHNAME
               PERFORM   SYSKANRI-READ-SEC
           END-IF.
      *
           MOVE     "tbl_syskanri"      TO    MCP-TABLE.
           MOVE     "key10"             TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
       SYS1001-READ-EXT.
           EXIT.
      *
      ******************************************************************
      *    システム管理１０３９読込
      ******************************************************************
       SYS1039-READ-SEC           SECTION.
      *
           INITIALIZE                       SYS-1039-REC
           MOVE    "1039"               TO  SYS-1039-KANRICD
           MOVE    "*"                  TO  SYS-1039-KBNCD
           MOVE    LNK-SYU-HOSPNUM      TO  SYS-1039-HOSPNUM
           MOVE    LNK-SYU-SRYYMD       TO  SYS-1039-STYUKYMD
           MOVE    LNK-SYU-SRYYMD       TO  SYS-1039-EDYUKYMD
           MOVE    SYS-1039-REC         TO  MCPDATA-REC
           MOVE    "DBSELECT"           TO  MCP-FUNC
           MOVE    "tbl_syskanri"       TO  MCP-TABLE
           MOVE    "key10"              TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
           IF      MCP-RC               =   ZERO
             MOVE     "tbl_syskanri"    TO  MCP-TABLE
             MOVE     "key10"           TO  MCP-PATHNAME
             PERFORM   SYSKANRI-READ-SEC
             IF    MCP-RC               =   ZERO
               MOVE SYS-1039-IKTSORTKBN TO  WK-1039-IKTSORTKBN
             END-IF
           END-IF
           MOVE    "tbl_syskanri"       TO  MCP-TABLE
           MOVE    "key10"              TO  MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           .
       SYS1039-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    システム管理マスター読込
      *****************************************************************
       SYSKANRI-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYS-1001-REC
                                           SYS-1026-REC
                                           SYS-1027-REC
                                           SYS-1037-REC
                                           SYS-1039-REC
                                           SYS-2010-REC
                                           SYS-2012-REC
                                           SYS-4001-REC
                                           SYS-4003-REC
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               INITIALIZE                  SYS-1001-REC
                                           SYS-1026-REC
                                           SYS-1027-REC
                                           SYS-1037-REC
                                           SYS-1039-REC
                                           SYS-2010-REC
                                           SYS-2012-REC
                                           SYS-4001-REC
                                           SYS-4003-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       SYSKANRI-READ-EXT.
           EXIT.
      *****************************************************************
      *    収納マスター読込
      *****************************************************************
       SYUNOU-READ-SEC          SECTION.
      *
       SYUNOU-READ-100.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYU-SYUNOU-REC
               IF    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-SYU-DENPNUM      NOT =  ZERO           ) AND
                      (LNK-SYU-DENPNUM          =  SYU-DENPNUM    ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTGENMKJFLG     =  SPACE          ) AND
                      (LNK-SYU-GRP-DENPNUM  NOT =  ZERO           ) AND
                      (LNK-SYU-GRP-DENPNUM      =  SYU-GRP-DENPNUM))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTGENMKJFLG     =  SPACE          ) AND
                      (LNK-SYU-GRP-DENPNUM  NOT =  ZERO           ) AND
                      (LNK-SYU-GRP-DENPNUM      =  SYU-DENPNUM    ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (FLG-IKTKEISANKBN         =  ZERO           ) AND
                      (LNK-S01-IKTSORTKBN       =   "0" OR SPACE  ) AND
                      (LNK-S01-IKTGENKEIFLG     =  SPACE          ) AND
                      (SYU-NYUGAIKBN            =   "2"           ) AND
                      (LNK-SYU-DENPNUM      NOT =  ZERO           ) AND
                      (LNK-SYU-DENPNUM          <  SYU-DENPNUM    ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (FLG-IKTKEISANKBN         =  ZERO           ) AND
                      (LNK-S01-IKTSORTKBN       =   "1"           ) AND
                      (LNK-S01-IKTGENKEIFLG     =  SPACE          ) AND
                      (SYU-NYUGAIKBN            =   "2"           ) AND
                      (LNK-SYU-SRYYMD       NOT =  SPACE          ) AND
                      (LNK-SYU-SRYYMD           <  SYU-SRYYMD     ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (FLG-IKTKEISANKBN         =  ZERO           ) AND
                      (LNK-S01-IKTSORTKBN       =   "1"           ) AND
                      (LNK-S01-IKTGENKEIFLG     =  SPACE          ) AND
                      (SYU-NYUGAIKBN            =   "2"           ) AND
                      (LNK-SYU-SRYYMD       NOT =  SPACE          ) AND
                      (LNK-SYU-SRYYMD           =  SYU-SRYYMD     ) AND
                      (LNK-SYU-DENPNUM      NOT =  ZERO           ) AND
                      (LNK-SYU-DENPNUM          <  SYU-DENPNUM    ))
      *
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (FLG-IKTKEISANKBN         =  ZERO           ) AND
                      (LNK-S01-IKTSORTKBN       =   "0" OR SPACE  ) AND
                      (LNK-S01-IKTGENKEIFLG NOT =  SPACE          ) AND
                      (COMB-KOH1HKNNUM      NOT =  "970"          ) AND
                      (SYU-KOH1HKNNUM       NOT =  "970"          ) AND
                      (LNK-SYU-SAIKEISANKBN     =
                                                 SYU-SAIKEISANKBN ) AND
                      (SYU-NYUGAIKBN            =   "2"           ) AND
                      (LNK-SYU-DENPNUM      NOT =  ZERO           ) AND
                      (LNK-SYU-DENPNUM          <  SYU-DENPNUM    ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (FLG-IKTKEISANKBN         =  ZERO           ) AND
                      (LNK-S01-IKTSORTKBN       =   "1"           ) AND
                      (LNK-S01-IKTGENKEIFLG NOT =  SPACE          ) AND
                      (COMB-KOH1HKNNUM      NOT =  "970"          ) AND
                      (SYU-KOH1HKNNUM       NOT =  "970"          ) AND
                      (LNK-SYU-SAIKEISANKBN     =
                                                 SYU-SAIKEISANKBN ) AND
                      (SYU-NYUGAIKBN            =   "2"           ) AND
                      (LNK-SYU-SRYYMD       NOT =  SPACE          ) AND
                      (LNK-SYU-SRYYMD           <  SYU-SRYYMD     ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (FLG-IKTKEISANKBN         =  ZERO           ) AND
                      (LNK-S01-IKTSORTKBN       =   "1"           ) AND
                      (LNK-S01-IKTGENKEIFLG NOT =  SPACE          ) AND
                      (COMB-KOH1HKNNUM      NOT =  "970"          ) AND
                      (SYU-KOH1HKNNUM       NOT =  "970"          ) AND
                      (LNK-SYU-SAIKEISANKBN     =
                                                 SYU-SAIKEISANKBN ) AND
                      (SYU-NYUGAIKBN            =   "2"           ) AND
                      (LNK-SYU-SRYYMD       NOT =  SPACE          ) AND
                      (LNK-SYU-SRYYMD           =  SYU-SRYYMD     ) AND
                      (LNK-SYU-DENPNUM      NOT =  ZERO           ) AND
                      (LNK-SYU-DENPNUM          <  SYU-DENPNUM    ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTGENKEIFLG NOT =  SPACE          ) AND
                      (COMB-KOH1HKNNUM      NOT =  "970"          ) AND
                      (SYU-KOH1HKNNUM       NOT =  "970"          ) AND
                      (LNK-SYU-SAIKEISANKBN     =  SPACE          ) AND
                      (SYU-SAIKEISANKBN         =   "1"           ) AND
                      (SYU-NYUGAIKBN            =   "2"           ))
      *
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (FLG-IKTKEISANKBN         =  ZERO           ) AND
                      (LNK-S01-IKTSORTKBN       =   "0" OR SPACE  ) AND
                      (LNK-S01-IKTGENKEIFLG NOT =  SPACE          ) AND
                      (COMB-KOH1HKNNUM          =  "970"          ) AND
                      (SYU-KOH1HKNNUM           =  "970"          ) AND
                      (SYU-NYUGAIKBN            =   "2"           ) AND
                      (LNK-SYU-DENPNUM      NOT =  ZERO           ) AND
                      (LNK-SYU-DENPNUM          <  SYU-DENPNUM    ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (FLG-IKTKEISANKBN         =  ZERO           ) AND
                      (LNK-S01-IKTSORTKBN       =   "1"           ) AND
                      (LNK-S01-IKTGENKEIFLG NOT =  SPACE          ) AND
                      (COMB-KOH1HKNNUM          =  "970"          ) AND
                      (SYU-KOH1HKNNUM           =  "970"          ) AND
                      (SYU-NYUGAIKBN            =   "2"           ) AND
                      (LNK-SYU-SRYYMD       NOT =  SPACE          ) AND
                      (LNK-SYU-SRYYMD           <  SYU-SRYYMD     ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (FLG-IKTKEISANKBN         =  ZERO           ) AND
                      (LNK-S01-IKTSORTKBN       =   "1"           ) AND
                      (LNK-S01-IKTGENKEIFLG NOT =  SPACE          ) AND
                      (COMB-KOH1HKNNUM          =  "970"          ) AND
                      (SYU-KOH1HKNNUM           =  "970"          ) AND
                      (SYU-NYUGAIKBN            =   "2"           ) AND
                      (LNK-SYU-SRYYMD       NOT =  SPACE          ) AND
                      (LNK-SYU-SRYYMD           =  SYU-SRYYMD     ) AND
                      (LNK-SYU-DENPNUM      NOT =  ZERO           ) AND
                      (LNK-SYU-DENPNUM          <  SYU-DENPNUM    ))
      *
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (LNK-S01-IKTGENKEIFLG     =   "1"           ) AND
                      (COMB-KOH1HKNNUM      NOT =  "970"          ) AND
                      (SYU-KOH1HKNNUM           =  "970"          ) AND
                      (SYU-NYUGAIKBN            =   "2"           ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTKEISANKBN     =   "1"           ) AND
                      (LNK-S01-IKTGENKEIFLG     =   "2"           ) AND
                      (COMB-KOH1HKNNUM          =  "970"          ) AND
                      (SYU-KOH1HKNNUM       NOT =  "970"          ) AND
                      (SYU-NYUGAIKBN            =   "2"           ))
               OR    ( SYU-ACCT-UPDKBN          =   "2"            )
      *
                   IF   (LNK-S01-SAIKEISAN-KBN    =   "1" )
                   AND  (LNK-S01-IKTGENKEIFLG NOT =  SPACE)
                   AND  (COMB-KOH1HKNNUM      NOT =  "970")
                   AND  (SYU-KOH1HKNNUM       NOT =  "970")
                   AND  (LNK-SYU-SAIKEISANKBN     =  SPACE)
                   AND  (SYU-SAIKEISANKBN         =   "1" )
                   AND  (SYU-NYUGAIKBN            =   "2" )
                   AND  (SYU-ACCT-UPDKBN      NOT =   "2" )
                     MOVE    ZERO    TO   FLG-OK
                     PERFORM    SYUNOU-CHECK-XXX-SEC
                     IF  FLG-OK  =  ZERO
                       GO    TO    SYUNOU-READ-100
                     ELSE
                       MOVE    ZERO    TO  FLG-SYUNOU
                       IF    LNK-S01-IKTSORTKBN       =   "1"
                         MOVE  ZERO    TO  SYU-DENPNUM
                       END-IF
                       MOVE    ZERO    TO  SYU-SYUCOMPFTN
                       MOVE    ZERO    TO  SYU-SYUCOMPFTN-ENTANI
                     END-IF
                   ELSE
                       GO    TO    SYUNOU-READ-100
                   END-IF
               ELSE
                       MOVE    ZERO    TO  FLG-SYUNOU
                       IF   (LNK-S01-SAIKEISAN-KBN    =   "1")
                       AND  (LNK-S01-IKTKEISANKBN     =   "1")
                       AND  (FLG-IKTKEISANKBN         =  ZERO)
                       AND  (LNK-S01-IKTSORTKBN       =   "1")
                       AND  (SYU-NYUGAIKBN            =   "2")
                         MOVE  ZERO    TO  SYU-DENPNUM
                       END-IF
               END-IF
           ELSE
               INITIALIZE                  SYU-SYUNOU-REC
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           .
      *
       SYUNOU-READ-EXT.
           EXIT.
      *****************************************************************
      *    収納マスタチェック
      *****************************************************************
       SYUNOU-CHECK-XXX-SEC          SECTION.
      *
           IF  (LNK-S01-KOUREI-ZAITAKU-KBN  =  "1"      )
           AND (COMB-KOH1HKNNUM   NOT =  "972" AND "974")
           AND (COMB-KOH2HKNNUM   NOT =  "972" AND "974")
           AND (COMB-KOH3HKNNUM   NOT =  "972" AND "974")
           AND (COMB-KOH4HKNNUM   NOT =  "972" AND "974")
             IF (( WK-2010-GNBKEIKBN-K-G(1)  =  "2"  ) AND
                 ((MAX-KIN-KOHI1-D       NOT =  ZERO) OR
                  (MAX-KIN-KOHI1-K       NOT =  ZERO)))
             OR (( WK-2010-GNBKEIKBN-K-G(2)  =  "2"  ) AND
                 ((MAX-KIN-KOHI2-D       NOT =  ZERO) OR
                  (MAX-KIN-KOHI2-K       NOT =  ZERO)))
             OR (( WK-2010-GNBKEIKBN-K-G(3)  =  "2"  ) AND
                 ((MAX-KIN-KOHI3-D       NOT =  ZERO) OR
                  (MAX-KIN-KOHI3-K       NOT =  ZERO)))
             OR (( WK-2010-GNBKEIKBN-K-G(4)  =  "2"  ) AND
                 ((MAX-KIN-KOHI4-D       NOT =  ZERO) OR
                  (MAX-KIN-KOHI4-K       NOT =  ZERO)))
                IF  ((LNK-S01-IKTSORTKBN   =  "0" OR SPACE) AND
                     (LNK-SYU-DENPNUM  NOT =  ZERO        ) AND
                     (LNK-SYU-DENPNUM  <   SYU-DENPNUM    ))
                OR  ((LNK-S01-IKTSORTKBN   =  "1"         ) AND
                     (LNK-SYU-SRYYMD   NOT =  SPACE       ) AND
                     (LNK-SYU-SRYYMD   <   SYU-SRYYMD     ))
                OR  ((LNK-S01-IKTSORTKBN   =  "1"         ) AND
                     (LNK-SYU-SRYYMD   NOT =  SPACE       ) AND
                     (LNK-SYU-SRYYMD   =   SYU-SRYYMD     ) AND
                     (LNK-SYU-DENPNUM  NOT =  ZERO        ) AND
                     (LNK-SYU-DENPNUM  <   SYU-DENPNUM    ))
                  CONTINUE
                ELSE
                  MOVE    1    TO   FLG-OK
                END-IF
             END-IF
           END-IF
      *
           .
      *
       SYUNOU-CHECK-XXX-EXT.
           EXIT.
      *****************************************************************
      *    収納マスター読込２
      *****************************************************************
       SYUNOU-READ2-SEC          SECTION.
      *
       SYUNOU-READ2-100.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYU-SYUNOU-REC
               IF    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-SYU-DENPNUM      NOT =  ZERO           ) AND
                      (LNK-SYU-DENPNUM          =  SYU-DENPNUM    ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTGENMKJFLG     =  SPACE          ) AND
                      (LNK-SYU-GRP-DENPNUM  NOT =  ZERO           ) AND
                      (LNK-SYU-GRP-DENPNUM      =  SYU-GRP-DENPNUM))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTGENMKJFLG     =  SPACE          ) AND
                      (LNK-SYU-GRP-DENPNUM  NOT =  ZERO           ) AND
                      (LNK-SYU-GRP-DENPNUM      =  SYU-DENPNUM    ))
               OR    ( SYU-ACCT-UPDKBN          =   "2"            )
                       IF  (LNK-S01-SAIKEISAN-KBN  =   "1"       )
                       AND (LNK-SYU-DENPNUM    NOT =  ZERO       )
                       AND (LNK-SYU-DENPNUM        =  SYU-DENPNUM)
                       AND (SYU-ACCT-UPDKBN    NOT =   "2"       )
                         MOVE  SYU-SECMONEY      TO
                                   WK-SYUNOU-GENBUTU-SECMONEY-MAE
                         MOVE  SYU-TOTAL-HKNTEN  TO
                                   WK-SYUNOU-GENBUTU-TOTALTEN-MAE
                       END-IF
                       GO    TO    SYUNOU-READ2-100
               ELSE
                       MOVE    ZERO    TO  FLG-SYUNOU
               END-IF
           ELSE
               INITIALIZE                  SYU-SYUNOU-REC
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           .
      *
       SYUNOU-READ2-EXT.
           EXIT.
      *****************************************************************
      *    収納マスター読込３
      *****************************************************************
       SYUNOU-READ3-SEC          SECTION.
      *
       SYUNOU-READ3-100.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYU-SYUNOU-REC
               IF    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-SYU-DENPNUM      NOT =  ZERO           ) AND
                      (LNK-SYU-DENPNUM          =  SYU-DENPNUM    ))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTGENMKJFLG     =  SPACE          ) AND
                      (LNK-SYU-GRP-DENPNUM  NOT =  ZERO           ) AND
                      (LNK-SYU-GRP-DENPNUM      =  SYU-GRP-DENPNUM))
               OR    ((LNK-S01-SAIKEISAN-KBN    =   "1"           ) AND
                      (LNK-S01-IKTGENMKJFLG     =  SPACE          ) AND
                      (LNK-SYU-GRP-DENPNUM  NOT =  ZERO           ) AND
                      (LNK-SYU-GRP-DENPNUM      =  SYU-DENPNUM    ))
               OR    ( SYU-ACCT-UPDKBN          =   "2"            )
                       GO    TO    SYUNOU-READ3-100
               ELSE
                       MOVE    ZERO    TO  FLG-SYUNOU
               END-IF
           ELSE
               INITIALIZE                  SYU-SYUNOU-REC
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           .
      *
       SYUNOU-READ3-EXT.
           EXIT.
      *****************************************************************
      *    日別収納マスタ読込
      *****************************************************************
       SYUDAY-READ-SEC          SECTION.
      *
           INITIALIZE                         SYU-SYUDAY-REC
           MOVE    SYU-HOSPNUM        TO      SDAY-HOSPNUM
           MOVE    SYU-NYUGAIKBN      TO      SDAY-NYUGAIKBN
           MOVE    SYU-PTID           TO      SDAY-PTID
           MOVE    SYU-DENPNUM        TO      SDAY-DENPNUM
           MOVE    SYU-SYUDAY-REC     TO      MCPDATA-REC
           MOVE    "DBSELECT"         TO      MCP-FUNC
           MOVE    "tbl_syuday"       TO      MCP-TABLE
           MOVE    "key"              TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
           IF      MCP-RC             =       ZERO
               MOVE    "DBFETCH"      TO      MCP-FUNC
               MOVE    "tbl_syuday"   TO      MCP-TABLE
               MOVE    "key"          TO      MCP-PATHNAME
               CALL    "ORCDBMAIN"    USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
               IF      MCP-RC              =   ZERO
                  MOVE   MCPDATA-REC  TO  SYU-SYUDAY-REC
               ELSE
                  INITIALIZE              SYU-SYUDAY-REC
               END-IF
           ELSE
                  INITIALIZE              SYU-SYUDAY-REC
           END-IF
      *
           MOVE     "tbl_syuday"      TO      MCP-TABLE
           MOVE     "key"             TO      MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
      *
       SYUDAY-READ-EXT.
           EXIT.
      *****************************************************************
      *    患者情報読込
      *****************************************************************
       PTINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTINF-REC
               MOVE    ZERO            TO  FLG-PTINF
           ELSE
               INITIALIZE                  PTINF-REC
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           .
       PTINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費情報読込
      *****************************************************************
       PTKOHINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTKOHINF-REC
               MOVE    ZERO            TO  FLG-PTKOHINF
           ELSE
               INITIALIZE                  PTKOHINF-REC
               MOVE    1               TO  FLG-PTKOHINF
           END-IF
      *
           .
       PTKOHINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者保険情報読込
      *****************************************************************
       PTHKNINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTHKNINF-REC
               MOVE    ZERO            TO  FLG-PTHKNINF
           ELSE
               INITIALIZE                  PTHKNINF-REC
               MOVE    1               TO  FLG-PTHKNINF
           END-IF
      *
           .
       PTHKNINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者労災保険情報読込
      *****************************************************************
       PTRSIINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTRSIINF-REC
               MOVE    ZERO            TO  FLG-PTRSIINF
           ELSE
               INITIALIZE                  PTRSIINF-REC
               MOVE    1               TO  FLG-PTRSIINF
           END-IF
      *
           .
       PTRSIINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費負担他院データマスター読込
      *****************************************************************
       PTKOHFTNETC-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTKOHFTNETC-REC
               MOVE    ZERO            TO  FLG-PTKOHFTNETC
           ELSE
               INITIALIZE                  PTKOHFTNETC-REC
               MOVE    1               TO  FLG-PTKOHFTNETC
           END-IF
      *
           .
       PTKOHFTNETC-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスター読込（主キー）
      *****************************************************************
       TENSU-READ-SEC         SECTION.
      *
           INITIALIZE                      TNS-TENSU-REC
           MOVE    WK-SRYCD            TO  TNS-SRYCD
           MOVE    LNK-SYU-HOSPNUM     TO  TNS-HOSPNUM
           MOVE    LNK-SYU-SRYYMD      TO  TNS-YUKOSTYMD
           MOVE    LNK-SYU-SRYYMD      TO  TNS-YUKOEDYMD
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "DBSELECT"          TO  MCP-FUNC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    "DBFETCH"           TO  MCP-FUNC
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"         USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
                   MOVE    ZERO                TO  FLG-TENSU
               ELSE
                   MOVE    1                   TO  FLG-TENSU
                   INITIALIZE                  TNS-TENSU-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-TENSU
               INITIALIZE                  TNS-TENSU-REC
           END-IF
      *
           MOVE     "tbl_tensu"            TO  MCP-TABLE
           MOVE     "key"                  TO  MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
       TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢクローズ処理
      *****************************************************************
       DB-CLOSE-SEC                 SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       DB-CLOSE-EXT.
           EXIT.
