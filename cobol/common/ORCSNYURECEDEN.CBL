      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCSNYURECEDEN.
      *****************************************************************
      *  システム名        : ＯＲＣＡ
      *  サブシステム名    : 入院
      *  コンポーネント名  : レセ電用入院会計取得サブ
      *  管理者            : 
      *  作成日付    作業者        記述
      *  04/05/18    NACL−小豆沢  新規作成
      *****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  01.00.01    NACL-藤原    04/10/19  コメント埋め込み文字の変更
      *  01.00.02    NACL-小豆沢  05/06/14  低所得患者の食事標準負担額の
      *                                     判定方法を変更（１日有効で判定）
      *  01.00.03    NACL-小豆沢  05/09/16  以下の特定入院料の外泊計算を修正
      *                                     診療所老人医療管理料
      *                                     老人性認知症疾患治療病棟入院料１
      *                                     老人性認知症疾患治療病棟入院料２
      *  01.00.04    NACL-小豆沢  06/01/06  食事の特別管理加算を月途中で変更
      *                                     した場合の対処追加
      *平成１８年４月改定対応
      *  01.00.05    NACL-小豆沢  06/03/22  特定入院料追加分（脳卒中ケアユニ）
      *                                     外泊置き換え処理
      *  01.00.06    NACL-小豆沢  06/04/05  MONFUNC対応
      *  01.00.07    NACL-小豆沢  06/04/19  食事記録方法の変更対応
      *  01.00.08    NACL-小豆沢  06/05/23  外泊時の入院基本料取得修正
      *  01.00.09    NACL-小豆沢  06/09/08  標欠対応
      *  01.00.10    NACL-小豆沢  06/09/13  定数超過対応
      *  01.00.11    NACL-小豆沢  06/10/06  療養病床レセコメント対応
      *  01.00.12    NACL-小豆沢  06/10/11  入院時生活療養費対応
      *  03.05.00    NACL-小豆沢  07/05/29  グループ診療対応
      *  03.05.01    NACL-小豆沢  07/06/19  以下入院料加算の記録順修正
      *                                     複数医師及び看護配置適合加算
      *                                     看護配置適合加算
      *  03.05.02    NACL-小豆沢  07/07/20  平成１８年４月以降の食事情報
      *                                     編集の患者所得情報取得をサブ
      *                                     ルーチンに変更
      *  04.01.01    NACL-小豆沢  07/11/20  公害保険対応（レセ電対象外）
      *  04.01.00    NACL-小豆沢  07/12/19  短期滞在手術基本料２の入院翌日の
      *                                     食事と入院料加算対応
      *  04.01.00    NACL-小豆沢  08/02/04  標欠と定数超過の外泊修正
      *平成２０年４月改定対応
      *  04.02.00    NACL-小豆沢  08/03/25  広域連合（後期高齢者）のレセ電対応
      *
      *  04.02.00    NACL-小豆沢  08/04/11  退院加算のレセ電対応（読み飛ばし）
      *                                     ・退院加算（療養病棟入院基本料等算定患者）
      *                                     ・退院加算（障害者施設等入院基本料等算定患者）
      *                                     ・早期退院加算
      *
      *  04.02.00    NACL-小豆沢  08/04/14  有床診療所の加算を注加算通番順に記録
      *                                     ・夜間緊急体制確保加算
      *                                     ・医師配置適合加算
      *                                     ・看護配置加算１
      *                                     ・看護配置加算２
      *                                     ・夜間看護配置加算１
      *                                     ・夜間看護配置加算２
      *
      *  04.02.00    NACL-小豆沢  08/04/14  小児入院医療管理料と回復期リハビリの
      *                                     加算を注加算通番順に記録
      *                                     ・プレイルーム、保育士等加算
      *                                     ・人工呼吸器使用加算（小児入院医療）
      *                                     ・重症患者回復病棟加算
      *
      *  04.02.00    NACL-小豆沢  08/04/15  特殊疾患病棟入院料の加算を注加算
      *                                     通番順に記録
      *                                     ・人工呼吸器使用加算（特殊疾患）
      *
      *  04.02.00    NACL-小豆沢  08/04/15  特定機能病院−精神病棟の加算を注加算
      *                                     通番順に記録
      *                                     ・重度認知症加算（特定機能病院精神病棟）
      *
      *  04.02.00    NACL-小豆沢  08/04/15  精神科急性期治療病棟入院料 及び
      *                                     精神科救急入院料の加算を注加算通番順に記録
      *                                     ・非定型抗精神病薬治療管理加算
      *
      *  04.02.00    NACL-小豆沢  08/04/15  療養病棟入院基本料 及び
      *                                     有床診療所療養病床入院基本料の加算を
      *                                     注加算通番順に記録
      *                                     ・褥瘡評価実施加算（療養病棟）
      *                                     ・褥瘡評価実施加算（有床診療所）
      *  04.05.00    NACL-小豆沢  09/12/03  診療入力された特別食加算の対応
      *  04.05.00    NACL-小豆沢  10/01/13  治験減点入力の読み飛ばし
      *****************************************************************
      *
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                        DIVISION.
      *FILE                        SECTION.
      *
       WORKING-STORAGE             SECTION.
      *
      *    フラグ領域
       01  FLG-AREA.
           03  FLG-NYUINACCT               PIC 9(01).
           03  FLG-NYUINACT                PIC 9(01).
           03  FLG-SRYACCT                 PIC 9(01).
           03  FLG-SRYACT                  PIC 9(01).
           03  FLG-TENSU                   PIC 9(01).
           03  FLG-PTINF                   PIC 9(01).
           03  FLG-SYSKANRI                PIC 9(01).
           03  FLG-HKNCOMBI                PIC 9(01).
           03  FLG-RJN                     PIC 9(01).
           03  FLG-ROUSAI                  PIC 9(01).
           03  FLG-RYAKU                   PIC 9(01).
           03  FLG-OK                      PIC 9(01).
           03  FLG-KSN                     PIC 9(01).
           03  FLG-SENTEI-SET              PIC 9(01).
           03  FLG-SENTEICDCHG             PIC 9(01).
           03  FLG-TSYRRK                  PIC 9(01).
           03  FLG-TNKRRK                  PIC 9(01).
           03  FLG-TENSUWRK                PIC 9(01).
           03  FLG-TOKU-SET                PIC 9(01).
           03  FLG-TOKU-SHOKU              PIC 9(01).
      *    添字領域
       01  IDX-AREA.
           03  IDX                         PIC 9(04).
           03  IDX1                        PIC 9(04).
           03  IDX2                        PIC 9(04).
           03  IDX3                        PIC 9(04).
           03  IDX4                        PIC 9(04).
           03  IDX5                        PIC 9(04).
           03  IDX6                        PIC 9(04).
           03  IDX7                        PIC 9(04).
           03  KSN-IDX                     PIC 9(04).
           03  GENSAN-IDX                  PIC 9(04).
           03  GENSAN-IDX2                 PIC 9(04).
           03  IDV                         PIC 9(04).
           03  TSY90-IDX                   PIC 9(02).
           03  ETC-IDX                     PIC 9(04).
           03  IDX-TSY90                   PIC 9(04).
           03  IDX-ADL                     PIC 9(04).
           03  MATOME-IDX                  PIC 9(04).
           03  CIDX                        PIC 9(04).
           03  CIDX2                       PIC 9(04).
      *
      *    コンスタント値
       01  CONSTANT-AREA.
      *    入院診療計画未実施減算
           03  CONS-KEIKAKU-GENSAN1        PIC X(09) VALUE "190080470".
           03  CONS-KEIKAKU-GENSAN2        PIC X(09) VALUE "190799670".
      *    院内感染防止対策未実施減算
           03  CONS-INNAI-GENSAN1          PIC X(09) VALUE "190080570".
           03  CONS-INNAI-GENSAN2          PIC X(09) VALUE "190799770".
      *    医療安全管理体制未整備減算
           03  CONS-ANZEN-GENSAN1          PIC X(09) VALUE "190111690".
           03  CONS-ANZEN-GENSAN2          PIC X(09) VALUE "190809090".
      *    褥瘡対策未実施減算
           03  CONS-JYOKU-GENSAN1          PIC X(09) VALUE "190111790".
           03  CONS-JYOKU-GENSAN2          PIC X(09) VALUE "190809190".
      *    日常生活障害加算
           03  CONS-NICHIJOU-KSN1          PIC X(09) VALUE "190109170".
           03  CONS-NICHIJOU-KSN2          PIC X(09) VALUE "190807570".
      *    認知症加算
           03  CONS-CHIHOU-KSN1            PIC X(09) VALUE "190109270".
           03  CONS-CHIHOU-KSN2            PIC X(09) VALUE "190808670".
      *    褥瘡患者管理加算
           03  CONS-JYOKU-KSN1             PIC X(09) VALUE "190116990".
           03  CONS-JYOKU-KSN2             PIC X(09) VALUE "190813390".
      *    特定抗精神病薬治療管理加算
           03  CONS-TOKUSEIYAKU-KSN        PIC X(09) VALUE "190117570".
      *    その他診療行為で入力した入院料加算
           03  CONS-ETCNYUIN-TBL.
             05  CONS-ETCNYUIN-KSN         PIC X(09)  OCCURS 10.
      *    点数マスタ読み込みワーク用
           03  TTNS-CONST-MAX              PIC 9(03) VALUE 200.
      *
      *
      *    退院加算（障害者施設等入院基本料等算定患者）
           03  CONS-TAIIN1                 PIC X(09) VALUE "190128410".
      *    退院加算（療養病棟入院基本料等算定患者）
           03  CONS-TAIIN2                 PIC X(09) VALUE "190128310".
      *    早期退院加算
           03  CONS-TAIIN3                 PIC X(09) VALUE "190128570".
      *    退院加算（障害者施設等入院基本料等算定患者）＋早期退院加算
           03  CONS-TAIIN4                 PIC X(09) VALUE "380256980".
      *
      *    一時領域
       01  WRK-AREA.
      *
           03  WRK-MM-X                    PIC X(02).
           03  WRK-MM-9     REDEFINES   WRK-MM-X
                                           PIC 9(02).
           03  WRK-GAIHAKU-SRYCD           PIC X(09).
           03  WRK-MEISAISU                PIC 9(03).
           03  WRK-KSNKBN                  PIC 9(03).
      *
           03  WRK-SYS5000-COUNT           PIC 9(02).
      *
           03  WRK-GENSAN2-MIJISI          PIC 9(01).
           03  WRK-GENSAN3-MIJISI          PIC 9(01).
           03  WRK-GENSAN4-MIJISI          PIC 9(01).
      *
      *    入院会計ワーク
           03  WRK-NYUIN-TABLE.
               05  WRK-NYUIN-TBL           OCCURS  31.
                   07  WRK-HKNCOMBI-DAY    PIC 9(03).
                   07  WRK-SRYKBN          PIC X(02).
                   07  WRK-NYUINKHN        PIC X(09).
                   07  WRK-SHOKIKSN        PIC X(09).
                   07  WRK-HYOUKETSU       PIC X(09).
                   07  WRK-TEISU           PIC X(09).
                   07  WRK-GAIHAKU         PIC X(09).
                   07  WRK-NYUKHNKSNKBN    PIC 9(03).
                   07  WRK-GAIHAKU-KBN     PIC 9(01).
      *
      *    入院会計並び替えワーク
           03  WRK-NYUIN-SORT-TABLE.
               05  WRK-NYUIN-SORT-TBL      OCCURS  31.
                   07  WRK-SO-MEISAISU     PIC 9(02).
                   07  WRK-SO-HKNCOMBI-DAY PIC 9(03).
                   07  WRK-SO-SRYKBN       PIC X(02).
                   07  WRK-SO-SRYCD        PIC X(09)  OCCURS 20.
                   07  WRK-SO-SRYCDTOTAL   PIC 9(14).
                   07  WRK-SO-TEN          PIC 9(07).
                   07  WRK-SO-KAISU        PIC 9(02).
                   07  WRK-SO-ADL-TEN-MOJI PIC X(04).
                   07  WRK-SO-GAIHAKU-TBL.
                     09  WRK-SO-GAIHAKU-KBN  PIC 9(01)  OCCURS 31.
                   07  WRK-SO-IRYOADL-DAY  PIC 9(02).
      *
      *    同一剤まとめ用比較キー
           03  WRK-OLD-KEY.
               05  WRK-OLD-MEISAISU        PIC 9(02).
               05  WRK-OLD-HKNCOMBI-DAY    PIC 9(03).
               05  WRK-OLD-SRYCDTOTAL      PIC 9(14).
               05  WRK-OLD-TEN             PIC 9(07).
           03  WRK-NEW-KEY.
               05  WRK-NEW-MEISAISU        PIC 9(02).
               05  WRK-NEW-HKNCOMBI-DAY    PIC 9(03).
               05  WRK-NEW-SRYCDTOTAL      PIC 9(14).
               05  WRK-NEW-TEN             PIC 9(07).
      *
      *    療養病床コメント並び替えワーク
           03  WRK-IRYOADL-TABLE.
               05  WRK-IRYOADL-SORT-TBL      OCCURS  31.
                   07  WRK-IRYOADL-DAY          PIC 9(02).
                   07  WRK-IRYOADL-MEISAISU     PIC 9(02).
                   07  WRK-IRYOADL-SRYCD        PIC X(09)  OCCURS 30.
                   07  WRK-IRYOADL-SRYCDTOTAL   PIC 9(14).
                   07  WRK-IRYOADL-ADL-SRYCD    PIC X(09).
                   07  WRK-IRYOADL-TEN          PIC 9(07).
                   07  WRK-IRYOADL-TEN-MOJI     PIC X(04).
                   07  WRK-IRYOADL-ADL-SRYCD-H22 PIC X(09) OCCURS 4.
                   07  WRK-IRYOADL-TEN-H22      PIC 9(07)  OCCURS 4.
                   07  WRK-IRYOADL-TEN-MOJI-H22 PIC X(04)  OCCURS 4.
                   07  WRK-IRYOADL-GAITOU-TBL.
                     09  WRK-IRYOADL-GAITOU-KBN   PIC 9(01)  OCCURS 31.
      *
      *    複数医師及び看護配置適合加算退避領域（平成２０年３月まで）
           03  WRK-FUKUSU-NYUKSN-AREA.
                   07  WRK-FUKUSU-NYUKSN         PIC X(09).
                   07  WRK-FUKUSU-NYUKSN-ZAITEN  PIC 9(08).
                   07  WRK-FUKUSU-NYUKSN-DAY     PIC 9(03)  OCCURS 31.
      *
      *    看護配置適合加算退避領域（平成２０年３月まで）
           03  WRK-KANGO-NYUKSN-AREA.
                   07  WRK-KANGO-NYUKSN          PIC X(09).
                   07  WRK-KANGO-NYUKSN-ZAITEN   PIC 9(08).
                   07  WRK-KANGO-NYUKSN-DAY      PIC 9(03)  OCCURS 31.
      *
      *    注加算通番をもつ入院料加算の退避領域（平成２０年４月より）
      *    １夜間緊急体制確保加算
      *    ２医師配置適合加算（平成２２年４月より医師配置加算２）
      *    ３看護配置加算１（平成２２年４月より看護配置加算２）
      *    ４看護配置加算２（平成２２年４月より看護配置加算１）
      *    ５夜間看護配置加算１（平成２２年４月より夜間看護配置加算２）
      *    ６夜間看護配置加算２（平成２２年４月より夜間看護配置加算１）
      *    ７人工呼吸器使用加算（特殊疾患）
      *    ８プレイルーム、保育士等加算
      *    ９人工呼吸器使用加算（小児入院医療）
      *  １０重度認知症加算（特定機能病院精神病棟）
      *  １１非定型抗精神薬治療管理加算（平成２２年４月より非定型抗精神薬加算２）
      *  １２褥瘡評価実施加算（療養病棟）
      *  １３褥瘡評価実施加算（有床診療所）
      *  １４重症患者回復病棟加算
      *   注加算通番をもつ入院料加算の退避領域（平成２２年４月追加分）
      *  １５医師配置加算１
      *  １６充実段階Ａ加算
      *  １７充実段階Ｂ加算
      *  １８高度医療体制加算
      *  １９小児加算（特定集中治療室管理料　７日以内）
      *  ２０小児加算（特定集中治療室管理料　８日以上１４日未満）
      *  ２１重症児（者）受入連携加算
      *  ２２非定型抗精神病薬加算１
      *  ２３休日リハビリテーション提供体制加算
      *  ２４リハビリテーション充実加算
      *  ２５超重症児（者）入院診療加算（６歳以上）
      *  ２６準超重症児（者）入院診療加算（６歳以上）
      *  ２７超重症児（者）入院診療加算（６歳未満）
      *  ２８準超重症児（者）入院診療加算（６歳未満）
      *  ２９在宅重症児（者）受入加算
      *  ３０医療安全対策加算１
      *  ３１感染防止対策加算
      *  ３２リハビリテーション提供体制加算
      *  ３３重症患者回復病棟加算（基準未適合）
           03  WRK-CHUKSN-NYUKSN-AREA.
             05   WRK-CHUKSN-NYUKSN-TBL      OCCURS  33.
               07  WRK-CHUKSN-NYUKSN         PIC X(09).
               07  WRK-CHUKSN-NYUKSN-ZAITEN  PIC 9(08).
               07  WRK-CHUKSN-NYUKSN-DAY     PIC 9(03)  OCCURS 31.
      *
      *    入院料加算退避領域
           03  WRK-NYUKSN-TABLE.
               05  WRK-NYUKSN-TBL          OCCURS  20.
                   07  WRK-NYUKSN          PIC X(09).
                   07  WRK-NYUKSN-ZAITEN   PIC 9(08).
                   07  WRK-NYUKSN-DAY      PIC 9(03)  OCCURS 31.
      *
      *    未実施減算退避用フラグテーブル
           03  WRK-GENSAN-TABLE.
               05  WRK-GENSAN-INF          OCCURS  31.
                   07  WRK-GENSAN-INNAI    PIC X(01).
                   07  WRK-GENSAN-IRYO     PIC X(01).
                   07  WRK-GENSAN-JYOKU    PIC X(01).
      *
      *    院内感染防止対策未実施減算ワーク
           03  WRK-GENSAN2                 PIC X(09).
      *    医療安全管理体制未整備減算ワーク
           03  WRK-GENSAN3                 PIC X(09).
      *    褥瘡対策未実施減算ワーク
           03  WRK-GENSAN4                 PIC X(09).
      *
      *    入院診療計画未実施減算ワーク
           03  WRK-KEIKAKU-GENSAN1         PIC 9(03) OCCURS 31.
           03  WRK-KEIKAKU-GENSAN2         PIC 9(03) OCCURS 31.
      *    院内感染防止対策未実施減算ワーク
           03  WRK-INNAI-GENSAN1           PIC 9(03) OCCURS 31.
           03  WRK-INNAI-GENSAN2           PIC 9(03) OCCURS 31.
      *    医療安全管理体制未整備減算ワーク
           03  WRK-ANZEN-GENSAN1           PIC 9(03) OCCURS 31.
           03  WRK-ANZEN-GENSAN2           PIC 9(03) OCCURS 31.
      *    褥瘡対策未実施減算ワーク
           03  WRK-JYOKU-GENSAN1           PIC 9(03) OCCURS 31.
           03  WRK-JYOKU-GENSAN2           PIC 9(03) OCCURS 31.
      *
      *    日常生活障害加算退避
           03  WRK-NICHIJOU-KSN1           PIC 9(03) OCCURS 31.
           03  WRK-NICHIJOU-KSN2           PIC 9(03) OCCURS 31.
      *
      *    認知症加算退避
           03  WRK-CHIHOU-KSN1             PIC 9(03) OCCURS 31.
           03  WRK-CHIHOU-KSN2             PIC 9(03) OCCURS 31.
      *
      *    褥瘡患者管理加算
           03  WRK-JYOKU-KSN1              PIC 9(03) OCCURS 31.
           03  WRK-JYOKU-KSN2              PIC 9(03) OCCURS 31.
      *
      *    特定抗精神病薬治療管理加算
           03  WRK-TOKUSEIYAKU-KSN         PIC 9(03) OCCURS 31.
      *
      *    その他診療行為で入力した入院料加算
           03  WRK-ETCNYUIN-TBL            OCCURS  10.
             05  WRK-ETCNYUIN-KSN          PIC 9(03) OCCURS 31.
      *
      *    診療コード計集計用
           03  WRK-SRYCD-X                 PIC X(09).
           03  WRK-SRYCD-9    REDEFINES    WRK-SRYCD-X
                                           PIC 9(09).
      *
      *    システム管理食事退避領域
           03  WRK-SYS5000-SKJ             OCCURS  5.
               05  WRK-SYS5000-SHOKUCD     PIC X(09) OCCURS 31.
      *    食事ワーク
           03  WRK-SKJ-TABLE.
               05  WRK-SKJ-TBL           OCCURS  31.
                   07  WRK-SKJ-HKNCOMBI-DAY    PIC 9(03).
                   07  WRK-SKJ-GRP.
                       09  WRK-SKJ-RYOYO       PIC X(09).
                       09  WRK-SKJ-TOKU-KANRI  PIC X(09).
                       09  WRK-SKJ-SHOKUDOU    PIC X(09).
                   07  WRK-SKJ-GRPR    REDEFINES  WRK-SKJ-GRP.
                       09  WRK-SKJ-SRYCD       PIC X(09)
                                               OCCURS  3.
                   07  WRK-SKJ-SRYCDTOTAL      PIC 9(14).
                   07  WRK-SKJ-KAISU           PIC 9(02).
                   07  WRK-SKJ-MONEY           PIC 9(07).
      *    食事ワーク２（複数献立加算）
           03  WRK-SKJ2-TABLE.
               05  WRK-SKJ2-TBL          OCCURS  31.
                   07  WRK-SKJ2-HKNCOMBI-DAY   PIC 9(03).
                   07  WRK-SKJ2-FUKUSU         PIC X(09).
                   07  WRK-SKJ2-KAISU          PIC 9(02).
      *    食事ワーク３（特別食加算）
           03  WRK-SKJ3-TABLE.
               05  WRK-SKJ3-TBL          OCCURS  31.
                   07  WRK-SKJ3-HKNCOMBI-DAY   PIC 9(03).
                   07  WRK-SKJ3-TOKU-SHOKU     PIC X(09).
                   07  WRK-SKJ3-KAISU          PIC 9(02).
      *    食事ワーク４（食事療養費）（平成１８年４月以降）
           03  WRK-SKJ4-TABLE.
               05  WRK-SKJ4-TBL          OCCURS  93.
                   07  WRK-SKJ4-HKNCOMBI-DAY   PIC 9(03).
                   07  WRK-SKJ4-RYOYO          PIC X(09).
                   07  WRK-SKJ4-KAISU          PIC 9(02).
      *    食事ワーク５（特別食加算）（平成１８年４月以降）
           03  WRK-SKJ5-TABLE.
               05  WRK-SKJ5-TBL          OCCURS  93.
                   07  WRK-SKJ5-HKNCOMBI-DAY   PIC 9(03).
                   07  WRK-SKJ5-TOKU-SHOKU     PIC X(09).
                   07  WRK-SKJ5-KAISU          PIC 9(02).
      *    食事ワーク６（食堂加算）（平成１８年４月以降）
           03  WRK-SKJ6-TABLE.
               05  WRK-SKJ6-TBL          OCCURS  31.
                   07  WRK-SKJ6-HKNCOMBI-DAY   PIC 9(03).
                   07  WRK-SKJ6-SHOKUDOU       PIC X(09).
                   07  WRK-SKJ6-KAISU          PIC 9(02).
      *    食事ワーク７
           03  WRK-SKJ7-TABLE.
               05  WRK-SKJ7-TBL           OCCURS  31.
                   07  WRK-SKJ7-HKNCOMBI-DAY   PIC 9(03).
                   07  WRK-SKJ7-GRP.
                       09  WRK-SKJ7-RYOYO       PIC X(09).
                       09  WRK-SKJ7-RYOYO-SU    PIC 9(01).
                       09  WRK-SKJ7-SHOKUDOU    PIC X(09).
                       09  WRK-SKJ7-TOKU-SHOKU  PIC X(09).
                       09  WRK-SKJ7-TOKU-SHOKU-SU PIC 9(01).
                       09  WRK-SKJ7-TOKU-SHOKU-KAISU1 PIC 9(02).
                       09  WRK-SKJ7-TOKU-SHOKU-KAISU2 PIC 9(02).
                       09  WRK-SKJ7-TOKU-SHOKU-KAISU3 PIC 9(02).
                       09  WRK-SKJ7-SKJFTN      PIC X(09).
                       09  WRK-SKJ7-SKJFTN-SU   PIC 9(01).
                   07  WRK-SKJ7-SRYCDTOTAL      PIC 9(14).
                   07  WRK-SKJ7-KAISU           PIC 9(02).
      *
      *    入院時生活療養（環境療養）ワーク
           03  WRK-KANKYO-TABLE.
               05  WRK-KANKYO-TBL           OCCURS  31.
                   07  WRK-KANKYO-HKNCOMBI-DAY  PIC 9(03).
                   07  WRK-KANKYO-GRP.
                       09  WRK-KANKYO-RYOYO     PIC X(09).
                       09  WRK-KANKYO-FTN       PIC X(09).
                   07  WRK-KANKYO-SRYCDTOTAL    PIC 9(14).
                   07  WRK-KANKYO-KAISU         PIC 9(02).
      *
      *    点数マスタ退避ワーク
           03  WRK-TENSU-OCC                   OCCURS  200.
               05  WRK-TENSU-SRYCD             PIC X(09).
               05  WRK-TENSU-DATA              PIC X(2000).
           03  WRK-TENSU-CD                    PIC X(09).
           03  TTNS-IDX                        PIC 9(03).
           03  TTNS-MAX                        PIC 9(03).
      *
      *    食事負担ワーク
           03  WRK-SKJFTN-TABLE.
               05  WRK-SKJFTN-TBL        OCCURS  31.
                   07  WRK-SKJFTN-HKNCOMBI-DAY PIC 9(03).
                   07  WRK-SKJFTN-SRYCD        PIC X(09).
                   07  WRK-SKJFTN-KAISU        PIC 9(02).
      *
      *    食事負担ワーク（平成１８年４月以降）
           03  WRK-SKJFTN2-TABLE.
               05  WRK-SKJFTN2-TBL       OCCURS  93.
                   07  WRK-SKJFTN2-HKNCOMBI-DAY PIC 9(03).
                   07  WRK-SKJFTN2-SRYCD        PIC X(09).
                   07  WRK-SKJFTN2-KAISU        PIC 9(02).
      *
      *    選定療養退避用テーブル
           03  TABLE-SENTEI.
               05  TBL-SENTEI                  PIC 9(01)   OCCURS  31.
      *
      *    外泊コメント用日付退避領域
           03  WRK-GAIHAKU-DAY-TABLE.
               05  WRK-GAIHAKU-DAY             OCCURS  31.
                   07  WRK-GAIHAKU-DAY-ST      PIC  9(02).
                   07  WRK-GAIHAKU-DAY-ED      PIC  9(02).
      *
      *    療養コメント用日付退避領域
           03  WRK-RYOYO-DAY-TABLE.
               05  WRK-RYOYO-DAY               OCCURS  31.
                   07  WRK-RYOYO-DAY-ST        PIC  9(02).
                   07  WRK-RYOYO-DAY-ED        PIC  9(02).
      *
      *    日付全角変換領域
       01  TBL-DAY-AREA.
           03  FILLER              PIC X(04)  VALUE "０１".
           03  FILLER              PIC X(04)  VALUE "０２".
           03  FILLER              PIC X(04)  VALUE "０３".
           03  FILLER              PIC X(04)  VALUE "０４".
           03  FILLER              PIC X(04)  VALUE "０５".
           03  FILLER              PIC X(04)  VALUE "０６".
           03  FILLER              PIC X(04)  VALUE "０７".
           03  FILLER              PIC X(04)  VALUE "０８".
           03  FILLER              PIC X(04)  VALUE "０９".
           03  FILLER              PIC X(04)  VALUE "１０".
           03  FILLER              PIC X(04)  VALUE "１１".
           03  FILLER              PIC X(04)  VALUE "１２".
           03  FILLER              PIC X(04)  VALUE "１３".
           03  FILLER              PIC X(04)  VALUE "１４".
           03  FILLER              PIC X(04)  VALUE "１５".
           03  FILLER              PIC X(04)  VALUE "１６".
           03  FILLER              PIC X(04)  VALUE "１７".
           03  FILLER              PIC X(04)  VALUE "１８".
           03  FILLER              PIC X(04)  VALUE "１９".
           03  FILLER              PIC X(04)  VALUE "２０".
           03  FILLER              PIC X(04)  VALUE "２１".
           03  FILLER              PIC X(04)  VALUE "２２".
           03  FILLER              PIC X(04)  VALUE "２３".
           03  FILLER              PIC X(04)  VALUE "２４".
           03  FILLER              PIC X(04)  VALUE "２５".
           03  FILLER              PIC X(04)  VALUE "２６".
           03  FILLER              PIC X(04)  VALUE "２７".
           03  FILLER              PIC X(04)  VALUE "２８".
           03  FILLER              PIC X(04)  VALUE "２９".
           03  FILLER              PIC X(04)  VALUE "３０".
           03  FILLER              PIC X(04)  VALUE "３１".
       01  TBL-DAY-AREA-R          REDEFINES   TBL-DAY-AREA.
           03  TBL-DAY             PIC X(04)   OCCURS   31.
      *
      *    患者所得情報の退避領域
       01  WRK-SYOTOKU-SKJKBN-AREA.
           03  WRK-SYOTOKU-SKJKBN       PIC X(01)   OCCURS  93.
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    システム管理マスタ
           COPY    "CPSYSKANRI.INC".
      *
           COPY    "CPSK1001.INC".
           COPY    "CPSK5000.INC".
      *
      *    入院診療会計マスタ−
       01  NYUINACCT-REC.
           COPY    "CPNYUINACCT.INC".
      *
      *    入院診療行為マスター
       01  NYUINACT-REC.
           COPY    "CPNYUINACT.INC".
      *
      *    診療会計
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    診療行為
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    点数マスタ−
           COPY    "CPTENSU.INC".
      *
      *    患者マスタ−
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    保険組み合わせ
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    選定療養費
       01  SENTEICDCHG-REC.
           COPY    "CPSENTEICDCHG.INC".
      *
      *    低所得
       01  TSYRRK-REC.
           COPY    "CPTSYRRK.INC".
      *
      *    年金
       01  TNKRRK-REC.
           COPY    "CPTNKRRK.INC".
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      *
           COPY    "MCPAREA".
      *
      *****************************************************************
      *    サブプロ用　領域
      *****************************************************************
      *
      *   日付変換サブ
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *
      *    保険算定用年齢・割合計算サブ
           COPY    "CPORCSAGECHK.INC".
      *
      *    療養レセコメント取得サブ
           COPY    "CPORCSRYOCOM.INC".
      *
      *    入院時生活療養費負担額取得サブ
           COPY    "CPORCSNYULIFE.INC".
      *
      *    患者所得情報編集サブ
           COPY    "CPORCSSYOTOKU.INC".
      *
      *    入院料未算定日取得サブ
           COPY    "CPORCSNYUINDAY.INC".
      *
      *****************************************************************
      *    連絡　領域
      *****************************************************************
        LINKAGE                     SECTION.
      *
      *    スパ領域
           COPY    "COMMON-SPA".
      *    入院会計作成用パラメタ
           COPY    "CPORCSNYURECEDEN.INC".
      *
       PROCEDURE                   DIVISION    USING
           ORCSNYURECEDEN-AREA
           SPA-AREA
           .
      *
      *****************************************************************
      *    主　　処理
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  IDX-AREA
           INITIALIZE                  WRK-AREA
           INITIALIZE                  LNK-NYURECEDEN-HENKYAKU-AREA
           INITIALIZE                  CONS-ETCNYUIN-TBL
           MOVE    ZERO                TO  LNK-NYURECEDEN-RC
      *
      *    パラメータチェック
           PERFORM 100-PRM-CHK-SEC
      *
      *    主処理
           IF      LNK-NYURECEDEN-RC      =    ZERO
               PERFORM 200-MAIN-SEC
           END-IF
      *
      *    診療行為入力された特別食加算の編集
           PERFORM   2103-TOKU-SHOKU-HENSHU-SEC
           IF        FLG-TOKU-SET        =     1
               MOVE   ZERO             TO  LNK-NYURECEDEN-RC
           END-IF
      *
           .
       000-PROC-EXT.
      *
           EXIT    PROGRAM
           .
      *
      *****************************************************************
      *    パラメータチェック
      *****************************************************************
       100-PRM-CHK-SEC                     SECTION.
      *
      *    算定年月チェック
           IF    ( LNK-NYURECEDEN-SANTEIYM    =   SPACE )
               MOVE    1               TO  LNK-NYURECEDEN-RC
               GO  TO  100-PRM-CHK-EXT
           END-IF
      *
      *    患者マスター検索
           INITIALIZE                      PTINF-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  PTINF-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  PTINF-PTID
           PERFORM 900-PTINF-READ-SEC
           IF      FLG-PTINF           NOT =   ZERO
               MOVE    2               TO  LNK-NYURECEDEN-RC
               GO  TO  100-PRM-CHK-EXT
           END-IF
      *
      *    保険区分チェック
           IF     LNK-NYURECEDEN-HKNKBN    =   "1"  OR  "2"  OR  "3"
               CONTINUE
           ELSE
               MOVE    3               TO  LNK-NYURECEDEN-RC
               GO  TO  100-PRM-CHK-EXT
           END-IF
      *
      *    入院中のチェック（入院会計マスターの保険組合せ検索）
           INITIALIZE                      NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "5"                     TO  NACCT-ZAISKBKBN
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           NOT =   ZERO
               MOVE    4               TO  LNK-NYURECEDEN-RC
           ELSE
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key17"             TO  MCP-PATHNAME
               PERFORM 910-NYUINACCT-READ-SEC
               IF   FLG-NYUINACCT          NOT =   ZERO
                    MOVE    4              TO  LNK-NYURECEDEN-RC
               ELSE
                    PERFORM    VARYING   IDX1   FROM   1   BY   1
                               UNTIL     IDX1   >      31
                        MOVE   NACCT-DAY (IDX1) TO 
                                            WRK-HKNCOMBI-DAY(IDX1)
                    END-PERFORM
               END-IF
           END-IF
      *
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *医療機関減算情報の取得（システム管理テーブルより）
           MOVE    ZERO                TO  FLG-SYSKANRI
           INITIALIZE                      SYSKANRI-REC
           MOVE    "1001"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    LNK-NYURECEDEN-SANTEIYM
                                       TO  SYS-STYUKYMD(1:6)
           MOVE    "01"                TO  SYS-STYUKYMD(7:2)
           MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
           MOVE    LNK-NYURECEDEN-HOSPNUM
                                       TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"  TO  MCP-TABLE
               MOVE    "key10"         TO  MCP-PATHNAME
               PERFORM  910-SYSKANRI-READ-SEC
               IF       FLG-SYSKANRI   =   0
                   MOVE   SYS-1001-HOSPSBT
                                       TO  SPA-HOSPSBT
               END-IF
           END-IF
      *    システム管理クローズ
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
           .
       100-PRM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    主取得
      *****************************************************************
       200-MAIN-SEC            SECTION.
      *
      *短期滞在手術基本料２と３の入院料未算定日について取得
           INITIALIZE                             ORCSNYUINDAY-AREA
           MOVE    LNK-NYURECEDEN-HOSPNUM     TO  LNK-NYUINDAY-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID        TO  LNK-NYUINDAY-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM    TO  LNK-NYUINDAY-SANTEIYM
           CALL    "ORCSNYUINDAY"         USING   ORCSNYUINDAY-AREA
                                                  SPA-AREA
      *
      *レセ電対象保険組合せ番号の取得
           PERFORM    VARYING   IDX   FROM   1   BY   1
                      UNTIL      IDX  >    31
               IF     WRK-HKNCOMBI-DAY(IDX)   NOT =   ZERO
                   INITIALIZE                          HKNCOMBI-REC
                   MOVE    LNK-NYURECEDEN-HOSPNUM  TO  COMB-HOSPNUM
                   MOVE    LNK-NYURECEDEN-PTID     TO  COMB-PTID
                   MOVE    WRK-HKNCOMBI-DAY(IDX)   TO  COMB-HKNCOMBINUM
                   MOVE    "tbl_hkncombi"          TO  MCP-TABLE
                   MOVE    "key"                   TO  MCP-PATHNAME
                   PERFORM 910-HKNCOMBI-SELECT-SEC
                   IF      FLG-HKNCOMBI            =   ZERO
                       MOVE    "tbl_hkncombi"      TO  MCP-TABLE
                       MOVE    "key"               TO  MCP-PATHNAME
                       PERFORM   910-HKNCOMBI-READ-SEC
                       IF   FLG-HKNCOMBI         =  ZERO
                            IF    ( COMB-HKNNUM   = "971" OR "973" OR
                                                    "975")
                                            OR
                                  ( COMB-HKNNUM(1:2)  =    "98")
                                MOVE   ZERO   TO  WRK-HKNCOMBI-DAY(IDX)
                            ELSE
                                EVALUATE   LNK-NYURECEDEN-HKNKBN
      *                             社保
                                    WHEN   "1"
                                        IF   COMB-HKNNUM = "060"  OR
                                                           "067"  OR
                                                           "068"  OR
                                                           "069"  OR
                                                           "039"  OR
                                                           "040"
                                        MOVE   ZERO  TO  
                                                  WRK-HKNCOMBI-DAY(IDX)
                                        END-IF
      *                             国保
                                    WHEN   "2"
                                        IF   COMB-HKNNUM = "060"  OR
                                                           "067"
                                            CONTINUE
                                        ELSE
                                            MOVE   ZERO  TO  
                                                  WRK-HKNCOMBI-DAY(IDX)
                                        END-IF
      *                             広域連合
                                    WHEN   "3"
                                        IF   COMB-HKNNUM = "039"
                                            CONTINUE
                                        ELSE
                                            MOVE   ZERO  TO  
                                                  WRK-HKNCOMBI-DAY(IDX)
                                        END-IF
                                END-EVALUATE
                            END-IF
                       ELSE
                           MOVE    5          TO  LNK-NYURECEDEN-RC
                       END-IF
      *                保険組合せクローズ
                       MOVE    "tbl_hkncombi"          TO  MCP-TABLE
                       MOVE    "key"                   TO  MCP-PATHNAME
                       PERFORM   900-CLOSE-SEC
                   ELSE
      *                保険組合せクローズ
                       MOVE    "tbl_hkncombi"          TO  MCP-TABLE
                       MOVE    "key"                   TO  MCP-PATHNAME
                       PERFORM   900-CLOSE-SEC
                       MOVE    5              TO  LNK-NYURECEDEN-RC
                   END-IF
               END-IF
           END-PERFORM
      *
      *入院料の取得
           MOVE    ZERO                    TO  FLG-OK
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "1"                     TO  NACCT-ZAISKBKBN
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key17"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
                   MOVE      ZERO     TO      FLG-RYAKU
                                              WRK-KSNKBN
                   IF    NACCT-SRYCDTOTAL     =    99999916
                       CONTINUE
                   ELSE
      *                該当入院行為テーブルの読み込み
                       PERFORM    210-NYUINACT-GET-SEC
      *                入院基本料と初期加算（長期減算）の退避
                       PERFORM    VARYING   IDX1   FROM   1   BY   1
                                  UNTIL     IDX1   >   31
                           IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)
                           AND   (NACCT-DAY(IDX1)    NOT =  ZERO)
                               MOVE    NSRY-SRYCD(1)   TO  
                                                   WRK-NYUINKHN(IDX1)
      *
                               IF  (NSRY-SRYCD(2) NOT =  SPACE)  AND
                                   (NSRY-SRYCD(2) NOT = "190107890" AND
                                                        "190107990" AND
                                                        "190108590" AND
                                                        "190108690" AND
                                                        "190107690" AND
                                                        "190107790" AND
                                                        "190122990" AND
                                                        "190123090")
                                   MOVE   NSRY-SRYCD(2)  TO
                                                   WRK-SHOKIKSN(IDX1)
                               END-IF
      *                        標欠コード
                               IF  (NSRY-SRYCD(2)  NOT =   SPACE)  AND
                                   (NSRY-SRYCD(2)  =   "190107890" OR
                                                       "190107990" OR
                                                       "190108590" OR
                                                       "190108690")
                                   MOVE   NSRY-SRYCD(2)  TO
                                                   WRK-HYOUKETSU(IDX1)
                               END-IF
      *                        標欠コード
                               IF  (NSRY-SRYCD(3)  NOT =   SPACE)  AND
                                   (NSRY-SRYCD(3)  =   "190107890" OR
                                                       "190107990" OR
                                                       "190108590" OR
                                                       "190108690")
                                   MOVE   NSRY-SRYCD(3)  TO
                                                   WRK-HYOUKETSU(IDX1)
                               END-IF
      *                        定数超過コード
                               IF  (NSRY-SRYCD(2)  NOT =   SPACE)  AND
                                   (NSRY-SRYCD(2)  =   "190107690" OR
                                                       "190107790" OR
                                                       "190122990" OR
                                                       "190123090")
                                   MOVE   NSRY-SRYCD(2)  TO
                                                   WRK-TEISU(IDX1)
                               END-IF
      *                        定数超過コード
                               IF  (NSRY-SRYCD(3)  NOT =   SPACE)  AND
                                   (NSRY-SRYCD(3)  =   "190107690" OR
                                                       "190107790" OR
                                                       "190122990" OR
                                                       "190123090")
                                   MOVE   NSRY-SRYCD(3)  TO
                                                   WRK-TEISU(IDX1)
                               END-IF
      *                        診療区分
                               MOVE    NACCT-SRYKBN
                                                TO  WRK-SRYKBN(IDX1)
                               IF   FLG-RYAKU   =   ZERO
      *
      *                           外泊コード編集用に入院基本料加算区分
      *                           の退避
                                  PERFORM   210-GAIHAKU-MAE-SEC
      *
                                  MOVE    1     TO    FLG-RYAKU
                               END-IF
      *
                               MOVE  WRK-KSNKBN
                                         TO  WRK-NYUKHNKSNKBN(IDX1)
      *
                               MOVE    1    TO   FLG-OK
                           END-IF
                           IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)
                           AND   (LNK-NYUINDAY-KBN(IDX1)  =  "1")
                               MOVE    1    TO   FLG-OK
                           END-IF                           
                       END-PERFORM
                   END-IF
                   MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                   MOVE    "key17"                 TO  MCP-PATHNAME
                   PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
               IF   FLG-OK     =   ZERO
                   MOVE     4      TO      LNK-NYURECEDEN-RC
      *            入院会計クローズ
                   MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                   MOVE    "key17"                 TO  MCP-PATHNAME
                   PERFORM   900-CLOSE-SEC
                   GO   TO    200-MAIN-EXT
               END-IF
           ELSE
               MOVE     4      TO      LNK-NYURECEDEN-RC
      *        入院会計クローズ
               MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
               MOVE    "key17"                 TO  MCP-PATHNAME
               PERFORM   900-CLOSE-SEC
               GO   TO    200-MAIN-EXT
           END-IF
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *入院時の外泊取得
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "2"                     TO  NACCT-ZAISKBKBN
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key17"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
      *            外泊区分の退避
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                              UNTIL     IDX1   >   31
                       IF    (WRK-NYUINKHN(IDX1) NOT = SPACE) 
                       AND   (NACCT-DAY(IDX1)    NOT =  ZERO) 
                              PERFORM     210-GAIHAKU-SET-SEC
                       END-IF
                   END-PERFORM
                   MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                   MOVE    "key17"                 TO  MCP-PATHNAME
                   PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *選定療養情報の取得
           MOVE    ZERO                    TO  FLG-SENTEI-SET
           MOVE    ZERO                    TO  FLG-NYUINACCT
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key22"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key22"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
      *            選定入院の退避
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                              UNTIL     IDX1   >   31
                       IF    (WRK-NYUINKHN(IDX1) NOT = SPACE) 
                       AND   (NACCT-DAY(IDX1)    NOT =  ZERO) 
                           MOVE   NACCT-DAY(IDX1)
                                              TO  TBL-SENTEI (IDX1)
                           MOVE     1         TO  FLG-SENTEI-SET 
                       END-IF
                   END-PERFORM
                   MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                   MOVE    "key22"                 TO  MCP-PATHNAME
                   PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key22"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *老人対象患者チェック
           PERFORM   210-RJN-TAISYO-CHK-SEC
      *
      *月内に複数の入院基本情報（５０００）がないか検索
      *この対応は特別管理加算用の為、平成１８年３月迄とする
           IF   LNK-NYURECEDEN-SANTEIYM  <=  "200603"
               PERFORM   210-SYS-5000-CHK-SEC
           END-IF
      *
      *医療機関減算情報の取得（システム管理テーブルより）
           MOVE    ZERO                TO  FLG-SYSKANRI
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    LNK-NYURECEDEN-SANTEIYM
                                       TO  SYS-STYUKYMD(1:6)
           MOVE    "01"                TO  SYS-STYUKYMD(7:2)
           MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
           MOVE    LNK-NYURECEDEN-HOSPNUM
                                       TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"  TO  MCP-TABLE
               MOVE    "key10"         TO  MCP-PATHNAME
               PERFORM  910-SYSKANRI-READ-SEC
      *        減算情報の取得は平成１８年３月迄とする
               IF   LNK-NYURECEDEN-SANTEIYM  <=  "200603"
                  PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                        UNTIL     GENSAN-IDX   >   4
                    IF    SYS-5000-GENKBN(GENSAN-IDX)   =   "2"
                        EVALUATE  GENSAN-IDX
                            WHEN  2
                                IF   FLG-RJN    =    ZERO
                                    MOVE  "190080570"  TO  WRK-GENSAN2
                                ELSE
                                    MOVE  "190799770"  TO  WRK-GENSAN2
                                END-IF
                                PERFORM VARYING GENSAN-IDX2 FROM 1 BY 1
                                    UNTIL     GENSAN-IDX2   >   31
                                  MOVE   "1"  TO
                                          WRK-GENSAN-INNAI(GENSAN-IDX2)
                                END-PERFORM
                            WHEN  3
                                IF   FLG-RJN    =    ZERO
                                    MOVE  "190111690"  TO  WRK-GENSAN3
                                ELSE
                                    MOVE  "190809090"  TO  WRK-GENSAN3
                                END-IF
                                PERFORM VARYING GENSAN-IDX2 FROM 1 BY 1
                                    UNTIL     GENSAN-IDX2   >   31
                                  MOVE   "1"  TO
                                          WRK-GENSAN-IRYO(GENSAN-IDX2)
                                END-PERFORM
                            WHEN  4
                                IF   FLG-RJN    =    ZERO
                                    MOVE  "190111790"  TO  WRK-GENSAN4
                                ELSE
                                    MOVE  "190809190"  TO  WRK-GENSAN4
                                END-IF
                                PERFORM VARYING GENSAN-IDX2 FROM 1 BY 1
                                    UNTIL     GENSAN-IDX2   >   31
                                  MOVE   "1"  TO
                                          WRK-GENSAN-JYOKU(GENSAN-IDX2)
                                END-PERFORM
                        END-EVALUATE
                    END-IF
                  END-PERFORM
               END-IF
      *        食事情報の退避
               PERFORM    VARYING   IDX  FROM  1  BY  1
                          UNTIL     IDX   >    31
      *            入院時食事療養費
                   IF     SYS-5000-SHOKUJIRYOYOCD  NOT =  SPACE
                       MOVE  SYS-5000-SHOKUJIRYOYOCD
                                          TO WRK-SYS5000-SHOKUCD(1 IDX)
                   END-IF
      *            特別管理加算
      *            平成１８年３月迄とする
                   IF   LNK-NYURECEDEN-SANTEIYM  <=  "200603"
                       IF     SYS-5000-SHOKUCD(1)  NOT =  SPACE
                           IF  SYS-5000-SHOKUKBN(1) =     "2"
                               MOVE  SYS-5000-SHOKUCD(1)
                                          TO WRK-SYS5000-SHOKUCD(2 IDX)
                           END-IF
                       END-IF
                   END-IF
      *             食堂加算（入院会計からの取得に変更）
      *             IF     SYS-5000-SHOKUCD(2)  NOT =  SPACE
      *                 IF  SYS-5000-SHOKUKBN(2) =     "2"
      *                     MOVE  SYS-5000-SHOKUCD(2)
      *                                    TO WRK-SYS5000-SHOKUCD(3 IDX)
      *                 END-IF
      *             END-IF
               END-PERFORM
           END-IF
      *    システム管理クローズ
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *この対応は特別管理加算用の為、平成１８年３月迄とする
           IF   LNK-NYURECEDEN-SANTEIYM  <=  "200603"
               IF        WRK-SYS5000-COUNT    =     ZERO
                     CONTINUE
               ELSE
                     PERFORM  210-SYS-5000-GET-SEC
               END-IF
           END-IF
      *
      *食堂加算取得（入院会計より）
           MOVE    ZERO                    TO  KSN-IDX
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key43"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE     "tbl_nyuinacct"    TO  MCP-TABLE
               MOVE     "key43"            TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
                 IF   NACCT-SRYCDTOTAL     =   197000570
      *            食堂加算の退避
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                              UNTIL     IDX1   >   31
                       IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)
                       AND   (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       AND   (NACCT-DAY(IDX1)    NOT =  ZERO)
      *                  入院時食事療養（１）の場合のみセット
                           IF  WRK-SYS5000-SHOKUCD(1 IDX1)  =
                                                          "197000110"
                               MOVE  "197000570"
                                       TO WRK-SYS5000-SHOKUCD(3 IDX1)
                           END-IF
                       END-IF
                   END-PERFORM
                 END-IF
                 MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                 MOVE    "key43"                 TO  MCP-PATHNAME
                 PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key43"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           DISPLAY "ORCSNYURECEDEN"
           DISPLAY "SPA-HOSPSBT = " SPA-HOSPSBT
      *
      *    有床診療所の入院料加算（平成２０年３月まで）
           IF   (SPA-HOSPSBT                 =    2)    AND
                (LNK-NYURECEDEN-SANTEIYM    <=   "200803")
      *
      *      入院時の入院料加算取得（入院会計より）
      *      （複数医師及び看護配置適合加算）
             MOVE    ZERO                    TO  KSN-IDX
             INITIALIZE                          NYUINACCT-REC
             MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
             MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
             MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
             MOVE    "6"                     TO  NACCT-ZAISKBKBN
             MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
             MOVE    "key17"                 TO  MCP-PATHNAME
             PERFORM 910-NYUINACCT-SELECT-SEC
             IF      FLG-NYUINACCT           =   ZERO
               MOVE     "tbl_nyuinacct"    TO  MCP-TABLE
               MOVE     "key17"            TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
                   MOVE      ZERO     TO      FLG-RYAKU
      *            入院料加算の退避
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                              UNTIL     IDX1   >   31
                       IF   ((WRK-NYUINKHN(IDX1) NOT = SPACE)  OR
                             (LNK-NYUINDAY-KBN(IDX1) = "1"))
                       AND   (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       AND   (NACCT-DAY(IDX1)    NOT =  ZERO)
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190117070
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                        TO  WRK-FUKUSU-NYUKSN
                           MOVE   NACCT-ZAITEN  
                                        TO  WRK-FUKUSU-NYUKSN-ZAITEN
                           MOVE   NACCT-DAY(IDX1)
                                        TO WRK-FUKUSU-NYUKSN-DAY(IDX1)
                         END-IF
      *
                       END-IF
                   END-PERFORM
                   MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                   MOVE    "key17"                 TO  MCP-PATHNAME
                   PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
             END-IF
      *      入院会計クローズ
             MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
             MOVE    "key17"                 TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
      *      入院時の入院料加算取得（入院会計より）
      *      （看護配置適合加算）
             MOVE    ZERO                    TO  KSN-IDX
             INITIALIZE                          NYUINACCT-REC
             MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
             MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
             MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
             MOVE    "6"                     TO  NACCT-ZAISKBKBN
             MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
             MOVE    "key17"                 TO  MCP-PATHNAME
             PERFORM 910-NYUINACCT-SELECT-SEC
             IF      FLG-NYUINACCT           =   ZERO
               MOVE     "tbl_nyuinacct"    TO  MCP-TABLE
               MOVE     "key17"            TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
                   MOVE      ZERO     TO      FLG-RYAKU
      *            入院料加算の退避
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                              UNTIL     IDX1   >   31
                       IF   ((WRK-NYUINKHN(IDX1) NOT = SPACE)  OR
                             (LNK-NYUINDAY-KBN(IDX1) = "1"))
                       AND   (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       AND   (NACCT-DAY(IDX1)    NOT =  ZERO)
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190109670
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                        TO  WRK-KANGO-NYUKSN
                           MOVE   NACCT-ZAITEN  
                                        TO  WRK-KANGO-NYUKSN-ZAITEN
                           MOVE   NACCT-DAY(IDX1)
                                        TO WRK-KANGO-NYUKSN-DAY(IDX1)
                         END-IF
      *
                       END-IF
                   END-PERFORM
                   MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                   MOVE    "key17"                 TO  MCP-PATHNAME
                   PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
             END-IF
      *      入院会計クローズ
             MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
             MOVE    "key17"                 TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
           END-IF
      *
      *    有床診療所の入院料加算（入院会計）（平成２０年４月から）
      *    ※注加算コードの付番されているもの
           IF   (SPA-HOSPSBT                 =    2)    AND
                (LNK-NYURECEDEN-SANTEIYM    >=   "200804")
      *
      *      入院時の入院料加算取得（入院会計より）
             MOVE    ZERO                    TO  KSN-IDX
             INITIALIZE                          NYUINACCT-REC
             MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
             MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
             MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
             MOVE    "6"                     TO  NACCT-ZAISKBKBN
             MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
             MOVE    "key17"                 TO  MCP-PATHNAME
             PERFORM 910-NYUINACCT-SELECT-SEC
             IF      FLG-NYUINACCT           =   ZERO
               MOVE     "tbl_nyuinacct"    TO  MCP-TABLE
               MOVE     "key17"            TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
                   MOVE      ZERO     TO      FLG-RYAKU
      *            入院料加算の退避
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                              UNTIL     IDX1   >   31
                       IF   ((WRK-NYUINKHN(IDX1) NOT = SPACE)  OR
                             (LNK-NYUINDAY-KBN(IDX1) = "1"))
                       AND   (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       AND   (NACCT-DAY(IDX1)    NOT =  ZERO)
      *
      *                  夜間緊急体制確保加算
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190126470
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(1)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(1)
                           MOVE   NACCT-DAY(IDX1)
                                     TO WRK-CHUKSN-NYUKSN-DAY(1 IDX1)
                         END-IF
      *
      *                  医師配置加算１（平成２２年４月新設）
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190135570
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(15)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(15)
                           MOVE   NACCT-DAY(IDX1)
                                     TO  WRK-CHUKSN-NYUKSN-DAY(15 IDX1)
                         END-IF
      *
      *                  医師配置加算２（平成２２年３月まで医師配置適合加算）
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190117070
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(2)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(2)
                           MOVE   NACCT-DAY(IDX1)
                                     TO  WRK-CHUKSN-NYUKSN-DAY(2 IDX1)
                         END-IF
      *
      *                  看護配置加算２（平成２２年３月まで看護配置加算１）
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190126570
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(3)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(3)
                           MOVE   NACCT-DAY(IDX1)
                                     TO  WRK-CHUKSN-NYUKSN-DAY(3 IDX1)
                         END-IF
      *
      *                  看護配置加算１（平成２２年３月まで看護配置加算２）
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190109670
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(4)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(4)
                           MOVE   NACCT-DAY(IDX1)
                                     TO  WRK-CHUKSN-NYUKSN-DAY(4 IDX1)
                         END-IF
      *
      *                  夜間看護配置加算２（平成２２年３月まで夜間看護配置加算１）
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190126670
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(5)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(5)
                           MOVE   NACCT-DAY(IDX1)
                                     TO  WRK-CHUKSN-NYUKSN-DAY(5 IDX1)
                         END-IF
      *
      *                  夜間看護配置加算１（平成２２年３月まで夜間看護配置加算２）
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190126770
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(6)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(6)
                           MOVE   NACCT-DAY(IDX1)
                                     TO  WRK-CHUKSN-NYUKSN-DAY(6 IDX1)
                         END-IF
      *
                       END-IF
                   END-PERFORM
                   MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                   MOVE    "key17"                 TO  MCP-PATHNAME
                   PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
             END-IF
      *      入院会計クローズ
             MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
             MOVE    "key17"                 TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
           END-IF
      *
      *    病院の入院料加算（入院会計）（平成２０年４月から）
      *    ※注加算コードの付番されているもの
           IF   (SPA-HOSPSBT                 =    1)    AND
                (LNK-NYURECEDEN-SANTEIYM    >=   "200804")
      *
      *      入院時の入院料加算取得（入院会計より）
             MOVE    ZERO                    TO  KSN-IDX
             INITIALIZE                          NYUINACCT-REC
             MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
             MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
             MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
             MOVE    "6"                     TO  NACCT-ZAISKBKBN
             MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
             MOVE    "key17"                 TO  MCP-PATHNAME
             PERFORM 910-NYUINACCT-SELECT-SEC
             IF      FLG-NYUINACCT           =   ZERO
               MOVE     "tbl_nyuinacct"    TO  MCP-TABLE
               MOVE     "key17"            TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
                   MOVE      ZERO     TO      FLG-RYAKU
      *            入院料加算の退避
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                              UNTIL     IDX1   >   31
                       IF   ((WRK-NYUINKHN(IDX1) NOT = SPACE)  OR
                             (LNK-NYUINDAY-KBN(IDX1) = "1"))
                       AND   (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       AND   (NACCT-DAY(IDX1)    NOT =  ZERO)
      *
      *                  プレイルーム、保育士等加算
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190111370
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(8)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(8)
                           MOVE   NACCT-DAY(IDX1)
                                     TO WRK-CHUKSN-NYUKSN-DAY(8 IDX1)
                         END-IF
      *
      *                  重症患者回復病棟加算
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190129870
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(14)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(14)
                           MOVE   NACCT-DAY(IDX1)
                                     TO  WRK-CHUKSN-NYUKSN-DAY(14 IDX1)
                         END-IF
      *
      *                  重症患者回復病棟加算（基準未適合）
                         IF   NACCT-SRYCDTOTAL(6:9)  =   190142370
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                     TO  WRK-CHUKSN-NYUKSN(33)
                           MOVE   NACCT-ZAITEN  
                                     TO  WRK-CHUKSN-NYUKSN-ZAITEN(33)
                           MOVE   NACCT-DAY(IDX1)
                                     TO  WRK-CHUKSN-NYUKSN-DAY(33 IDX1)
                         END-IF
      *
                       END-IF
                   END-PERFORM
                   MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                   MOVE    "key17"                 TO  MCP-PATHNAME
                   PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
             END-IF
      *      入院会計クローズ
             MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
             MOVE    "key17"                 TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
           END-IF
      *
      *    入院料加算取得（入院会計）
      *    ※注加算コードの付番されていないもの
           MOVE    ZERO                    TO  KSN-IDX
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "6"                     TO  NACCT-ZAISKBKBN
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE     "tbl_nyuinacct"    TO  MCP-TABLE
               MOVE     "key17"            TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
                   MOVE      ZERO     TO      FLG-RYAKU
                   MOVE      ZERO     TO      FLG-KSN
      *            入院料加算の退避
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                              UNTIL     IDX1   >   31
                       IF   ((WRK-NYUINKHN(IDX1) NOT = SPACE)  OR
                             (LNK-NYUINDAY-KBN(IDX1) = "1"))
                       AND   (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       AND   (NACCT-DAY(IDX1)    NOT =  ZERO)
                         IF (((SPA-HOSPSBT                 =    2) AND
                             (LNK-NYURECEDEN-SANTEIYM <= "200803")) AND
                            ((NACCT-SRYCDTOTAL(6:9) =  190117070)  OR
                             (NACCT-SRYCDTOTAL(6:9) =  190109670)))
                                        OR
                            (((SPA-HOSPSBT                 =    2) AND
                             (LNK-NYURECEDEN-SANTEIYM >= "200804")) AND
                            ((NACCT-SRYCDTOTAL(6:9) =  190126470)  OR
                             (NACCT-SRYCDTOTAL(6:9) =  190135570)  OR
                             (NACCT-SRYCDTOTAL(6:9) =  190117070)  OR
                             (NACCT-SRYCDTOTAL(6:9) =  190126570)  OR
                             (NACCT-SRYCDTOTAL(6:9) =  190109670)  OR
                             (NACCT-SRYCDTOTAL(6:9) =  190126670)  OR
                             (NACCT-SRYCDTOTAL(6:9) =  190126770)))
                                        OR
                            (((SPA-HOSPSBT                 =    1) AND
                             (LNK-NYURECEDEN-SANTEIYM >= "200804")) AND
                            ((NACCT-SRYCDTOTAL(6:9) =  190111370)  OR
                             (NACCT-SRYCDTOTAL(6:9) =  190129870)))
                             CONTINUE
                         ELSE
                           IF   FLG-KSN   =  ZERO
                               ADD     1    TO    KSN-IDX
                               MOVE    1    TO    FLG-KSN
                           END-IF
                           MOVE   NACCT-SRYCDTOTAL(6:9)
                                        TO  WRK-NYUKSN(KSN-IDX)
                           MOVE   NACCT-ZAITEN  
                                        TO  WRK-NYUKSN-ZAITEN(KSN-IDX)
                           MOVE   NACCT-DAY(IDX1)
                                        TO WRK-NYUKSN-DAY(KSN-IDX IDX1)
                         END-IF
      *
                       END-IF
                   END-PERFORM
                   MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
                   MOVE    "key17"                 TO  MCP-PATHNAME
                   PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *
      *    入院料加算取得（診療会計）
           INITIALIZE                          SRYACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  ACCT-HOSPNUM
           MOVE    "1"                     TO  ACCT-NYUGAIKBN
           MOVE    LNK-NYURECEDEN-PTID     TO  ACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  ACCT-SRYYM
           MOVE    "tbl_sryacct"           TO  MCP-TABLE
           MOVE    "key30"                 TO  MCP-PATHNAME
           PERFORM 910-SRYACCT-SELECT-SEC
           IF      FLG-SRYACCT             =   ZERO
               MOVE    "tbl_sryacct"       TO  MCP-TABLE
               MOVE    "key30"             TO  MCP-PATHNAME
               PERFORM   910-SRYACCT-READ-SEC
               PERFORM   UNTIL   (FLG-SRYACCT    =   1)
                 MOVE      ZERO     TO      FLG-RYAKU
                 IF   (ACCT-ZAITEN    NOT =    ZERO)    AND
                      (ACCT-ZAIKAISU  NOT =    ZERO)    AND
                      (ACCT-ZAIKBN    =        ZERO)
                   IF   ACCT-SRYKBN  =  "90" OR "92"
                     INITIALIZE      SRYACT-REC
                     MOVE    ACCT-HOSPNUM   TO   SRY-HOSPNUM
                     MOVE    ACCT-NYUGAIKBN TO   SRY-NYUGAIKBN
                     MOVE    ACCT-PTID      TO   SRY-PTID
                     MOVE    ACCT-SRYKA     TO   SRY-SRYKA
                     MOVE    ACCT-SRYYM     TO   SRY-SRYYM
                     MOVE    ACCT-ZAINUM    TO   SRY-ZAINUM
                     MOVE    1              TO   SRY-RENNUM
                     MOVE    "tbl_sryact"   TO  MCP-TABLE
                     MOVE    "key"          TO  MCP-PATHNAME
                     PERFORM 910-SRYACT-SELECT-SEC
                     IF      FLG-SRYACT     =    ZERO
                         MOVE     "tbl_sryact"   TO  MCP-TABLE
                         MOVE     "key"          TO  MCP-PATHNAME
                         PERFORM   910-SRYACT-READ-SEC
                         IF  FLG-SRYACT    =    ZERO
                             MOVE  SRY-SRYCD(1)   TO  
                                            ACCT-SRYCDTOTAL(6:9)   
                         END-IF
                     END-IF
      *              診療行為クローズ
                     MOVE     "tbl_sryact"   TO  MCP-TABLE
                     MOVE     "key"          TO  MCP-PATHNAME
                     PERFORM   900-CLOSE-SEC
      *
                     IF  ((LNK-NYURECEDEN-SANTEIYM <= "200803") AND
                          (ACCT-SRYCDTOTAL(6:9)  =
                                            CONS-KEIKAKU-GENSAN1
                                        OR  CONS-KEIKAKU-GENSAN2
                                        OR  CONS-INNAI-GENSAN1
                                        OR  CONS-INNAI-GENSAN2
                                        OR  CONS-ANZEN-GENSAN1
                                        OR  CONS-ANZEN-GENSAN2
                                        OR  CONS-JYOKU-GENSAN1
                                        OR  CONS-JYOKU-GENSAN2
                                        OR  CONS-NICHIJOU-KSN1
                                        OR  CONS-NICHIJOU-KSN2
                                        OR  CONS-CHIHOU-KSN1
                                        OR  CONS-CHIHOU-KSN2
                                        OR  CONS-JYOKU-KSN1
                                        OR  CONS-JYOKU-KSN2
                                        OR  CONS-TOKUSEIYAKU-KSN))
                                   OR
                         ((LNK-NYURECEDEN-SANTEIYM >= "200804") AND
                          (ACCT-SRYCDTOTAL(6:9)  = "190055470"  OR 
                                                   "190120970"  OR
                                                   "190119210"  OR
                                                   "190117570"  OR
                                                   "190121970"  OR
                                                   "190122670"  OR
                                                   "190139470"  OR
                                                   "190139570"  OR
                                                   "190139670"  OR
                                                   "190140270"  OR
                                                   "190140370"  OR
                                                   "190135070"  OR
                                                   "190141270"  OR
                                                   "190140870"  OR
                                                   "190140970"  OR
                                                   "190136170"  OR
                                                   "190141070" ))
                                   OR
                         ((LNK-NYURECEDEN-SANTEIYM >= "201004") AND
                          (ACCT-SRYCDTOTAL(6:9)  = "190076570"  OR
                                                   "190076670"  OR
                                                   "190127510"  OR 
                                                   "190127610" ))
      *                入院料加算の退避
                       PERFORM    VARYING   IDX1   FROM   1   BY   1
                                  UNTIL     IDX1   >   31
                           IF   ((WRK-NYUINKHN(IDX1) NOT = SPACE)  OR
                                 (LNK-NYUINDAY-KBN(IDX1) = "1"))
                           AND   (WRK-GAIHAKU-KBN(IDX1)  = ZERO OR 4 OR
                                                                   5)
                           AND   (ACCT-DAY(1 IDX1)   NOT =  ZERO)
                            IF   LNK-NYURECEDEN-SANTEIYM <= "200803"
                               EVALUATE   ACCT-SRYCDTOTAL(6:9)
      *                         入院診療計画未実施減算
                                WHEN  CONS-KEIKAKU-GENSAN1
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-KEIKAKU-GENSAN1(IDX1)
                                WHEN  CONS-KEIKAKU-GENSAN2
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-KEIKAKU-GENSAN2(IDX1)
      *                         院内感染防止対策未実施減算
                                WHEN  CONS-INNAI-GENSAN1
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-INNAI-GENSAN1(IDX1)
                                WHEN  CONS-INNAI-GENSAN2
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-INNAI-GENSAN2(IDX1)
      *                         医療安全管理体制未整備減算
                                WHEN  CONS-ANZEN-GENSAN1
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ANZEN-GENSAN1(IDX1)
                                WHEN  CONS-ANZEN-GENSAN2
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ANZEN-GENSAN2(IDX1)
      *                         褥瘡対策未実施減算
                                WHEN  CONS-JYOKU-GENSAN1
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-JYOKU-GENSAN1(IDX1)
                                WHEN  CONS-JYOKU-GENSAN2
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-JYOKU-GENSAN2(IDX1)
      *                         日常生活障害加算
                                WHEN  CONS-NICHIJOU-KSN1
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-NICHIJOU-KSN1(IDX1)
                                WHEN  CONS-NICHIJOU-KSN2
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-NICHIJOU-KSN2(IDX1)
      *                         認知症加算
                                WHEN  CONS-CHIHOU-KSN1
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-CHIHOU-KSN1(IDX1)
                                WHEN  CONS-CHIHOU-KSN2
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-CHIHOU-KSN2(IDX1)
      *                         褥瘡患者管理加算
                                WHEN  CONS-JYOKU-KSN1
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-JYOKU-KSN1(IDX1)
                                WHEN  CONS-JYOKU-KSN2
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-JYOKU-KSN2(IDX1)
      *                         特定抗精神病薬治療管理加算
                                WHEN  CONS-TOKUSEIYAKU-KSN
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-TOKUSEIYAKU-KSN(IDX1)
                               END-EVALUATE
                             ELSE
                               EVALUATE   ACCT-SRYCDTOTAL(6:9)
      *                         人工呼吸器使用加算（特殊疾患）
                                WHEN  "190055470"
                                  MOVE   "190055470"
                                      TO  WRK-CHUKSN-NYUKSN(7)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(7)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO  WRK-CHUKSN-NYUKSN-DAY(7 IDX1)
      *                         人工呼吸器使用加算（小児入院医療）
                                WHEN  "190120970"
                                  MOVE   "190120970"
                                      TO  WRK-CHUKSN-NYUKSN(9)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(9)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO  WRK-CHUKSN-NYUKSN-DAY(9 IDX1)
      *                         重度認知症加算（特定機能病院精神病棟）
                                WHEN  "190119210"
                                  MOVE   "190119210"
                                      TO  WRK-CHUKSN-NYUKSN(10)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(10)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(10 IDX1)
      *                         非定型抗精神病薬治療管理加算
                                WHEN  "190117570"
                                  MOVE   "190117570"
                                      TO  WRK-CHUKSN-NYUKSN(11)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(11)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(11 IDX1)
      *                         褥瘡評価実施加算（療養病棟）
                                WHEN  "190121970"
                                  MOVE   "190121970"
                                      TO  WRK-CHUKSN-NYUKSN(12)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(12)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(12 IDX1)
      *                         褥瘡評価実施加算（有床診療所）
                                WHEN  "190122670"
                                  MOVE   "190122670"
                                      TO  WRK-CHUKSN-NYUKSN(13)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(13)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(13 IDX1)
      *                        ここから平成２２年４月新設分
      *                         充実段階Ａ加算
                                WHEN  "190139470"
                                  MOVE   "190139470"
                                      TO  WRK-CHUKSN-NYUKSN(16)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(16)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(16 IDX1)
      *                         充実段階Ｂ加算
                                WHEN  "190139570"
                                  MOVE   "190139570"
                                      TO  WRK-CHUKSN-NYUKSN(17)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(17)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(17 IDX1)
      *                         高度医療体制加算
                                WHEN  "190139670"
                                  MOVE   "190139670"
                                      TO  WRK-CHUKSN-NYUKSN(18)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(18)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(18 IDX1)
      *                         小児加算（特定集中）（７日以内）
                                WHEN  "190140270"
                                  MOVE   "190140270"
                                      TO  WRK-CHUKSN-NYUKSN(19)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(19)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(19 IDX1)
      *                         小児加算（特定集中）（８日以上１４日未満）
                                WHEN  "190140370"
                                  MOVE   "190140370"
                                      TO  WRK-CHUKSN-NYUKSN(20)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(20)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(20 IDX1)
      *                         重症児（者）受入連携加算
                                WHEN  "190135070"
                                  MOVE   "190135070"
                                      TO  WRK-CHUKSN-NYUKSN(21)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(21)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(21 IDX1)
      *                         非定型抗精神病薬加算１（２種類以下）
                                WHEN  "190141270"
                                  MOVE   "190141270"
                                      TO  WRK-CHUKSN-NYUKSN(22)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(22)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(22 IDX1)
      *                         休日リハビリテーション提供体制加算
                                WHEN  "190140870"
                                  MOVE   "190140870"
                                      TO  WRK-CHUKSN-NYUKSN(23)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(23)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(23 IDX1)
      *                         リハビリテーション充実加算
                                WHEN  "190140970"
                                  MOVE   "190140970"
                                      TO  WRK-CHUKSN-NYUKSN(24)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(24)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(24 IDX1)
      *                         超重症児（者）入院診療加算（６歳以上）
                                WHEN  "190076570"
                                  MOVE   "190076570"
                                      TO  WRK-CHUKSN-NYUKSN(25)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(25)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(25 IDX1)
      *                         準超重症児（者）入院診療加算（６歳以上）
                                WHEN  "190076670"
                                  MOVE   "190076670"
                                      TO  WRK-CHUKSN-NYUKSN(26)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(26)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(26 IDX1)
      *                         超重症児（者）入院診療加算（６歳未満）
                                WHEN  "190127510"
                                  MOVE   "190127510"
                                      TO  WRK-CHUKSN-NYUKSN(27)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(27)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(27 IDX1)
      *                         準超重症児（者）入院診療加算（６歳未満）
                                WHEN  "190127610"
                                  MOVE   "190127610"
                                      TO  WRK-CHUKSN-NYUKSN(28)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(28)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(28 IDX1)
      *                         在宅重症児（者）受入加算
                                WHEN  "190136170"
                                  MOVE   "190136170"
                                      TO  WRK-CHUKSN-NYUKSN(29)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(29)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(29 IDX1)
      *                         リハビリテーション提供体制加算
                                WHEN  "190141070"
                                  MOVE   "190141070"
                                      TO  WRK-CHUKSN-NYUKSN(32)
                                  MOVE   ACCT-ZAITEN
                                      TO  WRK-CHUKSN-NYUKSN-ZAITEN(32)
                                  MOVE   ACCT-DAY(1 IDX1)
                                      TO WRK-CHUKSN-NYUKSN-DAY(32 IDX1)
                               END-EVALUATE
                             END-IF                                  
      *
                           END-IF
                       END-PERFORM
                     ELSE
                      IF    (LNK-NYURECEDEN-SANTEIYM  <=  "201003") AND
                          (((CONS-TAIIN1   =  ACCT-SRYCDTOTAL(6:9)) AND
                            (ACCT-MEISAISU =  1))                   OR
                           ((CONS-TAIIN2   =  ACCT-SRYCDTOTAL(6:9)) AND
                            (ACCT-MEISAISU =  1))                   OR
                           ((CONS-TAIIN3   =  ACCT-SRYCDTOTAL(6:9)) AND
                            (ACCT-MEISAISU =  1))                   OR
                           ((CONS-TAIIN4   =  ACCT-SRYCDTOTAL(6:9)) AND
                            (ACCT-MEISAISU =  2)))
      *                    退院加算は読み飛ばす（平成２２年３月まで）
                           CONTINUE
                      ELSE
      *                その他入院料加算の退避
      *                診療会計から診療行為を検索し、入院料加算の診療
      *                コードを特定する
                       IF         ACCT-MEISAISU    =      1
                             CONTINUE
                       ELSE
                          INITIALIZE      SRYACT-REC
                          MOVE    ACCT-HOSPNUM   TO   SRY-HOSPNUM
                          MOVE    ACCT-NYUGAIKBN TO   SRY-NYUGAIKBN
                          MOVE    ACCT-PTID      TO   SRY-PTID
                          MOVE    ACCT-SRYKA     TO   SRY-SRYKA
                          MOVE    ACCT-SRYYM     TO   SRY-SRYYM
                          MOVE    ACCT-ZAINUM    TO   SRY-ZAINUM
                          MOVE    1              TO   SRY-RENNUM
                          MOVE    "tbl_sryact"   TO  MCP-TABLE
                          MOVE    "key"          TO  MCP-PATHNAME
                          PERFORM 910-SRYACT-SELECT-SEC
                          IF      FLG-SRYACT     =    ZERO
                              MOVE     "tbl_sryact"   TO  MCP-TABLE
                              MOVE     "key"          TO  MCP-PATHNAME
                              PERFORM   910-SRYACT-READ-SEC
                              IF  FLG-SRYACT    =    ZERO
                                  MOVE  SRY-SRYCD(1)   TO  
                                                  ACCT-SRYCDTOTAL(6:9)   
                              END-IF
                          END-IF
      *                   診療行為クローズ
                          MOVE     "tbl_sryact"   TO  MCP-TABLE
                          MOVE     "key"          TO  MCP-PATHNAME
                          PERFORM   900-CLOSE-SEC
                       END-IF
      *                
                       IF   (LNK-NYURECEDEN-SANTEIYM  <= "201003")  AND
                            (ACCT-SRYCDTOTAL(6:9)  =   CONS-TAIIN1  OR
                                                       CONS-TAIIN2  OR
                                                       CONS-TAIIN3)
      *                    退院加算は読み飛ばす（平成２２年３月まで）
                           CONTINUE
                       ELSE
                         PERFORM    VARYING   IDX1   FROM   1   BY   1
                                      UNTIL     IDX1   >   31
                           IF   ((WRK-NYUINKHN(IDX1) NOT = SPACE)  OR
                                 (LNK-NYUINDAY-KBN(IDX1) = "1"))
                           AND   (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4
                                                                 OR 5)
                           AND   (ACCT-DAY(1 IDX1)   NOT =  ZERO)
                              EVALUATE   ACCT-SRYCDTOTAL(6:9)
                                WHEN  CONS-ETCNYUIN-KSN(1)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(1 IDX1)
                                WHEN  CONS-ETCNYUIN-KSN(2)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(2 IDX1)
                                WHEN  CONS-ETCNYUIN-KSN(3)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(3 IDX1)
                                WHEN  CONS-ETCNYUIN-KSN(4)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(4 IDX1)
                                WHEN  CONS-ETCNYUIN-KSN(5)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(5 IDX1)
                                WHEN  CONS-ETCNYUIN-KSN(6)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(6 IDX1)
                                WHEN  CONS-ETCNYUIN-KSN(7)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(7 IDX1)
                                WHEN  CONS-ETCNYUIN-KSN(8)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(8 IDX1)
                                WHEN  CONS-ETCNYUIN-KSN(9)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(9 IDX1)
                                WHEN  CONS-ETCNYUIN-KSN(10)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(10 IDX1)
                                WHEN  OTHER
                                  ADD     1     TO   ETC-IDX
                                  MOVE    ACCT-SRYCDTOTAL(6:9) TO  
                                           CONS-ETCNYUIN-KSN(ETC-IDX)
                                  MOVE   ACCT-DAY(1 IDX1)
                                        TO  WRK-ETCNYUIN-KSN(ETC-IDX
                                                                 IDX1)
                              END-EVALUATE
      *
                           END-IF
                         END-PERFORM
                       END-IF
                      END-IF
                     END-IF
                   END-IF
                 END-IF
                 MOVE     "tbl_sryacct"      TO  MCP-TABLE
                 MOVE     "key30"            TO  MCP-PATHNAME
                 PERFORM   910-SRYACCT-READ-SEC
               END-PERFORM
           END-IF
      *    診療会計クローズ
           MOVE     "tbl_sryacct"   TO  MCP-TABLE
           MOVE     "key30"          TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *
      *    取得した入院情報から日単位の入院会計情報を再構築
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
      *        診療区分
               MOVE   WRK-SRYKBN(IDX1)  TO  WRK-SO-SRYKBN(IDX1)
               IF    (LNK-NYUINDAY-KBN(IDX1)   =    "1")   AND
                     (LNK-NYUINDAY-TANKI2-KBN(IDX1)  NOT =    SPACE)
                   MOVE   "92"     TO       WRK-SO-SRYKBN(IDX1)
               END-IF
               IF    (LNK-NYUINDAY-KBN(IDX1)   =    "1")   AND
                     (LNK-NYUINDAY-TANKI2-KBN(IDX1)  =    SPACE)
                   MOVE   "90"     TO       WRK-SO-SRYKBN(IDX1)
               END-IF
      *        保険組合せ
               MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                        TO  WRK-SO-HKNCOMBI-DAY(IDX1)
               MOVE     ZERO                TO  WRK-MEISAISU
      *        入院基本料
               IF         WRK-NYUINKHN(IDX1)  NOT =        SPACE
                   ADD      1               TO  WRK-MEISAISU
                   MOVE   WRK-NYUINKHN(IDX1) TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
                   IF     FLG-SENTEI-SET    NOT =   ZERO
                       IF   TBL-SENTEI(IDX1)    =   1
                           MOVE    ZERO    TO  FLG-SENTEICDCHG
                           INITIALIZE  SENTEICDCHG-REC
                           MOVE    WRK-NYUINKHN(IDX1)
                                           TO  SENCHG-IPNSRYCD
                           MOVE     "tbl_senteicdchg"  TO  MCP-TABLE
                           MOVE     "key2"             TO  MCP-PATHNAME
                           PERFORM   910-SENTEICDCHG-SELECT-SEC
                           IF      FLG-SENTEICDCHG  =    ZERO
                               MOVE     "tbl_senteicdchg"
                                                      TO  MCP-TABLE
                               MOVE     "key2"        TO  MCP-PATHNAME
                               PERFORM  910-SENTEICDCHG-READ-SEC
                               IF    FLG-SENTEICDCHG  =   ZERO
                                   MOVE  SENCHG-SENTEISRYCD
                                                TO  WRK-SO-SRYCD
                                                   (IDX1 WRK-MEISAISU)
                               END-IF
                          END-IF
                          MOVE     "tbl_senteicdchg"   TO  MCP-TABLE
                          MOVE     "key2"              TO  MCP-PATHNAME
                         PERFORM   900-CLOSE-SEC
                       END-IF
                   END-IF
               END-IF
      *
      *        他医療機関受診（３０％減産）
               IF      (WRK-GAIHAKU(IDX1)        =
                                    "190142190" OR  "190142090" OR
                                    "190142290" OR  "190141590" )
                   ADD      1               TO  WRK-MEISAISU
                   MOVE   WRK-GAIHAKU(IDX1) TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
      *
      *        初期加算（長期減算）
               IF      (WRK-GAIHAKU(IDX1)       =   SPACE       OR
                                    "190142190" OR  "190142090" OR
                                    "190142290" OR  "190141590" )
               AND     (WRK-SHOKIKSN(IDX1)      NOT =   SPACE)
                   ADD      1               TO  WRK-MEISAISU
                   MOVE   WRK-SHOKIKSN(IDX1) TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
      *
      *        標欠
               IF     (WRK-GAIHAKU(IDX1)     =             SPACE) AND
                      (WRK-HYOUKETSU(IDX1)   NOT =         SPACE)
                   ADD      1               TO  WRK-MEISAISU
                   MOVE   WRK-HYOUKETSU(IDX1) TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
      *
      *        定数超過
               IF     (WRK-GAIHAKU(IDX1)     =             SPACE) AND
                      (WRK-TEISU(IDX1)       NOT =         SPACE)
                   ADD      1               TO  WRK-MEISAISU
                   MOVE   WRK-TEISU(IDX1)  TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
      *
      *        外泊
               IF         WRK-GAIHAKU(IDX1)   NOT =        SPACE
                 IF      (WRK-GAIHAKU(IDX1)     =
                                    "190142190" OR  "190142090" OR
                                    "190142290" OR  "190141590" )
                          CONTINUE
                 ELSE
                   ADD      1               TO  WRK-MEISAISU
                   MOVE   WRK-GAIHAKU(IDX1) TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
                   MOVE   WRK-GAIHAKU-KBN(IDX1)
                                            TO  WRK-SO-GAIHAKU-KBN
                                                           (IDX1 IDX1)
                 END-IF
               END-IF
      *
      *        診療所の入院料加算セット（平成２０年３月まで）
               IF  (SPA-HOSPSBT                 =    2)    AND  
                   (LNK-NYURECEDEN-SANTEIYM     <=   "200803")
      *            入院会計加算情報（複数医師及び看護配置適合加算）
                   IF    WRK-FUKUSU-NYUKSN-DAY(IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-FUKUSU-NYUKSN
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（看護配置適合加算）
                   IF    WRK-KANGO-NYUKSN-DAY(IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-KANGO-NYUKSN
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
               END-IF
      *
      *        診療所の入院料加算セット（平成２０年４月から平成２２年３月まで）
               IF  (SPA-HOSPSBT                 =    2)    AND  
                   (LNK-NYURECEDEN-SANTEIYM     >=   "200804")  AND
                   (LNK-NYURECEDEN-SANTEIYM     <=   "201003")
      *
      *            入院会計加算情報（夜間緊急体制確保加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(1 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(1)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（医師配置適合加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(2 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(2)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（看護配置加算１）
                   IF    WRK-CHUKSN-NYUKSN-DAY(3 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(3)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（看護配置加算２）
                   IF    WRK-CHUKSN-NYUKSN-DAY(4 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(4)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（夜間看護配置加算１）
                   IF    WRK-CHUKSN-NYUKSN-DAY(5 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(5)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（夜間看護配置加算２）
                   IF    WRK-CHUKSN-NYUKSN-DAY(6 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(6)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（褥瘡評価実施加算（有床診療所））
                   IF    WRK-CHUKSN-NYUKSN-DAY(13 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(13)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
               END-IF
      *
      *        診療所の入院料加算セット（平成２２年４月から）
               IF  (SPA-HOSPSBT                 =    2)    AND  
                   (LNK-NYURECEDEN-SANTEIYM     >=   "201004")
      *
      *            入院会計加算情報（夜間緊急体制確保加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(1 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(1)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（医師配置加算１）
                   IF    WRK-CHUKSN-NYUKSN-DAY(15 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(15)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（医師配置加算２）
                   IF    WRK-CHUKSN-NYUKSN-DAY(2 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(2)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（看護配置加算１）
                   IF    WRK-CHUKSN-NYUKSN-DAY(4 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(4)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（看護配置加算２）
                   IF    WRK-CHUKSN-NYUKSN-DAY(3 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(3)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（夜間看護配置加算１）
                   IF    WRK-CHUKSN-NYUKSN-DAY(6 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(6)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（夜間看護配置加算２）
                   IF    WRK-CHUKSN-NYUKSN-DAY(5 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(5)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（褥瘡評価実施加算（有床診療所））
                   IF    WRK-CHUKSN-NYUKSN-DAY(13 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(13)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（超重症児（者）入院診療加算６歳以上）
                   IF    WRK-CHUKSN-NYUKSN-DAY(25 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(25)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（準超重症児（者）入院診療加算６歳以上）
                   IF    WRK-CHUKSN-NYUKSN-DAY(26 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(26)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（超重症児（者）入院診療加算６歳未満）
                   IF    WRK-CHUKSN-NYUKSN-DAY(27 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(27)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（準超重症児（者）入院診療加算６歳未満）
                   IF    WRK-CHUKSN-NYUKSN-DAY(28 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(28)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（在宅重症児（者）受入加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(29 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(29)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
               END-IF
      *
      *        病院の入院料加算セット（平成２０年４月から平成２２年３月まで）
               IF  (SPA-HOSPSBT                 =    1)    AND  
                   (LNK-NYURECEDEN-SANTEIYM     >=   "200804")  AND
                   (LNK-NYURECEDEN-SANTEIYM     <=   "201003")
      *
      *            診療会計加算情報（人工呼吸器使用加算（特殊疾患））
                   IF    WRK-CHUKSN-NYUKSN-DAY(7 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(7)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（プレイルーム、保育士等加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(8 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(8)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（人工呼吸器使用加算（小児入院医療））
                   IF    WRK-CHUKSN-NYUKSN-DAY(9 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(9)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（重度認知症加算（特定機能病院精神病棟））
                   IF    WRK-CHUKSN-NYUKSN-DAY(10 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(10)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（非定型抗精神病薬治療管理加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(11 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(11)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（褥瘡評価実施加算（療養病棟））
                   IF    WRK-CHUKSN-NYUKSN-DAY(12 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(12)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（重症患者回復病棟加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(14 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(14)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
               END-IF
      *
      *        病院の入院料加算セット（平成２２年４月から）
               IF  (SPA-HOSPSBT                 =    1)    AND
                   (LNK-NYURECEDEN-SANTEIYM     >=   "201004")
      *
      *            診療会計加算情報（人工呼吸器使用加算（特殊疾患））
                   IF    WRK-CHUKSN-NYUKSN-DAY(7 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(7)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（プレイルーム、保育士等加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(8 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(8)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（人工呼吸器使用加算（小児入院医療））
                   IF    WRK-CHUKSN-NYUKSN-DAY(9 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(9)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（充実段階Ａ加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(16 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(16)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（充実段階Ｂ加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(17 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(17)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（高度医療体制加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(18 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(18)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（小児加算７日以内）
                   IF    WRK-CHUKSN-NYUKSN-DAY(19 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(19)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（小児加算８日以上１４日未満）
                   IF    WRK-CHUKSN-NYUKSN-DAY(20 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(20)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（重度認知症加算（特定機能病院精神病棟））
                   IF    WRK-CHUKSN-NYUKSN-DAY(10 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(10)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（重症児（者）受入連携加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(21 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(21)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（非定型抗精神病薬加算２）
                   IF    WRK-CHUKSN-NYUKSN-DAY(11 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(11)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（非定型抗精神病薬加算１）
                   IF    WRK-CHUKSN-NYUKSN-DAY(22 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(22)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（褥瘡評価実施加算（療養病棟））
                   IF    WRK-CHUKSN-NYUKSN-DAY(12 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(12)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（重症患者回復病棟加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(14 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(14)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            入院会計加算情報（重症患者回復病棟加算（基準未適合））
                   IF    WRK-CHUKSN-NYUKSN-DAY(33 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(33)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（休日リハビリテーション提供体制加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(23 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(23)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（リハビリテーション充実加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(24 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(24)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（超重症児（者）入院診療加算６歳以上）
                   IF    WRK-CHUKSN-NYUKSN-DAY(25 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(25)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（準超重症児（者）入院診療加算６歳以上）
                   IF    WRK-CHUKSN-NYUKSN-DAY(26 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(26)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（超重症児（者）入院診療加算６歳未満）
                   IF    WRK-CHUKSN-NYUKSN-DAY(27 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(27)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（準超重症児（者）入院診療加算６歳未満）
                   IF    WRK-CHUKSN-NYUKSN-DAY(28 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(28)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（在宅重症児（者）受入加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(29 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(29)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
      *            診療会計加算情報（リハビリテーション提供体制加算）
                   IF    WRK-CHUKSN-NYUKSN-DAY(32 IDX1)  =  ZERO
                       CONTINUE
                   ELSE
                       ADD   1    TO  WRK-MEISAISU
                       MOVE  WRK-CHUKSN-NYUKSN(32)
                                  TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                   END-IF
      *
               END-IF
      *
      *        入院会計加算情報
               PERFORM   VARYING   KSN-IDX   FROM   1  BY   1
                         UNTIL (WRK-NYUKSN(KSN-IDX)  =  SPACE)  OR
                               (KSN-IDX    >      20)
                  IF    WRK-NYUKSN-DAY(KSN-IDX IDX1)  =  ZERO
                      CONTINUE
                  ELSE
                      ADD   1               TO  WRK-MEISAISU
                      MOVE  WRK-NYUKSN(KSN-IDX)
                                 TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                  END-IF
               END-PERFORM
      *
               IF  LNK-NYURECEDEN-SANTEIYM     <=    "200803"
      *            日常生活障害加算
                   IF         WRK-NICHIJOU-KSN1(IDX1)   NOT =   ZERO
                       ADD      1                 TO  WRK-MEISAISU
                       MOVE   CONS-NICHIJOU-KSN1  TO  WRK-SO-SRYCD
                                               (IDX1 WRK-MEISAISU)
                   END-IF
                   IF         WRK-NICHIJOU-KSN2(IDX1)   NOT =   ZERO
                       ADD      1                 TO  WRK-MEISAISU
                       MOVE   CONS-NICHIJOU-KSN2  TO  WRK-SO-SRYCD
                                               (IDX1 WRK-MEISAISU)
                   END-IF
      *            認知症加算
                   IF         WRK-CHIHOU-KSN1(IDX1)     NOT =   ZERO
                       ADD      1                  TO  WRK-MEISAISU
                       MOVE   CONS-CHIHOU-KSN1     TO  WRK-SO-SRYCD
                                               (IDX1 WRK-MEISAISU)
                   END-IF
                   IF         WRK-CHIHOU-KSN2(IDX1)     NOT =   ZERO
                       ADD      1                  TO  WRK-MEISAISU
                       MOVE   CONS-CHIHOU-KSN2     TO  WRK-SO-SRYCD
                                               (IDX1 WRK-MEISAISU)
                   END-IF
      *            褥瘡患者管理加算
                   IF         WRK-JYOKU-KSN1(IDX1)      NOT =   ZERO
                       ADD      1                  TO  WRK-MEISAISU
                       MOVE   CONS-JYOKU-KSN1      TO  WRK-SO-SRYCD
                                               (IDX1 WRK-MEISAISU)
                   END-IF
                   IF         WRK-JYOKU-KSN2(IDX1)      NOT =   ZERO
                       ADD      1                  TO  WRK-MEISAISU
                       MOVE   CONS-JYOKU-KSN2      TO  WRK-SO-SRYCD
                                               (IDX1 WRK-MEISAISU)
                   END-IF
      *            特定抗精神病薬治療管理加算
                   IF         WRK-TOKUSEIYAKU-KSN(IDX1) NOT =   ZERO
                       ADD      1                  TO  WRK-MEISAISU
                       MOVE   CONS-TOKUSEIYAKU-KSN TO  WRK-SO-SRYCD
                                               (IDX1 WRK-MEISAISU)
                   END-IF
               END-IF
      *
      *        その他入院料加算
               PERFORM    VARYING   ETC-IDX   FROM  1  BY  1
                          UNTIL     ETC-IDX  >  10
                   IF  CONS-ETCNYUIN-KSN(ETC-IDX)  NOT =  SPACE
                     IF   WRK-ETCNYUIN-KSN(ETC-IDX IDX1) NOT =   ZERO
                       ADD      1                  TO  WRK-MEISAISU
                       MOVE   CONS-ETCNYUIN-KSN(ETC-IDX)
                                   TO  WRK-SO-SRYCD(IDX1 WRK-MEISAISU)
                     END-IF
                   END-IF
               END-PERFORM
      *        入院診療計画未実施減算
               IF         WRK-KEIKAKU-GENSAN1(IDX1) NOT =   ZERO
                   ADD      1                  TO  WRK-MEISAISU
                   MOVE   CONS-KEIKAKU-GENSAN1 TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
               IF         WRK-KEIKAKU-GENSAN2(IDX1) NOT =   ZERO
                   ADD      1                  TO  WRK-MEISAISU
                   MOVE   CONS-KEIKAKU-GENSAN2 TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
      *        院内感染防止対策未実施減算
               IF         WRK-INNAI-GENSAN1(IDX1) NOT =   ZERO
                   ADD      1                  TO  WRK-MEISAISU
                   MOVE   CONS-INNAI-GENSAN1   TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
               IF         WRK-INNAI-GENSAN2(IDX1) NOT =   ZERO
                   ADD      1                  TO  WRK-MEISAISU
                   MOVE   CONS-INNAI-GENSAN2   TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
      *        医療安全管理体制未整備減算
               IF         WRK-ANZEN-GENSAN1(IDX1) NOT =   ZERO
                   ADD      1                  TO  WRK-MEISAISU
                   MOVE   CONS-ANZEN-GENSAN1   TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
               IF         WRK-ANZEN-GENSAN2(IDX1) NOT =   ZERO
                   ADD      1                  TO  WRK-MEISAISU
                   MOVE   CONS-ANZEN-GENSAN2   TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
      *        褥瘡対策未実施減算
               IF         WRK-JYOKU-GENSAN1(IDX1) NOT =   ZERO
                   ADD      1                  TO  WRK-MEISAISU
                   MOVE   CONS-JYOKU-GENSAN1   TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
               IF         WRK-JYOKU-GENSAN2(IDX1) NOT =   ZERO
                   ADD      1                  TO  WRK-MEISAISU
                   MOVE   CONS-JYOKU-GENSAN2   TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
               END-IF
      *        減算情報（システム管理）
               IF      (WRK-NYUINKHN(IDX1)   NOT =         SPACE)  AND
                       (WRK-GAIHAKU(IDX1)        =         SPACE)  AND
                       (WRK-GENSAN-INNAI(IDX1)   NOT =     SPACE)
                   ADD      1               TO  WRK-MEISAISU
                   MOVE   WRK-GENSAN2       TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
                   MOVE     1               TO  WRK-GENSAN2-MIJISI
               END-IF
               IF      (WRK-NYUINKHN(IDX1)   NOT =         SPACE)  AND
                       (WRK-GAIHAKU(IDX1)        =         SPACE)  AND
                       (WRK-GENSAN-IRYO(IDX1)   NOT =      SPACE)
                   ADD      1               TO  WRK-MEISAISU
                   MOVE   WRK-GENSAN3       TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
                   MOVE     1               TO  WRK-GENSAN3-MIJISI
               END-IF
               IF      (WRK-NYUINKHN(IDX1)   NOT =         SPACE)  AND
                       (WRK-GAIHAKU(IDX1)        =         SPACE)  AND
                       (WRK-GENSAN-JYOKU(IDX1)   NOT =     SPACE)
                   ADD      1               TO  WRK-MEISAISU
                   MOVE   WRK-GENSAN4       TO  WRK-SO-SRYCD
                                           (IDX1 WRK-MEISAISU)
                   MOVE     1               TO  WRK-GENSAN4-MIJISI
               END-IF
      *        選定入院時の外泊
               IF   (TBL-SENTEI(IDX1)    =         1)   AND
                    (WRK-GAIHAKU-KBN(IDX1)     NOT =  ZERO)
                   EVALUATE   WRK-GAIHAKU-KBN(IDX1)
      *                外泊
                       WHEN   3
                           INITIALIZE   WRK-NYUIN-SORT-TBL(IDX1)
      *                他医療機関受診
                       WHEN   4
                       WHEN   5
                           INITIALIZE   WRK-NYUIN-SORT-TBL(IDX1)
                   END-EVALUATE
               END-IF
           END-PERFORM
      *
      *    再構築した入院会計情報から点数の算定
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
      *        点数マスタの読み込み
               PERFORM   VARYING   IDX2    FROM   1  BY   1
                         UNTIL (WRK-SO-SRYCD(IDX1 IDX2) = SPACE)
                            OR (IDX2    >      20)
                   PERFORM    210-TENSU-KEISAN-SEC
               END-PERFORM
           END-PERFORM
      *
      *     PERFORM    VARYING   IDX1   FROM  1  BY  1
      *                UNTIL     (IDX1   >     31)
      *          DISPLAY  "IDX1 = " IDX1
      *          DISPLAY  "WRK-SO-HKNCOMBI-DAY = " WRK-SO-HKNCOMBI-DAY
      *                                                         (IDX1)
      *          DISPLAY  "WRK-SO-SRYKBN   = " WRK-SO-SRYKBN(IDX1)
      *          DISPLAY  "WRK-SO-MEISAISU = " WRK-SO-MEISAISU(IDX1)
      *          DISPLAY  "WRK-SO-SRYCD(1) = " WRK-SO-SRYCD(IDX1 1)
      *          DISPLAY  "WRK-SO-SRYCD(2) = " WRK-SO-SRYCD(IDX1 2)
      *          DISPLAY  "WRK-SO-SRYCD(3) = " WRK-SO-SRYCD(IDX1 3)
      *          DISPLAY  "WRK-SO-SRYCD(4) = " WRK-SO-SRYCD(IDX1 4)
      *          DISPLAY  "WRK-SO-SRYCD(5) = " WRK-SO-SRYCD(IDX1 5)
      *          DISPLAY  "WRK-SO-SRYCDTOTAL = " WRK-SO-SRYCDTOTAL(IDX1)
      *          DISPLAY  "WRK-SO-TEN      = " WRK-SO-TEN(IDX1)
      *          DISPLAY  "WRK-SO-KAISU    = " WRK-SO-KAISU(IDX1)
      *     END-PERFORM
      *
      *    医療区分、ＡＤＬ点数情報の取得
           INITIALIZE                          ORCSRYOCOM-AREA
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  LNK-RYOCOM-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  LNK-RYOCOM-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  LNK-RYOCOM-SANTEIYM
           CALL    "ORCSRYOCOM"     USING  ORCSRYOCOM-AREA
                                           SPA-AREA
           IF      LNK-RYOCOM-RC           NOT =  ZERO
               DISPLAY  "LNK-RYOCOM-RC = " LNK-RYOCOM-RC
           END-IF
      *
      *     PERFORM   VARYING  IDX1   FROM  1   BY   1
      *               UNTIL    IDX1    >   31
      *       DISPLAY "IDX1 = " IDX1
      *       DISPLAY "LNK-RYOCOM-NYUINKBN = " LNK-RYOCOM-NYUINKBN(IDX1)
      *       DISPLAY "LNK-RYOCOM-MEISAISU = " LNK-RYOCOM-MEISAISU(IDX1)
      *       DISPLAY "LNK-RYOCOM-SRYCDTOTAL = " 
      *                                     LNK-RYOCOM-SRYCDTOTAL(IDX1)
      *       DISPLAY "LNK-RYOCOM-SRYCDTOTAL2 = " 
      *                                     LNK-RYOCOM-SRYCDTOTAL2(IDX1)
      *       DISPLAY "LNK-RYOCOM-IRYO-SRYCD (IDX1 1) = "
      *                             LNK-RYOCOM-IRYO-SRYCD(IDX1 1)
      *       DISPLAY "LNK-RYOCOM-IRYO-SRYCD (IDX1 2) = "
      *                             LNK-RYOCOM-IRYO-SRYCD(IDX1 2)
      *       DISPLAY "LNK-RYOCOM-IRYO-SRYCD (IDX1 3) = "
      *                             LNK-RYOCOM-IRYO-SRYCD(IDX1 3)
      *       DISPLAY "LNK-RYOCOM-IRYO-SRYCD (IDX1 4) = "
      *                             LNK-RYOCOM-IRYO-SRYCD(IDX1 4)
      *       DISPLAY "LNK-RYOCOM-IRYO-SRYCD (IDX1 5) = "
      *                             LNK-RYOCOM-IRYO-SRYCD(IDX1 5)
      *       DISPLAY "LNK-RYOCOM-ADL-SRYCD (IDX1) = "
      *                             LNK-RYOCOM-ADL-SRYCD(IDX1)
      *       DISPLAY "LNK-RYOCOM-ADL-TEN (IDX1) = "
      *                             LNK-RYOCOM-ADL-TEN(IDX1)
      *       DISPLAY "LNK-RYOCOM-ADL-TEN-MOJI (IDX1) = "
      *                             LNK-RYOCOM-ADL-TEN-MOJI(IDX1)
      *     END-PERFORM
      *
      *
           MOVE      ZERO      TO   MATOME-IDX
      *
      *    再構築した入院会計情報から同一剤のまとめ処理
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
               IF   (WRK-SO-MEISAISU(IDX1)  NOT =   ZERO)   AND
                    (WRK-SO-TEN(IDX1)       NOT =   ZERO)
                   IF    (LNK-RYOCOM-NYUINKBN(IDX1)   =   "1")   AND
                         (LNK-RYOCOM-MEISAISU(IDX1)   NOT =  ZERO)
                       ADD   1              TO  MATOME-IDX
                       MOVE  MATOME-IDX     TO  WRK-IRYOADL-DAY(IDX1)
                       MOVE  MATOME-IDX     TO  WRK-SO-IRYOADL-DAY(IDX1)
                   END-IF
                   ADD   1                  TO  WRK-SO-KAISU(IDX1)
                   MOVE       ZERO          TO  IDX2
                   COMPUTE    IDX2          =   IDX1    +   1
                   PERFORM    VARYING    IDX3   FROM   IDX2  BY  1
                              UNTIL      IDX3   >   31
                       IF    (WRK-SO-MEISAISU(IDX3)  =
                                             WRK-SO-MEISAISU(IDX1)) AND
                             (WRK-SO-HKNCOMBI-DAY(IDX3)  =
                                         WRK-SO-HKNCOMBI-DAY(IDX1)) AND
                             (WRK-SO-SRYCDTOTAL(IDX3)  =
                                         WRK-SO-SRYCDTOTAL(IDX1))   AND
                             (WRK-SO-TEN(IDX3)  =
                                         WRK-SO-TEN(IDX1))
                             IF (LNK-RYOCOM-NYUINKBN(IDX3) = "1")   AND
                                (LNK-RYOCOM-MEISAISU(IDX3) NOT =  ZERO)
                                 MOVE  MATOME-IDX    TO  
                                                 WRK-IRYOADL-DAY(IDX3)
                             END-IF
                             ADD     1    TO    WRK-SO-KAISU(IDX1)
                             IF  WRK-SO-GAIHAKU-KBN(IDX3 IDX3)
                                                             NOT = ZERO
                                 MOVE  WRK-SO-GAIHAKU-KBN(IDX3 IDX3)
                                          TO  WRK-SO-GAIHAKU-KBN
                                                            (IDX1 IDX3)
                             END-IF
                             INITIALIZE   WRK-NYUIN-SORT-TBL(IDX3)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
      *
      *    療養レセコメントの同一剤まとめ処理
           IF    (MATOME-IDX     NOT =   ZERO)   AND
                 (LNK-RYOCOM-RC  =       ZERO)
      *      療養レセコメント取得サブの返却結果をまとめワークに転送
             PERFORM      VARYING    IDX1   FROM   1  BY  1
               UNTIL      IDX1   >   31
                 IF   (LNK-RYOCOM-NYUINKBN(IDX1)  NOT =   ZERO)   AND
                      (LNK-RYOCOM-MEISAISU(IDX1)  NOT =   ZERO)
                     MOVE   LNK-RYOCOM-MEISAISU(IDX1)
                                   TO  WRK-IRYOADL-MEISAISU(IDX1)
                     PERFORM  VARYING  IDX2  FROM  1  BY  1
                       UNTIL  IDX2 >  LNK-RYOCOM-MEISAISU(IDX1)
                         MOVE  LNK-RYOCOM-IRYO-SRYCD(IDX1 IDX2)
                                     TO  WRK-IRYOADL-SRYCD(IDX1 IDX2)
                     END-PERFORM
                     MOVE   LNK-RYOCOM-SRYCDTOTAL2(IDX1)
                                   TO  WRK-IRYOADL-SRYCDTOTAL(IDX1)
                     IF     LNK-NYURECEDEN-SANTEIYM   <=  "201003"
                         MOVE   LNK-RYOCOM-ADL-SRYCD(IDX1)
                                       TO  WRK-IRYOADL-ADL-SRYCD(IDX1)
                         MOVE   LNK-RYOCOM-ADL-TEN(IDX1)
                                       TO  WRK-IRYOADL-TEN(IDX1)
                         MOVE   LNK-RYOCOM-ADL-TEN-MOJI(IDX1)
                                       TO  WRK-IRYOADL-TEN-MOJI(IDX1)
                     ELSE
                         MOVE   LNK-RYOCOM-ADL-SRYCD-H22(IDX1 1)
                                   TO  WRK-IRYOADL-ADL-SRYCD-H22(IDX1 1)
                         MOVE   LNK-RYOCOM-ADL-TEN-H22(IDX1 1)
                                   TO  WRK-IRYOADL-TEN-H22(IDX1 1)
                         MOVE   LNK-RYOCOM-ADL-TEN-MOJI-H22(IDX1 1)
                                   TO  WRK-IRYOADL-TEN-MOJI-H22(IDX1 1)
                         MOVE   LNK-RYOCOM-ADL-SRYCD-H22(IDX1 2)
                                   TO  WRK-IRYOADL-ADL-SRYCD-H22(IDX1 2)
                         MOVE   LNK-RYOCOM-ADL-TEN-H22(IDX1 2)
                                   TO  WRK-IRYOADL-TEN-H22(IDX1 2)
                         MOVE   LNK-RYOCOM-ADL-TEN-MOJI-H22(IDX1 2)
                                   TO  WRK-IRYOADL-TEN-MOJI-H22(IDX1 2)
                         MOVE   LNK-RYOCOM-ADL-SRYCD-H22(IDX1 3)
                                   TO  WRK-IRYOADL-ADL-SRYCD-H22(IDX1 3)
                         MOVE   LNK-RYOCOM-ADL-TEN-H22(IDX1 3)
                                   TO  WRK-IRYOADL-TEN-H22(IDX1 3)
                         MOVE   LNK-RYOCOM-ADL-TEN-MOJI-H22(IDX1 3)
                                   TO  WRK-IRYOADL-TEN-MOJI-H22(IDX1 3)
                         MOVE   LNK-RYOCOM-ADL-SRYCD-H22(IDX1 4)
                                   TO  WRK-IRYOADL-ADL-SRYCD-H22(IDX1 4)
                         MOVE   LNK-RYOCOM-ADL-TEN-H22(IDX1 4)
                                   TO  WRK-IRYOADL-TEN-H22(IDX1 4)
                         MOVE   LNK-RYOCOM-ADL-TEN-MOJI-H22(IDX1 4)
                                   TO  WRK-IRYOADL-TEN-MOJI-H22(IDX1 4)
                     END-IF
                 END-IF
             END-PERFORM
      *
      *      療養レセコメントまとめ
             PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
               IF   (WRK-IRYOADL-DAY(IDX1)  NOT =   ZERO)   AND
                    (WRK-IRYOADL-MEISAISU(IDX1)  NOT =   ZERO)
                   MOVE       1   TO  WRK-IRYOADL-GAITOU-KBN(IDX1 IDX1)
                   MOVE       ZERO      TO  IDX2
                   COMPUTE    IDX2      =   IDX1    +   1
                   PERFORM    VARYING    IDX3   FROM   IDX2  BY  1
                              UNTIL      IDX3   >   31
                     IF    LNK-NYURECEDEN-SANTEIYM   <=   "201003"
                       IF    (WRK-IRYOADL-DAY(IDX3)  =
                                         WRK-IRYOADL-DAY(IDX1)) AND
                             (WRK-IRYOADL-MEISAISU(IDX3)  =
                                         WRK-IRYOADL-MEISAISU(IDX1)) AND
                             (WRK-IRYOADL-SRYCDTOTAL(IDX3)  =
                                       WRK-IRYOADL-SRYCDTOTAL(IDX1)) AND
                             (WRK-IRYOADL-TEN(IDX3)  =
                                         WRK-IRYOADL-TEN(IDX1))
                             MOVE      1    TO
                                       WRK-IRYOADL-GAITOU-KBN(IDX1 IDX3)
                             INITIALIZE   WRK-IRYOADL-SORT-TBL(IDX3)
                       END-IF
                     ELSE
                       IF    (WRK-IRYOADL-DAY(IDX3)  =
                                         WRK-IRYOADL-DAY(IDX1)) AND
                             (WRK-IRYOADL-MEISAISU(IDX3)  =
                                         WRK-IRYOADL-MEISAISU(IDX1)) AND
                             (WRK-IRYOADL-SRYCDTOTAL(IDX3)  =
                                       WRK-IRYOADL-SRYCDTOTAL(IDX1)) AND
                             (WRK-IRYOADL-TEN-H22(IDX3 1)  =
                                       WRK-IRYOADL-TEN-H22(IDX1 1))  AND
                             (WRK-IRYOADL-TEN-H22(IDX3 2)  =
                                       WRK-IRYOADL-TEN-H22(IDX1 2))  AND
                             (WRK-IRYOADL-TEN-H22(IDX3 3)  =
                                       WRK-IRYOADL-TEN-H22(IDX1 3))  AND
                             (WRK-IRYOADL-TEN-H22(IDX3 4)  =
                                       WRK-IRYOADL-TEN-H22(IDX1 4))
                             MOVE      1    TO
                                       WRK-IRYOADL-GAITOU-KBN(IDX1 IDX3)
                             INITIALIZE   WRK-IRYOADL-SORT-TBL(IDX3)
                       END-IF
                     END-IF
                   END-PERFORM
               END-IF
             END-PERFORM
           END-IF
      *    まとめ結果確認
      *     PERFORM    VARYING   IDX1   FROM  1  BY  1
      *                UNTIL     (IDX1   >     31)
      *          DISPLAY  "IDX1 = " IDX1
      *          DISPLAY  "WRK-IRYOADL-DAY(IDX1) = "
      *                    WRK-IRYOADL-DAY(IDX1)
      *          DISPLAY  "WRK-IRYOADL-MEISAISU(IDX1) = "
      *                    WRK-IRYOADL-MEISAISU(IDX1)
      *          DISPLAY  "WRK-IRYOADL-SRYCDTOTAL(IDX1) = "
      *                    WRK-IRYOADL-SRYCDTOTAL(IDX1)
      *          DISPLAY  "WRK-IRYOADL-TEN(IDX1) = "
      *                    WRK-IRYOADL-TEN(IDX1)
      *          DISPLAY  "WRK-IRYOADL-GAITOU-TBL(IDX1) = "
      *                    WRK-IRYOADL-GAITOU-TBL(IDX1)
      *     END-PERFORM
      *
      *    入院会計まとめ結果と療養レセコメントのリンクを確認
      *     PERFORM    VARYING   IDX1   FROM  1  BY  1
      *                UNTIL     (IDX1   >     31)
      *          DISPLAY  "IDX1 = " IDX1
      *          DISPLAY  "WRK-IRYOADL-DAY(IDX1) = "
      *                    WRK-IRYOADL-DAY(IDX1)
      *          DISPLAY  "WRK-SO-IRYOADL-DAY(IDX1) = "
      *                    WRK-SO-IRYOADL-DAY(IDX1)
      *     END-PERFORM
      *
      *   結果表示
      *     PERFORM    VARYING   IDX1   FROM  1  BY  1
      *                UNTIL     (IDX1   >     31)
      *          DISPLAY  "IDX1 = " IDX1
      *          DISPLAY  "WRK-SO-HKNCOMBI-DAY = " WRK-SO-HKNCOMBI-DAY
      *                                                         (IDX1)
      *          DISPLAY  "WRK-SO-SRYKBN   = " WRK-SO-SRYKBN(IDX1)
      *          DISPLAY  "WRK-SO-MEISAISU = " WRK-SO-MEISAISU(IDX1)
      *          DISPLAY  "WRK-SO-SRYCD(1) = " WRK-SO-SRYCD(IDX1 1)
      *          DISPLAY  "WRK-SO-SRYCD(2) = " WRK-SO-SRYCD(IDX1 2)
      *          DISPLAY  "WRK-SO-SRYCD(3) = " WRK-SO-SRYCD(IDX1 3)
      *          DISPLAY  "WRK-SO-SRYCD(4) = " WRK-SO-SRYCD(IDX1 4)
      *          DISPLAY  "WRK-SO-SRYCD(5) = " WRK-SO-SRYCD(IDX1 5)
      *          DISPLAY  "WRK-SO-SRYCDTOTAL = " WRK-SO-SRYCDTOTAL(IDX1)
      *          DISPLAY  "WRK-SO-TEN      = " WRK-SO-TEN(IDX1)
      *          DISPLAY  "WRK-SO-KAISU    = " WRK-SO-KAISU(IDX1)
      *          PERFORM   VARYING  IDX2  FROM  1  BY  1
      *                    UNTIL  IDX2  >  31
      *                     DISPLAY  "IDX2 = " IDX2
      *                     DISPLAY  "WRK-SO-GAIHAKU-KBN = " 
      *                               WRK-SO-GAIHAKU-KBN(IDX1 IDX2)
      *          END-PERFORM
      *     END-PERFORM
      *
      *    レセ電サブ返却エリアへのセット（入院料　診療区分９０）
           MOVE       ZERO      TO     IDX2
           PERFORM    VARYING   IDX1   FROM  1  BY  1
                      UNTIL     (IDX1   >     31)
               IF   (WRK-SO-MEISAISU(IDX1)  NOT =   ZERO)   AND
                    (WRK-SO-TEN(IDX1)       NOT =   ZERO)   AND
                    (WRK-SO-SRYKBN(IDX1)    =       "90")
                     ADD    1      TO    IDX2
                     MOVE  WRK-SO-HKNCOMBI-DAY(IDX1) TO
                                     LNK-NYURECEDEN-HKNCOMBI(1 IDX2)
                     MOVE  WRK-SO-MEISAISU(IDX1)   TO
                                     LNK-NYURECEDEN-MEISAISU(1 IDX2)
                     PERFORM   VARYING   IDX3   FROM   1   BY  1
                               UNTIL (WRK-SO-SRYCD(IDX1 IDX3) = SPACE)
                                  OR (IDX3   >   20)
                         MOVE   "SI"   TO
                                    LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                         IF    IDX3   =    1
                               MOVE   WRK-SO-SRYKBN(IDX1)  TO   
                                    LNK-NYURECEDEN-SRYSKB(1 IDX2 IDX3)
                         END-IF
                         MOVE  WRK-SO-SRYCD(IDX1 IDX3) TO
                                    LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                         MOVE  ZERO     TO    IDX4
                         COMPUTE   IDX4 =    IDX3   +   1
                         IF    WRK-SO-SRYCD(IDX1 IDX4)    =   SPACE
                               MOVE   WRK-SO-TEN(IDX1)   TO
                                      LNK-NYURECEDEN-TEN(1 IDX2 IDX3)
                               MOVE   WRK-SO-KAISU(IDX1)   TO
                                     LNK-NYURECEDEN-KAISU(1 IDX2 IDX3)
                         END-IF
                     END-PERFORM
      *
      *              外泊コメントセット処理
                     INITIALIZE    WRK-GAIHAKU-DAY-TABLE
                     IF   WRK-SO-GAIHAKU-TBL(IDX1)   =  ALL"0"
                         CONTINUE
                     ELSE
                         MOVE     ZERO    TO   IDX6
                         PERFORM  VARYING  IDX5   FROM  1  BY  1
                           UNTIL  IDX5   >  31
                               IF   WRK-SO-GAIHAKU-KBN(IDX1 IDX5)  =
                                                         1   OR  2
                                 IF  IDX5   =   1
                                    ADD   1    TO   IDX6
                                    MOVE  IDX5   TO  
                                               WRK-GAIHAKU-DAY-ST(IDX6)
                                    MOVE  IDX5   TO  
                                               WRK-GAIHAKU-DAY-ED(IDX6)
                                 ELSE
                                   COMPUTE   IDX7  =   IDX5  -  1
                                   IF WRK-SO-GAIHAKU-KBN(IDX1 IDX7) =
                                                         1   OR  2
                                        MOVE  IDX5  TO
                                              WRK-GAIHAKU-DAY-ED(IDX6)
                                   ELSE
                                     ADD   1    TO   IDX6
                                     MOVE  IDX5   TO  
                                              WRK-GAIHAKU-DAY-ST(IDX6)
                                     MOVE  IDX5   TO  
                                              WRK-GAIHAKU-DAY-ED(IDX6)
                                   END-IF
                                 END-IF
                               END-IF
                         END-PERFORM
                       PERFORM   VARYING  IDX5  FROM  1  BY  1
                       UNTIL   (IDX5  >  31)   OR
                               (WRK-GAIHAKU-DAY-ST(IDX5) =  ZERO)
                           ADD    1     TO
                                       LNK-NYURECEDEN-MEISAISU(1 IDX2)
                           IF   WRK-GAIHAKU-DAY-ST(IDX5) = 
                                               WRK-GAIHAKU-DAY-ED(IDX5)
                                MOVE   "CO"   TO   
                                    LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                                MOVE  "840000015"  TO
                                      LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                                MOVE   WRK-GAIHAKU-DAY-ST(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           ELSE
                                MOVE   "CO"   TO   
                                    LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                                MOVE  "840000016"  TO
                                      LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                                MOVE   WRK-GAIHAKU-DAY-ST(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (1:4)
                                MOVE   WRK-GAIHAKU-DAY-ED(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (5:4)
                           END-IF
                           ADD    1     TO   IDX3
                       END-PERFORM
                     END-IF
      *
                     IF  LNK-RYOCOM-RC  =       ZERO
      *              療養レセプトコメントセット処理
      *              月日セット
                     PERFORM   VARYING  CIDX   FROM   1  BY  1
                       UNTIL   CIDX     >   31
                      IF   WRK-SO-IRYOADL-DAY(IDX1)  =
                                         WRK-IRYOADL-DAY(CIDX)
                       INITIALIZE    WRK-RYOYO-DAY-TABLE
                       IF   WRK-IRYOADL-GAITOU-TBL(CIDX)   =  ALL"0"
                         CONTINUE
                       ELSE
                         MOVE     ZERO    TO   IDX6
                         PERFORM  VARYING  IDX5   FROM  1  BY  1
                           UNTIL  IDX5   >  31
                               IF   WRK-IRYOADL-GAITOU-KBN(CIDX IDX5)
                                                          =       1
                                 IF  IDX5   =   1
                                    ADD   1    TO   IDX6
                                    MOVE  IDX5   TO  
                                               WRK-RYOYO-DAY-ST(IDX6)
                                    MOVE  IDX5   TO  
                                               WRK-RYOYO-DAY-ED(IDX6)
                                 ELSE
                                   COMPUTE   IDX7  =   IDX5  -  1
                                   IF WRK-IRYOADL-GAITOU-KBN(CIDX IDX7)
                                                           =     1
                                        MOVE  IDX5  TO
                                              WRK-RYOYO-DAY-ED(IDX6)
                                   ELSE
                                     ADD   1    TO   IDX6
                                     MOVE  IDX5   TO  
                                              WRK-RYOYO-DAY-ST(IDX6)
                                     MOVE  IDX5   TO  
                                              WRK-RYOYO-DAY-ED(IDX6)
                                   END-IF
                                 END-IF
                               END-IF
                         END-PERFORM
      *                  平成２２年４月より記録コメントの変更
      *                  （記録コメントコード810000001  ->  840000125 840000134）
                         IF  LNK-NYURECEDEN-SANTEIYM    <=   "201003"
                          PERFORM   VARYING  IDX5  FROM  1  BY  1
                          UNTIL   (IDX5  >  31)   OR
                               (WRK-RYOYO-DAY-ST(IDX5) =  ZERO)
                           IF   LNK-NYURECEDEN-MEISAISU(1 IDX2) < 300
                             ADD    1     TO
                                       LNK-NYURECEDEN-MEISAISU(1 IDX2)
                             IF   WRK-RYOYO-DAY-ST(IDX5) = 
                                               WRK-RYOYO-DAY-ED(IDX5)
                                MOVE   "CO"   TO   
                                    LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                                MOVE  "810000001"  TO
                                      LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                                MOVE   "　　月　　日"  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                MOVE   LNK-NYURECEDEN-SANTEIYM(5:2)
                                                       TO  WRK-MM-X
                                MOVE   WRK-MM-9        TO  IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (1:4)
                                MOVE   WRK-RYOYO-DAY-ST(IDX5) TO  IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (7:4)
                             ELSE
                                MOVE   "CO"   TO   
                                    LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                                MOVE  "810000001"  TO
                                      LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                                MOVE   "　　月　　日〜　　月　　日"  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                MOVE   LNK-NYURECEDEN-SANTEIYM(5:2)
                                                       TO  WRK-MM-X
                                MOVE   WRK-MM-9        TO  IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (1:4)
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (15:4)
                                MOVE   WRK-RYOYO-DAY-ST(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (7:4)
                                MOVE   WRK-RYOYO-DAY-ED(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (21:4)
                             END-IF
                             ADD    1     TO   IDX3
                           END-IF
                          END-PERFORM
                         ELSE
                          PERFORM   VARYING  IDX5  FROM  1  BY  1
                          UNTIL   (IDX5  >  31)   OR
                               (WRK-RYOYO-DAY-ST(IDX5) =  ZERO)
                           IF   LNK-NYURECEDEN-MEISAISU(1 IDX2) < 300
                             ADD    1     TO
                                       LNK-NYURECEDEN-MEISAISU(1 IDX2)
                             IF   WRK-RYOYO-DAY-ST(IDX5) = 
                                               WRK-RYOYO-DAY-ED(IDX5)
                                MOVE   "CO"   TO   
                                    LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                                IF   SPA-HOSPSBT    =    1
                                    MOVE  "840000125"  TO
                                      LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                                ELSE
                                    MOVE  "840000134"  TO
                                      LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                                END-IF
                                MOVE   WRK-RYOYO-DAY-ST(IDX5) TO  IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (1:4)
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (5:4)
                             ELSE
                                MOVE   "CO"   TO   
                                    LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                                IF   SPA-HOSPSBT    =    1
                                    MOVE  "840000125"  TO
                                      LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                                ELSE
                                    MOVE  "840000134"  TO
                                      LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                                END-IF
                                MOVE   WRK-RYOYO-DAY-ST(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (1:4)
                                MOVE   WRK-RYOYO-DAY-ED(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                                                          (5:4)
                             END-IF
                             ADD    1     TO   IDX3
                           END-IF
                          END-PERFORM
                         END-IF
      *
      *                  医療区分コメント
                         PERFORM   VARYING  IDX5  FROM  1  BY  1
                         UNTIL   (IDX5  >  30)   OR
                           (WRK-IRYOADL-SRYCD(CIDX IDX5) =  SPACE)
                           IF   LNK-NYURECEDEN-MEISAISU(1 IDX2) < 300
                             ADD    1     TO
                                   LNK-NYURECEDEN-MEISAISU(1 IDX2)
                             MOVE   "CO"   TO   
                                LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                             MOVE  WRK-IRYOADL-SRYCD(CIDX IDX5)  TO
                                  LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                             ADD    1     TO   IDX3
                           END-IF
                         END-PERFORM
      *
      *                  ＡＤＬコメント（平成２２年４月より記録コメントの変更）
                         IF  LNK-NYURECEDEN-SANTEIYM    <=   "201003"
                          IF   LNK-NYURECEDEN-MEISAISU(1 IDX2) < 300
                           ADD    1     TO
                                   LNK-NYURECEDEN-MEISAISU(1 IDX2)
                           MOVE   "CO"   TO   
                                LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                           MOVE  "840000103"   TO
                                  LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                           IF   WRK-IRYOADL-TEN(CIDX)   =   ZERO
                             MOVE  "００"    TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           ELSE
                             MOVE   WRK-IRYOADL-TEN(CIDX) TO IDX6
                             MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           END-IF
                           ADD    1     TO   IDX3
                          END-IF
                         ELSE
      *                   ＡＤＬａ
                          IF   LNK-NYURECEDEN-MEISAISU(1 IDX2) < 300
                           ADD    1     TO
                                   LNK-NYURECEDEN-MEISAISU(1 IDX2)
                           MOVE   "CO"   TO   
                                LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                           MOVE  "840000126"   TO
                                  LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                           IF   WRK-IRYOADL-TEN-H22(CIDX 1)   =   ZERO
                             MOVE  "００"    TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           ELSE
                             MOVE   WRK-IRYOADL-TEN-H22(CIDX 1) TO IDX6
                             MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           END-IF
                           ADD    1     TO   IDX3
                          END-IF
      *                   ＡＤＬｂ
                          IF   LNK-NYURECEDEN-MEISAISU(1 IDX2) < 300
                           ADD    1     TO
                                   LNK-NYURECEDEN-MEISAISU(1 IDX2)
                           MOVE   "CO"   TO   
                                LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                           MOVE  "840000127"   TO
                                  LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                           IF   WRK-IRYOADL-TEN-H22(CIDX 2)   =   ZERO
                             MOVE  "００"    TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           ELSE
                             MOVE   WRK-IRYOADL-TEN-H22(CIDX 2) TO IDX6
                             MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           END-IF
                           ADD    1     TO   IDX3
                          END-IF
      *                   ＡＤＬｃ
                          IF   LNK-NYURECEDEN-MEISAISU(1 IDX2) < 300
                           ADD    1     TO
                                   LNK-NYURECEDEN-MEISAISU(1 IDX2)
                           MOVE   "CO"   TO   
                                LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                           MOVE  "840000128"   TO
                                  LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                           IF   WRK-IRYOADL-TEN-H22(CIDX 3)   =   ZERO
                             MOVE  "００"    TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           ELSE
                             MOVE   WRK-IRYOADL-TEN-H22(CIDX 3) TO IDX6
                             MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           END-IF
                           ADD    1     TO   IDX3
                          END-IF
      *                   ＡＤＬｄ
                          IF   LNK-NYURECEDEN-MEISAISU(1 IDX2) < 300
                           ADD    1     TO
                                   LNK-NYURECEDEN-MEISAISU(1 IDX2)
                           MOVE   "CO"   TO   
                                LNK-NYURECEDEN-RECSKB(1 IDX2 IDX3)
                           MOVE  "840000129"   TO
                                  LNK-NYURECEDEN-SRYCD(1 IDX2 IDX3)
                           IF   WRK-IRYOADL-TEN-H22(CIDX 4)   =   ZERO
                             MOVE  "００"    TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           ELSE
                             MOVE   WRK-IRYOADL-TEN-H22(CIDX 4) TO IDX6
                             MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(1 IDX2 IDX3)
                           END-IF
                           ADD    1     TO   IDX3
                          END-IF
                         END-IF
      *
                       END-IF
                      END-IF
                     END-PERFORM
      *
                     END-IF
      *
               END-IF
           END-PERFORM
      *    レセ電サブ返却エリアへのセット（特定入院料　診療区分９２）
           MOVE      ZERO     TO   IDX2
           PERFORM    VARYING   IDX1   FROM  1  BY  1
                      UNTIL     (IDX1   >     31)
               IF   (WRK-SO-MEISAISU(IDX1)  NOT =   ZERO)   AND
                    (WRK-SO-TEN(IDX1)       NOT =   ZERO)   AND
                    (WRK-SO-SRYKBN(IDX1)    =       "92")
                     ADD    1      TO    IDX2
                     MOVE  WRK-SO-HKNCOMBI-DAY(IDX1) TO
                                     LNK-NYURECEDEN-HKNCOMBI(2 IDX2)
                     MOVE  WRK-SO-MEISAISU(IDX1)   TO
                                     LNK-NYURECEDEN-MEISAISU(2 IDX2)
                     PERFORM   VARYING   IDX3   FROM   1   BY  1
                               UNTIL (WRK-SO-SRYCD(IDX1 IDX3) = SPACE)
                                  OR (IDX3   >   20)
                         MOVE   "SI"   TO   
                                    LNK-NYURECEDEN-RECSKB(2 IDX2 IDX3)
                         IF    IDX3   =    1
                               MOVE   WRK-SO-SRYKBN(IDX1)  TO   
                                    LNK-NYURECEDEN-SRYSKB(2 IDX2 IDX3)
                         END-IF
                         MOVE  WRK-SO-SRYCD(IDX1 IDX3) TO
                                    LNK-NYURECEDEN-SRYCD(2 IDX2 IDX3)
                         MOVE  ZERO     TO    IDX4
                         COMPUTE   IDX4 =    IDX3   +   1
                         IF    WRK-SO-SRYCD(IDX1 IDX4)    =    SPACE
                               MOVE   WRK-SO-TEN(IDX1)   TO
                                      LNK-NYURECEDEN-TEN(2 IDX2 IDX3)
                               MOVE   WRK-SO-KAISU(IDX1)   TO
                                     LNK-NYURECEDEN-KAISU(2 IDX2 IDX3)
                         END-IF
                     END-PERFORM
      *              外泊コメントセット処理
                     INITIALIZE    WRK-GAIHAKU-DAY-TABLE
                     IF   WRK-SO-GAIHAKU-TBL(IDX1)   =  ALL"0"
                         CONTINUE
                     ELSE
                         MOVE     ZERO    TO   IDX6
                         PERFORM  VARYING  IDX5   FROM  1  BY  1
                           UNTIL  IDX5   >  31
                               IF   WRK-SO-GAIHAKU-KBN(IDX1 IDX5)  =
                                                         1   OR  2
                                 IF  IDX5   =   1
                                    ADD   1    TO   IDX6
                                    MOVE  IDX5   TO  
                                               WRK-GAIHAKU-DAY-ST(IDX6)
                                    MOVE  IDX5   TO  
                                               WRK-GAIHAKU-DAY-ED(IDX6)
                                 ELSE
                                   COMPUTE   IDX7  =   IDX5  -  1
                                   IF WRK-SO-GAIHAKU-KBN(IDX1 IDX7) =
                                                         1   OR  2
                                        MOVE  IDX5  TO
                                              WRK-GAIHAKU-DAY-ED(IDX6)
                                   ELSE
                                     ADD   1    TO   IDX6
                                     MOVE  IDX5   TO  
                                              WRK-GAIHAKU-DAY-ST(IDX6)
                                     MOVE  IDX5   TO  
                                              WRK-GAIHAKU-DAY-ED(IDX6)
                                   END-IF
                                 END-IF
                               END-IF
                         END-PERFORM
                       PERFORM   VARYING  IDX5  FROM  1  BY  1
                       UNTIL   (IDX5  >  31)   OR
                               (WRK-GAIHAKU-DAY-ST(IDX5) =  ZERO)
                           ADD    1     TO
                                       LNK-NYURECEDEN-MEISAISU(2 IDX2)
                           IF   WRK-GAIHAKU-DAY-ST(IDX5) = 
                                               WRK-GAIHAKU-DAY-ED(IDX5)
                                MOVE   "CO"   TO   
                                    LNK-NYURECEDEN-RECSKB(2 IDX2 IDX3)
                                MOVE  "840000015"  TO
                                      LNK-NYURECEDEN-SRYCD(2 IDX2 IDX3)
                                MOVE   WRK-GAIHAKU-DAY-ST(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(2 IDX2 IDX3)
                           ELSE
                                MOVE   "CO"   TO   
                                    LNK-NYURECEDEN-RECSKB(2 IDX2 IDX3)
                                MOVE  "840000016"  TO
                                      LNK-NYURECEDEN-SRYCD(2 IDX2 IDX3)
                                MOVE   WRK-GAIHAKU-DAY-ST(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(2 IDX2 IDX3)
                                                          (1:4)
                                MOVE   WRK-GAIHAKU-DAY-ED(IDX5) TO IDX6
                                MOVE   TBL-DAY(IDX6)  TO
                                    LNK-NYURECEDEN-COMMENT(2 IDX2 IDX3)
                                                          (5:4)
                           END-IF
                           ADD    1     TO   IDX3
                       END-PERFORM
                     END-IF
                END-IF
           END-PERFORM
      *
      *    食事情報の編集
           IF   LNK-NYURECEDEN-SANTEIYM  <=  "200603"
               PERFORM   2101-SHOKUJI-HENSHU1-SEC
           ELSE
               PERFORM   2103-SHOKUJI-HENSHU3-SEC
           END-IF
      *
      *    入院時生活療養（環境療養）の編集
           IF  (LNK-NYURECEDEN-SANTEIYM  >=  "200610")  AND
               (LNK-NYULIFE-RC           =    ZERO)
               PERFORM   2104-KANKYO-HENSHU-SEC
           END-IF
      *
           .
       200-MAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院診療行為取得
      *****************************************************************
       210-NYUINACT-GET-SEC            SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM       TO  NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN     TO  NSRY-NYUGAIKBN
           MOVE    NACCT-PTID          TO  NSRY-PTID
           MOVE    NACCT-SRYYM         TO  NSRY-SRYYM
           MOVE    NACCT-ZAINUM        TO  NSRY-ZAINUM
           MOVE    "tbl_nyuinact"      TO  MCP-TABLE
           MOVE    "key9"              TO  MCP-PATHNAME
           PERFORM 910-NYUINACT-SELECT-SEC
           IF      FLG-NYUINACT        =   ZERO
               MOVE    "tbl_nyuinact"  TO  MCP-TABLE
               MOVE    "key9"          TO  MCP-PATHNAME
               PERFORM   910-NYUINACT-READ-SEC
           END-IF
      *
      *    入院行為クローズ
           MOVE     "tbl_nyuinact"     TO  MCP-TABLE
           MOVE     "key9"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210-NYUINACT-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    外泊前処理
      *****************************************************************
       210-GAIHAKU-MAE-SEC            SECTION.
      *
      *    外泊コード編集用に入院基本料加算区分と診療区分の退避
           INITIALIZE                      TNS-TENSU-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM
                                       TO  TNS-HOSPNUM
           MOVE    NSRY-SRYCD(1)       TO  TNS-SRYCD
           MOVE    LNK-NYURECEDEN-SANTEIYM
                                       TO  TNS-YUKOSTYMD(1:6)
           MOVE    "01"                TO  TNS-YUKOSTYMD(7:2)
           MOVE    TNS-YUKOSTYMD       TO  TNS-YUKOEDYMD
           PERFORM 910-TENSU-READ-SEC
           MOVE    TNS-NYUKHNKSNKBN    TO  WRK-KSNKBN
      *
           .
       210-GAIHAKU-MAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    外泊診療コード取得
      *****************************************************************
       210-GAIHAKU-SET-SEC            SECTION.
      *
           MOVE   NACCT-DAY(IDX1)     TO    WRK-GAIHAKU-KBN(IDX1)
      *
           EVALUATE   WRK-SRYKBN(IDX1)
              WHEN     "90"
                 EVALUATE   NACCT-DAY(IDX1)
                    WHEN     1
                      MOVE   "190107290"   TO  WRK-GAIHAKU(IDX1)
                    WHEN     2
                      MOVE   "190107390"   TO  WRK-GAIHAKU(IDX1)
                    WHEN     4
                      PERFORM   2101-GAIHAKU-TAKIKAN-SEC
                    WHEN     5
                      PERFORM   2101-GAIHAKU-TAKIKAN-SEC
                 END-EVALUATE
              WHEN     "92"
                 EVALUATE   NACCT-DAY(IDX1)
                    WHEN     1
                      MOVE   "190107490"   TO  WRK-GAIHAKU(IDX1)
                    WHEN     2
                      MOVE   "190107590"   TO  WRK-GAIHAKU(IDX1)
                    WHEN     4
                      PERFORM   2101-GAIHAKU-TAKIKAN-SEC
                    WHEN     5
                      PERFORM   2101-GAIHAKU-TAKIKAN-SEC
                 END-EVALUATE
           END-EVALUATE
      *
           .
       210-GAIHAKU-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    外泊診療コード取得
      *****************************************************************
       2101-GAIHAKU-TAKIKAN-SEC           SECTION.
      *
           EVALUATE   WRK-NYUKHNKSNKBN(IDX1)
      *
               WHEN   099  THRU  100
                 IF   LNK-NYURECEDEN-SANTEIYM   >=   "201004"
                   EVALUATE   NACCT-DAY(IDX1)
                    WHEN     4
                      MOVE   "190108890"    TO   WRK-GAIHAKU(IDX1)
                    WHEN     5
                      MOVE   "190142190"    TO   WRK-GAIHAKU(IDX1)
                   END-EVALUATE
                 END-IF
               WHEN   201  THRU  219
               WHEN   221  THRU  222
               WHEN   224
               WHEN   227  THRU  229
               WHEN   230  THRU  239
               WHEN   241  THRU  249
                 EVALUATE   NACCT-DAY(IDX1)
                    WHEN     4
                      MOVE   "190108790"    TO   WRK-GAIHAKU(IDX1)
                    WHEN     5
                      MOVE   "190142090"    TO   WRK-GAIHAKU(IDX1)
                 END-EVALUATE
               WHEN   013  THRU  021
               WHEN   101  THRU  109
               WHEN   147  THRU  152
               WHEN   173  THRU  190
                 EVALUATE   NACCT-DAY(IDX1)
                    WHEN     4
                      MOVE   "190108890"    TO   WRK-GAIHAKU(IDX1)
                    WHEN     5
                      MOVE   "190142190"    TO   WRK-GAIHAKU(IDX1)
                 END-EVALUATE
               WHEN   075  THRU  080
                 EVALUATE   NACCT-DAY(IDX1)
                    WHEN     4
                      MOVE   "190108990"    TO   WRK-GAIHAKU(IDX1)
                 END-EVALUATE
               WHEN   085  THRU  086
               WHEN   132  THRU  133
               WHEN   153  THRU  158
                 EVALUATE   NACCT-DAY(IDX1)
                    WHEN     4
                      MOVE   "190109090"    TO   WRK-GAIHAKU(IDX1)
                    WHEN     5
                      MOVE   "190142290"    TO   WRK-GAIHAKU(IDX1)
                 END-EVALUATE
               WHEN   226
               WHEN   240
                 CONTINUE
               WHEN   OTHER
                 EVALUATE   NACCT-DAY(IDX1)
                    WHEN     5
                      MOVE   "190141590"    TO   WRK-GAIHAKU(IDX1)
                 END-EVALUATE
      *
           END-EVALUATE
      *
           .
       2101-GAIHAKU-TAKIKAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    老人対象患者チェック
      *****************************************************************
       210-RJN-TAISYO-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-RJN
      *
      *    入院患者の老人保険判定
           MOVE    ZERO                TO   FLG-HKNCOMBI
           INITIALIZE                       HKNCOMBI-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM TO  COMB-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID  TO   COMB-PTID
           PERFORM   VARYING   IDX   FROM  1  BY  1
                     UNTIL     (WRK-HKNCOMBI-DAY(IDX)  NOT =  ZERO) OR
                               (IDX     >   31)
               IF   WRK-HKNCOMBI-DAY(IDX)   NOT =   ZERO
                  MOVE    WRK-HKNCOMBI-DAY(IDX)
                                       TO   COMB-HKNCOMBINUM
               END-IF
           END-PERFORM
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-HKNCOMBI-SELECT-SEC
           IF      FLG-HKNCOMBI        =    ZERO
               MOVE    "tbl_hkncombi"  TO  MCP-TABLE
               MOVE    "key"           TO  MCP-PATHNAME
               PERFORM   910-HKNCOMBI-READ-SEC
           END-IF
      *    保険組合せクローズ
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *    入院患者の年齢計算
           INITIALIZE                      ORCSAGECHKAREA
           MOVE    LNK-NYURECEDEN-HOSPNUM
                                       TO  AGECHK-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID
                                       TO  AGECHK-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM
                                       TO  AGECHK-SRYYMD(1:6)
           MOVE    "01"                TO  AGECHK-SRYYMD(7:2)
           MOVE    PTINF-BIRTHDAY      TO  AGECHK-BIRTHDAY
           CALL    "ORCSAGECHK"        USING
                                           ORCSAGECHKAREA
                                           SPA-AREA
           IF    ( AGECHK-RC           =   ZERO )
               CONTINUE
           ELSE
               INITIALIZE  ORCSAGECHKAREA
           END-IF
      *
      *    老人対象患者判定
           IF    ((FLG-HKNCOMBI        =   ZERO)    AND
                  (COMB-KOH1HKNNUM     =   "027"))   OR
                 ( AGECHK-NENREI      >=    75)      OR
                 ((AGECHK-NENREI      >=    70)     AND
                  (PTINF-BIRTHDAY     <=   "19320930"))
               MOVE    1               TO  FLG-RJN
           END-IF
      *
           .
       210-RJN-TAISYO-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数計算処理
      *****************************************************************
       210-TENSU-KEISAN-SEC            SECTION.
      *
           INITIALIZE                      TNS-TENSU-REC
           IF     (IDX2                   =     1  )
           AND    (WRK-GAIHAKU(IDX1)   NOT =   SPACE)
               PERFORM    2101-GAIHAKU-NYUINKHN-SET-SEC
               IF    WRK-GAIHAKU-SRYCD    NOT =   SPACE
                  MOVE    WRK-GAIHAKU-SRYCD   TO  TNS-SRYCD
               ELSE
                  MOVE    WRK-SO-SRYCD(IDX1 IDX2)
                                              TO  TNS-SRYCD
               END-IF
           ELSE
                  MOVE    WRK-SO-SRYCD(IDX1 IDX2)
                                              TO  TNS-SRYCD
           END-IF
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  TNS-HOSPNUM
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  TNS-YUKOSTYMD(1:6)
           MOVE    "01"                    TO  TNS-YUKOSTYMD(7:2)
           MOVE    TNS-YUKOSTYMD           TO  TNS-YUKOEDYMD
           MOVE    TNS-SRYCD    TO   WRK-TENSU-CD
           PERFORM 910-TENSUWRK-CHK-SEC
           IF      FLG-TENSUWRK   =    ZERO
               PERFORM 910-TENSU-READ-SEC
               PERFORM 910-TTNS-HEN-SEC
           END-IF
      *
      *    点数算定
           EVALUATE    TNS-TENSIKIBETU
      *        点数（プラス）
               WHEN    3
                   ADD   TNS-TEN     TO  WRK-SO-TEN(IDX1)
      *        ％加算
               WHEN    5
                   COMPUTE    WRK-SO-TEN(IDX1)  =
                              WRK-SO-TEN(IDX1)  +
                            ((WRK-SO-TEN(IDX1)  *
                              (TNS-TEN   /  100))  + 0.5)
      *        ％減算
               WHEN    6
                   COMPUTE    WRK-SO-TEN(IDX1)  =
                            ( WRK-SO-TEN(IDX1)  -
                             (WRK-SO-TEN(IDX1)  *
                             (TNS-TEN   /  100)))        +  0.5
      *        点数（マイナス）
               WHEN    8
                   COMPUTE  WRK-SO-TEN(IDX1)  =
                            WRK-SO-TEN(IDX1)  -  TNS-TEN
      *        WHEN  OTHER
      *            ADD   TNS-TEN     TO  WRK-SO-TEN(IDX1)
           END-EVALUATE
      *
      *    診療コード計
           MOVE    TNS-SRYCD          TO  WRK-SRYCD-X
           COMPUTE WRK-SO-SRYCDTOTAL(IDX1)  =
                   WRK-SO-SRYCDTOTAL(IDX1)  +   WRK-SRYCD-9
           ADD      1          TO  WRK-SO-MEISAISU(IDX1)
      *
           .
       210-TENSU-KEISAN-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊時の入院基本料取得
      **************************************************************
       2101-GAIHAKU-NYUINKHN-SET-SEC           SECTION.
      *
           MOVE    SPACE    TO   WRK-GAIHAKU-SRYCD
      *
           EVALUATE  WRK-SO-SRYCD(IDX1 IDX2)
               WHEN  "190078210"
                     MOVE  "190077410"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078310"
                     MOVE  "190077510"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078410"
                     MOVE  "190077610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078510"
                     MOVE  "190077710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078610"
                     MOVE  "190077810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078710"
                     MOVE  "190077910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078810"
                     MOVE  "190078010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078910"
                     MOVE  "190078110"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190082410"
                     MOVE  "190081710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082510"
                     MOVE  "190081810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082610"
                     MOVE  "190081910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082710"
                     MOVE  "190082010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082810"
                     MOVE  "190082110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082910"
                     MOVE  "190082210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190083010"
                     MOVE  "190082310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190084310"
                     MOVE  "190083610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084410"
                     MOVE  "190083710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084510"
                     MOVE  "190083810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084610"
                     MOVE  "190083910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084710"
                     MOVE  "190084010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084810"
                     MOVE  "190084110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084910"
                     MOVE  "190084210"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190087410"
                     MOVE  "190085910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087510"
                     MOVE  "190086010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087610"
                     MOVE  "190086110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087710"
                     MOVE  "190086210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087810"
                     MOVE  "190086310"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087910"
                     MOVE  "190086410"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088010"
                     MOVE  "190086510"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088110"
                     MOVE  "190086610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088210"
                     MOVE  "190086710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088310"
                     MOVE  "190086810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088410"
                     MOVE  "190086910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088510"
                     MOVE  "190087010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088610"
                     MOVE  "190087110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088710"
                     MOVE  "190087210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088810"
                     MOVE  "190087310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190094710"
                     MOVE  "190093710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190094810"
                     MOVE  "190093810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190094910"
                     MOVE  "190093910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190095010"
                     MOVE  "190094010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190095110"
                     MOVE  "190094110"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190797410"
                     MOVE  "190796610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797510"
                     MOVE  "190796710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797610"
                     MOVE  "190796810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797710"
                     MOVE  "190796910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797810"
                     MOVE  "190797010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797910"
                     MOVE  "190797110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190798010"
                     MOVE  "190797210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190798110"
                     MOVE  "190797310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190803510"
                     MOVE  "190802810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803610"
                     MOVE  "190802910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803710"
                     MOVE  "190803010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803810"
                     MOVE  "190803110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803910"
                     MOVE  "190803210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190804010"
                     MOVE  "190803310"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190804110"
                     MOVE  "190803410"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190091210"
                     MOVE  "190090210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190091310"
                     MOVE  "190090310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190109670"
                     MOVE  "190097010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190808870"
                     MOVE  "190805710"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190117070"
                     MOVE  "190097010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190813270"
                     MOVE  "190805710"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190117670"
                     MOVE  "190097010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190813870"
                     MOVE  "190805710"      TO   WRK-GAIHAKU-SRYCD
      *        診療所老人医療管理料
               WHEN  "190774210"
                     MOVE  "190774110"      TO   WRK-GAIHAKU-SRYCD
      *        老人性認知症疾患治療病棟入院料１
               WHEN  "190740010"
                     MOVE  "190739910"      TO   WRK-GAIHAKU-SRYCD
      *        老人性認知症疾患治療病棟入院料２
               WHEN  "190813510"
                     MOVE  "190813410"      TO   WRK-GAIHAKU-SRYCD
           END-EVALUATE
      *
           IF   (LNK-NYURECEDEN-SANTEIYM  >= "200604"   )
           AND  (WRK-GAIHAKU-SRYCD  = "190774110" OR
                                      "190739910" OR
                                      "190813410")
               MOVE    SPACE    TO    WRK-GAIHAKU-SRYCD
           END-IF
      *
           IF    WRK-GAIHAKU-SRYCD   NOT =   SPACE
               MOVE   WRK-GAIHAKU-SRYCD   TO   WRK-SO-SRYCD(IDX1 IDX2)
           END-IF
      *
           .
       2101-GAIHAKU-NYUINKHN-SET-EXT.
           EXIT.
      *
      ******************************************************************
      *    月内に複数の医療期間情報がないか検索（医療機関減算の確認）  *
      ******************************************************************
       210-SYS-5000-CHK-SEC                 SECTION.
      *
           MOVE    ZERO                TO  WRK-SYS5000-COUNT
      *
           MOVE    ZERO                TO  FLG-SYSKANRI
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    LNK-NYURECEDEN-SANTEIYM
                                       TO  SYS-STYUKYMD(1:6)
           MOVE    "__"                TO  SYS-STYUKYMD(7:2)
           MOVE    LNK-NYURECEDEN-HOSPNUM
                                       TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"    TO  MCP-TABLE
               MOVE    "key11"           TO  MCP-PATHNAME
               PERFORM  910-SYSKANRI-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
                   ADD     1     TO        WRK-SYS5000-COUNT
                   MOVE    "tbl_syskanri"    TO  MCP-TABLE
                   MOVE    "key11"           TO  MCP-PATHNAME
                   PERFORM  910-SYSKANRI-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
      *
       210-SYS-5000-CHK-EXT.
           EXIT.
      *
      ******************************************************************
      *    月内の医療期間情報取得（医療機関減算情報）                  *
      ******************************************************************
       210-SYS-5000-GET-SEC                 SECTION.
      *
           MOVE    ZERO                TO  FLG-SYSKANRI
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    LNK-NYURECEDEN-SANTEIYM
                                       TO  SYS-STYUKYMD(1:6)
           MOVE    "__"                TO  SYS-STYUKYMD(7:2)
           MOVE    LNK-NYURECEDEN-HOSPNUM
                                       TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"    TO  MCP-TABLE
               MOVE    "key11"           TO  MCP-PATHNAME
               PERFORM  910-SYSKANRI-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
                 MOVE   SYS-5000-STYUKYMD(7:2)  TO  IDV
      *          食事の特別管理加算退避
                 IF     SYS-5000-SHOKUCD(1)  NOT =  SPACE
                    IF  SYS-5000-SHOKUKBN(1) =     "2"
                        PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                                  UNTIL     GENSAN-IDX2   >   31
                            MOVE  SYS-5000-SHOKUCD(1)
                                  TO WRK-SYS5000-SHOKUCD(2 GENSAN-IDX2)
                        END-PERFORM
                    ELSE
                        PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                                  UNTIL     GENSAN-IDX2   >   31
                            MOVE  SPACE
                                  TO WRK-SYS5000-SHOKUCD(2 GENSAN-IDX2)
                        END-PERFORM
                    END-IF
                 ELSE
                    PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                              UNTIL     GENSAN-IDX2   >   31
                        MOVE SPACE TO WRK-SYS5000-SHOKUCD(2 GENSAN-IDX2)
                    END-PERFORM
                 END-IF
                 PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                            UNTIL     GENSAN-IDX   >   4
                    IF    SYS-5000-GENKBN(GENSAN-IDX)   =   "2"
                        EVALUATE  GENSAN-IDX
                            WHEN  2
                              IF   FLG-RJN    =    ZERO
                                  MOVE  "190080570"  TO  WRK-GENSAN2
                              ELSE
                                  MOVE  "190799770"  TO  WRK-GENSAN2
                              END-IF
                              PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                                  UNTIL     GENSAN-IDX2   >   31
                                MOVE   "1"  TO
                                        WRK-GENSAN-INNAI(GENSAN-IDX2)
                              END-PERFORM
                            WHEN  3
                              IF   FLG-RJN    =    ZERO
                                  MOVE  "190111690"  TO  WRK-GENSAN3
                              ELSE
                                  MOVE  "190809090"  TO  WRK-GENSAN3
                              END-IF
                              PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                                  UNTIL     GENSAN-IDX2   >   31
                                MOVE   "1"  TO
                                        WRK-GENSAN-IRYO(GENSAN-IDX2)
                              END-PERFORM
                            WHEN  4
                              IF   FLG-RJN    =    ZERO
                                  MOVE  "190111790"  TO  WRK-GENSAN4
                              ELSE
                                  MOVE  "190809190"  TO  WRK-GENSAN4
                              END-IF
                              PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                                  UNTIL     GENSAN-IDX2   >   31
                                MOVE   "1"  TO
                                        WRK-GENSAN-JYOKU(GENSAN-IDX2)
                              END-PERFORM
                        END-EVALUATE
                    ELSE
                        EVALUATE  GENSAN-IDX
                            WHEN  2
                              PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                                  UNTIL     GENSAN-IDX2   >   31
                                MOVE   SPACE  TO
                                        WRK-GENSAN-INNAI(GENSAN-IDX2)
                              END-PERFORM
                            WHEN  3
                              PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                                  UNTIL     GENSAN-IDX2   >   31
                                MOVE   SPACE  TO
                                        WRK-GENSAN-IRYO(GENSAN-IDX2)
                              END-PERFORM
                            WHEN  4
                              PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                                  UNTIL     GENSAN-IDX2   >   31
                                MOVE   SPACE  TO
                                        WRK-GENSAN-JYOKU(GENSAN-IDX2)
                              END-PERFORM
                        END-EVALUATE
                    END-IF
                 END-PERFORM
                 MOVE    "tbl_syskanri"    TO  MCP-TABLE
                 MOVE    "key11"           TO  MCP-PATHNAME
                 PERFORM  910-SYSKANRI-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
      *
       210-SYS-5000-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事情報の編集（平成１８年３月迄）
      *****************************************************************
       2101-SHOKUJI-HENSHU1-SEC        SECTION.
      *
      *食事情報の取得（入院会計）
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key28"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key28"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   VARYING   IDX1   FROM  1   BY  1
                         UNTIL     IDX1   >    31
                   IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)  AND
                         (NACCT-DAY(IDX1)    NOT =  ZERO)     AND
                         (WRK-NYUINKHN(IDX1) NOT =  SPACE)    AND
                         (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                       TO  WRK-SKJ-HKNCOMBI-DAY(IDX1)
                                           WRK-SKJ2-HKNCOMBI-DAY(IDX1)
                                           WRK-SKJ3-HKNCOMBI-DAY(IDX1)
                                         WRK-SKJFTN-HKNCOMBI-DAY(IDX1)
                       EVALUATE   NACCT-DAY(IDX1)
                           WHEN   1
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                               TO  WRK-SKJ-RYOYO(IDX1)
                               EVALUATE  WRK-SYS5000-SHOKUCD(1 IDX1)
                                   WHEN  "197000110"
                                      ADD  1920 TO WRK-SKJ-MONEY(IDX1)
                                   WHEN  "197000710"
                                      ADD  1520 TO WRK-SKJ-MONEY(IDX1)
                               END-EVALUATE
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                         TO  WRK-SKJFTN-SRYCD(IDX1)
                               END-IF
                           WHEN   2
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                               TO  WRK-SKJ-RYOYO(IDX1)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000470"
                                         TO  WRK-SKJ3-TOKU-SHOKU(IDX1)
                               END-IF
                               EVALUATE  WRK-SYS5000-SHOKUCD(1 IDX1)
                                   WHEN  "197000110"
                                      ADD  1920 TO WRK-SKJ-MONEY(IDX1)
                                   WHEN  "197000710"
                                      ADD  1520 TO WRK-SKJ-MONEY(IDX1)
                               END-EVALUATE
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                         TO  WRK-SKJFTN-SRYCD(IDX1)
                               END-IF
                           WHEN   3
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                               TO  WRK-SKJ-RYOYO(IDX1)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000670"
                                          TO  WRK-SKJ2-FUKUSU(IDX1)
                               END-IF
                               EVALUATE  WRK-SYS5000-SHOKUCD(1 IDX1)
                                   WHEN  "197000110"
                                      ADD  1920 TO WRK-SKJ-MONEY(IDX1)
                                   WHEN  "197000710"
                                      ADD  1520 TO WRK-SKJ-MONEY(IDX1)
                               END-EVALUATE
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                         TO  WRK-SKJFTN-SRYCD(IDX1)
                               END-IF
                           WHEN   4
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                               TO  WRK-SKJ-RYOYO(IDX1)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000470"
                                         TO  WRK-SKJ3-TOKU-SHOKU(IDX1)
                                   MOVE   "197000670"
                                          TO  WRK-SKJ2-FUKUSU(IDX1)
                               END-IF
                               EVALUATE  WRK-SYS5000-SHOKUCD(1 IDX1)
                                   WHEN  "197000110"
                                      ADD  1920 TO WRK-SKJ-MONEY(IDX1)
                                   WHEN  "197000710"
                                      ADD  1520 TO WRK-SKJ-MONEY(IDX1)
                               END-EVALUATE
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                         TO  WRK-SKJFTN-SRYCD(IDX1)
                               END-IF
                       END-EVALUATE
      *                特別管理加算
                       IF    WRK-SYS5000-SHOKUCD(2 IDX1)  NOT = SPACE
                           MOVE  WRK-SYS5000-SHOKUCD(2 IDX1)
                                          TO  WRK-SKJ-TOKU-KANRI(IDX1)
                           ADD   200          TO  WRK-SKJ-MONEY(IDX1)
                       END-IF
      *                食堂加算
                       IF    WRK-SYS5000-SHOKUCD(3 IDX1)  NOT = SPACE
                           MOVE  WRK-SYS5000-SHOKUCD(3 IDX1)
                                          TO  WRK-SKJ-SHOKUDOU(IDX1)
                           ADD    50          TO  WRK-SKJ-MONEY(IDX1)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *
      *低所得情報の取得
           INITIALIZE                          TSYRRK-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  TSYRRK-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  TSYRRK-PTID
           MOVE    "tbl_tsyrrk"            TO  MCP-TABLE
           MOVE    "key3"                  TO  MCP-PATHNAME
           PERFORM 910-TSYRRK-SELECT-SEC
           IF      FLG-TSYRRK              =   ZERO
               MOVE    "tbl_tsyrrk"        TO  MCP-TABLE
               MOVE    "key3"              TO  MCP-PATHNAME
               PERFORM 910-TSYRRK-READ-SEC
               PERFORM  UNTIL  
                  ( FLG-TSYRRK          =   1                ) OR
                 (( TSYRRK-NINSTYMD(1:6) <= LNK-NYURECEDEN-SANTEIYM AND
                    LNK-NYURECEDEN-SANTEIYM <= TSYRRK-NINEDYMD(1:6) ))
      *
                   MOVE    "tbl_tsyrrk"     TO  MCP-TABLE
                   MOVE    "key3"           TO  MCP-PATHNAME
                   PERFORM 910-TSYRRK-READ-SEC
      *
               END-PERFORM
           END-IF
           IF      FLG-TSYRRK              =   ZERO
              IF  (LNK-NYURECEDEN-SANTEIYM   =  TSYRRK-NINSTYMD(1:6))
              AND (TSYRRK-NINSTYMD(7:2)      NOT =  "01")
                CONTINUE
              ELSE
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                          UNTIL     IDX1   >    31
                    IF    WRK-SKJ-RYOYO(IDX1)  NOT =  SPACE
                        MOVE   "197000910"
                                        TO  WRK-SKJFTN-SRYCD(IDX1)
                    END-IF
                END-PERFORM
              END-IF
           END-IF
      *
           MOVE     "tbl_tsyrrk"        TO  MCP-TABLE
           MOVE     "key3"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *９０日越え（低所得情報）
           IF  (TSYRRK-SKJGNSTYMD(1:6)  <= LNK-NYURECEDEN-SANTEIYM) AND
               (TSYRRK-SKJGNSTYMD       NOT = SPACE)
             IF (LNK-NYURECEDEN-SANTEIYM  = TSYRRK-SKJGNSTYMD(1:6)) AND
                (TSYRRK-SKJGNSTYMD(7:2)   NOT = "01")
               CONTINUE
             ELSE
               IF  TSYRRK-SKJGNSTYMD(1:6)  <  LNK-NYURECEDEN-SANTEIYM
                   MOVE   1             TO   TSY90-IDX
               ELSE
                   MOVE   TSYRRK-SKJGNSTYMD(7:2)   TO  TSY90-IDX
               END-IF
               PERFORM   VARYING   IDX1   FROM   TSY90-IDX  BY  1
                          UNTIL     IDX1   >    31
                    IF    WRK-SKJ-RYOYO(IDX1)  NOT =  SPACE
                        MOVE   "197001010"
                                        TO  WRK-SKJFTN-SRYCD(IDX1)
                    END-IF
               END-PERFORM
             END-IF
           END-IF
      *
      *低年金情報の取得
           INITIALIZE                          TNKRRK-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  TNKRRK-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  TNKRRK-PTID
           MOVE    "tbl_tnkrrk"            TO  MCP-TABLE
           MOVE    "key3"                  TO  MCP-PATHNAME
           PERFORM 910-TNKRRK-SELECT-SEC
           IF      FLG-TNKRRK              =   ZERO
               MOVE    "tbl_tnkrrk"        TO  MCP-TABLE
               MOVE    "key3"              TO  MCP-PATHNAME
               PERFORM 910-TNKRRK-READ-SEC
               PERFORM  UNTIL  
                  ( FLG-TNKRRK          =   1                ) OR
                 (( TNKRRK-STYMD(1:6) <= LNK-NYURECEDEN-SANTEIYM AND
                    LNK-NYURECEDEN-SANTEIYM <= TNKRRK-EDYMD(1:6) ))
      *
                   MOVE    "tbl_tnkrrk"       TO  MCP-TABLE
                   MOVE    "key3"             TO  MCP-PATHNAME
                   PERFORM 910-TNKRRK-READ-SEC
      *
               END-PERFORM
           END-IF
           IF      FLG-TNKRRK              =   ZERO
              IF  (LNK-NYURECEDEN-SANTEIYM   =  TNKRRK-STYMD(1:6))
              AND (TNKRRK-STYMD(7:2)     NOT =  "01")
                CONTINUE
              ELSE
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                          UNTIL     IDX1   >    31
                    IF    WRK-SKJ-RYOYO(IDX1)  NOT =  SPACE
                        MOVE   "197001110"
                                        TO  WRK-SKJFTN-SRYCD(IDX1)
                    END-IF
                END-PERFORM
              END-IF
           END-IF
      *
           MOVE     "tbl_tnkrrk"        TO  MCP-TABLE
           MOVE     "key3"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *
      *    食事の診療コード計
           PERFORM    VARYING   IDX1    FROM  1  BY  1
                      UNTIL     IDX1    >   31
               PERFORM   VARYING  IDX2  FROM  1  BY  1
                         UNTIL    IDX2    >   3
                   IF   WRK-SKJ-SRYCD(IDX1 IDX2)  NOT =  SPACE
                       MOVE    WRK-SKJ-SRYCD(IDX1 IDX2) TO WRK-SRYCD-X
                       COMPUTE WRK-SKJ-SRYCDTOTAL(IDX1)  =
                               WRK-SKJ-SRYCDTOTAL(IDX1)  + WRK-SRYCD-9
                   END-IF
               END-PERFORM
           END-PERFORM
      *
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"             TO  MCP-TABLE
           MOVE    "key28"                     TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *    再構築した食事情報から同一剤のまとめ処理
      *    食事ワーク
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
               IF    WRK-SKJ-SRYCDTOTAL(IDX1)  NOT =   ZERO
                   ADD   1                  TO  WRK-SKJ-KAISU(IDX1)
                   MOVE       ZERO          TO  IDX2
                   COMPUTE    IDX2          =   IDX1    +   1
                   PERFORM    VARYING    IDX3   FROM   IDX2  BY  1
                              UNTIL      IDX3   >   31
                       IF    (WRK-SKJ-HKNCOMBI-DAY(IDX3)  =
                                       WRK-SKJ-HKNCOMBI-DAY(IDX1)) AND
                             (WRK-SKJ-SRYCDTOTAL(IDX3)  =
                                       WRK-SKJ-SRYCDTOTAL(IDX1))
                             ADD     1    TO    WRK-SKJ-KAISU(IDX1)
                             INITIALIZE   WRK-SKJ-TBL(IDX3)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
      *    食事ワーク２（複数献立加算）
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
               IF    WRK-SKJ2-FUKUSU(IDX1)  NOT =   SPACE
                   ADD   1                  TO  WRK-SKJ2-KAISU(IDX1)
                   MOVE       ZERO          TO  IDX2
                   COMPUTE    IDX2          =   IDX1    +   1
                   PERFORM    VARYING    IDX3   FROM   IDX2  BY  1
                              UNTIL      IDX3   >   31
                       IF    (WRK-SKJ2-HKNCOMBI-DAY(IDX3)  =
                                      WRK-SKJ2-HKNCOMBI-DAY(IDX1)) AND
                             (WRK-SKJ2-FUKUSU(IDX3)  =
                                       WRK-SKJ2-FUKUSU(IDX1))
                             ADD     1    TO    WRK-SKJ2-KAISU(IDX1)
                             INITIALIZE   WRK-SKJ2-TBL(IDX3)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
      *    食事ワーク３（特別食加算）
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
               IF    WRK-SKJ3-TOKU-SHOKU(IDX1)  NOT =   SPACE
                   ADD   1                  TO  WRK-SKJ3-KAISU(IDX1)
                   MOVE       ZERO          TO  IDX2
                   COMPUTE    IDX2          =   IDX1    +   1
                   PERFORM    VARYING    IDX3   FROM   IDX2  BY  1
                              UNTIL      IDX3   >   31
                       IF    (WRK-SKJ3-HKNCOMBI-DAY(IDX3)  =
                                      WRK-SKJ3-HKNCOMBI-DAY(IDX1)) AND
                             (WRK-SKJ3-TOKU-SHOKU(IDX3)  =
                                       WRK-SKJ3-TOKU-SHOKU(IDX1))
                             ADD     1    TO    WRK-SKJ3-KAISU(IDX1)
                             INITIALIZE   WRK-SKJ3-TBL(IDX3)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
      *    食事負担ワーク
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
               IF    WRK-SKJFTN-SRYCD(IDX1)  NOT =   SPACE
                   ADD   1                  TO  WRK-SKJFTN-KAISU(IDX1)
                   MOVE       ZERO          TO  IDX2
                   COMPUTE    IDX2          =   IDX1    +   1
                   PERFORM    VARYING    IDX3   FROM   IDX2  BY  1
                              UNTIL      IDX3   >   31
                       IF    (WRK-SKJFTN-HKNCOMBI-DAY(IDX3)  =
                                    WRK-SKJFTN-HKNCOMBI-DAY(IDX1)) AND
                             (WRK-SKJFTN-SRYCD(IDX3)  =
                                       WRK-SKJFTN-SRYCD(IDX1))
                             ADD     1    TO    WRK-SKJFTN-KAISU(IDX1)
                             INITIALIZE   WRK-SKJFTN-TBL(IDX3)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
      *   結果表示
      **     PERFORM    VARYING   IDX1   FROM  1  BY  1
      **                UNTIL     (IDX1   >     31)
      **          DISPLAY  "IDX1 = " IDX1
      **          DISPLAY  "WRK-SKJ-HKNCOMBI-DAY = " 
      **                    WRK-SKJ-HKNCOMBI-DAY(IDX1)
      **          DISPLAY  "WRK-SKJ-SRYCD(1) = " WRK-SKJ-SRYCD(IDX1 1)
      **          DISPLAY  "WRK-SKJ-SRYCD(2) = " WRK-SKJ-SRYCD(IDX1 2)
      **          DISPLAY  "WRK-SKJ-SRYCD(3) = " WRK-SKJ-SRYCD(IDX1 3)
      **          DISPLAY  "WRK-SKJ-SRYCDTOTAL = "
      **                                      WRK-SKJ-SRYCDTOTAL(IDX1)
      **          DISPLAY  "WRK-SKJ-MONEY    = " WRK-SKJ-MONEY(IDX1)
      **          DISPLAY  "WRK-SKJ-KAISU    = " WRK-SKJ-KAISU(IDX1)
      **     END-PERFORM
      *    レセ電サブ返却エリアへの食事セット
           MOVE       ZERO    TO   IDX2
           PERFORM    VARYING   IDX1   FROM  1  BY  1
                      UNTIL     (IDX1   >     31)
                IF    WRK-SKJ-SRYCD(IDX1 1)   NOT =  SPACE
                    ADD    1     TO    IDX2
                    MOVE  WRK-SKJ-HKNCOMBI-DAY(IDX1) TO
                                    LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
                    MOVE   ZERO     TO    IDX4
                    PERFORM    VARYING    IDX3   FROM  1   BY  1
                               UNTIL      IDX3   >    3
                        IF   WRK-SKJ-SRYCD(IDX1 IDX3)  NOT =  SPACE
                            ADD     1     TO    IDX4
                            MOVE   "SI"   TO
                                  LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                            IF     IDX4    =   1
                                MOVE   "97"   TO
                                  LNK-NYURECEDEN-SRYSKB(3 IDX2 IDX4)
                            END-IF
                            MOVE   WRK-SKJ-SRYCD(IDX1 IDX3)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                        END-IF
                    END-PERFORM
                    MOVE  WRK-SKJ-MONEY(IDX1)  TO
                                LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                    MOVE  WRK-SKJ-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                    MOVE  IDX4  TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
                END-IF
           END-PERFORM
      *    レセ電サブ返却エリアへの食事セット（特別食加算）
           PERFORM    VARYING   IDX1   FROM  1  BY  1
                      UNTIL     (IDX1   >     31)
                IF    WRK-SKJ3-TOKU-SHOKU(IDX1)   NOT =  SPACE
                    ADD    1     TO    IDX2
                    MOVE  WRK-SKJ3-HKNCOMBI-DAY(IDX1) TO
                                    LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
                    MOVE   "SI"   TO
                                  LNK-NYURECEDEN-RECSKB(3 IDX2 1)
                    MOVE   SPACE   TO
                                  LNK-NYURECEDEN-SRYSKB(3 IDX2 1)
                    MOVE   WRK-SKJ3-TOKU-SHOKU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 1)
                    MOVE  350  TO
                                LNK-NYURECEDEN-TEN(3 IDX2 1)
                    MOVE  WRK-SKJ3-KAISU(IDX1)  TO
                                  LNK-NYURECEDEN-KAISU(3 IDX2 1)
                    MOVE  1   TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
                END-IF
           END-PERFORM
      *    レセ電サブ返却エリアへの食事セット（複数献立加算）
           PERFORM    VARYING   IDX1   FROM  1  BY  1
                      UNTIL     (IDX1   >     31)
                IF    WRK-SKJ2-FUKUSU(IDX1)   NOT =  SPACE
                    ADD    1     TO    IDX2
                    MOVE  WRK-SKJ2-HKNCOMBI-DAY(IDX1) TO
                                    LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
                    MOVE   "SI"   TO
                                  LNK-NYURECEDEN-RECSKB(3 IDX2 1)
                    MOVE   SPACE   TO
                                  LNK-NYURECEDEN-SRYSKB(3 IDX2 1)
                    MOVE   WRK-SKJ2-FUKUSU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 1)
                    MOVE   50  TO
                                LNK-NYURECEDEN-TEN(3 IDX2 1)
                    MOVE  WRK-SKJ2-KAISU(IDX1)  TO
                                  LNK-NYURECEDEN-KAISU(3 IDX2 1)
                    MOVE  1   TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
                END-IF
           END-PERFORM
      *    レセ電サブ返却エリアへの食事セット（食事負担）
           PERFORM    VARYING   IDX1   FROM  1  BY  1
                      UNTIL     (IDX1   >     31)
                IF    WRK-SKJFTN-SRYCD(IDX1)   NOT =  SPACE
                    ADD    1     TO    IDX2
                    MOVE  WRK-SKJFTN-HKNCOMBI-DAY(IDX1) TO
                                    LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
                    MOVE   "SI"   TO
                                  LNK-NYURECEDEN-RECSKB(3 IDX2 1)
                    MOVE   "97"   TO
                                  LNK-NYURECEDEN-SRYSKB(3 IDX2 1)
                    MOVE   WRK-SKJFTN-SRYCD(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 1)
                    EVALUATE   WRK-SKJFTN-SRYCD(IDX1)
                        WHEN   "197000810"
                            MOVE  780  TO 
                                        LNK-NYURECEDEN-TEN(3 IDX2 1)
                        WHEN   "197000910"
                            MOVE  650  TO 
                                        LNK-NYURECEDEN-TEN(3 IDX2 1)
                        WHEN   "197001010"
                            MOVE  500  TO 
                                        LNK-NYURECEDEN-TEN(3 IDX2 1)
                        WHEN   "197001110"
                            MOVE  300  TO 
                                        LNK-NYURECEDEN-TEN(3 IDX2 1)
                    END-EVALUATE
                    MOVE  WRK-SKJFTN-KAISU(IDX1)  TO
                                  LNK-NYURECEDEN-KAISU(3 IDX2 1)
                    MOVE  1   TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
                END-IF
           END-PERFORM
      *
           .
       2101-SHOKUJI-HENSHU1-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事情報の編集（平成１８年４月以降）
      *****************************************************************
       2102-SHOKUJI-HENSHU2-SEC        SECTION.
      *
      *食事情報の取得（朝食）（入院会計）
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key30"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key30"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   VARYING   IDX1   FROM  1   BY  1
                         UNTIL     IDX1   >    31
                   IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)  AND
                         (NACCT-DAY(IDX1)    NOT =  ZERO)     AND
                        ((WRK-NYUINKHN(IDX1) NOT =  SPACE)    OR
                         (LNK-NYUINDAY-KBN(IDX1) =  "1"  ))   AND
                         (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                       TO  WRK-SKJ4-HKNCOMBI-DAY(IDX1)
      *                                     WRK-SKJ5-HKNCOMBI-DAY(IDX1)
      *                                     WRK-SKJ6-HKNCOMBI-DAY(IDX1)
                                        WRK-SKJFTN2-HKNCOMBI-DAY(IDX1)
                       EVALUATE   NACCT-DAY(IDX1)
                           WHEN   1
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX1)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                         TO  WRK-SKJFTN2-SRYCD(IDX1)
                               END-IF
                           WHEN   2
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX1)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000470"
                                           TO  WRK-SKJ5-TOKU-SHOKU(IDX1)
                               END-IF
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                           TO  WRK-SKJFTN2-SRYCD(IDX1)
                               END-IF
                       END-EVALUATE
      *                食堂加算
                       IF    WRK-SYS5000-SHOKUCD(3 IDX1)  NOT = SPACE
                           MOVE  WRK-SYS5000-SHOKUCD(3 IDX1)
                                          TO  WRK-SKJ6-SHOKUDOU(IDX1)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"             TO  MCP-TABLE
           MOVE    "key30"                     TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *食事情報の取得（昼食）（入院会計）
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key31"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key31"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   VARYING   IDX1   FROM  1   BY  1
                         UNTIL     IDX1   >    31
                   COMPUTE   IDX2   =    IDX1   +   31
                   IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)  AND
                         (NACCT-DAY(IDX1)    NOT =  ZERO)     AND
                        ((WRK-NYUINKHN(IDX1) NOT =  SPACE)    OR
                         (LNK-NYUINDAY-KBN(IDX1) =  "1"  ))   AND
                         (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                       TO  WRK-SKJ4-HKNCOMBI-DAY(IDX2)
      *                                     WRK-SKJ5-HKNCOMBI-DAY(IDX2)
      *                                     WRK-SKJ6-HKNCOMBI-DAY(IDX2)
                                        WRK-SKJFTN2-HKNCOMBI-DAY(IDX2)
                       EVALUATE   NACCT-DAY(IDX1)
                           WHEN   1
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX2)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                         TO  WRK-SKJFTN2-SRYCD(IDX2)
                               END-IF
                           WHEN   2
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX2)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000470"
                                           TO  WRK-SKJ5-TOKU-SHOKU(IDX2)
                               END-IF
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                           TO  WRK-SKJFTN2-SRYCD(IDX2)
                               END-IF
                       END-EVALUATE
      *                食堂加算
                       IF    WRK-SYS5000-SHOKUCD(3 IDX1)  NOT = SPACE
                           MOVE  WRK-SYS5000-SHOKUCD(3 IDX1)
                                          TO  WRK-SKJ6-SHOKUDOU(IDX1)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"             TO  MCP-TABLE
           MOVE    "key31"                     TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *食事情報の取得（夕食）（入院会計）
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key32"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key32"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   VARYING   IDX1   FROM  1   BY  1
                         UNTIL     IDX1   >    31
                   COMPUTE   IDX3   =    IDX1   +   62
                   IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)  AND
                         (NACCT-DAY(IDX1)    NOT =  ZERO)     AND
                        ((WRK-NYUINKHN(IDX1) NOT =  SPACE)    OR
                         (LNK-NYUINDAY-KBN(IDX1) =  "1"  ))   AND
                         (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                       TO  WRK-SKJ4-HKNCOMBI-DAY(IDX3)
      *                                     WRK-SKJ5-HKNCOMBI-DAY(IDX3)
      *                                     WRK-SKJ6-HKNCOMBI-DAY(IDX3)
                                        WRK-SKJFTN2-HKNCOMBI-DAY(IDX3)
                       EVALUATE   NACCT-DAY(IDX1)
                           WHEN   1
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX3)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                            TO  WRK-SKJFTN2-SRYCD(IDX3)
                               END-IF
                           WHEN   2
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX3)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000470"
                                           TO  WRK-SKJ5-TOKU-SHOKU(IDX3)
                               END-IF
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                           TO  WRK-SKJFTN2-SRYCD(IDX3)
                               END-IF
                       END-EVALUATE
      *                食堂加算
                       IF    WRK-SYS5000-SHOKUCD(3 IDX1)  NOT = SPACE
                           MOVE  WRK-SYS5000-SHOKUCD(3 IDX1)
                                          TO  WRK-SKJ6-SHOKUDOU(IDX1)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"             TO  MCP-TABLE
           MOVE    "key32"                     TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *低所得情報の取得
           INITIALIZE                          TSYRRK-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  TSYRRK-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  TSYRRK-PTID
           MOVE    "tbl_tsyrrk"            TO  MCP-TABLE
           MOVE    "key3"                  TO  MCP-PATHNAME
           PERFORM 910-TSYRRK-SELECT-SEC
           IF      FLG-TSYRRK              =   ZERO
               MOVE    "tbl_tsyrrk"        TO  MCP-TABLE
               MOVE    "key3"              TO  MCP-PATHNAME
               PERFORM 910-TSYRRK-READ-SEC
               PERFORM  UNTIL  
                  ( FLG-TSYRRK          =   1                ) OR
                 (( TSYRRK-NINSTYMD(1:6) <= LNK-NYURECEDEN-SANTEIYM AND
                    LNK-NYURECEDEN-SANTEIYM <= TSYRRK-NINEDYMD(1:6) ))
      *
                   MOVE    "tbl_tsyrrk"     TO  MCP-TABLE
                   MOVE    "key3"           TO  MCP-PATHNAME
                   PERFORM 910-TSYRRK-READ-SEC
      *
               END-PERFORM
           END-IF
           IF      FLG-TSYRRK              =   ZERO
              IF  (LNK-NYURECEDEN-SANTEIYM   =  TSYRRK-NINSTYMD(1:6))
              AND (TSYRRK-NINSTYMD(7:2)      NOT =  "01")
                CONTINUE
              ELSE
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                          UNTIL     IDX1   >    93
                    IF    WRK-SKJ4-RYOYO(IDX1)  NOT =  SPACE
                        MOVE   "197000910"
                                        TO  WRK-SKJFTN2-SRYCD(IDX1)
                    END-IF
                END-PERFORM
              END-IF
           END-IF
      *
           MOVE     "tbl_tsyrrk"        TO  MCP-TABLE
           MOVE     "key3"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *９０日越え（低所得情報）
           IF  (TSYRRK-SKJGNSTYMD(1:6)  <= LNK-NYURECEDEN-SANTEIYM) AND
               (TSYRRK-SKJGNSTYMD       NOT = SPACE)
             IF (LNK-NYURECEDEN-SANTEIYM  = TSYRRK-SKJGNSTYMD(1:6)) AND
                (TSYRRK-SKJGNSTYMD(7:2)   NOT = "01")
               CONTINUE
             ELSE
               IF  TSYRRK-SKJGNSTYMD(1:6)  <  LNK-NYURECEDEN-SANTEIYM
                   MOVE   1             TO   TSY90-IDX
               ELSE
                   MOVE   TSYRRK-SKJGNSTYMD(7:2)   TO  TSY90-IDX
               END-IF
               PERFORM   VARYING   IDX1   FROM   TSY90-IDX  BY  1
                          UNTIL     IDX1   >    31
                    IF    WRK-SKJ4-RYOYO(IDX1)  NOT =  SPACE
                        MOVE   "197001010"
                                        TO  WRK-SKJFTN2-SRYCD(IDX1)
                        COMPUTE   IDX-TSY90  =  IDX1  +  31
                        MOVE   "197001010"
                                        TO  WRK-SKJFTN2-SRYCD(IDX-TSY90)
                        COMPUTE   IDX-TSY90  =  IDX1  +  62
                        MOVE   "197001010"
                                        TO  WRK-SKJFTN2-SRYCD(IDX-TSY90)
                    END-IF
               END-PERFORM
             END-IF
           END-IF
      *
      *低年金情報の取得
           INITIALIZE                          TNKRRK-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  TNKRRK-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  TNKRRK-PTID
           MOVE    "tbl_tnkrrk"            TO  MCP-TABLE
           MOVE    "key3"                  TO  MCP-PATHNAME
           PERFORM 910-TNKRRK-SELECT-SEC
           IF      FLG-TNKRRK              =   ZERO
               MOVE    "tbl_tnkrrk"        TO  MCP-TABLE
               MOVE    "key3"              TO  MCP-PATHNAME
               PERFORM 910-TNKRRK-READ-SEC
               PERFORM  UNTIL  
                  ( FLG-TNKRRK          =   1                ) OR
                 (( TNKRRK-STYMD(1:6) <= LNK-NYURECEDEN-SANTEIYM AND
                    LNK-NYURECEDEN-SANTEIYM <= TNKRRK-EDYMD(1:6) ))
      *
                   MOVE    "tbl_tnkrrk"       TO  MCP-TABLE
                   MOVE    "key3"             TO  MCP-PATHNAME
                   PERFORM 910-TNKRRK-READ-SEC
      *
               END-PERFORM
           END-IF
           IF      FLG-TNKRRK              =   ZERO
              IF  (LNK-NYURECEDEN-SANTEIYM   =  TNKRRK-STYMD(1:6))
              AND (TNKRRK-STYMD(7:2)     NOT =  "01")
                CONTINUE
              ELSE
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                          UNTIL     IDX1   >    93
                    IF    WRK-SKJ4-RYOYO(IDX1)  NOT =  SPACE
                        MOVE   "197001110"
                                        TO  WRK-SKJFTN2-SRYCD(IDX1)
                    END-IF
                END-PERFORM
              END-IF
           END-IF
      *
           MOVE     "tbl_tnkrrk"        TO  MCP-TABLE
           MOVE     "key3"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *    食事ワーク７の編集（同一剤まとめ用）
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
      *        食事療養費（朝）
               IF    WRK-SKJ4-RYOYO(IDX1)  NOT =   SPACE
                   MOVE  WRK-SKJ4-HKNCOMBI-DAY(IDX1)
                                       TO  WRK-SKJ7-HKNCOMBI-DAY(IDX1)
                   MOVE  WRK-SKJ4-RYOYO(IDX1)
                                       TO  WRK-SKJ7-RYOYO(IDX1)
                   ADD   1             TO  WRK-SKJ7-RYOYO-SU(IDX1)
               END-IF
      *        特別食加算（朝）
               IF    WRK-SKJ5-TOKU-SHOKU(IDX1)  NOT =   SPACE
                   MOVE  WRK-SKJ5-TOKU-SHOKU(IDX1)
                                       TO  WRK-SKJ7-TOKU-SHOKU(IDX1)
                   ADD   1             TO  WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
               END-IF
      *        食事負担（朝）
               IF    WRK-SKJFTN2-SRYCD(IDX1)  NOT =   SPACE
                   MOVE  WRK-SKJFTN2-SRYCD(IDX1)
                                       TO  WRK-SKJ7-SKJFTN(IDX1)
                   ADD   1             TO  WRK-SKJ7-SKJFTN-SU(IDX1)
               END-IF
      *        食事療養費（昼）
               MOVE      ZERO          TO  IDX2
               COMPUTE   IDX2     =    IDX1    +   31
               IF    WRK-SKJ4-RYOYO(IDX2)  NOT =   SPACE
                   MOVE  WRK-SKJ4-HKNCOMBI-DAY(IDX2)
                                       TO  WRK-SKJ7-HKNCOMBI-DAY(IDX1)
                   MOVE  WRK-SKJ4-RYOYO(IDX2)
                                       TO  WRK-SKJ7-RYOYO(IDX1)
                   ADD   1             TO  WRK-SKJ7-RYOYO-SU(IDX1)
               END-IF
      *        特別食加算（昼）
               IF    WRK-SKJ5-TOKU-SHOKU(IDX2)  NOT =   SPACE
                   MOVE  WRK-SKJ5-TOKU-SHOKU(IDX2)
                                       TO  WRK-SKJ7-TOKU-SHOKU(IDX1)
                   ADD   1             TO  WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
               END-IF
      *        食事負担（昼）
               IF    WRK-SKJFTN2-SRYCD(IDX2)  NOT =   SPACE
                   MOVE  WRK-SKJFTN2-SRYCD(IDX2)
                                       TO  WRK-SKJ7-SKJFTN(IDX1)
                   ADD   1             TO  WRK-SKJ7-SKJFTN-SU(IDX1)
               END-IF
      *        食事療養費（夕）
               MOVE      ZERO          TO  IDX3
               COMPUTE   IDX3     =    IDX1    +   62
               IF    WRK-SKJ4-RYOYO(IDX3)  NOT =   SPACE
                   MOVE  WRK-SKJ4-HKNCOMBI-DAY(IDX3)
                                       TO  WRK-SKJ7-HKNCOMBI-DAY(IDX1)
                   MOVE  WRK-SKJ4-RYOYO(IDX3)
                                       TO  WRK-SKJ7-RYOYO(IDX1)
                   ADD   1             TO  WRK-SKJ7-RYOYO-SU(IDX1)
               END-IF
      *        特別食加算（夕）
               IF    WRK-SKJ5-TOKU-SHOKU(IDX3)  NOT =   SPACE
                   MOVE  WRK-SKJ5-TOKU-SHOKU(IDX3)
                                       TO  WRK-SKJ7-TOKU-SHOKU(IDX1)
                   ADD   1             TO  WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
               END-IF
      *        食事負担（夕）
               IF    WRK-SKJFTN2-SRYCD(IDX3)  NOT =   SPACE
                   MOVE  WRK-SKJFTN2-SRYCD(IDX3)
                                       TO  WRK-SKJ7-SKJFTN(IDX1)
                   ADD   1             TO  WRK-SKJ7-SKJFTN-SU(IDX1)
               END-IF
      *        食事回数
      **         IF    (WRK-SKJ4-RYOYO(IDX1)  NOT =   SPACE)   AND
      **               (WRK-SKJ4-RYOYO(IDX2)  NOT =   SPACE)   AND
      **               (WRK-SKJ4-RYOYO(IDX3)  NOT =   SPACE)
      **             MOVE      1         TO   WRK-SKJ7-KAISU(IDX1)
      **         END-IF
      *        食堂加算
               IF    WRK-SKJ6-SHOKUDOU(IDX1)  NOT =   SPACE
                   MOVE  WRK-SKJ6-SHOKUDOU(IDX1)
                                       TO  WRK-SKJ7-SHOKUDOU(IDX1)
               END-IF
           END-PERFORM
      *
      *    食事の診療コード計
           PERFORM    VARYING   IDX1    FROM  1  BY  1
                      UNTIL     IDX1    >   31
               IF   WRK-SKJ7-RYOYO(IDX1)  NOT =  SPACE
                   MOVE    WRK-SKJ7-RYOYO(IDX1)       TO WRK-SRYCD-X
                   COMPUTE WRK-SKJ7-SRYCDTOTAL(IDX1)  =
                           WRK-SKJ7-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
               END-IF
               IF   WRK-SKJ7-SHOKUDOU(IDX1)  NOT =  SPACE
                   MOVE    WRK-SKJ7-SHOKUDOU(IDX1)    TO WRK-SRYCD-X
                   COMPUTE WRK-SKJ7-SRYCDTOTAL(IDX1)  =
                           WRK-SKJ7-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
               END-IF
               IF   WRK-SKJ7-TOKU-SHOKU(IDX1)  NOT =  SPACE
                   MOVE    WRK-SKJ7-TOKU-SHOKU(IDX1)  TO WRK-SRYCD-X
                   COMPUTE WRK-SKJ7-SRYCDTOTAL(IDX1)  =
                           WRK-SKJ7-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
               END-IF
               IF   WRK-SKJ7-SKJFTN(IDX1)      NOT =  SPACE
                   MOVE    WRK-SKJ7-SKJFTN(IDX1)  TO WRK-SRYCD-X
                   COMPUTE WRK-SKJ7-SRYCDTOTAL(IDX1)  =
                           WRK-SKJ7-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
               END-IF
               ADD   WRK-SKJ7-RYOYO-SU(IDX1)
                                     TO  WRK-SKJ7-SRYCDTOTAL(IDX1)
               ADD   WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
                                     TO  WRK-SKJ7-SRYCDTOTAL(IDX1)
               ADD   WRK-SKJ7-SKJFTN-SU(IDX1)
                                     TO  WRK-SKJ7-SRYCDTOTAL(IDX1)
           END-PERFORM
      *
      *     PERFORM      VARYING    IDX1   FROM   1  BY  1
      *                  UNTIL      IDX1   >   31
      *          DISPLAY "IDX1 = " IDX1
      *          DISPLAY "WRK-SKJ7-HKNCOMBI-DAY(IDX1) = "
      *                   WRK-SKJ7-HKNCOMBI-DAY(IDX1)
      *          DISPLAY "WRK-SKJ7-RYOYO(IDX1) = "
      *                   WRK-SKJ7-RYOYO(IDX1)
      *          DISPLAY "WRK-SKJ7-RYOYO-SU(IDX1) = "
      *                   WRK-SKJ7-RYOYO-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-SHOKUDOU(IDX1) = "
      *                   WRK-SKJ7-SHOKUDOU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-SU(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-SKJFTN(IDX1) = "
      *                   WRK-SKJ7-SKJFTN(IDX1)
      *          DISPLAY "WRK-SKJ7-SKJFTN-SU(IDX1) = "
      *                   WRK-SKJ7-SKJFTN-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-KAISU =(IDX1) = "
      *                   WRK-SKJ7-KAISU (IDX1)
      *     END-PERFORM
      *
      *    再構築した食事情報から同一剤のまとめ処理
      *    食事ワーク
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
               IF    WRK-SKJ7-SRYCDTOTAL(IDX1)  NOT =   ZERO
                   ADD   1                  TO  WRK-SKJ7-KAISU(IDX1)
                   MOVE       ZERO          TO  IDX2
                   COMPUTE    IDX2          =   IDX1    +   1
                   PERFORM    VARYING    IDX3   FROM   IDX2  BY  1
                              UNTIL      IDX3   >   31
                       IF    (WRK-SKJ7-HKNCOMBI-DAY(IDX3)  =
                                       WRK-SKJ7-HKNCOMBI-DAY(IDX1)) AND
                             (WRK-SKJ7-SRYCDTOTAL(IDX3)  =
                                       WRK-SKJ7-SRYCDTOTAL(IDX1))
                             ADD     1    TO    WRK-SKJ7-KAISU(IDX1)
                             INITIALIZE   WRK-SKJ7-TBL(IDX3)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
      *
      *    レセ電サブ返却エリアへの食事セット
           MOVE       ZERO    TO   IDX2
           PERFORM    VARYING   IDX1   FROM  1  BY  1
                      UNTIL     (IDX1   >     31)
      *          DISPLAY "IDX1 = " IDX1
      *          DISPLAY "WRK-SKJ7-HKNCOMBI-DAY(IDX1) = "
      *                   WRK-SKJ7-HKNCOMBI-DAY(IDX1)
      *          DISPLAY "WRK-SKJ7-RYOYO(IDX1) = "
      *                   WRK-SKJ7-RYOYO(IDX1)
      *          DISPLAY "WRK-SKJ7-RYOYO-SU(IDX1) = "
      *                   WRK-SKJ7-RYOYO-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-SHOKUDOU(IDX1) = "
      *                   WRK-SKJ7-SHOKUDOU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-SU(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-SKJFTN(IDX1) = "
      *                   WRK-SKJ7-SKJFTN(IDX1)
      *          DISPLAY "WRK-SKJ7-SKJFTN-SU(IDX1) = "
      *                   WRK-SKJ7-SKJFTN-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-KAISU =(IDX1) = "
      *                   WRK-SKJ7-KAISU (IDX1)
                IF    WRK-SKJ7-RYOYO(IDX1)   NOT =  SPACE
                    ADD    1     TO    IDX2
                    MOVE  WRK-SKJ7-HKNCOMBI-DAY(IDX1) TO
                                    LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
                    MOVE   ZERO     TO    IDX4
                    IF   WRK-SKJ7-RYOYO(IDX1)  NOT =  SPACE
                        ADD     1     TO    IDX4
                        MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                        IF     IDX4    =   1
                            MOVE   "97"   TO
                              LNK-NYURECEDEN-SRYSKB(3 IDX2 IDX4)
                        END-IF
                        MOVE   WRK-SKJ7-RYOYO(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                    END-IF
                    MOVE      WRK-SKJ7-RYOYO-SU(IDX1)  TO
                                      LNK-NYURECEDEN-SURYO(3 IDX2 IDX4)
                    EVALUATE  WRK-SKJ7-RYOYO(IDX1)
                      WHEN  "197000110"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   640     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  2
                                MOVE  1280     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  3
                                MOVE  1920     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                        END-EVALUATE
                      WHEN  "197000710"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   506     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  2
                                MOVE  1012     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  3
                                MOVE  1518     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                        END-EVALUATE
                    END-EVALUATE
                    MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                    IF   WRK-SKJ7-SHOKUDOU(IDX1)  NOT =  SPACE
                         ADD     1     TO    IDX4
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                         MOVE   WRK-SKJ7-SHOKUDOU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                         MOVE   50     TO
                                 LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                         MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                    END-IF
                    IF   WRK-SKJ7-TOKU-SHOKU(IDX1)  NOT =  SPACE
                         ADD     1     TO    IDX4
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                         MOVE   WRK-SKJ7-TOKU-SHOKU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                         MOVE   WRK-SKJ7-TOKU-SHOKU-SU(IDX1)  TO
                                  LNK-NYURECEDEN-SURYO(3 IDX2 IDX4)
                         EVALUATE  WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
                             WHEN  1
                                 MOVE   76     TO
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                             WHEN  2
                                 MOVE   152    TO
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                             WHEN  3
                                 MOVE   228    TO
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                         END-EVALUATE
                         MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                    END-IF
                    IF   WRK-SKJ7-SKJFTN(IDX1)  NOT =  SPACE
                        ADD     1     TO    IDX4
                        MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                        MOVE   WRK-SKJ7-SKJFTN(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                        MOVE   WRK-SKJ7-SKJFTN-SU(IDX1)  TO
                                  LNK-NYURECEDEN-SURYO(3 IDX2 IDX4)
                        EVALUATE   WRK-SKJ7-SKJFTN(IDX1)
                            WHEN   "197000810"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  260  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  520  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  780  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
                            WHEN   "197000910"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  210  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  420  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  630  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
                            WHEN   "197001010"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  160  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  320  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  480  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
                            WHEN   "197001110"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  100  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  200  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  300  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
                        END-EVALUATE
                        MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                    LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                    END-IF
                    MOVE  IDX4  TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
                END-IF
           END-PERFORM
      *
      *    レセ電サブ返却エリアへの食事セット
      **     MOVE       ZERO    TO   IDX2
      *
      *    レセ電サブ返却エリアへの食事セット（食事療養）
      **     PERFORM    VARYING   IDX1   FROM  1  BY  1
      **                UNTIL     (IDX1   >     93)
      **          IF    WRK-SKJ4-RYOYO(IDX1)   NOT =  SPACE
      **              ADD    1     TO    IDX2
      **              MOVE  WRK-SKJ4-HKNCOMBI-DAY(IDX1) TO
      **                              LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
      **              MOVE   "SI"   TO
      **                            LNK-NYURECEDEN-RECSKB(3 IDX2 1)
      **              MOVE   "97"   TO
      **                            LNK-NYURECEDEN-SRYSKB(3 IDX2 1)
      **              MOVE   WRK-SKJ4-RYOYO(IDX1)  TO
      **                            LNK-NYURECEDEN-SRYCD(3 IDX2 1)
      **              EVALUATE  WRK-SKJ4-RYOYO(IDX1)
      **                 WHEN   "197000110"
      **                      MOVE  640  TO  LNK-NYURECEDEN-TEN(3 IDX2 1)
      **                 WHEN   "197000710"
      **                      MOVE  506  TO  LNK-NYURECEDEN-TEN(3 IDX2 1)
      **              END-EVALUATE
      **              MOVE  WRK-SKJ4-KAISU(IDX1)  TO
      **                            LNK-NYURECEDEN-KAISU(3 IDX2 1)
      **              MOVE  1   TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
      **          END-IF
      **     END-PERFORM
      *
      *    レセ電サブ返却エリアへの食事セット（特別食加算）
      **     PERFORM    VARYING   IDX1   FROM  1  BY  1
      **                UNTIL     (IDX1   >     93)
      **          IF    WRK-SKJ5-TOKU-SHOKU(IDX1)   NOT =  SPACE
      **              ADD    1     TO    IDX2
      **              MOVE  WRK-SKJ5-HKNCOMBI-DAY(IDX1) TO
      **                              LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
      **              MOVE   "SI"   TO
      **                            LNK-NYURECEDEN-RECSKB(3 IDX2 1)
      **              MOVE   SPACE   TO
      **                            LNK-NYURECEDEN-SRYSKB(3 IDX2 1)
      **              MOVE   WRK-SKJ5-TOKU-SHOKU(IDX1)  TO
      **                            LNK-NYURECEDEN-SRYCD(3 IDX2 1)
      **              MOVE  76  TO
      **                          LNK-NYURECEDEN-TEN(3 IDX2 1)
      **              MOVE  WRK-SKJ5-KAISU(IDX1)  TO
      **                            LNK-NYURECEDEN-KAISU(3 IDX2 1)
      **              MOVE  1   TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
      **          END-IF
      **     END-PERFORM
      *
      *    レセ電サブ返却エリアへの食事セット（食堂加算）
      **     PERFORM    VARYING   IDX1   FROM  1  BY  1
      **                UNTIL     (IDX1   >     31)
      **          IF    WRK-SKJ6-SHOKUDOU(IDX1)   NOT =  SPACE
      **              ADD    1     TO    IDX2
      **             MOVE  WRK-SKJ6-HKNCOMBI-DAY(IDX1) TO
      **                              LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
      **              MOVE   "SI"   TO
      **                            LNK-NYURECEDEN-RECSKB(3 IDX2 1)
      **              MOVE   SPACE   TO
      **                            LNK-NYURECEDEN-SRYSKB(3 IDX2 1)
      **              MOVE   WRK-SKJ6-SHOKUDOU(IDX1)  TO
      **                            LNK-NYURECEDEN-SRYCD(3 IDX2 1)
      **              MOVE  50  TO
      **                          LNK-NYURECEDEN-TEN(3 IDX2 1)
      **              MOVE  WRK-SKJ6-KAISU(IDX1)  TO
      **                            LNK-NYURECEDEN-KAISU(3 IDX2 1)
      **              MOVE  1   TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
      **          END-IF
      **     END-PERFORM
      *
      *    レセ電サブ返却エリアへの食事セット（食事負担）
      **     PERFORM    VARYING   IDX1   FROM  1  BY  1
      **                UNTIL     (IDX1   >     93)
      **          IF    WRK-SKJFTN2-SRYCD(IDX1)   NOT =  SPACE
      **              ADD    1     TO    IDX2
      **              MOVE  WRK-SKJFTN2-HKNCOMBI-DAY(IDX1) TO
      **                              LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
      **              MOVE   "SI"   TO
      **                            LNK-NYURECEDEN-RECSKB(3 IDX2 1)
      **              MOVE   "97"   TO
      **                            LNK-NYURECEDEN-SRYSKB(3 IDX2 1)
      **              MOVE   WRK-SKJFTN2-SRYCD(IDX1)  TO
      **                            LNK-NYURECEDEN-SRYCD(3 IDX2 1)
      **              EVALUATE   WRK-SKJFTN2-SRYCD(IDX1)
      **                  WHEN   "197000810"
      **                      MOVE  260  TO 
      **                                  LNK-NYURECEDEN-TEN(3 IDX2 1)
      **                  WHEN   "197000910"
      **                      MOVE  210  TO 
      **                                  LNK-NYURECEDEN-TEN(3 IDX2 1)
      **                  WHEN   "197001010"
      **                      MOVE  160  TO 
      **                                  LNK-NYURECEDEN-TEN(3 IDX2 1)
      **                  WHEN   "197001110"
      **                      MOVE  100  TO 
      **                                  LNK-NYURECEDEN-TEN(3 IDX2 1)
      **              END-EVALUATE
      **              MOVE  WRK-SKJFTN2-KAISU(IDX1)  TO
      **                            LNK-NYURECEDEN-KAISU(3 IDX2 1)
      **              MOVE  1   TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
      **          END-IF
      **     END-PERFORM
      *
           .
       2102-SHOKUJI-HENSHU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事情報の編集（平成１８年４月以降　食事療養費食数ベース）
      *****************************************************************
       2103-SHOKUJI-HENSHU3-SEC        SECTION.
      *
      *食事情報の取得（朝食）（入院会計）
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key30"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key30"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   VARYING   IDX1   FROM  1   BY  1
                         UNTIL     IDX1   >    31
                   IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)  AND
                         (NACCT-DAY(IDX1)    NOT =  ZERO)     AND
                        ((WRK-NYUINKHN(IDX1) NOT =  SPACE)    OR
                         (LNK-NYUINDAY-KBN(IDX1) =  "1"  ))   AND
                         (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                       TO  WRK-SKJ4-HKNCOMBI-DAY(IDX1)
      *                                     WRK-SKJ5-HKNCOMBI-DAY(IDX1)
      *                                     WRK-SKJ6-HKNCOMBI-DAY(IDX1)
                                        WRK-SKJFTN2-HKNCOMBI-DAY(IDX1)
                       EVALUATE   NACCT-DAY(IDX1)
                           WHEN   1
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX1)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                         TO  WRK-SKJFTN2-SRYCD(IDX1)
                               END-IF
                           WHEN   2
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX1)
      *                        特別食加算は入院時食事療養（１）の場合
      *                        のみセット
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1)  =
                                                            "197000110"
                                   MOVE   "197000470"
                                           TO  WRK-SKJ5-TOKU-SHOKU(IDX1)
                               END-IF
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                           TO  WRK-SKJFTN2-SRYCD(IDX1)
                               END-IF
                       END-EVALUATE
      *                食堂加算
                       IF    WRK-SYS5000-SHOKUCD(3 IDX1)  NOT = SPACE
                           MOVE  WRK-SYS5000-SHOKUCD(3 IDX1)
                                          TO  WRK-SKJ6-SHOKUDOU(IDX1)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"             TO  MCP-TABLE
           MOVE    "key30"                     TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *食事情報の取得（昼食）（入院会計）
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key31"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key31"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   VARYING   IDX1   FROM  1   BY  1
                         UNTIL     IDX1   >    31
                   COMPUTE   IDX2   =    IDX1   +   31
                   IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)  AND
                         (NACCT-DAY(IDX1)    NOT =  ZERO)     AND
                        ((WRK-NYUINKHN(IDX1) NOT =  SPACE)    OR
                         (LNK-NYUINDAY-KBN(IDX1) =  "1"  ))   AND
                         (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                       TO  WRK-SKJ4-HKNCOMBI-DAY(IDX2)
      *                                     WRK-SKJ5-HKNCOMBI-DAY(IDX2)
      *                                     WRK-SKJ6-HKNCOMBI-DAY(IDX2)
                                        WRK-SKJFTN2-HKNCOMBI-DAY(IDX2)
                       EVALUATE   NACCT-DAY(IDX1)
                           WHEN   1
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX2)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                         TO  WRK-SKJFTN2-SRYCD(IDX2)
                               END-IF
                           WHEN   2
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX2)
      *                        特別食加算は入院時食事療養（１）の場合
      *                        のみセット
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1)  =
                                                            "197000110"
                                   MOVE   "197000470"
                                           TO  WRK-SKJ5-TOKU-SHOKU(IDX2)
                               END-IF
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                           TO  WRK-SKJFTN2-SRYCD(IDX2)
                               END-IF
                       END-EVALUATE
      *                食堂加算
                       IF    WRK-SYS5000-SHOKUCD(3 IDX1)  NOT = SPACE
                           MOVE  WRK-SYS5000-SHOKUCD(3 IDX1)
                                          TO  WRK-SKJ6-SHOKUDOU(IDX1)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"             TO  MCP-TABLE
           MOVE    "key31"                     TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *食事情報の取得（夕食）（入院会計）
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  NACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  NACCT-SRYYM
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key32"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key32"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   VARYING   IDX1   FROM  1   BY  1
                         UNTIL     IDX1   >    31
                   COMPUTE   IDX3   =    IDX1   +   62
                   IF    (WRK-HKNCOMBI-DAY(IDX1) NOT = ZERO)  AND
                         (NACCT-DAY(IDX1)    NOT =  ZERO)     AND
                        ((WRK-NYUINKHN(IDX1) NOT =  SPACE)    OR
                         (LNK-NYUINDAY-KBN(IDX1) =  "1"  ))   AND
                         (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                       MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                       TO  WRK-SKJ4-HKNCOMBI-DAY(IDX3)
      *                                     WRK-SKJ5-HKNCOMBI-DAY(IDX3)
      *                                     WRK-SKJ6-HKNCOMBI-DAY(IDX3)
                                        WRK-SKJFTN2-HKNCOMBI-DAY(IDX3)
                       EVALUATE   NACCT-DAY(IDX1)
                           WHEN   1
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX3)
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                            TO  WRK-SKJFTN2-SRYCD(IDX3)
                               END-IF
                           WHEN   2
                               MOVE   WRK-SYS5000-SHOKUCD(1 IDX1)
                                              TO  WRK-SKJ4-RYOYO(IDX3)
      *                        特別食加算は入院時食事療養（１）の場合
      *                        のみセット
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1)  =
                                                            "197000110"
                                   MOVE   "197000470"
                                           TO  WRK-SKJ5-TOKU-SHOKU(IDX3)
                               END-IF
                               IF   WRK-SYS5000-SHOKUCD(1 IDX1) NOT =
                                                                 SPACE
                                   MOVE   "197000810"
                                           TO  WRK-SKJFTN2-SRYCD(IDX3)
                               END-IF
                       END-EVALUATE
      *                食堂加算
                       IF    WRK-SYS5000-SHOKUCD(3 IDX1)  NOT = SPACE
                           MOVE  WRK-SYS5000-SHOKUCD(3 IDX1)
                                          TO  WRK-SKJ6-SHOKUDOU(IDX1)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"             TO  MCP-TABLE
           MOVE    "key32"                     TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *−−−−サブルーチンでの患者所得情報の取得ここから−−−−−
           INITIALIZE                          WRK-SYOTOKU-SKJKBN-AREA
           INITIALIZE                          ORCSSYOTOKUAREA
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  LNK-SYOTOKU-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  LNK-SYOTOKU-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  LNK-SYOTOKU-SRYYM
           CALL    "ORCSSYOTOKU"    USING      ORCSSYOTOKUAREA
                                               SPA-AREA
           IF    LNK-SYOTOKU-RC      =         ZERO
                PERFORM    VARYING   IDX1   FROM   1   BY  1
                  UNTIL   (IDX1      >     31)
                      MOVE    LNK-SYOTOKU-SKJKBN(IDX1)
                                    TO  WRK-SYOTOKU-SKJKBN (IDX1)
                      COMPUTE    IDX2   =   IDX1   +   31
                      MOVE    LNK-SYOTOKU-SKJKBN(IDX1)
                                    TO  WRK-SYOTOKU-SKJKBN (IDX2)
                      COMPUTE    IDX2   =   IDX1   +   62
                      MOVE    LNK-SYOTOKU-SKJKBN(IDX1)
                                    TO  WRK-SYOTOKU-SKJKBN (IDX2)
                END-PERFORM
           ELSE
                DISPLAY "ORCSSYTOKU RC = " LNK-SYOTOKU-RC
           END-IF
      *−−−−サブルーチンでの患者所得情報の取得ここまで−−−−−
      *
      *所得情報のセット
           PERFORM   VARYING   IDX1   FROM   1  BY  1
                     UNTIL     IDX1   >    93
               IF    WRK-SKJ4-RYOYO(IDX1)  NOT =  SPACE
                   EVALUATE    WRK-SYOTOKU-SKJKBN (IDX1)
      *                低所得２
                       WHEN    "2"
                           MOVE   "197000910"
                                         TO  WRK-SKJFTN2-SRYCD(IDX1)
      *                低所得２（９０日越え）
                       WHEN    "3"
                           MOVE   "197001010"
                                         TO  WRK-SKJFTN2-SRYCD(IDX1)
      *                低所得１
                       WHEN    "1"
                       WHEN    "4"
                           MOVE   "197001110"
                                         TO  WRK-SKJFTN2-SRYCD(IDX1)
                   END-EVALUATE
               END-IF
           END-PERFORM
      *
      *
      *
      *    入院時生活療養費の情報取得
           INITIALIZE                          ORCSNYULIFE-AREA
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  LNK-NYULIFE-HOSPNUM
           MOVE    LNK-NYURECEDEN-PTID     TO  LNK-NYULIFE-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  LNK-NYULIFE-SANTEIYM
           CALL    "ORCSNYULIFE"     USING  ORCSNYULIFE-AREA
                                            SPA-AREA
           IF      LNK-NYULIFE-RC          NOT =  ZERO
               DISPLAY  "LNK-NYULIFE-RC = " LNK-NYULIFE-RC
           END-IF
      *
      *    食事ワーク７の編集（同一剤まとめ用）
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
      *        食事療養費（朝）
               IF    WRK-SKJ4-RYOYO(IDX1)  NOT =   SPACE
                   MOVE  WRK-SKJ4-HKNCOMBI-DAY(IDX1)
                                       TO  WRK-SKJ7-HKNCOMBI-DAY(IDX1)
                   MOVE  WRK-SKJ4-RYOYO(IDX1)
                                       TO  WRK-SKJ7-RYOYO(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  LNK-NYULIFE-SKJ-SRYCD(IDX1)
                                       TO  WRK-SKJ7-RYOYO(IDX1)
                   END-IF
                   ADD   1             TO  WRK-SKJ7-RYOYO-SU(IDX1)
               END-IF
      *        特別食加算（朝）
               IF    WRK-SKJ5-TOKU-SHOKU(IDX1)  NOT =   SPACE
                   MOVE  WRK-SKJ5-TOKU-SHOKU(IDX1)
                                       TO  WRK-SKJ7-TOKU-SHOKU(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  "197001570"
                                       TO  WRK-SKJ7-TOKU-SHOKU(IDX1)
                   END-IF
                   ADD   1             TO  WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
               END-IF
      *        食事負担（朝）
               IF    WRK-SKJFTN2-SRYCD(IDX1)  NOT =   SPACE
                   MOVE  WRK-SKJFTN2-SRYCD(IDX1)
                                       TO  WRK-SKJ7-SKJFTN(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  LNK-NYULIFE-SKJFTN-SRYCD(IDX1)
                                       TO  WRK-SKJ7-SKJFTN(IDX1)
                   END-IF
                   ADD   1             TO  WRK-SKJ7-SKJFTN-SU(IDX1)
               END-IF
      *        食事療養費（昼）
               MOVE      ZERO          TO  IDX2
               COMPUTE   IDX2     =    IDX1    +   31
               IF    WRK-SKJ4-RYOYO(IDX2)  NOT =   SPACE
                   MOVE  WRK-SKJ4-HKNCOMBI-DAY(IDX2)
                                       TO  WRK-SKJ7-HKNCOMBI-DAY(IDX1)
                   MOVE  WRK-SKJ4-RYOYO(IDX2)
                                       TO  WRK-SKJ7-RYOYO(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  LNK-NYULIFE-SKJ-SRYCD(IDX1)
                                       TO  WRK-SKJ7-RYOYO(IDX1)
                   END-IF
                   ADD   1             TO  WRK-SKJ7-RYOYO-SU(IDX1)
               END-IF
      *        特別食加算（昼）
               IF    WRK-SKJ5-TOKU-SHOKU(IDX2)  NOT =   SPACE
                   MOVE  WRK-SKJ5-TOKU-SHOKU(IDX2)
                                       TO  WRK-SKJ7-TOKU-SHOKU(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  "197001570"
                                       TO  WRK-SKJ7-TOKU-SHOKU(IDX1)
                   END-IF
                   ADD   1             TO  WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
               END-IF
      *        食事負担（昼）
               IF    WRK-SKJFTN2-SRYCD(IDX2)  NOT =   SPACE
                   MOVE  WRK-SKJFTN2-SRYCD(IDX2)
                                       TO  WRK-SKJ7-SKJFTN(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  LNK-NYULIFE-SKJFTN-SRYCD(IDX1)
                                       TO  WRK-SKJ7-SKJFTN(IDX1)
                   END-IF
                   ADD   1             TO  WRK-SKJ7-SKJFTN-SU(IDX1)
               END-IF
      *        食事療養費（夕）
               MOVE      ZERO          TO  IDX3
               COMPUTE   IDX3     =    IDX1    +   62
               IF    WRK-SKJ4-RYOYO(IDX3)  NOT =   SPACE
                   MOVE  WRK-SKJ4-HKNCOMBI-DAY(IDX3)
                                       TO  WRK-SKJ7-HKNCOMBI-DAY(IDX1)
                   MOVE  WRK-SKJ4-RYOYO(IDX3)
                                       TO  WRK-SKJ7-RYOYO(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  LNK-NYULIFE-SKJ-SRYCD(IDX1)
                                       TO  WRK-SKJ7-RYOYO(IDX1)
                   END-IF
                   ADD   1             TO  WRK-SKJ7-RYOYO-SU(IDX1)
               END-IF
      *        特別食加算（夕）
               IF    WRK-SKJ5-TOKU-SHOKU(IDX3)  NOT =   SPACE
                   MOVE  WRK-SKJ5-TOKU-SHOKU(IDX3)
                                       TO  WRK-SKJ7-TOKU-SHOKU(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  "197001570"
                                       TO  WRK-SKJ7-TOKU-SHOKU(IDX1)
                   END-IF
                   ADD   1             TO  WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
               END-IF
      *        食事負担（夕）
               IF    WRK-SKJFTN2-SRYCD(IDX3)  NOT =   SPACE
                   MOVE  WRK-SKJFTN2-SRYCD(IDX3)
                                       TO  WRK-SKJ7-SKJFTN(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  LNK-NYULIFE-SKJFTN-SRYCD(IDX1)
                                       TO  WRK-SKJ7-SKJFTN(IDX1)
                   END-IF
                   ADD   1             TO  WRK-SKJ7-SKJFTN-SU(IDX1)
               END-IF
      *        食事回数
      **         IF    (WRK-SKJ4-RYOYO(IDX1)  NOT =   SPACE)   AND
      **               (WRK-SKJ4-RYOYO(IDX2)  NOT =   SPACE)   AND
      **               (WRK-SKJ4-RYOYO(IDX3)  NOT =   SPACE)
      **             MOVE      1         TO   WRK-SKJ7-KAISU(IDX1)
      **         END-IF
      *        食堂加算
               IF    WRK-SKJ6-SHOKUDOU(IDX1)  NOT =   SPACE
                   MOVE  WRK-SKJ6-SHOKUDOU(IDX1)
                                       TO  WRK-SKJ7-SHOKUDOU(IDX1)
      *            入院時生活療養費の置換え
                   IF   LNK-NYULIFE-SKJ-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  "197001670"
                                       TO  WRK-SKJ7-SHOKUDOU(IDX1)
                   END-IF
               END-IF
           END-PERFORM
      *
      *    食事の診療コード計
           PERFORM    VARYING   IDX1    FROM  1  BY  1
                      UNTIL     IDX1    >   31
               IF   WRK-SKJ7-RYOYO(IDX1)  NOT =  SPACE
                   MOVE    WRK-SKJ7-RYOYO(IDX1)       TO WRK-SRYCD-X
                   COMPUTE WRK-SKJ7-SRYCDTOTAL(IDX1)  =
                           WRK-SKJ7-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
               END-IF
               IF   WRK-SKJ7-SHOKUDOU(IDX1)  NOT =  SPACE
                   MOVE    WRK-SKJ7-SHOKUDOU(IDX1)    TO WRK-SRYCD-X
                   COMPUTE WRK-SKJ7-SRYCDTOTAL(IDX1)  =
                           WRK-SKJ7-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
               END-IF
      **         IF   WRK-SKJ7-TOKU-SHOKU(IDX1)  NOT =  SPACE
      **             MOVE    WRK-SKJ7-TOKU-SHOKU(IDX1)  TO WRK-SRYCD-X
      **             COMPUTE WRK-SKJ7-SRYCDTOTAL(IDX1)  =
      **                     WRK-SKJ7-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
      **         END-IF
               IF   WRK-SKJ7-SKJFTN(IDX1)      NOT =  SPACE
                   MOVE    WRK-SKJ7-SKJFTN(IDX1)  TO WRK-SRYCD-X
                   COMPUTE WRK-SKJ7-SRYCDTOTAL(IDX1)  =
                           WRK-SKJ7-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
               END-IF
               ADD   WRK-SKJ7-RYOYO-SU(IDX1)
                                     TO  WRK-SKJ7-SRYCDTOTAL(IDX1)
      **         ADD   WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
      **                               TO  WRK-SKJ7-SRYCDTOTAL(IDX1)
               EVALUATE    WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
                   WHEN    1
                       ADD  1   TO   WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1)
                   WHEN    2
                       ADD  1   TO   WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1)
                   WHEN    3
                       ADD  1   TO   WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1)
               END-EVALUATE
               ADD   WRK-SKJ7-SKJFTN-SU(IDX1)
                                     TO  WRK-SKJ7-SRYCDTOTAL(IDX1)
           END-PERFORM
      *
      *     DISPLAY "WRK-SKJ7  MATOME BEFORE"
      *     PERFORM      VARYING    IDX1   FROM   1  BY  1
      *                  UNTIL      IDX1   >   31
      *          DISPLAY "IDX1 = " IDX1
      *          DISPLAY "WRK-SKJ7-HKNCOMBI-DAY(IDX1) = "
      *                   WRK-SKJ7-HKNCOMBI-DAY(IDX1)
      *          DISPLAY "WRK-SKJ7-RYOYO(IDX1) = "
      *                   WRK-SKJ7-RYOYO(IDX1)
      *          DISPLAY "WRK-SKJ7-RYOYO-SU(IDX1) = "
      *                   WRK-SKJ7-RYOYO-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-SHOKUDOU(IDX1) = "
      *                   WRK-SKJ7-SHOKUDOU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-SU(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1)
      *          DISPLAY "WRK-SKJ7-SKJFTN(IDX1) = "
      *                   WRK-SKJ7-SKJFTN(IDX1)
      *          DISPLAY "WRK-SKJ7-SKJFTN-SU(IDX1) = "
      *                   WRK-SKJ7-SKJFTN-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-KAISU =(IDX1) = "
      *                   WRK-SKJ7-KAISU (IDX1)
      *          DISPLAY "WRK-SKJ7-SRYCDTOTAL =(IDX1) = "
      *                   WRK-SKJ7-SRYCDTOTAL (IDX1)
      *     END-PERFORM
      *
      *    再構築した食事情報から同一剤のまとめ処理
      *    食事ワーク
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
               IF    WRK-SKJ7-SRYCDTOTAL(IDX1)  NOT =   ZERO
                   ADD   1                  TO  WRK-SKJ7-KAISU(IDX1)
                   MOVE       ZERO          TO  IDX2
                   COMPUTE    IDX2          =   IDX1    +   1
                   PERFORM    VARYING    IDX3   FROM   IDX2  BY  1
                              UNTIL      IDX3   >   31
                       IF    (WRK-SKJ7-HKNCOMBI-DAY(IDX3)  =
                                       WRK-SKJ7-HKNCOMBI-DAY(IDX1)) AND
                             (WRK-SKJ7-SRYCDTOTAL(IDX3)  =
                                       WRK-SKJ7-SRYCDTOTAL(IDX1))
                             IF   WRK-SKJ7-TOKU-SHOKU(IDX3) NOT = SPACE
                                 MOVE  WRK-SKJ7-TOKU-SHOKU(IDX3)  TO
                                           WRK-SKJ7-TOKU-SHOKU(IDX1)
                             END-IF
                             IF   WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX3)
                                                      NOT =  ZERO
                                     ADD   1   TO  
                                        WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1)
                             END-IF
                             IF   WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX3)
                                                      NOT =  ZERO
                                     ADD   1   TO  
                                        WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1)
                             END-IF
                             IF   WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX3)
                                                      NOT =  ZERO
                                     ADD   1   TO  
                                        WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1)
                             END-IF
                             ADD     1    TO    WRK-SKJ7-KAISU(IDX1)
                             INITIALIZE   WRK-SKJ7-TBL(IDX3)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
      *
      *    レセ電サブ返却エリアへの食事セット
           MOVE       ZERO    TO   IDX2
           MOVE       ZERO    TO   IDX3
           PERFORM    VARYING   IDX1   FROM  1  BY  1
                      UNTIL     (IDX1   >     31)
      *          DISPLAY "WRK-SKJ7  MATOME AFTER"
      *          DISPLAY "IDX1 = " IDX1
      *          DISPLAY "WRK-SKJ7-HKNCOMBI-DAY(IDX1) = "
      *                   WRK-SKJ7-HKNCOMBI-DAY(IDX1)
      *          DISPLAY "WRK-SKJ7-RYOYO(IDX1) = "
      *                   WRK-SKJ7-RYOYO(IDX1)
      *          DISPLAY "WRK-SKJ7-RYOYO-SU(IDX1) = "
      *                   WRK-SKJ7-RYOYO-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-SHOKUDOU(IDX1) = "
      *                   WRK-SKJ7-SHOKUDOU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-SU(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1)
      *          DISPLAY "WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1) = "
      *                   WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1)
      *          DISPLAY "WRK-SKJ7-SKJFTN(IDX1) = "
      *                   WRK-SKJ7-SKJFTN(IDX1)
      *          DISPLAY "WRK-SKJ7-SKJFTN-SU(IDX1) = "
      *                   WRK-SKJ7-SKJFTN-SU(IDX1)
      *          DISPLAY "WRK-SKJ7-KAISU =(IDX1) = "
      *                   WRK-SKJ7-KAISU (IDX1)
              IF    WRK-SKJ7-RYOYO(IDX1)   NOT =  SPACE
                IF (WRK-SKJ7-RYOYO(IDX1)   NOT = "197001310")  AND
                   (WRK-SKJ7-RYOYO(IDX1)   NOT = "197001710")
                    ADD    1     TO    IDX2
                    MOVE  WRK-SKJ7-HKNCOMBI-DAY(IDX1) TO
                                    LNK-NYURECEDEN-HKNCOMBI(3 IDX2)
                    MOVE   ZERO     TO    IDX4
                    IF   WRK-SKJ7-RYOYO(IDX1)  NOT =  SPACE
                        ADD     1     TO    IDX4
                        MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                        IF     IDX4    =   1
                            MOVE   "97"   TO
                              LNK-NYURECEDEN-SRYSKB(3 IDX2 IDX4)
                        END-IF
                        MOVE   WRK-SKJ7-RYOYO(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                    END-IF
                    MOVE      WRK-SKJ7-RYOYO-SU(IDX1)  TO
                                      LNK-NYURECEDEN-SURYO(3 IDX2 IDX4)
                    EVALUATE  WRK-SKJ7-RYOYO(IDX1)
                      WHEN  "197000110"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   640     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  2
                                MOVE  1280     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  3
                                MOVE  1920     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                        END-EVALUATE
                      WHEN  "197000710"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   506     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  2
                                MOVE  1012     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  3
                                MOVE  1518     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                        END-EVALUATE
      *               入院時生活療養（１）食事療養
                      WHEN  "197001310"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   554     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  2
                                MOVE  1108     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  3
                                MOVE  1662     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                        END-EVALUATE
      *               入院時生活療養（２）食事療養
                      WHEN  "197001710"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   420     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  2
                                MOVE   840     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                            WHEN  3
                                MOVE  1260     TO  
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                        END-EVALUATE
                    END-EVALUATE
                    MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                    IF   WRK-SKJ7-SHOKUDOU(IDX1)  NOT =  SPACE
                         ADD     1     TO    IDX4
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                         MOVE   WRK-SKJ7-SHOKUDOU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                         MOVE   50     TO
                                 LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                         MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                    END-IF
                    IF   WRK-SKJ7-TOKU-SHOKU(IDX1)   =  SPACE
                          CONTINUE
                    ELSE
                      IF  WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1) NOT = 0
                         ADD     1     TO    IDX4
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                         MOVE   WRK-SKJ7-TOKU-SHOKU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                         MOVE   1    TO
                                  LNK-NYURECEDEN-SURYO(3 IDX2 IDX4)
                         MOVE   76     TO
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                         MOVE  WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                      END-IF
                      IF  WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1) NOT = 0
                         ADD     1     TO    IDX4
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                         MOVE   WRK-SKJ7-TOKU-SHOKU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                         MOVE   2    TO
                                  LNK-NYURECEDEN-SURYO(3 IDX2 IDX4)
                         MOVE   152    TO
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                         MOVE  WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                      END-IF
                      IF  WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1) NOT = 0
                         ADD     1     TO    IDX4
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                         MOVE   WRK-SKJ7-TOKU-SHOKU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                         MOVE   3    TO
                                  LNK-NYURECEDEN-SURYO(3 IDX2 IDX4)
                         MOVE   228    TO
                                      LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                         MOVE  WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                      END-IF
                    END-IF
                    IF   WRK-SKJ7-SKJFTN(IDX1)  NOT =  SPACE
                        ADD     1     TO    IDX4
                        MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(3 IDX2 IDX4)
                        MOVE   WRK-SKJ7-SKJFTN(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(3 IDX2 IDX4)
                        MOVE   WRK-SKJ7-SKJFTN-SU(IDX1)  TO
                                  LNK-NYURECEDEN-SURYO(3 IDX2 IDX4)
                        EVALUATE   WRK-SKJ7-SKJFTN(IDX1)
      *               食事療養標準負担額（一般）
                            WHEN   "197000810"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  260  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  520  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  780  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               食事療養標準負担額（低２・９０日以下）
                            WHEN   "197000910"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  210  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  420  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  630  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               食事療養標準負担額（低２・９０日超）
                            WHEN   "197001010"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  160  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  320  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  480  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               食事療養標準負担額（低１）
                            WHEN   "197001110"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  100  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  200  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  300  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養（１）食事療養標準負担額（一般）
                            WHEN   "197002010"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  460  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  920  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE 1380  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養（２）食事療養標準負担額（一般）
                            WHEN   "197002110"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  420  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  840  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE 1260  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（低２）
                            WHEN   "197002210"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  210  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  420  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  630  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（低１）
                            WHEN   "197002310"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  130  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  260  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  390  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（老人低１（老福以外））
                            WHEN   "197002410"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  130  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  260  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  390  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（老人低１（老福））
                            WHEN   "197002510"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  100  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  200  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  300  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（医療区分２、３（一般））
                            WHEN   "197002710"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  260  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  520  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  780  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（医療区分２、３（低２・
      *                                           ９０日以下））
                            WHEN   "197002810"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  210  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  420  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  630  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（医療区分２、３（低２・
      *                                           ９０日超））
                            WHEN   "197002910"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  160  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  320  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  480  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（医療区分２、３（低１））
                            WHEN   "197003010"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  100  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   2
                                      MOVE  200  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                                   WHEN   3
                                      MOVE  300  TO 
                                         LNK-NYURECEDEN-TEN(3 IDX2 IDX4)
                               END-EVALUATE
      *
                        END-EVALUATE
      *
                        MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                    LNK-NYURECEDEN-KAISU(3 IDX2 IDX4)
                    END-IF
                    MOVE  IDX4  TO  LNK-NYURECEDEN-MEISAISU(3 IDX2)
                ELSE
      *             入院時生活療養の食事療養は添字４の領域に返却
                    ADD    1     TO    IDX3
                    MOVE  WRK-SKJ7-HKNCOMBI-DAY(IDX1) TO
                                    LNK-NYURECEDEN-HKNCOMBI(4 IDX3)
                    MOVE   ZERO     TO    IDX5
                    IF   WRK-SKJ7-RYOYO(IDX1)  NOT =  SPACE
                        ADD     1     TO    IDX5
                        MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(4 IDX3 IDX5)
                        IF     IDX5    =   1
                            MOVE   "97"   TO
                              LNK-NYURECEDEN-SRYSKB(4 IDX3 IDX5)
                        END-IF
                        MOVE   WRK-SKJ7-RYOYO(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(4 IDX3 IDX5)
                    END-IF
                    MOVE      WRK-SKJ7-RYOYO-SU(IDX1)  TO
                                      LNK-NYURECEDEN-SURYO(4 IDX3 IDX5)
                    EVALUATE  WRK-SKJ7-RYOYO(IDX1)
                      WHEN  "197000110"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   640     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                            WHEN  2
                                MOVE  1280     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                            WHEN  3
                                MOVE  1920     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                        END-EVALUATE
                      WHEN  "197000710"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   506     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                            WHEN  2
                                MOVE  1012     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                            WHEN  3
                                MOVE  1518     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                        END-EVALUATE
      *               入院時生活療養（１）食事療養
                      WHEN  "197001310"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   554     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                            WHEN  2
                                MOVE  1108     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                            WHEN  3
                                MOVE  1662     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                        END-EVALUATE
      *               入院時生活療養（２）食事療養
                      WHEN  "197001710"
                        EVALUATE  WRK-SKJ7-RYOYO-SU(IDX1)
                            WHEN  1
                                MOVE   420     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                            WHEN  2
                                MOVE   840     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                            WHEN  3
                                MOVE  1260     TO  
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                        END-EVALUATE
                    END-EVALUATE
                    MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(4 IDX3 IDX5)
                    IF   WRK-SKJ7-SHOKUDOU(IDX1)  NOT =  SPACE
                         ADD     1     TO    IDX5
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(4 IDX3 IDX5)
                         MOVE   WRK-SKJ7-SHOKUDOU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(4 IDX3 IDX5)
                         MOVE   50     TO
                                 LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                         MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(4 IDX3 IDX5)
                    END-IF
                    IF   WRK-SKJ7-TOKU-SHOKU(IDX1)   =  SPACE
                          CONTINUE
                    ELSE
                      IF  WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1) NOT = 0
                         ADD     1     TO    IDX5
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(4 IDX3 IDX5)
                         MOVE   WRK-SKJ7-TOKU-SHOKU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(4 IDX3 IDX5)
                         MOVE   1    TO
                                  LNK-NYURECEDEN-SURYO(4 IDX3 IDX5)
                         MOVE   76     TO
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                         MOVE  WRK-SKJ7-TOKU-SHOKU-KAISU1(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(4 IDX3 IDX5)
                      END-IF
                      IF  WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1) NOT = 0
                         ADD     1     TO    IDX5
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(4 IDX3 IDX5)
                         MOVE   WRK-SKJ7-TOKU-SHOKU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(4 IDX3 IDX5)
                         MOVE   2    TO
                                  LNK-NYURECEDEN-SURYO(4 IDX3 IDX5)
                         MOVE   152    TO
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                         MOVE  WRK-SKJ7-TOKU-SHOKU-KAISU2(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(4 IDX3 IDX5)
                      END-IF
                      IF  WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1) NOT = 0
                         ADD     1     TO    IDX5
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(4 IDX3 IDX5)
                         MOVE   WRK-SKJ7-TOKU-SHOKU(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(4 IDX3 IDX5)
                         MOVE   3    TO
                                  LNK-NYURECEDEN-SURYO(4 IDX3 IDX5)
                         MOVE   228    TO
                                      LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                         MOVE  WRK-SKJ7-TOKU-SHOKU-KAISU3(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(4 IDX3 IDX5)
                      END-IF
                    END-IF
                    IF   WRK-SKJ7-SKJFTN(IDX1)  NOT =  SPACE
                        ADD     1     TO    IDX5
                        MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(4 IDX3 IDX5)
                        MOVE   WRK-SKJ7-SKJFTN(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(4 IDX3 IDX5)
                        MOVE   WRK-SKJ7-SKJFTN-SU(IDX1)  TO
                                  LNK-NYURECEDEN-SURYO(4 IDX3 IDX5)
                        EVALUATE   WRK-SKJ7-SKJFTN(IDX1)
      *               食事療養標準負担額（一般）
                            WHEN   "197000810"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  260  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  520  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  780  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               食事療養標準負担額（低２・９０日以下）
                            WHEN   "197000910"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  210  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  420  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  630  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               食事療養標準負担額（低２・９０日超）
                            WHEN   "197001010"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  160  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  320  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  480  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               食事療養標準負担額（低１）
                            WHEN   "197001110"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  100  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  200  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  300  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養（１）食事療養標準負担額（一般）
                            WHEN   "197002010"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  460  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  920  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE 1380  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養（２）食事療養標準負担額（一般）
                            WHEN   "197002110"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  420  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  840  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE 1260  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（低２）
                            WHEN   "197002210"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  210  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  420  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  630  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（低１）
                            WHEN   "197002310"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  130  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  260  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  390  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（老人低１（老福以外））
                            WHEN   "197002410"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  130  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  260  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  390  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（老人低１（老福））
                            WHEN   "197002510"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  100  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  200  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  300  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（医療区分２、３（一般））
                            WHEN   "197002710"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  260  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  520  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  780  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（医療区分２、３（低２・
      *                                           ９０日以下））
                            WHEN   "197002810"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  210  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  420  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  630  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（医療区分２、３（低２・
      *                                           ９０日超））
                            WHEN   "197002910"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  160  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  320  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  480  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *               生活療養食事療養標準負担額（医療区分２、３（低１））
                            WHEN   "197003010"
                               EVALUATE   WRK-SKJ7-SKJFTN-SU(IDX1)
                                   WHEN   1
                                      MOVE  100  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   2
                                      MOVE  200  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                                   WHEN   3
                                      MOVE  300  TO 
                                         LNK-NYURECEDEN-TEN(4 IDX3 IDX5)
                               END-EVALUATE
      *
                        END-EVALUATE
      *
                        MOVE  WRK-SKJ7-KAISU(IDX1)  TO
                                    LNK-NYURECEDEN-KAISU(4 IDX3 IDX5)
                    END-IF
                    MOVE  IDX5  TO  LNK-NYURECEDEN-MEISAISU(4 IDX3)
                END-IF
              END-IF
           END-PERFORM
      *
           .
       2103-SHOKUJI-HENSHU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療行為入力された特別食加算の編集
      *****************************************************************
       2103-TOKU-SHOKU-HENSHU-SEC        SECTION.
      *
           MOVE    ZERO                    TO  FLG-TOKU-SET
      *
      *特別食加算（食事療養）の取得
           INITIALIZE                          SRYACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  ACCT-HOSPNUM
           MOVE    "1"                     TO  ACCT-NYUGAIKBN
           MOVE    LNK-NYURECEDEN-PTID     TO  ACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  ACCT-SRYYM
           MOVE    "tbl_sryacct"           TO  MCP-TABLE
           MOVE    "key54"                 TO  MCP-PATHNAME
           PERFORM 910-SRYACCT-SELECT-SEC
           IF      FLG-SRYACCT             =   ZERO
               MOVE    "tbl_sryacct"       TO  MCP-TABLE
               MOVE    "key54"             TO  MCP-PATHNAME
               PERFORM   910-SRYACCT-READ-SEC
               PERFORM   UNTIL   (FLG-SRYACCT   =  1)
                   MOVE   1                        TO  FLG-TOKU-SHOKU
                   INITIALIZE                          HKNCOMBI-REC
                   MOVE    LNK-NYURECEDEN-HOSPNUM  TO  COMB-HOSPNUM
                   MOVE    LNK-NYURECEDEN-PTID     TO  COMB-PTID
                   MOVE    ACCT-HKNCOMBI           TO  COMB-HKNCOMBINUM
                   MOVE    "tbl_hkncombi"          TO  MCP-TABLE
                   MOVE    "key"                   TO  MCP-PATHNAME
                   PERFORM 910-HKNCOMBI-SELECT-SEC
                   IF      FLG-HKNCOMBI            =   ZERO
                       MOVE    "tbl_hkncombi"      TO  MCP-TABLE
                       MOVE    "key"               TO  MCP-PATHNAME
                       PERFORM   910-HKNCOMBI-READ-SEC
                       IF   FLG-HKNCOMBI         =  ZERO
                            IF    ( COMB-HKNNUM   = "971" OR "973" OR
                                                    "975")
                                            OR
                                  ( COMB-HKNNUM(1:2)  =    "98")
                                MOVE    ZERO       TO  FLG-TOKU-SHOKU
                            ELSE
                                EVALUATE   LNK-NYURECEDEN-HKNKBN
      *                             社保
                                    WHEN   "1"
                                        IF   COMB-HKNNUM = "060"  OR
                                                           "067"  OR
                                                           "068"  OR
                                                           "069"  OR
                                                           "039"  OR
                                                           "040"
                                            MOVE  ZERO  TO
                                                       FLG-TOKU-SHOKU
                                        END-IF
      *                             国保
                                    WHEN   "2"
                                        IF   COMB-HKNNUM = "060"  OR
                                                           "067"
                                            CONTINUE
                                        ELSE
                                            MOVE  ZERO  TO
                                                       FLG-TOKU-SHOKU
                                        END-IF
      *                             広域連合
                                    WHEN   "3"
                                        IF   COMB-HKNNUM = "039"
                                            CONTINUE
                                        ELSE
                                            MOVE  ZERO  TO
                                                       FLG-TOKU-SHOKU
                                        END-IF
                                END-EVALUATE
                            END-IF
                       ELSE
                           MOVE    ZERO            TO  FLG-TOKU-SHOKU
                       END-IF
                   END-IF
      *
      *            保険組合せクローズ
                   MOVE    "tbl_hkncombi"      TO  MCP-TABLE
                   MOVE    "key"               TO  MCP-PATHNAME
                   PERFORM   900-CLOSE-SEC
      *
                   IF    FLG-TOKU-SHOKU        =   1
                       PERFORM    VARYING   IDX1   FROM   1   BY  1
                         UNTIL   (IDX1         >   31)     OR
                                 (LNK-NYURECEDEN-HKNCOMBI(3 IDX1)
                                               =   ZERO)
                             CONTINUE
                       END-PERFORM
                       MOVE  1   TO   FLG-TOKU-SET
                       MOVE  ACCT-HKNCOMBI
                                 TO   LNK-NYURECEDEN-HKNCOMBI(3 IDX1)
                       MOVE  1   
                                 TO   LNK-NYURECEDEN-MEISAISU(3 IDX1)
                       MOVE   "SI"
                                 TO   LNK-NYURECEDEN-RECSKB(3 IDX1 1)
                       MOVE   "97"
                                 TO   LNK-NYURECEDEN-SRYSKB(3 IDX1 1)
                       MOVE   "197000470"
                                 TO   LNK-NYURECEDEN-SRYCD(3 IDX1 1)
                       MOVE   ACCT-SURYOUTOTAL
                                 TO   LNK-NYURECEDEN-SURYO(3 IDX1 1)
                       MOVE   ACCT-ZAITEN
                                 TO   LNK-NYURECEDEN-TEN(3 IDX1 1)
                       MOVE   ACCT-ZAIKAISU
                                 TO   LNK-NYURECEDEN-KAISU(3 IDX1 1)
                   END-IF
      *
                   MOVE    "tbl_sryacct"       TO  MCP-TABLE
                   MOVE    "key54"             TO  MCP-PATHNAME
                   PERFORM   910-SRYACCT-READ-SEC
               END-PERFORM
           END-IF
      *
      *    診療会計クローズ
           MOVE    "tbl_sryacct"           TO  MCP-TABLE
           MOVE    "key54"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *
      *特別食加算（生活療養）の取得
           INITIALIZE                          SRYACCT-REC
           MOVE    LNK-NYURECEDEN-HOSPNUM  TO  ACCT-HOSPNUM
           MOVE    "1"                     TO  ACCT-NYUGAIKBN
           MOVE    LNK-NYURECEDEN-PTID     TO  ACCT-PTID
           MOVE    LNK-NYURECEDEN-SANTEIYM TO  ACCT-SRYYM
           MOVE    "tbl_sryacct"           TO  MCP-TABLE
           MOVE    "key55"                 TO  MCP-PATHNAME
           PERFORM 910-SRYACCT-SELECT-SEC
           IF      FLG-SRYACCT             =   ZERO
               MOVE    "tbl_sryacct"       TO  MCP-TABLE
               MOVE    "key55"             TO  MCP-PATHNAME
               PERFORM   910-SRYACCT-READ-SEC
               PERFORM   UNTIL   (FLG-SRYACCT   =  1)
                   MOVE   1                        TO  FLG-TOKU-SHOKU
                   INITIALIZE                          HKNCOMBI-REC
                   MOVE    LNK-NYURECEDEN-HOSPNUM  TO  COMB-HOSPNUM
                   MOVE    LNK-NYURECEDEN-PTID     TO  COMB-PTID
                   MOVE    ACCT-HKNCOMBI           TO  COMB-HKNCOMBINUM
                   MOVE    "tbl_hkncombi"          TO  MCP-TABLE
                   MOVE    "key"                   TO  MCP-PATHNAME
                   PERFORM 910-HKNCOMBI-SELECT-SEC
                   IF      FLG-HKNCOMBI            =   ZERO
                       MOVE    "tbl_hkncombi"      TO  MCP-TABLE
                       MOVE    "key"               TO  MCP-PATHNAME
                       PERFORM   910-HKNCOMBI-READ-SEC
                       IF   FLG-HKNCOMBI         =  ZERO
                            IF    ( COMB-HKNNUM   = "971" OR "973" OR
                                                    "975")
                                            OR
                                  ( COMB-HKNNUM(1:2)  =    "98")
                                MOVE    ZERO       TO  FLG-TOKU-SHOKU
                            ELSE
                                EVALUATE   LNK-NYURECEDEN-HKNKBN
      *                             社保
                                    WHEN   "1"
                                        IF   COMB-HKNNUM = "060"  OR
                                                           "067"  OR
                                                           "068"  OR
                                                           "069"  OR
                                                           "039"  OR
                                                           "040"
                                            MOVE  ZERO  TO
                                                       FLG-TOKU-SHOKU
                                        END-IF
      *                             国保
                                    WHEN   "2"
                                        IF   COMB-HKNNUM = "060"  OR
                                                           "067"
                                            CONTINUE
                                        ELSE
                                            MOVE  ZERO  TO
                                                       FLG-TOKU-SHOKU
                                        END-IF
      *                             広域連合
                                    WHEN   "3"
                                        IF   COMB-HKNNUM = "039"
                                            CONTINUE
                                        ELSE
                                            MOVE  ZERO  TO
                                                       FLG-TOKU-SHOKU
                                        END-IF
                                END-EVALUATE
                            END-IF
                       ELSE
                           MOVE    ZERO            TO  FLG-TOKU-SHOKU
                       END-IF
                   END-IF
      *
      *            保険組合せクローズ
                   MOVE    "tbl_hkncombi"      TO  MCP-TABLE
                   MOVE    "key"               TO  MCP-PATHNAME
                   PERFORM   900-CLOSE-SEC
      *
                   IF    FLG-TOKU-SHOKU        =   1
                       PERFORM    VARYING   IDX1   FROM   1   BY  1
                         UNTIL   (IDX1         >   31)     OR
                                 (LNK-NYURECEDEN-HKNCOMBI(4 IDX1)
                                               =   ZERO)
                             CONTINUE
                       END-PERFORM
                       MOVE  1   TO   FLG-TOKU-SET
                       MOVE  ACCT-HKNCOMBI
                                 TO   LNK-NYURECEDEN-HKNCOMBI(4 IDX1)
                       MOVE  1   
                                 TO   LNK-NYURECEDEN-MEISAISU(4 IDX1)
                       MOVE   "SI"
                                 TO   LNK-NYURECEDEN-RECSKB(4 IDX1 1)
                       MOVE   "97"
                                 TO   LNK-NYURECEDEN-SRYSKB(4 IDX1 1)
                       MOVE   "197001570"
                                 TO   LNK-NYURECEDEN-SRYCD(4 IDX1 1)
                       MOVE   ACCT-SURYOUTOTAL
                                 TO   LNK-NYURECEDEN-SURYO(4 IDX1 1)
                       MOVE   ACCT-ZAITEN
                                 TO   LNK-NYURECEDEN-TEN(4 IDX1 1)
                       MOVE   ACCT-ZAIKAISU
                                 TO   LNK-NYURECEDEN-KAISU(4 IDX1 1)
                   END-IF
      *
                   MOVE    "tbl_sryacct"       TO  MCP-TABLE
                   MOVE    "key55"             TO  MCP-PATHNAME
                   PERFORM   910-SRYACCT-READ-SEC
               END-PERFORM
           END-IF
      *
      *    診療会計クローズ
           MOVE    "tbl_sryacct"           TO  MCP-TABLE
           MOVE    "key55"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *
           .
       2103-TOKU-SHOKU-HENSHU-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院時生活療養（環境療養）（平成１８年１０月以降）
      *****************************************************************
       2104-KANKYO-HENSHU-SEC        SECTION.
      *
           PERFORM   VARYING   IDX1    FROM   1   BY   1
             UNTIL   IDX1      >       31
               IF    (WRK-HKNCOMBI-DAY(IDX1) NOT =  ZERO)           AND
                     (LNK-NYULIFE-KAN-SRYCD(IDX1)    NOT =  SPACE)  AND
                    ((WRK-NYUINKHN(IDX1)     NOT =  SPACE)          OR
                     (LNK-NYUINDAY-KBN(IDX1)     =  "1"  ))         AND
                     (WRK-GAIHAKU-KBN(IDX1)  =  ZERO OR 4 OR 5)
                   MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                     TO  WRK-KANKYO-HKNCOMBI-DAY(IDX1)
                   MOVE   LNK-NYULIFE-KAN-SRYCD(IDX1)
                                     TO  WRK-KANKYO-RYOYO(IDX1)
                   MOVE   LNK-NYULIFE-KANFTN-SRYCD(IDX1)
                                     TO  WRK-KANKYO-FTN(IDX1)
                   IF   LNK-NYULIFE-KAN-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  LNK-NYULIFE-KAN-SRYCD(IDX1) TO WRK-SRYCD-X
                       COMPUTE WRK-KANKYO-SRYCDTOTAL(IDX1)  =
                           WRK-KANKYO-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
                   END-IF
                   IF   LNK-NYULIFE-KANFTN-SRYCD(IDX1)  NOT =  SPACE
                       MOVE  LNK-NYULIFE-KANFTN-SRYCD(IDX1)
                                                        TO WRK-SRYCD-X
                       COMPUTE WRK-KANKYO-SRYCDTOTAL(IDX1)  =
                           WRK-KANKYO-SRYCDTOTAL(IDX1)  +  WRK-SRYCD-9
                   END-IF
               END-IF
           END-PERFORM
      *
      *
      *    同一剤のまとめ処理
           PERFORM      VARYING    IDX1   FROM   1  BY  1
                        UNTIL      IDX1   >   31
               IF    WRK-KANKYO-SRYCDTOTAL(IDX1)  NOT =   ZERO
                   ADD   1                  TO  WRK-KANKYO-KAISU(IDX1)
                   MOVE       ZERO          TO  IDX2
                   COMPUTE    IDX2          =   IDX1    +   1
                   PERFORM    VARYING    IDX3   FROM   IDX2  BY  1
                              UNTIL      IDX3   >   31
                       IF    (WRK-KANKYO-HKNCOMBI-DAY(IDX3)  =
                                     WRK-KANKYO-HKNCOMBI-DAY(IDX1)) AND
                             (WRK-KANKYO-SRYCDTOTAL(IDX3)  =
                                       WRK-KANKYO-SRYCDTOTAL(IDX1))
                             ADD     1    TO    WRK-KANKYO-KAISU(IDX1)
                             INITIALIZE   WRK-KANKYO-TBL(IDX3)
                       END-IF
                   END-PERFORM
               END-IF
           END-PERFORM
      *
      *    レセ電サブ返却エリアへの環境療養セット
           MOVE       ZERO    TO   IDX2
           PERFORM    VARYING   IDX1   FROM  1  BY  1
                      UNTIL     (IDX1   >     31)
                IF    WRK-KANKYO-RYOYO(IDX1)   NOT =  SPACE
                    ADD    1     TO    IDX2
                    MOVE  WRK-KANKYO-HKNCOMBI-DAY(IDX1) TO
                                    LNK-NYURECEDEN-HKNCOMBI(5 IDX2)
                    MOVE   ZERO     TO    IDX4
                    IF   WRK-KANKYO-RYOYO(IDX1)  NOT =  SPACE
                        ADD     1     TO    IDX4
                        MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(5 IDX2 IDX4)
                        IF     IDX4    =   1
                            MOVE   "97"   TO
                              LNK-NYURECEDEN-SRYSKB(5 IDX2 IDX4)
                        END-IF
                        MOVE   WRK-KANKYO-RYOYO(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(5 IDX2 IDX4)
                    END-IF
                    EVALUATE  WRK-KANKYO-RYOYO(IDX1)
                      WHEN  "197001410"
                          MOVE   398     TO  
                                      LNK-NYURECEDEN-TEN(5 IDX2 IDX4)
                      WHEN  "197001810"
                          MOVE   398     TO  
                                      LNK-NYURECEDEN-TEN(5 IDX2 IDX4)
                    END-EVALUATE
                    MOVE  WRK-KANKYO-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(5 IDX2 IDX4)
                    IF   WRK-KANKYO-FTN(IDX1)  NOT =  SPACE
                         ADD     1     TO    IDX4
                         MOVE   "SI"   TO
                              LNK-NYURECEDEN-RECSKB(5 IDX2 IDX4)
                         MOVE   WRK-KANKYO-FTN(IDX1)  TO
                                  LNK-NYURECEDEN-SRYCD(5 IDX2 IDX4)
                         MOVE   320     TO  
                                      LNK-NYURECEDEN-TEN(5 IDX2 IDX4)
                         MOVE  WRK-KANKYO-KAISU(IDX1)  TO
                                LNK-NYURECEDEN-KAISU(5 IDX2 IDX4)
                    END-IF
      *
                    MOVE  WRK-KANKYO-KAISU(IDX1)  TO
                                    LNK-NYURECEDEN-KAISU(5 IDX2 IDX4)
                    MOVE  IDX4  TO  LNK-NYURECEDEN-MEISAISU(5 IDX2)
                END-IF
           END-PERFORM
      *
           .
       2104-KANKYO-HENSHU-EXT.
           EXIT.
      *****************************************************************
      *    点数マスタ退避ワークチェック処理
      *****************************************************************
       910-TENSUWRK-CHK-SEC               SECTION.
      *
           MOVE    ZERO                TO  FLG-TENSUWRK
      *
           PERFORM VARYING TTNS-IDX      FROM    1   BY  1
                   UNTIL ( TTNS-IDX      >   TTNS-MAX ) OR
                         ( FLG-TENSUWRK    =   1 )      OR
                         ( TTNS-IDX      >   200 )
               IF    ( WRK-TENSU-SRYCD (TTNS-IDX)
                                       =   WRK-TENSU-CD )
                   MOVE    1           TO  FLG-TENSUWRK
                   MOVE    WRK-TENSU-DATA (TTNS-IDX)
                                       TO  TNS-TENSU-REC
               END-IF
           END-PERFORM
      *
           .
       910-TENSUWRK-CHK-EXT.
           EXIT.
      *****************************************************************
      *    点数マスタ退避ワーク編集処理
      *****************************************************************
       910-TTNS-HEN-SEC               SECTION.
      *
           IF    ( TTNS-CONST-MAX  >   TTNS-MAX )
               COMPUTE TTNS-MAX    =   TTNS-MAX    +   1
               MOVE    TNS-SRYCD       TO  WRK-TENSU-SRYCD
                                                   (TTNS-MAX)
               MOVE    TNS-TENSU-REC   TO  WRK-TENSU-DATA
                                                   (TTNS-MAX)
           END-IF
      *
           .
       910-TTNS-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    システム管理マスター読込
      *****************************************************************
       910-SYSKANRI-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1001-REC
                                               SYS-5000-REC
               MOVE    ZERO                TO  FLG-SYSKANRI
           ELSE
               INITIALIZE                      SYS-1001-REC
                                               SYS-5000-REC
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
      *
           .
       910-SYSKANRI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者マスター読込
      *****************************************************************
       900-PTINF-READ-SEC         SECTION.
      *
           MOVE    PTINF-REC           TO  MCPDATA-REC
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptinf"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM   900-DBFETCH-SEC
               IF      MCP-RC          =   ZERO
                   MOVE    MCPDATA-REC TO  PTINF-REC
                   MOVE    ZERO        TO  FLG-PTINF
               ELSE
                   INITIALIZE              PTINF-REC
                   MOVE    1           TO  FLG-PTINF
               END-IF
           ELSE
               INITIALIZE                  PTINF-REC
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       900-PTINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院会計マスター検索
      *****************************************************************
       910-NYUINACCT-SELECT-SEC        SECTION.
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-NYUINACCT
           ELSE
               MOVE    1                  TO  FLG-NYUINACCT
           END-IF
      *
           .
       910-NYUINACCT-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院会計マスター読込
      *****************************************************************
       910-NYUINACCT-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  NYUINACCT-REC
               MOVE    ZERO               TO  FLG-NYUINACCT
           ELSE
               INITIALIZE                     NYUINACCT-REC
               MOVE    1                  TO  FLG-NYUINACCT
           END-IF
      *
           .
       910-NYUINACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    選定入院料振替マスター検索
      *****************************************************************
       910-SENTEICDCHG-SELECT-SEC        SECTION.
      *
           MOVE    SENTEICDCHG-REC     TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-SENTEICDCHG
           ELSE
               MOVE    1                  TO  FLG-SENTEICDCHG
           END-IF
      *
           .
       910-SENTEICDCHG-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    選定入院料振替マスター読込
      *****************************************************************
       910-SENTEICDCHG-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  SENTEICDCHG-REC
               MOVE    ZERO               TO  FLG-SENTEICDCHG
           ELSE
               INITIALIZE                     SENTEICDCHG-REC
               MOVE    1                  TO  FLG-SENTEICDCHG
           END-IF
      *
           .
       910-SENTEICDCHG-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    低所得マスター検索
      *****************************************************************
       910-TSYRRK-SELECT-SEC        SECTION.
      *
           MOVE    TSYRRK-REC          TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-TSYRRK
           ELSE
               MOVE    1                  TO  FLG-TSYRRK
           END-IF
      *
           .
       910-TSYRRK-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    低所得マスター読込
      *****************************************************************
       910-TSYRRK-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  TSYRRK-REC
               MOVE    ZERO               TO  FLG-TSYRRK
           ELSE
               INITIALIZE                     TSYRRK-REC
               MOVE    1                  TO  FLG-TSYRRK
           END-IF
      *
           .
       910-TSYRRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    低年金マスター検索
      *****************************************************************
       910-TNKRRK-SELECT-SEC        SECTION.
      *
           MOVE    TNKRRK-REC          TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-TNKRRK
           ELSE
               MOVE    1                  TO  FLG-TNKRRK
           END-IF
      *
           .
       910-TNKRRK-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    低年金マスター読込
      *****************************************************************
       910-TNKRRK-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  TNKRRK-REC
               MOVE    ZERO               TO  FLG-TNKRRK
           ELSE
               INITIALIZE                     TNKRRK-REC
               MOVE    1                  TO  FLG-TNKRRK
           END-IF
      *
           .
       910-TNKRRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院診療行為マスター検索
      *****************************************************************
       910-NYUINACT-SELECT-SEC        SECTION.
      *
           MOVE    NYUINACT-REC        TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-NYUINACT
           ELSE
               MOVE    1                  TO  FLG-NYUINACT
           END-IF
      *
           .
       910-NYUINACT-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院診療行為マスター読込
      *****************************************************************
       910-NYUINACT-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  NYUINACT-REC
               MOVE    ZERO                TO  FLG-NYUINACT
           ELSE
               INITIALIZE                      NYUINACT-REC
               MOVE    1                   TO  FLG-NYUINACT
           END-IF
      *
           .
       910-NYUINACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスター検索
      *****************************************************************
       910-SRYACCT-SELECT-SEC        SECTION.
      *
           MOVE    SRYACCT-REC         TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-SRYACCT
           ELSE
               MOVE    1                  TO  FLG-SRYACCT
           END-IF
      *
           .
       910-SRYACCT-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスター読込
      *****************************************************************
       910-SRYACCT-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  SRYACCT-REC
               MOVE    ZERO               TO  FLG-SRYACCT
           ELSE
               INITIALIZE                     SRYACCT-REC
               MOVE    1                  TO  FLG-SRYACCT
           END-IF
      *
           .
       910-SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療行為マスター検索
      *****************************************************************
       910-SRYACT-SELECT-SEC        SECTION.
      *
           MOVE    SRYACT-REC          TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       910-SRYACT-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療行為マスター読込
      *****************************************************************
       910-SRYACT-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       910-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスター検索
      *****************************************************************
       910-HKNCOMBI-SELECT-SEC        SECTION.
      *
           MOVE    HKNCOMBI-REC        TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-HKNCOMBI
           ELSE
               MOVE    1                  TO  FLG-HKNCOMBI
           END-IF
      *
           .
       910-HKNCOMBI-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスター読込
      *****************************************************************
       910-HKNCOMBI-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  HKNCOMBI-REC
               MOVE    ZERO                TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                      HKNCOMBI-REC
               MOVE    1                   TO  FLG-HKNCOMBI
           END-IF
      *
           .
       910-HKNCOMBI-READ-EXT.
           EXIT.
      *****************************************************************
      *    点数マスター読込（主キー）
      *****************************************************************
       910-TENSU-READ-SEC         SECTION.
      *
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM   900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
                   MOVE    ZERO                TO  FLG-TENSU
               ELSE
                   MOVE    1                   TO  FLG-TENSU
                   INITIALIZE                  TNS-TENSU-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-TENSU
               INITIALIZE                  TNS-TENSU-REC
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       910-TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＳＥＬＥＣＴ処理
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           IF      MCP-RC              =   ZERO
               CONTINUE
           ELSE
               DISPLAY "SELECT ERR table=" MCP-TABLE
                       " pathname="        MCP-PATHNAME
           END-IF
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＦＥＴＣＨ処理
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブルアクセス処理
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
           CALL    "ORCDBMAIN"     USING   MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           .
      *
       900-ORCDBMAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブルクローズ処理
      *****************************************************************
       900-CLOSE-SEC               SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-CLOSE-EXT.
           EXIT.
