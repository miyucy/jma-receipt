      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this licence along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION      DIVISION.
       PROGRAM-ID.         ORCS02.
      ****************************************************************
      *    OS           LINUX                                         
      *                                                               
      *    PROGRAM      ORCS02  /  負担金額算定サブ                   
      *                            （入院用）                         
      *  管理者            : 
      *  作成日付    作業者        記述
      *  02/10/22    NACL−門脇    新規作成
      ****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  01.00.01    NACL-門脇    03/03/07  老人限度額の集計変更
      *  01.00.02    NACL-門脇    03/03/10  食事区分”４”の対応追加
      *  01.00.03    NACL-門脇    03/03/25  更正・育成等の患者公費負担対応
      *  01.00.04    NACL-門脇    03/04/16  船員保険（被保険者）＋通勤災害
      *                                     ＋初診時　対応
      *  01.00.05    NACL-門脇    03/05/07  地方老人の負担額の四捨五入の設定
      *                                     を保険番号マスタの設定で行う。
      *  01.00.06    NACL-門脇    03/05/08  船員保険（職務上）の食事負担無し
      *                                     に修正
      *  01.00.07    NACL-門脇    03/05/21  減免の端数設定対応
      *  01.00.08    NACL-門脇    03/06/06  消費税端数対応
      *  01.00.09    NACL-門脇    03/07/01  レセ記載用一部負担金編集修正
      *  01.00.10    NACL-門脇    03/07/24  労災非指定医療機関対応
      *                                     自賠責患者請求０％対応
      *                                     自賠責文書料消費税対応
      *                                     自賠責の療養担当手当対応
      *                                     労災自賠責食事療養費計算対応
      *  01.00.11    NACL-門脇    03/08/27  特定疾患改正対応
      *  01.00.12    NACL-門脇    03/10/02  東京都地方公費対応
      *  01.00.13    NACL-門脇    03/12/02  日別収納マスタ更新等
      *  01.00.14    NACL-門脇    04/01/14  診療行為の包括分は除く
      *                                     SRYACCT7→33
      *  01.00.15    NACL-門脇    04/01/15  消費税項目等追加項目編集
      *  01.00.16    NACL-門脇    04/02/06  自賠責の食事療養費を労災
      *                                     の１．２倍で計算する
      *  01.00.17    NACL-門脇    04/02/10  食事負担額助成対応
      *  01.00.18    NACL-門脇    04/02/10  生保の食事負担計算修正
      *  01.00.19    NACL-門脇    04/02/10  生保の公費負担限度額設定
      *  01.00.20    NACL-門脇    04/03/12  公費負担円単位編集
      *  01.00.21    NACL-門脇    04/04/06  高齢者フラグ編集修正
      *  01.00.22    NACL-門脇    04/07/27  国保負担割合編集修正
      *  01.00.23    NACL-門脇    04/08/04  同一保険番号対応
      *  01.00.24    NACL-門脇    04/08/20  兵庫県地方公費対応
      *  01.00.25    NACL-門脇    04/09/07  １０円未満四捨五入しない場合
      *                                     の修正
      *  01.00.26    NACL-門脇    04/09/07  北海道地方公費対応
      *  01.00.27    NACL-門脇    04/09/08  生保単独の限度額修正
      *  01.00.28    NACL-門脇    04/09/10  熊本県地方公費対応
      *  01.00.29    NACL-門脇    04/09/24  請求額端数処理対応
      *  01.00.30    NACL-門脇    04/10/01  自賠責特定器材等消費税対応
      *  01.00.31    NACL-門脇    04/10/21  公費四捨五入しない場合の修正
      *  01.00.32    NACL-門脇    04/11/12  福岡県地方公費対応
      *  01.00.33    NACL-門脇    04/11/15  公費月上限額取得修正
      *  01.00.34    NACL-門脇    04/11/24  埼玉県４１老人が長期と併用の
      *                                     場合、１００００円上限とする
      *  01.00.35    NACL-門脇    04/11/25  大阪府４１老人上限額編集
      *  01.00.36    NACL-門脇    04/11/25  福島県乳幼児特殊計算対応
      *  01.00.37    NACL-門脇    05/01/14  岡山県乳幼児特殊計算対応
      *  01.00.38    NACL-門脇    05/01/25  北海道地方公費修正
      *  01.00.39    NACL-門脇    05/03/03  食事に関する編集修正
      *  01.00.40    NACL-門脇    05/03/04  静岡県母子障害が長期と併用の
      *                                     場合、１００００円上限とする
      *  01.00.41    NACL-門脇    05/03/07  北海道、大阪、広島４１老人の
      *                                     ７２３００超、低所得低年金対応
      *  01.00.42    NACL-門脇    05/03/23  保険組合せの上限区分編集
      *  01.01.01    NACL-門脇    05/03/24  小児特定上限対応
      *  01.01.02    NACL-門脇    05/03/24  新潟県地方公費：日固定額対応
      *  01.01.03    NACL-門脇    05/04/13  静岡県地方公費対応
      *  01.01.04    NACL-門脇    05/05/06  公費一部負担金と食事負担を
      *                                     別々に比較し、それぞれ値の小さ
      *                                     いものを患者負担とする
      *  01.01.05    NACL-門脇    05/06/09  低所得情報編集修正
      *  01.01.06    NACL-門脇    05/06/16  京都４１老人対応
      *  01.01.07    NACL-門脇    05/06/21  更生・育成が長期と併用の場合の対応
      *  01.01.08    NACL-門脇    05/06/22  兵庫県地方公費対応
      *  01.01.09    NACL-門脇    05/06/27  加算率３桁対応
      *  01.01.10    NACL-門脇    05/07/08  福井県地方公費対応
      *  01.01.11    NACL-門脇    05/07/12  秋田県地方公費対応
      *  01.01.12    NACL-小豆沢  05/07/15  自費１０項目対応
      *  01.01.13    NACL-門脇    05/07/19  収納項目追加に伴う修正
      *  01.01.14    NACL-門脇    05/07/22  日上限、月上限がある場合の対応
      *  01.01.15    NACL-門脇    05/08/23  埼玉県さいたま市対応
      *  01.01.16    NACL-門脇    05/08/24  千葉４１老人対応
      *  01.01.17    NACL-門脇    05/08/25  福島、岡山特殊計算修正
      *  01.01.18    NACL-門脇    05/09/01  省庁対応
      *  01.01.19    NACL-門脇    05/09/15  島根県地方公費対応
      *  01.01.20    NACL-門脇    05/09/21  全国土木建築、全国板金業＋
      *                                     精神、結核対応
      *  01.01.21    NACL-門脇    05/10/03  宮城県地方公費対応
      *  01.01.22    NACL-門脇    05/10/06  鳥取県地方公費対応
      *  01.01.23    NACL-門脇    05/10/06  茨城県地方公費対応
      *  01.01.24    NACL-門脇    06/01/05  シス管（５０００）の食事情報取
      *                                     得修正
      *  01.01.25    NACL-門脇    06/01/17  高齢者の主保険又は２７老人情報
      *                                     （円単位）修正
      *  01.01.26    NACL-門脇    06/01/17  高齢者２割＋大阪１８８の
      *                                     主保険又は２７老人の７２３００
      *                                     ＋＠対応
      *  01.01.27    NACL-門脇    06/01/26  群馬県高崎市老人対応
      *  01.01.28    NACL-門脇    06/02/03  宮城県地方公費食事療養費記載対応
      *  01.01.29    NACL-小豆沢  06/02/15  労災入院中の特別食加算退避
      *                                     処理の診療会計検索ＰＡＴＨ変更
      *  01.01.30    NACL-門脇    06/02/16  高齢者２割＋北海道重心の
      *                                     主保険又は２７老人の７２３００
      *                                     ＋＠対応
      *  01.01.31    NACL-門脇    06/02/17  特別療養費対応
      *  01.01.32    NACL-門脇    06/02/22  自費保険計算・集計先編集修正
      *  01.03.01    NACL-門脇    06/03/09  いわき市重心対応
      *  01.03.02    NACL-門脇    06/03/09  東京都マル障＋長期対応
      *  01.03.03    NACL-門脇    06/03/20  自立支援法対応
      *  01.03.04    NACL-門脇    06/03/22  ２００６０４改正対応（食事関係）
      *  01.03.05    NACL-門脇    06/03/30  自立支援法（高額療養費現物対応）
      *  02.09.01    NACL-門脇    06/04/19  岩手県地方公費対応
      *  02.09.02    NACL-門脇    06/05/02  自立支援神戸市対応
      *  02.09.03    NACL-門脇    06/05/18  岡山県西粟倉村退職者国保２割対応
      *  02.09.04    NACL-門脇    06/06/01  特定疾患等＋長期対応
      *  02.09.05    NACL-門脇    06/06/09  自立支援神戸市対応修正
      *  02.09.06    NACL-門脇    06/06/12  自立支援の上限額がある場合の
      *                                     高齢者、長期に関する負担計算修正
      *  03.01.01    NACL-門脇    06/07/06  領収書対応
      *  03.01.02    NACL-門脇    06/07/20  北海道の特定疾患食事対応
      *  03.02.01    NACL-門脇    06/07/31  高齢者上限額経過措置対応
      *  03.02.02    NACL-門脇    06/08/17  茨城県地方公費対応
      *  03.02.03    NACL-門脇    06/08/18  岡山県地方公費１０月改正対応
      *  03.02.04    NACL-門脇    06/09/05  健康保険法１０月改正対応
      *  03.02.05    NACL-門脇    06/09/13  入院時生活療養費１０月改正対応
      *  03.02.06    NACL-門脇    06/09/16  山梨県地方公費対応
      *  03.02.07    NACL-門脇    06/09/20  大分県地方公費１０月改正対応
      *  03.02.08    NACL-門脇    06/09/25  愛知県地方公費１０月改正対応
      *  03.02.09    NACL-門脇    06/10/02  東京都地方公費１０月改正対応
      *  03.02.10    NACL-門脇    06/10/03  神奈川県地方公費１０月改正対応
      *  03.02.11    NACL-門脇    06/10/04  和歌山県地方公費１０月改正対応
      *  03.02.12    NACL-門脇    06/10/11  入院時生活療養費の公費対象外対応
      *                                     （群馬県地方公費）
      *  03.03.01    NACL-門脇    06/10/17  減額・免除・支払猶予対応
      *  03.03.02    NACL-門脇    06/10/23  地方公費保険番号マスタ低所得
      *                                     低年金タブ有効化対応
      *  03.03.03    NACL-門脇    06/10/30  障害児施設医療・療養介護医療
      *                                     対応
      *  03.03.04    NACL-門脇    06/11/02  減額・免除・支払猶予対応
      *  03.03.05    NACL-門脇    06/11/08  岡山県地方公費１０月改正対応
      *  03.03.06    NACL-門脇    06/11/09  高齢者で低所得かつ全国公費を
      *                                     もつ場合の上限額編集修正
      *  03.04.01    NACL-門脇    06/11/20  高額委任払い制度、高額４回目以降
      *                                     対応
      *  03.04.02    NACL-門脇    06/11/24  宮城県地方公費１０月改正対応
      *  03.04.03    NACL-門脇    06/11/29  入院時生活療養費の公費対象外対応
      *                                     （新潟県地方公費）
      *  03.04.04    NACL-門脇    06/12/01  自賠責健保準拠対応
      *  03.04.05    NACL-門脇    06/12/26  東京理容等＋結核対応
      *  03.04.06    NACL-門脇    07/01/23  ５１＋低所得対応
      *  03.04.07    NACL-門脇    07/01/25  消費税総額表示対応
      *  03.04.08    NACL-門脇    07/02/05  北海道旭川市対応
      *  03.04.09    NACL-門脇    07/02/14  福島県飯館村対応
      *  03.04.10    NACL-門脇    07/02/21  高額現物給付対応
      *  03.04.11    NACL-門脇    07/03/22  埼玉県地方公費対応
      *                                     （川口・春日部市）
      *  03.04.12    NACL-門脇    07/03/23  北海道小樽市地方公費対応
      *  03.04.13    NACL-門脇    07/05/02  高齢者の計算修正
      *  03.04.14    NACL-門脇    07/05/08  北海道旭川市対応
      *  03.04.15    NACL-門脇    07/06/13  現物給付高額４回目公費併用時対応
      *  03.05.00    NACL-門脇    07/05/09  グループ診療対応
      *  03.05.01    NACL-門脇    07/07/13  北海道地方公費対応
      *  03.05.02    NACL-門脇    07/07/20  北海道４１老人現物給付対応
      *  03.05.03    NACL-門脇    07/07/31  ７０歳未満現物給付保険者毎で計算
      *  03.05.04    NACL-門脇    07/08/01  所得情報取扱い機能強化対応
      *  03.05.05    NACL-門脇    07/08/01  標準負担額減額認定証設定対応
      *  03.05.06    NACL-門脇    07/08/01  月途中の所得情報変更対応
      *  03.05.07    NACL-門脇    07/08/10  北海道４１老人現物給付対応修正
      *  03.05.08    NACL-門脇    07/09/03  減額減免全国公費対応
      *  03.05.09    NACL-門脇    07/09/12  東京都マル子対応
      *  03.05.10    NACL-門脇    07/09/13  所沢市乳幼児対応
      *  03.05.11    NACL-門脇    07/09/27  特定保険者＋精神、結核対応修正
      *                                     （老人は対象外とする）
      *  04.01.01    NACL-門脇    07/10/05  患者減免自費対応
      *  04.01.02    NACL-門脇    07/10/24  自賠責特定器材等消費税対象外設定
      *                                     項目数拡張対応
      *  04.01.03    NACL-門脇    07/10/25  公務災害対応
      *  04.01.04    NACL-門脇    07/12/03  北海道特定疾患（道単独事業）対応
      *  04.01.05    NACL-門脇    07/12/07  公害対応
      *  04.01.06    NACL-門脇    07/12/19  入院料未算定日対応
      *  04.01.07    NACL-門脇    08/01/18  埼玉県川島町地方公費対応
      *  04.01.08    NACL-門脇    08/01/21  同日再入院食事対応
      *  04.01.09    NACL-門脇    08/01/25  結核入院限度額対応
      *  04.02.01    NACL-門脇    08/02/29  平成２０年４月改正対応
      *  04.02.02    NACL-門脇    08/03/06  生保一部負担金編集修正
      *  04.02.03    NACL-門脇    08/03/21  肝炎治療対応
      *  04.02.04    NACL-門脇    08/03/24  鳥取県地方公費対応
      *  04.02.05    NACL-門脇    08/04/08  北海道道老廃止
      *  04.02.06    NACL-門脇    08/04/09  ７０歳代特例措置０５１食事計算
      *  04.02.07    NACL-門脇    08/04/25  ７０歳代特例措置０５１食事計算
      *                                     （道単独事業５１）
      *  04.02.08    NACL-門脇    08/04/28  埼玉県川越市地方公費対応
      *  04.02.09    NACL-門脇    08/05/01  後期高齢者月途中保険者変更対応
      *  04.02.10    NACL-門脇    08/05/23  月途中で後期高齢者から７０歳未満
      *                                     現物給付へ変更となった場合の対応
      *  04.02.11    NACL-門脇    08/05/28  ７０歳代特例措置０５１食事計算
      *                                     （都単独事業５１）
      *  04.02.12    NACL-門脇    08/05/29  現物給付保険者単位条件追加
      *  04.02.13    NACL-門脇    08/06/03  入院時生活療養費の公費対象外対応
      *                                     （群馬県地方公費）
      *  04.02.14    NACL-門脇    08/06/24  後期高齢者の現物給付対象編集修正
      *  04.02.15    NACL-門脇    08/06/30  高齢者一般経過措置延長対応
      *  04.02.16    NACL-門脇    08/07/30  高齢者３割８０１００＋＠の計算修正
      *  04.02.17    NACL-門脇    08/08/20  大阪府地方公費対応
      ****************************************************************
       ENVIRONMENT         DIVISION.
       CONFIGURATION       SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                DIVISION.
       FILE                        SECTION.
      *
       WORKING-STORAGE SECTION.
      *
       01  KEISAN-AREA.
           03  WK-KNJFTNKIN            PIC 9(10).
           03  WK-KNJFTNKIN-ENTANI     PIC 9(08)V9(01).
           03  WK-ENTANI               PIC 9(08).
           03  WK-ENTANI2              PIC 9(08).
           03  WK-CYOKI                PIC 9(08).
           03  WK-CYOKI-ENTANI         PIC 9(08).
           03  WK-CYOKI-ZAN            PIC 9(08).
           03  WK-CYOKI-ZAN-ENTANI     PIC 9(08).
           03  WK-ZENGAKU              PIC 9(10).
           03  WK-ZENGAKU-SYU          PIC 9(10).
           03  WK-ZENGAKU-YAK          PIC 9(10).
           03  WK-FUTANWARI            PIC 9V99.
           03  WK-SEIKYUGK             PIC 9(10).
           03  WK-NYUKFTNRATE          PIC 9(03).
           03  WK-NYUSKJJYOGAK         PIC 9(06).
           03  WK-NYUSKJJYOGAK2        PIC 9(09).
           03  WK-TOKUTEI-COMPFTN      PIC 9(08).
           03  WK-TOKUTEI-COMPFTN2     PIC 9(08).
           03  WK-TOKUTEI-COMPFTN3     PIC 9(08).
           03  WK-HANGAKU-COMPFTN      PIC 9(07).
           03  WK-HANGAKU-ENTANI       PIC 9(07)V9(01).
           03  WK-GENMEN-KEISAN        PIC 9(07).
           03  WK-GENMEN-KEISAN2       PIC 9(07).
           03  WK-GENMEN-KEISAN3       PIC 9(07).
           03  WK-JIHIGAKU             PIC 9(10).
           03  WK-JIHIGAKU2            PIC 9(10).
           03  WK-JIHIGAKU3            PIC 9(10).
           03  WK-JIHIFTN              PIC 9V99.
           03  WK-ZAN-JIRITU           PIC 9(08).
           03  WK-KOH-GENDOGAKU        PIC 9(07).
           03  WK-GEN70-GENDOGAKU      PIC 9(07).
           03  WK-GEN70-GENDOGAKU2     PIC 9(07).
           03  WK-SKYMONEY-ZEI         PIC 9(07).
           03  WK-RSIETC-ZEITAISYO     PIC 9(07).
           03  WK-SKJ-ZEITAISYO        PIC 9(07).
           03  WK-KEISAN-JIBAI         PIC 9(07).
           03  WK-SKJ-ZEI              PIC 9(07).
           03  WK-SKJ-ZEIKEI           PIC 9(07).
           03  WK-SKJ-ZEIKEI2          PIC 9(07).
           03  WK-SKJ-ZEIKEIL          PIC 9(07).
           03  WK-SKJ-ZEIKEI2L         PIC 9(07).
           03  WK-GENBUTU-KOH1COMPFTN  PIC 9(07).
           03  WK-GENBUTU-KOH2COMPFTN  PIC 9(07).
           03  WK-GENBUTU-KOH3COMPFTN  PIC 9(07).
           03  WK-GENBUTU-KOH4COMPFTN  PIC 9(07).
           03  WK-GENBUTU-HKNKIN       PIC 9(10).
           03  WK-GENBUTU-HKNKIN2      PIC 9(10).
           03  WK-GENBUTU-HKNKIN3      PIC 9(10).
           03  WK-SEIHO-GENDO          PIC 9(07).
           03  WK-SEIHO-GENDO70        PIC 9(07).
           03  WK-CYOKI-GENDO          PIC 9(07).
           03  WK-CYOKI-GENDO2         PIC 9(07).
       01  FLG-AREA.
           03  FLG-SYUNOU              PIC 9(01).
           03  FLG-HKNNUM              PIC 9(01).
           03  FLG-HKNCOMBI            PIC 9(01).
           03  FLG-SYSKANRI            PIC 9(01).
           03  FLG-PTINF               PIC 9(01).
           03  FLG-PTKOHINF            PIC 9(01).
           03  FLG-PTHKNINF            PIC 9(01).
           03  FLG-NYUINACCT           PIC 9(01).
           03  FLG-SRYACCT             PIC 9(01).
           03  FLG-TENSU               PIC 9(01).
           03  FLG-NYUGAI              PIC 9(01).
           03  FLG-GENMEN              PIC 9(01).
           03  FLG-SANSHOU2            PIC X(01).
           03  FLG-SANSHOU3            PIC X(01).
           03  FLG-SANTEI1             PIC X(01).
           03  FLG-SANTEI2             PIC X(01).
           03  FLG-SANTEI3             PIC X(01).
           03  FLG-SANTEI4             PIC X(01).
           03  FLG-NG                  PIC X(01).
           03  FLG-HIKAKU              PIC 9(01).
           03  FLG-HIKAKU-SKJ          PIC 9(01).
           03  FLG-KUMAMOTO            PIC X(01).
           03  FLG-TAIGAI              PIC X(01).
           03  FLG-HIKOTEI             PIC 9(01).
           03  FLG-TUKIHIKAKU          PIC 9(01).
           03  FLG-SEISINJYO           PIC 9(01).
           03  FLG-TOKUREI-HKNJYA      PIC 9(01).
           03  FLG-MIYAGI              PIC 9(01).
           03  FLG-NYUSKJJYOGAK        PIC 9(01).
           03  FLG-KEIKASOCHI-IPAN     PIC 9(01).
           03  FLG-SEIKATU             PIC 9(01).
           03  FLG-SEIKATUS            PIC 9(01).
           03  FLG-SEIKATUL            PIC 9(01).
           03  FLG-ROJIN41             PIC 9(01).
           03  FLG-TOKYO               PIC 9(01).
           03  FLG-GEN70-TOKUSYU       PIC 9(01).
           03  FLG-KOHININBARAI        PIC 9(01).
           03  FLG-KOHYONKAIME         PIC 9(01).
           03  FLG-GENBUTU70           PIC 9(01).
           03  FLG-SYUKEI              PIC 9(01).
           03  FLG-SYUKEI2             PIC 9(01).
           03  FLG-GENBUTU-TAISYODATA  PIC 9(01).
           03  FLG-GENBUTU-TAISYOOK    PIC 9(01).
           03  FLG-KENPOJYUNKYO        PIC 9(01).
           03  FLG-SYUGAKUMAE          PIC 9(01).
           03  FLG-TAISYO              PIC 9(01).
           03  FLG-ZENKI-TOKUREI       PIC 9(01).
      *
       01  WRK-AREA.
           03  WK-PAYKBN               PIC X(02).
           03  WK-1001-JIHIPOSITION    PIC X(01).
           03  WK-1001-CHIHOUNUMKBN    PIC X(01).
           03  WK-1001-GENTAIKBN       PIC X(01).
      *
           03  WK-NYUJGNKBN            PIC X(01).
           03  WK-NYUJGNGAK            PIC 9(07).
      *
           03  WK-DAYTAIHI-FTNMONEY    PIC 9(07).
           03  WK-DAYTAIHI-COMPFTN     PIC 9(07).
           03  WK-DAYTAIHI-COMPFTNWK   PIC 9(07).
      *
      *    保険区分（空白：医保、１：労災自賠、２：公害）
           03  WK-HKNKBN               PIC X(01).
      *
      *    患者負担計算時の四捨五入用ワーク
           03  WK-FTN                  PIC 9(10).
      *
      *    病院割引額計算時の割引率用ワーク
           03  WK-RATE                 PIC 9(1)V9(2).
      *
      *    請求額金額端数区分（減免有り）
           03  WK-HASU1001-KBN         PIC X(1).
      *    請求額金額端数区分（減免無し）
           03  WK-HASU1001-KBN2        PIC X(1).
      *
      *    消費税端数区分
           03  WK-TAX1001-KBN          PIC X(1).
      *
      *    県番号
           03  WK-1001-PREFNUM         PIC 9(2).
      *
           03  WK-TAIHI-RECEFTNDSPKBN-OCC.
               05  WK-TAIHI-RECEFTNDSPKBN
                                       PIC X(1)    OCCURS   4.
      *    福岡県地方公費負担区分・主保険の負担割合
           03  WK-KOH-FTNKBN           PIC X(1).
           03  WK-KOH-FTNRATE          PIC 9(3).
      *
           03  WK-TAIHI-NYUJGNGAK-OCC.
               05  WK-TAIHI-NYUJGNGAK  PIC 9(7)    OCCURS   4.
      *
           03  WK-TAIHI-KANSEN11-OCC.
               05  WK-TAIHI-KANSEN11   PIC 9(1)    OCCURS   4.
      *
           03  WK-TAIHI-SDAY-COMPFTN   PIC 9(7).
           03  WK-TAIHI-SDAY-COMPFTNWK PIC 9(7).
           03  WK-TAIHI-SDAY-FTNMONEY  PIC 9(7).
      *
      *****労災・自賠責
      *    自賠責（加算率）
           03  WK-4001-KSNRATE         PIC 9(2).
           03  WK-4001-KSNRATE1        PIC 9(3).
      *    自賠責文書料消費税
           03  WK-4001-TAXKBN          PIC X(1).
      *    点数単価区分
           03  WK-4001-TENKBN          PIC X(1).
      *    自賠責食事療養費区分
           03  WK-4001-SKJKBN          PIC X(1).
      *    自賠責特定器材等消費税
           03  WK-4001-TAXKBN-KZI      PIC X(1).
      *    技術点単価
           03  WK-4001-SYUTENTANKA     PIC 9(2).
      *    薬剤等点単価
           03  WK-4001-YKZTENTANKA     PIC 9(2).
      *    公務災害点単価
           03  WK-4001-KOMUTENTANKA    PIC 9(2).
      *
      *    自賠責特定器材等消費税対象外コード
           03  WK-4003-TAIGAI.
               05  WK-4003-TAIGAI-OCC      OCCURS  50.
                 06  WK-4003-TAIGAI-SRYCD  PIC  X(09).
      *
      *    自賠責その他コード（０９５９１．９２．９３）の診療行為コード等
           03  WK-SONOTA91.
               05  WK-SONOTA91-OCC         OCCURS  50.
                 06  WK-SONOTA91-SRYCD     PIC  X(09).
                 06  WK-SONOTA91-ZAIKAISU  PIC  9(07).
                 06  WK-SONOTA91-TANKA     PIC  9(07).
           03  WK-SONOTA92.
               05  WK-SONOTA92-OCC         OCCURS  50.
                 06  WK-SONOTA92-SRYCD     PIC  X(09).
                 06  WK-SONOTA92-ZAIKAISU  PIC  9(07).
                 06  WK-SONOTA92-TANKA     PIC  9(07).
           03  WK-SONOTA93.
               05  WK-SONOTA93-OCC         OCCURS  50.
                 06  WK-SONOTA93-SRYCD     PIC  X(09).
                 06  WK-SONOTA93-ZAIKAISU  PIC  9(07).
                 06  WK-SONOTA93-TANKA     PIC  9(07).
      *
           03  WK-ZAN-KOHI-D           PIC 9(05).
           03  WK-DAY-NYUKFTNRATE      PIC 9(03).
           03  WK-DAY-COMPFTN          PIC 9(05).
           03  WK-RYOYO                PIC 9(07).
           03  WK-KSNRATE9             PIC 9(03).
           03  WK-KSNRATE              PIC 9V99. 
           03  WK-BRMSGK-TAXKBN        PIC X(01).
           03  WK-KEISAN-XX            PIC 9(09).
           03  WK-KEISAN               PIC 9(09).
           03  WK-KEISAN1              PIC 9(09).
           03  WK-KEISAN2              PIC 9(09).
           03  WK-KEISAN3              PIC 9(09).
           03  WK-KEISAN4              PIC 9(09).
           03  WK-KEISAN9              PIC 9(09).
           03  WK-KEISAN-SKJ           PIC 9(09).
           03  WK-KEISAN1-SKJ          PIC 9(09).
           03  WK-KEISAN2-SKJ          PIC 9(09).
           03  WK-KEISAN3-SKJ          PIC 9(09).
           03  WK-KEISAN4-SKJ          PIC 9(09).
           03  WK-KEISAN9-SKJ          PIC 9(09).
           03  WK-KEISAN-ENTANI        PIC 9(08)V9(01).
           03  WK-KEISAN1-ENTANI       PIC 9(08)V9(01).
           03  WK-KEISAN2-ENTANI       PIC 9(08)V9(01).
           03  WK-KEISAN3-ENTANI       PIC 9(08)V9(01).
           03  WK-KEISAN4-ENTANI       PIC 9(08)V9(01).
           03  WK-KEISAN9-ENTANI       PIC 9(08)V9(01).
      *
      *    特殊計算用
           03  WK-TOKUSYU-COMPFTN      PIC 9(07).
           03  WK-TOKUSYU-COMPFTN2     PIC 9(07).
           03  WK-TOKUSYU-ENTANI       PIC 9(07)V9(01).
           03  WK-TOKUSYU              PIC 9(07).
           03  WK-TOKUSYU2             PIC 9(07).
           03  WK-TAIHI-TOKU1          PIC 9(07)V9(01).
           03  WK-TAIHI-TOKU2          PIC 9(07).
      *
           03  WK-JIRITU-TBL.
               05  WK-JIRITU-OCC           OCCURS   4.
                 06  WK-JIRITU-CYUKANSOU   PIC  9(01).
                 06  WK-JIRITU-TAFTNRUIKEI PIC  9(07).
                 06  WK-JIRITU-SKJGENMEN   PIC  9(01).
      *
                 06  WK-CHIHOU-TAFTNRUIKEI PIC  9(07).
                 06  WK-KANEN-TAFTNRUIKEI  PIC  9(07).
      *
           03  WK-SYOGAI-TBL.
               05  WK-SYOGAI-OCC           OCCURS   4.
                 06  WK-SYOGAI-SKJGAK      PIC  9(07).
                 06  WK-SYOGAI-SKJGENMEN   PIC  9(01).
      *
           03  WK-SYOFUKUMU-TBL.
               05  WK-SYOFUKUMU-OCC        OCCURS   4.
                 06  WK-SYOFUKUMU-GENDOGAK PIC  9(07).
                 06  WK-SYOFUKUMU-FLG      PIC  9(01).
      *
           03  WK-JIRITU-SRYYMD            PIC  X(08).
      *
           03  WK-OITA-HKNFTNMONEY         PIC  9(07).
           03  WK-OITA-CYOFTN              PIC  9(07).
           03  WK-OITA-CYOFTN-KON          PIC  9(07).
           03  WK-OITA-KEISAN              PIC  9(07).
           03  WK-OITA-KEISAN2             PIC  9(07).
      *
           03  WK-GENGAKUKBN               PIC  9(01).
           03  WK-GENGAKU-KOHID            PIC  9(10).
           03  WK-GENGAKU-RITU             PIC  9(03).
           03  WK-GENGAKU-RITUX            PIC  9(03).
           03  WK-GENGAKU-KIN              PIC  9(07).
           03  WK-GENGAKU-GAK              PIC  9(07).
           03  WK-GENGAKU-GAK-ENTANI       PIC  9(07)V9(01).
      *
           03  WK-KOHININBARAI-KOHID       PIC  9(10).
      *
           03  WK-HKNJANUM-TBL.
               05  WK-HKNJANUM             PIC  X(08).
               05  WK-HONKZKKBN            PIC  X(01).
               05  WK-KIGO                 PIC  X(80).
               05  WK-NUM                  PIC  X(80).
           03  WK-HKNJANUM2-TBL.
               05  WK-HKNJANUM2            PIC  X(08).
               05  WK-HONKZKKBN2           PIC  X(01).
               05  WK-KIGO2                PIC  X(80).
               05  WK-NUM2                 PIC  X(80).
      *
           03  WK-SYOTOKU-SKJKBN-TBL.
               05  WK-SYOTOKU-SKJKBN       PIC  X(01)  OCCURS  31.
      *
           03  WK-GENTAI-SKYMONEY          PIC  9(07).
           03  WK-GENTAI-SKYMONEY2         PIC  9(07).
           03  WK-GENTAI-SKYMONEY3         PIC  9(07).
      *
           03  WK-DOTANDOKU-TBL.
               05  WK-DOTANDOKU-OCC        OCCURS   4.
                 06  WK-DOTANDOKU          PIC  9(01).
                 06  WK-DOTANDOKUFLG       PIC  9(01).
      *
           03  WK-KOHNUM                   PIC  X(03).
      *
           03  WK-TOTORI-JIRITU            PIC  9(01).
      *
           03  WK-ZENKI-TOKUREI-MONEY      PIC  9(07).
      *
      *    公費の患者負担上限金額の退避用エリア
       01  HOKEN-MAX-AREA.
           03  MAX-KAI-KOHI1-M         PIC 9(05).
           03  MAX-KAI-KOHI2-M         PIC 9(05).
           03  MAX-KAI-KOHI3-M         PIC 9(05).
           03  MAX-KAI-KOHI4-M         PIC 9(05).
           03  MAX-KIN-KOHI1-D         PIC 9(08).
           03  MAX-KIN-KOHI2-D         PIC 9(08).
           03  MAX-KIN-KOHI3-D         PIC 9(08).
           03  MAX-KIN-KOHI4-D         PIC 9(08).
           03  MAX-KIN-KOHI1-M         PIC 9(08).
           03  MAX-KIN-KOHI2-M         PIC 9(08).
           03  MAX-KIN-KOHI3-M         PIC 9(08).
           03  MAX-KIN-KOHI4-M         PIC 9(08).
      *
      *    公費の使用回数カウント用エリア（日単位）
       01  HOKEN-KAISU-TABLE.
           03  HOKEN-KAISU-TABLE1.
             04 HOKEN-KAISU-TBL        OCCURS  32.
               05  KOHI1-TBL           PIC 9(02).
               05  KOHI2-TBL           PIC 9(02).
               05  KOHI3-TBL           PIC 9(02).
               05  KOHI4-TBL           PIC 9(02).
           03  HOKEN-KAISU-TBL-R   REDEFINES   HOKEN-KAISU-TABLE1
                                       OCCURS  32.
               05  KOHI-TBL            PIC 9(02)   OCCURS   4.
      *
      *    公費の患者負担済み金額の加算用エリア
       01  HOKEN-FUTAN-AREA.
           03  FTN-KOHI1-D             PIC 9(05)   OCCURS  31.
           03  FTN-KOHI2-D             PIC 9(05)   OCCURS  31.
           03  FTN-KOHI3-D             PIC 9(05)   OCCURS  31.
           03  FTN-KOHI4-D             PIC 9(05)   OCCURS  31.
           03  FTN-KOHI1-M             PIC 9(08).
           03  FTN-KOHI2-M             PIC 9(08).
           03  FTN-KOHI3-M             PIC 9(08).
           03  FTN-KOHI4-M             PIC 9(08).
           03  FTN-KOHI1-M-JI          PIC 9(08).
           03  FTN-KOHI2-M-JI          PIC 9(08).
           03  FTN-KOHI3-M-JI          PIC 9(08).
           03  FTN-KOHI4-M-JI          PIC 9(08).
           03  FTN-CYOKI-M-JI          PIC 9(08).
      *
      *    公費のレセプト負担区分四捨五入しない場合,
      *    レセ記載金額の加算用エリア
       01  HOKEN-FUTAN-AREA2.                                           
           03  FTN-KOHI1-D2            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI2-D2            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI3-D2            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI4-D2            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI1-M2            PIC 9(08).                       
           03  FTN-KOHI2-M2            PIC 9(08).                       
           03  FTN-KOHI3-M2            PIC 9(08).                       
           03  FTN-KOHI4-M2            PIC 9(08).                       
           03  FTN-KOHI1-M2-JI         PIC 9(08).                       
           03  FTN-KOHI2-M2-JI         PIC 9(08).                       
           03  FTN-KOHI3-M2-JI         PIC 9(08).                       
           03  FTN-KOHI4-M2-JI         PIC 9(08).   
           03  FTN-CYOKI-M2-JI         PIC 9(08).
      *
      *    公費の負担金額円単位用                                       
       01  HOKEN-FUTAN-AREA3.
           03  FTN-KOHI1-D3            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI2-D3            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI3-D3            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI4-D3            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI1-M3            PIC 9(08).
           03  FTN-KOHI2-M3            PIC 9(08).
           03  FTN-KOHI3-M3            PIC 9(08).
           03  FTN-KOHI4-M3            PIC 9(08).
           03  FTN-KOHI1-M3-JI         PIC 9(08).                 
           03  FTN-KOHI2-M3-JI         PIC 9(08).                 
           03  FTN-KOHI3-M3-JI         PIC 9(08).                 
           03  FTN-KOHI4-M3-JI         PIC 9(08).                 
           03  FTN-CYOKI-M3-JI         PIC 9(08).
      *
      *    公費の食事負担金額（０２４・０７９）
       01  HOKEN-SKJFUTAN-AREA.
           03  FTN-KOHI1-SKJ           PIC 9(08).
           03  FTN-KOHI2-SKJ           PIC 9(08).
           03  FTN-KOHI3-SKJ           PIC 9(08).
           03  FTN-KOHI4-SKJ           PIC 9(08).
      *
      *    公費の患者負担可能な残額算定用エリア
       01  HOKEN-ZAN-AREA.
           03  ZAN-KOHI1-M             PIC 9(08).
           03  ZAN-KOHI2-M             PIC 9(08).
           03  ZAN-KOHI3-M             PIC 9(08).
           03  ZAN-KOHI4-M             PIC 9(08).
           03  ZAN-KOHI-AREA.
             05  ZAN-KOHI1             PIC 9(08).
             05  ZAN-KOHI2             PIC 9(08).
             05  ZAN-KOHI3             PIC 9(08).
             05  ZAN-KOHI4             PIC 9(08).
           03  ZAN-KOHI-TBL  REDEFINES  ZAN-KOHI-AREA
                                        OCCURS  4.
             05  ZAN-KOHI-T            PIC 9(08).
      *
      *    公費の患者負担可能な残額算定用エリア（日単位）
       01  HOKEN-ZAN-D-AREA.
           03  HOKEN-ZAN-D-TABLE1.
             04  HOKEN-ZAN-D-TBL       OCCURS  31.
               05  ZAN-KOHI1-D         PIC 9(05).
               05  ZAN-KOHI2-D         PIC 9(05).
               05  ZAN-KOHI3-D         PIC 9(05).
               05  ZAN-KOHI4-D         PIC 9(05).
           03  HOKEN-ZAN-D-TBL-R   REDEFINES   HOKEN-ZAN-D-TABLE1
                                       OCCURS  31.
               05  ZAN-KOHI-D          PIC 9(05)   OCCURS   4.
      *
      *    公費のレセプト負担区分四捨五入しない場合,
      *    レセ記載可能な残額算定用エリア
       01  HOKEN-ZAN-AREA2.                                             
           03  ZAN-KOHI1-M2            PIC 9(08).                       
           03  ZAN-KOHI2-M2            PIC 9(08).                       
           03  ZAN-KOHI3-M2            PIC 9(08).                       
           03  ZAN-KOHI4-M2            PIC 9(08).                       
           03  ZAN-KOHI-AREA2.                                          
             05  ZAN-KOHI12            PIC 9(08).                       
             05  ZAN-KOHI22            PIC 9(08).                       
             05  ZAN-KOHI32            PIC 9(08).                       
             05  ZAN-KOHI42            PIC 9(08).                       
           03  ZAN-KOHI-TBL2 REDEFINES  ZAN-KOHI-AREA2                  
                                        OCCURS  4.                      
             05  ZAN-KOHI-T2           PIC 9(08).                       
      *
      *    公費のレセプト負担区分四捨五入しない場合,
      *    レセ記載可能な残額算定用エリア（日単位）
       01  HOKEN-ZAN-D2-AREA.
           03  HOKEN-ZAN-D2-TABLE1.
             04  HOKEN-ZAN-D2-TBL       OCCURS  31.
               05  ZAN-KOHI1-D2         PIC 9(05).
               05  ZAN-KOHI2-D2         PIC 9(05).
               05  ZAN-KOHI3-D2         PIC 9(05).
               05  ZAN-KOHI4-D2         PIC 9(05).
           03  HOKEN-ZAN-D2-TBL-R   REDEFINES   HOKEN-ZAN-D2-TABLE1
                                        OCCURS  31.
               05  ZAN-KOHI-D2          PIC 9(05)   OCCURS   4.
      *
      *    公費の負担金額円単位用                                       
       01  HOKEN-ZAN-AREA3.
           03  ZAN-KOHI1-M3            PIC 9(08).
           03  ZAN-KOHI2-M3            PIC 9(08).
           03  ZAN-KOHI3-M3            PIC 9(08).
           03  ZAN-KOHI4-M3            PIC 9(08).
           03  ZAN-KOHI-AREA3.
             05  ZAN-KOHI13            PIC 9(08).
             05  ZAN-KOHI23            PIC 9(08).
             05  ZAN-KOHI33            PIC 9(08).
             05  ZAN-KOHI43            PIC 9(08).
           03  ZAN-KOHI-TBL3 REDEFINES  ZAN-KOHI-AREA3
                                        OCCURS  4.
             05  ZAN-KOHI-T3           PIC 9(08).
      *
      *    公費の負担金額円単位用                                       
      *    （日単位）
       01  HOKEN-ZAN-D3-AREA.
           03  HOKEN-ZAN-D3-TABLE1.
             04  HOKEN-ZAN-D3-TBL       OCCURS  31.
               05  ZAN-KOHI1-D3         PIC 9(05).
               05  ZAN-KOHI2-D3         PIC 9(05).
               05  ZAN-KOHI3-D3         PIC 9(05).
               05  ZAN-KOHI4-D3         PIC 9(05).
           03  HOKEN-ZAN-D3-TBL-R   REDEFINES   HOKEN-ZAN-D3-TABLE1
                                        OCCURS  31.
               05  ZAN-KOHI-D3          PIC 9(05)   OCCURS   4.
      *
      *    公費の食事負担残金額（０２４・０７９）
       01  HOKEN-SKJZAN-AREA.
           03  ZAN-SKJ-AREA.
             05  ZAN-KOHI1-SKJ           PIC 9(08).
             05  ZAN-KOHI2-SKJ           PIC 9(08).
             05  ZAN-KOHI3-SKJ           PIC 9(08).
             05  ZAN-KOHI4-SKJ           PIC 9(08).
           03  ZAN-SKJ-TBL  REDEFINES  ZAN-SKJ-AREA
                                         OCCURS  4.
             05  ZAN-KOHI-SKJ            PIC 9(08).
      *
      *    公費のレセプト負担区分四捨五入しない場合,
      *    レセ記載金額退避用エリア
       01  WK-KOH-COMPFTN-AREA.                                         
           03  WK-KOH-COMPFTN          PIC 9(07)                        
                                        OCCURS  4.                      
      *
      *    日単位の食事負担金額退避用エリア
       01  WK-DAY-SKJFTN-AREA.
           03  WK-DAY-SKJFTN-OCC        OCCURS  31.
               05  WK-DAY-SKJFTN        PIC 9(05).
               05  WK-DAY-SKJFTNS       PIC 9(05).
               05  WK-DAY-SKJFTNL       PIC 9(05).
               05  WK-DAY-KAISU         PIC 9(04).
               05  WK-DAY-KAISUS        PIC 9(04).
               05  WK-DAY-KAISUL        PIC 9(04).
      *
      *    公費の日単位算定フラグ
       01  WK-DAYINFFLG-AREA.
           03  WK-DAYINFFLG            PIC 9(01)
                                        OCCURS  4.
      *
      *    公費のレセプト負担区分四捨五入しない場合,
      *    レセ記載金額退避用エリア（日単位）
       01  WK-DAY-KOH-COMPFTN-AREA.
           03  WK-DAY-KOH-COMPFTN      PIC 9(07)
                                        OCCURS  4.
      *
      *    患者年齢算出用エリア
       01  WRK-NENREI-AREA.
           03  WRK-NENREI              PIC 9(03).
           03  WRK-YMDS1.
               05  WRK-YYS1            PIC 9(04).
               05  WRK-MMS1            PIC 9(02).
               05  WRK-DDS1            PIC 9(02).
           03  WRK-YMDS2.
               05  WRK-YYS2            PIC 9(04).
               05  WRK-MMS2            PIC 9(02).
               05  WRK-DDS2            PIC 9(02).
      *
      *    添え字領域
       01  IDX-AREA.
           03  IDX                     PIC  9(02)  VALUE  ZERO.
           03  IDX2                    PIC  9(02)  VALUE  ZERO.
           03  IDX3                    PIC  9(02).
           03  IDX4                    PIC  9(03).
           03  IDX5                    PIC  9(03).
           03  IDX6                    PIC  9(03).
           03  IDX7                    PIC  9(03).
           03  IDX8                    PIC  9(03).
           03  IDX9                    PIC  9(03).
           03  IDX-ST                  PIC  9(02)  VALUE  ZERO.
           03  IDX-ED                  PIC  9(02)  VALUE  ZERO.
           03  IDY                     PIC  9(02)  VALUE  ZERO.
           03  IDZ                     PIC  9(02)  VALUE  ZERO.
           03  HKNNYU-IDX              PIC  9(02)  VALUE  ZERO.
           03  KOH-IDX                 PIC  9(02)  VALUE  ZERO.
           03  KOH-IDX2                PIC  9(02)  VALUE  ZERO.
           03  KOH-IDX3                PIC  9(02)  VALUE  ZERO.
           03  KIRIKAE-IDX             PIC  9(02).
           03  NYULIFE-IDX             PIC  9(02).
           03  GEN-IDX                 PIC  9(02).
           03  SYOTOKU-IDX             PIC  9(02).
      *
      *    高齢者の負担上限算定エリア
       01  WK-SYUHKN-TAIHI-AREA.
           03  MAX-KIN-SYU-M           PIC 9(08).
           03  FTN-SYU-M               PIC 9(08).
           03  ZAN-SYU-M               PIC 9(08).
           03  FLG-SANTEI-SYU          PIC X(01).
           03  FLG-KOUREI              PIC 9(01).
           03  FLG-IRYOHI              PIC 9(01).
           03  FLG-IRYOHI2             PIC 9(01).
           03  FLG-IRYOHI3             PIC 9(01).
           03  FLG-IRYOHI3X            PIC 9(02).
           03  FLG-IRYOHI4             PIC 9(01).
           03  FLG-IRYOHI5             PIC 9(02).
           03  FLG-IRYOHI70            PIC 9(02).
           03  FLG-IRYOHI70K           PIC 9(02).
           03  FLG-KOUGAKUCYO          PIC 9(01).
           03  FLG-KOUGAKUCYO2         PIC 9(01).
           03  FLG-KOUGAKUCYO3         PIC 9(01).
           03  FLG-KOUGAKUCYO5         PIC 9(01).
           03  FLG-KOUGAKUCYO-JIRITU   PIC 9(01).
           03  FLG-KOUGAKUCYO-ININ     PIC 9(01).
           03  FLG-KOUGAKUCYO-GEN70    PIC 9(01).
           03  FLG-KOUGAKUCYO-GEN70K   PIC 9(01).
           03  FLG-KOUGAKUCYO-OITA     PIC 9(01).
           03  FLG-KANSEN11            PIC 9(01).
           03  WK-SYU-SYUCOMPFTN       PIC 9(08).
           03  WK-KOUREI-IRYOHI        PIC 9(08).
           03  WK-KOUREI-IRYOHI2       PIC 9(08).
           03  WK-KOUREI-IRYOHI3       PIC 9(08).
           03  WK-KOUREI-IRYOHI4       PIC 9(08).
           03  WK-KOUREI-IRYOHI70      PIC 9(08).
           03  WK-KOUREI-IRYOHI70K     PIC 9(08).
           03  WK-KOUREI-IRYOHI70X     PIC 9(08).
      *
           03  FTN-KOHI1-M-ENTANI      PIC 9(08).                       
           03  ZAN-KOHI1-ENTANI        PIC 9(08).                       
           03  FTN-SYU-M-ENTANI        PIC 9(08).                       
           03  ZAN-SYU-M-ENTANI        PIC 9(08).                       
           03  FLG-SANTEI1-ENTANI      PIC X(01).                       
           03  FLG-SANTEI-SYU-ENTANI   PIC X(01).                       
      *
           03  FLG-ROUJINHOKEN         PIC X(01).
      *
      *    食事負担算定エリア
       01  WK-SHOKUJI-TAIHI-AREA.
           03  WK-SHOKUJIRYOYO-OCC.
               05  WK-SHOKUJIRYOYO     PIC 9(01)  OCCURS 31.
           03  WK-TOKUKANRIKASAN-OCC.
               05  WK-TOKUKANRIKASAN   PIC 9(01)  OCCURS 31.
           03  WK-SHOKUJI-KINGAKU-OCC.
               05  WK-SHOKUJI-KINGAKU      PIC 9(07)  OCCURS  7.
           03  WK-SHOKUJI-HYOJYUNFTN-OCC.
               05  WK-SHOKUJI-HYOJYUNFTN   PIC 9(07)  OCCURS  4.
           03  WK-SHOKUJI-NISSU        PIC 9(02).
           03  WK-SHOKUJI-NISSUS       PIC 9(02).
           03  WK-SHOKUJI-NISSUL       PIC 9(02).
           03  WK-SHOKUJI-RYOYOHI      PIC 9(07).
           03  WK-SHOKUJI-RYOYOHIS     PIC 9(07).
           03  WK-SHOKUJI-RYOYOHIL     PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI95    PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI96    PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI95L   PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI96L   PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI-KOGAI
                                       PIC 9(07).
           03  WK-SHOKUJI-JIHI         PIC 9(07).
           03  WK-SHOKUJI-FTN          PIC 9(07).
           03  WK-SHOKUJI-FTNS         PIC 9(07).
           03  WK-SHOKUJI-FTNL         PIC 9(07).
           03  WK-SHOKUJI-FTN95        PIC 9(07).
           03  WK-SHOKUJI-FTN96        PIC 9(07).
           03  WK-SHOKUJI-FTN95L       PIC 9(07).
           03  WK-SHOKUJI-FTN96L       PIC 9(07).
           03  WK-NYUSKJRYYKBN         PIC X(01).
           03  WK-NYUSKJRYYKBN-TOKU-OCC.
               05  WK-NYUSKJRYYKBN-TOKU    PIC X(01)  OCCURS  4.
           03  WK-KNJFTNKIN-SKJ        PIC 9(07).
           03  WK-KNJFTNKIN-SKJ-KEISAN PIC 9(07).
           03  WK-KNJFTNKIN-SKJS       PIC 9(07).
           03  WK-KNJFTNKIN-SKJL       PIC 9(07).
           03  WK-SRYCD                PIC X(09).
      *
           03  WK-SHOKUJI-KAIKEI       OCCURS   31.
               05  WK-SHOKUDOKASAN     PIC 9(04).
               05  WK-SHOKUJI-ASA      PIC 9(04).
               05  WK-SHOKUJI-HIRU     PIC 9(04).
               05  WK-SHOKUJI-YORU     PIC 9(04).
               05  WK-GAIHAKU          PIC 9(04).
      *
               05  WK-SHOKUJI-NYUINJI  PIC 9(04).
               05  WK-SHOKUJI-TOKUSYO  PIC 9(04).
      *
               05  WK-ROSAITOKU95      PIC 9(04).
               05  WK-ROSAITOKU96      PIC 9(04).
               05  WK-ROSAITOKU97      PIC 9(04).
      *
               05  WK-SHOKUJI-KANFLG   PIC 9(01).
      *
           03  WK-NYULIFE-AREA         OCCURS   31.
               05  WK-NYULIFE-KBN           PIC  X(01).
               05  WK-NYULIFE-SKJ-MONEY     PIC  9(07).
               05  WK-NYULIFE-KAN-MONEY     PIC  9(07).
               05  WK-NYULIFE-SKJFTN-MONEY  PIC  9(07).
               05  WK-NYULIFE-KANFTN-MONEY  PIC  9(07).
      *
      *地方公費用フラグ（公費限度額決定用）
       01  WK-CHIHOU-FLG-TAIHI-AREA.
           03  FLG-CHIHOU              PIC X(01)  OCCURS  4.
      *
      *償還払い地方公費フラグ
       01  WK-SYOUKAN-FLG-TAIHI-AREA.
           03  FLG-SYOUKAN             PIC X(01)  OCCURS  4.
      *
      *    減額・免除・支払猶予判定用テーブル
       01  TBL-GENGAKU-AREA.
           03  FILLER          PIC X(03)   VALUE    "960".
           03  FILLER          PIC X(03)   VALUE    "961".
           03  FILLER          PIC X(03)   VALUE    "962".
           03  FILLER          PIC X(03)   VALUE    "963".
      *
       01  TBL-GENGAKU-R       REDEFINES   TBL-GENGAKU-AREA.
           03  TBL-GENGAKU     PIC X(03)   OCCURS    4.
      *
       01  TBL-GENGAKU-MAX     PIC 9(02)   VALUE     4.
      *
      *    ７０歳未満現物給付判定用テーブル
       01  TBL-GENBUTU70-AREA.
           03  FILLER          PIC X(03)   VALUE    "966".
           03  FILLER          PIC X(03)   VALUE    "967".
      *
       01  TBL-GENBUTU70-R     REDEFINES   TBL-GENBUTU70-AREA.
           03  TBL-GENBUTU70   PIC X(03)   OCCURS    2.
      *
       01  TBL-GENBUTU70-MAX   PIC 9(02)   VALUE     2.
      *
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    収納マスター
       01  SYU-SYUNOU-REC.
           COPY    "CPSYUNOU.INC".
      *
      *    日別収納マスタ
       01  SYU-SYUDAY-REC.
           COPY    "CPSYUDAY.INC".
      *
      *    保険組み合わせ
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *    ワーク保険組み合わせ
       01  WRK-HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC"
                               REPLACING  //COMB-// BY //WRK-COMB-//.
      *
      *    保険番号
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *    ワーク保険番号
       01  WRK-HKNNUM-REC.
           COPY    "CPHKNNUM.INC"
                               REPLACING  //HKN-// BY //WRK-HKN-//.
      *
      *    入院会計
       01  NYUINACCT-REC.
           COPY    "CPNYUINACCT.INC".
      *
      *    診療会計
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    システム管理
           COPY    "CPSK1001.INC".
           COPY    "CPSK1026.INC".
           COPY    "CPSK1027.INC".
           COPY    "CPSK1037.INC".
           COPY    "CPSK4001.INC".
           COPY    "CPSK4003.INC".
           COPY    "CPSK5000.INC".
      *
      *    患者情報
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    点数
           COPY    "CPTENSU.INC".
      *
      *    患者公費情報
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *
      *    患者保険情報
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *
      *****************************************************************
      *    サブプロ用　領域
      *****************************************************************
      *
      *    日付変換サブ
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
           COPY    "CPORCSGDAY.INC".
      *    保険算定用年齢・割合計算サブ
           COPY    "CPORCSAGECHK.INC".
      *    公費月上限額取得サブ
           COPY    "CPORCSJGNGET.INC".
      *    公費付加情報取得サブ
           COPY    "CPORCSKOHPLUS.INC".
      *    入院時生活療養費負担額取得サブ
           COPY    "CPORCSNYULIFE.INC".
      *    患者所得情報編集サブ
           COPY    "CPORCSSYOTOKU.INC".
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      ***  COPY    "CPORCMCP.INC".
      *
      /
      ***
       LINKAGE             SECTION.
           COPY  "MCPAREA". 
       01  LNK-ORCS02-REC.
           COPY  "CPORCS02.INC".
       01  LNK-SYUNOU-REC.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //LNK-SYU-//.
       01  LNK-WRK-SYUNOU-REC-T.
         02 LNK-WRK-SYUNOU-REC     OCCURS 10.
           COPY  "CPSYUNOU.INC"  
                               REPLACING  //SYU-// BY //LNK-WRK-SYU-//.
       01  LNK-SYUDAY-REC.
           COPY  "CPSYUDAY.INC"  REPLACING  //SDAY-// BY //LNK-SDAY-//.
       01  LNK-WRK-SYUDAY-REC-T.
         02 LNK-WRK-SYUDAY-REC     OCCURS 10.
           COPY  "CPSYUDAY.INC"
                             REPLACING  //SDAY-// BY //LNK-WRK-SDAY-//.
      *
           COPY  "COMMON-SPA".
      /
       PROCEDURE           DIVISION  USING
                                     MCPAREA
                                     LNK-ORCS02-REC
                                     LNK-SYUNOU-REC
                                     LNK-WRK-SYUNOU-REC-T
                                     LNK-SYUDAY-REC
                                     LNK-WRK-SYUDAY-REC-T
                                     SPA-AREA.
      ******************************************************************
      *        依頼制御処理
      ******************************************************************
       MAIN-RTN            SECTION.
       MAIN-000.
      **   MOVE    ZERO            TO  LNK-S02-RC.
           MOVE    SPACE           TO  KEISAN-AREA.
           INITIALIZE                  KEISAN-AREA.
           MOVE    SPACE           TO  WRK-AREA.
           INITIALIZE                  WRK-AREA.
           MOVE    ZERO            TO  LNK-SYU-RJN-FTN
                                       LNK-SYU-KOH-FTN
                                       LNK-SYU-KOH-FTN-ENTANI
                                       LNK-SYU-YKZ-FTN
                                       LNK-SYU-HKNTEKMONEY.
           MOVE    ZERO            TO  LNK-SYU-SYUHKNFTNMONEY
                                       LNK-SYU-SYUCOMPFTN
                                       LNK-SYU-SYUCOMPFTN-ENTANI
                                       LNK-SYU-SYUCOMPYKZFTN
                                       LNK-SYU-SYUCOMPTOTAL.
           MOVE    SPACE           TO  LNK-SYU-SYUYKZFTNKBN.
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   4
                  MOVE    ZERO     TO  LNK-SYU-KOH-HKNFTNMONEY(IDX)
                                       LNK-SYU-KOH-COMPFTN(IDX)
                                       LNK-SYU-KOH-COMPFTN-ENTANI(IDX)
                                       LNK-SYU-KOH-COMPYKZFTN(IDX)
                                       LNK-SYU-KOH-COMPTOTAL(IDX)
                  MOVE    SPACE    TO  LNK-SYU-KOH-YKZFTNKBN(IDX)
           END-PERFORM.
           MOVE    ZERO            TO  LNK-SYU-RESE-YKZ-FTN.
      *
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   10
                  MOVE    ZERO     TO  LNK-SYU-SHOKUJI(IDX)
                                       LNK-SYU-SHOKUJI-NISSU(IDX)
           END-PERFORM.              
           MOVE           ZERO     TO  LNK-SYU-SYUSKJ-NISSU
                                       LNK-SYU-SYUSKJ-RYOYOHI
                                       LNK-SYU-SYUSKJ-FTN
                                       LNK-SYU-SYUSKJ-FTN-RECE.
           MOVE           SPACE    TO  LNK-SYU-SYUSKJ-FTNKBN.
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   4
                  MOVE    ZERO     TO  LNK-SYU-SKJ-NISSU(IDX)
                                       LNK-SYU-SKJ-RYOYOHI(IDX)
                                       LNK-SYU-SKJ-FTN(IDX)
                                       LNK-SYU-SKJ-FTN-RECE(IDX)
                  MOVE    SPACE    TO  LNK-SYU-SKJ-FTNKBN(IDX)
           END-PERFORM.
           MOVE           ZERO     TO  LNK-SYU-RYOYOHI-SKJ.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-TAX.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-KEI.
           MOVE           ZERO     TO  LNK-SYU-RYOYOHI-SKJ-JIHI.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-JIHI.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-JIHI-TAX.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-JIHI-KEI.
      *
           MOVE           ZERO     TO  LNK-SYU-RYOYOHI-LIFE.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-TAX.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-KEI.
           MOVE           ZERO     TO  LNK-SYU-RYOYOHI-LIFE-JIHI.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-JIHI.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-JIHI-TAX.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-JIHI-KEI.
      *
           MOVE    ZERO            TO  LNK-SYU-TGMONEY-TAX-SAI
                                       LNK-SYU-RSI-TAX-SAI
                                       LNK-SYU-RSI-TOTAL
                                       LNK-SYU-RSIJIBAI-SKYMONEY
                                       LNK-SYU-SKYMONEY-TAX-SAI
                                       LNK-SYU-RMSAGAKU-TAX-SAI.
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   3
                  MOVE    ZERO     TO  LNK-SYU-SKJ-FTNGAKU(IDX)
                                       LNK-SYU-SKJ-FTNDAY(IDX)
           END-PERFORM.
           MOVE    SPACE           TO  LNK-SYU-DAYINFFLG.
           MOVE    SPACE           TO  LNK-SYU-DISCOUNT-KBN
                                       LNK-SYU-DISCOUNT-BODY
                                       LNK-SYU-DISCOUNT-RATEKBN
                                       LNK-SYU-DISCOUNT-TEIRITU.
           MOVE    ZERO            TO  LNK-SYU-DISCOUNT-RATE.
           MOVE    ZERO            TO  LNK-SYU-DISCOUNT-MONEY.
           MOVE    ZERO            TO  LNK-SYU-JYO-HKNFTNMONEY.
           MOVE    ZERO            TO  LNK-SYU-JYO-COMPFTN.
           MOVE    ZERO            TO  LNK-SYU-JYO-COMPFTN-ENTANI.
           MOVE    ZERO            TO  LNK-SYU-TAX-TAISHOU.
           MOVE    ZERO            TO  LNK-SYU-NYNSHOKAISU.
           MOVE    SPACE           TO  LNK-SYU-KOHTAIYKZKBN.
           MOVE    ZERO            TO  LNK-SYU-YKZKENNUM.
           MOVE    SPACE           TO  LNK-SYU-SAIKEISANKBN.
      *
           MOVE    ZERO            TO  FLG-SEISINJYO
                                       FLG-TOKUREI-HKNJYA.
      *
      *    請求金額端数区分、消費税端数区分の取り込み
           INITIALIZE                         SYS-1001-REC.
           MOVE    "1001"               TO    SYS-1001-KANRICD.
           MOVE    "*"                  TO    SYS-1001-KBNCD.
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-1001-HOSPNUM.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1001-STYUKYMD.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1001-EDYUKYMD.
           MOVE    SYS-1001-REC         TO    MCPDATA-REC.
           MOVE    "DBSELECT"           TO    MCP-FUNC.
           MOVE    "tbl_syskanri"       TO    MCP-TABLE.
           MOVE    "key10"              TO    MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =     ZERO
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key10"         TO    MCP-PATHNAME
               PERFORM   SYSKANRI-READ-SEC
               MOVE      SYS-1001-DISCOUNT-HASU-KBN  
                                        TO    WK-HASU1001-KBN
               IF   WK-HASU1001-KBN  =  SPACE
                  MOVE   "1"            TO    WK-HASU1001-KBN
               END-IF
               MOVE      SYS-1001-DISCOUNT-HASU-KBN2 
                                        TO    WK-HASU1001-KBN2
               IF   WK-HASU1001-KBN2 =  SPACE
                  MOVE   "4"            TO    WK-HASU1001-KBN2
               END-IF
               MOVE      SYS-1001-TAX-HASU-KBN       
                                        TO    WK-TAX1001-KBN
               MOVE      SYS-1001-PREFNUM
                                        TO    WK-1001-PREFNUM
               MOVE      SYS-1001-JIHIPOSITION
                                        TO    WK-1001-JIHIPOSITION
               MOVE      SYS-1001-CHIHOUNUMKBN
                                        TO    WK-1001-CHIHOUNUMKBN
               MOVE      SYS-1001-GENTAIKBN
                                        TO    WK-1001-GENTAIKBN
           END-IF.
      *
           MOVE     "tbl_syskanri"      TO    MCP-TABLE.
           MOVE     "key10"             TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    システム管理マスタ（４００１）から点数単価等の取得
           MOVE     ZERO      TO    WK-4001-KSNRATE.
           MOVE     ZERO      TO    WK-4001-KSNRATE1.
           MOVE     SPACE     TO    WK-4001-TAXKBN.
           MOVE     SPACE     TO    WK-4001-TENKBN.
           MOVE     SPACE     TO    WK-4001-SKJKBN.
           MOVE     SPACE     TO    WK-4001-TAXKBN-KZI.
           MOVE     ZERO      TO    WK-4001-SYUTENTANKA.
           MOVE     ZERO      TO    WK-4001-YKZTENTANKA.
           MOVE     ZERO      TO    WK-4001-KOMUTENTANKA.
           IF   LNK-SYU-SYUHKNNUM         =    "971" OR "973"
               INITIALIZE                         SYS-4001-REC
               MOVE    "4001"               TO    SYS-4001-KANRICD
               MOVE    "*"                  TO    SYS-4001-KBNCD
               MOVE    LNK-SYU-HOSPNUM      TO    SYS-4001-HOSPNUM
               MOVE    LNK-SYU-SRYYMD       TO    SYS-4001-STYUKYMD
               MOVE    LNK-SYU-SRYYMD       TO    SYS-4001-EDYUKYMD
               MOVE    SYS-4001-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "tbl_syskanri"       TO    MCP-TABLE
               MOVE    "key10"              TO    MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =     ZERO
                   MOVE     "tbl_syskanri"  TO    MCP-TABLE
                   MOVE     "key10"         TO    MCP-PATHNAME
                   PERFORM   SYSKANRI-READ-SEC
                   MOVE   SYS-4001-KSNRATE  TO    WK-4001-KSNRATE
                   MOVE   SYS-4001-KSNRATE1 TO    WK-4001-KSNRATE1
                   MOVE   SYS-4001-TAXKBN   TO    WK-4001-TAXKBN
                   MOVE   SYS-4001-TENKBN   TO    WK-4001-TENKBN
                   MOVE   SYS-4001-SKJKBN   TO    WK-4001-SKJKBN
                   MOVE   SYS-4001-TAXKBN-KZI
                                            TO    WK-4001-TAXKBN-KZI
                   IF     SYS-4001-SYUTENTANKA-X  =  SPACE
                        MOVE  ZERO          TO    WK-4001-SYUTENTANKA
                   ELSE
                        MOVE  SYS-4001-SYUTENTANKA
                                            TO    WK-4001-SYUTENTANKA
                   END-IF
                   IF     SYS-4001-YKZTENTANKA-X  =  SPACE
                        MOVE  ZERO          TO    WK-4001-YKZTENTANKA
                   ELSE
                        MOVE  SYS-4001-YKZTENTANKA
                                            TO    WK-4001-YKZTENTANKA
                   END-IF
                   IF     SYS-4001-KOMUTENTANKA-X =  SPACE
                        MOVE  ZERO          TO    WK-4001-KOMUTENTANKA
                   ELSE
                        MOVE  SYS-4001-KOMUTENTANKA
                                            TO    WK-4001-KOMUTENTANKA
                   END-IF
               END-IF
               MOVE     "tbl_syskanri"      TO    MCP-TABLE
               MOVE     "key10"             TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           END-IF.
      *
      *    保険組合せマスタの検索
           INITIALIZE                           HKNCOMBI-REC.
           MOVE    LNK-SYU-HOSPNUM      TO      COMB-HOSPNUM.
           MOVE    LNK-SYU-PTID         TO      COMB-PTID.
           MOVE    LNK-SYU-HKNCOMBINUM  TO      COMB-HKNCOMBINUM.
           MOVE    HKNCOMBI-REC         TO      MCPDATA-REC.
           MOVE    "DBSELECT"           TO      MCP-FUNC.
           MOVE    "tbl_hkncombi"       TO      MCP-TABLE.
           MOVE    "key"                TO      MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =       ZERO
               MOVE     "tbl_hkncombi"  TO      MCP-TABLE
               MOVE     "key"           TO      MCP-PATHNAME
               PERFORM   HKNCOMBI-READ-SEC
               IF      FLG-HKNCOMBI     =       1
                   DISPLAY "HKNCOMBI DBFETCH ERR"
                   MOVE     10             TO   LNK-S02-RC
                   MOVE    "tbl_hkncombi"  TO   MCP-TABLE
                   MOVE    "key"           TO   MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
                   GO   TO              MAIN-EXT
               END-IF
           ELSE
               MOVE    1                TO      FLG-HKNCOMBI
               DISPLAY "HKNCOMBI DBSELECT ERR"
               MOVE     10              TO      LNK-S02-RC
               MOVE    "tbl_hkncombi"   TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
               GO   TO                  MAIN-EXT
           END-IF.
           MOVE    "tbl_hkncombi"       TO      MCP-TABLE.
           MOVE    "key"                TO      MCP-PATHNAME.
           PERFORM  DB-CLOSE-SEC.
      *
      *    保険組合せマスタの参照部分確定
           PERFORM   100-KAKUTEI-SEC.
      *
      *    自費保険のデータ編集
           MOVE      ZERO    TO    WK-SKYMONEY-ZEI.
           PERFORM   104-JIHIHOKEN-DATA-HENSYU-SEC.
      *    保険組合せの上限区分編集
           PERFORM   105-JYOGENKBN-HENSYU-SEC.
      *
      *    保険組合せマスタから主保険の保険種類を判定
      *    （空白：医保、１：労災自賠、２：公害）
           MOVE     SPACE               TO       WK-HKNKBN.
           EVALUATE    COMB-SYU-HKNKOHSBTKBN
               WHEN    "4"
                       MOVE    "1"      TO       WK-HKNKBN
           END-EVALUATE.
           IF   COMB-HKNNUM  = "975"
                       MOVE    "2"      TO       WK-HKNKBN
           END-IF.
      *
      *    同日再入院計算識別用
           IF   (LNK-S02-DOJITUFLG-ST   =  "1"                )
           AND  (LNK-S02-SKYSTYMD(1:6)  =  LNK-SYU-SRYYMD(1:6))
                MOVE    "1"     TO      LNK-SYU-SAIKEISANKBN
           END-IF.
      *
      *    患者負担額の算定
           PERFORM       200-HKNFTN-SANTEI-SEC.
      *
      *    算出請求額の１０円未満四捨五入（薬剤一部負担金も含む）
      *    ※労災保険の場合は四捨五入を行わない
      *    ※老人２割で限度が７２３００円＋＠円の場合は四捨五入を行わない
           IF     (LNK-SYU-SKYMONEY      NOT =   ZERO)   
               IF  (WK-HKNKBN                =   "1" OR "2")
               OR  (FLG-KOUGAKUCYO           =    1        )
               OR  (FLG-KOUGAKUCYO2          =    1        )
               OR  (FLG-KOUGAKUCYO3          =    1        )
               OR  (FLG-KOUGAKUCYO5          =    1        )
               OR  (FLG-KOUGAKUCYO-JIRITU    =    1        )
               OR  (FLG-KOUGAKUCYO-ININ      =    1        )
               OR  (FLG-KOUGAKUCYO-GEN70     =    1        )
               OR  (FLG-KOUGAKUCYO-GEN70K    =    1        )
               OR  (FLG-KOUGAKUCYO-OITA      =    1        )
               OR  (FLG-KUMAMOTO             =   "1"       )
               OR  (COMB-SYU-HKNKOHSBTKBN    =   "8"       )
               OR  (FLG-KANSEN11             =    1        )
                   CONTINUE
               ELSE
                   COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +  5
                   COMPUTE  WK-SEIKYUGK      = LNK-SYU-SKYMONEY  /  10
                   COMPUTE  LNK-SYU-SKYMONEY = WK-SEIKYUGK       *  10
               END-IF 
           END-IF.
      *
      *    主保険・老人・公費の判別
      *      （主保険）
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)    AND
                  (LNK-SYU-KOH1HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH2HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH3HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH4HKNNUM    =       SPACE)
                   MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-HKNTEKMONEY
           END-IF.
      *       （老人） 
      *
           IF     (LNK-SYU-KOH1HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH2HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH3HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH4HKNNUM    =   SPACE)
                   CONTINUE
           ELSE
               IF      COMB-KOH1-HKNKOHSBTKBN    =       "3"
                  IF  (COMB-KOH2-HKNKOHSBTKBN    =     SPACE)  AND
                      (COMB-KOH3-HKNKOHSBTKBN    =     SPACE)  AND
                      (COMB-KOH4-HKNKOHSBTKBN    =     SPACE)
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-RJN-FTN
                  ELSE
      *            （公費）
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-KOH-FTN
                       MOVE   WK-KNJFTNKIN-ENTANI
                                          TO   LNK-SYU-KOH-FTN-ENTANI
                  END-IF
               ELSE
      *            （公費）
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-KOH-FTN
                       MOVE   WK-KNJFTNKIN-ENTANI
                                          TO   LNK-SYU-KOH-FTN-ENTANI
               END-IF
           END-IF.
      *
      *    自費金額の消費税計算
           COMPUTE   LNK-SYU-JIHI-TOTAL =  (LNK-SYU-JIHI-TAXNASI(1)  +
                                            LNK-SYU-JIHI-TAXNASI(2)  +
                                            LNK-SYU-JIHI-TAXNASI(3)  +
                                            LNK-SYU-JIHI-TAXNASI(4)  +
                                            LNK-SYU-JIHI-TAXNASI(5)  +
                                            LNK-SYU-JIHI-TAXNASI(6)  +
                                            LNK-SYU-JIHI-TAXNASI(7)  +
                                            LNK-SYU-JIHI-TAXNASI(8)  +
                                            LNK-SYU-JIHI-TAXNASI(9)  +
                                            LNK-SYU-JIHI-TAXNASI(10)).
           COMPUTE  LNK-SYU-JIHI-TOTAL-TAX = (LNK-SYU-JIHI-TAXARI(1) +
                                              LNK-SYU-JIHI-TAXARI(2) +
                                              LNK-SYU-JIHI-TAXARI(3) +
                                              LNK-SYU-JIHI-TAXARI(4) +
                                              LNK-SYU-JIHI-TAXARI(5) +
                                              LNK-SYU-JIHI-TAXARI(6) +
                                              LNK-SYU-JIHI-TAXARI(7) +
                                              LNK-SYU-JIHI-TAXARI(8) +
                                              LNK-SYU-JIHI-TAXARI(9) +
                                              LNK-SYU-JIHI-TAXARI(10)).
      *
      *    保険適用外金額の加算
           MOVE       ZERO              TO  LNK-SYU-TGMONEY(17).
           MOVE       ZERO              TO  LNK-SYU-TGMONEY-TAX(17).
           PERFORM    VARYING   HKNNYU-IDX   FROM   1   BY   1
                      UNTIL     HKNNYU-IDX   >     16
                      ADD       LNK-SYU-TGMONEY(HKNNYU-IDX)
                                            TO  LNK-SYU-TGMONEY(17)
                      ADD       LNK-SYU-TGMONEY-TAX(HKNNYU-IDX)
                                        TO  LNK-SYU-TGMONEY-TAX(17)
           END-PERFORM.
      *
           COMPUTE   WK-GENTAI-SKYMONEY  =  LNK-SYU-SKYMONEY         +
                                            LNK-SYU-SKYMONEY-SKJ-KEI +
                                            LNK-SYU-SKYMONEY-LIFE-KEI.
      *
           IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
             IF    WK-TAX1001-KBN  =  "1"
                COMPUTE LNK-SYU-JIHI-TAX =
                       (LNK-SYU-JIHI-TOTAL-TAX  * 5 / 105) + 0.5
                COMPUTE LNK-SYU-TGMONEY-TAX-SAI   =
                       (LNK-SYU-TGMONEY-TAX(17) * 5 / 105) + 0.5
                IF   WK-BRMSGK-TAXKBN    =  "1"
                  COMPUTE LNK-SYU-RMSAGAKU-TAX-SAI    =
                         (LNK-SYU-RMSAGAKU      * 5 / 105) + 0.5
                END-IF
             ELSE
                COMPUTE LNK-SYU-JIHI-TAX =
                       (LNK-SYU-JIHI-TOTAL-TAX  * 5 / 105)
                COMPUTE LNK-SYU-TGMONEY-TAX-SAI   =
                       (LNK-SYU-TGMONEY-TAX(17) * 5 / 105)
                IF   WK-BRMSGK-TAXKBN    =  "1"
                  COMPUTE LNK-SYU-RMSAGAKU-TAX-SAI    =
                         (LNK-SYU-RMSAGAKU      * 5 / 105)
                END-IF
             END-IF
      *      請求金額の計算（調整金含まず）
             COMPUTE    LNK-SYU-SKYMONEY  =
                               LNK-SYU-SKYMONEY               +
                               LNK-SYU-RMSAGAKU               +
                               LNK-SYU-SKYMONEY-SKJ-KEI       +
                               LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                               LNK-SYU-SKYMONEY-LIFE-KEI      +
                               LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                               LNK-SYU-TGMONEY(17)            +
                               LNK-SYU-TGMONEY-TAX(17)        +
                               LNK-SYU-JIHI-TOTAL             +
                               LNK-SYU-JIHI-TOTAL-TAX
             IF   WK-HKNKBN  =   "1" OR "2"
                  COMPUTE      LNK-SYU-RSIJIBAI-SKYMONEY      =
                               LNK-SYU-RSIJIBAI-SKYMONEY      +
                               LNK-SYU-RMSAGAKU               +
      *****                    LNK-SYU-SKYMONEY-SKJ-KEI       +
                               LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
      *****                    LNK-SYU-SKYMONEY-LIFE-KEI      +
                               LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                               LNK-SYU-TGMONEY(17)            +
                               LNK-SYU-TGMONEY-TAX(17)        +
                               LNK-SYU-JIHI-TOTAL             +
                               LNK-SYU-JIHI-TOTAL-TAX
             END-IF
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" ) AND
                 ( COMB-HOJOKBN           =  "1" )
                 COMPUTE  LNK-SYU-TAX-TAISHOU     =
                          LNK-SYU-HKNTEKMONEY     +
                          LNK-SYU-TGMONEY-TAX(17) +
                          LNK-SYU-JIHI-TOTAL-TAX  +
                          WK-SKJ-ZEITAISYO
             ELSE
                 COMPUTE  LNK-SYU-TAX-TAISHOU     =
                          LNK-SYU-TGMONEY-TAX(17) +
                          LNK-SYU-JIHI-TOTAL-TAX  +
                          WK-SKJ-ZEITAISYO
             END-IF
             IF   WK-BRMSGK-TAXKBN    =  "1"
                 COMPUTE  LNK-SYU-TAX-TAISHOU     =
                          LNK-SYU-TAX-TAISHOU     +
                          LNK-SYU-RMSAGAKU
             END-IF
             IF    WK-TAX1001-KBN  =  "1"
                 COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                         (LNK-SYU-TAX-TAISHOU  * 5 / 105) + 0.5
             ELSE
                 COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                         (LNK-SYU-TAX-TAISHOU  * 5 / 105)
             END-IF
      *
      ***    COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI       =
      ***             LNK-SYU-JIHI-TAX               +
      ***             LNK-SYU-TGMONEY-TAX-SAI        +
      ***             LNK-SYU-RMSAGAKU-TAX-SAI       +
      ***             LNK-SYU-SKYMONEY-SKJ-TAX       +
      ***             LNK-SYU-SKYMONEY-SKJ-JIHI-TAX  +
      ***             LNK-SYU-SKYMONEY-LIFE-TAX      +
      ***             LNK-SYU-SKYMONEY-LIFE-JIHI-TAX +
      ***             WK-SKYMONEY-ZEI
           ELSE
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" ) AND
                 ( COMB-HOJOKBN           =  "1" )
              CONTINUE
             ELSE
              IF    WK-TAX1001-KBN  =  "1"
                COMPUTE LNK-SYU-JIHI-TAX =
                       (LNK-SYU-JIHI-TOTAL-TAX  * 0.05)  +  0.5
                COMPUTE LNK-SYU-TGMONEY-TAX-SAI   =
                       (LNK-SYU-TGMONEY-TAX(17) * 0.05)  +  0.5
                COMPUTE LNK-SYU-TGMONEY-TAX(17)   = 
                       (LNK-SYU-TGMONEY-TAX(17) * 1.05)  +  0.5
                IF   WK-BRMSGK-TAXKBN    =  "1"
                  COMPUTE  LNK-SYU-RMSAGAKU-TAX-SAI  =
                          (LNK-SYU-RMSAGAKU     * 0.05)  +  0.5
                  COMPUTE  LNK-SYU-RMSAGAKU  =
                          (LNK-SYU-RMSAGAKU     * 1.05)  +  0.5
                END-IF
              ELSE
                COMPUTE LNK-SYU-JIHI-TAX =
                        LNK-SYU-JIHI-TOTAL-TAX  * 0.05
                COMPUTE LNK-SYU-TGMONEY-TAX-SAI   = 
                        LNK-SYU-TGMONEY-TAX(17) * 0.05
                COMPUTE LNK-SYU-TGMONEY-TAX(17)   = 
                        LNK-SYU-TGMONEY-TAX(17) * 1.05
                IF   WK-BRMSGK-TAXKBN    =  "1"
                  COMPUTE  LNK-SYU-RMSAGAKU-TAX-SAI  =
                           LNK-SYU-RMSAGAKU     * 0.05
                  COMPUTE  LNK-SYU-RMSAGAKU  =
                           LNK-SYU-RMSAGAKU     * 1.05
                END-IF
              END-IF
             END-IF
      *      請求金額の計算（調整金含まず）
             COMPUTE    LNK-SYU-SKYMONEY  =
                               LNK-SYU-SKYMONEY               +
                               LNK-SYU-RMSAGAKU               +
                               LNK-SYU-SKYMONEY-SKJ-KEI       +
                               LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                               LNK-SYU-SKYMONEY-LIFE-KEI      +
                               LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                               LNK-SYU-TGMONEY(17)            +
                               LNK-SYU-TGMONEY-TAX(17)        +
                               LNK-SYU-JIHI-TOTAL             +
                               LNK-SYU-JIHI-TOTAL-TAX         +
                               LNK-SYU-JIHI-TAX
             IF   WK-HKNKBN  =   "1" OR "2"
                  COMPUTE      LNK-SYU-RSIJIBAI-SKYMONEY      =
                               LNK-SYU-RSIJIBAI-SKYMONEY      +
                               LNK-SYU-RMSAGAKU               +
      *****                    LNK-SYU-SKYMONEY-SKJ-KEI       +
                               LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
      *****                    LNK-SYU-SKYMONEY-LIFE-KEI      +
                               LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                               LNK-SYU-TGMONEY(17)            +
                               LNK-SYU-TGMONEY-TAX(17)        +
                               LNK-SYU-JIHI-TOTAL             +
                               LNK-SYU-JIHI-TOTAL-TAX         +
                               LNK-SYU-JIHI-TAX
             END-IF
      *      自費保険の補助区分が課税の場合、消費税計算を行う
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" ) AND
                 ( COMB-HOJOKBN           =  "1" )
               IF    WK-TAX1001-KBN  =  "1"
                 COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                        ( LNK-SYU-SKYMONEY  *  0.05 ) + 0.5
                 COMPUTE  LNK-SYU-SKYMONEY          =
                        ( LNK-SYU-SKYMONEY  *  1.05 ) + 0.5
               ELSE
                 COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                          LNK-SYU-SKYMONEY  *  0.05
                 COMPUTE  LNK-SYU-SKYMONEY          =
                          LNK-SYU-SKYMONEY  *  1.05
               END-IF
             ELSE
               COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI       =
                        LNK-SYU-JIHI-TAX               +
                        LNK-SYU-TGMONEY-TAX-SAI        +
                        LNK-SYU-RMSAGAKU-TAX-SAI       +
                        LNK-SYU-SKYMONEY-SKJ-TAX       +
                        LNK-SYU-SKYMONEY-SKJ-JIHI-TAX  +
                        LNK-SYU-SKYMONEY-LIFE-TAX      +
                        LNK-SYU-SKYMONEY-LIFE-JIHI-TAX
             END-IF
           END-IF.
      *
           MOVE      LNK-SYU-SKYMONEY   TO  WK-GENTAI-SKYMONEY2.
      *
      *    減免計算・請求額端数計算（労災・自賠責・公害を除く）
           MOVE     ZERO      TO    FLG-GENMEN.
           IF   LNK-SYU-SYUHKNNUM   =  "971" OR "973" OR "975"
                   CONTINUE
           ELSE
      *            減免計算
                   INITIALIZE                           PTINF-REC
                   MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM
                   MOVE    LNK-SYU-PTID         TO      PTINF-PTID
                   MOVE    PTINF-REC            TO      MCPDATA-REC
                   MOVE    "DBSELECT"           TO      MCP-FUNC
                   MOVE    "tbl_ptinf"          TO      MCP-TABLE
                   MOVE    "key"                TO      MCP-PATHNAME
                   CALL    "ORCDBMAIN"          USING   MCPAREA
                                                        MCPDATA-REC
                                                        SPA-AREA
                   IF      MCP-RC               =       ZERO
                       MOVE    "tbl_ptinf"      TO      MCP-TABLE
                       MOVE    "key"            TO      MCP-PATHNAME
                       PERFORM  PTINF-READ-SEC
                       IF       MCP-RC          =       ZERO
                           PERFORM   300-GENMEN-KEISAN-SEC
                       ELSE
                           DISPLAY  "PTINF FETCH ERR"
                       END-IF
                   ELSE
                       DISPLAY   "PTINF SELECT ERR"
                   END-IF
      *
                   MOVE    "tbl_ptinf"          TO       MCP-TABLE
                   MOVE    "key"                TO       MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
      *
      *            請求額端数計算（減免無し）
                   IF   (FLG-GENMEN            = ZERO)
                   AND  (LNK-SYU-SKYMONEY  NOT = ZERO)
                       PERFORM   400-SEIKYU-HASUU-KEISAN-SEC
                   END-IF
           END-IF.
      *
      *    請求金額の計算（労災保険適用時の円建て項目加算）
      *    ＜労災指定（０％）＞
           IF   (WK-HKNKBN               =    "1"  ) AND
                (LNK-SYU-SYUHKNNUM       =    "971") AND
                (LNK-SYU-PTFTNRATE       =    ZERO )
              MOVE    ZERO      TO       LNK-SYU-SKYMONEY
              IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                 COMPUTE    LNK-SYU-SKYMONEY  =
                            LNK-SYU-SKYMONEY               +
                            LNK-SYU-RMSAGAKU               +
                            LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                            LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                            LNK-SYU-TGMONEY(17)            +
                            LNK-SYU-TGMONEY-TAX(17)        +
                            LNK-SYU-JIHI-TOTAL             +
                            LNK-SYU-JIHI-TOTAL-TAX
              ELSE
                 COMPUTE    LNK-SYU-SKYMONEY  =
                            LNK-SYU-SKYMONEY               +
                            LNK-SYU-RMSAGAKU               +
                            LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                            LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                            LNK-SYU-TGMONEY(17)            +
                            LNK-SYU-TGMONEY-TAX(17)        +
                            LNK-SYU-JIHI-TOTAL             +
                            LNK-SYU-JIHI-TOTAL-TAX         +
                            LNK-SYU-JIHI-TAX
              END-IF
           END-IF.
      *    ＜非労災指定（１００％）＞
           IF   (WK-HKNKBN               =    "1"  ) AND
                (LNK-SYU-SYUHKNNUM       =    "971") AND
                (LNK-SYU-PTFTNRATE       =     100 )
                 COMPUTE    LNK-SYU-SKYMONEY  =
                            LNK-SYU-SKYMONEY              +
                            LNK-SYU-RSISHOSHIN-MONEY      +
                            LNK-SYU-RSISAISHIN-MONEY      +
                            LNK-SYU-RSISDO-MONEY          +
                            LNK-SYU-RSIETC-MONEY
      *
                 COMPUTE    LNK-SYU-RSI-TOTAL =                         
                                            LNK-SYU-RSISHOSHIN-MONEY +  
                                            LNK-SYU-RSISAISHIN-MONEY +  
                                            LNK-SYU-RSISDO-MONEY     +  
                                            LNK-SYU-RSIETC-MONEY        
           END-IF.
      *
           IF   (WK-HKNKBN               =    "1"  ) AND                
                (LNK-SYU-SYUHKNNUM       =    "971")                    
                   COMPUTE    LNK-SYU-RSIJIBAI-SKYMONEY  =  
                              LNK-SYU-RSIJIBAI-SKYMONEY  +  
                              LNK-SYU-RSISHOSHIN-MONEY   +  
                              LNK-SYU-RSISAISHIN-MONEY   +  
                              LNK-SYU-RSISDO-MONEY       +  
                              LNK-SYU-RSIETC-MONEY          
           END-IF.
      *
           MOVE     ZERO      TO   WK-RSIETC-ZEITAISYO.
      *
      *    自賠責保険の場合、労災円建て項目への加算率計算追加
      *    ＜患者請求する（１００％）の場合＞
           IF   (WK-HKNKBN               =    "1")   AND
                (LNK-SYU-SYUHKNNUM       =    "973") AND
                (LNK-SYU-PTFTNRATE       =     100 )
              IF   FLG-KENPOJYUNKYO  =  ZERO
                 COMPUTE  LNK-SYU-RSISHOSHIN-MONEY  =
                         (LNK-SYU-RSISHOSHIN-MONEY  *  WK-KSNRATE)
                                                    +  0.5
                 COMPUTE  LNK-SYU-RSISAISHIN-MONEY  =
                         (LNK-SYU-RSISAISHIN-MONEY  *  WK-KSNRATE)
                                                    +  0.5
              END-IF
      *
      *          自賠責その他コード情報の編集（０９５９１．９２．９３）
                 PERFORM   500-JIBAI-SONOTA-HENSYU-SEC
      *
                 COMPUTE    LNK-SYU-SKYMONEY  =   
                            LNK-SYU-SKYMONEY         +
                            LNK-SYU-RSISHOSHIN-MONEY +
                            LNK-SYU-RSISAISHIN-MONEY +
                            LNK-SYU-RSISDO-MONEY     +
                            LNK-SYU-RSIETC-MONEY
      *
                 COMPUTE    LNK-SYU-RSI-TOTAL =   
                                            LNK-SYU-RSISHOSHIN-MONEY +  
                                            LNK-SYU-RSISAISHIN-MONEY +  
                                            LNK-SYU-RSISDO-MONEY     +  
                                            LNK-SYU-RSIETC-MONEY        
      *
                 IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE     LNK-SYU-TAX-TAISHOU     =
                                 LNK-SYU-TGMONEY-TAX(17) +
                                 LNK-SYU-JIHI-TOTAL-TAX  +
                                 WK-SKJ-ZEITAISYO        +
                                 WK-RSIETC-ZEITAISYO
                     IF   WK-BRMSGK-TAXKBN    =  "1"
                        COMPUTE  LNK-SYU-TAX-TAISHOU     =
                                 LNK-SYU-TAX-TAISHOU     +
                                 LNK-SYU-RMSAGAKU
                     END-IF
                     IF    WK-TAX1001-KBN  =  "1"
                        COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                                (LNK-SYU-TAX-TAISHOU  * 5 / 105) + 0.5
                     ELSE
                        COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                                (LNK-SYU-TAX-TAISHOU  * 5 / 105)
                     END-IF
      ***            COMPUTE    LNK-SYU-SKYMONEY-TAX-SAI  =
      ***                       LNK-SYU-SKYMONEY-TAX-SAI  +
      ***                       LNK-SYU-RSI-TAX-SAI    
                 ELSE
                     COMPUTE    LNK-SYU-SKYMONEY-TAX-SAI  =
                                LNK-SYU-SKYMONEY-TAX-SAI  +
                                LNK-SYU-RSI-TAX-SAI        
                 END-IF
           END-IF.
      *    ＜患者請求しない（０％）の場合＞
           IF   (WK-HKNKBN               =    "1")   AND
                (LNK-SYU-SYUHKNNUM       =    "973") AND
                (LNK-SYU-PTFTNRATE       =    ZERO )
              IF   FLG-KENPOJYUNKYO  =  ZERO
                 COMPUTE  LNK-SYU-RSISHOSHIN-MONEY  =
                         (LNK-SYU-RSISHOSHIN-MONEY  *  WK-KSNRATE)
                                                    +  0.5
                 COMPUTE  LNK-SYU-RSISAISHIN-MONEY  =
                         (LNK-SYU-RSISAISHIN-MONEY  *  WK-KSNRATE)
                                                    +  0.5
              END-IF
      *
      *       自賠責その他コード情報の編集（０９５９１．９２．９３）
              PERFORM   500-JIBAI-SONOTA-HENSYU-SEC
      *
              MOVE    ZERO      TO       LNK-SYU-SKYMONEY
              IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                 COMPUTE    LNK-SYU-SKYMONEY  =
                            LNK-SYU-SKYMONEY               +
                            LNK-SYU-RMSAGAKU               +
                            LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                            LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                            LNK-SYU-TGMONEY(17)            +
                            LNK-SYU-TGMONEY-TAX(17)        +
                            LNK-SYU-JIHI-TOTAL             +
                            LNK-SYU-JIHI-TOTAL-TAX
              ELSE
                 COMPUTE    LNK-SYU-SKYMONEY  =
                            LNK-SYU-SKYMONEY               +
                            LNK-SYU-RMSAGAKU               +
                            LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                            LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                            LNK-SYU-TGMONEY(17)            +
                            LNK-SYU-TGMONEY-TAX(17)        +
                            LNK-SYU-JIHI-TOTAL             +
                            LNK-SYU-JIHI-TOTAL-TAX         +
                            LNK-SYU-JIHI-TAX
              END-IF
           END-IF.
      *
           IF   (WK-HKNKBN               =    "1"  ) AND                
                (LNK-SYU-SYUHKNNUM       =    "973")                    
                   COMPUTE    LNK-SYU-RSIJIBAI-SKYMONEY  =  
                              LNK-SYU-RSIJIBAI-SKYMONEY  +  
                              LNK-SYU-RSISHOSHIN-MONEY   +  
                              LNK-SYU-RSISAISHIN-MONEY   +  
                              LNK-SYU-RSISDO-MONEY       +  
                              LNK-SYU-RSIETC-MONEY          
           END-IF.
      *
      *    患者負担金　独自計算対応
      *
           INITIALIZE                         SYS-1037-REC.
           MOVE    "1037"               TO    SYS-1037-KANRICD.
           MOVE    "*"                  TO    SYS-1037-KBNCD.
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-1037-HOSPNUM.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1037-STYUKYMD.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1037-EDYUKYMD.
           MOVE    SYS-1037-REC         TO    MCPDATA-REC.
           MOVE    "DBSELECT"           TO    MCP-FUNC.
           MOVE    "tbl_syskanri"       TO    MCP-TABLE.
           MOVE    "key10"              TO    MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =     ZERO
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key10"         TO    MCP-PATHNAME
               PERFORM   SYSKANRI-READ-SEC
               IF    MCP-RC             =     ZERO
                   IF   LNK-SYU-HOSPNUM   =    SYS-1037-HOSPNUM
                       IF  SYS-1037-PGID-NYU NOT = SPACE
                          CALL   SYS-1037-PGID-NYU  USING
                                                    MCPAREA
                                                    LNK-SYUNOU-REC
                                                    SPA-AREA
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
           MOVE     "tbl_syskanri"      TO    MCP-TABLE.
           MOVE     "key10"             TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    請求金額の計算（調整金の加減算）
           COMPUTE    LNK-SYU-SKYMONEY  =   LNK-SYU-SKYMONEY    +
                                            LNK-SYU-CHOSEI.
      *
       MAIN-EXT.
           EXIT PROGRAM
           STOP RUN.
      *
      ******************************************************************
      *        減免計算処理                                            *
      ******************************************************************
       300-GENMEN-KEISAN-SEC          SECTION.
      *
           IF   PTINF-DISCOUNT  NOT =   SPACE  AND  "00"
      *
               INITIALIZE                         SYS-1026-REC
               MOVE    "1026"               TO    SYS-1026-KANRICD
               MOVE    PTINF-DISCOUNT-KBN   TO    SYS-1026-KBNCD
               MOVE    LNK-SYU-HOSPNUM      TO    SYS-1026-HOSPNUM
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1026-STYUKYMD
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1026-EDYUKYMD
               MOVE    SYS-1026-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "tbl_syskanri"       TO    MCP-TABLE
               MOVE    "key10"              TO    MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =     ZERO
                   MOVE     "tbl_syskanri"  TO    MCP-TABLE
                   MOVE     "key10"         TO    MCP-PATHNAME
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
                       MOVE   SYS-1026-KBNCD  TO  LNK-SYU-DISCOUNT-KBN
                       MOVE   SYS-1026-DISCOUNT-BODY
                                              TO  LNK-SYU-DISCOUNT-BODY
                   END-IF
               END-IF
      *
               MOVE     "tbl_syskanri"      TO    MCP-TABLE
               MOVE     "key10"             TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
      *
               INITIALIZE                         SYS-1027-REC
               MOVE    "1027"               TO    SYS-1027-KANRICD
               MOVE    PTINF-DISCOUNT       TO    SYS-1027-KBNCD
               MOVE    LNK-SYU-HOSPNUM      TO    SYS-1027-HOSPNUM
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1027-STYUKYMD
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1027-EDYUKYMD
               MOVE    SYS-1027-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "tbl_syskanri"       TO    MCP-TABLE
               MOVE    "key10"              TO    MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =     ZERO
                   MOVE     "tbl_syskanri"  TO    MCP-TABLE
                   MOVE     "key10"         TO    MCP-PATHNAME
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
      *
                     IF   (SYS-1027-TEIRITU        NOT =  SPACE)
                     AND  (SYS-1027-DISCOUNT-RATE  NOT =  ZERO )
                       IF  WK-1001-GENTAIKBN  =  "2"
                         IF  COMB-SYU-HKNKOHSBTKBN  =  "8"
                           CONTINUE
                         ELSE
                           PERFORM  3001-GENMEN-KEISAN2-SEC
                         END-IF
                       ELSE
                           PERFORM  3001-GENMEN-KEISAN2-SEC
                       END-IF
                     END-IF
      *
                   END-IF
               END-IF
      *
               MOVE     "tbl_syskanri"    TO    MCP-TABLE
               MOVE     "key10"           TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           END-IF.
      *
       300-GENMEN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        減免計算処理                                            *
      ******************************************************************
       3001-GENMEN-KEISAN2-SEC          SECTION.
      *
           IF   WK-1001-GENTAIKBN  =  "2"
              MOVE    WK-GENTAI-SKYMONEY      TO   LNK-SYU-SKYMONEY
              COMPUTE WK-GENTAI-SKYMONEY3     =    WK-GENTAI-SKYMONEY2
                                              -    WK-GENTAI-SKYMONEY
           END-IF
      *
           EVALUATE  SYS-1027-TEIRITU
              WHEN  "1"
                  MOVE    ZERO    TO   WK-RATE
                  COMPUTE  WK-RATE  =  (100 - SYS-1027-DISCOUNT-RATE)
                                    /   100
                  MOVE     LNK-SYU-SKYMONEY   TO   WK-GENMEN-KEISAN
                  COMPUTE  WK-GENMEN-KEISAN2   =   LNK-SYU-SKYMONEY
                                               *   WK-RATE
                  COMPUTE  WK-GENMEN-KEISAN3   =   WK-GENMEN-KEISAN
                                               -   WK-GENMEN-KEISAN2
                  MOVE     WK-GENMEN-KEISAN2  TO   LNK-SYU-SKYMONEY
              WHEN  "2"
                  IF   SYS-1027-DISCOUNT-RATE  >=  LNK-SYU-SKYMONEY
                      MOVE    LNK-SYU-SKYMONEY TO WK-GENMEN-KEISAN3
                      MOVE    ZERO             TO LNK-SYU-SKYMONEY
                  ELSE
                      MOVE    SYS-1027-DISCOUNT-RATE
                                               TO WK-GENMEN-KEISAN3
                      COMPUTE LNK-SYU-SKYMONEY  = LNK-SYU-SKYMONEY
                                                - SYS-1027-DISCOUNT-RATE
                  END-IF
           END-EVALUATE
      *
           IF   (WK-1001-GENTAIKBN      =  "2"             )
           AND  (WK-HASU1001-KBN        =  WK-HASU1001-KBN2)
              COMPUTE  LNK-SYU-SKYMONEY =  LNK-SYU-SKYMONEY
                                        +  WK-GENTAI-SKYMONEY3
           END-IF
      *
           IF   LNK-SYU-SKYMONEY   NOT =  ZERO
               EVALUATE   WK-HASU1001-KBN
                  WHEN  "1"
                     COMPUTE    LNK-SYU-SKYMONEY  =
                                LNK-SYU-SKYMONEY  + 5
                     COMPUTE    LNK-SYU-SKYMONEY  =
                                LNK-SYU-SKYMONEY  / 10
                     COMPUTE    LNK-SYU-SKYMONEY  =
                                LNK-SYU-SKYMONEY  * 10
                  WHEN  "2"
                     COMPUTE    LNK-SYU-SKYMONEY  =
                                LNK-SYU-SKYMONEY  / 10
                     COMPUTE    LNK-SYU-SKYMONEY  =
                                LNK-SYU-SKYMONEY  * 10
                  WHEN  "3"
                     COMPUTE    LNK-SYU-SKYMONEY  =
                                LNK-SYU-SKYMONEY  + 9
                     COMPUTE    LNK-SYU-SKYMONEY  =
                                LNK-SYU-SKYMONEY  / 10
                     COMPUTE    LNK-SYU-SKYMONEY  =
                                LNK-SYU-SKYMONEY  * 10
                  WHEN  "4"
                     CONTINUE
               END-EVALUATE
           END-IF
      *
           IF   (WK-1001-GENTAIKBN      =  "2"             )
           AND  (WK-HASU1001-KBN   NOT  =  WK-HASU1001-KBN2)
              IF   WK-GENTAI-SKYMONEY3   NOT =  ZERO
                  EVALUATE   WK-HASU1001-KBN2
                     WHEN  "1"
                        COMPUTE    WK-GENTAI-SKYMONEY3  =
                                   WK-GENTAI-SKYMONEY3  + 5
                        COMPUTE    WK-GENTAI-SKYMONEY3  =
                                   WK-GENTAI-SKYMONEY3  / 10
                        COMPUTE    WK-GENTAI-SKYMONEY3  =
                                   WK-GENTAI-SKYMONEY3  * 10
                     WHEN  "2"
                        COMPUTE    WK-GENTAI-SKYMONEY3  =
                                   WK-GENTAI-SKYMONEY3  / 10
                        COMPUTE    WK-GENTAI-SKYMONEY3  =
                                   WK-GENTAI-SKYMONEY3  * 10
                     WHEN  "3"
                        COMPUTE    WK-GENTAI-SKYMONEY3  =
                                   WK-GENTAI-SKYMONEY3  + 9
                        COMPUTE    WK-GENTAI-SKYMONEY3  =
                                   WK-GENTAI-SKYMONEY3  / 10
                        COMPUTE    WK-GENTAI-SKYMONEY3  =
                                   WK-GENTAI-SKYMONEY3  * 10
                     WHEN  "4"
                        CONTINUE
                  END-EVALUATE
              END-IF
              COMPUTE  LNK-SYU-SKYMONEY    = LNK-SYU-SKYMONEY
                                           + WK-GENTAI-SKYMONEY3
           END-IF
      *
           MOVE   SYS-1027-KBNCD          TO   LNK-SYU-DISCOUNT-RATEKBN
           MOVE   SYS-1027-TEIRITU        TO   LNK-SYU-DISCOUNT-TEIRITU
           MOVE   SYS-1027-DISCOUNT-RATE  TO   LNK-SYU-DISCOUNT-RATE
           MOVE   WK-GENMEN-KEISAN3       TO   LNK-SYU-DISCOUNT-MONEY
      *
           MOVE     1                     TO   FLG-GENMEN
      *
           .
      *
       3001-GENMEN-KEISAN2-EXT.
           EXIT.
      *
      ******************************************************************
      *        請求額端数計算処理（減免無し）                                      *
      ******************************************************************
       400-SEIKYU-HASUU-KEISAN-SEC          SECTION.
      *
           EVALUATE   WK-HASU1001-KBN2
              WHEN  "1"
                 COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +   5
                 COMPUTE  WK-SEIKYUGK      = LNK-SYU-SKYMONEY  /  10
                 COMPUTE  LNK-SYU-SKYMONEY = WK-SEIKYUGK       *  10
              WHEN  "2"
                 COMPUTE  WK-SEIKYUGK      = LNK-SYU-SKYMONEY  /  10
                 COMPUTE  LNK-SYU-SKYMONEY = WK-SEIKYUGK       *  10
              WHEN  "3"
                 COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +   9
                 COMPUTE  WK-SEIKYUGK      = LNK-SYU-SKYMONEY  /  10
                 COMPUTE  LNK-SYU-SKYMONEY = WK-SEIKYUGK       *  10
              WHEN  "4"
                 CONTINUE
           END-EVALUATE
      *
           .
      *
       400-SEIKYU-HASUU-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        自賠責その他コード情報の編集（０９５９１．９２．９３）                                      *
      ******************************************************************
       500-JIBAI-SONOTA-HENSYU-SEC          SECTION.
      *
           INITIALIZE                            WK-4003-TAIGAI.
      *
      *    システム管理マスタ（４００３）から消費税対象外コード取得
      *
           IF   WK-4001-TAXKBN-KZI   =   "2"
              INITIALIZE                         SYS-4003-REC
              MOVE    "4003"               TO    SYS-4003-KANRICD
              MOVE    "*"                  TO    SYS-4003-KBNCD
              MOVE    LNK-SYU-HOSPNUM      TO    SYS-4003-HOSPNUM
              MOVE    LNK-SYU-SRYYMD       TO    SYS-4003-STYUKYMD
              MOVE    LNK-SYU-SRYYMD       TO    SYS-4003-EDYUKYMD
              MOVE    SYS-4003-REC         TO    MCPDATA-REC
              MOVE    "DBSELECT"           TO    MCP-FUNC
              MOVE    "tbl_syskanri"       TO    MCP-TABLE
              MOVE    "key10"              TO    MCP-PATHNAME
              CALL    "ORCDBMAIN"          USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
              IF      MCP-RC               =     ZERO
                  MOVE     "tbl_syskanri"  TO    MCP-TABLE
                  MOVE     "key10"         TO    MCP-PATHNAME
                  PERFORM   SYSKANRI-READ-SEC
                  IF    MCP-RC             =     ZERO
                     PERFORM   VARYING   IDX8    FROM   1   BY   1
                                UNTIL   (IDX8                 >    50 )
                                  OR    (SYS-4003-SRYCD(IDX8) =  SPACE)
                          MOVE    SYS-4003-SRYCD(IDX8)
                                        TO   WK-4003-TAIGAI-SRYCD(IDX8)
                     END-PERFORM
                  END-IF
              END-IF
      *
              MOVE     "tbl_syskanri"      TO    MCP-TABLE
              MOVE     "key10"             TO    MCP-PATHNAME
              PERFORM   DB-CLOSE-SEC
           END-IF.
      *
      *    コード別に退避
      *
           INITIALIZE              WK-SONOTA91.
           INITIALIZE              WK-SONOTA92.
           INITIALIZE              WK-SONOTA93.
           MOVE     ZERO      TO   IDX5.
           MOVE     ZERO      TO   IDX6.
           MOVE     ZERO      TO   IDX7.
      *
           PERFORM   VARYING   IDX4    FROM   1   BY   1
                      UNTIL   (IDX4                       >    50 )
                       OR     (LNK-S02-SONOTA-SRYCD(IDX4) =  SPACE)
                 EVALUATE      LNK-S02-SONOTA-SRYCD(IDX4)(1:5)
                    WHEN   "09591"
                       ADD     1     TO   IDX5
                       MOVE    LNK-S02-SONOTA-SRYCD(IDX4)
                                     TO   WK-SONOTA91-SRYCD(IDX5)
                       MOVE    LNK-S02-SONOTA-ZAIKAISU(IDX4)
                                     TO   WK-SONOTA91-ZAIKAISU(IDX5)
                       MOVE    LNK-S02-SONOTA-TANKA(IDX4)
                                     TO   WK-SONOTA91-TANKA(IDX5)
                    WHEN   "09592"
                       ADD     1     TO   IDX6
                       MOVE    LNK-S02-SONOTA-SRYCD(IDX4)
                                     TO   WK-SONOTA92-SRYCD(IDX6)
                       MOVE    LNK-S02-SONOTA-ZAIKAISU(IDX4)
                                     TO   WK-SONOTA92-ZAIKAISU(IDX6)
                       MOVE    LNK-S02-SONOTA-TANKA(IDX4)
                                     TO   WK-SONOTA92-TANKA(IDX6)
                    WHEN   "09593"
                       MOVE     SPACE    TO    FLG-TAIGAI
                       PERFORM  VARYING  IDX8    FROM   1   BY   1
                            UNTIL  (IDX8                       >   50  )
                              OR   (WK-4003-TAIGAI-SRYCD(IDX8) =  SPACE)
                              OR   (FLG-TAIGAI                 =  "1"  )
                         IF   WK-4003-TAIGAI-SRYCD(IDX8)  =
                                         LNK-S02-SONOTA-SRYCD(IDX4)
                              MOVE    "1"     TO    FLG-TAIGAI
                         END-IF
                       END-PERFORM
                       IF   FLG-TAIGAI  =  SPACE
                          ADD     1     TO   IDX7
                          MOVE    LNK-S02-SONOTA-SRYCD(IDX4)
                                        TO   WK-SONOTA93-SRYCD(IDX7)
                          MOVE    LNK-S02-SONOTA-ZAIKAISU(IDX4)
                                        TO   WK-SONOTA93-ZAIKAISU(IDX7)
                          MOVE    LNK-S02-SONOTA-TANKA(IDX4)
                                        TO   WK-SONOTA93-TANKA(IDX7)
                       END-IF
                 END-EVALUATE
           END-PERFORM.
      *
      *    文書料消費税計算
      *
           IF   WK-4001-TAXKBN   =   "2"
      *
              IF    WK-TAX1001-KBN  =  "1"
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    50 )
                              OR    (WK-SONOTA91-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA91-TANKA(IDX4)  *  0.05)  +  0.5
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA91-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA91-TANKA(IDX4)    *
                              WK-SONOTA91-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    50 )
                              OR    (WK-SONOTA92-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA92-TANKA(IDX4)  *  0.05)  +  0.5
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA92-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA92-TANKA(IDX4)    *
                              WK-SONOTA92-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
              ELSE
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    50 )
                              OR    (WK-SONOTA91-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA91-TANKA(IDX4)  *  0.05)
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA91-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA91-TANKA(IDX4)    *
                              WK-SONOTA91-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    50 )
                              OR    (WK-SONOTA92-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA92-TANKA(IDX4)  *  0.05)
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA92-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA92-TANKA(IDX4)    *
                              WK-SONOTA92-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
              END-IF
      *
           END-IF.
      *
      *    特定器材等消費税計算
      *
           IF   WK-4001-TAXKBN-KZI   =   "2"
      *
              IF    WK-TAX1001-KBN  =  "1"
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    50 )
                              OR    (WK-SONOTA93-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA93-TANKA(IDX4)  *  0.05)  +  0.5
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA93-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA93-TANKA(IDX4)    *
                              WK-SONOTA93-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
              ELSE
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    50 )
                              OR    (WK-SONOTA93-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA93-TANKA(IDX4)  *  0.05)
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA93-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA93-TANKA(IDX4)    *
                              WK-SONOTA93-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
              END-IF
      *
           END-IF.
      *
       500-JIBAI-SONOTA-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        保険参照部分確定処理                                    *
      ******************************************************************
       100-KAKUTEI-SEC          SECTION.
      *
           MOVE    SPACE              TO  FLG-SANSHOU2
           MOVE    SPACE              TO  FLG-SANSHOU3
           INITIALIZE                     WK-SYOTOKU-SKJKBN-TBL
      *
           INITIALIZE                     ORCSSYOTOKUAREA
           MOVE  LNK-SYU-HOSPNUM      TO  LNK-SYOTOKU-HOSPNUM
           MOVE  LNK-SYU-PTID         TO  LNK-SYOTOKU-PTID
           MOVE  LNK-SYU-SRYYMD(1:6)  TO  LNK-SYOTOKU-SRYYM
      *
           CALL    "ORCSSYOTOKU"      USING  ORCSSYOTOKUAREA
                                             SPA-AREA
      *
           IF    LNK-SYOTOKU-RC    =   ZERO
                IF    LNK-SYU-SRYYMD(1:6)   >=  "200604"
                  MOVE   LNK-SYU-SRYYMD(7:2)  TO  SYOTOKU-IDX
                ELSE
                  MOVE   1                    TO  SYOTOKU-IDX
                END-IF
      *       （主保険・全国公費）
                MOVE   LNK-SYOTOKU-SYUKBN(SYOTOKU-IDX)
                                              TO  FLG-SANSHOU3
      *       （地方公費）
                MOVE   LNK-SYOTOKU-CHIKBN(SYOTOKU-IDX)
                                              TO  FLG-SANSHOU2
      *       （食事）
                PERFORM   VARYING   SYOTOKU-IDX    FROM   1   BY   1
                           UNTIL    SYOTOKU-IDX     >    31
                   MOVE   LNK-SYOTOKU-SKJKBN(SYOTOKU-IDX)
                                    TO  WK-SYOTOKU-SKJKBN(SYOTOKU-IDX)
                   IF (LNK-SYU-SYUHKNNUM = "971" OR "973" OR "975"
                                        OR "068" OR "069" OR "040")
                   OR (LNK-SYU-SYUHKNNUM(1:2) = "98"              )
                       MOVE  SPACE  TO  WK-SYOTOKU-SKJKBN(SYOTOKU-IDX)
                   END-IF
                END-PERFORM
           END-IF
      *
           EVALUATE   FLG-SANSHOU2
               WHEN     SPACE
                    MOVE     "1"      TO  FLG-SANSHOU2
               WHEN     "2"
               WHEN     "3"
                    MOVE     "2"      TO  FLG-SANSHOU2
               WHEN     "1"
               WHEN     "4"
                    MOVE     "3"      TO  FLG-SANSHOU2
           END-EVALUATE
      *
      *    公費負担限度額のセット
           IF   LNK-SYU-SRYYMD(1:6)   >= "200610"
                  MOVE   44400     TO  WK-KOH-GENDOGAKU
                  EVALUATE  FLG-SANSHOU3
                    WHEN       "2"
                    WHEN       "3"
                      MOVE  24600  TO  WK-KOH-GENDOGAKU
                    WHEN       "1"
                    WHEN       "4"
                      MOVE  15000  TO  WK-KOH-GENDOGAKU
                  END-EVALUATE
           ELSE
                  MOVE   40200     TO  WK-KOH-GENDOGAKU
                  EVALUATE  FLG-SANSHOU3
                    WHEN       "2"
                    WHEN       "3"
                      MOVE  24600  TO  WK-KOH-GENDOGAKU
                    WHEN       "1"
                    WHEN       "4"
                      MOVE  15000  TO  WK-KOH-GENDOGAKU
                  END-EVALUATE
           END-IF
      *
           IF   ( COMB-KOH1HKNNUM  =   "972" )
           OR   ( COMB-KOH2HKNNUM  =   "972" )
           OR   ( COMB-KOH3HKNNUM  =   "972" )
           OR   ( COMB-KOH4HKNNUM  =   "972" )
              IF   WK-KOH-GENDOGAKU > 10000
                 MOVE   10000   TO  WK-KOH-GENDOGAKU
              END-IF
           END-IF
      *
           IF   ( COMB-KOH1HKNNUM  =   "974" )
           OR   ( COMB-KOH2HKNNUM  =   "974" )
           OR   ( COMB-KOH3HKNNUM  =   "974" )
           OR   ( COMB-KOH4HKNNUM  =   "974" )
              IF   WK-KOH-GENDOGAKU > 20000
                 MOVE   20000   TO  WK-KOH-GENDOGAKU
              END-IF
           END-IF
      *
           .
      *
       100-KAKUTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *    自費保険のデータ編集                                *
      ******************************************************************
       104-JIHIHOKEN-DATA-HENSYU-SEC          SECTION.
      *
           IF  ((COMB-HKNNUM            NOT =   SPACE   ) AND
                (COMB-SYU-HKNKOHSBTKBN      =   "8"     ) AND
                (WK-1001-JIHIPOSITION       =   "2"     ) AND
                (LNK-SYU-SRYYMD(1:6)       >=   "200604"))
           OR  ((COMB-HKNNUM            NOT =   SPACE   ) AND
                (COMB-SYU-HKNKOHSBTKBN      =   "8"     ) AND
                (WK-1001-JIHIPOSITION   NOT =   "2"     ) AND
                (COMB-HOJOKBN               =   "1"     ) AND
                (LNK-SYU-SRYYMD(1:6)       >=   "200704"))
      *
      *      該当保険番号テーブルの検索
             INITIALIZE                      HKNNUM-REC
             MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
             MOVE   COMB-HKNNUM        TO    HKN-HKNNUM
             MOVE   "00"               TO    WK-PAYKBN
             MOVE   HKNNUM-REC         TO    MCPDATA-REC
             MOVE   "DBSELECT"         TO    MCP-FUNC
             MOVE   "tbl_hknnum"       TO    MCP-TABLE
             MOVE   "key2"             TO    MCP-PATHNAME
             CALL   "ORCDBMAIN"        USING MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
             IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"  TO    MCP-TABLE
                 MOVE    "key2"        TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                  ( FLG-HKNNUM           =  1                   ) OR
                  ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                   (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6)  ) AND
                   (WK-PAYKBN            =  HKN-PAYKBN         ))
                     MOVE     "tbl_hknnum"  TO    MCP-TABLE
                     MOVE     "key2"        TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
             END-IF
      *
             MOVE     "tbl_hknnum"  TO    MCP-TABLE
             MOVE     "key2"        TO    MCP-PATHNAME
             PERFORM   DB-CLOSE-SEC
      *
             IF  HKN-TENTNK   =   ZERO
                 MOVE     10      TO      HKN-TENTNK
             END-IF
      *
             IF   COMB-HONKZKKBN        =   "1"
               IF  HKN-HON-NYUKFTNRATE   NOT =   ZERO
                  IF  HKN-TENTNK   =   10
                      COMPUTE  WK-JIHIFTN   =
                               HKN-HON-NYUKFTNRATE  /  100
                  ELSE
                      MOVE       1     TO      WK-JIHIFTN
                  END-IF
               ELSE
                  MOVE     ZERO        TO      WK-JIHIFTN
               END-IF
             ELSE
               IF  HKN-KZK-NYUKFTNRATE   NOT =   ZERO
                  IF  HKN-TENTNK   =   10
                      COMPUTE  WK-JIHIFTN   =
                               HKN-KZK-NYUKFTNRATE  /  100
                  ELSE
                      MOVE       1     TO      WK-JIHIFTN
                  END-IF
               ELSE
                  MOVE     ZERO        TO      WK-JIHIFTN
               END-IF
             END-IF
      *
             IF     WK-JIHIFTN    NOT =    ZERO
               PERFORM   VARYING   IDX9    FROM    1   BY  1
                          UNTIL    IDX9       >   17
                 IF   (LNK-SYU-SRYYMD(1:6)       >=   "200704")
                 AND  (COMB-HOJOKBN               =   "1"     )
                    COMPUTE WK-JIHIGAKU   =
                            LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK
                    COMPUTE WK-JIHIGAKU2  =
                            WK-JIHIGAKU           *  WK-JIHIFTN
                    IF    WK-TAX1001-KBN  =  "1"
                       COMPUTE WK-JIHIGAKU3  =
                              (WK-JIHIGAKU2  * 0.05) + 0.5
                    ELSE
                       COMPUTE WK-JIHIGAKU3  =
                              (WK-JIHIGAKU2  * 0.05)
                    END-IF
                    IF    IDX9  =  17
                       MOVE   ZERO  TO  WK-JIHIGAKU2
                       MOVE   ZERO  TO  WK-JIHIGAKU3
                    END-IF
                    IF    WK-1001-JIHIPOSITION  =   "2"
                       COMPUTE LNK-SYU-TGMONEY-TAX(IDX9) =
                               LNK-SYU-TGMONEY-TAX(IDX9) + WK-JIHIGAKU2
                                                         + WK-JIHIGAKU3
                       MOVE    ZERO    TO      LNK-SYU-HKNTEN(IDX9)
                    ELSE
                       COMPUTE WK-SKYMONEY-ZEI = WK-SKYMONEY-ZEI
                                               + WK-JIHIGAKU3
                    END-IF
                 ELSE
                    COMPUTE WK-JIHIGAKU   =
                            LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK
                    COMPUTE WK-JIHIGAKU2  =
                            WK-JIHIGAKU           *  WK-JIHIFTN
                    IF    IDX9  =  17
                       MOVE   ZERO  TO  WK-JIHIGAKU2
                    END-IF
                    COMPUTE LNK-SYU-TGMONEY(IDX9) =
                            LNK-SYU-TGMONEY(IDX9) +  WK-JIHIGAKU2
                    MOVE    ZERO    TO      LNK-SYU-HKNTEN(IDX9)
                 END-IF
               END-PERFORM
             END-IF
      *
           END-IF
      *
           .
      *
       104-JIHIHOKEN-DATA-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    保険組合せの上限区分編集                                *
      ******************************************************************
       105-JYOGENKBN-HENSYU-SEC          SECTION.
      *
           MOVE    SPACE    TO   COMB-KOH1-NYUJGNKBN.
           MOVE    SPACE    TO   COMB-KOH2-NYUJGNKBN.
           MOVE    SPACE    TO   COMB-KOH3-NYUJGNKBN.
           MOVE    SPACE    TO   COMB-KOH4-NYUJGNKBN.
      *
      *    公費１の上限区分編集
           IF  COMB-KOH1HKNNUM           NOT =  SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH1HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH1HKNNUM    =     "027"
                       MOVE     COMB-KOH1PAYKBN
                                         TO    WK-PAYKBN
               ELSE
                       MOVE     "00"     TO    WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                       OR
                  ((HKN-TEKSTYMD(1:6)     <=  LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <=  HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            =  HKN-PAYKBN))
                     MOVE     "tbl_hknnum"  TO    MCP-TABLE
                     MOVE     "key2"        TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   1051-JYOGENKBN-CHECK-SEC
                        MOVE   WK-NYUJGNKBN  TO  COMB-KOH1-NYUJGNKBN
                 END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"      TO    MCP-TABLE
               MOVE    "key2"            TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    公費２の上限区分編集
           IF  COMB-KOH2HKNNUM           NOT = SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH2HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                      OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum" TO    MCP-TABLE
                     MOVE     "key2"       TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   1051-JYOGENKBN-CHECK-SEC
                        MOVE   WK-NYUJGNKBN  TO  COMB-KOH2-NYUJGNKBN
                 END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"      TO    MCP-TABLE
               MOVE    "key2"            TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    公費３の上限区分編集
           IF  COMB-KOH3HKNNUM           NOT = SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH3HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                      OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum" TO    MCP-TABLE
                     MOVE     "key2"       TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   1051-JYOGENKBN-CHECK-SEC
                        MOVE   WK-NYUJGNKBN  TO  COMB-KOH3-NYUJGNKBN
                 END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"      TO    MCP-TABLE
               MOVE    "key2"            TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    公費４の上限区分編集
           IF  COMB-KOH4HKNNUM           NOT = SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH4HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                       OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum" TO    MCP-TABLE
                     MOVE     "key2"       TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   1051-JYOGENKBN-CHECK-SEC
                        MOVE   WK-NYUJGNKBN  TO  COMB-KOH4-NYUJGNKBN
                 END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
       105-JYOGENKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    保険組合せの上限区分チェック                                *
      ******************************************************************
       1051-JYOGENKBN-CHECK-SEC           SECTION.
      *
           MOVE     SPACE     TO    WK-NYUJGNKBN.
      *
           IF    HKN-HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                      OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                      OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                      END-IF
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                      ELSE
                        IF   HKN-TSY-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-TSY-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-TSY-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                      ELSE
                        IF   HKN-TNK-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-TNK-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-TNK-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( HKN-HKNNUM        = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( HKN-HKNNUM        = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( HKN-HKNNUM        = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( HKN-HKNNUM        = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( HKN-HKNNUM(1:1)  >=  "1"  AND  <=  "8"       ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( HKN-HKNNUM        = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( HKN-HKNNUM        = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( HKN-HKNNUM        = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( HKN-HKNNUM        = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( HKN-HKNNUM        = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                      OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                      OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                      END-IF
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                      ELSE
                        IF   HKN-TSY-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-TSY-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-TSY-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                      ELSE
                        IF   HKN-TNK-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-TNK-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-TNK-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                      END-IF
                 END-EVALUATE
               ELSE
                 IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                 OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                 OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                 END-IF
               END-IF
             END-IF
           ELSE
             IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
             OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
             OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
             END-IF
           END-IF.
      *
       1051-JYOGENKBN-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *        保険負担額算定処理                                      *
      ******************************************************************
       200-HKNFTN-SANTEI-SEC          SECTION.
      *
           MOVE    SPACE                 TO    HOKEN-MAX-AREA
                                               HOKEN-KAISU-TABLE
                                               HOKEN-FUTAN-AREA
                                               HOKEN-FUTAN-AREA2
                                               HOKEN-FUTAN-AREA3
                                               HOKEN-ZAN-AREA
                                               HOKEN-ZAN-AREA2
                                               HOKEN-ZAN-AREA3
                                               HOKEN-ZAN-D-AREA
                                               HOKEN-ZAN-D2-AREA
                                               HOKEN-ZAN-D3-AREA
                                               HOKEN-SKJFUTAN-AREA
                                               HOKEN-SKJZAN-AREA
           INITIALIZE                          HOKEN-MAX-AREA
                                               HOKEN-KAISU-TABLE
                                               HOKEN-FUTAN-AREA
                                               HOKEN-FUTAN-AREA2
                                               HOKEN-FUTAN-AREA3
                                               HOKEN-ZAN-AREA
                                               HOKEN-ZAN-AREA2
                                               HOKEN-ZAN-AREA3
                                               HOKEN-ZAN-D-AREA
                                               HOKEN-ZAN-D2-AREA
                                               HOKEN-ZAN-D3-AREA
                                               HOKEN-SKJFUTAN-AREA
                                               HOKEN-SKJZAN-AREA
           MOVE    ALL"9"                TO    WK-KOH-COMPFTN-AREA
                                               WK-DAY-KOH-COMPFTN-AREA
      *
      *    自賠責・療養担当手当用特例処理
      *    （自賠責の場合、１０点を１２０円に読み替える）
      *    （療養担当手当：１月１回の算定）
           IF    LNK-SYU-SYUHKNNUM       =    "973"
           AND   LNK-S02-RYOYO       NOT =    ZERO
               COMPUTE  LNK-SYU-HKNTEN (16)  =  LNK-SYU-HKNTEN (16)
                                             -  LNK-S02-RYOYO
               COMPUTE  LNK-SYU-HKNTEN (17)  =  LNK-SYU-HKNTEN (17)
                                             -  LNK-S02-RYOYO
      *
               COMPUTE  WK-RYOYO  =  LNK-S02-RYOYO  /   10
      *
               COMPUTE  LNK-SYU-RSIETC-MONEY =  LNK-SYU-RSIETC-MONEY
                                             +  ( 120 *  WK-RYOYO )
           END-IF
      *
           INITIALIZE    WK-SYUHKN-TAIHI-AREA
      *
      *    公費単独で老人保険入力があるかチェック
           IF      COMB-HKNNUM          =   SPACE
           AND     COMB-KOH1HKNNUM  NOT =   SPACE
           AND     COMB-KOH2HKNNUM      =   SPACE
           AND     COMB-KOH3HKNNUM      =   SPACE
           AND     COMB-KOH4HKNNUM      =   SPACE
                IF   LNK-SYU-SRYYMD(1:6)  >=   "200804"
                     MOVE   "968"   TO  WK-KOHNUM
                ELSE
                     MOVE   "027"   TO  WK-KOHNUM
                END-IF
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    WK-KOHNUM            TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF      PTKOH-TEKSTYMD(1:6)  <=
                                                 LNK-SYU-SRYYMD(1:6)
                        AND     LNK-SYU-SRYYMD(1:6)  <=
                                                 PTKOH-TEKEDYMD(1:6)
                        AND     PTKOH-SAKJOKBN   =  SPACE
                           MOVE   "1"           TO  FLG-ROUJINHOKEN
                           MOVE    1            TO  FLG-PTKOHINF     
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF   
                    END-PERFORM
                END-IF
      *
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
           MOVE      ZERO       TO    FLG-KENPOJYUNKYO
                                      FLG-SYUGAKUMAE
           IF    LNK-SYU-SRYYMD(1:6)    >=   "200210"
      *        患者年齢計算
               INITIALIZE                           PTINF-REC
               MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM
               MOVE    LNK-SYU-PTID         TO      PTINF-PTID
               MOVE    PTINF-REC            TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "tbl_ptinf"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptinf"      TO      MCP-TABLE
                   MOVE    "key"            TO      MCP-PATHNAME
                   PERFORM  PTINF-READ-SEC
               ELSE
                   DISPLAY   "PTINF SELECT ERR"
                   INITIALIZE                   PTINF-REC
               END-IF
      *
               MOVE    "tbl_ptinf"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
               INITIALIZE                    ORCSAGECHKAREA
               MOVE    LNK-SYU-HOSPNUM   TO  AGECHK-HOSPNUM
               MOVE    LNK-SYU-PTID      TO  AGECHK-PTID
               MOVE    LNK-SYU-SRYYMD    TO  AGECHK-SRYYMD
               MOVE    PTINF-BIRTHDAY    TO  AGECHK-BIRTHDAY
               MOVE    LNK-SYU-HKNCOMBINUM
                                         TO  AGECHK-HKNCOMBINUM
               MOVE    LNK-SYU-NYUGAIKBN TO  AGECHK-NYUGAIKBN
               CALL    "ORCSAGECHK"          USING
                                             ORCSAGECHKAREA
                                             SPA-AREA
               IF      AGECHK-RC       =   ZERO
                   IF  ( AGECHK-NENREI   >=  70      ) OR
                       ( AGECHK-NENREI   >=  65  AND
                         COMB-KOH1HKNNUM  = "027"    ) OR
      ***              ( AGECHK-NENREI   >=  65  AND
      ***                FLG-ROUJINHOKEN  = "1"      ) OR
      ***              ( AGECHK-NENREI   >=  65  AND
      ***                COMB-HKNNUM      = "039"    )
                       ( FLG-ROUJINHOKEN  = "1"      ) OR
                       ( COMB-HKNNUM      = "039"    )
                     IF  LNK-S02-KOUREI-NYUIN-KBN     =   SPACE
                       MOVE  "1"     TO  LNK-S02-KOUREI-NYUIN-KBN
                     END-IF
                   ELSE
                     IF  LNK-S02-KOUREI-NYUIN-KBN     =   "1"
                       MOVE  SPACE   TO  LNK-S02-KOUREI-NYUIN-KBN
                     END-IF
                   END-IF
                   MOVE   AGECHK-FTNRATE  TO  LNK-SYU-PTFTNRATE
                   IF    WK-HKNKBN        =  "1"
                     IF   AGECHK-HKNKBN   =   4  OR  5
                       MOVE     1         TO  FLG-KENPOJYUNKYO
                     END-IF
                   END-IF
                   MOVE   AGECHK-SYUGAKUKBN
                                          TO  FLG-SYUGAKUMAE
               ELSE
                   DISPLAY  "PTINF AGE-CHK ERR " LNK-SYU-PTID
                   MOVE  SPACE       TO  LNK-S02-KOUREI-NYUIN-KBN
               END-IF
           END-IF
      *
           IF   LNK-S02-KOUREI-NYUIN-KBN   =  "1"
               IF  COMB-SYU-HKNKOHSBTKBN   =   "8"
                   MOVE  SPACE       TO  LNK-S02-KOUREI-NYUIN-KBN
               END-IF
               IF  COMB-HKNNUM  =  "971" OR "973" OR "975"
                                OR "068" OR "069" OR "040"
                   MOVE  SPACE       TO  LNK-S02-KOUREI-NYUIN-KBN
               END-IF
           END-IF                                               
      *
      *    前期高齢者（７０歳〜７４歳）
           MOVE      ZERO       TO    FLG-ZENKI-TOKUREI
           IF    LNK-SYU-SRYYMD(1:6)    >=   "200804"
           AND   LNK-SYU-SRYYMD(1:6)    <=   "200903"
             IF  (COMB-HKNNUM                =   SPACE   )
             OR  (COMB-SYU-HKNKOHSBTKBN      =   "8"     )
             OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                               OR "068" OR "069" OR "040"
                                                 OR "039")
             OR  (AGECHK-NENREI         <     70         )
             OR  (AGECHK-NENREI         >     74         )
               CONTINUE
             ELSE
               IF  COMB-HOJOKBN  =  "1"  OR  "9"
                  MOVE    1     TO    FLG-ZENKI-TOKUREI
               END-IF
             END-IF
           END-IF
      *
      *    一般経過措置対象者
           MOVE      ZERO     TO    FLG-KEIKASOCHI-IPAN
           IF  (LNK-S02-KOUREI-NYUIN-KBN      =   "1"    )
           AND (LNK-SYU-SRYYMD(1:6)          >=  "200608")
      *    AND (LNK-SYU-SRYYMD(1:6)          <=  "200808")
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "978"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                     MCPDATA-REC
                                                     SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD(1:6)  <=
                                                 LNK-SYU-SRYYMD(1:6))
                        AND (LNK-SYU-SRYYMD(1:6)  <=
                                                 PTKOH-TEKEDYMD(1:6))
                        AND (PTKOH-SAKJOKBN   =  SPACE              )
                           MOVE    1         TO  FLG-KEIKASOCHI-IPAN
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
      *    減額・免除・支払猶予対象者
           MOVE     ZERO     TO     WK-GENGAKUKBN
           MOVE     ZERO     TO     WK-GENGAKU-KOHID
      *
           IF   (LNK-SYU-SRYYMD(1:6)       >=  "200610")
           AND  (COMB-HKNNUM            NOT =   SPACE  )
      *
            IF  (COMB-SYU-HKNKOHSBTKBN      =   "8"     )
            OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                              OR "068" OR "069" OR "040")
              CONTINUE
            ELSE
              PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                         UNTIL   (GEN-IDX    >    TBL-GENGAKU-MAX)
                           OR    (WK-GENGAKUKBN   NOT = ZERO     )
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    TBL-GENGAKU(GEN-IDX) TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           EVALUATE   GEN-IDX
                             WHEN        1
                               MOVE    1     TO  WK-GENGAKUKBN
                               MOVE   PTKOH-KOHID
                                             TO  WK-GENGAKU-KOHID
                             WHEN        2
                               MOVE    2     TO  WK-GENGAKUKBN
                               MOVE   PTKOH-KOHID
                                             TO  WK-GENGAKU-KOHID
                             WHEN        3
                               MOVE    3     TO  WK-GENGAKUKBN
                             WHEN        4
                               MOVE    4     TO  WK-GENGAKUKBN
                           END-EVALUATE
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-PERFORM
            END-IF
      *
            IF   WK-GENGAKUKBN    =   2
                   MOVE     ZERO    TO    WK-GENGAKUKBN
            END-IF
            MOVE   WK-GENGAKUKBN    TO    LNK-SYU-YKZKENNUM
      *
           END-IF
      *
      *    高額委任払い制度対象者
           MOVE      ZERO     TO    FLG-KOHININBARAI
           MOVE      ZERO     TO    WK-KOHININBARAI-KOHID
           IF   LNK-S02-KOUREI-NYUIN-KBN      =   "1"
                CONTINUE
           ELSE
            IF   COMB-HKNNUM      NOT =  SPACE
            AND  COMB-KOH1HKNNUM      =  SPACE
            AND  COMB-KOH2HKNNUM      =  SPACE
            AND  COMB-KOH3HKNNUM      =  SPACE
            AND  COMB-KOH4HKNNUM      =  SPACE
              IF  (COMB-SYU-HKNKOHSBTKBN      =   "8"     )
              OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                                OR "068" OR "069" OR "040")
                CONTINUE
              ELSE
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "964"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           MOVE    1         TO  FLG-KOHININBARAI
                           MOVE   PTKOH-KOHID
                                             TO  WK-KOHININBARAI-KOHID
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
            END-IF
           END-IF
      *
      *    ７０歳未満高額現物給付対象者
           MOVE      ZERO     TO    FLG-GENBUTU70
           IF     LNK-SYU-SRYYMD(1:6)       >=  "200704"
             IF  (LNK-S02-KOUREI-NYUIN-KBN   =   "1"     )
             OR  (COMB-HKNNUM                =   SPACE   )
             OR  (COMB-SYU-HKNKOHSBTKBN      =   "8"     )
             OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                               OR "068" OR "069" OR "040")
               CONTINUE
             ELSE
               PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                          UNTIL   (GEN-IDX    >    TBL-GENBUTU70-MAX)
                            OR    (FLG-GENBUTU70   NOT = ZERO       )
                 INITIALIZE                         PTKOHINF-REC
                 MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
                 MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
                 MOVE    TBL-GENBUTU70(GEN-IDX) TO  PTKOH-KOHNUM
                 MOVE    PTKOHINF-REC           TO  MCPDATA-REC
                 MOVE    "DBSELECT"             TO  MCP-FUNC
                 MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
                 MOVE    "key4"                 TO  MCP-PATHNAME
                 CALL    "ORCDBMAIN"            USING  MCPAREA
                                                       MCPDATA-REC
                                                       SPA-AREA
                 IF      MCP-RC               =       ZERO
                     MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                     MOVE    "key4"             TO  MCP-PATHNAME
                     PERFORM  PTKOHINF-READ-SEC
                     PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           EVALUATE   GEN-IDX
                             WHEN        1
                               MOVE    1   TO  FLG-GENBUTU70
                             WHEN        2
                               IF    FLG-SANSHOU3  =  SPACE
                                 MOVE  2   TO  FLG-GENBUTU70
                               ELSE
                                 MOVE  3   TO  FLG-GENBUTU70
                               END-IF
                           END-EVALUATE
                           MOVE    1       TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                           MOVE    "key4"             TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                     END-PERFORM
                 END-IF
                 MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
                 MOVE    "key4"                 TO  MCP-PATHNAME
                 PERFORM  DB-CLOSE-SEC
               END-PERFORM
             END-IF
           END-IF
      *
      *    高額４回目以降対象者
           MOVE      ZERO     TO    FLG-KOHYONKAIME
           IF  ( LNK-S02-KOUREI-NYUIN-KBN      =   "1")
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "965"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD(1:6)  <=
                                                 LNK-SYU-SRYYMD(1:6))
                        AND (LNK-SYU-SRYYMD(1:6)  <=
                                                 PTKOH-TEKEDYMD(1:6))
                        AND (PTKOH-SAKJOKBN   =  SPACE              )
                           MOVE    1         TO  FLG-KOHYONKAIME
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
           IF  ( FLG-GENBUTU70             NOT =  ZERO)
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "965"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           MOVE    1         TO  FLG-KOHYONKAIME
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
           IF    (FLG-GENBUTU70   NOT =  ZERO)
           AND   (FLG-KOHININBARAI    =    1 )
              MOVE   ZERO     TO    FLG-KOHININBARAI
           END-IF
           IF     FLG-GENBUTU70   NOT =  ZERO
              EVALUATE   FLG-GENBUTU70
                WHEN        1
                WHEN        2
                  MOVE     80100   TO   WK-GEN70-GENDOGAKU
                  IF  FLG-KOHYONKAIME = 1
                     MOVE  44400   TO   WK-GEN70-GENDOGAKU
                  END-IF
                WHEN        3
                  MOVE     35400   TO   WK-GEN70-GENDOGAKU
                  IF  FLG-KOHYONKAIME = 1
                     MOVE  24600   TO   WK-GEN70-GENDOGAKU
                  END-IF
              END-EVALUATE
              IF   ( COMB-KOH1HKNNUM  =   "972" )
              OR   ( COMB-KOH2HKNNUM  =   "972" )
              OR   ( COMB-KOH3HKNNUM  =   "972" )
              OR   ( COMB-KOH4HKNNUM  =   "972" )
                 IF   WK-GEN70-GENDOGAKU > 10000
                    MOVE   10000   TO  WK-GEN70-GENDOGAKU
                 END-IF
              END-IF
              IF   ( COMB-KOH1HKNNUM  =   "974" )
              OR   ( COMB-KOH2HKNNUM  =   "974" )
              OR   ( COMB-KOH3HKNNUM  =   "974" )
              OR   ( COMB-KOH4HKNNUM  =   "974" )
                 IF   WK-GEN70-GENDOGAKU > 20000
                    MOVE   20000   TO  WK-GEN70-GENDOGAKU
                 END-IF
              END-IF
           END-IF
      *
           MOVE      15000       TO     WK-SEIHO-GENDO
           IF  FLG-KOHYONKAIME = 1
              MOVE   24600       TO     WK-SEIHO-GENDO70
           ELSE
              MOVE   35400       TO     WK-SEIHO-GENDO70
           END-IF
           MOVE      10000       TO     WK-CYOKI-GENDO
           MOVE      20000       TO     WK-CYOKI-GENDO2
      *
      *    減額（割合・金額）の取込み処理
      *    公費負担限度額の減額
           IF    WK-GENGAKUKBN    NOT  =   ZERO
               PERFORM     2001-KOHGENDO-GEN-SEC
           END-IF
      *
      *    保険番号テーブルから公費の負担上限金額の取得
           PERFORM         210-HOKEN-KAISU-SEC
      *
      *    診療月内の収納マスタから公費毎の患者負担金額の
      *    累計を調査
           PERFORM         220-SYUNOU-SEC
      *
      *    保険・公費の負担金計算
           PERFORM         230-FTNKIN-SEC
      *
           .
      *
       200-HKNFTN-SANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *        減額（割合・金額）の取込み処理                          *
      *        公費負担限度額の減額                                    *
      ******************************************************************
       2001-KOHGENDO-GEN-SEC           SECTION.
      *
           IF   WK-GENGAKUKBN   =   1   OR   2
      *
                MOVE       ZERO           TO  WK-GENGAKU-RITU
                                              WK-GENGAKU-KIN
      *
      *         公費月上限額取得
                INITIALIZE                    LNK-ORCSJGNGET-REC
                MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
                MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
                MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
                EVALUATE   WK-GENGAKUKBN
                  WHEN         1
                     MOVE    "960"        TO  LNK-ORCSJGNGET-KOHHKNNUM
                  WHEN         2
                     MOVE    "961"        TO  LNK-ORCSJGNGET-KOHHKNNUM
                END-EVALUATE
                MOVE  WK-GENGAKU-KOHID    TO  LNK-ORCSJGNGET-KOHID
                MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
      *
                CALL    "ORCSJGNGET"      USING
                                          LNK-ORCSJGNGET-REC
                                          SPA-AREA
      *
                IF    LNK-ORCSJGNGET-RC   =   ZERO
                    EVALUATE   WK-GENGAKUKBN
                      WHEN          1
                         MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                          TO  WK-GENGAKU-RITU
                         IF   WK-GENGAKU-RITU  >  100
                             MOVE   100   TO  WK-GENGAKU-RITU
                         END-IF
                      WHEN          2
                         MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                          TO  WK-GENGAKU-KIN
                    END-EVALUATE
                END-IF
      *
           END-IF
      *
           IF   WK-KOH-GENDOGAKU  NOT = ZERO
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   WK-KOH-GENDOGAKU
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  WK-KOH-GENDOGAKU  =
                             WK-KOH-GENDOGAKU  *
                             WK-GENGAKU-RITUX  /
                             100
                  END-IF
                WHEN          2
                  CONTINUE
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   WK-KOH-GENDOGAKU
              END-EVALUATE
              COMPUTE  WK-KOH-GENDOGAKU =
                       WK-KOH-GENDOGAKU +  5
              COMPUTE  WK-KOH-GENDOGAKU =
                       WK-KOH-GENDOGAKU /  10
              COMPUTE  WK-KOH-GENDOGAKU =
                       WK-KOH-GENDOGAKU *  10
           END-IF
      *
           IF   WK-GEN70-GENDOGAKU  NOT = ZERO
              IF   WK-GEN70-GENDOGAKU  = 80100
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     END-IF
                   WHEN          2
                     CONTINUE
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU
                 END-EVALUATE
              ELSE
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     ELSE
                       COMPUTE  WK-GENGAKU-RITUX =
                                100 - WK-GENGAKU-RITU
                       COMPUTE  WK-GEN70-GENDOGAKU  =
                                WK-GEN70-GENDOGAKU  *
                                WK-GENGAKU-RITUX  /
                                100
                     END-IF
                   WHEN          2
                     CONTINUE
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU
                 END-EVALUATE
                 COMPUTE  WK-GEN70-GENDOGAKU =
                          WK-GEN70-GENDOGAKU +  5
                 COMPUTE  WK-GEN70-GENDOGAKU =
                          WK-GEN70-GENDOGAKU /  10
                 COMPUTE  WK-GEN70-GENDOGAKU =
                          WK-GEN70-GENDOGAKU *  10
              END-IF
           END-IF
      *
           EVALUATE   WK-GENGAKUKBN
             WHEN          1
               IF  WK-GENGAKU-RITU = 100
                 MOVE   ZERO   TO   WK-SEIHO-GENDO
                                    WK-SEIHO-GENDO70
                                    WK-CYOKI-GENDO
                                    WK-CYOKI-GENDO2
               ELSE
                 COMPUTE  WK-GENGAKU-RITUX =
                          100 - WK-GENGAKU-RITU
                 COMPUTE  WK-SEIHO-GENDO    =
                          WK-SEIHO-GENDO    *
                          WK-GENGAKU-RITUX  /
                          100
                 COMPUTE  WK-SEIHO-GENDO70  =
                          WK-SEIHO-GENDO70  *
                          WK-GENGAKU-RITUX  /
                          100
                 COMPUTE  WK-CYOKI-GENDO    =
                          WK-CYOKI-GENDO    *
                          WK-GENGAKU-RITUX  /
                          100
                 COMPUTE  WK-CYOKI-GENDO2   =
                          WK-CYOKI-GENDO2   *
                          WK-GENGAKU-RITUX  /
                          100
               END-IF
             WHEN          2
               CONTINUE
             WHEN          3
             WHEN          4
               MOVE     ZERO   TO   WK-SEIHO-GENDO
                                    WK-SEIHO-GENDO70
                                    WK-CYOKI-GENDO
                                    WK-CYOKI-GENDO2
           END-EVALUATE
           COMPUTE  WK-SEIHO-GENDO   =
                    WK-SEIHO-GENDO   +  5
           COMPUTE  WK-SEIHO-GENDO   =
                    WK-SEIHO-GENDO   /  10
           COMPUTE  WK-SEIHO-GENDO   =
                    WK-SEIHO-GENDO   *  10
           COMPUTE  WK-SEIHO-GENDO70 =
                    WK-SEIHO-GENDO70 +  5
           COMPUTE  WK-SEIHO-GENDO70 =
                    WK-SEIHO-GENDO70 /  10
           COMPUTE  WK-SEIHO-GENDO70 =
                    WK-SEIHO-GENDO70 *  10
           COMPUTE  WK-CYOKI-GENDO   =
                    WK-CYOKI-GENDO   +  5
           COMPUTE  WK-CYOKI-GENDO   =
                    WK-CYOKI-GENDO   /  10
           COMPUTE  WK-CYOKI-GENDO   =
                    WK-CYOKI-GENDO   *  10
           COMPUTE  WK-CYOKI-GENDO2  =
                    WK-CYOKI-GENDO2  +  5
           COMPUTE  WK-CYOKI-GENDO2  =
                    WK-CYOKI-GENDO2  /  10
           COMPUTE  WK-CYOKI-GENDO2  =
                    WK-CYOKI-GENDO2  *  10
      *
           .
      *
       2001-KOHGENDO-GEN-EXT.
           EXIT.
      *
      ******************************************************************
      *        保険・公費の設定上限金額の取得　　　　　                *
      ******************************************************************
       210-HOKEN-KAISU-SEC           SECTION.
      *
           INITIALIZE         WK-CHIHOU-FLG-TAIHI-AREA.
      *
           PERFORM    2101-PTHKNINF-KENSAKU-SEC.
      *
      *    患者負担金算出前の１００％負担額算出
           MOVE      ZERO      TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX9    FROM    1   BY  1
                     UNTIL     IDX9       >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                            (LNK-SYU-HKNTEN (IDX9) *  10)
           END-PERFORM.
      *
      *    *公費１の上限金額取込み
           IF (COMB-KOH1HKNNUM           NOT =  SPACE)    AND
              (COMB-KOH1-NYUJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH1HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH1HKNNUM    =     "027"
                       MOVE     COMB-KOH1PAYKBN
                                         TO    WK-PAYKBN
               ELSE
                       MOVE     "00"     TO    WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                       OR
                  ((HKN-TEKSTYMD(1:6)     <=  LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <=  HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            =  HKN-PAYKBN))
                     MOVE     "tbl_hknnum"    TO    MCP-TABLE
                     MOVE     "key2"          TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   2103-KOH1-KAISU-SEC
                 END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"     TO    MCP-TABLE
               MOVE     "key2"           TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF  (LNK-S02-KOUREI-NYUIN-KBN  =   "1" )
               AND (COMB-KOH1HKNNUM           =  "010")
                    MOVE   WK-KOH-GENDOGAKU
                                       TO   MAX-KIN-KOHI1-M
                    MOVE    "1"        TO   COMB-KOH1-NYUJGNKBN
               END-IF
               IF  (FLG-GENBUTU70   NOT =   ZERO)
               AND (COMB-KOH1HKNNUM     =  "010")
                    MOVE   WK-GEN70-GENDOGAKU
                                       TO   MAX-KIN-KOHI1-M
                    MOVE    "1"        TO   COMB-KOH1-NYUJGNKBN
                    EVALUATE  WK-GEN70-GENDOGAKU
                      WHEN       80100
                        MOVE  WK-ZENGAKU TO WK-KOUREI-IRYOHI70K
                        MOVE  1          TO FLG-IRYOHI70K
                    END-EVALUATE
               END-IF
      *
               IF    (COMB-KOH1HKNNUM       =  "021"   )
               AND   (LNK-SYU-SRYYMD(1:6)   >= "200604")
                  CONTINUE
               ELSE
                 IF    COMB-KOH1HKNNUM       =  "010" OR "021"
                     IF    FLG-SEISINJYO  =   1
                        MOVE   ZERO   TO    MAX-KIN-KOHI1-M
                        MOVE   SPACE  TO    COMB-KOH1-NYUJGNKBN
                        MOVE   ZERO   TO    FLG-IRYOHI70K
                     END-IF
                 END-IF
               END-IF
      *
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
               AND ( COMB-KOH1HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH1HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   40200   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(1)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH1HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH1HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH1HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH1HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
               END-IF
      *
           END-IF.
      *
      *    *公費２の上限金額取込み
           IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
              (COMB-KOH2-NYUJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH2HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                      OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum"    TO    MCP-TABLE
                     MOVE     "key2"          TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   2104-KOH2-KAISU-SEC
                 END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF  (LNK-S02-KOUREI-NYUIN-KBN  =   "1" )
               AND (COMB-KOH2HKNNUM           =  "010")
                    MOVE   WK-KOH-GENDOGAKU
                                       TO   MAX-KIN-KOHI2-M
                    MOVE    "1"        TO   COMB-KOH2-NYUJGNKBN
               END-IF
      *
               IF    (COMB-KOH2HKNNUM       =  "021"   )
               AND   (LNK-SYU-SRYYMD(1:6)   >= "200604")
                  CONTINUE
               ELSE
                 IF    COMB-KOH2HKNNUM       =  "010" OR "021"
                     IF    FLG-SEISINJYO  =   1
                        MOVE   ZERO   TO    MAX-KIN-KOHI2-M
                        MOVE   SPACE  TO    COMB-KOH2-NYUJGNKBN
                     END-IF
                 END-IF
               END-IF
      *
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
               AND ( COMB-KOH2HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH2HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   40200   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(2)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH2HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH2HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH2HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH2HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
               END-IF
      *
           END-IF.
      *
      *    *公費３の上限金額取込み
           IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
              (COMB-KOH3-NYUJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH3HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                      OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum"    TO    MCP-TABLE
                     MOVE     "key2"          TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   2105-KOH3-KAISU-SEC
                 END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
               AND ( COMB-KOH3HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH3HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   40200   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(3)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH3HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH3HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH3HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH3HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
               END-IF
      *
           END-IF.
      *
      *    *公費４の上限金額取込み
           IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
              (COMB-KOH4-NYUJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH4HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                       OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum"    TO    MCP-TABLE
                     MOVE     "key2"          TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   2106-KOH4-KAISU-SEC
                 END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
               AND ( COMB-KOH4HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH4HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   40200   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(4)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH4HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH4HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH4HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH4HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
               END-IF
      *
           END-IF.
      *
      *    北海道・特定疾患（０５１）（道単独事業）
      *
           INITIALIZE        WK-DOTANDOKU-TBL.
      *
           IF     (WK-1001-PREFNUM         =  01     )
           AND    (LNK-SYU-SRYYMD(1:6)    >= "200510")
      *
             PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                         UNTIL    KOH-IDX      >    4
      *
              IF  COMB-KOHHKNNUM(KOH-IDX) = "051"
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    COMB-KOHID(KOH-IDX)  TO  PTKOH-KOHID
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key8"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key8"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    IF       FLG-PTKOHINF    =       ZERO
                      IF  PTKOH-JKYSNUM(1:2) >= "91" AND <= "95"
                         MOVE    1    TO   WK-DOTANDOKU(KOH-IDX)
                         MOVE    1    TO   WK-DOTANDOKUFLG(KOH-IDX)
                      END-IF
                      IF  PTKOH-JKYSNUM(1:2) >= "71" AND <= "88"
                         MOVE    1    TO   WK-DOTANDOKU(KOH-IDX)
                      END-IF
                    END-IF
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key8"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
      *
             END-PERFORM
      *
           END-IF.
      *
      *    患者公費負担（金額）取り込み
           IF    LNK-SYU-SRYYMD(1:6)   <   "200304"
               CONTINUE
           ELSE
               PERFORM   2107-KOHFTN-KINGAKU-SEC
           END-IF.
      *
           IF  LNK-S02-KOUREI-NYUIN-KBN   =   "1"
               IF  COMB-KOH1-HKNKOHSBTKBN   =   "3"
                   EVALUATE   COMB-KOH1PAYKBN
                       WHEN   "01"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF  FLG-SANSHOU3     =   SPACE               
                               MOVE   44400   TO   MAX-KIN-KOHI1-M
                           ELSE
                             IF  FLG-SANSHOU3     =   "1" OR "4"
                               MOVE   15000   TO   MAX-KIN-KOHI1-M
                             ELSE
                               MOVE   24600   TO   MAX-KIN-KOHI1-M
                             END-IF
                           END-IF
                         ELSE
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF  FLG-SANSHOU3     =   SPACE               
                               MOVE   40200   TO   MAX-KIN-KOHI1-M
                           ELSE
                             IF  FLG-SANSHOU3     =   "1" OR "4"
                               MOVE   15000   TO   MAX-KIN-KOHI1-M
                             ELSE
                               MOVE   24600   TO   MAX-KIN-KOHI1-M
                             END-IF
                           END-IF
                         END-IF
                       WHEN   "02"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                             MOVE   44400       TO   MAX-KIN-KOHI1-M
                           ELSE
                            IF  FLG-KOHYONKAIME      =  1
                             MOVE   44400       TO   MAX-KIN-KOHI1-M
                            ELSE
                             MOVE   80100       TO   MAX-KIN-KOHI1-M
                             IF  (COMB-KOH2HKNNUM    =  SPACE)              
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   1           TO   FLG-IRYOHI
                             END-IF
                            END-IF
                           END-IF
                         ELSE
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                             MOVE   40200       TO   MAX-KIN-KOHI1-M
                           ELSE
                            IF  FLG-KOHYONKAIME      =  1
                             MOVE   40200       TO   MAX-KIN-KOHI1-M
                            ELSE
                             MOVE   72300       TO   MAX-KIN-KOHI1-M
                             IF  (COMB-KOH2HKNNUM    =  SPACE)              
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   1           TO   FLG-IRYOHI
                             END-IF
                            END-IF
                           END-IF
                         END-IF
                       WHEN   "03"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                             MOVE   44400       TO   MAX-KIN-KOHI1-M
                           ELSE
                            IF  FLG-KOHYONKAIME      =  1
                             MOVE   44400       TO   MAX-KIN-KOHI1-M
                            ELSE
                             MOVE   80100       TO   MAX-KIN-KOHI1-M
                             IF  (COMB-KOH2HKNNUM    =  SPACE)              
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   1           TO   FLG-IRYOHI
                             END-IF
                            END-IF
                           END-IF
                         END-IF
                   END-EVALUATE
               ELSE
                   EVALUATE   COMB-HOJOKBN
                       WHEN   "1"
                       WHEN   "5"
                       WHEN   "9"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           IF  FLG-SANSHOU3      =   SPACE              
                               MOVE   44400   TO   MAX-KIN-SYU-M
                           ELSE
                             IF  FLG-SANSHOU3     =   "1" OR "4"
                               MOVE   15000   TO   MAX-KIN-SYU-M
                             ELSE
                               MOVE   24600   TO   MAX-KIN-SYU-M
                             END-IF
                           END-IF
                         ELSE
                           IF  FLG-SANSHOU3      =   SPACE              
                               MOVE   40200   TO   MAX-KIN-SYU-M
                           ELSE
                             IF  FLG-SANSHOU3     =   "1" OR "4"
                               MOVE   15000   TO   MAX-KIN-SYU-M
                             ELSE
                               MOVE   24600   TO   MAX-KIN-SYU-M
                             END-IF
                           END-IF
                         END-IF
                       WHEN   "2"
                       WHEN   "6"
                       WHEN   "8"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                             MOVE   44400       TO   MAX-KIN-SYU-M
                           ELSE
                            IF  FLG-KOHYONKAIME      =  1
                             MOVE   44400       TO   MAX-KIN-SYU-M
                            ELSE
                             MOVE   80100       TO   MAX-KIN-SYU-M
                             IF  (COMB-KOH1HKNNUM    =  SPACE)              
                             AND (COMB-KOH2HKNNUM    =  SPACE)
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   2           TO   FLG-IRYOHI
                             END-IF
                            END-IF
                           END-IF
                         ELSE
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                             MOVE   40200       TO   MAX-KIN-SYU-M
                           ELSE
                            IF  FLG-KOHYONKAIME      =  1
                             MOVE   40200       TO   MAX-KIN-SYU-M
                            ELSE
                             MOVE   72300       TO   MAX-KIN-SYU-M
                             IF  (COMB-KOH1HKNNUM    =  SPACE)              
                             AND (COMB-KOH2HKNNUM    =  SPACE)
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   2           TO   FLG-IRYOHI
                             END-IF
                            END-IF
                           END-IF
                         END-IF
                       WHEN   "3"
                       WHEN   "7"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                             MOVE   44400       TO   MAX-KIN-SYU-M
                           ELSE
                            IF  FLG-KOHYONKAIME      =  1
                             MOVE   44400       TO   MAX-KIN-SYU-M
                            ELSE
                             MOVE   80100       TO   MAX-KIN-SYU-M
                             IF  (COMB-KOH1HKNNUM    =  SPACE)              
                             AND (COMB-KOH2HKNNUM    =  SPACE)
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   2           TO   FLG-IRYOHI
                             END-IF
                            END-IF
                           END-IF
                         END-IF
                   END-EVALUATE
               END-IF
           END-IF.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =      "1"   )
           AND ( COMB-HKNNUM            NOT   =     SPACE  )
      *
                IF   COMB-KOH1HKNNUM      =    "027"
                   IF (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH4HKNNUM(1:2)   =     "99"))
                   OR (( COMB-KOH2HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(2)        =      1  ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(2)        =      1  ) AND
                       ( COMB-KOH3HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                          IF   MAX-KIN-KOHI1-M    =  72300 OR 80100
                             MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                             MOVE   1           TO   FLG-IRYOHI3
                             MOVE   21          TO   FLG-IRYOHI3X
                          END-IF
                   ELSE
                    IF   ( COMB-KOH2HKNNUM   =   "012" )
                    OR   ( COMB-KOH3HKNNUM   =   "012" )
                    OR   ( COMB-KOH4HKNNUM   =   "012" )
                        IF   MAX-KIN-KOHI1-M   >  15000
                            MOVE   15000   TO   MAX-KIN-KOHI1-M
                        END-IF
                    ELSE
                     IF   ( COMB-KOH2HKNNUM  =   "972" )
                     OR   ( COMB-KOH3HKNNUM  =   "972" )
                     OR   ( COMB-KOH4HKNNUM  =   "972" )
                        IF   MAX-KIN-KOHI1-M   >  10000
                            MOVE   10000   TO   MAX-KIN-KOHI1-M
                        END-IF
                     ELSE
                      IF  ( COMB-KOH2HKNNUM  =   "974" )
                      OR  ( COMB-KOH3HKNNUM  =   "974" )
                      OR  ( COMB-KOH4HKNNUM  =   "974" )
                        IF   MAX-KIN-KOHI1-M   >  20000
                            MOVE   20000   TO   MAX-KIN-KOHI1-M
                        END-IF
                      ELSE
                        IF  (COMB-KOH2HKNNUM(1:1) = "0")
                        OR  (COMB-KOH3HKNNUM(1:1) = "0")
                        OR  (COMB-KOH4HKNNUM(1:1) = "0")
                           CONTINUE
      **>                  IF  LNK-SYU-SRYYMD(1:6)  >= "200610"
      *****                  IF   MAX-KIN-KOHI1-M   >  44400
      **>                      MOVE   44400   TO   MAX-KIN-KOHI1-M
      *****                  END-IF
      **>                  ELSE
      *****                  IF   MAX-KIN-KOHI1-M   >  40200
      **>                      MOVE   40200   TO   MAX-KIN-KOHI1-M
      *****                  END-IF
      **>                  END-IF
                        END-IF
                      END-IF
                     END-IF
                    END-IF
                   END-IF
                ELSE
                   IF (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM        =    SPACE) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH2HKNNUM        =    SPACE) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(1)        =      1  ) AND
                       ( COMB-KOH2HKNNUM        =    SPACE) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(1)        =      1  ) AND
                       ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                          IF   MAX-KIN-SYU-M      =  72300 OR 80100
                             MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                             MOVE   2           TO   FLG-IRYOHI3
                             MOVE   11          TO   FLG-IRYOHI3X
                          END-IF
                   ELSE
                    IF   ( COMB-KOH1HKNNUM   =   "012" OR "025" )
                    OR   ( COMB-KOH2HKNNUM   =   "012" OR "025" )
                    OR   ( COMB-KOH3HKNNUM   =   "012" OR "025" )
                    OR   ( COMB-KOH4HKNNUM   =   "012" OR "025" )
                        IF   MAX-KIN-SYU-M   >  15000
                            MOVE   15000   TO   MAX-KIN-SYU-M
                        END-IF
                    ELSE
                     IF   ( COMB-KOH1HKNNUM  =   "972" )
                     OR   ( COMB-KOH2HKNNUM  =   "972" )
                     OR   ( COMB-KOH3HKNNUM  =   "972" )
                     OR   ( COMB-KOH4HKNNUM  =   "972" )
                        IF   MAX-KIN-SYU-M   >  10000
                            MOVE   10000   TO   MAX-KIN-SYU-M
                        END-IF
                     ELSE
                      IF  ( COMB-KOH1HKNNUM  =   "974" )
                      OR  ( COMB-KOH2HKNNUM  =   "974" )
                      OR  ( COMB-KOH3HKNNUM  =   "974" )
                      OR  ( COMB-KOH4HKNNUM  =   "974" )
                        IF   MAX-KIN-SYU-M   >  20000
                            MOVE   20000   TO   MAX-KIN-SYU-M
                        END-IF
                      ELSE
                        IF  (COMB-KOH1HKNNUM(1:1) = "0")
                        OR  (COMB-KOH2HKNNUM(1:1) = "0")
                        OR  (COMB-KOH3HKNNUM(1:1) = "0")
                        OR  (COMB-KOH4HKNNUM(1:1) = "0")
                           CONTINUE
      **>                  IF  LNK-SYU-SRYYMD(1:6)  >= "200610"
      *****                  IF   MAX-KIN-SYU-M   >  44400
      **>                      MOVE   44400   TO   MAX-KIN-SYU-M
      *****                  END-IF
      **>                  ELSE
      *****                  IF   MAX-KIN-SYU-M   >  40200
      **>                      MOVE   40200   TO   MAX-KIN-SYU-M
      *****                  END-IF
      **>                  END-IF
                        END-IF
                      END-IF
                     END-IF
                    END-IF
                   END-IF
                END-IF
      *
           END-IF.
      *
           IF  FLG-GENBUTU70   NOT =   ZERO
      *
               EVALUATE   FLG-GENBUTU70
                WHEN        1
                  MOVE    150000   TO   MAX-KIN-SYU-M
                  IF  FLG-KOHYONKAIME = 1
                     MOVE  83400   TO   MAX-KIN-SYU-M
                  END-IF
                WHEN        2
                  MOVE     80100   TO   MAX-KIN-SYU-M
                  IF  FLG-KOHYONKAIME = 1
                     MOVE  44400   TO   MAX-KIN-SYU-M
                  END-IF
                WHEN        3
                  MOVE     35400   TO   MAX-KIN-SYU-M
                  IF  FLG-KOHYONKAIME = 1
                     MOVE  24600   TO   MAX-KIN-SYU-M
                  END-IF
               END-EVALUATE
      *
               IF  (COMB-KOH1HKNNUM    =  SPACE)
               AND (COMB-KOH2HKNNUM    =  SPACE)
               AND (COMB-KOH3HKNNUM    =  SPACE)
               AND (COMB-KOH4HKNNUM    =  SPACE)
                  EVALUATE  MAX-KIN-SYU-M
                   WHEN      150000
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  1           TO  FLG-IRYOHI70
                   WHEN       80100
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  2           TO  FLG-IRYOHI70
                  END-EVALUATE
               END-IF
      *
               IF (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM        =    SPACE) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM(1:2)   =     "99") AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH3HKNNUM(1:2)   =     "99") AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:2)   =     "99") AND
                   ( COMB-KOH2HKNNUM        =    SPACE) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( WK-DOTANDOKU(1)        =      1  ) AND
                   ( COMB-KOH2HKNNUM        =    SPACE) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( WK-DOTANDOKU(1)        =      1  ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
                   IF  (WK-1001-PREFNUM  =  01            )
                   AND (COMB-HKNNUM  NOT = "060" AND "067")
                   AND (COMB-KOH1HKNNUM  =  "141" OR "241")
                   AND (LNK-SYU-SRYYMD(1:6)   <=  "200803")
                     MOVE     80100   TO   MAX-KIN-SYU-M
                     IF  FLG-KOHYONKAIME = 1
                        MOVE  44400   TO   MAX-KIN-SYU-M
                     END-IF
                   END-IF
                   EVALUATE  MAX-KIN-SYU-M
                     WHEN      150000
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  3           TO  FLG-IRYOHI70
                     WHEN       80100
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  4           TO  FLG-IRYOHI70
                   END-EVALUATE
               ELSE
                IF   ( COMB-KOH1HKNNUM   =   "012" OR "025" )
                OR   ( COMB-KOH2HKNNUM   =   "012" OR "025" )
                OR   ( COMB-KOH3HKNNUM   =   "012" OR "025" )
                OR   ( COMB-KOH4HKNNUM   =   "012" OR "025" )
                   IF  FLG-KOHYONKAIME = 1
                      MOVE  24600   TO   WK-GEN70-GENDOGAKU2
                   ELSE
                      MOVE  35400   TO   WK-GEN70-GENDOGAKU2
                   END-IF
                   IF MAX-KIN-SYU-M  >   WK-GEN70-GENDOGAKU2
                      MOVE WK-GEN70-GENDOGAKU2
                                    TO   MAX-KIN-SYU-M
                   END-IF
                ELSE
                 IF   ( COMB-KOH1HKNNUM  =   "972" )
                 OR   ( COMB-KOH2HKNNUM  =   "972" )
                 OR   ( COMB-KOH3HKNNUM  =   "972" )
                 OR   ( COMB-KOH4HKNNUM  =   "972" )
                      IF   MAX-KIN-SYU-M   >  10000
                          MOVE   10000   TO   MAX-KIN-SYU-M
                      END-IF
                 ELSE
                  IF  ( COMB-KOH1HKNNUM  =   "974" )
                  OR  ( COMB-KOH2HKNNUM  =   "974" )
                  OR  ( COMB-KOH3HKNNUM  =   "974" )
                  OR  ( COMB-KOH4HKNNUM  =   "974" )
                      IF   MAX-KIN-SYU-M   >  20000
                          MOVE   20000   TO   MAX-KIN-SYU-M
                      END-IF
                  ELSE
                   IF  (COMB-KOH1HKNNUM(1:1) = "0")
                   OR  (COMB-KOH2HKNNUM(1:1) = "0")
                   OR  (COMB-KOH3HKNNUM(1:1) = "0")
                   OR  (COMB-KOH4HKNNUM(1:1) = "0")
      ***>            IF  FLG-KOHYONKAIME = 1
      ***>              MOVE   44400       TO   MAX-KIN-SYU-M
      ***>            ELSE
                        MOVE   80100       TO   MAX-KIN-SYU-M
                        MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70
                        MOVE   6           TO   FLG-IRYOHI70
      ***>            END-IF
                   END-IF
                  END-IF
                 END-IF
                END-IF
               END-IF
      *
           END-IF.
      *
      *    主保険の減額
      *    長期の減額
           IF    WK-GENGAKUKBN     NOT  =   ZERO
               PERFORM   2109-KOHFTN-KINGAKU-GEN-SEC
           END-IF.
      *
      *    高額委任払い金額取り込み
           IF    FLG-KOHININBARAI       =   1
               PERFORM   2110-KOHININBARAI-KINGAKU-SEC
           END-IF.
      *
      *    ４１老人上限額編集処理等
           PERFORM    2108-ROUJIN41-JYOGEN-HENSYU-SEC.
      *
       210-HOKEN-KAISU-EXT.
           EXIT.
      *
      ***************************************************************
      *        患者保険情報検索
      ***************************************************************
       2101-PTHKNINF-KENSAKU-SEC           SECTION.
      *
           MOVE   ZERO               TO    FLG-SEISINJYO
                                           FLG-TOKUREI-HKNJYA
           MOVE   SPACE              TO    WK-HKNJANUM-TBL
      *
           INITIALIZE                      PTHKNINF-REC
           MOVE   COMB-HOSPNUM       TO    PTHKN-HOSPNUM
           MOVE   COMB-PTID          TO    PTHKN-PTID
           MOVE   COMB-HKNID         TO    PTHKN-HKNID
           MOVE   PTHKNINF-REC       TO    MCPDATA-REC
           MOVE   "DBSELECT"         TO    MCP-FUNC
           MOVE   "tbl_pthkninf"     TO    MCP-TABLE
           MOVE   "key"              TO    MCP-PATHNAME
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_pthkninf"     TO    MCP-TABLE
               MOVE    "key"              TO    MCP-PATHNAME
               PERFORM  PTHKNINF-READ-SEC
               IF      FLG-PTHKNINF   =     ZERO
                  IF   PTHKN-HKNJANUM(1:6) = "133033" OR "133280" OR
                                             "133041" OR "133066" OR
                                             "133074" OR "133090" OR
                                             "133116" OR "133132" OR
                                             "133140" OR "133157" OR
                                             "133165" OR "133173" OR
                                             "133181" OR "133199" OR
                                             "133207" OR "133223" OR
                                             "133249" OR "133256" OR
                                             "133272"
                    IF     COMB-KOH1HKNNUM    =     "027"
                      CONTINUE
                    ELSE
                      MOVE    1      TO    FLG-SEISINJYO
                    END-IF
                  END-IF
                  IF   PTHKN-HKNJANUM      = "67330753"
                      MOVE    1      TO    FLG-TOKUREI-HKNJYA
                  END-IF
                  MOVE    PTHKN-HKNJANUM   TO    WK-HKNJANUM
                  MOVE    PTHKN-HONKZKKBN  TO    WK-HONKZKKBN
                  MOVE    PTHKN-KIGO       TO    WK-KIGO
                  MOVE    PTHKN-NUM        TO    WK-NUM
               END-IF
           END-IF
      *
           MOVE     "tbl_pthkninf"   TO    MCP-TABLE
           MOVE     "key"            TO    MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
      *
       2101-PTHKNINF-KENSAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費１（金額）取込み処理                                *
      ******************************************************************
       2103-KOH1-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH1HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOH1HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH1HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH1HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH1HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOH1HKNNUM(1:1)  >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOH1HKNNUM   = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH1HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH1HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOH1HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOH1HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                 MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                 MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
             MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
             MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
           END-IF.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
           AND ( COMB-KOH1HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH1HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                               20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI1-M             >  40200       )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH1HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    40200   TO    MAX-KIN-KOHI1-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH1HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH1HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH1HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH1HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
       2103-KOH1-KAISU-EXT.
           EXIT.
      ******************************************************************
      *        公費２（金額）取込み処理                                *
      ******************************************************************
       2104-KOH2-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH2HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOH2HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH2HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH2HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH2HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOH2HKNNUM   = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH2HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH2HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOH2HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOH2HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                 MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                 MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
             MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
             MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
           END-IF.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
           AND ( COMB-KOH2HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH2HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                               20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI2-M             >  40200       )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH2HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    40200   TO    MAX-KIN-KOHI2-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH2HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH2HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH2HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH2HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
       2104-KOH2-KAISU-EXT.
           EXIT.
      ******************************************************************
      *        公費３（金額）取込み処理                                *
      ******************************************************************
       2105-KOH3-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH3HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOH3HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH3HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH3HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH3HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOH3HKNNUM(1:1)  >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOH3HKNNUM   = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH3HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH3HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOH3HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOH3HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                 MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                 MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
             MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
             MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
           END-IF.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
           AND ( COMB-KOH3HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH3HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                               20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI3-M             >  40200       )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH3HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    40200   TO    MAX-KIN-KOHI3-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH3HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH3HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH3HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH3HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
       2105-KOH3-KAISU-EXT.
           EXIT.
      ******************************************************************
      *        公費４（金額）取込み処理                                *
      ******************************************************************
       2106-KOH4-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH4HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOH4HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH4HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH4HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH4HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOH4HKNNUM(1:1)  >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOH4HKNNUM   = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH4HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH4HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOH4HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOH4HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                 MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                 MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
             MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
             MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
           END-IF.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
           AND ( COMB-KOH4HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH4HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                               20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI4-M             >  40200       )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH4HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    40200   TO    MAX-KIN-KOHI4-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH4HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH4HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH4HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH4HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
       2106-KOH4-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        患者公費負担（金額）取込み処理                          *
      ******************************************************************
       2107-KOHFTN-KINGAKU-SEC           SECTION.
      *
           INITIALIZE                   WK-TAIHI-NYUJGNGAK-OCC.
      *
           INITIALIZE                   WK-JIRITU-TBL.
           INITIALIZE                   WK-SYOGAI-TBL.
           INITIALIZE                   WK-SYOFUKUMU-TBL.
           MOVE       ZERO     TO       WK-TOTORI-JIRITU.
      *
           PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                      UNTIL    (KOH-IDX    >      4)
      *
             IF ( COMB-KOHHKNNUM(KOH-IDX)      = "015" OR "016" 
                                                       OR "012"      )
      *
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "051"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200310")           )
      *
             OR ((WK-1001-PREFNUM              =  13            )  AND
                 (COMB-KOHHKNNUM(KOH-IDX)      = "151" OR "451" )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200310")           )
      *
             OR ((WK-1001-PREFNUM              =  28     )  AND
                 (COMB-KOHHKNNUM(KOH-IDX)      = "186"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200310"))
      *
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "052"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200504")           )
      *
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "021"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200604")           )
      *
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "024" OR "079" )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200610")           )
      *
             OR ((WK-1001-PREFNUM              =  07     )  AND
                 (COMB-KOHHKNNUM(KOH-IDX)      = "281"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200702"))
      *
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "011"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200704")           )
      *
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "038" OR "025" )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200804")           )
      *
      ***    OR ( COMB-KOHHKNNUM(KOH-IDX)(1:1) = "1" OR "2" OR "3" OR 
      ***                                        "4" OR "5" OR "6" OR
      ***                                        "7" OR "8"          )
      *
                MOVE       ZERO           TO  WK-NYUJGNGAK
      *
      *         公費月上限額取得
                INITIALIZE                    LNK-ORCSJGNGET-REC
                MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
                MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
                MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
                MOVE  COMB-KOHHKNNUM(KOH-IDX)
                                          TO  LNK-ORCSJGNGET-KOHHKNNUM
                MOVE  COMB-KOHID(KOH-IDX) TO  LNK-ORCSJGNGET-KOHID
                MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
                MOVE  LNK-SYU-SKYEDYMD    TO  LNK-ORCSJGNGET-SKYEDYMD
      *
                CALL    "ORCSJGNGET"       USING
                                           LNK-ORCSJGNGET-REC
                                           SPA-AREA
      *
                IF    LNK-ORCSJGNGET-RC   =   ZERO
      *
                     IF  (LNK-SYU-SRYYMD(1:6)     >= "200804"      )
                     AND (COMB-KOHHKNNUM(KOH-IDX)  = "015" OR "016"
                                                           OR "021")
                        IF  LNK-ORCSJGNGET-NYUJGNGAK
                                   = 9999999 OR 999999 OR 40200
                            CONTINUE
                        ELSE
                            MOVE    1    TO    WK-TOTORI-JIRITU
                        END-IF
                     END-IF
      *            全国公費の減額
                     IF    WK-GENGAKUKBN    NOT  =   ZERO
                       PERFORM   21071-KOHFTN-KINGAKU-GEN-SEC
                     END-IF
                     MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                          TO  WK-NYUJGNGAK
                     EVALUATE   KOH-IDX
                      WHEN  1
                        MOVE   WK-NYUJGNGAK    TO   MAX-KIN-KOHI1-M
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                        MOVE     "1"   TO     COMB-KOH1-NYUJGNKBN
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1" 
                            IF  COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "011" OR "025"
                             EVALUATE  COMB-KOHHKNNUM(KOH-IDX)
                             WHEN  "012"
                             WHEN  "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI1-M > WK-SEIHO-GENDO)
                                MOVE  WK-SEIHO-GENDO
                                     TO   MAX-KIN-KOHI1-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                             WHEN  "011"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI1-M > WK-KOH-GENDOGAKU)
                                MOVE  WK-KOH-GENDOGAKU
                                     TO   MAX-KIN-KOHI1-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                             END-EVALUATE
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) = "038") AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200804"))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI1-M    >
                                                      WK-KOH-GENDOGAKU)
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                                 = "0")
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                   MOVE  WK-KOH-GENDOGAKU
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   EVALUATE  WK-KOH-GENDOGAKU
                                    WHEN      15000
      *                             ５割減
                                    WHEN       7500
                                     MOVE 1 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                    WHEN      24600
      *                             ５割減
                                    WHEN      12300
                                     MOVE 2 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                    WHEN      OTHER
                                     MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                   END-EVALUATE
                                 END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(1)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(1)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                            IF    COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "011" OR "025"
                             EVALUATE  COMB-KOHHKNNUM(KOH-IDX)
                             WHEN  "012"
                             WHEN  "025"
                              IF  MAX-KIN-KOHI1-M > WK-SEIHO-GENDO70
                                MOVE WK-SEIHO-GENDO70
                                     TO MAX-KIN-KOHI1-M
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                             WHEN  "011"
                              IF  MAX-KIN-KOHI1-M > WK-GEN70-GENDOGAKU
                                MOVE WK-GEN70-GENDOGAKU
                                     TO MAX-KIN-KOHI1-M
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                             END-EVALUATE
                            ELSE
                              IF  ( COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021"
                                                 OR "024" OR "079"  )
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) = "038") AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200804"))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI1-M    >
                                                    WK-GEN70-GENDOGAKU)
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                                 = "0")
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                   MOVE  WK-GEN70-GENDOGAKU
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  ( COMB-KOHHKNNUM(KOH-IDX) =
                                      "012" OR "011" OR "025" )
                        OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                     "015" OR "016" OR "021" ) AND
                             (LNK-SYU-SRYYMD(1:6) >= "200604"))
                        OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                     "024" OR "079"          ) AND
                             (LNK-SYU-SRYYMD(1:6) >= "200610"))
                        OR  ((COMB-KOHHKNNUM(KOH-IDX) = "038") AND
                             (LNK-SYU-SRYYMD(1:6) >= "200804"))
                          CONTINUE
                        ELSE
                          IF  (COMB-KOH2HKNNUM  = "972") OR
                              (COMB-KOH3HKNNUM  = "972") OR
                              (COMB-KOH4HKNNUM  = "972")
                           IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) = ZERO
                            IF  MAX-KIN-KOHI1-M > WK-CYOKI-GENDO
                             MOVE  WK-CYOKI-GENDO
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                             MOVE  3  TO WK-SYOFUKUMU-FLG(KOH-IDX)
                            END-IF
                           END-IF
                          END-IF
                          IF  (COMB-KOH2HKNNUM  = "974") OR
                              (COMB-KOH3HKNNUM  = "974") OR
                              (COMB-KOH4HKNNUM  = "974")
                           IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) = ZERO
                            IF  MAX-KIN-KOHI1-M > WK-CYOKI-GENDO2
                             MOVE  WK-CYOKI-GENDO2
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                             MOVE  3  TO WK-SYOFUKUMU-FLG(KOH-IDX)
                            END-IF
                           END-IF
                          END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI1-M = 9999999 OR 999999
                              MOVE  1  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  ZERO
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                            ELSE
                              MOVE  2  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                              IF   MAX-KIN-KOHI1-M = ZERO
                                 MOVE   1
                                       TO WK-JIRITU-SKJGENMEN(KOH-IDX)
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "024" OR "079"         )
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200610"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-SYOGAI-SKJGAK(KOH-IDX)
                              IF   WK-SYOGAI-SKJGAK(KOH-IDX) = ZERO
                                 MOVE   1
                                       TO WK-SYOGAI-SKJGENMEN(KOH-IDX)
                              END-IF
                        END-IF
                        IF  (WK-1001-PREFNUM      =  07       )
                        AND (COMB-KOH1HKNNUM      = "281"     )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200702"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF  (COMB-KOH1HKNNUM      = "038"     )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200804"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-KANEN-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1"
                         IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                         AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                         AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  1        )
                            IF    MAX-KIN-KOHI1-M  >  WK-KOH-GENDOGAKU
                                MOVE    WK-KOH-GENDOGAKU
                                                TO   MAX-KIN-KOHI1-M
                                MOVE    WK-KOH-GENDOGAKU  TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            END-IF
                         END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                         IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                         AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  1        )
                            IF    MAX-KIN-KOHI1-M  >  WK-GEN70-GENDOGAKU
                              MOVE    WK-GEN70-GENDOGAKU
                                      TO MAX-KIN-KOHI1-M
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              EVALUATE  WK-GEN70-GENDOGAKU
                               WHEN       80100
                                 MOVE  WK-ZENGAKU TO WK-KOUREI-IRYOHI70K
                                 MOVE  2          TO FLG-IRYOHI70K
                              END-EVALUATE
                            END-IF
                         END-IF
                        END-IF
                        IF  ( LNK-SYU-SRYYMD(1:6)   >= "200604"  )
                        AND ( COMB-KOH1HKNNUM  = "015" OR "016"  )
                        AND ((COMB-KOH2HKNNUM  = "972") OR
                             (COMB-KOH3HKNNUM  = "972") OR
                             (COMB-KOH4HKNNUM  = "972"))
                         IF   WK-JIRITU-CYUKANSOU(KOH-IDX) =  2
                          CONTINUE
                         ELSE
                          IF   MAX-KIN-KOHI1-M   >  WK-CYOKI-GENDO
                            MOVE  WK-CYOKI-GENDO
                                   TO  MAX-KIN-KOHI1-M
                                       WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO            TO  FLG-IRYOHI70K
                          END-IF
                         END-IF
                        END-IF
                        IF  ( LNK-SYU-SRYYMD(1:6)   >= "200604"  )
                        AND ( COMB-KOH1HKNNUM  = "015" OR "016"  )
                        AND ((COMB-KOH2HKNNUM  = "974") OR
                             (COMB-KOH3HKNNUM  = "974") OR
                             (COMB-KOH4HKNNUM  = "974"))
                         IF   WK-JIRITU-CYUKANSOU(KOH-IDX) =  2
                          CONTINUE
                         ELSE
                          IF   MAX-KIN-KOHI1-M   >  WK-CYOKI-GENDO2
                            MOVE  WK-CYOKI-GENDO2
                                   TO  MAX-KIN-KOHI1-M
                                       WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO            TO  FLG-IRYOHI70K
                          END-IF
                         END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI1-M = 9999999 OR 999999
                              IF  LNK-SYU-SRYYMD(1:6)  >= "200610"
                                MOVE  80100   TO   MAX-KIN-KOHI1-M
                                MOVE  80100   TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI
                                MOVE  1           TO  FLG-IRYOHI4
                              ELSE
                                MOVE  72300   TO   MAX-KIN-KOHI1-M
                                MOVE  72300   TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI
                                MOVE  1           TO  FLG-IRYOHI4
                              END-IF
                            END-IF
                        END-IF
                        IF  (WK-1001-PREFNUM =  28                    )
                        AND (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                          IF   COMB-KOH2HKNNUM =  "100" OR "200"
                            MOVE  MAX-KAI-KOHI2-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI2-D  TO  MAX-KIN-KOHI1-D
                            IF   COMB-KOH2HKNNUM  =  "200"
                              MOVE   ZERO          TO  MAX-KIN-KOHI1-M
                            ELSE
                              MOVE MAX-KIN-KOHI2-M TO  MAX-KIN-KOHI1-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                          END-IF
                          IF   COMB-KOH3HKNNUM =  "100" OR "200"
                            MOVE  MAX-KAI-KOHI3-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI3-D  TO  MAX-KIN-KOHI1-D
                            IF   COMB-KOH3HKNNUM  =  "200"
                              MOVE   ZERO          TO  MAX-KIN-KOHI1-M
                            ELSE
                              MOVE MAX-KIN-KOHI3-M TO  MAX-KIN-KOHI1-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                          END-IF
                          IF   COMB-KOH4HKNNUM =  "100" OR "200"
                            MOVE  MAX-KAI-KOHI4-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI4-D  TO  MAX-KIN-KOHI1-D
                            IF   COMB-KOH4HKNNUM  =  "200"
                              MOVE   ZERO          TO  MAX-KIN-KOHI1-M
                            ELSE
                              MOVE MAX-KIN-KOHI4-M TO  MAX-KIN-KOHI1-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                          END-IF
                        END-IF
                      WHEN  2
                        MOVE   WK-NYUJGNGAK    TO   MAX-KIN-KOHI2-M
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                        MOVE     "1"   TO     COMB-KOH2-NYUJGNKBN
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1" 
                            IF  COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "011" OR "025"
                             EVALUATE  COMB-KOHHKNNUM(KOH-IDX)
                             WHEN  "012"
                             WHEN  "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI2-M > WK-SEIHO-GENDO)
                                MOVE  WK-SEIHO-GENDO
                                     TO   MAX-KIN-KOHI2-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                             WHEN  "011"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI2-M > WK-KOH-GENDOGAKU)
                                MOVE  WK-KOH-GENDOGAKU
                                     TO   MAX-KIN-KOHI2-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                             END-EVALUATE
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI2-M    >
                                                      WK-KOH-GENDOGAKU)
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                                 = "0")
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                   MOVE  WK-KOH-GENDOGAKU
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   EVALUATE  WK-KOH-GENDOGAKU
                                    WHEN      15000
      *                             ５割減
                                    WHEN       7500
                                     MOVE 1 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                    WHEN      24600
      *                             ５割減
                                    WHEN      12300
                                     MOVE 2 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                    WHEN      OTHER
                                     MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                   END-EVALUATE
                                 END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(2)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(2)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                            IF    COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "011" OR "025"
                             EVALUATE  COMB-KOHHKNNUM(KOH-IDX)
                             WHEN  "012"
                             WHEN  "025"
                              IF  MAX-KIN-KOHI2-M > WK-SEIHO-GENDO70
                                MOVE WK-SEIHO-GENDO70
                                     TO MAX-KIN-KOHI2-M
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                             WHEN  "011"
                              IF  MAX-KIN-KOHI2-M > WK-GEN70-GENDOGAKU
                                MOVE WK-GEN70-GENDOGAKU
                                     TO MAX-KIN-KOHI2-M
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                             END-EVALUATE
                            ELSE
                              IF  COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021"
                                                 OR "024" OR "079"
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI2-M    >
                                                    WK-GEN70-GENDOGAKU)
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                                 = "0")
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                   MOVE  WK-GEN70-GENDOGAKU
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  ( COMB-KOHHKNNUM(KOH-IDX) =
                                      "012" OR "011" OR "025" )
                        OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                     "015" OR "016" OR "021" ) AND
                             (LNK-SYU-SRYYMD(1:6) >= "200604"))
                        OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                     "024" OR "079"          ) AND
                             (LNK-SYU-SRYYMD(1:6) >= "200610"))
                          CONTINUE
                        ELSE
                          IF  (COMB-KOH1HKNNUM  = "972") OR
                              (COMB-KOH3HKNNUM  = "972") OR
                              (COMB-KOH4HKNNUM  = "972")
                           IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) = ZERO
                            IF  MAX-KIN-KOHI2-M > WK-CYOKI-GENDO
                             MOVE  WK-CYOKI-GENDO
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                             MOVE  3  TO WK-SYOFUKUMU-FLG(KOH-IDX)
                            END-IF
                           END-IF
                          END-IF
                          IF  (COMB-KOH1HKNNUM  = "974") OR
                              (COMB-KOH3HKNNUM  = "974") OR
                              (COMB-KOH4HKNNUM  = "974")
                           IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) = ZERO
                            IF  MAX-KIN-KOHI2-M > WK-CYOKI-GENDO2
                             MOVE  WK-CYOKI-GENDO2
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                             MOVE  3  TO WK-SYOFUKUMU-FLG(KOH-IDX)
                            END-IF
                           END-IF
                          END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI2-M = 9999999 OR 999999
                              MOVE  1  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  ZERO
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                            ELSE
                              MOVE  2  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                              IF   MAX-KIN-KOHI2-M = ZERO
                                 MOVE   1
                                       TO WK-JIRITU-SKJGENMEN(KOH-IDX)
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "024" OR "079"         )
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200610"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-SYOGAI-SKJGAK(KOH-IDX)
                              IF   WK-SYOGAI-SKJGAK(KOH-IDX) = ZERO
                                 MOVE   1
                                       TO WK-SYOGAI-SKJGENMEN(KOH-IDX)
                              END-IF
                        END-IF
                        IF  (WK-1001-PREFNUM      =  07       )
                        AND (COMB-KOH2HKNNUM      = "281"     )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200702"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1"
                         IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                         AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                         AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  1        )
                            IF    MAX-KIN-KOHI2-M  >  WK-KOH-GENDOGAKU
                                MOVE    WK-KOH-GENDOGAKU
                                                TO   MAX-KIN-KOHI2-M
                                MOVE    WK-KOH-GENDOGAKU  TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            END-IF
                         END-IF
                        END-IF
                        IF  ( LNK-SYU-SRYYMD(1:6)   >= "200604"  )
                        AND ( COMB-KOH2HKNNUM  = "015" OR "016"  )
                        AND ((COMB-KOH1HKNNUM  = "972") OR
                             (COMB-KOH3HKNNUM  = "972") OR
                             (COMB-KOH4HKNNUM  = "972"))
                         IF   WK-JIRITU-CYUKANSOU(KOH-IDX) =  2
                          CONTINUE
                         ELSE
                          IF   MAX-KIN-KOHI2-M   >  WK-CYOKI-GENDO
                            MOVE  WK-CYOKI-GENDO
                                   TO  MAX-KIN-KOHI2-M
                                       WK-TAIHI-NYUJGNGAK(KOH-IDX)
                          END-IF
                         END-IF
                        END-IF
                        IF  ( LNK-SYU-SRYYMD(1:6)   >= "200604"  )
                        AND ( COMB-KOH2HKNNUM  = "015" OR "016"  )
                        AND ((COMB-KOH1HKNNUM  = "974") OR
                             (COMB-KOH3HKNNUM  = "974") OR
                             (COMB-KOH4HKNNUM  = "974"))
                         IF   WK-JIRITU-CYUKANSOU(KOH-IDX) =  2
                          CONTINUE
                         ELSE
                          IF   MAX-KIN-KOHI2-M   >  WK-CYOKI-GENDO2
                            MOVE  WK-CYOKI-GENDO2
                                   TO  MAX-KIN-KOHI2-M
                                       WK-TAIHI-NYUJGNGAK(KOH-IDX)
                          END-IF
                         END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI2-M = 9999999 OR 999999
                              IF  LNK-SYU-SRYYMD(1:6)  >= "200610"
                                MOVE  80100   TO   MAX-KIN-KOHI2-M
                                MOVE  80100   TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              ELSE
                                MOVE  72300   TO   MAX-KIN-KOHI2-M
                                MOVE  72300   TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                            END-IF
                        END-IF
                        IF  (WK-1001-PREFNUM =  28                    )
                        AND (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                          IF   COMB-KOH3HKNNUM =  "100" OR "200"
                            MOVE  MAX-KAI-KOHI3-M  TO  MAX-KAI-KOHI2-M
                            MOVE  MAX-KIN-KOHI3-D  TO  MAX-KIN-KOHI2-D
                            IF   COMB-KOH3HKNNUM  =  "200"
                              MOVE   ZERO          TO  MAX-KIN-KOHI2-M
                            ELSE
                              MOVE MAX-KIN-KOHI3-M TO  MAX-KIN-KOHI2-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                          END-IF
                          IF   COMB-KOH4HKNNUM =  "100" OR "200"
                            MOVE  MAX-KAI-KOHI4-M  TO  MAX-KAI-KOHI2-M
                            MOVE  MAX-KIN-KOHI4-D  TO  MAX-KIN-KOHI2-D
                            IF   COMB-KOH4HKNNUM  =  "200"
                              MOVE   ZERO          TO  MAX-KIN-KOHI2-M
                            ELSE
                              MOVE MAX-KIN-KOHI4-M TO  MAX-KIN-KOHI2-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                          END-IF
                        END-IF
                      WHEN  3
                        MOVE   WK-NYUJGNGAK    TO   MAX-KIN-KOHI3-M
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                        MOVE     "1"   TO     COMB-KOH3-NYUJGNKBN
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1" 
                            IF  COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI3-M > WK-SEIHO-GENDO)
                                MOVE  WK-SEIHO-GENDO
                                     TO   MAX-KIN-KOHI3-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI3-M    >
                                                   WK-KOH-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                MOVE  WK-KOH-GENDOGAKU
                                   TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                EVALUATE  WK-KOH-GENDOGAKU
                                 WHEN      15000
      *                          ５割減
                                 WHEN       7500
                                  MOVE 1 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 WHEN      24600
      *                          ５割減
                                 WHEN      12300
                                  MOVE 2 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 WHEN      OTHER
                                  MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-EVALUATE
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(3)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(3)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                            IF    COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "025"
                              IF  MAX-KIN-KOHI3-M > WK-SEIHO-GENDO70
                                MOVE WK-SEIHO-GENDO70
                                     TO MAX-KIN-KOHI3-M
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI3-M    >
                                                 WK-GEN70-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                MOVE  WK-GEN70-GENDOGAKU
                                   TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                              END-IF
                            END-IF
                        END-IF
                        IF  COMB-KOHHKNNUM(KOH-IDX) = "012" OR "025"
                          CONTINUE
                        ELSE
                          IF  (COMB-KOH1HKNNUM  = "972") OR
                              (COMB-KOH2HKNNUM  = "972") OR
                              (COMB-KOH4HKNNUM  = "972")
                           IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) = ZERO
                            IF  MAX-KIN-KOHI3-M > WK-CYOKI-GENDO
                             MOVE  WK-CYOKI-GENDO
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                             MOVE  3  TO WK-SYOFUKUMU-FLG(KOH-IDX)
                            END-IF
                           END-IF
                          END-IF
                          IF  (COMB-KOH1HKNNUM  = "974") OR
                              (COMB-KOH2HKNNUM  = "974") OR
                              (COMB-KOH4HKNNUM  = "974")
                           IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) = ZERO
                            IF  MAX-KIN-KOHI3-M > WK-CYOKI-GENDO2
                             MOVE  WK-CYOKI-GENDO2
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                             MOVE  3  TO WK-SYOFUKUMU-FLG(KOH-IDX)
                            END-IF
                           END-IF
                          END-IF
                        END-IF
                        IF  (WK-1001-PREFNUM      =  07       )
                        AND (COMB-KOH3HKNNUM      = "281"     )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200702"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                      WHEN  4
                        MOVE   WK-NYUJGNGAK    TO   MAX-KIN-KOHI4-M
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                        MOVE     "1"   TO     COMB-KOH4-NYUJGNKBN
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1" 
                            IF  COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI4-M > WK-SEIHO-GENDO)
                                MOVE  WK-SEIHO-GENDO
                                     TO   MAX-KIN-KOHI4-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI4-M    >
                                                   WK-KOH-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                MOVE  WK-KOH-GENDOGAKU
                                   TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                EVALUATE  WK-KOH-GENDOGAKU
                                 WHEN      15000
      *                          ５割減
                                 WHEN       7500
                                  MOVE 1 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 WHEN      24600
      *                          ５割減
                                 WHEN      12300
                                  MOVE 2 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 WHEN      OTHER
                                  MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-EVALUATE
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(4)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(4)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                            IF    COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "025"
                              IF  MAX-KIN-KOHI4-M > WK-SEIHO-GENDO70
                                MOVE WK-SEIHO-GENDO70
                                     TO MAX-KIN-KOHI4-M
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI4-M    >
                                                 WK-GEN70-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                MOVE  WK-GEN70-GENDOGAKU
                                   TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                              END-IF
                            END-IF
                        END-IF
                        IF  COMB-KOHHKNNUM(KOH-IDX) = "012" OR "025"
                          CONTINUE
                        ELSE
                          IF  (COMB-KOH1HKNNUM  = "972") OR
                              (COMB-KOH2HKNNUM  = "972") OR
                              (COMB-KOH3HKNNUM  = "972")
                           IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) = ZERO
                            IF  MAX-KIN-KOHI4-M > WK-CYOKI-GENDO
                             MOVE  WK-CYOKI-GENDO
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                             MOVE  3  TO WK-SYOFUKUMU-FLG(KOH-IDX)
                            END-IF
                           END-IF
                          END-IF
                          IF  (COMB-KOH1HKNNUM  = "974") OR
                              (COMB-KOH2HKNNUM  = "974") OR
                              (COMB-KOH3HKNNUM  = "974")
                           IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) = ZERO
                            IF  MAX-KIN-KOHI4-M > WK-CYOKI-GENDO2
                             MOVE  WK-CYOKI-GENDO2
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                             MOVE  3  TO WK-SYOFUKUMU-FLG(KOH-IDX)
                            END-IF
                           END-IF
                          END-IF
                        END-IF
                        IF  (WK-1001-PREFNUM      =  07       )
                        AND (COMB-KOH4HKNNUM      = "281"     )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200702"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                     END-EVALUATE
                END-IF
      *
             END-IF
      *
           END-PERFORM.
      *
       2107-KOHFTN-KINGAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    全国公費の減額
      ******************************************************************
       21071-KOHFTN-KINGAKU-GEN-SEC           SECTION.
      *
           IF  ((COMB-KOHHKNNUM(KOH-IDX)(1:1)  =  "0"  ) AND
                (WK-DOTANDOKU(KOH-IDX)         =  ZERO ) AND
                (LNK-ORCSJGNGET-NYUJGNGAK  NOT =  ZERO ))
      *
             IF  LNK-ORCSJGNGET-NYUJGNGAK = 9999999 OR 999999
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   LNK-ORCSJGNGET-NYUJGNGAK
                     END-IF
                   WHEN          2
                     CONTINUE
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   LNK-ORCSJGNGET-NYUJGNGAK
                 END-EVALUATE
             ELSE
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   LNK-ORCSJGNGET-NYUJGNGAK
                     ELSE
                       COMPUTE  WK-GENGAKU-RITUX =
                                100 - WK-GENGAKU-RITU
                       COMPUTE  LNK-ORCSJGNGET-NYUJGNGAK  =
                                LNK-ORCSJGNGET-NYUJGNGAK  *
                                WK-GENGAKU-RITUX          /
                                100
                     END-IF
                   WHEN          2
                     CONTINUE
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   LNK-ORCSJGNGET-NYUJGNGAK
                 END-EVALUATE
                 COMPUTE  LNK-ORCSJGNGET-NYUJGNGAK =
                          LNK-ORCSJGNGET-NYUJGNGAK +  5
                 COMPUTE  LNK-ORCSJGNGET-NYUJGNGAK =
                          LNK-ORCSJGNGET-NYUJGNGAK /  10
                 COMPUTE  LNK-ORCSJGNGET-NYUJGNGAK =
                          LNK-ORCSJGNGET-NYUJGNGAK *  10
             END-IF
      *
           END-IF
      *
           .
      *
       21071-KOHFTN-KINGAKU-GEN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ４１老人上限額編集処理
      ******************************************************************
       2108-ROUJIN41-JYOGEN-HENSYU-SEC           SECTION.
      *
           IF      FLG-GENBUTU70   NOT =   ZERO
      *      ４１老人
             IF ((WK-1001-PREFNUM  =  26 OR 27 OR 34 OR 12       ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ))
             OR ((WK-1001-PREFNUM  =  10                         ) AND
                 (COMB-KOH1HKNNUM  =  "255"                      ))
             OR ((WK-1001-PREFNUM  =  33                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ))
             OR ((WK-1001-PREFNUM  =  23                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ))
             OR ((WK-1001-PREFNUM  =  14                         ) AND
                 (COMB-KOH1HKNNUM  =  "142"                      ))
             OR ((WK-1001-PREFNUM  =  01                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=   "200803"            ))
                MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70K
                IF   MAX-KIN-KOHI1-M    =    72300
                   MOVE   11       TO   FLG-IRYOHI70K
                END-IF
                IF   MAX-KIN-KOHI1-M    =    80100
                   MOVE   12       TO   FLG-IRYOHI70K
                END-IF
             END-IF
      *      岡山県地方公費
             IF   WK-1001-PREFNUM        =    33
               IF  COMB-KOH1HKNNUM   =   "385" OR "280" OR "286"
                 IF  ( COMB-KOH1HKNNUM  =  "280"          )
                 AND ((COMB-KOH2HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH3HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH4HKNNUM  =  "972" OR "974"))
                   CONTINUE
                 ELSE
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70K
                   MOVE   13          TO   FLG-IRYOHI70K
                 END-IF
               END-IF
               IF   COMB-KOH1HKNNUM  =   "585"
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70K
                   MOVE   14          TO   FLG-IRYOHI70K
               END-IF
             END-IF
           ELSE
      *      ４１老人
             MOVE       ZERO        TO      FLG-ROJIN41
             IF ((WK-1001-PREFNUM  =  26 OR 27 OR 34 OR 12       ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ))
             OR ((WK-1001-PREFNUM  =  10                         ) AND
                 (COMB-KOH1HKNNUM  =  "255"                      ))
             OR ((WK-1001-PREFNUM  =  33                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   >=   "200610"            ))
             OR ((WK-1001-PREFNUM  =  23                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   >=   "200610"            ))
             OR ((WK-1001-PREFNUM  =  14                         ) AND
                 (COMB-KOH1HKNNUM  =  "142"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   >=   "200610"            ))
             OR ((WK-1001-PREFNUM  =  01                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=   "200803"            ))
                IF  LNK-SYU-SRYYMD(1:6)   >=   "200610"
                    CONTINUE
                ELSE
                    MOVE  "1"      TO   COMB-KOH1-NYUJGNKBN
                    MOVE   72300   TO   MAX-KIN-KOHI1-M
                END-IF
                MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                MOVE   1           TO   FLG-IRYOHI2
                IF  LNK-SYU-SRYYMD(1:6)   >=   "200610"
                   IF   MAX-KIN-KOHI1-M    =    72300
                      MOVE     1      TO    FLG-ROJIN41
                   END-IF
                   IF   MAX-KIN-KOHI1-M    =    80100
                      MOVE     2      TO    FLG-ROJIN41
                   END-IF
                END-IF
             END-IF
      *      岡山県地方公費
             IF  (WK-1001-PREFNUM        =    33     )
             AND (LNK-SYU-SRYYMD(1:6)   >=   "200610")
               IF  COMB-KOH1HKNNUM   =   "385" OR "280" OR "286"
                 IF  ( COMB-KOH1HKNNUM  =  "280"          )
                 AND ((COMB-KOH2HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH3HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH4HKNNUM  =  "972" OR "974"))
                   CONTINUE
                 ELSE
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI3
                   MOVE   11          TO   FLG-IRYOHI5
                 END-IF
               END-IF
               IF   COMB-KOH1HKNNUM  =   "585"
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI3
                   MOVE   12          TO   FLG-IRYOHI5
               END-IF
               IF  (COMB-KOH1HKNNUM  =   "027"         )
               AND (COMB-KOH2HKNNUM  =   "280" OR "286")
                 IF  ( COMB-KOH2HKNNUM  =  "280"          )
                 AND ((COMB-KOH3HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH4HKNNUM  =  "972" OR "974"))
                   CONTINUE
                 ELSE
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI3
                   MOVE   21          TO   FLG-IRYOHI5
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
      *
       2108-ROUJIN41-JYOGEN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        主保険の減額                                            *
      *        長期の減額                                              *
      ******************************************************************
       2109-KOHFTN-KINGAKU-GEN-SEC           SECTION.
      *
           IF  LNK-S02-KOUREI-NYUIN-KBN   =   "1"
      *
              IF   COMB-KOH1HKNNUM          =  "027"
                IF   MAX-KIN-KOHI1-M   NOT =  ZERO
                 IF  FLG-IRYOHI  = ZERO
                 AND FLG-IRYOHI3 = ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-KOHI1-M     =
                                   MAX-KIN-KOHI1-M     *
                                   WK-GENGAKU-RITUX    /
                                   100
                        END-IF
                     WHEN          2
                        CONTINUE
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                   END-EVALUATE
                   COMPUTE  MAX-KIN-KOHI1-M =
                            MAX-KIN-KOHI1-M +  5
                   COMPUTE  MAX-KIN-KOHI1-M =
                            MAX-KIN-KOHI1-M /  10
                   COMPUTE  MAX-KIN-KOHI1-M =
                            MAX-KIN-KOHI1-M *  10
                 END-IF
                END-IF
              ELSE
                IF   MAX-KIN-SYU-M     NOT =  ZERO
                 IF  FLG-IRYOHI  = ZERO
                 AND FLG-IRYOHI3 = ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-SYU-M       =
                                   MAX-KIN-SYU-M       *
                                   WK-GENGAKU-RITUX    /
                                   100
                        END-IF
                     WHEN          2
                        CONTINUE
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-SYU-M
                   END-EVALUATE
                   COMPUTE  MAX-KIN-SYU-M =
                            MAX-KIN-SYU-M +  5
                   COMPUTE  MAX-KIN-SYU-M =
                            MAX-KIN-SYU-M /  10
                   COMPUTE  MAX-KIN-SYU-M =
                            MAX-KIN-SYU-M *  10
                 END-IF
                END-IF
              END-IF
      *
           END-IF
      *
           IF  FLG-GENBUTU70   NOT =   ZERO
      *
             IF   MAX-KIN-SYU-M     NOT =  ZERO
               IF  FLG-IRYOHI70  = ZERO
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-SYU-M       =
                                  MAX-KIN-SYU-M       *
                                  WK-GENGAKU-RITUX    /
                                  100
                       END-IF
                    WHEN          2
                       CONTINUE
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-SYU-M
                  END-EVALUATE
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M +  5
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M /  10
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M *  10
               END-IF
             END-IF
      *
           END-IF
      *
      ***********
      *
           IF   COMB-KOH1HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI1-M    =
                             MAX-KIN-KOHI1-M    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  CONTINUE
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI1-M
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI1-M =
                       MAX-KIN-KOHI1-M +  5
              COMPUTE  MAX-KIN-KOHI1-M =
                       MAX-KIN-KOHI1-M /  10
              COMPUTE  MAX-KIN-KOHI1-M =
                       MAX-KIN-KOHI1-M *  10
           END-IF
      *
           IF   COMB-KOH2HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI2-M
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI2-M    =
                             MAX-KIN-KOHI2-M    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  CONTINUE
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI2-M
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI2-M =
                       MAX-KIN-KOHI2-M +  5
              COMPUTE  MAX-KIN-KOHI2-M =
                       MAX-KIN-KOHI2-M /  10
              COMPUTE  MAX-KIN-KOHI2-M =
                       MAX-KIN-KOHI2-M *  10
           END-IF
      *
           IF   COMB-KOH3HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI3-M
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI3-M    =
                             MAX-KIN-KOHI3-M    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  CONTINUE
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI3-M
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI3-M =
                       MAX-KIN-KOHI3-M +  5
              COMPUTE  MAX-KIN-KOHI3-M =
                       MAX-KIN-KOHI3-M /  10
              COMPUTE  MAX-KIN-KOHI3-M =
                       MAX-KIN-KOHI3-M *  10
           END-IF
      *
           IF   COMB-KOH4HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI4-M
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI4-M    =
                             MAX-KIN-KOHI4-M    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  CONTINUE
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI4-M
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI4-M =
                       MAX-KIN-KOHI4-M +  5
              COMPUTE  MAX-KIN-KOHI4-M =
                       MAX-KIN-KOHI4-M /  10
              COMPUTE  MAX-KIN-KOHI4-M =
                       MAX-KIN-KOHI4-M *  10
           END-IF
      *
           .
      *
       2109-KOHFTN-KINGAKU-GEN-EXT.
           EXIT.
      *
      ******************************************************************
      *        患者公費負担（高額委任払い金額取り込み）取込み処理
      ******************************************************************
       2110-KOHININBARAI-KINGAKU-SEC           SECTION.
      *
      *    公費月上限額取得
           INITIALIZE                    LNK-ORCSJGNGET-REC
           MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
           MOVE    "964"             TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE  WK-KOHININBARAI-KOHID
                                     TO  LNK-ORCSJGNGET-KOHID
           MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
      *
           CALL    "ORCSJGNGET"      USING
                                     LNK-ORCSJGNGET-REC
                                     SPA-AREA
      *
           IF    LNK-ORCSJGNGET-RC   =   ZERO
              IF      LNK-ORCSJGNGET-NYUJGNGAK  =  ZERO
                 MOVE    ZERO        TO  FLG-KOHININBARAI
              ELSE
                 MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                     TO  MAX-KIN-SYU-M
                 MOVE    1           TO  FLG-KOUGAKUCYO-ININ
              END-IF
           ELSE
                 MOVE    ZERO        TO  FLG-KOHININBARAI
           END-IF
      *
           .
      *
       2110-KOHININBARAI-KINGAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    診療月内の収納マスタから公費毎の患者負担金額の
      *    累計を調査
      ******************************************************************
       220-SYUNOU-SEC           SECTION.
      *
           MOVE     ZERO        TO    FLG-NYUGAI.
           MOVE     ZERO        TO    FLG-TOKYO.
           MOVE     ZERO        TO    FLG-GEN70-TOKUSYU.
      *
           MOVE     ZERO        TO    WK-CYOKI.
           MOVE     ZERO        TO    WK-CYOKI-ENTANI.
      *
           MOVE     ZERO        TO    WK-OITA-HKNFTNMONEY.
           MOVE     ZERO        TO    WK-OITA-CYOFTN.
      *
           MOVE     ZERO        TO    FLG-SYUKEI2.
      *
           MOVE     ZERO        TO    WK-GENBUTU-HKNKIN.
      *
           IF  (LNK-S02-KOUREI-NYUIN-KBN  =   "1"   )
           AND (WK-1001-PREFNUM           =   13    )
           AND (LNK-SYU-SRYYMD(1:6)      >= "200610")
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (LNK-SYU-KOH1HKNNUM       = "027"          )
              AND (LNK-SYU-KOH2HKNNUM       = "182"          )
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
                  MOVE     2      TO   FLG-TOKYO
              END-IF
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (LNK-SYU-KOH1HKNNUM       = "182"          )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
                  MOVE     1      TO   FLG-TOKYO
              END-IF
           END-IF.
           IF  (LNK-S02-KOUREI-NYUIN-KBN  =   "1"   )
           AND (WK-1001-PREFNUM           =   11    )
           AND (LNK-SYU-SRYYMD(1:6)      >= "200804")
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (LNK-SYU-KOH1HKNNUM       = "542"          )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972"          )
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972"          )
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972"          )
                  MOVE     1      TO   FLG-GEN70-TOKUSYU
              END-IF
           END-IF.
           IF  (FLG-GENBUTU70         NOT =  ZERO)
           AND (WK-1001-PREFNUM           =   13 )
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (LNK-SYU-KOH1HKNNUM       = "182"          )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
                  MOVE     1      TO   FLG-TOKYO
              END-IF
           END-IF.
           IF  (FLG-GENBUTU70         NOT =  ZERO)
           AND (WK-1001-PREFNUM           =   07 )
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (LNK-SYU-KOH1HKNNUM       = "245" OR  "246")
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
                  MOVE     1      TO   FLG-GEN70-TOKUSYU
              END-IF
           END-IF.
           IF  (FLG-GENBUTU70         NOT =  ZERO)
           AND (WK-1001-PREFNUM           =   11 )
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (LNK-SYU-KOH1HKNNUM       = "181" OR  "182"
                                           OR "183" OR  "281")
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
                  MOVE     1      TO   FLG-GEN70-TOKUSYU
              END-IF
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (LNK-SYU-KOH1HKNNUM       = "543"          )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-SRYYMD(1:6)     >= "200710"       )
                  MOVE     1      TO   FLG-GEN70-TOKUSYU
              END-IF
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (LNK-SYU-KOH1HKNNUM       = "381"          )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-SRYYMD(1:6)     >= "200801"       )
                  MOVE     1      TO   FLG-GEN70-TOKUSYU
              END-IF
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (LNK-SYU-KOH1HKNNUM       = "743" OR "442" )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-SRYYMD(1:6)     >= "200804"       )
                  MOVE     1      TO   FLG-GEN70-TOKUSYU
              END-IF
           END-IF.
      *
           IF  (COMB-KOH1-NYUJGNKBN       =       "1")      OR
               (COMB-KOH2-NYUJGNKBN       =       "1")      OR
               (COMB-KOH3-NYUJGNKBN       =       "1")      OR
               (COMB-KOH4-NYUJGNKBN       =       "1")      OR
               (LNK-S02-KOUREI-NYUIN-KBN  =       "1")      OR
               (FLG-KOHININBARAI          =        1 )      OR
               (FLG-GENBUTU70         NOT =      ZERO)
      *
               IF   WK-1001-PREFNUM       =     32
               AND  LNK-SYU-SRYYMD(1:6)   <    "200510"
                    IF    LNK-SYU-KOH1HKNNUM = "190" OR "191"
                        MOVE     1    TO     FLG-NYUGAI
                    END-IF
                    IF    LNK-SYU-KOH2HKNNUM = "190" OR "191"
                        MOVE     2    TO     FLG-NYUGAI
                    END-IF
                    IF    LNK-SYU-KOH3HKNNUM = "190" OR "191"
                        MOVE     3    TO     FLG-NYUGAI
                    END-IF
                    IF    LNK-SYU-KOH4HKNNUM = "190" OR "191"
                        MOVE     4    TO     FLG-NYUGAI
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200604"
                    IF    LNK-SYU-KOH1HKNNUM  = "015" OR "016" OR "021"
                      IF  WK-JIRITU-CYUKANSOU(1)   =  2
                        MOVE     1    TO     FLG-NYUGAI
                        MOVE  WK-JIRITU-TAFTNRUIKEI(1) TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
                      END-IF
                    END-IF
                    IF    LNK-SYU-KOH2HKNNUM  = "015" OR "016" OR "021"
                      IF  WK-JIRITU-CYUKANSOU(2)   =  2
                        MOVE     2    TO     FLG-NYUGAI
                        MOVE  WK-JIRITU-TAFTNRUIKEI(2) TO FTN-KOHI2-M
                                                          FTN-KOHI2-M2
                                                          FTN-KOHI2-M3
                      END-IF
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200610"
                    IF   LNK-SYU-KOH1HKNNUM  = "024" OR "079"
                        MOVE     1    TO     FLG-NYUGAI
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM  = "024" OR "079"
                        MOVE     2    TO     FLG-NYUGAI
                    END-IF
               END-IF
               IF   WK-1001-PREFNUM       =    07
               AND  LNK-SYU-SRYYMD(1:6)  >=   "200702"
                    IF   LNK-SYU-KOH1HKNNUM  = "281"
                        MOVE     1    TO     FLG-NYUGAI
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(1) TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM  = "281"
                        MOVE     2    TO     FLG-NYUGAI
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(2) TO FTN-KOHI2-M
                                                          FTN-KOHI2-M2
                                                          FTN-KOHI2-M3
                    END-IF
                    IF   LNK-SYU-KOH3HKNNUM  = "281"
                        MOVE     3    TO     FLG-NYUGAI
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(3) TO FTN-KOHI3-M
                                                          FTN-KOHI3-M2
                                                          FTN-KOHI3-M3
                    END-IF
                    IF   LNK-SYU-KOH4HKNNUM  = "281"
                        MOVE     4    TO     FLG-NYUGAI
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(4) TO FTN-KOHI4-M
                                                          FTN-KOHI4-M2
                                                          FTN-KOHI4-M3
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200804"
                    IF   LNK-SYU-KOH1HKNNUM  = "038"
                        MOVE     1    TO     FLG-NYUGAI
                        MOVE  WK-KANEN-TAFTNRUIKEI(1)  TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
                    END-IF
               END-IF
      *
               IF   LNK-S02-TEIKI-KBN     =   "X"
                 IF    FLG-NYUGAI    NOT =   ZERO
                   INITIALIZE                         SYU-SYUNOU-REC
                   MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
                   MOVE    "2"                  TO    SYU-NYUGAIKBN
                   MOVE    LNK-SYU-PTID         TO    SYU-PTID
                   MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
                   MOVE    "__"                 TO    SYU-SRYYMD(7:2)
                   MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
                   MOVE    "DBSELECT"           TO    MCP-FUNC
                   MOVE    "tbl_syunou"         TO    MCP-TABLE
                   MOVE    "key14"              TO    MCP-PATHNAME
                   CALL    "ORCDBMAIN"          USING MCPAREA
                                                      MCPDATA-REC
                                                      SPA-AREA
                   IF      MCP-RC             =       ZERO
                     MOVE    "tbl_syunou"       TO    MCP-TABLE
                     MOVE    "key14"            TO    MCP-PATHNAME
                     PERFORM  SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                       IF  SYU-DENPJTIKBN    NOT =  "3"
                             INITIALIZE     SYU-SYUDAY-REC
                             PERFORM        2201-SYUNOU-COUNT-SEC
                       END-IF
                       MOVE    "tbl_syunou"     TO    MCP-TABLE
                       MOVE    "key14"          TO    MCP-PATHNAME
                       PERFORM  SYUNOU-READ-SEC
                     END-PERFORM
                   ELSE
                     MOVE    12                 TO    LNK-S02-RC
                   END-IF
      *
                   MOVE     "tbl_syunou"        TO    MCP-TABLE
                   MOVE     "key14"             TO    MCP-PATHNAME
                   PERFORM   DB-CLOSE-SEC
                 END-IF
               ELSE
                 IF    FLG-NYUGAI    NOT =   ZERO
                   INITIALIZE                         SYU-SYUNOU-REC
                   MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
                   MOVE    LNK-SYU-PTID         TO    SYU-PTID
                   MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
                   MOVE    "__"                 TO    SYU-SRYYMD(7:2)
                   MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
                   MOVE    "DBSELECT"           TO    MCP-FUNC
                   MOVE    "tbl_syunou"         TO    MCP-TABLE
                   MOVE    "key29"              TO    MCP-PATHNAME
                   CALL    "ORCDBMAIN"          USING MCPAREA
                                                      MCPDATA-REC
                                                      SPA-AREA
                   IF      MCP-RC             =       ZERO
                     MOVE    "tbl_syunou"       TO    MCP-TABLE
                     MOVE    "key29"            TO    MCP-PATHNAME
                     PERFORM  SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                       IF  SYU-DENPJTIKBN    NOT =  "3"
                          IF   SYU-NYUGAIKBN     =  "1"
                            IF ( LNK-SYU-SKYSTYMD > SYU-SKYSTYMD )
                            OR ((LNK-SYU-SKYSTYMD = SYU-SKYSTYMD) AND
                                (LNK-SYU-SKYEDYMD > SYU-SKYEDYMD))
                            OR ((LNK-SYU-SKYSTYMD = SYU-SKYSTYMD) AND
                                (LNK-SYU-SKYEDYMD = SYU-SKYEDYMD) AND
                                (SYU-SAIKEISANKBN = SPACE       ) AND
                                (LNK-SYU-SAIKEISANKBN  =  "1"   ))
                               IF   SYU-DAYINFFLG  =  "1"
                                  PERFORM     SYUDAY-READ-SEC
                               ELSE
                                  INITIALIZE  SYU-SYUDAY-REC
                               END-IF
                               PERFORM        2201-SYUNOU-COUNT-SEC
                            END-IF
                          ELSE
                               INITIALIZE     SYU-SYUDAY-REC
                               PERFORM        2201-SYUNOU-COUNT-SEC
                          END-IF
                       END-IF
                       MOVE    "tbl_syunou"     TO    MCP-TABLE
                       MOVE    "key29"          TO    MCP-PATHNAME
                       PERFORM  SYUNOU-READ-SEC
                     END-PERFORM
                   ELSE
                     MOVE    12                 TO    LNK-S02-RC
                   END-IF
      *
                   MOVE     "tbl_syunou"        TO    MCP-TABLE
                   MOVE     "key29"             TO    MCP-PATHNAME
                   PERFORM   DB-CLOSE-SEC
                 ELSE
                   INITIALIZE                         SYU-SYUNOU-REC
                   MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
                   MOVE    LNK-SYU-NYUGAIKBN    TO    SYU-NYUGAIKBN
                   MOVE    LNK-SYU-PTID         TO    SYU-PTID
                   MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
                   MOVE    "__"                 TO    SYU-SRYYMD(7:2)
                   MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
                   MOVE    "DBSELECT"           TO    MCP-FUNC
                   MOVE    "tbl_syunou"         TO    MCP-TABLE
                   MOVE    "key14"              TO    MCP-PATHNAME
                   CALL    "ORCDBMAIN"          USING MCPAREA
                                                      MCPDATA-REC
                                                      SPA-AREA
                   IF      MCP-RC             =       ZERO
                     MOVE    "tbl_syunou"       TO    MCP-TABLE
                     MOVE    "key14"            TO    MCP-PATHNAME
                     PERFORM  SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                       IF  SYU-DENPJTIKBN    NOT =  "3"
                        IF ( LNK-SYU-SKYSTYMD > SYU-SKYSTYMD )
                        OR ((LNK-SYU-SKYSTYMD = SYU-SKYSTYMD) AND
                            (LNK-SYU-SKYEDYMD > SYU-SKYEDYMD))
                        OR ((LNK-SYU-SKYSTYMD = SYU-SKYSTYMD) AND
                            (LNK-SYU-SKYEDYMD = SYU-SKYEDYMD) AND
                            (SYU-SAIKEISANKBN = SPACE       ) AND
                            (LNK-SYU-SAIKEISANKBN  =  "1"   ))
                               IF   SYU-DAYINFFLG  =  "1"
                                  PERFORM     SYUDAY-READ-SEC
                               ELSE
                                  INITIALIZE  SYU-SYUDAY-REC
                               END-IF
                               PERFORM        2201-SYUNOU-COUNT-SEC
                        END-IF
                       END-IF
                       MOVE    "tbl_syunou"     TO    MCP-TABLE
                       MOVE    "key14"          TO    MCP-PATHNAME
                       PERFORM  SYUNOU-READ-SEC
                     END-PERFORM
                   ELSE
                     MOVE    12                 TO    LNK-S02-RC
                   END-IF
      *
                   MOVE     "tbl_syunou"        TO    MCP-TABLE
                   MOVE     "key14"             TO    MCP-PATHNAME
                   PERFORM   DB-CLOSE-SEC
                 END-IF
               END-IF
      *
               PERFORM    VARYING   IDZ    FROM   1   BY   1
                           UNTIL  (IDZ    >    10)
                             OR   (LNK-WRK-SYU-SKYSTYMD(IDZ) =  SPACE)
      *
                  IF  LNK-SYU-SKYSTYMD(1:6) = 
                                   LNK-WRK-SYU-SKYSTYMD(IDZ)(1:6) 
                      MOVE    LNK-WRK-SYUNOU-REC(IDZ)  
                                             TO  SYU-SYUNOU-REC
                      IF   SYU-DAYINFFLG  =  "1"
                         MOVE    LNK-WRK-SYUDAY-REC(IDZ)
                                             TO  SYU-SYUDAY-REC
                      ELSE
                         INITIALIZE  SYU-SYUDAY-REC
                      END-IF
                      PERFORM        2201-SYUNOU-COUNT-SEC
                  END-IF
      *
               END-PERFORM
      *
           END-IF.
      *
           IF     FLG-GENBUTU70   NOT =   ZERO
              IF     FLG-IRYOHI70     =  1 OR 3
                IF  WK-KOUREI-IRYOHI70  >  500000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70 - 500000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70
                END-IF
              END-IF
              IF     FLG-IRYOHI70     =  2 OR 4 OR 6
                IF  WK-KOUREI-IRYOHI70  >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70 - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70
                END-IF
              END-IF
      *       自立支援等用
              IF     FLG-IRYOHI70K    =  1
                IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K   >  1935690
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              END-IF
              IF     FLG-IRYOHI70K    =  2
                IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K   >   860340
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              END-IF
      *       ４１老人用
              IF     FLG-IRYOHI70K    =  11
                IF  WK-KOUREI-IRYOHI70K >  361500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 361500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                END-IF
              END-IF
              IF     FLG-IRYOHI70K    =  12
                IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                END-IF
              END-IF
      *       岡山県地方公費用
              IF     FLG-IRYOHI70K    =  13
                IF  WK-KOUREI-IRYOHI70K >  801000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 801000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                END-IF
              END-IF
              IF     FLG-IRYOHI70K    =  14
                IF  WK-KOUREI-IRYOHI70K >  2002500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 2002500) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                END-IF
              END-IF
              IF    (FLG-IRYOHI70   NOT =  ZERO)
              OR    (FLG-IRYOHI70K  =  1  OR  2)
                IF    WK-GENGAKUKBN  NOT = ZERO
                     PERFORM   2202-KOHFTN-KINGAKU-GEN2-SEC
                END-IF
              END-IF
           ELSE
            IF    LNK-SYU-SRYYMD(1:6)  >= "200610"
              IF     FLG-IRYOHI     =      1
                IF  WK-KOUREI-IRYOHI  >  267000
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO
                END-IF
              END-IF
              IF     FLG-IRYOHI     =      2
                IF  WK-KOUREI-IRYOHI  >  267000
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO
                END-IF
              END-IF
              IF     FLG-IRYOHI3    =      1
                IF  WK-KOUREI-IRYOHI  >  267000
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO3
                END-IF
              END-IF
              IF     FLG-IRYOHI3    =      2
                IF  WK-KOUREI-IRYOHI  >  267000
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO3
                END-IF
              END-IF
      *       ４１老人用
              IF     FLG-IRYOHI2     =      1
               IF  FLG-ROJIN41   =   1
                IF  WK-KOUREI-IRYOHI  >  361500
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                        (( WK-KOUREI-IRYOHI   -  361500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO2
                END-IF
               END-IF
               IF  FLG-ROJIN41   =   2
                IF  WK-KOUREI-IRYOHI  >  267000
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                        (( WK-KOUREI-IRYOHI   -  267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO2
                END-IF
               END-IF
              END-IF
      *       岡山県地方公費用
              IF     FLG-IRYOHI5     =      11
                IF  WK-KOUREI-IRYOHI3  >  801000
                   COMPUTE WK-KOUREI-IRYOHI4 = 
                         (( WK-KOUREI-IRYOHI3 -  801000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI4
                   MOVE    1    TO    FLG-KOUGAKUCYO5
                END-IF
              END-IF
              IF     FLG-IRYOHI5     =      12
                IF  WK-KOUREI-IRYOHI3  >  2002500
                   COMPUTE WK-KOUREI-IRYOHI4 = 
                         (( WK-KOUREI-IRYOHI3 - 2002500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI4
                   MOVE    1    TO    FLG-KOUGAKUCYO5
                END-IF
              END-IF
              IF     FLG-IRYOHI5     =      21
                IF  WK-KOUREI-IRYOHI3  >  801000
                   COMPUTE WK-KOUREI-IRYOHI4 = 
                         (( WK-KOUREI-IRYOHI3 -  801000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M 
                                             +   WK-KOUREI-IRYOHI4
                   MOVE    1    TO    FLG-KOUGAKUCYO5
                END-IF
              END-IF
      *       自立支援用
              IF     FLG-IRYOHI4     =      1
                IF  WK-KOUREI-IRYOHI  >  267000
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI2
                   IF   WK-KOUREI-IRYOHI   >   860340
                        MOVE    1    TO    FLG-KOUGAKUCYO-JIRITU
                   END-IF
                END-IF
              END-IF
            ELSE
              IF     FLG-IRYOHI     =      1
                IF  WK-KOUREI-IRYOHI  >  361500
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  361500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO
                END-IF
              END-IF
              IF     FLG-IRYOHI     =      2
                IF  WK-KOUREI-IRYOHI  >  361500
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  361500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO
                END-IF
              END-IF
              IF     FLG-IRYOHI3    =      1
                IF  WK-KOUREI-IRYOHI  >  361500
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  361500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO3
                END-IF
              END-IF
              IF     FLG-IRYOHI3    =      2
                IF  WK-KOUREI-IRYOHI  >  361500
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  361500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO3
                END-IF
              END-IF
      *       ４１老人用
              IF     FLG-IRYOHI2     =      1
                IF  WK-KOUREI-IRYOHI  >  361500
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                        (( WK-KOUREI-IRYOHI   -  361500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI2
                   MOVE    1    TO    FLG-KOUGAKUCYO2
                END-IF
              END-IF
      *       自立支援用
              IF     FLG-IRYOHI4     =      1
                IF  WK-KOUREI-IRYOHI  >  241000
                   COMPUTE WK-KOUREI-IRYOHI2 = 
                         (( WK-KOUREI-IRYOHI  -  241000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                             +   WK-KOUREI-IRYOHI2
                   IF   WK-KOUREI-IRYOHI   >   776540
                        MOVE    1    TO    FLG-KOUGAKUCYO-JIRITU
                   END-IF
                END-IF
              END-IF
            END-IF
            IF      (FLG-IRYOHI      =  1 OR 2)
            OR      (FLG-IRYOHI3     =  1 OR 2)
            OR      (FLG-IRYOHI4     =  1     )
                IF   WK-GENGAKUKBN  NOT =  ZERO
                   PERFORM   2202-KOHFTN-KINGAKU-GEN2-SEC
                END-IF
            END-IF
           END-IF.
      *
       220-SYUNOU-EXT.
           EXIT.
      *
      ******************************************************************
      *        診療月の収納マスタから公費の金額カウント
      ******************************************************************
       2201-SYUNOU-COUNT-SEC          SECTION.
      *
      *    保険組合せマスタの検索
           INITIALIZE                         WRK-HKNCOMBI-REC.
           MOVE    SYU-HOSPNUM        TO      WRK-COMB-HOSPNUM.
           MOVE    SYU-PTID           TO      WRK-COMB-PTID.
           MOVE    SYU-HKNCOMBINUM    TO      WRK-COMB-HKNCOMBINUM.
           MOVE    WRK-HKNCOMBI-REC   TO      MCPDATA-REC.
           MOVE    "DBSELECT"         TO      MCP-FUNC.
           MOVE    "tbl_hkncombi"     TO      MCP-TABLE.
           MOVE    "key"              TO      MCP-PATHNAME.
           CALL    "ORCDBMAIN"        USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA.
           IF      MCP-RC               =       ZERO
               MOVE     "tbl_hkncombi"  TO    MCP-TABLE
               MOVE     "key"           TO    MCP-PATHNAME
               PERFORM   HKNCOMBI-READ2-SEC
               IF      FLG-HKNCOMBI     =       1
                   DISPLAY "HKNCOMBI DBFETCH ERR"
                   MOVE     10             TO   LNK-S02-RC
                   MOVE    "tbl_hkncombi"  TO   MCP-TABLE
                   MOVE    "key"           TO   MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
                   GO   TO              2201-SYUNOU-COUNT-EXT
               END-IF
           ELSE
               MOVE    1                TO      FLG-HKNCOMBI
               DISPLAY "HKNCOMBI DBSELECT ERR"
               MOVE     10              TO      LNK-S02-RC
               MOVE    "tbl_hkncombi"   TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
               GO   TO                  2201-SYUNOU-COUNT-EXT
           END-IF.
           MOVE    "tbl_hkncombi"       TO       MCP-TABLE.
           MOVE    "key"                TO       MCP-PATHNAME.
           PERFORM  DB-CLOSE-SEC.
           IF     (FLG-GENBUTU70         NOT =  ZERO)
           OR     (FLG-KOHININBARAI          =   1  )
           OR     (LNK-S02-KOUREI-NYUIN-KBN  =  "1" )
             MOVE   SPACE              TO    WK-HKNJANUM2-TBL
             INITIALIZE                      PTHKNINF-REC
             MOVE   WRK-COMB-HOSPNUM   TO    PTHKN-HOSPNUM
             MOVE   WRK-COMB-PTID      TO    PTHKN-PTID
             MOVE   WRK-COMB-HKNID     TO    PTHKN-HKNID
             MOVE   PTHKNINF-REC       TO    MCPDATA-REC
             MOVE   "DBSELECT"         TO    MCP-FUNC
             MOVE   "tbl_pthkninf"     TO    MCP-TABLE
             MOVE   "key"              TO    MCP-PATHNAME
             CALL   "ORCDBMAIN"        USING MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
             IF      MCP-RC            =     ZERO
                 MOVE    "tbl_pthkninf"     TO    MCP-TABLE
                 MOVE    "key"              TO    MCP-PATHNAME
                 PERFORM  PTHKNINF-READ-SEC
                 IF      FLG-PTHKNINF   =     ZERO
                    MOVE  PTHKN-HKNJANUM    TO    WK-HKNJANUM2
                    MOVE  PTHKN-HONKZKKBN   TO    WK-HONKZKKBN2
                    MOVE  PTHKN-KIGO        TO    WK-KIGO2
                    MOVE  PTHKN-NUM         TO    WK-NUM2
                 END-IF
             END-IF
             MOVE     "tbl_pthkninf"   TO    MCP-TABLE
             MOVE     "key"            TO    MCP-PATHNAME
             PERFORM   DB-CLOSE-SEC
           END-IF.
      *
      *    特定疾患
           IF    LNK-SYU-SRYYMD(1:6)         >= "200310"
      *
              IF     SYU-KOH1HKNNUM  =  "051" 
                IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                END-IF
                IF   LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                END-IF
              END-IF
              IF     SYU-KOH2HKNNUM  =  "051" 
                IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                END-IF
                IF   LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                END-IF
              END-IF
      *
           END-IF.
      *
      *    小児特定
           IF    LNK-SYU-SRYYMD(1:6)         >= "200504"
      *
              IF     SYU-KOH1HKNNUM  =  "052"
                IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                END-IF
                IF   LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                END-IF
              END-IF
              IF     SYU-KOH2HKNNUM  =  "052"
                IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                END-IF
                IF   LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                END-IF
              END-IF
      *
           END-IF.
      *
      *    自立支援（精神通院、更生、育成）
           IF    LNK-SYU-SRYYMD(1:6)         >= "200604"
      *
              MOVE  LNK-SYU-SRYYMD(1:6)  TO  WK-JIRITU-SRYYMD(1:6)
              MOVE  "01"                 TO  WK-JIRITU-SRYYMD(7:2)
      *
              IF     SYU-KOH1HKNNUM  =  "015" OR "016" OR "021"
                IF   (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM  )
                AND  (COMB-KOH1ID     NOT =  WRK-COMB-KOH1ID )
                AND  (WK-JIRITU-CYUKANSOU(1)   =  2          )
                AND  (SYU-NYNSHOKAISU          =  ZERO       )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                END-IF
                IF   (LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM  )
                AND  (COMB-KOH2ID     NOT =  WRK-COMB-KOH1ID )
                AND  (WK-JIRITU-CYUKANSOU(2)   =  2          )
                AND  (SYU-NYNSHOKAISU          =  ZERO       )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                END-IF
              END-IF
              IF     SYU-KOH2HKNNUM  =  "015" OR "016" OR "021"
                IF   (LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM  )
                AND  (COMB-KOH1ID     NOT =  WRK-COMB-KOH2ID )
                AND  (WK-JIRITU-CYUKANSOU(1)   =  2          )
                AND  (SYU-NYNSHOKAISU          =  ZERO       )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                END-IF
                IF   (LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM  )
                AND  (COMB-KOH2ID     NOT =  WRK-COMB-KOH2ID )
                AND  (WK-JIRITU-CYUKANSOU(2)   =  2          )
                AND  (SYU-NYNSHOKAISU          =  ZERO       )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                END-IF
              END-IF
      *
           END-IF.
      *
           IF  (WK-1001-PREFNUM          =  44      ) AND
               (LNK-SYU-SRYYMD(1:6)     >= "200610" )
      *
                IF (SYU-KOH1HKNNUM  = "183" OR "283")
                OR (SYU-KOH2HKNNUM  = "183" OR "283")
                OR (SYU-KOH3HKNNUM  = "183" OR "283")
                OR (SYU-KOH4HKNNUM  = "183" OR "283")
                  COMPUTE   SYU-KOH-FTN         =  SYU-KOH-FTN
                                                -  SYU-JYO-COMPFTN
                  COMPUTE   SYU-KOH-FTN-ENTANI  =  SYU-KOH-FTN-ENTANI
                                                -  SYU-JYO-COMPFTN
                END-IF
      *
           END-IF.
      *
           MOVE     ZERO     TO     FLG-KOUREI.                         
           MOVE     ZERO     TO     FLG-SYUKEI.
           MOVE     ZERO     TO     FLG-TAISYO.
      *
           IF  SYU-NYUGAIKBN  =  "1"
             IF ( LNK-S02-KOUREI-NYUIN-KBN   =   "1" )
             OR ( FLG-KOHININBARAI           =    1  )
             OR ( FLG-GENBUTU70          NOT =   ZERO)
               IF ( SYU-SYUHKNNUM       =  "971" OR "973" OR "975"
                                        OR "068" OR "069" OR "040" )
               OR ( SYU-SYUHKNNUM(1:2)  =  "98"                    )
      *
                 CONTINUE
      *
               ELSE
      *
                 IF COMB-KOH1HKNNUM      =    "027"                     
      ***
                      IF    SYU-KOH1HKNNUM         = "027"
                       IF  (SYU-KOH2HKNNUM     NOT = SPACE)              
                       OR  (SYU-KOH3HKNNUM     NOT = SPACE)
                       OR  (SYU-KOH4HKNNUM     NOT = SPACE)
                        MOVE     SYU-KOH-FTN  TO  WK-SYU-SYUCOMPFTN
                        COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                       ELSE
                        MOVE     SYU-KOH1COMPFTN
                                              TO  WK-SYU-SYUCOMPFTN
                        COMPUTE WK-ENTANI = SYU-KOH1COMPFTN-ENTANI
                                                               + 0.9
                       END-IF
                       ADD   WK-SYU-SYUCOMPFTN     TO   FTN-KOHI1-M      
                       ADD   WK-ENTANI       TO   FTN-KOHI1-M-ENTANI
                       IF  ( COMB-KOH2HKNNUM        =    SPACE)
                       AND ( COMB-KOH3HKNNUM        =    SPACE)
                       AND ( COMB-KOH4HKNNUM        =    SPACE)
                       AND ( SYU-KOH2HKNNUM         =    SPACE)
                       AND ( SYU-KOH3HKNNUM         =    SPACE)
                       AND ( SYU-KOH4HKNNUM         =    SPACE)
                       AND ( FLG-IRYOHI         NOT =    ZERO )
                          COMPUTE   WK-KOUREI-IRYOHI  =   
                                    WK-KOUREI-IRYOHI  +  
                                   (SYU-HKNTEN (17) * 10)
                       END-IF
      *
                       MOVE  1                     TO   FLG-KOUREI       
                      END-IF
                 ELSE                                                   
      ***
                    IF   (SYU-SYUHKNNUM      NOT = SPACE)
                    AND  (COMB-HKNNUM        NOT = SPACE)
                     IF   FLG-KOHININBARAI     =    1
                       IF  (SYU-KOH1HKNNUM     =  SPACE)
                       AND (SYU-KOH2HKNNUM     =  SPACE)
                       AND (SYU-KOH3HKNNUM     =  SPACE)
                       AND (SYU-KOH4HKNNUM     =  SPACE)
                        IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                          MOVE   SYU-SYUCOMPFTN
                                            TO   WK-SYU-SYUCOMPFTN
                          COMPUTE WK-ENTANI =
                                  SYU-SYUCOMPFTN-ENTANI + 0.9
                          ADD   WK-SYU-SYUCOMPFTN  TO  FTN-SYU-M
                          ADD   WK-ENTANI          TO  FTN-SYU-M-ENTANI
                        END-IF
                       END-IF
                     ELSE
                      IF  FLG-GENBUTU70    NOT =  ZERO
                       PERFORM   22011-GEN70-SYU-HENSYU-SEC
                      ELSE
                       PERFORM   22012-KOUREI-SYU-HENSYU-SEC
                      END-IF
                     END-IF
                    END-IF
                 END-IF                                                 
      *
               END-IF
             END-IF
      *
             IF      LNK-SYU-KOH1HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22013-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
             IF      LNK-SYU-KOH2HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22013-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
             IF      LNK-SYU-KOH3HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22013-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
             IF      LNK-SYU-KOH4HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22013-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
      *
           END-IF.
      *
      *    公費１カウント
           IF ((COMB-KOH1HKNNUM       NOT =  SPACE           ) AND
               (COMB-KOH1-NYUJGNKBN       =  "1"             ) AND
               (FLG-KOUREI                =  ZERO            ))
           OR ( FLG-IRYOHI70              =  3 OR 4 OR 6      )
           OR ( FLG-IRYOHI3               =  2                )
             IF  ( SYU-NYUGAIKBN              =   "1"   )
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI                 =    1   ))
               IF   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
      *
                IF   SYU-NYUGAIKBN  =   "1"
                 IF  FLG-GENBUTU70    NOT =  ZERO
                  IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                    IF   FLG-IRYOHI70  =  3 OR 4 OR 6
                     COMPUTE  WK-KOUREI-IRYOHI70  =
                              WK-KOUREI-IRYOHI70  +
                             (SYU-HKNTEN (17) * 10)
                     MOVE       1    TO      FLG-SYUKEI
                     IF   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                           (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                     OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                           (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                     OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                           (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                        MOVE    1    TO      FLG-SYUKEI2
                     END-IF
                    END-IF
                  END-IF
                  IF   FLG-IRYOHI70K NOT = ZERO
                    COMPUTE  WK-KOUREI-IRYOHI70K =
                             WK-KOUREI-IRYOHI70K +
                            (SYU-HKNTEN (17) * 10)
                  END-IF
                 ELSE
                  IF    (FLG-IRYOHI2     =      1)
                  OR    (FLG-IRYOHI4     =      1)
                  OR    (FLG-IRYOHI3     =      2)
                   COMPUTE  WK-KOUREI-IRYOHI  =  WK-KOUREI-IRYOHI  +  
                                                (SYU-HKNTEN (17) * 10)
                  END-IF
                  IF     FLG-IRYOHI5     =      11 OR 12
                   COMPUTE  WK-KOUREI-IRYOHI3 =  WK-KOUREI-IRYOHI3 +  
                                                (SYU-HKNTEN (17) * 10)
                  END-IF
                 END-IF
                END-IF
      *
                 IF ((WK-1001-PREFNUM         =  07      ) AND
                     (LNK-SYU-KOH1HKNNUM      = "245"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200412" ))
                 OR ((WK-1001-PREFNUM         =  07      ) AND
                     (LNK-SYU-KOH1HKNNUM      = "246"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH1HKNNUM = "181" OR "182"
                                        OR "183" OR "281") AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200704" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH1HKNNUM      = "543"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200710" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH1HKNNUM      = "381"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200801" ))
                 OR ((WK-1001-PREFNUM         =  11             ) AND
                     (LNK-SYU-KOH1HKNNUM      = "743" OR "442"
                                                      OR "542"  ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200804"        ))
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH1HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           COMPUTE  WK-TOKUSYU  = SYU-JYO-COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-TOKUSYU2 = SYU-KOH1COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-KEISAN   =
                                    WK-TOKUSYU  - WK-TOKUSYU2
                           ADD      WK-KEISAN   TO   FTN-SYU-M-ENTANI
                         END-IF
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH2HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           COMPUTE  WK-TOKUSYU  = SYU-JYO-COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-TOKUSYU2 = SYU-KOH2COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-KEISAN   =
                                    WK-TOKUSYU  - WK-TOKUSYU2
                           ADD      WK-KEISAN   TO   FTN-SYU-M-ENTANI
                         END-IF
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH3HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           COMPUTE  WK-TOKUSYU  = SYU-JYO-COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-TOKUSYU2 = SYU-KOH3COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-KEISAN   =
                                    WK-TOKUSYU  - WK-TOKUSYU2
                           ADD      WK-KEISAN   TO   FTN-SYU-M-ENTANI
                         END-IF
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH4HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           COMPUTE  WK-TOKUSYU  = SYU-JYO-COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-TOKUSYU2 = SYU-KOH4COMPFTN-ENTANI
                                                + 0.9
                           COMPUTE  WK-KEISAN   =
                                    WK-TOKUSYU  - WK-TOKUSYU2
                           ADD      WK-KEISAN   TO   FTN-SYU-M-ENTANI
                         END-IF
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                      END-IF
                 END-IF
      *
                 IF ((WK-1001-PREFNUM         =  33      ) AND
                     (LNK-SYU-KOH1HKNNUM      = "285"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200110" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200609" ))
                 OR ((WK-1001-PREFNUM         =  13      ) AND
                     (LNK-SYU-KOH1HKNNUM      = "182"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                         IF   FLG-TOKYO  =  1
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH1HKNFTNMONEY  TO   FTN-SYU-M
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH1COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH1COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                         IF   FLG-TOKYO  =  1
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH1COMPFTN-ENTANI
                                         TO   FTN-SYU-M-ENTANI
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                         IF   FLG-TOKYO  =  1
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH2HKNFTNMONEY  TO   FTN-SYU-M
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH2COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH2COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                         IF   FLG-TOKYO  =  1
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH2COMPFTN-ENTANI
                                         TO   FTN-SYU-M-ENTANI
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                         IF   FLG-TOKYO  =  1
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH3HKNFTNMONEY  TO   FTN-SYU-M
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH3COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH3COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                         IF   FLG-TOKYO  =  1
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH3COMPFTN-ENTANI
                                         TO   FTN-SYU-M-ENTANI
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                         IF   FLG-TOKYO  =  1
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH4HKNFTNMONEY  TO   FTN-SYU-M
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH4COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH4COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                         IF   FLG-TOKYO  =  1
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH4COMPFTN-ENTANI
                                         TO   FTN-SYU-M-ENTANI
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                        END-IF
                      END-IF
                 END-IF
      *
                 IF  (WK-1001-PREFNUM          =  44      ) AND
                     (LNK-SYU-KOH1HKNNUM  = "183" OR "283") AND
                     (LNK-SYU-SRYYMD(1:6)     >= "200610" )
                    IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                                             OR  SYU-KOH2HKNNUM
                                             OR  SYU-KOH3HKNNUM
                                             OR  SYU-KOH4HKNNUM
                       ADD   SYU-JYO-HKNFTNMONEY
                                      TO  WK-OITA-HKNFTNMONEY
                       ADD   SYU-JYO-COMPFTN
                                      TO  WK-OITA-CYOFTN
                    END-IF
                 END-IF
      *
                 IF     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                         (MAX-KIN-KOHI1-M           = ZERO))
                 OR     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                         (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                   PERFORM   VARYING  IDX2  FROM  1  BY  1
                              UNTIL   IDX2   >   31
                     IF   SYU-DAY(IDX2)  =  "1" OR "2"
                        EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                             IF  KOHI1-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 1)     =  1
                                 ADD     1      TO    KOHI1-TBL(IDX2)
                                 ADD     1      TO    KOHI1-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 1)
                                          TO  FTN-KOHI1-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 1)
                                          TO  FTN-KOHI1-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 1)
                                          TO  FTN-KOHI1-D3(IDX2)
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 1)
                                           TO  FTN-KOHI1-D(IDX2)
                                               FTN-KOHI1-D2(IDX2)
                                               FTN-KOHI1-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                             IF  KOHI1-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 2)     =  1
                                 ADD     1      TO    KOHI1-TBL(IDX2)
                                 ADD     1      TO    KOHI1-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 2)
                                          TO  FTN-KOHI1-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 2)
                                          TO  FTN-KOHI1-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 2)
                                          TO  FTN-KOHI1-D3(IDX2)
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 2)
                                           TO  FTN-KOHI1-D(IDX2)
                                               FTN-KOHI1-D2(IDX2)
                                               FTN-KOHI1-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                             IF  KOHI1-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 3)     =  1
                                 ADD     1      TO    KOHI1-TBL(IDX2)
                                 ADD     1      TO    KOHI1-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 3)
                                          TO  FTN-KOHI1-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 3)
                                          TO  FTN-KOHI1-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 3)
                                          TO  FTN-KOHI1-D3(IDX2)
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 3)
                                           TO  FTN-KOHI1-D(IDX2)
                                               FTN-KOHI1-D2(IDX2)
                                               FTN-KOHI1-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                             IF  KOHI1-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 4)     =  1
                                 ADD     1      TO    KOHI1-TBL(IDX2)
                                 ADD     1      TO    KOHI1-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 4)
                                          TO  FTN-KOHI1-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 4)
                                          TO  FTN-KOHI1-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 4)
                                          TO  FTN-KOHI1-D3(IDX2)
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 4)
                                           TO  FTN-KOHI1-D(IDX2)
                                               FTN-KOHI1-D2(IDX2)
                                               FTN-KOHI1-D3(IDX2)
                             END-IF
                        END-EVALUATE
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI1-M
                             END-IF
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI1-M2 =                  
                                        FTN-KOHI1-M2     +              
                                        SYU-KOH1COMPFTN  +              
                                        SYU-KOH1SKJ-FTN                 
                               COMPUTE  FTN-KOHI1-M3 =                  
                                        FTN-KOHI1-M3            +       
                                        SYU-KOH1COMPFTN-ENTANI  +       
                                        SYU-KOH1SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH1COMPFTN                    
                                                TO  FTN-KOHI1-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3        
                             END-IF                                     
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(1)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "024" OR "079"         ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200804") AND
                                 (LNK-SYU-KOH1HKNNUM    =  "038"   ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                                ADD   SYU-KOH1HKNFTNMONEY
                                                   TO  FTN-KOHI1-M-JI
                                ADD   SYU-KOH1COMPFTN
                                                   TO  FTN-KOHI1-M2-JI
                                COMPUTE WK-ENTANI =
                                          SYU-KOH1COMPFTN-ENTANI + 0.9
                                ADD   WK-ENTANI    TO  FTN-KOHI1-M3-JI
                             END-IF
                             IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610")
                             AND (LNK-SYU-KOH1HKNNUM    =
                                            "024" OR "079"         )
                             AND (SYU-NYUGAIKBN            = "1"   )
                                ADD   SYU-KOH1SKJ-FTN
                                                   TO  FTN-KOHI1-SKJ
                             END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI1-M
                             END-IF
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI1-M2 =                  
                                        FTN-KOHI1-M2     +              
                                        SYU-KOH2COMPFTN  +              
                                        SYU-KOH2SKJ-FTN                 
                               COMPUTE  FTN-KOHI1-M3 =                  
                                        FTN-KOHI1-M3            +       
                                        SYU-KOH2COMPFTN-ENTANI  +       
                                        SYU-KOH2SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH2COMPFTN                    
                                                TO  FTN-KOHI1-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3        
                             END-IF                                     
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(1)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "024" OR "079"         ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                                ADD   SYU-KOH2HKNFTNMONEY
                                                   TO  FTN-KOHI1-M-JI
                                ADD   SYU-KOH2COMPFTN
                                                   TO  FTN-KOHI1-M2-JI
                                COMPUTE WK-ENTANI =
                                          SYU-KOH2COMPFTN-ENTANI + 0.9
                                ADD   WK-ENTANI    TO  FTN-KOHI1-M3-JI
                             END-IF
                             IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610")
                             AND (LNK-SYU-KOH1HKNNUM    =
                                            "024" OR "079"         )
                             AND (SYU-NYUGAIKBN            = "1"   )
                                ADD   SYU-KOH2SKJ-FTN
                                                   TO  FTN-KOHI1-SKJ
                             END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI1-M
                             END-IF
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI1-M2 =                  
                                        FTN-KOHI1-M2     +              
                                        SYU-KOH3COMPFTN  +              
                                        SYU-KOH3SKJ-FTN                 
                               COMPUTE  FTN-KOHI1-M3 =                  
                                        FTN-KOHI1-M3            +       
                                        SYU-KOH3COMPFTN-ENTANI  +       
                                        SYU-KOH3SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH3COMPFTN                    
                                                TO  FTN-KOHI1-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3        
                             END-IF                                     
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI1-M
                             END-IF
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI1-M2 =                  
                                        FTN-KOHI1-M2     +              
                                        SYU-KOH4COMPFTN  +              
                                        SYU-KOH4SKJ-FTN                 
                               COMPUTE  FTN-KOHI1-M3 =                  
                                        FTN-KOHI1-M3            +       
                                        SYU-KOH4COMPFTN-ENTANI  +       
                                        SYU-KOH4SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH4COMPFTN                    
                                                TO  FTN-KOHI1-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3        
                             END-IF                                     
                 END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *    公費２カウント
           IF ((COMB-KOH2HKNNUM       NOT =  SPACE          ) AND
               (COMB-KOH2-NYUJGNKBN       =  "1"            ))
           OR ( FLG-IRYOHI3               =   1              )
             IF  ( SYU-NYUGAIKBN              =   "1"   )
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI                 =    2   ))
               IF   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH4ID))
      *
                IF   SYU-NYUGAIKBN  =   "1"
                 IF  FLG-GENBUTU70    NOT =  ZERO
                  IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                    IF   (FLG-IRYOHI70  =  6   )
                    AND  (FLG-SYUKEI    =  ZERO)
                      IF  ((WK-1001-PREFNUM    =  07           ) AND
                           (LNK-SYU-KOH2HKNNUM = "245" OR "246"))
                      OR  ((WK-1001-PREFNUM    =  11           ) AND
                           (LNK-SYU-KOH2HKNNUM = "181" OR "182"
                                              OR "183" OR "281"))
                      OR  ((WK-1001-PREFNUM    =  11           ) AND
                           (LNK-SYU-KOH2HKNNUM = "543"         ) AND
                           (LNK-SYU-SRYYMD(1:6)   >= "200710"  ))
                      OR  ((WK-1001-PREFNUM    =  11           ) AND
                           (LNK-SYU-KOH2HKNNUM = "381"         ) AND
                           (LNK-SYU-SRYYMD(1:6)   >= "200801"  ))
                      OR  ((WK-1001-PREFNUM    =  11           ) AND
                           (LNK-SYU-KOH2HKNNUM = "743" OR "442") AND
                           (LNK-SYU-SRYYMD(1:6)   >= "200804"  ))
                        COMPUTE  WK-KOUREI-IRYOHI70  =
                                 WK-KOUREI-IRYOHI70  +
                                (SYU-HKNTEN (17) * 10)
                      END-IF
                    END-IF
                  END-IF
                 ELSE
                  IF     FLG-IRYOHI3     =      1
                   COMPUTE  WK-KOUREI-IRYOHI  =  WK-KOUREI-IRYOHI  +  
                                                (SYU-HKNTEN (17) * 10)
                  END-IF
                  IF     FLG-IRYOHI5     =      21
                   COMPUTE  WK-KOUREI-IRYOHI3 =  WK-KOUREI-IRYOHI3 +  
                                                (SYU-HKNTEN (17) * 10)
                  END-IF
                 END-IF
                END-IF
      *
                 IF ((WK-1001-PREFNUM         =  07      ) AND
                     (LNK-SYU-KOH2HKNNUM      = "245"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200412" ))
                 OR ((WK-1001-PREFNUM         =  07      ) AND
                     (LNK-SYU-KOH2HKNNUM      = "246"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH2HKNNUM = "181" OR "182"
                                        OR "183" OR "281") AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200704" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH2HKNNUM      = "543"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200710" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH2HKNNUM      = "381"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200801" ))
                 OR ((WK-1001-PREFNUM         =  11           ) AND
                     (LNK-SYU-KOH2HKNNUM      = "743" OR "442"
                                                      OR "542") AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200804"      ))
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                      END-IF
                 END-IF
      *
                 IF ((WK-1001-PREFNUM         =  33      ) AND
                     (LNK-SYU-KOH2HKNNUM      = "285"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200110" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200609" ))
                 OR ((WK-1001-PREFNUM         =  13      ) AND
                     (LNK-SYU-KOH2HKNNUM      = "182"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                         IF   FLG-TOKYO  =  2
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH1HKNFTNMONEY  TO   FTN-KOHI1-M
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH1COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH1COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                         IF   FLG-TOKYO  =  2
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH1COMPFTN-ENTANI
                                         TO   FTN-KOHI1-M-ENTANI
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                         IF   FLG-TOKYO  =  2
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH2HKNFTNMONEY  TO   FTN-KOHI1-M
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH2COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH2COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                         IF   FLG-TOKYO  =  2
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH2COMPFTN-ENTANI
                                         TO   FTN-KOHI1-M-ENTANI
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                         IF   FLG-TOKYO  =  2
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH3HKNFTNMONEY  TO   FTN-KOHI1-M
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH3COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH3COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                         IF   FLG-TOKYO  =  2
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH3COMPFTN-ENTANI
                                         TO   FTN-KOHI1-M-ENTANI
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                         IF   FLG-TOKYO  =  2
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH4HKNFTNMONEY  TO   FTN-KOHI1-M
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH4COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH4COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                         IF   FLG-TOKYO  =  2
                         AND  FLG-TAISYO =  ZERO
                            ADD  SYU-KOH4COMPFTN-ENTANI
                                         TO   FTN-KOHI1-M-ENTANI
                         END-IF
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                        END-IF
                      END-IF
                 END-IF
      *
                 IF  (WK-1001-PREFNUM          =  44      ) AND
                     (LNK-SYU-KOH2HKNNUM  = "183" OR "283") AND
                     (LNK-SYU-SRYYMD(1:6)     >= "200610" )
                    IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                                             OR  SYU-KOH2HKNNUM
                                             OR  SYU-KOH3HKNNUM
                                             OR  SYU-KOH4HKNNUM
                       ADD   SYU-JYO-HKNFTNMONEY
                                      TO  WK-OITA-HKNFTNMONEY
                       ADD   SYU-JYO-COMPFTN
                                      TO  WK-OITA-CYOFTN
                    END-IF
                 END-IF
      *
                 IF     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                         (MAX-KIN-KOHI2-M           = ZERO))
                 OR     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                         (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                   PERFORM   VARYING  IDX2  FROM  1  BY  1
                              UNTIL   IDX2   >   31
                     IF   SYU-DAY(IDX2)  =  "1" OR "2"
                        EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                             IF  KOHI2-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 1)     =  1
                                 ADD     1      TO    KOHI2-TBL(IDX2)
                                 ADD     1      TO    KOHI2-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 1)
                                           TO  FTN-KOHI2-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 1)
                                           TO  FTN-KOHI2-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 1)
                                           TO  FTN-KOHI2-D3(IDX2)
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 1)
                                           TO  FTN-KOHI2-D(IDX2)
                                               FTN-KOHI2-D2(IDX2)
                                               FTN-KOHI2-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                             IF  KOHI2-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 2)     =  1
                                 ADD     1      TO    KOHI2-TBL(IDX2)
                                 ADD     1      TO    KOHI2-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 2)
                                           TO  FTN-KOHI2-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 2)
                                           TO  FTN-KOHI2-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 2)
                                           TO  FTN-KOHI2-D3(IDX2)
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 2)
                                           TO  FTN-KOHI2-D(IDX2)
                                               FTN-KOHI2-D2(IDX2)
                                               FTN-KOHI2-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                             IF  KOHI2-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 3)     =  1
                                 ADD     1      TO    KOHI2-TBL(IDX2)
                                 ADD     1      TO    KOHI2-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 3)
                                           TO  FTN-KOHI2-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 3)
                                           TO  FTN-KOHI2-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 3)
                                           TO  FTN-KOHI2-D3(IDX2)
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 3)
                                           TO  FTN-KOHI2-D(IDX2)
                                               FTN-KOHI2-D2(IDX2)
                                               FTN-KOHI2-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                             IF  KOHI2-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 4)     =  1
                                 ADD     1      TO    KOHI2-TBL(IDX2)
                                 ADD     1      TO    KOHI2-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 4)
                                           TO  FTN-KOHI2-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 4)
                                           TO  FTN-KOHI2-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 4)
                                           TO  FTN-KOHI2-D3(IDX2)
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 4)
                                           TO  FTN-KOHI2-D(IDX2)
                                               FTN-KOHI2-D2(IDX2)
                                               FTN-KOHI2-D3(IDX2)
                             END-IF
                        END-EVALUATE
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI2-M
                             END-IF
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI2-M2 =                  
                                        FTN-KOHI2-M2     +              
                                        SYU-KOH1COMPFTN  +              
                                        SYU-KOH1SKJ-FTN                 
                               COMPUTE  FTN-KOHI2-M3 =                  
                                        FTN-KOHI2-M3            +       
                                        SYU-KOH1COMPFTN-ENTANI  +       
                                        SYU-KOH1SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH1COMPFTN                    
                                                TO  FTN-KOHI2-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3        
                             END-IF                                     
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(2)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "024" OR "079"         ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                                ADD   SYU-KOH1HKNFTNMONEY
                                                   TO  FTN-KOHI2-M-JI
                                ADD   SYU-KOH1COMPFTN
                                                   TO  FTN-KOHI2-M2-JI
                                COMPUTE WK-ENTANI =
                                          SYU-KOH1COMPFTN-ENTANI + 0.9
                                ADD   WK-ENTANI    TO  FTN-KOHI2-M3-JI
                             END-IF
                             IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610")
                             AND (LNK-SYU-KOH2HKNNUM    =
                                            "024" OR "079"         )
                             AND (SYU-NYUGAIKBN            = "1"   )
                                ADD   SYU-KOH1SKJ-FTN
                                                   TO  FTN-KOHI2-SKJ
                             END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI2-M
                             END-IF
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI2-M2 =                  
                                        FTN-KOHI2-M2     +              
                                        SYU-KOH2COMPFTN  +              
                                        SYU-KOH2SKJ-FTN                 
                               COMPUTE  FTN-KOHI2-M3 =                  
                                        FTN-KOHI2-M3            +       
                                        SYU-KOH2COMPFTN-ENTANI  +       
                                        SYU-KOH2SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH2COMPFTN                    
                                                TO  FTN-KOHI2-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3        
                             END-IF                                     
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(2)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "024" OR "079"         ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                                ADD   SYU-KOH2HKNFTNMONEY
                                                   TO  FTN-KOHI2-M-JI
                                ADD   SYU-KOH2COMPFTN
                                                   TO  FTN-KOHI2-M2-JI
                                COMPUTE WK-ENTANI =
                                          SYU-KOH2COMPFTN-ENTANI + 0.9
                                ADD   WK-ENTANI    TO  FTN-KOHI2-M3-JI
                             END-IF
                             IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610")
                             AND (LNK-SYU-KOH2HKNNUM    =
                                            "024" OR "079"         )
                             AND (SYU-NYUGAIKBN            = "1"   )
                                ADD   SYU-KOH2SKJ-FTN
                                                   TO  FTN-KOHI2-SKJ
                             END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI2-M
                             END-IF
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI2-M2 =                  
                                        FTN-KOHI2-M2     +              
                                        SYU-KOH3COMPFTN  +              
                                        SYU-KOH3SKJ-FTN                 
                               COMPUTE  FTN-KOHI2-M3 =                  
                                        FTN-KOHI2-M3            +       
                                        SYU-KOH3COMPFTN-ENTANI  +       
                                        SYU-KOH3SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH3COMPFTN                    
                                                TO  FTN-KOHI2-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3        
                             END-IF                                     
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI2-M
                             END-IF
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI2-M2 =                  
                                        FTN-KOHI2-M2     +              
                                        SYU-KOH4COMPFTN  +              
                                        SYU-KOH4SKJ-FTN                 
                               COMPUTE  FTN-KOHI2-M3 =                  
                                        FTN-KOHI2-M3            +       
                                        SYU-KOH4COMPFTN-ENTANI  +       
                                        SYU-KOH4SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH4COMPFTN                    
                                                TO  FTN-KOHI2-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3        
                             END-IF                                     
                 END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *    公費３カウント
           IF  (COMB-KOH3HKNNUM               NOT = SPACE)   AND
               (COMB-KOH3-NYUJGNKBN           =     "1")     
             IF  ( SYU-NYUGAIKBN              =   "1"   )
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI                 =    3   ))
               IF   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH4ID))
      *
                 IF ((WK-1001-PREFNUM         =  07      ) AND
                     (LNK-SYU-KOH3HKNNUM      = "245"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200412" ))
                 OR ((WK-1001-PREFNUM         =  07      ) AND
                     (LNK-SYU-KOH3HKNNUM      = "246"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH3HKNNUM = "181" OR "182"
                                        OR "183" OR "281") AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200704" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH3HKNNUM      = "543"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200710" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH3HKNNUM      = "381"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200801" ))
                 OR ((WK-1001-PREFNUM         =  11           ) AND
                     (LNK-SYU-KOH3HKNNUM      = "743" OR "442"
                                                      OR "542") AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200804"      ))
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                      END-IF
                 END-IF
      *
                 IF ((WK-1001-PREFNUM         =  33      ) AND
                     (LNK-SYU-KOH3HKNNUM      = "285"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200110" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200609" ))
                 OR ((WK-1001-PREFNUM         =  13      ) AND
                     (LNK-SYU-KOH3HKNNUM      = "182"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH1COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH1COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH2COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH2COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH3COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH3COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH4COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH4COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                        END-IF
                      END-IF
                 END-IF
      *
                 IF  (WK-1001-PREFNUM          =  44      ) AND
                     (LNK-SYU-KOH3HKNNUM  = "183" OR "283") AND
                     (LNK-SYU-SRYYMD(1:6)     >= "200610" )
                    IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                                             OR  SYU-KOH2HKNNUM
                                             OR  SYU-KOH3HKNNUM
                                             OR  SYU-KOH4HKNNUM
                       ADD   SYU-JYO-HKNFTNMONEY
                                      TO  WK-OITA-HKNFTNMONEY
                       ADD   SYU-JYO-COMPFTN
                                      TO  WK-OITA-CYOFTN
                    END-IF
                 END-IF
      *
                 IF     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                         (MAX-KIN-KOHI3-M           = ZERO))
                 OR     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                         (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                   PERFORM   VARYING  IDX2  FROM  1  BY  1
                              UNTIL   IDX2   >   31
                     IF   SYU-DAY(IDX2)  =  "1" OR "2"
                        EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                             IF  KOHI3-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 1)     =  1
                                 ADD     1      TO    KOHI3-TBL(IDX2)
                                 ADD     1      TO    KOHI3-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 1)
                                           TO  FTN-KOHI3-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 1)
                                           TO  FTN-KOHI3-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 1)
                                           TO  FTN-KOHI3-D3(IDX2)
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 1)
                                           TO  FTN-KOHI3-D(IDX2)
                                               FTN-KOHI3-D2(IDX2)
                                               FTN-KOHI3-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                             IF  KOHI3-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 2)     =  1
                                 ADD     1      TO    KOHI3-TBL(IDX2)
                                 ADD     1      TO    KOHI3-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 2)
                                           TO  FTN-KOHI3-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 2)
                                           TO  FTN-KOHI3-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 2)
                                           TO  FTN-KOHI3-D3(IDX2)
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 2)
                                           TO  FTN-KOHI3-D(IDX2)
                                               FTN-KOHI3-D2(IDX2)
                                               FTN-KOHI3-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                             IF  KOHI3-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 3)     =  1
                                 ADD     1      TO    KOHI3-TBL(IDX2)
                                 ADD     1      TO    KOHI3-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 3)
                                           TO  FTN-KOHI3-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 3)
                                           TO  FTN-KOHI3-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 3)
                                           TO  FTN-KOHI3-D3(IDX2)
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 3)
                                           TO  FTN-KOHI3-D(IDX2)
                                               FTN-KOHI3-D2(IDX2)
                                               FTN-KOHI3-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                             IF  KOHI3-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 4)     =  1
                                 ADD     1      TO    KOHI3-TBL(IDX2)
                                 ADD     1      TO    KOHI3-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 4)
                                           TO  FTN-KOHI3-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 4)
                                           TO  FTN-KOHI3-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 4)
                                           TO  FTN-KOHI3-D3(IDX2)
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 4)
                                           TO  FTN-KOHI3-D(IDX2)
                                               FTN-KOHI3-D2(IDX2)
                                               FTN-KOHI3-D3(IDX2)
                             END-IF
                        END-EVALUATE
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI3-M
                             END-IF
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI3-M2 =                  
                                        FTN-KOHI3-M2     +              
                                        SYU-KOH1COMPFTN  +              
                                        SYU-KOH1SKJ-FTN                 
                               COMPUTE  FTN-KOHI3-M3 =                  
                                        FTN-KOHI3-M3            +       
                                        SYU-KOH1COMPFTN-ENTANI  +       
                                        SYU-KOH1SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH1COMPFTN                    
                                                TO  FTN-KOHI3-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3        
                             END-IF                                     
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI3-M
                             END-IF
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI3-M2 =                  
                                        FTN-KOHI3-M2     +              
                                        SYU-KOH2COMPFTN  +              
                                        SYU-KOH2SKJ-FTN                 
                               COMPUTE  FTN-KOHI3-M3 =                  
                                        FTN-KOHI3-M3            +       
                                        SYU-KOH2COMPFTN-ENTANI  +       
                                        SYU-KOH2SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH2COMPFTN                    
                                                TO  FTN-KOHI3-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3        
                             END-IF                                     
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI3-M
                             END-IF
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI3-M2 =                  
                                        FTN-KOHI3-M2     +              
                                        SYU-KOH3COMPFTN  +              
                                        SYU-KOH3SKJ-FTN                 
                               COMPUTE  FTN-KOHI3-M3 =                  
                                        FTN-KOHI3-M3            +       
                                        SYU-KOH3COMPFTN-ENTANI  +       
                                        SYU-KOH3SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH3COMPFTN                    
                                                TO  FTN-KOHI3-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3        
                             END-IF                                     
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI3-M
                             END-IF
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI3-M2 =                  
                                        FTN-KOHI3-M2     +              
                                        SYU-KOH4COMPFTN  +              
                                        SYU-KOH4SKJ-FTN                 
                               COMPUTE  FTN-KOHI3-M3 =                  
                                        FTN-KOHI3-M3            +       
                                        SYU-KOH4COMPFTN-ENTANI  +       
                                        SYU-KOH4SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH4COMPFTN                    
                                                TO  FTN-KOHI3-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3        
                             END-IF                                     
                 END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *    公費４カウント
           IF  (COMB-KOH4HKNNUM               NOT = SPACE)   AND
               (COMB-KOH4-NYUJGNKBN           =     "1")     
             IF  ( SYU-NYUGAIKBN              =   "1"   )
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI                 =    4   ))
               IF   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH4ID))
      *
                 IF ((WK-1001-PREFNUM         =  07      ) AND
                     (LNK-SYU-KOH4HKNNUM      = "245"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200412" ))
                 OR ((WK-1001-PREFNUM         =  07      ) AND
                     (LNK-SYU-KOH4HKNNUM      = "246"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH4HKNNUM = "181" OR "182"
                                        OR "183" OR "281") AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200704" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH4HKNNUM      = "543"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200710" ))
                 OR ((WK-1001-PREFNUM         =  11      ) AND
                     (LNK-SYU-KOH4HKNNUM      = "381"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200801" ))
                 OR ((WK-1001-PREFNUM         =  11           ) AND
                     (LNK-SYU-KOH4HKNNUM      = "743" OR "442"
                                                      OR "542") AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200804"      ))
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM
                         MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                         MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                         MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                      END-IF
                 END-IF
      *
                 IF ((WK-1001-PREFNUM         =  33      ) AND
                     (LNK-SYU-KOH4HKNNUM      = "285"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200110" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200609" ))
                 OR ((WK-1001-PREFNUM         =  13      ) AND
                     (LNK-SYU-KOH4HKNNUM      = "182"    ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH1COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH1COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH2COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH2COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH3COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH3COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         COMPUTE  WK-TOKUSYU   = SYU-JYO-COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  WK-TOKUSYU2  = SYU-KOH4COMPFTN-ENTANI
                                               + 0.9
                         COMPUTE  SYU-KOH4COMPFTN-ENTANI =
                                  WK-TOKUSYU   - WK-TOKUSYU2
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                        END-IF
                      END-IF
                 END-IF
      *
                 IF  (WK-1001-PREFNUM          =  44      ) AND
                     (LNK-SYU-KOH4HKNNUM  = "183" OR "283") AND
                     (LNK-SYU-SRYYMD(1:6)     >= "200610" )
                    IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                                             OR  SYU-KOH2HKNNUM
                                             OR  SYU-KOH3HKNNUM
                                             OR  SYU-KOH4HKNNUM
                       ADD   SYU-JYO-HKNFTNMONEY
                                      TO  WK-OITA-HKNFTNMONEY
                       ADD   SYU-JYO-COMPFTN
                                      TO  WK-OITA-CYOFTN
                    END-IF
                 END-IF
      *
                 IF     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                         (MAX-KIN-KOHI4-M           = ZERO))
                 OR     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                         (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                   PERFORM   VARYING  IDX2  FROM  1  BY  1
                              UNTIL   IDX2   >   31
                     IF   SYU-DAY(IDX2)  =  "1" OR "2"
                        EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                             IF  KOHI4-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 1)     =  1
                                 ADD     1      TO    KOHI4-TBL(IDX2)
                                 ADD     1      TO    KOHI4-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 1)
                                           TO  FTN-KOHI4-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 1)
                                           TO  FTN-KOHI4-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 1)
                                           TO  FTN-KOHI4-D3(IDX2)
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 1)
                                           TO  FTN-KOHI4-D(IDX2)
                                               FTN-KOHI4-D2(IDX2)
                                               FTN-KOHI4-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                             IF  KOHI4-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 2)     =  1
                                 ADD     1      TO    KOHI4-TBL(IDX2)
                                 ADD     1      TO    KOHI4-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 2)
                                           TO  FTN-KOHI4-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 2)
                                           TO  FTN-KOHI4-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 2)
                                           TO  FTN-KOHI4-D3(IDX2)
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 2)
                                           TO  FTN-KOHI4-D(IDX2)
                                               FTN-KOHI4-D2(IDX2)
                                               FTN-KOHI4-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                             IF  KOHI4-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 3)     =  1
                                 ADD     1      TO    KOHI4-TBL(IDX2)
                                 ADD     1      TO    KOHI4-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 3)
                                           TO  FTN-KOHI4-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 3)
                                           TO  FTN-KOHI4-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 3)
                                           TO  FTN-KOHI4-D3(IDX2)
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 3)
                                           TO  FTN-KOHI4-D(IDX2)
                                               FTN-KOHI4-D2(IDX2)
                                               FTN-KOHI4-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                             IF  KOHI4-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 4)     =  1
                                 ADD     1      TO    KOHI4-TBL(IDX2)
                                 ADD     1      TO    KOHI4-TBL(32)
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 4)
                                           TO  FTN-KOHI4-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 4)
                                           TO  FTN-KOHI4-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 4)
                                           TO  FTN-KOHI4-D3(IDX2)
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                 ADD  SDAY-SKJFTN(IDX2 4)
                                           TO  FTN-KOHI4-D(IDX2)
                                               FTN-KOHI4-D2(IDX2)
                                               FTN-KOHI4-D3(IDX2)
                             END-IF
                        END-EVALUATE
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI4-M
                             END-IF
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI4-M2 =                  
                                        FTN-KOHI4-M2     +              
                                        SYU-KOH1COMPFTN  +              
                                        SYU-KOH1SKJ-FTN                 
                               COMPUTE  FTN-KOHI4-M3 =                  
                                        FTN-KOHI4-M3            +       
                                        SYU-KOH1COMPFTN-ENTANI  +       
                                        SYU-KOH1SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH1COMPFTN                    
                                                TO  FTN-KOHI4-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3        
                             END-IF                                     
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI4-M
                             END-IF
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI4-M2 =                  
                                        FTN-KOHI4-M2     +              
                                        SYU-KOH2COMPFTN  +              
                                        SYU-KOH2SKJ-FTN                 
                               COMPUTE  FTN-KOHI4-M3 =                  
                                        FTN-KOHI4-M3            +       
                                        SYU-KOH2COMPFTN-ENTANI  +       
                                        SYU-KOH2SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH2COMPFTN                    
                                                TO  FTN-KOHI4-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3        
                             END-IF                                     
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI4-M
                             END-IF
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI4-M2 =                  
                                        FTN-KOHI4-M2     +              
                                        SYU-KOH3COMPFTN  +              
                                        SYU-KOH3SKJ-FTN                 
                               COMPUTE  FTN-KOHI4-M3 =                  
                                        FTN-KOHI4-M3            +       
                                        SYU-KOH3COMPFTN-ENTANI  +       
                                        SYU-KOH3SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH3COMPFTN                    
                                                TO  FTN-KOHI4-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH3COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3        
                             END-IF                                     
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI4-M
                             END-IF
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"           
                               COMPUTE  FTN-KOHI4-M2 =                  
                                        FTN-KOHI4-M2     +              
                                        SYU-KOH4COMPFTN  +              
                                        SYU-KOH4SKJ-FTN                 
                               COMPUTE  FTN-KOHI4-M3 =                  
                                        FTN-KOHI4-M3            +       
                                        SYU-KOH4COMPFTN-ENTANI  +       
                                        SYU-KOH4SKJ-FTN         +       
                                        0.9
                             ELSE                                       
                               ADD   SYU-KOH4COMPFTN                    
                                                TO  FTN-KOHI4-M2        
                               COMPUTE WK-ENTANI =
                                           SYU-KOH4COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3        
                             END-IF                                     
                 END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *
       2201-SYUNOU-COUNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    ７０歳未満現物給付の主保険分編集
      ******************************************************************
       22011-GEN70-SYU-HENSYU-SEC          SECTION.
      *
           IF  (COMB-KOH1HKNNUM  =  SPACE)
           AND (COMB-KOH2HKNNUM  =  SPACE)
           AND (COMB-KOH3HKNNUM  =  SPACE)
           AND (COMB-KOH4HKNNUM  =  SPACE)
             IF  (SYU-KOH1HKNNUM     =  SPACE)
             AND (SYU-KOH2HKNNUM     =  SPACE)
             AND (SYU-KOH3HKNNUM     =  SPACE)
             AND (SYU-KOH4HKNNUM     =  SPACE)
               IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                 MOVE  SYU-SYUCOMPFTN TO  WK-SYU-SYUCOMPFTN
                 COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
                 IF    FLG-IRYOHI70  =  1 OR 2
                   COMPUTE   WK-KOUREI-IRYOHI70  =
                             WK-KOUREI-IRYOHI70  +
                            (SYU-HKNTEN (17) * 10)
                 END-IF
                 COMPUTE     WK-GENBUTU-HKNKIN   =
                             WK-GENBUTU-HKNKIN   +
                            (SYU-HKNTEN (17) * 10)
                 MOVE   ZERO  TO  FLG-TAISYO
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             ELSE
               IF  (SYU-KOHTAIYKZKBN =   "9"          )
               AND (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
                 MOVE  SYU-KOH-FTN    TO  WK-SYU-SYUCOMPFTN
                 COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                 IF    FLG-IRYOHI70  =  1 OR 2
                   COMPUTE   WK-KOUREI-IRYOHI70  =
                             WK-KOUREI-IRYOHI70  +
                            (SYU-HKNTEN (17) * 10)
                 END-IF
                 MOVE   ZERO  TO  FLG-TAISYO
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             END-IF
           ELSE
             IF  (SYU-KOH1HKNNUM     =  SPACE)
             AND (SYU-KOH2HKNNUM     =  SPACE)
             AND (SYU-KOH3HKNNUM     =  SPACE)
             AND (SYU-KOH4HKNNUM     =  SPACE)
               IF  (SYU-KOHTAIYKZKBN =   "9"          )
               AND (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
      ***        MOVE  SYU-SYUCOMPFTN TO  WK-SYU-SYUCOMPFTN
      ***        COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
      ***        IF    FLG-IRYOHI70  =  3 OR 4 OR 6
      ***          COMPUTE   WK-KOUREI-IRYOHI70  =
      ***                    WK-KOUREI-IRYOHI70  +
      ***                   (SYU-HKNTEN (17) * 10)
      ***        END-IF
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             ELSE
               IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                 MOVE  SYU-KOH-FTN    TO  WK-SYU-SYUCOMPFTN
                 COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI + 0.9
                 MOVE   ZERO  TO  FLG-TAISYO
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             END-IF
           END-IF
           ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
           ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
      *
           .
      *
       22011-GEN70-SYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    高齢者の主保険分編集
      ******************************************************************
       22012-KOUREI-SYU-HENSYU-SEC          SECTION.
      *
           IF     COMB-HKNNUM     = "039"
             IF   (SYU-SYUHKNNUM    =  "039"         )
      ***    AND  (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
               IF  (SYU-KOH1HKNNUM     NOT = SPACE)
               OR  (SYU-KOH2HKNNUM     NOT = SPACE)
               OR  (SYU-KOH3HKNNUM     NOT = SPACE)
               OR  (SYU-KOH4HKNNUM     NOT = SPACE)
                 MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                 COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI    + 0.9
               ELSE
                 MOVE    SYU-SYUCOMPFTN  TO  WK-SYU-SYUCOMPFTN
                 COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
               END-IF
               ADD   WK-SYU-SYUCOMPFTN   TO  FTN-SYU-M
               ADD   WK-ENTANI           TO  FTN-SYU-M-ENTANI
               IF  ( COMB-KOH1HKNNUM        =    SPACE)
               AND ( COMB-KOH2HKNNUM        =    SPACE)
               AND ( COMB-KOH3HKNNUM        =    SPACE)
               AND ( COMB-KOH4HKNNUM        =    SPACE)
               AND ( SYU-KOH1HKNNUM         =    SPACE)
               AND ( SYU-KOH2HKNNUM         =    SPACE)
               AND ( SYU-KOH3HKNNUM         =    SPACE)
               AND ( SYU-KOH4HKNNUM         =    SPACE)
               AND ( FLG-IRYOHI         NOT =    ZERO )
                   COMPUTE   WK-KOUREI-IRYOHI  =
                             WK-KOUREI-IRYOHI  +
                            (SYU-HKNTEN (17)   * 10)
               END-IF
               MOVE  ZERO                TO  FLG-TAISYO
             ELSE
               MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
               MOVE   ZERO    TO    WK-ENTANI
               MOVE   1       TO    FLG-TAISYO
             END-IF
           ELSE
             IF    LNK-SYU-SRYYMD(1:6)  >= "200804"
               IF   (SYU-SYUHKNNUM   NOT =  "039"      )
               AND  (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
                 IF  (SYU-KOH1HKNNUM     NOT = SPACE)
                 OR  (SYU-KOH2HKNNUM     NOT = SPACE)
                 OR  (SYU-KOH3HKNNUM     NOT = SPACE)
                 OR  (SYU-KOH4HKNNUM     NOT = SPACE)
                   MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                   COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI    + 0.9
                 ELSE
                   MOVE    SYU-SYUCOMPFTN  TO  WK-SYU-SYUCOMPFTN
                   COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
                 END-IF
                 ADD   WK-SYU-SYUCOMPFTN   TO  FTN-SYU-M
                 ADD   WK-ENTANI           TO  FTN-SYU-M-ENTANI
                 IF  ( COMB-KOH1HKNNUM        =    SPACE)
                 AND ( COMB-KOH2HKNNUM        =    SPACE)
                 AND ( COMB-KOH3HKNNUM        =    SPACE)
                 AND ( COMB-KOH4HKNNUM        =    SPACE)
                 AND ( SYU-KOH1HKNNUM         =    SPACE)
                 AND ( SYU-KOH2HKNNUM         =    SPACE)
                 AND ( SYU-KOH3HKNNUM         =    SPACE)
                 AND ( SYU-KOH4HKNNUM         =    SPACE)
                 AND ( FLG-IRYOHI         NOT =    ZERO )
                     COMPUTE   WK-KOUREI-IRYOHI  =
                               WK-KOUREI-IRYOHI  +
                              (SYU-HKNTEN (17)   * 10)
                 END-IF
                 MOVE  ZERO                TO  FLG-TAISYO
               ELSE
                 MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                 MOVE   ZERO    TO    WK-ENTANI
                 MOVE   1       TO    FLG-TAISYO
               END-IF
             ELSE
               IF  (SYU-KOH1HKNNUM     NOT = SPACE)
               OR  (SYU-KOH2HKNNUM     NOT = SPACE)
               OR  (SYU-KOH3HKNNUM     NOT = SPACE)
               OR  (SYU-KOH4HKNNUM     NOT = SPACE)
                 MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                 COMPUTE WK-ENTANI = SYU-KOH-FTN-ENTANI    + 0.9
               ELSE
                 MOVE    SYU-SYUCOMPFTN  TO  WK-SYU-SYUCOMPFTN
                 COMPUTE WK-ENTANI = SYU-SYUCOMPFTN-ENTANI + 0.9
               END-IF
               ADD   WK-SYU-SYUCOMPFTN   TO  FTN-SYU-M
               ADD   WK-ENTANI           TO  FTN-SYU-M-ENTANI
               IF  ( COMB-KOH1HKNNUM        =    SPACE)
               AND ( COMB-KOH2HKNNUM        =    SPACE)
               AND ( COMB-KOH3HKNNUM        =    SPACE)
               AND ( COMB-KOH4HKNNUM        =    SPACE)
               AND ( SYU-KOH1HKNNUM         =    SPACE)
               AND ( SYU-KOH2HKNNUM         =    SPACE)
               AND ( SYU-KOH3HKNNUM         =    SPACE)
               AND ( SYU-KOH4HKNNUM         =    SPACE)
               AND ( FLG-IRYOHI         NOT =    ZERO )
                   COMPUTE   WK-KOUREI-IRYOHI  =
                             WK-KOUREI-IRYOHI  +
                            (SYU-HKNTEN (17)   * 10)
               END-IF
             END-IF
           END-IF
           .
      *
       22012-KOUREI-SYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    長期の負担編集
      ******************************************************************
       22013-CYOKI-FTN-HENSYU-SEC          SECTION.
      *
           COMPUTE WK-CYOKI        =  WK-CYOKI
                                   +  SYU-KOH-FTN
           COMPUTE WK-CYOKI-ENTANI =  WK-CYOKI-ENTANI
                                   + (SYU-KOH-FTN-ENTANI + 0.9)
      *
           IF  (LNK-SYU-SRYYMD(1:6) >=  "200604"       )
           AND (SYU-KOH1HKNNUM   NOT =  "015" AND "016"
                                              AND "024")
           AND (SYU-KOH2HKNNUM   NOT =  "015" AND "016"
                                              AND "024")
              ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M-JI
              ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M2-JI
              COMPUTE  WK-ENTANI =  SYU-KOH-FTN-ENTANI + 0.9
              ADD   WK-ENTANI    TO  FTN-CYOKI-M3-JI
           END-IF
      *
           .
      *
       22013-CYOKI-FTN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        主保険の減額（＋＠）                                    *
      *        全国公費の減額（＋＠）                                  *
      ******************************************************************
       2202-KOHFTN-KINGAKU-GEN2-SEC           SECTION.
      *
           IF  FLG-GENBUTU70   NOT =   ZERO
            IF  FLG-IRYOHI70   NOT =   ZERO
               IF   MAX-KIN-SYU-M     NOT = ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-SYU-M       =
                                  (MAX-KIN-SYU-M       *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        CONTINUE
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-SYU-M
                   END-EVALUATE
                   IF   MAX-KIN-SYU-M  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-GEN70
                   END-IF
               END-IF
            END-IF
            IF  FLG-IRYOHI70K  =  1  OR  2
               IF   MAX-KIN-KOHI1-M     NOT =  ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-KOHI1-M     =
                                  (MAX-KIN-KOHI1-M     *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        CONTINUE
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                   END-EVALUATE
                   IF   MAX-KIN-KOHI1-M  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-GEN70K
                   END-IF
               END-IF
            END-IF
           ELSE
            IF    ( FLG-IRYOHI     =      1 )
            OR    ( FLG-IRYOHI3    =      1 )
               IF   MAX-KIN-KOHI1-M   NOT =  ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-KOHI1-M     =
                                  (MAX-KIN-KOHI1-M     *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        CONTINUE
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                   END-EVALUATE
                   IF   FLG-IRYOHI       =   1
                   AND  MAX-KIN-KOHI1-M  =  ZERO
                       MOVE     ZERO     TO    FLG-KOUGAKUCYO
                   END-IF
                   IF   FLG-IRYOHI3      =   1
                   AND  MAX-KIN-KOHI1-M  =  ZERO
                       MOVE     ZERO     TO    FLG-KOUGAKUCYO3
                   END-IF
               END-IF
            END-IF
            IF    ( FLG-IRYOHI     =      2 )
            OR    ( FLG-IRYOHI3    =      2 )
               IF   MAX-KIN-SYU-M     NOT = ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-SYU-M       =
                                  (MAX-KIN-SYU-M       *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        CONTINUE
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-SYU-M
                   END-EVALUATE
                   IF   FLG-IRYOHI     =      2
                   AND  MAX-KIN-SYU-M  =     ZERO
                       MOVE     ZERO     TO    FLG-KOUGAKUCYO
                   END-IF
                   IF   FLG-IRYOHI3    =      2
                   AND  MAX-KIN-SYU-M  =     ZERO
                       MOVE     ZERO     TO    FLG-KOUGAKUCYO3
                   END-IF
               END-IF
            END-IF
            IF    ( FLG-IRYOHI4    =      1 )
               IF   MAX-KIN-KOHI1-M   NOT =  ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-KOHI1-M     =
                                  (MAX-KIN-KOHI1-M     *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        CONTINUE
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                   END-EVALUATE
                   IF   MAX-KIN-KOHI1-M  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-JIRITU
                   END-IF
               END-IF
            END-IF
           END-IF
      *
           .
      *
       2202-KOHFTN-KINGAKU-GEN2-EXT.
           EXIT.
      *
      ******************************************************************
      *    保険・公費の負担金計算
      ******************************************************************
       230-FTNKIN-SEC           SECTION.
      *
      *    １日単位の算定可能残額を算出する
      *
           PERFORM        2301-DAY-ZAN-HENSYU-SEC.
      *
      *    算定可能フラグの初期化
           MOVE     SPACE                  TO     FLG-SANTEI1
                                                  FLG-SANTEI2
                                                  FLG-SANTEI3
                                                  FLG-SANTEI4.
      *
      *    過去の患者保険負担累計額と上限金額の比較
      *
           IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
           OR   (FLG-KOHININBARAI           =    1 )
           OR   (FLG-GENBUTU70          NOT =  ZERO)
               IF  MAX-KIN-SYU-M           NOT =  ZERO
                   IF  FTN-SYU-M           >=     MAX-KIN-SYU-M
                       MOVE  "1"           TO     FLG-SANTEI-SYU
                   END-IF
               END-IF
           END-IF.
      ***     IF       MAX-KIN-KOHI1-M        NOT =  ZERO
      ***         IF   FTN-KOHI1-M            >=     MAX-KIN-KOHI1-M
      ***              MOVE     "1"           TO     FLG-SANTEI1
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI2-M        NOT =  ZERO
      ***         IF   FTN-KOHI2-M            >=     MAX-KIN-KOHI2-M
      ***              MOVE     "1"           TO     FLG-SANTEI2
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI3-M        NOT =  ZERO
      ***         IF   FTN-KOHI3-M            >=     MAX-KIN-KOHI3-M
      ***              MOVE     "1"           TO     FLG-SANTEI3
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI4-M        NOT =  ZERO
      ***         IF   FTN-KOHI4-M            >=     MAX-KIN-KOHI4-M
      ***              MOVE     "1"           TO     FLG-SANTEI4
      ***         END-IF
      ***     END-IF.
      *
      *    保険（公費）テーブルの患者負担上限額と当月の患者負担累計額
      *    から算定可能残額を算出する
      *
           IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
           OR   (FLG-KOHININBARAI           =    1 )
           OR   (FLG-GENBUTU70          NOT =  ZERO)
               IF  FLG-SANTEI-SYU            =   "1"                  
                       MOVE  ZERO        TO      ZAN-SYU-M            
               ELSE                                                   
                   IF  FTN-SYU-M         >=    MAX-KIN-SYU-M          
                       MOVE  ZERO        TO      ZAN-SYU-M
                   ELSE
                       COMPUTE  ZAN-SYU-M  =   MAX-KIN-SYU-M  -
                                               FTN-SYU-M
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI1               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI1-M
                                               ZAN-KOHI1-M2             
                                               ZAN-KOHI1-M3             
           ELSE
               IF (COMB-KOH1HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH1-NYUJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI1-M       NOT = ZERO
                       IF   FTN-KOHI1-M           >=  MAX-KIN-KOHI1-M
                            MOVE     ZERO         TO  ZAN-KOHI1-M
                       ELSE
                            COMPUTE  ZAN-KOHI1-M  =   MAX-KIN-KOHI1-M -
                                                      FTN-KOHI1-M
                       END-IF
                       IF  COMB-KOH1HKNNUM    =   "027"                 
                            MOVE     ZERO         TO  ZAN-KOHI1-M2      
                       ELSE                                             
                         IF   FTN-KOHI1-M2        >=  MAX-KIN-KOHI1-M   
                            MOVE     ZERO         TO  ZAN-KOHI1-M2      
                         ELSE                                           
                            COMPUTE  ZAN-KOHI1-M2 =   MAX-KIN-KOHI1-M - 
                                                      FTN-KOHI1-M2      
                         END-IF                                         
                       END-IF                                           
                       IF  COMB-KOH1HKNNUM    =   "027"                 
                            MOVE     ZERO         TO  ZAN-KOHI1-M3      
                       ELSE                                             
                         IF   FTN-KOHI1-M3        >=  MAX-KIN-KOHI1-M   
                            MOVE     ZERO         TO  ZAN-KOHI1-M3      
                         ELSE                                           
                            COMPUTE  ZAN-KOHI1-M3 =   MAX-KIN-KOHI1-M - 
                                                      FTN-KOHI1-M3      
                         END-IF                                         
                       END-IF                                           
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI2               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI2-M
                                               ZAN-KOHI2-M2             
                                               ZAN-KOHI2-M3             
           ELSE
               IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH2-NYUJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI2-M       NOT = ZERO
                       IF   FTN-KOHI2-M           >=  MAX-KIN-KOHI2-M
                            MOVE     ZERO         TO  ZAN-KOHI2-M
                       ELSE
                            COMPUTE  ZAN-KOHI2-M  =   MAX-KIN-KOHI2-M -
                                                      FTN-KOHI2-M
                       END-IF
                       IF   FTN-KOHI2-M2          >=  MAX-KIN-KOHI2-M   
                            MOVE     ZERO         TO  ZAN-KOHI2-M2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI2-M2 =   MAX-KIN-KOHI2-M - 
                                                      FTN-KOHI2-M2      
                       END-IF                                           
                       IF   FTN-KOHI2-M3          >=  MAX-KIN-KOHI2-M   
                            MOVE     ZERO         TO  ZAN-KOHI2-M3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI2-M3 =   MAX-KIN-KOHI2-M - 
                                                      FTN-KOHI2-M3      
                       END-IF                                           
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI3               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI3-M
                                               ZAN-KOHI3-M2             
                                               ZAN-KOHI3-M3             
           ELSE
               IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH3-NYUJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI3-M       NOT = ZERO
                       IF   FTN-KOHI3-M           >=  MAX-KIN-KOHI3-M
                            MOVE     ZERO         TO  ZAN-KOHI3-M
                       ELSE
                            COMPUTE  ZAN-KOHI3-M  =   MAX-KIN-KOHI3-M -
                                                      FTN-KOHI3-M
                       END-IF
                       IF   FTN-KOHI3-M2          >=  MAX-KIN-KOHI3-M   
                            MOVE     ZERO         TO  ZAN-KOHI3-M2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI3-M2 =   MAX-KIN-KOHI3-M - 
                                                      FTN-KOHI3-M2      
                       END-IF                                           
                       IF   FTN-KOHI3-M3          >=  MAX-KIN-KOHI3-M   
                            MOVE     ZERO         TO  ZAN-KOHI3-M3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI3-M3 =   MAX-KIN-KOHI3-M - 
                                                      FTN-KOHI3-M3      
                       END-IF                                           
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI4               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI4-M
                                               ZAN-KOHI4-M2             
                                               ZAN-KOHI4-M3             
           ELSE
               IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH4-NYUJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI4-M       NOT = ZERO
                       IF   FTN-KOHI4-M           >=  MAX-KIN-KOHI4-M
                            MOVE     ZERO         TO  ZAN-KOHI4-M
                       ELSE
                            COMPUTE  ZAN-KOHI4-M  =   MAX-KIN-KOHI4-M -
                                                      FTN-KOHI4-M
                       END-IF
                       IF   FTN-KOHI4-M2          >=  MAX-KIN-KOHI4-M   
                            MOVE     ZERO         TO  ZAN-KOHI4-M2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI4-M2 =   MAX-KIN-KOHI4-M - 
                                                      FTN-KOHI4-M2      
                       END-IF                                           
                       IF   FTN-KOHI4-M3          >=  MAX-KIN-KOHI4-M   
                            MOVE     ZERO         TO  ZAN-KOHI4-M3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI4-M3 =   MAX-KIN-KOHI4-M - 
                                                      FTN-KOHI4-M3      
                       END-IF                                           
                   END-IF
               END-IF
           END-IF.
      *
      *    月の患者負担可能残額をセットする
           IF (COMB-KOH1HKNNUM              NOT = SPACE)    AND
              (COMB-KOH1-NYUJGNKBN          =     "1")
               MOVE   ZAN-KOHI1-M     TO   ZAN-KOHI1
               MOVE   ZAN-KOHI1-M2    TO   ZAN-KOHI12               
               MOVE   ZAN-KOHI1-M3    TO   ZAN-KOHI13               
      ****
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604"       ) AND
                   ( COMB-KOH1HKNNUM = "015" OR "016" OR "021") AND
                   ( WK-JIRITU-CYUKANSOU(1) =   2             ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610"       ) AND
                   ( COMB-KOH1HKNNUM = "024" OR "079"         ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200804"       ) AND
                   ( COMB-KOH1HKNNUM = "038"                  ))
                   IF  ( COMB-KOH1HKNNUM  = "015" OR "016"
                                         OR "024" OR "079" OR "038" )
                   AND ((COMB-KOH2HKNNUM  = "972") OR
                        (COMB-KOH3HKNNUM  = "972") OR
                        (COMB-KOH4HKNNUM  = "972"))
                   AND ( MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO)
                      IF    FTN-KOHI1-M-JI   >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ( COMB-KOH1HKNNUM  = "015" OR "016"
                                         OR "024" OR "079" OR "038" )
                   AND ((COMB-KOH2HKNNUM  = "974") OR
                        (COMB-KOH3HKNNUM  = "974") OR
                        (COMB-KOH4HKNNUM  = "974"))
                   AND ( MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO2)
                      IF    FTN-KOHI1-M-JI   >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ( LNK-S02-KOUREI-NYUIN-KBN  =    "1")
                   AND ( MAX-KIN-KOHI1-M > WK-KOH-GENDOGAKU)
                      IF    FTN-KOHI1-M-JI   >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ( FLG-GENBUTU70   NOT =   ZERO        )
                   AND ( MAX-KIN-KOHI1-M > WK-GEN70-GENDOGAKU)
                      IF    FTN-KOHI1-M-JI   >=   WK-GEN70-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-GEN70-GENDOGAKU
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-GEN70-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-GEN70-GENDOGAKU
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-GEN70-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-GEN70-GENDOGAKU
                                              - FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
                   END-IF
               END-IF
      *+++
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
                   ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
                   ((COMB-KOH2HKNNUM  = "972") OR
                    (COMB-KOH3HKNNUM  = "972") OR
                    (COMB-KOH4HKNNUM  = "972"))         )
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
                   ( COMB-KOH1HKNNUM  = "024"          ) AND
                   ((COMB-KOH2HKNNUM  = "972") OR
                    (COMB-KOH3HKNNUM  = "972") OR
                    (COMB-KOH4HKNNUM  = "972"))         )
                      IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-CYOKI-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-CYOKI-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-CYOKI-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
               END-IF
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
                   ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
                   ((COMB-KOH2HKNNUM  = "974") OR
                    (COMB-KOH3HKNNUM  = "974") OR
                    (COMB-KOH4HKNNUM  = "974"))         )
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
                   ( COMB-KOH1HKNNUM  = "024"          ) AND
                   ((COMB-KOH2HKNNUM  = "974") OR
                    (COMB-KOH3HKNNUM  = "974") OR
                    (COMB-KOH4HKNNUM  = "974"))         )
                      IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-CYOKI-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-CYOKI-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-CYOKI-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI13
                      END-IF
               END-IF
      ****
           END-IF.
      *
           IF (COMB-KOH2HKNNUM              NOT = SPACE)    AND
              (COMB-KOH2-NYUJGNKBN          =     "1")
               MOVE   ZAN-KOHI2-M     TO   ZAN-KOHI2
               MOVE   ZAN-KOHI2-M2    TO   ZAN-KOHI22               
               MOVE   ZAN-KOHI2-M3    TO   ZAN-KOHI23               
      ****
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604"       ) AND
                   ( COMB-KOH2HKNNUM = "015" OR "016" OR "021") AND
                   ( WK-JIRITU-CYUKANSOU(2) =   2             ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610"       ) AND
                   ( COMB-KOH2HKNNUM = "024" OR "079"         ))
                   IF  ( COMB-KOH2HKNNUM  = "015" OR "016"
                                         OR "024" OR "079" )
                   AND ((COMB-KOH1HKNNUM  = "972") OR
                        (COMB-KOH3HKNNUM  = "972") OR
                        (COMB-KOH4HKNNUM  = "972"))
                   AND ( MAX-KIN-KOHI2-M  >  WK-CYOKI-GENDO)
                      IF    FTN-KOHI2-M-JI   >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI2-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-KOHI2-M2-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI2-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-KOHI2-M3-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI2-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
                      END-IF
                   END-IF
                   IF  ( COMB-KOH2HKNNUM  = "015" OR "016"
                                         OR "024" OR "079" )
                   AND ((COMB-KOH1HKNNUM  = "974") OR
                        (COMB-KOH3HKNNUM  = "974") OR
                        (COMB-KOH4HKNNUM  = "974"))
                   AND ( MAX-KIN-KOHI2-M  >  WK-CYOKI-GENDO2)
                      IF    FTN-KOHI2-M-JI   >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI2-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-KOHI2-M2-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI2-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-KOHI2-M3-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI2-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
                      END-IF
                   END-IF
                   IF  ( LNK-S02-KOUREI-NYUIN-KBN  =    "1")
                   AND ( MAX-KIN-KOHI2-M > WK-KOH-GENDOGAKU)
                      IF    FTN-KOHI2-M-JI   >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI2-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-KOHI2-M2-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI2-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-KOHI2-M3-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI2-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
                      END-IF
                   END-IF
               END-IF
      *+++
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
                   ( COMB-KOH2HKNNUM  = "015" OR "016" ) AND
                   ((COMB-KOH1HKNNUM  = "972") OR
                    (COMB-KOH3HKNNUM  = "972") OR
                    (COMB-KOH4HKNNUM  = "972"))         )
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
                   ( COMB-KOH2HKNNUM  = "024"          ) AND
                   ((COMB-KOH1HKNNUM  = "972") OR
                    (COMB-KOH3HKNNUM  = "972") OR
                    (COMB-KOH4HKNNUM  = "972"))         )
                      IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-CYOKI-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-CYOKI-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-CYOKI-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
                      END-IF
               END-IF
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
                   ( COMB-KOH2HKNNUM  = "015" OR "016" ) AND
                   ((COMB-KOH1HKNNUM  = "974") OR
                    (COMB-KOH3HKNNUM  = "974") OR
                    (COMB-KOH4HKNNUM  = "974"))         )
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
                   ( COMB-KOH2HKNNUM  = "024"          ) AND
                   ((COMB-KOH1HKNNUM  = "974") OR
                    (COMB-KOH3HKNNUM  = "974") OR
                    (COMB-KOH4HKNNUM  = "974"))         )
                      IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-CYOKI-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-CYOKI-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-CYOKI-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI23
                      END-IF
               END-IF
      ****
           END-IF.
      *
           IF (COMB-KOH3HKNNUM              NOT = SPACE)    AND
              (COMB-KOH3-NYUJGNKBN          =     "1")
               MOVE   ZAN-KOHI3-M     TO   ZAN-KOHI3
               MOVE   ZAN-KOHI3-M2    TO   ZAN-KOHI32               
               MOVE   ZAN-KOHI3-M3    TO   ZAN-KOHI33               
           END-IF.
      *
           IF (COMB-KOH4HKNNUM              NOT = SPACE)    AND
              (COMB-KOH4-NYUJGNKBN          =     "1")
               MOVE   ZAN-KOHI4-M     TO   ZAN-KOHI4
               MOVE   ZAN-KOHI4-M2    TO   ZAN-KOHI42               
               MOVE   ZAN-KOHI4-M3    TO   ZAN-KOHI43               
           END-IF.
      *
           IF  LNK-SYU-SRYYMD(1:6)   >=  "200610"
               IF   COMB-KOH1HKNNUM   =  "024" OR "079"
                  IF  FTN-KOHI1-SKJ  >=  WK-SYOGAI-SKJGAK(1)
                       MOVE     ZERO   TO   ZAN-KOHI1-SKJ
                  ELSE
                       COMPUTE  ZAN-KOHI1-SKJ =  WK-SYOGAI-SKJGAK(1)
                                              -  FTN-KOHI1-SKJ
                  END-IF
               END-IF
               IF   COMB-KOH2HKNNUM   =  "024" OR "079"
                  IF  FTN-KOHI2-SKJ  >=  WK-SYOGAI-SKJGAK(2)
                       MOVE     ZERO   TO   ZAN-KOHI2-SKJ
                  ELSE
                       COMPUTE  ZAN-KOHI2-SKJ =  WK-SYOGAI-SKJGAK(2)
                                              -  FTN-KOHI2-SKJ
                  END-IF
               END-IF
           END-IF.
      *
      *    主保険負担金額の円単位　残金額計算                           
           IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
           OR   (FLG-KOHININBARAI           =    1 )
           OR   (FLG-GENBUTU70          NOT =  ZERO)
                PERFORM    2303-SYUENTANI-ZANKIN-KEISAN-SEC
           END-IF.
      *
      *    食事療養費等の計算
           MOVE    ZERO   TO   WK-SKJ-ZEIKEI.
           MOVE    ZERO   TO   WK-SKJ-ZEIKEIL.
           MOVE    ZERO   TO   WK-SKJ-ZEIKEI2.
           MOVE    ZERO   TO   WK-SKJ-ZEIKEI2L.
           IF   LNK-SYU-SRYYMD(1:6)       >=   "200604"
                PERFORM       2304-SHOKUJI-KEISAN200604-SEC
           ELSE
                PERFORM       2304-SHOKUJI-KEISAN-SEC
           END-IF.
      *
      *    保険・公費毎の患者負担金額の計算
           MOVE     ZERO       TO       WK-DAY-NYUKFTNRATE.
           MOVE     ZERO       TO       WK-KOH-FTNRATE.
           MOVE     ZERO       TO       FLG-GENBUTU-TAISYODATA.
           IF    ((COMB-KOH1-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH1HKNNUM           =   "027")) OR 
                 ((COMB-KOH2-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH2HKNNUM           =   "027")) OR 
                 ((COMB-KOH3-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH3HKNNUM           =   "027")) OR 
                 ((COMB-KOH4-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH4HKNNUM           =   "027")) 
                  CONTINUE
           ELSE
               IF    COMB-HKNNUM             NOT =       SPACE
                  PERFORM    2305-SYUHOKEN-KEISAN-SEC
               END-IF
           END-IF.
      *
           MOVE     ZERO     TO     WK-TOKUTEI-COMPFTN3.
           MOVE     SPACE    TO     FLG-KUMAMOTO.
           INITIALIZE               WK-TAIHI-RECEFTNDSPKBN-OCC.
      *
           INITIALIZE               WK-SYOUKAN-FLG-TAIHI-AREA.
           INITIALIZE               WK-TAIHI-KANSEN11-OCC.
      *
           MOVE    ZERO      TO     WK-TOKUSYU-COMPFTN.
           MOVE    9999999   TO     WK-TOKUSYU-COMPFTN2.
           MOVE    ZERO      TO     WK-TOKUSYU-ENTANI.
      *
           MOVE    ZERO      TO     WK-CYOKI-ZAN.
           MOVE    ZERO      TO     WK-CYOKI-ZAN-ENTANI.
           IF   (COMB-KOH1HKNNUM     = "972") OR
                (COMB-KOH2HKNNUM     = "972") OR
                (COMB-KOH3HKNNUM     = "972") OR
                (COMB-KOH4HKNNUM     = "972")
                 IF   WK-CYOKI         >   WK-CYOKI-GENDO
                    MOVE   ZERO   TO   WK-CYOKI-ZAN
                 ELSE
                    COMPUTE WK-CYOKI-ZAN  =  WK-CYOKI-GENDO
                                          -  WK-CYOKI
                 END-IF
                 IF   WK-CYOKI-ENTANI  >   WK-CYOKI-GENDO
                    MOVE   ZERO   TO   WK-CYOKI-ZAN-ENTANI
                 ELSE
                    COMPUTE WK-CYOKI-ZAN-ENTANI =  WK-CYOKI-GENDO
                                                -  WK-CYOKI-ENTANI
                 END-IF
           END-IF.
           IF   (COMB-KOH1HKNNUM     = "974") OR
                (COMB-KOH2HKNNUM     = "974") OR
                (COMB-KOH3HKNNUM     = "974") OR
                (COMB-KOH4HKNNUM     = "974")
                 IF   WK-CYOKI         >   WK-CYOKI-GENDO2
                    MOVE   ZERO   TO   WK-CYOKI-ZAN
                 ELSE
                    COMPUTE WK-CYOKI-ZAN  =  WK-CYOKI-GENDO2
                                          -  WK-CYOKI
                 END-IF
                 IF   WK-CYOKI-ENTANI  >   WK-CYOKI-GENDO2
                    MOVE   ZERO   TO   WK-CYOKI-ZAN-ENTANI
                 ELSE
                    COMPUTE WK-CYOKI-ZAN-ENTANI =  WK-CYOKI-GENDO2
                                                -  WK-CYOKI-ENTANI
                 END-IF
           END-IF.
      *
           PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                      UNTIL    (KOH-IDX    >      4)
               IF   COMB-KOHHKNNUM(KOH-IDX)  NOT =  SPACE
                    PERFORM    2306-KOH-HKNREAD-SEC
                    IF   FLG-CHIHOU(KOH-IDX)  =  "1"
                      IF    WK-NYUKFTNRATE  =  ZERO
                          MOVE  SPACE  TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
                      END-IF
                    END-IF
                    IF   COMB-KOH-NYUJGNKBN(KOH-IDX)  =  "1"
                         PERFORM   2307-KOH-KEISAN-SEC
                    ELSE
                         PERFORM   2308-KOH-KEISAN2-SEC
                    END-IF
               END-IF 
           END-PERFORM.
      *
      *     公費単位で計算した患者負担金額から最小の値を選択セット
            PERFORM   2309-FTNKIN-HIKAKU-SEC.
      *
       230-FTNKIN-EXT.
           EXIT.
      *
      ******************************************************************
      *        １日単位の算定可能残額を算出する
      ******************************************************************
       2301-DAY-ZAN-HENSYU-SEC           SECTION.
      *
           INITIALIZE     WK-DAYINFFLG-AREA.
      *
           IF (COMB-KOH1HKNNUM           NOT = SPACE)    AND
              (COMB-KOH1-NYUJGNKBN       =     "1")
               IF     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                       (MAX-KIN-KOHI1-M           = ZERO))
               OR     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                       (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF   ( LNK-SYU-DAY(IDX2)          =  "1" OR "2" )
                     AND  ( LNK-SDAY-HKNTEN(IDX2)      NOT =  ZERO   )
                       IF   MAX-KAI-KOHI1-M       NOT = ZERO
                          IF  KOHI1-TBL(IDX2)  NOT = ZERO
                             MOVE     SPACE    TO    FLG-NG
                             MOVE      9       TO    KOHI1-TBL(IDX2)
                          ELSE
                             IF   KOHI1-TBL(32)  >=  MAX-KAI-KOHI1-M
                               MOVE   "1"      TO    FLG-NG
                             ELSE
                               MOVE   SPACE    TO    FLG-NG
                               MOVE    9       TO    KOHI1-TBL(IDX2)
                               ADD     1       TO    KOHI1-TBL(32)
                             END-IF
                          END-IF
                       ELSE
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI1-TBL(IDX2)
                       END-IF
                       IF     FLG-NG   =    SPACE  
                         MOVE        1         TO    WK-DAYINFFLG(1)
                         IF   FTN-KOHI1-D(IDX2)     >=  MAX-KIN-KOHI1-D
                              MOVE     ZERO    TO  ZAN-KOHI1-D(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI1-D(IDX2) =
                                       MAX-KIN-KOHI1-D   -
                                       FTN-KOHI1-D(IDX2)
                         END-IF
                         IF   FTN-KOHI1-D2(IDX2)  >=  MAX-KIN-KOHI1-D
                              MOVE     ZERO    TO  ZAN-KOHI1-D2(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI1-D2(IDX2) =
                                       MAX-KIN-KOHI1-D    -
                                       FTN-KOHI1-D2(IDX2)
                         END-IF
                         IF   FTN-KOHI1-D3(IDX2)  >=  MAX-KIN-KOHI1-D
                              MOVE     ZERO    TO  ZAN-KOHI1-D3(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI1-D3(IDX2) =
                                       MAX-KIN-KOHI1-D    -
                                       FTN-KOHI1-D3(IDX2)
                         END-IF
                       END-IF
                     END-IF
                  END-PERFORM
               END-IF
           END-IF.
      *
           IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
              (COMB-KOH2-NYUJGNKBN       =     "1")
               IF     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                       (MAX-KIN-KOHI2-M           = ZERO))
               OR     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                       (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF   ( LNK-SYU-DAY(IDX2)          =  "1" OR "2" )
                     AND  ( LNK-SDAY-HKNTEN(IDX2)      NOT =  ZERO   )
                       IF   MAX-KAI-KOHI2-M       NOT = ZERO
                          IF  KOHI2-TBL(IDX2)  NOT = ZERO
                             MOVE     SPACE    TO    FLG-NG
                             MOVE      9       TO    KOHI2-TBL(IDX2)
                          ELSE
                             IF   KOHI2-TBL(32)  >=  MAX-KAI-KOHI2-M
                               MOVE   "1"      TO    FLG-NG
                             ELSE
                               MOVE   SPACE    TO    FLG-NG
                               MOVE    9       TO    KOHI2-TBL(IDX2)
                               ADD     1       TO    KOHI2-TBL(32)
                             END-IF
                          END-IF
                       ELSE
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI2-TBL(IDX2)
                       END-IF
                       IF     FLG-NG   =    SPACE  
                         MOVE        1         TO    WK-DAYINFFLG(2)
                         IF   FTN-KOHI2-D(IDX2)     >=  MAX-KIN-KOHI2-D
                              MOVE     ZERO    TO  ZAN-KOHI2-D(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI2-D(IDX2) =
                                       MAX-KIN-KOHI2-D   -
                                       FTN-KOHI2-D(IDX2)
                         END-IF
                         IF   FTN-KOHI2-D2(IDX2)  >=  MAX-KIN-KOHI2-D
                              MOVE     ZERO    TO  ZAN-KOHI2-D2(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI2-D2(IDX2) =
                                       MAX-KIN-KOHI2-D    -
                                       FTN-KOHI2-D2(IDX2)
                         END-IF
                         IF   FTN-KOHI2-D3(IDX2)  >=  MAX-KIN-KOHI2-D
                              MOVE     ZERO    TO  ZAN-KOHI2-D3(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI2-D3(IDX2) =
                                       MAX-KIN-KOHI2-D    -
                                       FTN-KOHI2-D3(IDX2)
                         END-IF
                       END-IF
                     END-IF
                  END-PERFORM
               END-IF
           END-IF.
      *
           IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
              (COMB-KOH3-NYUJGNKBN       =     "1")
               IF     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                       (MAX-KIN-KOHI3-M           = ZERO))
               OR     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                       (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF   ( LNK-SYU-DAY(IDX2)          =  "1" OR "2" )
                     AND  ( LNK-SDAY-HKNTEN(IDX2)      NOT =  ZERO   )
                       IF   MAX-KAI-KOHI3-M       NOT = ZERO
                          IF  KOHI3-TBL(IDX2)  NOT = ZERO
                             MOVE     SPACE    TO    FLG-NG
                             MOVE      9       TO    KOHI3-TBL(IDX2)
                          ELSE
                             IF   KOHI3-TBL(32)  >=  MAX-KAI-KOHI3-M
                               MOVE   "1"      TO    FLG-NG
                             ELSE
                               MOVE   SPACE    TO    FLG-NG
                               MOVE    9       TO    KOHI3-TBL(IDX2)
                               ADD     1       TO    KOHI3-TBL(32)
                             END-IF
                          END-IF
                       ELSE
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI3-TBL(IDX2)
                       END-IF
                       IF     FLG-NG   =    SPACE  
                         MOVE        1         TO    WK-DAYINFFLG(3)
                         IF   FTN-KOHI3-D(IDX2)     >=  MAX-KIN-KOHI3-D
                              MOVE     ZERO    TO  ZAN-KOHI3-D(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI3-D(IDX2) =
                                       MAX-KIN-KOHI3-D   -
                                       FTN-KOHI3-D(IDX2)
                         END-IF
                         IF   FTN-KOHI3-D2(IDX2)  >=  MAX-KIN-KOHI3-D
                              MOVE     ZERO    TO  ZAN-KOHI3-D2(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI3-D2(IDX2) =
                                       MAX-KIN-KOHI3-D    -
                                       FTN-KOHI3-D2(IDX2)
                         END-IF
                         IF   FTN-KOHI3-D3(IDX2)  >=  MAX-KIN-KOHI3-D
                              MOVE     ZERO    TO  ZAN-KOHI3-D3(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI3-D3(IDX2) =
                                       MAX-KIN-KOHI3-D    -
                                       FTN-KOHI3-D3(IDX2)
                         END-IF
                       END-IF
                     END-IF
                  END-PERFORM
               END-IF
           END-IF.
      *
           IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
              (COMB-KOH4-NYUJGNKBN       =     "1")
               IF     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                       (MAX-KIN-KOHI4-M           = ZERO))
               OR     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                       (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF   ( LNK-SYU-DAY(IDX2)          =  "1" OR "2" )
                     AND  ( LNK-SDAY-HKNTEN(IDX2)      NOT =  ZERO   )
                       IF   MAX-KAI-KOHI4-M       NOT = ZERO
                          IF  KOHI4-TBL(IDX2)  NOT = ZERO
                             MOVE     SPACE    TO    FLG-NG
                             MOVE      9       TO    KOHI4-TBL(IDX2)
                          ELSE
                             IF   KOHI4-TBL(32)  >=  MAX-KAI-KOHI4-M
                               MOVE   "1"      TO    FLG-NG
                             ELSE
                               MOVE   SPACE    TO    FLG-NG
                               MOVE    9       TO    KOHI4-TBL(IDX2)
                               ADD     1       TO    KOHI4-TBL(32)
                             END-IF
                          END-IF
                       ELSE
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI4-TBL(IDX2)
                       END-IF
                       IF     FLG-NG   =    SPACE  
                         MOVE        1         TO    WK-DAYINFFLG(4)
                         IF   FTN-KOHI4-D(IDX2)     >=  MAX-KIN-KOHI4-D
                              MOVE     ZERO    TO  ZAN-KOHI4-D(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI4-D(IDX2) =
                                       MAX-KIN-KOHI4-D   -
                                       FTN-KOHI4-D(IDX2)
                         END-IF
                         IF   FTN-KOHI4-D2(IDX2)  >=  MAX-KIN-KOHI4-D
                              MOVE     ZERO    TO  ZAN-KOHI4-D2(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI4-D2(IDX2) =
                                       MAX-KIN-KOHI4-D    -
                                       FTN-KOHI4-D2(IDX2)
                         END-IF
                         IF   FTN-KOHI4-D3(IDX2)  >=  MAX-KIN-KOHI4-D
                              MOVE     ZERO    TO  ZAN-KOHI4-D3(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI4-D3(IDX2) =
                                       MAX-KIN-KOHI4-D    -
                                       FTN-KOHI4-D3(IDX2)
                         END-IF
                       END-IF
                     END-IF
                  END-PERFORM
               END-IF
           END-IF.
      *
       2301-DAY-ZAN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        主保険負担金額の円単位　残金額計算
      ******************************************************************
       2303-SYUENTANI-ZANKIN-KEISAN-SEC           SECTION.              
      *
      *    算定可能フラグの初期化
           MOVE     SPACE                  TO     FLG-SANTEI1-ENTANI
                                                  FLG-SANTEI-SYU-ENTANI.
      *
      *    過去の患者保険負担累計額と上限金額の比較
      *
           IF   COMB-KOH1HKNNUM      =    "027"
             IF       MAX-KIN-KOHI1-M        NOT =  ZERO
               IF   FTN-KOHI1-M-ENTANI        >=     MAX-KIN-KOHI1-M
                       MOVE     "1"       TO     FLG-SANTEI1-ENTANI
               END-IF
             END-IF
           END-IF.
      *
           IF         MAX-KIN-SYU-M          NOT =  ZERO
               IF  FTN-SYU-M-ENTANI           >=     MAX-KIN-SYU-M
                      MOVE  "1"           TO     FLG-SANTEI-SYU-ENTANI
               END-IF
           END-IF.
      *
      *    保険（公費）テーブルの患者負担上限額と当月の患者負担累計額
      *    から算定可能残額を算出する
      *
           IF  FLG-SANTEI1-ENTANI           =     "1"
               MOVE     ZERO             TO    ZAN-KOHI1-ENTANI
           ELSE
               IF  COMB-KOH1HKNNUM           =   "027"
                   IF       MAX-KIN-KOHI1-M       NOT = ZERO
                       COMPUTE  ZAN-KOHI1-ENTANI =   MAX-KIN-KOHI1-M
                                                 -   FTN-KOHI1-M-ENTANI
                   END-IF
               END-IF
           END-IF.
      *
           IF  FLG-SANTEI-SYU-ENTANI        =     "1"
               MOVE     ZERO             TO    ZAN-SYU-M-ENTANI
           ELSE
               IF       MAX-KIN-SYU-M    NOT = ZERO
                     COMPUTE  ZAN-SYU-M-ENTANI  =   MAX-KIN-SYU-M
                                                -   FTN-SYU-M-ENTANI
               END-IF
           END-IF.
      *
       2303-SYUENTANI-ZANKIN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        シス管・入院会計から食事療養費等の計算を行う            *
      ******************************************************************
       2304-SHOKUJI-KEISAN-SEC         SECTION.
      *
           INITIALIZE    WK-SHOKUJI-TAIHI-AREA
                         WK-DAY-SKJFTN-AREA
      *
           PERFORM       23045-SYS-5000-CHK-SEC
      *
           INITIALIZE                            NYUINACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      NACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      NACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      NACCT-PTID
      ***  MOVE    "00"                  TO      NACCT-SRYKA
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      NACCT-SRYYM
           MOVE    NYUINACCT-REC         TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC             =       ZERO
               MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
               MOVE    "key7"            TO      MCP-PATHNAME
               PERFORM  NYUINACCT-READ-SEC
               PERFORM  UNTIL   FLG-NYUINACCT  =     1
      *
                 IF     NACCT-SRYCDTOTAL    =    197000570
                         PERFORM     23041-SHOKUDOKASANTOU-TAIHI-SEC
                 END-IF
      *
                 IF     NACCT-ZAISKBKBN     =    "2"
                         PERFORM     23042-GAIHAKU-TAIHI-SEC
                 END-IF
      *
                 MOVE     "tbl_nyuinacct"   TO   MCP-TABLE
                 MOVE     "key7"            TO   MCP-PATHNAME
                 PERFORM   NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_nyuinacct" TO   MCP-TABLE
           MOVE    "key7"          TO   MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           INITIALIZE                            SRYACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      ACCT-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      ACCT-SRYYM
           MOVE    SRYACCT-REC           TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key45"               TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC                =       ZERO
               MOVE    "tbl_sryacct"     TO      MCP-TABLE
               MOVE    "key45"           TO      MCP-PATHNAME
               PERFORM  SRYACCT-READ-SEC
               PERFORM  UNTIL   FLG-SRYACCT     =    1
      *
                 IF     LNK-SYU-HKNCOMBINUM  =    ACCT-HKNCOMBI
                         PERFORM    23043-ROSAITOKU-TAIHI-SEC
                 END-IF
      *
                 MOVE    "tbl_sryacct"   TO      MCP-TABLE
                 MOVE    "key45"         TO      MCP-PATHNAME
                 PERFORM  SRYACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key45"               TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           IF    WK-SHOKUJIRYOYO-OCC   NOT =  ZERO
             INITIALIZE                            NYUINACCT-REC
             MOVE    LNK-SYU-HOSPNUM       TO      NACCT-HOSPNUM
             MOVE    LNK-SYU-NYUGAIKBN     TO      NACCT-NYUGAIKBN
             MOVE    LNK-SYU-PTID          TO      NACCT-PTID
      ***    MOVE    "00"                  TO      NACCT-SRYKA
             MOVE    LNK-SYU-SRYYMD(1:6)   TO      NACCT-SRYYM
             MOVE    NYUINACCT-REC         TO      MCPDATA-REC
             MOVE    "DBSELECT"            TO      MCP-FUNC
             MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
             MOVE    "key7"                TO      MCP-PATHNAME
             CALL    "ORCDBMAIN"           USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
             IF      MCP-RC             =       ZERO
                 MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
                 MOVE    "key7"            TO      MCP-PATHNAME
                 PERFORM  NYUINACCT-READ-SEC
                 PERFORM  UNTIL   FLG-NYUINACCT  =     1
      *
                   IF     NACCT-SRYCDTOTAL    =    099999913
                           PERFORM    23044-SHOKUJI-COUNT-SEC
                   END-IF
      *
                   MOVE    "tbl_nyuinacct" TO      MCP-TABLE
                   MOVE    "key7"          TO      MCP-PATHNAME
                   PERFORM  NYUINACCT-READ-SEC
                 END-PERFORM
             END-IF
             MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
             MOVE    "key7"                TO      MCP-PATHNAME
             PERFORM  DB-CLOSE-SEC
           END-IF
      *
           .
      *
       2304-SHOKUJI-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        シス管・入院会計から食事療養費等の計算を行う(200604)    *
      ******************************************************************
       2304-SHOKUJI-KEISAN200604-SEC         SECTION.
      *
           INITIALIZE    WK-SHOKUJI-TAIHI-AREA
                         WK-DAY-SKJFTN-AREA
      *
           PERFORM       23045-SYS-5000-CHK-SEC
      *
           INITIALIZE                            NYUINACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      NACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      NACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      NACCT-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      NACCT-SRYYM
           MOVE    NYUINACCT-REC         TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key29"               TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC                =       ZERO
               MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
               MOVE    "key29"           TO      MCP-PATHNAME
               PERFORM  NYUINACCT-READ-SEC
               PERFORM  UNTIL   FLG-NYUINACCT   =    1
      *
                 IF     NACCT-ZAISKBKBN     =    "4"
                         PERFORM    23041-SHOKUDOKASANTOU-TAIHI-SEC
                 END-IF
      *
                 IF     NACCT-ZAISKBKBN     =    "2"
                         PERFORM    23042-GAIHAKU-TAIHI-SEC
                 END-IF
      *
                 MOVE    "tbl_nyuinacct" TO      MCP-TABLE
                 MOVE    "key29"         TO      MCP-PATHNAME
                 PERFORM  NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key29"               TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           INITIALIZE                            SRYACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      ACCT-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      ACCT-SRYYM
           MOVE    SRYACCT-REC           TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key45"               TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC                =       ZERO
               MOVE    "tbl_sryacct"     TO      MCP-TABLE
               MOVE    "key45"           TO      MCP-PATHNAME
               PERFORM  SRYACCT-READ-SEC
               PERFORM  UNTIL   FLG-SRYACCT     =    1
      *
                 IF     LNK-SYU-HKNCOMBINUM  =    ACCT-HKNCOMBI
                         PERFORM    23043-ROSAITOKU-TAIHI-SEC
                 END-IF
      *
                 MOVE    "tbl_sryacct"   TO      MCP-TABLE
                 MOVE    "key45"         TO      MCP-PATHNAME
                 PERFORM  SRYACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key45"               TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           PERFORM  23046-SHOKUJI-FURIWAKE-SEC
      *
           IF    WK-SHOKUJIRYOYO-OCC   NOT =  ZERO
                  PERFORM     23047-SHOKUJI-COUNT200604-SEC
           END-IF
      *
           .
      *
       2304-SHOKUJI-KEISAN200604-EXT.
           EXIT.
      *
      ******************************************************************
      *        食堂加算等退避                                            *
      ******************************************************************
       23041-SHOKUDOKASANTOU-TAIHI-SEC         SECTION.
      *
           IF   LNK-SYU-SRYYMD(1:6)       >=   "200604"
              EVALUATE   NACCT-SRYCDTOTAL
                 WHEN      099999918
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                               UNTIL    IDY    >    31
                     IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUJI-ASA (IDY)
                     END-IF
                   END-PERFORM
                 WHEN      099999919
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                               UNTIL    IDY    >    31
                     IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUJI-HIRU(IDY)
                     END-IF
                   END-PERFORM
                 WHEN      099999920
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                               UNTIL    IDY    >    31
                     IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUJI-YORU(IDY)
                     END-IF
                   END-PERFORM
                 WHEN      197000570
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                               UNTIL    IDY    >    31
                     IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUDOKASAN(IDY)
                     END-IF
                   END-PERFORM
              END-EVALUATE
           ELSE
              PERFORM    VARYING   IDY   FROM   1   BY   1
                          UNTIL    IDY    >    31
                   IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUDOKASAN(IDY)
                   END-IF
              END-PERFORM
           END-IF
      *
           .
      *
       23041-SHOKUDOKASANTOU-TAIHI-EXT.
           EXIT.
      *
      ******************************************************************
      *        外泊退避                                            *
      ******************************************************************
       23042-GAIHAKU-TAIHI-SEC         SECTION.
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
             IF       NACCT-DAY(IDY)   NOT =  ZERO 
                    MOVE   NACCT-DAY(IDY)  TO   WK-GAIHAKU(IDY)
             END-IF
           END-PERFORM
      *
           .
      *
       23042-GAIHAKU-TAIHI-EXT.
           EXIT.
      *
      ******************************************************************
      *        労災入院中の特別食加算退避                              *
      ******************************************************************
       23043-ROSAITOKU-TAIHI-SEC         SECTION.
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
               IF   ACCT-SRYKBN   =   "95"
                  IF       ACCT-DAY(1 IDY)   NOT =  ZERO
                      MOVE   ACCT-DAY(1 IDY)  TO   WK-ROSAITOKU95(IDY)
                  END-IF
               END-IF
               IF   ACCT-SRYKBN   =   "96"
                  IF       ACCT-DAY(1 IDY)   NOT =  ZERO
                      MOVE   ACCT-DAY(1 IDY)  TO   WK-ROSAITOKU96(IDY)
                  END-IF
               END-IF
               IF   ACCT-SRYKBN   =   "97"
                  IF       ACCT-DAY(1 IDY)   NOT =  ZERO
                      MOVE   ACCT-DAY(1 IDY)  TO   WK-ROSAITOKU97(IDY)
                  END-IF
               END-IF
           END-PERFORM
      *
           .
      *
       23043-ROSAITOKU-TAIHI-EXT.
           EXIT.
      *
      ******************************************************************
      *        食事療養費等の計算                                       *
      ******************************************************************
       23044-SHOKUJI-COUNT-SEC         SECTION.
      *
           MOVE       LNK-SYU-SKYSTYMD(7:2)  TO   IDX-ST.
           MOVE       LNK-SYU-SKYEDYMD(7:2)  TO   IDX-ED.
      *
           PERFORM    VARYING   IDY   FROM   IDX-ST   BY   1
                                    UNTIL    IDY     >    IDX-ED
      *
             MOVE     ZERO     TO      WK-SHOKUJI-JIHI
      *
             IF       ( NACCT-DAY(IDY)   NOT =  ZERO )
             AND      ( LNK-SYU-DAY(IDY)     =  "1"  )
             AND      ( WK-GAIHAKU(IDY)      =  ZERO  OR  4 )
      *
              IF  WK-SHOKUDOKASAN(IDY)  =  ZERO
      *
                EVALUATE   NACCT-DAY(IDY)
                  WHEN  1
                      EVALUATE   WK-SHOKUJIRYOYO(IDY)
                        WHEN  1
                         IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI2-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   特別管理加算
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
                         ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI1-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI1
                          END-IF
                         END-IF
                        WHEN  2
      *
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI5-NISSU
      *                   入院時食事療養（２）
                          MOVE  "197000710"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI5
                          END-IF
                      END-EVALUATE
                  WHEN  2
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI2-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   特別管理加算
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   特別食加算
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI1-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI1
                          END-IF
      *                   特別食加算
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
                      END-IF
                  WHEN  3
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI2-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   特別管理加算
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   複数献立加算
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI1-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI1
                          END-IF
      *                   複数献立加算
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      END-IF
                  WHEN  4
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI2-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   特別管理加算
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   特別食加算
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
      *                   複数献立加算
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI1-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI1
                          END-IF
      *                   特別食加算
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
      *                   複数献立加算
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      END-IF
                END-EVALUATE
      *
              ELSE
      *
                EVALUATE   NACCT-DAY(IDY)
                  WHEN  1
                      EVALUATE   WK-SHOKUJIRYOYO(IDY)
                        WHEN  1
                         IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI4-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   特別管理加算
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   食堂加算
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
                         ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI3-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   食堂加算
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
                         END-IF
                        WHEN  2
      *
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI5-NISSU
      *                   入院時食事療養（２）
                          MOVE  "197000710"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI5
                          END-IF
                      END-EVALUATE
                  WHEN  2
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI4-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   特別管理加算
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   食堂加算
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   特別食加算
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI3-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   食堂加算
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   特別食加算
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
                      END-IF
                  WHEN  3
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI4-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   特別管理加算
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   食堂加算
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   複数献立加算
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI3-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   食堂加算
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   複数献立加算
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      END-IF
                  WHEN  4
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI4-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   特別管理加算
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   食堂加算
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   特別食加算
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
      *                   複数献立加算
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI3-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   入院時食事療養（１）
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   食堂加算
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   特別食加算
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
      *                   複数献立加算
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      END-IF
                END-EVALUATE
      *
              END-IF
      *
              IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"            )
              OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                OR  "068"  OR  "069"  OR  "040" )
                ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
              ELSE
                EVALUATE   WK-SYOTOKU-SKJKBN(1)
                  WHEN  SPACE
      *                   標準負担額（一般）
                          MOVE  "197000810"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     TNS-TEN   TO   WK-SHOKUJI-FTN
                             MOVE    TNS-TEN   TO   WK-DAY-SKJFTN(IDY)
                          END-IF
                  WHEN  "1"
                  WHEN  "4"
      *                   標準負担額（低１）
                          MOVE  "197001110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     TNS-TEN   TO   WK-SHOKUJI-FTN
                             MOVE    TNS-TEN   TO   WK-DAY-SKJFTN(IDY)
                          END-IF
                  WHEN  "2"
      *                   標準負担額（低２・９０日以下）
                          MOVE  "197000910"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     TNS-TEN   TO   WK-SHOKUJI-FTN
                             MOVE    TNS-TEN   TO   WK-DAY-SKJFTN(IDY)
                          END-IF
                  WHEN  "3"
      *                   標準負担額（低２・９０日超）
                          MOVE  "197001010"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     TNS-TEN   TO   WK-SHOKUJI-FTN
                             MOVE    TNS-TEN   TO   WK-DAY-SKJFTN(IDY)
                          END-IF
                END-EVALUATE
              END-IF
      *
             END-IF
      *
             IF       ( WK-ROSAITOKU95(IDY)  NOT =  ZERO       )
      **>    AND      ( LNK-SYU-DAY(IDY)         =  "1" OR "2" )
             AND      ( LNK-SYU-DAY(IDY)         =  "2"        )
      *
      *         標準負担額（労災入院中）
                MOVE  "197001210"    TO   WK-SRYCD
                PERFORM    TENSU-TBL-SEC
                IF       FLG-TENSU      =    ZERO
                   ADD     TNS-TEN   TO   WK-SHOKUJI-RYOYOHI95
                                          WK-SHOKUJI-FTN95
                END-IF
      *
             END-IF
      *
             IF       ( WK-ROSAITOKU96(IDY)  NOT =  ZERO       )
      **>    AND      ( LNK-SYU-DAY(IDY)         =  "1" OR "2" )
             AND      ( LNK-SYU-DAY(IDY)         =  "2"        )
      *
      *         標準負担額（労災入院中）
                MOVE  "197001210"    TO   WK-SRYCD
                PERFORM    TENSU-TBL-SEC
                IF       FLG-TENSU      =    ZERO
                   ADD     TNS-TEN   TO   WK-SHOKUJI-RYOYOHI96
                                          WK-SHOKUJI-FTN96
                END-IF
      *
             END-IF
      *
             MOVE     ZERO     TO      WK-SHOKUJI-JIHI
      *
             IF       ( WK-ROSAITOKU97(IDY)  NOT =  ZERO       )
      **>    AND      ( LNK-SYU-DAY(IDY)         =  "1" OR "2" )
             AND      ( LNK-SYU-DAY(IDY)         =  "2"        )
      *
                ADD       1    TO   WK-SHOKUJI-NISSU
                                    LNK-SYU-SHOKUJI6-NISSU
      *         標準負担額（労災入院中）
                MOVE  "197001210"    TO   WK-SRYCD
                PERFORM    TENSU-TBL-SEC
                IF       FLG-TENSU      =    ZERO
                   ADD     TNS-TEN   TO   WK-SHOKUJI-RYOYOHI
                                          WK-SHOKUJI-JIHI
                   MOVE    TNS-TEN   TO   LNK-SYU-SHOKUJI6
                END-IF
      *
                IF  COMB-SYU-HKNKOHSBTKBN   =   "8"
                  ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                END-IF
      *
             END-IF
      *
           END-PERFORM.
      *
       23044-SHOKUJI-COUNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    システム管理マスタ（５０００）の食事情報取得
      ******************************************************************
       23045-SYS-5000-CHK-SEC                 SECTION.
      *
           MOVE    SPACE                TO    WK-BRMSGK-TAXKBN
      *
           INITIALIZE                         SYS-5000-REC
           MOVE    "5000"               TO    SYS-5000-KANRICD
           MOVE    "*"                  TO    SYS-5000-KBNCD
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-5000-HOSPNUM
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYS-5000-STYUKYMD(1:6)
           MOVE    "01"                 TO    SYS-5000-STYUKYMD(7:2)
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYS-5000-EDYUKYMD(1:6)
           MOVE    "01"                 TO    SYS-5000-EDYUKYMD(7:2)
           MOVE    SYS-5000-REC         TO    MCPDATA-REC
           MOVE    "DBSELECT"           TO    MCP-FUNC
           MOVE    "tbl_syskanri"       TO    MCP-TABLE
           MOVE    "key10"              TO    MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
           IF      MCP-RC               =     ZERO
                   MOVE    "tbl_syskanri"   TO   MCP-TABLE
                   MOVE    "key10"          TO   MCP-PATHNAME
                   PERFORM  SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
      *
                     PERFORM   VARYING   IDX3   FROM  1  BY  1
                                UNTIL    IDX3    >   31
                      EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *                入院食事療養（１）
                       WHEN         "197000110"
                          MOVE     1      TO   WK-SHOKUJIRYOYO(IDX3)
                          EVALUATE  SYS-5000-SHOKUKBN(1)
                            WHEN     "1"
                              MOVE  ZERO  TO   WK-TOKUKANRIKASAN(IDX3)
                            WHEN     "2"
                              MOVE    1   TO   WK-TOKUKANRIKASAN(IDX3)
                          END-EVALUATE
      *                入院食事療養（２）
                       WHEN         "197000710"
                          MOVE     2      TO   WK-SHOKUJIRYOYO(IDX3)
                      END-EVALUATE
                     END-PERFORM
      *
                     MOVE   SYS-5000-BRMSGK-TAXKBN
                                          TO   WK-BRMSGK-TAXKBN
      *
                   END-IF
           END-IF
      *
           MOVE      "tbl_syskanri"       TO   MCP-TABLE
           MOVE      "key10"              TO   MCP-PATHNAME
           PERFORM    DB-CLOSE-SEC
      *
           INITIALIZE                         SYS-5000-REC
           MOVE    "5000"               TO    SYS-5000-KANRICD
           MOVE    "*"                  TO    SYS-5000-KBNCD
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-5000-HOSPNUM
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYS-5000-STYUKYMD(1:6)
           MOVE    "__"                 TO    SYS-5000-STYUKYMD(7:2)
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYS-5000-EDYUKYMD(1:6)
           MOVE    "__"                 TO    SYS-5000-EDYUKYMD(7:2)
           MOVE    SYS-5000-REC         TO    MCPDATA-REC
           MOVE    "DBSELECT"           TO    MCP-FUNC
           MOVE    "tbl_syskanri"       TO    MCP-TABLE
           MOVE    "key11"              TO    MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
           IF      MCP-RC               =     ZERO
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key11"         TO    MCP-PATHNAME
               PERFORM   SYSKANRI-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
                   MOVE   SYS-5000-STYUKYMD(7:2)  TO  KIRIKAE-IDX
                   PERFORM    VARYING  IDX3  FROM KIRIKAE-IDX BY 1
                              UNTIL    IDX3  >   31
                      EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *                入院食事療養（１）
                       WHEN         "197000110"
                          MOVE     1      TO   WK-SHOKUJIRYOYO(IDX3)
                          EVALUATE  SYS-5000-SHOKUKBN(1)
                            WHEN     "1"
                              MOVE  ZERO  TO   WK-TOKUKANRIKASAN(IDX3)
                            WHEN     "2"
                              MOVE    1   TO   WK-TOKUKANRIKASAN(IDX3)
                          END-EVALUATE
      *                入院食事療養（２）
                       WHEN         "197000710"
                          MOVE     2      TO   WK-SHOKUJIRYOYO(IDX3)
                          MOVE    ZERO    TO   WK-TOKUKANRIKASAN(IDX3)
                      END-EVALUATE
                   END-PERFORM
                   MOVE    "tbl_syskanri" TO   MCP-TABLE
                   MOVE    "key11"        TO   MCP-PATHNAME
                   PERFORM  SYSKANRI-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE     "tbl_syskanri"        TO   MCP-TABLE
           MOVE     "key11"               TO   MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
           .
      *
       23045-SYS-5000-CHK-EXT.
           EXIT.
      *
      ******************************************************************
      *    入院時食事療養と特別食加算をわける
      ******************************************************************
       23046-SHOKUJI-FURIWAKE-SEC                 SECTION.
      *
           IF   LNK-S02-SKYSTYMD(1:6) = LNK-SYU-SRYYMD(1:6)
             IF   LNK-S02-DOJITUFLG-ST  =  "1"
                MOVE      LNK-SYU-SKYSTYMD(7:2)  TO   IDX-ST
                EVALUATE  LNK-S02-TIMEKBN-ST
                  WHEN     "0"
                    MOVE   ZERO   TO  WK-SHOKUJI-ASA (IDX-ST)
                    MOVE   ZERO   TO  WK-SHOKUJI-HIRU(IDX-ST)
                    MOVE   ZERO   TO  WK-SHOKUJI-YORU(IDX-ST)
                    MOVE   ZERO   TO  WK-SHOKUDOKASAN(IDX-ST)
                  WHEN     "1"
                    CONTINUE
                  WHEN     "2"
                    IF   WK-SHOKUJI-ASA (IDX-ST)  NOT = ZERO
                      MOVE ZERO   TO  WK-SHOKUDOKASAN(IDX-ST)
                    END-IF
                    MOVE   ZERO   TO  WK-SHOKUJI-ASA (IDX-ST)
                  WHEN     "3"
                    IF   WK-SHOKUJI-ASA (IDX-ST)  NOT = ZERO
                    OR   WK-SHOKUJI-HIRU(IDX-ST)  NOT = ZERO
                      MOVE ZERO   TO  WK-SHOKUDOKASAN(IDX-ST)
                    END-IF
                    MOVE   ZERO   TO  WK-SHOKUJI-ASA (IDX-ST)
                    MOVE   ZERO   TO  WK-SHOKUJI-HIRU(IDX-ST)
                END-EVALUATE
                MOVE        1     TO  WK-SHOKUJI-KANFLG(IDX-ST)
                MOVE       ZERO   TO  WK-ROSAITOKU95 (IDX-ST)
                MOVE       ZERO   TO  WK-ROSAITOKU96 (IDX-ST)
                MOVE       ZERO   TO  WK-ROSAITOKU97 (IDX-ST)
             END-IF
           END-IF
           IF   LNK-S02-SKYEDYMD(1:6) = LNK-SYU-SRYYMD(1:6)
             IF   LNK-S02-DOJITUFLG-ED  =  "1"
                MOVE      LNK-SYU-SKYEDYMD(7:2)  TO   IDX-ED
                EVALUATE  LNK-S02-TIMEKBN-ED
                  WHEN     "0"
                    MOVE   ZERO   TO  WK-SHOKUJI-ASA (IDX-ED)
                    MOVE   ZERO   TO  WK-SHOKUJI-HIRU(IDX-ED)
                    MOVE   ZERO   TO  WK-SHOKUJI-YORU(IDX-ED)
                    MOVE   ZERO   TO  WK-SHOKUDOKASAN(IDX-ED)
                  WHEN     "1"
                    IF   WK-SHOKUJI-ASA (IDX-ED)   = ZERO
                      MOVE ZERO   TO  WK-SHOKUDOKASAN(IDX-ED)
                    END-IF
                    MOVE   ZERO   TO  WK-SHOKUJI-HIRU(IDX-ED)
                    MOVE   ZERO   TO  WK-SHOKUJI-YORU(IDX-ED)
                  WHEN     "2"
                    IF   WK-SHOKUJI-ASA (IDX-ED)   = ZERO
                    AND  WK-SHOKUJI-HIRU(IDX-ED)   = ZERO
                      MOVE ZERO   TO  WK-SHOKUDOKASAN(IDX-ED)
                    END-IF
                    MOVE   ZERO   TO  WK-SHOKUJI-YORU(IDX-ED)
                  WHEN     "3"
                    CONTINUE
                END-EVALUATE
             END-IF
           END-IF
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
      *
              EVALUATE   WK-SHOKUJI-ASA (IDY)
                WHEN        1
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                WHEN        2
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                                     WK-SHOKUJI-TOKUSYO(IDY)
              END-EVALUATE
              EVALUATE   WK-SHOKUJI-HIRU(IDY)
                WHEN        1
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                WHEN        2
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                                     WK-SHOKUJI-TOKUSYO(IDY)
              END-EVALUATE
              EVALUATE   WK-SHOKUJI-YORU(IDY)
                WHEN        1
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                WHEN        2
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                                     WK-SHOKUJI-TOKUSYO(IDY)
              END-EVALUATE
      *
           END-PERFORM
      *
      *    入院時生活療養費負担額取得
           IF   LNK-SYU-SRYYMD(1:6)      >=  "200610"
             INITIALIZE                      ORCSNYULIFE-AREA
             MOVE    LNK-SYU-HOSPNUM     TO  LNK-NYULIFE-HOSPNUM
             MOVE    LNK-SYU-PTID        TO  LNK-NYULIFE-PTID
             MOVE    LNK-SYU-SRYYMD(1:6) TO  LNK-NYULIFE-SANTEIYM
             CALL    "ORCSNYULIFE"       USING
                                         ORCSNYULIFE-AREA
                                         SPA-AREA
             IF      LNK-NYULIFE-RC  =   ZERO
               PERFORM  VARYING  NYULIFE-IDX  FROM  1  BY  1
                         UNTIL   NYULIFE-IDX   >   31
                 MOVE  LNK-NYULIFE-KBN(NYULIFE-IDX)
                                TO  WK-NYULIFE-KBN(NYULIFE-IDX)
                 MOVE  LNK-NYULIFE-SKJ-MONEY(NYULIFE-IDX)
                                TO  WK-NYULIFE-SKJ-MONEY(NYULIFE-IDX)
                 MOVE  LNK-NYULIFE-KAN-MONEY(NYULIFE-IDX)
                                TO  WK-NYULIFE-KAN-MONEY(NYULIFE-IDX)
                 MOVE  LNK-NYULIFE-SKJFTN-MONEY(NYULIFE-IDX)
                                TO  WK-NYULIFE-SKJFTN-MONEY(NYULIFE-IDX)
                 MOVE  LNK-NYULIFE-KANFTN-MONEY(NYULIFE-IDX)
                                TO  WK-NYULIFE-KANFTN-MONEY(NYULIFE-IDX)
               END-PERFORM
             END-IF
           END-IF
      *
           .
      *
       23046-SHOKUJI-FURIWAKE-EXT.
           EXIT.
      *
      ******************************************************************
      *        食事療養費等の計算                                      *
      ******************************************************************
       23047-SHOKUJI-COUNT200604-SEC         SECTION.
      *
      *    入院時食事療養（１）
           MOVE    "197000110"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(1)
           END-IF
      *    入院時食事療養（２）
           MOVE    "197000710"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(2)
           END-IF
      *    特別食加算
           MOVE    "197000470"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(3)
           END-IF
      *    食堂加算
           MOVE    "197000570"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(4)
           END-IF
      *    標準負担額（労災入院中）
           MOVE    "197001210"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(5)
           END-IF
      *    特別食加算（生活療養）
           MOVE    "197001570"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(6)
           END-IF
      *    食堂加算（生活療養）
           MOVE    "197001670"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(7)
           END-IF
      *    標準負担額（一般）
           MOVE    "197000810"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(1)
           END-IF
      *    標準負担額（低１）
           MOVE    "197001110"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(2)
           END-IF
      *    標準負担額（低２・９０日以下）
           MOVE    "197000910"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(3)
           END-IF
      *    標準負担額（低２・９０日超）
           MOVE    "197001010"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(4)
           END-IF
      **
           MOVE       ZERO        TO  FLG-SEIKATU
           MOVE       ZERO        TO  FLG-SEIKATUS
           MOVE       ZERO        TO  FLG-SEIKATUL
      **
           MOVE       LNK-SYU-SKYSTYMD(7:2)  TO   IDX-ST
           MOVE       LNK-SYU-SKYEDYMD(7:2)  TO   IDX-ED
      *
           PERFORM    VARYING   IDY   FROM   IDX-ST   BY   1
                       UNTIL    IDY     >    IDX-ED
      *
             MOVE     ZERO     TO      WK-SHOKUJI-JIHI
      *
             IF     WK-NYULIFE-KBN(IDY)   NOT =   SPACE
      *
      *       入院時生活療養（食事）
              IF       ( WK-SHOKUJI-NYUINJI(IDY)   NOT =  ZERO )
              AND      ((LNK-SYU-DAY(IDY)              =  "1" ) OR
                        (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ))
              AND      ( WK-GAIHAKU(IDY)        =  ZERO  OR  4 )
      *
               IF    LNK-SYU-SYUHKNNUM   =   "971" OR "973"
                 EVALUATE  LNK-SYU-SYUHKNNUM
                  WHEN       "971"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   WK-NYULIFE-SKJ-MONEY(IDY)
                                           *   1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      MOVE      WK-KEISAN  TO  WK-NYULIFE-SKJ-MONEY(IDY)
                    END-IF
                  WHEN       "973"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   WK-NYULIFE-SKJ-MONEY(IDY)
                                           *   1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      IF   WK-4001-SKJKBN  =   "2"
                       COMPUTE  WK-KEISAN  =   WK-KEISAN  *  1.2
                      END-IF
                      MOVE    WK-KEISAN    TO  WK-NYULIFE-SKJ-MONEY(IDY)
                    END-IF
                 END-EVALUATE
               END-IF
      *
               EVALUATE   WK-SHOKUJIRYOYO(IDY)
      *
                WHEN        1
      *
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUL
                  COMPUTE WK-KEISAN-XX     =  WK-NYULIFE-SKJ-MONEY(IDY)
                                           *  WK-SHOKUJI-NYUINJI(IDY)
                  ADD     WK-KEISAN-XX     TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIL
                                              WK-SHOKUJI-JIHI
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO LNK-SYU-SHOKUJI5-NISSU
                  MOVE    WK-NYULIFE-SKJ-MONEY(IDY)
                                           TO LNK-SYU-SHOKUJI5
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    IF    WK-TAX1001-KBN  =  "1"
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-NYULIFE-SKJ-MONEY(IDY) * 0.05) + 0.5
                    ELSE
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-NYULIFE-SKJ-MONEY(IDY) * 0.05)
                    END-IF
                    COMPUTE   WK-SKJ-ZEIKEI2L  =
                              WK-SKJ-ZEIKEI2L  +
                             (WK-SKJ-ZEI   *  WK-SHOKUJI-NYUINJI(IDY))
                  END-IF
      *
                  IF   WK-SHOKUJI-TOKUSYO(IDY)  NOT = ZERO
                      COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(6)
                                           *  WK-SHOKUJI-TOKUSYO(IDY)
                      ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIL
                                              WK-SHOKUJI-JIHI
                      ADD     WK-SHOKUJI-TOKUSYO(IDY)
                                           TO LNK-SYU-SHOKUJI7-NISSU
                      MOVE    WK-SHOKUJI-KINGAKU(6)
                                           TO LNK-SYU-SHOKUJI7
                      IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                        IF    WK-TAX1001-KBN  =  "1"
                          COMPUTE WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(6) * 0.05) + 0.5
                        ELSE
                          COMPUTE WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(6) * 0.05)
                        END-IF
                        COMPUTE   WK-SKJ-ZEIKEI2L  =
                                  WK-SKJ-ZEIKEI2L  +
                                 (WK-SKJ-ZEI * WK-SHOKUJI-TOKUSYO(IDY))
                      END-IF
                  END-IF
      *
                  IF   WK-SHOKUDOKASAN(IDY)     NOT =  ZERO
                      COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(7)
                      ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIL
                                              WK-SHOKUJI-JIHI
                      ADD     1            TO LNK-SYU-SHOKUJI8-NISSU
                      MOVE    WK-SHOKUJI-KINGAKU(7)
                                           TO LNK-SYU-SHOKUJI8
                      IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                        IF    WK-TAX1001-KBN  =  "1"
                          COMPUTE WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(7) * 0.05) + 0.5
                        ELSE
                          COMPUTE WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(7) * 0.05)
                        END-IF
                        COMPUTE   WK-SKJ-ZEIKEI2L  =
                                  WK-SKJ-ZEIKEI2L  +
                                  WK-SKJ-ZEI
                      END-IF
                  END-IF
      *
                WHEN        2
      *
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUL
                  COMPUTE WK-KEISAN-XX     =  WK-NYULIFE-SKJ-MONEY(IDY)
                                           *  WK-SHOKUJI-NYUINJI(IDY)
                  ADD     WK-KEISAN-XX     TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIL
                                              WK-SHOKUJI-JIHI
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO LNK-SYU-SHOKUJI6-NISSU
                  MOVE    WK-NYULIFE-SKJ-MONEY(IDY)
                                           TO LNK-SYU-SHOKUJI6
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    IF    WK-TAX1001-KBN  =  "1"
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-NYULIFE-SKJ-MONEY(IDY) * 0.05) + 0.5
                    ELSE
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-NYULIFE-SKJ-MONEY(IDY) * 0.05)
                    END-IF
                    COMPUTE   WK-SKJ-ZEIKEI2L  =
                              WK-SKJ-ZEIKEI2L  +
                             (WK-SKJ-ZEI   *  WK-SHOKUJI-NYUINJI(IDY))
                  END-IF
      *
               END-EVALUATE
      *
               IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"            )
               OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                 OR  "068"  OR  "069"  OR  "040" )
                 ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                                               WK-SHOKUJI-FTNL
               ELSE
                 COMPUTE WK-KEISAN-XX =  WK-NYULIFE-SKJFTN-MONEY(IDY)
                                      *  WK-SHOKUJI-NYUINJI(IDY)
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                         WK-SHOKUJI-FTNL
                 ADD     WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                         WK-DAY-SKJFTNL(IDY)
                 MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                      TO WK-DAY-KAISU(IDY)
                                         WK-DAY-KAISUL(IDY)
               END-IF
               IF    FLG-SEIKATU   =  ZERO
                   MOVE     2     TO      FLG-SEIKATU
               END-IF
               MOVE         1     TO      FLG-SEIKATUL
      *
              END-IF
      *
      *       入院時生活療養（環境）
              MOVE     ZERO     TO      WK-SHOKUJI-JIHI
              IF       ((LNK-SYU-DAY(IDY)              =  "1" ) OR
                        (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ))
              AND      ( WK-GAIHAKU(IDY)        =  ZERO  OR  4 )
              AND      ( WK-SHOKUJI-KANFLG(IDY) =  ZERO        )
      *
                IF    LNK-SYU-SYUHKNNUM   =   "971" OR "973"
                 EVALUATE  LNK-SYU-SYUHKNNUM
                  WHEN       "971"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   WK-NYULIFE-KAN-MONEY(IDY)
                                           *   1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      MOVE      WK-KEISAN  TO  WK-NYULIFE-KAN-MONEY(IDY)
                    END-IF
                  WHEN       "973"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   WK-NYULIFE-KAN-MONEY(IDY)
                                           *   1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      IF   WK-4001-SKJKBN  =   "2"
                       COMPUTE  WK-KEISAN  =   WK-KEISAN  *  1.2
                      END-IF
                      MOVE    WK-KEISAN    TO  WK-NYULIFE-KAN-MONEY(IDY)
                    END-IF
                 END-EVALUATE
                END-IF
      *
                EVALUATE   WK-SHOKUJIRYOYO(IDY)
      *
                 WHEN        1
      *
                  COMPUTE WK-KEISAN-XX  =   WK-NYULIFE-KAN-MONEY(IDY)
                  ADD     WK-KEISAN-XX  TO  WK-SHOKUJI-RYOYOHI
                                            WK-SHOKUJI-RYOYOHIL
                                            WK-SHOKUJI-JIHI
                  ADD     1             TO  LNK-SYU-SHOKUJI9-NISSU
                  MOVE    WK-NYULIFE-KAN-MONEY(IDY)
                                        TO  LNK-SYU-SHOKUJI9
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    IF    WK-TAX1001-KBN  =  "1"
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-NYULIFE-KAN-MONEY(IDY) * 0.05) + 0.5
                    ELSE
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-NYULIFE-KAN-MONEY(IDY) * 0.05)
                    END-IF
                    COMPUTE   WK-SKJ-ZEIKEI2L  =
                              WK-SKJ-ZEIKEI2L  +
                              WK-SKJ-ZEI
                  END-IF
      *
                 WHEN        2
      *
                  COMPUTE WK-KEISAN-XX  =   WK-NYULIFE-KAN-MONEY(IDY)
                  ADD     WK-KEISAN-XX  TO  WK-SHOKUJI-RYOYOHI
                                            WK-SHOKUJI-RYOYOHIL
                                            WK-SHOKUJI-JIHI
                  ADD     1             TO  LNK-SYU-SHOKUJI10-NISSU
                  MOVE    WK-NYULIFE-KAN-MONEY(IDY)
                                        TO  LNK-SYU-SHOKUJI10
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    IF    WK-TAX1001-KBN  =  "1"
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-NYULIFE-KAN-MONEY(IDY) * 0.05) + 0.5
                    ELSE
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-NYULIFE-KAN-MONEY(IDY) * 0.05)
                    END-IF
                    COMPUTE   WK-SKJ-ZEIKEI2L  =
                              WK-SKJ-ZEIKEI2L  +
                              WK-SKJ-ZEI
                  END-IF
      *
                END-EVALUATE
      *
                IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"            )
                OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                  OR  "068"  OR  "069"  OR  "040" )
                  ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                                                WK-SHOKUJI-FTNL
                ELSE
                  COMPUTE WK-KEISAN-XX =  WK-NYULIFE-KANFTN-MONEY(IDY)
                  ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                          WK-SHOKUJI-FTNL
                  ADD     WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                          WK-DAY-SKJFTNL(IDY)
                END-IF
                IF   FLG-SEIKATU   =  ZERO
                   MOVE     2     TO      FLG-SEIKATU
                END-IF
                MOVE        1     TO      FLG-SEIKATUL
      *
              END-IF
      *
             ELSE
      *
              IF       ( WK-SHOKUJI-NYUINJI(IDY)   NOT =  ZERO )
              AND      ((LNK-SYU-DAY(IDY)              =  "1" ) OR
                        (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ))
              AND      ( WK-GAIHAKU(IDY)        =  ZERO  OR  4 )
      *
               EVALUATE   WK-SHOKUJIRYOYO(IDY)
      *
                WHEN        1
      *
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUS
                  COMPUTE WK-KEISAN-XX     =  WK-SHOKUJI-KINGAKU(1)
                                           *  WK-SHOKUJI-NYUINJI(IDY)
                  ADD     WK-KEISAN-XX     TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIS
                                              WK-SHOKUJI-JIHI
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO LNK-SYU-SHOKUJI1-NISSU
                  MOVE    WK-SHOKUJI-KINGAKU(1)
                                           TO LNK-SYU-SHOKUJI1
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    IF    WK-TAX1001-KBN  =  "1"
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-SHOKUJI-KINGAKU(1) * 0.05) + 0.5
                    ELSE
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-SHOKUJI-KINGAKU(1) * 0.05)
                    END-IF
                    COMPUTE   WK-SKJ-ZEIKEI2  =
                              WK-SKJ-ZEIKEI2  +
                             (WK-SKJ-ZEI   *  WK-SHOKUJI-NYUINJI(IDY))
                  END-IF
      *
                  IF   WK-SHOKUJI-TOKUSYO(IDY)  NOT = ZERO
                      COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(3)
                                           *  WK-SHOKUJI-TOKUSYO(IDY)
                      ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIS
                                              WK-SHOKUJI-JIHI
                      ADD     WK-SHOKUJI-TOKUSYO(IDY)
                                           TO LNK-SYU-SHOKUJI3-NISSU
                      MOVE    WK-SHOKUJI-KINGAKU(3)
                                           TO LNK-SYU-SHOKUJI3
                      IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                        IF    WK-TAX1001-KBN  =  "1"
                          COMPUTE WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(3) * 0.05) + 0.5
                        ELSE
                          COMPUTE WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(3) * 0.05)
                        END-IF
                        COMPUTE   WK-SKJ-ZEIKEI2  =
                                  WK-SKJ-ZEIKEI2  +
                                 (WK-SKJ-ZEI * WK-SHOKUJI-TOKUSYO(IDY))
                      END-IF
                  END-IF
      *
                  IF   WK-SHOKUDOKASAN(IDY)     NOT =  ZERO
                      COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(4)
                      ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIS
                                              WK-SHOKUJI-JIHI
                      ADD     1            TO LNK-SYU-SHOKUJI4-NISSU
                      MOVE    WK-SHOKUJI-KINGAKU(4)
                                           TO LNK-SYU-SHOKUJI4
                      IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                        IF    WK-TAX1001-KBN  =  "1"
                          COMPUTE WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(4) * 0.05) + 0.5
                        ELSE
                          COMPUTE WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(4) * 0.05)
                        END-IF
                        COMPUTE   WK-SKJ-ZEIKEI2  =
                                  WK-SKJ-ZEIKEI2  +
                                  WK-SKJ-ZEI
                      END-IF
                  END-IF
      *
                WHEN        2
      *
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUS
                  COMPUTE WK-KEISAN-XX     =  WK-SHOKUJI-KINGAKU(2)
                                           *  WK-SHOKUJI-NYUINJI(IDY)
                  ADD     WK-KEISAN-XX     TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIS
                                              WK-SHOKUJI-JIHI
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO LNK-SYU-SHOKUJI2-NISSU
                  MOVE    WK-SHOKUJI-KINGAKU(2)
                                           TO LNK-SYU-SHOKUJI2
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    IF    WK-TAX1001-KBN  =  "1"
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-SHOKUJI-KINGAKU(2) * 0.05) + 0.5
                    ELSE
                      COMPUTE WK-SKJ-ZEI   =
                             (WK-SHOKUJI-KINGAKU(2) * 0.05)
                    END-IF
                    COMPUTE   WK-SKJ-ZEIKEI2  =
                              WK-SKJ-ZEIKEI2  +
                             (WK-SKJ-ZEI   *  WK-SHOKUJI-NYUINJI(IDY))
                  END-IF
      *
               END-EVALUATE
      *
               IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"            )
               OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                 OR  "068"  OR  "069"  OR  "040" )
                ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                                              WK-SHOKUJI-FTNS
               ELSE
                EVALUATE   WK-SYOTOKU-SKJKBN(IDY)
                  WHEN       SPACE
      *              標準負担額（一般）
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(1)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
                     ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                             WK-SHOKUJI-FTNS
                     MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                             WK-DAY-SKJFTNS(IDY)
                     MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                          TO WK-DAY-KAISU(IDY)
                                             WK-DAY-KAISUS(IDY)
                  WHEN       "1"
                  WHEN       "4"
      *              標準負担額（低１）
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(2)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
                     ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                             WK-SHOKUJI-FTNS
                     MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                             WK-DAY-SKJFTNS(IDY)
                     MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                          TO WK-DAY-KAISU(IDY)
                                             WK-DAY-KAISUS(IDY)
                  WHEN       "2"
      *              標準負担額（低２・９０日以下）
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(3)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
                     ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                             WK-SHOKUJI-FTNS
                     MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                             WK-DAY-SKJFTNS(IDY)
                     MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                          TO WK-DAY-KAISU(IDY)
                                             WK-DAY-KAISUS(IDY)
                  WHEN       "3"
      *              標準負担額（低２・９０日超）
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(4)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
                     ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                             WK-SHOKUJI-FTNS
                     MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                             WK-DAY-SKJFTNS(IDY)
                     MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                          TO WK-DAY-KAISU(IDY)
                                             WK-DAY-KAISUS(IDY)
                END-EVALUATE
               END-IF
               IF    FLG-SEIKATU   =  ZERO
                   MOVE     1     TO      FLG-SEIKATU
               END-IF
               MOVE         1     TO      FLG-SEIKATUS
      *
              END-IF
      *
             END-IF
      *
             IF     WK-NYULIFE-KBN(IDY)   NOT =   SPACE
               IF       ( WK-ROSAITOKU95(IDY)  NOT =  ZERO       )
               AND      ( LNK-SYU-DAY(IDY)         =  "2"        )
      *          標準負担額（労災入院中）
                 COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(5)
                                      *  WK-ROSAITOKU95(IDY)
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI95L
                                         WK-SHOKUJI-FTN95L
               END-IF
               IF       ( WK-ROSAITOKU96(IDY)  NOT =  ZERO       )
               AND      ( LNK-SYU-DAY(IDY)         =  "2"        )
      *          標準負担額（労災入院中）
                 IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                   IF    WK-TAX1001-KBN  =  "1"
                     COMPUTE WK-SKJ-ZEI   =
                            (WK-SHOKUJI-KINGAKU(5) * 0.05) + 0.5
                   ELSE
                     COMPUTE WK-SKJ-ZEI   =
                            (WK-SHOKUJI-KINGAKU(5) * 0.05)
                   END-IF
                   COMPUTE   WK-SKJ-ZEIKEIL  =
                             WK-SKJ-ZEIKEIL  +
                            (WK-SKJ-ZEI   *  WK-ROSAITOKU96(IDY))
                 END-IF
                 COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(5)
                                      *  WK-ROSAITOKU96(IDY)
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI96L
                                         WK-SHOKUJI-FTN96L
               END-IF
               MOVE     ZERO     TO      WK-SHOKUJI-JIHI
               IF       ( WK-ROSAITOKU97(IDY)  NOT =  ZERO       )
               AND      ( LNK-SYU-DAY(IDY)         =  "2"        )
      *           標準負担額（労災入院中）
                  ADD     WK-ROSAITOKU97(IDY)
                                            TO  WK-SHOKUJI-NISSU
                                                WK-SHOKUJI-NISSUL
                  COMPUTE WK-KEISAN-XX  =  WK-SHOKUJI-KINGAKU(5)
                                        *  WK-ROSAITOKU97(IDY)
                  ADD     WK-KEISAN-XX      TO  WK-SHOKUJI-RYOYOHI
                                                WK-SHOKUJI-RYOYOHIL
                                                WK-SHOKUJI-JIHI
                  ADD     WK-ROSAITOKU97(IDY)
                                            TO  LNK-SYU-SHOKUJI7-NISSU
                  MOVE    WK-SHOKUJI-KINGAKU(5)
                                            TO  LNK-SYU-SHOKUJI7
                  IF   COMB-SYU-HKNKOHSBTKBN   =   "8"
                    ADD   WK-SHOKUJI-JIHI   TO  WK-SHOKUJI-FTN
                                                WK-SHOKUJI-FTNL
                  END-IF
                  IF    FLG-SEIKATU   =  ZERO
                        MOVE    2     TO    FLG-SEIKATU
                  END-IF
                  MOVE          1     TO    FLG-SEIKATUL
               END-IF
             ELSE
               IF       ( WK-ROSAITOKU95(IDY)  NOT =  ZERO       )
               AND      ( LNK-SYU-DAY(IDY)         =  "2"        )
      *          標準負担額（労災入院中）
                 COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(5)
                                      *  WK-ROSAITOKU95(IDY)
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI95
                                         WK-SHOKUJI-FTN95
               END-IF
               IF       ( WK-ROSAITOKU96(IDY)  NOT =  ZERO       )
               AND      ( LNK-SYU-DAY(IDY)         =  "2"        )
      *          標準負担額（労災入院中）
                 IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                   IF    WK-TAX1001-KBN  =  "1"
                     COMPUTE WK-SKJ-ZEI   =
                            (WK-SHOKUJI-KINGAKU(5) * 0.05) + 0.5
                   ELSE
                     COMPUTE WK-SKJ-ZEI   =
                            (WK-SHOKUJI-KINGAKU(5) * 0.05)
                   END-IF
                   COMPUTE   WK-SKJ-ZEIKEI   =
                             WK-SKJ-ZEIKEI   +
                            (WK-SKJ-ZEI   *  WK-ROSAITOKU96(IDY))
                 END-IF
                 COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(5)
                                      *  WK-ROSAITOKU96(IDY)
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI96
                                         WK-SHOKUJI-FTN96
               END-IF
               MOVE     ZERO     TO      WK-SHOKUJI-JIHI
               IF       ( WK-ROSAITOKU97(IDY)  NOT =  ZERO       )
               AND      ( LNK-SYU-DAY(IDY)         =  "2"        )
      *           標準負担額（労災入院中）
                  ADD     WK-ROSAITOKU97(IDY)
                                            TO  WK-SHOKUJI-NISSU
                                                WK-SHOKUJI-NISSUS
                  COMPUTE WK-KEISAN-XX  =  WK-SHOKUJI-KINGAKU(5)
                                        *  WK-ROSAITOKU97(IDY)
                  ADD     WK-KEISAN-XX      TO  WK-SHOKUJI-RYOYOHI
                                                WK-SHOKUJI-RYOYOHIS
                                                WK-SHOKUJI-JIHI
                  ADD     WK-ROSAITOKU97(IDY)
                                            TO  LNK-SYU-SHOKUJI3-NISSU
                  MOVE    WK-SHOKUJI-KINGAKU(5)
                                            TO  LNK-SYU-SHOKUJI3
                  IF   COMB-SYU-HKNKOHSBTKBN   =   "8"
                    ADD   WK-SHOKUJI-JIHI   TO  WK-SHOKUJI-FTN
                                                WK-SHOKUJI-FTNS
                  END-IF
                  IF    FLG-SEIKATU   =  ZERO
                        MOVE    1     TO    FLG-SEIKATU
                  END-IF
                  MOVE          1     TO    FLG-SEIKATUS
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
      *
       23047-SHOKUJI-COUNT200604-EXT.
           EXIT.
      *
      ******************************************************************
      *        主保険の患者負担金額計算                                *
      ******************************************************************
       2305-SYUHOKEN-KEISAN-SEC           SECTION.
      *
      *    該当保険番号テーブルの検索
           INITIALIZE                      HKNNUM-REC.
           MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM.
           MOVE   COMB-HKNNUM        TO    HKN-HKNNUM.
           MOVE   "00"               TO    WK-PAYKBN.
           MOVE   HKNNUM-REC         TO    MCPDATA-REC.
           MOVE   "DBSELECT"         TO    MCP-FUNC.
           MOVE   "tbl_hknnum"       TO    MCP-TABLE.
           MOVE   "key2"             TO    MCP-PATHNAME.
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA.
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  HKNNUM-READ-SEC
               PERFORM  UNTIL
                 (FLG-HKNNUM     =    1)                       OR
                ((HKN-TEKSTYMD(1:6)     <=  LNK-SYU-SRYYMD(1:6)  ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=  HKN-TEKEDYMD(1:6))     AND
                 (WK-PAYKBN            =  HKN-PAYKBN))
                   MOVE     "tbl_hknnum"  TO    MCP-TABLE
                   MOVE     "key2"        TO    MCP-PATHNAME
                   PERFORM   HKNNUM-READ-SEC
               END-PERFORM
           END-IF.
      *
           MOVE     "tbl_hknnum"     TO    MCP-TABLE.
           MOVE     "key2"           TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    保険組合せテーブルの補助区分から患者の負担割合を保険番号
      *    テーブルに再セット（国保のみ）
           IF    COMB-HKNNUM           =    "060" OR "039"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "0"
                   WHEN   "4"
                          MOVE   ZERO      TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "1"
                   WHEN   "5"
                          MOVE   10        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "2"
                   WHEN   "6"
                          MOVE   20        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "3"
                          MOVE   30        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
               END-EVALUATE
      *    健保の高齢者についても補助区分より負担割合セット
           ELSE
               EVALUATE   COMB-HOJOKBN
                   WHEN   "9"
                          MOVE   10        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "8"
                          MOVE   20        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "7"
                          MOVE   30        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
               END-EVALUATE
           END-IF.
      *
      *    岡山県西粟倉村退職者国保（前期高齢者を除く）
           IF  (FLG-TOKUREI-HKNJYA    =     1  )
           AND (COMB-HOJOKBN          =   SPACE)
                 MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                     HKN-KZK-NYUKFTNRATE
                                     HKN-TSY-NYUKFTNRATE
                                     HKN-TNK-NYUKFTNRATE
           END-IF.
      *
      *    年齢３歳未満
           IF      LNK-SYU-SRYYMD       >=      "20021001"
           AND     LNK-SYU-SRYYMD       <=      "20080331"
             INITIALIZE                           PTINF-REC
             MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM
             MOVE    LNK-SYU-PTID         TO      PTINF-PTID
             MOVE    PTINF-REC            TO      MCPDATA-REC
             MOVE    "DBSELECT"           TO      MCP-FUNC
             MOVE    "tbl_ptinf"          TO      MCP-TABLE
             MOVE    "key"                TO      MCP-PATHNAME
             CALL    "ORCDBMAIN"          USING   MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptinf"      TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM  PTINF-READ-SEC
               IF       MCP-RC          =       ZERO
                    MOVE   PTINF-BIRTHDAY   TO  WRK-YMDS1
                    MOVE   LNK-SYU-SRYYMD   TO  WRK-YMDS2
                    MOVE   ZERO             TO  WRK-NENREI
                    COMPUTE  WRK-NENREI     =   WRK-YYS2
                                            -   WRK-YYS1
                    IF   WRK-YMDS1(5:4)     >   WRK-YMDS2(5:4)
                         ADD   -1           TO  WRK-NENREI
                    END-IF
                    IF   WRK-NENREI         =   3
                    AND  WRK-YMDS1(5:4)    <=   WRK-YMDS2(5:4)
                        IF    WRK-YMDS1(5:2)  = WRK-YMDS2(5:2)
                             IF   WRK-YMDS1(7:2)  NOT = "01"
                                   ADD   -1     TO  WRK-NENREI
                              END-IF
                        END-IF
                    END-IF
               ELSE
                    DISPLAY  "PTINF FETCH ERR"
                    MOVE     ZERO   TO      WRK-NENREI
               END-IF
             ELSE
               DISPLAY   "PTINF SELECT ERR"
               MOVE     ZERO   TO      WRK-NENREI
             END-IF
      *
             MOVE    "tbl_ptinf"          TO       MCP-TABLE
             MOVE    "key"                TO       MCP-PATHNAME
             PERFORM  DB-CLOSE-SEC
      *
             IF      WRK-NENREI         <     3
               IF   COMB-HKNNUM       =     "060"
                   IF   COMB-HOJOKBN  =     "0"  OR  "1"
                                       OR   "4"  OR  "5"
                       CONTINUE
                   ELSE
                       MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                           HKN-KZK-NYUKFTNRATE
                                           HKN-TSY-NYUKFTNRATE
                                           HKN-TNK-NYUKFTNRATE
                   END-IF
               ELSE
                   IF    HKN-HKNKOHSBTKBN  =  "1" 
                       MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                           HKN-KZK-NYUKFTNRATE
                                           HKN-TSY-NYUKFTNRATE
                                           HKN-TNK-NYUKFTNRATE
                   END-IF 
               END-IF
             END-IF
           END-IF.
      *
      *    義務教育就学前
           IF      LNK-SYU-SRYYMD       >=      "20080401"
             IF        FLG-SYUGAKUMAE    =       1
                   IF   COMB-HKNNUM       =     "060"
                       IF   COMB-HOJOKBN  =     "0"  OR  "1"
                                           OR   "4"  OR  "5"
                           CONTINUE
                       ELSE
                           MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                               HKN-KZK-NYUKFTNRATE
                                               HKN-TSY-NYUKFTNRATE
                                               HKN-TNK-NYUKFTNRATE
                       END-IF
                   ELSE
                       IF    HKN-HKNKOHSBTKBN  =  "1" 
                           MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                               HKN-KZK-NYUKFTNRATE
                                               HKN-TSY-NYUKFTNRATE
                                               HKN-TNK-NYUKFTNRATE
                       END-IF
                   END-IF
             END-IF
           END-IF.
      *
      *    保険組合せテーブルの補助区分から患者の負担割合を保険番号
      *    テーブルに再セット（船員保険時）
           IF    COMB-HKNNUM           =    "002"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "1"
                   WHEN   "2"
                   WHEN   "3"
                   WHEN   "A"
                   WHEN   "B"
                   WHEN   "C"
                   WHEN   "D"
                   WHEN   "E"
                   WHEN   "F"
                   WHEN   "G"
                   WHEN   "H"
                   WHEN   "I"
                       IF   LNK-S02-SENINFLG  NOT =    "1"
                          MOVE   ZERO      TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                       END-IF
      *
                       MOVE      "0"       TO   HKN-HON-NYUSKJRYYKBN
                                                HKN-KZK-NYUSKJRYYKBN
                                                HKN-TSY-NYUSKJRYYKBN
                                                HKN-TNK-NYUSKJRYYKBN
               END-EVALUATE
           END-IF.
      *    保険組合せテーブルの補助区分から患者の負担割合を保険番号
      *    テーブルに再セット（共済組合保険時）
           IF    COMB-HKNNUM    =    "031" OR "032" OR "033" OR "034"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "2"
                   WHEN   "B"
                   WHEN   "E"
                   WHEN   "H"
                          MOVE   ZERO      TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
      *
                          MOVE   "0"       TO   HKN-HON-NYUSKJRYYKBN
                                                HKN-KZK-NYUSKJRYYKBN
                                                HKN-TSY-NYUSKJRYYKBN
                                                HKN-TNK-NYUSKJRYYKBN
               END-EVALUATE
           END-IF.
      *
      *    特別療養費
           IF    COMB-HKNNUM    =    "068" OR "069" OR "040"
                          MOVE   100       TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                          MOVE   "1"       TO   HKN-HON-NYUSKJRYYKBN
                                                HKN-KZK-NYUSKJRYYKBN
                                                HKN-TSY-NYUSKJRYYKBN
                                                HKN-TNK-NYUSKJRYYKBN
           END-IF.
      *
      *    患者負担金算出前の１００％負担額算出
           IF    (WK-HKNKBN         =   "1" OR "2")
           OR    (COMB-HKNNUM(1:1)  =   "0"       )
                 MOVE    10    TO      HKN-TENTNK
           ELSE
             IF   HKN-TENTNK   =   ZERO
                 MOVE    10    TO      HKN-TENTNK
             END-IF
           END-IF.
           MOVE      ZERO      TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX9    FROM    1   BY  1
                     UNTIL     IDX9       >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                            (LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK)
           END-PERFORM.
      *
           IF    COMB-SYU-HKNKOHSBTKBN       =   "8"
           AND   HKN-TENTNK              NOT =   10
               IF   HKN-HON-NYUKFTNRATE     NOT =   ZERO
                   MOVE     100       TO   HKN-HON-NYUKFTNRATE
               END-IF
               IF   HKN-KZK-NYUKFTNRATE     NOT =   ZERO
                   MOVE     100       TO   HKN-KZK-NYUKFTNRATE
               END-IF
           END-IF.
      *
      *    （ＷＫ−ＨＫＮＫＢＮ　空白：医保　１：労災・自賠）
           EVALUATE   WK-HKNKBN
             WHEN   SPACE
               IF   COMB-HONKZKKBN        =   "1"
                        IF    HKN-HON-NYUKFTNRATE     NOT =    ZERO
                              MOVE   HKN-HON-NYUKFTNRATE
                                           TO   WK-DAY-NYUKFTNRATE
                                                WK-KOH-FTNRATE
                              COMPUTE   WK-FUTANWARI  =
                                        HKN-HON-NYUKFTNRATE  /  100
                              COMPUTE   LNK-SYU-SYUCOMPFTN  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   LNK-SYU-SYUCOMPFTN-ENTANI  =    
                                        WK-ZENGAKU   *  WK-FUTANWARI    
                              IF   LNK-S02-SENINFLG    =  "1"           
                                IF LNK-SYU-SYUCOMPFTN  >  200           
                                   MOVE   200  TO  LNK-SYU-SYUCOMPFTN   
                                            LNK-SYU-SYUCOMPFTN-ENTANI   
                                END-IF                                  
                              END-IF                                    
                              IF  (COMB-SYU-HKNKOHSBTKBN     = "8" )
                              AND (WK-1001-JIHIPOSITION  NOT = "2" )
                              AND (COMB-HOJOKBN              = "1" )
                              AND (LNK-SYU-SRYYMD(1:6)  >= "200704")
                                 COMPUTE  LNK-SYU-SYUCOMPFTN =
                                          LNK-SYU-SYUCOMPFTN +
                                          WK-SKYMONEY-ZEI
                                 COMPUTE  LNK-SYU-SYUCOMPFTN-ENTANI =
                                          LNK-SYU-SYUCOMPFTN-ENTANI +
                                          WK-SKYMONEY-ZEI
                              END-IF
      *                       減額
                              EVALUATE  WK-GENGAKUKBN
                                WHEN        1
                                  IF  WK-GENGAKU-RITU = 100
                                   MOVE  ZERO  TO  WK-GENGAKU-GAK
                                   MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                                  ELSE
                                   COMPUTE  WK-GENGAKU-RITUX =
                                            100 - WK-GENGAKU-RITU
                                   COMPUTE  WK-GENGAKU-GAK      =
                                            LNK-SYU-SYUCOMPFTN  *
                                            WK-GENGAKU-RITUX    /
                                            100
                                   COMPUTE  WK-GENGAKU-GAK-ENTANI     =
                                            LNK-SYU-SYUCOMPFTN-ENTANI *
                                            WK-GENGAKU-RITUX          /
                                            100
                                  END-IF
                                WHEN        2
                                  CONTINUE
                                WHEN        3
                                WHEN        4
                                  MOVE  ZERO  TO  WK-GENGAKU-GAK
                                  MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                              END-EVALUATE
                              IF  WK-GENGAKUKBN  NOT =  ZERO
                                  MOVE  WK-GENGAKU-GAK
                                          TO  LNK-SYU-SYUCOMPFTN
                                  MOVE  WK-GENGAKU-GAK-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN2
                              IF   COMB-SYU-HKNKOHSBTKBN  =  "8"
                              AND  WK-1001-JIHIPOSITION   =  "3"
                              AND  LNK-SYU-SRYYMD(1:6)   >=  "200604"
                                 CONTINUE
                              ELSE
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           LNK-SYU-SYUCOMPFTN  +  5
                                 COMPUTE   WK-FTN      =
                                           LNK-SYU-SYUCOMPFTN  /  10
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           WK-FTN   *  10
                              END-IF
                        END-IF
      *
                        IF    FLG-GENBUTU70          NOT =  ZERO
      ***                   IF  LNK-SYU-SYUCOMPFTN   >=  21000
                            IF  WK-TOKUTEI-COMPFTN2  >=  21000
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (COMB-KOH1HKNNUM        =  SPACE)
                            AND (COMB-KOH2HKNNUM        =  SPACE)
                            AND (COMB-KOH3HKNNUM        =  SPACE)
                            AND (COMB-KOH4HKNNUM        =  SPACE)
                            AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                            AND (WK-GENBUTU-HKNKIN  NOT =  ZERO )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  21000
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                        END-IF
                        IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
                        OR   (FLG-KOHININBARAI           =    1 )
                        OR   (FLG-GENBUTU70          NOT =  ZERO)
                         IF  (FLG-GENBUTU70      NOT =  ZERO )
                         AND (COMB-KOH1HKNNUM        =  SPACE)
                         AND (COMB-KOH2HKNNUM        =  SPACE)
                         AND (COMB-KOH3HKNNUM        =  SPACE)
                         AND (COMB-KOH4HKNNUM        =  SPACE)
                         AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                            MOVE WK-TOKUTEI-COMPFTN2
                                                 TO  WK-TOKUTEI-COMPFTN
                            IF    FLG-KOUGAKUCYO-GEN70 =    1
                               MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                            END-IF
                         ELSE
                            IF  ZAN-SYU-M     <=    WK-TOKUTEI-COMPFTN2 
                                MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
                                                     WK-TOKUTEI-COMPFTN 
                            ELSE                                        
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                                IF    FLG-KOUGAKUCYO    =    1
                                   MOVE    ZERO    TO   FLG-KOUGAKUCYO
                                END-IF
                                IF    FLG-KOUGAKUCYO3   =    1
                                   MOVE    ZERO    TO   FLG-KOUGAKUCYO3
                                END-IF
                                IF    FLG-KOUGAKUCYO-ININ  =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-ININ
                                END-IF
                                IF    FLG-KOUGAKUCYO-GEN70 =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                                END-IF
                            END-IF
                            IF  ZAN-SYU-M-ENTANI                        
                                              <     WK-TOKUTEI-COMPFTN2
                                MOVE  ZAN-SYU-M-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                            END-IF                                      
                         END-IF
                        ELSE
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                        END-IF
                        COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                                  LNK-SYU-SYUCOMPFTN     
                        MOVE  HKN-HON-NYUSKJRYYKBN
                                             TO   LNK-SYU-SYUSKJ-FTNKBN
                        MOVE  WK-SHOKUJI-NISSU
                                             TO   LNK-SYU-SYUSKJ-NISSU
                        MOVE  WK-SHOKUJI-RYOYOHI
                                             TO   LNK-SYU-SYUSKJ-RYOYOHI
                        IF    HKN-HON-NYUSKJRYYKBN  NOT =  "0"
                            IF    HKN-HON-NYUSKJRYYKBN  NOT =  "3"
                              MOVE  WK-SHOKUJI-FTN
                                             TO   LNK-SYU-SYUSKJ-FTN
                            END-IF
                            MOVE  WK-SHOKUJI-FTN
                                            TO   LNK-SYU-SYUSKJ-FTN-RECE
                        END-IF
               ELSE
                        IF    HKN-KZK-NYUKFTNRATE     NOT =    ZERO
                              MOVE   HKN-KZK-NYUKFTNRATE
                                           TO   WK-DAY-NYUKFTNRATE
                                                WK-KOH-FTNRATE
                              COMPUTE   WK-FUTANWARI  =
                                        HKN-KZK-NYUKFTNRATE  /  100
                              COMPUTE   LNK-SYU-SYUCOMPFTN  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   LNK-SYU-SYUCOMPFTN-ENTANI  =    
                                        WK-ZENGAKU   *  WK-FUTANWARI    
                              IF  (COMB-SYU-HKNKOHSBTKBN     = "8" )
                              AND (WK-1001-JIHIPOSITION  NOT = "2" )
                              AND (COMB-HOJOKBN              = "1" )
                              AND (LNK-SYU-SRYYMD(1:6)  >= "200704")
                                 COMPUTE  LNK-SYU-SYUCOMPFTN =
                                          LNK-SYU-SYUCOMPFTN +
                                          WK-SKYMONEY-ZEI
                                 COMPUTE  LNK-SYU-SYUCOMPFTN-ENTANI =
                                          LNK-SYU-SYUCOMPFTN-ENTANI +
                                          WK-SKYMONEY-ZEI
                              END-IF
      *                       減額
                              EVALUATE  WK-GENGAKUKBN
                                WHEN        1
                                  IF  WK-GENGAKU-RITU = 100
                                   MOVE  ZERO  TO  WK-GENGAKU-GAK
                                   MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                                  ELSE
                                   COMPUTE  WK-GENGAKU-RITUX =
                                            100 - WK-GENGAKU-RITU
                                   COMPUTE  WK-GENGAKU-GAK      =
                                            LNK-SYU-SYUCOMPFTN  *
                                            WK-GENGAKU-RITUX    /
                                            100
                                   COMPUTE  WK-GENGAKU-GAK-ENTANI     =
                                            LNK-SYU-SYUCOMPFTN-ENTANI *
                                            WK-GENGAKU-RITUX          /
                                            100
                                  END-IF
                                WHEN        2
                                  CONTINUE
                                WHEN        3
                                WHEN        4
                                  MOVE  ZERO  TO  WK-GENGAKU-GAK
                                  MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                              END-EVALUATE
                              IF  WK-GENGAKUKBN  NOT =  ZERO
                                  MOVE  WK-GENGAKU-GAK
                                          TO  LNK-SYU-SYUCOMPFTN
                                  MOVE  WK-GENGAKU-GAK-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN2
                              IF   COMB-SYU-HKNKOHSBTKBN  =  "8"
                              AND  WK-1001-JIHIPOSITION   =  "3"
                              AND  LNK-SYU-SRYYMD(1:6)   >=  "200604"
                                 CONTINUE
                              ELSE
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           LNK-SYU-SYUCOMPFTN  +  5
                                 COMPUTE   WK-FTN      =
                                           LNK-SYU-SYUCOMPFTN  /  10
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           WK-FTN   *  10
                              END-IF
                        END-IF
      *
                        IF    FLG-GENBUTU70          NOT =  ZERO
      ***                   IF  LNK-SYU-SYUCOMPFTN   >=  21000
                            IF  WK-TOKUTEI-COMPFTN2  >=  21000
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (COMB-KOH1HKNNUM        =  SPACE)
                            AND (COMB-KOH2HKNNUM        =  SPACE)
                            AND (COMB-KOH3HKNNUM        =  SPACE)
                            AND (COMB-KOH4HKNNUM        =  SPACE)
                            AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                            AND (WK-GENBUTU-HKNKIN  NOT =  ZERO )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  21000
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                        END-IF
                        IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
                        OR   (FLG-KOHININBARAI           =    1 )
                        OR   (FLG-GENBUTU70          NOT =  ZERO)
                         IF  (FLG-GENBUTU70      NOT =  ZERO )
                         AND (COMB-KOH1HKNNUM        =  SPACE)
                         AND (COMB-KOH2HKNNUM        =  SPACE)
                         AND (COMB-KOH3HKNNUM        =  SPACE)
                         AND (COMB-KOH4HKNNUM        =  SPACE)
                         AND (FLG-GENBUTU-TAISYODATA =  ZERO )
                            MOVE WK-TOKUTEI-COMPFTN2
                                                 TO  WK-TOKUTEI-COMPFTN
                            IF    FLG-KOUGAKUCYO-GEN70 =    1
                               MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                            END-IF
                         ELSE
                            IF  ZAN-SYU-M     <=    WK-TOKUTEI-COMPFTN2 
                                MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
                                                     WK-TOKUTEI-COMPFTN 
                            ELSE                                        
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                                IF    FLG-KOUGAKUCYO    =    1
                                   MOVE    ZERO    TO   FLG-KOUGAKUCYO
                                END-IF
                                IF    FLG-KOUGAKUCYO3   =    1
                                   MOVE    ZERO    TO   FLG-KOUGAKUCYO3
                                END-IF
                                IF    FLG-KOUGAKUCYO-ININ  =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-ININ
                                END-IF
                                IF    FLG-KOUGAKUCYO-GEN70 =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                                END-IF
                            END-IF
                            IF  ZAN-SYU-M-ENTANI                        
                                              <     WK-TOKUTEI-COMPFTN2
                                MOVE  ZAN-SYU-M-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                            END-IF                                      
                         END-IF
                        ELSE
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                        END-IF
                        COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                                  LNK-SYU-SYUCOMPFTN     
                        MOVE  HKN-KZK-NYUSKJRYYKBN
                                             TO   LNK-SYU-SYUSKJ-FTNKBN
                        MOVE  WK-SHOKUJI-NISSU
                                             TO   LNK-SYU-SYUSKJ-NISSU
                        MOVE  WK-SHOKUJI-RYOYOHI
                                             TO   LNK-SYU-SYUSKJ-RYOYOHI
                        IF    HKN-KZK-NYUSKJRYYKBN  NOT =  "0"
                            IF    HKN-KZK-NYUSKJRYYKBN  NOT =  "3"
                              MOVE  WK-SHOKUJI-FTN
                                             TO   LNK-SYU-SYUSKJ-FTN
                            END-IF
                            MOVE  WK-SHOKUJI-FTN
                                            TO   LNK-SYU-SYUSKJ-FTN-RECE
                        END-IF
               END-IF
             WHEN   "1"
               IF    WK-4001-KSNRATE1(1:3)   =  SPACE
                  IF    WK-4001-KSNRATE(1:2)   =    SPACE
                      MOVE     100        TO   WK-KSNRATE9
                      COMPUTE  WK-KSNRATE   =  WK-KSNRATE9  /  100
                  ELSE
                      COMPUTE  WK-KSNRATE9  =  WK-4001-KSNRATE
                                            +  100 
                      COMPUTE  WK-KSNRATE   =  WK-KSNRATE9  /  100
                  END-IF  
               ELSE
                 MOVE WK-4001-KSNRATE1    TO   WK-KSNRATE9
                 COMPUTE  WK-KSNRATE   =  WK-KSNRATE9  /  100
               END-IF
               IF     LNK-SYU-SYUHKNNUM       =  "971" OR "973"
                 IF   LNK-SYU-PTFTNRATE       =   100
                   MOVE     100      TO   HKN-HON-NYUKFTNRATE
                                          HKN-KZK-NYUKFTNRATE
                                          HKN-TSY-NYUKFTNRATE
                                          HKN-TNK-NYUKFTNRATE
                   MOVE     "1"      TO   HKN-HON-NYUSKJRYYKBN
                                          HKN-KZK-NYUSKJRYYKBN
                                          HKN-TSY-NYUSKJRYYKBN
                                          HKN-TNK-NYUSKJRYYKBN
                 ELSE
                   MOVE     ZERO     TO   HKN-HON-NYUKFTNRATE
                                          HKN-KZK-NYUKFTNRATE
                                          HKN-TSY-NYUKFTNRATE
                                          HKN-TNK-NYUKFTNRATE
                   MOVE     "0"      TO   HKN-HON-NYUSKJRYYKBN
                                          HKN-KZK-NYUSKJRYYKBN
                                          HKN-TSY-NYUSKJRYYKBN
                                          HKN-TNK-NYUSKJRYYKBN
                 END-IF
               END-IF
               IF     LNK-SYU-SYUHKNNUM       =  "971"
                 IF   FLG-KENPOJYUNKYO  =  ZERO
                   EVALUATE  WK-4001-TENKBN
                     WHEN  "1"
                         COMPUTE  WK-ZENGAKU  =  
                                 (WK-ZENGAKU  / 10 * 11.5)
                     WHEN  "2"
                         COMPUTE  WK-ZENGAKU  =  
                                 (WK-ZENGAKU  / 10 * 12.0)
                   END-EVALUATE
                 ELSE
                   COMPUTE WK-ZENGAKU =
                          (WK-ZENGAKU / 10 * WK-4001-KOMUTENTANKA)
                 END-IF
               ELSE
                 IF   FLG-KENPOJYUNKYO  =  ZERO
                   EVALUATE  WK-4001-TENKBN
                     WHEN  "1"
                        COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  /  10  
                        MOVE  LNK-S02-SYUTEN  TO  WK-ZENGAKU-SYU
                        COMPUTE  WK-ZENGAKU-YAK = WK-ZENGAKU 
                                                - LNK-S02-SYUTEN
                        COMPUTE  WK-ZENGAKU-SYU =
                          (WK-ZENGAKU-SYU * 11.5 * WK-KSNRATE)
                                                 + 0.5
                        COMPUTE  WK-ZENGAKU-YAK =
                          (WK-ZENGAKU-YAK * 11.5)
                                                 + 0.5
                        COMPUTE  WK-ZENGAKU     = WK-ZENGAKU-SYU
                                                + WK-ZENGAKU-YAK
                     WHEN  "2"
                        COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  /  10  
                        MOVE  LNK-S02-SYUTEN  TO  WK-ZENGAKU-SYU
                        COMPUTE  WK-ZENGAKU-YAK = WK-ZENGAKU 
                                                - LNK-S02-SYUTEN
                        COMPUTE  WK-ZENGAKU-SYU =
                          (WK-ZENGAKU-SYU * 12.0 * WK-KSNRATE)
                                                 + 0.5
                        COMPUTE  WK-ZENGAKU-YAK =
                          (WK-ZENGAKU-YAK * 12.0)
                                                 + 0.5
                        COMPUTE  WK-ZENGAKU     = WK-ZENGAKU-SYU
                                                + WK-ZENGAKU-YAK
                   END-EVALUATE
                 ELSE
                   COMPUTE  WK-ZENGAKU     =  WK-ZENGAKU  /  10
                   MOVE   LNK-S02-SYUTEN  TO  WK-ZENGAKU-SYU
                   COMPUTE  WK-ZENGAKU-YAK =  WK-ZENGAKU
                                           -  LNK-S02-SYUTEN
                   COMPUTE  WK-ZENGAKU-SYU =
                           (WK-ZENGAKU-SYU *  WK-4001-SYUTENTANKA)
                                           +  0.5
                   COMPUTE  WK-ZENGAKU-YAK =
                           (WK-ZENGAKU-YAK *  WK-4001-YKZTENTANKA)
                                           +  0.5
                   COMPUTE  WK-ZENGAKU     =  WK-ZENGAKU-SYU
                                           +  WK-ZENGAKU-YAK
                 END-IF
               END-IF 
      *
               COMPUTE   LNK-SYU-RSIJIBAI-SKYMONEY  =
                         WK-ZENGAKU                 +
                         WK-SHOKUJI-FTN
      *
               COMPUTE   WK-FUTANWARI  =
                         HKN-HON-NYUKFTNRATE  /  100
               COMPUTE   LNK-SYU-SYUCOMPFTN  =
                         WK-ZENGAKU   *  WK-FUTANWARI
      *         COMPUTE   LNK-SYU-SYUCOMPFTN =
      *                   LNK-SYU-SYUCOMPFTN  +  5
      *         COMPUTE   WK-FTN      =
      *                   LNK-SYU-SYUCOMPFTN  /  10
      *         COMPUTE   LNK-SYU-SYUCOMPFTN =
      *                   WK-FTN   *  10
               COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                         LNK-SYU-SYUCOMPFTN     
               MOVE  HKN-HON-NYUSKJRYYKBN
                                        TO   LNK-SYU-SYUSKJ-FTNKBN
               MOVE  WK-SHOKUJI-NISSU
                                        TO   LNK-SYU-SYUSKJ-NISSU
               MOVE  WK-SHOKUJI-RYOYOHI
                                        TO   LNK-SYU-SYUSKJ-RYOYOHI
               IF    HKN-HON-NYUSKJRYYKBN  NOT =  "0"
                       IF    HKN-HON-NYUSKJRYYKBN  NOT =  "3"
                         MOVE  WK-SHOKUJI-FTN
                                        TO   LNK-SYU-SYUSKJ-FTN
                       END-IF
                       MOVE  WK-SHOKUJI-FTN
                                        TO   LNK-SYU-SYUSKJ-FTN-RECE
               END-IF
             WHEN   "2"
               MOVE     ZERO            TO   HKN-HON-NYUKFTNRATE
                                             HKN-KZK-NYUKFTNRATE
                                             HKN-TSY-NYUKFTNRATE
                                             HKN-TNK-NYUKFTNRATE
               MOVE     "0"             TO   HKN-HON-NYUSKJRYYKBN
                                             HKN-KZK-NYUSKJRYYKBN
                                             HKN-TSY-NYUSKJRYYKBN
                                             HKN-TNK-NYUSKJRYYKBN
      *
               COMPUTE  WK-ZENGAKU      =    WK-ZENGAKU  /  10
               MOVE     LNK-S02-SYUTEN  TO   WK-ZENGAKU-SYU
               COMPUTE  WK-ZENGAKU-YAK  =    WK-ZENGAKU
                                        -    LNK-S02-SYUTEN
               COMPUTE  WK-ZENGAKU-SYU  =    WK-ZENGAKU-SYU * 12
               COMPUTE  WK-ZENGAKU-YAK  =    WK-ZENGAKU-YAK * 10
               COMPUTE  WK-ZENGAKU      =    WK-ZENGAKU-SYU
                                        +    WK-ZENGAKU-YAK
      *
               COMPUTE  WK-SHOKUJI-RYOYOHI-KOGAI =  WK-SHOKUJI-RYOYOHI
                                                 *  1.2
      *
               COMPUTE  LNK-SYU-RSIJIBAI-SKYMONEY  =
                        WK-ZENGAKU                 +
                        WK-SHOKUJI-RYOYOHI-KOGAI
      *
               COMPUTE  WK-FUTANWARI  =
                        HKN-HON-NYUKFTNRATE  /  100
               COMPUTE  LNK-SYU-SYUCOMPFTN  =
                        WK-ZENGAKU    *  WK-FUTANWARI
      *
               COMPUTE  LNK-SYU-SYUCOMPTOTAL   =
                        LNK-SYU-SYUCOMPFTN
      *
               MOVE     HKN-HON-NYUSKJRYYKBN TO  LNK-SYU-SYUSKJ-FTNKBN
               MOVE     WK-SHOKUJI-NISSU     TO  LNK-SYU-SYUSKJ-NISSU
      ***      MOVE     WK-SHOKUJI-RYOYOHI   TO  LNK-SYU-SYUSKJ-RYOYOHI
               MOVE     WK-SHOKUJI-RYOYOHI-KOGAI
                                             TO  LNK-SYU-SYUSKJ-RYOYOHI
               IF    HKN-HON-NYUSKJRYYKBN  NOT =  "0"
                 IF  HKN-HON-NYUSKJRYYKBN  NOT =  "3"
                   MOVE WK-SHOKUJI-FTN       TO  LNK-SYU-SYUSKJ-FTN
                 END-IF
                 MOVE   WK-SHOKUJI-FTN       TO  LNK-SYU-SYUSKJ-FTN-RECE
               END-IF
           END-EVALUATE.
      *
       2305-SYUHOKEN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費の保険番号テーブル検索                              *
      ******************************************************************
       2306-KOH-HKNREAD-SEC           SECTION.
      *
      *    該当保険番号テーブルの検索
           INITIALIZE                      HKNNUM-REC.
           MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM.
           MOVE   COMB-KOHHKNNUM(KOH-IDX)
                                     TO    HKN-HKNNUM.
           IF     COMB-KOHHKNNUM(KOH-IDX)  =     "027"
                  MOVE     COMB-KOH1PAYKBN
                                     TO    WK-PAYKBN
           ELSE
                  MOVE     "00"      TO    WK-PAYKBN
           END-IF.
           MOVE   HKNNUM-REC         TO    MCPDATA-REC.
           MOVE   "DBSELECT"         TO    MCP-FUNC.
           MOVE   "tbl_hknnum"       TO    MCP-TABLE.
           MOVE   "key2"             TO    MCP-PATHNAME.
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA.
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  HKNNUM-READ-SEC
               PERFORM  UNTIL
                 (FLG-HKNNUM     =    1)                       OR
                ((HKN-TEKSTYMD(1:6)     <=  LNK-SYU-SRYYMD(1:6)  ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=  HKN-TEKEDYMD(1:6))     AND
                 (WK-PAYKBN            =  HKN-PAYKBN))
                   MOVE     "tbl_hknnum"  TO    MCP-TABLE
                   MOVE     "key2"        TO    MCP-PATHNAME
                   PERFORM   HKNNUM-READ-SEC
               END-PERFORM
           END-IF.
      *
           MOVE     "tbl_hknnum"  TO    MCP-TABLE.
           MOVE     "key2"        TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    患者負担金算出前の１００％負担額算出
           IF    (COMB-KOHHKNNUM(KOH-IDX)(1:1)   =   "0"           )
           OR    (COMB-KOHHKNNUM(KOH-IDX)        =   "972" OR "974")
                 MOVE    10    TO      HKN-TENTNK
           ELSE
             IF   HKN-TENTNK   =   ZERO
                 MOVE    10    TO      HKN-TENTNK
             END-IF
           END-IF.
           MOVE      ZERO      TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX9    FROM    1   BY  1
                     UNTIL     IDX9       >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                            (LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK)
           END-PERFORM.
      *
           MOVE       ZERO                TO   WK-NYUKFTNRATE.
           MOVE       SPACE               TO   WK-NYUSKJRYYKBN.
           MOVE       ZERO                TO   WK-NYUSKJJYOGAK.
           MOVE       ZERO                TO   FLG-NYUSKJJYOGAK.
      *
           IF    COMB-KOHHKNNUM(KOH-IDX)(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                     MOVE   HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                 WHEN   "2"
                   IF   HKN-TSY-NYUFTNNBK      =  "0"
                     MOVE   HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                   ELSE
                     MOVE   HKN-TSY-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-TSY-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-TSY-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                   END-IF
                 WHEN   "3"
                   IF  HKN-TNK-NYUFTNKBN       =  "0"
                     MOVE   HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                   ELSE
                     MOVE   HKN-TNK-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-TNK-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-TNK-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                   END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141"             ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "241" OR "180" OR
                                                "182" OR "143" OR
                                                "185" OR "127"    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "374" OR "474"    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "191" OR "391"    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                           >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "155"             ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "100"             ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141" OR "285" OR
                                                "485" OR "180" OR
                                                "186"             ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141"             ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141"             ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                        MOVE  HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                   WHEN   "2"
                     IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                     ELSE
                        MOVE  HKN-TSY-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-TSY-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-TSY-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                     END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                      ELSE
                        MOVE  HKN-TNK-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-TNK-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-TNK-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                 MOVE  HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                 MOVE  HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
               END-IF
             END-IF
           ELSE
             MOVE      HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
             MOVE      HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
             MOVE      HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
           END-IF.
      *
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200304"      )
           AND (LNK-SYU-SRYYMD(1:6)      <   "200604"      )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "015" OR "016")
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  WK-JIRITU-SKJGENMEN(KOH-IDX)  =   1
                MOVE    "3"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  WK-SYOGAI-SKJGENMEN(KOH-IDX)  =   1
                MOVE    "3"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (COMB-KOHHKNNUM(KOH-IDX)   =  "012"         )
                MOVE    "3"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200310"      )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "051"         )
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200310"      )
           AND (WK-1001-PREFNUM           =   13           )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "151" OR "451")
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200310"      )
           AND (WK-1001-PREFNUM           =   28           )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "186"         )
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200504"      )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "052"         )
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200702"      )
           AND (WK-1001-PREFNUM           =   07           )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "281"         )
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
      *
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "027"
                MOVE    HKN-HON-NYUKFTNRATE  TO   WK-KOH-FTNRATE
                MOVE    "1"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
      *
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "011"
           AND  LNK-SYU-SRYYMD(1:6)     >=  "200704"
                MOVE    "2"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "012"
           AND  LNK-SYU-SRYYMD(1:6)     >=  "200604"
                MOVE    "2"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "025"
                MOVE    "2"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
      *
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "010" OR "021"
              IF    (COMB-KOHHKNNUM(KOH-IDX)  =  "021"   )
              AND   (LNK-SYU-SRYYMD(1:6)     >=  "200604")
                 CONTINUE
              ELSE
                 IF   FLG-SEISINJYO  =  1
                   MOVE     ZERO     TO    WK-NYUKFTNRATE
                   MOVE     "3"      TO    WK-NYUSKJRYYKBN
                 END-IF
              END-IF
           END-IF.
      *
           MOVE      ZERO      TO        FLG-MIYAGI.
           IF     (WK-1001-PREFNUM         =  04           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "183" OR "383" 
                                                   OR "483") AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200510"      ) AND
                  (LNK-SYU-SRYYMD(1:6)    <  "200610"      )
      *
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    COMB-KOHHKNNUM(KOH-IDX)
                                             TO  PTKOH-KOHNUM
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKSTYMD
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKEDYMD
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key6"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key6"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF   PTKOH-KOHID  =  COMB-KOHID(KOH-IDX)
                           EVALUATE  PTKOH-FTNJANUM(1:7)
                             WHEN    "8304004"
                             WHEN    "8304009"
                             WHEN    "8304017"
                             WHEN    "8304023"
                             WHEN    "8304026"
                             WHEN    "8304028"
                             WHEN    "8304036"
                             WHEN    "8304041"
                               MOVE    1    TO  FLG-MIYAGI
                           END-EVALUATE
                           MOVE    1        TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key6"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key6"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
      *
           END-IF.
           IF     (WK-1001-PREFNUM         =  04           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "183" OR "383" 
                                                   OR "483") AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200610"      )
      *
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    COMB-KOHHKNNUM(KOH-IDX)
                                             TO  PTKOH-KOHNUM
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKSTYMD
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKEDYMD
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key6"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key6"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF   PTKOH-KOHID  =  COMB-KOHID(KOH-IDX)
                           EVALUATE  PTKOH-FTNJANUM(1:7)
                             WHEN    "8304017"
                             WHEN    "8304028"
                             WHEN    "8304079"
                               MOVE    1    TO  FLG-MIYAGI
                           END-EVALUATE
                           MOVE    1        TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key6"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key6"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    北海道・特定疾患（０５１）（道単独事業）
           IF    (WK-DOTANDOKU(KOH-IDX)     =   1)
           AND   (WK-DOTANDOKUFLG(KOH-IDX)  =   1)
               MOVE    "1"       TO   WK-NYUSKJRYYKBN
               MOVE    9999999   TO   WK-TAIHI-NYUJGNGAK(KOH-IDX)
           END-IF.
      *
      *    埼玉県さいたま市
      *    宮城県
      *    茨城県
           IF     LNK-SYU-SRYYMD(1:6)     >=  "200604"
             IF ((WK-1001-PREFNUM          =   11           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "352" OR "353"
                                                    OR "354"))
             OR ( FLG-MIYAGI          NOT  =   ZERO          )
             OR ((WK-1001-PREFNUM          =   08           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "146"
                                           OR "183" OR "185") AND
                 (LNK-SYU-SRYYMD(1:6)    >= "200511"
                                     AND <= "200703"        ))
             OR ((WK-1001-PREFNUM          =   11           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "281"         ) AND
                 (LNK-SYU-SRYYMD(1:6)    >= "200704"        ))
                       MOVE     1     TO   FLG-NYUSKJJYOGAK
             END-IF
             IF ((WK-1001-PREFNUM          =   11           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "543"         ) AND
                 (LNK-SYU-SRYYMD(1:6)    >= "200710"        ))
                       MOVE     2     TO   FLG-NYUSKJJYOGAK
             END-IF
             IF ((WK-1001-PREFNUM          =   11           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "381"         ) AND
                 (LNK-SYU-SRYYMD(1:6)    >= "200801"        ))
                       MOVE     2     TO   FLG-NYUSKJJYOGAK
             END-IF
             IF ((WK-1001-PREFNUM          =   11           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "743" OR "442"
                                                    OR "542") AND
                 (LNK-SYU-SRYYMD(1:6)    >= "200804"        ))
                       MOVE     2     TO   FLG-NYUSKJJYOGAK
             END-IF
           ELSE
             IF ((WK-1001-PREFNUM          =   11           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "352" OR "353"
                                                    OR "354"))
             OR ( FLG-MIYAGI          NOT  =   ZERO          )
             OR ((WK-1001-PREFNUM          =   08           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "146"
                                           OR "183" OR "185") AND
                 (LNK-SYU-SRYYMD(1:6)    >= "200511"
                                     AND <= "200703"        ))
                 EVALUATE   WK-SYOTOKU-SKJKBN(1)
                     WHEN      SPACE
                       MOVE    390    TO   WK-NYUSKJJYOGAK
                     WHEN      "1"
                     WHEN      "4"
                       MOVE    150    TO   WK-NYUSKJJYOGAK
                     WHEN      "2"
                       MOVE    325    TO   WK-NYUSKJJYOGAK
                     WHEN      "3"
                       MOVE    250    TO   WK-NYUSKJJYOGAK
                 END-EVALUATE
             END-IF
           END-IF.
      *
      *    福岡県の地方公費対応（公費付加情報の取得）
           MOVE     SPACE     TO     WK-KOH-FTNKBN.
           IF  (WK-1001-PREFNUM           =       40)    AND
               (COMB-KOHHKNNUM(KOH-IDX)(1:1)  >= "1")    AND
               (COMB-KOHHKNNUM(KOH-IDX)(1:1)  <= "8")
               PERFORM     23061-KOHPLUS-FUKUOKA-SEC
           END-IF.
      *
           IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
           AND  (FLG-SEIKATUL            =   1      )
           AND  (WK-NYUSKJRYYKBN         =  "3"     )
               IF ((WK-1001-PREFNUM         =  10           ) AND
                   (COMB-KOHHKNNUM(KOH-IDX) = "146" OR "246"
                                           OR "143" OR "243"
                                           OR "177" OR "187"))
               OR ((WK-1001-PREFNUM         =  15           ) AND
                   (COMB-KOHHKNNUM(KOH-IDX) = "261" OR "361"
                                                    OR "561"
                                           OR "264" OR "364"
                                                    OR "564"))
                   IF     FLG-SEIKATUS       =   1
                         MOVE  "5"    TO  WK-NYUSKJRYYKBN
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                   ELSE
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN
                   END-IF
               END-IF
           END-IF.
      *
           IF ((WK-1001-PREFNUM         =  01                    ) AND
               (COMB-KOHHKNNUM(KOH-IDX) = "142" OR "143" OR "144"
                                                         OR "744") AND
               (LNK-SYU-SRYYMD(1:6)    >= "200410"               ))
           OR ((WK-1001-PREFNUM         =  01                    ) AND
               (COMB-KOHHKNNUM(KOH-IDX) = "842" OR "443" OR "444") AND
               (WK-NYUKFTNRATE          =  ZERO                  ) AND
               (LNK-SYU-SRYYMD(1:6)    >= "200410"               ))
           OR ((WK-1001-PREFNUM         =  01                    ) AND
               (COMB-KOHHKNNUM(KOH-IDX) = "190" OR "291" OR "292") AND
               (LNK-SYU-SRYYMD(1:6)    >= "200708"               ))
               IF    LNK-S02-SYOSINFLG  =  SPACE
                    MOVE    SPACE   TO   COMB-KOH-NYUJGNKBN(KOH-IDX)
                    MOVE    ZERO    TO   WK-NYUKFTNRATE
               END-IF
           END-IF.
      *
           IF  (WK-1001-PREFNUM         =  13           ) AND
               (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
               (LNK-SYU-SRYYMD(1:6)    >= "200710"      )
                    MOVE    SPACE   TO   COMB-KOH-NYUJGNKBN(KOH-IDX)
                    MOVE    ZERO    TO   WK-NYUKFTNRATE
           END-IF.
      *
           IF  (WK-1001-PREFNUM         =  31           ) AND
               (COMB-KOHHKNNUM(KOH-IDX) = "281" OR "282"
                                                OR "283") AND
               (LNK-SYU-SRYYMD(1:6)    >= "200804"      ) AND
               (WK-TOTORI-JIRITU        =  1            )
                    MOVE    SPACE   TO   COMB-KOH-NYUJGNKBN(KOH-IDX)
                    MOVE    ZERO    TO   WK-NYUKFTNRATE
           END-IF.
      *
           IF  (COMB-KOHHKNNUM(KOH-IDX)(1:2)  = "99"  ) AND
               (WK-NYUKFTNRATE                =  ZERO )
                    MOVE    WK-KOH-FTNRATE   TO   WK-NYUKFTNRATE
           END-IF.
      *
           IF  (LNK-SYU-SRYYMD(1:6)     >= "200604"               )
           AND (COMB-KOHHKNNUM(KOH-IDX)  = "015" OR "016" OR "021")
           AND (WK-JIRITU-CYUKANSOU(KOH-IDX)   =  1               )
                   MOVE    1       TO  LNK-SYU-NYNSHOKAISU
           END-IF.
      *
           IF  ((LNK-S02-KOUREI-NYUIN-KBN        =     "1" ) OR
                (FLG-GENBUTU70               NOT =     ZERO))
           AND ( COMB-KOHHKNNUM(KOH-IDX)(1:1)   >=     "1"  )
           AND ( COMB-KOHHKNNUM(KOH-IDX)(1:1)   <=     "8"  )
           AND ( COMB-KOH-NYUJGNKBN(KOH-IDX)     =   SPACE  )
           AND ( WK-NYUKFTNRATE                  =     100
                                                OR      30  )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
      *
           IF  ( LNK-SYU-SRYYMD(1:6)            >= "200610" )
           AND ((LNK-S02-KOUREI-NYUIN-KBN        =     "1" ) OR
                (FLG-GENBUTU70               NOT =     ZERO))
           AND ( WK-1001-PREFNUM                 =     13   )
           AND ( COMB-KOHHKNNUM(KOH-IDX)         =    "182" )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
      *
           IF  ( FLG-GENBUTU70               NOT =     ZERO        )
           AND ( WK-1001-PREFNUM                 =     07          )
           AND ( COMB-KOHHKNNUM(KOH-IDX)         =  "245" OR "246" )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
           IF  ( FLG-GENBUTU70               NOT =     ZERO        )
           AND ( WK-1001-PREFNUM                 =     11          )
           AND ( COMB-KOHHKNNUM(KOH-IDX)   =  "181" OR  "182"
                                           OR "183" OR  "281"      )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
           IF  ( FLG-GENBUTU70               NOT =     ZERO        )
           AND ( WK-1001-PREFNUM                 =     11          )
           AND ( COMB-KOHHKNNUM(KOH-IDX)         =    "543"        )
           AND ( LNK-SYU-SRYYMD(1:6)            >=    "200710"     )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
           IF  ( FLG-GENBUTU70               NOT =     ZERO        )
           AND ( WK-1001-PREFNUM                 =     11          )
           AND ( COMB-KOHHKNNUM(KOH-IDX)         =    "381"        )
           AND ( LNK-SYU-SRYYMD(1:6)            >=    "200801"     )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
           IF  ( FLG-GENBUTU70               NOT =     ZERO        )
           AND ( WK-1001-PREFNUM                 =     11          )
           AND ( COMB-KOHHKNNUM(KOH-IDX) = "743" OR "442"          )
           AND ( LNK-SYU-SRYYMD(1:6)            >=    "200804"     )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
           IF  ( LNK-S02-KOUREI-NYUIN-KBN        =     "1"         )
           AND ( WK-1001-PREFNUM                 =     11          )
           AND ( COMB-KOHHKNNUM(KOH-IDX) = "542"                   )
           AND ( LNK-SYU-SRYYMD(1:6)            >=    "200804"     )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
      *
       2306-KOH-HKNREAD-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費付加情報の取得（福岡県対応）                  *
      ******************************************************************
       23061-KOHPLUS-FUKUOKA-SEC           SECTION.
      *
           INITIALIZE                  ORCSKOHPLUS-AREA
           MOVE    LNK-SYU-HOSPNUM TO  LNK-SKOHPLUS-HOSPNUM
           MOVE    WK-1001-PREFNUM TO  LNK-SKOHPLUS-PREFNUM
           MOVE    LNK-SYU-PTID    TO  LNK-SKOHPLUS-PTID
           MOVE    LNK-SYU-HKNCOMBINUM
                                   TO  LNK-SKOHPLUS-HKNCOMBI
           MOVE    LNK-SYU-SRYYMD  TO  LNK-SKOHPLUS-SRYYMD
           CALL    "ORCSKOHPLUS"       USING
                                       ORCSKOHPLUS-AREA
                                       SPA-AREA
           IF      LNK-SKOHPLUS-RC =   ZERO
               MOVE   LNK-SKOHPLUS-FTNKBN    TO   WK-KOH-FTNKBN
               MOVE   LNK-SKOHPLUS-NYUSKJRYYKBN
                                             TO   WK-NYUSKJRYYKBN
               MOVE   WK-KOH-FTNRATE         TO   WK-NYUKFTNRATE
               IF     WK-NYUKFTNRATE  =  ZERO
                      MOVE    SPACE   TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
               END-IF
           END-IF
      *
           .
      *
       23061-KOHPLUS-FUKUOKA-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費の患者負担金額計算（上限額あり）                    *
      ******************************************************************
       2307-KOH-KEISAN-SEC           SECTION.
      *
      *    日別収納算定
           IF   WK-DAYINFFLG(KOH-IDX)  =    1
               PERFORM    23071-DAYINF-SANTEI-SEC
               GO    TO   2307-KOH-KEISAN-EXT
           END-IF.
      *
      *    負担金額の計算
           IF  WK-NYUKFTNRATE     NOT =    ZERO
      *
               IF   WK-DAY-NYUKFTNRATE  =  ZERO
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE
               ELSE
                 IF  WK-DAY-NYUKFTNRATE  > WK-NYUKFTNRATE
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE
                 END-IF
               END-IF
      *
               COMPUTE   WK-FUTANWARI  =
                              WK-NYUKFTNRATE  /  100
               IF    WK-KOH-FTNKBN   NOT =  SPACE
                 EVALUATE  WK-KOH-FTNKBN
                    WHEN  "1"
                      COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                      COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                    WHEN  "2"
                      MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                      MOVE    ZERO   TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                      MOVE    ZERO   TO   LNK-SYU-KYUFUGAI-SHOSHIN-TEN
                                          LNK-SYU-KYUFUGAI-SIDOU-TEN
                                          LNK-SYU-KYUFUGAI-OSIN1-TEN
                                          LNK-SYU-KYUFUGAI-OSIN2-TEN
                                          LNK-SYU-KYUFUGAI-OSIN3-TEN
                                          LNK-SYU-KYUFUGAI-GOKEI-TEN
                 END-EVALUATE
               ELSE
                 COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
                 COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
                 IF  (WK-1001-PREFNUM             =  01           )
                 AND (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "642" OR "643"
                                                 OR "644" OR "743")
                 AND (LNK-S02-SYOSINFLG       NOT =  SPACE        )
                     IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)         <   580
                        MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                        COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                                 LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                                 580
                     END-IF
                     IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <   580
                        MOVE  ZERO  TO
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     ELSE
                        COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                                 580
                     END-IF
                 END-IF
               END-IF
      *
      *        IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)       =  "027"
               IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0"
      *             減額
                    EVALUATE  WK-GENGAKUKBN
                      WHEN        1
                        IF  WK-GENGAKU-RITU = 100
                         MOVE  ZERO  TO  WK-GENGAKU-GAK
                         MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                        ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  WK-GENGAKU-GAK               =
                                  LNK-SYU-KOH-COMPFTN(KOH-IDX) *
                                  WK-GENGAKU-RITUX             /
                                  100
                         COMPUTE  WK-GENGAKU-GAK-ENTANI               =
                                  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) *
                                  WK-GENGAKU-RITUX                    /
                                  100
                        END-IF
                      WHEN        2
                        CONTINUE
                      WHEN        3
                      WHEN        4
                        MOVE  ZERO  TO  WK-GENGAKU-GAK
                        MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                    END-EVALUATE
                    IF  WK-GENGAKUKBN  NOT =  ZERO
                        MOVE  WK-GENGAKU-GAK
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  WK-GENGAKU-GAK-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                    END-IF
                    IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "027"
                        MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)                 
                                            TO WK-TOKUTEI-COMPFTN3      
                    END-IF
               END-IF                                      
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "051"         ) OR
                  ( HKN-RECEFTNDSPKBN            =  "2"           ) OR
                  ( (LNK-SYU-SRYYMD(1:6)        >=  "200404"      ) AND
                    (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "015" OR "016") )
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN
                                        TO  LNK-SYU-SYUCOMPFTN
                   END-IF
                   IF    LNK-SYU-KOH-HKNNUM(1)    =    "027"
                     IF  WK-TOKUTEI-COMPFTN3  NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN3
                                        TO  LNK-SYU-KOH-COMPFTN(1)
                     END-IF
                   END-IF
               ELSE
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  / 10
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             WK-FTN   *  10
               END-IF
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =   "1"  )            
               AND ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "027" )            
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      ZAN-KOHI1-ENTANI            
                     MOVE   ZAN-KOHI1-ENTANI       TO                   
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) 
                 END-IF                                                 
               ELSE                                                     
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      ZAN-KOHI-T3(KOH-IDX)        
                     MOVE   ZAN-KOHI-T3(KOH-IDX)   TO                   
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) 
                 END-IF                                                 
               END-IF                                                   
               PERFORM    23075-KOHHI-HIKAKU4-SEC                             
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "051"         ) OR
                  ( HKN-RECEFTNDSPKBN            =  "2"           ) OR
                  ( (LNK-SYU-SRYYMD(1:6)        >=  "200404"      ) AND
                    (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "015" OR "016") )
                 IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)   >                 
                                            ZAN-KOHI-T2(KOH-IDX)        
                     MOVE   ZAN-KOHI-T2(KOH-IDX)   TO                   
                                          WK-KOH-COMPFTN(KOH-IDX)       
                     PERFORM    23073-KOHHI-HIKAKU2-SEC                       
                 ELSE
                     MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  TO
                                          WK-KOH-COMPFTN(KOH-IDX)       
                     PERFORM    23073-KOHHI-HIKAKU2-SEC
                 END-IF                                                 
               END-IF                                                   
               IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)   >
                                            ZAN-KOHI-T(KOH-IDX)
                     MOVE   ZAN-KOHI-T(KOH-IDX)   TO
                                          LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"     
                          MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)           
                                            TO WK-TOKUTEI-COMPFTN3      
                     END-IF         
               ELSE
                     IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"     
                     AND  FLG-KOUGAKUCYO               =        1
                          MOVE    ZERO      TO FLG-KOUGAKUCYO
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"     
                     AND  FLG-KOUGAKUCYO3              =        1
                          MOVE    ZERO      TO FLG-KOUGAKUCYO3
                     END-IF
               END-IF
               PERFORM   23072-KOHHI-HIKAKU-SEC
               COMPUTE   ZAN-KOHI-T(KOH-IDX)    =
                         ZAN-KOHI-T(KOH-IDX)    -
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)
               COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)     
               IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                             ZAN-KOHI-T(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             ZAN-KOHI-T(KOH-IDX)  /  10
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                             WK-FTN   *  10
               END-IF
               MOVE  WK-NYUSKJRYYKBN    TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               MOVE  WK-SHOKUJI-NISSU   TO LNK-SYU-SKJ-NISSU(KOH-IDX)
               MOVE  WK-SHOKUJI-RYOYOHI TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
               EVALUATE   WK-NYUSKJRYYKBN
                   WHEN   "1"
                   WHEN   "2"
                   WHEN   "4"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                           LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSU
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
                       IF   LNK-SYU-SKJ-FTNKBN(KOH-IDX)  =  "2"
                         IF    LNK-SYU-SKJ-FTN(KOH-IDX)   >
                                              ZAN-KOHI-T(KOH-IDX)
                            MOVE   ZAN-KOHI-T(KOH-IDX)   TO
                                        LNK-SYU-SKJ-FTN(KOH-IDX)
      *                                 LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                            MOVE   ZERO      TO  ZAN-KOHI-T(KOH-IDX)
                         ELSE
                            COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
                                     ZAN-KOHI-T(KOH-IDX)    -
                                     LNK-SYU-SKJ-FTN(KOH-IDX)
                         END-IF
                       END-IF
                       IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610"      )
                       AND (LNK-SYU-KOH-HKNNUM(KOH-IDX)
                                                  =  "024" OR "079")
                         IF    LNK-SYU-SKJ-FTN(KOH-IDX)   >
                                              ZAN-KOHI-SKJ(KOH-IDX)
                            MOVE   "6"  TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
                            MOVE   ZAN-KOHI-SKJ(KOH-IDX)   TO
                                        LNK-SYU-SKJ-FTN(KOH-IDX)
      *                                 LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                         END-IF
                       END-IF
                   WHEN   "3"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   WHEN   "5"
                       MOVE  WK-SHOKUJI-NISSUS
                                      TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                       MOVE  WK-SHOKUJI-RYOYOHIS
                                      TO   LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNS
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNL
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSUL
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
               END-EVALUATE
           ELSE
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "051"         ) OR
                  ( HKN-RECEFTNDSPKBN            =  "2"           ) OR
                  ( (LNK-SYU-SRYYMD(1:6)        >=  "200404"      ) AND
                    (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "015" OR "016") )
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN  TO  LNK-SYU-SYUCOMPFTN
                   END-IF
               END-IF
               IF  (( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "051"       ) OR
                    ( HKN-RECEFTNDSPKBN            =  "2"         ) OR
                    ( (LNK-SYU-SRYYMD(1:6)        >=  "200404"    ) AND
                      (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  
                                                    "015" OR "016") ))
               AND (  LNK-SYU-KOH-HKNNUM(1)        =  "027"          )
                   IF    WK-TOKUTEI-COMPFTN3   NOT =    ZERO            
                       MOVE   WK-TOKUTEI-COMPFTN3                       
                                            TO  LNK-SYU-KOH-COMPFTN(1)  
                   END-IF                                               
               END-IF                    
      *
      *        特殊計算（限度を超えた場合、患者負担発生（全額））
      *********（福島県）
               IF ((WK-1001-PREFNUM             =  07      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "245"    ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200412" ))
               OR ((WK-1001-PREFNUM             =  07      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "246"    ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200604" ))
               OR ((WK-1001-PREFNUM             =  11      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "181" OR
                                                  "182" OR
                                                  "183" OR
                                                  "281"    ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200704" ))
               OR ((WK-1001-PREFNUM             =  11      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "543"    ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200710" ))
               OR ((WK-1001-PREFNUM             =  11      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "381"    ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200801" ))
               OR ((WK-1001-PREFNUM             =  11           ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "743" OR "442"
                                                        OR "542") AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200804"      ))
                  PERFORM   23076-TOKUSYU-SANTEI-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *        特殊計算（限度を超えた場合、患者負担発生（超えた額））
      *********（岡山県）
      *********（東京都）
               IF ((WK-1001-PREFNUM             =  33      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "285"    ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200110" ) AND
                   (LNK-SYU-SRYYMD(1:6)        <= "200609" ))
               OR ((WK-1001-PREFNUM             =  13      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "182"    ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200610" ))
                  PERFORM   23077-TOKUSYU-SANTEI2-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *        特殊計算（２割又は３割の額を算出後、半額を患者負担とする）
      *********（秋田県）
               IF  (WK-1001-PREFNUM             =  05             ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "374" OR "474"  ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200508" )
                  PERFORM   23078-TOKUSYU-SANTEI3-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *        特殊計算（長期の計算）
               IF  (LNK-SYU-SRYYMD(1:6)        >= "200804"      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "972" OR "974")
                  PERFORM   23079-TOKUSYU-SANTEI4-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      **
      ***      IF    LNK-SYU-SYUCOMPFTN-ENTANI   NOT =    ZERO          
               IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                       IF    LNK-SYU-SYUCOMPFTN-ENTANI
                                                 >  ZAN-KOHI-T3(KOH-IDX)
                           MOVE   ZAN-KOHI-T3(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       ELSE
                           MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
               ELSE
      ***        IF    LNK-SYU-KOH-COMPFTN-ENTANI(1)   NOT =    ZERO
                 IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                       IF    LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                 >  ZAN-KOHI-T3(KOH-IDX)
                           MOVE   ZAN-KOHI-T3(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       ELSE
                           MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                 ELSE
                       IF    WK-ZENGAKU   >  ZAN-KOHI-T3(KOH-IDX)
                           MOVE   ZAN-KOHI-T3(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       ELSE
                           MOVE   WK-ZENGAKU
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                 END-IF
               END-IF                                                   
               PERFORM    23075-KOHHI-HIKAKU4-SEC                             
      **
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "051"         ) OR
                  ( HKN-RECEFTNDSPKBN            =  "2"           ) OR
                  ( (LNK-SYU-SRYYMD(1:6)        >=  "200404"      ) AND
                    (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "015" OR "016") )
      ***       IF    LNK-SYU-SYUCOMPFTN   NOT =    ZERO
                IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                       IF   LNK-SYU-SYUCOMPFTN   >  ZAN-KOHI-T2(KOH-IDX)
                           MOVE   ZAN-KOHI-T2(KOH-IDX)
                                            TO  WK-KOH-COMPFTN(KOH-IDX)
                           PERFORM    23073-KOHHI-HIKAKU2-SEC
                       ELSE
                           MOVE  LNK-SYU-SYUCOMPFTN
                                            TO  WK-KOH-COMPFTN(KOH-IDX)
                           PERFORM    23073-KOHHI-HIKAKU2-SEC
                       END-IF
                ELSE
      ***        IF    LNK-SYU-KOH-COMPFTN(1)   NOT =    ZERO
                 IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                       IF    LNK-SYU-KOH-COMPFTN(1)
                                     >    ZAN-KOHI-T2(KOH-IDX)
                          MOVE   ZAN-KOHI-T2(KOH-IDX)
                                       TO  WK-KOH-COMPFTN(KOH-IDX)
                          PERFORM    23073-KOHHI-HIKAKU2-SEC
                       ELSE
                          MOVE   LNK-SYU-KOH-COMPFTN(1)
                                       TO  WK-KOH-COMPFTN(KOH-IDX)
                          PERFORM    23073-KOHHI-HIKAKU2-SEC
                       END-IF
                 ELSE
                       IF    WK-ZENGAKU   >    ZAN-KOHI-T2(KOH-IDX)
                          MOVE   ZAN-KOHI-T2(KOH-IDX)
                                       TO  WK-KOH-COMPFTN(KOH-IDX)
                          PERFORM    23073-KOHHI-HIKAKU2-SEC
                       ELSE
                          MOVE   WK-ZENGAKU   
                                       TO  WK-KOH-COMPFTN(KOH-IDX)
                          PERFORM    23073-KOHHI-HIKAKU2-SEC
                       END-IF
                 END-IF
                END-IF
               END-IF                                                   
      **
      ***      IF    LNK-SYU-SYUCOMPFTN   NOT =    ZERO
               IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                       IF   LNK-SYU-SYUCOMPFTN   >  ZAN-KOHI-T(KOH-IDX)
                           MOVE   ZAN-KOHI-T(KOH-IDX)
                                            TO  LNK-SYU-KOH-COMPFTN
                                                         (KOH-IDX)
                       ELSE
                           MOVE  LNK-SYU-SYUCOMPFTN
                                            TO  LNK-SYU-KOH-COMPFTN
                                                         (KOH-IDX)
                       END-IF
               ELSE
      ***        IF    LNK-SYU-KOH-COMPFTN(1)   NOT =    ZERO
                 IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                       IF    LNK-SYU-KOH-COMPFTN(1)
                                     >    ZAN-KOHI-T(KOH-IDX)
                          MOVE   ZAN-KOHI-T(KOH-IDX)
                                       TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       ELSE
                          MOVE   LNK-SYU-KOH-COMPFTN(1)
                                              TO  LNK-SYU-KOH-COMPFTN
                                                            (KOH-IDX)
                       END-IF
                 ELSE
                       IF    WK-ZENGAKU   >    ZAN-KOHI-T(KOH-IDX)
                          MOVE   ZAN-KOHI-T(KOH-IDX)
                                       TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       ELSE
                          MOVE   WK-ZENGAKU   TO  LNK-SYU-KOH-COMPFTN
                                                            (KOH-IDX)
                       END-IF
                 END-IF
               END-IF
               PERFORM   23072-KOHHI-HIKAKU-SEC
      *
               IF  (  FLG-ZENKI-TOKUREI           =   1             )
               AND (( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          )
                 OR ((WK-1001-PREFNUM             =  13           ) AND
                     (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "151" OR "451")))
      **>        OR ((WK-1001-PREFNUM             =  28           ) AND
      **>            (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "186"         )))
                  COMPUTE  WK-ZENKI-TOKUREI-MONEY
                                   =  WK-ZENGAKU  *  0.2
                  IF   WK-ZENKI-TOKUREI-MONEY  <  ZAN-KOHI-T(KOH-IDX)
                    COMPUTE   ZAN-KOHI-T(KOH-IDX)  =
                              ZAN-KOHI-T(KOH-IDX)  -
                              WK-ZENKI-TOKUREI-MONEY
                  ELSE
                    MOVE      ZERO   TO   ZAN-KOHI-T(KOH-IDX)
                  END-IF
               ELSE
                  COMPUTE   ZAN-KOHI-T(KOH-IDX)  =
                            ZAN-KOHI-T(KOH-IDX)  -
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
      *
               IF   (LNK-SYU-KOH-HKNNUM(KOH-IDX)     =  "011")
               AND  (WK-TAIHI-NYUJGNGAK(KOH-IDX) NOT =   ZERO)
               AND  (ZAN-KOHI-T(KOH-IDX)             =   ZERO)
                  MOVE     1    TO    WK-TAIHI-KANSEN11(KOH-IDX)
               END-IF
               COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)     
               IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                             ZAN-KOHI-T(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             ZAN-KOHI-T(KOH-IDX)  /  10
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                             WK-FTN   *  10
               END-IF
               MOVE  WK-NYUSKJRYYKBN    TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               MOVE  WK-SHOKUJI-NISSU   TO LNK-SYU-SKJ-NISSU(KOH-IDX)
               MOVE  WK-SHOKUJI-RYOYOHI TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
               EVALUATE   WK-NYUSKJRYYKBN
                   WHEN   "1"
                   WHEN   "2"
                   WHEN   "4"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                           LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSU
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
                       IF   LNK-SYU-SKJ-FTNKBN(KOH-IDX)  =  "2"
                         IF    LNK-SYU-SKJ-FTN(KOH-IDX)   >
                                              ZAN-KOHI-T(KOH-IDX)
                            MOVE   ZAN-KOHI-T(KOH-IDX)   TO
                                        LNK-SYU-SKJ-FTN(KOH-IDX)
      *                                 LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                            MOVE   ZERO      TO  ZAN-KOHI-T(KOH-IDX)
                         ELSE
                            COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
                                     ZAN-KOHI-T(KOH-IDX)    -
                                     LNK-SYU-SKJ-FTN(KOH-IDX)
                         END-IF
                       END-IF
                   WHEN   "3"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   WHEN   "5"
                       MOVE  WK-SHOKUJI-NISSUS
                                      TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                       MOVE  WK-SHOKUJI-RYOYOHIS
                                      TO   LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNS
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNL
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSUL
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
               END-EVALUATE
           END-IF.
      *
       2307-KOH-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費の患者負担金額計算（上限額なし）                  *
      ******************************************************************
       2308-KOH-KEISAN2-SEC           SECTION.
      *
      *    負担金額の計算
           IF  WK-NYUKFTNRATE     NOT =    ZERO
      *
               IF   WK-DAY-NYUKFTNRATE  =  ZERO
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE
               ELSE
                 IF  WK-DAY-NYUKFTNRATE  > WK-NYUKFTNRATE
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE
                 END-IF
               END-IF
      *
               COMPUTE   WK-FUTANWARI  =
                              WK-NYUKFTNRATE  /  100
               IF    WK-KOH-FTNKBN   NOT =  SPACE
                 EVALUATE  WK-KOH-FTNKBN
                    WHEN  "1"
                      COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                      COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                    WHEN  "2"
                      MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                      MOVE    ZERO   TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                      MOVE    ZERO   TO   LNK-SYU-KYUFUGAI-SHOSHIN-TEN
                                          LNK-SYU-KYUFUGAI-SIDOU-TEN
                                          LNK-SYU-KYUFUGAI-OSIN1-TEN
                                          LNK-SYU-KYUFUGAI-OSIN2-TEN
                                          LNK-SYU-KYUFUGAI-OSIN3-TEN
                                          LNK-SYU-KYUFUGAI-GOKEI-TEN
                 END-EVALUATE
               ELSE
                 COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
                 COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
                 IF  (WK-1001-PREFNUM             =  01           )
                 AND (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "642" OR "643"
                                                 OR "644" OR "743")
                 AND (LNK-S02-SYOSINFLG       NOT =  SPACE        )
                     IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)         <   580
                        MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                        COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                                 LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                                 580
                     END-IF
                     IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <   580
                        MOVE  ZERO  TO
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     ELSE
                        COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                                 580
                     END-IF
                 END-IF
               END-IF
      *
      *        IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)       =  "027"
               IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0"
      *             減額
                    EVALUATE  WK-GENGAKUKBN
                      WHEN        1
                        IF  WK-GENGAKU-RITU = 100
                         MOVE  ZERO  TO  WK-GENGAKU-GAK
                         MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                        ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  WK-GENGAKU-GAK               =
                                  LNK-SYU-KOH-COMPFTN(KOH-IDX) *
                                  WK-GENGAKU-RITUX             /
                                  100
                         COMPUTE  WK-GENGAKU-GAK-ENTANI               =
                                  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) *
                                  WK-GENGAKU-RITUX                    /
                                  100
                        END-IF
                      WHEN        2
                        CONTINUE
                      WHEN        3
                      WHEN        4
                        MOVE  ZERO  TO  WK-GENGAKU-GAK
                        MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                    END-EVALUATE
                    IF  WK-GENGAKUKBN  NOT =  ZERO
                        MOVE  WK-GENGAKU-GAK
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  WK-GENGAKU-GAK-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                    END-IF
                    IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "027"
                        MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)                 
                                            TO WK-TOKUTEI-COMPFTN3      
                    END-IF
               END-IF                
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "051"         ) OR
                  ( HKN-RECEFTNDSPKBN            =  "2"           ) OR
                  ( (LNK-SYU-SRYYMD(1:6)        >=  "200404"      ) AND
                    (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "015" OR "016") )
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN
                                        TO  LNK-SYU-SYUCOMPFTN
                   END-IF
                   IF    LNK-SYU-KOH-HKNNUM(1)    =    "027"
                     IF  WK-TOKUTEI-COMPFTN3  NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN3
                                        TO  LNK-SYU-KOH-COMPFTN(1)
                     END-IF
                   END-IF
               ELSE
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  /  10
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =  WK-FTN
                                                              *  10
               END-IF
           ELSE
               IF  ((WK-1001-PREFNUM         =  43           ) AND
                    (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342"))
               OR  ((WK-1001-PREFNUM         =  13           ) AND
                    (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
                    (LNK-SYU-SRYYMD(1:6)    >= "200710"      ))
      *
                 IF (WK-1001-PREFNUM         =  43           ) AND
                    (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342")
                   MOVE    "1"   TO    FLG-KUMAMOTO
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   PERFORM   23081-KUMAMOTO-KOHI-SEC
                 END-IF
                 IF (WK-1001-PREFNUM         =  13           ) AND
                    (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
                    (LNK-SYU-SRYYMD(1:6)    >= "200710"      )
                   PERFORM   23082-TOKYO-KOHI-SEC
                 END-IF
      *
               END-IF
           END-IF.
           PERFORM    23075-KOHHI-HIKAKU4-SEC.                                
           PERFORM    23072-KOHHI-HIKAKU-SEC.
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX).     
           MOVE  WK-NYUSKJRYYKBN    TO  LNK-SYU-SKJ-FTNKBN(KOH-IDX)
           MOVE  WK-SHOKUJI-NISSU   TO  LNK-SYU-SKJ-NISSU(KOH-IDX)
           MOVE  WK-SHOKUJI-RYOYOHI TO  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
           EVALUATE   WK-NYUSKJRYYKBN
                   WHEN   "1"
                   WHEN   "2"
                   WHEN   "4"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                           LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       IF   FLG-NYUSKJJYOGAK   NOT =  ZERO
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)  NOT = ZERO
                             COMPUTE LNK-SYU-SKJ-FTN(KOH-IDX) =
                                     LNK-SYU-SKJ-FTN(KOH-IDX) /  2
                          END-IF
                          IF   FLG-MIYAGI  NOT  =   ZERO
                            IF   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                                                         NOT = ZERO
                             COMPUTE LNK-SYU-SKJ-FTN-RECE(KOH-IDX) =
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX) /  2
                            END-IF
                          END-IF
                       ELSE
                        IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSU
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                          IF   FLG-MIYAGI  NOT  =   ZERO
                            IF   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN-RECE(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN-RECE(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                            ELSE
                             MOVE   ZERO   TO
                                      LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                            END-IF
                          END-IF
                        END-IF
                       END-IF
                       IF   LNK-SYU-SKJ-FTNKBN(KOH-IDX)  =  "2"
                         IF    LNK-SYU-SKJ-FTN(KOH-IDX)   >
                                              ZAN-KOHI-T(KOH-IDX)
                            MOVE   ZAN-KOHI-T(KOH-IDX)   TO
                                        LNK-SYU-SKJ-FTN(KOH-IDX)
                            MOVE   ZERO      TO  ZAN-KOHI-T(KOH-IDX)
                         ELSE
                            COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
                                     ZAN-KOHI-T(KOH-IDX)    -
                                     LNK-SYU-SKJ-FTN(KOH-IDX)
                         END-IF
                       END-IF
                   WHEN   "3"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   WHEN   "5"
                       MOVE  WK-SHOKUJI-NISSUS
                                      TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                       MOVE  WK-SHOKUJI-RYOYOHIS
                                      TO   LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNS
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNL
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSUL
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
           END-EVALUATE.
      *     
       2308-KOH-KEISAN2-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費単位で計算した患者負担金を比較
      ******************************************************************
       23072-KOHHI-HIKAKU-SEC           SECTION.
      *
           IF    LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974"
             IF  LNK-SYU-KOH-HKNNUM(1)       =  "027"
               IF  LNK-SYU-KOH-COMPFTN(1) < LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   MOVE  LNK-SYU-KOH-COMPFTN(1)
                                        TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
             END-IF
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN(1) < LNK-SYU-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  LNK-SYU-KOH-COMPFTN(2)
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN(2) < LNK-SYU-KOH-COMPFTN(3)
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  LNK-SYU-KOH-COMPFTN(3)
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN(3) < LNK-SYU-KOH-COMPFTN(4)
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  LNK-SYU-KOH-COMPFTN(4)
                   END-IF
             END-EVALUATE
           END-IF.
      *
           IF    WK-SYOFUKUMU-FLG(KOH-IDX)  NOT =  ZERO
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                     WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                 IF   (WK-SYOFUKUMU-FLG(KOH-IDX)        =   1 OR 2 )
                 AND  (LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1) =  "0"     )
                    COMPUTE  LNK-SYU-SKJ-FTNGAKU(1)       =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                             WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                    COMPUTE  LNK-SYU-SKJ-FTNGAKU(1) =
                             LNK-SYU-SKJ-FTNGAKU(1) +    5
                    COMPUTE  LNK-SYU-SKJ-FTNGAKU(1) =
                             LNK-SYU-SKJ-FTNGAKU(1) /   10
                    COMPUTE  LNK-SYU-SKJ-FTNGAKU(1) =
                             LNK-SYU-SKJ-FTNGAKU(1) *   10
                 END-IF
                 MOVE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF.
      *
       23072-KOHHI-HIKAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費単位で計算した患者負担金を比較
      *        （レセ記載金額退避用エリア用）
      ******************************************************************
       23073-KOHHI-HIKAKU2-SEC           SECTION.                             
      *
           IF    LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974"
             IF  LNK-SYU-KOH-HKNNUM(1)       =  "027"
               IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                 IF  LNK-SYU-KOH-COMPFTN(1) < WK-KOH-COMPFTN(KOH-IDX)
                     MOVE  LNK-SYU-KOH-COMPFTN(1)
                                          TO  WK-KOH-COMPFTN(KOH-IDX)
                 END-IF
               ELSE
                 IF  WK-KOH-COMPFTN(1)      < WK-KOH-COMPFTN(KOH-IDX)
                     MOVE  WK-KOH-COMPFTN(1)
                                          TO  WK-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
             END-IF
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                 IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-KOH-COMPFTN(2)
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(1)      < WK-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  WK-KOH-COMPFTN(1)
                                            TO  WK-KOH-COMPFTN(2)
                   END-IF
                 END-IF
               WHEN    3
                 IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-KOH-COMPFTN(3)
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-KOH-COMPFTN(3)
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(2)      < WK-KOH-COMPFTN(3)
                       MOVE  WK-KOH-COMPFTN(2)
                                            TO  WK-KOH-COMPFTN(3)
                   END-IF
                 END-IF
               WHEN    4
                 IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-KOH-COMPFTN(4)
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-KOH-COMPFTN(4)
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(3)      < WK-KOH-COMPFTN(4)
                       MOVE  WK-KOH-COMPFTN(3)
                                            TO  WK-KOH-COMPFTN(4)
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF.
      *
           IF    WK-SYOFUKUMU-FLG(KOH-IDX)  NOT =  ZERO
             IF  WK-KOH-COMPFTN(KOH-IDX)       >
                                     WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                 MOVE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF.
      *
       23073-KOHHI-HIKAKU2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        公費単位で計算した患者負担金を比較
      *        （レセ記載金額退避用エリア用）（日単位）
      ******************************************************************
       23074-KOHHI-HIKAKU3-SEC           SECTION.
      *
           EVALUATE    KOH-IDX
               WHEN    2
                 IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                  IF  WK-DAY-KOH-COMPFTN(1)  =  ALL"9"
                    IF  LNK-SYU-KOH-COMPFTN(1) < WK-DAY-KOH-COMPFTN(2)
                    AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                        MOVE  LNK-SYU-KOH-COMPFTN(1)
                                             TO  WK-DAY-KOH-COMPFTN(2)
                    END-IF
                  ELSE
                    IF  WK-DAY-KOH-COMPFTN(1)  < WK-DAY-KOH-COMPFTN(2)
                    AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                        MOVE  WK-DAY-KOH-COMPFTN(1)
                                             TO  WK-DAY-KOH-COMPFTN(2)
                    END-IF
                  END-IF
                 ELSE
                  IF  WK-DAY-KOH-COMPFTN(1)  =  ALL"9"
                    IF  WK-KOH-COMPFTN(1)      < WK-DAY-KOH-COMPFTN(2)
                    AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                        MOVE  WK-KOH-COMPFTN(1)
                                             TO  WK-DAY-KOH-COMPFTN(2)
                    END-IF
                  ELSE
                    IF  WK-DAY-KOH-COMPFTN(1)  < WK-DAY-KOH-COMPFTN(2)
                    AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                        MOVE  WK-DAY-KOH-COMPFTN(1)
                                             TO  WK-DAY-KOH-COMPFTN(2)
                    END-IF
                  END-IF
                 END-IF
               WHEN    3
                 IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                  IF  WK-DAY-KOH-COMPFTN(2)  =  ALL"9"
                    IF  LNK-SYU-KOH-COMPFTN(2) < WK-DAY-KOH-COMPFTN(3)
                    AND LNK-SYU-KOH2HKNNUM   NOT =  SPACE
                        MOVE  LNK-SYU-KOH-COMPFTN(2)
                                             TO  WK-DAY-KOH-COMPFTN(3)
                    END-IF
                  ELSE
                    IF  WK-DAY-KOH-COMPFTN(2)  < WK-DAY-KOH-COMPFTN(3)
                    AND LNK-SYU-KOH2HKNNUM   NOT =  SPACE
                        MOVE  WK-DAY-KOH-COMPFTN(2)
                                             TO  WK-DAY-KOH-COMPFTN(3)
                    END-IF
                  END-IF
                 ELSE
                  IF  WK-DAY-KOH-COMPFTN(2)  =  ALL"9"
                    IF  WK-KOH-COMPFTN(2)      < WK-DAY-KOH-COMPFTN(3)
                    AND LNK-SYU-KOH2HKNNUM   NOT =  SPACE
                        MOVE  WK-KOH-COMPFTN(2)
                                             TO  WK-DAY-KOH-COMPFTN(3)
                    END-IF
                  ELSE
                    IF  WK-DAY-KOH-COMPFTN(2)  < WK-DAY-KOH-COMPFTN(3)
                    AND LNK-SYU-KOH2HKNNUM   NOT =  SPACE
                        MOVE  WK-DAY-KOH-COMPFTN(2)
                                             TO  WK-DAY-KOH-COMPFTN(3)
                    END-IF
                  END-IF
                 END-IF
               WHEN    4
                 IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                  IF  WK-DAY-KOH-COMPFTN(3)  =  ALL"9"
                    IF  LNK-SYU-KOH-COMPFTN(3) < WK-DAY-KOH-COMPFTN(4)
                    AND LNK-SYU-KOH3HKNNUM   NOT =  SPACE
                        MOVE  LNK-SYU-KOH-COMPFTN(3)
                                             TO  WK-DAY-KOH-COMPFTN(4)
                    END-IF
                  ELSE
                    IF  WK-DAY-KOH-COMPFTN(3)  < WK-DAY-KOH-COMPFTN(4)
                    AND LNK-SYU-KOH3HKNNUM   NOT =  SPACE
                        MOVE  WK-DAY-KOH-COMPFTN(3)
                                             TO  WK-DAY-KOH-COMPFTN(4)
                    END-IF
                  END-IF
                 ELSE
                  IF  WK-DAY-KOH-COMPFTN(3)  =  ALL"9"
                    IF  WK-KOH-COMPFTN(3)      < WK-DAY-KOH-COMPFTN(4)
                    AND LNK-SYU-KOH3HKNNUM   NOT =  SPACE
                        MOVE  WK-KOH-COMPFTN(3)
                                             TO  WK-DAY-KOH-COMPFTN(4)
                    END-IF
                  ELSE
                    IF  WK-DAY-KOH-COMPFTN(3)  < WK-DAY-KOH-COMPFTN(4)
                    AND LNK-SYU-KOH3HKNNUM   NOT =  SPACE
                        MOVE  WK-DAY-KOH-COMPFTN(3)
                                             TO  WK-DAY-KOH-COMPFTN(4)
                    END-IF
                  END-IF
                 END-IF
           END-EVALUATE.
      *
       23074-KOHHI-HIKAKU3-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        公費単位で計算した患者負担金を比較
      *        （円単位）
      ******************************************************************
       23075-KOHHI-HIKAKU4-SEC           SECTION.                             
      *
           IF    LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974"
             IF  LNK-SYU-KOH-HKNNUM(1)       =  "027"
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                               <     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
             END-IF
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                   <     LNK-SYU-KOH-COMPFTN-ENTANI(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                   <     LNK-SYU-KOH-COMPFTN-ENTANI(3)
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                   <     LNK-SYU-KOH-COMPFTN-ENTANI(4)
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                   END-IF
             END-EVALUATE
           END-IF.
      *
           IF    WK-SYOFUKUMU-FLG(KOH-IDX)  NOT =  ZERO
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  >
                                     WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                 MOVE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
           END-IF.
      *
       23075-KOHHI-HIKAKU4-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        日別収納算定
      ******************************************************************
       23071-DAYINF-SANTEI-SEC           SECTION.
      *
           MOVE       ZERO        TO       FLG-HIKOTEI.
           IF      WK-1001-PREFNUM       =   15
              IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =
                      "161" OR "261" OR "361" OR "461" OR "561" OR
                      "163" OR "263" OR "165" OR "265" OR
                      "190" OR "290" OR
                      "164" OR "264" OR "364" OR "464" OR "564"
                 MOVE         1      TO      FLG-HIKOTEI
              END-IF
           END-IF.
      *
           MOVE       ZERO        TO       FLG-TUKIHIKAKU.
           EVALUATE     KOH-IDX
              WHEN        1
                  IF    MAX-KIN-KOHI1-M     NOT  = ZERO
                      MOVE     1     TO     FLG-TUKIHIKAKU
                  END-IF
              WHEN        2
                  IF    MAX-KIN-KOHI2-M     NOT  = ZERO
                      MOVE     1     TO     FLG-TUKIHIKAKU
                  END-IF
              WHEN        3
                  IF    MAX-KIN-KOHI3-M     NOT  = ZERO
                      MOVE     1     TO     FLG-TUKIHIKAKU
                  END-IF
              WHEN        4
                  IF    MAX-KIN-KOHI4-M     NOT  = ZERO
                      MOVE     1     TO     FLG-TUKIHIKAKU
                  END-IF
           END-EVALUATE.
      *
           MOVE    "1"    TO   LNK-SDAY-DAYINFFLG.
      *
           MOVE    ZERO   TO   WK-DAY-KOH-COMPFTN(KOH-IDX).
      *
           IF  WK-NYUKFTNRATE    NOT =  ZERO
              IF       WK-DAY-NYUKFTNRATE  =  ZERO
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE
              ELSE
                 IF  WK-DAY-NYUKFTNRATE  > WK-NYUKFTNRATE
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE
                 END-IF
              END-IF
           END-IF.
      *
           COMPUTE   WK-FUTANWARI  =
                                WK-DAY-NYUKFTNRATE  /  100.
      *
           PERFORM    VARYING   IDX2   FROM   1   BY   1
                         UNTIL    IDX2     >    31
      *
               IF    KOHI-TBL(IDX2 KOH-IDX)  =   9
      *
                 MOVE   99999    TO   WK-DAY-COMPFTN
      *
                 MOVE      1     TO    LNK-SDAY-SANTEIFLG(IDX2 KOH-IDX)
      *
                 MOVE   ZERO     TO    WK-TAIHI-SDAY-COMPFTN
                                       WK-TAIHI-SDAY-COMPFTNWK
                                       WK-TAIHI-SDAY-FTNMONEY
      *
                 IF     WK-DAY-NYUKFTNRATE    NOT =    ZERO
                    COMPUTE   WK-TAIHI-SDAY-COMPFTN =
                              LNK-SDAY-HKNTEN(IDX2) *
                              HKN-TENTNK            *
                              WK-FUTANWARI
                    COMPUTE   WK-TAIHI-SDAY-COMPFTNWK =
                             (LNK-SDAY-HKNTEN(IDX2)   *
                              HKN-TENTNK              *
                              WK-FUTANWARI         )  + 0.9
                 ELSE
                    COMPUTE   WK-TAIHI-SDAY-COMPFTN =
                              LNK-SDAY-HKNTEN(IDX2) *
                              HKN-TENTNK
                    COMPUTE   WK-TAIHI-SDAY-COMPFTNWK  =
                              LNK-SDAY-HKNTEN(IDX2)    *
                              HKN-TENTNK
                 END-IF
                 IF   ((KOH-IDX                =   1    ) AND
                       (LNK-SYU-SYUHKNNUM  NOT =   SPACE) AND
                       (LNK-SYU-SYUCOMPFTN     =   ZERO ))
                 OR   ((KOH-IDX                >   1    ) AND
                       (LNK-SYU-KOH-HKNNUM(KOH-IDX - 1)
                                           NOT =   SPACE) AND
                       (LNK-SYU-KOH-COMPFTN(KOH-IDX - 1)
                                               =   ZERO ))
                 OR   ((KOH-IDX                >   1    ) AND
                       (LNK-SYU-SYUHKNNUM  NOT =   SPACE) AND
                       (LNK-SYU-KOH-HKNNUM(1)
                                           NOT =   "027") AND
                       (LNK-SYU-SYUCOMPFTN     =   ZERO ))
                       MOVE   ZERO   TO  WK-TAIHI-SDAY-COMPFTN
                                         WK-TAIHI-SDAY-COMPFTNWK
                 END-IF
      *
                 IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "051"       ) OR
                    ( HKN-RECEFTNDSPKBN            =  "2"         ) OR
                    ( (LNK-SYU-SRYYMD(1:6)        >=  "200404"    ) AND
                      (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  
                                                  "015" OR "016"  ) )
                     MOVE  "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                     IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                         MOVE  WK-TOKUTEI-COMPFTN
                                           TO  LNK-SYU-SYUCOMPFTN
                     END-IF
                     IF    LNK-SYU-KOH-HKNNUM(1)    =    "027"
                       IF  WK-TOKUTEI-COMPFTN3  NOT =    ZERO
                         MOVE  WK-TOKUTEI-COMPFTN3
                                           TO  LNK-SYU-KOH-COMPFTN(1)
                       END-IF
                     END-IF
                 ELSE
                     COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                               WK-TAIHI-SDAY-COMPFTN  +  5
                     COMPUTE   WK-FTN      =
                               WK-TAIHI-SDAY-COMPFTN  / 10
                     COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                               WK-FTN   *  10
                 END-IF
      *
                 IF      WK-TAIHI-SDAY-COMPFTNWK
                                          >   ZAN-KOHI-D3(IDX2 KOH-IDX)
                       MOVE   ZAN-KOHI-D3(IDX2 KOH-IDX)  TO
                                       WK-TAIHI-SDAY-COMPFTNWK
                 END-IF
      *
                 IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "051"       ) OR
                    ( HKN-RECEFTNDSPKBN            =  "2"         ) OR
                    ( (LNK-SYU-SRYYMD(1:6)        >=  "200404"    ) AND
                      (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  
                                                  "015" OR "016"  ) )
                   IF    WK-TAIHI-SDAY-COMPFTN
                                          >   ZAN-KOHI-D2(IDX2 KOH-IDX)
                       MOVE   ZAN-KOHI-D2(IDX2 KOH-IDX)  TO
                                     WK-DAY-COMPFTN
                   END-IF
                 END-IF
      *
                 MOVE    ZAN-KOHI-D(IDX2 KOH-IDX)   TO   WK-ZAN-KOHI-D
      *
                 IF      WK-TAIHI-SDAY-COMPFTN
                                          >   ZAN-KOHI-D(IDX2 KOH-IDX)
                       MOVE   ZAN-KOHI-D(IDX2 KOH-IDX)   TO
                                    WK-TAIHI-SDAY-COMPFTN
                       MOVE   ZERO        TO  ZAN-KOHI-D(IDX2 KOH-IDX)
                 ELSE
                       COMPUTE  ZAN-KOHI-D(IDX2 KOH-IDX)    =
                                ZAN-KOHI-D(IDX2 KOH-IDX)    -
                                WK-TAIHI-SDAY-COMPFTN
                 END-IF
      *
                 IF    ZAN-KOHI-D(IDX2 KOH-IDX)   NOT =   ZERO
                     COMPUTE   ZAN-KOHI-D(IDX2 KOH-IDX) =
                               ZAN-KOHI-D(IDX2 KOH-IDX) +  5
                     COMPUTE   WK-FTN      =
                               ZAN-KOHI-D(IDX2 KOH-IDX) /  10
                     COMPUTE   ZAN-KOHI-D(IDX2 KOH-IDX) =
                               WK-FTN   *  10
                 END-IF
      *
                 IF   ( FLG-HIKOTEI            NOT =  ZERO )
                 AND  ( WK-TAIHI-SDAY-COMPFTN  NOT =  ZERO )
                    MOVE   ZAN-KOHI-D3(IDX2 KOH-IDX)  TO
                                 WK-TAIHI-SDAY-COMPFTNWK
                    MOVE   ZAN-KOHI-D2(IDX2 KOH-IDX)  TO
                                 WK-TAIHI-SDAY-COMPFTN
                    MOVE   WK-ZAN-KOHI-D              TO
                                 WK-TAIHI-SDAY-FTNMONEY
                    MOVE   ZERO        TO   ZAN-KOHI-D(IDX2 KOH-IDX)
                 ELSE
                    MOVE      WK-TAIHI-SDAY-COMPFTN
                                  TO   WK-TAIHI-SDAY-FTNMONEY
                    COMPUTE   WK-TAIHI-SDAY-FTNMONEY  =
                              WK-TAIHI-SDAY-FTNMONEY  +  5
                    COMPUTE   WK-FTN      =
                              WK-TAIHI-SDAY-FTNMONEY  / 10
                    COMPUTE   WK-TAIHI-SDAY-FTNMONEY  =
                              WK-FTN   *  10
      *
                    IF    WK-DAY-COMPFTN    =  ALL"9"
                          CONTINUE
                    ELSE
                          MOVE  WK-DAY-COMPFTN     TO   
                                     WK-TAIHI-SDAY-COMPFTN
                    END-IF
                 END-IF
      *
                 MOVE  WK-TAIHI-SDAY-COMPFTN  
                                   TO  LNK-SDAY-COMPFTN(IDX2 KOH-IDX)
                 MOVE  WK-TAIHI-SDAY-FTNMONEY
                                   TO  LNK-SDAY-FTNMONEY(IDX2 KOH-IDX)
                 MOVE  WK-TAIHI-SDAY-COMPFTNWK
                                   TO  LNK-SDAY-COMPFTNWK(IDX2 KOH-IDX)
      *
                 ADD   LNK-SDAY-COMPFTN(IDX2 KOH-IDX)  TO
                                 WK-DAY-KOH-COMPFTN(KOH-IDX)
      *
      *          収納項目
                 ADD   LNK-SDAY-FTNMONEY(IDX2 KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
                 ADD   LNK-SDAY-COMPFTNWK(IDX2 KOH-IDX)                 
                            TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
      *
               END-IF
      *
               EVALUATE   WK-NYUSKJRYYKBN
                     WHEN   "1"
                     WHEN   "2"
                     WHEN   "4"
                         MOVE  WK-DAY-SKJFTN(IDX2)
                                  TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      *
                         IF   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                           IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                            COMPUTE   WK-NYUSKJJYOGAK2  =
                                      WK-NYUSKJJYOGAK   *
                                      WK-DAY-KAISU(IDX2)
                            IF   WK-DAY-SKJFTN(IDX2)
                                              >   WK-NYUSKJJYOGAK2
                               COMPUTE   LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                                         LNK-SDAY-SKJFTN(IDX2 KOH-IDX) -
                                         WK-NYUSKJJYOGAK2
                            ELSE
                               MOVE   ZERO   TO   
                                         LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                            END-IF
                           END-IF
                         ELSE
                           IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                            IF   WK-DAY-SKJFTN(IDX2)
                                              >   WK-NYUSKJJYOGAK
                               COMPUTE   LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                                         LNK-SDAY-SKJFTN(IDX2 KOH-IDX) -
                                         WK-NYUSKJJYOGAK
                            ELSE
                               MOVE   ZERO   TO   
                                         LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                            END-IF
                           END-IF
                         END-IF
      ****               IF   WK-NYUSKJRYYKBN  =  "2"
      ****                 IF    LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      ****                               >   ZAN-KOHI-D(IDX2 KOH-IDX)
      ****                    MOVE   ZAN-KOHI-D(IDX2 KOH-IDX)   TO
      ****                             LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      ****                    MOVE   ZERO   TO  ZAN-KOHI-D(IDX2 KOH-IDX)
      ****                 ELSE
      ****                    COMPUTE  ZAN-KOHI-D(IDX2 KOH-IDX)   =
      ****                             ZAN-KOHI-D(IDX2 KOH-IDX)   -
      ****                             LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      ****                 END-IF
      ****               END-IF
      *                  収納項目
                         ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                                  TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                         ADD   WK-DAY-SKJFTN(IDX2)
                                  TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                     WHEN   "3"
      *                  収納項目
                         ADD   WK-DAY-SKJFTN(IDX2)
                                  TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                     WHEN   "5"
                         MOVE  WK-DAY-SKJFTNL(IDX2)
                                  TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                         IF    WK-NYUSKJJYOGAK  NOT =  ZERO
                            COMPUTE   WK-NYUSKJJYOGAK2  =
                                      WK-NYUSKJJYOGAK   *
                                      WK-DAY-KAISUL(IDX2)
                            IF   WK-DAY-SKJFTNL(IDX2)
                                              >   WK-NYUSKJJYOGAK2
                              COMPUTE  LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                                       LNK-SDAY-SKJFTN(IDX2 KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                            ELSE
                              MOVE   ZERO   TO
                                       LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                            END-IF
                         END-IF
      *                  収納項目
                         ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                                  TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                         ADD   WK-DAY-SKJFTNS(IDX2)
                                  TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
               END-EVALUATE
      *
           END-PERFORM.
      *
      *    収納項目
      *
           MOVE     "1"             TO   LNK-SYU-DAYINFFLG.
      *
           MOVE  WK-NYUSKJRYYKBN    TO LNK-SYU-SKJ-FTNKBN(KOH-IDX).
           MOVE  WK-SHOKUJI-NISSU   TO LNK-SYU-SKJ-NISSU(KOH-IDX).
           MOVE  WK-SHOKUJI-RYOYOHI TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX).
           IF    WK-NYUSKJRYYKBN    =    "5"
             MOVE WK-SHOKUJI-NISSUS   TO LNK-SYU-SKJ-NISSU(KOH-IDX)
             MOVE WK-SHOKUJI-RYOYOHIS TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
           END-IF.
      *
           IF      FLG-TUKIHIKAKU     NOT =    ZERO
                IF  ZAN-KOHI-T(KOH-IDX)   <
                                        LNK-SYU-KOH-COMPFTN(KOH-IDX)
                    MOVE  ZAN-KOHI-T(KOH-IDX)
                                 TO     LNK-SYU-KOH-COMPFTN(KOH-IDX)
                END-IF
                IF  ZAN-KOHI-T2(KOH-IDX)  <
                                         WK-DAY-KOH-COMPFTN(KOH-IDX)
                    MOVE  ZAN-KOHI-T2(KOH-IDX)
                                 TO      WK-DAY-KOH-COMPFTN(KOH-IDX)
                END-IF
                IF  ZAN-KOHI-T3(KOH-IDX)  <
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                    MOVE  ZAN-KOHI-T3(KOH-IDX)
                             TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                END-IF
           END-IF.
      *
           PERFORM    23072-KOHHI-HIKAKU-SEC.
           PERFORM    23074-KOHHI-HIKAKU3-SEC.
           PERFORM    23075-KOHHI-HIKAKU4-SEC.                                
      *
           IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) = ZERO
              PERFORM    VARYING   IDX2    FROM   1   BY   1
                          UNTIL    IDX2     >    31
                 MOVE   ZERO   TO   LNK-SDAY-SANTEIFLG(IDX2 KOH-IDX)
              END-PERFORM
           END-IF.
      *
           MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    TO LNK-SYU-KOH-COMPTOTAL(KOH-IDX).
      *
       23071-DAYINF-SANTEI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（限度を超えた場合、患者負担発生（全額））
      ******************************************************************
       23076-TOKUSYU-SANTEI-SEC           SECTION.
      *
      ***  IF    LNK-SYU-SYUCOMPFTN-ENTANI   NOT =    ZERO
      ***  OR    FLG-GENBUTU70               NOT =    ZERO
           IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                                 TO  WK-TAIHI-TOKU1
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI13
                          MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI23
                          MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI33
                          MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI43
                          MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF     WK-TAIHI-TOKU1   >=  ZAN-KOHI-T3(KOH-IDX)
                         MOVE   WK-TAIHI-TOKU1  TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     ELSE
                         MOVE   ZERO    TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     END-IF
                   ELSE
                     IF    LNK-SYU-SYUCOMPFTN-ENTANI
                                               >=  ZAN-KOHI-T3(KOH-IDX)
                         MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     ELSE
                         MOVE   ZERO    TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     END-IF
                   END-IF
                   PERFORM    23075-KOHHI-HIKAKU4-SEC
                   MOVE       LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                                 WK-TOKUSYU-ENTANI
      *
                   IF   KOH-IDX    >     1
                      IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >=  ZAN-KOHI-T3(KOH-IDX)
                          CONTINUE
                      ELSE
                          MOVE   ZERO   TO
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                      END-IF
                   END-IF
           ELSE
      ***      IF    LNK-SYU-KOH-COMPFTN-ENTANI(1)   NOT =    ZERO
               IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                   IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                         TO  WK-TAIHI-TOKU1
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI13
                          MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI23
                          MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI33
                          MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI43
                          MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF     WK-TAIHI-TOKU1  >=  ZAN-KOHI-T3(KOH-IDX)
                         MOVE   WK-TAIHI-TOKU1  TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     ELSE
                         MOVE  ZERO    TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     END-IF
                   ELSE
                     IF    LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                              >=  ZAN-KOHI-T3(KOH-IDX)
                        MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)  TO
                                  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     ELSE
                        MOVE   ZERO    TO
                                  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     END-IF
                   END-IF
                   PERFORM    23075-KOHHI-HIKAKU4-SEC
                   MOVE       LNK-SYU-KOH-COMPFTN-ENTANI(1)  TO
                                                  WK-TOKUSYU-ENTANI
      *
                   IF   KOH-IDX    >     1
                      IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >=  ZAN-KOHI-T3(KOH-IDX)
                          CONTINUE
                      ELSE
                          MOVE   ZERO   TO
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                      END-IF
                   END-IF
               ELSE
                   IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     MOVE   WK-ZENGAKU   TO   WK-TAIHI-TOKU1
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI13
                          MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI23
                          MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI33
                          MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU1    >   ZAN-KOHI43
                          MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU1
                        END-IF
                     END-IF
                     IF    WK-TAIHI-TOKU1    >=  ZAN-KOHI-T3(KOH-IDX)
                         MOVE   WK-TAIHI-TOKU1  TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     ELSE
                         MOVE   ZERO    TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     END-IF
                   ELSE
                     IF    WK-ZENGAKU   >=  ZAN-KOHI-T3(KOH-IDX)
                        MOVE   WK-ZENGAKU  TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     ELSE
                        MOVE   ZERO    TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     END-IF
                   END-IF
                   PERFORM    23075-KOHHI-HIKAKU4-SEC
                   MOVE       WK-ZENGAKU  TO      WK-TOKUSYU-ENTANI
      *
                   IF   KOH-IDX    >     1
                      IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >=  ZAN-KOHI-T3(KOH-IDX)
                          CONTINUE
                      ELSE
                          MOVE   ZERO   TO
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                      END-IF
                   END-IF
               END-IF
           END-IF
      **
           IF    HKN-RECEFTNDSPKBN      =  "2"
      ***     IF    LNK-SYU-SYUCOMPFTN   NOT =    ZERO
      ***     OR    FLG-GENBUTU70        NOT =    ZERO
              IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                    IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                      MOVE   LNK-SYU-SYUCOMPFTN  TO  WK-TAIHI-TOKU2
                      IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI12
                          MOVE   ZAN-KOHI12   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI22
                          MOVE   ZAN-KOHI22   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI32
                          MOVE   ZAN-KOHI32   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI42
                          MOVE   ZAN-KOHI42   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF  WK-TAIHI-TOKU2  >=  ZAN-KOHI-T2(KOH-IDX)
                         MOVE   WK-TAIHI-TOKU2  TO
                                           WK-KOH-COMPFTN(KOH-IDX)
                      ELSE
                         MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                      END-IF
                    ELSE
                      IF  LNK-SYU-SYUCOMPFTN  >=  ZAN-KOHI-T2(KOH-IDX)
                         MOVE   LNK-SYU-SYUCOMPFTN  TO
                                           WK-KOH-COMPFTN(KOH-IDX)
                      ELSE
                         MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                      END-IF
                    END-IF
                    PERFORM   23073-KOHHI-HIKAKU2-SEC
                    MOVE      LNK-SYU-SYUCOMPFTN  TO
                                         WK-TOKUSYU-COMPFTN2
      *
                    IF   KOH-IDX    >     1
                      IF WK-KOH-COMPFTN(KOH-IDX) >= ZAN-KOHI-T2(KOH-IDX)
                          CONTINUE
                      ELSE
                          MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                      END-IF
                    END-IF
              ELSE
      ***       IF  LNK-SYU-KOH-COMPFTN(1)   NOT =    ZERO
                IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                AND (LNK-SYU-KOH1HKNNUM        =   "027")
                    IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                      MOVE   LNK-SYU-KOH-COMPFTN(1)  TO  WK-TAIHI-TOKU2
                      IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI12
                          MOVE   ZAN-KOHI12   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI22
                          MOVE   ZAN-KOHI22   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI32
                          MOVE   ZAN-KOHI32   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI42
                          MOVE   ZAN-KOHI42   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF  WK-TAIHI-TOKU2  >=  ZAN-KOHI-T2(KOH-IDX)
                         MOVE   WK-TAIHI-TOKU2  TO
                                           WK-KOH-COMPFTN(KOH-IDX)
                      ELSE
                         MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                      END-IF
                    ELSE
                      IF  LNK-SYU-KOH-COMPFTN(1)
                                          >=  ZAN-KOHI-T2(KOH-IDX)
                         MOVE   LNK-SYU-KOH-COMPFTN(1)  TO
                                           WK-KOH-COMPFTN(KOH-IDX)
                      ELSE
                         MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                      END-IF
                    END-IF
                    PERFORM   23073-KOHHI-HIKAKU2-SEC
                    MOVE      LNK-SYU-KOH-COMPFTN(1)  TO
                                         WK-TOKUSYU-COMPFTN2
      *
                    IF   KOH-IDX    >     1
                      IF WK-KOH-COMPFTN(KOH-IDX) >= ZAN-KOHI-T2(KOH-IDX)
                          CONTINUE
                      ELSE
                          MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                      END-IF
                    END-IF
                ELSE
                    IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                      MOVE   WK-ZENGAKU  TO   WK-TAIHI-TOKU2
                      IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI12
                          MOVE   ZAN-KOHI12   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI22
                          MOVE   ZAN-KOHI22   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI32
                          MOVE   ZAN-KOHI32   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                        IF   WK-TAIHI-TOKU2    >   ZAN-KOHI42
                          MOVE   ZAN-KOHI42   TO  WK-TAIHI-TOKU2
                        END-IF
                      END-IF
                      IF  WK-TAIHI-TOKU2  >=  ZAN-KOHI-T2(KOH-IDX)
                         MOVE   WK-TAIHI-TOKU2  TO
                                           WK-KOH-COMPFTN(KOH-IDX)
                      ELSE
                         MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                      END-IF
                    ELSE
                      IF  WK-ZENGAKU    >=    ZAN-KOHI-T2(KOH-IDX)
                         MOVE   WK-ZENGAKU  TO
                                           WK-KOH-COMPFTN(KOH-IDX)
                      ELSE
                         MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                      END-IF
                    END-IF
                    PERFORM   23073-KOHHI-HIKAKU2-SEC
                    MOVE      WK-ZENGAKU  TO   WK-TOKUSYU-COMPFTN2
      *
                    IF   KOH-IDX    >     1
                      IF WK-KOH-COMPFTN(KOH-IDX) >= ZAN-KOHI-T2(KOH-IDX)
                          CONTINUE
                      ELSE
                          MOVE   ZERO   TO  WK-KOH-COMPFTN(KOH-IDX)
                      END-IF
                    END-IF
                END-IF
              END-IF
           END-IF
      **
      ***  IF    LNK-SYU-SYUCOMPFTN   NOT =    ZERO
      ***  OR    FLG-GENBUTU70        NOT =    ZERO
           IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  IF   FLG-KOUGAKUCYO-GEN70   =   1
                    MOVE  LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU
                  ELSE
                    COMPUTE  WK-TOKUSYU =  LNK-SYU-SYUCOMPFTN  +   5
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU          /  10
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU          *  10
                  END-IF
      *
                  IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI1
                          MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI2
                          MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI3
                          MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI4
                          MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                         MOVE   WK-TOKUSYU          TO
                                           LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                         MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                  ELSE
                     IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                         MOVE   LNK-SYU-SYUCOMPFTN  TO
                                           LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                         MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                  END-IF
                  PERFORM    23072-KOHHI-HIKAKU-SEC
                  MOVE       LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU-COMPFTN
      *
                  IF   KOH-IDX    >     1
                      COMPUTE  WK-TOKUSYU =
                                  LNK-SYU-KOH-COMPFTN(KOH-IDX)  +    5
                      COMPUTE  WK-TOKUSYU  =
                                  WK-TOKUSYU                    /   10
                      COMPUTE  WK-TOKUSYU  =
                                  WK-TOKUSYU                    *   10
                      IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                          CONTINUE
                      ELSE
                          MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                      END-IF
                  END-IF
           ELSE
      ***     IF  LNK-SYU-KOH-COMPFTN(1)   NOT =    ZERO
              IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND (LNK-SYU-KOH1HKNNUM        =   "027")
                  COMPUTE  WK-TOKUSYU =
                                    LNK-SYU-KOH-COMPFTN(1) +    5
                  COMPUTE  WK-TOKUSYU  =
                                    WK-TOKUSYU             /   10
                  COMPUTE  WK-TOKUSYU  =
                                    WK-TOKUSYU             *   10
      *
                  IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI1
                          MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI2
                          MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI3
                          MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI4
                          MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF  WK-TOKUSYU  >=  ZAN-KOHI-T(KOH-IDX)
                         MOVE   WK-TOKUSYU          TO
                                           LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                         MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                  ELSE
                     IF  WK-TOKUSYU  >=  ZAN-KOHI-T(KOH-IDX)
                         MOVE   LNK-SYU-KOH-COMPFTN(1)  TO
                                           LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                         MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                  END-IF
                  PERFORM    23072-KOHHI-HIKAKU-SEC
                  MOVE       LNK-SYU-KOH-COMPFTN(1)  TO
                                        WK-TOKUSYU-COMPFTN
      *
                  IF   KOH-IDX    >     1
                      COMPUTE  WK-TOKUSYU =
                                  LNK-SYU-KOH-COMPFTN(KOH-IDX)  +    5
                      COMPUTE  WK-TOKUSYU  =
                                  WK-TOKUSYU                    /   10
                      COMPUTE  WK-TOKUSYU  =
                                  WK-TOKUSYU                    *   10
                      IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                          CONTINUE
                      ELSE
                          MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                      END-IF
                  END-IF
              ELSE
                  COMPUTE  WK-TOKUSYU =
                                    WK-ZENGAKU             +    5
                  COMPUTE  WK-TOKUSYU  =
                                    WK-TOKUSYU             /   10
                  COMPUTE  WK-TOKUSYU  =
                                    WK-TOKUSYU             *   10
      *
                  IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI1
                          MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI2
                          MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI3
                          MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-TOKUSYU    >   ZAN-KOHI4
                          MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                       END-IF
                     END-IF
                     IF  WK-TOKUSYU    >=    ZAN-KOHI-T(KOH-IDX)
                         MOVE   WK-TOKUSYU          TO
                                           LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                         MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                  ELSE
                     IF  WK-TOKUSYU    >=    ZAN-KOHI-T(KOH-IDX)
                         MOVE   WK-ZENGAKU  TO
                                           LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                         MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                  END-IF
                  PERFORM    23072-KOHHI-HIKAKU-SEC
                  MOVE       WK-ZENGAKU  TO   WK-TOKUSYU-COMPFTN
      *
                  IF   KOH-IDX    >     1
                      COMPUTE  WK-TOKUSYU =
                                  LNK-SYU-KOH-COMPFTN(KOH-IDX)  +    5
                      COMPUTE  WK-TOKUSYU  =
                                  WK-TOKUSYU                    /   10
                      COMPUTE  WK-TOKUSYU  =
                                  WK-TOKUSYU                    *   10
                      IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                          CONTINUE
                      ELSE
                          MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                      END-IF
                  END-IF
              END-IF
           END-IF
      **
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           MOVE  WK-NYUSKJRYYKBN    TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
           MOVE  WK-SHOKUJI-NISSU   TO LNK-SYU-SKJ-NISSU(KOH-IDX)
           MOVE  WK-SHOKUJI-RYOYOHI TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
      *
           EVALUATE   WK-NYUSKJRYYKBN
                WHEN   "1"
                WHEN   "2"
                WHEN   "4"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                           LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       IF   FLG-NYUSKJJYOGAK   NOT =  ZERO
                       AND  LNK-SYU-KOH-COMPFTN(KOH-IDX) = ZERO
                         EVALUATE  FLG-NYUSKJJYOGAK
                           WHEN     1
                             IF   LNK-SYU-SKJ-FTN(KOH-IDX)  NOT = ZERO
                               COMPUTE LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) /  2
                             END-IF
                           WHEN     2
                             IF   LNK-SYU-SKJ-FTN(KOH-IDX)  NOT = ZERO
                               MOVE    ZERO   TO
                                       LNK-SYU-SKJ-FTN(KOH-IDX)
                             END-IF
                         END-EVALUATE
                       ELSE
                         IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSU
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                         END-IF
                       END-IF
      ****             IF   LNK-SYU-SKJ-FTNKBN(KOH-IDX)  =  "2"
      ****               IF    LNK-SYU-SKJ-FTN(KOH-IDX)   >
      ****                                    ZAN-KOHI-T(KOH-IDX)
      ****                  MOVE   ZAN-KOHI-T(KOH-IDX)   TO
      ****                              LNK-SYU-SKJ-FTN(KOH-IDX)
      ****                  MOVE   ZERO      TO  ZAN-KOHI-T(KOH-IDX)
      ****               ELSE
      ****                  COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
      ****                           ZAN-KOHI-T(KOH-IDX)    -
      ****                           LNK-SYU-SKJ-FTN(KOH-IDX)
      ****               END-IF
      ****             END-IF
                WHEN   "3"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                WHEN   "5"
                       MOVE  WK-SHOKUJI-NISSUS
                                      TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                       MOVE  WK-SHOKUJI-RYOYOHIS
                                      TO   LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNS
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNL
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSUL
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
           END-EVALUATE
      *
      *    公費単位で計算した患者負担金を比較
      *
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
           END-EVALUATE
      *
      *    公費単位で計算した患者負担金を比較
      *    （レセ記載金額退避用エリア用）
      *
           IF    HKN-RECEFTNDSPKBN      =  "2"
             EVALUATE    KOH-IDX
               WHEN    2
                 IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(1)      < WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  WK-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    3
                 IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(2)      < WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    4
                 IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(3)      < WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF
      *
      *    公費単位で計算した患者負担金を比較
      *    （円単位）
      *
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                   <     WK-TOKUSYU-ENTANI
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
           END-EVALUATE
      *
           IF  (WK-1001-PREFNUM             =  11  )
           AND (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "542")
              CONTINUE
           ELSE
             IF  ( LNK-S02-KOUREI-NYUIN-KBN     =      "1"   )
             AND ( COMB-HKNNUM            NOT   =     SPACE  )
      *
              MOVE   ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                 WK-TOKUSYU-COMPFTN
                                 WK-TOKUSYU-ENTANI
      *
              IF    HKN-RECEFTNDSPKBN    =  "2"
                   MOVE   ZERO   TO    WK-KOH-COMPFTN(KOH-IDX)
                                       WK-TOKUSYU-COMPFTN2
              END-IF
      *
              COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
             END-IF
           END-IF
      *
           .
      *
       23076-TOKUSYU-SANTEI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（限度を超えた場合、患者負担発生（超えた額））
      ******************************************************************
       23077-TOKUSYU-SANTEI2-SEC           SECTION.
      *
      ***  IF    LNK-SYU-SYUCOMPFTN-ENTANI   NOT =    ZERO
      ***  OR    FLG-GENBUTU70               NOT =    ZERO
           IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
                   IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >   ZAN-KOHI-T3(KOH-IDX)
                       COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                                ZAN-KOHI-T3(KOH-IDX)
                   ELSE
                       MOVE   ZERO  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                                 WK-TOKUSYU-ENTANI
           ELSE
      ***      IF    LNK-SYU-KOH-COMPFTN-ENTANI(1)   NOT =    ZERO
               IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                   MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
                   IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >   ZAN-KOHI-T3(KOH-IDX)
                       COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                                ZAN-KOHI-T3(KOH-IDX)
                   ELSE
                       MOVE   ZERO  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)  TO
                                                 WK-TOKUSYU-ENTANI
               ELSE
                   MOVE   WK-ZENGAKU  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
                   IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >   ZAN-KOHI-T3(KOH-IDX)
                       COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                                ZAN-KOHI-T3(KOH-IDX)
                   ELSE
                       MOVE   ZERO  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                   MOVE   WK-ZENGAKU   TO   WK-TOKUSYU-ENTANI
               END-IF
           END-IF
      **
           IF    HKN-RECEFTNDSPKBN      =  "2"
      ***     IF    LNK-SYU-SYUCOMPFTN   NOT =    ZERO
      ***     OR    FLG-GENBUTU70        NOT =    ZERO
              IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   MOVE  LNK-SYU-SYUCOMPFTN  TO  WK-KOH-COMPFTN(KOH-IDX)
                   PERFORM    23073-KOHHI-HIKAKU2-SEC
      *
                   IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI12
                          MOVE   ZAN-KOHI12
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI22
                          MOVE   ZAN-KOHI22
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI32
                          MOVE   ZAN-KOHI32
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI42
                          MOVE   ZAN-KOHI42
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T2(KOH-IDX)
                       COMPUTE  WK-KOH-COMPFTN(KOH-IDX)  =
                                WK-KOH-COMPFTN(KOH-IDX)  -
                                ZAN-KOHI-T2(KOH-IDX)
                   ELSE
                       MOVE   ZERO    TO   WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU-COMPFTN2
              ELSE
      ***       IF  LNK-SYU-KOH-COMPFTN(1)   NOT =    ZERO
                IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                AND (LNK-SYU-KOH1HKNNUM        =   "027")
                   MOVE  LNK-SYU-KOH-COMPFTN(1) TO
                                            WK-KOH-COMPFTN(KOH-IDX)
                   PERFORM    23073-KOHHI-HIKAKU2-SEC
      *
                   IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI12
                          MOVE   ZAN-KOHI12
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI22
                          MOVE   ZAN-KOHI22
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI32
                          MOVE   ZAN-KOHI32
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI42
                          MOVE   ZAN-KOHI42
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T2(KOH-IDX)
                       COMPUTE  WK-KOH-COMPFTN(KOH-IDX)  =
                                WK-KOH-COMPFTN(KOH-IDX)  -
                                ZAN-KOHI-T2(KOH-IDX)
                   ELSE
                       MOVE   ZERO    TO   WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-KOH-COMPFTN(1)  TO
                                           WK-TOKUSYU-COMPFTN2
                ELSE
                   MOVE  WK-ZENGAKU  TO    WK-KOH-COMPFTN(KOH-IDX)
                   PERFORM    23073-KOHHI-HIKAKU2-SEC
      *
                   IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI12
                          MOVE   ZAN-KOHI12
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI22
                          MOVE   ZAN-KOHI22
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI32
                          MOVE   ZAN-KOHI32
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI42
                          MOVE   ZAN-KOHI42
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T2(KOH-IDX)
                       COMPUTE  WK-KOH-COMPFTN(KOH-IDX)  =
                                WK-KOH-COMPFTN(KOH-IDX)  -
                                ZAN-KOHI-T2(KOH-IDX)
                   ELSE
                       MOVE   ZERO    TO   WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   MOVE   WK-ZENGAKU  TO   WK-TOKUSYU-COMPFTN2
                END-IF
              END-IF
           END-IF
      **
      ***  IF    LNK-SYU-SYUCOMPFTN   NOT =    ZERO
      ***  OR    FLG-GENBUTU70        NOT =    ZERO
           IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  IF  (FLG-KOUGAKUCYO3      =     1)
                  OR  (FLG-KOUGAKUCYO-GEN70 =     1)
                    MOVE  LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU
                  ELSE
                    COMPUTE  WK-TOKUSYU =  LNK-SYU-SYUCOMPFTN  +   5
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU          /  10
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU          *  10
                  END-IF
      *
                  MOVE  WK-TOKUSYU  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  PERFORM    23072-KOHHI-HIKAKU-SEC
      *
                  IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI1
                          MOVE   ZAN-KOHI1
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI2
                          MOVE   ZAN-KOHI2
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI3
                          MOVE   ZAN-KOHI3
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI4
                          MOVE   ZAN-KOHI4
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                  END-IF
      *
                  IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                            ZAN-KOHI-T(KOH-IDX)
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                               ZAN-KOHI-T(KOH-IDX)
                  ELSE
                      MOVE   ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  END-IF
                  MOVE   LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU-COMPFTN
           ELSE
      ***     IF  LNK-SYU-KOH-COMPFTN(1)   NOT =    ZERO
              IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND (LNK-SYU-KOH1HKNNUM        =   "027")
                  IF   FLG-KOUGAKUCYO3     =     1
                    MOVE  LNK-SYU-KOH-COMPFTN(1)  TO  WK-TOKUSYU
                  ELSE
                    COMPUTE  WK-TOKUSYU =  LNK-SYU-KOH-COMPFTN(1)  +   5
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU              /  10
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU              *  10
                  END-IF
      *
                  MOVE  WK-TOKUSYU  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  PERFORM    23072-KOHHI-HIKAKU-SEC
      *
                  IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI1
                          MOVE   ZAN-KOHI1
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI2
                          MOVE   ZAN-KOHI2
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI3
                          MOVE   ZAN-KOHI3
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI4
                          MOVE   ZAN-KOHI4
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                  END-IF
      *
                  IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                            ZAN-KOHI-T(KOH-IDX)
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                               ZAN-KOHI-T(KOH-IDX)
                  ELSE
                      MOVE   ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  END-IF
                  MOVE   LNK-SYU-KOH-COMPFTN(1)  TO  WK-TOKUSYU-COMPFTN
              ELSE
                  COMPUTE  WK-TOKUSYU =  WK-ZENGAKU  +   5
                  COMPUTE  WK-TOKUSYU =  WK-TOKUSYU  /  10
                  COMPUTE  WK-TOKUSYU =  WK-TOKUSYU  *  10
      *
                  MOVE  WK-TOKUSYU  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  PERFORM    23072-KOHHI-HIKAKU-SEC
      *
                  IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                      (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI1
                          MOVE   ZAN-KOHI1
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI2
                          MOVE   ZAN-KOHI2
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI3
                          MOVE   ZAN-KOHI3
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI4
                          MOVE   ZAN-KOHI4
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                  END-IF
      *
                  IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                            ZAN-KOHI-T(KOH-IDX)
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                               ZAN-KOHI-T(KOH-IDX)
                  ELSE
                      MOVE   ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  END-IF
                  MOVE   WK-ZENGAKU  TO   WK-TOKUSYU-COMPFTN
              END-IF
           END-IF
      **
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           MOVE  WK-NYUSKJRYYKBN    TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
           MOVE  WK-SHOKUJI-NISSU   TO LNK-SYU-SKJ-NISSU(KOH-IDX)
           MOVE  WK-SHOKUJI-RYOYOHI TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
      *
           EVALUATE   WK-NYUSKJRYYKBN
                WHEN   "1"
                WHEN   "2"
                WHEN   "4"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                           LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSU
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
      ****             IF   LNK-SYU-SKJ-FTNKBN(KOH-IDX)  =  "2"
      ****               IF    LNK-SYU-SKJ-FTN(KOH-IDX)   >
      ****                                    ZAN-KOHI-T(KOH-IDX)
      ****                  MOVE   ZAN-KOHI-T(KOH-IDX)   TO
      ****                              LNK-SYU-SKJ-FTN(KOH-IDX)
      ****                  MOVE   ZERO      TO  ZAN-KOHI-T(KOH-IDX)
      ****               ELSE
      ****                  COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
      ****                           ZAN-KOHI-T(KOH-IDX)    -
      ****                           LNK-SYU-SKJ-FTN(KOH-IDX)
      ****               END-IF
      ****             END-IF
                WHEN   "3"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                WHEN   "5"
                       MOVE  WK-SHOKUJI-NISSUS
                                      TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                       MOVE  WK-SHOKUJI-RYOYOHIS
                                      TO   LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNS
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNL
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSUL
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
           END-EVALUATE
      *
      *    公費単位で計算した患者負担金を比較
      *
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
           END-EVALUATE
      *
      *    公費単位で計算した患者負担金を比較
      *    （レセ記載金額退避用エリア用）
      *
           IF    HKN-RECEFTNDSPKBN      =  "2"
             EVALUATE    KOH-IDX
               WHEN    2
                 IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(1)      < WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  WK-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    3
                 IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(2)      < WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    4
                 IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(3)      < WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF
      *
      *    公費単位で計算した患者負担金を比較
      *    （円単位）
      *
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                   <     WK-TOKUSYU-ENTANI
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
           END-EVALUATE
      *
           .
      *
       23077-TOKUSYU-SANTEI2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（２割又は３割の額を算出後、半額を患者負担とする）
      ******************************************************************
       23078-TOKUSYU-SANTEI3-SEC           SECTION.
      *
      ***  IF     LNK-SYU-SYUCOMPFTN-ENTANI       NOT =    ZERO
      ***  OR     FLG-GENBUTU70                   NOT =    ZERO
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  COMPUTE     WK-HANGAKU-ENTANI     =
                              LNK-SYU-SYUCOMPFTN-ENTANI      *  0.5
           ELSE
      ***    IF   LNK-SYU-KOH-COMPFTN-ENTANI(1)   NOT =    ZERO
             IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                    COMPUTE   WK-HANGAKU-ENTANI     =
                              LNK-SYU-KOH-COMPFTN-ENTANI(1)  *  0.5
             ELSE
                    COMPUTE   WK-HANGAKU-ENTANI     =
                              WK-ZENGAKU  *  0.5
             END-IF
           END-IF
      *
           IF    WK-HANGAKU-ENTANI  >  ZAN-KOHI-T3(KOH-IDX)
               MOVE   ZAN-KOHI-T3(KOH-IDX)
                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           ELSE
               MOVE   WK-HANGAKU-ENTANI
                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
      *
           IF     HKN-RECEFTNDSPKBN          =  "2"
      *
      ***     IF      LNK-SYU-SYUCOMPFTN       NOT =   ZERO
      ***     OR      FLG-GENBUTU70            NOT =   ZERO
              IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                      COMPUTE   WK-HANGAKU-COMPFTN   =
                                LNK-SYU-SYUCOMPFTN      *  0.5
              ELSE
      ***       IF    LNK-SYU-KOH-COMPFTN(1)   NOT =   ZERO
                IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                      COMPUTE   WK-HANGAKU-COMPFTN   =
                                LNK-SYU-KOH-COMPFTN(1)  *  0.5
                ELSE
                      COMPUTE   WK-HANGAKU-COMPFTN   =
                                WK-ZENGAKU  *  0.5
                END-IF
              END-IF
      *
              IF    WK-HANGAKU-COMPFTN  >  ZAN-KOHI-T2(KOH-IDX)
                  MOVE   ZAN-KOHI-T2(KOH-IDX)
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
              ELSE
                  MOVE  WK-HANGAKU-COMPFTN
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
              END-IF
      *
              PERFORM    23073-KOHHI-HIKAKU2-SEC
      *
           END-IF
      *
      *
      ***  IF      LNK-SYU-SYUCOMPFTN       NOT =   ZERO
      ***  IF      WK-TOKUTEI-COMPFTN       NOT =   ZERO
      ***  OR      FLG-GENBUTU70            NOT =   ZERO
           IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   COMPUTE   WK-HANGAKU-COMPFTN   =
      ***                    LNK-SYU-SYUCOMPFTN      *  0.5
                             WK-TOKUTEI-COMPFTN      *  0.5
           ELSE
      ***    IF    LNK-SYU-KOH-COMPFTN(1)   NOT =   ZERO
      ***    IF    WK-TOKUTEI-COMPFTN3      NOT =   ZERO
             IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                   COMPUTE   WK-HANGAKU-COMPFTN   =
      ***                    LNK-SYU-KOH-COMPFTN(1)  *  0.5
                             WK-TOKUTEI-COMPFTN3     *  0.5
             ELSE
                   COMPUTE   WK-HANGAKU-COMPFTN   =
                             WK-ZENGAKU  *  0.5
             END-IF
           END-IF
      *
           IF    WK-HANGAKU-COMPFTN  >  ZAN-KOHI-T(KOH-IDX)
               MOVE   ZAN-KOHI-T(KOH-IDX)
                             TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
           ELSE
               MOVE  WK-HANGAKU-COMPFTN
                             TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
           PERFORM   23072-KOHHI-HIKAKU-SEC
      *
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           MOVE  WK-NYUSKJRYYKBN     TO  LNK-SYU-SKJ-FTNKBN(KOH-IDX)
           MOVE  WK-SHOKUJI-NISSU    TO  LNK-SYU-SKJ-NISSU(KOH-IDX)
           MOVE  WK-SHOKUJI-RYOYOHI  TO  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
      *
           EVALUATE   WK-NYUSKJRYYKBN
                WHEN   "1"
                WHEN   "2"
                WHEN   "4"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                           LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSU
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
      ****             IF   LNK-SYU-SKJ-FTNKBN(KOH-IDX)  =  "2"
      ****               IF    LNK-SYU-SKJ-FTN(KOH-IDX)   >
      ****                                    ZAN-KOHI-T(KOH-IDX)
      ****                  MOVE   ZAN-KOHI-T(KOH-IDX)   TO
      ****                              LNK-SYU-SKJ-FTN(KOH-IDX)
      ****                  MOVE   ZERO      TO  ZAN-KOHI-T(KOH-IDX)
      ****               ELSE
      ****                  COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
      ****                           ZAN-KOHI-T(KOH-IDX)    -
      ****                           LNK-SYU-SKJ-FTN(KOH-IDX)
      ****               END-IF
      ****             END-IF
                WHEN   "3"
                       MOVE  WK-SHOKUJI-FTN
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                WHEN   "5"
                       MOVE  WK-SHOKUJI-NISSUS
                                      TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                       MOVE  WK-SHOKUJI-RYOYOHIS
                                      TO   LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNS
                                      TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       MOVE  WK-SHOKUJI-FTNL
                                      TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                       IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                          COMPUTE   WK-NYUSKJJYOGAK2  =
                                    WK-NYUSKJJYOGAK * WK-SHOKUJI-NISSUL
                          IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                              >   WK-NYUSKJJYOGAK2
                             COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                       LNK-SYU-SKJ-FTN(KOH-IDX) -
                                       WK-NYUSKJJYOGAK2
                          ELSE
                             MOVE   ZERO   TO  
                                      LNK-SYU-SKJ-FTN(KOH-IDX) 
                          END-IF
                       END-IF
           END-EVALUATE
      *
           .
      *
       23078-TOKUSYU-SANTEI3-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        特殊計算（長期の計算）
      ******************************************************************
       23079-TOKUSYU-SANTEI4-SEC           SECTION.
      *
           IF    FLG-ZENKI-TOKUREI  =  1
             COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                   =  WK-ZENGAKU  *  0.2
             COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                   =  WK-ZENGAKU  *  0.2
           ELSE
             IF  COMB-HKNNUM        =  SPACE
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                   =  WK-ZENGAKU
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                   =  WK-ZENGAKU
             ELSE
               COMPUTE  WK-FUTANWARI   = WK-KOH-FTNRATE  /  100
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                   =  WK-ZENGAKU  *  WK-FUTANWARI
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                   =  WK-ZENGAKU  *  WK-FUTANWARI
             END-IF
           END-IF
      *
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
           COMPUTE  WK-FTN      =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX) / 10
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                    WK-FTN   *  10
      *
           IF LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) > ZAN-KOHI-T3(KOH-IDX)
              MOVE  ZAN-KOHI-T3(KOH-IDX)  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           IF LNK-SYU-KOH-COMPFTN(KOH-IDX) > ZAN-KOHI-T(KOH-IDX)
              MOVE  ZAN-KOHI-T(KOH-IDX)   TO
                                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
              MOVE  ZERO                  TO ZAN-KOHI-T(KOH-IDX)
           ELSE
              COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
                       ZAN-KOHI-T(KOH-IDX)    -
                       LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
           COMPUTE     LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                       LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                         ZAN-KOHI-T(KOH-IDX) +   5
               COMPUTE   WK-FTN      =
                         ZAN-KOHI-T(KOH-IDX) /  10
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                         WK-FTN   *  10
           END-IF
      *
           MOVE  WK-NYUSKJRYYKBN    TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
           MOVE  WK-SHOKUJI-NISSU   TO LNK-SYU-SKJ-NISSU(KOH-IDX)
           MOVE  WK-SHOKUJI-RYOYOHI TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
           MOVE  WK-SHOKUJI-FTN     TO LNK-SYU-SKJ-FTN(KOH-IDX)
                                       LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
      *
           .
      *
       23079-TOKUSYU-SANTEI4-EXT.
           EXIT.
      *
      ******************************************************************
      *        熊本県地方公費（１／３）計算
      ******************************************************************
       23081-KUMAMOTO-KOHI-SEC           SECTION.
      *
      *    負担金額の計算
      *
      ***  IF     LNK-SYU-SYUCOMPFTN  NOT  =  ZERO
      ***  OR     FLG-GENBUTU70       NOT  =  ZERO
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-SYUCOMPFTN            +  5
                  COMPUTE   WK-FTN  =  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    /  10
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =  WK-FTN
                                                          *  10
           ELSE
      ***    IF   (LNK-SYU-KOH-HKNNUM(1)       =   "027")
      ***    AND  (LNK-SYU-KOH-COMPFTN(1)  NOT =   ZERO )
             IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-KOH-COMPFTN(1)        +  5
                  COMPUTE   WK-FTN  =  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    /  10
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =  WK-FTN
                                                          *  10
             ELSE
                  MOVE    ZERO    TO    LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)   NOT  =  ZERO
                  MOVE      LNK-SYU-KOH-COMPFTN(KOH-IDX)  TO  WK-FTN
      *
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            ( WK-FTN  /  3 ) + 0.9
      *
                  COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                            ( WK-FTN  /  3 )
           END-IF
      *
           .
      *
       23081-KUMAMOTO-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        東京都地方公費マル子計算
      ******************************************************************
       23082-TOKYO-KOHI-SEC           SECTION.
      *
      ***  IF      WK-TOKUTEI-COMPFTN   NOT =    ZERO
           IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  *   2  /  3
                COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  *   2  /  3
           ELSE
                MOVE   ZERO  TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                MOVE   ZERO  TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           IF   HKN-RECEFTNDSPKBN   =   "2"
                MOVE   "1"   TO   WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                    MOVE  WK-TOKUTEI-COMPFTN
                             TO   LNK-SYU-SYUCOMPFTN
                END-IF
           ELSE
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                COMPUTE   WK-FTN      =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) /  10
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =  WK-FTN
                                                       *  10
           END-IF
      *
           .
      *
       23082-TOKYO-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        公費単位で計算した患者負担金から最小の値を選択セット
      ******************************************************************
       2309-FTNKIN-HIKAKU-SEC         SECTION.
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               IF   LNK-SYU-KOH1HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH1COMPFTN-ENTANI  >
                                        LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH1HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  LNK-SYU-KOH1COMPFTN-ENTANI
                 END-IF
               END-IF
               IF   LNK-SYU-KOH2HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH2COMPFTN-ENTANI  >
                                        LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH2HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                    TO  LNK-SYU-KOH2COMPFTN-ENTANI
                 END-IF
               END-IF
               IF   LNK-SYU-KOH3HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH3COMPFTN-ENTANI  >
                                        LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH3HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                    TO  LNK-SYU-KOH3COMPFTN-ENTANI
                 END-IF
               END-IF
               IF   LNK-SYU-KOH4HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH4COMPFTN-ENTANI  >
                                        LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH4HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                    TO  LNK-SYU-KOH4COMPFTN-ENTANI
                 END-IF
               END-IF
           END-IF.
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               IF   LNK-SYU-KOH1HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH1COMPFTN      >     LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH1HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN  TO  LNK-SYU-KOH1COMPFTN
                   MOVE   LNK-SYU-KOH1COMPFTN TO  LNK-SYU-KOH1COMPTOTAL
                   IF    WK-KOH-COMPFTN(1)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO  WK-KOH-COMPFTN(1)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(1)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO  WK-DAY-KOH-COMPFTN(1)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH2HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH2COMPFTN      >     LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH2HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN  TO  LNK-SYU-KOH2COMPFTN
                   MOVE   LNK-SYU-KOH2COMPFTN TO  LNK-SYU-KOH2COMPTOTAL
                   IF    WK-KOH-COMPFTN(2)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO  WK-KOH-COMPFTN(2)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(2)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO  WK-DAY-KOH-COMPFTN(2)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH3HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH3COMPFTN      >     LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH3HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN  TO  LNK-SYU-KOH3COMPFTN
                   MOVE   LNK-SYU-KOH3COMPFTN TO  LNK-SYU-KOH3COMPTOTAL
                   IF    WK-KOH-COMPFTN(3)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO  WK-KOH-COMPFTN(3)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(3)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO  WK-DAY-KOH-COMPFTN(3)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH4HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH4COMPFTN      >     LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH4HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN  TO  LNK-SYU-KOH4COMPFTN
                   MOVE   LNK-SYU-KOH4COMPFTN TO  LNK-SYU-KOH4COMPTOTAL
                   IF    WK-KOH-COMPFTN(4)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO  WK-KOH-COMPFTN(4)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(4)  =  ALL"9"
                       CONTINUE
                   ELSE
                      MOVE  LNK-SYU-SYUCOMPFTN TO  WK-DAY-KOH-COMPFTN(4)
                   END-IF
                 END-IF
               END-IF
           END-IF.
      *
           IF   FLG-GENBUTU70   NOT =   ZERO
              MOVE   LNK-SYU-KOH1COMPFTN   TO   WK-GENBUTU-KOH1COMPFTN
              MOVE   LNK-SYU-KOH2COMPFTN   TO   WK-GENBUTU-KOH2COMPFTN
              MOVE   LNK-SYU-KOH3COMPFTN   TO   WK-GENBUTU-KOH3COMPFTN
              MOVE   LNK-SYU-KOH4COMPFTN   TO   WK-GENBUTU-KOH4COMPFTN
           END-IF.
      *
           IF   (COMB-KOH1HKNNUM     = "972" OR "974") OR
                (COMB-KOH2HKNNUM     = "972" OR "974") OR
                (COMB-KOH3HKNNUM     = "972" OR "974") OR
                (COMB-KOH4HKNNUM     = "972" OR "974")
      ***   IF   FLG-ZENKI-TOKUREI  =  1
      **>   IF   LNK-SYU-SRYYMD(1:6)   >= "200804"
                 PERFORM   23091-FTNKIN-HIKAKU-CYOKI-SEC
      **>   ELSE
      **>     IF  ((COMB-KOH1HKNNUM     = "972" OR "974" ) AND
      **>          (COMB-KOH2HKNNUM     =  SPACE         ) AND
      **>          (COMB-KOH3HKNNUM     =  SPACE         ) AND
      **>          (COMB-KOH4HKNNUM     =  SPACE         ))
      **>     OR  ((COMB-KOH1HKNNUM     = "027"          ) AND
      **>          (COMB-KOH2HKNNUM     = "972" OR "974" ) AND
      **>          (COMB-KOH3HKNNUM     =  SPACE         ) AND
      **>          (COMB-KOH4HKNNUM     =  SPACE         ))
      **>        PERFORM   23092-FTNKIN-HIKAKU-TUJYO-SEC
      **>     ELSE
      **>        PERFORM   23091-FTNKIN-HIKAKU-CYOKI-SEC
      **>     END-IF
      **>   END-IF
           ELSE
                 PERFORM   23092-FTNKIN-HIKAKU-TUJYO-SEC
           END-IF.
      *
      *    収納テーブルの請求額をセット
           MOVE    WK-KNJFTNKIN             TO  LNK-SYU-SKYMONEY.
      *
      *    大分県乳幼児特殊計算
           PERFORM   23095-OITA-TOKUSYU-KEISAN-SEC.
      *
           IF   LNK-SYU-SRYYMD(1:6)       <   "200610"
              MOVE   WK-SHOKUJI-RYOYOHI     TO  WK-SHOKUJI-RYOYOHIS
              MOVE   ZERO                   TO  WK-SHOKUJI-RYOYOHIL
              MOVE   WK-KNJFTNKIN-SKJ       TO  WK-KNJFTNKIN-SKJS
              MOVE   ZERO                   TO  WK-KNJFTNKIN-SKJL
           ELSE
              COMPUTE  WK-KNJFTNKIN-SKJ-KEISAN  =  WK-SHOKUJI-FTNS
                                                +  WK-SHOKUJI-FTNL
              IF     WK-KNJFTNKIN-SKJ  =  ZERO
                MOVE     ZERO       TO  WK-KNJFTNKIN-SKJS
                MOVE     ZERO       TO  WK-KNJFTNKIN-SKJL
              ELSE
                IF   WK-KNJFTNKIN-SKJ   =  WK-KNJFTNKIN-SKJ-KEISAN
                  MOVE   WK-SHOKUJI-FTNS  TO  WK-KNJFTNKIN-SKJS
                  MOVE   WK-SHOKUJI-FTNL  TO  WK-KNJFTNKIN-SKJL
                ELSE
                 IF  ((WK-NYUSKJRYYKBN-TOKU(1)  =  "1")
                                          AND (FLG-HIKAKU-SKJ = 1))
                 OR  ((WK-NYUSKJRYYKBN-TOKU(2)  =  "1")
                                          AND (FLG-HIKAKU-SKJ = 2))
                 OR  ((WK-NYUSKJRYYKBN-TOKU(3)  =  "1")
                                          AND (FLG-HIKAKU-SKJ = 3))
                 OR  ((WK-NYUSKJRYYKBN-TOKU(4)  =  "1")
                                          AND (FLG-HIKAKU-SKJ = 4))
                    MOVE ZERO             TO  WK-KNJFTNKIN-SKJS
                    MOVE WK-KNJFTNKIN-SKJ TO  WK-KNJFTNKIN-SKJL
                 ELSE
                  IF  WK-KNJFTNKIN-SKJ  <  WK-KNJFTNKIN-SKJ-KEISAN
                    EVALUATE    FLG-SEIKATU
                     WHEN   1
                       IF  (FLG-SEIKATUL      =  ZERO           )
                       OR  (WK-KNJFTNKIN-SKJ  <  WK-SHOKUJI-FTNS)
                         MOVE   WK-KNJFTNKIN-SKJ TO  WK-KNJFTNKIN-SKJS
                         MOVE   ZERO             TO  WK-KNJFTNKIN-SKJL
                       ELSE
                         MOVE   WK-SHOKUJI-FTNS  TO  WK-KNJFTNKIN-SKJS
                         COMPUTE  WK-KNJFTNKIN-SKJL =  WK-KNJFTNKIN-SKJ
                                                    -  WK-SHOKUJI-FTNS
                       END-IF
                     WHEN   2
                       IF  (FLG-SEIKATUS      =  ZERO           )
                       OR  (WK-KNJFTNKIN-SKJ  <  WK-SHOKUJI-FTNL)
                         MOVE   WK-KNJFTNKIN-SKJ TO  WK-KNJFTNKIN-SKJL
                         MOVE   ZERO             TO  WK-KNJFTNKIN-SKJS
                       ELSE
                         MOVE   WK-SHOKUJI-FTNL  TO  WK-KNJFTNKIN-SKJL
                         COMPUTE  WK-KNJFTNKIN-SKJS =  WK-KNJFTNKIN-SKJ
                                                    -  WK-SHOKUJI-FTNL
                       END-IF
                    END-EVALUATE
                  END-IF
                 END-IF
                END-IF
              END-IF
           END-IF
      *
           MOVE     ZERO      TO   WK-SKJ-ZEITAISYO.
      *    食事療養費・食事負担額をセット
           MOVE    WK-SHOKUJI-RYOYOHIS      TO  LNK-SYU-RYOYOHI-SKJ.
           MOVE    WK-KNJFTNKIN-SKJS        TO  LNK-SYU-SKYMONEY-SKJ.
           IF   (COMB-SYU-HKNKOHSBTKBN  =  "8")
             IF  (LNK-SYU-SYUSKJ-FTNKBN  =  "4")
               IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
                 MOVE  WK-SKJ-ZEIKEI2   TO  LNK-SYU-SKYMONEY-SKJ-TAX
                 COMPUTE  WK-SKJ-ZEITAISYO           =
                          WK-SKJ-ZEITAISYO           +
                          LNK-SYU-SKYMONEY-SKJ       +
                          LNK-SYU-SKYMONEY-SKJ-TAX
               ELSE
                 IF    COMB-HOJOKBN       =  "1"
                   CONTINUE
                 ELSE
                   IF    WK-TAX1001-KBN  =  "1"
                     COMPUTE LNK-SYU-SKYMONEY-SKJ-TAX   =
                           ( LNK-SYU-SKYMONEY-SKJ  *   0.05 )  +  0.5
                   ELSE
                     COMPUTE LNK-SYU-SKYMONEY-SKJ-TAX   =
                           ( LNK-SYU-SKYMONEY-SKJ  *   0.05 )
                   END-IF
                 END-IF
               END-IF
             ELSE
               IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
                 IF    COMB-HOJOKBN           =  "1"
                 AND   LNK-SYU-SYUSKJ-FTNKBN  =  "1"
                   MOVE  WK-SKJ-ZEIKEI2   TO  LNK-SYU-SKYMONEY-SKJ-TAX
                   COMPUTE  WK-SKJ-ZEITAISYO           =
                            WK-SKJ-ZEITAISYO           +
                            LNK-SYU-SKYMONEY-SKJ       +
                            LNK-SYU-SKYMONEY-SKJ-TAX
                 END-IF
               END-IF
             END-IF
           END-IF.
           COMPUTE  LNK-SYU-SKYMONEY-SKJ-KEI = LNK-SYU-SKYMONEY-SKJ
                                             + LNK-SYU-SKYMONEY-SKJ-TAX.
      *    食事療養費・食事負担額をセット（生活）
           MOVE    WK-SHOKUJI-RYOYOHIL     TO  LNK-SYU-RYOYOHI-LIFE.
           MOVE    WK-KNJFTNKIN-SKJL       TO  LNK-SYU-SKYMONEY-LIFE.
           IF   (COMB-SYU-HKNKOHSBTKBN  =  "8")
             IF  (LNK-SYU-SYUSKJ-FTNKBN  =  "4")
               IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
                 MOVE  WK-SKJ-ZEIKEI2L  TO  LNK-SYU-SKYMONEY-LIFE-TAX
                 COMPUTE  WK-SKJ-ZEITAISYO           =
                          WK-SKJ-ZEITAISYO           +
                          LNK-SYU-SKYMONEY-LIFE      +
                          LNK-SYU-SKYMONEY-LIFE-TAX
               ELSE
                 IF    COMB-HOJOKBN       =  "1"
                   CONTINUE
                 ELSE
                   IF    WK-TAX1001-KBN  =  "1"
                     COMPUTE LNK-SYU-SKYMONEY-LIFE-TAX   =
                           ( LNK-SYU-SKYMONEY-LIFE  *   0.05 )  +  0.5
                   ELSE
                     COMPUTE LNK-SYU-SKYMONEY-LIFE-TAX   =
                           ( LNK-SYU-SKYMONEY-LIFE  *   0.05 )
                   END-IF
                 END-IF
               END-IF
             ELSE
               IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
                 IF    COMB-HOJOKBN           =  "1"
                 AND   LNK-SYU-SYUSKJ-FTNKBN  =  "1"
                   MOVE  WK-SKJ-ZEIKEI2L  TO  LNK-SYU-SKYMONEY-LIFE-TAX
                   COMPUTE  WK-SKJ-ZEITAISYO           =
                            WK-SKJ-ZEITAISYO           +
                            LNK-SYU-SKYMONEY-LIFE      +
                            LNK-SYU-SKYMONEY-LIFE-TAX
                 END-IF
               END-IF
             END-IF
           END-IF.
           COMPUTE  LNK-SYU-SKYMONEY-LIFE-KEI
                                    = LNK-SYU-SKYMONEY-LIFE
                                    + LNK-SYU-SKYMONEY-LIFE-TAX.
      *    特定疾患がある方の特例処理
           IF  ((LNK-SYU-KOH1HKNNUM    =  "051") AND (FLG-HIKAKU = 1))
           OR  ((LNK-SYU-KOH2HKNNUM    =  "051") AND (FLG-HIKAKU = 2))
             IF    LNK-SYU-SRYYMD(1:6)   <  "200310"
               COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                  +   LNK-SYU-SKYMONEY-SKJ-KEI
                                  +   LNK-SYU-SKYMONEY-LIFE-KEI
               COMPUTE   WK-FTN   =   WK-FTN     +   5
               COMPUTE   WK-FTN   =   WK-FTN     /  10
               COMPUTE   WK-FTN   =   WK-FTN     *  10
               IF        WK-FTN    >=  14000
                 COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                            +  LNK-SYU-SKYMONEY-SKJ-KEI
                                            +  LNK-SYU-SKYMONEY-LIFE-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                               LNK-SYU-SKYMONEY-SKJ-TAX
                                               LNK-SYU-SKYMONEY-SKJ-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                               LNK-SYU-SKYMONEY-LIFE-TAX
                                               LNK-SYU-SKYMONEY-LIFE-KEI
               END-IF
             ELSE
               COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                  +   LNK-SYU-SKYMONEY-SKJ-KEI
                                  +   LNK-SYU-SKYMONEY-LIFE-KEI
               COMPUTE   WK-FTN   =   WK-FTN     +   5
               COMPUTE   WK-FTN   =   WK-FTN     /  10
               COMPUTE   WK-FTN   =   WK-FTN     *  10
               IF        WK-FTN    >=  WK-TAIHI-NYUJGNGAK(FLG-HIKAKU)
                 COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                            +  LNK-SYU-SKYMONEY-SKJ-KEI
                                            +  LNK-SYU-SKYMONEY-LIFE-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                               LNK-SYU-SKYMONEY-SKJ-TAX
                                               LNK-SYU-SKYMONEY-SKJ-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                               LNK-SYU-SKYMONEY-LIFE-TAX
                                               LNK-SYU-SKYMONEY-LIFE-KEI
               END-IF
             END-IF
           END-IF.
           IF    LNK-SYU-SRYYMD(1:6)   <   "200304"
               CONTINUE
           ELSE
            IF   LNK-SYU-SRYYMD(1:6)   >=  "200604"
             CONTINUE
            ELSE
      *      更正がある方の特例処理
             IF ((LNK-SYU-KOH1HKNNUM    =  "015") AND (FLG-HIKAKU = 1))
             OR ((LNK-SYU-KOH2HKNNUM    =  "015") AND (FLG-HIKAKU = 2))
               COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                  +   LNK-SYU-SKYMONEY-SKJ-KEI
                                  +   LNK-SYU-SKYMONEY-LIFE-KEI
               COMPUTE   WK-FTN   =   WK-FTN     +   5
               COMPUTE   WK-FTN   =   WK-FTN     /  10
               COMPUTE   WK-FTN   =   WK-FTN     *  10
               IF        WK-FTN    >=  WK-TAIHI-NYUJGNGAK(FLG-HIKAKU)
                 COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                            +  LNK-SYU-SKYMONEY-SKJ-KEI
                                            +  LNK-SYU-SKYMONEY-LIFE-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                               LNK-SYU-SKYMONEY-SKJ-TAX
                                               LNK-SYU-SKYMONEY-SKJ-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                               LNK-SYU-SKYMONEY-LIFE-TAX
                                               LNK-SYU-SKYMONEY-LIFE-KEI
               END-IF
             END-IF
      *      育成がある方の特例処理
             IF ((LNK-SYU-KOH1HKNNUM    =  "016") AND (FLG-HIKAKU = 1))
             OR ((LNK-SYU-KOH2HKNNUM    =  "016") AND (FLG-HIKAKU = 2))
               COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                  +   LNK-SYU-SKYMONEY-SKJ-KEI
                                  +   LNK-SYU-SKYMONEY-LIFE-KEI
               COMPUTE   WK-FTN   =   WK-FTN     +   5
               COMPUTE   WK-FTN   =   WK-FTN     /  10
               COMPUTE   WK-FTN   =   WK-FTN     *  10
               IF        WK-FTN    >=  WK-TAIHI-NYUJGNGAK(FLG-HIKAKU)
                 COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                            +  LNK-SYU-SKYMONEY-SKJ-KEI
                                            +  LNK-SYU-SKYMONEY-LIFE-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                               LNK-SYU-SKYMONEY-SKJ-TAX
                                               LNK-SYU-SKYMONEY-SKJ-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                               LNK-SYU-SKYMONEY-LIFE-TAX
                                               LNK-SYU-SKYMONEY-LIFE-KEI
               END-IF
             END-IF
            END-IF
           END-IF.
      *
           IF    LNK-SYU-SRYYMD(1:6)   <   "200310"
               CONTINUE
           ELSE
      *      東京都地方公費１５１がある方の特例処理
             IF   WK-1001-PREFNUM    =   13
               IF ((LNK-SYU-KOH1HKNNUM = "151" OR "451") 
                                              AND (FLG-HIKAKU = 1))
               OR ((LNK-SYU-KOH2HKNNUM = "151" OR "451")
                                              AND (FLG-HIKAKU = 2))
               OR ((LNK-SYU-KOH3HKNNUM = "151" OR "451")
                                              AND (FLG-HIKAKU = 3))
               OR ((LNK-SYU-KOH4HKNNUM = "151" OR "451")
                                              AND (FLG-HIKAKU = 4))
                COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                   +   LNK-SYU-SKYMONEY-SKJ-KEI
                                   +   LNK-SYU-SKYMONEY-LIFE-KEI
                COMPUTE   WK-FTN   =   WK-FTN     +   5
                COMPUTE   WK-FTN   =   WK-FTN     /  10
                COMPUTE   WK-FTN   =   WK-FTN     *  10
                IF        WK-FTN    >=  WK-TAIHI-NYUJGNGAK(FLG-HIKAKU)
                 COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                            +  LNK-SYU-SKYMONEY-SKJ-KEI
                                            +  LNK-SYU-SKYMONEY-LIFE-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                               LNK-SYU-SKYMONEY-SKJ-TAX
                                               LNK-SYU-SKYMONEY-SKJ-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                               LNK-SYU-SKYMONEY-LIFE-TAX
                                               LNK-SYU-SKYMONEY-LIFE-KEI
                END-IF
               END-IF
             END-IF
           END-IF.
      *
           IF    LNK-SYU-SRYYMD(1:6)   <   "200310"
               CONTINUE
           ELSE
      *      兵庫県地方公費１８６がある方の特例処理
             IF   WK-1001-PREFNUM    =   28
               IF ((LNK-SYU-KOH1HKNNUM = "186") AND (FLG-HIKAKU = 1))
               OR ((LNK-SYU-KOH2HKNNUM = "186") AND (FLG-HIKAKU = 2))
               OR ((LNK-SYU-KOH3HKNNUM = "186") AND (FLG-HIKAKU = 3))
               OR ((LNK-SYU-KOH4HKNNUM = "186") AND (FLG-HIKAKU = 4))
                COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                   +   LNK-SYU-SKYMONEY-SKJ-KEI
                                   +   LNK-SYU-SKYMONEY-LIFE-KEI
                COMPUTE   WK-FTN   =   WK-FTN     +   5
                COMPUTE   WK-FTN   =   WK-FTN     /  10
                COMPUTE   WK-FTN   =   WK-FTN     *  10
                IF        WK-FTN    >=  WK-TAIHI-NYUJGNGAK(FLG-HIKAKU)
                 COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                            +  LNK-SYU-SKYMONEY-SKJ-KEI
                                            +  LNK-SYU-SKYMONEY-LIFE-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                               LNK-SYU-SKYMONEY-SKJ-TAX
                                               LNK-SYU-SKYMONEY-SKJ-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                               LNK-SYU-SKYMONEY-LIFE-TAX
                                               LNK-SYU-SKYMONEY-LIFE-KEI
                END-IF
               END-IF
             END-IF
           END-IF.
      *
           IF    LNK-SYU-SRYYMD(1:6)   <   "200504"
               CONTINUE
           ELSE
      *      小児特定がある方の特例処理
             IF ((LNK-SYU-KOH1HKNNUM    =  "052") AND (FLG-HIKAKU = 1))
             OR ((LNK-SYU-KOH2HKNNUM    =  "052") AND (FLG-HIKAKU = 2))
               COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                  +   LNK-SYU-SKYMONEY-SKJ-KEI
                                  +   LNK-SYU-SKYMONEY-LIFE-KEI
               COMPUTE   WK-FTN   =   WK-FTN     +   5
               COMPUTE   WK-FTN   =   WK-FTN     /  10
               COMPUTE   WK-FTN   =   WK-FTN     *  10
               IF        WK-FTN    >=  WK-TAIHI-NYUJGNGAK(FLG-HIKAKU)
                 COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                            +  LNK-SYU-SKYMONEY-SKJ-KEI
                                            +  LNK-SYU-SKYMONEY-LIFE-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                               LNK-SYU-SKYMONEY-SKJ-TAX
                                               LNK-SYU-SKYMONEY-SKJ-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                               LNK-SYU-SKYMONEY-LIFE-TAX
                                               LNK-SYU-SKYMONEY-LIFE-KEI
               END-IF
             END-IF
           END-IF.
      *
           IF    LNK-SYU-SRYYMD(1:6)   <   "200702"
               CONTINUE
           ELSE
      *      福島県地方公費２８１がある方の特例処理
             IF   WK-1001-PREFNUM    =   07
               IF ((LNK-SYU-KOH1HKNNUM = "281") AND (FLG-HIKAKU = 1))
               OR ((LNK-SYU-KOH2HKNNUM = "281") AND (FLG-HIKAKU = 2))
               OR ((LNK-SYU-KOH3HKNNUM = "281") AND (FLG-HIKAKU = 3))
               OR ((LNK-SYU-KOH4HKNNUM = "281") AND (FLG-HIKAKU = 4))
                COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                   +   LNK-SYU-SKYMONEY-SKJ-KEI
                                   +   LNK-SYU-SKYMONEY-LIFE-KEI
                COMPUTE   WK-FTN   =   WK-FTN     +   5
                COMPUTE   WK-FTN   =   WK-FTN     /  10
                COMPUTE   WK-FTN   =   WK-FTN     *  10
                IF        WK-FTN    >=  WK-TAIHI-NYUJGNGAK(FLG-HIKAKU)
                 COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                            +  LNK-SYU-SKYMONEY-SKJ-KEI
                                            +  LNK-SYU-SKYMONEY-LIFE-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                               LNK-SYU-SKYMONEY-SKJ-TAX
                                               LNK-SYU-SKYMONEY-SKJ-KEI
                 MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                               LNK-SYU-SKYMONEY-LIFE-TAX
                                               LNK-SYU-SKYMONEY-LIFE-KEI
                END-IF
               END-IF
             END-IF
           END-IF.
      *
           COMPUTE  LNK-SYU-RYOYOHI-SKJ-JIHI  = WK-SHOKUJI-RYOYOHI95
                                              + WK-SHOKUJI-RYOYOHI96.
           COMPUTE  LNK-SYU-SKYMONEY-SKJ-JIHI = WK-SHOKUJI-FTN95
                                              + WK-SHOKUJI-FTN96.
           IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
             MOVE  WK-SKJ-ZEIKEI   TO  LNK-SYU-SKYMONEY-SKJ-JIHI-TAX
             IF    WK-SHOKUJI-FTN96   NOT =  ZERO
               COMPUTE  WK-SKJ-ZEITAISYO = WK-SKJ-ZEITAISYO
                                         + WK-SHOKUJI-FTN96
                                         + WK-SKJ-ZEIKEI
             END-IF
           ELSE
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" ) AND
                 ( COMB-HOJOKBN           =  "1" )
               CONTINUE
             ELSE
               IF    WK-TAX1001-KBN  =  "1"
                   COMPUTE  LNK-SYU-SKYMONEY-SKJ-JIHI-TAX  =
                          ( WK-SHOKUJI-FTN96  *  0.05 )  +  0.5
               ELSE
                   COMPUTE  LNK-SYU-SKYMONEY-SKJ-JIHI-TAX  =
                          ( WK-SHOKUJI-FTN96  *  0.05 )
               END-IF
             END-IF
           END-IF.
           COMPUTE  LNK-SYU-SKYMONEY-SKJ-JIHI-KEI
                                      = LNK-SYU-SKYMONEY-SKJ-JIHI
                                      + LNK-SYU-SKYMONEY-SKJ-JIHI-TAX.
      *
           COMPUTE  LNK-SYU-RYOYOHI-LIFE-JIHI  = WK-SHOKUJI-RYOYOHI95L
                                               + WK-SHOKUJI-RYOYOHI96L.
           COMPUTE  LNK-SYU-SKYMONEY-LIFE-JIHI = WK-SHOKUJI-FTN95L
                                               + WK-SHOKUJI-FTN96L.
           IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
             MOVE  WK-SKJ-ZEIKEIL  TO  LNK-SYU-SKYMONEY-LIFE-JIHI-TAX
             IF    WK-SHOKUJI-FTN96L  NOT =  ZERO
               COMPUTE  WK-SKJ-ZEITAISYO = WK-SKJ-ZEITAISYO
                                         + WK-SHOKUJI-FTN96L
                                         + WK-SKJ-ZEIKEIL
             END-IF
           ELSE
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" ) AND
                 ( COMB-HOJOKBN           =  "1" )
               CONTINUE
             ELSE
               IF    WK-TAX1001-KBN  =  "1"
                   COMPUTE  LNK-SYU-SKYMONEY-LIFE-JIHI-TAX  =
                          ( WK-SHOKUJI-FTN96L  *  0.05 )  +  0.5
               ELSE
                   COMPUTE  LNK-SYU-SKYMONEY-LIFE-JIHI-TAX  =
                          ( WK-SHOKUJI-FTN96L  *  0.05 )
               END-IF
             END-IF
           END-IF.
           COMPUTE  LNK-SYU-SKYMONEY-LIFE-JIHI-KEI
                                 = LNK-SYU-SKYMONEY-LIFE-JIHI
                                 + LNK-SYU-SKYMONEY-LIFE-JIHI-TAX.
      *
      *    収納テーブルの公費毎の患者負担金額をセットする
           IF   (COMB-KOH1HKNNUM         NOT = SPACE)   AND
                (COMB-KOH1-NYUJGNKBN     =     "1")
             IF  ( LNK-S02-KOUREI-NYUIN-KBN     =        "1"  )
             AND ( COMB-KOH1HKNNUM              =       "027" )
                  CONTINUE
             ELSE
               IF  (( FLG-KOUGAKUCYO2    NOT =    ZERO ) AND
                    ( FLG-IRYOHI2            =     1   ))
               OR  (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                    ( FLG-IRYOHI3X           =     11  ) AND
                    ( FLG-SYOUKAN(1)         =    "1"  ))
               OR  (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                    ( FLG-IRYOHI5        =   11 OR 12  ))
               OR  (  FLG-KOUGAKUCYO-JIRITU
                                         NOT =    ZERO  )
               OR  (  FLG-KOUGAKUCYO-GEN70K
                                         NOT =    ZERO  )
               OR  (( FLG-KOUGAKUCYO-GEN70
                                         NOT =    ZERO ) AND
                    ( FLG-IRYOHI70       =   3  OR 4   ) AND
                    ( FLG-SYOUKAN(1)         =    "1"  ))
               OR  (  WK-TAIHI-KANSEN11(1)   =     1    )
                    MOVE     LNK-SYU-KOH1COMPFTN  TO
                                          LNK-SYU-KOH1HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =                  
                                    LNK-SYU-KOH1COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =                  
                                    LNK-SYU-KOH1HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =                  
                                    LNK-SYU-KOH1HKNFTNMONEY *  10        
               END-IF
             END-IF
           END-IF.
           IF   (COMB-KOH2HKNNUM        NOT = SPACE)   AND
                (COMB-KOH2-NYUJGNKBN    =     "1")
               IF  (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                    ( FLG-IRYOHI3X           =     21  ) AND
                    ( FLG-SYOUKAN(2)         =    "1"  ))
               OR  (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                    ( FLG-IRYOHI5            =    21   ))
               OR  (  WK-TAIHI-KANSEN11(2)   =     1    )
                    MOVE     LNK-SYU-KOH2COMPFTN  TO
                                          LNK-SYU-KOH2HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =                  
                                    LNK-SYU-KOH2COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =                  
                                    LNK-SYU-KOH2HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =                  
                                    LNK-SYU-KOH2HKNFTNMONEY *  10        
               END-IF
           END-IF.
           IF   (COMB-KOH3HKNNUM        NOT = SPACE)   AND
                (COMB-KOH3-NYUJGNKBN    =     "1")
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =                  
                                    LNK-SYU-KOH3COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =                  
                                    LNK-SYU-KOH3HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =                  
                                    LNK-SYU-KOH3HKNFTNMONEY *  10        
           END-IF.
           IF   (COMB-KOH4HKNNUM        NOT = SPACE)   AND
                (COMB-KOH4-NYUJGNKBN    =     "1")
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =                  
                                    LNK-SYU-KOH4COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =                  
                                    LNK-SYU-KOH4HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =                  
                                    LNK-SYU-KOH4HKNFTNMONEY *  10        
           END-IF.
      *
      *    レセ記載金額退避用エリアから収納項目へ編集
      *
           IF    COMB-KOH1HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(1)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(1) = SPACE
                AND  COMB-KOH1HKNNUM       NOT = "027"
                  IF (( FLG-KOUGAKUCYO2    NOT =    ZERO ) AND
                      ( FLG-IRYOHI2            =     1   ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHI3X           =     11  ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                      ( FLG-IRYOHI5        =   11 OR 12  ))
                  OR (  FLG-KOUGAKUCYO-JIRITU
                                           NOT =    ZERO  )
                  OR (  FLG-KOUGAKUCYO-GEN70K
                                           NOT =    ZERO  )
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70       =   3  OR 4   ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (  WK-TAIHI-KANSEN11(1)   =     1    )
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(1)  TO   LNK-SYU-KOH1COMPFTN       
                COMPUTE   LNK-SYU-KOH1COMPTOTAL   =
                          LNK-SYU-KOH1COMPFTN     
             END-IF                                                      
             IF    WK-DAY-KOH-COMPFTN(1)  =  ALL"9"
                IF   WK-TAIHI-RECEFTNDSPKBN(1) = SPACE
                AND  COMB-KOH1HKNNUM       NOT = "027"
                  IF (( FLG-KOUGAKUCYO2    NOT =    ZERO ) AND
                      ( FLG-IRYOHI2            =     1   ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHI3X           =     11  ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                      ( FLG-IRYOHI5        =   11 OR 12  ))
                  OR (  FLG-KOUGAKUCYO-JIRITU
                                           NOT =    ZERO  )
                  OR (  FLG-KOUGAKUCYO-GEN70K
                                           NOT =    ZERO  )
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70       =   3  OR 4   ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (  WK-TAIHI-KANSEN11(1)   =     1    )
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                IF   WK-TAIHI-RECEFTNDSPKBN(1) = SPACE
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    WK-DAY-KOH-COMPFTN(1)   +   5
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN
                ELSE
                    MOVE     WK-DAY-KOH-COMPFTN(1)
                                         TO   LNK-SYU-KOH1COMPFTN
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN
                END-IF
             END-IF
           END-IF.
      *
           IF    COMB-KOH2HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(2)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(2) = SPACE
                  IF (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHI3X           =     21  ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                      ( FLG-IRYOHI5            =     21  ))
                  OR (  WK-TAIHI-KANSEN11(2)   =     1    )
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(2)  TO   LNK-SYU-KOH2COMPFTN       
                COMPUTE   LNK-SYU-KOH2COMPTOTAL   =
                          LNK-SYU-KOH2COMPFTN     
             END-IF                                                      
             IF    WK-DAY-KOH-COMPFTN(2)  =  ALL"9"
                IF   WK-TAIHI-RECEFTNDSPKBN(2) = SPACE
                  IF (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHI3X           =     21  ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                      ( FLG-IRYOHI5            =     21  ))
                  OR (  WK-TAIHI-KANSEN11(2)   =     1    )
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                IF   WK-TAIHI-RECEFTNDSPKBN(2) = SPACE
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    WK-DAY-KOH-COMPFTN(2)   +   5
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN
                ELSE
                    MOVE     WK-DAY-KOH-COMPFTN(2)
                                         TO   LNK-SYU-KOH2COMPFTN
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN
                END-IF
             END-IF
           END-IF.
      *
           IF    COMB-KOH3HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(3)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(3) = SPACE
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(3)  TO   LNK-SYU-KOH3COMPFTN       
                COMPUTE   LNK-SYU-KOH3COMPTOTAL   =
                          LNK-SYU-KOH3COMPFTN     
             END-IF                                                      
             IF    WK-DAY-KOH-COMPFTN(3)  =  ALL"9"
                IF   WK-TAIHI-RECEFTNDSPKBN(3) = SPACE
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN
                END-IF
             ELSE                                                         
                IF   WK-TAIHI-RECEFTNDSPKBN(3) = SPACE
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    WK-DAY-KOH-COMPFTN(3)   +   5
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN
                ELSE
                    MOVE     WK-DAY-KOH-COMPFTN(3)
                                         TO   LNK-SYU-KOH3COMPFTN
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN
                END-IF
             END-IF
           END-IF.
      *
           IF    COMB-KOH4HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(4)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(4) = SPACE
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(4)  TO   LNK-SYU-KOH4COMPFTN       
                COMPUTE   LNK-SYU-KOH4COMPTOTAL   =
                          LNK-SYU-KOH4COMPFTN     
             END-IF                                                      
             IF    WK-DAY-KOH-COMPFTN(4)  =  ALL"9"
                IF   WK-TAIHI-RECEFTNDSPKBN(4) = SPACE
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN
                END-IF
             ELSE                                                         
                IF   WK-TAIHI-RECEFTNDSPKBN(4) = SPACE
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    WK-DAY-KOH-COMPFTN(4)   +   5
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN
                ELSE
                    MOVE     WK-DAY-KOH-COMPFTN(4)
                                         TO   LNK-SYU-KOH4COMPFTN
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN
                END-IF
             END-IF
           END-IF.
      *
      *    特殊計算用金額退避編集
           PERFORM   23093-TOKUSYU-HENSYU-SEC.
      *
      *    主保険・老人保険の金額置き換え
           IF   COMB-HKNNUM            NOT =   SPACE
           AND  LNK-SYU-SYUCOMPFTN     NOT =    ZERO
           AND  FLG-KOUGAKUCYO         NOT =     1  
           AND  FLG-KOUGAKUCYO3        NOT =     1  
           AND  FLG-KOUGAKUCYO-ININ    NOT =     1
           AND  COMB-SYU-HKNKOHSBTKBN  NOT =    "8"
           AND  FLG-KOUGAKUCYO-GEN70   NOT =     1
      *
                 COMPUTE   LNK-SYU-SYUCOMPFTN  =
                           LNK-SYU-SYUCOMPFTN  +  5
                 COMPUTE   WK-FTN      =
                           LNK-SYU-SYUCOMPFTN  / 10
                 COMPUTE   LNK-SYU-SYUCOMPFTN  =
                           WK-FTN   *  10
                 COMPUTE   LNK-SYU-SYUCOMPTOTAL =
                           LNK-SYU-SYUCOMPFTN
      *
           END-IF.
      *
           IF   COMB-KOH1HKNNUM            =   "027"
           AND  LNK-SYU-KOH1COMPFTN    NOT =    ZERO
           AND  FLG-KOUGAKUCYO         NOT =     1  
           AND  FLG-KOUGAKUCYO3        NOT =     1  
      *
                 COMPUTE   LNK-SYU-KOH1COMPFTN  =
                           LNK-SYU-KOH1COMPFTN  +  5
                 COMPUTE   WK-FTN      =
                           LNK-SYU-KOH1COMPFTN  / 10
                 COMPUTE   LNK-SYU-KOH1COMPFTN  =
                           WK-FTN   *  10
                 COMPUTE   LNK-SYU-KOH1COMPTOTAL =
                           LNK-SYU-KOH1COMPFTN
      *
           END-IF.
      *
      *    ４１老人用
           IF   FLG-KOUGAKUCYO2        NOT =    ZERO
              IF  (FLG-IRYOHI2 = 1) AND (FLG-HIKAKU = 1)
                  CONTINUE
              ELSE
                  MOVE    ZERO     TO    FLG-KOUGAKUCYO2
              END-IF
           END-IF.
           IF   FLG-KOUGAKUCYO-JIRITU  NOT =    ZERO
              IF   FLG-HIKAKU     =     1
                  CONTINUE
              ELSE
                  MOVE     ZERO      TO    FLG-KOUGAKUCYO-JIRITU
              END-IF
           END-IF.
      *
           IF   FLG-KOUGAKUCYO3        NOT =    ZERO
              IF ((FLG-IRYOHI3X = 11      ) AND (FLG-SYOUKAN(1) = "1")
                                            AND (FLG-HIKAKU     =  1 ))
              OR ((FLG-IRYOHI3X = 21      ) AND (FLG-SYOUKAN(2) = "1")
                                            AND (FLG-HIKAKU     =  2 ))
                  CONTINUE
              ELSE
                  MOVE    ZERO     TO    FLG-KOUGAKUCYO3
              END-IF
           END-IF.
      *
           IF   FLG-KOUGAKUCYO5        NOT =    ZERO
              IF ((FLG-IRYOHI5 = 11 OR 12 ) AND (FLG-HIKAKU = 1))
              OR ((FLG-IRYOHI5 = 21       ) AND (FLG-HIKAKU = 2))
                  CONTINUE
              ELSE
                  MOVE    ZERO     TO    FLG-KOUGAKUCYO5
              END-IF
           END-IF.
      *
           IF   FLG-KOUGAKUCYO-GEN70    =    1
              EVALUATE  FLG-IRYOHI70
                WHEN      1
                WHEN      2
                    CONTINUE
                WHEN      3
                WHEN      4
                  IF  (FLG-SYOUKAN(1) =    "1")
                  AND (FLG-HIKAKU     =     1 )
                    CONTINUE
                  ELSE
                    MOVE    ZERO   TO    FLG-KOUGAKUCYO-GEN70
                  END-IF
                WHEN      6
                    MOVE    ZERO   TO    FLG-KOUGAKUCYO-GEN70
              END-EVALUATE
           END-IF.
           IF   FLG-KOUGAKUCYO-GEN70K   =    1
               IF   FLG-HIKAKU     =     1
                    CONTINUE
               ELSE
                    MOVE    ZERO   TO    FLG-KOUGAKUCYO-GEN70K
               END-IF
           END-IF.
      *
           MOVE       ZERO         TO    FLG-KANSEN11.
           IF   WK-TAIHI-KANSEN11(1)    =    1
               IF   FLG-HIKAKU     =     1
                    MOVE    1      TO    FLG-KANSEN11
               END-IF
           END-IF.
           IF   WK-TAIHI-KANSEN11(2)    =    1
               IF   FLG-HIKAKU     =     2
                    MOVE    1      TO    FLG-KANSEN11
               END-IF
           END-IF.
      *
      *    日別データ置き換え編集処理
           PERFORM   23094-DAYDATA-OKIKAE-HENSYU-SEC.
      *
      *    現物給付に関する対象データフラグ編集
           PERFORM   23096-GENBUTU-TAISYODATA-HENSYU-SEC.
      *
       2309-FTNKIN-HIKAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費単位で計算した患者負担金から最小の値を選択セット
      ******************************************************************
       23091-FTNKIN-HIKAKU-CYOKI-SEC         SECTION.
      *
      *    請求額比較
           MOVE    ZERO               TO    WK-KEISAN-ENTANI
                                            WK-KEISAN1-ENTANI
                                            WK-KEISAN2-ENTANI
                                            WK-KEISAN3-ENTANI
                                            WK-KEISAN4-ENTANI
                                            WK-KEISAN9-ENTANI
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    公費１のみ
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO   WK-KEISAN9-ENTANI
                                                 WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN9-ENTANI
                                                 WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   MOVE    WK-KEISAN1-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               ELSE
                   MOVE    WK-KEISAN2-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                            TO   WK-KEISAN3-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   IF    WK-KEISAN1-ENTANI  <  WK-KEISAN3-ENTANI
                      MOVE    WK-KEISAN1-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               ELSE
                   IF    WK-KEISAN2-ENTANI  <  WK-KEISAN3-ENTANI
                      MOVE    WK-KEISAN2-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO   WK-KEISAN-ENTANI
               IF   WK-KEISAN-ENTANI  <  WK-KEISAN9-ENTANI
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                  TO   WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
           IF    WK-CYOKI-ZAN-ENTANI  <=  WK-KNJFTNKIN-ENTANI
               MOVE   WK-CYOKI-ZAN-ENTANI   TO   WK-KNJFTNKIN-ENTANI
           END-IF
      *
      *********************
      *
      *    請求額比較
           MOVE    ZERO               TO    WK-KEISAN
                                            WK-KEISAN1
                                            WK-KEISAN2
                                            WK-KEISAN3
                                            WK-KEISAN4
                                            WK-KEISAN9
           MOVE    ZERO               TO    WK-KEISAN-SKJ
                                            WK-KEISAN1-SKJ
                                            WK-KEISAN2-SKJ
                                            WK-KEISAN3-SKJ
                                            WK-KEISAN4-SKJ
                                            WK-KEISAN9-SKJ
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU-SKJ
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN
                                            WK-KNJFTNKIN-SKJ
      *
      *    公費１のみ
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE      ZERO                 TO   FLG-HIKAKU
               MOVE      ZERO                 TO   FLG-HIKAKU-SKJ
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ 
           END-IF
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE      1                    TO   FLG-HIKAKU
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   MOVE    1                  TO   FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN1-SKJ     TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ
               ELSE
                   MOVE    2                  TO   FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN2-SKJ     TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ
               END-IF
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               IF    WK-KEISAN1  <  WK-KEISAN2
                   MOVE      1                TO  FLG-HIKAKU
                   MOVE    WK-KEISAN1         TO  WK-KEISAN9
                                                  WK-KNJFTNKIN
               ELSE
                   MOVE      2                TO  FLG-HIKAKU
                   MOVE    WK-KEISAN2         TO  WK-KEISAN9
                                                  WK-KNJFTNKIN
               END-IF
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      MOVE    1               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN1-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ
                   ELSE
                      MOVE    3               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ 
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      MOVE    2               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN2-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ 
                   ELSE
                      MOVE    3               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ 
                   END-IF
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
               MOVE   LNK-SYU-KOH3COMPFTN     TO   WK-KEISAN3
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               MOVE   LNK-SYU-KOH4SKJ-FTN     TO   WK-KEISAN4-SKJ
               IF    WK-KEISAN1  <  WK-KEISAN2
                   IF    WK-KEISAN1  <  WK-KEISAN3
                      MOVE      1             TO  FLG-HIKAKU
                      MOVE    WK-KEISAN1      TO  WK-KEISAN9
                                                  WK-KNJFTNKIN
                   ELSE
                      MOVE      3             TO  FLG-HIKAKU
                      MOVE    WK-KEISAN3      TO  WK-KEISAN9
                                                  WK-KNJFTNKIN
                   END-IF
               ELSE
                   IF    WK-KEISAN2  <  WK-KEISAN3
                      MOVE      2             TO  FLG-HIKAKU
                      MOVE    WK-KEISAN2      TO  WK-KEISAN9
                                                  WK-KNJFTNKIN
                   ELSE
                      MOVE      3             TO  FLG-HIKAKU
                      MOVE    WK-KEISAN3      TO  WK-KEISAN9
                                                  WK-KNJFTNKIN
                   END-IF
               END-IF
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN1-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    1               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN1-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    3               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN2-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    2               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN2-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    3               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN-SKJ
               IF   WK-KEISAN  <  WK-KEISAN9
                   MOVE    ZERO                 TO   FLG-HIKAKU
                   MOVE    LNK-SYU-SYUCOMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF   WK-KEISAN-SKJ  <  WK-KEISAN9-SKJ
                   MOVE    ZERO                 TO   FLG-HIKAKU-SKJ
                   MOVE    LNK-SYU-SYUSKJ-FTN   TO   WK-KNJFTNKIN-SKJ 
               END-IF
           END-IF
      *
           IF    WK-CYOKI-ZAN  <=  WK-KNJFTNKIN
               MOVE     ZERO            TO     FLG-HIKAKU
               MOVE     WK-CYOKI-ZAN    TO     WK-KNJFTNKIN
           END-IF
      *
           .
      *
       23091-FTNKIN-HIKAKU-CYOKI-EXT.
           EXIT.
      *
      ******************************************************************
      *        公費単位で計算した患者負担金から最小の値を選択セット
      ******************************************************************
       23092-FTNKIN-HIKAKU-TUJYO-SEC         SECTION.
      *
      *    請求額比較
           MOVE    ZERO               TO    WK-KEISAN-ENTANI
                                            WK-KEISAN1-ENTANI
                                            WK-KEISAN2-ENTANI
                                            WK-KEISAN3-ENTANI
                                            WK-KEISAN4-ENTANI
                                            WK-KEISAN9-ENTANI
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    主保険のみ
           IF (COMB-KOH1HKNNUM              =    SPACE)    AND
              (COMB-KOH2HKNNUM              =    SPACE)    AND
              (COMB-KOH3HKNNUM              =    SPACE)    AND
              (COMB-KOH4HKNNUM              =    SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO   WK-KEISAN9-ENTANI
                                                 WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１のみ
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN9-ENTANI
                                                 WK-KNJFTNKIN-ENTANI
           END-IF
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   MOVE    WK-KEISAN1-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               ELSE
                   MOVE    WK-KEISAN2-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                            TO   WK-KEISAN3-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   IF    WK-KEISAN1-ENTANI  <  WK-KEISAN3-ENTANI
                      MOVE    WK-KEISAN1-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               ELSE
                   IF    WK-KEISAN2-ENTANI  <  WK-KEISAN3-ENTANI
                      MOVE    WK-KEISAN2-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                            TO   WK-KEISAN3-ENTANI
               MOVE   LNK-SYU-KOH4COMPFTN-ENTANI
                                            TO   WK-KEISAN4-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   IF    WK-KEISAN1-ENTANI  <  WK-KEISAN3-ENTANI
                      IF    WK-KEISAN1-ENTANI  <  WK-KEISAN4-ENTANI
                        MOVE  WK-KEISAN1-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      ELSE
                        MOVE  WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-ENTANI  <  WK-KEISAN4-ENTANI
                        MOVE  WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      ELSE
                        MOVE  WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      END-IF
                   END-IF
               ELSE
                   IF    WK-KEISAN2-ENTANI  <  WK-KEISAN3-ENTANI
                      IF    WK-KEISAN2-ENTANI  <  WK-KEISAN4-ENTANI
                        MOVE  WK-KEISAN2-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      ELSE
                        MOVE  WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-ENTANI  <  WK-KEISAN4-ENTANI
                        MOVE  WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      ELSE
                        MOVE  WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO   WK-KEISAN-ENTANI
               IF   WK-KEISAN-ENTANI  <  WK-KEISAN9-ENTANI
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                  TO   WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
      *********************
      *
      *    請求額比較
           MOVE    ZERO               TO    WK-KEISAN
                                            WK-KEISAN1
                                            WK-KEISAN2
                                            WK-KEISAN3
                                            WK-KEISAN4
                                            WK-KEISAN9
           MOVE    ZERO               TO    WK-KEISAN-SKJ
                                            WK-KEISAN1-SKJ
                                            WK-KEISAN2-SKJ
                                            WK-KEISAN3-SKJ
                                            WK-KEISAN4-SKJ
                                            WK-KEISAN9-SKJ
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU-SKJ
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN
                                            WK-KNJFTNKIN-SKJ
      *    主保険のみ
           IF (COMB-KOH1HKNNUM              =    SPACE)    AND
              (COMB-KOH2HKNNUM              =    SPACE)    AND
              (COMB-KOH3HKNNUM              =    SPACE)    AND
              (COMB-KOH4HKNNUM              =    SPACE)
               MOVE      ZERO                 TO   FLG-HIKAKU
               MOVE      ZERO                 TO   FLG-HIKAKU-SKJ
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ 
           END-IF
      *    公費１のみ
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE      1                    TO   FLG-HIKAKU
               MOVE      1                    TO   FLG-HIKAKU-SKJ
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ 
           END-IF
      *    公費１と公費２
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               IF    WK-KEISAN1  <  WK-KEISAN2
                   MOVE      1                     TO  FLG-HIKAKU
                   MOVE    WK-KEISAN1              TO  WK-KEISAN9
                                                       WK-KNJFTNKIN
               ELSE
                   MOVE      2                     TO  FLG-HIKAKU
                   MOVE    WK-KEISAN2              TO  WK-KEISAN9
                                                       WK-KNJFTNKIN
               END-IF
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   MOVE      1                     TO  FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN1-SKJ          TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ
               ELSE
                   MOVE      2                     TO  FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN2-SKJ          TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ
               END-IF
           END-IF
      *    公費１と公費２と公費３
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
               MOVE   LNK-SYU-KOH3COMPFTN     TO   WK-KEISAN3
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               IF    WK-KEISAN1  <  WK-KEISAN2
                   IF    WK-KEISAN1  <  WK-KEISAN3
                      MOVE      1                  TO  FLG-HIKAKU
                      MOVE    WK-KEISAN1           TO  WK-KEISAN9
                                                       WK-KNJFTNKIN
                   ELSE
                      MOVE      3                  TO  FLG-HIKAKU
                      MOVE    WK-KEISAN3           TO  WK-KEISAN9
                                                       WK-KNJFTNKIN
                   END-IF
               ELSE
                   IF    WK-KEISAN2  <  WK-KEISAN3
                      MOVE      2                  TO  FLG-HIKAKU
                      MOVE    WK-KEISAN2           TO  WK-KEISAN9
                                                       WK-KNJFTNKIN
                   ELSE
                      MOVE      3                  TO  FLG-HIKAKU
                      MOVE    WK-KEISAN3           TO  WK-KEISAN9
                                                       WK-KNJFTNKIN
                   END-IF
               END-IF
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      MOVE      1                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN1-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ
                   ELSE
                      MOVE      3                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ 
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      MOVE      2                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN2-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ 
                   ELSE
                      MOVE      3                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ 
                   END-IF
               END-IF
           END-IF
      *    公費１と公費２と公費３と公費４
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
               MOVE   LNK-SYU-KOH3COMPFTN     TO   WK-KEISAN3
               MOVE   LNK-SYU-KOH4COMPFTN     TO   WK-KEISAN4
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               MOVE   LNK-SYU-KOH4SKJ-FTN     TO   WK-KEISAN4-SKJ
               IF    WK-KEISAN1  <  WK-KEISAN2
                   IF    WK-KEISAN1  <  WK-KEISAN3
                      IF    WK-KEISAN1  <  WK-KEISAN4
                        MOVE      1                 TO  FLG-HIKAKU
                        MOVE    WK-KEISAN1          TO  WK-KEISAN9
                                                        WK-KNJFTNKIN
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU
                        MOVE    WK-KEISAN4          TO  WK-KEISAN9
                                                        WK-KNJFTNKIN
                      END-IF
                   ELSE
                      IF    WK-KEISAN3  <  WK-KEISAN4
                        MOVE      3                 TO  FLG-HIKAKU
                        MOVE    WK-KEISAN3          TO  WK-KEISAN9
                                                        WK-KNJFTNKIN
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU
                        MOVE    WK-KEISAN4          TO  WK-KEISAN9
                                                        WK-KNJFTNKIN
                      END-IF
                   END-IF
               ELSE
                   IF    WK-KEISAN2  <  WK-KEISAN3
                      IF    WK-KEISAN2  <  WK-KEISAN4
                        MOVE      2                 TO  FLG-HIKAKU
                        MOVE    WK-KEISAN2          TO  WK-KEISAN9
                                                        WK-KNJFTNKIN
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU
                        MOVE    WK-KEISAN4          TO  WK-KEISAN9
                                                        WK-KNJFTNKIN
                      END-IF
                   ELSE
                      IF    WK-KEISAN3  <  WK-KEISAN4
                        MOVE      3                 TO  FLG-HIKAKU
                        MOVE    WK-KEISAN3          TO  WK-KEISAN9
                                                        WK-KNJFTNKIN
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU
                        MOVE    WK-KEISAN4          TO  WK-KEISAN9
                                                        WK-KNJFTNKIN
                      END-IF
                   END-IF
               END-IF
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN1-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      1                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN1-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      3                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN2-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      2                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN2-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      3                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN-SKJ
               IF   WK-KEISAN  <  WK-KEISAN9
                   MOVE    ZERO                 TO   FLG-HIKAKU
                   MOVE    LNK-SYU-SYUCOMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF   WK-KEISAN-SKJ  <  WK-KEISAN9-SKJ
                   MOVE    ZERO                 TO   FLG-HIKAKU-SKJ
                   MOVE    LNK-SYU-SYUSKJ-FTN   TO   WK-KNJFTNKIN-SKJ 
               END-IF
           END-IF
      *
           .
      *
       23092-FTNKIN-HIKAKU-TUJYO-EXT.
           EXIT.
      *
      ******************************************************************
      *        特殊計算用金額退避編集
      ******************************************************************
       23093-TOKUSYU-HENSYU-SEC         SECTION.
      *
           IF ((WK-1001-PREFNUM             =  07      ) AND
               (LNK-SYU-SRYYMD(1:6)        >= "200412" ) AND
               ((LNK-SYU-KOH1HKNNUM         = "245"   ) OR
                (LNK-SYU-KOH2HKNNUM         = "245"   ) OR
                (LNK-SYU-KOH3HKNNUM         = "245"   ) OR
                (LNK-SYU-KOH4HKNNUM         = "245"   )))
           OR ((WK-1001-PREFNUM             =  07      ) AND
               (LNK-SYU-SRYYMD(1:6)        >= "200604" ) AND
               ((LNK-SYU-KOH1HKNNUM         = "246"   ) OR
                (LNK-SYU-KOH2HKNNUM         = "246"   ) OR
                (LNK-SYU-KOH3HKNNUM         = "246"   ) OR
                (LNK-SYU-KOH4HKNNUM         = "246"   )))
      *
      ***
                    IF   LNK-SYU-KOH1HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH3HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH4HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(4) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(4)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(4) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
      ***
      *
                    IF  ( FLG-KOUGAKUCYO-GEN70  NOT =    ZERO     )
                    AND ( FLG-IRYOHI70          =   3  OR  4      )
                    AND ( LNK-SYU-KOH1HKNNUM    =  "245" OR "246" )
                      MOVE     WK-TOKUSYU-COMPFTN   TO
                                         LNK-SYU-JYO-HKNFTNMONEY
                    ELSE
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    WK-TOKUSYU-COMPFTN        +    5
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   /   10
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   *   10
                    END-IF
      *
                    MOVE  WK-TOKUSYU-COMPFTN   TO   LNK-SYU-JYO-COMPFTN
                    IF    WK-TOKUSYU-COMPFTN2  =  9999999
                       IF ((LNK-SYU-KOH1HKNNUM   = "245" OR "246") AND
                           (WK-TAIHI-RECEFTNDSPKBN(1) = SPACE    ))
                       OR ((LNK-SYU-KOH2HKNNUM   = "245" OR "246") AND
                           (WK-TAIHI-RECEFTNDSPKBN(2) = SPACE    ))
                       OR ((LNK-SYU-KOH3HKNNUM   = "245" OR "246") AND
                           (WK-TAIHI-RECEFTNDSPKBN(3) = SPACE    ))
                       OR ((LNK-SYU-KOH4HKNNUM   = "245" OR "246") AND
                           (WK-TAIHI-RECEFTNDSPKBN(4) = SPACE    ))
                         IF  ( FLG-KOUGAKUCYO-GEN70  NOT =    ZERO     )
                         AND ( FLG-IRYOHI70          =   3  OR  4      )
                         AND ( LNK-SYU-KOH1HKNNUM    =  "245" OR "246" )
                           CONTINUE
                         ELSE
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       +    5
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       /   10
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       *   10
                         END-IF
                       END-IF
                    ELSE
                       MOVE  WK-TOKUSYU-COMPFTN2  TO
                                        LNK-SYU-JYO-COMPFTN
                    END-IF
      *
                    MOVE     WK-TOKUSYU-ENTANI    TO
                                        LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
           IF  (WK-1001-PREFNUM             =  33      )
           AND (LNK-SYU-SRYYMD(1:6)        >= "200110" )
           AND (LNK-SYU-SRYYMD(1:6)        <= "200609" )
           AND ((LNK-SYU-KOH1HKNNUM         = "285"   ) OR
                (LNK-SYU-KOH2HKNNUM         = "285"   ) OR
                (LNK-SYU-KOH3HKNNUM         = "285"   ) OR
                (LNK-SYU-KOH4HKNNUM         = "285"   ))
      *
      ***
                    IF   LNK-SYU-KOH1HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH3HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH4HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(4) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(4)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(4) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
      ***
      *
                    COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    WK-TOKUSYU-COMPFTN        +    5
                    COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   /   10
                    COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   *   10
      *
                    MOVE  WK-TOKUSYU-COMPFTN   TO   LNK-SYU-JYO-COMPFTN
                    IF    WK-TOKUSYU-COMPFTN2  =  9999999
                       IF ((LNK-SYU-KOH1HKNNUM        = "285") AND
                           (WK-TAIHI-RECEFTNDSPKBN(1) = SPACE))
                       OR ((LNK-SYU-KOH2HKNNUM        = "285") AND
                           (WK-TAIHI-RECEFTNDSPKBN(2) = SPACE))
                       OR ((LNK-SYU-KOH3HKNNUM        = "285") AND
                           (WK-TAIHI-RECEFTNDSPKBN(3) = SPACE))
                       OR ((LNK-SYU-KOH4HKNNUM        = "285") AND
                           (WK-TAIHI-RECEFTNDSPKBN(4) = SPACE))
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       +    5
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       /   10
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       *   10
                       END-IF
                    ELSE
                       MOVE  WK-TOKUSYU-COMPFTN2  TO
                                        LNK-SYU-JYO-COMPFTN
                    END-IF
      *
                    MOVE     WK-TOKUSYU-ENTANI    TO
                                        LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
           IF  (WK-1001-PREFNUM             =  13      )
           AND (LNK-SYU-SRYYMD(1:6)        >= "200610" )
           AND ((LNK-SYU-KOH1HKNNUM         = "182"   ) OR
                (LNK-SYU-KOH2HKNNUM         = "182"   ) OR
                (LNK-SYU-KOH3HKNNUM         = "182"   ) OR
                (LNK-SYU-KOH4HKNNUM         = "182"   ))
      *
      ***
                    IF   LNK-SYU-KOH1HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH3HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH4HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(4) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(4)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(4) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
      ***
      *
                    IF (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                        ( FLG-IRYOHI3X           =     11  ) AND
                        ( LNK-SYU-KOH1HKNNUM     =    "182"))
                    OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                        ( FLG-IRYOHI3X           =     21  ) AND
                        ( LNK-SYU-KOH2HKNNUM     =    "182"))
                    OR (( FLG-KOUGAKUCYO-GEN70
                                             NOT =    ZERO ) AND
                        ( FLG-IRYOHI70       =   3  OR  4  ) AND
                        ( LNK-SYU-KOH1HKNNUM     =    "182"))
                      MOVE     WK-TOKUSYU-COMPFTN   TO
                                         LNK-SYU-JYO-HKNFTNMONEY
                    ELSE
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    WK-TOKUSYU-COMPFTN        +    5
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   /   10
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   *   10
                    END-IF
      *
                    MOVE  WK-TOKUSYU-COMPFTN   TO   LNK-SYU-JYO-COMPFTN
                    IF    WK-TOKUSYU-COMPFTN2  =  9999999
                       IF ((LNK-SYU-KOH1HKNNUM        = "182") AND
                           (WK-TAIHI-RECEFTNDSPKBN(1) = SPACE))
                       OR ((LNK-SYU-KOH2HKNNUM        = "182") AND
                           (WK-TAIHI-RECEFTNDSPKBN(2) = SPACE))
                       OR ((LNK-SYU-KOH3HKNNUM        = "182") AND
                           (WK-TAIHI-RECEFTNDSPKBN(3) = SPACE))
                       OR ((LNK-SYU-KOH4HKNNUM        = "182") AND
                           (WK-TAIHI-RECEFTNDSPKBN(4) = SPACE))
                         IF (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                             ( FLG-IRYOHI3X           =     11  ) AND
                             ( LNK-SYU-KOH1HKNNUM     =    "182"))
                         OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                             ( FLG-IRYOHI3X           =     21  ) AND
                             ( LNK-SYU-KOH2HKNNUM     =    "182"))
                         OR (( FLG-KOUGAKUCYO-GEN70
                                                  NOT =    ZERO ) AND
                             ( FLG-IRYOHI70       =   3  OR  4  ) AND
                             ( LNK-SYU-KOH1HKNNUM     =    "182"))
                           CONTINUE
                         ELSE
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       +    5
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       /   10
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       *   10
                         END-IF
                       END-IF
                    ELSE
                       MOVE  WK-TOKUSYU-COMPFTN2  TO
                                        LNK-SYU-JYO-COMPFTN
                    END-IF
      *
                    MOVE     WK-TOKUSYU-ENTANI    TO
                                        LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
           IF ((WK-1001-PREFNUM             =  11      ) AND
               (LNK-SYU-SRYYMD(1:6)        >= "200704" ) AND
               ((LNK-SYU-KOH1HKNNUM   = "181" OR "182"
                                     OR "183" OR "281") OR
                (LNK-SYU-KOH2HKNNUM   = "181" OR "182"
                                     OR "183" OR "281") OR
                (LNK-SYU-KOH3HKNNUM   = "181" OR "182"
                                     OR "183" OR "281") OR
                (LNK-SYU-KOH4HKNNUM   = "181" OR "182"
                                     OR "183" OR "281")))
           OR ((WK-1001-PREFNUM             =  11      ) AND
               (LNK-SYU-SRYYMD(1:6)        >= "200710" ) AND
               ((LNK-SYU-KOH1HKNNUM         = "543"   ) OR
                (LNK-SYU-KOH2HKNNUM         = "543"   ) OR
                (LNK-SYU-KOH3HKNNUM         = "543"   ) OR
                (LNK-SYU-KOH4HKNNUM         = "543"   )))
           OR ((WK-1001-PREFNUM             =  11      ) AND
               (LNK-SYU-SRYYMD(1:6)        >= "200801" ) AND
               ((LNK-SYU-KOH1HKNNUM         = "381"   ) OR
                (LNK-SYU-KOH2HKNNUM         = "381"   ) OR
                (LNK-SYU-KOH3HKNNUM         = "381"   ) OR
                (LNK-SYU-KOH4HKNNUM         = "381"   )))
           OR ((WK-1001-PREFNUM             =  11             ) AND
               (LNK-SYU-SRYYMD(1:6)        >= "200804"        ) AND
               ((LNK-SYU-KOH1HKNNUM = "743" OR "442" OR "542") OR
                (LNK-SYU-KOH2HKNNUM = "743" OR "442" OR "542") OR
                (LNK-SYU-KOH3HKNNUM = "743" OR "442" OR "542") OR
                (LNK-SYU-KOH4HKNNUM = "743" OR "442" OR "542")))
      *
      ***
                    IF   LNK-SYU-KOH1HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH3HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
                    IF   LNK-SYU-KOH4HKNNUM   = "972" OR "974"
                       IF  LNK-SYU-KOH-COMPFTN(4) < WK-TOKUSYU-COMPFTN
                          MOVE  LNK-SYU-KOH-COMPFTN(4)
                                            TO  WK-TOKUSYU-COMPFTN
                          MOVE  9999999     TO  WK-TOKUSYU-COMPFTN2
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(4) 
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                    END-IF
      ***
      *
                    IF  ( FLG-KOUGAKUCYO-GEN70  NOT =    ZERO     )
                    AND ( FLG-IRYOHI70          =   3  OR  4      )
                    AND ( LNK-SYU-KOH1HKNNUM    =  "181" OR "182"
                                                OR "183" OR "281"
                                                OR "543" OR "381"
                                                OR "743" OR "442" )
                      MOVE     WK-TOKUSYU-COMPFTN   TO
                                         LNK-SYU-JYO-HKNFTNMONEY
                    ELSE
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    WK-TOKUSYU-COMPFTN        +    5
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   /   10
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   *   10
                    END-IF
      *
                    MOVE  WK-TOKUSYU-COMPFTN   TO   LNK-SYU-JYO-COMPFTN
                    IF    WK-TOKUSYU-COMPFTN2  =  9999999
                       IF ((LNK-SYU-KOH1HKNNUM   = "181" OR "182"
                                                OR "183" OR "281"
                                                OR "543" OR "381"
                                                OR "743" OR "442"
                                                         OR "542") AND
                           (WK-TAIHI-RECEFTNDSPKBN(1) = SPACE    ))
                       OR ((LNK-SYU-KOH2HKNNUM   = "181" OR "182"
                                                OR "183" OR "281"
                                                OR "543" OR "381"
                                                OR "743" OR "442"
                                                         OR "542") AND
                           (WK-TAIHI-RECEFTNDSPKBN(2) = SPACE    ))
                       OR ((LNK-SYU-KOH3HKNNUM   = "181" OR "182"
                                                OR "183" OR "281"
                                                OR "543" OR "381"
                                                OR "743" OR "442"
                                                         OR "542") AND
                           (WK-TAIHI-RECEFTNDSPKBN(3) = SPACE    ))
                       OR ((LNK-SYU-KOH4HKNNUM   = "181" OR "182"
                                                OR "183" OR "281"
                                                OR "543" OR "381"
                                                OR "743" OR "442"
                                                         OR "542") AND
                           (WK-TAIHI-RECEFTNDSPKBN(4) = SPACE    ))
                         IF  ( FLG-KOUGAKUCYO-GEN70  NOT =    ZERO     )
                         AND ( FLG-IRYOHI70          =   3  OR  4      )
                         AND ( LNK-SYU-KOH1HKNNUM    =  "181" OR "182"
                                                     OR "183" OR "281"
                                                     OR "543" OR "381"
                                                     OR "743" OR "442" )
                           CONTINUE
                         ELSE
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       +    5
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       /   10
                           COMPUTE  LNK-SYU-JYO-COMPFTN  =
                                    LNK-SYU-JYO-COMPFTN       *   10
                         END-IF
                       END-IF
                    ELSE
                       MOVE  WK-TOKUSYU-COMPFTN2  TO
                                        LNK-SYU-JYO-COMPFTN
                    END-IF
      *
                    MOVE     WK-TOKUSYU-ENTANI    TO
                                        LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
           .
      *
       23093-TOKUSYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        日別データ置き換え編集処理
      ******************************************************************
       23094-DAYDATA-OKIKAE-HENSYU-SEC         SECTION.
      *
           PERFORM    VARYING   KOH-IDX2   FROM   1   BY   1
                       UNTIL    KOH-IDX2    >     4
      *
             IF   WK-DAYINFFLG(KOH-IDX2)   =    1
      *
               MOVE  LNK-SYU-KOH-HKNFTNMONEY(KOH-IDX2)
                                  TO   WK-DAYTAIHI-FTNMONEY
               MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX2)
                                  TO   WK-DAYTAIHI-COMPFTN
               COMPUTE  WK-DAYTAIHI-COMPFTNWK =
                        LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX2) + 0.9
      *
               PERFORM    VARYING   KOH-IDX3   FROM   1   BY   1
                           UNTIL    KOH-IDX3    >    31
      *
                   IF    KOHI-TBL(KOH-IDX3 KOH-IDX2)  =   9
      *
                       IF  LNK-SDAY-FTNMONEY(KOH-IDX3 KOH-IDX2)
                                        <=    WK-DAYTAIHI-FTNMONEY
                         COMPUTE WK-DAYTAIHI-FTNMONEY  =
                                 WK-DAYTAIHI-FTNMONEY  -
                                 LNK-SDAY-FTNMONEY(KOH-IDX3 KOH-IDX2)
                       ELSE
                         MOVE    WK-DAYTAIHI-FTNMONEY  TO
                                 LNK-SDAY-FTNMONEY(KOH-IDX3 KOH-IDX2)
                         MOVE    ZERO    TO   WK-DAYTAIHI-FTNMONEY
                       END-IF
      *
                       IF  LNK-SDAY-COMPFTN(KOH-IDX3 KOH-IDX2)
                                        <=    WK-DAYTAIHI-COMPFTN
                         COMPUTE WK-DAYTAIHI-COMPFTN  =
                                 WK-DAYTAIHI-COMPFTN  -
                                 LNK-SDAY-COMPFTN(KOH-IDX3 KOH-IDX2)
                       ELSE
                         MOVE    WK-DAYTAIHI-COMPFTN   TO
                                 LNK-SDAY-COMPFTN(KOH-IDX3 KOH-IDX2)
                         MOVE    ZERO    TO   WK-DAYTAIHI-COMPFTN
                       END-IF
      *
                       IF  LNK-SDAY-COMPFTNWK(KOH-IDX3 KOH-IDX2)
                                        <=    WK-DAYTAIHI-COMPFTNWK
                         COMPUTE WK-DAYTAIHI-COMPFTNWK  =
                                 WK-DAYTAIHI-COMPFTNWK  -
                                 LNK-SDAY-COMPFTNWK(KOH-IDX3 KOH-IDX2)
                       ELSE
                         MOVE    WK-DAYTAIHI-COMPFTNWK   TO  
                                 LNK-SDAY-COMPFTNWK(KOH-IDX3 KOH-IDX2)
                         MOVE    ZERO    TO   WK-DAYTAIHI-COMPFTNWK
                       END-IF
      *
                   END-IF
      *
               END-PERFORM
      *
             END-IF
      *
           END-PERFORM.
      *
       23094-DAYDATA-OKIKAE-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        大分県乳幼児特殊計算
      ******************************************************************
       23095-OITA-TOKUSYU-KEISAN-SEC         SECTION.
      *
           IF  (WK-1001-PREFNUM             =  44      )
           AND (LNK-SYU-SRYYMD(1:6)        >= "200610" )
           AND ((LNK-SYU-KOH1HKNNUM   = "183" OR "283" ) OR
                (LNK-SYU-KOH2HKNNUM   = "183" OR "283" ) OR
                (LNK-SYU-KOH3HKNNUM   = "183" OR "283" ) OR
                (LNK-SYU-KOH4HKNNUM   = "183" OR "283" ))
      *
             IF   LNK-SYU-KOH1HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-SYUCOMPFTN     TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   LNK-SYU-KOH2HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-KOH-COMPFTN(1) TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   LNK-SYU-KOH3HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-KOH-COMPFTN(2) TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   LNK-SYU-KOH4HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-KOH-COMPFTN(3) TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
      *
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  +    5
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  /   10
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  *   10
      *
             IF     FLG-GENBUTU70    NOT =    ZERO
                IF  (FLG-IRYOHI70       =    3   OR   4  )
                AND (LNK-SYU-KOH1HKNNUM =  "183" OR "283")
                AND (FLG-SYUKEI2        =   ZERO         )
                  COMPUTE WK-FUTANWARI   = WK-KOH-FTNRATE  /  100
                  COMPUTE WK-OITA-KEISAN = WK-KOUREI-IRYOHI70
                                         * WK-FUTANWARI
                  COMPUTE  WK-OITA-KEISAN  =
                           WK-OITA-KEISAN  +    5
                  COMPUTE  WK-OITA-KEISAN  =
                           WK-OITA-KEISAN  /   10
                  COMPUTE  WK-OITA-KEISAN  =
                           WK-OITA-KEISAN  *   10
                  IF      MAX-KIN-SYU-M  > WK-OITA-KEISAN
                    MOVE   WK-OITA-KEISAN  TO  WK-OITA-KEISAN2
                  ELSE
                    MOVE   MAX-KIN-SYU-M   TO  WK-OITA-KEISAN2
                  END-IF
                  IF   WK-OITA-KEISAN2  >  80100
                    COMPUTE  WK-OITA-CYOFTN-KON  =  WK-OITA-KEISAN2
                                                 -  80100
                    IF  WK-OITA-CYOFTN-KON   >  WK-OITA-CYOFTN
                       COMPUTE WK-OITA-CYOFTN-KON  = WK-OITA-CYOFTN-KON
                                                   - WK-OITA-CYOFTN
                    ELSE
                       MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
                    END-IF
                  ELSE
                    MOVE       ZERO    TO    WK-OITA-CYOFTN-KON
                  END-IF
                ELSE
                  MOVE         ZERO    TO    WK-OITA-CYOFTN-KON
                END-IF
                MOVE           ZERO    TO    LNK-SYU-JYO-HKNFTNMONEY
             ELSE
                IF (LNK-SYU-KOH1HKNNUM   = "972" OR "974" ) OR
                   (LNK-SYU-KOH2HKNNUM   = "972" OR "974" ) OR
                   (LNK-SYU-KOH3HKNNUM   = "972" OR "974" ) OR
                   (LNK-SYU-KOH4HKNNUM   = "972" OR "974" )
                  MOVE         ZERO    TO    LNK-SYU-JYO-HKNFTNMONEY
                  MOVE         ZERO    TO    WK-OITA-CYOFTN-KON
                ELSE
                  COMPUTE  WK-OITA-HKNFTNMONEY = WK-OITA-HKNFTNMONEY
                                               + LNK-SYU-JYO-HKNFTNMONEY
                  IF       WK-OITA-HKNFTNMONEY > 80100
                    COMPUTE  WK-OITA-CYOFTN-KON  =  WK-OITA-HKNFTNMONEY
                                                 -  80100
                    IF  WK-OITA-CYOFTN-KON   >  WK-OITA-CYOFTN
                       COMPUTE WK-OITA-CYOFTN-KON  = WK-OITA-CYOFTN-KON
                                                   - WK-OITA-CYOFTN
                    ELSE
                       MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
                    END-IF
                  ELSE
                    MOVE       ZERO    TO    WK-OITA-CYOFTN-KON
                  END-IF
                END-IF
             END-IF
      *
             MOVE    WK-OITA-CYOFTN-KON  TO  LNK-SYU-JYO-COMPFTN
      *
      *      請求額に加算
             COMPUTE  LNK-SYU-SKYMONEY  =
                      LNK-SYU-SKYMONEY  +    5
             COMPUTE  LNK-SYU-SKYMONEY  =
                      LNK-SYU-SKYMONEY  /   10
             COMPUTE  LNK-SYU-SKYMONEY  =
                      LNK-SYU-SKYMONEY  *   10
             ADD     WK-OITA-CYOFTN-KON  TO  LNK-SYU-SKYMONEY
                                             WK-KNJFTNKIN-ENTANI
             MOVE    1                   TO  FLG-KOUGAKUCYO-OITA
      *
           END-IF
      *
           .
      *
       23095-OITA-TOKUSYU-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *    現物給付に関する対象データフラグ編集
      ******************************************************************
       23096-GENBUTU-TAISYODATA-HENSYU-SEC         SECTION.
      *
           IF  (FLG-GENBUTU70       NOT =   ZERO)
           AND (FLG-GENBUTU-TAISYODATA  =    1  )
      *
               MOVE      ZERO            TO    FLG-GENBUTU-TAISYOOK
      *
               IF  ( COMB-KOH1HKNNUM   =  SPACE )
               AND ( COMB-KOH2HKNNUM   =  SPACE )
               AND ( COMB-KOH3HKNNUM   =  SPACE )
               AND ( COMB-KOH4HKNNUM   =  SPACE )
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
               ELSE
                 IF ( COMB-KOH1HKNNUM  =  "972" OR "974" )
                 OR ( COMB-KOH2HKNNUM  =  "972" OR "974" )
                 OR ( COMB-KOH3HKNNUM  =  "972" OR "974" )
                 OR ( COMB-KOH4HKNNUM  =  "972" OR "974" )
                         CONTINUE
                 ELSE
                   IF    COMB-KOH1HKNNUM  NOT = SPACE
                      IF  WK-GENBUTU-KOH1COMPFTN  NOT = ZERO
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
                      END-IF
                   END-IF
                   IF    COMB-KOH2HKNNUM  NOT = SPACE
                      IF  WK-GENBUTU-KOH2COMPFTN  NOT = ZERO
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
                      END-IF
                   END-IF
                   IF    COMB-KOH3HKNNUM  NOT = SPACE
                      IF  WK-GENBUTU-KOH3COMPFTN  NOT = ZERO
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
                      END-IF
                   END-IF
                   IF    COMB-KOH4HKNNUM  NOT = SPACE
                      IF  WK-GENBUTU-KOH4COMPFTN  NOT = ZERO
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
                      END-IF
                   END-IF
                 END-IF
               END-IF
      *
               IF   FLG-GENBUTU-TAISYOOK  =  1
                   MOVE    "9"    TO    LNK-SYU-KOHTAIYKZKBN
               END-IF
      *
           END-IF
      *
           .
      *
       23096-GENBUTU-TAISYODATA-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険番号マスター読込
      *****************************************************************
       HKNNUM-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNNUM-REC
               MOVE    ZERO            TO  FLG-HKNNUM
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
      *
           .
       HKNNUM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスター読込
      *****************************************************************
       HKNCOMBI-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNCOMBI-REC
               MOVE    ZERO            TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                  HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           .
       HKNCOMBI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスター読込
      *****************************************************************
       HKNCOMBI-READ2-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  WRK-HKNCOMBI-REC
               MOVE    ZERO            TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                  WRK-HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           .
       HKNCOMBI-READ2-EXT.
           EXIT.
      *
      *****************************************************************
      *    システム管理マスター読込
      *****************************************************************
       SYSKANRI-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYS-1001-REC
                                           SYS-1026-REC
                                           SYS-1027-REC
                                           SYS-1037-REC
                                           SYS-4001-REC
                                           SYS-4003-REC
                                           SYS-5000-REC
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               INITIALIZE                  SYS-1001-REC
                                           SYS-1026-REC
                                           SYS-1027-REC
                                           SYS-1037-REC
                                           SYS-4001-REC
                                           SYS-4003-REC
                                           SYS-5000-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       SYSKANRI-READ-EXT.
           EXIT.
      *****************************************************************
      *    収納マスター読込
      *****************************************************************
       SYUNOU-READ-SEC          SECTION.
      *
       SYUNOU-READ-100.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYU-SYUNOU-REC
               IF     (LNK-S02-SAIKEISAN-KBN    =   "1")    AND
                      (LNK-S02-SAIKEISAN-DENPYO =   SYU-DENPNUM)
                       GO    TO    SYUNOU-READ-100
               ELSE
                       MOVE    ZERO    TO  FLG-SYUNOU
               END-IF
           ELSE
               INITIALIZE                  SYU-SYUNOU-REC
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           .
      *
       SYUNOU-READ-EXT.
           EXIT.
      *****************************************************************
      *    日別収納マスタ読込
      *****************************************************************
       SYUDAY-READ-SEC          SECTION.
      *
           INITIALIZE                         SYU-SYUDAY-REC
           MOVE    SYU-HOSPNUM        TO      SDAY-HOSPNUM
           MOVE    SYU-NYUGAIKBN      TO      SDAY-NYUGAIKBN
           MOVE    SYU-PTID           TO      SDAY-PTID
           MOVE    SYU-DENPNUM        TO      SDAY-DENPNUM
           MOVE    SYU-SYUDAY-REC     TO      MCPDATA-REC
           MOVE    "DBSELECT"         TO      MCP-FUNC
           MOVE    "tbl_syuday"       TO      MCP-TABLE
           MOVE    "key"              TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
           IF      MCP-RC             =       ZERO
               MOVE    "DBFETCH"      TO      MCP-FUNC
               MOVE    "tbl_syuday"   TO      MCP-TABLE
               MOVE    "key"          TO      MCP-PATHNAME
               CALL    "ORCDBMAIN"    USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
               IF      MCP-RC              =   ZERO
                  MOVE   MCPDATA-REC  TO  SYU-SYUDAY-REC
               ELSE
                  INITIALIZE              SYU-SYUDAY-REC
               END-IF
           ELSE
                  INITIALIZE              SYU-SYUDAY-REC
           END-IF
      *
           MOVE     "tbl_syuday"      TO      MCP-TABLE
           MOVE     "key"             TO      MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
      *
       SYUDAY-READ-EXT.
           EXIT.
      *****************************************************************
      *    患者情報読込
      *****************************************************************
       PTINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTINF-REC
               MOVE    ZERO            TO  FLG-PTINF
           ELSE
               INITIALIZE                  PTINF-REC
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           .
       PTINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院会計マスター読込
      *****************************************************************
       NYUINACCT-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  NYUINACCT-REC
               MOVE    ZERO            TO  FLG-NYUINACCT
           ELSE
               INITIALIZE                  NYUINACCT-REC
               MOVE    1               TO  FLG-NYUINACCT
           END-IF
      *
           .
       NYUINACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数テーブルの検索
      *****************************************************************
       TENSU-TBL-SEC               SECTION.
      *
           INITIALIZE                           TNS-TENSU-REC
           MOVE    WK-SRYCD             TO      TNS-SRYCD
           MOVE    LNK-SYU-HOSPNUM      TO      TNS-HOSPNUM
           MOVE    LNK-SYU-SRYYMD       TO      TNS-YUKOSTYMD
           MOVE    LNK-SYU-SRYYMD       TO      TNS-YUKOEDYMD
           MOVE    TNS-TENSU-REC        TO      MCPDATA-REC
           MOVE    "DBSELECT"           TO      MCP-FUNC
           MOVE    "tbl_tensu"          TO      MCP-TABLE
           MOVE    "key"                TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_tensu"      TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM  TENSU-READ-SEC
           ELSE
               MOVE     1               TO      FLG-TENSU
           END-IF
      *
           IF     FLG-TENSU    =    ZERO
              IF    LNK-SYU-SYUHKNNUM   =   "971" OR "973"
                EVALUATE  LNK-SYU-SYUHKNNUM
                  WHEN       "971"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   TNS-TEN    *  1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                    ELSE
                      MOVE   TNS-TEN   TO     WK-KEISAN
                    END-IF
                  WHEN       "973"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   TNS-TEN    *  1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      IF    WK-4001-SKJKBN      =   "2"
                         COMPUTE   WK-KEISAN    =   WK-KEISAN  *  1.2
                      END-IF
                    ELSE
                      MOVE   TNS-TEN   TO     WK-KEISAN
                    END-IF
                END-EVALUATE
              ELSE
                 MOVE      TNS-TEN     TO     WK-KEISAN
              END-IF
           ELSE
                 MOVE      ZERO        TO     WK-KEISAN
           END-IF
      *
           MOVE     "tbl_tensu"            TO  MCP-TABLE
           MOVE     "key"                  TO  MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
       TENSU-TBL-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数読込
      *****************************************************************
       TENSU-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
               MOVE    ZERO            TO  FLG-TENSU
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1               TO  FLG-TENSU
           END-IF
      *
           .
       TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費情報読込
      *****************************************************************
       PTKOHINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTKOHINF-REC
               MOVE    ZERO            TO  FLG-PTKOHINF
           ELSE
               INITIALIZE                  PTKOHINF-REC
               MOVE    1               TO  FLG-PTKOHINF
           END-IF
      *
           .
       PTKOHINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者保険情報読込
      *****************************************************************
       PTHKNINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTHKNINF-REC
               MOVE    ZERO            TO  FLG-PTHKNINF
           ELSE
               INITIALIZE                  PTHKNINF-REC
               MOVE    1               TO  FLG-PTHKNINF
           END-IF
      *
           .
       PTHKNINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスター読込
      *****************************************************************
       SRYACCT-READ-SEC        SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  SRYACCT-REC
               MOVE    ZERO               TO  FLG-SRYACCT
           ELSE
               INITIALIZE                     SRYACCT-REC
               MOVE    1                  TO  FLG-SRYACCT
           END-IF
      *
           .
       SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢクローズ処理
      *****************************************************************
       DB-CLOSE-SEC                 SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       DB-CLOSE-EXT.
           EXIT.
