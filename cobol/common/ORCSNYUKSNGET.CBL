      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCSNYUKSNGET.
      *****************************************************************
      *  システム名        : ＯＲＣＡ
      *  サブシステム名    : 入院
      *  コンポーネント名  : 入院料加算取得サブ
      *  管理者            : 
      *  作成日付    作業者        記述
      *  13/10/31    NACL−小豆沢  新規作成
      *****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  05.00.00    NACL-小豆沢  18/03/13  入院料と入院料加算のチェック
      *                                     を入院料加算チェックマスタから
      *                                     電子点数表マスタに変更
      *  05.00.00    NACL-小豆沢  18/03/13  特別入院基本料の判定変更
      *  05.00.00    NACL-小豆沢  18/03/30  療養病棟入院料２（経過措置２）を
      *                                     特別入院基本料の扱いに変更
      *  05.00.00    NACL-小豆沢  18/04/02  療養病棟入院料２（経過措置２）の
      *                                     乳幼児加算、幼児加算を暫定対処
      *  05.00.00    NACL-小豆沢  18/11/15  特定入院料算定要件外で療養病棟
      *                                     入院基本料Ｉ算定時の加算算定変更
      *****************************************************************
      *
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                        DIVISION.
      *FILE                        SECTION.
      *
       WORKING-STORAGE             SECTION.
      *
      *    フラグ領域
       01  FLG-AREA.
           03  FLG-SYSKANRI                PIC 9(01).
           03  FLG-PTINF                   PIC 9(01).
           03  FLG-TENSU                   PIC 9(01).
           03  FLG-NYUKSNCHK               PIC 9(01).
           03  FLG-NYUKSN                  PIC 9(01).
           03  FLG-ETENSU1                 PIC 9(01).
      *
      *    添字領域
       01  IDX-AREA.
           03  IDX                         PIC 9(05).
           03  IDX7                        PIC 9(05).
           03  IDX8                        PIC 9(05).
           03  IDX9                        PIC 9(05).
           03  IDX-KSN                     PIC 9(05).
      *
      *    一時領域
       01  WRK-AREA.
      *
      *    医療機関設定の入院料加算チェック用
           03  WRK-NYUKHNKSN-SRYCD         PIC X(09)  OCCURS 20.
           03  WRK-KHN-NYUKSNKBN           PIC X(03).
           03  WRK-NYUKSNKBN               PIC X(03).
           03  WRK-BTU-NYUKSNKBN           PIC X(03).
           03  WRK-BTU-CDKBN-KBNNUM        PIC 9(03).
           03  WRK-BTU-CDKBN-KBNNUM-EDA    PIC 9(02).
           03  WRK-BTU-CDKBN-KOUBAN        PIC 9(02).
           03  WRK-KSN-NYUKSNKBN           PIC X(03).
           03  WRK-KSN-CDKBN-KBNNUM        PIC 9(03).
           03  WRK-KSN-CDKBN-KBNNUM-EDA    PIC 9(02).
           03  WRK-KSN-CHUKSNCD            PIC X(04).
           03  WRK-KSN-CHUKSNTUBAN         PIC X(01).
      *
           03  WRK-TOKUBETSU-NYUIN         PIC X(01).
      *
      *    プレイルーム、保育士加算加算退避領域
           03  WRK-BTU-HIKSISUKBN          PIC X(01).
           03  WRK-BTU-KNGTEK-KBN          PIC X(01).
           03  WRK-BTU-DRTEK-KBN           PIC X(01).
      *
      *    患者年齢算出用エリア
           03  WRK-NENREI-AREA.
              05  WRK-NENREI               PIC 9(03).
              05  WRK-YMDS1.
                  07  WRK-YYS1             PIC 9(04).
                  07  WRK-MMS1             PIC 9(02).
                  07  WRK-DDS1             PIC 9(02).
              05  WRK-YMDS2.
                  07  WRK-YYS2             PIC 9(04).
                  07  WRK-MMS2             PIC 9(02).
                  07  WRK-DDS2             PIC 9(02).
      *
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    システム管理マスタ
           COPY    "CPSYSKANRI.INC".
      *    （医療機関情報）
           COPY    "CPSK5000.INC".
      *    （病棟情報）
           COPY    "CPSK5001.INC".
      *    （病室情報）
           COPY    "CPSK5002.INC".
      *
      *    患者マスタ
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    点数マスタ−
      *01  TENSU-REC.
           COPY    "CPTENSU.INC".
      *
      *    入院料加算チェック
       01  NYUKSNCHK-REC.
           COPY    "CPNYUKSNCHK.INC".
      *
      *    電子点数表マスタ
       01  ETENSU1-REC.
           COPY   "CPETENSU1.INC".
      *
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      *
           COPY    "MCPAREA".
      *
      *****************************************************************
      *    サブプロ用　領域
      *****************************************************************
      *
      *    日付変換サブ
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
           COPY    "CPORCSGDAY.INC".
      *
      *    夜勤時間超過減算入院料コード取得サブ
           COPY "CPORCSYAKINGEN.INC".
      *
      *    夜勤時間特別入院基本料コード取得サブ
           COPY "CPORCSYAKINTOKU.INC".
      *
      *    看護職員数等入院基本料コード取得サブ
           COPY "CPORCSKANGOCHG.INC".
      *
      *****************************************************************
      *    連絡　領域
      *****************************************************************
        LINKAGE                     SECTION.
      *
      *    入院料加算取得パラメタ
           COPY    "CPORCSNYUKSNGET.INC".
      *
      *    スパ領域
           COPY    "COMMON-SPA".
      *
       PROCEDURE                   DIVISION    USING
           ORCSNYUKSNGET-AREA
           SPA-AREA
           .
      *
      *****************************************************************
      *    主　　処理
      *****************************************************************
       000-PROC-SEC                    SECTION.
      *
           INITIALIZE                      FLG-AREA
           INITIALIZE                      IDX-AREA
           INITIALIZE                      WRK-AREA
           INITIALIZE                      LNK-NYUKSNGET-HENKYAKU-AREA
           MOVE    ZERO                TO  LNK-NYUKSNGET-RC
      *
           PERFORM    100-NYUKSN-GET-SEC
           .
      *
       000-PROC-EXT.
           EXIT   PROGRAM
           .
      *
      *****************************************************************
      *    入院料加算の取り込み処理
      *****************************************************************
       100-NYUKSN-GET-SEC            SECTION.
      *
           MOVE   ZERO             TO   IDX8
      *
      *医療機関加算情報
           INITIALIZE                  SYSKANRI-REC
           MOVE    SPA-HOSPNUM     TO  SYS-HOSPNUM
           MOVE    "5000"          TO  SYS-KANRICD
           MOVE    LNK-NYUKSNGET-SANTEIYM
                                   TO  SYS-STYUKYMD(1:6)
           MOVE   "01"             TO  SYS-STYUKYMD(7:2)
           MOVE    SYS-STYUKYMD    TO  SYS-EDYUKYMD
           MOVE    SYSKANRI-REC    TO  MCPDATA-REC
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBFETCH-SEC
           IF   MCP-RC             =    ZERO
               MOVE    MCPDATA-REC TO   SYS-5000-REC
      *        入院料加算
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL  (IDX7                    >   20)     OR
                        (SYS-5000-KSNCD(IDX7)    =   SPACE)
                    IF   SYS-5000-KSNKBN(IDX7)   =   "2"
      *                 平成２８年４月以降の病院設定は乳幼児加算(病院）だけと
      *                 なるので、患者年齢で置き換えする（診療所は従前のまま）
                        IF   LNK-NYUKSNGET-SANTEIYM   >=  "201604"
                           IF    SYS-5000-KSNCD(IDX7)   =   "190100470"
                               PERFORM   4801-PT-AGE-SEC
                               IF      WRK-NENREI          <      3
                                   MOVE  "190100470"  TO
                                                SYS-5000-KSNCD(IDX7)
                               ELSE
                                   MOVE  "190100770"  TO
                                                SYS-5000-KSNCD(IDX7)
                               END-IF
                           END-IF
                        END-IF
      *
                        ADD    1                TO  IDX8
                        MOVE   SYS-5000-KSNCD(IDX7)  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                    END-IF
               END-PERFORM
      *        地域加算
               IF   SYS-5000-CHIIKIKSN    NOT =   SPACE
                    ADD    1        TO   IDX8
                    MOVE   SYS-5000-CHIIKIKSN   TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *病棟加算情報
           PERFORM     4801-BTUSEL-SEC
      *
           IF   FLG-SYSKANRI           =    ZERO
      *
      *        看護補助加算
               IF    SYS-5001-BTU-KNGHJOKSN   NOT =   SPACE
                   ADD      1          TO     IDX8
                   EVALUATE     SYS-5001-BTU-KNGHJOKSN
                       WHEN     "01"
                           MOVE  "190103070"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "02"
                           MOVE  "190103470"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "03"
                           MOVE  "190103770"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "04"
                           MOVE  "190103970"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "05"
                           MOVE  "190104070"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
      *                平成１８年４月改正対応
                       WHEN     "06"
      *                    看護補助加算１
                           MOVE  "190103770"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "07"
      *                    看護補助加算１（１３対１入院基本料）
                           MOVE  "190103870"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "08"
      *                    看護補助加算２
                           MOVE  "190103970"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "09"
      *                    看護補助加算３
                           MOVE  "190104070"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                   END-EVALUATE
               END-IF
      *
      *        夜間勤務等看護加算
               IF    SYS-5001-BTU-YAKANKNGKSN   NOT =   SPACE
                   ADD      1          TO     IDX8
                   EVALUATE     SYS-5001-BTU-YAKANKNGKSN
                       WHEN     "01"
                           MOVE  "190109870"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "02"
                           MOVE  "190076070"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "03"
                           MOVE  "190076170"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "04"
                           MOVE  "190076370"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                       WHEN     "05"
                           MOVE  "190076470"   TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                   END-EVALUATE
               END-IF
      *
      *        小児入院医療管理料加算（保育士１人以上）
               MOVE  SPACE       TO   WRK-BTU-HIKSISUKBN
               IF    LNK-NYUKSNGET-NYUIN-SRYCD =   "190129310"  OR
                                                   "190111110"  OR
                                                   "190111210"  OR
                                                   "190075810"  OR
                                                   "190140710"
                   IF    SYS-5001-BTU-HIKSISUKBN   =   "2"
                       MOVE   "2"    TO   WRK-BTU-HIKSISUKBN
                   END-IF
               END-IF
      *
      *      病棟入院料加算
      *
      *      平成２０年３月までの加算セット処理
             IF     LNK-NYUKSNGET-SANTEIYM     <=     "200803"
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL  (IDX7                    >   14)
                   EVALUATE   IDX7
                       WHEN   3
                       WHEN   4
                       WHEN   5
                           CONTINUE
      *                児童思春期精神科入院医療管理加算（２０才未満）
                       WHEN   6
                           IF      SYS-5001-KSNKBN(IDX7)   =   "2"
                               PERFORM   4801-PT-AGE-SEC
                               IF      WRK-NENREI          <      20
                                   ADD    1                TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                               WRK-NYUKHNKSN-SRYCD(IDX8)
                               END-IF
                           END-IF
      *                看護配置適合加算
                       WHEN   13
                           MOVE  SPACE       TO   WRK-BTU-KNGTEK-KBN
                           IF    SYS-5001-KNGTEK-KBN   =   "2"
                               MOVE   "2"    TO   WRK-BTU-KNGTEK-KBN
                           END-IF
      *                複数医師及び看護配置適合加算
                       WHEN   14
                           MOVE  SPACE       TO   WRK-BTU-DRTEK-KBN
                           IF    SYS-5001-DRTEK-KBN   =   "2"
                               MOVE   "2"    TO   WRK-BTU-DRTEK-KBN
                           END-IF
                       WHEN   OTHER
                           IF     SYS-5001-KSNKBN(IDX7)    =   "2"
                               ADD    1                TO  IDX8
                               MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                           END-IF
                   END-EVALUATE
               END-PERFORM
             END-IF
      *
      *      平成２０年４月から平成２２年３月までの加算セット処理
             IF    (LNK-NYUKSNGET-SANTEIYM  >=   "200804")    AND
                   (LNK-NYUKSNGET-SANTEIYM  <=   "201003")
                 PERFORM   VARYING   IDX7   FROM   1  BY  1
                   UNTIL  (IDX7      >   14)
                     IF   SYS-5001-KSNKBN(IDX7)   =   "2"
                         EVALUATE    SYS-5001-KSNCD(IDX7)
      *                      児童思春期精神科入院医療管理加算（２０才未満）
                             WHEN    "190110170"
                                PERFORM   4801-PT-AGE-SEC
                                IF      WRK-NENREI   <      20
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      重症患者回復病棟加算（回復期リハビリテーション入院料１）
                             WHEN    "190129870"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                     = "190129410"  OR
                                                       "190129510"  
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      医師配置適合加算（有床診療所入院基本料１）
      *                      看護配置加算１（有床診療所入院基本料１）
      *                      看護配置加算２（有床診療所入院基本料１）
      *                      夜間看護配置加算１（有床診療所入院基本料１）
      *                      夜間看護配置加算２（有床診療所入院基本料１）
                             WHEN    "190117070"
                             WHEN    "190126570"
                             WHEN    "190109670"
                             WHEN    "190126670"
                             WHEN    "190126770"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190097010"
                                                        OR "190097110"
                                                        OR "190119510"
                                                        OR "190119610"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      夜間緊急体制確保加算（有床診療所入院基本料１と２）
                             WHEN    "190126470"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190097010"
                                                        OR "190097110"
                                                        OR "190119510"
                                                        OR "190119610"
                                                        OR "190097210"
                                                        OR "190097310"
                                                        OR "190119710"
                                                        OR "190119810"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
                             WHEN   OTHER
                                ADD    1                TO  IDX8
                                MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                         END-EVALUATE
                     END-IF
                 END-PERFORM
             END-IF
      *
      *      平成２２年４月から平成２４年３月までの加算セット処理
             IF    (LNK-NYUKSNGET-SANTEIYM    >=     "201004")    AND
                   (LNK-NYUKSNGET-SANTEIYM    <=     "201203")
      *         （システム管理の病棟設定見直しによるもの）
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL  (IDX7      >   14)
                     IF   SYS-5001-KSNKBN(IDX7)   =   "2"
                         EVALUATE    SYS-5001-KSNCD(IDX7)
      *                      児童思春期精神科入院医療管理加算（２０才未満）
                             WHEN    "190110170"
                                PERFORM   4801-PT-AGE-SEC
                                IF      WRK-NENREI   <      20
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      重症患者回復病棟加算（回復期リハビリテーション入院料１）
                             WHEN    "190129870"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190129410" OR
                                                         "190129510" OR
                                                         "190141610" OR
                                                         "190141710"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
      *                            基準未適合の場合は重症患者回復病棟加算（基準未適合）
      *                            に置き換える
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190129410" OR
                                                         "190129510"
                                     MOVE   "190142370"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
                                END-IF
      *                      医師配置加算１（有床診療所入院基本料１と２）
      *                      医師配置加算２（有床診療所入院基本料１と２）
      *                      看護配置加算１（有床診療所入院基本料１と２）
      *                      看護配置加算２（有床診療所入院基本料１と２）
      *                      夜間看護配置加算１（有床診療所入院基本料１と２）
      *                      夜間看護配置加算２（有床診療所入院基本料１と２）
                             WHEN    "190135570"
                             WHEN    "190117070"
                             WHEN    "190109670"
                             WHEN    "190126570"
                             WHEN    "190126770"
                             WHEN    "190126670"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      夜間緊急体制確保加算（有床診療所入院基本料１と２と３）
                             WHEN    "190126470"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      一般病棟看護必要度評価加算（１０対１入院基本料）
                             WHEN    "190131570"
      *                            一般病棟看護必要度評価加算
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190077410"
                                     ADD    1            TO  IDX8
                                     MOVE   "190131570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            一般病棟看護必要度評価加算（特定機能病院）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190085910"
                                     ADD    1            TO  IDX8
                                     MOVE   "190134870"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            一般病棟看護必要度評価加算（専門病院）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190090210"
                                     ADD    1            TO  IDX8
                                     MOVE   "190134970"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      休日リハビリテーション提供体制加算（回復期リハビリテーション病棟入院料）
                             WHEN    "190140870"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190141610" OR
                                                         "190141710" OR
                                                         "190141810" OR
                                                         "190141910"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
                             WHEN   OTHER
                                ADD    1                TO  IDX8
                                MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                         END-EVALUATE
                     END-IF
               END-PERFORM
             END-IF
      *
      *      平成２４年４月からの加算セット処理
             IF    (LNK-NYUKSNGET-SANTEIYM    >=     "201204")  AND
                   (LNK-NYUKSNGET-SANTEIYM    <=     "201403")
      *         （システム管理の病棟設定見直しによるもの）
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL  (IDX7      >   14)
                     IF   SYS-5001-KSNKBN(IDX7)   =   "2"
                         EVALUATE    SYS-5001-KSNCD(IDX7)
      *                      医師配置加算１（有床診療所入院基本料１と２）
      *                      医師配置加算２（有床診療所入院基本料１と２）
      *                      看護配置加算１（有床診療所入院基本料１と２）
      *                      看護配置加算２（有床診療所入院基本料１と２）
      *                      夜間看護配置加算１（有床診療所入院基本料１と２）
      *                      夜間看護配置加算２（有床診療所入院基本料１と２）
                             WHEN    "190135570"
                             WHEN    "190117070"
                             WHEN    "190109670"
                             WHEN    "190126570"
                             WHEN    "190126770"
                             WHEN    "190126670"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      夜間緊急体制確保加算（有床診療所入院基本料１と２と３）
                             WHEN    "190126470"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      一般病棟看護必要度評価加算（１３対１入院基本料）
                             WHEN    "190131570"
      *                            一般病棟看護必要度評価加算
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190077510"
                                     ADD    1            TO  IDX8
                                     MOVE   "190131570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            一般病棟看護必要度評価加算（専門病院）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190090310"
                                     ADD    1            TO  IDX8
                                     MOVE   "190134970"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            一般病棟看護必要度評価加算（特定一般病棟入院料１）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190151910"
                                     ADD    1            TO  IDX8
                                     MOVE   "190152570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      休日リハビリテーション提供体制加算（回復期リハビリテーション病棟入院料）
                             WHEN    "190140870"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190141610" OR
                                                         "190141710" OR
                                                         "190141810" OR
                                                         "190141910" OR
                                                         "190150110" OR
                                                         "190150210"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護必要度加算１（１０対１入院基本料）
                             WHEN    "190143070"
      *                         看護必要度加算１（一般病棟入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190077410"
                                   ADD    1            TO  IDX8
                                   MOVE   "190143070"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算１（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190143970"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算１（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190144570"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護必要度加算２（１０対１入院基本料）
                             WHEN    "190143170"
      *                         看護必要度加算２（一般病棟入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190077410"
                                   ADD    1            TO  IDX8
                                   MOVE   "190143170"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算２（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190144070"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算２（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =   "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190144670"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
                             WHEN   OTHER
                                ADD    1                TO  IDX8
                                MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                         END-EVALUATE
                     END-IF
               END-PERFORM
             END-IF
      *
      *      平成２６年４月からの加算セット処理
             IF    (LNK-NYUKSNGET-SANTEIYM    >=    "201404")  AND
                   (LNK-NYUKSNGET-SANTEIYM    <=    "201603")
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL  (IDX7      >   14)
                     IF   SYS-5001-KSNKBN(IDX7)   =   "2"
                         EVALUATE    SYS-5001-KSNCD(IDX7)
      *                      医師配置加算１（有床診療所入院基本料１から６）
      *                      医師配置加算２（有床診療所入院基本料１から６）
      *                      看護配置加算１（有床診療所入院基本料１から６）
      *                      看護配置加算２（有床診療所入院基本料１から６）
      *                      夜間看護配置加算１（有床診療所入院基本料１から６）
      *                      夜間看護配置加算２（有床診療所入院基本料１から６）
      *                      看護補助配置加算１（有床診療所入院基本料１から６）
      *                      看護補助配置加算２（有床診療所入院基本料１から６）
                             WHEN    "190135570"
                             WHEN    "190117070"
                             WHEN    "190109670"
                             WHEN    "190126570"
                             WHEN    "190126770"
                             WHEN    "190126670"
                             WHEN    "190170570"
                             WHEN    "190170670"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
      *                                                 有床診療所入院基本料４
                                                        OR "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
      *                                                 有床診療所入院基本料５
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
      *                                                 有床診療所入院基本料６
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      夜間緊急体制確保加算（有床診療所入院基本料１から６）
                             WHEN    "190126470"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
      *                                                 有床診療所入院基本料４
                                                        OR "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
      *                                                 有床診療所入院基本料５
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
      *                                                 有床診療所入院基本料６
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      栄養管理実施加算
                             WHEN    "190170770"
      *                         栄養管理実施加算（有床診療所入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
      *                                                 有床診療所入院基本料４
                                                        OR "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
      *                                                 有床診療所入院基本料５
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
      *                                                 有床診療所入院基本料６
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   "190170770"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         栄養管理実施加算（有床診療所療養病床入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                         有床診療所療養病床入院基本料Ａ
                                                          "190122010"
      *                                         有床診療所療養病床入院基本料Ａ（生活療養）
                                                       OR "190124310"
      *                                         有床診療所療養病床入院基本料Ｂ
                                                       OR "190122110"
      *                                         有床診療所療養病床入院基本料Ｂ（生活療養）
                                                       OR "190124410"
      *                                         有床診療所療養病床入院基本料Ｃ
                                                       OR "190122210"
      *                                         有床診療所療養病床入院基本料Ｃ（生活療養）
                                                       OR "190124510"
      *                                         有床診療所療養病床入院基本料Ｄ
                                                       OR "190122310"
      *                                         有床診療所療養病床入院基本料Ｄ（生活療養）
                                                       OR "190124610"
      *                                         有床診療所療養病床入院基本料Ｅ
                                                       OR "190122410"
      *                                         有床診療所療養病床入院基本料Ｅ（生活療養）
                                                       OR "190124710"
      *                                         療養病床以外・有床診療所療養病床入院Ａ
                                                       OR "190155210"
      *                                         療養病床以外・有床診療所療養病床入院Ａ（生活療養）
                                                       OR "190155410"
      *                                         療養病床以外・有床診療所療養病床入院Ｂ
                                                       OR "190155610"
      *                                         療養病床以外・有床診療所療養病床入院Ｂ（生活療養）
                                                       OR "190155810"
      *                                         療養病床以外・有床診療所療養病床入院Ｃ
                                                       OR "190156010"
      *                                         療養病床以外・有床診療所療養病床入院Ｃ（生活療養）
                                                       OR "190156210"
      *                                         療養病床以外・有床診療所療養病床入院Ｄ
                                                       OR "190156410"
      *                                         療養病床以外・有床診療所療養病床入院Ｄ（生活療養）
                                                       OR "190156610"
      *                                         療養病床以外・有床診療所療養病床入院Ｅ
                                                       OR "190156810"
      *                                         療養病床以外・有床診療所療養病床入院Ｅ（生活療養）
                                                       OR "190157010"
                                   ADD    1            TO  IDX8
                                   MOVE   "190171770"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      一般病棟看護必要度評価加算（１３対１入院基本料）
                             WHEN    "190131570"
      *                            一般病棟看護必要度評価加算（一般病棟入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         =  "190077510"
                                                         OR "190165810"
                                     ADD    1            TO  IDX8
                                     MOVE   "190131570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            一般病棟看護必要度評価加算（専門病院）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190090310"
                                     ADD    1            TO  IDX8
                                     MOVE   "190134970"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            一般病棟看護必要度評価加算（特定一般病棟入院料１）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190151910"
                                     ADD    1            TO  IDX8
                                     MOVE   "190152570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      ＡＤＬ維持向上等体制加算
                             WHEN    "190166070"
      *                            ＡＤＬ維持向上等体制加算（一般病棟入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  一般病棟７対１入院基本料
                                                         =  "190117710"
                                                         OR "190131310"
      *                                                  一般病棟１０対１入院基本料
                                                         OR "190077410"
                                                         OR "190131410"
                                     ADD    1            TO  IDX8
                                     MOVE   "190166070"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            ＡＤＬ維持向上等体制加算（特定機能病院入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  特定機能病院一般病棟７対１入院基本料
                                                         =  "190118610"
      *                                                  特定機能病院一般病棟１０対１入院基本料
                                                         OR "190085910"
                                     ADD    1            TO  IDX8
                                     MOVE   "190169070"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            ＡＤＬ維持向上等体制加算（専門病院入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  専門病院７対１入院基本料
                                                         =  "190119310"
      *                                                  専門病院１０対１入院基本料
                                                         OR "190090210"
                                     ADD    1            TO  IDX8
                                     MOVE   "190169170"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      休日リハビリテーション提供体制加算
      *                      （回復期リハビリテーション病棟入院料２と３のみ）
                             WHEN    "190140870"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190141610" OR
                                                         "190141710" OR
                                                         "190141810" OR
                                                         "190141910"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      体制強化加算（回復期リハビリテーション病棟入院料１）
                             WHEN    "190175270"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190150110" OR
                                                         "190150210"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      精神科急性期医師配置加算（精神科急性期治療病棟入院料１）
                             WHEN    "190182270"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190121110" OR
                                                         "190066910"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護職員配置加算（地域包括ケア病棟入院料）
                             WHEN    "190176970"
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                  地域包括ケア病棟入院料１
                                                     =  "190175310"
      *                                  地域包括ケア病棟入院料１（生活療養）
                                                     OR "190175410"
      *                                  地域包括ケア病棟入院料１（特定地域）
                                                     OR "190176110"
      *                                  地域包括ケア病棟入院料１（生活療養）（特定地域）
                                                     OR "190176210"
      *                                  地域包括ケア入院医療管理料１
                                                     OR "190175510"
      *                                  地域包括ケア入院医療管理料１（生活療養）
                                                     OR "190175610"
      *                                  地域包括ケア入院医療管理料１（特定地域）
                                                     OR "190176310"
      *                                  地域包括ケア入院医療管理料１（生活療養）（特定地域）
                                                     OR "190176410"
      *                                  地域包括ケア病棟入院料２
                                                     OR "190175710"
      *                                  地域包括ケア病棟入院料２（生活療養）
                                                     OR "190175810"
      *                                  地域包括ケア病棟入院料２（特定地域）
                                                     OR "190176510"
      *                                  地域包括ケア病棟入院料２（生活療養）（特定地域）
                                                     OR "190176610"
      *                                  地域包括ケア入院医療管理料２
                                                     OR "190175910"
      *                                  地域包括ケア入院医療管理料２（生活療養）
                                                     OR "190176010"
      *                                  地域包括ケア入院医療管理料２（特定地域）
                                                     OR "190176710"
      *                                  地域包括ケア入院医療管理料２（生活療養）（特定地域）
                                                     OR "190176810"
                                     ADD    1            TO  IDX8
                                     MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      看護補助者配置加算（地域包括ケア病棟入院料）
                             WHEN    "190177070"
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                  地域包括ケア病棟入院料１
                                                     =  "190175310"
      *                                  地域包括ケア病棟入院料１（生活療養）
                                                     OR "190175410"
      *                                  地域包括ケア病棟入院料１（特定地域）
                                                     OR "190176110"
      *                                  地域包括ケア病棟入院料１（生活療養）（特定地域）
                                                     OR "190176210"
      *                                  地域包括ケア入院医療管理料１
                                                     OR "190175510"
      *                                  地域包括ケア入院医療管理料１（生活療養）
                                                     OR "190175610"
      *                                  地域包括ケア入院医療管理料１（特定地域）
                                                     OR "190176310"
      *                                  地域包括ケア入院医療管理料１（生活療養）（特定地域）
                                                     OR "190176410"
      *                                  地域包括ケア病棟入院料２
                                                     OR "190175710"
      *                                  地域包括ケア病棟入院料２（生活療養）
                                                     OR "190175810"
      *                                  地域包括ケア病棟入院料２（特定地域）
                                                     OR "190176510"
      *                                  地域包括ケア病棟入院料２（生活療養）（特定地域）
                                                     OR "190176610"
      *                                  地域包括ケア入院医療管理料２
                                                     OR "190175910"
      *                                  地域包括ケア入院医療管理料２（生活療養）
                                                     OR "190176010"
      *                                  地域包括ケア入院医療管理料２（特定地域）
                                                     OR "190176710"
      *                                  地域包括ケア入院医療管理料２（生活療養）（特定地域）
                                                     OR "190176810"
                                     ADD    1            TO  IDX8
                                     MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      精神保健福祉士配置加算
                             WHEN    "190168970"
      *                            精神保健福祉士配置加算（精神病棟入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  精神病棟１０対１入院基本料
                                                         =  "190083610"
                                                         OR "190134610"
      *                                                  精神病棟１３対１入院基本料
                                                         OR "190134510"
                                                         OR "190168510"
      *                                                  精神病棟１５対１入院基本料
                                                         OR "190083810"
                                                         OR "190168610"
      *                                                  精神病棟１８対１入院基本料
                                                         OR "190083910"
                                                         OR "190168710"
      *                                                  精神病棟２０対１入院基本料
                                                         OR "190084010"
                                                         OR "190168810"
                                     ADD    1            TO  IDX8
                                     MOVE   "190168970"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            精神保健福祉士配置加算（精神科療養病棟入院料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  精神療養病棟入院料
                                                         =  "190055010"
                                     ADD    1            TO  IDX8
                                     MOVE   "190177570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      看護必要度加算１（１０対１入院基本料）
                             WHEN    "190143070"
      *                         看護必要度加算１（一般病棟入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190077410"
                                                       OR "190131410"
                                   ADD    1            TO  IDX8
                                   MOVE   "190143070"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算１（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190143970"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算１（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190144570"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護必要度加算２（１０対１入院基本料）
                             WHEN    "190143170"
      *                         看護必要度加算２（一般病棟入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190077410"
                                                       OR "190131410"
                                   ADD    1            TO  IDX8
                                   MOVE   "190143170"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算２（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190144070"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算２（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =   "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190144670"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
                             WHEN   OTHER
                                ADD    1                TO  IDX8
                                MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                         END-EVALUATE
                     END-IF
               END-PERFORM
             END-IF
      *
      *      平成２８年４月からの加算セット処理
             IF    (LNK-NYUKSNGET-SANTEIYM   >=     "201604")  AND
                   (LNK-NYUKSNGET-SANTEIYM   <=     "201803")
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL  (IDX7      >   14)
                     IF   SYS-5001-KSNKBN(IDX7)   =   "2"
                         EVALUATE    SYS-5001-KSNCD(IDX7)
      *                      医師配置加算１（有床診療所入院基本料１から６）
      *                      医師配置加算２（有床診療所入院基本料１から６）
      *                      看護配置加算１（有床診療所入院基本料１から６）
      *                      看護配置加算２（有床診療所入院基本料１から６）
      *                      夜間看護配置加算１（有床診療所入院基本料１から６）
      *                      夜間看護配置加算２（有床診療所入院基本料１から６）
      *                      看護補助配置加算１（有床診療所入院基本料１から６）
      *                      看護補助配置加算２（有床診療所入院基本料１から６）
                             WHEN    "190135570"
                             WHEN    "190117070"
                             WHEN    "190109670"
                             WHEN    "190126570"
                             WHEN    "190126770"
                             WHEN    "190126670"
                             WHEN    "190170570"
                             WHEN    "190170670"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
      *                                                 有床診療所入院基本料４
                                                        OR "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
      *                                                 有床診療所入院基本料５
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
      *                                                 有床診療所入院基本料６
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      夜間緊急体制確保加算（有床診療所入院基本料１から６）
                             WHEN    "190126470"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
      *                                                 有床診療所入院基本料４
                                                        OR "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
      *                                                 有床診療所入院基本料５
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
      *                                                 有床診療所入院基本料６
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      有床診療所在宅復帰機能強化加算（有床診療所入院基本料）
      *                      （システム管理には療養病床用のコードが設定されている
      *                        ので、有床診療所入院基本料であれば置き換える）
                             WHEN    "190190370"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
                                   ADD    1            TO  IDX8
                                   MOVE   "190190270"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                ELSE
                                   ADD    1            TO  IDX8
                                   MOVE   "190190370"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      栄養管理実施加算
                             WHEN    "190170770"
      *                         栄養管理実施加算（有床診療所入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
      *                                                 有床診療所入院基本料４
                                                        OR "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
      *                                                 有床診療所入院基本料５
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
      *                                                 有床診療所入院基本料６
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   "190170770"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         栄養管理実施加算（有床診療所療養病床入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                         有床診療所療養病床入院基本料Ａ
                                                          "190122010"
      *                                         有床診療所療養病床入院基本料Ａ（生活療養）
                                                       OR "190124310"
      *                                         有床診療所療養病床入院基本料Ｂ
                                                       OR "190122110"
      *                                         有床診療所療養病床入院基本料Ｂ（生活療養）
                                                       OR "190124410"
      *                                         有床診療所療養病床入院基本料Ｃ
                                                       OR "190122210"
      *                                         有床診療所療養病床入院基本料Ｃ（生活療養）
                                                       OR "190124510"
      *                                         有床診療所療養病床入院基本料Ｄ
                                                       OR "190122310"
      *                                         有床診療所療養病床入院基本料Ｄ（生活療養）
                                                       OR "190124610"
      *                                         有床診療所療養病床入院基本料Ｅ
                                                       OR "190122410"
      *                                         有床診療所療養病床入院基本料Ｅ（生活療養）
                                                       OR "190124710"
      *                                         療養病床以外・有床診療所療養病床入院Ａ
                                                       OR "190155210"
      *                                         療養病床以外・有床診療所療養病床入院Ａ（生活療養）
                                                       OR "190155410"
      *                                         療養病床以外・有床診療所療養病床入院Ｂ
                                                       OR "190155610"
      *                                         療養病床以外・有床診療所療養病床入院Ｂ（生活療養）
                                                       OR "190155810"
      *                                         療養病床以外・有床診療所療養病床入院Ｃ
                                                       OR "190156010"
      *                                         療養病床以外・有床診療所療養病床入院Ｃ（生活療養）
                                                       OR "190156210"
      *                                         療養病床以外・有床診療所療養病床入院Ｄ
                                                       OR "190156410"
      *                                         療養病床以外・有床診療所療養病床入院Ｄ（生活療養）
                                                       OR "190156610"
      *                                         療養病床以外・有床診療所療養病床入院Ｅ
                                                       OR "190156810"
      *                                         療養病床以外・有床診療所療養病床入院Ｅ（生活療養）
                                                       OR "190157010"
                                   ADD    1            TO  IDX8
                                   MOVE   "190171770"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      一般病棟看護必要度評価加算（１３対１入院基本料）
                             WHEN    "190131570"
      *                            一般病棟看護必要度評価加算（一般病棟入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         =  "190077510"
                                                         OR "190165810"
                                                         OR "190183510"
                                     ADD    1            TO  IDX8
                                     MOVE   "190131570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            一般病棟看護必要度評価加算（専門病院）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190090310"
                                     ADD    1            TO  IDX8
                                     MOVE   "190134970"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            一般病棟看護必要度評価加算（特定一般病棟入院料１）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190151910"
                                     ADD    1            TO  IDX8
                                     MOVE   "190152570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      ＡＤＬ維持向上等体制加算
                             WHEN    "190166070"
      *                            ＡＤＬ維持向上等体制加算（一般病棟入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  一般病棟７対１入院基本料
                                                         =  "190117710"
                                                         OR "190131310"
                                                         OR "190183310"
      *                                                  一般病棟１０対１入院基本料
                                                         OR "190077410"
                                                         OR "190131410"
                                                         OR "190183410"
                                     ADD    1            TO  IDX8
                                     MOVE   "190166070"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            ＡＤＬ維持向上等体制加算（特定機能病院入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  特定機能病院一般病棟７対１入院基本料
                                                         =  "190118610"
      *                                                  特定機能病院一般病棟１０対１入院基本料
                                                         OR "190085910"
                                     ADD    1            TO  IDX8
                                     MOVE   "190169070"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            ＡＤＬ維持向上等体制加算（専門病院入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  専門病院７対１入院基本料
                                                         =  "190119310"
      *                                                  専門病院１０対１入院基本料
                                                         OR "190090210"
                                     ADD    1            TO  IDX8
                                     MOVE   "190169170"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      休日リハビリテーション提供体制加算
      *                      （回復期リハビリテーション病棟入院料２と３のみ）
                             WHEN    "190140870"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190141610" OR
                                                         "190141710" OR
                                                         "190141810" OR
                                                         "190141910"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      体制強化加算１（回復期リハビリテーション病棟入院料１）
      *                      体制強化加算２（回復期リハビリテーション病棟入院料１）
                             WHEN    "190194870"
                             WHEN    "190194970"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190150110" OR
                                                         "190150210"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護職員配置加算（地域包括ケア病棟入院料）
                             WHEN    "190176970"
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                  地域包括ケア病棟入院料１
                                                     =  "190175310"
      *                                  地域包括ケア病棟入院料１（生活療養）
                                                     OR "190175410"
      *                                  地域包括ケア病棟入院料１（特定地域）
                                                     OR "190176110"
      *                                  地域包括ケア病棟入院料１（生活療養）（特定地域）
                                                     OR "190176210"
      *                                  地域包括ケア入院医療管理料１
                                                     OR "190175510"
      *                                  地域包括ケア入院医療管理料１（生活療養）
                                                     OR "190175610"
      *                                  地域包括ケア入院医療管理料１（特定地域）
                                                     OR "190176310"
      *                                  地域包括ケア入院医療管理料１（生活療養）（特定地域）
                                                     OR "190176410"
      *                                  地域包括ケア病棟入院料２
                                                     OR "190175710"
      *                                  地域包括ケア病棟入院料２（生活療養）
                                                     OR "190175810"
      *                                  地域包括ケア病棟入院料２（特定地域）
                                                     OR "190176510"
      *                                  地域包括ケア病棟入院料２（生活療養）（特定地域）
                                                     OR "190176610"
      *                                  地域包括ケア入院医療管理料２
                                                     OR "190175910"
      *                                  地域包括ケア入院医療管理料２（生活療養）
                                                     OR "190176010"
      *                                  地域包括ケア入院医療管理料２（特定地域）
                                                     OR "190176710"
      *                                  地域包括ケア入院医療管理料２（生活療養）（特定地域）
                                                     OR "190176810"
                                     ADD    1            TO  IDX8
                                     MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      看護補助者配置加算（地域包括ケア病棟入院料）
                             WHEN    "190177070"
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                  地域包括ケア病棟入院料１
                                                     =  "190175310"
      *                                  地域包括ケア病棟入院料１（生活療養）
                                                     OR "190175410"
      *                                  地域包括ケア病棟入院料１（特定地域）
                                                     OR "190176110"
      *                                  地域包括ケア病棟入院料１（生活療養）（特定地域）
                                                     OR "190176210"
      *                                  地域包括ケア入院医療管理料１
                                                     OR "190175510"
      *                                  地域包括ケア入院医療管理料１（生活療養）
                                                     OR "190175610"
      *                                  地域包括ケア入院医療管理料１（特定地域）
                                                     OR "190176310"
      *                                  地域包括ケア入院医療管理料１（生活療養）（特定地域）
                                                     OR "190176410"
      *                                  地域包括ケア病棟入院料２
                                                     OR "190175710"
      *                                  地域包括ケア病棟入院料２（生活療養）
                                                     OR "190175810"
      *                                  地域包括ケア病棟入院料２（特定地域）
                                                     OR "190176510"
      *                                  地域包括ケア病棟入院料２（生活療養）（特定地域）
                                                     OR "190176610"
      *                                  地域包括ケア入院医療管理料２
                                                     OR "190175910"
      *                                  地域包括ケア入院医療管理料２（生活療養）
                                                     OR "190176010"
      *                                  地域包括ケア入院医療管理料２（特定地域）
                                                     OR "190176710"
      *                                  地域包括ケア入院医療管理料２（生活療養）（特定地域）
                                                     OR "190176810"
                                     ADD    1            TO  IDX8
                                     MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      精神保健福祉士配置加算
                             WHEN    "190168970"
      *                            精神保健福祉士配置加算（精神病棟入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  精神病棟１０対１入院基本料
                                                         =  "190083610"
                                                         OR "190134610"
                                                         OR "190188310"
      *                                                  精神病棟１３対１入院基本料
                                                         OR "190134510"
                                                         OR "190168510"
                                                         OR "190188410"
      *                                                  精神病棟１５対１入院基本料
                                                         OR "190083810"
                                                         OR "190168610"
                                                         OR "190188510"
      *                                                  精神病棟１８対１入院基本料
                                                         OR "190083910"
                                                         OR "190168710"
                                                         OR "190188610"
      *                                                  精神病棟２０対１入院基本料
                                                         OR "190084010"
                                                         OR "190168810"
                                                         OR "190188710"
                                     ADD    1            TO  IDX8
                                     MOVE   "190168970"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            精神保健福祉士配置加算（精神科療養病棟入院料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  精神療養病棟入院料
                                                         =  "190055010"
                                     ADD    1            TO  IDX8
                                     MOVE   "190177570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      看護必要度加算１（１０対１入院基本料）
                             WHEN    "190183070"
      *                         看護必要度加算１（一般病棟入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190077410"
                                                       OR "190131410"
                                                       OR "190183410"
                                   ADD    1            TO  IDX8
                                   MOVE   "190183070"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算１（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190188870"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算１（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190189170"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護必要度加算２（１０対１入院基本料）
                             WHEN    "190183170"
      *                         看護必要度加算２（一般病棟入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190077410"
                                                       OR "190131410"
                                                       OR "190183410"
                                   ADD    1            TO  IDX8
                                   MOVE   "190183170"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算２（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190188970"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算２（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =   "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190189270"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護必要度加算３（１０対１入院基本料）
                             WHEN    "190183270"
      *                         看護必要度加算３（一般病棟入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190077410"
                                                       OR "190131410"
                                                       OR "190183410"
                                   ADD    1            TO  IDX8
                                   MOVE   "190183270"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算３（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190189070"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算３（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =   "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190189370"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
                             WHEN   OTHER
                                ADD    1                TO  IDX8
                                MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                         END-EVALUATE
                     END-IF
               END-PERFORM
             END-IF
      *
      *      平成３０年４月からの加算セット処理
             IF     LNK-NYUKSNGET-SANTEIYM   >=     "201804"
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL  (IDX7      >   14)
                     IF   SYS-5001-KSNKBN(IDX7)   =   "2"
                         EVALUATE    SYS-5001-KSNCD(IDX7)
      *                      医師配置加算１（有床診療所入院基本料１から６）
      *                      医師配置加算２（有床診療所入院基本料１から６）
      *                      看護配置加算１（有床診療所入院基本料１から６）
      *                      看護配置加算２（有床診療所入院基本料１から６）
      *                      夜間看護配置加算１（有床診療所入院基本料１から６）
      *                      夜間看護配置加算２（有床診療所入院基本料１から６）
      *                      看護補助配置加算１（有床診療所入院基本料１から６）
      *                      看護補助配置加算２（有床診療所入院基本料１から６）
                             WHEN    "190135570"
                             WHEN    "190117070"
                             WHEN    "190109670"
                             WHEN    "190126570"
                             WHEN    "190126770"
                             WHEN    "190126670"
                             WHEN    "190170570"
                             WHEN    "190170670"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
      *                                                 有床診療所入院基本料４
                                                        OR "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
      *                                                 有床診療所入院基本料５
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
      *                                                 有床診療所入院基本料６
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      夜間緊急体制確保加算（有床診療所入院基本料１から６）
                             WHEN    "190126470"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
      *                                                 有床診療所入院基本料４
                                                        OR "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
      *                                                 有床診療所入院基本料５
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
      *                                                 有床診療所入院基本料６
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      有床診療所在宅復帰機能強化加算（有床診療所入院基本料）
      *                      （システム管理には療養病床用のコードが設定されている
      *                        ので、有床診療所入院基本料であれば置き換える）
                             WHEN    "190190370"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
                                   ADD    1            TO  IDX8
                                   MOVE   "190190270"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                ELSE
                                   ADD    1            TO  IDX8
                                   MOVE   "190190370"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      栄養管理実施加算
                             WHEN    "190170770"
      *                         栄養管理実施加算（有床診療所入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                                 有床診療所入院基本料１
                                                           "190169610"
                                                        OR "190169710"
                                                        OR "190169810"
      *                                                 有床診療所入院基本料２
                                                        OR "190169910"
                                                        OR "190170010"
                                                        OR "190170110"
      *                                                 有床診療所入院基本料３
                                                        OR "190170210"
                                                        OR "190170310"
                                                        OR "190170410"
      *                                                 有床診療所入院基本料４
                                                        OR "190097010"
                                                        OR "190119510"
                                                        OR "190119610"
      *                                                 有床診療所入院基本料５
                                                        OR "190097210"
                                                        OR "190119710"
                                                        OR "190119810"
      *                                                 有床診療所入院基本料６
                                                        OR "190135110"
                                                        OR "190135210"
                                                        OR "190135310"
                                   ADD    1            TO  IDX8
                                   MOVE   "190170770"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         栄養管理実施加算（有床診療所療養病床入院基本料）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD  =
      *                                         有床診療所療養病床入院基本料Ａ
                                                          "190122010"
      *                                         有床診療所療養病床入院基本料Ａ（生活療養）
                                                       OR "190124310"
      *                                         有床診療所療養病床入院基本料Ｂ
                                                       OR "190122110"
      *                                         有床診療所療養病床入院基本料Ｂ（生活療養）
                                                       OR "190124410"
      *                                         有床診療所療養病床入院基本料Ｃ
                                                       OR "190122210"
      *                                         有床診療所療養病床入院基本料Ｃ（生活療養）
                                                       OR "190124510"
      *                                         有床診療所療養病床入院基本料Ｄ
                                                       OR "190122310"
      *                                         有床診療所療養病床入院基本料Ｄ（生活療養）
                                                       OR "190124610"
      *                                         有床診療所療養病床入院基本料Ｅ
                                                       OR "190122410"
      *                                         有床診療所療養病床入院基本料Ｅ（生活療養）
                                                       OR "190124710"
      *                                         療養病床以外・有床診療所療養病床入院Ａ
                                                       OR "190155210"
      *                                         療養病床以外・有床診療所療養病床入院Ａ（生活療養）
                                                       OR "190155410"
      *                                         療養病床以外・有床診療所療養病床入院Ｂ
                                                       OR "190155610"
      *                                         療養病床以外・有床診療所療養病床入院Ｂ（生活療養）
                                                       OR "190155810"
      *                                         療養病床以外・有床診療所療養病床入院Ｃ
                                                       OR "190156010"
      *                                         療養病床以外・有床診療所療養病床入院Ｃ（生活療養）
                                                       OR "190156210"
      *                                         療養病床以外・有床診療所療養病床入院Ｄ
                                                       OR "190156410"
      *                                         療養病床以外・有床診療所療養病床入院Ｄ（生活療養）
                                                       OR "190156610"
      *                                         療養病床以外・有床診療所療養病床入院Ｅ
                                                       OR "190156810"
      *                                         療養病床以外・有床診療所療養病床入院Ｅ（生活療養）
                                                       OR "190157010"
                                   ADD    1            TO  IDX8
                                   MOVE   "190171770"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      夜間７５対１看護補助加算
      *                      （地域一般入院料１、２）
      *                      （１３対１入院基本料）
                             WHEN    "190191170"
                                     IF LNK-NYUKSNGET-NYUIN-SRYCD =
                                          "190200210"   OR
                                          "190077510"   OR
                                          "190090310"   OR
                                          "190093810"   OR
                                          "190081810"   OR
                                          "190134510"   OR
                                          "190086510"   OR
                                          "190134710"
                                         ADD    1            TO  IDX8
                                         MOVE   "190191170"  TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                                     END-IF
      *                      在宅復帰機能強化加算（療養病棟入院料１）
                             WHEN    "190168070"
                                     MOVE    ZERO     TO  FLG-TENSU
                                     INITIALIZE           TNS-TENSU-REC
                                     MOVE    LNK-NYUKSNGET-HOSPNUM
                                                      TO  TNS-HOSPNUM
                                     MOVE    LNK-NYUKSNGET-NYUIN-SRYCD
                                                      TO  TNS-SRYCD
                                     MOVE    LNK-NYUKSNGET-SANTEIYM
                                                 TO  TNS-YUKOSTYMD(1:6)
                                     MOVE    "01"     TO
                                                     TNS-YUKOSTYMD(7:2)
                                     MOVE    TNS-YUKOSTYMD
                                                      TO  TNS-YUKOEDYMD
                                     MOVE    "tbl_tensu"
                                                      TO  MCP-TABLE
                                     MOVE    "key"    TO  MCP-PATHNAME
                                     PERFORM 910-TENSU-SELECT-SEC
                                     MOVE    "tbl_tensu"
                                                      TO  MCP-TABLE
                                     MOVE    "key"    TO  MCP-PATHNAME
                                     PERFORM 910-TENSU-READ-SEC
                                     IF    FLG-TENSU    =   ZERO
                                       IF ((TNS-CDKBN-KBNNUM = 101) AND
                                           (TNS-CDKBN-KOUBAN = 1))  OR
                                          ((TNS-CDKBN-KBNNUM = 317) AND
                                           (TNS-CDKBN-KOUBAN = 8))
                                         ADD    1            TO  IDX8
                                         MOVE   "190168070"  TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                                       END-IF
                                     END-IF
                                     MOVE    "tbl_tensu"  TO  MCP-TABLE
                                     MOVE    "key"     TO  MCP-PATHNAME
                                     PERFORM 990-DBCLOSE-SEC
      *                      夜間看護加算（療養病棟入院基本料）
      *                      （特別入院基本料等、経過措置１、経過措置２は除く）
                             WHEN    "190204570"
                                IF    SYS-5001-BTU-SBT   =   "04"
                                  IF (LNK-NYUKSNGET-NYUIN-SRYCD
                                                      = "190121810" OR
                                                        "190124210") OR
                                     (SYS-5001-SYOKUINKBN   =   "1") OR
                                     (SYS-5001-SYOKUINKBN2  =   "1")
                                     CONTINUE
                                  ELSE
                                     MOVE    ZERO     TO  FLG-TENSU
                                     INITIALIZE           TNS-TENSU-REC
                                     MOVE    LNK-NYUKSNGET-HOSPNUM
                                                      TO  TNS-HOSPNUM
                                     MOVE    LNK-NYUKSNGET-NYUIN-SRYCD
                                                      TO  TNS-SRYCD
                                     MOVE    LNK-NYUKSNGET-SANTEIYM
                                                 TO  TNS-YUKOSTYMD(1:6)
                                     MOVE    "01"     TO
                                                     TNS-YUKOSTYMD(7:2)
                                     MOVE    TNS-YUKOSTYMD
                                                      TO  TNS-YUKOEDYMD
                                     MOVE    "tbl_tensu"
                                                      TO  MCP-TABLE
                                     MOVE    "key"    TO  MCP-PATHNAME
                                     PERFORM 910-TENSU-SELECT-SEC
                                     MOVE    "tbl_tensu"
                                                      TO  MCP-TABLE
                                     MOVE    "key"    TO  MCP-PATHNAME
                                     PERFORM 910-TENSU-READ-SEC
                                     IF    FLG-TENSU    =   ZERO
                                       IF ((TNS-CDKBN-KBNNUM = 101) AND
                                           (TNS-CDKBN-KOUBAN = 1))  OR
                                          ((TNS-CDKBN-KBNNUM = 101) AND
                                           (TNS-CDKBN-KOUBAN = 2))
                                         ADD    1            TO  IDX8
                                         MOVE   "190204570"  TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                                       END-IF
                                     END-IF
                                     MOVE    "tbl_tensu"  TO  MCP-TABLE
                                     MOVE    "key"     TO  MCP-PATHNAME
                                     PERFORM 990-DBCLOSE-SEC
                                  END-IF
                                END-IF
      *                      看護補助加算（障害者施設等入院基本料）
      *                      （７対１、１０対１に限る）
                             WHEN    "190205570"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190126310" OR
                                                         "190199010" OR
                                                         "190189510" OR
                                                         "190198910" OR
                                                         "190189410" OR
                                                         "190169210" OR
                                                         "190093710" OR
                                                         "190199210" OR
                                                         "190189710" OR
                                                         "190199110" OR
                                                         "190189610" OR
                                                         "190169310"
      *                                  １４日以内の加算
                                         ADD    1            TO  IDX8
                                         MOVE   "190205570" TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
      *                                  １５日以上３０日以内の加算
                                         ADD    1            TO  IDX8
                                         MOVE   "190205670" TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      夜間看護体制加算（障害者施設等入院基本料）
                             WHEN    "190205770"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190126310" OR
                                                         "190199010" OR
                                                         "190189510" OR
                                                         "190198910" OR
                                                         "190189410" OR
                                                         "190169210" OR
                                                         "190093710" OR
                                                         "190199210" OR
                                                         "190189710" OR
                                                         "190199110" OR
                                                         "190189610" OR
                                                         "190169310"
                                         ADD    1            TO  IDX8
                                         MOVE   "190205770" TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      一般病棟看護必要度評価加算（１３対１入院基本料）
                             WHEN    "190134970"
      *                            一般病棟看護必要度評価加算（専門病院）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190090310"
                                     ADD    1            TO  IDX8
                                     MOVE   "190134970"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            一般病棟看護必要度評価加算（特定一般病棟入院料１）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                         = "190151910"
                                     ADD    1            TO  IDX8
                                     MOVE   "190152570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      ＡＤＬ維持向上等体制加算（特別入院基本料等は算定不可）
                             WHEN    "190166070"
      *                            ＡＤＬ維持向上等体制加算（急性期一般入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  急性期一般入院基本料１
                                                         =  "190117710"
      *                                                  急性期一般入院基本料２
                                                         OR "190199710"
      *                                                  急性期一般入院基本料３
                                                         OR "190199810"
      *                                                  急性期一般入院基本料４
                                                         OR "190199910"
      *                                                  急性期一般入院基本料５
                                                         OR "190200010"
      *                                                  急性期一般入院基本料６
                                                         OR "190200110"
      *                                                  急性期一般入院基本料７
                                                         OR "190077410"
                                     ADD    1            TO  IDX8
                                     MOVE   "190166070"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            ＡＤＬ維持向上等体制加算（特定機能病院入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  特定機能病院一般病棟７対１入院基本料
                                                         =  "190118610"
      *                                                  特定機能病院一般病棟１０対１入院基本料
                                                         OR "190085910"
                                     ADD    1            TO  IDX8
                                     MOVE   "190169070"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            ＡＤＬ維持向上等体制加算（専門病院入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  専門病院７対１入院基本料
                                                         =  "190119310"
      *                                                  専門病院１０対１入院基本料
                                                         OR "190090210"
                                     ADD    1            TO  IDX8
                                     MOVE   "190169170"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      休日リハビリテーション提供体制加算
      *                      （回復期リハビリテーション病棟入院料３、４、５、６のみ）
                             WHEN    "190140870"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190208310" OR
                                                         "190208410" OR
                                                         "190208510" OR
                                                         "190208610" OR
                                                         "190208710" OR
                                                         "190208810" OR
                                                         "190208910" OR
                                                         "190209010"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      体制強化加算１（回復期リハビリテーション病棟入院料１、２）
      *                      体制強化加算２（回復期リハビリテーション病棟入院料１、２）
                             WHEN    "190194870"
                             WHEN    "190194970"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       = "190207910" OR
                                                         "190208010" OR
                                                         "190208110" OR
                                                         "190208210"
                                   ADD    1            TO  IDX8
                                   MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護職員配置加算（地域包括ケア病棟入院料）
                             WHEN    "190176970"
      *                      看護補助者配置加算（地域包括ケア病棟入院料）
                             WHEN    "190177070"
      *                      看護職員夜間配置加算（地域包括ケア病棟入院料）
                             WHEN    "190212570"
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                  地域包括ケア病棟入院料１
                                                     =  "190209110"
      *                                  地域包括ケア病棟入院料１（生活療養）
                                                     OR "190209210"
      *                                  地域包括ケア入院医療管理料１
                                                     OR "190209310"
      *                                  地域包括ケア入院医療管理料１（生活療養）
                                                     OR "190209410"
      *                                  地域包括ケア病棟入院料２
                                                     OR "190209510"
      *                                  地域包括ケア病棟入院料２（生活療養）
                                                     OR "190209610"
      *                                  地域包括ケア入院医療管理料２
                                                     OR "190209710"
      *                                  地域包括ケア入院医療管理料２（生活療養）
                                                     OR "190209810"
      *                                  地域包括ケア病棟入院料３
                                                     OR "190209910"
      *                                  地域包括ケア病棟入院料３（生活療養）
                                                     OR "190210010"
      *                                  地域包括ケア入院医療管理料３
                                                     OR "190210110"
      *                                  地域包括ケア入院医療管理料３（生活療養）
                                                     OR "190210210"
      *                                  地域包括ケア病棟入院料４
                                                     OR "190210310"
      *                                  地域包括ケア病棟入院料４（生活療養）
                                                     OR "190210410"
      *                                  地域包括ケア入院医療管理料４
                                                     OR "190210510"
      *                                  地域包括ケア入院医療管理料４（生活療養）
                                                     OR "190210610"
      *                                  地域包括ケア病棟入院料１（特定地域）
                                                     OR "190210710"
      *                                  地域包括ケア病棟入院料１（生活療養）（特定地域）
                                                     OR "190210810"
      *                                  地域包括ケア入院医療管理料１（特定地域）
                                                     OR "190210910"
      *                                  地域包括ケア入院医療管理料１（生活療養）（特定地域）
                                                     OR "190211010"
      *                                  地域包括ケア病棟入院料２（特定地域）
                                                     OR "190211110"
      *                                  地域包括ケア病棟入院料２（生活療養）（特定地域）
                                                     OR "190211210"
      *                                  地域包括ケア入院医療管理料２（特定地域）
                                                     OR "190211310"
      *                                  地域包括ケア入院医療管理料２（生活療養）（特定地域）
                                                     OR "190211410"
      *                                  地域包括ケア病棟入院料３（特定地域）
                                                     OR "190211510"
      *                                  地域包括ケア病棟入院料３（生活療養）（特定地域）
                                                     OR "190211610"
      *                                  地域包括ケア入院医療管理料３（特定地域）
                                                     OR "190211710"
      *                                  地域包括ケア入院医療管理料３（生活療養）（特定地域）
                                                     OR "190211810"
      *                                  地域包括ケア病棟入院料４（特定地域）
                                                     OR "190211910"
      *                                  地域包括ケア病棟入院料４（生活療養）（特定地域）
                                                     OR "190212010"
      *                                  地域包括ケア入院医療管理料４（特定地域）
                                                     OR "190212110"
      *                                  地域包括ケア入院医療管理料４（生活療養）（特定地域）
                                                     OR "190212210"
      *                                  特定一般病棟入院料（地域包括ケア１）
                                                     OR "190213310"
      *                                  特定一般病棟入院料（地域包括ケア２）
                                                     OR "190213410"
      *                                  特定一般病棟入院料（地域包括ケア３）
                                                     OR "190213510"
      *                                  特定一般病棟入院料（地域包括ケア４）
                                                     OR "190213610"
                                     ADD    1            TO  IDX8
                                     MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      認知症夜間対応加算（認知症治療病棟入院料）
                             WHEN    "190151870"
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                    認知症治療病棟入院料１（３０日以内）
                                                     = "190151610" OR
      *                                    認知症治療病棟入院料１（３１日以上６０日以内）
                                                       "190739910" OR
      *                                    認知症治療病棟入院料１（６１日以上）
                                                       "190740010" OR
      *                                    認知症治療病棟入院料２（３０日以内）
                                                       "190151710" OR
      *                                    認知症治療病棟入院料２（３１日以上６０日以内）
                                                       "190813410" OR
      *                                    認知症治療病棟入院料２（６１日以上）
                                                       "190813510"
      *                                  ３０日以内の加算
                                         ADD    1            TO  IDX8
                                         MOVE   "190151870" TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
      *                                  ３１日以上の加算
                                         ADD    1            TO  IDX8
                                         MOVE   "190213270" TO
                                              WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護職員夜間配置加算（精神科救急入院料）
                             WHEN    "190213070"
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                  精神科救急入院料１
                                                     =  "190121010"
      *                                  精神科救急入院料２
                                                     OR "190130010"
                                     ADD    1            TO  IDX8
                                     MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      看護職員夜間配置加算（精神科救急・合併症入院料）
                             WHEN    "190213170"
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                  精神科救急・合併症入院料
                                                     =  "190130210"
                                     ADD    1            TO  IDX8
                                     MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      精神保健福祉士配置加算
                             WHEN    "190168970"
      *                            精神保健福祉士配置加算（精神病棟入院基本料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  精神病棟１０対１入院基本料
                                                         =  "190083610"
                                                         OR "190134610"
                                                         OR "190188310"
      *                                                  精神病棟１３対１入院基本料
                                                         OR "190134510"
                                                         OR "190168510"
                                                         OR "190188410"
      *                                                  精神病棟１５対１入院基本料
                                                         OR "190083810"
                                                         OR "190168610"
                                                         OR "190188510"
      *                                                  精神病棟１８対１入院基本料
                                                         OR "190083910"
                                                         OR "190168710"
                                                         OR "190188610"
      *                                                  精神病棟２０対１入院基本料
                                                         OR "190084010"
                                                         OR "190168810"
                                                         OR "190188710"
                                     ADD    1            TO  IDX8
                                     MOVE   "190168970"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                            精神保健福祉士配置加算（精神科療養病棟入院料）
                                   IF  LNK-NYUKSNGET-NYUIN-SRYCD
      *                                                  精神療養病棟入院料
                                                         =  "190055010"
                                     ADD    1            TO  IDX8
                                     MOVE   "190177570"  TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                                   END-IF
      *                      看護必要度加算１（１０対１入院基本料）
                             WHEN    "190189170"
      *                         看護必要度加算１（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190188870"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算１（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190189170"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護必要度加算２（１０対１入院基本料）
                             WHEN    "190189270"
      *                         看護必要度加算２（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190188970"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算２（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =   "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190189270"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                      看護必要度加算３（１０対１入院基本料）
                             WHEN    "190189370"
      *                         看護必要度加算３（特定機能病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =  "190085910"
                                   ADD    1            TO  IDX8
                                   MOVE   "190189070"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
      *                         看護必要度加算３（専門病院）
                                IF  LNK-NYUKSNGET-NYUIN-SRYCD
                                                       =   "190090210"
                                   ADD    1            TO  IDX8
                                   MOVE   "190189370"  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                                END-IF
                             WHEN   OTHER
                                ADD    1                TO  IDX8
                                MOVE   SYS-5001-KSNCD(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                         END-EVALUATE
                     END-IF
               END-PERFORM
             END-IF
      *
      *      入院料加算（ユーザー設定）
             PERFORM   VARYING   IDX7   FROM   1  BY  1
               UNTIL  (IDX7      >   10)
                   IF   SYS-5001-KSNCD2(IDX7)  NOT =   SPACE
                       ADD   1     TO    IDX8
                       MOVE   SYS-5001-KSNCD2(IDX7) TO
                                            WRK-NYUKHNKSN-SRYCD(IDX8)
                   END-IF
             END-PERFORM
      *
           END-IF
      *
      *    病室入院料加算
           PERFORM     4801-BRMSEL-SEC
      *
           IF   FLG-SYSKANRI       =    ZERO
      *
               PERFORM   VARYING   IDX7   FROM   1  BY  1
                 UNTIL    (IDX7                    >   12)
                     IF   SYS-5002-KSNKBN(IDX7)   =   "2"
                          ADD    1                TO  IDX8
                          MOVE   SYS-5002-KSNCD(IDX7)  TO
                                             WRK-NYUKHNKSN-SRYCD(IDX8)
                     END-IF
               END-PERFORM
      *
           END-IF
      *
           PERFORM VARYING IDX-KSN FROM    1   BY  1
                   UNTIL ( IDX-KSN >   3 )
               IF    ( LNK-NYUKSNGET-I01-KSN-SRYCD (IDX-KSN)
                                       NOT =   SPACE )
                    ADD     1       TO     IDX8
                    MOVE    LNK-NYUKSNGET-I01-KSN-SRYCD (IDX-KSN)
                                    TO     WRK-NYUKHNKSN-SRYCD(IDX8)
               END-IF
           END-PERFORM
      *
      *    入院料と入院料加算の併算定チェック
           MOVE    ZERO            TO     IDX9
           PERFORM    VARYING    IDX8   FROM   1   BY   1
                      UNTIL      (WRK-NYUKHNKSN-SRYCD(IDX8)  =  SPACE)
                         OR      (IDX8   >     20)
      *
                         PERFORM   4801-NYUKSN-CHK-SEC
      *
                         IF     FLG-NYUKSN       =   ZERO   
                             ADD    1                TO  IDX9
                             MOVE   WRK-NYUKHNKSN-SRYCD(IDX8)  TO
                                           LNK-NYUKSNGET-KSNSRYCD(IDX9)
      *
      *                      褥瘡患者管理加算のフラグセット
                             IF   WRK-NYUKHNKSN-SRYCD(IDX8)  =
                                                         "190116990"
                                  MOVE   "1"    TO
                                       LNK-NYUKSNGET-NYUKSNKBN(IDX9)
                             END-IF
      *                      救急・在宅等支援療養病床初期加算（病院）のフラグセット
                             IF   WRK-NYUKHNKSN-SRYCD(IDX8)  =
                                             "190134270"
                                  IF    LNK-NYUKSNGET-FLG-IPPAN2  =  1
                                     MOVE   "2"    TO
                                         LNK-NYUKSNGET-NYUKSNKBN(IDX9)
                                  END-IF
                                  IF    LNK-NYUKSNGET-FLG-IPPAN2  =  2
                                     MOVE   "3"    TO
                                         LNK-NYUKSNGET-NYUKSNKBN(IDX9)
                                  END-IF
                             END-IF
      *                      救急・在宅等支援療養病床初期加算（診療所）のフラグセット
                             IF   WRK-NYUKHNKSN-SRYCD(IDX8)  =
                                             "190135670"
                                  IF    LNK-NYUKSNGET-FLG-IPPAN2  =  3
                                     MOVE   "4"    TO
                                         LNK-NYUKSNGET-NYUKSNKBN(IDX9)
                                  END-IF
                             END-IF
                         END-IF
           END-PERFORM
      *
      *    小児入院医療管理料加算（保育士１人以上）
           IF    (WRK-BTU-HIKSISUKBN   =   "2")  AND
                 (IDX9    <   20 )
               ADD    1            TO  IDX9
               MOVE  "190111370"   TO
                                   LNK-NYUKSNGET-KSNSRYCD(IDX9)
           END-IF
      *
           IF     LNK-NYUKSNGET-SANTEIYM  <=   "200803"
      *      看護配置適合加算
             IF    (WRK-BTU-KNGTEK-KBN   =   "2")  AND
                   (IDX9    <   20 )
                 ADD    1            TO  IDX9
                 MOVE  "190109670"   TO
                                   LNK-NYUKSNGET-KSNSRYCD(IDX9)
             END-IF          
      *
      *      複数医師及び看護配置適合加算
             IF    (WRK-BTU-DRTEK-KBN   =   "2")  AND
                   (IDX9    <   20 )
                 ADD    1            TO  IDX9
                 MOVE  "190117070"   TO
                                   LNK-NYUKSNGET-KSNSRYCD(IDX9)
             END-IF
           END-IF 
      *
      *    返却領域へのセット
           MOVE     WRK-TOKUBETSU-NYUIN
                                     TO   LNK-NYUKSNGET-TOKUBETSU-NYUIN
      *
      *    復帰コード
           IF    WRK-NYUKHNKSN-SRYCD(1)   =   SPACE
                MOVE    1            TO   LNK-NYUKSNGET-RC
           ELSE
                MOVE    ZERO         TO   LNK-NYUKSNGET-RC
           END-IF
      *
      *    返却情報の表示（テスト用）
      **     DISPLAY    "===========   ORCSNYUKSNGET HENKYAKU ====="
      **     DISPLAY    "WRK-NENREI = " WRK-NENREI
      **     DISPLAY    "LNK-NYUKSNGET-TOKUBETSU-NYUIN = "
      **                 LNK-NYUKSNGET-TOKUBETSU-NYUIN
      **     PERFORM     VARYING    IDX    FROM   1   BY   1
      **       UNTIL    (IDX    >   20)   OR
      **                (LNK-NYUKSNGET-KSNSRYCD(IDX)  =  SPACE)
      **         DISPLAY "IDX = " IDX
      **         MOVE    LNK-NYUKSNGET-HOSPNUM
      **                                 TO  TNS-HOSPNUM
      **         MOVE    WRK-NYUKHNKSN-SRYCD(IDX)
      **                                 TO  TNS-SRYCD
      **         MOVE    LNK-NYUKSNGET-SANTEIYM
      **                                 TO  TNS-YUKOSTYMD(1:6)
      **         MOVE    "01"            TO  TNS-YUKOSTYMD(7:2)
      **         MOVE    TNS-YUKOSTYMD   TO  TNS-YUKOEDYMD
      **         MOVE    TNS-TENSU-REC   TO  MCPDATA-REC
      **         MOVE    "tbl_tensu"     TO  MCP-TABLE
      **         MOVE    "key"           TO  MCP-PATHNAME
      **         PERFORM 910-DBSELECT-SEC
      **         MOVE    "tbl_tensu"     TO  MCP-TABLE
      **         MOVE    "key"           TO  MCP-PATHNAME
      **         PERFORM 910-DBFETCH-SEC
      **         IF    ( MCP-RC          =   ZERO )
      **            MOVE    MCPDATA-REC TO  TNS-TENSU-REC
      **            MOVE    ZERO        TO  FLG-TENSU
      **         ELSE
      **            MOVE    1           TO  FLG-TENSU
      **         END-IF
      ***
      **         MOVE    "tbl_tensu"     TO  MCP-TABLE
      **         MOVE    "key"           TO  MCP-PATHNAME
      **         PERFORM 990-DBCLOSE-SEC
      **         DISPLAY "KSN-SRYCD = " WRK-NYUKHNKSN-SRYCD(IDX) 
      **                 " NAME = " TNS-NAME
      **     END-PERFORM
      *
      **     DISPLAY  "LNK-NYUKSNGET-RC = " LNK-NYUKSNGET-RC
           .
      *
       100-NYUKSN-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院料加算の算定可・不可チェック
      *****************************************************************
       4801-NYUKSN-CHK-SEC         SECTION.
      *
           MOVE    ZERO            TO  FLG-NYUKSN
      *
      *    入院料加算チェックテーブルによる判定
           INITIALIZE  NYUKSNCHK-REC
      *
      *    点数マスタ検索処理（入院料）
           PERFORM   48011-TENSU-SEL-SEC
           MOVE    WRK-BTU-NYUKSNKBN
                                   TO  NYUKSNCHK-NYUINKBN
      *
      *    点数マスタ検索処理（入院料加算）
           PERFORM   48012-TENSU-SEL-SEC
      *
      *    救急・在宅等支援病床初期加算（地域包括ケア病棟入院料）は
      *    入院料加算チェックができない為、チェックしない
           IF      TNS-SRYCD  =   "190177170"
               GO  TO   4801-NYUKSN-CHK-EXT
           END-IF
      *
      *    平成３０年３月までは入院料加算チェックマスタを使用
           IF     LNK-NYUKSNGET-SANTEIYM   <=     "201803"
             IF      TNS-NYUKHNKSNKBN    NOT =   ZERO
               MOVE    WRK-KSN-NYUKSNKBN
                                       TO  NYUKSNCHK-KSNKBN
               MOVE    LNK-NYUKSNGET-SANTEIYM
                                       TO  NYUKSNCHK-YUKOSTYMD(1:6)
               MOVE    "01"            TO  NYUKSNCHK-YUKOSTYMD(7:2)
               MOVE    NYUKSNCHK-YUKOSTYMD
                                       TO  NYUKSNCHK-YUKOEDYMD
      *
               MOVE    "tbl_nyuksnchk" TO  MCP-TABLE
               MOVE    "key"           TO  MCP-PATHNAME
               MOVE    NYUKSNCHK-REC   TO  MCPDATA-REC
               PERFORM 910-DBSELECT-SEC
               MOVE    "tbl_nyuksnchk" TO  MCP-TABLE
               MOVE    "key"           TO  MCP-PATHNAME
               MOVE    NYUKSNCHK-REC   TO  MCPDATA-REC
               PERFORM 910-DBFETCH-SEC
               IF    ( MCP-RC          =   ZERO )
                   MOVE    MCPDATA-REC TO  NYUKSNCHK-REC
                   IF    ( NYUKSNCHK-CHKKBN    =   "1" OR "2" )
                       CONTINUE
                   ELSE
                       MOVE   1        TO     FLG-NYUKSN
                   END-IF
               ELSE
                   MOVE   1        TO     FLG-NYUKSN
               END-IF
      *
      *
               MOVE    "tbl_nyuksnchk" TO  MCP-TABLE
               MOVE    "key"           TO  MCP-PATHNAME
               PERFORM 990-DBCLOSE-SEC
      *
             END-IF
           END-IF
      *
      *    平成３０年４月からは電子点数表マスタを使用
           IF     LNK-NYUKSNGET-SANTEIYM   >=     "201804"
             IF      WRK-KSN-CDKBN-KBNNUM  =   ZERO
               INITIALIZE                 ETENSU1-REC
               MOVE    LNK-NYUKSNGET-NYUIN-SRYCD
                                      TO  ETENSU1-SRYCD
               MOVE    TNS-SRYCD
                                      TO  ETENSU1-UPSRYCD
               MOVE    LNK-NYUKSNGET-SANTEIYM
                                      TO  ETENSU1-YUKOSTYMD(1:6)
               MOVE    "01"           TO  ETENSU1-YUKOSTYMD(7:2)
               MOVE    ETENSU1-YUKOSTYMD
                                      TO  ETENSU1-YUKOEDYMD
               MOVE    "tbl_etensu_1" TO  MCP-TABLE
               MOVE    "key4"         TO  MCP-PATHNAME
               PERFORM 910-ETENSU1-SELECT-SEC
               MOVE    "tbl_etensu_1" TO MCP-TABLE
               MOVE    "key4"         TO  MCP-PATHNAME
               PERFORM 910-ETENSU1-READ-SEC
               IF      FLG-ETENSU1    NOT =   ZERO
                   MOVE   1        TO     FLG-NYUKSN
               END-IF
      *        電子点数表マスタクローズ
               MOVE    "tbl_etensu_1"          TO  MCP-TABLE
               MOVE    "key4"                  TO  MCP-PATHNAME
               PERFORM   990-DBCLOSE-SEC
      *
             END-IF
           END-IF
      *
      *    平成３０年４月の療養病棟入院料２（経過措置２)は乳幼児加算、
      *    幼児加算を特別入院基本料の算定ができるよう暫定対処
      *    （電子点数表マスタが修正されるまでの間の対処）
           IF     LNK-NYUKSNGET-SANTEIYM   >=     "201804"
              IF  (NYUKSNCHK-NYUINKBN      =      "014")   AND
                  (TNS-SRYCD               =      "190100570"  OR
                                                  "190100870")
                  MOVE   ZERO      TO     FLG-NYUKSN
              END-IF
           END-IF
      *
      *    注加算の表用番号が同一であることの判定
           IF   WRK-KSN-CDKBN-KBNNUM    NOT =    ZERO
              IF  (WRK-BTU-CDKBN-KBNNUM  = WRK-KSN-CDKBN-KBNNUM)  AND
                  (WRK-BTU-CDKBN-KBNNUM-EDA = WRK-KSN-CDKBN-KBNNUM-EDA)
                  CONTINUE
              ELSE
                  MOVE    1     TO    FLG-NYUKSN
              END-IF
           END-IF
      *
      *    平成２４年改正で新設された入院料加算のチェック追加
      *    （このチェックは平成２８年３月で止める）
      *    以下の入院料加算については点数マスタに入院基本料加算区分がセット
      *    されていない為、入院料加算チェックテーブルによる判定ができない
      *    ことから、特定入院料算定時は算定不可とする暫定対処を追加する
      *    こととする。
      *    ・夜間２５対１急性期看護補助体制加算（平成２６年改正で追加）
      *    ・夜間５０対１急性期看護補助体制加算
      *    ・夜間１００対１急性期看護補助体制加算
      *    ・看護職員夜間配置加算
           IF    LNK-NYUKSNGET-SANTEIYM      <=   "201603"
               IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190173010"  OR
                                                 =    "190145970"  OR
                                                      "190146070"  OR
                                                      "190146170"
                   IF   ((WRK-BTU-CDKBN-KBNNUM   >=   300)     AND
                         (WRK-BTU-CDKBN-KBNNUM   <=   399))    OR
                        ( WRK-BTU-CDKBN-KBNNUM   =    400 )
                      MOVE    1     TO    FLG-NYUKSN
                   END-IF
               END-IF
           END-IF
      *
      *    特定入院料算定要件外で療養病棟入院基本料を算定時に算定できない
      *    入院料加算の判定
           IF    LNK-NYUKSNGET-GAI-NYUKSNKBN      =   "1"
      *      重症児（者）受入連携加算（療養病棟入院基本料）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190143270"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      急性期患者支援療養病床初期加算（療養病棟入院基本料）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190201770"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      在宅患者支援療養病床初期加算（療養病棟入院基本料）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190201870"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      地域医療支援病院入院診療加算
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190099870"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      基幹型臨床研修病院入院診療加算
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190117170"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      協力型臨床研修病院入院診療加算
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190119910"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      在宅患者緊急入院診療加算（在支診、在支病、在宅療養後方支援病院）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190145410"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      在宅患者緊急入院診療加算（１、２以外）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190100270"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      在宅患者緊急入院診療加算（連携医療機関（１以外））
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190127010"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      診療録管理体制加算１
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190172170"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      診療録管理体制加算２
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190100370"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      ５０対１補助体制加算（医師事務作業補助体制加算１）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190172710"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      ５０対１補助体制加算（医師事務作業補助体制加算２）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190127210"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      ７５対１補助体制加算（医師事務作業補助体制加算１）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190172810"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      ７５対１補助体制加算（医師事務作業補助体制加算２）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190127310"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      １００対１補助体制加算（医師事務作業補助体制加算１）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190172910"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      １００対１補助体制加算（医師事務作業補助体制加算２）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190127410"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      療養病棟療養環境改善加算１
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190146210"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      療養病棟療養環境改善加算２
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190146310"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      医療安全対策加算１
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190120510"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      医療安全対策加算２
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190136910"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      医療安全対策地域連携加算１
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190206670"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      医療安全対策地域連携加算２
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190206770"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      感染防止対策加算１
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190147210"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      感染防止対策加算２
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190147310"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      感染防止対策地域連携加算
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190147470"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      抗菌薬適正使用支援加算
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190206870"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      患者サポート体制充実加算
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190147510"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      病棟薬剤業務実施加算１
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190192110"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      在宅復帰機能強化加算（療養病棟入院料１）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190168070"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
      *      在宅復帰機能強化加算（療養病棟入院料１）（労災用）
             IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "101900140"
                   MOVE    1     TO    FLG-NYUKSN
             END-IF
           END-IF
      *
           .
      *
       4801-NYUKSN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ検索処理（入院料）
      *****************************************************************
       48011-TENSU-SEL-SEC              SECTION.
      *
           MOVE    SPACE           TO  WRK-NYUKSNKBN
           MOVE    ZERO            TO  WRK-BTU-CDKBN-KBNNUM
           MOVE    ZERO            TO  WRK-BTU-CDKBN-KBNNUM-EDA
           MOVE    ZERO            TO  WRK-BTU-CDKBN-KOUBAN
           MOVE    SPACE           TO  WRK-TOKUBETSU-NYUIN
      *
      *    平成２６年改正　夜勤時間超過減算の特別入院基本料判定用に
      *    入院料コードを置き換え
      *   （医療観察入院時はこの処理をスキップ）
           IF      LNK-NYUKSNGET-NYUIN-SRYCD(1:3) = "188"
               CONTINUE
           ELSE
      *        特定入院基本料のコード細分化置き換え
               IF     LNK-NYUKSNGET-SANTEIYM   >=   "20120401"
                   IF  LNK-NYUKSNGET-NYUIN-SRYCD  =  "190799410"
                       EVALUATE   SYS-5001-BTU-SBT
      *                    専門病院
                           WHEN    "06"
                                 MOVE "190161010" TO
                                        LNK-NYUKSNGET-NYUIN-SRYCD
      *                    障害者施設等
                           WHEN    "05"
                                 MOVE "190161210" TO
                                        LNK-NYUKSNGET-NYUIN-SRYCD
                       END-EVALUATE
      *
      *                特定機能病院は病棟設定された入院コードから判定
                       IF   SYS-5001-BTU-KHNSRYCD =  "190118610" OR
                                                     "190705610" OR
                                                     "190085910"
                         MOVE "190160810" TO  LNK-NYUKSNGET-NYUIN-SRYCD
                       END-IF
                   END-IF
               END-IF
      *
      *        夜勤時間超過減算入院料コード取得
               INITIALIZE    ORCSYAKINGEN-AREA
               MOVE   LNK-NYUKSNGET-SANTEIYM
                                   TO    LNK-YAKINGEN-SANTEIYM
               MOVE   SYS-5001-BTU-NUM
                                   TO    LNK-YAKINGEN-BTU-NUM
               MOVE   LNK-NYUKSNGET-NYUIN-SRYCD
                                   TO    LNK-YAKINGEN-SRYCD
               CALL   "ORCSYAKINGEN"    USING   ORCSYAKINGEN-AREA
                                                SPA-AREA
               IF   LNK-YAKINGEN-RC     =       ZERO
                    MOVE LNK-YAKINGEN-CHGSRYCD
                                   TO    LNK-NYUKSNGET-NYUIN-SRYCD
               END-IF
      *        夜勤時間特別入院基本料コード取得
               INITIALIZE    ORCSYAKINTOKU-AREA
               MOVE   LNK-NYUKSNGET-SANTEIYM
                                   TO    LNK-YAKINTOKU-SANTEIYM
               MOVE   SYS-5001-BTU-NUM
                                   TO    LNK-YAKINTOKU-BTU-NUM
               MOVE   LNK-NYUKSNGET-NYUIN-SRYCD
                                   TO    LNK-YAKINTOKU-SRYCD
               CALL   "ORCSYAKINTOKU"    USING  ORCSYAKINTOKU-AREA
                                                SPA-AREA
               IF   LNK-YAKINTOKU-RC     =       ZERO
                    MOVE LNK-YAKINTOKU-CHGSRYCD
                                   TO    LNK-NYUKSNGET-NYUIN-SRYCD
               END-IF
      *        看護職員数等入院基本料コード取得
               INITIALIZE    ORCSKANGOCHG-AREA
               MOVE   LNK-NYUKSNGET-SANTEIYM
                                   TO    LNK-KANGOCHG-SANTEIYM
               MOVE   SYS-5001-BTU-NUM
                                   TO    LNK-KANGOCHG-BTU-NUM
               MOVE   LNK-NYUKSNGET-NYUIN-SRYCD
                                   TO    LNK-KANGOCHG-SRYCD
               CALL   "ORCSKANGOCHG"     USING  ORCSKANGOCHG-AREA
                                                SPA-AREA
               IF   LNK-KANGOCHG-RC     =       ZERO
                    MOVE LNK-KANGOCHG-CHGSRYCD
                                   TO    LNK-NYUKSNGET-NYUIN-SRYCD
               END-IF
           END-IF
      *
           MOVE    ZERO            TO  FLG-TENSU
           INITIALIZE                  TNS-TENSU-REC
           MOVE    LNK-NYUKSNGET-HOSPNUM
                                   TO  TNS-HOSPNUM
           MOVE    LNK-NYUKSNGET-NYUIN-SRYCD
                                   TO  TNS-SRYCD
           MOVE    LNK-NYUKSNGET-SANTEIYM
                                   TO  TNS-YUKOSTYMD(1:6)
           MOVE    "01"            TO  TNS-YUKOSTYMD(7:2)
           MOVE    TNS-YUKOSTYMD   TO  TNS-YUKOEDYMD
           MOVE    TNS-TENSU-REC   TO  MCPDATA-REC
           MOVE    "tbl_tensu"     TO  MCP-TABLE
           MOVE    "key"           TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           MOVE    "tbl_tensu"     TO  MCP-TABLE
           MOVE    "key"           TO  MCP-PATHNAME
           PERFORM 910-DBFETCH-SEC
           IF    ( MCP-RC          =   ZERO )
               MOVE    MCPDATA-REC TO  TNS-TENSU-REC
               MOVE    ZERO        TO  FLG-TENSU
           ELSE
               MOVE    1           TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"     TO  MCP-TABLE
           MOVE    "key"           TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF    ( FLG-TENSU       NOT =   ZERO )
               GO  TO  48011-TENSU-SEL-EXT
           END-IF
      *
           MOVE    TNS-NYUKHNKSNKBN
                                   TO  WRK-BTU-NYUKSNKBN
           MOVE    TNS-CDKBN-KBNNUM
                                   TO WRK-BTU-CDKBN-KBNNUM
           MOVE    TNS-CDKBN-KBNNUM-EDA
                                   TO WRK-BTU-CDKBN-KBNNUM-EDA
           MOVE    TNS-CDKBN-KOUBAN
                                   TO WRK-BTU-CDKBN-KOUBAN
      *    療養病床以外・有床診療所療養病床入院基本料のとき、
      *    表用番号の置き換え（平成２４年改正）
           IF     (TNS-CDKBN-KBNNUM  = 108)   AND
                  (TNS-CDKBN-KOUBAN  =  10)   AND
                 ((TNS-YUKOSTYMD    >=  "20120401")   AND
                  (TNS-YUKOSTYMD    <=  "20140331"))
               MOVE   109           TO WRK-BTU-CDKBN-KBNNUM
               MOVE   ZERO          TO WRK-BTU-CDKBN-KBNNUM-EDA
           END-IF
      *    療養病床以外・有床診療所療養病床入院基本料のとき、
      *    表用番号の置き換え（平成２６年改正）
           IF     (TNS-CDKBN-KBNNUM  = 108)   AND
                  (TNS-CDKBN-KOUBAN  =  13)   AND
                  (TNS-YUKOSTYMD    >=  "20140401")
               MOVE   109           TO WRK-BTU-CDKBN-KBNNUM
               MOVE   ZERO          TO WRK-BTU-CDKBN-KBNNUM-EDA
           END-IF
      *
      *    一般病棟・療養病棟入院料１のとき、
      *    表用番号の置き換え（平成２６年改正）
           IF     (TNS-CDKBN-KBNNUM  = 100)   AND
                  (TNS-CDKBN-KOUBAN  =  16)   AND
                 ((TNS-YUKOSTYMD    >=  "20140401")   AND
                  (TNS-YUKOSTYMD    <=  "20180331"))
               MOVE   101           TO WRK-BTU-CDKBN-KBNNUM
               MOVE   0             TO WRK-BTU-CDKBN-KBNNUM-EDA
           END-IF
      *    一般病棟・療養病棟入院料１のとき、
      *    表用番号の置き換え（平成３０年改正）
           IF     (TNS-CDKBN-KBNNUM  = 100)   AND
                  (TNS-CDKBN-KOUBAN  =  14)   AND
                  (TNS-YUKOSTYMD    >=  "20180401")
               MOVE   101           TO WRK-BTU-CDKBN-KBNNUM
               MOVE   0             TO WRK-BTU-CDKBN-KBNNUM-EDA
           END-IF
      *    特定一般病棟・療養病棟入院料１のとき、
      *    表用番号の置き換え（平成２６年改正）
           IF     (TNS-CDKBN-KBNNUM  = 317)   AND
                  (TNS-CDKBN-KOUBAN  =  11)   AND
                 ((TNS-YUKOSTYMD    >=  "20140401")   AND
                  (TNS-YUKOSTYMD    <=  "20180331"))
               MOVE   101           TO WRK-BTU-CDKBN-KBNNUM
               MOVE   0             TO WRK-BTU-CDKBN-KBNNUM-EDA
           END-IF
      *    特定一般病棟・療養病棟入院料１のとき、
      *    表用番号の置き換え（平成３０年改正）
           IF     (TNS-CDKBN-KBNNUM  = 317)   AND
                  (TNS-CDKBN-KOUBAN  =   8)   AND
                  (TNS-YUKOSTYMD    >=  "20180401")
               MOVE   101           TO WRK-BTU-CDKBN-KBNNUM
               MOVE   0             TO WRK-BTU-CDKBN-KBNNUM-EDA
           END-IF
      *
      *    特定一般病棟入院料（地域包括ケア１〜４）のとき、
      *    表用番号の置き換え（平成３０年改正）
           IF     (TNS-CDKBN-KBNNUM  = 317)   AND
                  (TNS-CDKBN-KOUBAN  =  7)   AND
                  (TNS-YUKOSTYMD    >=  "20180401")
               MOVE   308           TO WRK-BTU-CDKBN-KBNNUM
               MOVE   3             TO WRK-BTU-CDKBN-KBNNUM-EDA
           END-IF
      *
      *    特別入院料の判定
           EVALUATE   TNS-NYUKHNKBN
               WHEN   73
               WHEN   74
               WHEN   75
               WHEN   76
               WHEN   77
               WHEN   78
               WHEN   79
               WHEN   83
               WHEN   84
      *        平成２６年改正で月平均夜勤時間超過減算の入院基本料区分追加
               WHEN   88
                   MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
           END-EVALUATE
      *    療養病棟入院基本料（特別入院基本料）
           IF  TNS-SRYCD      =    "190121810"
                   MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
           END-IF
      *    特定入院基本料（一般病棟入院基本料）（特別入院基本料等算定患者）
           IF  TNS-SRYCD      =    "190799510"
                   MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
           END-IF
      *
      *    平成２８年改正から入院基本料区分が予備項目になった事から、
      *    特別入院料の判定を表用番号に変更
           IF  (LNK-NYUKSNGET-SANTEIYM   >=   "201604")  AND
               (LNK-NYUKSNGET-SANTEIYM   <=   "201803")
      *       一般病棟特別入院基本料
      *       （選）一般病棟特別入院基本料
              IF     (TNS-CDKBN-KBNNUM  = 100)   AND
                     (TNS-CDKBN-KOUBAN  =   6)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       一般病棟入院基本料（夜勤時間超過減算）
              IF     (TNS-CDKBN-KBNNUM  = 100)   AND
                     (TNS-CDKBN-KOUBAN  =   7)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       一般病棟入院基本料（夜勤時間特別入院基本料）
              IF     (TNS-CDKBN-KBNNUM  = 100)   AND
                     (TNS-CDKBN-KOUBAN  =  18)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       療養病棟入院基本料２（特別入院基本料）
      *       療養病棟入院基本料２（夜勤時間超過減算）
              IF     (TNS-CDKBN-KBNNUM  = 101)   AND
                     (TNS-CDKBN-KOUBAN  =   3)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       療養病棟入院基本料２（看護職員数等経過措置）
              IF     (TNS-CDKBN-KBNNUM  = 101)   AND
                     (TNS-CDKBN-KOUBAN  =   9)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       療養病棟入院基本料２（夜勤時間特別入院基本料）
              IF     (TNS-CDKBN-KBNNUM  = 101)   AND
                     (TNS-CDKBN-KOUBAN  =  10)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       結核病棟特別入院基本料
      *       結核病棟入院基本料（夜勤時間超過減算）
              IF     (TNS-CDKBN-KBNNUM  = 102)   AND
                     (TNS-CDKBN-KOUBAN  =   7)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       結核病棟入院基本料（夜勤時間特別入院基本料）
              IF     (TNS-CDKBN-KBNNUM  = 102)   AND
                     (TNS-CDKBN-KOUBAN  =   9)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       精神病棟特別入院基本料
      *       精神病棟入院基本料（夜勤時間超過減算）
              IF     (TNS-CDKBN-KBNNUM  = 103)   AND
                     (TNS-CDKBN-KOUBAN  =   6)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       精神病棟入院基本料（夜勤時間特別入院基本料）
              IF     (TNS-CDKBN-KBNNUM  = 103)   AND
                     (TNS-CDKBN-KOUBAN  =  11)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       障害者施設等入院基本料（夜勤時間超過減算）
              IF     (TNS-CDKBN-KBNNUM  = 106)   AND
                     (TNS-CDKBN-KOUBAN  =   5)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       障害者施設等入院基本料（医療区分）（夜勤時間超過減算）
      *       （表用番号で判定不可の為、算定コードを直判定）
              IF      TNS-SRYCD       = "190198910"  OR
                                        "190199010"  OR
                                        "190199110"  OR
                                        "190199210"  OR
                                        "190199310"  OR
                                        "190199410"  OR
                                        "190199510"  OR
                                        "190199610"
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
           END-IF
      *    平成３０年から
           IF   LNK-NYUKSNGET-SANTEIYM   >=   "201804"
      *       一般病棟特別入院基本料
              IF     (TNS-CDKBN-KBNNUM  = 100)   AND
                     (TNS-CDKBN-KOUBAN  =   4)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       （選）一般病棟特別入院基本料
              IF     (TNS-CDKBN-KBNNUM  = 100)   AND
                     (TNS-CDKBN-KOUBAN  =   5)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       急性期一般入院料（月平均夜勤時間超過減算）
      *       地域一般入院料（月平均夜勤時間超過減算）
              IF     (TNS-CDKBN-KBNNUM  = 100)   AND
                     (TNS-CDKBN-KOUBAN  =   6)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       急性期一般入院料（夜勤時間特別入院基本料）
      *       地域一般入院料（夜勤時間特別入院基本料）
              IF     (TNS-CDKBN-KBNNUM  = 100)   AND
                     (TNS-CDKBN-KOUBAN  =  11)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       療養病棟入院基本料（特別入院基本料）
      *       療養病棟入院基本料（特別入院基本料）（生活療養）
              IF     (TNS-CDKBN-KBNNUM  = 101)   AND
                     (TNS-CDKBN-KOUBAN  =   3)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       療養病棟入院料２（経過措置２）
      *       療養病棟入院料２（経過措置２）（生活療養）
              IF     (TNS-CDKBN-KBNNUM  = 101)   AND
                     (TNS-CDKBN-KOUBAN  =  11)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       結核病棟特別入院基本料
      *       結核病棟入院基本料（夜勤時間超過減算）
              IF     (TNS-CDKBN-KBNNUM  = 102)   AND
                     (TNS-CDKBN-KOUBAN  =   7)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       結核病棟入院基本料（夜勤時間特別入院基本料）
              IF     (TNS-CDKBN-KBNNUM  = 102)   AND
                     (TNS-CDKBN-KOUBAN  =   9)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       精神病棟特別入院基本料
      *       精神病棟入院基本料（夜勤時間超過減算）
              IF     (TNS-CDKBN-KBNNUM  = 103)   AND
                     (TNS-CDKBN-KOUBAN  =   6)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       精神病棟入院基本料（夜勤時間特別入院基本料）
              IF     (TNS-CDKBN-KBNNUM  = 103)   AND
                     (TNS-CDKBN-KOUBAN  =  11)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       障害者施設等入院基本料（夜勤時間超過減算）
              IF     (TNS-CDKBN-KBNNUM  = 106)   AND
                     (TNS-CDKBN-KOUBAN  =   5)
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
      *       障害者施設等入院基本料（医療区分）（夜勤時間超過減算）
      *       （表用番号で判定不可の為、算定コードを直判定）
              IF      TNS-SRYCD       = "190198910"  OR
                                        "190199010"  OR
                                        "190199110"  OR
                                        "190199210"  OR
                                        "190199310"  OR
                                        "190199410"  OR
                                        "190199510"  OR
                                        "190199610"
                    MOVE    "1"     TO  WRK-TOKUBETSU-NYUIN
              END-IF
           END-IF
           .
      *
       48011-TENSU-SEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ検索処理（入院料加算）
      *****************************************************************
       48012-TENSU-SEL-SEC              SECTION.
      *
           MOVE    SPACE           TO  WRK-NYUKSNKBN
           MOVE    ZERO            TO  WRK-KSN-CDKBN-KBNNUM
           MOVE    ZERO            TO  WRK-KSN-CDKBN-KBNNUM-EDA
      *
           MOVE    ZERO            TO  FLG-TENSU
           INITIALIZE                  TNS-TENSU-REC
      *
           MOVE    LNK-NYUKSNGET-HOSPNUM
                                   TO  TNS-HOSPNUM
      *
      *    特別入院料算定時に幼児加算と乳幼児加算の加算コード置き換え
           IF      WRK-TOKUBETSU-NYUIN   =   "1"
               EVALUATE   WRK-NYUKHNKSN-SRYCD(IDX8)
                   WHEN   "190100470"
                       MOVE  "190100570"  TO  WRK-NYUKHNKSN-SRYCD(IDX8)
                   WHEN   "190100770"
                       MOVE  "190100870"  TO  WRK-NYUKHNKSN-SRYCD(IDX8)
               END-EVALUATE
           END-IF
      *
           MOVE    WRK-NYUKHNKSN-SRYCD(IDX8)
                                   TO  TNS-SRYCD
      *
      *    平成２８年改正で新設された入院料加算チェック対応
      *    点数マスタに入院基本料加算区分がセットされていない加算について、
      *    コードを読み替えて加算チェックを行う。
      *  ・A207-3 夜間看護体制加算（夜間○○対１急性期看護補助体制加算の注加算）
      *           を夜間３０対１急性期看護補助体制加算のコードに読み替える
           IF   (LNK-NYUKSNGET-SANTEIYM      >=   "201604")   AND
                (LNK-NYUKSNGET-SANTEIYM      <=   "201803")
               IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190190770"
                   MOVE   "190173010"  TO  TNS-SRYCD
               END-IF
           END-IF
      *  ・A214   夜間７５対１看護補助加算（看護補助加算の注加算）
      *           を看護補助加算１のコードに読み替える
           IF   (LNK-NYUKSNGET-SANTEIYM      >=   "201604")   AND
                (LNK-NYUKSNGET-SANTEIYM      <=   "201803")
               IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190191170"
                   MOVE   "190103770"  TO  TNS-SRYCD
               END-IF
           END-IF
      *  ・A214   夜間看護体制加算（看護補助加算の注加算）
      *           を看護補助加算１のコードに読み替える
           IF   (LNK-NYUKSNGET-SANTEIYM      >=   "201604")   AND
                (LNK-NYUKSNGET-SANTEIYM      <=   "201803")
               IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190191270"
                   MOVE   "190103770"  TO  TNS-SRYCD
               END-IF
           END-IF
      *
      *    平成２８年改正で新設された入院料加算ではないが点数マスタに
      *    入院基本料加算区分がセットされていない加算について、
      *    コードを読み替えて加算チェックを行う。
      *  ・A234-2 感染防止対策地域連携加算（感染防止対策加算の注加算）
      *           を感染防止対策加算１のコードに読み替える
           IF   (LNK-NYUKSNGET-SANTEIYM      >=   "201604")   AND
                (LNK-NYUKSNGET-SANTEIYM      <=   "201803")
               IF    WRK-NYUKHNKSN-SRYCD(IDX8)   =    "190147470"
                   MOVE   "190147210"  TO  TNS-SRYCD
               END-IF
           END-IF
      *
      *
      *    平成３０年４月からの入院料加算チェック対応
      *  （入院基本料等加算の中で更に注の加算となっているものを読み替え）
      *  （注加算通番０で単純に読み替えができないものが対象）
           IF    LNK-NYUKSNGET-SANTEIYM      >=   "201804"
      *(A207-3)夜間３０対１急性期看護補助体制加算（急性期看護補助体制加算の注加算）
               IF    WRK-NYUKHNKSN-SRYCD(IDX8)  =  "190173010"
                  MOVE   "190145710"   TO  TNS-SRYCD
               END-IF
      *(A207-3)夜間５０対１急性期看護補助体制加算（急性期看護補助体制加算の注加算）
               IF    WRK-NYUKHNKSN-SRYCD(IDX8)  =  "190145970"
                  MOVE   "190145710"   TO  TNS-SRYCD
               END-IF
      *(A207-3)夜間１００対１急性期看護補助体制加算（急性期看護補助体制加算の注加算）
               IF    WRK-NYUKHNKSN-SRYCD(IDX8)  =  "190146070"
                  MOVE   "190145710"   TO  TNS-SRYCD
               END-IF
      *(A207-3)夜間看護体制加算（急性期看護補助体制加算の注加算）
               IF    WRK-NYUKHNKSN-SRYCD(IDX8)  =  "190190770"
                  MOVE   "190145710"   TO  TNS-SRYCD
               END-IF
           END-IF
      *
           MOVE    LNK-NYUKSNGET-SANTEIYM
                                   TO  TNS-YUKOSTYMD(1:6)
           MOVE    "01"            TO  TNS-YUKOSTYMD(7:2)
           MOVE    TNS-YUKOSTYMD   TO  TNS-YUKOEDYMD
           MOVE    TNS-TENSU-REC   TO  MCPDATA-REC
      *
           MOVE    "tbl_tensu"     TO  MCP-TABLE
           MOVE    "key"           TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           MOVE    "tbl_tensu"     TO  MCP-TABLE
           MOVE    "key"           TO  MCP-PATHNAME
           PERFORM 910-DBFETCH-SEC
           IF    ( MCP-RC          =   ZERO )
               MOVE    MCPDATA-REC TO  TNS-TENSU-REC
               MOVE    ZERO        TO  FLG-TENSU
           ELSE
               MOVE    1           TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"     TO  MCP-TABLE
           MOVE    "key"           TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF    ( FLG-TENSU       NOT =   ZERO )
               GO  TO  48012-TENSU-SEL-EXT
           END-IF
      *
      *
      *    平成３０年３月までは入院料加算チェックマスタを使用する
           IF     LNK-NYUKSNGET-SANTEIYM   <=     "201803"
               MOVE    TNS-NYUKHNKSNKBN
                                   TO  WRK-KSN-NYUKSNKBN
           END-IF
      *
      *    入院基本料等加算の中で注の加算となる場合は上位の加算に
      *    読み替えを行う（これを行わないと電子点数表テーブルでチェック
      *    できない）
           MOVE    SPACE                     TO  WRK-KSN-CHUKSNCD
                                                 WRK-KSN-CHUKSNTUBAN
           IF     LNK-NYUKSNGET-SANTEIYM     >=     "201804"
             IF ((TNS-CDKBN-KBNNUM           >=  200)   AND
                 (TNS-CDKBN-KBNNUM           <=  299))
                 MOVE    TNS-CHUKSNCD        TO  WRK-KSN-CHUKSNCD
                 MOVE    TNS-CHUKSNTUBAN     TO  WRK-KSN-CHUKSNTUBAN
                 IF    WRK-KSN-CHUKSNTUBAN   NOT =  "0"
                    INITIALIZE                  TNS-TENSU-REC
                    MOVE    LNK-NYUKSNGET-HOSPNUM
                                                TO  TNS-HOSPNUM
                    MOVE    LNK-NYUKSNGET-SANTEIYM
                                                TO  TNS-YUKOSTYMD(1:6)
                    MOVE    "01"                TO  TNS-YUKOSTYMD(7:2)
                    MOVE    TNS-YUKOSTYMD       TO  TNS-YUKOEDYMD
                    MOVE    WRK-KSN-CHUKSNCD    TO  TNS-CHUKSNCD
                    MOVE    "0"                 TO  TNS-CHUKSNTUBAN
                    MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
                    MOVE    "tbl_tensu"         TO  MCP-TABLE
                    MOVE    "key36"             TO  MCP-PATHNAME
                    PERFORM 910-DBSELECT-SEC
                    MOVE    "tbl_tensu"         TO  MCP-TABLE
                    MOVE    "key36"             TO  MCP-PATHNAME
                    PERFORM 910-DBFETCH-SEC
                    IF    ( MCP-RC          =   ZERO )
                        MOVE    MCPDATA-REC TO  TNS-TENSU-REC
                    END-IF
      *
                    MOVE    "tbl_tensu"         TO  MCP-TABLE
                    MOVE    "key36"             TO  MCP-PATHNAME
                    PERFORM 990-DBCLOSE-SEC
                 END-IF
             END-IF
           END-IF
      *
      *
      *    入院料（Ａ１００番台）、特定入院料（Ａ３００番台）に含まれる
      *    注加算のみが判定対象となる
           IF      (TNS-CDKBN-KBN       =   "A")     AND
                   (TNS-CDKBN-KBNNUM   >=   100)     AND
                   (TNS-CDKBN-KBNNUM   <=   199)
               MOVE    TNS-CDKBN-KBNNUM TO  WRK-KSN-CDKBN-KBNNUM
               MOVE    TNS-CDKBN-KBNNUM-EDA
                                        TO  WRK-KSN-CDKBN-KBNNUM-EDA
           END-IF
      *
           IF      (TNS-CDKBN-KBN       =   "A")     AND
                   (TNS-CDKBN-KBNNUM   >=   300)     AND
                   (TNS-CDKBN-KBNNUM   <=   399)
               MOVE    TNS-CDKBN-KBNNUM TO  WRK-KSN-CDKBN-KBNNUM
               MOVE    TNS-CDKBN-KBNNUM-EDA
                                        TO  WRK-KSN-CDKBN-KBNNUM-EDA
           END-IF
           .
      *
       48012-TENSU-SEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院患者の年齢算出
      *****************************************************************
       4801-PT-AGE-SEC         SECTION.
      *
           INITIALIZE                      PTINF-REC
           MOVE    LNK-NYUKSNGET-HOSPNUM
                                       TO  PTINF-HOSPNUM
           MOVE    LNK-NYUKSNGET-PTID  TO  PTINF-PTID
           MOVE    PTINF-REC           TO  MCPDATA-REC
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBFETCH-SEC
           IF    ( MCP-RC              =   ZERO  )
               MOVE    MCPDATA-REC     TO  PTINF-REC
           ELSE
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      FLG-PTINF           =   1
               MOVE    ZERO            TO  WRK-NENREI
           ELSE
               MOVE   PTINF-BIRTHDAY   TO  WRK-YMDS1
               MOVE   LNK-NYUKSNGET-SANTEIYM
                                       TO  WRK-YMDS2(1:6)
               MOVE   "01"             TO  WRK-YMDS2(7:2)
               MOVE   ZERO             TO  WRK-NENREI
               COMPUTE  WRK-NENREI     =   WRK-YYS2
                                       -   WRK-YYS1
               IF   WRK-YMDS1(5:4)     >   WRK-YMDS2(5:4)
                    ADD   -1           TO  WRK-NENREI
               END-IF
           END-IF
      *
           .
      *
       4801-PT-AGE-EXT.
           EXIT.
      *
      *****************************************************************
      *    病棟情報検索処理
      *****************************************************************
       4801-BTUSEL-SEC             SECTION.
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    ZERO                TO  FLG-SYSKANRI
      *
           MOVE    LNK-NYUKSNGET-HOSPNUM
                                       TO  SYS-HOSPNUM
           MOVE    "5001"              TO  SYS-KANRICD
           MOVE    LNK-NYUKSNGET-BTUNUM
                                       TO  SYS-KBNCD
           MOVE    LNK-NYUKSNGET-SANTEIYM
                                       TO  SYS-STYUKYMD(1:6)
           MOVE    "01"                TO  SYS-STYUKYMD(7:2)
           MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYS-5001-REC
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               INITIALIZE                  SYS-5001-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       4801-BTUSEL-EXT.
           EXIT.
      *****************************************************************
      *    病室情報検索処理
      *****************************************************************
       4801-BRMSEL-SEC             SECTION.
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    ZERO                TO  FLG-SYSKANRI
      *
           MOVE    LNK-NYUKSNGET-HOSPNUM
                                       TO  SYS-HOSPNUM
           MOVE    "5002"              TO  SYS-KANRICD
           MOVE    LNK-NYUKSNGET-BRMNUM
                                       TO  SYS-KBNCD
           MOVE    LNK-NYUKSNGET-SANTEIYM
                                       TO  SYS-STYUKYMD(1:6)
           MOVE    "01"                TO  SYS-STYUKYMD(7:2)
           MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYS-5002-REC
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               INITIALIZE                  SYS-5002-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       4801-BRMSEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ検索
      *****************************************************************
       910-TENSU-SELECT-SEC        SECTION.
      *
           MOVE    TNS-TENSU-REC          TO  MCPDATA-REC
           PERFORM   910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-TENSU
           ELSE
               MOVE    1                  TO  FLG-TENSU
           END-IF
      *
           .
       910-TENSU-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ読込
      *****************************************************************
       910-TENSU-READ-SEC        SECTION.
      *
           PERFORM   910-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  TNS-TENSU-REC
               MOVE    ZERO               TO  FLG-TENSU
           ELSE
               INITIALIZE                     TNS-TENSU-REC
               MOVE    1                  TO  FLG-TENSU
           END-IF
      *
           .
       910-TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    電子点数表検索
      *****************************************************************
       910-ETENSU1-SELECT-SEC        SECTION.
      *
           MOVE    ETENSU1-REC            TO  MCPDATA-REC
           PERFORM   910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-ETENSU1
           ELSE
               MOVE    1                  TO  FLG-ETENSU1
           END-IF
      *
           .
       910-ETENSU1-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    電子点数表読込
      *****************************************************************
       910-ETENSU1-READ-SEC        SECTION.
      *
           PERFORM   910-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  ETENSU1-REC
               MOVE    ZERO               TO  FLG-ETENSU1
           ELSE
               INITIALIZE                     ETENSU1-REC
               MOVE    1                  TO  FLG-ETENSU1
           END-IF
      *
           .
       910-ETENSU1-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブル検索処理
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    ＤＢ読み込み処理
      *****************************************************************
       910-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢクロース処理
      *****************************************************************
       990-DBCLOSE-SEC         SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
