      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCGH01.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ÀÁµá´ÉÍý
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ÀÁµá´ÉÍý¡Ý¼ê½ñ¤­ÄûÀµ¡Ê£È£°£±¡Ë
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  00/12/01    MCC¡ÝÆ£¸¶¡¡   ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  01.00.01    MCC-Æ£¸¶     01/09/14  ¥¯¥ê¥¢¥Ü¥¿¥óÄÉ²Ã
      *  01.01.01    MCC-Æ£¸¶     01/09/21  JOIN¤Î½¤Àµ      
      *  01.01.02    MCC-Æ£¸¶     01/10/01  ÀÁµá¶èÊ¬¡¢ÄûÀµ¶èÊ¬¤Î½¤Àµ
      *  01.01.03    MCC-Æ£¸¶     01/10/26  ÊÝ¸±¼ïÊÌ¤Îµ­¹æ½¤Àµ
      *  01.01.04    MCC-Æ£¸¶     01/11/28  »áÌ¾¸¡º÷¤Ø¤ÎÁ«°Ü¤Î½¤Àµ
      *  01.01.05    MCC-Æ£¸¶     02/02/19  µ­¹æÈÖ¹æ¤¬Ä¹¤¤¤È¤­É½¼¨¤¹¤ë
      *                                     ¤è¤¦¤Ë½¤Àµ
      *  01.01.06    MCC-Æ£¸¶     02/03/28  »áÌ¾¸¡º÷²èÌÌ¤«¤éÌá¤Ã¤¿¤È¤­¤Î
      *                                     ¥Á¥§¥Ã¥¯¤òÃæ»ß
      *  £²£°£°£²¡¥£±£°²þÀµÂÐ±þ 
      *  01.02.01    NACL-Æ£¸¶    02/10/7   ¸©Æâ¸©³°¶èÊ¬¡¦¸©ÈÖ¹æ¡¦
      *                                     Ç¯Îð¡¦µëÉÕ³ä¹ç¤ÎÄÉ²Ã
      *  01.02.02    NACL-Æ£¸¶    02/10/10  ¥ì¥»¥×¥È¼ïÊÌ¤Î½ÐÎÏ¤Î½¤Àµ
      *                                     ºßÂð¿²¤¿¤­¤êÅù¤ÎÉ½¼¨¤ÎÄÉ²Ã       
      *  01.02.03    NACL-Æ£¸¶    03/02/05  ¸øÈñÀÁµá½ñ£Ä£Â¤òÄÉ²Ã
      *                                     Æþ±¡ÂÐ±þ
      *                                     ²Ê¥³¡¼¥É¤ÎÆþÎÏ¤Î½¤Àµ
      *  01.02.04    NACL-Æ£¸¶    03/07/05  ´µ¼Ô»áÌ¾¤Ç¤Î¸¡º÷¤òÄÉ²Ã
      *  01.02.05    NACL-Æ£¸¶    04/01/26  ÇÓÂ¾À©¸æ½èÍýÄÉ²Ã
      *
      *  02.06.01    NACL-Æ£¸¶    05/04/11  ËÜ¿Í²ÈÂ²¶èÊ¬¤ÎÄÉ²Ã
      *  02.06.02    NACL-Æ£¸¶    05/09/29  Êä½õ¶èÊ¬¤«¤é¤ÎÊÔ½¸¤Î½¤Àµ
      *
      *  02.07.01    NACL-Æ£¸¶    05/08/20  ÆÃÊÌÎÅÍÜÈñÂÐ±þ
      *  02.07.02    NACL-Æ£¸¶    05/10/31  MONFUNCÂÐ±þ
      *
      *  02.08.01    NACL-Æ£¸¶    06/02/20  ¼ç²ÊÂÐ±þ
      *
      *£²£°£°£¶Ç¯£´·î²þÀµÂÐ±þ
      *  02.09.01    NACL-Æ£¸¶    06/04/14  £²£°£°£¶Ç¯£´·î²þÀµÂÐ±þ
      *                                     ¡Ö£±£³»ØÆ³¡×¡Ö£±£³°å³Ø´ÉÍý¡×
      *                                     ¡Ö¿©»öÆü¿ô¡×¡Ö¿©»ö²ó¿ô¡×
      *                                      ¤Î¿ÇÎÅÇ¯·î¤Ë¤è¤ëÉ½¼¨¤ÎÊÑ¹¹
      *                                     ¡ÖºßÂð¿²¤¿¤­¤êÅù¡×¤ÎÉ½¼¨¤ò
      *                                     ¡Öºß°åÁíÅù¡×¤ËÊÑ¹¹
      *
      *  03.03.01    NACL-Æ£¸¶    06/09/27  £²£°£°£¶Ç¯£±£°·î²þÀµÂÐ±þ
      *                                     ¹¹¿·Á°¥Á¥§¥Ã¥¯¤òÄÉ²Ã 
      *
      *  03.05.01    NACL-Æ£¸¶    07/04/19  ¥°¥ë¡¼¥×¿ÇÎÅÂÐ±þ
      *
      *  04.01.01    NACL-Æ£¸¶    07/11/22  ¸ø³²¥ì¥»¥×¥ÈÂÐ±þ
      *
      *  04.02.01    NACL-Æ£¸¶    08/03/25  Ê¿À®£²£°Ç¯£´·î²þÀµÂÐ±þ
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
       DATA                    DIVISION.
       FILE                        SECTION.
      *
       WORKING-STORAGE             SECTION.
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *
      *    ÀÁµá´ÉÍý¥¹¥ÑÎÎ°è
           COPY    "H01COMMON-SPA".
      *
      *    ²èÌÌÍÑ£Ó£Ð£Á
           COPY    "H01SCR-SPA".
      *
           COPY    "ENUM-VALUE".
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-END             PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
           03  FLG-SEIKYU          PIC 9(01).
           03  FLG-PTINF           PIC 9(01).
           03  FLG-KOHSKY          PIC 9(01).
      *
      *    ¥«¥¦¥ó¥ÈÎÎ°è
       01  CNT-AREA.
           03  CNT-ERR             PIC 9(06).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX                 PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDZ                 PIC 9(04).
           03  IDX2                PIC 9(04).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-MOTOPG          PIC X(08).
           03  WRK-Z9              PIC Z9.
           03  WRK-HIDMSG          PIC X(70).
      *
           03  WRK-SYO             PIC 9(02).
           03  WRK-AMARI           PIC 9(02).
           03  WRK-WIDGET          PIC 9(02).
           03  WRK-WIDGET-X        REDEFINES   WRK-WIDGET
                                   PIC X(02).
           03  WRK-WIDGET1         PIC 9(01).
      *
           03  WRK-NYUGAIKBN       PIC X(06).
           03  WRK-TEISYUTUSAKI    PIC X(10).
           03  WRK-RECESYUBETU     PIC X(10).
           03  WRK-YM              PIC X(07). 
           03  WRK-SYMD.
               05  WRK-SYY         PIC 9(04).
               05  WRK-SMM         PIC 9(02).
               05  WRK-SDD         PIC 9(02).
           03  WRK-WYMD.
               05  WRK-WGO         PIC X(01).
               05  WRK-WYY         PIC 9(02).
               05  WRK-WMM         PIC 9(02).
               05  WRK-WDD         PIC 9(02).
      *
       01  WRK-HEN-AREA.
           03  WRK-HENYMDG         PIC X(09).
           03  WRK-HENYMD.
               05  WRK-HGO         PIC X(01).
               05  WRK-HYY         PIC 9(02).
               05  FILLER          PIC X(01)   VALUE   ".".
               05  WRK-HMM         PIC 9(02).
               05  FILLER          PIC X(01)   VALUE   ".".
               05  WRK-HDD         PIC 9(02).
      *
      *
      *    ¥¹¥ÑÎÎ°è¡Ê¥ï¡¼¥¯¡Ë
           COPY    "COMMON-SPA"
                                   REPLACING   //SPA-//
                                   BY          //WRK-SPA-//.
      * 
        01  WRK-CONS-SRYYM-200610  PIC 9(06)   VALUE   200610. 
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿
           COPY    "CPSYSKANRI.INC".
      *    °åÎÅµ¡´Ø¾ðÊó
           COPY    "CPSK1001.INC".
      *
           COPY    "CPSK1005.INC".
      *
           COPY    "CPRCF010.INC".
      *
      *    ´µ¼Ô¥Þ¥¹¥¿¡Ý
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    ¸øÈñÀÁµá½ñ
           COPY    "CPKOHSKY.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *   ´µ¼ÔÈÖ¹æÊÑ´¹¥µ¥Ö
           COPY    "CPORCSPTID.INC".
      *   ´µ¼ÔÈÖ¹æÊÑ´¹¥µ¥Ö
           COPY    "CPORCSPTNUM.INC".
      *
      *   ²èÌÌÆüÉÕÊÑ´¹¥µ¥Ö
          COPY    "CPORCSGDAY.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
      *
      *    ÇÓÂ¾À©¸æ¥µ¥Ö¥Ñ¥é¥á¥¿
           COPY    "CPORCSLOCK.INC".
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
        LINKAGE                     SECTION.
      *
           COPY    "MCPAREA".
           COPY    "ORCA-SPA".
      *
           COPY    "LINKAREA".
      *
       01  SCRAREA.
           COPY    "H01.INC".
           COPY    "H99.INC".
           COPY    "HERR.INC".
           COPY    "HID1.INC".
      *
       PROCEDURE                   DIVISION    USING
           MCPAREA
           SPAAREA
           LINKAREA
           SCRAREA.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           MOVE    SPA-COMMON      TO  SPA-AREA
           MOVE    SPA-FREE        TO  SPA-H01FREE
           MOVE    SPA-WORK        TO  SPA-H01KYOUTU
      *
           MOVE    SPACE           TO  SPA-ERRCD
           MOVE    ZERO            TO  FLG-END
      *
           EVALUATE    MCP-STATUS      ALSO    MCP-EVENT
               WHEN    "LINK"          ALSO    ANY
                   PERFORM 100-INIT-SEC
      *    ²èÌÌÁ«°Ü
               WHEN     "PUTG"           ALSO   "CLICKED"
                   PERFORM 200-GMNSENI
      *    ÆþÎÏ
               WHEN      OTHER
                   PERFORM 200-ENTRY
           END-EVALUATE.
      *
      *    ²èÌÌÁ«°Ü¤¬¤Ê¤¤»þ¡¢²èÌÌÉ½¼¨¤Ø
           IF      FLG-END             =   ZERO
               PERFORM 500-SET-SCREEN
           END-IF
      *
           MOVE    SPA-H01KYOUTU   TO  SPA-WORK
           MOVE    SPA-AREA        TO  SPA-COMMON
           MOVE    SPA-H01FREE     TO  SPA-FREE
      *
           .
           EXIT    PROGRAM
           .
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  WRK-AREA
      *
      *    ¥¨¥é¡¼²èÌÌ¤è¤ê
           IF      SPA-MOTOPG          =   "HERR"
               MOVE    SPACE               TO  SPA-MOTOPG
               PERFORM 5001-MAPCUR-SEC
           ELSE
      *        ½é´ü²èÌÌ¥»¥Ã¥È
               PERFORM 300-SCREEN-SEC
               IF      FLG-END             =   1
                   GO  TO  100-INIT-EXT
               END-IF
      *        ²èÌÌÊÔ½¸
               PERFORM 500-GMNHEN-SEC
           END-IF
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    SPACE               TO  MCP-PUTTYPE
           MOVE    "H01    "           TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                   TO  FLG-END
           .
       100-INIT-EXT.
           EXIT.
      *****************************************************************
      *    ½é´ü²èÌÌ½èÍý
      *****************************************************************
       300-SCREEN-SEC              SECTION.
      *    Â¾¤Î£Ì£Ä¤è¤ê
           IF      LINKAREA        NOT =   SPACE
               MOVE    LNK-KYOUTU          TO  SPA-KYOUTU
               MOVE    SPA-MOTOPG          TO  WRK-MOTOPG
      *
      *        ¸µ¤Î²èÌÌ¤ØÌá¤¹
               IF      WRK-MOTOPG(1:3)     =   "Y01"  OR  "U01"  OR
                                               "P97"
                   MOVE    LNK-COMMON      TO  SPA-KYOUTU
                   MOVE    LNK-SCRSPA      TO  SPA-H01-AREA
                   MOVE    SPA-WORK        TO  SPA-H01KYOUTU
               END-IF
      *        ³°Éô¤è¤êÁªÂò¤¬¤¢¤ë»þ
               IF      WRK-MOTOPG(1:3)     =   "U01"  OR
                                               "P97"
                   PERFORM 3101-U01SPASET-SEC
                   GO      TO      300-SCREEN-EXT
               ELSE
                   MOVE    SPA-MOTOPG          TO  SPA-MOTOPG2
               END-IF
           END-IF
      *
           EVALUATE    SPA-MOTOPG
      *    ¸¡º÷½èÍý
               WHEN    "H99"
                   PERFORM 320-H99SPASET-SEC
                   GO      TO      300-SCREEN-EXT
      *    ¹¹¿·½èÍý
               WHEN    "HID1"
                   PERFORM 330-HID1-SET-SEC
                   GO      TO      300-SCREEN-EXT
           END-EVALUATE
      *
           PERFORM 310-SPASET-SEC
      *
           MOVE    1               TO  SPA-H01GMN-PAGE
      *
           .
       300-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ì£Ä³°¤Î¹àÌÜÆþÎÏÊÔ½¸½èÍý
      *****************************************************************
       3101-U01SPASET-SEC              SECTION.
      *
           MOVE    LNK-KYOUTU          TO  WRK-SPA-KYOUTU
      *    ´µ¼Ô¸¡º÷¤è¤ê
           IF      WRK-SPA-PTNUM       =   SPA-H01GMN-PTNUM
               CONTINUE
           ELSE
               IF      WRK-SPA-PTNUM       NOT =   SPACE
                   MOVE    WRK-SPA-PTNUM       TO  H01-PTNUM
                   MOVE    H01-PTNUM           TO  SPA-H01GMN-PTNUM
      *
                   MOVE    SPACE               TO  SPA-UPDFLG
                                                   SPA-HENFLG
      *
                   INITIALIZE                  ORCSPTIDAREA
                   MOVE    SPA-HOSPNUM         TO  SPTID-HOSPNUM
                   MOVE    SPA-H01GMN-PTNUM    TO  SPTID-PTNUM
                   CALL    "ORCSPTID"          USING   ORCSPTIDAREA
                                                       SPA-AREA
                   IF      SPTID-RC        NOT =   ZERO
                       MOVE    "0004"          TO  SPA-ERRCD
                   ELSE
                       INITIALIZE              SPA-H01GMN-TABLE
                                               SPA-H01GMN-KOUMOKU
                       MOVE    SPTID-PTNUM     TO  SPA-H01GMN-PTNUM
                       MOVE    SPTID-PTID      TO  SPA-H01NAI-PTID
      *                ´µ¼Ô¥Þ¥¹¥¿¡¼Â¸ºß¥Á¥§¥Ã¥¯
                       MOVE    SPA-HOSPNUM     TO  PTINF-HOSPNUM
                       MOVE    SPA-H01NAI-PTID TO  PTINF-PTID
                       PERFORM 900-PTINF-READ-SEC
                       IF      FLG-PTINF   NOT =   ZERO
                           MOVE    "0001"      TO  SPA-ERRCD
                       ELSE
      *
      *                    ÇÓÂ¾À©¸æ½èÍý
                           PERFORM 990-LOCK-IN-SEC
                           IF      SPA-ERRCD       =   SPACE
                               MOVE    PTINF-NAME  TO  SPA-H01GMN-NAME
                           END-IF
                       END-IF
                   END-IF     
               END-IF    
               MOVE    2                   TO  SPA-H01GMN-CUR
           END-IF
           .
       3101-U01SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¹¥Ñ½é´üÊÔ½¸½èÍý
      *****************************************************************
       310-SPASET-SEC              SECTION.
      *
           INITIALIZE              SPA-H01-AREA
                                   SPA-H01KYOUTU 
      *
      *    °åÎÅµ¡´Ø¾ðÊó¼èÆÀ
           INITIALIZE                  SYS-1001-REC
           MOVE    "1001"              TO  SYS-1001-KANRICD
           MOVE    "*"                 TO  SYS-1001-KBNCD
           MOVE    ZERO                TO  SYS-1001-STYUKYMD
                                           SYS-1001-EDYUKYMD
grpsys     MOVE    SPA-HOSPNUM         TO  SYS-1001-HOSPNUM
           MOVE    SYS-1001-REC        TO  MCPDATA-REC
           PERFORM 910-SYSKANRI-INV-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1001-REC
           END-IF
           MOVE    SYS-1001-HOSPSBT1   TO  SPA-SYS-1001-HOSPSBT1
      *
      *    ¸«½Ð¤·ÊÔ½¸
           MOVE    "2"                 TO  SPA-RECE10-NYUGAIKBN
           MOVE    SPA-SYSYMD (1:6)    TO  SPA-RECE10-SRYYM
           MOVE    1                   TO  SPA-RECE10-TEISYUTUSAKI 
           PERFORM 3101-MIDASI-HENSYU-SEC
           MOVE    SPACE               TO  SPA-RECE10-NYUGAIKBN
           MOVE    ZERO                TO  SPA-RECE10-SRYYM
                                           SPA-RECE10-TEISYUTUSAKI
      *
           MOVE    "0"                 TO  SPA-H01GMN-SKYKBNL    (1)
           MOVE    "ÀÁµá¤·¤Ê¤¤"        TO  SPA-H01GMN-SKYKBNMEIL (1)
           MOVE    "1"                 TO  SPA-H01GMN-SKYKBNL    (2)
           MOVE    "Ì¤ÀÁµá"            TO  SPA-H01GMN-SKYKBNMEIL (2)
           MOVE    "2"                 TO  SPA-H01GMN-SKYKBNL    (3)
           MOVE    "ÀÁµáºÑ"            TO  SPA-H01GMN-SKYKBNMEIL (3)
      *                                 
           MOVE    1                   TO  SPA-H01GMN-CUR
           .
       310-SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸«½Ð¤·ÊÔ½¸½èÍý
      *****************************************************************
       3101-MIDASI-HENSYU-SEC          SECTION.
      *
           MOVE    SPACE               TO  SPA-H01GMN-MIDASI-AREA
      *
           EVALUATE    SPA-RECE10-NYUGAIKBN
                                       ALSO    SPA-RECE10-TEISYUTUSAKI
               WHEN    "1"             ALSO    1
               WHEN    "1"             ALSO    2
               WHEN    "1"             ALSO    6
                   PERFORM VARYING IDX FROM    1   BY  1
                           UNTIL   IDX >       35
                       MOVE    "blue"  TO  SPA-H01GMN-MIDASI-STYLE (IDX)
                   END-PERFORM
                   MOVE  "          ½é    ¿Ç"  TO SPA-H01GMN-MIDASI(01)
                   IF      SPA-RECE10-SRYYM    >=  "200604"
                       MOVE  "          °å³Ø´ÉÍý"
                                               TO SPA-H01GMN-MIDASI(02)
                   ELSE 
                       MOVE  "          »Ø    Æ³"
                                               TO SPA-H01GMN-MIDASI(02)
                   END-IF 
                   MOVE  "          ºß    Âð"  TO SPA-H01GMN-MIDASI(03)
                   MOVE  "          Æâ    Éþ"  TO SPA-H01GMN-MIDASI(04)
                   MOVE  "          ÆÖ    Éþ"  TO SPA-H01GMN-MIDASI(05)
                   MOVE  "          ³°    ÍÑ"  TO SPA-H01GMN-MIDASI(06)
                   MOVE  "          Ä´    ºÞ"  TO SPA-H01GMN-MIDASI(07)
                   MOVE  "          Ëã    ÆÇ"  TO SPA-H01GMN-MIDASI(08)
                   MOVE  "          Ä´    ´ð"  TO SPA-H01GMN-MIDASI(09)
                   MOVE  "        Èé²¼¶ÚÆùÆâ"  TO SPA-H01GMN-MIDASI(10)
                   MOVE  "            ÀÅÌ®Æâ"  TO SPA-H01GMN-MIDASI(11)
                   MOVE  "            ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(12)
                   MOVE  "            ½è  ÃÖ"  TO SPA-H01GMN-MIDASI(13)
                   MOVE  "            Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(14)
                   MOVE  "        ¼ê½Ñ¡¦Ëã¿ì"  TO SPA-H01GMN-MIDASI(15)
                   MOVE  "            Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(16)
                   IF      SPA-RECE10-SRYYM    >=  "200804"
                       MOVE  "          ÉÂÍý¸¡ºº"
                                               TO SPA-H01GMN-MIDASI(17)
                   ELSE
                       MOVE  "            ¸¡  ºº"
                                               TO SPA-H01GMN-MIDASI(17)
                   END-IF
                   MOVE  "            Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(18)
                   MOVE  "          ²èÁü¿ÇÃÇ"  TO SPA-H01GMN-MIDASI(19)
                   MOVE  "            Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(20)
                   MOVE  "            ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(21)
                   MOVE  "          Ìô    ºÞ"  TO SPA-H01GMN-MIDASI(22)
                   MOVE  "  Æþ±¡´ðËÜÎÁ¡¦²Ã»»"  TO SPA-H01GMN-MIDASI(23)
                   MOVE  "ÆÃÄêÆþ±¡ÎÁ¡¦¤½¤ÎÂ¾"
                                               TO SPA-H01GMN-MIDASI(28)
                   MOVE  "        ¡·        "  TO SPA-H01GMN-MIDASI(24)
                                                  SPA-H01GMN-MIDASI(25)
                                                  SPA-H01GMN-MIDASI(26)
                                                  SPA-H01GMN-MIDASI(27)
                                                  SPA-H01GMN-MIDASI(29)
                                                  SPA-H01GMN-MIDASI(30)
                                                  SPA-H01GMN-MIDASI(31)
                                                  SPA-H01GMN-MIDASI(32)
                   MOVE  SPACE              TO    SPA-H01GMN-MIDASI(33)
                                                  SPA-H01GMN-MIDASI(34)
                                                  SPA-H01GMN-MIDASI(35)
                   MOVE  "¿©»öÎÅÍÜÈñ"       TO SPA-H01GMN-SHOMIDASI (1)
                   MOVE  "¿©»öÉ¸½àÉéÃ´³Û"   TO SPA-H01GMN-SHOMIDASI (2) 
                   IF      SPA-RECE10-SRYYM    >=  "200604"
                       MOVE  "¿©»ö²ó¿ô"     TO SPA-H01GMN-SHOMIDASI (3)
                   ELSE
                       MOVE  "¿©»öÆü¿ô"     TO SPA-H01GMN-SHOMIDASI (3)
                   END-IF 
                   MOVE  WIDGET-NORMAL      TO SPA-H01GMN-SHO-STATE 
                   MOVE    "¹ç·×ÅÀ¿ô"       TO SPA-H01GMN-TENMIDASI (1)
                   MOVE    "°ìÉôÉéÃ´¶â"     TO SPA-H01GMN-TENMIDASI (2)
                   IF      SPA-RECE10-SRYYM    <   "200304"
                       MOVE    "ÌôºÞ°ìÉôÉéÃ´¶â"
                                            TO SPA-H01GMN-TENMIDASI (3)
                   END-IF
                   MOVE    "¼ÂÆü¿ô"         TO SPA-H01GMN-TENMIDASI (4)
               WHEN    "2"             ALSO    1
               WHEN    "2"             ALSO    2
               WHEN    "2"             ALSO    6
                   PERFORM VARYING IDX FROM    1   BY  1
                           UNTIL   IDX >       35
                       MOVE    "blue"  TO  SPA-H01GMN-MIDASI-STYLE (IDX)
                   END-PERFORM
                   MOVE    "        ½é    ¿Ç"  TO SPA-H01GMN-MIDASI(01)
                   MOVE    "        ºÆ    ¿Ç"  TO SPA-H01GMN-MIDASI(02)
                   MOVE    "    ³°Íè´ÉÍý²Ã»»"  TO SPA-H01GMN-MIDASI(03)
                   MOVE    "          »þ´Ö³°"  TO SPA-H01GMN-MIDASI(04)
                   MOVE    "        µÙ    Æü"  TO SPA-H01GMN-MIDASI(05)
                   MOVE    "        ¿¼    Ìë"  TO SPA-H01GMN-MIDASI(06)
                   IF      SPA-RECE10-SRYYM    >=  "200604"
                       MOVE  "        °å³Ø´ÉÍý"
                                               TO SPA-H01GMN-MIDASI(07)
                   ELSE 
                       MOVE  "        »Ø    Æ³"
                                               TO SPA-H01GMN-MIDASI(07)
                   END-IF 
                   MOVE    "        ±ý    ¿Ç"  TO SPA-H01GMN-MIDASI(08)
                   MOVE    "        Ìë    ´Ö"  TO SPA-H01GMN-MIDASI(09)
                   MOVE    "      ¿¼Ìë¡¦¶ÛµÞ"  TO SPA-H01GMN-MIDASI(10)
                   MOVE    "ºßÂð´µ¼ÔË¬Ìä¿ÇÎÅ"  TO SPA-H01GMN-MIDASI(11)
                   MOVE    "          ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(12)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(13)
                   MOVE    "        ÆâÉþÌôºÞ"  TO SPA-H01GMN-MIDASI(14)
                   MOVE    "        ÆâÉþÄ´ºÞ"  TO SPA-H01GMN-MIDASI(15)
                   MOVE    "        ÆÖÉþÌôºÞ"  TO SPA-H01GMN-MIDASI(16)
                   MOVE    "        ³°ÍÑÌôºÞ"  TO SPA-H01GMN-MIDASI(17)
                   MOVE    "        ³°ÍÑÄ´ºÞ"  TO SPA-H01GMN-MIDASI(18)
                   MOVE    "        ½è    Êý"  TO SPA-H01GMN-MIDASI(19)
                   MOVE    "        Ëã    ÆÇ"  TO SPA-H01GMN-MIDASI(20)
                   MOVE    "        Ä´    ´ð"  TO SPA-H01GMN-MIDASI(21)
                   MOVE    "      Èé²¼¶ÚÆùÆâ"  TO SPA-H01GMN-MIDASI(22)
                   MOVE    "          ÀÅÌ®Æâ"  TO SPA-H01GMN-MIDASI(23)
                   MOVE    "          ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(24)
                   MOVE    "          ½è  ÃÖ"  TO SPA-H01GMN-MIDASI(25)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(26)
                   MOVE    "      ¼ê½Ñ¡¦Ëã¿ì"  TO SPA-H01GMN-MIDASI(27)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(28)
                   IF      SPA-RECE10-SRYYM    >=  "200804"
                       MOVE  "        ÉÂÍý¸¡ºº"
                                               TO SPA-H01GMN-MIDASI(29)
                   ELSE
                       MOVE  "          ¸¡  ºº"
                                               TO SPA-H01GMN-MIDASI(29)
                   END-IF
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(30)
                   MOVE    "        ²èÁü¿ÇÃÇ"  TO SPA-H01GMN-MIDASI(31)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(32)
                   MOVE    "        ½èÊý¤»¤ó"  TO SPA-H01GMN-MIDASI(33)
                   MOVE    "          ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(34)
                   MOVE    "        Ìô    ºÞ"  TO SPA-H01GMN-MIDASI(35)
                   MOVE    SPACE               TO
                                               SPA-H01GMN-SHOMIDASI (1)
                                               SPA-H01GMN-SHOMIDASI (2)
                                               SPA-H01GMN-SHOMIDASI (3)
                   MOVE  WIDGET-INSENSITIVE TO SPA-H01GMN-SHO-STATE 
                   MOVE    "¹ç·×ÅÀ¿ô"       TO SPA-H01GMN-TENMIDASI (1)
                   MOVE    "°ìÉôÉéÃ´¶â"     TO SPA-H01GMN-TENMIDASI (2)
                   IF      SPA-RECE10-SRYYM    <   "200304"
                       MOVE    "ÌôºÞ°ìÉôÉéÃ´¶â"
                                            TO SPA-H01GMN-TENMIDASI (3)
                   END-IF
                   MOVE    "¼ÂÆü¿ô"         TO SPA-H01GMN-TENMIDASI (4)
               WHEN    "1"             ALSO    5
                   PERFORM VARYING IDX FROM    1   BY  1
                           UNTIL   IDX >       31
                       MOVE    "blue"  TO  SPA-H01GMN-MIDASI-STYLE (IDX)
                   END-PERFORM
                   MOVE  "          ½é    ¿Ç"  TO SPA-H01GMN-MIDASI(01)
                   MOVE  "          °å³Ø´ÉÍý"  TO SPA-H01GMN-MIDASI(02)
                   MOVE  "          ºß    Âð"  TO SPA-H01GMN-MIDASI(03)
                   MOVE  "          Æâ    Éþ"  TO SPA-H01GMN-MIDASI(04)
                   MOVE  "          ÆÖ    Éþ"  TO SPA-H01GMN-MIDASI(05)
                   MOVE  "          ³°    ÍÑ"  TO SPA-H01GMN-MIDASI(06)
                   MOVE  "          Ä´    ºÞ"  TO SPA-H01GMN-MIDASI(07)
                   MOVE  "          Ëã    ÆÇ"  TO SPA-H01GMN-MIDASI(08)
                   MOVE  "          Ä´    ´ð"  TO SPA-H01GMN-MIDASI(09)
                   MOVE  "            Ãí  ¼Í"  TO SPA-H01GMN-MIDASI(10)
                   MOVE  "            Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(11)
                   MOVE  "            ½è  ÃÖ"  TO SPA-H01GMN-MIDASI(12)
                   MOVE  "            Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(13)
                   MOVE  "        ¼ê½Ñ¡¦Ëã¿ì"  TO SPA-H01GMN-MIDASI(14)
                   MOVE  "            Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(15)
                   MOVE  "            ¸¡  ºº"  TO SPA-H01GMN-MIDASI(16)
                   MOVE  "            Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(17)
                   MOVE  "          ²èÁü¿ÇÃÇ"  TO SPA-H01GMN-MIDASI(18)
                   MOVE  "        ¥Õ¥£¥ë¥àÅù"  TO SPA-H01GMN-MIDASI(19)
                   MOVE  "            ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(20)
                   MOVE  "          Ìô    ºÞ"  TO SPA-H01GMN-MIDASI(21)
                   MOVE  "  Æþ±¡´ðËÜÎÁ¡¦²Ã»»"  TO SPA-H01GMN-MIDASI(22)
                   MOVE  "  ¸ø³²Æþ±¡ÎÅÍÜ»ØÆ³"  TO SPA-H01GMN-MIDASI(27)
                   MOVE  "  À¶¾ô¶õµ¤¼¼´ÉÍýÎÁ"  TO SPA-H01GMN-MIDASI(30)
                   MOVE  "            ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(31)
                   MOVE  "        ¡·        "  TO SPA-H01GMN-MIDASI(23)
                                                  SPA-H01GMN-MIDASI(24)
                                                  SPA-H01GMN-MIDASI(25)
                                                  SPA-H01GMN-MIDASI(26)
                                                  SPA-H01GMN-MIDASI(28)
                                                  SPA-H01GMN-MIDASI(29)
                   MOVE  WIDGET-INSENSITIVE TO SPA-H01GMN-SHO-STATE 
                   MOVE    "        ¾®  ·×" TO SPA-H01GMN-TENMIDASI (1)
                   MOVE    "¡Ê¿©»ö¡Ë¾®  ·×" TO SPA-H01GMN-TENMIDASI (2)
                   MOVE    "        ¹ç  ·×" TO SPA-H01GMN-TENMIDASI (3)
                   MOVE    "        ¼ÂÆü¿ô" TO SPA-H01GMN-TENMIDASI (4)
               WHEN    "2"             ALSO    5
                   PERFORM VARYING IDX FROM    1   BY  1
                           UNTIL   IDX >       38
                       MOVE    "blue"  TO  SPA-H01GMN-MIDASI-STYLE (IDX)
                   END-PERFORM
                   MOVE    "        ½é    ¿Ç"  TO SPA-H01GMN-MIDASI(1)
                   MOVE    "        ºÆ    ¿Ç"  TO SPA-H01GMN-MIDASI(2)
                   MOVE    "    ³°Íè´ÉÍý²Ã»»"  TO SPA-H01GMN-MIDASI(3)
                   MOVE    "          »þ´Ö³°"  TO SPA-H01GMN-MIDASI(4)
                   MOVE    "        µÙ    Æü"  TO SPA-H01GMN-MIDASI(5)
                   MOVE    "        ¿¼    Ìë"  TO SPA-H01GMN-MIDASI(6)
                   MOVE    "        ¸ø³²ÁêÃÌ"  TO SPA-H01GMN-MIDASI(7)
                   MOVE    "¸ø³²³°ÍèÎÅÍÜ»ØÆ³"  TO SPA-H01GMN-MIDASI(8)
                   MOVE    "          ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(9)
                   MOVE    "        ±ý    ¿Ç"  TO SPA-H01GMN-MIDASI(10)
                   MOVE    "        Ìë    ´Ö"  TO SPA-H01GMN-MIDASI(11)
                   MOVE    "      ¿¼Ìë¡¦¶ÛµÞ"  TO SPA-H01GMN-MIDASI(12)
                   MOVE    "ºßÂð´µ¼ÔË¬Ìä¿ÇÎÅ"  TO SPA-H01GMN-MIDASI(13)
                   MOVE    "          ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(14)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(15)
                   MOVE    "        ÆâÉþÌôºÞ"  TO SPA-H01GMN-MIDASI(16)
                   MOVE    "        ÆâÉþÄ´ºÞ"  TO SPA-H01GMN-MIDASI(17)
                   MOVE    "        ÆÖ    Éþ"  TO SPA-H01GMN-MIDASI(18)
                   MOVE    "        ³°ÍÑÌôºÞ"  TO SPA-H01GMN-MIDASI(19)
                   MOVE    "        ³°ÍÑÄ´ºÞ"  TO SPA-H01GMN-MIDASI(20)
                   MOVE    "        ½è    Êý"  TO SPA-H01GMN-MIDASI(21)
                   MOVE    "        Ëã    ÆÇ"  TO SPA-H01GMN-MIDASI(22)
                   MOVE    "        Ä´    ´ð"  TO SPA-H01GMN-MIDASI(23)
                   MOVE    "      Èé²¼¶ÚÆùÆâ"  TO SPA-H01GMN-MIDASI(24)
                   MOVE    "          ÀÅÌ®Ãí"  TO SPA-H01GMN-MIDASI(25)
                   MOVE    "          ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(26)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(27)
                   MOVE    "          ½è  ÃÖ"  TO SPA-H01GMN-MIDASI(28)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(29)
                   MOVE    "      ¼ê½Ñ¡¦Ëã¿ì"  TO SPA-H01GMN-MIDASI(30)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(31)
                   MOVE    "          ¸¡  ºº"  TO SPA-H01GMN-MIDASI(32)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(33)
                   MOVE    "        ²èÁü¿ÇÃÇ"  TO SPA-H01GMN-MIDASI(34)
                   MOVE    "      ¥Õ¥£¥ë¥àÅù"  TO SPA-H01GMN-MIDASI(35)
                   MOVE    "        ½èÊý¤»¤ó"  TO SPA-H01GMN-MIDASI(36)
                   MOVE    "          ¤½¤ÎÂ¾"  TO SPA-H01GMN-MIDASI(37)
                   MOVE    "          Ìô  ºÞ"  TO SPA-H01GMN-MIDASI(38)
                   MOVE  WIDGET-INSENSITIVE TO SPA-H01GMN-SHO-STATE 
                   MOVE    "¾®  ·×"         TO SPA-H01GMN-TENMIDASI (1)
                   MOVE    SPACE            TO SPA-H01GMN-TENMIDASI (2)
                   MOVE    "¹ç  ·×"         TO SPA-H01GMN-TENMIDASI (3)
                   MOVE    "¼ÂÆü¿ô"         TO SPA-H01GMN-TENMIDASI (4)
           END-EVALUATE
      *
           .
       3101-MIDASI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÂÐ¾Ý¥ì¥»¥×¥È¥»¥Ã¥È½èÍý
      *****************************************************************
       320-H99SPASET-SEC          SECTION.
      *
           IF      SPA-H99-KEY      =   SPACE
               GO  TO  320-H99SPASET-EXT
           END-IF
      *
           MOVE    SPACE           TO  SPA-UPDFLG
                                       SPA-HENFLG
      *
           INITIALIZE              RECE10-REC
           MOVE    SPA-H99-KEY     TO  RECE10-KEY
           PERFORM 900-SEIKYU-INV-SEC
           MOVE    MCPDATA-REC     TO  RECE10-REC
      *
      *    ÇÓÂ¾À©¸æ½èÍý
           PERFORM 990-LOCK-IN-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO  TO  320-H99SPASET-EXT
           END-IF
      *
           PERFORM 41021-SEIKYU-HENSYU-SEC
      *
           .
       320-H99SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³ÎÇ§²èÌÌ¡Ê£Ã£É£Ä£±¡Ë£Ï£Ë½èÍý
      *****************************************************************
       330-HID1-SET-SEC            SECTION.
      *
           IF      SPA-HID1-FLG    =   "OK"
               IF      SPA-HIDCD       =    "1001"
                   PERFORM 450-KOUSIN-SEC
               ELSE
                   MOVE    SPACE       TO  SPA-UPDFLG
                   MOVE    "JOIN"      TO  MCP-PUTTYPE
                   PERFORM 210-BACK
               END-IF
           ELSE
               MOVE    "1"             TO  SPA-UPDFLG 
           END-IF
      *
           MOVE    SPACE           TO  SPA-HID1-FLG
           MOVE    SPACE           TO  SPA-HIDCD      
           .
       330-HID1-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       200-GMNSENI                   SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *        Ìá¤ë
               WHEN    "CLICKED"       ALSO    "B01"
                   MOVE    "CHANGE"        TO  MCP-PUTTYPE
                   PERFORM 210-BACK
      *        ¥¯¥ê¥¢
               WHEN    "CLICKED"       ALSO    "B02"
                   PERFORM 420-CLEAR-SEC
      *    »áÌ¾¸¡º÷
               WHEN    "CLICKED"       ALSO    "B09"
                   PERFORM 480-KENSAKU-SEC
      *     ¹¹¿·
               WHEN    "CLICKED"       ALSO    "B12"
                   PERFORM 450-KOUSIN-GIDMSG-SEC
           END-EVALUATE
      *
           .
       200-GMNSENI-EXT.
           EXIT.
      *****************************************************************
      *    ²ñÏÃ¡¡½èÍý
      *****************************************************************
       200-ENTRY                   SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
               WHEN    "ACTIVATE"      ALSO    "PTNUM"
                   PERFORM 4101-PTNUM-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "SRYYM"
                   PERFORM 4102-SRYYM-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "SRYKA"
                   PERFORM 4103-SRYKA-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "SKYYM"
                   PERFORM 4104-SKYYM-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "HENREIYM"
                   PERFORM 4105-HENREIYM-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "SKYKBN"
                   PERFORM 4106-SKYKBN-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN01"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN02"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN03"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN04"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN05"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN06"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN07"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN08"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN09"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN10"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN11"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN12"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN13"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN14"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN15"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN16"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN17"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN18"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN19"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN20"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN21"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN22"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN23"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN24"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN25"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN26"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN27"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN28"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN29"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN30"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN31"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN32"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN33"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN34"
               WHEN    "ACTIVATE"      ALSO    "NKHNTEN35"
      **         WHEN    "ACTIVATE"      ALSO    "NKHNTEN36"
      **         WHEN    "ACTIVATE"      ALSO    "NKHNTEN37"
      **         WHEN    "ACTIVATE"      ALSO    "NKHNTEN38"
                   MOVE    MCP-WIDGET (8:2)    TO  WRK-WIDGET 
                   MOVE    WRK-WIDGET          TO  IDX 
                   PERFORM 4108-KHNTEN-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NKAISU01"
               WHEN    "ACTIVATE"      ALSO    "NKAISU02"
               WHEN    "ACTIVATE"      ALSO    "NKAISU03"
               WHEN    "ACTIVATE"      ALSO    "NKAISU04"
               WHEN    "ACTIVATE"      ALSO    "NKAISU05"
               WHEN    "ACTIVATE"      ALSO    "NKAISU06"
               WHEN    "ACTIVATE"      ALSO    "NKAISU07"
               WHEN    "ACTIVATE"      ALSO    "NKAISU08"
               WHEN    "ACTIVATE"      ALSO    "NKAISU09"
               WHEN    "ACTIVATE"      ALSO    "NKAISU10"
               WHEN    "ACTIVATE"      ALSO    "NKAISU11"
               WHEN    "ACTIVATE"      ALSO    "NKAISU12"
               WHEN    "ACTIVATE"      ALSO    "NKAISU13"
               WHEN    "ACTIVATE"      ALSO    "NKAISU14"
               WHEN    "ACTIVATE"      ALSO    "NKAISU15"
               WHEN    "ACTIVATE"      ALSO    "NKAISU16"
               WHEN    "ACTIVATE"      ALSO    "NKAISU17"
               WHEN    "ACTIVATE"      ALSO    "NKAISU18"
               WHEN    "ACTIVATE"      ALSO    "NKAISU19"
               WHEN    "ACTIVATE"      ALSO    "NKAISU20"
               WHEN    "ACTIVATE"      ALSO    "NKAISU21"
               WHEN    "ACTIVATE"      ALSO    "NKAISU22"
               WHEN    "ACTIVATE"      ALSO    "NKAISU23"
               WHEN    "ACTIVATE"      ALSO    "NKAISU24"
               WHEN    "ACTIVATE"      ALSO    "NKAISU25"
               WHEN    "ACTIVATE"      ALSO    "NKAISU26"
               WHEN    "ACTIVATE"      ALSO    "NKAISU27"
               WHEN    "ACTIVATE"      ALSO    "NKAISU28"
               WHEN    "ACTIVATE"      ALSO    "NKAISU29"
               WHEN    "ACTIVATE"      ALSO    "NKAISU30"
               WHEN    "ACTIVATE"      ALSO    "NKAISU31"
               WHEN    "ACTIVATE"      ALSO    "NKAISU32"
               WHEN    "ACTIVATE"      ALSO    "NKAISU33"
               WHEN    "ACTIVATE"      ALSO    "NKAISU34"
               WHEN    "ACTIVATE"      ALSO    "NKAISU35"
      **         WHEN    "ACTIVATE"      ALSO    "NKAISU36"
      **         WHEN    "ACTIVATE"      ALSO    "NKAISU37"
      **         WHEN    "ACTIVATE"      ALSO    "NKAISU38"
                   MOVE    MCP-WIDGET (7:2)    TO  WRK-WIDGET 
                   MOVE    WRK-WIDGET          TO  IDX  
                   PERFORM 4109-KAISU-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NTENSU01"
               WHEN    "ACTIVATE"      ALSO    "NTENSU02"
               WHEN    "ACTIVATE"      ALSO    "NTENSU03"
               WHEN    "ACTIVATE"      ALSO    "NTENSU04"
               WHEN    "ACTIVATE"      ALSO    "NTENSU05"
               WHEN    "ACTIVATE"      ALSO    "NTENSU06"
               WHEN    "ACTIVATE"      ALSO    "NTENSU07"
               WHEN    "ACTIVATE"      ALSO    "NTENSU08"
               WHEN    "ACTIVATE"      ALSO    "NTENSU09"
               WHEN    "ACTIVATE"      ALSO    "NTENSU10"
               WHEN    "ACTIVATE"      ALSO    "NTENSU11"
               WHEN    "ACTIVATE"      ALSO    "NTENSU12"
               WHEN    "ACTIVATE"      ALSO    "NTENSU13"
               WHEN    "ACTIVATE"      ALSO    "NTENSU14"
               WHEN    "ACTIVATE"      ALSO    "NTENSU15"
               WHEN    "ACTIVATE"      ALSO    "NTENSU16"
               WHEN    "ACTIVATE"      ALSO    "NTENSU17"
               WHEN    "ACTIVATE"      ALSO    "NTENSU18"
               WHEN    "ACTIVATE"      ALSO    "NTENSU19"
               WHEN    "ACTIVATE"      ALSO    "NTENSU20"
               WHEN    "ACTIVATE"      ALSO    "NTENSU21"
               WHEN    "ACTIVATE"      ALSO    "NTENSU22"
               WHEN    "ACTIVATE"      ALSO    "NTENSU23"
               WHEN    "ACTIVATE"      ALSO    "NTENSU24"
               WHEN    "ACTIVATE"      ALSO    "NTENSU25"
               WHEN    "ACTIVATE"      ALSO    "NTENSU26"
               WHEN    "ACTIVATE"      ALSO    "NTENSU27"
               WHEN    "ACTIVATE"      ALSO    "NTENSU28"
               WHEN    "ACTIVATE"      ALSO    "NTENSU29"
               WHEN    "ACTIVATE"      ALSO    "NTENSU30"
               WHEN    "ACTIVATE"      ALSO    "NTENSU31"
               WHEN    "ACTIVATE"      ALSO    "NTENSU32"
               WHEN    "ACTIVATE"      ALSO    "NTENSU33"
               WHEN    "ACTIVATE"      ALSO    "NTENSU34"
               WHEN    "ACTIVATE"      ALSO    "NTENSU35"
      **         WHEN    "ACTIVATE"      ALSO    "NTENSU36"
      **         WHEN    "ACTIVATE"      ALSO    "NTENSU37"
      **         WHEN    "ACTIVATE"      ALSO    "NTENSU38"
                   MOVE    MCP-WIDGET (7:2)    TO  WRK-WIDGET 
                   MOVE    WRK-WIDGET          TO  IDX  
                   MOVE    1                   TO  IDY
                   PERFORM 4110-TENSU-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU101"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU102"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU103"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU104"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU105"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU106"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU107"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU108"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU109"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU110"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU111"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU112"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU113"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU114"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU115"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU116"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU117"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU118"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU119"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU120"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU121"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU122"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU123"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU124"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU125"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU126"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU127"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU128"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU129"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU130"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU131"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU132"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU133"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU134"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU135"
      **         WHEN    "ACTIVATE"      ALSO    "NKOHTENSU136"
      **         WHEN    "ACTIVATE"      ALSO    "NKOHTENSU137"
      **         WHEN    "ACTIVATE"      ALSO    "NKOHTENSU138"
                   MOVE    MCP-WIDGET (11:2)   TO  WRK-WIDGET 
                   MOVE    WRK-WIDGET          TO  IDX 
                   MOVE    2                   TO  IDY 
                   PERFORM 4110-TENSU-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU201"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU202"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU203"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU204"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU205"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU206"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU207"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU208"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU209"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU210"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU211"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU212"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU213"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU214"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU215"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU216"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU217"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU218"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU219"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU220"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU221"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU222"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU223"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU224"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU225"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU226"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU227"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU228"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU229"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU230"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU231"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU232"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU233"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU234"
               WHEN    "ACTIVATE"      ALSO    "NKOHTENSU235"
      **         WHEN    "ACTIVATE"      ALSO    "NKOHTENSU236"
      **         WHEN    "ACTIVATE"      ALSO    "NKOHTENSU237"
      **         WHEN    "ACTIVATE"      ALSO    "NKOHTENSU238"
                   MOVE    MCP-WIDGET (11:2)   TO  WRK-WIDGET 
                   MOVE    WRK-WIDGET          TO  IDX 
                   MOVE    3                   TO  IDY 
                   PERFORM 4110-TENSU-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NFTNMONEY1"
               WHEN    "ACTIVATE"      ALSO    "NFTNMONEY2"
               WHEN    "ACTIVATE"      ALSO    "NFTNMONEY3"
                   MOVE    MCP-WIDGET (10:1)   TO  WRK-WIDGET1 
                   MOVE    WRK-WIDGET1         TO  IDX 
                   PERFORM 4111-FTNMONEY-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NYKZFTN1"
               WHEN    "ACTIVATE"      ALSO    "NYKZFTN2"
               WHEN    "ACTIVATE"      ALSO    "NYKZFTN3"
                   MOVE    MCP-WIDGET (8:1)    TO  WRK-WIDGET1 
                   MOVE    WRK-WIDGET1         TO  IDX 
                   PERFORM 4112-YKZFTN-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NJNISSU1"
               WHEN    "ACTIVATE"      ALSO    "NJNISSU2"
               WHEN    "ACTIVATE"      ALSO    "NJNISSU3"
                   MOVE    MCP-WIDGET (8:1)    TO  WRK-WIDGET1 
                   MOVE    WRK-WIDGET1         TO  IDX 
                   PERFORM 4113-JNISSU-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NSHORYOYOHI1"
               WHEN    "ACTIVATE"      ALSO    "NSHORYOYOHI2"
               WHEN    "ACTIVATE"      ALSO    "NSHORYOYOHI3"
                   MOVE    MCP-WIDGET (12:1)   TO  WRK-WIDGET1 
                   MOVE    WRK-WIDGET1         TO  IDX 
                   PERFORM 4114-SHORYOYOHI-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NSHOFTN1"
               WHEN    "ACTIVATE"      ALSO    "NSHOFTN2"
               WHEN    "ACTIVATE"      ALSO    "NSHOFTN3"
                   MOVE    MCP-WIDGET (8:1)    TO  WRK-WIDGET1 
                   MOVE    WRK-WIDGET1         TO  IDX 
                   PERFORM 4115-SHOFTN-CHK-SEC
               WHEN    "ACTIVATE"      ALSO    "NSHONISSU1"
               WHEN    "ACTIVATE"      ALSO    "NSHONISSU2"
               WHEN    "ACTIVATE"      ALSO    "NSHONISSU3"
                   MOVE    MCP-WIDGET (10:1)    TO  WRK-WIDGET1 
                   MOVE    WRK-WIDGET1         TO  IDX 
                   PERFORM 4116-SHONISSU-CHK-SEC
           END-EVALUATE
      *
           .
       200-ENTRY-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼ÔÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4101-PTNUM-CHK-SEC            SECTION.
      *
           MOVE    2                   TO  SPA-H01GMN-CUR
      *
           MOVE    SPACE               TO  SPA-UPDFLG
                                           SPA-HENFLG
      *
           MOVE    H01-PTNUM           TO  SPA-H01GMN-PTNUM
      *
           INITIALIZE                  ORCSPTNUMAREA
           MOVE    SPA-H01GMN-PTNUM    TO  SPTNUM-PTNUM
           CALL    "ORCSPTNUM"         USING   ORCSPTNUMAREA
                                               SPA-AREA
           EVALUATE    SPTNUM-RC
               WHEN    00
                   MOVE    SPTNUM-PTNUM        TO  SPTID-PTNUM
                   MOVE    SPTNUM-PTID         TO  SPTID-PTID
               WHEN   10
                   MOVE    "0004"              TO  SPA-ERRCD
               WHEN    20
                   MOVE    SPACE               TO  LINKAREA
                   MOVE    SPA-KYOUTU          TO  LNK-COMMON
                   MOVE    SPA-H01-AREA        TO  LNK-SCRSPA
      *
                   MOVE    "H01"               TO  SPA-MOTOPG
                   MOVE    "P97"               TO  SPA-SAKIPG
      *            »áÌ¾¥»¥Ã¥È
                   MOVE    SPA-H01GMN-PTNUM    TO  SPA-NAME
                   MOVE    SPA-KYOUTU          TO  LNK-KYOUTU
      *
                   MOVE    "CHANGE"            TO  MCP-PUTTYPE
                   MOVE    "P97"               TO  MCP-WINDOW
                   PERFORM 900-PUT-WINDOW
                   MOVE    1                   TO  FLG-END
                   GO      TO     4101-PTNUM-CHK-EXT
               WHEN    OTHER
                   MOVE    "0004"          TO  SPA-ERRCD
           END-EVALUATE
      *
           IF      SPA-ERRCD           =   SPACE
               INITIALIZE                  SPA-H01GMN-TABLE
                                           SPA-H01GMN-KOUMOKU
               MOVE    SPTID-PTNUM     TO  SPA-H01GMN-PTNUM
               MOVE    SPTID-PTID      TO  SPA-H01NAI-PTID
      *        ´µ¼Ô¥Þ¥¹¥¿¡¼Â¸ºß¥Á¥§¥Ã¥¯
               MOVE    SPA-HOSPNUM     TO  PTINF-HOSPNUM
               MOVE    SPA-H01NAI-PTID TO  PTINF-PTID
               PERFORM 900-PTINF-READ-SEC
               IF      FLG-PTINF   NOT =   ZERO
                   MOVE    "0001"      TO  SPA-ERRCD
               ELSE
      *
      *            ÇÓÂ¾À©¸æ½èÍý
                   PERFORM 990-LOCK-IN-SEC
                   IF      SPA-ERRCD       NOT =   SPACE
                       GO      TO     4101-PTNUM-CHK-EXT
                   ELSE
                       MOVE    PTINF-NAME  TO  SPA-H01GMN-NAME
                   END-IF
               END-IF
           END-IF
      *
      *    ÀÁµá´ÉÍý£Ä£Â¸¡º÷½èÍý
      *
           IF      SPA-ERRCD               =   SPACE
               IF      SPA-SYS-1001-HOSPSBT1   =   ZERO
                   MOVE    SPACE               TO  SPA-H01GMN-SRYKA 
                   PERFORM 41021-SEIKYU-KENSAKU-SEC
               ELSE
                   MOVE    3               TO  SPA-H01GMN-CUR
               END-IF
           ELSE
               INITIALIZE                  SPA-H01GMN-TABLE    
                                           SPA-H01GMN-KOUMOKU
               INITIALIZE                  SPA-H01GMN-NAME
                                           SPA-H01NAI-PTID
           END-IF
           .
       4101-PTNUM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅÇ¯·î¡¡ÆþÎÏ½èÍý
      *****************************************************************
       4102-SRYYM-CHK-SEC          SECTION.
      *
           MOVE    1               TO  SPA-H01GMN-CUR
      *
           MOVE    SPACE           TO  SPA-UPDFLG
                                       SPA-HENFLG
      *
           MOVE    H01-SRYYM       TO  SPA-H01GMN-SRYYM
           MOVE    ZERO            TO  SPA-H01NAI-SRYYM
      *
      *    ÆüÉÕ²èÌÌ¥Á¥§¥Ã¥¯¥µ¥Ö
           INITIALIZE                      ORCSGDAYAREA
           MOVE    "1"                 TO  SGDAY-INTYPE
           MOVE    SPA-H01GMN-SRYYM    TO  SGDAY-INDAY
           CALL    "ORCSGDAY"          USING
                                       ORCSGDAYAREA
           IF      SGDAY-RC            =   ZERO
               MOVE    SGDAY-OTDAY(1:6)    TO  SPA-H01GMN-SRYYM
               MOVE    SGDAY-SDAY (1:6)    TO  SPA-H01NAI-SRYYM
           ELSE
               INITIALIZE                  SPA-H01GMN-TABLE
                                           SPA-H01GMN-KOUMOKU
               MOVE    "0002"          TO  SPA-ERRCD
               GO  TO  4102-SRYYM-CHK-EXT
           END-IF
      *
           IF      SPA-ERRCD               =   SPACE
               MOVE    2                       TO  SPA-H01GMN-CUR
           END-IF
           .
       4102-SRYYM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÀÁµá´ÉÍý£Ä£Â¸¡º÷½èÍý
      *****************************************************************
       41021-SEIKYU-KENSAKU-SEC        SECTION.
      *
           INITIALIZE                  SPA-H01GMN-TABLE
                                       SPA-H01GMN-KOUMOKU
      *    ÀÁµá´ÉÍý£Ä£Â¸¡º÷
           INITIALIZE                  RECE10-REC
           MOVE    SPA-HOSPNUM         TO  RECE10-HOSPNUM
           MOVE    SPA-H01NAI-PTID     TO  RECE10-PTID
           IF      SPA-H01GMN-SRYKA    =   SPACE
               MOVE    "%%"                TO  RECE10-RECEKA
           ELSE
               MOVE    SPA-H01GMN-SRYKA    TO  RECE10-RECEKA
           END-IF
           MOVE    SPA-H01NAI-SRYYM       TO  RECE10-SRYYM
           MOVE    RECE10-REC          TO  MCPDATA-REC
           MOVE    "tbl_seikyu"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_seikyu"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 900-SEIKYU-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SEIKYU
           END-IF
      *
           MOVE    ZERO                TO  IDX 
           PERFORM     UNTIL       FLG-SEIKYU     =   1
                       OR          IDX            =   2
               ADD     1                   TO  IDX
               IF      IDX                 =   1 
                   MOVE    MCPDATA-REC     TO  RECE10-REC
               END-IF
      *
               MOVE    "tbl_seikyu"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 900-SEIKYU-READ-SEC
           END-PERFORM
      *   
      *    ¥«¡¼¥½¥ë¥¯¥í¡¼¥¹
           MOVE    "tbl_seikyu"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           EVALUATE    IDX
               WHEN    ZERO
                   MOVE    "0003"         TO  SPA-ERRCD
               WHEN    1
                   PERFORM 41021-SEIKYU-HENSYU-SEC
               WHEN    OTHER
                   PERFORM 41021-H99-HENSYU-SEC
           END-EVALUATE
           .
       41021-SEIKYU-KENSAKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÀÁµá¥Þ¥¹¥¿²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       41021-SEIKYU-HENSYU-SEC         SECTION.
      *
           MOVE    RECE10-KEY         TO  SPA-RECE10-KEY
      *
      *    ¸«½Ð¤·ÊÔ½¸
           PERFORM 3101-MIDASI-HENSYU-SEC
      *
      *    ¼ç²ÊÂÐ±þ¤Î¤È¤­¼ç²Ê¤òÉ½¼¨¤¹¤ë
           IF    ( SPA-SYUKA-KBN      =   "1"  )
      *****AND   ( RECE10-TEISYUTUSAKI 
      *****                           =   "1"  )
           AND   ( RECE10-RECEKA  NOT =   "00" )
               MOVE    RECE10-RECEKA      TO  SPA-H01GMN-SRYKA
           END-IF
      *
           IF      RECE10-NYUGAIKBN   =   "1"
               MOVE    "Æþ  ±¡"       TO  SPA-H01GMN-HNYUGAIKBN
           ELSE    
               MOVE    "Æþ±¡³°"       TO  SPA-H01GMN-HNYUGAIKBN
           END-IF
           EVALUATE    RECE10-TEISYUTUSAKI
               WHEN    "1"
                   MOVE    "»ÙÊ§´ð¶â"      TO  SPA-H01GMN-HTEISYUTUSAKI
               WHEN    "2"
                   MOVE    "¹ñÊÝÏ¢¹ç²ñ"    TO  SPA-H01GMN-HTEISYUTUSAKI
               WHEN    "5"
                   MOVE    "¸ø³²"          TO  SPA-H01GMN-HTEISYUTUSAKI
               WHEN    "6"
                   MOVE    "¹­°èÏ¢¹ç"      TO  SPA-H01GMN-HTEISYUTUSAKI
           END-EVALUATE
      *
           PERFORM 530-RECESYUBETU-HENSYU-SEC
           MOVE    WRK-RECESYUBETU     TO  SPA-H01GMN-HRECESYUBETU
      *
           EVALUATE    RECE10-TEISYUTUSAKI
               WHEN    "1"
               WHEN    "2"
               WHEN    "6"
                   MOVE    RECE10-HKNJANUM     TO  SPA-H01GMN-HHKNJANUM
           END-EVALUATE
      *
           EVALUATE    RECE10-TEISYUTUSAKI
               WHEN    "6"
                   MOVE    RECE10-NUM          TO  SPA-H01GMN-HKIGO
               WHEN    OTHER
                   STRING  RECE10-KIGO     DELIMITED   BY  SPACE
                           "¡¡"            DELIMITED   BY  SIZE
                           RECE10-NUM      DELIMITED   BY  SPACE
                                           INTO    SPA-H01GMN-HKIGO
                   END-STRING
           END-EVALUATE        
      *
           EVALUATE    RECE10-HKNNUM
               WHEN    "002"
               WHEN    "031"  THRU  "034"
                   EVALUATE    RECE10-HOJOKBN-KEY
                       WHEN    "1"
                       WHEN    "A"
                       WHEN    "D"
                       WHEN    "G"
                           MOVE    "¿¦Ì³¾å"    TO  SPA-H01GMN-HHOJOKBN
                       WHEN    "2"
                       WHEN    "B"
                       WHEN    "E"
                       WHEN    "H"
                           MOVE    "²¼Á¥£³·î"  TO  SPA-H01GMN-HHOJOKBN
                       WHEN    "3"
                       WHEN    "C"
                       WHEN    "F"
                       WHEN    "I"
                           MOVE    "ÄÌ¶ÐºÒ³²"  TO  SPA-H01GMN-HHOJOKBN
                   END-EVALUATE
           END-EVALUATE
      *
           MOVE    RECE10-SKYYM        TO  SPA-H01NAI-SKYYM
                                           WRK-SYMD (1:6)
           MOVE    "01"                TO  WRK-SYMD (7:2) 
           PERFORM 5002-HIZUKE-HEN-SEC
           MOVE    WRK-HENYMDG(1:6)    TO  SPA-H01GMN-SKYYM
      *
           MOVE    RECE10-HENREIYM     TO  SPA-H01NAI-HENREIYM
                                           WRK-SYMD (1:6)
           MOVE    "01"                TO  WRK-SYMD (7:2) 
           PERFORM 5002-HIZUKE-HEN-SEC
           MOVE    WRK-HENYMDG(1:6)    TO  SPA-H01GMN-HENREIYM
      *
           MOVE    RECE10-SKYKBN       TO  SPA-H01GMN-SKYKBN
      * 
           PERFORM VARYING IDY FROM   1   BY  1
                   UNTIL   IDY >      3
               IF      SPA-H01GMN-SKYKBN
                                      =   SPA-H01GMN-SKYKBNL (IDY)
                   MOVE    SPA-H01GMN-SKYKBNMEIL (IDY)
                                          TO  SPA-H01GMN-SKYKBNMEI
                   MOVE    3              TO  IDY
               END-IF
           END-PERFORM
      *
           EVALUATE    RECE10-TEISEIKBN
               WHEN    "0"
                   MOVE    SPACE       TO  SPA-H01GMN-TEISEIKBNNM
               WHEN    "1"
                   MOVE    "¼ê½ñ¤­½¤Àµ"
                                       TO  SPA-H01GMN-TEISEIKBNNM
               WHEN    "2"
                   MOVE    "¥ì¥»¥×¥ÈºÆºîÀ®"
                                       TO  SPA-H01GMN-TEISEIKBNNM
           END-EVALUATE   
      *
           EVALUATE    RECE10-NYUGAIKBN
               WHEN    "1"
                   PERFORM VARYING IDX FROM    1   BY  1
                           UNTIL   IDX >       32
                       IF    ( RECE10-TEISYUTUSAKI     =   "5" )
                       AND   ( IDX                     >   31  )
                           CONTINUE
                       ELSE 
                           MOVE    RECE10-KHNTEN (IDX)
                                       TO  SPA-H01GMN-KHNTEN (IDX)
                                           SPA-H01GMN-NKHNTEN(IDX)
                           MOVE    RECE10-KAISU  (IDX)
                                       TO  SPA-H01GMN-KAISU  (IDX)
                                           SPA-H01GMN-NKAISU (IDX)
                           PERFORM VARYING IDY FROM    1   BY  1
                                   UNTIL   IDY >       3
                               MOVE    RECE10-TENSU  (IDX IDY)
                                       TO  SPA-H01GMN-TENSU  (IDY IDX)
                                           SPA-H01GMN-NTENSU (IDY IDX)
                          END-PERFORM
                       END-IF 
                   END-PERFORM       
               WHEN    "2"
                   PERFORM VARYING IDX FROM    1   BY  1
                           UNTIL   IDX >       38
                       IF    ( RECE10-TEISYUTUSAKI     =   "1" OR  "2"
                                                               OR  "6" )
                       AND   ( IDX                     >   35          )
                           CONTINUE
                       ELSE 
                           MOVE    RECE10-KHNTEN (IDX)
                                           TO  SPA-H01GMN-KHNTEN (IDX)
                                               SPA-H01GMN-NKHNTEN(IDX)
                           MOVE    RECE10-KAISU  (IDX)
                                           TO  SPA-H01GMN-KAISU  (IDX)
                                               SPA-H01GMN-NKAISU (IDX)
                           PERFORM VARYING IDY FROM    1   BY  1
                                   UNTIL   IDY >       3
                               MOVE    RECE10-TENSU  (IDX IDY)
                                       TO  SPA-H01GMN-TENSU  (IDY IDX)
                                           SPA-H01GMN-NTENSU (IDY IDX)
                           END-PERFORM
                       END-IF        
                   END-PERFORM
           END-EVALUATE 
      *    
           PERFORM VARYING IDY FROM    1   BY  1
                   UNTIL   IDY >       3
               MOVE    RECE10-TOTALTEN (IDY)
                                   TO  SPA-H01GMN-TOTALTEN (IDY)
                                       SPA-H01GMN-NTOTALTEN(IDY)
               MOVE    RECE10-JNISSU   (IDY)
                                   TO  SPA-H01GMN-JNISSU   (IDY)
                                       SPA-H01GMN-NJNISSU  (IDY)
               IF      RECE10-TEISYUTUSAKI =   "5"
      *            ¾®·×
                   MOVE    RECE10-FTNMONEY (IDY)
                                       TO  SPA-H01GMN-YKZFTN   (IDY)
                                           SPA-H01GMN-NYKZFTN  (IDY)
      *            ¾®·×¡Ê¿©»ö¡Ë
                   MOVE    RECE10-YKZFTN   (IDY)
                                       TO  SPA-H01GMN-FTNMONEY (IDY)
                                           SPA-H01GMN-NFTNMONEY(IDY)
               ELSE
                   MOVE    RECE10-FTNMONEY (IDY)
                                       TO  SPA-H01GMN-FTNMONEY (IDY)
                                           SPA-H01GMN-NFTNMONEY(IDY)
                   MOVE    RECE10-YKZFTN   (IDY)
                                       TO  SPA-H01GMN-YKZFTN   (IDY)
                                           SPA-H01GMN-NYKZFTN  (IDY)
               END-IF
           END-PERFORM
      *
           IF     RECE10-NYUGAIKBN     =   "1"
               IF      RECE10-TEISYUTUSAKI =   "5"
                   CONTINUE
               ELSE
                   PERFORM VARYING IDY FROM    1   BY  1
                           UNTIL   IDY >       3
                       MOVE    RECE10-SHOKUJIRYOYOHI (IDY)
                                   TO  SPA-H01GMN-SHORYOYOHI (IDY)
                                       SPA-H01GMN-NSHORYOYOHI(IDY)
                       MOVE    RECE10-SHOKUJIFTN   (IDY)
                                   TO  SPA-H01GMN-SHOFTN     (IDY)
                                       SPA-H01GMN-NSHOFTN    (IDY)
                       MOVE    RECE10-SHOKUJINISSU   (IDY)
                                   TO  SPA-H01GMN-SHONISSU   (IDY)
                                       SPA-H01GMN-NSHONISSU  (IDY)
                   END-PERFORM
               END-IF
           END-IF
      *
           MOVE    RECE10-AGE      TO  SPA-H01GMN-AGE
           IF      RECE10-TEISYUTUSAKI =   "5"
               CONTINUE
           ELSE
               MOVE    RECE10-KYURATE  TO  SPA-H01GMN-KYURATE
      *
               IF      RECE10-ZAITAKU  =   "1"
                   MOVE    "ºß°åÁíÅù"          TO  SPA-H01GMN-ZAITAKU
               END-IF
           END-IF         
      *
           IF    ( RECE10-RECESYUBETU  =   "6666" )
           OR    ( RECE10-TEISYUTUSAKI =   "5"    )
               CONTINUE
           ELSE
               EVALUATE    RECE10-RECESYUBETU (4:1)
                   WHEN    "1"
                   WHEN    "2"
                       MOVE    "ËÜ¿Í"          TO  SPA-H01GMN-HONKZKKBN
                   WHEN    "3"
                   WHEN    "4"
                       IF      SPA-RECE10-SRYYM    >=  "200804"
                           MOVE    "Ì¤½¢"      TO  SPA-H01GMN-HONKZKKBN
                       ELSE
                           MOVE    "»°ºÐ"      TO  SPA-H01GMN-HONKZKKBN
                       END-IF
                   WHEN    "5"
                   WHEN    "6"
                       MOVE    "²ÈÂ²"          TO  SPA-H01GMN-HONKZKKBN
                   WHEN    "7"
                   WHEN    "8"
                       IF      SPA-RECE10-SRYYM    >=  "200804"
                           MOVE    "¹â°ì"      TO  SPA-H01GMN-HONKZKKBN
                       ELSE 
                           MOVE    "¹â£¹"      TO  SPA-H01GMN-HONKZKKBN
                       END-IF
                   WHEN    "9"
                   WHEN    "0"
                       IF      RECE10-SRYYM    <   WRK-CONS-SRYYM-200610
                           MOVE    "¹â£¸"      TO  SPA-H01GMN-HONKZKKBN
                       ELSE
                           EVALUATE    RECE10-KYURATE
                               WHEN    8
                                   MOVE    "¹â£¸"
                                               TO  SPA-H01GMN-HONKZKKBN
                               WHEN    7
                                   MOVE    "¹â£·"
                                               TO  SPA-H01GMN-HONKZKKBN
                           END-EVALUATE
                       END-IF
               END-EVALUATE
           END-IF             
      * 
           MOVE    "1"                 TO  SPA-HENFLG
      *         
           MOVE    4                   TO  SPA-H01GMN-CUR
           .
       41021-SEIKYU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È¸¡º÷²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       41021-H99-HENSYU-SEC         SECTION.
      *
           INITIALIZE                  SPA-H99GMN-AREA
           MOVE    SPACE               TO  SPA-H99-AREA
      *
           MOVE    SPA-H01GMN-PTNUM    TO  SPA-H99GMN-PTNUM
           MOVE    SPA-H01GMN-NAME     TO  SPA-H99GMN-NAME
           MOVE    SPA-H01GMN-SRYYM    TO  SPA-H99GMN-SRYYM
           MOVE    SPA-H01GMN-SRYKA    TO  SPA-H99GMN-SRYKA
           MOVE    SPA-H01GMN-SRYKANAME
                                       TO  SPA-H99GMN-SRYKANAME
           MOVE    SPA-H01NAI-PTID     TO  SPA-H99NAI-PTID
           MOVE    SPA-H01NAI-SRYYM    TO  SPA-H99NAI-SRYYM
      *
           MOVE    SPA-H01KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-H01FREE         TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGH99"           USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON          TO  SPA-AREA
           MOVE    SPA-FREE            TO  SPA-H01FREE
           MOVE    SPA-WORK            TO  SPA-H01KYOUTU
      *
           MOVE    SPA-H01KYOUTU       TO  SPA-WORK
      *
           MOVE    "SELNUM"             TO  MCP-WIDGET
      *
           MOVE    "H01"                TO  SPA-MOTOPG
           MOVE    "H99"                TO  SPA-SAKIPG
      *
           MOVE    "NEW"                TO  MCP-PUTTYPE
           MOVE    "H99"                TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                    TO  FLG-END              
           .
       41021-H99-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ÊÆþÎÏ½èÍý
      *****************************************************************
       4103-SRYKA-CHK-SEC             SECTION.
      *
           MOVE    3                   TO  SPA-H01GMN-CUR
      *
           MOVE    SPACE           TO  SPA-UPDFLG
                                       SPA-HENFLG
      *
           MOVE    H01-SRYKA-VALUE TO  SPA-H01GMN-SRYKA
      *
           IF      SPA-H01GMN-SRYKA    =   SPACE
               CONTINUE
           ELSE
               INITIALIZE                  SYS-1005-REC
               MOVE    "1005"              TO  SYS-1005-KANRICD
               MOVE    SPA-H01GMN-SRYKA    TO  SYS-1005-KBNCD
               MOVE    SPA-SYSYMD          TO  SYS-1005-STYUKYMD
                                               SYS-1005-EDYUKYMD
grpsys         MOVE    SPA-HOSPNUM         TO  SYS-1005-HOSPNUM
               MOVE    SYS-1005-REC        TO  MCPDATA-REC
               PERFORM 910-SYSKANRI-INV-SEC
               IF      FLG-SYSKANRI        =   ZERO
                   MOVE    MCPDATA-REC         TO  SYS-1005-REC
                   MOVE    SYS-1005-SRYKANAME  TO  SPA-H01GMN-SRYKANAME
               ELSE
                   MOVE    "0001"              TO  SPA-ERRCD
                   MOVE    SPACE               TO  SPA-H01GMN-SRYKANAME
               END-IF
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE 
      *    ÀÁµá´ÉÍý£Ä£Â¸¡º÷½èÍý
               PERFORM 41021-SEIKYU-KENSAKU-SEC
           END-IF
           .
       4103-SRYKA-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÀÁµáÇ¯·î¡¡ÆþÎÏ½èÍý
      *****************************************************************
       4104-SKYYM-CHK-SEC          SECTION.
      *
           MOVE    4               TO  SPA-H01GMN-CUR
      *
           MOVE    H01-SKYYM       TO  SPA-H01GMN-SKYYM
           MOVE    ZERO            TO  SPA-H01NAI-SKYYM
      *
           IF      SPA-H01GMN-SKYYM    =   SPACE
              CONTINUE
           ELSE 
      *    ÆüÉÕ²èÌÌ¥Á¥§¥Ã¥¯¥µ¥Ö
               INITIALIZE                      ORCSGDAYAREA
               MOVE    "1"                 TO  SGDAY-INTYPE
               MOVE    SPA-H01GMN-SKYYM    TO  SGDAY-INDAY
               CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
               IF      SGDAY-RC            =   ZERO
                   MOVE    SGDAY-OTDAY(1:6)
                                           TO  SPA-H01GMN-SKYYM
                   MOVE    SGDAY-SDAY (1:6)
                                           TO  SPA-H01NAI-SKYYM
                   IF      SPA-H01NAI-SKYYM
                                           <   SPA-H01NAI-SRYYM
                       MOVE    "0002"          TO  SPA-ERRCD
                   END-IF
               ELSE
                   MOVE    "0002"          TO  SPA-ERRCD
               END-IF
           END-IF
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD           =   SPACE
               MOVE    5               TO  SPA-H01GMN-CUR
           END-IF
           .
       4104-SRYYM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÖÌáÇ¯·î¡¡ÆþÎÏ½èÍý
      *****************************************************************
       4105-HENREIYM-CHK-SEC          SECTION.
      *
           MOVE    5               TO  SPA-H01GMN-CUR
      *
           MOVE    H01-HENREIYM    TO  SPA-H01GMN-HENREIYM
           MOVE    ZERO            TO  SPA-H01NAI-HENREIYM
      *
           IF      SPA-H01GMN-HENREIYM =   SPACE
               CONTINUE
           ELSE
      *    ÆüÉÕ²èÌÌ¥Á¥§¥Ã¥¯¥µ¥Ö
               INITIALIZE                      ORCSGDAYAREA
               MOVE    "1"                 TO  SGDAY-INTYPE
               MOVE    SPA-H01GMN-HENREIYM TO  SGDAY-INDAY
               CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
               IF      SGDAY-RC            =   ZERO
                   MOVE    SGDAY-OTDAY(1:6)
                                       TO  SPA-H01GMN-HENREIYM
                   MOVE    SGDAY-SDAY (1:6)
                                       TO  SPA-H01NAI-HENREIYM
                   IF      SPA-H01NAI-HENREIYM
                                           <   SPA-H01NAI-SRYYM
                       MOVE    "0002"          TO  SPA-ERRCD
                   END-IF
               ELSE
                   MOVE    "0002"          TO  SPA-ERRCD
               END-IF
           END-IF
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD           =   SPACE
               MOVE    6               TO  SPA-H01GMN-CUR
           END-IF
           .
       4105-HENREIYM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÀÁµá¶èÊ¬ÆþÎÏ½èÍý
      *****************************************************************
       4106-SKYKBN-CHK-SEC             SECTION.
      *
           MOVE    6                   TO  SPA-H01GMN-CUR
      *
           MOVE    H01-SKYKBN          TO  SPA-H01GMN-SKYKBN-G
      *
           MOVE    SPACE               TO  SPA-H01GMN-SKYKBNMEI 
           PERFORM VARYING IDY FROM   1   BY  1
                   UNTIL   IDY >      3
               IF      SPA-H01GMN-SKYKBN
                                      =   SPA-H01GMN-SKYKBNL (IDY)
                   MOVE    SPA-H01GMN-SKYKBNMEIL (IDY)
                                          TO  SPA-H01GMN-SKYKBNMEI
                   MOVE    3              TO  IDY
               END-IF
           END-PERFORM
      *
           IF      SPA-H01GMN-SKYKBNMEI    =   SPACE
              MOVE    "0001"       TO  SPA-ERRCD
           END-IF       
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD           =   SPACE
               MOVE    8               TO  SPA-H01GMN-CUR
           END-IF
           .
       4106-SKYKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´ðËÜÅÀ¿ô¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4108-KHNTEN-CHK-SEC          SECTION.
      *
      *
           MOVE    3                  TO  SPA-H01GMN-CUR
      *
           COMPUTE SPA-H01GMN-CUR        =   SPA-H01GMN-CUR     +
                                          IDX *  5
           MOVE    H01-NKHNTEN (IDX)      TO  SPA-H01GMN-NKHNTEN (IDX)
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD           =   SPACE
               ADD     1                   TO  SPA-H01GMN-CUR
           END-IF 
           .
       4108-KHNTEN-CHK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ²ó¿ô¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4109-KAISU-CHK-SEC          SECTION.
      *
      *
           MOVE    4                  TO  SPA-H01GMN-CUR
      *
           COMPUTE SPA-H01GMN-CUR        =   SPA-H01GMN-CUR     +
                                          IDX *  5
           MOVE    H01-NKAISU (IDX)       TO  SPA-H01GMN-NKAISU (IDX)
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD           =   SPACE
               ADD     1                   TO  SPA-H01GMN-CUR
           END-IF 
           .
       4109-KAISU-CHK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ÅÀ¿ô¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4110-TENSU-CHK-SEC          SECTION.
      *
           MOVE    4                  TO  SPA-H01GMN-CUR
      *
           COMPUTE SPA-H01GMN-CUR        =   SPA-H01GMN-CUR     +
                                          IDY             +
                                          IDX *  5
      *
           COMPUTE SPA-H01GMN-NTOTALTEN (IDY) = 
                                      SPA-H01GMN-NTOTALTEN (IDY)     -
                                      SPA-H01GMN-NTENSU    (IDY IDX)
      *           
           MOVE    H01-NTENSU (IDY IDX)
                                       TO  SPA-H01GMN-NTENSU (IDY IDX)
      *
           COMPUTE SPA-H01GMN-NTOTALTEN (IDY) = 
                                      SPA-H01GMN-NTOTALTEN (IDY)     +
                                      SPA-H01GMN-NTENSU    (IDY IDX)
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD           =   SPACE
               ADD     1                   TO  SPA-H01GMN-CUR
           END-IF 
           .
       4110-TENSU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    °ìÉôÉéÃ´¶â¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4111-FTNMONEY-CHK-SEC          SECTION.
      *
           MOVE    182                TO  SPA-H01GMN-CUR
      *
           COMPUTE SPA-H01GMN-CUR        =   SPA-H01GMN-CUR     +
                                          IDX
      *
           MOVE    H01-NFTNMONEY (IDX) TO  SPA-H01GMN-NFTNMONEY (IDX)
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD           =   SPACE
               ADD     1                   TO  SPA-H01GMN-CUR
           END-IF 
           .
       4111-FTNMONEY-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌôºÞ°ìÉôÉéÃ´¶â¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4112-YKZFTN-CHK-SEC          SECTION.
      *
           MOVE    185                TO  SPA-H01GMN-CUR
      *
           COMPUTE SPA-H01GMN-CUR        =   SPA-H01GMN-CUR     +
                                          IDX
      *
           MOVE    H01-NYKZFTN (IDX)      TO  SPA-H01GMN-NYKZFTN (IDX)
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD           =   SPACE
               ADD     1                   TO  SPA-H01GMN-CUR
           END-IF 
           .
       4112-YKZFTN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ¼ÂÆü¿ô¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4113-JNISSU-CHK-SEC          SECTION.
      *
           MOVE    188                TO  SPA-H01GMN-CUR
      *
           COMPUTE SPA-H01GMN-CUR        =   SPA-H01GMN-CUR     +
                                          IDX
      *
           MOVE    H01-NJNISSU (IDX)      TO  SPA-H01GMN-NJNISSU (IDX)
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD          =   SPACE
               IF      SPA-H01GMN-CUR        =   191
               AND     SPA-RECE10-NYUGAIKBN  =   "2"
                   MOVE    8                  TO  SPA-H01GMN-CUR
               ELSE 
                   ADD     1                  TO  SPA-H01GMN-CUR
               END-IF
           END-IF 
           .
       4113-JNISSU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿©»öÎÅÍÜÈñ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4114-SHORYOYOHI-CHK-SEC          SECTION.
      *
           MOVE    191                TO  SPA-H01GMN-CUR
      *
           COMPUTE SPA-H01GMN-CUR     =   SPA-H01GMN-CUR     +
                                          IDX
      *
           MOVE    H01-NSHORYOYOHI (IDX)
                                      TO  SPA-H01GMN-NSHORYOYOHI (IDX)
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD          =   SPACE
               ADD     1                  TO  SPA-H01GMN-CUR
           END-IF 
           .
       4114-SHORYOYOHI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿©»öÉ¸½àÉéÃ´³Û¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4115-SHOFTN-CHK-SEC          SECTION.
      *
           MOVE    194                TO  SPA-H01GMN-CUR
      *
           COMPUTE SPA-H01GMN-CUR        =   SPA-H01GMN-CUR     +
                                          IDX
      *
           MOVE    H01-NSHOFTN (IDX)      TO  SPA-H01GMN-NSHOFTN (IDX)
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                 TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD           =   SPACE
               ADD     1                   TO  SPA-H01GMN-CUR
           END-IF 
           .
       4115-SHOFTN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ¿©»öÆü¿ô¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4116-SHONISSU-CHK-SEC          SECTION.
      *
      *
           MOVE    197                TO  SPA-H01GMN-CUR
      *
           COMPUTE SPA-H01GMN-CUR     =   SPA-H01GMN-CUR     +
                                          IDX
      *
           MOVE    H01-NSHONISSU (IDX)
                                      TO  SPA-H01GMN-NSHONISSU (IDX)
      *
      *    ¹¹¿·¥Õ¥é¥°¥»¥Ã¥È
           MOVE    "1"                TO  SPA-UPDFLG
      *
           IF      SPA-ERRCD          =   SPACE
               IF      SPA-H01GMN-CUR     =   200
                   MOVE    8                  TO  SPA-H01GMN-CUR
               ELSE 
                   ADD     1                  TO  SPA-H01GMN-CUR
               END-IF
           END-IF 
           .
       4116-SHONISSU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ìá¤ë¡¡½èÍý
      *****************************************************************
       210-BACK                    SECTION.
      *
           IF      SPA-UPDFLG          =   "1"
               MOVE    "0101"          TO  SPA-HIDCD
               GO      TO      210-BACK-EXT
           END-IF
      *
      *    ÇÓÂ¾À©¸æ²ò½ü½èÍý
           PERFORM 990-LOCK-OUT-SEC
      *
           MOVE    "M01"               TO  SPA-SAKIPG
           MOVE    "H01"               TO  SPA-MOTOPG
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    SPACE               TO  SPA-WORK 
           INITIALIZE                      SPA-KYOTUKEY
                                           SPA-KYOTU-SET
           MOVE    SPA-KYOUTU          TO  LNK-KYOUTU
      *
      ***  MOVE    "CHANGE"            TO  MCP-PUTTYPE
           MOVE    SPA-SAKIPG          TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
      *
           .
       210-BACK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¯¥ê¥¢½èÍý
      *****************************************************************
       420-CLEAR-SEC                   SECTION.
      *
           MOVE    2                   TO  SPA-H01GMN-CUR
           INITIALIZE                      SPA-H01GMN-TABLE
                                           SPA-H01GMN-KOUMOKU
                                           SPA-H01GMN-KOUMOKU1
                                           SPA-H01NAI-KOUMOKU
                                           SPA-H01NAI-KOUMOKU1
                                           SPA-RECE10-KEY
      *
           MOVE    SPACE               TO  SPA-HENFLG
                                           SPA-UPDFLG                                     
      *
      *    ÇÓÂ¾À©¸æ²ò½ü½èÍý
           PERFORM 990-LOCK-OUT-SEC
           .
       420-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¹¹¿·Á°½èÍý
      *****************************************************************
       450-KOUSIN-GIDMSG-SEC                SECTION.
      *
           IF      SPA-HENFLG          =   SPACE
               MOVE    "0015"              TO  SPA-ERRCD
               GO  TO  450-KOUSIN-GIDMSG-EXT
           END-IF
      *
           IF      SPA-UPDFLG          =   SPACE
               MOVE    "0010"              TO  SPA-ERRCD
               GO  TO  450-KOUSIN-GIDMSG-EXT
           END-IF
      *
           IF    ( SPA-H01GMN-SKYYM
                                   NOT =   SPACE )
           AND   ( SPA-H01NAI-SKYYM    =   ZERO  )
               MOVE    "0002"              TO  SPA-ERRCD
               MOVE    4                   TO  SPA-H01GMN-CUR  
               GO  TO  450-KOUSIN-GIDMSG-EXT
           END-IF       
      *
           IF    ( SPA-H01GMN-HENREIYM
                                   NOT =   SPACE )
           AND   ( SPA-H01NAI-HENREIYM =   ZERO  )
              MOVE    "0002"               TO  SPA-ERRCD
               MOVE    5                   TO  SPA-H01GMN-CUR  
               GO  TO  450-KOUSIN-GIDMSG-EXT
           END-IF
      *       
           IF    ( SPA-H01NAI-SKYYM    >   ZERO  )
           AND   ( SPA-H01NAI-SRYYM    >   ZERO  )
               IF      SPA-H01NAI-SKYYM    <   SPA-H01NAI-SRYYM
                   MOVE    "0002"              TO  SPA-ERRCD
                   MOVE    4                   TO  SPA-H01GMN-CUR  
                   GO  TO  450-KOUSIN-GIDMSG-EXT
               END-IF
           END-IF 
      *        
           IF      SPA-H01GMN-SKYKBNMEI
                                       =   SPACE
              MOVE    "0001"               TO  SPA-ERRCD
               MOVE    6                   TO  SPA-H01GMN-CUR  
               GO  TO  450-KOUSIN-GIDMSG-EXT
           END-IF       
      *         
      *    ¥¬¥¤¥É¥á¥Ã¥»¡¼¥¸¥»¥Ã¥È
           IF      SPA-ERRCD           =   SPACE
               MOVE    "1001"              TO  SPA-HIDCD
           END-IF    
           .
       450-KOUSIN-GIDMSG-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¹¹¿·½èÍý
      *****************************************************************
       450-KOUSIN-SEC                SECTION.
      *
      *    ¹¹¿·ºÑ
           MOVE    SPACE           TO  SPA-UPDFLG
                                       SPA-HENFLG
      *
           MOVE    SPACE           TO  RECE10-REC   
           INITIALIZE                  RECE10-REC
           MOVE    SPA-RECE10-KEY  TO  RECE10-KEY
      *
           PERFORM 900-SEIKYU-INV-SEC
           IF      FLG-SEIKYU          =   ZERO
               MOVE    MCPDATA-REC         TO  RECE10-REC
           ELSE
               MOVE    "1010"          TO  SPA-ERRCD
               GO  TO  450-KOUSIN-EXT
           END-IF
      *
           MOVE    SPA-H01NAI-SKYYM       TO  RECE10-SKYYM
           MOVE    SPA-H01NAI-HENREIYM    TO  RECE10-HENREIYM
           MOVE    SPA-H01GMN-SKYKBN      TO  RECE10-SKYKBN
           MOVE    "1"                    TO  RECE10-TEISEIKBN
      *
      *    ¸ø³²¤ÏÅÀ¿ôÅù¤Î¹¹¿·¤Ï¤·¤Ê¤¤
           IF      SPA-RECE10-TEISYUTUSAKI =   "5"
               CONTINUE
           ELSE
               PERFORM VARYING IDX FROM    1   BY  1
                       UNTIL   IDX >       3
                   MOVE    SPA-H01GMN-NJNISSU (IDX)  TO
                                           RECE10-JNISSU   (IDX)
                   MOVE    SPA-H01GMN-NTOTALTEN (IDX)    TO 
                                           RECE10-TOTALTEN (IDX)
                   MOVE    SPA-H01GMN-NFTNMONEY(IDX) TO
                                           RECE10-FTNMONEY (IDX)
                   MOVE    SPA-H01GMN-NYKZFTN  (IDX) TO
                                           RECE10-YKZFTN   (IDX)
                   IF      SPA-RECE10-NYUGAIKBN      =   "1"
                       MOVE    SPA-H01GMN-NSHONISSU (IDX)  TO
                                           RECE10-SHOKUJINISSU   (IDX)
                       MOVE    SPA-H01GMN-NSHORYOYOHI (IDX)    TO 
                                           RECE10-SHOKUJIRYOYOHI (IDX)
                       MOVE    SPA-H01GMN-NSHOFTN(IDX) TO
                                           RECE10-SHOKUJIFTN (IDX)
                   END-IF
               END-PERFORM
               EVALUATE    SPA-RECE10-NYUGAIKBN
                   WHEN    "1"
                       PERFORM VARYING IDX FROM    1   BY  1
                               UNTIL   IDX >       32
                           MOVE    SPA-H01GMN-NKHNTEN  (IDX)  TO
                                               RECE10-KHNTEN (IDX)
                           MOVE    SPA-H01GMN-NKAISU   (IDX)  TO
                                               RECE10-KAISU  (IDX)
                           PERFORM VARYING IDY FROM    1   BY  1
                                   UNTIL   IDY >       3
                               MOVE    SPA-H01GMN-NTENSU (IDY IDX)  TO
                                               RECE10-TENSU (IDX IDY)
                           END-PERFORM 
                       END-PERFORM
                   WHEN    "2"
                       PERFORM VARYING IDX FROM    1   BY  1
                               UNTIL   IDX >       38
                           MOVE    SPA-H01GMN-NKHNTEN  (IDX)  TO
                                               RECE10-KHNTEN (IDX)
                           MOVE    SPA-H01GMN-NKAISU   (IDX)  TO
                                               RECE10-KAISU  (IDX)
                           PERFORM VARYING IDY FROM    1   BY  1
                                   UNTIL   IDY >       3
                               MOVE    SPA-H01GMN-NTENSU (IDY IDX)  TO
                                               RECE10-TENSU (IDX IDY)
                           END-PERFORM 
                       END-PERFORM
               END-EVALUATE
           END-IF     
      *     
           MOVE    SPA-SYSYMD          TO  RECE10-UPDYMD
      *
           MOVE    RECE10-REC          TO  MCPDATA-REC
           MOVE    "DBUPDATE"          TO  MCP-FUNC
           MOVE    "tbl_seikyu"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
      *    ¸øÈñÀÁµá½ñ¤¬¤¢¤ì¤Ð¹¹¿·¤¹¤ë
           IF      MCP-RC              =   ZERO
               MOVE    SPACE           TO  KOHSKY-REC   
               INITIALIZE                  KOHSKY-REC
               MOVE    SPA-RECE10-KEY      TO  KOHSKY-KEY
      *
               PERFORM 900-KOHSKY-INV-SEC
               IF      FLG-KOHSKY          =   ZERO
                   MOVE    MCPDATA-REC         TO  KOHSKY-REC
                   MOVE    SPA-H01NAI-SKYYM    TO  KOHSKY-SKYYM
                   MOVE    SPA-H01NAI-HENREIYM TO  KOHSKY-HENREIYM
                   MOVE    SPA-H01GMN-SKYKBN   TO  KOHSKY-SKYKBN
                   MOVE    "1"                 TO  KOHSKY-TEISEIKBN
                   MOVE    SPA-SYSYMD          TO  KOHSKY-UPDYMD
      *
                   MOVE    KOHSKY-REC          TO  MCPDATA-REC
                   MOVE    "DBUPDATE"          TO  MCP-FUNC
                   MOVE    "tbl_kohsky"        TO  MCP-TABLE
                   MOVE    "key"               TO  MCP-PATHNAME
grpsys             PERFORM 900-ORCDBMAIN-SEC
      *
                   IF      MCP-RC     NOT =   ZERO
                       MOVE    "1002"          TO  SPA-ERRCD
                       GO  TO  450-KOUSIN-EXT
                   END-IF
               END-IF
           ELSE    
               MOVE    "1001"          TO  SPA-ERRCD
               GO  TO  450-KOUSIN-EXT
           END-IF
      *
           MOVE    2               TO  SPA-H01GMN-CUR
           INITIALIZE                  SPA-H01GMN-TABLE
                                       SPA-H01GMN-KOUMOKU
                                       SPA-H01GMN-KOUMOKU1
                                       SPA-H01NAI-KOUMOKU
                                       SPA-H01NAI-KOUMOKU1
                                       SPA-RECE10-KEY
      *
      *    ÇÓÂ¾À©¸æ²ò½ü½èÍý
           PERFORM 990-LOCK-OUT-SEC
           .
       450-KOUSIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    »áÌ¾¸¡º÷¤Ø
      *****************************************************************
       480-KENSAKU-SEC             SECTION.
      *
           IF      SPA-H01NAI-SRYYM    =   ZERO
               MOVE    "0005"              TO  SPA-ERRCD
               GO  TO  480-KENSAKU-EXT
           END-IF
      *         
           MOVE    SPACE               TO  LINKAREA
           MOVE    SPA-KYOUTU          TO  LNK-COMMON
           MOVE    SPA-H01-AREA        TO  LNK-SCRSPA
      *
      *    ²èÌÌ°Ü¹ÔÍÑ¤Î¥Ñ¥é¥á¥¿ÊÑ¹¹
           MOVE    "H01"               TO  SPA-MOTOPG
           MOVE    "P97"               TO  SPA-SAKIPG
      *
      *    »áÌ¾¤ò¥¯¥ê¥¢¤¹¤ë
           MOVE    SPACE               TO  SPA-NAME
           MOVE    SPA-KYOUTU          TO  LNK-KYOUTU
      *
           MOVE    "CHANGE"            TO  MCP-PUTTYPE
           MOVE    "P97"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
           .
       480-KENSAKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼«²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-SET-SCREEN              SECTION.
      *
           PERFORM 500-GMNHEN-SEC
      *
           IF      SPA-ERRCD       NOT =   SPACE
               PERFORM 510-ERRSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           IF      SPA-HIDCD       NOT =   SPACE
               PERFORM 520-RIDSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    "CURRENT"           TO  MCP-PUTTYPE.
           MOVE    "H01    "           TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
           .
       500-SET-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-GMNHEN-SEC              SECTION.
      *
           INITIALIZE              H01
      *
           MOVE    SPA-H01GMN-PTNUM       TO  H01-PTNUM
           MOVE    SPA-H01GMN-NAME        TO  H01-NAME-VALUE
           MOVE    SPA-H01GMN-SRYYM       TO  H01-SRYYM
           MOVE    SPA-H01GMN-SRYKA       TO  H01-SRYKA-VALUE
           MOVE    SPA-H01GMN-SRYKANAME   TO  H01-SRYKANAME-VALUE
           MOVE    SPA-H01GMN-SKYYM       TO  H01-SKYYM
           MOVE    SPA-H01GMN-HENREIYM    TO  H01-HENREIYM
           MOVE    SPA-H01GMN-SKYKBN-G    TO  H01-SKYKBN
           PERFORM VARYING IDX FROM    1       BY  1
                   UNTIL       IDX             >   3
                   OR          SPA-H01GMN-SKYKBNL  (IDX)   =   SPACE 
               MOVE    SPA-H01GMN-SKYKBNLST (IDX)
                                          TO  H01-SKYKBNLST (IDX)
               MOVE    IDX                TO  H01-SKYKBN-COUNT
           END-PERFORM
           MOVE    SPA-H01GMN-TEISEIKBNNM TO  H01-TEISEIKBNNM-VALUE
           MOVE    SPA-H01GMN-HNYUGAIKBN  TO  H01-HNYUGAIKBN-VALUE
           MOVE    SPA-H01GMN-HTEISYUTUSAKI 
                                          TO  H01-HTEISYUTUSAKI-VALUE
           MOVE    SPA-H01GMN-HRECESYUBETU
                                          TO  H01-HRECESYUBETU-VALUE
           MOVE    SPA-H01GMN-HHKNJANUM   TO  H01-HHKNJANUM-VALUE
           MOVE    SPA-H01GMN-HHOJOKBN    TO  H01-HHOJOKBN-VALUE
           MOVE    SPA-H01GMN-HKIGO       TO  H01-HKIGO-VALUE   
      *
           PERFORM VARYING IDX FROM    1       BY  1
                   UNTIL   IDX     >   38
      *****        OR          SPA-H01GMN-MIDASI (IDX)    =   SPACE
               MOVE    SPA-H01GMN-MIDASI (IDX)    TO  H01-MIDASI (IDX)
               MOVE    SPA-H01GMN-KHNTEN (IDX)    TO  H01-KHNTEN (IDX)
               MOVE    SPA-H01GMN-KAISU  (IDX)    TO  H01-KAISU  (IDX)
               PERFORM VARYING IDY FROM    1       BY  1
                       UNTIL   IDY     >   3
                   MOVE    SPA-H01GMN-TENSU (IDY IDX)
                                           TO  H01-TENSU (IDY IDX)
               END-PERFORM
      *
               MOVE    SPA-H01GMN-NKHNTEN (IDX)
                                           TO  H01-NKHNTEN (IDX)
               MOVE    SPA-H01GMN-NKAISU  (IDX)
                                           TO  H01-NKAISU  (IDX)
               PERFORM VARYING IDY FROM    1       BY  1
                       UNTIL   IDY     >   3
                   MOVE    SPA-H01GMN-NTENSU (IDY IDX)
                                           TO  H01-NTENSU (IDY IDX)
               END-PERFORM
           END-PERFORM
      *
           PERFORM VARYING IDX FROM    1       BY  1
                   UNTIL   IDX     >   3
               MOVE    SPA-H01GMN-TOTALTEN (IDX)
                                               TO  H01-TOTALTEN (IDX)
               MOVE    SPA-H01GMN-FTNMONEY (IDX)
                                               TO  H01-FTNMONEY (IDX)
               MOVE    SPA-H01GMN-YKZFTN   (IDX)
                                               TO  H01-YKZFTN   (IDX)
               MOVE    SPA-H01GMN-JNISSU   (IDX)
                                               TO  H01-JNISSU   (IDX)
               MOVE    SPA-H01GMN-SHORYOYOHI (IDX)
                                               TO  H01-SHORYOYOHI (IDX)
               MOVE    SPA-H01GMN-SHOFTN   (IDX)
                                               TO  H01-SHOFTN   (IDX)
               MOVE    SPA-H01GMN-SHONISSU (IDX)
                                               TO  H01-SHONISSU (IDX)
      *
               MOVE    SPA-H01GMN-NTOTALTEN(IDX)
                                               TO  H01-NTOTALTEN(IDX)
               MOVE    SPA-H01GMN-NFTNMONEY(IDX)
                                               TO  H01-NFTNMONEY(IDX)
               MOVE    SPA-H01GMN-NYKZFTN  (IDX)
                                               TO  H01-NYKZFTN  (IDX)
               MOVE    SPA-H01GMN-NJNISSU  (IDX)
                                               TO  H01-NJNISSU  (IDX)
               MOVE    SPA-H01GMN-NSHORYOYOHI (IDX)
                                               TO  H01-NSHORYOYOHI (IDX)
               MOVE    SPA-H01GMN-NSHOFTN   (IDX)
                                               TO  H01-NSHOFTN   (IDX)
               MOVE    SPA-H01GMN-NSHONISSU (IDX)
                                               TO  H01-NSHONISSU (IDX)
           END-PERFORM
      *
           MOVE    SPA-H01GMN-SHOMIDASI (1)    TO  H01-SHOMIDASI (1)
                                                   H01-SHOMIDASI (4) 
           MOVE    SPA-H01GMN-SHOMIDASI (2)    TO  H01-SHOMIDASI (2)
                                                   H01-SHOMIDASI (5) 
           MOVE    SPA-H01GMN-SHOMIDASI (3)    TO  H01-SHOMIDASI (3)
                                                   H01-SHOMIDASI (6) 
      *
           MOVE    SPA-H01GMN-TENMIDASI (1)    TO  H01-TENMIDASI (1)
                                                   H01-TENMIDASI (5) 
           MOVE    SPA-H01GMN-TENMIDASI (2)    TO  H01-TENMIDASI (2)
                                                   H01-TENMIDASI (6) 
           MOVE    SPA-H01GMN-TENMIDASI (3)    TO  H01-TENMIDASI (3)
                                                   H01-TENMIDASI (7) 
           MOVE    SPA-H01GMN-TENMIDASI (4)    TO  H01-TENMIDASI (4)
                                                   H01-TENMIDASI (8) 
      *    ¿§¤ÎÀßÄê
           PERFORM VARYING IDX FROM    1       BY  1
                   UNTIL   IDX     >   38
               MOVE    SPA-H01GMN-MIDASI-STYLE (IDX)
                                       TO  H01-MIDASI-STYLE (IDX)
           END-PERFORM
           MOVE    "blue"              TO  H01-NAME-STYLE
                                           H01-SRYKANAME-STYLE
                                           H01-TEISEIKBNNM-STYLE
           MOVE    "blue"              TO  H01-HNYUGAIKBN-STYLE
                                           H01-HTEISYUTUSAKI-STYLE
                                           H01-HRECESYUBETU-STYLE
                                           H01-HHKNJANUM-STYLE
                                           H01-HKIGO-STYLE
                                           H01-HHOJOKBN-STYLE
      *
      *    ÆþÎÏ¤ÎÀßÄê
           IF      SPA-SYS-1001-HOSPSBT1   =   "0"
               MOVE    WIDGET-INSENSITIVE  TO  H01-SRYKA-STATE
           ELSE
               MOVE    WIDGET-NORMAL       TO  H01-SRYKA-STATE
           END-IF
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX     >   38
               MOVE    WIDGET-INSENSITIVE  TO  H01-KHNTEN-STATE (IDX)
                                               H01-KAISU-STATE  (IDX)
               PERFORM VARYING IDY FROM    1       BY  1
                       UNTIL   IDY     >   3
                   MOVE    WIDGET-INSENSITIVE
                                   TO  H01-TENSU-STATE (IDY IDX)
               END-PERFORM
           END-PERFORM
           PERFORM VARYING IDX FROM    1       BY  1
                   UNTIL   IDX     >   3
               MOVE    WIDGET-INSENSITIVE
                                   TO  H01-TOTALTEN-STATE  (IDX)
                                       H01-FTNMONEY-STATE  (IDX)
                                       H01-YKZFTN-STATE    (IDX)
                                       H01-JNISSU-STATE    (IDX)
                                       H01-NTOTALTEN-STATE (IDX)
                                       H01-SHORYOYOHI-STATE(IDX)
                                       H01-SHOFTN-STATE    (IDX)
                                       H01-SHONISSU-STATE  (IDX)
               MOVE    SPA-H01GMN-SHO-STATE
                                   TO  H01-NSHORYOYOHI-STATE(IDX)
                                       H01-NSHOFTN-STATE    (IDX)
                                       H01-NSHONISSU-STATE  (IDX)
           END-PERFORM
      *
           MOVE    SPA-H01GMN-AGE     TO  H01-AGE
           MOVE    SPA-H01GMN-KYURATE TO  H01-KYURATE     
           MOVE    SPA-H01GMN-ZAITAKU TO  H01-ZAITAKU 
           MOVE    SPA-H01GMN-HONKZKKBN
                                      TO  H01-HONKZKKBN
      *
           PERFORM 5001-MAPCUR-SEC
      *
           .
       500-GMNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ¥«¡¼¥½¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       5001-MAPCUR-SEC             SECTION.
      *
         EVALUATE    SPA-H01GMN-CUR
             WHEN    2
                    MOVE  "PTNUM"        TO  MCP-WIDGET
             WHEN    1
                    MOVE  "SRYYM"        TO  MCP-WIDGET
             WHEN    3
                    MOVE  "SRYKA"        TO  MCP-WIDGET
             WHEN    4
                    MOVE  "SKYYM"        TO  MCP-WIDGET
             WHEN    5
                    MOVE  "HENREIYM"     TO  MCP-WIDGET
             WHEN    6
                    MOVE  "SKYKBN"       TO  MCP-WIDGET
             WHEN    8   THRU    182
                 COMPUTE IDX     =   SPA-H01GMN-CUR     -   3   
                 DIVIDE   IDX          BY  5
                                       GIVING       WRK-SYO
                                       REMAINDER    WRK-AMARI
                 MOVE    WRK-SYO          TO  WRK-WIDGET 
                 EVALUATE    WRK-AMARI
                     WHEN    0
                         MOVE  "NKHNTEN"  TO  MCP-WIDGET
                         MOVE  WRK-WIDGET-X TO  MCP-WIDGET (8:2)
                     WHEN    1
                         MOVE  "NKAISU"   TO  MCP-WIDGET
                         MOVE  WRK-WIDGET-X TO  MCP-WIDGET (7:2)
                     WHEN    2
                         MOVE  "NTENSU"   TO  MCP-WIDGET
                         MOVE  WRK-WIDGET-X TO  MCP-WIDGET (7:2)
                     WHEN    3
                         MOVE  "NKOHTENSU1"  TO  MCP-WIDGET
                         MOVE  WRK-WIDGET-X TO  MCP-WIDGET (11:2)
                     WHEN    4
                         MOVE  "NKOHTENSU2"  TO  MCP-WIDGET
                         MOVE  WRK-WIDGET-X TO  MCP-WIDGET (11:2)
                 END-EVALUATE                    
             WHEN    183
                    MOVE  "NFTNMONEY1"   TO  MCP-WIDGET
             WHEN    184
                    MOVE  "NFTNMONEY2"   TO  MCP-WIDGET
             WHEN    185
                    MOVE  "NFTNMONEY3"   TO  MCP-WIDGET
             WHEN    186
                    MOVE  "NYKZFTN1"     TO  MCP-WIDGET
             WHEN    187
                    MOVE  "NYKZFTN2"     TO  MCP-WIDGET
             WHEN    188
                    MOVE  "NYKZFTN3"     TO  MCP-WIDGET
             WHEN    189
                    MOVE  "NJNISSU1"     TO  MCP-WIDGET
             WHEN    190
                    MOVE  "NJNISSU2"     TO  MCP-WIDGET
             WHEN    191
                    MOVE  "NJNISSU3"     TO  MCP-WIDGET
             WHEN    192
                    MOVE  "NSHORYOYOHI1"   TO  MCP-WIDGET
             WHEN    193
                    MOVE  "NSHORYOYOHI2"   TO  MCP-WIDGET
             WHEN    194
                    MOVE  "NSHORYOYOHI3"   TO  MCP-WIDGET
             WHEN    195
                    MOVE  "NSHOFTN1"     TO  MCP-WIDGET
             WHEN    196
                    MOVE  "NSHOFTN2"     TO  MCP-WIDGET
             WHEN    197
                    MOVE  "NSHOFTN3"     TO  MCP-WIDGET
             WHEN    198
                    MOVE  "NSHONISSU1"     TO  MCP-WIDGET
             WHEN    199
                    MOVE  "NSHONISSU2"     TO  MCP-WIDGET
             WHEN    200
                    MOVE  "NSHONISSU3"     TO  MCP-WIDGET
             WHEN    300
                    MOVE  "B12"        TO  MCP-WIDGET   
         END-EVALUATE
      *
           .
       5001-MAPCUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸É½¼¨Íý
      *****************************************************************
       510-ERRSET-SEC              SECTION.
           MOVE    SPACE               TO  SPA-ERRMSG
      *
           EVALUATE    SPA-ERRCD
               WHEN    "0001"
                   MOVE    "ÆþÎÏ¥¨¥é¡¼¤Ç¤¹"  TO  SPA-ERRMSG
               WHEN    "0002"
                   MOVE    "Ç¯·î¤ÎÆþÎÏ¥¨¥é¡¼¤Ç¤¹"
                                             TO  SPA-ERRMSG
               WHEN    "0003"
                   MOVE    "ÂÐ¾Ý¤Î¥ì¥»¥×¥È¤ÏÂ¸ºß¤·¤Þ¤»¤ó"
                                             TO  SPA-ERRMSG
               WHEN    "0004"
                   MOVE    "³ºÅö¤Î´µ¼Ô¤¬Â¸ºß¤·¤Þ¤»¤ó"
                                               TO  SPA-ERRMSG
               WHEN    "0005"
                   MOVE    "¿ÇÎÅÇ¯·î¤¬Ì¤ÆþÎÏ¤Ç¤¹" 
                                               TO  SPA-ERRMSG
               WHEN    "0010"
                   MOVE    "½¤Àµ¹àÌÜ¤¬¤¢¤ê¤Þ¤»¤ó" 
                                               TO  SPA-ERRMSG
               WHEN    "0015"
                   MOVE    "¹¹¿·ÂÐ¾Ý¤Î¥Ç¡¼¥¿¤òÆþÎÏ¤·¤Æ²¼¤µ¤¤" 
                                               TO  SPA-ERRMSG
               WHEN    "1001"
                   MOVE    "¹¹¿·¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿"
                                             TO  SPA-ERRMSG
               WHEN    "1010"
                   MOVE
                       "ÂÐ¾Ý¤ÎÀÁµá¥Ç¡¼¥¿¤¬Â¸ºß¤·¤Ê¤¤¤Î¤Ç¹¹¿·¤Ç¤­¤Þ¤»¤ó"
                                             TO  SPA-ERRMSG
      *
               WHEN    "9999"
                   MOVE    "Â¾Ã¼Ëö¤Ç»ÈÍÑÃæ¤Ç¤¹¡£"
                                               TO  SPA-ERRMSG
                   MOVE    SLOCK-MSG           TO  SPA-ERRMSG(21:)
           END-EVALUATE
      *
           MOVE    SPACE                TO  HERR
           MOVE    SPA-ERRCD            TO  HERR-ERRCODE
           MOVE    SPA-ERRMSG           TO  HERR-ERRMSG
           MOVE    "B01"                TO  MCP-WIDGET
      *
           MOVE    "H01"                TO  SPA-MOTOPG
           MOVE    "HERR"               TO  SPA-SAKIPG
      *
           MOVE    "NEW"                TO  MCP-PUTTYPE
           MOVE    "HERR"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                    TO  FLG-END              
      *
           .
       510-ERRMSG-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³ÎÇ§¥á¥Ã¥»¡¼¥¸É½¼¨½èÍý
      *****************************************************************
       520-RIDSET-SEC              SECTION.
      *
           MOVE    SPACE               TO  WRK-HIDMSG
      *
           EVALUATE    SPA-HIDCD
               WHEN    "1001"
                   MOVE    "¹¹¿·½èÍý¤ò¤·¤Þ¤¹"
                                        TO  WRK-HIDMSG
               WHEN    "0101"
                   MOVE    "ÆþÎÏ¤ÎÅÓÃæ¤Ç¤¹¡£½ªÎ»¤·¤Æ¤è¤í¤·¤¤¤Ç¤¹¤«¡£"
                                        TO  WRK-HIDMSG
           END-EVALUATE
      *
           MOVE    SPACE                TO  HID1
           MOVE    SPA-HIDCD            TO  HID1-ID1CODE
           MOVE    WRK-HIDMSG           TO  HID1-ID1MSG
           MOVE    "B12"                TO  MCP-WIDGET
      *
           MOVE    "H01"                TO  SPA-MOTOPG
           MOVE    "HID1"               TO  SPA-SAKIPG
      *
           MOVE    "NEW"                TO  MCP-PUTTYPE
           MOVE    "HID1"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                    TO  FLG-END              
      *
           .
       520-RIDSET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÏÂÎñÀ¾ÎñÊÑ´¹ÊÔ½¸½èÍý
      *****************************************************************
       5002-HIZUKE-HEN-SEC          SECTION.
      *
           IF      WRK-SYMD (1:6)          =   ZERO    OR  SPACE
               MOVE    SPACE                   TO  WRK-HENYMDG
           ELSE
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY2-AREA
               MOVE    "21"                TO  LNK-DAY2-IRAI
               MOVE    WRK-SYMD            TO  LNK-DAY2-YMD
               CALL    "ORCSDAY"            USING   STS-AREA-DAY
                                                   LNK-DAY2-AREA
               MOVE    LNK-DAY2-EDTYMD1    TO  WRK-HENYMDG
           END-IF
      *
           .
       5002-HIZUKE-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È¼ïÊÌÊÔ½¸½èÍý
      *****************************************************************
       530-RECESYUBETU-HENSYU-SEC          SECTION.
      *
           MOVE   SPACE                TO  WRK-RECESYUBETU
      *
           IF      RECE10-TEISYUTUSAKI =   "5"
      ***      MOVE    "¸ø³²"              TO  WRK-RECESYUBETU
               GO  TO  530-RECESYUBETU-HENSYU-EXT
           END-IF        
      *
           IF      RECE10-RECESYUBETU  =   "6666"
               MOVE    "ÆÃÊÌÎÅÍÜÈñ"        TO  WRK-RECESYUBETU
               GO  TO  530-RECESYUBETU-HENSYU-EXT
           END-IF        
      *
           IF      RECE10-SRYYM        >   "200209"
               MOVE    RECE10-RECESYUBETU  TO  WRK-RECESYUBETU
               GO  TO  530-RECESYUBETU-HENSYU-EXT
           END-IF        
      *         
           EVALUATE  RECE10-RECESYUBETU
                                 ALSO  RECE10-TEISYUTUSAKI
           WHEN    1111      ALSO      2
               IF  RECE10-HONKZKKBN    =   2
                   MOVE    "¡ú¡ú¡ú"    TO  WRK-RECESYUBETU
               ELSE
                   MOVE    "¡ú"        TO  WRK-RECESYUBETU
               END-IF
           WHEN    1111      ALSO      1
           WHEN    1111      ALSO      ANY
               MOVE    "¡ú"            TO  WRK-RECESYUBETU
      *
           WHEN    1112      ALSO      2
               IF  RECE10-HONKZKKBN    =   2
                   MOVE    "¡ù¡ù¡ù¡ù"  TO  WRK-RECESYUBETU
               ELSE
                   MOVE    "¡ù¡ù"      TO  WRK-RECESYUBETU
               END-IF
           WHEN    1112      ALSO      1
               MOVE    "¡ù¡ù"          TO  WRK-RECESYUBETU
      *
           WHEN    1115      ALSO      ANY
               MOVE    "¡ú¡ú¡ú"        TO  WRK-RECESYUBETU
      *
           WHEN    1116      ALSO      ANY
               MOVE    "¡ù¡ù¡ù¡ù"      TO  WRK-RECESYUBETU
      ****     MOVE    "¡ú¡ú¡ú¡ú"      TO  WRK-RECESYUBETU
      *
           WHEN    1121      ALSO      2
               IF  RECE10-HONKZKKBN    =   2
                   MOVE    "¡ú¡ú¡ú"    TO  WRK-RECESYUBETU
               ELSE
                   MOVE    "¡ú"        TO  WRK-RECESYUBETU
               END-IF
           WHEN    1121      ALSO      1
               MOVE    "¡ú"            TO  WRK-RECESYUBETU
      *
           WHEN    1122      ALSO      2
               IF  RECE10-HONKZKKBN    =   2
                   MOVE    "¡ù¡ù¡ù¡ù"  TO  WRK-RECESYUBETU
               ELSE
                   MOVE    "¡ù¡ù"      TO  WRK-RECESYUBETU
               END-IF
           WHEN    1122      ALSO      1
               MOVE    "¡ù¡ù"          TO  WRK-RECESYUBETU
      *
           WHEN    1125      ALSO      ANY
               MOVE    "¡ú¡ú¡ú"        TO  WRK-RECESYUBETU
      *
           WHEN    1126      ALSO      ANY
               MOVE    "¡ù¡ù¡ù¡ù"      TO  WRK-RECESYUBETU
      *
           WHEN    1131      ALSO      2
               IF  RECE10-HONKZKKBN    =   2
                   MOVE    "¡ú¡ú¡ú"    TO  WRK-RECESYUBETU
               ELSE
                   MOVE    "¡ú"        TO  WRK-RECESYUBETU
               END-IF
           WHEN    1131      ALSO      1
               MOVE    "¡ú"            TO  WRK-RECESYUBETU
      *
           WHEN    1132      ALSO      2
               IF  RECE10-HONKZKKBN    =   2
                   MOVE    "¡ù¡ù¡ù¡ù"  TO  WRK-RECESYUBETU
               ELSE
                   MOVE    "¡ù¡ù"      TO  WRK-RECESYUBETU
               END-IF
           WHEN    1132      ALSO      1
               MOVE    "¡ù¡ù"          TO  WRK-RECESYUBETU
      *
           WHEN    1135      ALSO      ANY
               MOVE    "¡ú¡ú¡ú"        TO  WRK-RECESYUBETU
      *
           WHEN    1136      ALSO      ANY
               MOVE    "¡ù¡ù¡ù¡ù"      TO  WRK-RECESYUBETU
      *
           WHEN    1211      ALSO      ANY
           WHEN    1221      ALSO      ANY
           WHEN    1231      ALSO      ANY
               MOVE    "¡ü"            TO  WRK-RECESYUBETU
      *
           WHEN    1212      ALSO      ANY
           WHEN    1222      ALSO      ANY
           WHEN    1232      ALSO      ANY
               MOVE    "¡û¡û"          TO  WRK-RECESYUBETU
      *
           WHEN    1311      ALSO      ANY
           WHEN    1321      ALSO      ANY
           WHEN    1331      ALSO      ANY
               MOVE    "¢¥"            TO  WRK-RECESYUBETU
      *
           WHEN    1312      ALSO      ANY
           WHEN    1322      ALSO      ANY
           WHEN    1332      ALSO      ANY
               MOVE    "¢¤¢¤"          TO  WRK-RECESYUBETU
      *
           WHEN    1411      ALSO      ANY
           WHEN    1421      ALSO      ANY
           WHEN    1431      ALSO      ANY
               MOVE    "¢¡"            TO  WRK-RECESYUBETU
      *
           WHEN    1412      ALSO      ANY
           WHEN    1422      ALSO      ANY
           WHEN    1432      ALSO      ANY
               MOVE    "¡þ¡þ"          TO  WRK-RECESYUBETU
      *
           WHEN    1415      ALSO      ANY
           WHEN    1425      ALSO      ANY
           WHEN    1435      ALSO      ANY
               MOVE    "¢¡¢¡¢¡"        TO  WRK-RECESYUBETU
      *
           WHEN    1416      ALSO      ANY
           WHEN    1426      ALSO      ANY
           WHEN    1436      ALSO      ANY
               MOVE    "¡þ¡þ¡þ¡þ"      TO  WRK-RECESYUBETU
           END-EVALUATE
      *
           .
       530-RECESYUBETU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¹þ
      *****************************************************************
       910-SYSKANRI-INV-SEC         SECTION.
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-SYSKANRI
               ELSE
                   MOVE    1                   TO  FLG-SYSKANRI
               END-IF
           ELSE
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       910-SYSKANRI-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼Ô¥Þ¥¹¥¿¡¼ÆÉ¹þ¡Ê¼ç¥­¡¼¡Ë
      *****************************************************************
       900-PTINF-READ-SEC         SECTION.
      *
           MOVE    PTINF-REC           TO  MCPDATA-REC
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptinf"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  PTINF-REC
                   MOVE    ZERO                TO  FLG-PTINF
               ELSE
                   MOVE    1                   TO  FLG-PTINF
                   INITIALIZE                      PTINF-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTINF
               INITIALIZE                      PTINF-REC
           END-IF
      *
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-PTINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÀÁµá¥Þ¥¹¥¿¡¼ÆÉ¹þ¡Ê¼ç¥­¡¼¡Ë
      *****************************************************************
       900-SEIKYU-INV-SEC         SECTION.
      *
           MOVE    RECE10-REC          TO  MCPDATA-REC
           MOVE    "tbl_seikyu"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_seikyu"        TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-SEIKYU-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SEIKYU
           END-IF
      *
           MOVE    "tbl_seikyu"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-SEIKYU-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÀÁµá¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       900-SEIKYU-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SEIKYU
           ELSE
               MOVE    1               TO  FLG-SEIKYU
           END-IF
      *
           .
       900-SEIKYU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñÀÁµá¥Þ¥¹¥¿¡¼ÆÉ¹þ¡Ê¼ç¥­¡¼¡Ë
      *****************************************************************
       900-KOHSKY-INV-SEC         SECTION.
      *
           MOVE    KOHSKY-REC          TO  MCPDATA-REC
           MOVE    "tbl_kohsky"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_kohsky"        TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-KOHSKY-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-KOHSKY
           END-IF
      *
           MOVE    "tbl_kohsky"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-KOHSKY-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñÀÁµá¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       900-KOHSKY-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-KOHSKY
           ELSE
               MOVE    1               TO  FLG-KOHSKY
           END-IF
      *
           .
       900-KOHSKY-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÇÓÂ¾À©¸æ½èÍý
      *****************************************************************
       990-LOCK-IN-SEC         SECTION.
      *
      *    ÇÓÂ¾À©¸æ½èÍý
           MOVE    1                   TO  SLOCK-MODE
           MOVE    SPA-H01NAI-PTID     TO  SLOCK-PTID
           CALL    "ORCSLOCK"          USING
                                       MCPAREA
                                       SPA-AREA
                                       ORCSLOCKAREA
           IF      SLOCK-RETURN    NOT =   ZERO
               MOVE    "9999"              TO  SPA-ERRCD
           END-IF
           .
       990-LOCK-IN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÇÓÂ¾À©¸æ²ò½ü½èÍý
      *****************************************************************
       990-LOCK-OUT-SEC         SECTION.
      *
      *    ÇÓÂ¾À©¸æ²ò½ü½èÍý
           MOVE    2                   TO  SLOCK-MODE
           CALL    "ORCSLOCK"          USING
                                       MCPAREA
                                       SPA-AREA
                                       ORCSLOCKAREA
           .
       990-LOCK-OUT-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â£Ó£Å£Ì£Å£Ã£Ô½èÍý
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â£Æ£Å£Ô£Ã£È½èÍý
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       900-CLOSE-SEC               SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¥¢¥¯¥»¥¹½èÍý
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
      *
       900-ORCDBMAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ð£Õ£Ô¡¡½èÍý
      *****************************************************************
       900-PUT-WINDOW              SECTION.
      *
           MOVE   "PUTWINDOW"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           .
      *
       900-PUT-WINDOW-EXT.
           EXIT.
