      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCR0640.
      *****************************************************************
      *  システム名        : ＯＲＣＡ
      *  サブシステム名    : レセプト（入院）
      *  コンポーネント名  : 診療区分別点数集計
      *  管理者            : 
      *  作成日付    作業者        記述
      *  02/12/11    NaCl−門脇    新規作成
      *****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  01.00.01    NACL-門脇    03.03.05  点滴編集追加
      *  01.00.02    NACL-門脇    03.03.10  食事区分”４”の対応追加
      *  01.00.03    NACL-門脇    03.03.12  選定入院料対応
      *  01.00.04    NACL-藤原    03.04.09  特定器材（画像診断のフィルム以外）
      *                                     の単価を表示するように修正
      *  01.00.05    NACL-門脇    03.04.10  看護配置適合の外泊対応
      *  01.00.06    NACL-門脇    03.04.16  船員保険（被保険者）＋通勤災害
      *                                     ＋初診時　対応
      *  01.00.07    NACL-門脇    03.04.17  結核、精神の一部負担額編集修正
      *  01.00.08    NACL-藤原    03/04/21  地方公費データのとき不明分は
      *                                     処理の対象としない
      *  01.00.09    NACL-門脇    03/04/24  一部負担金（）の編集修正
      *  01.00.10    NACL-門脇    03/05/08  名称有効桁のセット
      *  01.00.11    NACL-門脇    03/05/22  残量廃棄の数量セット
      *  01.00.12    NACL-門脇    03/05/23  一部負担金記載修正
      *  01.00.13    NACL-門脇    03/05/28  老人精神病棟等の診療行為コード
      *                                     置き換え
      *  01.00.14    NACL-門脇    03/06/11  選定療養の他医療機関受診の
      *                                     診療行為コード修正
      *  01.00.15    NACL-門脇    03/08/20  公費実日数テーブル情報のセット
      *  01.00.16    NACL-門脇    03/08/27  特定疾患改正対応
      *  01.00.17    NACL-門脇    03/09/18  一部負担金額編集修正
      *  01.00.18    NACL-門脇    03/09/24  コメント編集修正
      *  01.00.19    NACL-門脇    03/09/29  包括対象検査情報のセット
      *                                     検査等実施判断情報のセット
      *                                     各種番号等情報のセット
      *  01.00.20    NACL-門脇    03/10/02  東京都地方公費対応
      *  01.00.21    NACL-門脇    03/11/26  自費レセプトの自費分
      *                                     摘要欄記載対応
      *  01.00.22    NACL-門脇    04/01/06  診療行為コードの１桁目の判定
      *                                     修正
      *  01.00.23    NACL-門脇    04/01/14  診療行為の包括分は除く
      *                                     SRYACCT7→33
      *  01.00.24    NACL-門脇    04/01/19  病床数編集フラグの編集
      *  01.00.25    NACL-門脇    04/01/20  自費レセ摘要欄編集レコード
      *                                     フラグの編集
      *  01.00.26    NACL-門脇    04/01/28  診療区分９０、９２のコメント
      *                                     のみの剤もレセ記載の対象にする
      *  01.00.27    NACL-門脇    04/02/05  診療コード＊数量の累計編集
      *  01.00.28    NACL-門脇    04/02/10  生保の一部負担金額記載修正
      *  01.00.29    NACL-門脇    04/02/20  合計点数情報（ぶん点・公費分離
      *                                     区分編集用）を使用するよう修正
      *  01.00.30    NACL-門脇    04/02/27  未実施減算月途中変更対応
      *  01.00.31    NACL-門脇    04/03/17  愛媛県地方公費：福祉レセ対応
      *  01.00.32    NACL-門脇    04/03/17  他医療機関受診の判定用コード
      *                                     （入院基本料加算区分）追加
      *  01.00.33    NACL-門脇    04/03/18  有床診療所１群入院基本料１
      *                                     （医師配置適合）の外泊時
      *                                     の基本料取得対応等
      *  ２００４年４月改正対応
      *  01.01.01    NACL-門脇    04/04/01  上限あり公費併用時の一部負担額
      *                                     編集修正
      *  01.01.02    NACL-門脇    04/04/01  リハ言語聴覚療法（３）追加対応
      *  01.01.03    NACL-門脇    04/04/05  在宅血液透析頻回指導管理料の
      *                                     コメント対応
      *  01.01.04    NACL-門脇    04/04/26  ユーザーコメント追加対応
      *  01.01.05    NACL-門脇    04/05/11  老人入院料摘要欄対応
      *  01.01.06    NACL-門脇    04/05/13  初診時に時間外・深夜・休日が
      *                                     ２つ以上あった場合の記載対応
      *  01.01.07    NACL-門脇    04/05/20  点滴の器材単価編集
      *  01.01.08    NACL-門脇    04/06/08  選定外泊のコメント対応
      *  01.01.09    NACL-小豆沢  04/06/08  ＣＴ・ＭＲＩ（２回目以降）の
      *                                     摘要欄記載順修正
      *  01.01.10    NACL-門脇    04/06/21  生活保護の負担金額記載修正
      *  01.01.11    NACL-門脇    04/07/27  原爆食事療養記載修正
      *  01.01.12    NACL-藤原    04/07/28  RECE65レイアウト変更
      *                                     告示等識別区分１
      *                                     きざみ値計算識別
      *                                     注加算コードの追加
      *  01.01.13    NACL-門脇    04/07/28  投薬料の器材点の集計修正
      *  01.01.14    NACL-門脇    04/08/04  同一保険番号対応
      *  01.01.15    NACL-門脇    04/08/05  食事療養費が患者負担あり（上限
      *                                     あり）の場合の療養の給付−負担
      *                                     金額欄記載修正
      *  01.01.16    NACL-太田    04/08/10  点数マスタ検索ロジック修正
      *  01.01.17    NACL-門脇    04/08/20  兵庫県地方公費対応
      *  01.01.18    NACL-藤原    04/09/17  ＯＣＲ記載対応
      *  01.01.19    NACL-門脇    04/10/04  点滴の診療コード＊数量の累計編集
      *  中止処理追加
      *  01.02.01    NACL-藤原    04/10/07  中止処理の追加
      *  01.02.02    NACL-門脇    04/11/15  公費月上限額取得修正
      *  01.02.03    NACL-門脇    04/11/22  フィルム点数計算
      *                                     （診区４０、５０、５４、６０）
      *  01.02.04    NACL-小豆沢  04/12/08  点数フラグの初期化追加
      *  01.02.05    NACL-藤原    04/11/01  記載なしの公費の処理
      *  01.02.06    NACL-門脇    04/12/15  公費一部負担金レセ記載フラグ
      *                                     の編集
      *                                     公費一部負担金０円記載フラグ
      *                                     の編集
      *  01.02.07    NACL-門脇    05/01/18  酸素計算式コメント対応
      *  01.02.08    NACL-門脇    05/01/24  児童保護食事療養記載修正
      *  01.02.09    NACL-門脇    05/02/14  高齢者一部負担額記載修正
      *  01.02.10    NACL-門脇    05/02/28  （サ）記載対応
      *  01.02.11    NACL-門脇    05/03/03  特記事項の編集修正
      *  01.02.12    NACL-門脇    05/03/03  食事に関する編集修正
      *  01.02.13    NACL-門脇    05/03/16  負担金額（一部負担額）・
      *                                     負担金額（控除額）・
      *                                     一部負担金・食事療養費標準
      *                                     負担額区分の編集
      *  01.03.01    NACL-門脇    05/03/24  小児特定上限対応
      *  01.03.02    NACL-小豆沢  05/03/24  老人理学療法摘要欄対応
      *
      *  02.06.01    NACL-門脇    05/04/08  負担金額（一部負担額）編集
      *                                     修正
      *  02.06.02    NACL-門脇    05/05/16  療養担当手当（北海道）対応
      *  02.06.03    NACL-門脇    05/05/19  点数マスタの単位文字数がゼロ
      *                                     の場合の編集
      *  02.06.04    NACL-小豆沢  05/05/20  入院点滴種別追加に伴う修正
      *  02.06.05    NACL-門脇    05/05/31  レセ記載フラグ、０円記載フラグ
      *                                     の編集修正
      *  02.06.06    NACL-竹田    05/05/30  realtime preview 処理追加
      *  02.06.07    NACL-小豆沢  05/06/17  realtime preview 福岡給付外点数
      *  02.06.08    NACL-門脇    05/06/27  高齢者で、主保険＋地方公費
      *                                     （レセ記載なし）の一部負担額記載
      *                                     修正
      *  02.06.09    NACL-門脇    05/07/07  更生・育成の日割計算時の
      *                                     一部負担額記載修正
      *  02.06.10    NACL-藤原    05/07/13  本人−入院−内容の追加
      *  02.06.11    NACL-藤原    05/08/05  記載外公費−負担者番号の追加
      *  02.06.12    NACL-門脇    05/08/22  リハビリ実施回数差し込み修正対応
      *  02.06.13    NACL-藤原    05/08/22  検体検査コメントの追加
      *  02.06.14    NACL-門脇    05/09/13  入院点滴コメントに関する修正
      *  02.06.15    NACL-小豆沢  05/09/16  以下の特定入院料の外泊計算を修正
      *                                     診療所老人医療管理料
      *                                     老人性認知症疾患治療病棟入院料１
      *                                     老人性認知症疾患治療病棟入院料２
      *  02.06.16    NACL-門脇    05/09/22  全国土木建築、全国板金業＋
      *                                     精神、結核対応
      *  02.06.17    NACL-門脇    05/09/28  島根県地方公費１０月改正対応
      *  02.06.18    NACL-門脇    05/10/04  精神食事療養記載修正
      *
      *  02.07.01    NACL-藤原    05/08/20  特別療養費対応
      *  02.07.02    NACL-小豆沢  05/10/28  特記事項　先進、制超　対応
      *  02.07.03    NACL-門脇    05/11/01  （検選）等コメント対応
      *  02.07.04    NACL-門脇    05/11/11  コメントがある場合の編集修正
      *  02.07.05    NACL-門脇    05/11/15  傷病手当金、療養費同意書の自動
      *                                     記載フラグ編集修正
      *  02.07.06    NACL-門脇    06/01/05  シス管（５０００）の食事情報取
      *                                     得修正
      *  02.07.07    NACL-門脇    06/01/20  標欠対応
      *  02.07.08    NACL-門脇    06/02/01  ０９９２０００で始まる投薬用
      *                                     コメントの編集対応
      *  02.07.09    NACL-門脇    06/02/03  宮城県地方公費食事療養費記載対応
      *  02.07.10    NACL-門脇    06/02/03  高知県乳幼児対応
      *  02.07.11    NACL-門脇    06/02/07  食事基本料情報（その他）編集
      *  02.08.01    NACL-小豆沢  06/03/22  特定入院料追加分（脳卒中ケアユニ）
      *                                     外泊置き換え処理
      *
      *  ２００６年４月改正対応
      *  02.09.01    NACL-門脇    06/04/05  累計トータル編集修正
      *  02.09.02    NACL-門脇    06/04/13  ２００６年４月改正対応
      *  02.09.03    NACL-藤原    06/04/14  三種の公費併用に係わる記載要
      *                                     項の特例対応
      *  02.09.04    NACL-門脇    06/04/20  外来迅速検体検査加算編集
      *  02.09.05    NACL-門脇    06/04/26  生活保護一部負担編集修正
      *  02.09.06    NACL-門脇    06/04/26  川崎市国保＋２１精神一部負担
      *                                     編集修正
      *  02.09.07    NACL-門脇    06/04/27  相模原市国保＋２１精神一部負担
      *                                     編集修正
      *  02.09.08    NACL-門脇    06/05/08  改定通信医１６０４９号
      *                                     日計表詳記レコード対応
      *                                     収納より総点数を集計
      *  02.09.09    NACL-門脇    06/05/09  累計トータル編集修正
      *  02.09.10    NACL-藤原    06/05/09  ＯＣＲエリアの薬剤一部負担金
      *                                     に生月日を記載
      *  02.09.11    NACL-門脇    06/05/16  老人特定入院基本料の診療区分
      *                                     編集修正
      *  02.09.12    NACL-門脇    06/05/23  外泊時の入院基本料取得修正
      *  02.09.13    NACL-門脇    06/05/31  川崎市国保、相模原市国保の
      *                                     対応取り止め
      *
      *  03.00.01    NACL-藤原    06/06/07  ＯＣＲエリアの記号番号の数字
      *                                     記載対応
      *  03.00.02    NACL-門脇    06/06/22  往診、在宅患者訪問診療料の
      *                                     コメント自動記載対応
      *  03.01.01    NACL-門脇    06/06/30  療養病棟の他医療機関受診対応
      *  03.01.02    NACL-門脇    06/07/06  生保単独時の一部負担金記載
      *                                     修正
      *  03.01.03    NACL-門脇    06/07/06  公費単独時の食事負担額編集
      *                                     修正
      *  03.01.04    NACL-門脇    06/07/10  在支援コメント自動記載対応
      *  03.01.05    NACL-門脇    06/07/20  北海道の特定疾患食事対応
      *  03.02.01    NACL-門脇    06/08/04  診療行為のみの公費の食事欄
      *                                     編集修正（０記載）
      *  03.02.02    NACL-門脇    06/08/10  高齢者上限額経過措置対応
      *  03.02.03    NACL-門脇    06/08/30  入院点滴の剤番号編集修正
      *  03.02.04    NACL-門脇    06/09/08  フイルムの単価編集修正
      *  03.03.01    NACL-門脇    06/09/26  岡山県地方公費一部負担金編集
      *  03.03.02    NACL-門脇    06/09/27  特記事項１６長２対応
      *  03.03.03    NACL-門脇    06/09/29  Ｈ１８年１０月改正に伴う一部
      *                                     負担金編集対応
      *  03.03.04    NACL-藤原    06/09/29  検査の判断料の記載方法の変更
      *                                     検査等実施判断の追加
      *  03.03.05    NACL-門脇    06/10/10  老齢福祉年金についての対応
      *  03.03.06    NACL-門脇    06/10/11  入院時生活療養費対応
      *  03.03.07    NACL-門脇    06/10/17  減額・免除・支払猶予対応
      *  03.03.08    NACL-門脇    06/10/30  障害児施設医療・療養介護医療
      *                                     対応
      *  03.03.09    NACL-門脇    06/11/02  減額・免除・支払猶予対応
      *  03.03.10    NACL-門脇    06/11/10  往診のコメント自動記載条件修正
      *  03.03.11    NACL-門脇    06/11/15  入院時生活療養費食事負担内訳
      *  03.04.01    NACL-門脇    06/11/20  高額４回目以降対応
      *  03.04.02    NACL-門脇    06/11/24  宮城県地方公費１０月改正対応
      *  03.04.03    NACL-門脇    06/11/29  入院時生活療養費対応（新潟県）
      *  03.04.04    NACL-門脇    06/12/04  上限額に食事を含む場合の食事療養
      *                                     欄記載修正
      *  03.04.05    NACL-門脇    06/12/06  茨城県地方公費一部負担金記載対応
      *  03.04.06    NACL-門脇    06/12/26  東京理容等＋結核対応
      *  03.04.07    NACL-門脇    07/01/16  （　）再掲記載の修正
      *  03.04.08    NACL-門脇    07/01/23  ５１＋低所得対応
      *  03.04.09    NACL-門脇    07/02/14  福島県飯館村対応
      *  03.04.10    NACL-門脇    07/02/19  北海道５１＋４１対応
      *  03.04.11    NACL-門脇    07/03/14  保険欄一部負担金記載修正
      *  03.04.12    NACL-門脇    07/03/28  特定器材種別１、酸素等区分の編集
      *  03.04.13    NACL-門脇    07/04/01  現物給付対応
      *  03.04.14    NACL-門脇    07/04/13  リハビリ対応
      *  03.04.15    NACL-門脇    07/05/15  点滴の記載編集修正
      *  03.04.16    NACL-門脇    07/05/22  京都府５１＋４１対応
      *  03.04.17    NACL-門脇    07/06/07  食事がない場合の食事欄記載修正
      *  03.04.18    NACL-門脇    07/06/13  現物給付高額４回目公費併用時対応
      *  03.05.01    NACL-小豆沢  07/06/04  グループ診療対応
      *  03.05.02    NACL-門脇    07/07/17  個別時のシステム管理編集修正
      *  03.05.03    NACL-門脇    07/07/20  北海道４１老人現物給付対応
      *  03.05.04    NACL-門脇    07/07/26  レセに記載しないコメント対応
      *  03.05.05    NACL-門脇    07/07/31  ７０歳未満現物給付保険者毎で計算
      *  03.05.06    NACL-門脇    07/08/01  所得情報取扱い機能強化対応
      *  03.05.07    NACL-門脇    07/08/01  標準負担額減額認定証設定対応
      *  03.05.08    NACL-門脇    07/08/01  月途中の所得情報変更対応
      *  03.05.09    NACL-門脇    07/08/10  北海道４１老人現物給付対応修正
      *  03.05.10    NACL-門脇    07/09/03  減額減免全国公費対応
      *  03.05.11    NACL-門脇    07/09/18  画像診断の加算（データ区分：手技）
      *                                     の記載順変更対応
      *  03.05.12    NACL-藤原    07/09/11  新潟県中越沖地震対応
      *                                     ２００７年９月〜１２月対象 
      *  03.05.13    NACL-門脇    07/09/27  特定保険者＋精神、結核対応修正
      *                                     （老人は対象外とする）
      *  03.05.14    NACL-門脇    07/10/03  秋田県乳幼児一部負担金記載対応
      *  03.05.15    NACL-門脇    07/10/04  新潟県中越沖地震対応修正
      *  04.01.01    NACL-門脇    07/10/05  入院点滴コメント対応
      *  04.01.02    NACL-門脇    07/10/25  北海道５１（道単独事業）に関わる
      *                                     （　）再掲記載対応
      *  04.01.03    NACL-門脇    07/11/12  千葉県乳幼児一部負担金記載対応
      *  04.01.04    NACL-門脇    07/11/26  特定器材商品名記載対応
      *  04.01.05    NACL-門脇    07/11/29  新潟県中越沖地震対応修正
      *  04.01.06    NACL-門脇    07/11/30  他保険にて診察料算定済の名称置換
      *  04.01.07    NACL-門脇    07/12/03  北海道特定疾患（道単独事業）対応
      *  04.01.08    NACL-門脇    07/12/07  ＜７０歳未満現物給付＞
      *                                     月途中に保険者番号の変更なく、記
      *                                     号番号のみ変更になった場合の対応
      *  04.01.09    NACL-門脇    07/12/19  入院料未算定日対応
      *  04.01.10    NACL-門脇    08/01/07  京都府地方公費請求点記載対応
      *  04.01.11    NACL-門脇    08/01/07  徳島県地方公費一部負担金記載対応
      *  04.01.12    NACL-門脇    08/01/15  公害対応
      *  04.01.13    NACL-門脇    08/01/25  結核入院限度額対応
      *  04.01.14    NACL-門脇    08/02/04  標欠外泊計算修正
      *  04.01.15    NACL-門脇    08/02/06  岡山県地方公費対応
      *  04.01.16    NACL-門脇    08/02/12  処方料等カウント修正
      *  04.01.17    NACL-門脇    08/02/15  負担金額（一部負担額）編集修正
      *  04.02.01    NACL-門脇    08/02/20  主保険がない場合の食事療養費欄
      *                                     編集修正
      *  04.02.02    NACL-門脇    08/03/06  生保一部負担金編集修正
      *  04.02.03    NACL-門脇    08/03/10  ○○にて入院料算定済のフラグ編集修正
      *  04.02.04    NACL-門脇    08/03/19  生保の７９併用時の対応
      *  04.02.05    NACL-門脇    08/03/24  平成２０年４月改正対応
      *                                     （外泊：他医療機関受診時の診療行為
      *                                             コード取得）
      *                                     （特記事項追加対応：２０）
      *                                     （薬剤管理指導料コード追加）
      *                                     （脳血管リハ（３）コード追加）
      *                                     （介達牽引発症日記載廃止）
      *                                     （初診（夜間・早朝等）加算追加）
      *                                     （診療区分６４：病理診断対応）
      *                                     （一部負担金記載編集）
      *                                     （在支病自動記載対応）
      *  04.02.06    NACL-藤原    08/03/31  広域連合ＯＣＲ出力区分追加
      *  04.02.07    NACL-門脇    08/04/03  ○○にて入院料算定済のフラグ編集修正
      *  04.02.08    NACL-門脇    08/04/08  滋賀県地方公費一部負担金記載対応
      *  04.02.09    NACL-門脇    08/04/08  北海道道老廃止
      *  04.02.10    NACL-門脇    08/04/24  ７０歳代前半特例一部負担金記載修正
      *  04.02.11    NACL-門脇    08/04/25  ７０歳代前半特例対象者編集
      *  04.02.12    NACL-門脇    08/04/25  ７０歳代前半特例一部負担金記載修正
      *                                     （道単独事業５１）
      *  04.02.13    NACL-門脇    08/05/01  後期高齢者月途中保険者変更対応
      *  04.02.14    NACL-門脇    08/05/15  徳島県地方公費請求点記載対応
      *  04.02.15    NACL-門脇    08/05/28  ７０歳代前半特例一部負担金記載修正
      *                                     （都単独事業５１）
      *  04.02.16    NACL-門脇    08/05/29  現物給付保険者単位条件追加
      *  04.02.17    NACL-門脇    08/06/03  入院時生活療養費の公費対象外対応
      *                                     （群馬県地方公費）
      *  04.02.18    NACL-門脇    08/06/09  結核＋生保食事療養記載対応
      *  04.02.19    NACL-門脇    08/06/09  群馬県後期高齢者レセ記載対応
      *  04.02.20    NACL-門脇    08/06/12  愛媛県地方公費対応
      *                                     （一部負担金・一部負担金再掲欄編集）
      *  04.02.21    NACL-門脇    08/06/13  退院前訪問指導料、精神科退院前訪問
      *                                     指導料のコメント対応
      *  04.02.22    NACL-門脇    08/06/25  全国公費２種の一部負担金等記載対応
      *  04.02.23    NACL-門脇    08/06/30  高齢者一般経過措置延長対応
      *  04.02.24    NACL-門脇    08/07/03  山梨県４１老人対応
      *  04.02.25    NACL-門脇    08/07/23  岩手・宮城内陸地震対応
      *  04.02.26    NACL-門脇    08/08/20  大阪府地方公費対応
      *  04.02.27    NACL-門脇    08/08/26  ７０歳未満現物給付マル長に関する修正
      *  04.02.28    NACL-門脇    08/09/08  兵庫県地方公費対応
      *  04.02.29    NACL-門脇    08/09/09  建設連合組合＋精神、結核対応
      *  04.02.30    NACL-門脇    08/09/10  広島県地方公費対応
      *  04.02.31    NACL-門脇    08/09/16  一部負担金再掲欄記載修正
      *  04.02.32    NACL-門脇    08/09/24  高齢者一般経過措置延長対応修正
      *  04.02.33    NACL-門脇    08/10/02  北海道特定疾患対応
      *  04.02.34    NACL-門脇    08/10/22  神戸市地方公費大阪府対応
      *
      *  04.03.01    NACL-門脇    08/07/07  複数保険組み合わせ使用時の
      *                                     請求点・実日数記載対応
      *  04.03.02    NACL-門脇    08/07/08  診区１４のコメントのみの剤
      *                                     編集対応
      *  04.03.03    NACL-門脇    08/07/14  仮レセ作成（院外処方含む）対応
      *                                     投薬剤点０（院外等）記載
      *  04.03.04    NACL-門脇    08/08/19  入院料未算定時のコメント対応
      *  04.03.05    NACL-門脇    08/11/26  兵庫県医師国保組合＋精神、結核対応
      *  04.03.06    NACL-門脇    08/12/01  在宅（院外分）編集修正
      *  04.03.07    NACL-門脇    08/12/04  仮収納チェック処理追加
      *  04.03.08    NACL-門脇    08/12/16  平成２１年１月改正対応
      *  04.03.09    NACL-門脇    09/01/05  平成２１年１月改正対応
      *  04.03.10    NACL-門脇    09/01/14  北海道特定疾患対応
      *  04.03.11    NACL-門脇    09/01/21  マル長併用時編集修正
      *  04.03.12    NACL-門脇    09/01/28  一部負担金編集修正
      *  04.03.13    NACL-門脇    09/01/28  山梨県４１老人対応
      *  04.03.14    NACL-門脇    09/02/09  公費分点数編集修正
      *  04.03.15    NACL-門脇    09/02/26  長崎県地方公費対応
      *  04.03.16    NACL-門脇    09/02/26  ７５歳以上の前期高齢者対応
      *  04.03.17    NACL-門脇    09/03/24  埼玉県地方公費対応
      *
      *  04.04.01    NACL-門脇    08/12/25  包括対応
      *  04.04.02    NACL-門脇    09/02/04  検査のコメント自動記載対応
      *  04.04.03    NACL-門脇    09/02/16  地方公費のレセ記載対応
      *  04.04.04    NACL-門脇    09/04/13  平成２１年５月改正対応
      *  04.04.05    NACL-門脇    09/04/15  東京都地方公費
      *                                     平成２１年４月改正対応
      *  04.04.06    NACL-門脇    09/04/15  群馬県地方公費対応
      *  04.04.07    NACL-藤原    09/04/21  注加算による加算項目の記載
      *                                     基本項目が複数ある場合は基本
      *                                     項目毎に加算項目の記載を行なう
      *                                     告示等識別区分２、通則加算対
      *                                     象外区分の追加
      *  04.04.08    NACL-門脇    09/05/11  平成２１年５月改正対応
      *  04.04.09    NACL-門脇    09/05/29  平成２１年５月改正対応
      *  04.04.10    NACL-門脇    09/06/01  平成２１年５月改正対応
      *                                     （東京都１５１）
      *  04.04.11    NACL-門脇    09/06/10  長期＋全国公費２種の対応
      *  04.04.12    NACL-門脇    09/06/23  点滴器材商品名記載修正
      *  04.04.13    NACL-門脇    09/07/08  精神入院限度額対応
      *  04.04.14    NACL-門脇    09/07/16  公費月上限額判定
      *  04.04.15    NACL-門脇    09/07/17  東京都地方公費対応
      *  04.04.16    NACL-門脇    09/08/17  中国・九州北部豪雨対応
      *  04.04.17    NACL-門脇    09/08/18  群馬県地方公費対応
      *  04.04.18    NACL-門脇    09/08/19  出産一時金対応
      *  04.04.19    NACL-門脇    09/09/01  茨城県地方公費対応
      *  04.04.20    NACL-門脇    09/09/03  全国土木＋精神、結核対応
      *                                     （奈良県）
      *  04.04.21    NACL-門脇    09/09/07  愛知県単独５１対応
      *  04.04.22    NACL-門脇    09/09/08  長崎県地方公費対応
      *  04.04.23    NACL-門脇    09/09/10  月途中に医保と生保の併用から
      *                                     生保単独になったときの対応
      *  04.04.24    NACL-門脇    09/09/11  宮崎県地方公費対応
      *  04.04.25    NACL-門脇    09/09/15  埼玉県地方公費食事対応
      *  04.04.26    NACL-門脇    09/09/17  東京都マル子対応
      *                                     （平成２１年１０月診療〜）
      *  04.04.27    NACL-門脇    09/09/17  一部負担金記載修正
      *  04.04.28    NACL-門脇    09/09/18  平成２１年台風第９号対応
      *  04.04.29    NACL-門脇    09/09/18  茨城県地方公費対応
      *  04.04.30    NACL-門脇    09/11/05  高齢者他保険入院対応
      *  04.04.31    NACL-門脇    09/11/19  和歌山県地方公費対応
      *  04.04.32    NACL-門脇    09/12/02  平成２１年５月改正対応
      *                                     （５２の対象負担者番号追加）
      *  04.04.33    NACL-門脇    09/12/04  剤まとめ項目値の計算修正
      *  04.04.34    NACL-門脇    09/12/07  時間外加算区分編集
      *  04.04.35    NACL-門脇    09/12/09  出来高算定（剤）の対応
      *  04.04.36    NACL-門脇    10/01/04  公費単独の食事標準負担額編集修正
      *                                     公費単独の一部負担金編集修正
      *                                     月途中に医保と更生等の併用から
      *                                     更生等単独になったときの対応
      *  04.04.37    NACL-門脇    10/01/08  高齢者他保険入院対応修正
      *  04.04.38    NACL-門脇    10/01/13  剤まとめ項目値の計算修正
      *  04.04.39    NACL-門脇    10/02/01  大阪府地方公費対応
      *  04.04.40    NACL-門脇    10/02/16  レセ記載しない地方公費がある場合
      *                                     の保険欄一部負担金編集対応
      *  04.04.41    NACL-門脇    10/03/05  ７０歳代前半の特例措置延長対応
      *  04.04.42    NACL-門脇    10/03/09  ７０歳代前半の特例措置対象者に
      *                                     関する保険欄一部負担金編集修正
      *  04.04.43    NACL-門脇    10/03/23  改正対応
      *                                     （外泊区分５の対応）
      *                                     （外泊区分４の条件追加）
      *                                     （外泊区分４特定入院基本料の対応）
      *  04.04.44    NACL-門脇    10/03/25  改正対応
      *                                     （予約コード読み飛ばし編集）
      *  04.04.45    NACL-門脇    10/03/29  改正対応
      *                                     （画像診断２回目以降減算編集）
      *                                     （コード追加）
      *  04.04.46    NACL-門脇    10/04/06  改正対応
      *                                     （コメント自動記載）
      *  04.04.47    NACL-門脇    10/04/09  広島県地方公費対応
      *                                     社保分保険欄一部負担金記載
      *                                     一律一般の金額で記載
      *  04.04.48    NACL-門脇    10/04/13  分点編集
      *  04.04.49    NACL-門脇    10/04/16  山口県地方公費対応
      *  04.04.50    NACL-門脇    10/04/30  長期＋全国公費２種の再掲対応
      *  04.04.51    NACL-門脇    10/05/14  入院料加算剤番号変換
      *  04.04.52    NACL-門脇    10/05/21  外泊時の入院料加算編集修正
      *  04.04.53    NACL-門脇    10/05/21  茨城県地方公費対応
      *  04.04.54    NACL-門脇    10/06/01  他医療機関受診対応
      *  04.04.55    NACL-門脇    10/07/06  ７０歳代前半の特例措置対象者で
      *                                     ５１が複数ある場合の対応
      *  04.04.56    NACL-門脇    10/07/20  秋田県地方公費対応
      *                                     社保分保険欄一部負担金記載
      *                                     一律一般の金額で記載
      *  04.04.57    NACL-門脇    10/08/05  特定入院基本料の１８０日超え
      *                                     他医受診時の診療行為コード修正
      *  04.04.58    NACL-門脇    10/08/09  他医受診（外泊４）の選定時対応
      *  04.04.59    NACL-門脇    10/08/11  東京都地方公費２８２対応
      *  04.04.60    NACL-門脇    10/08/11  平成２２年７月中国地方豪雨対応
      *  04.04.61    NACL-門脇    10/08/23  高齢非該当対応
      *  04.04.62    NACL-門脇    10/09/01  ７０歳未満現物給付で、高額計算
      *                                     対象外の全国公費の一部負担金記
      *                                     載対応
      *  04.04.63    NACL-門脇    10/09/08  長崎県地方公費対応
      *                                     社保分保険欄一部負担金記載
      *                                     一律一般の金額で記載
      *  04.04.64    NACL-門脇    10/09/09  平成２２年７月中国地方豪雨対応
      *                                     修正
      *  04.04.65    NACL-門脇    10/11/15  宮城県地方公費対応
      *  04.04.66    NACL-門脇    10/11/16  鹿児島県奄美市等における局地的
      *                                     大雨対応
      *  04.04.67    NACL-門脇    10/12/10  剤まとめ項目値の計算修正
      *  04.04.68    NACL-門脇    10/12/13  大阪府地方公費対応
      *  04.04.69    NACL-門脇    11/01/19  現物給付時の保険欄一部負担金
      *                                     記載修正
      *
      *  04.05.01    NACL-門脇    09/06/10  摘要欄下部へのコメント記載対応
      *  04.05.02    NACL-藤原    09/07/14  小数点以下５桁対応
      *  04.05.03    NACL-門脇    09/07/29  所得者情報の機能追加
      *                                     （標準負担額のみの減額）
      *  04.05.04    NACL-門脇    09/08/17  小数点以下５桁対応
      *  04.05.05    NACL-門脇    09/09/24  レセプト記載しないコメント対応
      *  04.05.06    NACL-門脇    09/11/19  薬剤算定なし時の摘要欄同一剤
      *                                     まとめ記載対応
      *  04.05.07    NACL-門脇    09/11/20  レセ電フォーマットコメント拡張
      *                                     対応（残量廃棄）
      *  04.05.08    NACL-門脇    09/11/30  レセ電フォーマットコメント拡張
      *                                     対応（ファイル編集）
      *  04.05.09    NACL-門脇    09/12/04  食事（特別食）の他保険対応
      *  04.05.10    NACL-門脇    10/01/07  治験対応
      *  04.05.11    NACL-門脇    10/02/08  地方公費の全国公費併用分請求点
      *                                     集計対応
      *  04.05.12    NACL-門脇    10/02/09  地方公費の一部負担金０円記載
      *                                     （記録）の設定項目追加対応
      *  04.05.13    NACL-門脇    10/06/21  食事療養編集修正
      *  04.05.14    NACL-門脇    10/09/06  地方公費の全国公費併用分請求点
      *                                     集計対応（レセ電負担区分対応）
      *  04.05.15    NACL-門脇    11/02/17  災害対応修正（平成２３年１月〜）
      *  04.05.16    NACL-門脇    11/02/18  ７０歳代前半の特例措置延長対応
      *  04.05.17    NACL-門脇    11/02/18  出産一時金対応期間修正
      *  04.05.19    NACL-門脇    11/03/02  山梨県地方公費対応
      *  04.05.20    NACL-門脇    11/03/24  災害対応
      *  04.05.21    NACL-門脇    11/03/25  災害対応（災２対応）
      *  04.05.22    NACL-門脇    11/03/28  特定保険者＋精神、結核対応
      *                                     (233064)平成２３年３月まで
      *  04.05.23    NACL-門脇    11/04/07  特定保険者＋精神、結核対応
      *                                     (133280)平成２３年３月まで
      *  04.05.24    NACL-門脇    11/04/08  新潟県地方公費対応
      *                                     社保分保険欄一部負担金記載
      *                                     一律一般の金額で記載
      *  04.05.25    NACL-門脇    11/04/11  北海道地方公費（１８３）の
      *                                     一部負担金記載修正
      *  04.05.26    NACL-門脇    11/04/11  大阪府地方公費に関わる保険欄
      *                                     の記載対応（後期高齢）
      *  04.05.27    NACL-門脇    11/04/14  ７０歳未満現物給付計算修正
      *                                     自立支援(999999)の月途中変更時
      *  04.05.28    NACL-門脇    11/06/09  入院会計・療養担当手当の剤番号
      *                                     編集修正
      *  04.05.29    NACL-門脇    11/06/21  画像診断・電子画像管理加算の
      *                                     表用番号編集
      *  04.05.30    NACL-門脇    11/07/05  ７０歳未満現物給付対象編集修正
      *  04.05.31    NACL-門脇    11/07/19  月途中保険変更時の
      *                                     保険欄−一部負担金記載編集修正
      *  04.05.32    NACL-門脇    11/07/19  公費欄−一部負担金記載編集修正
      *  04.05.33    NACL-門脇    11/07/20  長崎県地方公費対応
      *  04.05.34    NACL-門脇    11/09/15  愛知県地方公費対応
      *  04.05.35    NACL-門脇    11/09/16  徳島県地方公費対応
      *  04.05.36    NACL-門脇    11/10/12  ７０歳未満現物給付自立支援
      *                                     一部負担額記載修正
      *  04.05.37    NACL-門脇    11/10/18  愛知県地方公費対応
      *  04.05.38    NACL-門脇    11/11/09  同日再入院食事対応
      *  04.05.39    NACL-門脇    11/11/30  画像診断フイルム分画数対応
      *  04.05.40    NACL-門脇    11/12/01  広島県地方公費対応
      *  04.05.41    NACL-門脇    11/12/01  宮城県地方公費対応（仙台市）
      *  04.05.42    NACL-門脇    11/12/05  特定保険者＋精神、結核対応
      *                                     (283077)平成２３年１１月まで
      *  04.05.43    NACL-門脇    11/12/13  災害対象条件修正
      *  04.05.44    NACL-門脇    11/12/15  減免対応（東大阪市）
      *  04.05.45    NACL-門脇    11/12/16  器材の金額と単位の対応
      *  04.05.46    NACL-門脇    12/01/23  長崎県地方公費対応
      *  04.05.47    NACL-門脇    12/02/06  災害対応
      *                                     （食事免除は平成２４年２月まで）
      *
      *  04.06.01    NACL-藤原    10/06/23  レセ電請求時の受付エラー分の
      *                                     種別不明レセ対応
      *  04.06.02    NACL-門脇    10/08/16  入院の点滴入力改善対応
      *  04.06.03    NACL-門脇    10/12/13  保険別請求チェック表の本体取込み
      *  04.06.04    NACL-藤原    10/10/12  公費単独のレセ分離対応
      *                                     キーにkohid 追加
      *  04.06.05    NACL-藤原    11/01/05  機能追加（注加算、同時併施等）
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION           SECTION.
       INPUT-OUTPUT            SECTION.
       FILE-CONTROL.
           SELECT  RECE62-FILE     ASSIGN  RECE62PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE62-KEY
                                   FILE    STATUS  IS  STS-RECE62.
           SELECT  RECE64-FILE     ASSIGN  RECE64PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE64-KEY
                                   FILE    STATUS  IS  STS-RECE64.
           SELECT  RECE65-FILE     ASSIGN  RECE65PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE65-KEY
                                   FILE    STATUS  IS  STS-RECE65.
           SELECT  RECE69-FILE     ASSIGN  RECE69PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE69-KEY
                                   FILE    STATUS  IS  STS-RECE69.
      *    エラーファイル
           SELECT  RECEERR-FILE    ASSIGN  RECEERR
                                   FILE    STATUS  IS  STS-RECEERR.
      *
       DATA                    DIVISION.
       FILE                    SECTION.
      *
       FD  RECE62-FILE.
       01  RECE62-REC. 
           COPY    "CPRCF062.INC".
      *
       FD  RECE64-FILE.
       01  RECE64-REC. 
           COPY    "CPRCF064.INC".
      *
       FD  RECE65-FILE.
       01  RECE65-REC. 
           COPY    "CPRCF065.INC".
      *
       FD  RECE69-FILE.
       01  RECE69-REC. 
           COPY    "CPRCF069.INC".
      *
      *    エラーファイル
       FD  RECEERR-FILE.
       01  RECEERR-REC             PIC X(200). 
      *
       WORKING-STORAGE             SECTION.
      *
      *     レセプト明細ファイル 名称領域 
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE62//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE64//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE65//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE69//.
      *
      *    エラーファイル 名称領域 
           COPY    "CPERRFL.INC"
                                   REPLACING  //ERRFLPARA//
                                   BY         //RECEERR//.
      *
      *    フラグ領域
       01  STS-AREA.
           03  STS-RECE62                              PIC X(02).
           03  STS-RECE64                              PIC X(02).
           03  STS-RECE65                              PIC X(02).
           03  STS-RECE69                              PIC X(02).
           03  STS-RECEERR                             PIC X(02).
      *
       01  FLG-AREA.
           03  FLG-END                                 PIC 9(01).
           03  FLG-SRYACCT                             PIC 9(01).
           03  FLG-SRYACT                              PIC 9(01).
           03  FLG-TENSU                               PIC 9(01).
           03  FLG-SYUNOU                              PIC 9(01).
           03  FLG-SYSKANRI                            PIC 9(01).
           03  FLG-SRYACCTPLUS                         PIC 9(01).
           03  FLG-RECE62                              PIC 9(01).
           03  FLG-KANJI                               PIC 9(01).
           03  FLG-SP                                  PIC 9(01).
           03  FLG-PTCOM                               PIC 9(01).
           03  FLG-NYUINACCT                           PIC 9(01).
           03  FLG-NYUINACT                            PIC 9(01).
           03  FLG-ARI                                 PIC 9(01).
           03  FLG-ARI2                                PIC 9(01).
           03  FLG-DAY21                               PIC 9(01).
           03  FLG-DAY21-SENTEI                        PIC 9(01).       
           03  FLG-DAY22                               PIC 9(01).
           03  FLG-DAY24                               PIC 9(01).
           03  FLG-NYUKHN                              PIC 9(01).
           03  FLG-MIJISI                              PIC 9(01).
           03  FLG-MIJISI-SENTEI                       PIC 9(01).       
           03  FLG-MIJISI2                             PIC 9(01).
           03  FLG-TENTEKI                             PIC 9(01).
           03  FLG-WRITE65                             PIC 9(01).
           03  FLG-WRITE65X                            PIC 9(01).
           03  FLG-SIKIBETU                            PIC 9(01).
           03  FLG-SENTEICDCHG                         PIC 9(01).
           03  FLG-ZANHAIKI                            PIC 9(01).
           03  FLG-FORMAL-KISAI                        PIC 9(01).
           03  FLG-RECE65-ZAN                          PIC 9(01).
           03  FLG-REWRITE                             PIC 9(01).
           03  FLG-OKIKAE                              PIC 9(01).
           03  FLG-SET                                 PIC 9(01).
           03  FLG-NYUINRYO                            PIC 9(01).
           03  FLG-HKNCOMBI                            PIC 9(01).
           03  FLG-HOUSIJI-COM                         PIC 9(01).
           03  FLG-OSIN-COM                            PIC 9(01).
           03  FLG-SYOBYO-COM                          PIC 9(01).
           03  FLG-RYOYO-COM                           PIC 9(01).
           03  FLG-SYODOU-COM                          PIC 9(01).
           03  FLG-KENSA-COM                           PIC 9(01).
           03  FLG-RECESKYKBN                          PIC 9(01).
      *****03  FLG-HKNNUM                              PIC 9(01).
           03  FLG-RECE69                              PIC 9(01).
           03  FLG-ZENKOH-ARI                          PIC 9(01).
           03  FLG-RINYAK                              PIC 9(01).
           03  FLG-TOKKI                               PIC 9(02).
           03  FLG-PTKOHINF                            PIC 9(01).
           03  FLG-TOKUSYU-SKJ                         PIC 9(01).
           03  FLG-SKJ200610FTN                        PIC 9(01).
           03  FLG-KOHYONKAIME                         PIC 9(01).
           03  FLG-MIYAGI                              PIC 9(01).
           03  FLG-KEISAN                              PIC 9(01).
           03  FLG-KEISAN2                             PIC 9(01).
           03  FLG-KEISAN3                             PIC 9(01).
           03  FLG-KEISAN-TOK1                         PIC 9(01).
           03  FLG-KEISAN-TOK2                         PIC 9(01).
           03  FLG-GENBUTU70                           PIC 9(01).
           03  FLG-GENBUTU-TAISYOOK                    PIC 9(01).
           03  FLG-TENTEKIMATOME                       PIC 9(01).
           03  FLG-TAISYO                              PIC 9(01).
           03  FLG-RJNGENMEN-CHIARI                    PIC 9(01).
           03  FLG-IRYOHI70K                           PIC 9(01).
           03  FLG-KOUGAKUCYO-GEN70K                   PIC 9(01).
           03  FLG-SAIKEI-KISAI                        PIC 9(01).
           03  FLG-TAHOKEN                             PIC 9(01).
           03  FLG-DOTANDOKU-IGAI                      PIC 9(01).
           03  FLG-DOTANDOKU                           PIC 9(01).
           03  FLG-ZENKI-TOKUREI                       PIC 9(01).
           03  FLG-SKJFTNNASI                          PIC 9(01).
           03  FLG-HOKENICHIBU                         PIC 9(01).
           03  FLG-HOKENICHIBU-SYU                     PIC 9(01).
           03  FLG-HOKENICHIBU2                        PIC 9(01).
           03  FLG-HOKENICHIBU3                        PIC 9(01).
           03  FLG-HOKENICHIBU4                        PIC 9(01).
           03  FLG-HOKENICHIBU5                        PIC 9(01).
           03  FLG-HOKENICHIBU6                        PIC 9(01).
           03  FLG-HOKENICHIBU-CHK                     PIC 9(01).
           03  FLG-HOUSEI-COM                          PIC 9(01).
           03  FLG-HOUMON-COM                          PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU                   PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU2                  PIC 9(01).
           03  FLG-SYUNOU-ARI                          PIC 9(01).
           03  FLG-TOKU75                              PIC 9(01).
           03  FLG-TOKU75-KIZON                        PIC 9(01).
           03  FLG-SYOGAI75                            PIC 9(01).
           03  FLG-TOKU75-XXX                          PIC 9(01).
           03  FLG-TOKU75-KOHSKY                       PIC 9(01).
           03  FLG-KOKI-HIGAITO                        PIC 9(01).
           03  FLG-TOKUSITU                            PIC 9(01).
           03  FLG-TOKUSITU-TASU                       PIC 9(01).
           03  FLG-KOUGAKU                             PIC 9(01).
           03  FLG-KISAIOK                             PIC 9(01).
           03  FLG-GENGAKU-OKIKAE                      PIC 9(01).
           03  FLG-KOHYONKAIME-NO                      PIC 9(01).
           03  FLG-KOUREI-KBN                          PIC 9(01).
           03  FLG-SETCOM                              PIC 9(01).
           03  FLG-WRKFILE-CLEAR                       PIC 9(01).
           03  FLG-WRKFILE-KGKTAI                      PIC 9(01).
           03  FLG-SAIGAI-TAISYO                       PIC 9(01).
           03  FLG-CHIIKI                              PIC 9(01).
           03  FLG-KGKIPNTAI                           PIC 9(01).
           03  FLG-KGK                                 PIC 9(01).
           03  FLG-SKY-TOKKOH                          PIC 9(01).
           03  FLG-GENMEN-ARI                          PIC 9(01).
           03  FLG-GENMEN-NASI                         PIC 9(01).
           03  FLG-GENMEN-ARI2                         PIC 9(01).
           03  FLG-GENMEN-NASI2                        PIC 9(01).
           03  FLG-SAIGAI-JGN-ETC1                     PIC 9(01).
           03  FLG-SAIGAI-JGN-ETC2                     PIC 9(01).
           03  FLG-SAIGAI-JGN-SEIHO                    PIC 9(01).
           03  FLG-SAIGAI-ETC1-ARI                     PIC 9(01).
           03  FLG-JIRITU-CYUKANSOU1                   PIC 9(01).
           03  FLG-JIRITU-CYUKANSOU2                   PIC 9(01).
           03  FLG-DOJITU                              PIC 9(01).
      *
      *    カウント領域
       01  CNT-AREA.
           03  CNT-IN-COMMIT                           PIC 9(06).
           03  CNT-IN-CANCEL                           PIC 9(06).
           03  CNT-OUT1                                PIC 9(06).
           03  CNT-OUT2                                PIC 9(06).
           03  CNT-TBL-OCC                             OCCURS  2.
               05  CNT-IN                              PIC 9(06).
               05  CNT-OUT3                            PIC 9(06).
           03  CNT-DAY21                               PIC 9(06).
           03  CNT-DAY21-SENTEI                        PIC 9(06).       
           03  CNT-DAY22                               PIC 9(06).
           03  CNT-DAY24                               PIC 9(06).
           03  CNT-ZAIREN                              PIC 9(02).
      *
      *    添字領域
       01  IDX-AREA.
           03  IDX                                     PIC 9(03).
           03  IDX1                                    PIC 9(03).
           03  IDX2                                    PIC 9(03).
           03  IDX3                                    PIC 9(03).
           03  IDX4                                    PIC 9(03).
           03  IDX5                                    PIC 9(03).
           03  IDX6                                    PIC 9(03).
           03  IDX7                                    PIC 9(02).
           03  IDX8                                    PIC 9(02).
           03  IDX9                                    PIC 9(02).
           03  IDXA                                    PIC 9(01).
           03  IDXB                                    PIC 9(03).
           03  IDXX                                    PIC 9(02).
           03  IDYY                                    PIC 9(02).
           03  IDYX                                    PIC 9(02).
           03  IDZX                                    PIC 9(02).
           03  IDY                                     PIC 9(03).
           03  IDY2                                    PIC 9(03).
           03  IDY3                                    PIC 9(03).
           03  IDZ                                     PIC 9(03).
           03  IDW                                     PIC 9(03).
           03  IDW2                                    PIC 9(03).
           03  IDW3                                    PIC 9(03).
           03  IDW4                                    PIC 9(03).
           03  IDW5                                    PIC 9(03).
           03  IDW6                                    PIC 9(03).
           03  ID1                                     PIC 9(03).
           03  ID2                                     PIC 9(03).
           03  ID3                                     PIC 9(03).
           03  ID4                                     PIC 9(03).
           03  NUM-IDX                                 PIC 9(01).
           03  HC-IDX                                  PIC 9(03).
           03  KH-IDX                                  PIC 9(03).
           03  BUN-IDX                                 PIC 9(03).
           03  BUN-IDX2                                PIC 9(03).
           03  BUN-IDX3                                PIC 9(03).
           03  BUN-IDX4                                PIC 9(03).
           03  SYUKEI-IDX                              PIC 9(03).
           03  SYUKEI-IDX2                             PIC 9(03).
           03  SYUKEI-IDX3                             PIC 9(03).
           03  SYUKEI-IDX4                             PIC 9(03).
           03  SYUKEI-IDX5                             PIC 9(03).
           03  GENSAN-IDX                              PIC 9(03).
           03  GENSAN-IDX2                             PIC 9(03).
           03  IDV                                     PIC 9(02).
           03  IDV2                                    PIC 9(03).
           03  IDU                                     PIC 9(03).
           03  NYUINACT-IDX                            PIC 9(03).
           03  KOHFTN-IDX                              PIC 9(03).
           03  KOHFTN-IDX2                             PIC 9(03).
           03  SYSKAN-IDX                              PIC 9(03).
           03  SYSKAN-IDX2                             PIC 9(03).
           03  KOHIDX                                  PIC 9(03).
           03  FUKA-IDX                                PIC 9(03).
           03  GEN-IDX                                 PIC 9(02).
           03  TOKU75-IDX                              PIC 9(03).
           03  TOKU75-IDX2                             PIC 9(03).
           03  IDX10                                   PIC 9(03).
           03  IDX13                                   PIC 9(03).
           03  IDX-SAI                                 PIC 9(03).
      *
           03  IDA                 PIC 9(04).
           03  IDB                 PIC 9(04).
           03  SEIHIDX             PIC 9(02).
           03  KAKKIDX             PIC 9(02).
           03  SESNIDX             PIC 9(02).
      *
      *    ＯＣＲ編集領域
       01  OCR1-AREA.
           03  OCR1-HKNJANUM                           PIC 9(08).
           03  OCR1-HOSPCD                             PIC 9(07).
           03  OCR1-SKYTENSU                           PIC 9(07).
           03  OCR1-CHKDGT1                            PIC 9(01).
           03  OCR1-YKZFTN                             PIC 9(05).
           03  OCR1-CHKDGT2                            PIC 9(01).
           03  OCR1-FTNMONEY                           PIC 9(05).
           03  OCR1-CHKDGT3                            PIC 9(01).
           03  OCR1-CHKDGT4                            PIC 9(01).
           03  OCR1-JNISSU                             PIC 9(02).
           03  OCR1-SRYYM                              PIC 9(04).
           03  OCR1-CHKDGT5                            PIC 9(01).
           03  OCR1-FTNJANUM                           PIC 9(08).
           03  OCR1-JKYSNUM                            PIC 9(07).
           03  OCR1-CHKDGT6                            PIC 9(01).
           03  OCR1-PREFNUM                            PIC 9(02).
           03  OCR1-TENSUHYO                           PIC 9(01).
           03  OCR1-HKNSYUBETU1                        PIC 9(01).
           03  OCR1-HKNSYUBETU2                        PIC 9(01).
           03  OCR1-HONKZKKBN                          PIC 9(01).
           03  OCR1-SEIRINO                            PIC 9(01).
           03  OCR1-CHKDGT7                            PIC 9(01).
      *
       01  OCR2-AREA.
           03  OCR2-SEX                                PIC 9(01).
           03  OCR2-GENGO                              PIC 9(01).
           03  OCR2-BIRTHYY                            PIC 9(02).
           03  OCR2-CHKDGT1                            PIC 9(01).
           03  OCR2-KIGO                               PIC 9(10).
           03  OCR2-NUM                                PIC 9(10).
           03  OCR2-CHKDGT2                            PIC 9(01).
           03  OCR2-AREA-X.
               05  OCR2-FTNJANUM                       PIC 9(08).
               05  OCR2-JKYSNUM                        PIC 9(07).
               05  OCR2-CHKDGT3                        PIC 9(01).
               05  OCR2-JNISSU                         PIC 9(02).
               05  OCR2-TENSU                          PIC 9(07).
               05  OCR2-CHKDGT4                        PIC 9(01).
               05  OCR2-YKZFTN                         PIC 9(05).
               05  OCR2-CHKDGT5                        PIC 9(01).
               05  OCR2-FTNMONEY                       PIC 9(05).
               05  OCR2-CHKDGT6                        PIC 9(01).
               05  OCR2-CHKDGT7                        PIC 9(01).
           03  OCR2-YOBI                               PIC X(02).
      *
       01  OCR3-AREA.
           03  OCR3-AREA-X.
               05  OCR3-FTNJANUM                       PIC 9(08).
               05  OCR3-JKYSNUM                        PIC 9(07).
               05  OCR3-CHKDGT1                        PIC 9(01).
               05  OCR3-JNISSU                         PIC 9(02).
               05  OCR3-TENSU                          PIC 9(07).
               05  OCR3-CHKDGT2                        PIC 9(01).
               05  OCR3-YKZFTN                         PIC 9(05).
               05  OCR3-CHKDGT3                        PIC 9(01).
               05  OCR3-FTNMONEY                       PIC 9(05).
               05  OCR3-CHKDGT4                        PIC 9(01).
               05  OCR3-CHKDGT5                        PIC 9(01).
           03  OCR3-YOBI                               PIC X(28).
      *
      *    パス名領域
       01  WK-PATH                                     PIC X(20).
      *
      *    剤情報退避領域
       01  WK-ZAIKAISU                                 PIC S9(07).
       01  WK-ZAITEN                                   PIC S9(08).
       01  WK-SYUTEN                                   PIC S9(08).
       01  WK-KIZAITEN                                 PIC S9(08).
       01  WK-YKZTEN                                   PIC S9(08).
      *
      *    エラーメッセージ編集領域
       01  ERR-EDIT-AREA.
           03  ERR-PTNUM                               PIC X(20).
           03  ERR-ERRMSG                              PIC X(80).
           03  ERR-HEN-ERRMSG                          PIC X(200).
      *
      *    点数テーブル検索用対象日領域
       01  WK-TAIHI-AREA.
           03  WK-TAIHI-DAY                            PIC 9(02).
           03  WK-TAIHI-FLG                            PIC 9(01).
           03  WK-TAIHI-SRYYMD.
               05  WK-TAIHI-SRYYM                      PIC 9(06).
               05  WK-TAIHI-SRYD                       PIC 9(02).
      *
       01  WRK-AREA-SAIKEI.
           03  WRK-KOH-FTN                             PIC 9(09).
           03  WRK-KOH-FTN-GEN70                       PIC 9(09).
           03  WRK-KOH-KOUGAKU                         PIC 9(09).
           03  WRK-KOH-GAI                             PIC 9(09).
           03  WRK-KOH-GAI2                            PIC 9(09).
           03  WRK-KOH-GAI-GEN70                       PIC 9(09).
           03  FTN-KOH-XXX                             PIC 9(09).       
           03  FTN-KOH-XX2                             PIC 9(09).
           03  FTN-KOH-XX3                             PIC 9(09).
           03  FTN-KOH-XX4                             PIC 9(09).
           03  FTN-KOH-XX5                             PIC 9(09).
           03  FTN-KOH-XX6                             PIC 9(09).
           03  FTN-KOH-XX7                             PIC 9(09).
           03  FTN-KOH-YYY                             PIC 9(09).       
           03  FTN-KOH-YY2                             PIC 9(09).
           03  FTN-KOH-YY3                             PIC 9(09).
           03  FTN-KOH-YY4                             PIC 9(09).
           03  FTN-KOH-YY5                             PIC 9(09).
           03  FTN-KOH-YY6                             PIC 9(09).
           03  FTN-KOH-YY7                             PIC 9(09).
           03  FLG-KOH                                 PIC 9(01).
           03  WRK-FTNKEI                              PIC 9(09).
           03  WRK-FTNKEI-OKIKAE                       PIC 9(09).
           03  WRK-FTNKEI-SAGAKU                       PIC S9(09).
           03  WRK-FTNKEI-SAGAKU2                      PIC S9(09).
           03  WRK-FTNKEI-SAGAKU9                      PIC S9(09).
           03  WRK-FTNKEI-FTN                          PIC 9(09).
           03  WRK-FTNKEI2                             PIC 9(09).
           03  WRK-FTNKEI3                             PIC 9(09).
           03  WRK-FTNKEI4                             PIC 9(09).
           03  WRK-FTNKEI5                             PIC 9(09).
           03  WRK-FTNKEI6                             PIC 9(09).
           03  WRK-KINGAKU                             PIC 9(09).
           03  WRK-KINGAKU2                            PIC 9(09).
           03  WRK-KINGAKU3                            PIC 9(09).
           03  WRK-KINGAKU-GENBUTU                     PIC 9(09).
           03  WRK-KINGAKU-GENBUTU2                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU3                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU4                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU5                    PIC 9(09).
           03  FLG-CYOKI                               PIC 9(01).
           03  FLG-JYOGENKBN                           PIC 9(01).
           03  FLG-JYOGENKBN2                          PIC 9(01).
           03  FLG-JYOGENKBN3                          PIC 9(01).
           03  WRK-JYOGENKBN-TEN                       PIC 9(09).
           03  WRK-JYOGENKBN-TEN2                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN3                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN4                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN5                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN6                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN9                      PIC 9(09).
           03  WRK-TAIHI-FTNMONEYINF-AREA.
             05  WRK-TAIHI-FTNMONEYINF     OCCURS  5.
                 07  WRK-TAIHI-FTNMONEY                PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY-KOJ            PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY-EN             PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY-EN2            PIC 9(09)V9(01).
           03  WRK-KOHTANINF-AREA.
             05  WRK-KOHTANINF             OCCURS  5.
                 07  WRK-KOHTAN-SHOKUJIRYOYOHI         PIC 9(09).
      *
       01  WRK-SKY-AREA.
           03  WRK-SKY-KEISAN                          PIC 9(09).
           03  WRK-SKY-KEISAN2                         PIC 9(09).
           03  WRK-SKY-KEISAN3                         PIC 9(09).
           03  WRK-SKY-KEISAN4                         PIC S9(09).
           03  WRK-SKY-HOKENJA                         PIC 9(09).
           03  WRK-SKY-HOKENJA-KOH                     PIC 9(09).
           03  WRK-SKY-ICHIBUFTN                       PIC 9(09).
           03  WRK-SKY-ZENGAKU                         PIC 9(09).
           03  WRK-SKY-ZENGAKU-KOH                     PIC 9(09).
           03  WRK-SKY-FTNMONEY                        PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOH                    PIC 9(09)V9(01).
           03  WRK-SKY-FTNMONEY-KOH9                   PIC 9(09).
           03  WRK-SKY-ZENGAKU2                        PIC 9(09).
           03  WRK-SKY-FTNMONEY2                       PIC 9(09).
           03  WRK-SKY-FTNMONEY9                       PIC 9(09).
           03  WRK-SKY-FTNMONEY-XXX                    PIC S9(09).
           03  WRK-SKY-SKJ-ICHIBUFTN                   PIC 9(09).
           03  WRK-SKY-SKJ-ZENGAKU                     PIC 9(09).
           03  WRK-SKY-SKJ-FTNMONEY                    PIC 9(09).
           03  WRK-SKY-SKJ-ZENGAKU2                    PIC 9(09).
           03  WRK-SKY-SKJ-FTNMONEY2                   PIC 9(09).
      *
       01  WRK-DAY-TABLE.
           03  WRK-DAY-T                               OCCURS   31.
               05  WRK-DAY1                            PIC 9(04).
               05  WRK-DAY1-SENTEI                     PIC 9(04).       
               05  WRK-DAY1-SENTEI-KHNTEN              PIC 9(08).       
               05  WRK-DAY1-SENTEI-ZAITEN              PIC 9(08).       
               05  WRK-DAY1-SENTEI-SRYCD               PIC 9(09).       
               05  WRK-DAY1-SENTEI-SRYCD2              PIC 9(09).       
               05  WRK-DAY1-HYOKETU-SRYCD              PIC 9(09).
               05  WRK-DAY1-HYOKETU-TEN                PIC 9(09)V99.
               05  WRK-DAY1-KSN-SRYCD                  PIC 9(09).
               05  WRK-DAY1-NYUTENTTLKBN               PIC 9(03).
               05  WRK-DAY1-KHNTEN                     PIC 9(08).
               05  WRK-DAY1-KSNTEN                     PIC S9(08).
               05  WRK-DAY1-NYUKHNKSNKBN               PIC 9(03).
               05  WRK-DAY2                            PIC 9(04).
               05  WRK-DAY4                            PIC 9(04).
               05  WRK-DAY4X                           PIC 9(04).
               05  WRK-DAY5                            PIC 9(04).
      *
       01  WRK-DAY-TABLE2.
           03  WRK-DAY-T2                              OCCURS   31.
               05  WRK-DAY21                           PIC 9(04).
               05  WRK-DAY21-SENTEI                    PIC 9(04).       
               05  WRK-DAY22                           PIC 9(04).
               05  WRK-DAY22-NYUTENTTLKBN              PIC 9(03).
               05  WRK-DAY22-NYUKHNRYO                 PIC 9(08).
               05  WRK-DAY22-NYUKHNKSNKBN              PIC 9(03).
               05  WRK-DAY24                           PIC 9(04).
      *
       01  WRK-GAI-TABLE.
      ***  03  WRK-GAI-TBL                             OCCURS   10.
           03  WRK-GAI-TBL                             OCCURS   14.
             04  WRK-GAI-T                             OCCURS   10.
               05  WRK-GAI-DAY                         PIC 9(02).
               05  WRK-GAI-ZAITEN                      PIC 9(08).
               05  WRK-GAI-ZAIKAISU                    PIC 9(04).
               05  WRK-GAI-KAISU-T.
                06  WRK-GAI-KAISU-OCC                  OCCURS   31.
                 07  WRK-GAI-KAISU                     PIC 9(01).
      *
       01  WRK-GAI-TABLE2.
           03  WRK-GAI-T2                              OCCURS   20.
               05  WRK-GAI2-DAY                        PIC 9(02).
               05  WRK-GAI2-SRYCD.
                   07  WRK-GAI2-SRYCD-9                PIC 9(09).
               05  WRK-GAI2-ZAITEN                     PIC 9(08).
               05  WRK-GAI2-ZAIKAISU                   PIC 9(04).
               05  WRK-GAI2-SRYKBNFLG                  PIC 9(01).
               05  WRK-GAI2-KAISU-T.
                06  WRK-GAI2-KAISU-OCC                 OCCURS   31.
                 07  WRK-GAI2-KAISU                    PIC 9(01).
      *
       01  WRK-GAI-DATA                                PIC X(55).
      *
       01  WRK-SKJ-TABLE.
           03  WRK-SKJ-T                               OCCURS   31.
               05  WRK-SKJ-ZAITEN                      PIC 9(08).
               05  WRK-SKJ-ZAIKAISU                    PIC 9(04).
               05  WRK-SKJ-SRYCD-T.
                06  WRK-SKJ-SRYCD-OCC                  OCCURS    5.
                 07  WRK-SKJ-SRYCD                     PIC 9(09).
      *
       01  WRK-SKJ-TABLE2.
           03  WRK-SKJ-T2                              OCCURS   31.
               05  WRK-SKJ2-ZAITEN                     PIC 9(08).
               05  WRK-SKJ2-ZAIKAISU                   PIC 9(04).
               05  WRK-SKJ2-MEISAISU                   PIC 9(04).
               05  WRK-SKJ2-SRYCDTOTAL                 PIC 9(14).
               05  WRK-SKJ2-SRYCD-T.
                06  WRK-SKJ2-SRYCD-OCC                 OCCURS    5.
                 07  WRK-SKJ2-SRYCD                    PIC 9(09).
               05  WRK-SKJ2-KAISU-T.
                06  WRK-SKJ2-KAISU-OCC                 OCCURS   31.
                 07  WRK-SKJ2-KAISU                    PIC 9(01).
      *
       01  WRK-SKJ200604-TABLE.
           03  WRK-SKJ200604-T                         OCCURS   10.
             04  WRK-SKJ200604-HKNCOMBI                PIC 9(04).
             04  WRK-SKJ200604-T2                      OCCURS   31.
               05  WRK-SKJ200604-KBN                   PIC 9(01).
               05  WRK-SKJ200604-SRYCDTOTAL            PIC 9(14).
               05  WRK-SKJ200604-MEISAISU              PIC 9(02).
               05  WRK-SKJ200604-SURYOUTOTAL           PIC 9(02).
               05  WRK-SKJ200604-SURYOUTOTALFTN        PIC 9(02).
               05  WRK-SKJ200604-T3                    OCCURS    3.
                   07  WRK-SKJ200604-DAY               PIC 9(04).
               05  WRK-SKJ200604-DAY-KAN               PIC 9(01).
      *
       01  WRK-SKJ-DOJITU-TABLE.
           03  WRK-SKJ-DOJITU-T                        OCCURS   10.
             04  WRK-SKJ-DOJITU-T2                     OCCURS   31.
               05  WRK-SKJ-DOJITU-KBN                  PIC 9(01).
               05  WRK-SKJ-DOJITU-SHOKUDO              PIC 9(04).
               05  WRK-SKJ-DOJITU-ASA                  PIC 9(04).
               05  WRK-SKJ-DOJITU-HIRU                 PIC 9(04).
               05  WRK-SKJ-DOJITU-YORU                 PIC 9(04).
               05  WRK-SKJ-DOJITU-HKNCOMBI             PIC 9(04).
      *
       01  WRK-NYULIFE-TABLE.
           03  WRK-NYULIFE-AREA                        OCCURS   31.
               05  WRK-NYULIFE-KBN                     PIC X(01).
               05  WRK-NYULIFE-SKJFTN-SRYCD            PIC X(09).
               05  WRK-NYULIFE-SKJFTN-MONEY            PIC 9(07).
               05  WRK-NYULIFE-KANFTN-SRYCD            PIC X(09).
               05  WRK-NYULIFE-KANFTN-MONEY            PIC 9(07).
      *
       01  WRK-TENTEKI2-TABLE.
           03  WRK-TENTEKI2-AREA                       OCCURS   10.
             04  WRK-TENTEKI2-HKNCOMBI                 PIC 9(04).
      *
             04  WRK-TENTEKI2-HENKYAKU-AREA.
      *
               05  WRK-TENTEKI2-ZAINUM                 PIC 9(08)
                                                       OCCURS   20.
      *
               05  WRK-TENTEKI2-T-AREA                 OCCURS   31.
                 06  WRK-TENTEKI2-T-MEISAISU           PIC 9(03).
                 06  WRK-TENTEKI2-T-ZAITEN             PIC 9(07).
                 06  WRK-TENTEKI2-T-SRYCDTOTAL         PIC 9(13).
                 06  WRK-TENTEKI2-T-SRYCD-X.
                   07  WRK-TENTEKI2-T-SRYCD-X-OCC      OCCURS    5.
                     08  WRK-TENTEKI2-T-SRYCD            PIC X(09).
                     08  WRK-TENTEKI2-T-COM-MEISAISU     PIC 9(03).
                     08  WRK-TENTEKI2-T-COM-AREA       OCCURS    5.
                         10  WRK-TENTEKI2-T-COM-FLG      PIC X(01).
                         10  WRK-TENTEKI2-T-COM-SRYCD    PIC X(09).
                         10  WRK-TENTEKI2-T-COM-MOJI     PIC X(100).
               05  WRK-TENTEKI2-T-ERRCD                PIC 9(01).
      *
               05  WRK-TENTEKI2-C-AREA                 OCCURS   31.
                 06  WRK-TENTEKI2-C-MEISAISU           PIC 9(03).
                 06  WRK-TENTEKI2-C-ZAITEN             PIC 9(07).
                 06  WRK-TENTEKI2-C-SRYCDTOTAL         PIC 9(13).
                 06  WRK-TENTEKI2-C-SRYCD-X.
                   07  WRK-TENTEKI2-C-SRYCD-X-OCC      OCCURS    5.
                     08  WRK-TENTEKI2-C-SRYCD            PIC X(09).
                     08  WRK-TENTEKI2-C-COM-MEISAISU     PIC 9(03).
                     08  WRK-TENTEKI2-C-COM-AREA       OCCURS    5.
                         10  WRK-TENTEKI2-C-COM-FLG      PIC X(01).
                         10  WRK-TENTEKI2-C-COM-SRYCD    PIC X(09).
                         10  WRK-TENTEKI2-C-COM-MOJI     PIC X(100).
               05  WRK-TENTEKI2-C-ERRCD                PIC 9(01).
      *
       01  WRK-MIJ-TABLE.
           03  WRK-MIJ-T                               OCCURS   10.
             04  WRK-MIJ-HKNCOMBI                      PIC 9(04).
             04  WRK-MIJ-T2                            OCCURS    4.
               05  WRK-MIJ-CNT90                       PIC 9(02).
               05  WRK-MIJ-CNT92                       PIC 9(02).
               05  WRK-MIJ-T3                          OCCURS   31.
                   07  WRK-MIJ-DAY90                   PIC 9(04).
                   07  WRK-MIJ-DAY92                   PIC 9(04).
      *
       01  WRK-ORCSTEN-TABLE.
           03  WRK-ORCSTEN-T                           OCCURS  350.
               05  WRK-ORCSTEN-SRYCD                   PIC X(09).
               05  WRK-ORCSTEN-SURYO                   PIC 9(05)V9(05).
               05  WRK-ORCSTEN-COM-MEI                 PIC X(80).
           03  WRK-ORCSTEN-T2                          OCCURS   31.
               05  WRK-ORCSTEN-DAY                     PIC 9(03).
           03  WRK-ORCSTEN-ZAIKAISU                    PIC 9(04).
      *
      *    医療機関（基本情報）退避用領域
       01  TBL-SYS1001-T.
           03  TBL-SYS1001-OCC     OCCURS  100.
               05  TBL-SYS1001                         PIC X(610).
      *    施設基準情報退避用領域
       01  TBL-SYS1006-T.
           03  TBL-SYS1006-OCC                         OCCURS  100.
               05  TBL-SYS10061                        PIC X(610).
               05  TBL-SYS10062                        PIC X(610).
      *
       01  TBL-DOTANDOKU.
           03  TBL-DOTANDOKU-OCC                       OCCURS  4.
               05  TBL-DOTANDOKU-FLG                   PIC 9(01).
      *
       01  TBL-TOKUSITU.
           03  TBL-TOKUSITU-OCC                        OCCURS  4.
               05  TBL-TOKUSITUFLG                     PIC 9(01).
      *
       01  TBL-TOKATUKAI.
           03  TBL-TOKATUKAI-OCC                       OCCURS   4.
               05  TBL-TOKATUKAIFLG                    PIC  9(01).
      *
       01  TBL-HKNFTNDATA.
           03  TBL-HKNFTNDATA-OCC                      OCCURS   4.
               05  TBL-HKNFTNDATA-JGN                  PIC  9(07).
               05  TBL-HKNFTNDATA-TAF                  PIC  9(07).
      *
               05  TBL-HKNFTNDATA-GAIRAI               PIC  9(07).
               05  TBL-HKNFTNDATA-NYUIN                PIC  9(07).
      *
               05  TBL-HKNFTNDATA-NYUSKJ               PIC  9(07).
      *
               05  TBL-HKNFTNDATA-ZAN                  PIC  9(07).
               05  TBL-HKNFTNDATA-FLG                  PIC  9(01).
      *
               05  TBL-HKNFTNDATA-JGNXXX               PIC  9(07).
      *
       01  TBL-PTTOKKI.
           03  TBL-PTTOKKI-OCC                         OCCURS   5.
               05  TBL-PTTOKKI-NAIYO                   PIC  X(12).
               05  TBL-PTTOKKI-CD                      PIC  X(02).
      *
      *    医療機関（入院基本）退避用領域
       01  TBL-SYS5000-T.
           03  TBL-SYS5000-OCC     OCCURS  100.
               05  TBL-SYS5000                         PIC X(610).
      *
      *    一時領域
       01  WRK-AREA.
           03  WRK-PARA.
               05  WRK-PARA-SRYYM                      PIC X(06).
               05  WRK-PARA-TERMID                     PIC X(16).
               05  WRK-PARA-SYSYMD                     PIC X(08).
               05  WRK-PARA-JOBID                      PIC 9(07).
               05  WRK-PARA-SHELLID                    PIC X(08).
           03  WRK-PARA-HOSPNUM                        PIC 9(02).
      *
           03  WRK-SYS-SRYYMD                          PIC X(08).
      *
           03  WRK-CHK-HKNJANUM                        PIC X(08).
           03  WRK-CHK-HONKZKKBN                       PIC X(01).
           03  WRK-CHK-IDOU                            PIC 9(01).
           03  WRK-CHK-TAISYO                          PIC 9(01).
           03  WRK-CHK-TAISYO2                         PIC 9(01).
           03  WRK-CHK-TOKU75-MAE                      PIC 9(01).
           03  WRK-CHK-CNT                             PIC 9(07).
           03  WRK-CHK-HKNID                           PIC 9(10).
           03  WRK-CHK-HKNNUM                          PIC X(03).
           03  WRK-CHK-ICHIBUGAKU                      PIC 9(07).
           03  WRK-CHK-FTNGAKU                         PIC 9(07).
           03  WRK-CHK-KOHFTNGAKU                      PIC 9(07).
           03  WRK-CHK-KEISAN1                         PIC 9(07).
           03  WRK-CHK-KEISAN2                         PIC 9(07).
           03  WRK-CHK-KINGAKU                         PIC 9(07).
           03  WRK-CHK-KINGAKU2                        PIC 9(07).
           03  WRK-CHK-KINGAKU3                        PIC 9(07).
           03  WRK-CHK-KEIKASOCHIXX                    PIC 9(07).
           03  WRK-CHK-KEIKASOCHI1                     PIC S9(07).
           03  WRK-CHK-KEIKASOCHI2                     PIC S9(07).
           03  WRK-CHK-KEIKASOCHI3                     PIC S9(07).
           03  WRK-CHK-KOKIGAK                         PIC 9(07).
           03  WRK-CHK-KOKIGAK2                        PIC 9(07).
           03  WRK-CHK-KOKIGAK3                        PIC 9(07).
           03  WRK-CHK-KOKIGAK4                        PIC 9(07).
           03  WRK-CHK-KOKIGAK5                        PIC 9(07).
           03  WRK-CHK-KOKIGAK6                        PIC 9(07).
           03  WRK-CHK-KOKIGAK7                        PIC 9(07).
           03  WRK-CHK-KOKIGAK8                        PIC 9(07).
           03  WRK-CHK-KOKIGAK9                        PIC 9(07).
           03  WRK-CHK-KOKIGAK10                       PIC S9(07).
      *
           03  WRK-KEISAN                              PIC 9(07).
           03  WRK-KEISAN1                             PIC 9(07).
           03  WRK-KEISAN2                             PIC 9(07).
           03  WRK-KEISAN3                             PIC 9(07).
           03  WRK-KEISAN9                             PIC 9(07).
           03  WRK-KEISAN-XXX                          PIC 9(07).
           03  WRK-KEISAN-YYY                          PIC 9(07).
           03  WRK-KEISAN-ZZZ                          PIC 9(07).
      *
           03  WRK-JYOGEN41                            PIC 9(09).
      *
           03  WRK-ZENKAKU                             PIC X(80).
           03  WRK-NUM.
               05  WRK-NUM-X                           PIC X(10).
               05  FILLER                              PIC X(70).
           03  WRK-NUM-9                               PIC 9(10). 
           03  WRK-STIDX                               PIC 9(02).
           03  WRK-EDIDX                               PIC 9(02).
           03  WRK-SRYCD-X.
               05  WRK-SRYCD                           PIC 9(09).
           03  WRK-ZAINUM                              PIC 9(08).
           03  WRK-ZAINUM-CNT                          PIC 9(03).
           03  WRK-ZAINUM-CNT2                         PIC 9(03).
           03  WRK-ZAINUM-CNT3                         PIC 9(03).
           03  WRK-RENNUM                              PIC 9(02).
           03  WRK-RENNUM2                             PIC 9(02).
           03  WRK-TANICD                              PIC 9(03).
           03  WRK-TANIMOJISU                          PIC 9(01).
           03  WRK-TANINAME                            PIC X(24).
      *
           03  WRK-SRYSURYO                            PIC 9(05)V9(05).
           03  WRK-SRYSURYO2                           PIC 9(05).
           03  WRK-SRYSURYO3                           PIC 9(05).
           03  WRK-KZI058-TEN                          PIC 9(09)V99.
           03  WRK-KZI058-TANICD                       PIC 9(03).
           03  WRK-KZI058-TANIMOJISU                   PIC 9(01).
           03  WRK-KZI058-TANINAME                     PIC X(24).
      *
           03  WRK-FILMTEN                             PIC 9(07)V9(02).
           03  WRK-FILMTEN2                            PIC 9(07)V9(02).
      *
           03  WRK-PREFNUM                             PIC X(02).
      *
           03  WRK-CHIHOU-KIN                          PIC 9(09).
           03  WRK-CHIHOU-KIN2                         PIC 9(09).
           03  WRK-CHIHOU-KIN3                         PIC 9(09).
           03  WRK-CHIHOU-KIN4                         PIC 9(09).
           03  WRK-CHIHOU-KIN5                         PIC 9(09).
           03  WRK-CHIHOU-KIN6                         PIC 9(09).
      *
           03  WRK-NYUJGNGAK                           PIC 9(07).
           03  WRK-NYUJGNGAK2                          PIC 9(07).
      *
           03  WRK-TOKKI                               PIC X(02).
           03  TOKKI-IDX                               PIC 9(02). 
           03  TOKKI-IDX2                              PIC 9(02).
      *
           03  WRK-SRYYM-5000                          PIC X(06).
      *
           03  WRK-SYS5000-COUNT                       PIC 9(02).
      *
           03  WRK-HYOKETU-TEN                         PIC 9(09)V99.
           03  WRK-HYOKETU-SRYCD                       PIC 9(09).
           03  WRK-KSN-SRYCD                           PIC 9(09).
      *
           03  WRK-NYUTENTTLKBN                        PIC 9(03).
      *
           03  WRK-KHNTEN                              PIC 9(08).
           03  WRK-KSNTEN                              PIC S9(08).
           03  WRK-SENTEI-KHNTEN                       PIC 9(08).
           03  WRK-SENTEI-ZAITEN                       PIC 9(08).
           03  WRK-SENTEI-ZAITEN-W                     PIC 9(08).       
           03  WRK-SENTEI-SRYCD                        PIC 9(09).       
           03  WRK-SENTEI-SRYCD2                       PIC 9(09).       
           03  WRK-SENTEI-SRYCD-W                      PIC 9(09).       
           03  WRK-SENTEI-SRYCD2-W                     PIC 9(09).       
           03  WRK-SENTEI-KEISU                        PIC 9V99.
           03  WRK-GAIHAKU-SRYCD                       PIC X(09).
           03  WRK-GAIHAKU-KHNTEN                      PIC 9(08).
           03  WRK-NYUKHNKSNKBN                        PIC 9(03).
           03  WRK-SHOKUJIRYOYO-OCC.
               05  WRK-SHOKUJIRYOYO                    PIC 9(01)
                                                       OCCURS 31.
           03  WRK-TOKUKANRIKASAN-OCC.
               05  WRK-TOKUKANRIKASAN                  PIC 9(01)
                                                       OCCURS 31.
           03  WRK-SYS-MIJISI-T.
             04  WRK-SYS-MIJISI-OCC                    OCCURS  4.
               05  WRK-SYS-MIJISI                      PIC 9(01).
               05  WRK-SYS-MIJISI-FLG                  PIC 9(01)
                                                       OCCURS 31.
               05  WRK-SYS-MIJISI-ZAITEN               PIC 9(08).
      *
           03  WRK-SKJ-FTN-T.
             04  WRK-SKJ-FTN-OCC                       OCCURS  5.
               05  WRK-SKJ-FTN                         PIC 9(07).
      *
           03  WRK-SISETU613                           PIC 9(01).
           03  WRK-SISETU695                           PIC 9(01).
      *
           03  WRK-TOKUSYU-SKJFLG-T.
             04  WRK-TOKUSYU-SKJFLG-OCC                OCCURS  4.
               05  WRK-TOKUSYU-SKJFLG                  PIC 9(01).
               05  WRK-TOKUSYU-SKJFLG2                 PIC 9(01).
      *
           03  WRK-KOGAKU-TAISYOGAI-T.
             04  WRK-KOGAKU-TAISYOGAI-OCC              OCCURS  4.
               05  WRK-KOGAKU-TAISYOGAI                PIC 9(01).
      *
      *    1桁目:生保 2桁目:結核 3桁目:精神
           03  WRK-3SYU-KBN.
               05  WRK-3SYU        PIC X(03).
      *
      *    数字半角全角変換用     
           03  WRK-CHAR-IDX                    PIC 9(02).
           03  WRK-CHAR-HENKAN-AREA.
               05  WRK-CHAR-X                  PIC X(20).
               05  WRK-CHAR-N                  PIC X(40).
               05  WRK-CHAR-CNT                PIC 9(02).
               05  WRK-CHAR-N-CNT              PIC 9(02).
      *     
      *    単価編集用     
           03  WRK-TANKA                       PIC 9(09)V9(02).
           03  WRK-TANKA-R  REDEFINES  WRK-TANKA.
               05  WRK-TANKA-S1                PIC 9(09).
               05  WRK-TANKA-S2                PIC 9(02).
           03  WRK-TANKA-X.
               05  WRK-TANKA-Z1                PIC ZZZZZZZZ9.
               05  WRK-TANKA-Z2                PIC X(01).
               05  WRK-TANKA-Z3                PIC ZZ.
      *
      ***  03  WRK-FUKA-KINGAKU                PIC 9(09).
           03  WRK-FUKA-KINGAKU                PIC 9(13)V9(05).
           03  WRK-FUKA-VALUE                  PIC 9(01).
      *
           03  WRK-BIRTHDAY                    PIC X(08).
      *
           03  WK-GENGAKUKBN                   PIC  9(01).
           03  WK-GENGAKU-KOHID                PIC  9(10).
           03  WK-GENGAKU-RITU                 PIC  9(03).
           03  WK-GENGAKU-RITUX                PIC  9(03).
           03  WK-GENGAKU-KIN                  PIC  9(07).
           03  WK-GENGAKU-KTKBN                PIC  9(01).
      *
           03  WK-GENGAKU-YMD.
               05  WK-GENGAKU-YM               PIC  9(06).
               05  WK-GENGAKU-DD               PIC  9(02).
           03  WK-GENGAKU2-YMD.
               05  WK-GENGAKU2-YM              PIC  9(06).
               05  WK-GENGAKU2-DD              PIC  9(02).
           03  WK-GENGAKU3-YMD.
               05  WK-GENGAKU3-YM              PIC  9(06).
               05  WK-GENGAKU3-DD              PIC  9(02).
      *
           03  WRK-TENTEKI2-SRYCD-X.
               05  WRK-TENTEKI2-SRYCD-X-OCC        OCCURS    5.
                 06  WRK-TENTEKI2-SRYCD            PIC X(09).
                 06  WRK-TENTEKI2-COM-MEISAISU     PIC 9(03).
                 06  WRK-TENTEKI2-COM-AREA         OCCURS    5.
                     08  WRK-TENTEKI2-COM-FLG      PIC X(01).
                     08  WRK-TENTEKI2-COM-SRYCD    PIC X(09).
                     08  WRK-TENTEKI2-COM-MOJI     PIC X(100).
      *
           03  WRK-TENTEKI2-SRYCD2-X.
               05  WRK-TENTEKI2-SRYCD2-X-OCC       OCCURS  100.
                 06  WRK-TENTEKI2-SRYCD2           PIC X(09).
                 06  WRK-TENTEKI2-COM-FLG2         PIC X(01).
                 06  WRK-TENTEKI2-COM-MOJI2        PIC X(100).
      *
           03  WRK-GEN70-YMD.
               05  WRK-GEN70-YM                PIC  9(06).
               05  WRK-GEN70-DD                PIC  9(02).
      *
           03  WRK-GEN702-YMD.
               05  WRK-GEN702-YM               PIC  9(06).
               05  WRK-GEN702-DD               PIC  9(02).
      *
           03  WRK-KOHYONKAIME-YMD.
               05  WRK-KOHYONKAIME-YM          PIC  9(06).
               05  WRK-KOHYONKAIME-DD          PIC  9(02).
      *
           03  WRK-KOH-GENDOGAKU               PIC  9(07).
           03  WRK-GEN70-GENDOGAKU             PIC  9(07).
           03  WRK-SEIHO-GENDO                 PIC  9(07).
           03  WRK-SEIHO-GENDO70               PIC  9(07).
           03  WRK-CYOKI-GENDO                 PIC  9(07).
           03  WRK-CYOKI-GENDO2                PIC  9(07).
           03  WRK-JYOGEN-KOH                  PIC  9(07).
           03  WRK-JYOGEN-KOH2                 PIC  9(07).
           03  WRK-JIRITU-TAFTNRUIKEI          PIC  9(07).
           03  WRK-JIRITU-CYUKANSOU            PIC  9(01).
           03  WRK-KOUREI-IRYOHI70             PIC  9(09).
           03  WRK-KOUREI-IRYOHI70X            PIC  9(09).
           03  WRK-FTNKEI-KOH                  PIC  9(07).
           03  WRK-TAIHI-GENKIN2               PIC  9(07).
           03  WRK-TAIHI-GENKIN3               PIC  9(07).
           03  WRK-TAIHI-GENKIN-TBL.
              05  WRK-TAIHI-GENKIN-OCC         OCCURS   4.
                07  WRK-TAIHI-GENKIN           PIC  9(07).
                07  WRK-TAIHI-GENKIN-EN        PIC  9(07).
      *
           03  WRK-FORMALNAME                  PIC  X(300).
      *
           03  WRK-HOKENICHIBUGAK              PIC  9(07).
      *
           03  WRK-KOHCNT                      PIC  9(01).
      *
           03  WRK-HANTEI-TOTALTEN             PIC  9(09).
      *
           03  WRK-STR                         PIC  X(200).
           03  WRK-LEN                         PIC  9(05).
           03  WRK-SHO                         PIC  9(05).
           03  WRK-AMARI                       PIC  9(05).
      *
           03  WRK-TOKU75-BIRTHDAY             PIC  X(08).
      *
           03  WRK-KINGAKU-TOK1                PIC  9(07).
      *
           03  WRK-KINGAKU-TOK3                PIC  9(07).
           03  WRK-KINGAKU-TOK4                PIC  9(07).
           03  WRK-KINGAKU-TOK5                PIC  9(07).
      *
           03  WRK-KINGAKU-TOK7                PIC  9(07).
           03  WRK-KINGAKU-TOK8                PIC  9(07).
           03  WRK-KINGAKU-TOK9                PIC  9(07).
      *
           03  WRK-HKNFTNDATA-RUI              PIC  9(07).
      *
           03  WRK-EDYMD                       PIC  X(08).
      *
           03  WRK-KOH-KINGAKU                 PIC  9(07).
      *
           03  WRK-SAIGAI-DD                   PIC  9(02).
      *
           03  WRK-GENMEN-NASI-KIN             PIC  9(07).
           03  WRK-GENMEN-NASI-SKJ             PIC  9(07).
           03  WRK-GENMEN-NASI-KIN2            PIC  9(07).
           03  WRK-GENMEN-NASI-SKJ2            PIC  9(07).
      *
           03  WRK-JIRITU-SAIKEI               PIC  9(09).
           03  WRK-JIRITU-SAIKEI2              PIC  9(09).
      *
      *    数量編集用
           03  WRK-SURYOKETA                   PIC 9(02).
           03  WRK-SURYOKETA1                  PIC 9(02).
           03  WRK-SURYOKETA2                  PIC 9(02).
           03  WRK-SURYOST                     PIC 9(02).
           03  WRK-SURYO                       PIC 9(05)V9(05).
           03  WRK-SURYO-R  REDEFINES  WRK-SURYO.
               05  WRK-SURYO-S1                PIC 9(05).
               05  WRK-SURYO-S2                PIC 9(05).
           03  WRK-SURYO-X.
               05  WRK-SURYO-Z1                PIC ZZZZZ.
               05  WRK-SURYO-Z2                PIC X(01).
               05  WRK-SURYO-Z3                PIC ZZZZZ.
           03  WRK-SURYO-N.
               05  WRK-SURYO-N1                PIC X(10).
               05  WRK-SURYO-N2                PIC X(02).
               05  WRK-SURYO-N3                PIC X(10).
           03  WRK-SRYSURYOW                   PIC X(24).
      *
           03  WRK-SETCOM-JIDO                 PIC 9(03).
           03  WRK-SETCOM-JIDO2                PIC 9(03).
      *
           03  WRK-ZEROKISAIFLG                PIC X(01).
      *
           03  WRK-FTNMONEY-MAE                PIC 9(09).
      *
           03  WRK-CYOKI-KEISAN                PIC 9(09).
           03  WRK-CYOKI-KEISAN2               PIC 9(09).
           03  WRK-CYOKI-KEISAN3               PIC 9(09).
      *
       01  WRK-ERR-AREA.
           03  WRK-RECEERR                         PIC X(200).
           03  WRK-ERRMSG                          PIC X(300).
           03  WRK-MCP-RC                          PIC 9(9).
           03  WRK-ERR-FILE-STS                    PIC X(02).
           03  WRK-ERR-FILE-MSG                    PIC X(100).
           03  WRK-ERR-FILE-MSG1                   PIC X(17).
           03  WRK-ERR-FLG                         PIC 9(01).
      *    エラーファイル名称領域 
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1PARA//
                                   BY         //WRK-ERR-FILE-NM//.
      *
      *    固定値
       01  CONST-AREA.
      *    フリーコメント
           03  CONS-COMMENT    PIC X(09)   VALUE   "810000001".
      *    薬剤料逓減（９０／１００）（内服薬）
           03  CONS-YAKTEIGEN  PIC X(09)   VALUE   "630010002".
      *    粉砕（コメント）
           03  CONS-FUNSAI-COMMENT PIC X(09) VALUE "099209901".
      *    採血（Ｂ−Ａ）
           03  CONS-SAIKETSU1      PIC X(09) VALUE "160101210".
      *    採血（Ｂ−Ｖ）
           03  CONS-SAIKETSU2      PIC X(09) VALUE "160095710".
      *    採血（Ｂ−Ｃ）
           03  CONS-SAIKETSU3      PIC X(09) VALUE "160095810".
      *    特記事項
           03  CONS-TOKKI1         PIC X(14) VALUE "00000099990101".
           03  CONS-TOKKI2         PIC X(14) VALUE "00000099990102".
           03  CONS-TOKKI3         PIC X(14) VALUE "00000099990103".
           03  CONS-TOKKI4         PIC X(14) VALUE "00000099990104".
           03  CONS-TOKKI5         PIC X(14) VALUE "00000099990105".
           03  CONS-TOKKI7         PIC X(14) VALUE "00000099990107".
           03  CONS-TOKKI8         PIC X(14) VALUE "00000099990108".
           03  CONS-TOKKI9         PIC X(14) VALUE "00000099990109".
           03  CONS-TOKKI10        PIC X(14) VALUE "00000099990110".
           03  CONS-TOKKI11        PIC X(14) VALUE "00000099990111".
           03  CONS-TOKKI12        PIC X(14) VALUE "00000099990112".
           03  CONS-TOKKI13        PIC X(14) VALUE "00000099990113".
           03  CONS-TOKKI14        PIC X(14) VALUE "00000099990114".
           03  CONS-TOKKI15        PIC X(14) VALUE "00000099990115".
           03  CONS-TOKKI16        PIC X(14) VALUE "00000099990116".
           03  CONS-TOKKI17        PIC X(14) VALUE "00000099990117".
           03  CONS-TOKKI18        PIC X(14) VALUE "00000099990118".
           03  CONS-TOKKI19        PIC X(14) VALUE "00000099990119".
           03  CONS-TOKKI20        PIC X(14) VALUE "00000099990120".
           03  CONS-TOKKI21        PIC X(14) VALUE "00000099990121".
           03  CONS-TOKKI22        PIC X(14) VALUE "00000099990122".
           03  CONS-TOKKI23        PIC X(14) VALUE "00000099990123".
           03  CONS-TOKKI24        PIC X(14) VALUE "00000099990124".
           03  CONS-TOKKI25        PIC X(14) VALUE "00000099990125".
      *
      *    病床数編集フラグ編集の為のコード（特定疾患療養指導料等）
           03  CONS-SIDORYO1       PIC X(09) VALUE "113001810".
           03  CONS-SIDORYO2       PIC X(09) VALUE "113001910".
           03  CONS-SIDORYO3       PIC X(09) VALUE "113002010".
           03  CONS-SIDORYO4       PIC X(09) VALUE "113700610".
           03  CONS-SIDORYO5       PIC X(09) VALUE "113700710".
           03  CONS-SIDORYO6       PIC X(09) VALUE "113700810".
      *
      *    在支援フラグ編集の為のコード
           03  CONS-ZAISIEN1       PIC X(09) VALUE "114011570".
           03  CONS-ZAISIEN2       PIC X(09) VALUE "114011670".
           03  CONS-ZAISIEN3       PIC X(09) VALUE "114011770".
      *
      *    フィルム料（乳幼児）加算
           03  CONS-FILM-YOUJI-KASAN  
                                   PIC X(09) VALUE "799990070".
      *    酸素補正率
           03  CONS-SANSO          PIC X(09) VALUE "770020070".
      *    高気圧酸素加算
           03  CONS-SANSO2         PIC X(09) VALUE "770030070".
      *    残量廃棄
           03  CONS-ZANHAIKI       PIC X(09) VALUE "099309901".
      *
      *    薬剤管理指導料
           03  CONS-YAKUKAN-COMMENT1 PIC X(09)  VALUE  "113010710".
           03  CONS-YAKUKAN-COMMENT2 PIC X(09)  VALUE  "113010810".
           03  CONS-YAKUKAN-COMMENT3 PIC X(09)  VALUE  "120001610".
      *    入院栄養食事指導料
           03  CONS-NYUEIYO-COMMENT  PIC X(09)  VALUE  "113003310".
      *    退院前訪問指導料
           03  CONS-HOUMON-COMMENT1  PIC X(09)  VALUE  "190030310".
      *    （老）退院前訪問指導料
           03  CONS-HOUMON-COMMENT2  PIC X(09)  VALUE  "190723610".
      *    退院前訪問指導料算定日
           03  CONS-HOUMON-COMMENT3  PIC X(09)  VALUE  "840000055".
      *    傷病手当金意見書交付料
           03  CONS-SYOBYO-COMMENT   PIC X(09)  VALUE  "180000710".
      *    傷病手当金意見書交付年月日
           03  CONS-SYOBYO2-COMMENT  PIC X(09)  VALUE  "840000011".
      *    （相続）傷病手当金意見書交付年月日
           03  CONS-SYOBYO3-COMMENT  PIC X(09)  VALUE  "840000012".
      *    療養費同意書交付料
           03  CONS-RYOYO-COMMENT    PIC X(09)  VALUE  "113004310".
      *    療養費同意書交付年月日
           03  CONS-RYOYO2-COMMENT   PIC X(09)  VALUE  "840000078".
      *    退院時服薬指導加算
           03  CONS-TAIIN-COMMENT    PIC X(09)  VALUE  "113006270".
      *    訪問看護指示料
           03  CONS-HOUSIJI-COMMENT  PIC X(09)  VALUE  "114008010".
      *    訪問看護指示料算定日
           03  CONS-HOUSIJI2-COMMENT PIC X(09)  VALUE  "840000073".
      *    手術日コメント
           03  CONS-SHUJUTU-COMMENT  PIC X(09)  VALUE  "840000042".
      *    頭部単純ＣＴ撮影
           03  CONS-CTMRI-COMMENT1   PIC X(09)  VALUE  "170011710".
      *    躯幹単純ＣＴ撮影
           03  CONS-CTMRI-COMMENT2   PIC X(09)  VALUE  "170011810".
      *    四肢単純ＣＴ撮影
           03  CONS-CTMRI-COMMENT3   PIC X(09)  VALUE  "170011910".
      *    脳槽ＣＴ造影
           03  CONS-CTMRI-COMMENT4   PIC X(09)  VALUE  "170012110".
      *    頸部単純ＣＴ撮影
           03  CONS-CTMRI-COMMENT5   PIC X(09)  VALUE  "170015550".
      *    頭部単純ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT6   PIC X(09)  VALUE  "170015210".
      *    躯幹単純ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT7   PIC X(09)  VALUE  "170020110".
      *    四肢単純ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT8   PIC X(09)  VALUE  "170022110".
      *    ＣＴ、ＭＲＩ（頭部）（２回目以降）
           03  CONS-CTMRI-COMMENT9   PIC X(09)  VALUE  "170022290".
      *    ＣＴ、ＭＲＩ（躯幹）（２回目以降）
           03  CONS-CTMRI-COMMENT10  PIC X(09)  VALUE  "170022390".
      *    ＣＴ、ＭＲＩ（四肢）（２回目以降）
           03  CONS-CTMRI-COMMENT11  PIC X(09)  VALUE  "170022490".
      *    頭部特殊ＣＴ撮影
           03  CONS-CTMRI-COMMENT12  PIC X(09)  VALUE  "170023010".
      *    躯幹特殊ＣＴ撮影
           03  CONS-CTMRI-COMMENT13  PIC X(09)  VALUE  "170023110".
      *    四肢特殊ＣＴ撮影
           03  CONS-CTMRI-COMMENT14  PIC X(09)  VALUE  "170023210".
      *    頭部特殊ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT15  PIC X(09)  VALUE  "170023310".
      *    躯幹特殊ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT16  PIC X(09)  VALUE  "170023410".
      *    四肢特殊ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT17  PIC X(09)  VALUE  "170023510".
      *    ＣＴ撮影（１６列未満マルチスライス型機器）
           03  CONS-CTMRI-COMMENT18  PIC X(09)  VALUE  "170028610".
      *    精神科退院前訪問指導料
           03  CONS-HOUSEI-COMMENT   PIC X(09)  VALUE  "180018310".
      *    精神科退院前訪問指導料算定日
           03  CONS-HOUSEI-COMMENT2  PIC X(09)  VALUE  "840000079".
      *    精神科隔離病室管理加算
           03  CONS-KAKURI-COMMENT   PIC X(09)  VALUE  "190107070".
      *    在宅血液透析頻回指導管理料
           03  CONS-HINKAI-COMMENT   PIC X(09)  VALUE  "114009410".
      *    初診（同日複数診療科）
           03  CONS-SYODOU-COMMENT   PIC X(09)  VALUE  "111011810".
      *    複初算定診療科：
           03  CONS-SYODOU2-COMMENT  PIC X(09)  VALUE  "830000024".
      *    心大血管疾患リハビリテーション料（１）
           03  CONS-SINDAI1-COMMENT  PIC X(09)  VALUE  "180027410".
      *    心大血管疾患リハビリテーション料（２）
           03  CONS-SINDAI2-COMMENT  PIC X(09)  VALUE  "180027510".
      **   心大血管疾患リハビリテーション料（１）（１２０日超）
           03  CONS-SINDAI3-COMMENT  PIC X(09)  VALUE  "180029110".
      **   心大血管疾患リハビリテーション料（２）（１２０日超）
           03  CONS-SINDAI4-COMMENT  PIC X(09)  VALUE  "180029210".
      **   心大血管疾患リハビリテーション医学管理料（１）
           03  CONS-SINDAI5-COMMENT  PIC X(09)  VALUE  "180029910".
      **   心大血管疾患リハビリテーション医学管理料（２）
           03  CONS-SINDAI6-COMMENT  PIC X(09)  VALUE  "180030010".
      *    呼吸器リハビリテーション料（１）
           03  CONS-KOKYUKI1-COMMENT PIC X(09)  VALUE  "180028010".
      *    呼吸器リハビリテーション料（２）
           03  CONS-KOKYUKI2-COMMENT PIC X(09)  VALUE  "180028110".
      **   呼吸器リハビリテーション料（１）（８０日超）
           03  CONS-KOKYUKI3-COMMENT PIC X(09)  VALUE  "180029710".
      **   呼吸器リハビリテーション料（２）（８０日超）
           03  CONS-KOKYUKI4-COMMENT PIC X(09)  VALUE  "180029810".
      **   呼吸器リハビリテーション医学管理料（１）
           03  CONS-KOKYUKI5-COMMENT PIC X(09)  VALUE  "180030510".
      **   呼吸器リハビリテーション医学管理料（２）
           03  CONS-KOKYUKI6-COMMENT PIC X(09)  VALUE  "180030610".
      *    脳血管疾患等リハビリテーション料（１）
           03  CONS-NOUKE1-COMMENT   PIC X(09)  VALUE  "180027610".
      *    脳血管疾患等リハビリテーション料（２）
           03  CONS-NOUKE2-COMMENT   PIC X(09)  VALUE  "180027710".
      **   脳血管疾患等リハビリテーション料（１）（１４０日超）
           03  CONS-NOUKE3-COMMENT   PIC X(09)  VALUE  "180029310".
      **   脳血管疾患等リハビリテーション料（２）（１４０日超）
           03  CONS-NOUKE4-COMMENT   PIC X(09)  VALUE  "180029410".
      **   脳血管疾患等リハビリテーション医学管理料（１）
           03  CONS-NOUKE5-COMMENT   PIC X(09)  VALUE  "180030110".
      **   脳血管疾患等リハビリテーション医学管理料（２）
           03  CONS-NOUKE6-COMMENT   PIC X(09)  VALUE  "180030210".
      *    脳血管疾患等リハビリテーション料（３）
           03  CONS-NOUKE7-COMMENT   PIC X(09)  VALUE  "180030810".
      *    脳血管疾患等リハビリテーション料（１）（廃用症候群）
           03  CONS-NOUKE8-COMMENT   PIC X(09)  VALUE  "180032410".
      *    脳血管疾患等リハビリテーション料（２）（廃用症候群）
           03  CONS-NOUKE9-COMMENT   PIC X(09)  VALUE  "180032510".
      *    脳血管疾患等リハビリテーション料（３）（廃用症候群）
           03  CONS-NOUKE10-COMMENT  PIC X(09)  VALUE  "180032610".
      *    運動器リハビリテーション料（１）
           03  CONS-UNDOKI1-COMMENT  PIC X(09)  VALUE  "180027810".
      *    運動器リハビリテーション料（２）
           03  CONS-UNDOKI2-COMMENT  PIC X(09)  VALUE  "180027910".
      **   運動器リハビリテーション料（１）（１２０日超）
           03  CONS-UNDOKI3-COMMENT  PIC X(09)  VALUE  "180029510".
      **   運動器リハビリテーション料（２）（１２０日超）
           03  CONS-UNDOKI4-COMMENT  PIC X(09)  VALUE  "180029610".
      **   運動器リハビリテーション医学管理料（１）
           03  CONS-UNDOKI5-COMMENT  PIC X(09)  VALUE  "180030310".
      **   運動器リハビリテーション医学管理料（２）
           03  CONS-UNDOKI6-COMMENT  PIC X(09)  VALUE  "180030410".
      *    運動器リハビリテーション料（１）
           03  CONS-UNDOKI7-COMMENT  PIC X(09)  VALUE  "180032710".
      *    難病患者リハビリテーション料
           03  CONS-NANBYO-COMMENT   PIC X(09)  VALUE  "180017910".
      *    障害児（者）リハビリテーション料（６歳未満）
           03  CONS-SYOGAI1-COMMENT  PIC X(09)  VALUE  "180028210".
      *    障害児（者）リハビリテーション料（６歳以上１８歳未満）
           03  CONS-SYOGAI2-COMMENT  PIC X(09)  VALUE  "180028310".
      *    障害児（者）リハビリテーション料（１８歳以上）
           03  CONS-SYOGAI3-COMMENT  PIC X(09)  VALUE  "180028410".
      *    摂食機能療法
           03  CONS-SESSYOKU-COMMENT PIC X(09)  VALUE  "180016610".
      *    がん患者リハビリテーション料
           03  CONS-GANKNJ-COMMENT   PIC X(09)  VALUE  "180033110".
      *    介達牽引
           03  CONS-KAITATU-COMMENT  PIC X(09)  VALUE  "140048010".
      *    往診
           03  CONS-OSIN-COMMENT     PIC X(09)  VALUE  "114000110".
      *    特別往診
           03  CONS-OSIN2-COMMENT    PIC X(09)  VALUE  "114001610".
      *    往診日コメント
           03  CONS-OSIN3-COMMENT    PIC X(09)  VALUE  "840000039".
      *
      *    ＢＮＰ精密
           03  CONS-KENSA1-COMMENT   PIC X(09)  VALUE  "160162350".
      *    ＮＴ−ｐｒｏＢＮＰ精密
           03  CONS-KENSA2-COMMENT   PIC X(09)  VALUE  "160181250".
      *    ＨＡＮＰ精密
           03  CONS-KENSA3-COMMENT   PIC X(09)  VALUE  "160116310".
      *
      *    介護支援連携指導料
           03  CONS-KAISIEN-COMMENT  PIC X(09)  VALUE  "113011710".
      *    集団栄養食事指導料
           03  CONS-SYUEIYO-COMMENT  PIC X(09)  VALUE  "113003410".
      *    人工腎臓（その他）
           03  CONS-JINZOU1-COMMENT  PIC X(09)  VALUE  "140007710".
      *    人工腎臓（慢性維持透析）（４時間未満）
           03  CONS-JINZOU2-COMMENT  PIC X(09)  VALUE  "140036710".
      *    人工腎臓（慢性維持透析）（４時間以上５時間未満）
           03  CONS-JINZOU3-COMMENT  PIC X(09)  VALUE  "140051010".
      *    人工腎臓（慢性維持透析）（５時間以上）
           03  CONS-JINZOU4-COMMENT  PIC X(09)  VALUE  "140051110".
      *    連続携行式腹膜かん流
           03  CONS-JINZOU5-COMMENT  PIC X(09)  VALUE  "140008510".
      *    持続緩徐式血液濾過
           03  CONS-JINZOU6-COMMENT  PIC X(09)  VALUE  "140029850".
      *    血漿交換療法
           03  CONS-JINZOU7-COMMENT  PIC X(09)  VALUE  "140008210".
      *    血球成分除去療法
           03  CONS-JINZOU8-COMMENT  PIC X(09)  VALUE  "140039210".
      *    局所陰圧閉鎖処置（その他）
           03  CONS-KYOKUIN1-COMMENT PIC X(09)  VALUE  "140052410".
      *    局所陰圧閉鎖処置（被覆材貼付）（１００ｃｍ２未満）
           03  CONS-KYOKUIN2-COMMENT PIC X(09)  VALUE  "140051810".
      *    局所陰圧閉鎖処置（被覆材貼付）（１００ｃｍ２〜２００ｃｍ２未満）
           03  CONS-KYOKUIN3-COMMENT PIC X(09)  VALUE  "140051910".
      *    局所陰圧閉鎖処置（被覆材貼付）（２００ｃｍ２以上）
           03  CONS-KYOKUIN4-COMMENT PIC X(09)  VALUE  "140052010".
      *    栄養サポートチーム加算
           03  CONS-EISAPO-COMMENT   PIC X(09)  VALUE  "190136810".
      *    呼吸ケアチーム加算
           03  CONS-KOKKEA-COMMENT   PIC X(09)  VALUE  "190137910".
      *    重症者加算（精神療養病棟入院料）
           03  CONS-JYUSYO-COMMENT   PIC X(09)  VALUE  "190141370".
      *
      *    外来迅速検体検査加算
           03  CONS-GAIJINKEN        PIC X(09)  VALUE  "160177770".
      *
      *    老人理学療法の摘要欄記載判定用（名称に老人を追加）
           03  CONS-RJNRIGAKU1     PIC X(09) VALUE "180706810".
           03  CONS-RJNRIGAKU2     PIC X(09) VALUE "180706910".
           03  CONS-RJNRIGAKU3     PIC X(09) VALUE "180707010".
           03  CONS-RJNRIGAKU4     PIC X(09) VALUE "180707110".
           03  CONS-RJNRIGAKU5     PIC X(09) VALUE "180707210".
           03  CONS-RJNRIGAKU6     PIC X(09) VALUE "180707310".
           03  CONS-RJNRIGAKU7     PIC X(09) VALUE "180707410".
           03  CONS-RJNRIGAKU8     PIC X(09) VALUE "180707510".
      *
      *    剤の診療内容チェックテーブル
       01  TBL-ZAICHECK-AREA.
      *    （サ）
           03  FILLER          PIC X(09)   VALUE    "820000046".
      *    （検選）
           03  FILLER          PIC X(09)   VALUE    "820000053".
      *    （リハ選）
           03  FILLER          PIC X(09)   VALUE    "820000054".
      *    （精選）
           03  FILLER          PIC X(09)   VALUE    "820000055".
      *
       01  TBL-ZAICHECK-R      REDEFINES   TBL-ZAICHECK-AREA.
           03  TBL-ZAICHECK    PIC X(09)   OCCURS    4.
      *
       01  TBL-ZAICHECK-MAX    PIC 9(02)   VALUE     4.
      *
      *    減額・免除・支払猶予判定用テーブル
       01  TBL-GENGAKU-AREA.
           03  FILLER          PIC X(03)   VALUE    "960".
           03  FILLER          PIC X(03)   VALUE    "961".
           03  FILLER          PIC X(03)   VALUE    "962".
           03  FILLER          PIC X(03)   VALUE    "963".
      *
       01  TBL-GENGAKU-R       REDEFINES   TBL-GENGAKU-AREA.
           03  TBL-GENGAKU     PIC X(03)   OCCURS    4.
      *
       01  TBL-GENGAKU-MAX     PIC 9(02)   VALUE     4.
      *
      *    ７０歳未満現物給付判定用テーブル
       01  TBL-GENBUTU70-AREA.
           03  FILLER          PIC X(03)   VALUE    "966".
           03  FILLER          PIC X(03)   VALUE    "967".
      *
       01  TBL-GENBUTU70-R     REDEFINES   TBL-GENBUTU70-AREA.
           03  TBL-GENBUTU70   PIC X(03)   OCCURS    2.
      *
       01  TBL-GENBUTU70-MAX   PIC 9(02)   VALUE     2.
      *
      *    特定疾患等判定用テーブル（上位）
       01  TBL-TOKUJYOI-AREA.
           03  FILLER          PIC X(03)   VALUE    "966".
           03  FILLER          PIC X(03)   VALUE    "956".
      *
       01  TBL-TOKUJYOI-R      REDEFINES   TBL-TOKUJYOI-AREA.
           03  TBL-TOKUJYOI    PIC X(03)   OCCURS    2.
      *
       01  TBL-TOKUJYOI-MAX    PIC 9(02)   VALUE     2.
      *
      *    特定疾患等判定用テーブル（一般・低）
       01  TBL-TOKUIPAN-AREA.
           03  FILLER          PIC X(03)   VALUE    "967".
           03  FILLER          PIC X(03)   VALUE    "957".
      *
       01  TBL-TOKUIPAN-R      REDEFINES   TBL-TOKUIPAN-AREA.
           03  TBL-TOKUIPAN    PIC X(03)   OCCURS    2.
      *
       01  TBL-TOKUIPAN-MAX    PIC 9(02)   VALUE     2.
      *
      *    酸素 
           COPY    "CMSANSOTBL.INC".
      *
      *   日本語数字
       01  TBL-SUJI-AREA.
           03  FILLER          PIC X(20)   VALUE
              "１２３４５６７８９０".
       01  TBL-SUJI-R          REDEFINES   TBL-SUJI-AREA.
           03  TBL-SUJI        PIC X(02)   OCCURS   10.
       01  TBL-SUJI-AREA-X.
           03  FILLER          PIC X(10)   VALUE
              "1234567890".
       01  TBL-SUJI-X-R        REDEFINES   TBL-SUJI-AREA-X.
           03  TBL-SUJI-X      PIC X(01)   OCCURS   10.
      *
      *
       01  WRK-CONS-AREA.    
      *    固定端末ＩＤ
           03  WRK-CONS-TERMID     PIC X(64)   VALUE
                                   "0100007FZZZZZZZZZZZZZZZZZZZZZZZZ". 
      * 
           03  WRK-CONS-SRYYM-200604  PIC 9(06)   VALUE   200604. 
      *
           COPY    "MCPAREA".
      *
           COPY    "COMMON-SPA".
      *
      *    点数マスタ退避ワーク
           COPY    "CPTTNS.INC".
      *
       01  WRK-RECE62-REC. 
           COPY    "CPRCF062.INC"  REPLACING  //RECE62//
                                   BY         //WRK-RECE62//.
      *
       01  WRK-RECE62G-REC. 
           COPY    "CPRCF062.INC"  REPLACING  //RECE62//
                                   BY         //WRK-RECE62G//.
      *
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    ジョブ管理マスタ
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *    診療会計
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    診療行為
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    入院会計
       01  NYUINACCT-REC.
           COPY    "CPNYUINACCT.INC".
      *
      *    入院診療行為
       01  NYUINACT-REC.
           COPY    "CPNYUINACT.INC".
      *
      *    点数
           COPY    "CPTENSU.INC".
      *
      *    収納
       01  SYUNOU-REC.
           COPY    "CPSYUNOU.INC".
      *
      *    システム管理
           COPY    "CPSYSKANRI.INC".
      *    
           COPY    "CPSK1001.INC".
           COPY    "CPSK1006.INC".
      *    
           COPY    "CPSK2005.INC".
           COPY    "CPSK200501.INC".
      *
           COPY    "CPSK5000.INC".
      *
           COPY    "CPSK2010.INC".
      *    
      *
      *    患者コメント
       01  PTCOM-REC.
       COPY    "CPPTCOM.INC".
      *
      *    選定入院料
       01  SENTEICDCHG-REC.
           COPY    "CPSENTEICDCHG.INC".
      *
      *    保険組み合わせ
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    患者公費情報
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *
      *    診療会計マスタ付加
       01  SRYACCTPLUS-REC.
           COPY    "CPSRYACCTPLUS.INC".
      *
      *****保険番号
      *01  HKNNUM-REC.
      *****COPY    "CPHKNNUM.INC".
      *
      *****************************************************************
      *    サブプロ用領域
      *****************************************************************
      *
      *    半角チェックサブ
           COPY    "CPORCSKANACHK.INC".
      *
      *   日付変換サブ
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    患者番号変換サブ
           COPY    "CPORCSPTID.INC".
      *    数値変換サブ
           COPY    "CPORCSNUM.INC".
      *    チェックディジット（モジュラス１１用）算出サブ
           COPY    "CPORCCHKDGT11.INC".
      *   ジョブ管理ＤＢ制御サブ
           COPY    "CPORCSJOBKANRI.INC".
      *    入院点滴一括更新サブ
           COPY    "CPORCSTENTEK.INC".
      *    公費月上限額取得サブ
           COPY    "CPORCSJGNGET.INC".
      *    高齢者の一部負担金額記載に関するチェックサブ
           COPY    "CPORCSKOREIFTNCHK.INC".
      *    公費付加情報取得サブ
           COPY    "CPORCSKOHPLUS.INC".
      *    入院時生活療養費負担額取得サブ
           COPY    "CPORCSNYULIFE.INC".
      *    入院点滴手技加算まとめサブ
           COPY    "CPORCSTENTEK2.INC".
      *    保険算定用年齢・割合計算サブ
           COPY    "CPORCSAGECHK.INC".
      *    患者自己負担金レセプト記載判定
           COPY    "CPORCSFTNJGNCHK.INC".
      *    特定疾患等算定判定サブ
           COPY    "CPORCSSRHKOH.INC".
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      *     
      *
      ****************************************************************
       LINKAGE                 SECTION.
       01  COMMAND-PARAM.
           02  FILLER      PIC X(256).
      ****************************************************************
       PROCEDURE           DIVISION
               USING
           COMMAND-PARAM.
      *
      *****************************************************************
      *    主処理
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC    UNTIL   FLG-END =   1 
      *
           PERFORM 300-TERM-SEC
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               STOP    RUN
           ELSE
               EXIT    PROGRAM
           END-IF 
           .
      *****************************************************************
      *    初期　処理
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  CNT-AREA
           INITIALIZE                  SPA-AREA
                                       WRK-AREA
                                       TTNS-AREA
                                       FLG-AREA
      *
           MOVE    ZERO                TO  FLG-END
      *
           UNSTRING    COMMAND-PARAM   DELIMITED  BY  ","
                                       INTO    WRK-PARA
                                               WRK-PARA-HOSPNUM
                                               RECEERR
           END-UNSTRING
           MOVE    WRK-PARA-HOSPNUM    TO  SPA-HOSPNUM
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *        ＤＢオープン処理
               PERFORM 100-DBOPEN-SEC
      *
      *        ステップ管理開始処理
               MOVE    "STS"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               MOVE    "ORCR0640"      TO  JOB-PGID
               MOVE    "診療区分別点数集計"
                                       TO  JOB-SHELLMSG
               PERFORM   900-CALL-ORCSJOB-SEC
      *        処理中止設定処理
               PERFORM 500-CANCEL-HENSYU-SEC
           END-IF
      *                             
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
      *       医療機関情報
              INITIALIZE                      SYSKANRI-REC
              MOVE    "1001"              TO  SYS-KANRICD
              MOVE    "*"                 TO  SYS-KBNCD
              MOVE    WRK-PARA-SRYYM      TO  SYS-STYUKYMD (1:6)
              MOVE    "01"                TO  SYS-STYUKYMD (7:2)
              MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
              MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
              MOVE    SYSKANRI-REC        TO  MCPDATA-REC
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key10"             TO  MCP-PATHNAME
              PERFORM   900-DBSELECT-SEC
              IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"  TO  MCP-TABLE
                  MOVE    "key10"         TO  MCP-PATHNAME
                  PERFORM 960-KANRIMST-READ-SEC
      *
                  IF      FLG-SYSKANRI     =   ZERO
                     MOVE   MCPDATA-REC   TO  SYS-1001-REC
                     MOVE   SYS-1001-PREFNUM  TO  WRK-PREFNUM
                  ELSE
                     MOVE  "医療機関情報が取得できませんでした。"
                                          TO  WRK-RECEERR
                     PERFORM 500-ERR-HENSYU-SEC
                  END-IF    
              ELSE
                  MOVE    "医療機関情報が取得できませんでした。"
                                          TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
              END-IF
      *
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key10"             TO  MCP-PATHNAME
              PERFORM   900-CLOSE-SEC
      *
      *       施設基準情報
              MOVE     ZERO     TO     WRK-SISETU613
              MOVE     ZERO     TO     WRK-SISETU695
              PERFORM  VARYING  IDXA   FROM   1   BY  1
                        UNTIL   IDXA     >    2
                INITIALIZE                      SYSKANRI-REC
                MOVE    "1006"              TO  SYS-KANRICD
                MOVE    IDXA                TO  SYS-KBNCD
                MOVE    WRK-PARA-SRYYM      TO  SYS-STYUKYMD (1:6)
                MOVE    "01"                TO  SYS-STYUKYMD (7:2)
                MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
                MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
                MOVE    SYSKANRI-REC        TO  MCPDATA-REC
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key10"             TO  MCP-PATHNAME
                PERFORM   900-DBSELECT-SEC
                IF      MCP-RC              =   ZERO
                    MOVE    "tbl_syskanri"  TO  MCP-TABLE
                    MOVE    "key10"         TO  MCP-PATHNAME
                    PERFORM 960-KANRIMST-READ-SEC
                    IF      FLG-SYSKANRI     =   ZERO
                       MOVE   MCPDATA-REC   TO  SYS-1006-REC
                       EVALUATE  IDXA
                         WHEN     1
                           CONTINUE
                         WHEN     2
                           MOVE  SYS-1006-SSTKIJUN(113)
                                            TO  WRK-SISETU613
                           MOVE  SYS-1006-SSTKIJUN(195)
                                            TO  WRK-SISETU695
                       END-EVALUATE
                    END-IF
                END-IF
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key10"             TO  MCP-PATHNAME
                PERFORM   900-CLOSE-SEC
              END-PERFORM
           ELSE
              MOVE     ZERO               TO  SYSKAN-IDX
              MOVE     SPACE              TO  TBL-SYS1001-T
              INITIALIZE                      TBL-SYS1001-T
      *
              INITIALIZE                      SYSKANRI-REC
              MOVE    "1001"              TO  SYS-KANRICD
              MOVE    "*"                 TO  SYS-KBNCD
              MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
              MOVE    SYSKANRI-REC        TO  MCPDATA-REC
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
              PERFORM   900-DBSELECT-SEC
              IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"  TO  MCP-TABLE
                  MOVE    "key8"          TO  MCP-PATHNAME
                  PERFORM  960-KANRIMST-READ-SEC
                  PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                            OR    (SYSKAN-IDX   >=  100)
      *
                    MOVE    MCPDATA-REC   TO  SYS-1001-REC
                    ADD     1             TO  SYSKAN-IDX
                    MOVE    SYS-1001-REC  TO  TBL-SYS1001(SYSKAN-IDX)
      *
                    MOVE    "tbl_syskanri"  TO  MCP-TABLE
                    MOVE    "key8"          TO  MCP-PATHNAME
                    PERFORM  960-KANRIMST-READ-SEC
      *
                  END-PERFORM
              ELSE
                  MOVE    "医療機関情報が取得できませんでした。"
                                          TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
              END-IF
      *
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
              PERFORM   900-CLOSE-SEC
      *
              MOVE     SPACE              TO  TBL-SYS1006-T
              INITIALIZE                      TBL-SYS1006-T
      *
              PERFORM  VARYING  IDXA   FROM   1   BY  1
                        UNTIL   IDXA     >    2
                 MOVE     ZERO            TO  SYSKAN-IDX2
                 INITIALIZE                   SYSKANRI-REC
                 MOVE    "1006"           TO  SYS-KANRICD
                 MOVE    IDXA             TO  SYS-KBNCD
                 MOVE    SPA-HOSPNUM      TO  SYS-HOSPNUM
                 MOVE    SYSKANRI-REC     TO  MCPDATA-REC
                 MOVE    "tbl_syskanri"   TO  MCP-TABLE
                 MOVE    "key8"           TO  MCP-PATHNAME
                 PERFORM   900-DBSELECT-SEC
                 IF      MCP-RC           =   ZERO
                     MOVE    "tbl_syskanri"   TO  MCP-TABLE
                     MOVE    "key8"           TO  MCP-PATHNAME
                     PERFORM  960-KANRIMST-READ-SEC
                     PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                               OR    (SYSKAN-IDX2  >=  100)
      *
                       MOVE    MCPDATA-REC   TO  SYS-1006-REC
                       EVALUATE  IDXA
                         WHEN     1
                           ADD     1     TO  SYSKAN-IDX2
                           MOVE    SYS-1006-REC
                                         TO  TBL-SYS10061(SYSKAN-IDX2)
                         WHEN     2
                           ADD     1     TO  SYSKAN-IDX2
                           MOVE    SYS-1006-REC
                                         TO  TBL-SYS10062(SYSKAN-IDX2)
                       END-EVALUATE
      *
                       MOVE    "tbl_syskanri"   TO  MCP-TABLE
                       MOVE    "key8"           TO  MCP-PATHNAME
                       PERFORM  960-KANRIMST-READ-SEC
      *
                     END-PERFORM
                 END-IF
                 MOVE    "tbl_syskanri"   TO  MCP-TABLE
                 MOVE    "key8"           TO  MCP-PATHNAME
                 PERFORM   900-CLOSE-SEC
              END-PERFORM
           END-IF
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
      *
             MOVE      WRK-PARA-SRYYM    TO  WRK-SRYYM-5000
             PERFORM   1001-SYS-5000-CHK-SEC
      *      食事・未実施減算情報（システム管理テーブルより）
             INITIALIZE                   WRK-SHOKUJIRYOYO-OCC
                                          WRK-TOKUKANRIKASAN-OCC
      *
             INITIALIZE                   WRK-SYS-MIJISI-T
      *
             INITIALIZE                      SYSKANRI-REC
             MOVE    "5000"              TO  SYS-KANRICD
             MOVE    "*"                 TO  SYS-KBNCD
             MOVE    WRK-PARA-SRYYM      TO  SYS-STYUKYMD (1:6)
             MOVE    "01"                TO  SYS-STYUKYMD (7:2)
             MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
             MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
             MOVE    SYSKANRI-REC        TO  MCPDATA-REC
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key10"             TO  MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF      MCP-RC              =   ZERO
                 MOVE    "tbl_syskanri"    TO  MCP-TABLE
                 MOVE    "key10"           TO  MCP-PATHNAME
                 PERFORM  960-KANRIMST-READ-SEC
                 IF      FLG-SYSKANRI        =   ZERO
                   MOVE    MCPDATA-REC     TO  SYS-5000-REC
                   PERFORM  1002-SYSKAN-HENSYU-SEC
                   IF        WRK-SYS5000-COUNT    =     ZERO
                      CONTINUE
                   ELSE
                      PERFORM  1003-SYS-5000-GET-SEC
                   END-IF
                 ELSE
                   MOVE "医療機関情報−入院基本が取得できませんでした。"
                                         TO  WRK-RECEERR
                   PERFORM 500-ERR-HENSYU-SEC
                 END-IF
             ELSE
                  MOVE "医療機関情報−入院基本が取得できませんでした。"
                                         TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
             END-IF
      *
             MOVE    "tbl_syskanri"    TO  MCP-TABLE
             MOVE    "key10"           TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
           ELSE
      *
             MOVE     ZERO               TO  SYSKAN-IDX
             MOVE     SPACE              TO  TBL-SYS5000-T
             INITIALIZE                      TBL-SYS5000-T
      *
             INITIALIZE                      SYSKANRI-REC
             MOVE    "5000"              TO  SYS-KANRICD
             MOVE    "*"                 TO  SYS-KBNCD
             MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
             MOVE    SYSKANRI-REC        TO  MCPDATA-REC
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key8"              TO  MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF      MCP-RC              =   ZERO
                 MOVE    "tbl_syskanri"  TO  MCP-TABLE
                 MOVE    "key8"          TO  MCP-PATHNAME
                 PERFORM 960-KANRIMST-READ-SEC
                 PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                           OR    (SYSKAN-IDX   >=  100)
      *
                   MOVE    MCPDATA-REC  TO  SYS-5000-REC
                   ADD     1            TO  SYSKAN-IDX
                   MOVE   SYS-5000-REC  TO  TBL-SYS5000(SYSKAN-IDX)
      *
                   MOVE    "tbl_syskanri"  TO  MCP-TABLE
                   MOVE    "key8"          TO  MCP-PATHNAME
                   PERFORM 960-KANRIMST-READ-SEC
      *
                 END-PERFORM
             ELSE
                  MOVE "医療機関情報−入院基本が取得できませんでした。"
                                         TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
             END-IF
      *
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key8"              TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
           END-IF
      *
      *    レセプト編集区分情報
           INITIALIZE                   SYSKANRI-REC
           MOVE    "2005"           TO  SYS-KANRICD
           MOVE    "*"              TO  SYS-KBNCD
           MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
           MOVE    "01"             TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
           MOVE    SPA-HOSPNUM      TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC     TO  MCPDATA-REC
           MOVE    "tbl_syskanri"   TO  MCP-TABLE
           MOVE    "key10"          TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"   TO  MCP-TABLE
               MOVE    "key10"          TO  MCP-PATHNAME
               PERFORM 960-KANRIMST-READ-SEC
               IF      FLG-SYSKANRI     =   ZERO
                   MOVE    MCPDATA-REC      TO  SYS-2005-REC
               ELSE    
                   INITIALIZE                   SYS-2005-REC
               END-IF
           ELSE
               INITIALIZE                   SYS-2005-REC
           END-IF
           IF      SYS-2005-JIHITEKKSIKBN
                                        =   SPACE
               MOVE    ZERO             TO  SYS-2005-JIHITEKKSIKBN
           END-IF
           IF      SYS-2005-SYAOCRKBN   =   SPACE
               MOVE    ZERO             TO  SYS-2005-SYAOCRKBN
           END-IF
           IF      SYS-2005-KKHOCRKBN   =   SPACE
               MOVE    ZERO             TO  SYS-2005-KKHOCRKBN
           END-IF
      *
           MOVE    "tbl_syskanri"       TO  MCP-TABLE
           MOVE    "key10"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *         
           MOVE    SPACE            TO  SYSKANRI-REC
           INITIALIZE                   SYSKANRI-REC
           MOVE    "2005"           TO  SYS-KANRICD
           MOVE    "01"             TO  SYS-KBNCD
           MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
           MOVE    "01"             TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
           MOVE    SPA-HOSPNUM      TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC     TO  MCPDATA-REC
           MOVE    "tbl_syskanri"   TO  MCP-TABLE
           MOVE    "key10"          TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"   TO  MCP-TABLE
               MOVE    "key10"          TO  MCP-PATHNAME
               PERFORM 960-KANRIMST-READ-SEC
               IF      FLG-SYSKANRI     =   ZERO
                   MOVE    MCPDATA-REC      TO  SYS-200501-REC
               ELSE    
                   INITIALIZE                   SYS-200501-REC
               END-IF
           ELSE
               INITIALIZE                   SYS-200501-REC
           END-IF
           IF      SYS-200501-KOUIKIOCRKBN
                                    =   SPACE
               MOVE    ZERO             TO  SYS-200501-KOUIKIOCRKBN
           END-IF
           IF      SYS-200501-COMMENT-NYUINRYO-KSIKBN
                                    =   SPACE
               MOVE    "1"   TO  SYS-200501-COMMENT-NYUINRYO-KSIKBN
           END-IF
      *
           MOVE    "tbl_syskanri"       TO  MCP-TABLE
           MOVE    "key10"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       100-INIT-EXT.
           EXIT.
      *
      ******************************************************************
      *    月内に複数の医療期間情報がないか検索（医療機関減算の確認）  *
      ******************************************************************
       1001-SYS-5000-CHK-SEC                 SECTION.
      *
           MOVE     ZERO               TO  WRK-SYS5000-COUNT
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    WRK-SRYYM-5000      TO  SYS-STYUKYMD(1:6)
           MOVE    "__"                TO  SYS-STYUKYMD(7:2)
           MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"    TO  MCP-TABLE
               MOVE    "key11"           TO  MCP-PATHNAME
               PERFORM 960-KANRIMST-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
                   ADD     1     TO        WRK-SYS5000-COUNT
                   MOVE    "tbl_syskanri"    TO  MCP-TABLE
                   MOVE    "key11"           TO  MCP-PATHNAME
                   PERFORM 960-KANRIMST-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
      *
       1001-SYS-5000-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    シスカンの編集
      *****************************************************************
       1002-SYSKAN-HENSYU-SEC                SECTION.
      *
           PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                    UNTIL     GENSAN-IDX   >   4
                IF    SYS-5000-GENKBN(GENSAN-IDX)   =   "2"    
                    MOVE   1   TO   WRK-SYS-MIJISI(GENSAN-IDX)
                    PERFORM VARYING GENSAN-IDX2 FROM 1 BY 1
                        UNTIL     GENSAN-IDX2   >   31
                          MOVE   1   TO
                             WRK-SYS-MIJISI-FLG(GENSAN-IDX GENSAN-IDX2)
                    END-PERFORM
                END-IF
           END-PERFORM
      *
           PERFORM   VARYING   IDX8   FROM  1  BY  1
                      UNTIL    IDX8    >   31
              EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *         入院食事療養（１）
                WHEN         "197000110"
                    MOVE     1      TO   WRK-SHOKUJIRYOYO(IDX8)
                    EVALUATE  SYS-5000-SHOKUKBN(1)
                      WHEN     "1"
                        MOVE  ZERO  TO   WRK-TOKUKANRIKASAN(IDX8)
                      WHEN     "2"
                        MOVE    1   TO   WRK-TOKUKANRIKASAN(IDX8)
                    END-EVALUATE
      *         入院食事療養（２）
                WHEN         "197000710"
                    MOVE     2      TO   WRK-SHOKUJIRYOYO(IDX8)
              END-EVALUATE
           END-PERFORM
      *
           .
       1002-SYSKAN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    月内の医療期間情報取得（医療機関減算情報）                  *
      ******************************************************************
       1003-SYS-5000-GET-SEC                 SECTION.
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    WRK-SRYYM-5000      TO  SYS-STYUKYMD(1:6)
           MOVE    "__"                TO  SYS-STYUKYMD(7:2)
           MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"    TO  MCP-TABLE
               MOVE    "key11"           TO  MCP-PATHNAME
               PERFORM 960-KANRIMST-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
                 MOVE   MCPDATA-REC  TO  SYS-5000-REC
                 MOVE   SYS-5000-STYUKYMD(7:2)  TO  IDV
                 PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                            UNTIL     GENSAN-IDX   >   4
                    IF    SYS-5000-GENKBN(GENSAN-IDX)   =   "2"    
                        MOVE   1   TO   WRK-SYS-MIJISI(GENSAN-IDX)
                        PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                           UNTIL     GENSAN-IDX2   >   31
                          MOVE   1      TO
                             WRK-SYS-MIJISI-FLG(GENSAN-IDX GENSAN-IDX2)
                        END-PERFORM
                    ELSE
                        PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                           UNTIL     GENSAN-IDX2   >   31
                          MOVE   ZERO   TO
                             WRK-SYS-MIJISI-FLG(GENSAN-IDX GENSAN-IDX2)
                        END-PERFORM
                    END-IF
                 END-PERFORM
      *
                 PERFORM    VARYING  IDX8  FROM  IDV  BY  1
                             UNTIL   IDX8    >   31
                      EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *                入院食事療養（１）
                       WHEN         "197000110"
                          MOVE     1      TO   WRK-SHOKUJIRYOYO(IDX8)
                          EVALUATE  SYS-5000-SHOKUKBN(1)
                            WHEN     "1"
                              MOVE  ZERO  TO   WRK-TOKUKANRIKASAN(IDX8)
                            WHEN     "2"
                              MOVE    1   TO   WRK-TOKUKANRIKASAN(IDX8)
                          END-EVALUATE
      *                入院食事療養（２）
                       WHEN         "197000710"
                          MOVE     2      TO   WRK-SHOKUJIRYOYO(IDX8)
                          MOVE    ZERO    TO   WRK-TOKUKANRIKASAN(IDX8)
                      END-EVALUATE
                 END-PERFORM
      *
                 MOVE    "tbl_syskanri"   TO  MCP-TABLE
                 MOVE    "key11"          TO  MCP-PATHNAME
                 PERFORM 960-KANRIMST-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
      *
       1003-SYS-5000-GET-EXT.
           EXIT.
      * 
      *****************************************************************
      *    主処理
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
           PERFORM VARYING IDZ FROM    1   BY  1
                   UNTIL   IDZ >       2
                   OR      FLG-END     =   1
      *
               IF      IDZ             =   1               
      *    レセプト処理
                   MOVE    "RECE620"           TO  RECE62PARA-FILE-ID
                   MOVE    WRK-PARA-TERMID     TO  RECE62PARA-TERMID
                   MOVE    "RECE640"           TO  RECE64PARA-FILE-ID
                   MOVE    WRK-PARA-TERMID     TO  RECE64PARA-TERMID
                   MOVE    "RECE650"           TO  RECE65PARA-FILE-ID
                   MOVE    WRK-PARA-TERMID     TO  RECE65PARA-TERMID
               ELSE
      *    請求書処理
                   MOVE    "RECE62X"           TO  RECE62PARA-FILE-ID
      *->          MOVE    WRK-CONS-TERMID     TO  RECE62PARA-TERMID
                   IF      WRK-PARA-SHELLID    =   "RECEPTX"
                       MOVE    WRK-PARA-TERMID     TO RECE62PARA-TERMID
                   ELSE
                       MOVE    WRK-CONS-TERMID     TO RECE62PARA-TERMID
                   END-IF
               END-IF
               MOVE    "RECE690"           TO  RECE69PARA-FILE-ID
               MOVE    WRK-PARA-TERMID     TO  RECE69PARA-TERMID
               MOVE    WRK-PARA-HOSPNUM    TO  RECE62PARA-HOSPNUM
                                               RECE64PARA-HOSPNUM
                                               RECE65PARA-HOSPNUM
                                               RECE69PARA-HOSPNUM
      *
               PERFORM 200-HENSYU-SEC
      *        
               IF      WRK-PARA-SHELLID    =   "RECEPTX"
                   MOVE    1                   TO  FLG-END
               END-IF
           END-PERFORM 
      *
           MOVE    1                   TO  FLG-END
           .
       200-MAIN-EXT.
           EXIT.
      * 
      *****************************************************************
      *    主処理
      *****************************************************************
       200-HENSYU-SEC                SECTION.
      *
           MOVE    ZERO                TO  FLG-RECE62
      *
           IF      IDZ             =   1               
      *    レセプト処理
               OPEN    OUTPUT              RECE64-FILE
               CLOSE                       RECE64-FILE
      *
               OPEN    OUTPUT              RECE65-FILE
               CLOSE                       RECE65-FILE
      *
               OPEN    OUTPUT              RECE64-FILE
               OPEN    I-O                 RECE65-FILE
           END-IF
      *
           OPEN    I-O                 RECE62-FILE
           IF      STS-RECE62          =   "00"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
               MOVE    1                   TO  WRK-ERR-FLG
               MOVE    RECE62PARA          TO  WRK-ERR-FILE-NM
               MOVE    STS-RECE62          TO  WRK-ERR-FILE-STS
               PERFORM 500-FILE-ERR-ABORT-SEC
           END-IF
      *
           OPEN    INPUT               RECE69-FILE
           IF      STS-RECE69          =   "00"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
               MOVE    1                   TO  WRK-ERR-FLG
               MOVE    RECE69PARA          TO  WRK-ERR-FILE-NM
               MOVE    STS-RECE69          TO  WRK-ERR-FILE-STS
               PERFORM 500-FILE-ERR-ABORT-SEC
           END-IF
      *
           PERFORM    RECE62-READ-SEC
      *
           PERFORM                     UNTIL   FLG-RECE62  =   1
             PERFORM     210-HENSYU-SEC
      *
             IF  FLG-RECE62 = ZERO
               PERFORM     RECE62-READ-SEC
               IF  CNT-IN-COMMIT   =   300
                   MOVE  ZERO          TO      CNT-IN-COMMIT
                   PERFORM 900-DBCOMMIT-SEC
                   PERFORM 900-DBSTART-SEC
               END-IF
      *
      *        処理中止設定処理
               IF      CNT-IN-CANCEL       =   50
                   MOVE    ZERO                TO  CNT-IN-CANCEL
                   PERFORM 500-CANCEL-HENSYU-SEC
               END-IF
             END-IF
           END-PERFORM
      *
           CLOSE   RECE62-FILE
           CLOSE   RECE69-FILE
      *
           IF      IDZ             =   1               
      *    レセプト処理
               CLOSE   RECE64-FILE
                       RECE65-FILE
           END-IF
           .
       200-HENSYU-EXT.
           EXIT.
      * 
      *****************************************************************
      *    編集処理
      *****************************************************************
       210-HENSYU-SEC                   SECTION.
      *
      *    地方公費データのとき不明分は処理の対象としない
           IF      IDZ                  =   2
           AND     RECE62-RECESYUBETU   =   ZERO
               GO  TO  210-HENSYU-EXT
           END-IF
      *
           INITIALIZE          WRK-AREA-SAIKEI
           INITIALIZE          WRK-SKY-AREA
      *
           INITIALIZE          WRK-DAY-TABLE
                               WRK-MIJ-TABLE
                               WRK-SKJ200604-TABLE
                               WRK-NYULIFE-TABLE
                               WRK-TENTEKI2-TABLE
      *
           INITIALIZE          WRK-RECE62G-REC
      *
           PERFORM        2110-GENGAKU-HANTEI-SEC
      *
           PERFORM        2111-TENTEKIMATOME-HENSYU-SEC
      *
      ***  PERFORM    VARYING    IDX    FROM   1   BY   1
      ***             UNTIL     (IDX      >   10)  OR
      ***                       (RECE62-SRYKA(IDX)   =   SPACE)
               PERFORM    2101-RECE64-HENSYU-SEC
               PERFORM    2102-RECE64-HENSYU2-SEC
               PERFORM    2103-RECE64-HENSYU3-SEC
               PERFORM    2113-GENTEN-HENSYU-SEC
               PERFORM    2104-FTN-SET-SEC
      ***  END-PERFORM
      *
           IF    RECE62-SRYYM   >=  "200804"
             PERFORM      2114-BUNTENSU-HENSYU-SEC
           END-IF
           IF    RECE62-FUKUSHIFLG(3)  =  "2"
               MOVE   SPACE   TO   RECE62-FUKUSHIFLG(3)
           END-IF
           IF    RECE62-FUKUSHIFLG(4)  =  "2"
               MOVE   SPACE   TO   RECE62-FUKUSHIFLG(4)
           END-IF
           IF    RECE62-FUKUSHIFLG(5)  =  "2"
               MOVE   SPACE   TO   RECE62-FUKUSHIFLG(5)
           END-IF
      *
      *    レセプト請求区分による公費情報の振り分け処理
           MOVE    ZERO            TO  FLG-RECESKYKBN
           PERFORM VARYING IDX     FROM    1   BY  1
                   UNTIL   IDX     >       4
                   OR      FLG-RECESKYKBN  =   1
               IF    ( RECE62-KOHNUM     (IDX) NOT =   SPACE )
               AND   ( RECE62-RECESKYKBN (IDX) NOT =   SPACE )
                   MOVE    1                TO  FLG-RECESKYKBN
               END-IF
           END-PERFORM
           IF     FLG-RECESKYKBN        =   1
               PERFORM 2106-RECESKYKBN-HENSYU-SEC
           END-IF
      *
           IF      IDZ                  =   1
               IF ( ( RECE62-TEISYUTUSAKI   =   1           ) AND
                    ( SYS-2005-SYAOCRKBN    =   "2"         )     ) 
               OR ( ( RECE62-TEISYUTUSAKI   =   2           ) AND
                    ( SYS-2005-KKHOCRKBN    =   "2" OR  "3" )     ) 
               OR ( ( RECE62-TEISYUTUSAKI   =   6           ) AND
                    ( SYS-200501-KOUIKIOCRKBN
                                            =   "2" OR  "3" )     )
      *
      *            医療保険・公費のフラグ
                   MOVE    SPACE              TO  WRK-3SYU-KBN
                   MOVE    ZERO               TO  SEIHIDX
                   MOVE    ZERO               TO  KAKKIDX
                   MOVE    ZERO               TO  SESNIDX
                   PERFORM   VARYING   IDX  FROM    1   BY  1
                         UNTIL   ( IDX                >    4    )
                         OR      ( RECE62-KOHID(IDX)  =   SPACE )
      *                生保
                       IF  RECE62-KOHNUM (IDX)  =   "012"
                           MOVE    "1"          TO  WRK-3SYU (1:1)
                           MOVE     IDX         TO  SEIHIDX
                       END-IF
      *                結核
                       IF  RECE62-KOHNUM (IDX)  =   "010"  OR  "011"
                           MOVE    "1"          TO  WRK-3SYU (2:1)
                           MOVE     IDX         TO  KAKKIDX
                       END-IF
      *
                       IF      RECE62-SRYYM <   WRK-CONS-SRYYM-200604
      *                    精神
                           IF  RECE62-KOHNUM (IDX)  =   "020"  OR  "021"
                               MOVE    "1"          TO  WRK-3SYU (3:1)
                               MOVE     IDX         TO  SESNIDX
                           END-IF
                       ELSE
      *                    自立支援法
                           IF  RECE62-KOHNUM (IDX)  =   "021"  OR  "015"
                                                    OR  "016"  OR  "024"
                               MOVE    "1"          TO  WRK-3SYU (3:1)
                               MOVE     IDX         TO  SESNIDX
                           END-IF
                       END-IF
                   END-PERFORM
      *    
                   IF      WRK-3SYU-KBN           =   ALL "1" AND 
                           RECE62-HKNNUM          =   SPACE            
      *                ３種の場合
                       IF  KAKKIDX         >   SESNIDX
                           MOVE    SESNIDX     TO  IDA
                           MOVE    KAKKIDX     TO  IDB
                       ELSE
                           MOVE    KAKKIDX     TO  IDA
                           MOVE    SESNIDX     TO  IDB
                       END-IF
                       COMPUTE IDX5     =   SEIHIDX    +   1
                       COMPUTE IDX6     =   IDA        +   1
                       COMPUTE IDX7     =   IDB        +   1
                   ELSE    
      *                ３種以外の場合
                       MOVE    1               TO  IDA
                       MOVE    2               TO  IDB
                       MOVE    1               TO  IDX5
                       MOVE    2               TO  IDX6
                       MOVE    3               TO  IDX7
                   END-IF
      *
                   PERFORM     2107-OCR1-HENSYU-SEC
                   PERFORM     2108-OCR2-HENSYU-SEC
                   PERFORM     2109-OCR3-HENSYU-SEC
               END-IF
           END-IF
      *
      *    福岡県地方公費の判定
      ***  DISPLAY   "RECE62-PREFNUM = " RECE62-PREFNUM
           IF     (RECE62-PREFNUM     =   40    )
           AND    (RECE62-SRYYM      <=   200609)
               MOVE    ZERO               TO  KOHIDX
               PERFORM   VARYING   IDX  FROM    1   BY  1
                         UNTIL   ( IDX                >    4    )
                         OR      ( RECE62-KOHID(IDX)  =   SPACE )
      *            福岡県地方公費
                   EVALUATE    RECE62-KOHNUM (IDX)  (1:1)
                       WHEN    "1" THRU    "2"
                           IF      RECE62-KOHHBTNUM (IDX) =   "41"
                               CONTINUE
                           ELSE 
                               MOVE     IDX         TO  KOHIDX
                           END-IF
                   END-EVALUATE
               END-PERFORM
      *        福岡地方公費がある場合給付外点数を編集
               IF      KOHIDX          >   ZERO
                   PERFORM 300-KYUFUGAI-HENSYU-SEC
               END-IF 
           END-IF
      *
      *    新潟県中越沖地震対応 
      *    岩手・宮城内陸地震対応 
      *    中国・九州北部豪雨対応
      *    平成２１年台風第９号対応
      *    平成２２年７月中国地方豪雨対応
      *    鹿児島県奄美市等における局地的大雨対応
      *
           IF   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "15"         ) AND
                 ( RECE62-SRYYM       >=   200709       ) AND
                 ( RECE62-SRYYM       <=   200712       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "03" OR "04" ) AND
                 ( RECE62-SRYYM       >=   200806       ) AND
                 ( RECE62-SRYYM       <=   200812       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "35" OR "40" ) AND
                 ( RECE62-SRYYM       >=   200907       ) AND
                 ( RECE62-SRYYM       <=   200912       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "28" OR "33" ) AND
                 ( RECE62-SRYYM       >=   200908       ) AND
                 ( RECE62-SRYYM       <=   201001       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "34" OR "35" ) AND
                 ( RECE62-SRYYM       >=   201007       ) AND
                 ( RECE62-SRYYM       <=   201012       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "46"         ) AND
                 ( RECE62-SRYYM       >=   201010       ) AND
                 ( RECE62-SRYYM       <=   201103       ))
           OR   (( IDZ                 =   1            ) AND
                 ( RECE62-SRYYM       >=   201101       ))
               IF    ( RECE62-HKNNUM   NOT =   SPACE )
               AND   ( RECE62-HKNJANUM     =   SPACE )
                   IF  RECE62-SRYYM   >=  "201101"
                       MOVE    6           TO  RECE62-RJNGAIKOHFTN (1)
      *                保険者不明＋減免対象者のとき
                       IF    RECE62-GENMENKBN   >  ZERO
                           MOVE    7       TO  RECE62-RJNGAIKOHFTN (1)
                       END-IF
                   ELSE
                       MOVE    3           TO  RECE62-RJNGAIKOHFTN (1)
                   END-IF
               ELSE
                   IF    ( RECE62-RJNHKNNUM
                                           NOT =   SPACE )
                   AND   ( RECE62-RJNFTNJANUM  =   SPACE )
                       MOVE    3           TO  RECE62-RJNGAIKOHFTN (1)
                   ELSE
      *                記号・番号が不明のとき
                       IF    ( RECE62-HKNNUM   NOT =   SPACE )
                       AND   ( RECE62-KIGO         =   SPACE )
                       AND   ( RECE62-NUM          =   SPACE )
                           MOVE    1       TO  RECE62-RJNGAIKOHFTN (1)
                       END-IF   
      *                老人保健の受給者番号が不明のとき
                       IF    ( RECE62-RJNHKNNUM
                                               NOT =   SPACE )
                       AND   ( RECE62-RJNJKYSNUM   =   SPACE )
                           MOVE    1       TO  RECE62-RJNGAIKOHFTN (1)
                       END-IF
      *                公費負担者番号又は受給者番号が不明のとき
                       IF  (RECE62-SRYYM          >= "201101")
                       AND (RECE62-RJNGAIKOHFTN(1) =  ZERO   )
                       AND (RECE62-HKNNUM          =  SPACE  )
                         PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                   UNTIL   IDX-SAI    >    4
                           IF  (RECE62-KOHNUM(IDX-SAI) NOT =  SPACE)
                           AND (RECE62-KOHNUM(IDX-SAI) NOT = 
                                                    "972" AND "974")
                             IF  RECE62-KOHFTNJANUM(IDX-SAI) = SPACE
                               MOVE    6   TO  RECE62-RJNGAIKOHFTN (1)
                               MOVE    4   TO  IDX-SAI
                             ELSE
                              IF RECE62-KOHJKYSNUM (IDX-SAI) = SPACE
                               MOVE    1   TO  RECE62-RJNGAIKOHFTN (1)
                              END-IF
                             END-IF
                           END-IF
                         END-PERFORM
                       END-IF
      *                記号番号不明＋減免対象者のとき
      *                公費受給者番号不明＋減免対象者のとき
                       IF  (RECE62-RJNGAIKOHFTN(1) =   1  )
                       AND (RECE62-GENMENKBN       >  ZERO)
                         IF   RECE62-SRYYM    >= "201101"
                           MOVE    5       TO  RECE62-RJNGAIKOHFTN (1)
                         END-IF
                       END-IF
      *                公費負担者番号不明＋減免対象者のとき
                       IF  (RECE62-RJNGAIKOHFTN(1) =   6  )
                       AND (RECE62-GENMENKBN       >  ZERO)
                         IF   RECE62-SRYYM    >= "201101"
                           MOVE    7       TO  RECE62-RJNGAIKOHFTN (1)
                         END-IF
                       END-IF
      *                減免対象者のとき
                       IF  (RECE62-RJNGAIKOHFTN(1) =  ZERO)
                       AND (RECE62-GENMENKBN       >  ZERO)
                         IF    (RECE62-SRYYM    >= "201101")
                         AND   (FLG-GENMEN-ARI   =  1      )
                         AND   (FLG-GENMEN-NASI  =  1      )
                           MOVE    4       TO  RECE62-RJNGAIKOHFTN (1)
                           MOVE  WRK-GENMEN-NASI-KIN
                                           TO  RECE62-YOBIETC(4)
                           MOVE  WRK-GENMEN-NASI-SKJ
                                           TO  RECE62-YOBIETC(5)
                           IF   (FLG-SAIGAI-TAISYO  =   1       )
                           AND  (RECE62-HKNNUM  NOT =  SPACE    )
                             IF  RECE62-KOUREI      =  "1" OR "2"
                               MOVE   WRK-GENMEN-NASI-KIN
                                           TO  RECE62-FTNMONEY(1)
                             END-IF
                             MOVE   WRK-GENMEN-NASI-SKJ
                                           TO  RECE62-SHOKUJIFTN(1)
                           END-IF
                         ELSE
                           IF  (RECE62-SRYYM    >= "201101")
                           AND (FLG-GENMEN-ARI2  =  1      )
                           AND (FLG-GENMEN-NASI2 =  1      )
                             MOVE    4     TO  RECE62-RJNGAIKOHFTN (1)
                             MOVE  WRK-GENMEN-NASI-KIN2
                                           TO  RECE62-YOBIETC(4)
                             MOVE  WRK-GENMEN-NASI-SKJ2
                                           TO  RECE62-YOBIETC(5)
                           ELSE
                             MOVE    2     TO  RECE62-RJNGAIKOHFTN (1)
                           END-IF
                         END-IF
                       END-IF
                   END-IF
               END-IF
      *
               IF   RECE62-SRYYM   >=  "201007"
                   IF  (RECE62-SRYYM          >= "201101"         )
                   AND (RECE62-HKNNUM          =  SPACE           )
                   AND (FLG-SAIGAI-TAISYO      =   1              )
                   AND (RECE62-RJNGAIKOHFTN(1) =  2 OR 4 OR 5 OR 7)
      *              上限額確認
                     MOVE     ZERO      TO    FLG-SAIGAI-JGN-ETC1
                     MOVE     ZERO      TO    FLG-SAIGAI-JGN-ETC2
                     MOVE     9         TO    FLG-SAIGAI-JGN-SEIHO
                     MOVE     ZERO      TO    FLG-SAIGAI-ETC1-ARI
                     PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                               UNTIL   IDX-SAI    >    4
                       IF  (RECE62-KOHNUM(IDX-SAI) NOT =  SPACE)
                       AND (RECE62-KOHNUM(IDX-SAI) NOT = 
                                                "972" AND "974")
                         IF  RECE62-KOHNUM(IDX-SAI)  =  "010"
                            MOVE   1    TO    FLG-SAIGAI-JGN-ETC1
                         END-IF
                         IF  RECE62-KOHNUM(IDX-SAI)  =
                             "012" OR "015" OR "016" OR
                             "024" OR "025" OR "038" OR "051" OR
                             "052" OR "079" OR "011" OR "020"
                            PERFORM   2117-SAIGAI-JGN-CHECK-SEC
                         END-IF
                       END-IF
                     END-PERFORM
                     EVALUATE   FLG-SAIGAI-JGN-SEIHO
                       WHEN        ZERO
                         IF  (FLG-SAIGAI-JGN-ETC2 =  1)
                            CONTINUE
                         ELSE
                            EVALUATE  RECE62-RJNGAIKOHFTN(1)
                              WHEN      2
                              WHEN      4
                                MOVE  ZERO  TO  RECE62-RJNGAIKOHFTN(1)
                              WHEN      5
                                MOVE   1    TO  RECE62-RJNGAIKOHFTN(1)
                              WHEN      7
                                MOVE   6    TO  RECE62-RJNGAIKOHFTN(1)
                            END-EVALUATE
                            MOVE    ZERO    TO  RECE62-YOBIETC(4)
                            MOVE    ZERO    TO  RECE62-YOBIETC(5)
                            MOVE    ZERO    TO  RECE62-GENMENKBN
                         END-IF
                       WHEN        1
                         IF ( FLG-SAIGAI-ETC1-ARI =  ZERO )
                         OR ((FLG-SAIGAI-JGN-ETC1 =  1   ) AND
                             (FLG-SAIGAI-ETC1-ARI =  1   ))
                         OR ( FLG-SAIGAI-JGN-ETC2 =  1    )
                            CONTINUE
                         ELSE
                            EVALUATE  RECE62-RJNGAIKOHFTN(1)
                              WHEN      2
                              WHEN      4
                                MOVE  ZERO  TO  RECE62-RJNGAIKOHFTN(1)
                              WHEN      5
                                MOVE   1    TO  RECE62-RJNGAIKOHFTN(1)
                              WHEN      7
                                MOVE   6    TO  RECE62-RJNGAIKOHFTN(1)
                            END-EVALUATE
                            MOVE    ZERO    TO  RECE62-YOBIETC(4)
                            MOVE    ZERO    TO  RECE62-YOBIETC(5)
                            MOVE    ZERO    TO  RECE62-GENMENKBN
                         END-IF
                       WHEN        9
                         IF  (FLG-SAIGAI-JGN-ETC1 =  1)
                         OR  (FLG-SAIGAI-JGN-ETC2 =  1)
                            CONTINUE
                         ELSE
                            EVALUATE  RECE62-RJNGAIKOHFTN(1)
                              WHEN      2
                              WHEN      4
                                MOVE  ZERO  TO  RECE62-RJNGAIKOHFTN(1)
                              WHEN      5
                                MOVE   1    TO  RECE62-RJNGAIKOHFTN(1)
                              WHEN      7
                                MOVE   6    TO  RECE62-RJNGAIKOHFTN(1)
                            END-EVALUATE
                            MOVE    ZERO    TO  RECE62-YOBIETC(4)
                            MOVE    ZERO    TO  RECE62-YOBIETC(5)
                            MOVE    ZERO    TO  RECE62-GENMENKBN
                         END-IF
                     END-EVALUATE
                   END-IF
                   IF   FLG-SAIGAI-TAISYO   =   1
                     IF  (RECE62-SRYYM          >= "201101")
                     AND (RECE62-RJNGAIKOHFTN(1) =  ZERO   )
                       MOVE    3     TO   RECE62-RJNGAIKOHFTN (1)
                     END-IF
                     IF  (RECE62-HKNNUM      NOT =  SPACE  )
                     AND (RECE62-SRYYM          >= "201101")
                       EVALUATE  RECE62-RJNGAIKOHFTN(1)
                         WHEN       1
                           PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                     UNTIL   IDX-SAI    >    4
                             IF  (RECE62-KOHNUM(IDX-SAI) NOT =  SPACE)
                             AND (RECE62-KOHNUM(IDX-SAI) NOT = 
                                                      "972" AND "974")
                               IF  RECE62-KOHFTNJANUM(IDX-SAI) = SPACE
                                 MOVE   11   TO  RECE62-RJNGAIKOHFTN(1)
                                 MOVE    4   TO  IDX-SAI
                               ELSE
                                IF RECE62-KOHJKYSNUM (IDX-SAI) = SPACE
                                 MOVE    1   TO  RECE62-RJNGAIKOHFTN(1)
                                END-IF
                               END-IF
                             END-IF
                           END-PERFORM
                         WHEN       3
                           PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                     UNTIL   IDX-SAI    >    4
                             IF  (RECE62-KOHNUM(IDX-SAI) NOT =  SPACE)
                             AND (RECE62-KOHNUM(IDX-SAI) NOT = 
                                                      "972" AND "974")
                               IF  RECE62-KOHFTNJANUM(IDX-SAI) = SPACE
                                 MOVE    9   TO  RECE62-RJNGAIKOHFTN(1)
                                 MOVE    4   TO  IDX-SAI
                               ELSE
                                IF RECE62-KOHJKYSNUM (IDX-SAI) = SPACE
                                 MOVE   10   TO  RECE62-RJNGAIKOHFTN(1)
                                END-IF
                               END-IF
                             END-IF
                           END-PERFORM
                         WHEN       6
                           PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                     UNTIL   IDX-SAI    >    4
                             IF  (RECE62-KOHNUM(IDX-SAI) NOT =  SPACE)
                             AND (RECE62-KOHNUM(IDX-SAI) NOT = 
                                                      "972" AND "974")
                               IF  RECE62-KOHFTNJANUM(IDX-SAI) = SPACE
                                 MOVE    6   TO  RECE62-RJNGAIKOHFTN(1)
                                 MOVE    4   TO  IDX-SAI
                               ELSE
                                IF RECE62-KOHJKYSNUM (IDX-SAI) = SPACE
                                 MOVE    8   TO  RECE62-RJNGAIKOHFTN(1)
                                END-IF
                               END-IF
                             END-IF
                           END-PERFORM
                       END-EVALUATE
                     END-IF
                     IF  (RECE62-SRYYM          >= "201101")
                       EVALUATE  RECE62-RJNGAIKOHFTN(1)
                         WHEN       2
                         WHEN       5
                         WHEN       7
                            MOVE    96   TO      FLG-TOKKI
                            PERFORM   21013-TOKKI-HENSYU-SEC
                         WHEN       4
                            MOVE    97   TO      FLG-TOKKI
                            PERFORM   21013-TOKKI-HENSYU-SEC
                       END-EVALUATE
                     END-IF
                   ELSE
                     MOVE    ZERO    TO   RECE62-RJNGAIKOHFTN (1)
                     MOVE    ZERO    TO   RECE62-YOBIETC(4)
                     MOVE    ZERO    TO   RECE62-YOBIETC(5)
                   END-IF
               END-IF
           END-IF
      *
           IF   FLG-ZENKI-TOKUREI  =   1
              MOVE      1     TO     RECE62-RJNGAIKOHFTN(2)
           END-IF
      *
           PERFORM     2112-PTTOKKI-HENSYU-SEC
      *
      *    請求額情報編集
           PERFORM     2116-SKY-HENSYU-SEC
      *
           PERFORM     RECE62-REWRITE-SEC
           .
       210-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費単独の災害対象上限額チェック
      *****************************************************************
       2117-SAIGAI-JGN-CHECK-SEC      SECTION.
      *
           INITIALIZE                        LNK-ORCSJGNGET-REC
           MOVE   RECE62-HOSPNUM         TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE   RECE62-NYUGAIKBN       TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE   RECE62-PTID            TO  LNK-ORCSJGNGET-PTID
           MOVE   RECE62-KOHNUM(IDX-SAI) TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE   RECE62-KOHID(IDX-SAI)  TO  LNK-ORCSJGNGET-KOHID
           MOVE   RECE62-SRYYM           TO  LNK-ORCSJGNGET-SRYYM
           CALL    "ORCSJGNGET"          USING
                                         LNK-ORCSJGNGET-REC
                                         SPA-AREA
           IF   LNK-ORCSJGNGET-RC  =  ZERO
             IF   RECE62-KOHNUM(IDX-SAI)  =  "012" OR "025"
               IF   LNK-ORCSJGNGET-NYUJGNGAK  NOT = ZERO
                    MOVE     1     TO    FLG-SAIGAI-JGN-SEIHO
               ELSE
                    MOVE    ZERO   TO    FLG-SAIGAI-JGN-SEIHO
               END-IF
             ELSE
               IF   RECE62-KOHNUM(IDX-SAI)  =  "015" OR "016"
                                            OR "011" OR "020"
                 IF   LNK-ORCSJGNGET-NYUJGNGAK  NOT = ZERO
                    MOVE     1     TO    FLG-SAIGAI-JGN-ETC2
                 END-IF
               ELSE
                 MOVE        1     TO    FLG-SAIGAI-ETC1-ARI
                 IF   LNK-ORCSJGNGET-NYUJGNGAK  NOT = ZERO
                    MOVE     1     TO    FLG-SAIGAI-JGN-ETC1
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
       2117-SAIGAI-JGN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    減額・免除・支払猶予者の判定
      *****************************************************************
       2110-GENGAKU-HANTEI-SEC      SECTION.
      *
           MOVE     ZERO     TO     WK-GENGAKUKBN
           MOVE     ZERO     TO     WK-GENGAKU-KOHID
           MOVE     ZERO     TO     WK-GENGAKU-RITU
           MOVE     ZERO     TO     WK-GENGAKU-KIN
           MOVE     ZERO     TO     WK-GENGAKU-KTKBN
      *
           MOVE     ZERO     TO     FLG-SAIGAI-TAISYO
           MOVE     ZERO     TO     WRK-SAIGAI-DD
      *
           IF   (RECE62-SRYYM       >=  "200610")
           AND  (RECE62-HKNNUM   NOT =   SPACE  )
      *
            IF  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
              CONTINUE
            ELSE
              MOVE      RECE62-SRYYM          TO   WK-GENGAKU-YM
              IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                 MOVE   RECE62-TEKSTYMD(7:2)  TO   WK-GENGAKU-DD
              ELSE
                 MOVE   01                    TO   WK-GENGAKU-DD
              END-IF
      *
              MOVE      RECE62-SRYYM          TO   WK-GENGAKU2-YM
              IF   RECE62-TEKEDYMD-X(1:6) >  RECE62-SRYYM
                 INITIALIZE                        STS-AREA-DAY
                 INITIALIZE                        LNK-DAY7-AREA
                 MOVE   "71"                  TO   LNK-DAY7-IRAI
                 MOVE   RECE62-SRYYM          TO   LNK-DAY7-YM
                 CALL   "ORCSDAY"          USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE   LNK-DAY7-KOYOMI       TO   WRK-EDYMD
                 MOVE   WRK-EDYMD(7:2)        TO   WK-GENGAKU2-DD
              ELSE
                 MOVE   RECE62-TEKEDYMD-X(7:2)
                                              TO   WK-GENGAKU2-DD
              END-IF
      *
              MOVE      RECE62-SRYYM          TO   WK-GENGAKU3-YM
              IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
                 MOVE   RECE62-TEKSTYMD-X(7:2)
                                              TO   WK-GENGAKU3-DD
              ELSE
                 MOVE   01                    TO   WK-GENGAKU3-DD
              END-IF
      *
              PERFORM  21101-GENGAKU-HENSYU-SEC
      *
            END-IF
      *
            IF   WK-GENGAKUKBN    =   2
                   MOVE     ZERO    TO    WK-GENGAKUKBN
            END-IF
      *
            IF   RECE62-SRYYM   >=  "201007"
              PERFORM  2115-SAIGAI-TAISYO-HANTEI-SEC
            END-IF
      *
            IF   RECE62-HKNNUM   =   "068" OR "069" OR "040"
             IF   RECE62-SRYYM  >=   "201101"
              IF   (WK-GENGAKUKBN      =   3 OR 4)
              AND  (FLG-SAIGAI-TAISYO  =   1     )
                CONTINUE
              ELSE
                MOVE     ZERO    TO    WK-GENGAKUKBN
              END-IF
             ELSE
                MOVE     ZERO    TO    WK-GENGAKUKBN
                MOVE     ZERO    TO    FLG-SAIGAI-TAISYO
             END-IF
            END-IF
      *
            IF   RECE62-HKNNUM   =   "004"
             IF   RECE62-SRYYM  >=   "201101"
                MOVE     ZERO    TO    WK-GENGAKUKBN
             END-IF
            END-IF
      *
           END-IF
      *
      ***
      *
           IF   (RECE62-SRYYM       >=  "201101")
           AND  (RECE62-HKNNUM       =   SPACE  )
      *
            MOVE      RECE62-SRYYM       TO   WK-GENGAKU-YM
            IF   RECE62-KOHTEKSTYMD(1)(1:6)
                                       >=  RECE62-SRYYM
               MOVE   RECE62-KOHTEKSTYMD(1)(7:2)
                                         TO   WK-GENGAKU-DD
            ELSE
               MOVE   01                 TO   WK-GENGAKU-DD
            END-IF
      *
            MOVE      RECE62-SRYYM       TO   WK-GENGAKU2-YM
            IF   RECE62-KOHTEKEDYMD(1)(1:6)
                                        >  RECE62-SRYYM
              INITIALIZE                      STS-AREA-DAY
              INITIALIZE                      LNK-DAY7-AREA
              MOVE   "71"                TO   LNK-DAY7-IRAI
              MOVE   RECE62-SRYYM        TO   LNK-DAY7-YM
              CALL   "ORCSDAY"         USING  STS-AREA-DAY
                                              LNK-DAY7-AREA
              MOVE   LNK-DAY7-KOYOMI     TO   WRK-EDYMD
              MOVE   WRK-EDYMD(7:2)      TO   WK-GENGAKU2-DD
            ELSE
              MOVE   RECE62-KOHTEKEDYMD(1)(7:2)
                                         TO   WK-GENGAKU2-DD
            END-IF
      *
            MOVE     "99999999"          TO   WK-GENGAKU3-YMD
      *
            PERFORM  21101-GENGAKU-HENSYU-SEC
      *
            PERFORM  2115-SAIGAI-TAISYO-HANTEI-SEC
      *
            IF   (WK-GENGAKUKBN      =   3 OR 4)
            AND  (FLG-SAIGAI-TAISYO  =   1     )
              CONTINUE
            ELSE
              MOVE     ZERO    TO    WK-GENGAKUKBN
            END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN   =   1   OR   2
      *
      *       公費月上限額取得
              INITIALIZE                  LNK-ORCSJGNGET-REC
              MOVE  RECE62-HOSPNUM    TO  LNK-ORCSJGNGET-HOSPNUM
              MOVE  RECE62-NYUGAIKBN  TO  LNK-ORCSJGNGET-NYUGAIKBN
              MOVE  RECE62-PTID       TO  LNK-ORCSJGNGET-PTID
              EVALUATE   WK-GENGAKUKBN
                WHEN         1
                   MOVE    "960"      TO  LNK-ORCSJGNGET-KOHHKNNUM
                WHEN         2
                   MOVE    "961"      TO  LNK-ORCSJGNGET-KOHHKNNUM
              END-EVALUATE
              MOVE  WK-GENGAKU-KOHID  TO  LNK-ORCSJGNGET-KOHID
              MOVE  RECE62-SRYYM      TO  LNK-ORCSJGNGET-SRYYM
      *
              CALL    "ORCSJGNGET"    USING
                                      LNK-ORCSJGNGET-REC
                                      SPA-AREA
      *
              IF    LNK-ORCSJGNGET-RC   =   ZERO
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                      MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                       TO  WK-GENGAKU-RITU
                      IF   WK-GENGAKU-RITU  >  100
                          MOVE   100   TO  WK-GENGAKU-RITU
                      END-IF
                      IF   WK-GENGAKU-RITU  =  ZERO
                          MOVE   ZERO  TO  WK-GENGAKUKBN
                      END-IF
                   WHEN          2
                      MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                       TO  WK-GENGAKU-KIN
                      IF   WK-GENGAKU-KIN   =  ZERO
                          MOVE   ZERO  TO  WK-GENGAKUKBN
                      END-IF
                 END-EVALUATE
              END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
              EVALUATE   WK-GENGAKUKBN
      *           減額（割）
                  WHEN        1
                     MOVE    1                TO  RECE62-GENMENKBN
                     MOVE    WK-GENGAKU-RITU  TO  RECE62-GENGAKURATE
      *           減額（円）
                  WHEN        2
                     MOVE    1                TO  RECE62-GENMENKBN
                     MOVE    WK-GENGAKU-KIN   TO  RECE62-GENGAKU
      *           免除
                  WHEN        3
                     MOVE    2                TO  RECE62-GENMENKBN
      *           支払猶予
                  WHEN        4
                     MOVE    3                TO  RECE62-GENMENKBN
              END-EVALUATE
      *
              MOVE   WK-GENGAKU-KTKBN         TO  RECE62-YOBIETC(10)
           END-IF
      *
           .
       2110-GENGAKU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    減額・免除・支払猶予者の編集
      *****************************************************************
       21101-GENGAKU-HENSYU-SEC      SECTION.
      *
           PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                      UNTIL   (GEN-IDX    >    TBL-GENGAKU-MAX)
                        OR    (WK-GENGAKUKBN   NOT = ZERO     )
             INITIALIZE                       PTKOHINF-REC
             MOVE    RECE62-HOSPNUM       TO  PTKOH-HOSPNUM
             MOVE    RECE62-PTID          TO  PTKOH-PTID
             MOVE    TBL-GENGAKU(GEN-IDX) TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC         TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WK-GENGAKU-YMD ) AND
                      (WK-GENGAKU-YMD  <=   PTKOH-TEKEDYMD ) AND
                      (PTKOH-SAKJOKBN   =   SPACE          ))
                  OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU2-YMD) AND
                      (WK-GENGAKU2-YMD <=   PTKOH-TEKEDYMD ) AND
                      (PTKOH-SAKJOKBN   =   SPACE          ))
                  OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU3-YMD) AND
                      (WK-GENGAKU3-YMD <=   PTKOH-TEKEDYMD ) AND
                      (WK-GENGAKU3-YMD NOT = "99999999"    ) AND
                      (PTKOH-SAKJOKBN   =   SPACE          ))
                      EVALUATE   GEN-IDX
                        WHEN        1
                          MOVE   1           TO  WK-GENGAKUKBN
                          MOVE   PTKOH-KOHID TO  WK-GENGAKU-KOHID
                        WHEN        2
                          MOVE   2           TO  WK-GENGAKUKBN
                          MOVE   PTKOH-KOHID TO  WK-GENGAKU-KOHID
                        WHEN        3
                          MOVE   3           TO  WK-GENGAKUKBN
                        WHEN        4
                          MOVE   4           TO  WK-GENGAKUKBN
                      END-EVALUATE
      *
                      IF  RECE62-HKNJANUM  =  "270280" OR "67270280"
                        IF     PTKOH-JKYSNUM(1:1)  = "1"
                          MOVE   1           TO  WK-GENGAKU-KTKBN
                        END-IF
                        IF     PTKOH-JKYSNUM(1:1)  = "2"
                          MOVE   2           TO  WK-GENGAKU-KTKBN
                        END-IF
                      END-IF
      *
                      MOVE       1           TO  FLG-PTKOHINF
                  ELSE
                      MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                      MOVE    "key4"           TO  MCP-PATHNAME
                      PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
             MOVE    "key4"              TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
           END-PERFORM
      *
           .
       21101-GENGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    点滴手技加算まとめ編集
      *****************************************************************
       2111-TENTEKIMATOME-HENSYU-SEC      SECTION.
      *
           PERFORM    VARYING    IDX    FROM   1   BY   1
                       UNTIL    (IDX                   >   10  )
                         OR     (RECE62-HKNCOMBI(IDX)  =   ZERO)
      *
             INITIALIZE                 ORCSTENTEK2AREA
             MOVE    RECE62-HOSPNUM TO  LNK-ORCSTEN2-HOSPNUM
             MOVE    RECE62-PTID    TO  LNK-ORCSTEN2-PTID
             MOVE    RECE62-SRYYM   TO  LNK-ORCSTEN2-SRYYM
             MOVE    RECE62-HKNCOMBI(IDX)
                                    TO  LNK-ORCSTEN2-HKNCOMBI
             CALL    "ORCSTENTEK2"  USING
                                    ORCSTENTEK2AREA
                                    SPA-AREA
             IF      LNK-ORCSTEN2-RC  =   ZERO
               IF   (LNK-ORCSTEN2-TENTEK-ERRCD  = ZERO)
               OR   (LNK-ORCSTEN2-CHUJOU-ERRCD  = ZERO)
                 MOVE  RECE62-HKNCOMBI(IDX)
                                    TO  WRK-TENTEKI2-HKNCOMBI(IDX)
                 MOVE  LNK-ORCSTEN2-OUT-AREA
                                    TO  WRK-TENTEKI2-HENKYAKU-AREA(IDX)
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
       2111-TENTEKIMATOME-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者特記事項編集
      *****************************************************************
       2112-PTTOKKI-HENSYU-SEC      SECTION.
      *
           INITIALIZE                TBL-PTTOKKI
      *
           MOVE      ZERO      TO    TOKKI-IDX2
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
               IF (( RECE62-PTTOKKI-CD(TOKKI-IDX)    = SPACE ) AND
                   ( RECE62-PTTOKKI-NAIYO(TOKKI-IDX) = SPACE ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "15"     ) AND
                   ((RECE62-SRYYM   <  "200608") OR
                    (RECE62-SRYYM   >  "200812")             ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "16"     ) AND
                   ( RECE62-SRYYM   <  "200610"              ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) =
                                    "17" OR "18" OR "19"     ) AND
                   ( RECE62-SRYYM   <  "200704"              ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "20"     ) AND
                   ((RECE62-SRYYM   <  "200804") OR
                    (RECE62-SRYYM   >  "201203")             ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "21"     ) AND
                   ( RECE62-SRYYM   <  "200901"              ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) =
                                    "22" OR "23" OR "24"     ) AND
                   ( RECE62-SRYYM   <  "200905"              ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "25"     ) AND
                   ( RECE62-SRYYM   <  "200910"              ))
                 CONTINUE
               ELSE
                 ADD    1     TO    TOKKI-IDX2
                 MOVE   RECE62-PTTOKKI-CD(TOKKI-IDX)    TO
                                    TBL-PTTOKKI-CD(TOKKI-IDX2)
                 MOVE   RECE62-PTTOKKI-NAIYO(TOKKI-IDX) TO
                                    TBL-PTTOKKI-NAIYO(TOKKI-IDX2)
               END-IF
           END-PERFORM
      *
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
                 MOVE   TBL-PTTOKKI-CD(TOKKI-IDX)       TO
                                    RECE62-PTTOKKI-CD(TOKKI-IDX)
                 MOVE   TBL-PTTOKKI-NAIYO(TOKKI-IDX)    TO
                                    RECE62-PTTOKKI-NAIYO(TOKKI-IDX)
           END-PERFORM
      *
           .
       2112-PTTOKKI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００４）
      *****************************************************************
       2101-RECE64-HENSYU-SEC                SECTION.
      *
           INITIALIZE                           SRYACCT-REC
           MOVE    RECE62-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    RECE62-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    RECE62-PTID          TO      ACCT-PTID
      ***  MOVE    RECE62-SRYKA(IDX)    TO      ACCT-SRYKA
           MOVE    RECE62-SRYYM         TO      ACCT-SRYYM
           MOVE    SRYACCT-REC          TO      MCPDATA-REC
           MOVE    "tbl_sryacct"        TO      MCP-TABLE
           MOVE    "key33"              TO      MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryacct"    TO      MCP-TABLE
               MOVE    "key33"          TO      MCP-PATHNAME
               PERFORM  900-SRYACCT-READ-SEC
               PERFORM  UNTIL
                  (FLG-SRYACCT        =    1)
                   PERFORM VARYING IDX1    FROM    1   BY  1
                           UNTIL   IDX1    >       10
                           OR      RECE62-HKNCOMBI (IDX1)  =   ZERO 
                       IF      ACCT-HKNCOMBI   =
                                               RECE62-HKNCOMBI (IDX1)
      *
                           MOVE   ZERO           TO  FLG-TENTEKIMATOME
                           IF    ACCT-SRYKBN  =  "33"
                              PERFORM   21015-TENTEKIMATOME-CHECK-SEC
                           END-IF
      *
                           MOVE   ZERO           TO  FLG-RINYAK
      *
                           IF   (ACCT-ZAITEN    NOT =    ZERO)    AND
                                (ACCT-ZAIKAISU  NOT =    ZERO)    AND
                                (FLG-TENTEKIMATOME  =    ZERO)
                               MOVE   ZERO   TO   WRK-SRYSURYO
                               MOVE   ZERO   TO   WRK-SRYSURYO2
                               MOVE   ZERO   TO   WRK-SRYSURYO3
                               MOVE   ZERO   TO   WRK-TANICD
                               MOVE   ZERO   TO   WRK-TANIMOJISU
                               MOVE   SPACE  TO   WRK-TANINAME
                               MOVE   ZERO   TO   FLG-HOUSIJI-COM
                                                  FLG-SYOBYO-COM
                                                  FLG-RYOYO-COM
                                                  FLG-SYODOU-COM
                                                  FLG-OSIN-COM
                                                  FLG-HOUSEI-COM
                                                  FLG-HOUMON-COM
                                                  FLG-TAHOKEN
                                                  FLG-KENSA-COM
      *
                               MOVE   ZERO   TO   WRK-FILMTEN
      *
                               MOVE   SPACE  TO   WRK-FORMALNAME
                               MOVE   ZERO   TO   WRK-KZI058-TEN
                                                  WRK-KZI058-TANICD
                                                  WRK-KZI058-TANIMOJISU
                               MOVE   SPACE  TO   WRK-KZI058-TANINAME
                               MOVE   ZERO   TO   FLG-WRITE65
                               MOVE   ZERO   TO   FLG-TENTEKI
                               MOVE   ZERO   TO   FLG-SETCOM
                               MOVE   ZERO   TO   WRK-SETCOM-JIDO
                               MOVE   ZERO   TO   WRK-SETCOM-JIDO2
                               IF  (ACCT-SRYKBN     = "97"     )
                               AND (ACCT-SRYCDTOTAL = 197000470
                                                   OR 197001570
                                                   OR 197001210)
                                 IF  (RECE62-SRYYM   >= "200604" )
                                 AND (ACCT-SRYCDTOTAL = 197000470
                                                     OR 197001570)
                                   PERFORM   21011-RECE64-TENSOU-SEC
                                   PERFORM   21012-RECE65-HENSYU-SEC
                                   IF    FLG-WRITE65  =   1
                                     PERFORM RECE64-WRITE-SEC
                                   END-IF
                                 END-IF
                               ELSE
                                 PERFORM   21011-RECE64-TENSOU-SEC
                                 PERFORM   21012-RECE65-HENSYU-SEC
                                 IF    FLG-WRITE65  =   1
                                   PERFORM RECE64-WRITE-SEC
                                 END-IF
                               END-IF
                           ELSE
                             IF  (ACCT-ZAIKAISU  NOT =    ZERO)   AND
                                 (FLG-TENTEKIMATOME  =    ZERO)
                               IF ( ACCT-SRYKBN  =  "11" OR
                                                    "33" OR "99" OR
                                                    "90" OR "92"  )
                               OR ((RECE62-SRYYM >= "200804"     ) AND
                                   (ACCT-SRYKBN  =  "21" OR "22" OR
                                                    "23" OR "14" ))
                               OR ( ACCT-ZAIKBN  =   1            )
                                 IF  (ACCT-SRYCDTOTAL(1:12)  =
                                                    "000000999901")
                                 AND (ACCT-MEISAISU      =   1    )
                                      MOVE    1    TO      FLG-TOKKI
                                      PERFORM   21013-TOKKI-HENSYU-SEC
                                 ELSE
                                      MOVE   ZERO   TO   WRK-SRYSURYO
                                      MOVE   ZERO   TO   WRK-SRYSURYO2
                                      MOVE   ZERO   TO   WRK-SRYSURYO3
                                      MOVE   ZERO   TO   WRK-TANICD
                                      MOVE   ZERO   TO   WRK-TANIMOJISU
                                      MOVE   SPACE  TO   WRK-TANINAME
                                      MOVE   ZERO   TO   FLG-HOUSIJI-COM
                                                         FLG-SYOBYO-COM
                                                         FLG-RYOYO-COM
                                                         FLG-SYODOU-COM
                                                         FLG-OSIN-COM
                                                         FLG-HOUSEI-COM
                                                         FLG-HOUMON-COM
                                                         FLG-TAHOKEN
                                                         FLG-KENSA-COM
      *
                                      MOVE   ZERO   TO   WRK-FILMTEN
      *
                                      MOVE   SPACE  TO   WRK-FORMALNAME
                                      MOVE   ZERO   TO
                                                  WRK-KZI058-TEN
                                                  WRK-KZI058-TANICD
                                                  WRK-KZI058-TANIMOJISU
                                      MOVE   SPACE  TO
                                                  WRK-KZI058-TANINAME
                                      MOVE   ZERO   TO   FLG-WRITE65
                                      MOVE   ZERO   TO   FLG-TENTEKI
                                      MOVE   ZERO   TO   FLG-SETCOM
                                      MOVE   ZERO   TO  WRK-SETCOM-JIDO
                                      MOVE   ZERO   TO  WRK-SETCOM-JIDO2
                                      PERFORM   21011-RECE64-TENSOU-SEC
                                      PERFORM   21012-RECE65-HENSYU-SEC
                                      IF    FLG-WRITE65  =   1
                                        PERFORM RECE64-WRITE-SEC
                                      END-IF
                                 END-IF
                               ELSE
                                 PERFORM   21014-SINRYO-CHECK-SEC
                                 IF   FLG-RINYAK  NOT =  ZERO
                                      MOVE   ZERO   TO   WRK-SRYSURYO
                                      MOVE   ZERO   TO   WRK-SRYSURYO2
                                      MOVE   ZERO   TO   WRK-SRYSURYO3
                                      MOVE   ZERO   TO   WRK-TANICD
                                      MOVE   ZERO   TO   WRK-TANIMOJISU
                                      MOVE   SPACE  TO   WRK-TANINAME
                                      MOVE   ZERO   TO   FLG-HOUSIJI-COM
                                                         FLG-SYOBYO-COM
                                                         FLG-RYOYO-COM
                                                         FLG-SYODOU-COM
                                                         FLG-OSIN-COM
                                                         FLG-HOUSEI-COM
                                                         FLG-HOUMON-COM
                                                         FLG-TAHOKEN
                                                         FLG-KENSA-COM
      *
                                      MOVE   ZERO   TO   WRK-FILMTEN
      *
                                      MOVE   SPACE  TO   WRK-FORMALNAME
                                      MOVE   ZERO   TO
                                                  WRK-KZI058-TEN
                                                  WRK-KZI058-TANICD
                                                  WRK-KZI058-TANIMOJISU
                                      MOVE   SPACE  TO
                                                  WRK-KZI058-TANINAME
                                      MOVE   ZERO   TO   FLG-WRITE65
                                      MOVE   ZERO   TO   FLG-TENTEKI
                                      MOVE   ZERO   TO   FLG-SETCOM
                                      MOVE   ZERO   TO  WRK-SETCOM-JIDO
                                      MOVE   ZERO   TO  WRK-SETCOM-JIDO2
                                      PERFORM   21011-RECE64-TENSOU-SEC
                                      PERFORM   21012-RECE65-HENSYU-SEC
                                      IF    FLG-WRITE65  =   1
                                        PERFORM RECE64-WRITE-SEC
                                      END-IF
                                 END-IF
                               END-IF
                             END-IF
                           END-IF
                           MOVE    10                TO  IDX1
                       END-IF
                   END-PERFORM          
                   MOVE    "tbl_sryacct"     TO      MCP-TABLE
                   MOVE    "key33"           TO      MCP-PATHNAME
                   PERFORM   900-SRYACCT-READ-SEC
               END-PERFORM
           ELSE
               DISPLAY   "SRYACCT SELECT ERR" 
           END-IF
      *
           MOVE    "tbl_sryacct"      TO      MCP-TABLE
           MOVE    "key33"            TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       2101-RECE64-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       21011-RECE64-TENSOU-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    ACCT-SRYKBN          TO      RECE64-SRYKBN
           IF      ACCT-SRYKBN = "90" OR "92"
                 MOVE    "6"            TO      RECE64-ZAISKBKBN
           ELSE 
              IF   ACCT-SRYKBN = "97"
      ***        MOVE    "4"            TO      RECE64-ZAISKBKBN
                 MOVE    "9"            TO      RECE64-ZAISKBKBN
              END-IF
           END-IF
           MOVE    ACCT-ZAINUM          TO      RECE64-ZAINUM
           MOVE    ZERO                 TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    ACCT-SRYKA           TO      RECE64-SRYKA
           MOVE    ACCT-HKNCOMBI        TO      RECE64-HKNCOMBI
           MOVE    ACCT-JIHOKBN         TO      RECE64-JIHOKBN
           MOVE    ACCT-ZAITEN          TO      RECE64-ZAITEN
           MOVE    ACCT-SRYCDTOTAL      TO      RECE64-SRYCDTOTAL
           MOVE    ACCT-SURYOUTOTAL     TO      RECE64-SURYOUTOTAL
           MOVE    ACCT-MEISAISU        TO      RECE64-MEISAISU
           MOVE    ACCT-ZAIKAISU        TO      RECE64-ZAIKAISU
           MOVE    ACCT-SYUTEN1         TO      RECE64-SYUTEN1
           MOVE    ACCT-SYUTEN2         TO      RECE64-SYUTEN2
           MOVE    ACCT-YKZTEN          TO      RECE64-YKZTEN
           MOVE    ACCT-KIZAITEN        TO      RECE64-KIZAITEN
           MOVE    ACCT-DRCD            TO      RECE64-DRCD
           MOVE    ACCT-ZAIREQFLG       TO      RECE64-ZAIREQFLG
           MOVE    ACCT-TEIGENRATE      TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           PERFORM     VARYING   IDX3   FROM    1    BY   1
                       UNTIL     IDX3   >       4
               PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    ACCT-DAY(IDX3 IDX2)  TO
                                            RECE64-KAISU (IDX3 IDX2)
                   IF     (WK-TAIHI-FLG            =   ZERO)   AND
                          (ACCT-DAY(1 IDX2)    NOT =   ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
               END-PERFORM
           END-PERFORM
      *
           MOVE      ZERO     TO    FLG-OKIKAE
           IF   ( RECE62-AGE       >=  75        )
           OR   ( RECE62-BIRTHDAY  <  "19321001" )
               PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL    ( IDX2        >    31 )
                             OR     ( FLG-OKIKAE  =     1 )
                  IF  ( RECE62-BYOTOSYUBETU(IDX2) =  "02" OR "03" )
                  AND ( RECE64-KAISU(1 IDX2)  NOT =  ZERO         )
                        MOVE   1   TO   FLG-OKIKAE
                  END-IF    
               END-PERFORM
           END-IF
      *
           IF    FLG-RINYAK    NOT =    ZERO
                MOVE    FLG-RINYAK    TO     RECE64-SAFLG
           END-IF
      *
           .
       21011-RECE64-TENSOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       21012-RECE65-HENSYU-SEC               SECTION.
      *
           INITIALIZE                           SRYACT-REC
           MOVE    ACCT-HOSPNUM         TO      SRY-HOSPNUM
           MOVE    ACCT-NYUGAIKBN       TO      SRY-NYUGAIKBN
           MOVE    ACCT-PTID            TO      SRY-PTID
      ***  MOVE    ACCT-SRYKA           TO      SRY-SRYKA
           MOVE    ACCT-SRYYM           TO      SRY-SRYYM
           MOVE    ACCT-ZAINUM          TO      SRY-ZAINUM
           MOVE    SRYACT-REC           TO      MCPDATA-REC
           MOVE    "tbl_sryact"         TO      MCP-TABLE
           MOVE    "key9"               TO      MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key9"           TO      MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT    =    1
                   MOVE    ZERO         TO      FLG-ZANHAIKI
                                                FLG-FORMAL-KISAI
                   MOVE    ZERO         TO      WRK-RENNUM
                                                WRK-RENNUM2
                   MOVE    ZERO         TO      FLG-WRITE65X
                   PERFORM   210121-RECE65-TENSOU-SEC
                   IF   FLG-TENTEKI  =  ZERO
                   AND  FLG-WRITE65X =   1
                     PERFORM 210122-RECE62-HENSYU-SEC
                     PERFORM RECE65-WRITE-SEC
                     MOVE  1            TO      FLG-WRITE65
                   END-IF
                   IF  FLG-ZANHAIKI      =  1
                   OR  FLG-FORMAL-KISAI  =  1
                      PERFORM  RECE65-REWRITE-SEC
                   END-IF
                   MOVE    "tbl_sryact"      TO      MCP-TABLE
                   MOVE    "key9"            TO      MCP-PATHNAME
                   PERFORM   900-SRYACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryact"      TO      MCP-TABLE
           MOVE    "key9"            TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           IF     WRK-FILMTEN  NOT =  ZERO
                COMPUTE    RECE64-SYUTEN2  =  WRK-FILMTEN + 0.5
           END-IF
      *
           .
       21012-RECE65-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       210121-RECE65-TENSOU-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
           MOVE    SRY-ZAINUM           TO      RECE65-ZAINUM
           MOVE    ZERO                 TO      RECE65-ZAIREN
           MOVE    SRY-RENNUM           TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    SRY-SRYKA            TO      RECE65-SRYKA
           MOVE    SRY-SRYKBN           TO      RECE65-SRYKBN
           MOVE    SRY-SRYSYUKBN        TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           MOVE    SRY-JIHIMONEYTOTAL   TO      RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    OR
                                (SRY-SRYCD(IDX2)  =   SPACE)
      *
      *     老人精神病棟等の診療行為コード置き換え
            IF   RECE62-SRYYM  >= "200604"
              CONTINUE
            ELSE
              IF   FLG-OKIKAE   =   1
                EVALUATE  SRY-SRYCD(IDX2)
      *           血液学的検査判断料
                  WHEN  "160061810"
                      MOVE  "160703610"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           検体検査管理加算（１）
                  WHEN  "160170170"
                      MOVE  "160710070"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  539900
      *           検体検査管理加算（２）
                  WHEN  "160161610"
                      MOVE  "160709310"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  547700
      *           生化学的検査（１）判断料
                  WHEN  "160061910"
                      MOVE  "160703710"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           生化学的検査（２）判断料
                  WHEN  "160062010"
                      MOVE  "160703810"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           尿・糞便等検査判断料
                  WHEN  "160061710"
                      MOVE  "160703510"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           微生物学的検査判断料
                  WHEN  "160062210"
                      MOVE  "160704010"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           免疫学的検査判断料
                  WHEN  "160062110"
                      MOVE  "160703910"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
                END-EVALUATE
              END-IF
            END-IF
      *
            MOVE    SRY-SRYCD(IDX2)    TO    WRK-SRYCD
            MOVE    RECE65-SRYYM       TO    WK-TAIHI-SRYYM
            MOVE    WK-TAIHI-DAY       TO    WK-TAIHI-SRYD
            PERFORM    900-TENSU-TBL-SEC
      *
            IF     ( SRY-SRYCD(IDX2)(1:1)  =  "S"   )
                  COMPUTE   RECE64-MEISAISU  =  RECE64-MEISAISU
                                             -  1
            END-IF
      *
            IF     ( SRY-SRYCD(IDX2)(1:3)  =  "001"        )
            OR     ((SRY-SRYCD(IDX2)(1:3)  =  "059") AND
                    (TNS-TEN               =  ZERO )       )
            OR     ( SRY-SRYCD(IDX2)(1:7)  =  "0992000"    )
            OR     ( SRY-SRYCD(IDX2)       =  "099209903"
                                           OR "099209905"
                                           OR "099209906"  )
            OR     ( SRY-SRYCD(IDX2)(1:4)  =  "0085"
                                           OR "0086"       )
            OR     ( SRY-SRYCD(IDX2)       =  "099999903"
                                           OR "099999904"
                                           OR "099999905"
                                           OR "099999906"
                                           OR "099999907"  )
            OR     ((SRY-SRYSYUKBN  = "330" OR "331" OR
                                      "332" OR "350" OR
                                      "352"               ) AND
                    ((SRY-SRYCD(IDX2)(1:1) =   "8"       ) OR
                     (SRY-SRYCD(IDX2)(1:3) =   "008"     )) AND
                    ( ACCT-ZAITEN      NOT =   ZERO       ) AND
                    ( ACCT-SYUTEN1         =   ZERO       ) AND
                    ( ACCT-ZAIKAISU    NOT =   ZERO       ))
            OR     ((ACCT-SRYKBN = "40" OR "50" OR "54" OR
                                   "60" OR "64" OR "70" OR
                                   "80"                   ) AND
                    (ACCT-ZAITEN       NOT =  ZERO        ) AND
                    (ACCT-ZAIKAISU     NOT =  ZERO        ) AND
                    (ACCT-YKZTEN           =  ZERO        ) AND
                    (SRY-SRYCD(IDX2)(1:1)  =  "6"         ))
                  COMPUTE   RECE64-MEISAISU    =  RECE64-MEISAISU
                                               -  1
                  MOVE      SRY-SRYCD(IDX2)   TO  WRK-SRYCD
                  COMPUTE   RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                               -  WRK-SRYCD
                  IF ((ACCT-SRYKBN = "40" OR "50" OR "54" OR
                                     "60" OR "64" OR "70" OR
                                     "80"                   ) AND
                      (ACCT-ZAITEN       NOT =  ZERO        ) AND
                      (ACCT-ZAIKAISU     NOT =  ZERO        ) AND
                      (ACCT-YKZTEN           =  ZERO        ) AND
                      (SRY-SRYCD(IDX2)(1:1)  =  "6"         ))
                     COMPUTE   RECE64-SURYOUTOTAL =  RECE64-SURYOUTOTAL
                                                  -  SRY-SRYSURYO(IDX2)
                  ELSE
                     COMPUTE   RECE64-SURYOUTOTAL =  RECE64-SURYOUTOTAL
                                                  -  1
                  END-IF
            END-IF
      *
            IF       SRY-SRYCD(IDX2)(1:7) = "0999901"
                  COMPUTE   RECE64-MEISAISU    =  RECE64-MEISAISU
                                               -  1
                  MOVE      SRY-SRYCD(IDX2)   TO  WRK-SRYCD
                  COMPUTE   RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                               -  WRK-SRYCD
                  COMPUTE   RECE64-SURYOUTOTAL =  RECE64-SURYOUTOTAL
                                               -  1
                  MOVE    2    TO      FLG-TOKKI
                  PERFORM   21013-TOKKI-HENSYU-SEC
            END-IF
      *
            IF      SRY-SRYCD(IDX2)  =  "820000053" OR "820000054"
                                                    OR "820000055"
                  MOVE    3    TO      FLG-TOKKI
                  PERFORM   21013-TOKKI-HENSYU-SEC
            END-IF
      *
            IF   ACCT-ZAIKBN       =     1
               IF   SRY-SRYCD(IDX2)  =  "820000094" OR "630010011" OR
                                        "630010012" OR "630010013"
                  MOVE    9    TO      FLG-TOKKI
                  PERFORM   21013-TOKKI-HENSYU-SEC
               END-IF
               IF   SRY-SRYCD(IDX2)  =  "820000095"
                  MOVE   10    TO      FLG-TOKKI
                  PERFORM   21013-TOKKI-HENSYU-SEC
               END-IF
            END-IF
      *
            IF      SRY-SRYCD(IDX2)(1:1)     =   "0" OR  "1" OR
                                                 "6" OR  "7" OR
                                                 "8"
      *
             IF  (  SRY-SRYSYUKBN            = "330" OR "331"  OR      
                                               "332" OR "350"  OR
                                               "352" )
             AND (( SRY-SRYCD(IDX2)(1:3)     = "059"             ) OR  
                  ( SRY-SRYCD(IDX2)(1:1)     = "7"               ) OR  
                  ( SRY-SRYCD(IDX2)          = CONS-ZANHAIKI     ) OR  
                  ( SRY-SRYCD(IDX2)(1:1)     = "6"               ))    
             AND (  ACCT-ZAITEN          NOT = ZERO  )
      *******AND (  ACCT-SYUTEN1             = ZERO  )
             AND (  ACCT-ZAIKAISU        NOT = ZERO  )
      *
              MOVE    1                  TO    FLG-TENTEKI             
      *
             ELSE                                                      
      *
              IF     ( SRY-SRYCD(IDX2)(1:7)  =  "0999901"    )
              OR     ( SRY-SRYCD(IDX2)(1:3)  =  "001"        )
              OR     ((SRY-SRYCD(IDX2)(1:3)  =  "059") AND
                      (TNS-TEN               =  ZERO )       )
              OR     ( SRY-SRYCD(IDX2)(1:7)  =  "0992000"    )
              OR     ( SRY-SRYCD(IDX2)       =  "099209903"
                                             OR "099209905"
                                             OR "099209906"  )
              OR     ( SRY-SRYCD(IDX2)(1:4)  =  "0085"
                                             OR "0086"       )
              OR     ( SRY-SRYCD(IDX2)       =  "099999903"
                                             OR "099999904"
                                             OR "099999905"
                                             OR "099999906"
                                             OR "099999907"  )
              OR     ((SRY-SRYSYUKBN  = "330" OR "331" OR
                                        "332" OR "350" OR
                                        "352"               ) AND
                      ((SRY-SRYCD(IDX2)(1:1) =   "8"       ) OR
                       (SRY-SRYCD(IDX2)(1:3) =   "008"     )) AND
                      ( ACCT-ZAITEN      NOT =   ZERO       ) AND
                      ( ACCT-SYUTEN1         =   ZERO       ) AND
                      ( ACCT-ZAIKAISU    NOT =   ZERO       ))
              OR     ((ACCT-SRYKBN = "40" OR "50" OR "54" OR
                                     "60" OR "64" OR "70" OR
                                     "80"                   ) AND
                      (ACCT-ZAITEN       NOT =  ZERO        ) AND
                      (ACCT-ZAIKAISU     NOT =  ZERO        ) AND
                      (ACCT-YKZTEN           =  ZERO        ) AND
                      (SRY-SRYCD(IDX2)(1:1)  =  "6"         ))
      *
               CONTINUE
      *
              ELSE
      *
               ADD     1                  TO    IDX4    
      *
               MOVE    SRY-SRYCD(IDX2)    TO    RECE65-SRYCD(IDX4)
      *
               IF      SRY-SRYKBN         =     "13"
                   IF   SRY-SRYCD(IDX2)   =     CONS-SIDORYO1    OR
                                                CONS-SIDORYO2    OR
                                                CONS-SIDORYO3    OR
                                                CONS-SIDORYO4    OR
                                                CONS-SIDORYO5    OR
                                                CONS-SIDORYO6
                        MOVE   "1"        TO    RECE62-BEDSUFLG
                   END-IF
               END-IF
      *
               IF     SRY-SRYCD(IDX2)      =    CONS-GAIJINKEN
                  MOVE   "1"              TO    RECE62-KENTAIKASANFLG
                  MOVE   99               TO    RECE64-KNSJISGRPKBN
               END-IF
               IF     RECE64-KNSJISGRPKBN  =    ZERO
                 IF    TNS-KNSJISGRPKBN = 1 OR 2 OR 3 OR 4 OR 5 OR 6
                  MOVE  TNS-KNSJISGRPKBN  TO    RECE64-KNSJISGRPKBN
                 END-IF
               END-IF
      *
      ***      IF     SRY-SRYCD(IDX2)  =  "190128410" OR "190128310"
      ***                                             OR "190128570"
      ***         MOVE      1             TO    RECE64-NYUKSNFLG
      ***      END-IF
      *
               IF    ( SRY-SRYKBN         =     "60" OR "64" )
               AND   ( TNS-KNSJISKBN      =      2           )
                   MOVE    TNS-KNSJISKBN        TO  RECE64-KNSJISKBN
               END-IF
      *
               IF    ( SRY-SRYKBN   =  "14" OR "21" OR "22" OR "23" )
               AND   ( RECE64-ZAITEN     =     ZERO                 )
               AND   ( RECE64-SAFLG      =     SPACE                )
               AND   ( ACCT-ZAIKBN   NOT =     1                    )
                  IF   SRY-SRYCD(IDX2)   =     "820000046"
                     MOVE     "1"         TO    RECE64-SAFLG
                  END-IF
               END-IF
      *
               IF    ( SRY-SRYKBN   =  "21" OR "22" OR "23" )
               AND   ( RECE64-ZAITEN     =     ZERO         )
               AND   ( ACCT-ZAIKBN   NOT =     1            )
                  IF     RECE64-SAFLG   NOT =  SPACE
                        MOVE   SPACE      TO    RECE64-TOYAKUFLG
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                      IF   RECE64-TOYAKUFLG = SPACE
                        MOVE    "2"       TO    RECE64-TOYAKUFLG
                      END-IF
                    ELSE
                        MOVE    "1"       TO    RECE64-TOYAKUFLG
                    END-IF
                  END-IF
               END-IF
      *
               IF    ( SRY-SRYKBN        =     "14" )
               AND   ( RECE64-ZAITEN     =     ZERO )
               AND   ( ACCT-ZAIKBN   NOT =     1    )
                  IF     RECE64-SAFLG   NOT =  SPACE
                        MOVE   SPACE      TO    RECE64-TOYAKUFLG
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   SRY-SRYSYUKBN  =  "148" OR "149"
                          IF   RECE64-TOYAKUFLG = SPACE
                            MOVE   "2"    TO    RECE64-TOYAKUFLG
                          END-IF
                        END-IF
                    ELSE
                        MOVE    "1"       TO    RECE64-TOYAKUFLG
                    END-IF
                  END-IF
               END-IF
      *
               IF     SRY-SRYCD(IDX2)  IS  NUMERIC
      *          IF  SRY-SRYCD(IDX2)(1:3) NOT = "001"
                   MOVE    SRY-SRYCD(IDX2)   TO  WRK-SRYCD
      *
                   MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                   PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                             UNTIL   FUKA-IDX   >    9
                     MOVE   SRY-SRYCD(IDX2)(FUKA-IDX:1)
                                             TO  WRK-FUKA-VALUE
                     IF  WRK-FUKA-VALUE  =  ZERO
                       CONTINUE
                     ELSE
                       COMPUTE  RECE64-RUIKEITOTAL  =
                                RECE64-RUIKEITOTAL  +
                              ( WRK-FUKA-VALUE    * WRK-SRYCD)
                       COMPUTE  WRK-FUKA-KINGAKU    =
                                WRK-FUKA-KINGAKU    +
                              ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                                  * SRY-SRYSURYO(IDX2))
                     END-IF
                   END-PERFORM
                   COMPUTE  RECE64-RUIKEITOTAL  =
                            RECE64-RUIKEITOTAL  +
                            WRK-FUKA-KINGAKU
      *
                   MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                   PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                             UNTIL   FUKA-IDX   >   10
                     MOVE   SRY-SRYSURYO(IDX2)(FUKA-IDX:1)
                                             TO  WRK-FUKA-VALUE
                     IF  WRK-FUKA-VALUE  =  ZERO
                       CONTINUE
                     ELSE
                       COMPUTE  WRK-FUKA-KINGAKU  =
                                WRK-FUKA-KINGAKU  +
                              ((WRK-FUKA-VALUE^4) * FUKA-IDX)
                     END-IF
                   END-PERFORM
                   COMPUTE  RECE64-RUIKEITOTAL  =
                            RECE64-RUIKEITOTAL  +
                            WRK-FUKA-KINGAKU
      *          END-IF
               END-IF
      *
               MOVE    SRY-SRYSURYO(IDX2) TO    RECE65-SRYSURYO(IDX4)
               MOVE    SRY-SRYKAISU(IDX2) TO    RECE65-SRYKAISU(IDX4)
               MOVE    SRY-MEISKYFLG(IDX2) TO   RECE65-MEISKYFLG(IDX4)
               MOVE    SRY-AUTOKBN(IDX2)  TO    RECE65-AUTOKBN(IDX4)
               MOVE    SRY-INPUTNUM(IDX2) TO    RECE65-INPUTNUM(IDX4)
      *
               IF      SRY-SRYKBN = "40" OR "50" OR "54" OR "60" OR "64"
                  IF   SRY-SRYCD(IDX2)(1:1)  =  "7"
                  AND  TNS-DATAKBN           =  "3"
                         COMPUTE WRK-FILMTEN2   =
                                (TNS-TEN  * SRY-SRYSURYO(IDX2) / 10)
                         IF   TNS-JGNTEN  NOT =  ZERO
                         AND  TNS-JGNTEN   <  WRK-FILMTEN2
                             COMPUTE  WRK-FILMTEN  =
                                      WRK-FILMTEN  +
                                      TNS-JGNTEN
                         ELSE
                             COMPUTE  WRK-FILMTEN  =
                                      WRK-FILMTEN  +
                                      WRK-FILMTEN2
                         END-IF
                  END-IF
               END-IF
      *
               IF      RECE62-RECESYUBETU  =  8888
               AND     SYS-2005-JIHITEKKSIKBN  =  "1"
                 IF      SRY-SRYKBN    =     "95" OR "96"
                   IF      SRY-SRYCD(IDX2)(1:3)  =  "095" OR "096"
                     IF      SRY-SRYCD(IDX2)(1:5)  =  "09500" OR "09600"
                                                  OR  "09591" OR "09691"
                                                  OR  "09592" OR "09692"
                                                  OR  "09593" OR "09693"
                                                  OR  "09594" OR "09694"
                          CONTINUE
                     ELSE
                       IF     TNS-TEN     NOT =  ZERO
                          ADD     TNS-TEN    TO   RECE64-SYUTEN1
                          MOVE    "1"        TO   RECE62-JIHTEKFLG
                       END-IF
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               IF      TNS-SRYKBN         =     "80"
                   IF  TNS-NYUTENTTLKBN   =     130
                       MOVE   "13"        TO    RECE64-SRYKBN
                                                RECE65-SRYKBN
                   END-IF
               END-IF
      *
               PERFORM  2101211-RECE65-TENSOU-COMCNT-HEN-SEC
      *
               IF  SRY-SRYCD(IDX2)        =     CONS-ZANHAIKI           
                IF   ACCT-ZAIKBN  =  1
                  MOVE    "1"             TO  RECE65-RECEDENFLG(IDX4)
                  MOVE    "1"             TO  RECE65-RECEPTFLG(IDX4)
                  MOVE    ZERO            TO  RECE65-SRYSURYO(IDX4)
                ELSE
                  COMPUTE WRK-SRYSURYO2   =     WRK-SRYSURYO            
                                          +     0.99999                   
                  COMPUTE RECE65-SRYSURYO(IDX4)                         
                                          =     WRK-SRYSURYO2           
                                          -     WRK-SRYSURYO            
                  IF  RECE65-SRYSURYO(IDX4)  NOT = ZERO                 
                    MOVE  WRK-TANICD      TO    RECE65-TANICD(IDX4)     
                    MOVE  WRK-TANIMOJISU  TO    RECE65-TANIMOJISU(IDX4) 
                    MOVE  WRK-TANINAME    TO    RECE65-TANINAME(IDX4)   
                    IF    RECE65-RENNUM  >  1                           
                    AND   IDX4           =  1                           
                      MOVE    1           TO    FLG-ZANHAIKI            
                      COMPUTE  WRK-RENNUM  =  RECE65-RENNUM  -  1       
                      MOVE WRK-SRYSURYO2  TO  WRK-SRYSURYO3             
                    ELSE                                                
                      MOVE WRK-SRYSURYO2  TO  RECE65-SRYSURYO(IDX4 - 1) 
                    END-IF
                  ELSE
                    MOVE  "1"             TO  RECE65-RECEDENFLG(IDX4)
                    MOVE  "1"             TO  RECE65-RECEPTFLG(IDX4)
                  END-IF                                                
                END-IF
               ELSE                                                     
                  MOVE    SRY-SRYSURYO(IDX2)                            
                                          TO    WRK-SRYSURYO            
                  IF   TNS-TANICD  NOT = SPACE AND "000"
                    MOVE  TNS-TANICD      TO    RECE65-TANICD(IDX4)
                                                WRK-TANICD
                  END-IF
                  MOVE    TNS-TANIMOJISU  TO    RECE65-TANIMOJISU(IDX4)
                                                WRK-TANIMOJISU          
                  MOVE    TNS-TANINAME    TO    RECE65-TANINAME(IDX4)
                                                WRK-TANINAME            
               END-IF                                                   
               MOVE       TNS-TENSIKIBETU TO    RECE65-TENSIKIBETU(IDX4)
               MOVE       TNS-TEN         TO    RECE65-TEN(IDX4)
               MOVE    TNS-NYUTENTTLKBN   TO    RECE65-TENTTLKBN(IDX4)
               IF     (SRY-SRYCD    (IDX2)(1:1)     =   "8"  )
               OR     (SRY-SRYCD    (IDX2)(1:3)     =   "008")
                  MOVE ZERO               TO    RECE65-YUKOKETA(IDX4)
               ELSE
                  MOVE TNS-YUKOKETA       TO    RECE65-YUKOKETA(IDX4)
               END-IF
               MOVE    TNS-DATAKBN        TO    RECE65-DATAKBN (IDX4)
               MOVE    TNS-HOUKNSKBN      TO    RECE65-HOUKNSKBN(IDX4)
               MOVE    TNS-KNSJISKBN      TO    RECE65-KNSJISKBN(IDX4)
               MOVE    TNS-CDKBN-KBN      TO    RECE65-CDKBN-KBN(IDX4)
               MOVE    TNS-CDKBN-SYO      TO    RECE65-CDKBN-SYO(IDX4)
               MOVE    TNS-CDKBN-BU       TO    RECE65-CDKBN-BU(IDX4)
               MOVE    TNS-CDKBN-KBNNUM   
                                      TO RECE65-CDKBN-KBNNUM(IDX4)
               MOVE    TNS-CDKBN-KBNNUM-EDA
                                      TO RECE65-CDKBN-KBNNUM-EDA(IDX4)
               MOVE    TNS-CDKBN-KOUBAN
                                      TO RECE65-CDKBN-KOUBAN(IDX4)
               MOVE    TNS-KOUHYOJYUNNUM  
                                      TO RECE65-KOUHYOJYUNNUM(IDX4)
               MOVE    TNS-SRYSYUKBN  TO RECE65-SRYSYUKBN-X  (IDX4)
               MOVE    TNS-KOKUJISKBKBN1  
                                      TO RECE65-KOKUJISKBKBN1(IDX4)
               MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE65-KOKUJISKBKBN2(IDX4)
               MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE65-TUSOKUGAIKBN (IDX4)
               MOVE    TNS-TIMEKSNKBN TO RECE65-TIMEKSNKBN   (IDX4)
               MOVE    TNS-KZMCOMPSIKIBETU
                                      TO RECE65-KZMCOMPSIKIBETU(IDX4)
               MOVE    TNS-CHUKSNCD   TO RECE65-CHUKSNCD       (IDX4)
               MOVE    TNS-CHUKSNTUBAN
                                      TO RECE65-CHUKSNTUBAN    (IDX4)
               MOVE    TNS-KENTAICOMMENT
                                      TO RECE65-KENTAICOMMENT  (IDX4)
               MOVE    TNS-KNSJISGRPKBN
                                      TO RECE65-KNSJISGRPKBN   (IDX4)
               MOVE    TNS-TOKUKIZAISBT1
                                      TO RECE65-TOKUKIZAISBT1  (IDX4)
               MOVE    TNS-SANSOKBN   TO RECE65-SANSOKBN       (IDX4)
               IF      TNS-SRYCD (1:2)   =   "84"
                   PERFORM VARYING IDYY    FROM    1   BY  1
                           UNTIL   IDYY    >       10
                       MOVE    TNS-SSTKIJUNCD (IDYY)
                                           TO  RECE65-SSTKIJUNCD
                                                   (IDX4 IDYY)
                   END-PERFORM
               END-IF
      *
               IF    (TNS-SRYCD       =  "170022290"  OR
                                         "170022390"  OR
                                         "170022490")
               AND   (RECE62-SRYYM   <=  "201003"   )
                      MOVE   202      TO  RECE65-CDKBN-KBNNUM(IDX4)
                      MOVE   99       TO  RECE65-CDKBN-KOUBAN(IDX4)
               END-IF
               IF     TNS-SRYCD       =  "170016010"  OR
                                         "170020270"  OR  "170024470" OR
                                         "170024910"  OR  "170025010" OR
                                         "170025210"  OR  "170025310" OR
                                         "170025410"  OR  "170025510" OR
                                         "170025610"  OR  "170025710" OR
                                         "170025810"  OR  "170025910" OR
                                         "170026010"  OR  "170026110" OR
                                         "170026210"  OR  "170026310" OR
                                         "170026810"  OR
                                         "170000210"  OR  "170016910" OR
                                         "170017010"  OR  "170026710" OR
                                         "170028810"
                      MOVE   203      TO  RECE65-CDKBN-KBNNUM(IDX4)
                      MOVE   99       TO  RECE65-CDKBN-KOUBAN(IDX4)
               END-IF
      *
               IF    (TNS-SRYCD       =  "170022290")
               AND   (RECE62-SRYYM   >=  "201004"   )
                      MOVE   "1"      TO  RECE64-GAZOGEN
               END-IF
      *
               IF    ((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                      (SRY-SRYCD    (IDX2)(1:3)     =   "008"))
               AND   ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  )
                   MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
                   MOVE    SRY-PTID             TO  PTCOM-PTID
                   MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
                   MOVE    SRY-SRYCD (IDX2)     TO  PTCOM-SRYCD
                   MOVE    SRY-INPUTNUM(IDX2)   TO  PTCOM-RENNUM
                   PERFORM 950-PTCOM-READ-SEC
                   MOVE    PTCOM-INPUTCOMENT   TO   RECE65-NAME(IDX4)
                                                    RECE65-INPUTCOMENT
                                                                (IDX4)
      *            
                   IF      SRY-SRYCD (IDX2)(1:1)
                                                =   "8"
                       IF      PTCOM-INPUTCHI1     =   SPACE
                           INITIALIZE                  ORCSKANACHKAREA
                           MOVE    "2"             TO  KANACHK-SYORI 
                           MOVE    TNS-NAME        TO  KANACHK-MAE-INPUT
                           CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                           IF    ( KANACHK-RC      =   ZERO )
                           AND   ( KANACHK-MAX     >   ZERO )
                               COMPUTE IDXX    =   KANACHK-MAX +   1
                               MOVE    PTCOM-INPUTCOMENT (IDXX:)
                                                       TO
                                           RECE65-INPUTCOMENT   (IDX4)
                           ELSE
                               MOVE    PTCOM-INPUTCOMENT
                                                       TO
                                           RECE65-INPUTCOMENT   (IDX4)
                           END-IF
                       ELSE
                           INITIALIZE              ORCSKANACHKAREA
                           MOVE    "2"             TO  KANACHK-SYORI 
                           STRING  PTCOM-INPUTCHI1 DELIMITED  BY  SPACE
                                   PTCOM-INPUTCHI2 DELIMITED  BY  SPACE
                                   PTCOM-INPUTCHI3 DELIMITED  BY  SPACE
                                   PTCOM-INPUTCHI4 DELIMITED  BY  SPACE
                                   INTO   KANACHK-MAE-INPUT
                           END-STRING
                           CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                           IF      KANACHK-RC      =   ZERO
                               MOVE    KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                                   TO
                                           RECE65-INPUTCOMENT   (IDX4)
                           END-IF
                       END-IF
                   END-IF
      *
      ***          MOVE   "1"                  TO    RECE64-COMCDFLG
               ELSE
                   MOVE    TNS-NAME            TO    RECE65-NAME(IDX4)
                                                     RECE65-INPUTCOMENT
                                                                (IDX4)
                   MOVE    TNS-YUKOKETA    TO    RECE65-YUKOKETA(IDX4)
                   IF      TNS-SRYCD       =     CONS-RJNRIGAKU1  OR
                                                 CONS-RJNRIGAKU2  OR
                                                 CONS-RJNRIGAKU3  OR
                                                 CONS-RJNRIGAKU4  OR
                                                 CONS-RJNRIGAKU5  OR
                                                 CONS-RJNRIGAKU6  OR
                                                 CONS-RJNRIGAKU7  OR
                                                 CONS-RJNRIGAKU8
                         MOVE  "老人"    TO   RECE65-NAME(IDX4)(1:4)
                         MOVE  TNS-NAME  TO   RECE65-NAME(IDX4)(5:) 
                         COMPUTE  RECE65-YUKOKETA(IDX4) =
                                  RECE65-YUKOKETA(IDX4) + 2
                   END-IF
               END-IF
      *
               IF  SRY-SRYCD(IDX2)        =     CONS-ZANHAIKI
                  IF  RECE65-SRYSURYO(IDX4)  NOT = ZERO
                    PERFORM  2101213-RECE65-TENSOU-SURYO-HEN-SEC
      *
                    MOVE    SPACE      TO  RECE65-NAME(IDX4)
                    MOVE    SPACE      TO  RECE65-INPUTCOMENT(IDX4)
                    STRING  TNS-NAME          DELIMITED  BY  " "
      ***                   "  "              DELIMITED  BY  SIZE
                            "　"              DELIMITED  BY  SIZE
                            WRK-SRYSURYOW     DELIMITED  BY  " "
                            RECE65-TANINAME(IDX4)
                                              DELIMITED  BY  " "
                            INTO              RECE65-NAME(IDX4)
                    END-STRING
                    MOVE  RECE65-NAME(IDX4)
                                       TO  RECE65-INPUTCOMENT(IDX4)
      *
      ***           MOVE  "810000001"  TO  RECE65-SRYCD(IDX4)
                    MOVE  ZERO         TO  RECE65-SRYSURYO(IDX4)
                    MOVE  ZERO         TO  RECE65-TANICD(IDX4)
                    MOVE  ZERO         TO  RECE65-TANIMOJISU(IDX4)
                    MOVE  SPACE        TO  RECE65-TANINAME(IDX4)
                    MOVE  ZERO         TO  RECE65-YUKOKETA(IDX4)
                    MOVE  "2"          TO  RECE65-MEISKYFLG(IDX4)
                  END-IF
               END-IF
      *
               IF    (SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                     (SRY-SRYCD    (IDX2)(1:3)     =   "008")
                        MOVE     "1"       TO    RECE64-COMCDFLG
               END-IF
      *
               IF  ( SRY-SRYKBN     =  "60" OR "64" )
               AND ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                    (SRY-SRYCD(IDX2)(1:3)  =  "008"))
               AND ( FLG-KENSA-COM  =   ZERO        )
                 IF  SRY-SRYCD(IDX2) = "840000085" OR "840000087"
                    CONTINUE
                 ELSE
                    PERFORM  VARYING  IDV2  FROM  1  BY  2
                              UNTIL  (IDV2           >   200)
                               OR    (FLG-KENSA-COM  =    1 )
                      IF  RECE65-NAME(IDX4)(IDV2:2)   =  "日"
                        MOVE   SPACE  TO  RECE64-FLG-KENSA-COMMENT
                        MOVE     1    TO  FLG-KENSA-COM
                      END-IF
                    END-PERFORM
                 END-IF
               END-IF
      *
               IF  SRY-SRYCD(IDX2)(1:3)     =   "058"
                 MOVE  TNS-FORMALYUKOKETA TO  RECE65-YUKOKETA(IDX4)
                 MOVE  TNS-FORMALNAME     TO  RECE65-NAME(IDX4)
                                              WRK-FORMALNAME
                 MOVE  "1"                TO  RECE65-RECEDENFLG(IDX4)
      *
                 MOVE     TNS-TEN         TO  WRK-KZI058-TEN
                 IF   TNS-TANICD  NOT = SPACE AND "000"
                    MOVE  TNS-TANICD      TO  WRK-KZI058-TANICD
                    MOVE  TNS-TANIMOJISU  TO  WRK-KZI058-TANIMOJISU
                    MOVE  TNS-TANINAME    TO  WRK-KZI058-TANINAME
                 END-IF
                 MOVE     ZERO            TO  RECE65-TEN(IDX4)
                 MOVE     ZERO            TO  RECE65-TANICD(IDX4)
                 MOVE     ZERO            TO  RECE65-TANIMOJISU(IDX4)
                 MOVE     SPACE           TO  RECE65-TANINAME(IDX4)
               END-IF
               IF  (SRY-SRYCD(IDX2)(1:1)    =   "7")
               AND (SRY-MEISKYFLG(IDX2)     =   "1")
                 IF   (SRY-SRYKBN  =   "70")
                 AND  (TNS-DATAKBN =   "3" )
                    IF    RECE65-RENNUM  >  1
                    AND   IDX4           =  1
                      MOVE    1           TO  FLG-FORMAL-KISAI
                      COMPUTE  WRK-RENNUM2 =  RECE65-RENNUM  -  1
                    ELSE
                      MOVE  "1"           TO  RECE65-RECEPTFLG(IDX4 - 1)
                    END-IF
                 ELSE
                    MOVE  WRK-FORMALNAME  TO  RECE65-RECEDENNAME(IDX4)
                    MOVE  "1"             TO  RECE65-RECEHENFLG(IDX4)
                    IF    WRK-KZI058-TEN  NOT = ZERO
                       MOVE   WRK-KZI058-TEN
                                          TO  RECE65-TEN(IDX4)
                    END-IF
                    IF   (RECE65-TANICD(IDX4)    = ZERO)
                    AND  (WRK-KZI058-TANICD  NOT = ZERO)
                       MOVE   WRK-KZI058-TANICD
                                          TO  RECE65-TANICD(IDX4)
                       MOVE   WRK-KZI058-TANIMOJISU
                                          TO  RECE65-TANIMOJISU(IDX4)
                       MOVE   WRK-KZI058-TANINAME
                                          TO  RECE65-TANINAME(IDX4)
                    END-IF
                 END-IF
               END-IF
      *
               IF  (SRY-SRYKBN         =  "99"       )
               AND (SRY-RENNUM         =   1         )
               AND (IDX2               =   1         )
               AND (SRY-SRYCD(IDX2)    =  "099999902")
                    MOVE      1         TO  FLG-TAHOKEN
               END-IF
               IF  (FLG-TAHOKEN           =   1              )
               AND (SRY-RENNUM            =   1              )
               AND (IDX2                  =   2              )
               AND (SRY-SRYCD(IDX2)(1:4)  =  "0082"          )
               AND (TNS-NAME(1:14)        =  "保険名称変更：")
                  MOVE     "1"          TO  RECE65-RECEPTFLG(IDX4)
                  MOVE     "1"          TO  RECE65-RECEDENFLG(IDX4)
      *
                  MOVE      ZERO        TO  IDW3
                  PERFORM   VARYING   IDW   FROM   200   BY  -1
                             UNTIL    IDW     <    15
                       IF   TNS-NAME(IDW:1)  NOT =   SPACE
                           COMPUTE IDW6       =  (IDW / 2) - 7
                           MOVE    IDW        TO  IDW3
                           MOVE    1          TO  IDW
                       END-IF
                  END-PERFORM
                  IF     IDW3    NOT =  ZERO
                    MOVE  SPACE TO RECE65-NAME(IDX4 - 1)
                    COMPUTE   IDW4  =  IDW3  -  14
                    MOVE  TNS-NAME(15:IDW4)
                                TO RECE65-NAME(IDX4 - 1)(1:IDW4)
                    COMPUTE   IDW5  =  IDW4  +   1
                    MOVE  "にて診察料算定済"
                                TO RECE65-NAME(IDX4 - 1)(IDW5:16)
                    COMPUTE   RECE65-YUKOKETA(IDX4 - 1) =
                              RECE65-YUKOKETA(IDX4 - 1) -
                              3                         +
                              IDW6
                  END-IF
               END-IF
      *
               IF  RECE65-YUKOKETA(IDX4)  =  ZERO
                   PERFORM   VARYING   IDW   FROM   200   BY  -1
                           UNTIL   IDW   <   1
                       IF   RECE65-NAME(IDX4)(IDW:1)  NOT =   SPACE
                           COMPUTE RECE65-YUKOKETA(IDX4)  =
                                   IDW     /   2
                           MOVE    1          TO  IDW
                       END-IF
                   END-PERFORM
               END-IF
      *
      *        特定器材（画像診断のフィルム以外）のとき単価を編集
               IF      SRY-SRYCD (IDX2) (1:1)  =   "7"
      ***          IF   (( SRY-SRYKBN               =   "70" )  AND
      ***                ( TNS-DATAKBN              =   "3"  ))
                   IF   (  TNS-DATAKBN              =   "3"   )
                   OR   (  SRY-SRYCD (IDX2)         =
                                    CONS-FILM-YOUJI-KASAN  OR  
                                    CONS-SANSO             OR
                                    CONS-SANSO2               )
                       CONTINUE
                   ELSE
      *********        SET     TBL-SANSO           TO  1
      *                SEARCH      TBL-SANSO-OCC   VARYING   TBL-SANSO
      *                     AT  END
      *                         MOVE    ZERO            TO  FLG-SANSO-OK
      *                     WHEN    SRY-SRYCD (IDX2)    =   TBL-SANSO-SRYCD
      *                                                          (TBL-SANSO)
      *                         MOVE    1               TO  FLG-SANSO-OK
      *                END-SEARCH
      *********        IF      FLG-SANSO-OK        =   "1"
                     IF      TNS-TEN         =   ZERO
                       CONTINUE
                     ELSE
                       PERFORM 2101212-RECE65-TENSOU-TANKA-HEN-SEC
                       COMPUTE IDW =   RECE65-YUKOKETA(IDX4)  *  2 
                                                   +   3                    
                       MOVE    WRK-CHAR-N (1:WRK-CHAR-N-CNT)
                                                   TO
                                               RECE65-NAME(IDX4)(IDW:)   
                       COMPUTE RECE65-YUKOKETA(IDX4)
                                               =   RECE65-YUKOKETA(IDX4)
                                                   +   1   
                                                   +
                                                  (WRK-CHAR-N-CNT  /  2)
                     END-IF
                   END-IF
               END-IF
      *
               MOVE    ACCT-ZAIKBN  TO  RECE64-ZAIKBN
      *
               IF      ACCT-ZAIKBN       =     1
                 MOVE   ZERO        TO  RECE65-SRYSURYO(IDX4)
                 MOVE   ZERO        TO  RECE65-TANICD(IDX4)
                 MOVE   ZERO        TO  RECE65-TANIMOJISU(IDX4)
                 MOVE   SPACE       TO  RECE65-TANINAME(IDX4)
                 IF  (SRY-SRYCD(IDX2)(1:1) = "6" OR "7")
                 OR  (SRY-SRYCD(IDX2)(1:3) = "059"     )
                 OR  (SRY-SRYCD(IDX2)(1:2) = "63"      )
                     MOVE  "1"          TO  RECE64-COMCDFLG
                     MOVE  "810000001"  TO  RECE65-SRYCD(IDX4)
                 END-IF
               END-IF
               IF      ACCT-ZAIKBN       =     2
                 MOVE   ZERO        TO  RECE65-SRYSURYO(IDX4)
                 MOVE   ZERO        TO  RECE65-TANICD(IDX4)
                 MOVE   ZERO        TO  RECE65-TANIMOJISU(IDX4)
                 MOVE   SPACE       TO  RECE65-TANINAME(IDX4)
               END-IF
      *
               PERFORM  2101214-SETCOM-HENSYU-SEC
      *
              END-IF
             END-IF
            END-IF  
           END-PERFORM
      *
           IF    IDX4    NOT =   ZERO
               MOVE    1     TO    FLG-WRITE65X
           END-IF
      *
           .
       210121-RECE65-TENSOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトコメントフラグ編集処理
      *****************************************************************
       2101211-RECE65-TENSOU-COMCNT-HEN-SEC               SECTION.
      *
           IF      RECE64-SRYKBN      =     "11"
      *       初診（同日複数診療科）
              IF   SRY-SRYCD(IDX2)    =     CONS-SYODOU-COMMENT
              AND  FLG-SYODOU-COM     =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-SYODOU-COMMENT
                   MOVE   SRY-SRYKA   TO    RECE64-SYODOU-SRYKA(1)
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-SYODOU2-COMMENT
                   MOVE  SPACE  TO    RECE64-FLG-SYODOU-COMMENT
                   MOVE  SPACE  TO    RECE64-SYODOU-SRYKA(1)
                   MOVE    1    TO    FLG-SYODOU-COM
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "40"
      *       介達牽引（発症日記載）
              IF   RECE62-SRYYM      >=    "200604"
              AND  RECE62-SRYYM      <=    "200803"
                IF   SRY-SRYCD(IDX2)  =     CONS-KAITATU-COMMENT
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-KAITATU-COMMENT
                END-IF
              END-IF
      *
              IF   RECE62-SRYYM      >=    "201004"
      *         人工腎臓等
                IF   SRY-SRYCD(IDX2)  =     CONS-JINZOU1-COMMENT
                                        OR  CONS-JINZOU2-COMMENT
                                        OR  CONS-JINZOU3-COMMENT
                                        OR  CONS-JINZOU4-COMMENT
                                        OR  CONS-JINZOU5-COMMENT
                                        OR  CONS-JINZOU6-COMMENT
                                        OR  CONS-JINZOU7-COMMENT
                                        OR  CONS-JINZOU8-COMMENT
                        MOVE   "1"    TO    RECE64-FLG-JINZOU-COMMENT
                END-IF
      *         局所陰圧閉鎖処置
                IF   SRY-SRYCD(IDX2)  =     CONS-KYOKUIN1-COMMENT
                                        OR  CONS-KYOKUIN2-COMMENT
                                        OR  CONS-KYOKUIN3-COMMENT
                                        OR  CONS-KYOKUIN4-COMMENT
                        MOVE   "1"    TO    RECE64-FLG-KYOKUIN-COMMENT
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "80"
      *       リハビリ
              IF   SRY-SRYCD(IDX2)    =     "180706910"   OR
                                            "180022210"   OR
                                            "180706810"   OR
                                            "180022110"   OR
                                            "180707110"   OR
                                            "180022410"   OR
                                            "180707010"   OR
                                            "180022310"   OR
                                            "180707310"   OR
                                            "180022610"   OR
                                            "180707210"   OR
                                            "180022510"   OR
                                            "180707510"   OR
                                            "180022810"   OR
                                            "180707410"   OR
                                            "180022710"   OR
                                            "180708210"   OR
                                            "180023710"   OR
                                            "180708410"   OR
                                            "180023910"   OR
                                            "180708110"   OR
                                            "180023610"   OR
                                            "180708310"   OR
                                            "180023810"   OR
                                            "180024910"   OR
                                            "180024810"   OR
                                            "180025110"   OR
                                            "180025010"   OR
                                            "180025510"   OR
                                            "180025410"
      ****              MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-RIHABIRI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-SINDAI1-COMMENT  OR
                                            CONS-SINDAI2-COMMENT  OR
                                            CONS-SINDAI3-COMMENT  OR
                                            CONS-SINDAI4-COMMENT  OR
                                            CONS-KOKYUKI1-COMMENT OR
                                            CONS-KOKYUKI2-COMMENT OR
                                            CONS-KOKYUKI3-COMMENT OR
                                            CONS-KOKYUKI4-COMMENT OR
                                            CONS-NOUKE1-COMMENT   OR
                                            CONS-NOUKE2-COMMENT   OR
                                            CONS-NOUKE3-COMMENT   OR
                                            CONS-NOUKE4-COMMENT   OR
                                            CONS-NOUKE7-COMMENT   OR
                                            CONS-NOUKE8-COMMENT   OR
                                            CONS-NOUKE9-COMMENT   OR
                                            CONS-NOUKE10-COMMENT  OR
                                            CONS-UNDOKI1-COMMENT  OR
                                            CONS-UNDOKI2-COMMENT  OR
                                            CONS-UNDOKI3-COMMENT  OR
                                            CONS-UNDOKI4-COMMENT  OR
                                            CONS-UNDOKI7-COMMENT  OR
                                            CONS-SYOGAI1-COMMENT  OR
                                            CONS-SYOGAI2-COMMENT  OR
                                            CONS-SYOGAI3-COMMENT  OR
                                            CONS-GANKNJ-COMMENT
      ****              MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-RIHABIRI-COMMENT
              END-IF
              EVALUATE      SRY-SRYCD(IDX2)
                WHEN     CONS-SINDAI5-COMMENT
                        MOVE   "2"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     CONS-SINDAI6-COMMENT
                        MOVE   "3"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     CONS-KOKYUKI5-COMMENT
                        MOVE   "4"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     CONS-KOKYUKI6-COMMENT
                        MOVE   "5"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     CONS-NOUKE5-COMMENT
                        MOVE   "6"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     CONS-NOUKE6-COMMENT
                        MOVE   "7"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     CONS-UNDOKI5-COMMENT
                        MOVE   "8"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     CONS-UNDOKI6-COMMENT
                        MOVE   "9"    TO    RECE64-RIHABIRI-COMMENT
              END-EVALUATE
      *       リハビリ（発症日記載）
              IF   RECE62-SRYYM      >=    "200604"
                IF   SRY-SRYCD(IDX2)  =     CONS-SINDAI1-COMMENT
                                      OR    CONS-SINDAI2-COMMENT
                                      OR    CONS-SINDAI3-COMMENT
                                      OR    CONS-SINDAI4-COMMENT
                                      OR    CONS-SINDAI5-COMMENT
                                      OR    CONS-SINDAI6-COMMENT
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-SINDAI-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-KOKYUKI1-COMMENT
                                      OR    CONS-KOKYUKI2-COMMENT
                                      OR    CONS-KOKYUKI3-COMMENT
                                      OR    CONS-KOKYUKI4-COMMENT
                                      OR    CONS-KOKYUKI5-COMMENT
                                      OR    CONS-KOKYUKI6-COMMENT
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-KOKYUKI-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-NOUKE1-COMMENT
                                      OR    CONS-NOUKE2-COMMENT
                                      OR    CONS-NOUKE3-COMMENT
                                      OR    CONS-NOUKE4-COMMENT
                                      OR    CONS-NOUKE5-COMMENT
                                      OR    CONS-NOUKE6-COMMENT
                                      OR    CONS-NOUKE7-COMMENT
                                      OR    CONS-NOUKE8-COMMENT
                                      OR    CONS-NOUKE9-COMMENT
                                      OR    CONS-NOUKE10-COMMENT
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-NOUKE-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-UNDOKI1-COMMENT
                                      OR    CONS-UNDOKI2-COMMENT
                                      OR    CONS-UNDOKI3-COMMENT
                                      OR    CONS-UNDOKI4-COMMENT
                                      OR    CONS-UNDOKI5-COMMENT
                                      OR    CONS-UNDOKI6-COMMENT
                                      OR    CONS-UNDOKI7-COMMENT
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-UNDOKI-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-NANBYO-COMMENT
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-NANBYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-SYOGAI1-COMMENT
                                      OR    CONS-SYOGAI2-COMMENT
                                      OR    CONS-SYOGAI3-COMMENT
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-SYOGAI-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-SESSYOKU-COMMENT
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-SESSYOKU-COMMENT
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "13"
              IF   SRY-SRYCD(IDX2)    =     CONS-YAKUKAN-COMMENT1 OR
                                            CONS-YAKUKAN-COMMENT2 OR
                                            CONS-YAKUKAN-COMMENT3
                   MOVE   "1"   TO    RECE64-FLG-YAKUKAN-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-NYUEIYO-COMMENT
                   MOVE   "1"   TO    RECE64-FLG-NYUEIYO-COMMENT
              END-IF
      *
              IF  (SRY-SRYCD(IDX2)    =     CONS-HOUMON-COMMENT1  OR
                                            CONS-HOUMON-COMMENT2)
              AND (FLG-HOUMON-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE64-FLG-HOUMON-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-HOUMON-COMMENT3
                   MOVE  SPACE  TO    RECE64-FLG-HOUMON-COMMENT
                   MOVE    1    TO    FLG-HOUMON-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     CONS-SYOBYO-COMMENT
              AND  FLG-SYOBYO-COM     =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-SYOBYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-SYOBYO2-COMMENT
                                      OR    CONS-SYOBYO3-COMMENT
                   MOVE  SPACE  TO    RECE64-FLG-SYOBYO-COMMENT
                   MOVE    1    TO    FLG-SYOBYO-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     CONS-RYOYO-COMMENT
              AND  FLG-RYOYO-COM      =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-RYOYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-RYOYO2-COMMENT
                   MOVE  SPACE  TO    RECE64-FLG-RYOYO-COMMENT
                   MOVE    1    TO    FLG-RYOYO-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     CONS-TAIIN-COMMENT
                   MOVE   "1"   TO    RECE64-FLG-TAIIN-COMMENT
              END-IF
      *
              IF   RECE62-SRYYM      >=    "201004"
      *         介護支援連携指導料
                IF   SRY-SRYCD(IDX2)  =     CONS-KAISIEN-COMMENT
                        MOVE   "1"    TO    RECE64-FLG-KAISIEN-COMMENT
                END-IF
      *         集団栄養食事指導料
                IF   SRY-SRYCD(IDX2)  =     CONS-SYUEIYO-COMMENT
                        MOVE   "1"    TO    RECE64-FLG-SYUEIYO-COMMENT
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "14"
              IF   SRY-SRYCD(IDX2)    =     CONS-HOUSIJI-COMMENT
              AND  FLG-HOUSIJI-COM    =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-HOUSIJI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-HOUSIJI2-COMMENT
                   MOVE  SPACE  TO    RECE64-FLG-HOUSIJI-COMMENT
                   MOVE    1    TO    FLG-HOUSIJI-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     CONS-HINKAI-COMMENT
                   MOVE   "1"   TO    RECE64-FLG-HINKAI-COMMENT
              END-IF
      *
      ***     IF  (SRY-SRYCD(IDX2)    =     CONS-OSIN-COMMENT
      ***                             OR    CONS-OSIN2-COMMENT)
      ***     AND (FLG-OSIN-COM       =     ZERO              )
      ***          MOVE   "1"   TO    RECE64-FLG-OSIN-COMMENT
      ***     END-IF
      ***     IF   SRY-SRYCD(IDX2)    =     CONS-OSIN3-COMMENT
      ***          MOVE  SPACE  TO    RECE64-FLG-OSIN-COMMENT
      ***          MOVE    1    TO    FLG-OSIN-COM
      ***     END-IF
      *
              IF     WRK-SISETU613      =      1
                IF     RECE62-SRYYM    >=     "200604"
                  IF   SRY-SRYCD(IDX2)  =     CONS-ZAISIEN1    OR
                                              CONS-ZAISIEN2    OR
                                              CONS-ZAISIEN3
                       MOVE   "1"   TO    RECE62-COMCNTFLG
                       MOVE   "1"   TO    RECE64-FLG-ZAISIEN-COMMENT
                  END-IF
                END-IF
              ELSE
                IF   WRK-SISETU695      =      1
                  IF   RECE62-SRYYM    >=     "200804"
                    IF SRY-SRYCD(IDX2)  =     CONS-ZAISIEN1    OR
                                              CONS-ZAISIEN2    OR
                                              CONS-ZAISIEN3
                       MOVE   "1"   TO    RECE62-COMCNTFLG
                       MOVE   "2"   TO    RECE64-FLG-ZAISIEN-COMMENT
                    END-IF
                  END-IF
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "50"
              IF   RECE64-SYUTEN1     =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-SHUJUTU-COMMENT
              END-IF
              IF   SRY-SRYSYUKBN      =     "510"
                   MOVE   "1"   TO    RECE64-FLG-SHUJUTU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-SHUJUTU-COMMENT
                   MOVE   "1"   TO    RECE64-FLG-SHUJUTU-COMMENT
              END-IF
           END-IF
      *
           IF   RECE62-SRYYM      >=    "201004"
            IF     RECE64-SRYKBN      =     "54"
              IF   RECE64-SYUTEN1     =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-MASUI-COMMENT
              END-IF
            END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "70"
              IF  (SRY-SRYCD(IDX2)    =     CONS-CTMRI-COMMENT1  OR
                                            CONS-CTMRI-COMMENT2  OR
                                            CONS-CTMRI-COMMENT3  OR
                                            CONS-CTMRI-COMMENT4  OR
                                            CONS-CTMRI-COMMENT5  OR
                                            CONS-CTMRI-COMMENT6  OR
                                            CONS-CTMRI-COMMENT7  OR
                                            CONS-CTMRI-COMMENT8  OR
                                            CONS-CTMRI-COMMENT9  OR
                                            CONS-CTMRI-COMMENT10 OR
                                            CONS-CTMRI-COMMENT11 OR
                                            CONS-CTMRI-COMMENT12 OR
                                            CONS-CTMRI-COMMENT13 OR
                                            CONS-CTMRI-COMMENT14 OR
                                            CONS-CTMRI-COMMENT15 OR
                                            CONS-CTMRI-COMMENT16 OR
                                            CONS-CTMRI-COMMENT17)
              AND (RECE62-SRYYM       <     "201004"            )
                   MOVE   "1"   TO    RECE64-FLG-CTMRI-COMMENT
              END-IF
              IF  (SRY-SRYCD(IDX2)    =     CONS-CTMRI-COMMENT1  OR
                                            CONS-CTMRI-COMMENT2  OR
                                            CONS-CTMRI-COMMENT4  OR
                                            CONS-CTMRI-COMMENT6  OR
                                            CONS-CTMRI-COMMENT7  OR
                                            CONS-CTMRI-COMMENT18)
              AND (RECE62-SRYYM       >=    "201004"            )
                   MOVE   "1"   TO    RECE64-FLG-CTMRI-COMMENT
              END-IF
      *
              IF    SRY-SRYCD(IDX2)  =
                    "700010000" OR "700030000" OR "700050000" OR
                    "700080000" OR "700110000" OR "700140000" OR
                    "700290000" OR "700310000" OR "700330000" OR
                    "700710000" OR "700730000" OR "700750000" OR
                    "700780000" OR "700810000" OR "700840000" OR
                    "700870000" OR "700160000" OR "700180000" OR
                    "700190000" OR "700200000" OR "700210000" OR
                    "700220000" OR "700230000" OR "700240000" OR
                    "700250000" OR "700260000" OR "700270000" OR
                    "700280000" OR "700590000" OR "700600000" OR
                    "700630000" OR "700640000" OR "700650000" OR
                    "700680000" OR "729780000"
                IF    SRY-SRYKAISU(IDX2)  >   1
                   MOVE   "1"   TO    RECE64-FLG-FILM-COMMENT
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "80"
              IF   SRY-SRYCD(IDX2)    =     CONS-HOUSEI-COMMENT
              AND  FLG-HOUSEI-COM     =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-HOUSEI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-HOUSEI-COMMENT2
                   MOVE  SPACE  TO    RECE64-FLG-HOUSEI-COMMENT
                   MOVE    1    TO    FLG-HOUSEI-COM
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "90"  OR  "92"
              IF   SRY-SRYCD(IDX2)    =     CONS-KAKURI-COMMENT
                   MOVE   "1"   TO    RECE64-FLG-KAKURI-COMMENT
              END-IF
      *
              IF   RECE62-SRYYM      >=    "201004"
      *         栄養サポートチーム加算
                IF   SRY-SRYCD(IDX2)  =     CONS-EISAPO-COMMENT
                        MOVE   "1"    TO    RECE64-FLG-EISAPO-COMMENT
                END-IF
      *         呼吸ケアチーム加算
                IF   SRY-SRYCD(IDX2)  =     CONS-KOKKEA-COMMENT
                        MOVE   "1"    TO    RECE64-FLG-KOKKEA-COMMENT
                END-IF
      *         重症者加算（精神療養病棟入院料）
                IF   SRY-SRYCD(IDX2)  =     CONS-JYUSYO-COMMENT
                        MOVE   "1"    TO    RECE64-FLG-JYUSYO-COMMENT
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "60" OR "64"
              IF   (SRY-SRYCD(IDX2)   =     CONS-KENSA1-COMMENT
                                      OR    CONS-KENSA2-COMMENT
                                      OR    CONS-KENSA3-COMMENT)
              AND  (FLG-KENSA-COM     =     ZERO               )
                   MOVE   "1"   TO    RECE64-FLG-KENSA-COMMENT
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN   =  "14" OR "40" OR "50" OR "54"
                                   OR "60" OR "70" OR "80" OR "64"
              SET     TBL-SANSO    TO      1
              SEARCH      TBL-SANSO-OCC   VARYING   TBL-SANSO
                   AT  END
                       MOVE    ZERO            TO  FLG-SANSO-OK
                   WHEN    SRY-SRYCD (IDX2)    =   TBL-SANSO-SRYCD
                                                        (TBL-SANSO)
                       MOVE    1               TO  FLG-SANSO-OK
              END-SEARCH
              IF      FLG-SANSO-OK        =    1
                   MOVE   "1"   TO    RECE64-FLG-SANSO-COMMENT
              END-IF
           END-IF
      *
           .
       2101211-RECE65-TENSOU-COMCNT-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    酸素の単価編集処理
      *****************************************************************
       2101212-RECE65-TENSOU-TANKA-HEN-SEC     SECTION.
      *
      ***  IF      TNS-TEN         =   ZERO
      ***      GO  TO  2101212-RECE65-TENSOU-TANKA-HEN-EXT  
      ***  END-IF
      *
           MOVE    SPACE           TO  WRK-TANKA-X
      * 
      *    数字表示用編集（半角）
           MOVE    TNS-TEN         TO  WRK-TANKA
           MOVE    WRK-TANKA-S1    TO  WRK-TANKA-Z1
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDY3   FROM    2   BY  -1
                     UNTIL     IDY3           =   ZERO
             IF  WRK-TANKA-S2(IDY3:1) NOT =   ZERO
                 MOVE    1               TO  FLG-SP
             END-IF
             IF  FLG-SP                  =   1
                 MOVE    WRK-TANKA-S2(IDY3:1)
                                         TO  WRK-TANKA-Z3(IDY3:1)
             END-IF
           END-PERFORM
           IF  WRK-TANKA-Z3          NOT =   SPACE
               MOVE    "."               TO  WRK-TANKA-Z2
           END-IF
      *        
           INITIALIZE                      WRK-CHAR-HENKAN-AREA
           MOVE    WRK-TANKA-X         TO  WRK-CHAR-X
           MOVE    12                  TO  WRK-CHAR-CNT
           MOVE    1                   TO  WRK-CHAR-IDX
           MOVE    ZERO                TO  WRK-CHAR-N-CNT
      *     
           PERFORM VARYING     IDW     FROM    1   BY  1
                   UNTIL       IDW     >   WRK-CHAR-CNT
               IF      WRK-CHAR-X (IDW:1)  =   SPACE
                   CONTINUE
               ELSE        
                   IF    WRK-CHAR-X (IDW:1)  IS  NUMERIC
                       IF      WRK-CHAR-X (IDW:1)  =   "0"
                           MOVE    TBL-SUJI (10)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE
                           MOVE    WRK-CHAR-X (IDW:1)  TO  NUM-IDX
                           MOVE    TBL-SUJI (NUM-IDX)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF                    
                   ELSE
                       IF    WRK-CHAR-X (IDW:1)  =   "."
                           MOVE    "．"   TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE    
                           MOVE    "  "   TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF
                   END-IF    
                   ADD     2           TO  WRK-CHAR-IDX
                                           WRK-CHAR-N-CNT
               END-IF    
           END-PERFORM
      *
           IF      WRK-CHAR-N-CNT      >   ZERO
                   MOVE    "円"        TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                   ADD     2           TO  WRK-CHAR-N-CNT
           END-IF                             
      *
           .
       2101212-RECE65-TENSOU-TANKA-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    残量廃棄の数量編集処理
      *****************************************************************
       2101213-RECE65-TENSOU-SURYO-HEN-SEC     SECTION.
      *
           MOVE    SPACE           TO  WRK-SURYO-X
           MOVE    ZERO            TO  WRK-SURYOST
           MOVE    ZERO            TO  WRK-SURYOKETA
           MOVE    ZERO            TO  WRK-SURYOKETA1
           MOVE    ZERO            TO  WRK-SURYOKETA2
           MOVE    SPACE           TO  WRK-SURYO-N
           MOVE    SPACE           TO  WRK-SRYSURYOW
      *
      *    数字表示用編集（半角）
           MOVE    RECE65-SRYSURYO(IDX4)  TO  WRK-SURYO
           MOVE    WRK-SURYO-S1           TO  WRK-SURYO-Z1
      *
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDW   FROM    5   BY  -1
                      UNTIL    IDW   =   ZERO
             IF  WRK-SURYO-S2(IDW:1) NOT =   ZERO
                 MOVE    1         TO  FLG-SP
             END-IF
             IF  FLG-SP  =   1
                 MOVE    WRK-SURYO-S2(IDW:1)
                                   TO  WRK-SURYO-Z3(IDW:1)
             END-IF
           END-PERFORM
           IF  WRK-SURYO-Z3   NOT =  SPACE
               MOVE    "."         TO  WRK-SURYO-Z2
           END-IF
      *    表示文字数カウント
           PERFORM   VARYING   IDW   FROM    1   BY  1
                      UNTIL    IDW     >    11
             IF  WRK-SURYO-X(IDW:1)  NOT =  SPACE
                 IF  WRK-SURYOST           =   ZERO
                     MOVE    IDW   TO  WRK-SURYOST
                 END-IF
      *          数量桁数カウント(６桁目：ピリオド)
                 ADD     1         TO  WRK-SURYOKETA
                 IF  IDW    <   6
                     ADD     1     TO  WRK-SURYOKETA1
                 END-IF
                 IF  IDW    >   6
                     ADD     1     TO  WRK-SURYOKETA2
                 END-IF
             END-IF
           END-PERFORM
           IF  WRK-SURYOST  =   6
               MOVE   "0"          TO  WRK-SURYO-Z1(5:1)
               MOVE    5           TO  WRK-SURYOST
               MOVE    1           TO  WRK-SURYOKETA1
               ADD     1           TO  WRK-SURYOKETA
           END-IF
      *    全角変換
           IF  WRK-SURYOKETA1   >   ZERO
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z1(WRK-SURYOST:WRK-SURYOKETA1)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA1  TO  WRK-CHAR-CNT
      *
               MOVE    1               TO  WRK-CHAR-IDX
               PERFORM  VARYING  IDW   FROM    1   BY  1
                         UNTIL   IDW     >   WRK-CHAR-CNT
                   IF    WRK-CHAR-X(IDW:1)  IS  NUMERIC
                     IF    WRK-CHAR-X(IDW:1)  =   "0"
                        MOVE  TBL-SUJI(10)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     ELSE
                        MOVE  WRK-CHAR-X(IDW:1)  TO  NUM-IDX
                        MOVE  TBL-SUJI(NUM-IDX)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     END-IF
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
               END-PERFORM
      *
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N1
           END-IF
           IF  WRK-SURYOKETA2   >   ZERO
               MOVE    "．"            TO  WRK-SURYO-N2
      *
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z3(1:WRK-SURYOKETA2)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA2  TO  WRK-CHAR-CNT
      *
               MOVE    1               TO  WRK-CHAR-IDX
               PERFORM  VARYING  IDW   FROM    1   BY  1
                         UNTIL   IDW     >   WRK-CHAR-CNT
                   IF    WRK-CHAR-X(IDW:1)  IS  NUMERIC
                     IF    WRK-CHAR-X(IDW:1)  =   "0"
                        MOVE  TBL-SUJI(10)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     ELSE
                        MOVE  WRK-CHAR-X(IDW:1)  TO  NUM-IDX
                        MOVE  TBL-SUJI(NUM-IDX)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     END-IF
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
               END-PERFORM
      *
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N3
           END-IF
      *
           STRING      WRK-SURYO-N1    DELIMITED   BY  " "
                       WRK-SURYO-N2    DELIMITED   BY  " "
                       WRK-SURYO-N3    DELIMITED   BY  " "
                       INTO            WRK-SRYSURYOW
           END-STRING
      *
           .
       2101213-RECE65-TENSOU-SURYO-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    関係コメント編集
      *****************************************************************
       2101214-SETCOM-HENSYU-SEC     SECTION.
      *
           IF   RECE65-MEISKYFLG(IDX4)  =  "2"
              IF   (FLG-SETCOM              =  1   )
              AND  (RECE65-RECEDENFLG(IDX4) = SPACE)
                 MOVE  "1"            TO  RECE64-SETCOMFLG
              ELSE
                 MOVE  SPACE          TO  RECE65-MEISKYFLG(IDX4)
              END-IF
           ELSE
              IF   (RECE65-SRYCD(IDX4)(1:1) = "1" OR "6" OR "7")
              OR   (RECE65-SRYCD(IDX4)(1:3) = "059"            )
                IF  RECE65-SRYCD(IDX4)(1:2) = "63"
                 CONTINUE
                ELSE
                 MOVE   1             TO  FLG-SETCOM
                END-IF
              END-IF
           END-IF
      *
      *****
      *
      *    特定薬剤治療管理料
           IF    RECE65-SRYCD(IDX4)   = "113000410" OR "113000510" OR
                                        "180000110" OR "180000210"
                 MOVE   1             TO  WRK-SETCOM-JIDO
           END-IF
      *    特定薬剤治療管理加算（臓器移植月から３月）
           IF    RECE65-SRYCD(IDX4)   = "113000670"
                 MOVE   1             TO  WRK-SETCOM-JIDO2
           END-IF
      *    悪性腫瘍特異物質治療管理料
           IF    RECE65-SRYCD(IDX4)   = "113001210" OR "113001310" OR
                                        "113002110"
                 MOVE   3             TO  WRK-SETCOM-JIDO
           END-IF
      *
      *    初診（同日複数診療科）
           IF    RECE65-SRYCD(IDX4)   = CONS-SYODOU-COMMENT
                 MOVE   4             TO  WRK-SETCOM-JIDO
           END-IF
      *    傷病手当金意見書交付料
           IF    RECE65-SRYCD(IDX4)   = CONS-SYOBYO-COMMENT
                 MOVE   6             TO  WRK-SETCOM-JIDO
           END-IF
      *    療養費同意書交付料
           IF    RECE65-SRYCD(IDX4)   = CONS-RYOYO-COMMENT
                 MOVE   7             TO  WRK-SETCOM-JIDO
           END-IF
      *    訪問看護指示料
           IF    RECE65-SRYCD(IDX4)   = CONS-HOUSIJI-COMMENT
                 MOVE   11            TO  WRK-SETCOM-JIDO
           END-IF
      *    退院前訪問指導料
           IF    RECE65-SRYCD(IDX4)   = CONS-HOUMON-COMMENT1
                 MOVE   103           TO  WRK-SETCOM-JIDO
           END-IF
      *    精神科退院前訪問指導料
           IF    RECE65-SRYCD(IDX4)   = CONS-HOUSEI-COMMENT
                 MOVE   105           TO  WRK-SETCOM-JIDO
           END-IF
      *
           IF  ((WRK-SETCOM-JIDO    =  1                        ) AND
                (RECE65-SRYCD(IDX4) = "830000014" OR "840000038"))
           OR  ((WRK-SETCOM-JIDO2   =  1                        ) AND
                (RECE65-SRYCD(IDX4) = "840000077"               ))
           OR  ((WRK-SETCOM-JIDO    =  3                        ) AND
                (RECE65-SRYCD(IDX4) = "830000015"               ))
           OR  ((WRK-SETCOM-JIDO    =  4                        ) AND
                (RECE65-SRYCD(IDX4) = CONS-SYODOU2-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  6                        ) AND
                (RECE65-SRYCD(IDX4) = CONS-SYOBYO2-COMMENT
                                   OR CONS-SYOBYO3-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  7                        ) AND
                (RECE65-SRYCD(IDX4) = CONS-RYOYO2-COMMENT       ))
           OR  ((WRK-SETCOM-JIDO    =  11                       ) AND
                (RECE65-SRYCD(IDX4) = CONS-HOUSIJI2-COMMENT     ))
           OR  ((WRK-SETCOM-JIDO    =  103                      ) AND
                (RECE65-SRYCD(IDX4) = CONS-HOUMON-COMMENT3      ))
           OR  ((WRK-SETCOM-JIDO    =  105                      ) AND
                (RECE65-SRYCD(IDX4) = CONS-HOUSEI-COMMENT2      ))
      *
                 MOVE  "1"              TO  RECE64-SETCOMFLG
                 MOVE  "2"              TO  RECE65-MEISKYFLG(IDX4)
                 MOVE  WRK-SETCOM-JIDO  TO  RECE65-SETCOMATFLG(IDX4)
                 IF  (WRK-SETCOM-JIDO2   =  1         )
                 AND (RECE65-SRYCD(IDX4) = "840000077")
                   MOVE    2            TO  RECE65-SETCOMATFLG(IDX4)
                 END-IF
      *
           END-IF
      *
           .
       2101214-SETCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       210122-RECE62-HENSYU-SEC               SECTION.
      *
      *    公費の分離表示用インデックスの確定
           MOVE          ZERO       TO     BUN-IDX
      ***  IF    (RECE62-HKNNUM          NOT =   SPACE)   OR
           IF    (RECE62-HKNNUMHC(IDX1)  NOT =   SPACE)   OR
                 (RECE62-RJNHKNNUM       NOT =   SPACE)
           MOVE          1          TO     BUN-IDX
           END-IF
      *    インデックス２
           MOVE          ZERO       TO     BUN-IDX2
           IF  RECE62-HENTOTALTEN(2)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(2) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(2)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(1)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(1)
                           IF      RECE62-RECESKYKBN (1)       =   SPACE
                               MOVE      2       TO     BUN-IDX2
                           END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス３
           MOVE          ZERO       TO     BUN-IDX3
           IF  RECE62-HENTOTALTEN(3)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(3) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(3)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(2)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(2)
                           IF      RECE62-RECESKYKBN (2)       =   SPACE
                               MOVE      3       TO     BUN-IDX3
                           END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス４
           MOVE          ZERO       TO     BUN-IDX4
           IF  RECE62-HENTOTALTEN(4)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(4) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(4)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(3)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(3)
                           IF      RECE62-RECESKYKBN (3)       =   SPACE
                               MOVE      4       TO     BUN-IDX4
                           END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *
           PERFORM   VARYING  IDX3   FROM   1   BY   1
                     UNTIL    (IDX3         >     5)        OR
                              (SRY-SRYCD(IDX3)   =   SPACE)
               IF    SRY-RENNUM     =     1
                   IF  IDX3         =     1
                       MOVE  ACCT-ZAIKAISU     TO   WK-ZAIKAISU
                       MOVE  ACCT-ZAITEN       TO   WK-ZAITEN
                       IF    SRY-SRYKBN  =  "40"  OR  "50"  OR  "60"
                                        OR  "70"  OR  "80"  OR  "54"
                                        OR  "64"
                                MOVE   ACCT-SYUTEN1   TO   WK-SYUTEN
                                COMPUTE   WK-YKZTEN   =
                                                      ACCT-KIZAITEN  +
                                                      ACCT-YKZTEN
                       END-IF
                   ELSE
                       IF   SRY-SRYKBN   =  "21"  OR  "22"  OR  "23" OR
                                            "31"  OR  "32"  OR  "33" OR
                                            "40"  OR  "50"  OR  "54" OR
                                            "60"  OR  "70"  OR  "80" OR
                                            "13"  OR  "14"  OR  "64"
                           MOVE  ZERO          TO   WK-ZAIKAISU
                           MOVE  ZERO          TO   WK-ZAITEN
                           MOVE  ZERO          TO   WK-SYUTEN
                           MOVE  ZERO          TO   WK-KIZAITEN
                           MOVE  ZERO          TO   WK-YKZTEN
                       END-IF
                   END-IF
               ELSE
                     MOVE    ZERO     TO    WK-ZAIKAISU
                     MOVE    ZERO     TO    WK-ZAITEN
                     MOVE    ZERO     TO    WK-SYUTEN
                     MOVE    ZERO     TO    WK-KIZAITEN
                     MOVE    ZERO     TO    WK-YKZTEN
               END-IF
               IF   (ACCT-ZAITEN    NOT =    ZERO)    AND
                    (ACCT-ZAIKAISU  NOT =    ZERO)
                     PERFORM   2101221-RECE-LEFT-SET-SEC
               END-IF
               IF    SRY-SRYKBN   =   "21"   OR   "22"   OR   "23"   OR
                                      "31"   OR   "32"   OR   "33"   OR
                                      "40"   OR   "50"   OR   "54"   OR
                                      "60"   OR   "70"   OR   "13"   OR
                                      "14"   OR   "64"
                     MOVE    6      TO    IDX3
               END-IF
           END-PERFORM
      *
           .                                           
      *
       210122-RECE62-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       2101221-RECE-LEFT-SET-SEC               SECTION.
      *
           MOVE        SRY-SRYCD(IDX3)     TO   WRK-SRYCD
           MOVE        RECE65-SRYYM        TO   WK-TAIHI-SRYYM
           MOVE        WK-TAIHI-DAY        TO   WK-TAIHI-SRYD
           PERFORM     900-TENSU-TBL-SEC
           EVALUATE    SRY-SRYKBN
      *    初診のレセ点数欄の編集
               WHEN    "11"
                   IF   TNS-CHUKSNTUBAN   =   "0"
                        ADD   WK-ZAIKAISU  TO   RECE62-KAISU(1)
                   END-IF
      ***          IF   TNS-DATAKBN  =   2
      ***            EVALUATE    TNS-TIMEKSNKBN
      ***                WHEN    1
      ***                WHEN    5
      ***                    MOVE  "1"     TO   RECE62-SHOSHINTIME
      ***                WHEN    4
      ***                    MOVE  "2"     TO   RECE62-SHOSHINTIME
      ***                WHEN    3
      ***                    MOVE  "3"     TO   RECE62-SHOSHINTIME
      ***            END-EVALUATE
      ***          END-IF
      *************１：時間外　２：深夜　３：休日　４：時間外・深夜
      *************５：時間外・休日　６：休日・深夜
      *************７：時間外・休日・深夜
                   IF   TNS-DATAKBN  =   2
                     EVALUATE    TNS-TIMEKSNKBN
                         WHEN    1
                         WHEN    5
                         WHEN    6
                             EVALUATE   RECE62-SHOSHINTIME
                               WHEN   SPACE
                                  MOVE  "1"     TO   RECE62-SHOSHINTIME
                               WHEN   "1"
                                  CONTINUE
                               WHEN   "2"
                                  MOVE  "4"     TO   RECE62-SHOSHINTIME
                               WHEN   "3"
                                  MOVE  "5"     TO   RECE62-SHOSHINTIME
                               WHEN   "4"
                                  CONTINUE
                               WHEN   "5"
                                  CONTINUE
                               WHEN   "6"
                                  MOVE  "7"     TO   RECE62-SHOSHINTIME
                               WHEN   "7"
                                  CONTINUE
                             END-EVALUATE
                         WHEN    4
                             EVALUATE   RECE62-SHOSHINTIME
                               WHEN   SPACE
                                  MOVE  "2"     TO   RECE62-SHOSHINTIME
                               WHEN   "1"
                                  MOVE  "4"     TO   RECE62-SHOSHINTIME
                               WHEN   "2"
                                  CONTINUE
                               WHEN   "3"
                                  MOVE  "6"     TO   RECE62-SHOSHINTIME
                               WHEN   "4"
                                  CONTINUE
                               WHEN   "5"
                                  MOVE  "7"     TO   RECE62-SHOSHINTIME
                               WHEN   "6"
                                  CONTINUE
                               WHEN   "7"
                                  CONTINUE
                             END-EVALUATE
                         WHEN    3
                             EVALUATE   RECE62-SHOSHINTIME
                               WHEN   SPACE
                                  MOVE  "3"     TO   RECE62-SHOSHINTIME
                               WHEN   "1"
                                  MOVE  "5"     TO   RECE62-SHOSHINTIME
                               WHEN   "2"
                                  MOVE  "6"     TO   RECE62-SHOSHINTIME
                               WHEN   "3"
                                  CONTINUE
                               WHEN   "4"
                                  MOVE  "7"     TO   RECE62-SHOSHINTIME
                               WHEN   "5"
                                  CONTINUE
                               WHEN   "6"
                                  CONTINUE
                               WHEN   "7"
                                  CONTINUE
                             END-EVALUATE
                     END-EVALUATE
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE62-TENSU(1 BUN-IDX)  =
                                  RECE62-TENSU(1 BUN-IDX)  +
                                 (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE62-TENSU(1 BUN-IDX2)  =
                                  RECE62-TENSU(1 BUN-IDX2)  +
                                 (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE62-TENSU(1 BUN-IDX3)  =
                                  RECE62-TENSU(1 BUN-IDX3)  +
                                 (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE62-TENSU(1 BUN-IDX4)  =
                                  RECE62-TENSU(1 BUN-IDX4)  +
                                 (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
      *    指導のレセ点数欄の編集
               WHEN    "13"
                 IF  ACCT-ZAIKBN   =    2
                   IF    BUN-IDX        =   1
                       COMPUTE    WRK-RECE62G-TENSU(2 BUN-IDX)  =
                                  WRK-RECE62G-TENSU(2 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    WRK-RECE62G-TENSU(2 BUN-IDX2)  =
                                  WRK-RECE62G-TENSU(2 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    WRK-RECE62G-TENSU(2 BUN-IDX3)  =
                                  WRK-RECE62G-TENSU(2 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    WRK-RECE62G-TENSU(2 BUN-IDX4)  =
                                  WRK-RECE62G-TENSU(2 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                 ELSE
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE62-TENSU(2 BUN-IDX)  =
                                  RECE62-TENSU(2 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE62-TENSU(2 BUN-IDX2)  =
                                  RECE62-TENSU(2 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE62-TENSU(2 BUN-IDX3)  =
                                  RECE62-TENSU(2 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE62-TENSU(2 BUN-IDX4)  =
                                  RECE62-TENSU(2 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                 END-IF
      *    在宅のレセ点数欄の編集
               WHEN    "14"
                 IF  ACCT-ZAIKBN   =    2
                   IF    BUN-IDX        =   1
                       COMPUTE    WRK-RECE62G-TENSU(3 BUN-IDX)  =
                                  WRK-RECE62G-TENSU(3 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    WRK-RECE62G-TENSU(3 BUN-IDX2)  =
                                  WRK-RECE62G-TENSU(3 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    WRK-RECE62G-TENSU(3 BUN-IDX3)  =
                                  WRK-RECE62G-TENSU(3 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    WRK-RECE62G-TENSU(3 BUN-IDX4)  =
                                  WRK-RECE62G-TENSU(3 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                 ELSE
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE62-TENSU(3 BUN-IDX)  =
                                  RECE62-TENSU(3 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE62-TENSU(3 BUN-IDX2)  =
                                  RECE62-TENSU(3 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE62-TENSU(3 BUN-IDX3)  =
                                  RECE62-TENSU(3 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE62-TENSU(3 BUN-IDX4)  =
                                  RECE62-TENSU(3 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                 END-IF
      *    投薬のレセ点数欄の編集
               WHEN    "21"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF   SRY-SRYCD(IDX3)         =    CONS-YAKTEIGEN
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE62-TENSU(4 BUN-IDX)  =
                                     RECE62-TENSU(4 BUN-IDX)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE62-TENSU(4 BUN-IDX2)  =
                                     RECE62-TENSU(4 BUN-IDX2)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE62-TENSU(4 BUN-IDX3)  =
                                     RECE62-TENSU(4 BUN-IDX3)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE62-TENSU(4 BUN-IDX4)  =
                                     RECE62-TENSU(4 BUN-IDX4)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                     ELSE
                       ADD   WK-ZAIKAISU       TO   RECE62-KAISU(4)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE62-TENSU(4 BUN-IDX)  =
                                     RECE62-TENSU(4 BUN-IDX)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE62-TENSU(4 BUN-IDX2)  =
                                     RECE62-TENSU(4 BUN-IDX2)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE62-TENSU(4 BUN-IDX3)  =
                                     RECE62-TENSU(4 BUN-IDX3)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE62-TENSU(4 BUN-IDX4)  =
                                     RECE62-TENSU(4 BUN-IDX4)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                     END-IF
                   ELSE
                     IF   SRY-SRYCD(IDX3)     =    CONS-FUNSAI-COMMENT
                        ADD   WK-ZAIKAISU       TO   RECE62-KAISU(4)
                        IF    BUN-IDX        =   1
                            COMPUTE   RECE62-TENSU(4 BUN-IDX)  =
                                      RECE62-TENSU(4 BUN-IDX)  +
                                     (WK-ZAITEN   *   WK-ZAIKAISU)
                        END-IF
                        IF    BUN-IDX2       =   2
                            COMPUTE   RECE62-TENSU(4 BUN-IDX2)  =
                                      RECE62-TENSU(4 BUN-IDX2)  +
                                     (WK-ZAITEN   *   WK-ZAIKAISU)
                        END-IF
                        IF    BUN-IDX3       =   3
                            COMPUTE   RECE62-TENSU(4 BUN-IDX3)  =
                                      RECE62-TENSU(4 BUN-IDX3)  +
                                     (WK-ZAITEN   *   WK-ZAIKAISU)
                        END-IF
                        IF    BUN-IDX4       =   4
                            COMPUTE   RECE62-TENSU(4 BUN-IDX4)  =
                                      RECE62-TENSU(4 BUN-IDX4)  +
                                     (WK-ZAITEN   *   WK-ZAIKAISU)
                        END-IF
                     END-IF   
                   END-IF
               WHEN    "22"
                   ADD    WK-ZAIKAISU    TO   RECE62-KAISU(5)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(5 BUN-IDX)  =
                                 RECE62-TENSU(5 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(5 BUN-IDX2)  =
                                 RECE62-TENSU(5 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(5 BUN-IDX3)  =
                                 RECE62-TENSU(5 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(5 BUN-IDX4)  =
                                 RECE62-TENSU(5 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
               WHEN    "23"
                   ADD    WK-ZAIKAISU    TO   RECE62-KAISU(6)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(6 BUN-IDX)  =
                                 RECE62-TENSU(6 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(6 BUN-IDX2)  =
                                 RECE62-TENSU(6 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(6 BUN-IDX3)  =
                                 RECE62-TENSU(6 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(6 BUN-IDX4)  =
                                 RECE62-TENSU(6 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
      *    調剤のレセ点数欄の編集
               WHEN    "24"
                   IF  (SRY-SRYCD(IDX3)(1:1)   =   "8"  )
                   OR  (SRY-SRYCD(IDX3)(1:3)   =   "008")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE62-KAISU(7)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(7 BUN-IDX)  =
                                 RECE62-TENSU(7 BUN-IDX)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(7 BUN-IDX2)  =
                                 RECE62-TENSU(7 BUN-IDX2)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(7 BUN-IDX3)  =
                                 RECE62-TENSU(7 BUN-IDX3)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(7 BUN-IDX4)  =
                                 RECE62-TENSU(7 BUN-IDX4)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
      *    麻毒のレセ点数欄の編集
               WHEN    "26"
                   IF  (SRY-SRYCD(IDX3)(1:1)   =   "8"  )
                   OR  (SRY-SRYCD(IDX3)(1:3)   =   "008")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE62-KAISU(8)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(8 BUN-IDX)  =
                                 RECE62-TENSU(8 BUN-IDX)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(8 BUN-IDX2)  =
                                 RECE62-TENSU(8 BUN-IDX2)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(8 BUN-IDX3)  =
                                 RECE62-TENSU(8 BUN-IDX3)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(8 BUN-IDX4)  =
                                 RECE62-TENSU(8 BUN-IDX4)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
      *    調基のレセ点数欄の編集
               WHEN    "27"
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(9 BUN-IDX)  =
                                 RECE62-TENSU(9 BUN-IDX)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(9 BUN-IDX2)  =
                                 RECE62-TENSU(9 BUN-IDX2)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(9 BUN-IDX3)  =
                                 RECE62-TENSU(9 BUN-IDX3)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(9 BUN-IDX4)  =
                                 RECE62-TENSU(9 BUN-IDX4)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
      *    皮下筋肉内注射のレセ点数欄の編集
               WHEN    "31"
                   ADD    WK-ZAIKAISU     TO   RECE62-KAISU(10)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(10 BUN-IDX)  =
                                 RECE62-TENSU(10 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(10 BUN-IDX2)  =
                                 RECE62-TENSU(10 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(10 BUN-IDX3)  =
                                 RECE62-TENSU(10 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(10 BUN-IDX4)  =
                                 RECE62-TENSU(10 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
      *    静脈内注射のレセ点数欄の編集
               WHEN    "32"
                   ADD    WK-ZAIKAISU     TO   RECE62-KAISU(11)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(11 BUN-IDX)  =
                                 RECE62-TENSU(11 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(11 BUN-IDX2)  =
                                 RECE62-TENSU(11 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(11 BUN-IDX3)  =
                                 RECE62-TENSU(11 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(11 BUN-IDX4)  =
                                 RECE62-TENSU(11 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
      *    その他注射のレセ点数欄の編集
               WHEN    "33"
                   ADD    WK-ZAIKAISU     TO   RECE62-KAISU(12)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(12 BUN-IDX)  =
                                 RECE62-TENSU(12 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(12 BUN-IDX2)  =
                                 RECE62-TENSU(12 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(12 BUN-IDX3)  =
                                 RECE62-TENSU(12 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(12 BUN-IDX4)  =
                                 RECE62-TENSU(12 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
      *    処置のレセ点数欄の編集
               WHEN    "40"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE62-KAISU(13)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(13 BUN-IDX)  =
                                 RECE62-TENSU(13 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(13 BUN-IDX2)  =
                                 RECE62-TENSU(13 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(13 BUN-IDX3)  =
                                 RECE62-TENSU(13 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(13 BUN-IDX4)  =
                                 RECE62-TENSU(13 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(14 BUN-IDX)  =
                                 RECE62-TENSU(14 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(14 BUN-IDX2)  =
                                 RECE62-TENSU(14 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(14 BUN-IDX3)  =
                                 RECE62-TENSU(14 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(14 BUN-IDX4)  =
                                 RECE62-TENSU(14 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
      *    手術のレセ点数欄の編集
               WHEN    "50"
               WHEN    "54"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE62-KAISU(15)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(15 BUN-IDX)  =
                                 RECE62-TENSU(15 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(15 BUN-IDX2)  =
                                 RECE62-TENSU(15 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(15 BUN-IDX3)  =
                                 RECE62-TENSU(15 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(15 BUN-IDX4)  =
                                 RECE62-TENSU(15 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(16 BUN-IDX)  =
                                 RECE62-TENSU(16 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(16 BUN-IDX2)  =
                                 RECE62-TENSU(16 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(16 BUN-IDX3)  =
                                 RECE62-TENSU(16 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(16 BUN-IDX4)  =
                                 RECE62-TENSU(16 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
      *    検査のレセ点数欄の編集
               WHEN    "60"
               WHEN    "64"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE62-KAISU(17)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(17 BUN-IDX)  =
                                 RECE62-TENSU(17 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(17 BUN-IDX2)  =
                                 RECE62-TENSU(17 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(17 BUN-IDX3)  =
                                 RECE62-TENSU(17 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(17 BUN-IDX4)  =
                                 RECE62-TENSU(17 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    TNS-KNSJISKBN    =   2
                         COMPUTE   RECE62-KAISU(17)  =
                                   RECE62-KAISU(17)  -  
                                   WK-ZAIKAISU
                   END-IF
                   IF    TNS-SRYCD        =   CONS-SAIKETSU1  OR
                                              CONS-SAIKETSU2  OR
                                              CONS-SAIKETSU3
                         IF   RECE62-KAISU(17)  NOT =  ZERO
                              COMPUTE   RECE62-KAISU(17)  =
                                        RECE62-KAISU(17)  -   
                                        WK-ZAIKAISU
                         END-IF
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(18 BUN-IDX)  =
                                 RECE62-TENSU(18 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(18 BUN-IDX2)  =
                                 RECE62-TENSU(18 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(18 BUN-IDX3)  =
                                 RECE62-TENSU(18 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(18 BUN-IDX4)  =
                                 RECE62-TENSU(18 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
      *    画像診断のレセ点数欄の編集
               WHEN    "70"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE62-KAISU(19)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(19 BUN-IDX)  =
                                 RECE62-TENSU(19 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(19 BUN-IDX2)  =
                                 RECE62-TENSU(19 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(19 BUN-IDX3)  =
                                 RECE62-TENSU(19 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(19 BUN-IDX4)  =
                                 RECE62-TENSU(19 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(20 BUN-IDX)  =
                                 RECE62-TENSU(20 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(20 BUN-IDX2)  =
                                 RECE62-TENSU(20 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(20 BUN-IDX3)  =
                                 RECE62-TENSU(20 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(20 BUN-IDX4)  =
                                 RECE62-TENSU(20 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
      *    その他のレセ点数欄の編集
               WHEN    "80"
                   IF    BUN-IDX        =   1
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-TENSU(2 BUN-IDX)  =
                                     RECE62-TENSU(2 BUN-IDX)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         ELSE  
                           COMPUTE   RECE62-TENSU(21 BUN-IDX)  =
                                     RECE62-TENSU(21 BUN-IDX)  +
                                    (WK-SYUTEN   *   ACCT-ZAIKAISU)
                         END-IF
                   END-IF
                   IF    BUN-IDX2       =   2
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-TENSU(2 BUN-IDX2)  =
                                     RECE62-TENSU(2 BUN-IDX2)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         ELSE  
                           COMPUTE   RECE62-TENSU(21 BUN-IDX2)  =
                                     RECE62-TENSU(21 BUN-IDX2)  +
                                    (WK-SYUTEN   *   ACCT-ZAIKAISU)
                         END-IF
                   END-IF
                   IF    BUN-IDX3       =   3
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-TENSU(2 BUN-IDX3)  =
                                     RECE62-TENSU(2 BUN-IDX3)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         ELSE  
                           COMPUTE   RECE62-TENSU(21 BUN-IDX3)  =
                                     RECE62-TENSU(21 BUN-IDX3)  +
                                    (WK-SYUTEN   *   ACCT-ZAIKAISU)
                         END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-TENSU(2 BUN-IDX4)  =
                                     RECE62-TENSU(2 BUN-IDX4)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         ELSE
                           COMPUTE   RECE62-TENSU(21 BUN-IDX4)  =
                                     RECE62-TENSU(21 BUN-IDX4)  +
                                    (WK-SYUTEN   *   ACCT-ZAIKAISU)
                         END-IF
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(22 BUN-IDX)  =
                                 RECE62-TENSU(22 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(22 BUN-IDX2)  =
                                 RECE62-TENSU(22 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(22 BUN-IDX3)  =
                                 RECE62-TENSU(22 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(22 BUN-IDX4)  =
                                 RECE62-TENSU(22 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
           END-EVALUATE
           .
      *
       2101221-RECE-LEFT-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    特記事項の編集
      *****************************************************************
       21013-TOKKI-HENSYU-SEC                 SECTION.
      *
           MOVE     SPACE            TO      WRK-TOKKI
      *
           EVALUATE    FLG-TOKKI
             WHEN        1
               EVALUATE    ACCT-SRYCDTOTAL
                   WHEN    CONS-TOKKI1
                       MOVE    "01"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI2
                       MOVE    "02"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI3
                       MOVE    "03"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI4
                       MOVE    "04"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI5
                       MOVE    "05"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI7
                       MOVE    "07"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI8
                       MOVE    "08"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI9
                       MOVE    "09"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI10
                       MOVE    "10"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI11
                       MOVE    "11"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI12
                       MOVE    "12"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI13
                       MOVE    "13"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI14
                       MOVE    "14"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI15
                       MOVE    "15"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI16
                       MOVE    "16"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI17
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI18
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI19
                       MOVE    "19"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI20
                       MOVE    "20"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI21
                       MOVE    "21"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI22
                       MOVE    "22"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI23
                       MOVE    "23"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI24
                       MOVE    "24"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI25
                       MOVE    "25"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN        2
               EVALUATE    SRY-SRYCD(IDX2)
                   WHEN    CONS-TOKKI1(6:9)
                       MOVE    "01"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI2(6:9)
                       MOVE    "02"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI3(6:9)
                       MOVE    "03"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI4(6:9)
                       MOVE    "04"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI5(6:9)
                       MOVE    "05"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI7(6:9)
                       MOVE    "07"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI8(6:9)
                       MOVE    "08"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI9(6:9)
                       MOVE    "09"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI10(6:9)
                       MOVE    "10"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI11(6:9)
                       MOVE    "11"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI12(6:9)
                       MOVE    "12"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI13(6:9)
                       MOVE    "13"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI14(6:9)
                       MOVE    "14"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI15(6:9)
                       MOVE    "15"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI16(6:9)
                       MOVE    "16"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI17(6:9)
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI18(6:9)
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI19(6:9)
                       MOVE    "19"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI20(6:9)
                       MOVE    "20"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI21(6:9)
                       MOVE    "21"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI22(6:9)
                       MOVE    "22"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI23(6:9)
                       MOVE    "23"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI24(6:9)
                       MOVE    "24"      TO      WRK-TOKKI
                   WHEN    CONS-TOKKI25(6:9)
                       MOVE    "25"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN        3
                       MOVE    "14"      TO      WRK-TOKKI
             WHEN        4
                       MOVE    "15"      TO      WRK-TOKKI
             WHEN        5
               EVALUATE   FLG-GENBUTU70
                   WHEN     1
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "19"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN        6
                       MOVE    "21"      TO      WRK-TOKKI
             WHEN        7
               EVALUATE   FLG-TOKUSITU
                   WHEN     1
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "19"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN        8
               EVALUATE   FLG-TOKUSITU
                   WHEN     1
                       MOVE    "22"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "23"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "24"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN        9
                       MOVE    "11"      TO      WRK-TOKKI
             WHEN       10
                       MOVE    "12"      TO      WRK-TOKKI
      *
             WHEN       96
                       MOVE    "96"      TO      WRK-TOKKI
             WHEN       97
                       MOVE    "97"      TO      WRK-TOKKI
           END-EVALUATE
      *
      *    既に同じ特記事項コードが編集済みのときはセットしない
           EVALUATE  WRK-TOKKI
             WHEN      "15"
               IF  (RECE62-SRYYM   >=  "200608")
               AND (RECE62-SRYYM   <=  "200812")
                   CONTINUE
               ELSE
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "16"
               IF  (RECE62-SRYYM   <   "200610")
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "17"
             WHEN      "18"
             WHEN      "19"
               IF  (RECE62-SRYYM   <   "200704")
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "20"
               IF  (RECE62-SRYYM   >=  "200804")
               AND (RECE62-SRYYM   <=  "201203")
                   CONTINUE
               ELSE
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "21"
               IF  (RECE62-SRYYM   <   "200901")
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "22"
             WHEN      "23"
             WHEN      "24"
               IF  (RECE62-SRYYM   <   "200905")
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "25"
               IF  (RECE62-SRYYM   <   "200910")
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
           END-EVALUATE
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL ( TOKKI-IDX       >   5     )
               IF      RECE62-TOKKI(TOKKI-IDX)   =   SPACE
                   MOVE    WRK-TOKKI       TO  RECE62-TOKKI (TOKKI-IDX)
                   MOVE    5               TO  TOKKI-IDX
               ELSE
                   IF      WRK-TOKKI     =   RECE62-TOKKI   (TOKKI-IDX)
                       MOVE    5                 TO  TOKKI-IDX
                   END-IF 
               END-IF
           END-PERFORM
           .
       21013-TOKKI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    剤の診療内容チェック
      *****************************************************************
       21014-SINRYO-CHECK-SEC                 SECTION.
      *
           PERFORM   VARYING   IDU   FROM   1   BY   1
                      UNTIL  ( IDU   >   TBL-ZAICHECK-MAX )
                       OR    ( FLG-RINYAK  NOT =  ZERO    )
      *
              IF  ( IDU  =  1                                  )
              OR  ((IDU  =  2) AND (ACCT-SRYKBN = "60" OR "64"))
              OR  ((IDU  =  3) AND (ACCT-SRYKBN = "80"        ))
              OR  ((IDU  =  4) AND (ACCT-SRYKBN = "80"        ))
      *
                 INITIALIZE                  SRYACT-REC
                 MOVE RECE62-HOSPNUM     TO  SRY-HOSPNUM
                 MOVE RECE62-NYUGAIKBN   TO  SRY-NYUGAIKBN
                 MOVE RECE62-PTID        TO  SRY-PTID
                 MOVE RECE62-SRYYM       TO  SRY-SRYYM
                 MOVE ACCT-ZAINUM        TO  SRY-ZAINUM
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(1)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(2)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(3)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(4)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(5)
                 MOVE SRYACT-REC         TO  MCPDATA-REC
                 MOVE "tbl_sryact"       TO  MCP-TABLE
                 MOVE "key8"             TO  MCP-PATHNAME
                 PERFORM   900-DBSELECT-SEC
                 IF      MCP-RC        =  ZERO
                     MOVE "tbl_sryact"   TO  MCP-TABLE
                     MOVE "key8"         TO  MCP-PATHNAME
                     PERFORM   900-SRYACT-READ-SEC
                     IF     FLG-SRYACT   =  ZERO
                         EVALUATE   IDU
                           WHEN      1
                             MOVE   1   TO  FLG-RINYAK
                           WHEN      2
                           WHEN      3
                           WHEN      4
                             MOVE   2   TO  FLG-RINYAK
                         END-EVALUATE
                     END-IF
                 END-IF
                 MOVE "tbl_sryact"       TO  MCP-TABLE
                 MOVE "key8"             TO  MCP-PATHNAME
                 PERFORM   900-CLOSE-SEC
      *
              END-IF
      *
           END-PERFORM
      *
           .
       21014-SINRYO-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    点滴手技加算まとめ対象かチェック
      *****************************************************************
       21015-TENTEKIMATOME-CHECK-SEC                 SECTION.
      *
           PERFORM  VARYING  ID4    FROM   1   BY   1
                     UNTIL  (ID4                           >   20 )
                       OR   (WRK-TENTEKI2-ZAINUM(IDX1 ID4) =  ZERO)
                       OR   (FLG-TENTEKIMATOME             =    1 )
      *
             IF    ACCT-ZAINUM  =  WRK-TENTEKI2-ZAINUM(IDX1 ID4)
                  MOVE     1    TO   FLG-TENTEKIMATOME
             END-IF
      *
           END-PERFORM
      *
           .
       21015-TENTEKIMATOME-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００４）
      *****************************************************************
       2102-RECE64-HENSYU2-SEC                SECTION.
      *
           INITIALIZE                            NYUINACCT-REC
           MOVE    RECE62-HOSPNUM        TO      NACCT-HOSPNUM
           MOVE    RECE62-NYUGAIKBN      TO      NACCT-NYUGAIKBN
           MOVE    RECE62-PTID           TO      NACCT-PTID
      ***  MOVE    RECE62-SRYKA(IDX)     TO      NACCT-SRYKA
           MOVE    RECE62-SRYYM          TO      NACCT-SRYYM
           MOVE    NYUINACCT-REC         TO      MCPDATA-REC
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC             =       ZERO
      *
               MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
               MOVE    "key7"            TO      MCP-PATHNAME
               PERFORM  900-NYUINACCT-READ-SEC
               PERFORM  UNTIL  (FLG-NYUINACCT  =    "1")
      *
                 IF     NACCT-ZAISKBKBN    =    "1"  
                   IF     NACCT-SRYCDTOTAL   NOT =    099999916         
                       PERFORM      210201-NYUINKHN-GET-SEC
                   END-IF                                               
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                                    UNTIL    IDY    >    31
                     IF   NACCT-DAY(IDY)   NOT =  ZERO 
                        IF     NACCT-SRYCDTOTAL    =    099999916       
                           MOVE   NACCT-DAY(IDY)                        
                                           TO   WRK-DAY1-SENTEI(IDY)    
                        ELSE                                            
                           MOVE   NACCT-DAY(IDY)  TO   WRK-DAY1(IDY) 
                           IF (NACCT-SRYKBN     =  "90"       )
                           OR (NACCT-SRYCDTOTAL =   190799410 )
                           OR (NACCT-SRYCDTOTAL =   190799510 )
                              MOVE  903  TO  WRK-DAY1-NYUTENTTLKBN(IDY) 
                           ELSE                                         
                              MOVE  920  TO  WRK-DAY1-NYUTENTTLKBN(IDY) 
                           END-IF                                       
                           MOVE   WRK-KHNTEN
                                         TO  WRK-DAY1-KHNTEN(IDY) 
                           MOVE   WRK-KSNTEN
                                         TO  WRK-DAY1-KSNTEN(IDY)
                           MOVE   WRK-SENTEI-KHNTEN                     
                                         TO   WRK-DAY1-SENTEI-KHNTEN    
                                                               (IDY)    
                           MOVE   WRK-SENTEI-ZAITEN                     
                                         TO   WRK-DAY1-SENTEI-ZAITEN    
                                                               (IDY)    
                           MOVE   WRK-SENTEI-SRYCD                      
                                         TO   WRK-DAY1-SENTEI-SRYCD     
                                                               (IDY)    
                           MOVE   WRK-SENTEI-SRYCD2                     
                                         TO   WRK-DAY1-SENTEI-SRYCD2    
                                                               (IDY)    
                           MOVE   WRK-NYUKHNKSNKBN                      
                                      TO  WRK-DAY1-NYUKHNKSNKBN(IDY)    
                           MOVE   WRK-HYOKETU-SRYCD
                                         TO   WRK-DAY1-HYOKETU-SRYCD
                                                               (IDY)
                           MOVE   WRK-KSN-SRYCD
                                         TO   WRK-DAY1-KSN-SRYCD
                                                               (IDY)
                           MOVE   WRK-HYOKETU-TEN
                                         TO   WRK-DAY1-HYOKETU-TEN
                                                               (IDY)
                        END-IF                                          
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 IF     NACCT-ZAISKBKBN    =    "2"  
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                                    UNTIL    IDY    >    31
                     IF   NACCT-DAY(IDY)   NOT =  ZERO 
                             MOVE   NACCT-DAY(IDY)  TO   WRK-DAY2(IDY) 
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 IF   ( NACCT-ZAISKBKBN    =    "4"       )
                 AND  ( NACCT-SRYCDTOTAL   =    197000570 )
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                                    UNTIL    IDY    >    31
                     IF   NACCT-DAY(IDY)   NOT =  ZERO 
                             MOVE   NACCT-DAY(IDY)  TO   WRK-DAY4(IDY) 
                             MOVE   NACCT-DAY(IDY)  TO   WRK-DAY4X(IDY)
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 IF     NACCT-ZAISKBKBN    =    "5"  
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                                    UNTIL    IDY    >    31
                     IF   NACCT-DAY(IDY)   NOT =  ZERO 
                             MOVE   NACCT-DAY(IDY)  TO   WRK-DAY5(IDY) 
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
                 MOVE    "key7"                TO      MCP-PATHNAME
                 PERFORM        900-NYUINACCT-READ-SEC
               END-PERFORM
      *
           END-IF
      *
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
             IF    WRK-DAY2(IDY)  =  4  OR  5
                CONTINUE
             ELSE
                MOVE   ZERO    TO   WRK-DAY1-KSN-SRYCD(IDY)
                MOVE   ZERO    TO   WRK-DAY1-HYOKETU-SRYCD(IDY)
             END-IF
           END-PERFORM
      *
      *
           PERFORM      210202-SENTEI-KEISU-GET-SEC
      *
      *
           MOVE    ZERO    TO    WRK-ZAINUM-CNT2
           MOVE    ZERO    TO    FLG-DOJITU
           INITIALIZE            WRK-SKJ-DOJITU-TABLE
      *
           INITIALIZE                            NYUINACCT-REC
           MOVE    RECE62-HOSPNUM        TO      NACCT-HOSPNUM
           MOVE    RECE62-NYUGAIKBN      TO      NACCT-NYUGAIKBN
           MOVE    RECE62-PTID           TO      NACCT-PTID
      ***  MOVE    RECE62-SRYKA(IDX)     TO      NACCT-SRYKA
           MOVE    RECE62-SRYYM          TO      NACCT-SRYYM
           MOVE    NYUINACCT-REC         TO      MCPDATA-REC
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
      *
               MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
               MOVE    "key7"            TO      MCP-PATHNAME
               PERFORM  900-NYUINACCT-READ-SEC
               PERFORM  UNTIL  (FLG-NYUINACCT  =    "1") 
      *
                 IF     NACCT-ZAISKBKBN    =    "1"  OR  "2"  OR
                                                "4"  OR  "6"  OR
                                                "7"
      *
                   MOVE     ZERO       TO    CNT-ZAIREN
                   IF   NACCT-ZAISKBKBN  = "6"
                      ADD    1         TO    WRK-ZAINUM-CNT2
                   END-IF
      *
                   PERFORM  VARYING  IDX1    FROM    1   BY  1
                             UNTIL   IDX1    >       10
                             OR      RECE62-HKNCOMBI (IDX1)  =   ZERO 
      *
                      INITIALIZE          WRK-DAY-TABLE2
                                          WRK-GAI-TABLE
                                          WRK-GAI-TABLE2
                                          WRK-SKJ-TABLE
                                          WRK-SKJ-TABLE2
                      MOVE     ZERO       TO    CNT-DAY21
                                                CNT-DAY21-SENTEI        
                                                CNT-DAY22
                                                CNT-DAY24
                      MOVE     ZERO       TO    FLG-DAY21
                                                FLG-DAY21-SENTEI        
                                                FLG-DAY22
                                                FLG-DAY24
                                                FLG-MIJISI
                                                FLG-MIJISI-SENTEI       
                      MOVE     ZERO       TO    WRK-SENTEI-ZAITEN-W     
                                                WRK-SENTEI-SRYCD-W      
                                                WRK-SENTEI-SRYCD2-W     
                      MOVE     ZERO       TO    WRK-NYUTENTTLKBN
      *
                      PERFORM  VARYING  IDY    FROM    1   BY  1
                                  UNTIL   IDY     >       31
      *
                         IF  RECE62-HKNCOMBI (IDX1)  =  WRK-DAY5(IDY)
                            IF   NACCT-ZAITEN    NOT =  ZERO
                            AND  NACCT-DAY(IDY)  NOT =  ZERO
                            AND  NACCT-ZAISKBKBN NOT =  "4"
                              IF NACCT-ZAISKBKBN     =  "1"
                                 IF  WRK-DAY2(IDY) =  ZERO
                                  IF  WRK-DAY1-SENTEI(IDY) =  ZERO      
                                     MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY21(IDY) 
                                     ADD    1   TO   CNT-DAY21
                                     MOVE   1   TO   FLG-DAY21
                                     MOVE   1   TO   FLG-MIJISI
                                  ELSE                                  
                                     MOVE   NACCT-DAY(IDY)              
                                            TO   WRK-DAY21-SENTEI(IDY)  
                                     MOVE   WRK-DAY1-SENTEI-ZAITEN(IDY) 
                                            TO   WRK-SENTEI-ZAITEN-W    
                                     MOVE   WRK-DAY1-SENTEI-SRYCD(IDY)  
                                            TO   WRK-SENTEI-SRYCD-W     
                                     MOVE   WRK-DAY1-SENTEI-SRYCD2(IDY) 
                                            TO   WRK-SENTEI-SRYCD2-W    
                                     ADD    1   TO   CNT-DAY21-SENTEI   
                                     MOVE   1   TO   FLG-DAY21-SENTEI   
                                     MOVE   1   TO   FLG-MIJISI-SENTEI  
                                  END-IF                                
                                 END-IF
                              ELSE
                                IF  ((WRK-DAY1(IDY)   NOT  =  ZERO  ) OR
                                     (RECE62-NYUINDAY-KBN(IDY) = "1"))
                                AND ( WRK-DAY2(IDY) =  ZERO  OR  4
                                                             OR  5   )
                                    MOVE   NACCT-DAY(IDY)  
                                               TO   WRK-DAY21(IDY) 
                                    MOVE   WRK-DAY1-NYUTENTTLKBN(IDY)
                                               TO   WRK-NYUTENTTLKBN
                                    ADD    1     TO   CNT-DAY21
                                    MOVE   1     TO   FLG-DAY21
                                END-IF
                              END-IF
                            END-IF
      *                     *外泊
                            IF  (WRK-DAY1(IDY)   NOT  =  ZERO)
                            AND (NACCT-ZAITEN         =  ZERO)
                            AND (NACCT-ZAISKBKBN      =  "2" )
                            AND (NACCT-DAY(IDY)  NOT  =  ZERO)
                               MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY22(IDY) 
                               MOVE   WRK-DAY1-NYUTENTTLKBN(IDY)
                                        TO  WRK-DAY22-NYUTENTTLKBN(IDY)
                               MOVE   WRK-DAY1-NYUKHNKSNKBN(IDY)        
                                        TO  WRK-DAY22-NYUKHNKSNKBN(IDY) 
                               PERFORM      210203-NYUINACCT-GET-SEC
      *************************ADD    1     TO   CNT-DAY22
      *************************MOVE   1     TO   FLG-DAY22
                            END-IF
      *                     *食事
                            IF  ((WRK-DAY1(IDY)   NOT  =  ZERO  ) OR
                                 (RECE62-NYUINDAY-KBN(IDY) = "1"))
                            AND ( NACCT-ZAITEN         =  ZERO   )
                            AND ( NACCT-ZAISKBKBN      =  "4"    )
                            AND ( NACCT-DAY(IDY)  NOT  =  ZERO   )
                            AND ( WRK-SHOKUJIRYOYO(IDY)
                                                  NOT  =  ZERO   )
                               IF  WRK-DAY2(IDY) =  ZERO  OR  4
                                                          OR  5
                                IF   RECE62-SRYYM  >= "200604"
                                 IF  NACCT-SRYCDTOTAL = 099999918
                                                    OR  099999919
                                                    OR  099999920
                                  MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY24(IDY) 
                                  PERFORM      210204-NYUINACCT-SYU2-SEC
                                 END-IF
                                ELSE
                                 IF  NACCT-SRYCDTOTAL = 099999913
                                  MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY24(IDY) 
                                  PERFORM      210204-NYUINACCT-SYU2-SEC
                                  ADD    1     TO   CNT-DAY24
                                  MOVE   1     TO   FLG-DAY24
                                 END-IF
                                END-IF
                               END-IF
                            END-IF
                            IF     RECE62-SRYYM        >= "200610"
                              IF  ((WRK-DAY1(IDY)   NOT  =  ZERO  ) OR
                                   (RECE62-NYUINDAY-KBN(IDY) = "1"))
                              AND ( NACCT-ZAITEN         =  ZERO   )
                              AND ( NACCT-ZAISKBKBN      =  "4"    )
      ***                     AND ( NACCT-DAY(IDY)  NOT  =  ZERO   )
                              AND ( WRK-SHOKUJIRYOYO(IDY)
                                                    NOT  =  ZERO   )
                              AND ( NACCT-SRYCDTOTAL = 099999918
                                                   OR  099999919
                                                   OR  099999920   )
                              AND ( WRK-DAY2(IDY) =  ZERO  OR  4
                                                           OR  5   )
                                PERFORM   210218-NYUINACCT-SYU2-KAN-SEC
                              END-IF
                            END-IF
                         ELSE
      *                     *食事
                            IF  (RECE62-HKNCOMBI(IDX1)   =
                                   RECE62-DOUJITSU-HKNCOMBI(IDY))
                            AND (NACCT-ZAITEN         =  ZERO   )
                            AND (NACCT-ZAISKBKBN      =  "4"    )
                            AND (NACCT-DAY(IDY)  NOT  =  ZERO   )
                            AND (WRK-SHOKUJIRYOYO(IDY)
                                                 NOT  =  ZERO   )
                            AND (WRK-DAY2(IDY) = ZERO OR 4 OR 5 )
                            AND (RECE62-SRYYM >= "200604"       )
                             IF  NACCT-SRYCDTOTAL = 099999918
                                                 OR 099999919
                                                 OR 099999920
                              MOVE  1 TO  FLG-DOJITU
                              MOVE  1 TO  WRK-SKJ-DOJITU-KBN (IDX1 IDY)
                              EVALUATE   NACCT-SRYCDTOTAL
                                WHEN  099999918
                                  MOVE  NACCT-DAY(IDY) TO
                                          WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                                WHEN  099999919
                                  MOVE  NACCT-DAY(IDY) TO
                                          WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                                WHEN  099999920
                                  MOVE  NACCT-DAY(IDY) TO
                                          WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                              END-EVALUATE
                              MOVE  RECE62-HKNCOMBI(IDX1)
                                  TO  WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                             END-IF
                            END-IF
                         END-IF
      *
                      END-PERFORM
      *
                      IF   FLG-DAY21    =   1
                         ADD    1     TO   CNT-ZAIREN
                         PERFORM   210205-RECE64-TENSOU2-SEC
                         PERFORM   210206-RECE65-HENSYU2-SEC
                         PERFORM   RECE64-WRITE-SEC
                         IF    FLG-MIJISI  =  1  
                            PERFORM VARYING SYUKEI-IDX3 FROM 1 BY 1
                               UNTIL  SYUKEI-IDX3           > 4
      *
                             IF    WRK-SYS-MIJISI(SYUKEI-IDX3) = 1
                               PERFORM  VARYING  IDY  FROM  1  BY  1
                                      UNTIL   IDY     >       31
                                IF   WRK-DAY21(IDY)  NOT =  ZERO
                                  EVALUATE WRK-DAY1-NYUTENTTLKBN(IDY)
                                    WHEN   903
                                      IF  WRK-SYS-MIJISI-FLG
                                             (SYUKEI-IDX3 IDY)  = 1
                                         MOVE   RECE62-HKNCOMBI (IDX1)
                                           TO   WRK-MIJ-HKNCOMBI(IDX1)
                                         MOVE   WRK-DAY21(IDY)  
                                           TO   WRK-MIJ-DAY90
                                                (IDX1 SYUKEI-IDX3 IDY) 
                                      END-IF
                                    WHEN   920
                                      IF  WRK-SYS-MIJISI-FLG
                                             (SYUKEI-IDX3 IDY)  = 1
                                         MOVE   RECE62-HKNCOMBI (IDX1)
                                           TO   WRK-MIJ-HKNCOMBI(IDX1)
                                         MOVE   WRK-DAY21(IDY)  
                                           TO   WRK-MIJ-DAY92
                                                (IDX1 SYUKEI-IDX3 IDY)
                                      END-IF
                                  END-EVALUATE
                                END-IF
                               END-PERFORM
                             END-IF
      *
                            END-PERFORM
                         END-IF
                      END-IF
      *
                      IF   FLG-DAY21-SENTEI    =   1
                         ADD    1     TO   CNT-ZAIREN
                         PERFORM   210207-RECE64-TENSOU2-SEN-SEC
                         PERFORM   210208-RECE65-HENSYU2-SEN-SEC
                         PERFORM   RECE64-WRITE-SEC
                         IF    FLG-MIJISI-SENTEI  =  1  
                            PERFORM VARYING SYUKEI-IDX3 FROM 1 BY 1
                               UNTIL  SYUKEI-IDX3           > 4
      *
                             IF    WRK-SYS-MIJISI(SYUKEI-IDX3) = 1
                               PERFORM  VARYING  IDY  FROM  1  BY  1
                                      UNTIL   IDY     >       31
                                IF  WRK-DAY21-SENTEI(IDY)  NOT =  ZERO
                                  EVALUATE WRK-DAY1-NYUTENTTLKBN(IDY)
                                    WHEN   903
                                      IF  WRK-SYS-MIJISI-FLG
                                             (SYUKEI-IDX3 IDY)  = 1
                                         MOVE   RECE62-HKNCOMBI (IDX1)
                                           TO   WRK-MIJ-HKNCOMBI(IDX1)
                                         MOVE   WRK-DAY21-SENTEI(IDY)  
                                           TO   WRK-MIJ-DAY90
                                                (IDX1 SYUKEI-IDX3 IDY) 
                                      END-IF
                                    WHEN   920
                                      IF  WRK-SYS-MIJISI-FLG
                                             (SYUKEI-IDX3 IDY)  = 1
                                         MOVE   RECE62-HKNCOMBI (IDX1)
                                           TO   WRK-MIJ-HKNCOMBI(IDX1)
                                         MOVE   WRK-DAY21-SENTEI(IDY)  
                                           TO   WRK-MIJ-DAY92
                                                (IDX1 SYUKEI-IDX3 IDY)
                                      END-IF
                                  END-EVALUATE
                                END-IF
                               END-PERFORM
                             END-IF
      *
                            END-PERFORM
                         END-IF
                      END-IF
      *
                      IF   FLG-DAY22    =   1
                         PERFORM    210209-NYUINACCT-HEN-SEC
                         ADD    1     TO   CNT-ZAIREN
                         PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                            UNTIL  SYUKEI-IDX3           > 20
                             OR    WRK-GAI2-DAY(SYUKEI-IDX3) = ZERO
      *
                             PERFORM   210210-RECE64-TENSOU2-GAI-SEC
                             PERFORM   210211-RECE65-HENSYU2-GAI-SEC
                             PERFORM   RECE64-WRITE-SEC
      *
                         END-PERFORM
                      END-IF
      *
                      IF   FLG-DAY24    =   1
                       IF   RECE62-SRYYM  >= "200604"
                         CONTINUE
                       ELSE
                         PERFORM    210212-NYUINACCT-HEN2-SEC
                         ADD    1     TO   CNT-ZAIREN
                         PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                            UNTIL  SYUKEI-IDX3           >  31
                             OR    WRK-SKJ2-ZAITEN(SYUKEI-IDX3) = ZERO
      *
                             PERFORM   210213-RECE64-TENSOU2-SKJ-SEC
                             PERFORM   210214-RECE65-HENSYU2-SKJ-SEC
                             PERFORM   RECE64-WRITE-SEC
      *
                         END-PERFORM
                       END-IF
                      END-IF
      *
                   END-PERFORM
      *
                 END-IF
      *
                 MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
                 MOVE    "key7"                TO      MCP-PATHNAME
                 PERFORM        900-NYUINACCT-READ-SEC
               END-PERFORM
      *
           END-IF
      *
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *
      *    未実施減算
           PERFORM  VARYING  IDX1  FROM  1  BY  1
                    UNTIL  IDX1         >  10
      *
             IF    WRK-MIJ-HKNCOMBI(IDX1)  NOT =  ZERO 
      *
               PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                      UNTIL  SYUKEI-IDX3  >   4
      *
                 PERFORM   VARYING   IDY   FROM   1   BY   1
                         UNTIL   IDY    >  31
                    IF   WRK-MIJ-DAY90(IDX1 SYUKEI-IDX3 IDY)  
                                                  NOT =  ZERO
                        ADD   1   TO  WRK-MIJ-CNT90(IDX1 SYUKEI-IDX3)
                    END-IF
                    IF   WRK-MIJ-DAY92(IDX1 SYUKEI-IDX3 IDY)  
                                                  NOT =  ZERO
                        ADD   1   TO  WRK-MIJ-CNT92(IDX1 SYUKEI-IDX3)
                    END-IF
                 END-PERFORM
      *
               END-PERFORM
      *
             END-IF
      *
           END-PERFORM
      *
      *
           PERFORM      210215-MIJISI-GET-SEC
      *
           MOVE     ZERO       TO    CNT-ZAIREN
      *
           PERFORM  VARYING  IDX1  FROM  1  BY  1
                    UNTIL  IDX1         >  10
      *
             IF    WRK-MIJ-HKNCOMBI(IDX1)  NOT =  ZERO  
      *
               ADD       1      TO     CNT-ZAIREN
      *
               PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                      UNTIL  SYUKEI-IDX3  >   4
      *
                 IF   WRK-MIJ-CNT90(IDX1 SYUKEI-IDX3)  NOT =  ZERO
                       MOVE      1      TO     FLG-MIJISI2
                       PERFORM   210216-RECE64-TENSOU2-MIJ-SEC
                       PERFORM   210217-RECE65-TENSOU2-MIJ-SEC
                       PERFORM   RECE65-WRITE-SEC
                       PERFORM   RECE64-WRITE-SEC
                 END-IF
      *
               END-PERFORM
      *
               PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                    UNTIL  SYUKEI-IDX3  >   4
      *
                 IF   WRK-MIJ-CNT92(IDX1 SYUKEI-IDX3)  NOT =  ZERO
                       MOVE      2      TO     FLG-MIJISI2
                       PERFORM   210216-RECE64-TENSOU2-MIJ-SEC
                       PERFORM   210217-RECE65-TENSOU2-MIJ-SEC
                       PERFORM   RECE65-WRITE-SEC
                       PERFORM   RECE64-WRITE-SEC
                 END-IF
      *
               END-PERFORM
      *
             END-IF
      *
           END-PERFORM
      *
      *    同日再入院
      *
           IF   RECE62-SRYYM   >=  "200604"
              IF   FLG-DOJITU   =   1
                 PERFORM  VARYING  IDX1  FROM  1  BY  1
                           UNTIL   IDX1    >  10
                    PERFORM   210223-NYUINACCT-SYU2-DOJITU-SEC
                 END-PERFORM
              END-IF
           END-IF
      *
      *    入院時生活療養費負担額取得
           IF    RECE62-SRYYM   >=  "200610"
             INITIALIZE                   ORCSNYULIFE-AREA
             MOVE    RECE62-HOSPNUM   TO  LNK-NYULIFE-HOSPNUM
             MOVE    RECE62-PTID      TO  LNK-NYULIFE-PTID
             MOVE    RECE62-SRYYM     TO  LNK-NYULIFE-SANTEIYM
             CALL    "ORCSNYULIFE"        USING
                                          ORCSNYULIFE-AREA
                                          SPA-AREA
             IF      LNK-NYULIFE-RC   =   ZERO
               PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                         UNTIL   SYUKEI-IDX3   >   31
                 MOVE  LNK-NYULIFE-KBN(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-KBN(SYUKEI-IDX3)
                 MOVE  LNK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                 MOVE  LNK-NYULIFE-SKJFTN-MONEY(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-SKJFTN-MONEY(SYUKEI-IDX3)
                 MOVE  LNK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                 MOVE  LNK-NYULIFE-KANFTN-MONEY(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-KANFTN-MONEY(SYUKEI-IDX3)
               END-PERFORM
             END-IF
           END-IF
      *
      *    ２００６年４月以降の食事療養
           IF   RECE62-SRYYM   >=  "200604"
      *
              MOVE     ZERO     TO    CNT-ZAIREN
      *
              PERFORM  VARYING  IDX1  FROM  1  BY  1
                        UNTIL   IDX1    >  10
      *
                IF    WRK-SKJ200604-HKNCOMBI(IDX1)  NOT =  ZERO
      *
                   ADD       1      TO     CNT-ZAIREN
      *
                   PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                             UNTIL   SYUKEI-IDX3    >  31
      *
                     IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 1)
                                                        NOT =  ZERO
                        PERFORM 210213-RECE64-TENSOU2-SKJ200604-SEC
                        PERFORM 210214-RECE65-HENSYU2-SKJ200604-SEC
                        PERFORM RECE65-WRITE-SEC
                        PERFORM RECE64-WRITE-SEC
                     END-IF
      *
                     IF   WRK-SKJ200604-DAY-KAN(IDX1 SYUKEI-IDX3)
                                                        NOT =  ZERO
                     AND  WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
                       PERFORM 210219-RECE64-TENSOU2-SKJ200610-KAN-SEC
                       PERFORM 210220-RECE65-HENSYU2-SKJ200610-KAN-SEC
                       PERFORM RECE65-WRITE-SEC
                       PERFORM RECE64-WRITE-SEC
      *
                       MOVE   ZERO   TO  FLG-SKJFTNNASI
                       IF  (RECE62-HKNCOMBIFLG(IDX1)  =  3)
                       AND (RECE62-KOHNUMHC(IDX1 1)   =
                            "024" OR "079" OR "051" OR
                            "052" OR "015" OR "016"       )
                         INITIALIZE      LNK-ORCSJGNGET-REC
                         MOVE RECE62-HOSPNUM
                                     TO  LNK-ORCSJGNGET-HOSPNUM
                         MOVE RECE62-NYUGAIKBN
                                     TO  LNK-ORCSJGNGET-NYUGAIKBN
                         MOVE RECE62-PTID
                                     TO  LNK-ORCSJGNGET-PTID
                         MOVE RECE62-KOHNUMHC(IDX1 1)
                                     TO  LNK-ORCSJGNGET-KOHHKNNUM
                         MOVE RECE62-KOHIDHC(IDX1 1)
                                     TO  LNK-ORCSJGNGET-KOHID
                         MOVE RECE62-SRYYM
                                     TO  LNK-ORCSJGNGET-SRYYM
                         MOVE RECE62-SRYYM
                                     TO  LNK-ORCSJGNGET-SKYEDYMD(1:6)
                         MOVE "31"   TO  LNK-ORCSJGNGET-SKYEDYMD(7:2)
                         CALL  "ORCSJGNGET"  USING
                                             LNK-ORCSJGNGET-REC
                                             SPA-AREA
                         IF   LNK-ORCSJGNGET-RC   =   ZERO
                           IF RECE62-KOHNUMHC(IDX1 1) = "024" OR "079"
                            IF  LNK-ORCSJGNGET-TAFTNRUIKEI = ZERO
                               MOVE    1     TO    FLG-SKJFTNNASI
                            END-IF
                           END-IF
                           IF RECE62-KOHNUMHC(IDX1 1) =
                              "051" OR "052" OR "015" OR "016"
                            IF  LNK-ORCSJGNGET-NYUJGNGAK   = ZERO
                               MOVE    1     TO    FLG-SKJFTNNASI
                            END-IF
                           END-IF
                         END-IF
                       END-IF
      *
                       IF ((RECE62-HKNNUMHC(IDX1)        =  SPACE) AND
                           (RECE62-KOHNUMHC(IDX1 1)  NOT =
                            "010" AND "038" AND "024" AND "079" AND
                            "051" AND "052" AND "015" AND "016"  ) AND
                           (RECE62-KOHNUMHC(IDX1 2)      =  SPACE) AND
                           (RECE62-KOHNUMHC(IDX1 3)      =  SPACE) AND
                           (RECE62-KOHNUMHC(IDX1 4)      =  SPACE))
                       OR ( FLG-SKJFTNNASI               =    1   )
                       OR ((RECE62-HKNNUMHC(IDX1)        =  SPACE) AND
                           (RECE62-KOHNUMHC(IDX1 1)  NOT =  SPACE) AND
                           (RECE62-KOHNUMHC(IDX1 2)      =  SPACE) AND
                           (RECE62-KOHNUMHC(IDX1 3)      =  SPACE) AND
                           (RECE62-KOHNUMHC(IDX1 4)      =  SPACE) AND
                           (RECE62-SRYYM            >= "201101"  ) AND
                           (RECE62-SRYYM            <= "201202"  ) AND
                           (WK-GENGAKUKBN            =  3  OR  4 ) AND
                           (FLG-SAIGAI-TAISYO            =  1    ))
                        CONTINUE
                       ELSE
                        IF   WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                                                        NOT =  SPACE
                        AND  WRK-NYULIFE-SKJFTN-MONEY(SYUKEI-IDX3)
                                                        NOT =  ZERO
                        AND  WRK-SKJ200604-SURYOUTOTALFTN
                                                (IDX1 SYUKEI-IDX3)
                                                        NOT =  ZERO
                          MOVE    1    TO   FLG-SKJ200610FTN
                          PERFORM 210221-RECE64-TENSOU2-SKJ200610FTN-SEC
                          PERFORM 210222-RECE65-HENSYU2-SKJ200610FTN-SEC
                          PERFORM RECE65-WRITE-SEC
                          PERFORM RECE64-WRITE-SEC
                        END-IF
                        IF   WRK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                                                        NOT =  SPACE
                        AND  WRK-NYULIFE-KANFTN-MONEY(SYUKEI-IDX3)
                                                        NOT =  ZERO
                          MOVE    2    TO   FLG-SKJ200610FTN
                          PERFORM 210221-RECE64-TENSOU2-SKJ200610FTN-SEC
                          PERFORM 210222-RECE65-HENSYU2-SKJ200610FTN-SEC
                          PERFORM RECE65-WRITE-SEC
                          PERFORM RECE64-WRITE-SEC
                        END-IF
                       END-IF
                     END-IF
      *
                   END-PERFORM
      *
                END-IF
      *
              END-PERFORM
      *
           END-IF
      *
           .
       2102-RECE64-HENSYU2-EXT.
           EXIT.
      *
      **************************************************************
      *    入院基本料の取得
      **************************************************************
       210201-NYUINKHN-GET-SEC           SECTION.
      *
           MOVE    ZERO               TO   WRK-KHNTEN
                                           WRK-NYUKHNKSNKBN    
                                           WRK-KSNTEN
                                           WRK-KSN-SRYCD
      *
           MOVE    ZERO               TO   WRK-SENTEI-KHNTEN
                                           WRK-SENTEI-ZAITEN
                                           WRK-SENTEI-SRYCD
                                           WRK-SENTEI-SRYCD2
                                           NYUINACT-IDX
      *
           MOVE    SPACE              TO   WRK-GAIHAKU-SRYCD
           MOVE    ZERO               TO   WRK-GAIHAKU-KHNTEN
      *
           MOVE    ZERO               TO   WRK-HYOKETU-TEN
                                           WRK-HYOKETU-SRYCD
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC             =    ZERO
               MOVE    "tbl_nyuinact"      TO      MCP-TABLE
               MOVE    "key9"              TO      MCP-PATHNAME
               PERFORM 900-NYUINACT-READ-SEC
           ELSE
               MOVE    1              TO   FLG-NYUINACT
           END-IF
           IF      FLG-NYUINACT        =   ZERO
               MOVE      ZERO         TO   FLG-NYUKHN  
               PERFORM   VARYING  IDX2  FROM 1  BY  1
                 UNTIL  (FLG-NYUKHN         =      1)    OR
                        (IDX2               >      5)    OR
                        (NSRY-SRYCD(IDX2)   =  SPACE)
                     MOVE    NSRY-SRYCD(IDX2)    TO  WRK-SRYCD
                     MOVE    NACCT-SRYYM         TO  WK-TAIHI-SRYYM
                     MOVE    1                   TO  WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF   FLG-TENSU      =    ZERO
                       IF   TNS-DATAKBN    =    1
                          MOVE   TNS-TEN   TO   WRK-KHNTEN
      *                   初期加算（及び長期減算）の点数取得
      ***                 COMPUTE   WRK-KSNTEN  =   NACCT-ZAITEN
      ***                                       -   WRK-KHNTEN
                          MOVE   TNS-NYUKHNKSNKBN                  
                                           TO   WRK-NYUKHNKSNKBN   
                          MOVE   NSRY-SRYCD(IDX2)
                                           TO   WRK-SENTEI-SRYCD
      *                   看護比率基準未達時の入院基本点数の取得
                          PERFORM  2102011-GAIHAKU-NYUINKHN-SET-SEC
                          IF   WRK-GAIHAKU-KHNTEN  NOT =  ZERO
                                 MOVE   WRK-GAIHAKU-KHNTEN
                                               TO   WRK-KHNTEN
                          END-IF     
                          MOVE   IDX2      TO   NYUINACT-IDX
      ***                 MOVE   1         TO   FLG-NYUKHN
                       ELSE
                          EVALUATE  TNS-TENSIKIBETU
                            WHEN     3
                                MOVE  TNS-TEN  TO  WRK-KSNTEN
                                MOVE  NSRY-SRYCD(IDX2)
                                               TO  WRK-KSN-SRYCD
                            WHEN     8
                                COMPUTE  WRK-KSNTEN = TNS-TEN * -1
                                MOVE  NSRY-SRYCD(IDX2)
                                               TO  WRK-KSN-SRYCD
                            WHEN     6
                                MOVE  TNS-TEN  TO  WRK-HYOKETU-TEN
                                MOVE  NSRY-SRYCD(IDX2)
                                               TO  WRK-HYOKETU-SRYCD
                          END-EVALUATE
                       END-IF
                     END-IF                  
               END-PERFORM
      *
               IF    NYUINACT-IDX    NOT   =   ZERO
      *
                 MOVE    SPACE                TO  SENTEICDCHG-REC
                 INITIALIZE                       SENTEICDCHG-REC
                 MOVE    NSRY-SRYCD(NYUINACT-IDX)
                                              TO  SENCHG-IPNSRYCD
                 MOVE    SENTEICDCHG-REC      TO  MCPDATA-REC
                 MOVE    "tbl_senteicdchg"    TO  MCP-TABLE
                 MOVE    "key2"               TO  MCP-PATHNAME
                 PERFORM   900-DBSELECT-SEC
                 IF      MCP-RC             =    ZERO
                     MOVE    "tbl_senteicdchg"    TO  MCP-TABLE
                     MOVE    "key2"               TO  MCP-PATHNAME
                     PERFORM  900-SENTEICDCHG-READ-SEC
                 ELSE
                     MOVE    1                TO  FLG-SENTEICDCHG
                 END-IF
      *
                 IF  FLG-SENTEICDCHG   =   ZERO
      *
                    MOVE     SENCHG-SENTEISRYCD  TO   WRK-SRYCD
                    MOVE     NACCT-SRYYM         TO   WK-TAIHI-SRYYM
                    MOVE     1                   TO   WK-TAIHI-SRYD
                    PERFORM  900-TENSU-TBL-SEC
                    IF       FLG-TENSU      =    ZERO
                       MOVE     TNS-TEN          TO   WRK-SENTEI-KHNTEN
                       COMPUTE  WRK-SENTEI-ZAITEN  =  WRK-SENTEI-KHNTEN
                                                   +  WRK-KSNTEN
                       IF     WRK-HYOKETU-TEN    NOT =   ZERO
      *                  標欠：％減算
                         COMPUTE    WRK-SENTEI-ZAITEN  =
                                  ( WRK-SENTEI-ZAITEN  -
                                   (WRK-SENTEI-ZAITEN  *
                                    (WRK-HYOKETU-TEN   /  100)))  +  0.5
                       END-IF
                       MOVE  SENCHG-SENTEISRYCD  TO   WRK-SENTEI-SRYCD2
                    END-IF  
      *
                 END-IF
      *
                 MOVE    "tbl_senteicdchg"       TO      MCP-TABLE
                 MOVE    "key2"                  TO      MCP-PATHNAME
                 PERFORM   900-CLOSE-SEC
      *
               END-IF
      *
           END-IF
      *
           MOVE    "tbl_nyuinact"      TO      MCP-TABLE
           MOVE    "key9"              TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      ***  IF     WRK-HYOKETU-TEN    NOT =   ZERO
      *      標欠：％減算
      ***    COMPUTE    WRK-KHNTEN  =
      ***             ( WRK-KHNTEN  -
      ***              (WRK-KHNTEN  *
      ***               (WRK-HYOKETU-TEN   /  100)))  +  0.5
      ***  END-IF
      *
           .
       210201-NYUINKHN-GET-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊時の入院基本料取得
      **************************************************************
       2102011-GAIHAKU-NYUINKHN-SET-SEC           SECTION.
      *
           EVALUATE  TNS-SRYCD
               WHEN  "190078210"
                     MOVE  "190077410"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078310"
                     MOVE  "190077510"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078410"
                     MOVE  "190077610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078510"
                     MOVE  "190077710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078610"
                     MOVE  "190077810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078710"
                     MOVE  "190077910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078810"
                     MOVE  "190078010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078910"
                     MOVE  "190078110"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190082410"
                     MOVE  "190081710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082510"
                     MOVE  "190081810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082610"
                     MOVE  "190081910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082710"
                     MOVE  "190082010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082810"
                     MOVE  "190082110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082910"
                     MOVE  "190082210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190083010"
                     MOVE  "190082310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190084310"
                     MOVE  "190083610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084410"
                     MOVE  "190083710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084510"
                     MOVE  "190083810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084610"
                     MOVE  "190083910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084710"
                     MOVE  "190084010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084810"
                     MOVE  "190084110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084910"
                     MOVE  "190084210"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190087410"
                     MOVE  "190085910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087510"
                     MOVE  "190086010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087610"
                     MOVE  "190086110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087710"
                     MOVE  "190086210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087810"
                     MOVE  "190086310"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087910"
                     MOVE  "190086410"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088010"
                     MOVE  "190086510"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088110"
                     MOVE  "190086610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088210"
                     MOVE  "190086710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088310"
                     MOVE  "190086810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088410"
                     MOVE  "190086910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088510"
                     MOVE  "190087010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088610"
                     MOVE  "190087110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088710"
                     MOVE  "190087210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088810"
                     MOVE  "190087310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190094710"
                     MOVE  "190093710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190094810"
                     MOVE  "190093810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190094910"
                     MOVE  "190093910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190095010"
                     MOVE  "190094010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190095110"
                     MOVE  "190094110"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190797410"
                     MOVE  "190796610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797510"
                     MOVE  "190796710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797610"
                     MOVE  "190796810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797710"
                     MOVE  "190796910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797810"
                     MOVE  "190797010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797910"
                     MOVE  "190797110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190798010"
                     MOVE  "190797210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190798110"
                     MOVE  "190797310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190803510"
                     MOVE  "190802810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803610"
                     MOVE  "190802910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803710"
                     MOVE  "190803010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803810"
                     MOVE  "190803110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803910"
                     MOVE  "190803210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190804010"
                     MOVE  "190803310"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190804110"
                     MOVE  "190803410"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190091210"
                     MOVE  "190090210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190091310"
                     MOVE  "190090310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190109670"
                     MOVE  "190097010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190808870"
                     MOVE  "190805710"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190117070"
                     MOVE  "190097010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190813270"
                     MOVE  "190805710"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190117670"
                     MOVE  "190097010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190813870"
                     MOVE  "190805710"      TO   WRK-GAIHAKU-SRYCD
      *        診療所老人医療管理料
               WHEN  "190774210"
                     MOVE  "190774110"      TO   WRK-GAIHAKU-SRYCD
      *        老人性認知症疾患治療病棟入院料１
               WHEN  "190740010"
                     MOVE  "190739910"      TO   WRK-GAIHAKU-SRYCD
      *        老人性認知症疾患治療病棟入院料２
               WHEN  "190813510"
                     MOVE  "190813410"      TO   WRK-GAIHAKU-SRYCD
           END-EVALUATE
      *
           IF   (RECE62-SRYYM      >= "200604"   )
           AND  (WRK-GAIHAKU-SRYCD  = "190774110" OR
                                      "190739910" OR
                                      "190813410")
               MOVE    SPACE    TO    WRK-GAIHAKU-SRYCD
           END-IF
      *
           IF    WRK-GAIHAKU-SRYCD    NOT =   SPACE
               MOVE    WRK-GAIHAKU-SRYCD   TO  WRK-SRYCD
               MOVE    NACCT-SRYYM         TO  WK-TAIHI-SRYYM
               MOVE    1                   TO  WK-TAIHI-SRYD
               PERFORM    900-TENSU-TBL-SEC
               IF   FLG-TENSU      =    ZERO
                     MOVE     TNS-TEN      TO  WRK-GAIHAKU-KHNTEN
               END-IF                  
           END-IF
      *
           .
       2102011-GAIHAKU-NYUINKHN-SET-EXT.
           EXIT.
      *
      **************************************************************
      *    選定外泊時の係数取得
      **************************************************************
       210202-SENTEI-KEISU-GET-SEC           SECTION.
      *
           MOVE      ZERO           TO     WRK-SENTEI-KEISU
      *
           IF   RECE62-SRYYM    <=    "200303"
               MOVE   0.1           TO     WRK-SENTEI-KEISU
           END-IF
      *
           IF ( RECE62-SRYYM    >=    "200304" )   AND
              ( RECE62-SRYYM    <=    "200403" )
               MOVE   0.05           TO    WRK-SENTEI-KEISU
           END-IF
      *
           IF   RECE62-SRYYM    >=    "200404"
               MOVE   ZERO          TO     WRK-SENTEI-KEISU
           END-IF
      *
           .
      *
       210202-SENTEI-KEISU-GET-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊の入院基本料計算
      **************************************************************
       210203-NYUINACCT-GET-SEC           SECTION.
      *
      *    入院料と外泊を比較して点数算定
      *
           EVALUATE   WRK-DAY22-NYUTENTTLKBN(IDY)
               WHEN   903
                  IF    WRK-DAY1-SENTEI(IDY)   NOT  =  ZERO
                    EVALUATE   WRK-DAY22(IDY)
                     WHEN   1
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    1     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   3
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    3     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   4
                       IF   RECE62-SRYYM    >=    "201004"
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-SENTEI-KHNTEN(IDY)  *  0.3)
                                                               +  0.5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                  WRK-DAY22-NYUKHNRYO(IDY) +
                                  WRK-DAY1-KSNTEN(IDY)
                         IF  WRK-DAY1-HYOKETU-TEN(IDY)  NOT =  ZERO
                           COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                                  (WRK-DAY22-NYUKHNRYO(IDY)    -
                                   (WRK-DAY22-NYUKHNRYO(IDY)   *
                                    (WRK-DAY1-HYOKETU-TEN(IDY) / 100)))
                                                               + 0.5
                         END-IF
                         MOVE    5     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       ELSE
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
      ****                       (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                 (WRK-DAY1-KHNTEN(IDY)  
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    5     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       END-IF
                     WHEN   5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-SENTEI-KHNTEN(IDY)  *  0.7)
                                                               +  0.5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                  WRK-DAY22-NYUKHNRYO(IDY) +
                                  WRK-DAY1-KSNTEN(IDY)
                         IF  WRK-DAY1-HYOKETU-TEN(IDY)  NOT =  ZERO
                           COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                                  (WRK-DAY22-NYUKHNRYO(IDY)    -
                                   (WRK-DAY22-NYUKHNRYO(IDY)   *
                                    (WRK-DAY1-HYOKETU-TEN(IDY) / 100)))
                                                               + 0.5
                         END-IF
                         MOVE    12    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                    END-EVALUATE
                  ELSE
                    EVALUATE   WRK-DAY22(IDY)
                     WHEN   1
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                                        +  0.5
                         MOVE    1     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   2
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.3)
                                                        +  0.5
                         MOVE    2     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   4
                         IF   RECE62-SRYYM    >=    "200404"
                            COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                    (WRK-DAY1-KHNTEN(IDY)  *  0.3)
                                                           +  0.5
                         ELSE
                            COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                    (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                                           +  0.5
                         END-IF
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                  WRK-DAY22-NYUKHNRYO(IDY) +
                                  WRK-DAY1-KSNTEN(IDY)
                         IF  WRK-DAY1-HYOKETU-TEN(IDY)  NOT =  ZERO
                           COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                                  (WRK-DAY22-NYUKHNRYO(IDY)    -
                                   (WRK-DAY22-NYUKHNRYO(IDY)   *
                                    (WRK-DAY1-HYOKETU-TEN(IDY) / 100)))
                                                               + 0.5
                         END-IF
                         MOVE    4     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.7)
                                                        +  0.5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                  WRK-DAY22-NYUKHNRYO(IDY) +
                                  WRK-DAY1-KSNTEN(IDY)
                         IF  WRK-DAY1-HYOKETU-TEN(IDY)  NOT =  ZERO
                           COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                                  (WRK-DAY22-NYUKHNRYO(IDY)    -
                                   (WRK-DAY22-NYUKHNRYO(IDY)   *
                                    (WRK-DAY1-HYOKETU-TEN(IDY) / 100)))
                                                               + 0.5
                         END-IF
                         MOVE    11    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                    END-EVALUATE
                  END-IF
               WHEN   920
                  IF    WRK-DAY1-SENTEI(IDY)   NOT  =  ZERO
                    EVALUATE   WRK-DAY22(IDY)
                     WHEN   1
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    6     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   3
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    8     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   4
                       IF   RECE62-SRYYM    >=    "201004"
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-SENTEI-KHNTEN(IDY)  *  0.3)
                                                               +  0.5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                  WRK-DAY22-NYUKHNRYO(IDY) +
                                  WRK-DAY1-KSNTEN(IDY)
                         IF  WRK-DAY1-HYOKETU-TEN(IDY)  NOT =  ZERO
                           COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                                  (WRK-DAY22-NYUKHNRYO(IDY)    -
                                   (WRK-DAY22-NYUKHNRYO(IDY)   *
                                    (WRK-DAY1-HYOKETU-TEN(IDY) / 100)))
                                                               + 0.5
                         END-IF
                         MOVE   10     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       ELSE
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
      ****                       (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                 (WRK-DAY1-KHNTEN(IDY)  
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE   10     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       END-IF
                     WHEN   5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-SENTEI-KHNTEN(IDY)  *  0.7)
                                                               +  0.5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                  WRK-DAY22-NYUKHNRYO(IDY) +
                                  WRK-DAY1-KSNTEN(IDY)
                         IF  WRK-DAY1-HYOKETU-TEN(IDY)  NOT =  ZERO
                           COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                                  (WRK-DAY22-NYUKHNRYO(IDY)    -
                                   (WRK-DAY22-NYUKHNRYO(IDY)   *
                                    (WRK-DAY1-HYOKETU-TEN(IDY) / 100)))
                                                               + 0.5
                         END-IF
                         MOVE   14     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                    END-EVALUATE
                  ELSE
                    EVALUATE   WRK-DAY22(IDY)
                     WHEN   1
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                                        +  0.5
                         MOVE    6     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   2
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.3)
                                                        +  0.5
                         MOVE    7     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   4
                         IF   RECE62-SRYYM    >=    "200404"
                            COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                    (WRK-DAY1-KHNTEN(IDY)  *  0.3)
                                                           +  0.5
                         ELSE
                            COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                    (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                                           +  0.5
                         END-IF
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                  WRK-DAY22-NYUKHNRYO(IDY) +
                                  WRK-DAY1-KSNTEN(IDY)
                         IF  WRK-DAY1-HYOKETU-TEN(IDY)  NOT =  ZERO
                           COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                                  (WRK-DAY22-NYUKHNRYO(IDY)    -
                                   (WRK-DAY22-NYUKHNRYO(IDY)   *
                                    (WRK-DAY1-HYOKETU-TEN(IDY) / 100)))
                                                               + 0.5
                         END-IF
                         MOVE    9     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.7)
                                                        +  0.5
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                  WRK-DAY22-NYUKHNRYO(IDY) +
                                  WRK-DAY1-KSNTEN(IDY)
                         IF  WRK-DAY1-HYOKETU-TEN(IDY)  NOT =  ZERO
                           COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                                  (WRK-DAY22-NYUKHNRYO(IDY)    -
                                   (WRK-DAY22-NYUKHNRYO(IDY)   *
                                    (WRK-DAY1-HYOKETU-TEN(IDY) / 100)))
                                                               + 0.5
                         END-IF
                         MOVE    13    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                    END-EVALUATE
                  END-IF
           END-EVALUATE
      *
           .
       210203-NYUINACCT-GET-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊の入院基本料集計
      **************************************************************
       2102031-NYUINACCT-SYU-SEC           SECTION.
      *
           IF  ( WRK-DAY22-NYUKHNRYO(IDY)  NOT =  ZERO     )
      *
           OR  ((WRK-DAY22-NYUKHNRYO(IDY)      =  ZERO    )  AND
                (SYUKEI-IDX   =   3  OR  5  OR  8  OR  10
                                     OR 12  OR 14         ))
      *
             MOVE     ZERO     TO    FLG-ARI
             PERFORM  VARYING  SYUKEI-IDX2    FROM    1   BY  1
                  UNTIL  SYUKEI-IDX2           > 10
                   OR    WRK-GAI-DAY(SYUKEI-IDX SYUKEI-IDX2) = ZERO
                   OR    FLG-ARI               = 1
              IF  WRK-GAI-ZAITEN(SYUKEI-IDX SYUKEI-IDX2)
                                            =  WRK-DAY22-NYUKHNRYO(IDY)
                 ADD   1  TO   WRK-GAI-ZAIKAISU(SYUKEI-IDX SYUKEI-IDX2)
                 MOVE  1  TO                                            
                           WRK-GAI-KAISU   (SYUKEI-IDX SYUKEI-IDX2 IDY) 
                 MOVE  1  TO   FLG-ARI
              END-IF
             END-PERFORM  
             IF  FLG-ARI  =  ZERO  
                 MOVE  IDY 
                          TO   WRK-GAI-DAY     (SYUKEI-IDX SYUKEI-IDX2)
                 MOVE  WRK-DAY22-NYUKHNRYO(IDY)
                          TO   WRK-GAI-ZAITEN  (SYUKEI-IDX SYUKEI-IDX2) 
                 ADD   1  TO   WRK-GAI-ZAIKAISU(SYUKEI-IDX SYUKEI-IDX2)
                 MOVE  1  TO                                            
                           WRK-GAI-KAISU   (SYUKEI-IDX SYUKEI-IDX2 IDY) 
             END-IF
      *
             ADD    1     TO   CNT-DAY22
             MOVE   1     TO   FLG-DAY22
      *
           END-IF
      *
           .
      *
       2102031-NYUINACCT-SYU-EXT.
           EXIT.
      *
      **************************************************************
      *    食事療養費の集計
      **************************************************************
       210204-NYUINACCT-SYU2-SEC           SECTION.
      *
           IF   RECE62-SRYYM  >= "200604"
            IF  RECE62-DOUJITSU-HKNCOMBI(IDY)  NOT = ZERO
            AND RECE62-HKNCOMBI(IDX1)   NOT =
                                        RECE62-DOUJITSU-HKNCOMBI(IDY)
             MOVE    1    TO  FLG-DOJITU
             MOVE    2    TO  WRK-SKJ-DOJITU-KBN (IDX1 IDY)
             EVALUATE   NACCT-SRYCDTOTAL
               WHEN  099999918
                 MOVE  NACCT-DAY(IDY) TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
               WHEN  099999919
                 MOVE  NACCT-DAY(IDY) TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
               WHEN  099999920
                 MOVE  NACCT-DAY(IDY) TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
             END-EVALUATE
             MOVE  RECE62-HKNCOMBI(IDX1)
                                  TO  WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
            ELSE
             EVALUATE   WRK-SHOKUJIRYOYO(IDY)
              WHEN  1
                 EVALUATE   WRK-DAY24(IDY)
                   WHEN  1
                     MOVE    RECE62-HKNCOMBI(IDX1)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE  ZERO    TO  WRK-DAY4(IDY)
                     END-IF
                   WHEN  2
                     MOVE    RECE62-HKNCOMBI(IDX1)  TO
                                         WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 2)
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE  ZERO    TO  WRK-DAY4(IDY)
                     END-IF
                 END-EVALUATE
              WHEN  2
                     MOVE    RECE62-HKNCOMBI(IDX1)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
             END-EVALUATE
            END-IF
           ELSE
             EVALUATE   WRK-DAY24(IDY)
              WHEN  1
                EVALUATE   WRK-SHOKUJIRYOYO(IDY)
                  WHEN  1
      *              入院時食事療養（１）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000110"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000110"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              特別管理加算
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE  "197000270"    TO   WRK-SKJ-SRYCD-OCC
                                                               (IDY 2)
                        MOVE  "197000270"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              食堂加算
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                        MOVE  "197000570"    TO   WRK-SKJ-SRYCD-OCC
                                                                (IDY 4)
                        MOVE  "197000570"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *
                  WHEN  2
      *              入院時食事療養（２）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000710"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000710"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
                END-EVALUATE
              WHEN  2
      *              入院時食事療養（１）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000110"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000110"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              特別管理加算
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE  "197000270"    TO   WRK-SKJ-SRYCD-OCC
                                                                (IDY 2)
                        MOVE  "197000270"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              特別食加算
                     MOVE  "197000470"    TO   WRK-SKJ-SRYCD-OCC(IDY 3)
                     MOVE  "197000470"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              食堂加算
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                        MOVE  "197000570"    TO   WRK-SKJ-SRYCD-OCC
                                                                (IDY 4)
                        MOVE  "197000570"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
              WHEN  3
      *              入院時食事療養（１）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000110"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000110"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              特別管理加算
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE  "197000270"    TO   WRK-SKJ-SRYCD-OCC
                                                                 (IDY 2)
                        MOVE  "197000270"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              食堂加算
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                        MOVE  "197000570"    TO   WRK-SKJ-SRYCD-OCC
                                                                 (IDY 4)
                        MOVE  "197000570"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              複数献立加算
                     MOVE  "197000670"    TO   WRK-SKJ-SRYCD-OCC(IDY 5)
                     MOVE  "197000670"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
              WHEN  4
      *              入院時食事療養（１）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000110"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000110"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              特別管理加算
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE  "197000270"    TO   WRK-SKJ-SRYCD-OCC
                                                                (IDY 2)
                        MOVE  "197000270"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              特別食加算
                     MOVE  "197000470"    TO   WRK-SKJ-SRYCD-OCC(IDY 3)
                     MOVE  "197000470"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              食堂加算
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                        MOVE  "197000570"    TO   WRK-SKJ-SRYCD-OCC
                                                                 (IDY 4)
                        MOVE  "197000570"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              複数献立加算
                     MOVE  "197000670"    TO   WRK-SKJ-SRYCD-OCC(IDY 5)
                     MOVE  "197000670"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
             END-EVALUATE
           END-IF
      *
           .
       210204-NYUINACCT-SYU2-EXT.
           EXIT.
      *
      **************************************************************
      *    食事療養費の集計（同日再入院分）
      **************************************************************
       210223-NYUINACCT-SYU2-DOJITU-SEC           SECTION.
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
             EVALUATE  WRK-SKJ-DOJITU-KBN(IDX1 IDY)
               WHEN         1
                 MOVE  WRK-DAY4X(IDY)
                                   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                 EVALUATE  RECE62-DOUJITSU-SKJKBN(IDY)
                   WHEN     "0"
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                   WHEN     "1"
                     CONTINUE
                   WHEN     "2"
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY)  NOT = ZERO
                       MOVE ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                   WHEN     "3"
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY)  NOT = ZERO
                     OR   WRK-SKJ-DOJITU-HIRU(IDX1 IDY)  NOT = ZERO
                       MOVE ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                 END-EVALUATE
               WHEN         2
                 MOVE  WRK-DAY4X(IDY)
                                   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                 EVALUATE  RECE62-DOUJITSU-SKJKBN(IDY)
                   WHEN     "0"
                     CONTINUE
                   WHEN     "1"
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                   WHEN     "2"
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) = ZERO
                       MOVE ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                   WHEN     "3"
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) = ZERO
                     AND  WRK-SKJ-DOJITU-HIRU(IDX1 IDY) = ZERO
                       MOVE ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                 END-EVALUATE
             END-EVALUATE
           END-PERFORM
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
             IF   WRK-SKJ-DOJITU-KBN(IDX1 IDY)  NOT = ZERO
               EVALUATE   WRK-SHOKUJIRYOYO(IDY)
                 WHEN  1
                   IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) =  2
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 2)
                     END-IF
                     IF   WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE ZERO  TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                   END-IF
                   IF   WRK-SKJ-DOJITU-HIRU(IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     IF   WRK-SKJ-DOJITU-HIRU(IDX1 IDY) =  2
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 2)
                     END-IF
                     IF   WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE ZERO  TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                   END-IF
                   IF   WRK-SKJ-DOJITU-YORU(IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     IF   WRK-SKJ-DOJITU-YORU(IDX1 IDY) =  2
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 2)
                     END-IF
                     IF   WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE ZERO  TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                   END-IF
                 WHEN  2
                   IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                   END-IF
                   IF   WRK-SKJ-DOJITU-HIRU(IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                   END-IF
                   IF   WRK-SKJ-DOJITU-YORU(IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                   END-IF
               END-EVALUATE
             END-IF
           END-PERFORM
      *
           .
       210223-NYUINACCT-SYU2-DOJITU-EXT.
           EXIT.
      *
      **************************************************************
      *    食事療養費の集計（環境）
      **************************************************************
       210218-NYUINACCT-SYU2-KAN-SEC           SECTION.
      *
           EVALUATE   WRK-SHOKUJIRYOYO(IDY)
             WHEN  1
               MOVE    RECE62-HKNCOMBI(IDX1)
                               TO  WRK-SKJ200604-HKNCOMBI(IDX1)
               MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
               MOVE    1       TO  WRK-SKJ200604-DAY-KAN(IDX1 IDY)
             WHEN  2
               MOVE    RECE62-HKNCOMBI(IDX1)
                               TO  WRK-SKJ200604-HKNCOMBI(IDX1)
               MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
               MOVE    1       TO  WRK-SKJ200604-DAY-KAN(IDX1 IDY)
           END-EVALUATE
      *
           .
       210218-NYUINACCT-SYU2-KAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210205-RECE64-TENSOU2-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    NACCT-SRYKBN         TO      RECE64-SRYKBN
           IF      NACCT-ZAISKBKBN      =       "1"
             IF  (NACCT-SRYCDTOTAL =   190799410 )
             OR  (NACCT-SRYCDTOTAL =   190799510 )
                MOVE    "90"            TO      RECE64-SRYKBN
             END-IF
           END-IF
           IF      NACCT-ZAISKBKBN      =       "6"
             EVALUATE  WRK-NYUTENTTLKBN
               WHEN      903
                MOVE    "90"            TO      RECE64-SRYKBN
               WHEN      920
                MOVE    "92"            TO      RECE64-SRYKBN
             END-EVALUATE
           END-IF
           MOVE    NACCT-ZAISKBKBN      TO      RECE64-ZAISKBKBN
           IF      NACCT-ZAISKBKBN      =       "7"
                MOVE     "80"           TO      RECE64-SRYKBN
                MOVE    SPACE           TO      RECE64-ZAISKBKBN
           END-IF
      *
           MOVE    ZERO                 TO      WRK-ZAINUM-CNT
           MOVE    ZERO                 TO      WRK-ZAINUM-CNT3
           EVALUATE  NACCT-ZAISKBKBN
            WHEN    "1"
             PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                            OR       WRK-ZAINUM-CNT  NOT =  ZERO
                 IF  WRK-DAY21(IDX2)   NOT =   ZERO
                     MOVE    IDX2       TO      WRK-ZAINUM-CNT
                 END-IF
             END-PERFORM
             COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
             MOVE    WRK-ZAINUM         TO      RECE64-ZAINUM
            WHEN    "6"
             COMPUTE WRK-ZAINUM  = 99993000  +  WRK-ZAINUM-CNT2
             MOVE    WRK-ZAINUM         TO      RECE64-ZAINUM
            WHEN    "7"
             PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                            OR       WRK-ZAINUM-CNT3 NOT =  ZERO
                 IF  WRK-DAY21(IDX2)   NOT =   ZERO
                     MOVE    IDX2       TO      WRK-ZAINUM-CNT3
                 END-IF
             END-PERFORM
             COMPUTE WRK-ZAINUM  = 99993900  +  WRK-ZAINUM-CNT3
             MOVE    WRK-ZAINUM         TO      RECE64-ZAINUM
            WHEN    OTHER
             MOVE    NACCT-ZAINUM       TO      RECE64-ZAINUM
           END-EVALUATE
      *
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    NACCT-SRYKA          TO      RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI(IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           MOVE    NACCT-ZAITEN         TO      RECE64-ZAITEN
           MOVE    NACCT-MEISAISU       TO      RECE64-MEISAISU
           MOVE    CNT-DAY21            TO      RECE64-ZAIKAISU
           MOVE    NACCT-SYUTEN1        TO      RECE64-SYUTEN1
           MOVE    NACCT-SRYCDTOTAL     TO      RECE64-SRYCDTOTAL
           IF      NACCT-ZAISKBKBN      =       "7"
                MOVE    199000510       TO      RECE64-SRYCDTOTAL
           END-IF
           MOVE    NACCT-SURYOUTOTAL    TO      RECE64-SURYOUTOTAL
           MOVE    NACCT-SYUTEN2        TO      RECE64-SYUTEN2
           MOVE    NACCT-YKZTEN         TO      RECE64-YKZTEN
           MOVE    NACCT-KIZAITEN       TO      RECE64-KIZAITEN
           MOVE    NACCT-DRCD           TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-DAY21(IDX2)  TO
                                            RECE64-KAISU (1 IDX2)
                   IF     (WK-TAIHI-FLG           =   ZERO)   AND
                          (WRK-DAY21(IDX2)    NOT =   ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
           END-PERFORM
           .
       210205-RECE64-TENSOU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210206-RECE65-HENSYU2-SEC               SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
      *
               MOVE    "tbl_nyuinact"   TO   MCP-TABLE
               MOVE    "key9"           TO   MCP-PATHNAME
               PERFORM  900-NYUINACT-READ-SEC
               PERFORM  UNTIL  (FLG-NYUINACT  =    "1")
                   PERFORM   2102061-RECE65-TENSOU2-SEC
                   IF      NACCT-ZAISKBKBN      =       "7"
                      PERFORM   2102062-RECE62-HENSYU2-SEC
                   END-IF
                   PERFORM   RECE65-WRITE-SEC
                   MOVE    "tbl_nyuinact"     TO   MCP-TABLE
                   MOVE    "key9"             TO   MCP-PATHNAME
                   PERFORM        900-NYUINACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210206-RECE65-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       2102061-RECE65-TENSOU2-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
      *
           EVALUATE  NACCT-ZAISKBKBN
            WHEN    "1"
             COMPUTE WRK-ZAINUM   =  99999800  +  WRK-ZAINUM-CNT
             MOVE    WRK-ZAINUM         TO      RECE65-ZAINUM
            WHEN    "6"
             COMPUTE WRK-ZAINUM   =  99993000  +  WRK-ZAINUM-CNT2
             MOVE    WRK-ZAINUM         TO      RECE65-ZAINUM
            WHEN    "7"
             COMPUTE WRK-ZAINUM   =  99993900  +  WRK-ZAINUM-CNT3
             MOVE    WRK-ZAINUM         TO      RECE65-ZAINUM
            WHEN    OTHER
             MOVE    NSRY-ZAINUM        TO      RECE65-ZAINUM
           END-EVALUATE
      *
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    NSRY-RENNUM          TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    NSRY-SRYKA           TO      RECE65-SRYKA
           MOVE    NSRY-SRYKBN          TO      RECE65-SRYKBN
           MOVE    NSRY-SRYSYUKBN       TO      RECE65-SRYSYUKBN
           IF      NACCT-ZAISKBKBN      =       "1"
             IF  (NACCT-SRYCDTOTAL =   190799410 )
             OR  (NACCT-SRYCDTOTAL =   190799510 )
                MOVE    "90"            TO      RECE65-SRYKBN
                MOVE    "900"           TO      RECE65-SRYSYUKBN
             END-IF
           END-IF
           IF      NACCT-ZAISKBKBN      =       "6"
             EVALUATE  WRK-NYUTENTTLKBN
               WHEN      903
                MOVE    "90"            TO      RECE65-SRYKBN
                MOVE    "900"           TO      RECE65-SRYSYUKBN
               WHEN      920
                MOVE    "92"            TO      RECE65-SRYKBN
                MOVE    "920"           TO      RECE65-SRYSYUKBN
             END-EVALUATE
           END-IF
           IF      NACCT-ZAISKBKBN      =       "7"
                MOVE     "80"           TO      RECE65-SRYKBN
                MOVE     "800"          TO      RECE65-SRYSYUKBN
           END-IF
           MOVE    NSRY-JIHIMONEYTOTAL  TO      RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    OR
                                (NSRY-SRYCD(IDX2)  =   SPACE)
             IF      NSRY-SRYCD(IDX2)(1:1)    =   "0"  OR  "1" OR  
                                                  "8"
               ADD     1                   TO  IDX4    
               MOVE    NSRY-SRYCD(IDX2)    TO  RECE65-SRYCD(IDX4)
               IF      NACCT-ZAISKBKBN      =       "7"
                  MOVE     "199000510"     TO  RECE65-SRYCD(IDX4)
               END-IF
               MOVE    NSRY-SRYSURYO(IDX2) TO  RECE65-SRYSURYO(IDX4)
               MOVE    NSRY-SRYKAISU(IDX2) TO  RECE65-SRYKAISU(IDX4)
               MOVE    SPACE               TO  RECE65-MEISKYFLG(IDX4)
               MOVE    NSRY-AUTOKBN(IDX2)  TO  RECE65-AUTOKBN(IDX4)
               MOVE    NSRY-INPUTNUM(IDX2) TO  RECE65-INPUTNUM(IDX4)
               MOVE    NSRY-SRYCD(IDX2)    TO  WRK-SRYCD
               IF      NACCT-ZAISKBKBN      =       "7"
                  MOVE     199000510       TO  WRK-SRYCD
               END-IF
               MOVE    RECE65-SRYYM        TO  WK-TAIHI-SRYYM
               MOVE    WK-TAIHI-DAY        TO  WK-TAIHI-SRYD
               PERFORM    900-TENSU-TBL-SEC
               MOVE    TNS-TANICD          TO  RECE65-TANICD(IDX4)
               MOVE    TNS-TANIMOJISU      TO  RECE65-TANIMOJISU(IDX4)
               MOVE    TNS-TANINAME        TO  RECE65-TANINAME(IDX4)
               MOVE    TNS-TENSIKIBETU     TO  RECE65-TENSIKIBETU(IDX4)
               MOVE    TNS-TEN             TO  RECE65-TEN(IDX4)
               MOVE    TNS-NYUTENTTLKBN    TO  RECE65-TENTTLKBN(IDX4)
               MOVE    TNS-YUKOKETA        TO  RECE65-YUKOKETA(IDX4)
               MOVE    TNS-DATAKBN         TO  RECE65-DATAKBN (IDX4)
               MOVE    TNS-HOUKNSKBN       TO  RECE65-HOUKNSKBN(IDX4)
               MOVE    TNS-KNSJISKBN       TO  RECE65-KNSJISKBN(IDX4)
               MOVE    TNS-CDKBN-KBN       TO  RECE65-CDKBN-KBN(IDX4)
               MOVE    TNS-CDKBN-SYO       TO  RECE65-CDKBN-SYO(IDX4)
               MOVE    TNS-CDKBN-BU        TO  RECE65-CDKBN-BU(IDX4)
               MOVE    TNS-CDKBN-KBNNUM   
                                      TO RECE65-CDKBN-KBNNUM(IDX4)
               MOVE    TNS-CDKBN-KBNNUM-EDA
                                      TO RECE65-CDKBN-KBNNUM-EDA(IDX4)
               MOVE    TNS-CDKBN-KOUBAN
                                      TO RECE65-CDKBN-KOUBAN(IDX4)
               MOVE    TNS-KOUHYOJYUNNUM  
                                      TO RECE65-KOUHYOJYUNNUM(IDX4)
      *
               MOVE    TNS-SRYSYUKBN  TO RECE65-SRYSYUKBN-X(IDX4)
               MOVE    TNS-KOKUJISKBKBN1
                                      TO RECE65-KOKUJISKBKBN1(IDX4)
               MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE65-KOKUJISKBKBN2(IDX4)
               MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE65-TUSOKUGAIKBN (IDX4)
               MOVE    TNS-TIMEKSNKBN TO RECE65-TIMEKSNKBN   (IDX4)
               MOVE    TNS-KZMCOMPSIKIBETU
                                      TO RECE65-KZMCOMPSIKIBETU(IDX4)
               MOVE    TNS-CHUKSNCD   TO RECE65-CHUKSNCD(IDX4)
               MOVE    TNS-CHUKSNTUBAN
                                      TO RECE65-CHUKSNTUBAN(IDX4)
               MOVE    TNS-KENTAICOMMENT
                                      TO RECE65-KENTAICOMMENT(IDX4)
               MOVE    TNS-KNSJISGRPKBN
                                      TO RECE65-KNSJISGRPKBN(IDX4)
               MOVE    TNS-TOKUKIZAISBT1
                                      TO RECE65-TOKUKIZAISBT1(IDX4)
               MOVE    TNS-SANSOKBN   TO RECE65-SANSOKBN     (IDX4)
      *
               IF    ((NSRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                      (NSRY-SRYCD    (IDX2)(1:3)     =   "008"))
               AND   ( NSRY-INPUTNUM (IDX2)      NOT =   ZERO  )
                   MOVE    NSRY-HOSPNUM          TO  PTCOM-HOSPNUM
                   MOVE    NSRY-PTID             TO  PTCOM-PTID
                   MOVE    NSRY-ZAINUM           TO  PTCOM-ZAINUM
                   MOVE    NSRY-SRYCD (IDX2)     TO  PTCOM-SRYCD
                   MOVE    NSRY-INPUTNUM(IDX2)   TO  PTCOM-RENNUM
                   PERFORM 950-PTCOM-READ-SEC
                   MOVE    PTCOM-INPUTCOMENT     TO  RECE65-NAME(IDX4)
               ELSE
                   MOVE    TNS-NAME              TO  RECE65-NAME(IDX4)
      *
                 IF   RECE62-SRYYM  >= "200604"
                   CONTINUE
                 ELSE
                   IF   RECE64-ZAISKBKBN = "1"
                   AND  RECE64-SRYKBN    = "90"
                   AND  TNS-DATAKBN      =  1
                   AND  TNS-ROUTEKKBN    =  2
      *
                      IF   RECE65-NAME(IDX4)(1:4) = "老人"
                         CONTINUE
                      ELSE
                         MOVE  "老人"    TO   RECE65-NAME(IDX4)(1:4)
                         MOVE  TNS-NAME  TO   RECE65-NAME(IDX4)(5:) 
                         COMPUTE  RECE65-YUKOKETA(IDX4) =
                                  RECE65-YUKOKETA(IDX4) + 2
                      END-IF
      *
                   END-IF
                 END-IF
      *
               END-IF
      *
               MOVE    NSRY-SRYCD(IDX2)  TO  WRK-SRYCD
               IF      NACCT-ZAISKBKBN      =       "7"
                  MOVE     199000510     TO  WRK-SRYCD
               END-IF
               MOVE     ZERO    TO    WRK-FUKA-KINGAKU
               PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                         UNTIL   FUKA-IDX   >    9
                 MOVE   WRK-SRYCD(FUKA-IDX:1)
                                         TO  WRK-FUKA-VALUE
                 IF  WRK-FUKA-VALUE  =  ZERO
                   CONTINUE
                 ELSE
                   COMPUTE  RECE64-RUIKEITOTAL  =
                            RECE64-RUIKEITOTAL  +
                          ( WRK-FUKA-VALUE    * WRK-SRYCD)
                   COMPUTE  WRK-FUKA-KINGAKU    =
                            WRK-FUKA-KINGAKU    +
                          ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                              * NSRY-SRYSURYO(IDX2))
                 END-IF
               END-PERFORM
               COMPUTE  RECE64-RUIKEITOTAL  =
                        RECE64-RUIKEITOTAL  +
                        WRK-FUKA-KINGAKU
      *
             END-IF  
           END-PERFORM
      *
           .
       2102061-RECE65-TENSOU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（療養担当手当）
      *****************************************************************
       2102062-RECE62-HENSYU2-SEC                SECTION.
      *
      *    公費の分離表示用インデックスの確定
           MOVE          ZERO       TO     BUN-IDX
      ***  IF    (RECE62-HKNNUM          NOT =   SPACE)   OR
           IF    (RECE62-HKNNUMHC(IDX1)  NOT =   SPACE)   OR
                 (RECE62-RJNHKNNUM       NOT =   SPACE)
           MOVE          1          TO     BUN-IDX
           END-IF
      *    インデックス２
           MOVE          ZERO       TO     BUN-IDX2
           IF  RECE62-HENTOTALTEN(2)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(2) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(2)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(1)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(1)
                           IF      RECE62-RECESKYKBN (1)       =   SPACE
                               MOVE      2       TO     BUN-IDX2
                           END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス３
           MOVE          ZERO       TO     BUN-IDX3
           IF  RECE62-HENTOTALTEN(3)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(3) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(3)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(2)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(2)
                           IF      RECE62-RECESKYKBN (2)       =   SPACE
                               MOVE      3       TO     BUN-IDX3
                           END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス４
           MOVE          ZERO       TO     BUN-IDX4
           IF  RECE62-HENTOTALTEN(4)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(4) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(4)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(3)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(3)
                           IF      RECE62-RECESKYKBN (3)       =   SPACE
                               MOVE      4       TO     BUN-IDX4
                           END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *
      *    その他のレセ点数欄の編集
           IF    BUN-IDX        =   1
                   COMPUTE   RECE62-TENSU(21 BUN-IDX)  =
                             RECE62-TENSU(21 BUN-IDX)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
           END-IF
           IF    BUN-IDX2       =   2
                   COMPUTE   RECE62-TENSU(21 BUN-IDX2)  =
                             RECE62-TENSU(21 BUN-IDX2)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
           END-IF
           IF    BUN-IDX3       =   3
                   COMPUTE   RECE62-TENSU(21 BUN-IDX3)  =
                             RECE62-TENSU(21 BUN-IDX3)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
           END-IF
           IF    BUN-IDX4       =   4
                   COMPUTE   RECE62-TENSU(21 BUN-IDX4)  =
                             RECE62-TENSU(21 BUN-IDX4)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
           END-IF
      *
           .
       2102062-RECE62-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210207-RECE64-TENSOU2-SEN-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    NACCT-SRYKBN         TO      RECE64-SRYKBN
           IF      NACCT-ZAISKBKBN      =       "1"
             IF  (NACCT-SRYCDTOTAL =   190799410 )
             OR  (NACCT-SRYCDTOTAL =   190799510 )
                MOVE    "90"            TO      RECE64-SRYKBN
             END-IF
           END-IF
           IF      NACCT-ZAISKBKBN      =       "6"
             EVALUATE  WRK-NYUTENTTLKBN
               WHEN      903
                MOVE    "90"            TO      RECE64-SRYKBN
               WHEN      920
                MOVE    "92"            TO      RECE64-SRYKBN
             END-EVALUATE
           END-IF
           MOVE    NACCT-ZAISKBKBN      TO      RECE64-ZAISKBKBN
      *
           MOVE        ZERO             TO      WRK-ZAINUM-CNT
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                            OR       WRK-ZAINUM-CNT  NOT =  ZERO
               IF  WRK-DAY21-SENTEI(IDX2)   NOT =   ZERO
                   MOVE    IDX2         TO      WRK-ZAINUM-CNT
               END-IF
           END-PERFORM
           COMPUTE WRK-ZAINUM   =  99999800  +  WRK-ZAINUM-CNT
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
      *
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    NACCT-SRYKA          TO      RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI(IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           MOVE    WRK-SENTEI-ZAITEN-W  TO      RECE64-ZAITEN
           MOVE    NACCT-MEISAISU       TO      RECE64-MEISAISU
           MOVE    CNT-DAY21-SENTEI     TO      RECE64-ZAIKAISU
           MOVE    WRK-SENTEI-ZAITEN-W  TO      RECE64-SYUTEN1
           COMPUTE RECE64-SRYCDTOTAL  =  NACCT-SRYCDTOTAL
                                      -  WRK-SENTEI-SRYCD-W
                                      +  WRK-SENTEI-SRYCD2-W
           MOVE    NACCT-SURYOUTOTAL    TO      RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO      RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           MOVE    ZERO                 TO      RECE64-YKZTEN
           MOVE    ZERO                 TO      RECE64-KIZAITEN
           MOVE    NACCT-DRCD           TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-DAY21-SENTEI(IDX2)  TO
                                            RECE64-KAISU (1 IDX2)
                   IF     (WK-TAIHI-FLG           =   ZERO)   AND
                          (WRK-DAY21-SENTEI(IDX2)    NOT =   ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
           END-PERFORM
           .
       210207-RECE64-TENSOU2-SEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210208-RECE65-HENSYU2-SEN-SEC               SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
      *
               MOVE    "tbl_nyuinact"     TO   MCP-TABLE
               MOVE    "key9"             TO   MCP-PATHNAME
               PERFORM  900-NYUINACT-READ-SEC
               PERFORM  UNTIL  (FLG-NYUINACT  =    "1")
                   PERFORM   2102081-RECE65-TENSOU2-SEN-SEC
                   PERFORM   RECE65-WRITE-SEC
                   MOVE    "tbl_nyuinact"     TO   MCP-TABLE
                   MOVE    "key9"             TO   MCP-PATHNAME
                   PERFORM        900-NYUINACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210208-RECE65-HENSYU2-SEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       2102081-RECE65-TENSOU2-SEN-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
           COMPUTE WRK-ZAINUM   =  99999800  +  WRK-ZAINUM-CNT
           MOVE    WRK-ZAINUM           TO      RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    NSRY-RENNUM          TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    NSRY-SRYKA           TO      RECE65-SRYKA
           MOVE    NSRY-SRYKBN          TO      RECE65-SRYKBN
           MOVE    NSRY-SRYSYUKBN       TO      RECE65-SRYSYUKBN
           IF      NACCT-ZAISKBKBN      =       "1"
             IF  (NACCT-SRYCDTOTAL =   190799410 )
             OR  (NACCT-SRYCDTOTAL =   190799510 )
                MOVE    "90"            TO      RECE65-SRYKBN
                MOVE    "900"           TO      RECE65-SRYSYUKBN
             END-IF
           END-IF
           IF      NACCT-ZAISKBKBN      =       "6"
             EVALUATE  WRK-NYUTENTTLKBN
               WHEN      903
                MOVE    "90"            TO      RECE65-SRYKBN
                MOVE    "900"           TO      RECE65-SRYSYUKBN
               WHEN      920
                MOVE    "92"            TO      RECE65-SRYKBN
                MOVE    "920"           TO      RECE65-SRYSYUKBN
             END-EVALUATE
           END-IF
           MOVE    NSRY-JIHIMONEYTOTAL  TO      RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    OR
                                (NSRY-SRYCD(IDX2)  =   SPACE)
             IF      NSRY-SRYCD(IDX2)(1:1)    =   "0"  OR  "1" OR  
                                                  "8"
               ADD     1                   TO  IDX4    
               IF    IDX2  =  1
                 MOVE    WRK-SENTEI-SRYCD2-W
                                           TO  RECE65-SRYCD(IDX4)
               ELSE
                 MOVE    NSRY-SRYCD(IDX2)  TO  RECE65-SRYCD(IDX4)
               END-IF
               MOVE    NSRY-SRYSURYO(IDX2) TO  RECE65-SRYSURYO(IDX4)
               MOVE    NSRY-SRYKAISU(IDX2) TO  RECE65-SRYKAISU(IDX4)
               MOVE    SPACE               TO  RECE65-MEISKYFLG(IDX4)
               MOVE    NSRY-AUTOKBN(IDX2)  TO  RECE65-AUTOKBN(IDX4)
               MOVE    NSRY-INPUTNUM(IDX2) TO  RECE65-INPUTNUM(IDX4)
               IF    IDX2  =  1
                 MOVE    WRK-SENTEI-SRYCD2-W
                                           TO  WRK-SRYCD
               ELSE
                 MOVE    NSRY-SRYCD(IDX2)  TO  WRK-SRYCD
               END-IF
               MOVE    RECE65-SRYYM        TO  WK-TAIHI-SRYYM
               MOVE    WK-TAIHI-DAY        TO  WK-TAIHI-SRYD
               PERFORM    900-TENSU-TBL-SEC
               MOVE    TNS-TANICD          TO  RECE65-TANICD(IDX4)
               MOVE    TNS-TANIMOJISU      TO  RECE65-TANIMOJISU(IDX4)
               MOVE    TNS-TANINAME        TO  RECE65-TANINAME(IDX4)
               MOVE    TNS-TENSIKIBETU     TO  RECE65-TENSIKIBETU(IDX4)
               MOVE    TNS-TEN             TO  RECE65-TEN(IDX4)
               MOVE    TNS-NYUTENTTLKBN    TO  RECE65-TENTTLKBN(IDX4)
               MOVE    TNS-YUKOKETA        TO  RECE65-YUKOKETA(IDX4)
               MOVE    TNS-DATAKBN         TO  RECE65-DATAKBN (IDX4)
               MOVE    TNS-HOUKNSKBN       TO  RECE65-HOUKNSKBN(IDX4)
               MOVE    TNS-KNSJISKBN       TO  RECE65-KNSJISKBN(IDX4)
               MOVE    TNS-CDKBN-KBN       TO  RECE65-CDKBN-KBN(IDX4)
               MOVE    TNS-CDKBN-SYO       TO  RECE65-CDKBN-SYO(IDX4)
               MOVE    TNS-CDKBN-BU        TO  RECE65-CDKBN-BU(IDX4)
               MOVE    TNS-CDKBN-KBNNUM   
                                      TO RECE65-CDKBN-KBNNUM(IDX4)
               MOVE    TNS-CDKBN-KBNNUM-EDA
                                      TO RECE65-CDKBN-KBNNUM-EDA(IDX4)
               MOVE    TNS-CDKBN-KOUBAN
                                      TO RECE65-CDKBN-KOUBAN(IDX4)
               MOVE    TNS-KOUHYOJYUNNUM  
                                      TO RECE65-KOUHYOJYUNNUM(IDX4)
      *
               MOVE    TNS-SRYSYUKBN  TO RECE65-SRYSYUKBN-X(IDX4)
               MOVE    TNS-KOKUJISKBKBN1
                                      TO RECE65-KOKUJISKBKBN1(IDX4)
               MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE65-KOKUJISKBKBN2(IDX4)
               MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE65-TUSOKUGAIKBN (IDX4)
               MOVE    TNS-TIMEKSNKBN TO RECE65-TIMEKSNKBN   (IDX4)
               MOVE    TNS-KZMCOMPSIKIBETU
                                      TO RECE65-KZMCOMPSIKIBETU(IDX4)
               MOVE    TNS-CHUKSNCD   TO RECE65-CHUKSNCD(IDX4)
               MOVE    TNS-CHUKSNTUBAN
                                      TO RECE65-CHUKSNTUBAN(IDX4)
               MOVE    TNS-KENTAICOMMENT
                                      TO RECE65-KENTAICOMMENT(IDX4)
               MOVE    TNS-KNSJISGRPKBN
                                      TO RECE65-KNSJISGRPKBN(IDX4)
               MOVE    TNS-TOKUKIZAISBT1
                                      TO RECE65-TOKUKIZAISBT1(IDX4)
               MOVE    TNS-SANSOKBN   TO RECE65-SANSOKBN     (IDX4)
      *
               IF    ((NSRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                      (NSRY-SRYCD    (IDX2)(1:3)     =   "008"))
               AND   ( NSRY-INPUTNUM (IDX2)      NOT =   ZERO  )
                   MOVE    NSRY-HOSPNUM          TO  PTCOM-HOSPNUM
                   MOVE    NSRY-PTID             TO  PTCOM-PTID
                   MOVE    NSRY-ZAINUM           TO  PTCOM-ZAINUM
                   MOVE    NSRY-SRYCD (IDX2)     TO  PTCOM-SRYCD
                   MOVE    NSRY-INPUTNUM(IDX2)   TO  PTCOM-RENNUM
                   PERFORM 950-PTCOM-READ-SEC
                   MOVE    PTCOM-INPUTCOMENT     TO  RECE65-NAME(IDX4)
               ELSE
                   MOVE    TNS-NAME              TO  RECE65-NAME(IDX4)
      *
                 IF   RECE62-SRYYM  >= "200604"
                   CONTINUE
                 ELSE
                   IF   RECE64-ZAISKBKBN = "1"
                   AND  RECE64-SRYKBN    = "90"
                   AND  TNS-DATAKBN      =  1
                   AND  TNS-ROUTEKKBN    =  2
      *
                      IF   RECE65-NAME(IDX4)(7:4) = "老人"
                         CONTINUE
                      ELSE
                         MOVE  TNS-NAME(1:6)
                                         TO   RECE65-NAME(IDX4)(1:6)
                         MOVE  "老人"    TO   RECE65-NAME(IDX4)(7:4)
                         MOVE  TNS-NAME(7:)
                                         TO   RECE65-NAME(IDX4)(11:)
                         COMPUTE  RECE65-YUKOKETA(IDX4) =
                                  RECE65-YUKOKETA(IDX4) + 2
                      END-IF
      *
                   END-IF
                 END-IF
      *
               END-IF
      *
             END-IF  
           END-PERFORM
      *
           .
       2102081-RECE65-TENSOU2-SEN-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊の入院基本料編集
      **************************************************************
       210209-NYUINACCT-HEN-SEC           SECTION.
      *
           MOVE     ZERO     TO     SYUKEI-IDX3
      *
           PERFORM    VARYING  SYUKEI-IDX     FROM    1   BY  1
      ***         UNTIL  SYUKEI-IDX            > 10
                  UNTIL  SYUKEI-IDX            > 14
      *
             PERFORM  VARYING  SYUKEI-IDX2    FROM    1   BY  1
                  UNTIL  SYUKEI-IDX2           > 10
                   OR    WRK-GAI-DAY(SYUKEI-IDX SYUKEI-IDX2) = ZERO
      *
               ADD      1      TO     SYUKEI-IDX3
      *
               MOVE   WRK-GAI-DAY(SYUKEI-IDX SYUKEI-IDX2)
                                    TO   WRK-GAI2-DAY     (SYUKEI-IDX3)
               EVALUATE  SYUKEI-IDX
                  WHEN     1
                     MOVE   "190107290" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     2
                     MOVE   "190107390" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     3
                     MOVE   "190111590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     4
                     PERFORM  2102091-NYUINACCT-HEN-TAKIKAN-SEC
                  WHEN     5
                     PERFORM  2102092-NYUINACCT-HEN-TAKIKAN2-SEC
                  WHEN     6
                     MOVE   "190107490" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     7
                     MOVE   "190107590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     8
                     MOVE   "190111590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     9
                     PERFORM  2102091-NYUINACCT-HEN-TAKIKAN-SEC
                  WHEN    10
                     PERFORM  2102092-NYUINACCT-HEN-TAKIKAN2-SEC
                  WHEN    11
                     PERFORM  2102091-NYUINACCT-HEN-TAKIKAN-SEC
                  WHEN    12
                     PERFORM  2102092-NYUINACCT-HEN-TAKIKAN2-SEC
                  WHEN    13
                     PERFORM  2102091-NYUINACCT-HEN-TAKIKAN-SEC
                  WHEN    14
                     PERFORM  2102092-NYUINACCT-HEN-TAKIKAN2-SEC
               END-EVALUATE
               MOVE   WRK-GAI-ZAITEN(SYUKEI-IDX SYUKEI-IDX2)
                                    TO   WRK-GAI2-ZAITEN  (SYUKEI-IDX3)
               MOVE   WRK-GAI-ZAIKAISU(SYUKEI-IDX SYUKEI-IDX2)
                                    TO   WRK-GAI2-ZAIKAISU(SYUKEI-IDX3)
               EVALUATE  SYUKEI-IDX
                  WHEN     1
                  WHEN     2
                  WHEN     3
                  WHEN     4
                  WHEN     5
                  WHEN    11
                  WHEN    12
                     MOVE    1      TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)  TO   SYUKEI-IDX4
                     IF WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)      NOT = ZERO
                        MOVE    3   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
                     IF WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)  NOT = ZERO
                        MOVE    3   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
                  WHEN     6
                  WHEN     7
                  WHEN     8
                  WHEN     9
                  WHEN    10
                  WHEN    13
                  WHEN    14
                     MOVE    2      TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)  TO   SYUKEI-IDX4
                     IF WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)      NOT = ZERO
                        MOVE    4   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
                     IF WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)  NOT = ZERO
                        MOVE    4   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
               END-EVALUATE
               MOVE  WRK-GAI-KAISU-T(SYUKEI-IDX SYUKEI-IDX2)            
                                    TO   WRK-GAI2-KAISU-T(SYUKEI-IDX3)  
      *
             END-PERFORM
      *
           END-PERFORM  
      *
      *    日付順に並び替え
      *
           PERFORM    VARYING   SYUKEI-IDX     FROM    1   BY  1
                  UNTIL  ( SYUKEI-IDX                   >   20  )
                    OR   ( WRK-GAI2-DAY(SYUKEI-IDX)     =  ZERO )
      *
             COMPUTE    SYUKEI-IDX2  =  SYUKEI-IDX  +  1
      *
             PERFORM  VARYING  SYUKEI-IDX3  FROM  SYUKEI-IDX2  BY  1
                        UNTIL  ( SYUKEI-IDX3                >   20  )
                          OR   ( WRK-GAI2-DAY(SYUKEI-IDX3)  =  ZERO )
      *
                IF       WRK-GAI2-DAY(SYUKEI-IDX)  >
                                           WRK-GAI2-DAY(SYUKEI-IDX3)
                   MOVE  WRK-GAI-T2(SYUKEI-IDX)  
                                           TO  WRK-GAI-DATA
                   MOVE  WRK-GAI-T2(SYUKEI-IDX3)  
                                           TO  WRK-GAI-T2(SYUKEI-IDX)
                   MOVE  WRK-GAI-DATA      TO  WRK-GAI-T2(SYUKEI-IDX3)
                END-IF
      *
             END-PERFORM
      *
           END-PERFORM
      *
           .
      *
       210209-NYUINACCT-HEN-EXT.
           EXIT.
      *
      **************************************************************
      *    他医療機関受診時の診療行為コード取得
      **************************************************************
       2102091-NYUINACCT-HEN-TAKIKAN-SEC           SECTION.
      *
           MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)   TO   SYUKEI-IDX4
      *
           EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
               WHEN   099  THRU  100
                 IF   RECE62-SRYYM   >=  "201004"
                   EVALUATE   SYUKEI-IDX
                    WHEN     4
                    WHEN     9
                     MOVE "190108890" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    11
                    WHEN    13
                     MOVE "190142190" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 END-IF
               WHEN   201  THRU  219
               WHEN   221  THRU  222
               WHEN   224
               WHEN   227  THRU  229
               WHEN   230  THRU  239
               WHEN   241  THRU  249
                 EVALUATE   SYUKEI-IDX
                   WHEN     4
                   WHEN     9
                     MOVE "190108790" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    11
                   WHEN    13
                     MOVE "190142090" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   013  THRU  021
               WHEN   101  THRU  109
               WHEN   147  THRU  152
               WHEN   173  THRU  190
                 EVALUATE   SYUKEI-IDX
                   WHEN     4
                   WHEN     9
                     MOVE "190108890" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    11
                   WHEN    13
                     MOVE "190142190" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   075  THRU  080
                 EVALUATE   SYUKEI-IDX
                   WHEN     4
                   WHEN     9
                     MOVE "190108990" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   085  THRU  086
               WHEN   132  THRU  133
               WHEN   153  THRU  158
                 EVALUATE   SYUKEI-IDX
                   WHEN     4
                   WHEN     9
                     MOVE "190109090" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    11
                   WHEN    13
                     MOVE "190142290" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   226
               WHEN   240
                 CONTINUE
               WHEN   OTHER
                 EVALUATE   SYUKEI-IDX
                   WHEN    11
                   WHEN    13
                     MOVE "190141590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
           END-EVALUATE
           .
      *
       2102091-NYUINACCT-HEN-TAKIKAN-EXT.
           EXIT.
      *
      **************************************************************
      *    他医療機関受診時の診療行為コード取得（選定療養）
      **************************************************************
       2102092-NYUINACCT-HEN-TAKIKAN2-SEC           SECTION.
      *
           MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)   TO   SYUKEI-IDX4
      *
           EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
               WHEN   099  THRU  100
                 IF   RECE62-SRYYM   >=  "201004"
                   EVALUATE   SYUKEI-IDX
                    WHEN     5
                    WHEN    10
      ***            MOVE "190116690" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
      **>            MOVE "999999983" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     MOVE "190108890" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    12
                    WHEN    14
      **>            MOVE "999999993" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     MOVE "190142190" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 END-IF
               WHEN   201  THRU  219
               WHEN   221  THRU  222
               WHEN   224
               WHEN   227  THRU  229
               WHEN   230  THRU  239
               WHEN   241  THRU  249
                 EVALUATE   SYUKEI-IDX
                   WHEN     5
                   WHEN    10
      ***            MOVE "190116590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     MOVE "999999982" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    12
                   WHEN    14
                     MOVE "999999992" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   013  THRU  021
               WHEN   101  THRU  109
               WHEN   147  THRU  152
               WHEN   173  THRU  190
                 EVALUATE   SYUKEI-IDX
                   WHEN     5
                   WHEN    10
      ***            MOVE "190116690" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     MOVE "999999983" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    12
                   WHEN    14
                     MOVE "999999993" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   075  THRU  080
                 EVALUATE   SYUKEI-IDX
                   WHEN     5
                   WHEN    10
                     MOVE "190116890" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   085  THRU  086
               WHEN   132  THRU  133
               WHEN   153  THRU  158
                 EVALUATE   SYUKEI-IDX
                   WHEN     5
                   WHEN    10
      ***            MOVE "190116790" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     MOVE "999999984" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    12
                   WHEN    14
                     MOVE "999999994" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   226
               WHEN   240
                 CONTINUE
               WHEN   OTHER
                 EVALUATE   SYUKEI-IDX
                   WHEN    12
                   WHEN    14
                     MOVE "190141590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
           END-EVALUATE
           .
      *
       2102092-NYUINACCT-HEN-TAKIKAN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210210-RECE64-TENSOU2-GAI-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           IF      WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =   1 OR 3
              MOVE    "90"              TO      RECE64-SRYKBN
           ELSE
              MOVE    "92"              TO      RECE64-SRYKBN
           END-IF 
           MOVE    NACCT-ZAISKBKBN      TO      RECE64-ZAISKBKBN
           COMPUTE WRK-ZAINUM    =  99999900  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    NACCT-SRYKA          TO      RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI(IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           MOVE    WRK-GAI2-ZAITEN(SYUKEI-IDX3) 
                                        TO      RECE64-ZAITEN
           IF      WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =   1 OR 2
              MOVE    1                 TO      RECE64-MEISAISU
              MOVE    WRK-GAI2-SRYCD-9 (SYUKEI-IDX3)
                                        TO      RECE64-SRYCDTOTAL
              MOVE    1                 TO      RECE64-SURYOUTOTAL
           ELSE
              MOVE    1                 TO      RECE64-MEISAISU
              MOVE    WRK-GAI2-SRYCD-9 (SYUKEI-IDX3)
                                        TO      RECE64-SRYCDTOTAL
              MOVE    1                 TO      RECE64-SURYOUTOTAL
              MOVE    WRK-GAI2-DAY(SYUKEI-IDX3)  TO   SYUKEI-IDX4
              IF WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)      NOT = ZERO
                ADD   1   TO   RECE64-MEISAISU
                ADD   WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)
                          TO   RECE64-SRYCDTOTAL
                ADD   1   TO   RECE64-SURYOUTOTAL
              END-IF
              IF WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)  NOT = ZERO
                ADD   1   TO   RECE64-MEISAISU
                ADD   WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)
                          TO   RECE64-SRYCDTOTAL
                ADD   1   TO   RECE64-SURYOUTOTAL
              END-IF
           END-IF
           MOVE    ZERO                 TO      RECE64-RUIKEITOTAL
           MOVE    WRK-GAI2-ZAIKAISU(SYUKEI-IDX3)
                                        TO      RECE64-ZAIKAISU
           MOVE    WRK-GAI2-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           MOVE    ZERO                 TO      RECE64-YKZTEN
           MOVE    ZERO                 TO      RECE64-KIZAITEN
           MOVE    NACCT-DRCD           TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-GAI2-KAISU(SYUKEI-IDX3 IDX2)             
                                        TO    RECE64-KAISU (1 IDX2)
                   IF     (WK-TAIHI-FLG           =   ZERO)  
                   AND    (WRK-GAI2-KAISU(SYUKEI-IDX3 IDX2)             
                                                      NOT =   ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
           END-PERFORM
           .
       210210-RECE64-TENSOU2-GAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210211-RECE65-HENSYU2-GAI-SEC               SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_nyuinact"     TO   MCP-TABLE
               MOVE    "key9"             TO   MCP-PATHNAME
               PERFORM  900-NYUINACT-READ-SEC
           ELSE
               MOVE     1               TO      FLG-NYUINACT
           END-IF
           IF  FLG-NYUINACT   =   ZERO
               PERFORM   2102111-RECE65-TENSOU2-GAI-SEC
               PERFORM   RECE65-WRITE-SEC
           END-IF
      *
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210211-RECE65-HENSYU2-GAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       2102111-RECE65-TENSOU2-GAI-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
           COMPUTE WRK-ZAINUM    =  99999900  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO      RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    NSRY-RENNUM          TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    NSRY-SRYKA           TO      RECE65-SRYKA
           IF      WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =   1 OR 3
              MOVE    "90"              TO      RECE65-SRYKBN
           ELSE
              MOVE    "92"              TO      RECE65-SRYKBN
           END-IF 
           IF      WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =   1 OR 3
              MOVE    "900"             TO      RECE65-SRYSYUKBN
           ELSE
              MOVE    "920"             TO      RECE65-SRYSYUKBN
           END-IF 
           MOVE    NSRY-JIHIMONEYTOTAL  TO      RECE65-JIHIMONEY
      *
           MOVE    WRK-GAI2-SRYCD(SYUKEI-IDX3)
                                        TO  RECE65-SRYCD(1)
           MOVE    1                    TO  RECE65-SRYSURYO(1)
           MOVE    ZERO                 TO  RECE65-SRYKAISU(1)
           MOVE    SPACE                TO  RECE65-MEISKYFLG(1)
           MOVE    SPACE                TO  RECE65-AUTOKBN(1)
           MOVE    ZERO                 TO  RECE65-INPUTNUM(1)
           MOVE    WRK-GAI2-SRYCD(SYUKEI-IDX3)
                                        TO  WRK-SRYCD
           MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
           PERFORM    900-TENSU-TBL-SEC
           MOVE    TNS-TANICD          TO  RECE65-TANICD(1)
           MOVE    TNS-TANIMOJISU      TO  RECE65-TANIMOJISU(1)
           MOVE    TNS-TANINAME        TO  RECE65-TANINAME(1)
           MOVE    TNS-TENSIKIBETU     TO  RECE65-TENSIKIBETU(1)
           MOVE    TNS-TEN             TO  RECE65-TEN(1)
           MOVE    TNS-NYUTENTTLKBN    TO  RECE65-TENTTLKBN(1)
           MOVE    TNS-YUKOKETA        TO  RECE65-YUKOKETA(1)
           MOVE    TNS-DATAKBN         TO  RECE65-DATAKBN (1)
           MOVE    TNS-HOUKNSKBN       TO  RECE65-HOUKNSKBN(1)
           MOVE    TNS-KNSJISKBN       TO  RECE65-KNSJISKBN(1)
           MOVE    TNS-CDKBN-KBN       TO  RECE65-CDKBN-KBN(1)
           MOVE    TNS-CDKBN-SYO       TO  RECE65-CDKBN-SYO(1)
           MOVE    TNS-CDKBN-BU        TO  RECE65-CDKBN-BU(1)
           MOVE    TNS-CDKBN-KBNNUM   
                                  TO RECE65-CDKBN-KBNNUM(1)
           MOVE    TNS-CDKBN-KBNNUM-EDA
                                  TO RECE65-CDKBN-KBNNUM-EDA(1)
           MOVE    TNS-CDKBN-KOUBAN
                                  TO RECE65-CDKBN-KOUBAN(1)
           MOVE    TNS-KOUHYOJYUNNUM  
                                  TO RECE65-KOUHYOJYUNNUM(1)
      *
           MOVE    TNS-SRYSYUKBN  TO RECE65-SRYSYUKBN-X(1)
           MOVE    TNS-KOKUJISKBKBN1
                                  TO RECE65-KOKUJISKBKBN1(1)
           MOVE    TNS-KOKUJISKBKBN2  
                                  TO RECE65-KOKUJISKBKBN2(1)
           MOVE    TNS-TUSOKUGAIKBN
                                  TO RECE65-TUSOKUGAIKBN (1)
           MOVE    TNS-TIMEKSNKBN TO RECE65-TIMEKSNKBN   (1)
           MOVE    TNS-KZMCOMPSIKIBETU
                                  TO RECE65-KZMCOMPSIKIBETU(1)
           MOVE    TNS-CHUKSNCD   TO RECE65-CHUKSNCD(1)
           MOVE    TNS-CHUKSNTUBAN
                                  TO RECE65-CHUKSNTUBAN(1)
           MOVE    TNS-KENTAICOMMENT
                                  TO RECE65-KENTAICOMMENT(1)
           MOVE    TNS-KNSJISGRPKBN
                                  TO RECE65-KNSJISGRPKBN(1)
           MOVE    TNS-TOKUKIZAISBT1
                                  TO RECE65-TOKUKIZAISBT1(1)
           MOVE    TNS-SANSOKBN   TO RECE65-SANSOKBN(1)
      *
           MOVE    TNS-NAME       TO RECE65-NAME(1)
      *
           IF      WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =   3 OR 4
      *
            MOVE    1     TO     SYUKEI-IDX5
            MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)  TO  SYUKEI-IDX4
            IF WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)      NOT = ZERO
              ADD   1     TO     SYUKEI-IDX5
              MOVE  WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)
                                     TO  RECE65-SRYCD(SYUKEI-IDX5)
              MOVE  1                TO  RECE65-SRYSURYO(SYUKEI-IDX5)
              MOVE  ZERO             TO  RECE65-SRYKAISU(SYUKEI-IDX5)
              MOVE  SPACE            TO  RECE65-MEISKYFLG(SYUKEI-IDX5)
              MOVE  SPACE            TO  RECE65-AUTOKBN(SYUKEI-IDX5)
              MOVE  ZERO             TO  RECE65-INPUTNUM(SYUKEI-IDX5)
              MOVE  WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)
                                     TO  WRK-SRYCD
              MOVE  RECE65-SRYYM     TO  WK-TAIHI-SRYYM
              MOVE  WK-TAIHI-DAY     TO  WK-TAIHI-SRYD
              PERFORM    900-TENSU-TBL-SEC
              MOVE  TNS-TANICD       TO  RECE65-TANICD(SYUKEI-IDX5)
              MOVE  TNS-TANIMOJISU   TO  RECE65-TANIMOJISU(SYUKEI-IDX5)
              MOVE  TNS-TANINAME     TO  RECE65-TANINAME(SYUKEI-IDX5)
              MOVE  TNS-TENSIKIBETU  TO  RECE65-TENSIKIBETU(SYUKEI-IDX5)
              MOVE  TNS-TEN          TO  RECE65-TEN(SYUKEI-IDX5)
              MOVE  TNS-NYUTENTTLKBN TO  RECE65-TENTTLKBN(SYUKEI-IDX5)
              MOVE  TNS-YUKOKETA     TO  RECE65-YUKOKETA(SYUKEI-IDX5)
              MOVE  TNS-DATAKBN      TO  RECE65-DATAKBN (SYUKEI-IDX5)
              MOVE  TNS-HOUKNSKBN    TO  RECE65-HOUKNSKBN(SYUKEI-IDX5)
              MOVE  TNS-KNSJISKBN    TO  RECE65-KNSJISKBN(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-KBN    TO  RECE65-CDKBN-KBN(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-SYO    TO  RECE65-CDKBN-SYO(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-BU     TO  RECE65-CDKBN-BU(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-KBNNUM
                                TO RECE65-CDKBN-KBNNUM(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-KBNNUM-EDA
                                TO RECE65-CDKBN-KBNNUM-EDA(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-KOUBAN
                                TO RECE65-CDKBN-KOUBAN(SYUKEI-IDX5)
              MOVE  TNS-KOUHYOJYUNNUM
                                TO RECE65-KOUHYOJYUNNUM(SYUKEI-IDX5)
      *
              MOVE  TNS-SRYSYUKBN
                                TO RECE65-SRYSYUKBN-X(SYUKEI-IDX5)
              MOVE  TNS-KOKUJISKBKBN1
                                TO RECE65-KOKUJISKBKBN1(SYUKEI-IDX5)
              MOVE  TNS-KOKUJISKBKBN2
                                TO RECE65-KOKUJISKBKBN2(SYUKEI-IDX5)
              MOVE  TNS-TUSOKUGAIKBN
                                TO RECE65-TUSOKUGAIKBN (SYUKEI-IDX5)
              MOVE  TNS-TIMEKSNKBN
                                TO RECE65-TIMEKSNKBN   (SYUKEI-IDX5)
              MOVE  TNS-KZMCOMPSIKIBETU
                                TO RECE65-KZMCOMPSIKIBETU(SYUKEI-IDX5)
              MOVE  TNS-CHUKSNCD
                                TO RECE65-CHUKSNCD(SYUKEI-IDX5)
              MOVE  TNS-CHUKSNTUBAN
                                TO RECE65-CHUKSNTUBAN(SYUKEI-IDX5)
              MOVE  TNS-KENTAICOMMENT
                                TO RECE65-KENTAICOMMENT(SYUKEI-IDX5)
              MOVE  TNS-KNSJISGRPKBN
                                TO RECE65-KNSJISGRPKBN(SYUKEI-IDX5)
              MOVE  TNS-TOKUKIZAISBT1
                                TO RECE65-TOKUKIZAISBT1(SYUKEI-IDX5)
              MOVE  TNS-SANSOKBN
                                TO RECE65-SANSOKBN(SYUKEI-IDX5)
      *
              MOVE  TNS-NAME    TO RECE65-NAME(SYUKEI-IDX5)
            END-IF
      *
            IF WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)  NOT = ZERO
              ADD   1     TO     SYUKEI-IDX5
              MOVE  WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)
                                     TO  RECE65-SRYCD(SYUKEI-IDX5)
              MOVE  1                TO  RECE65-SRYSURYO(SYUKEI-IDX5)
              MOVE  ZERO             TO  RECE65-SRYKAISU(SYUKEI-IDX5)
              MOVE  SPACE            TO  RECE65-MEISKYFLG(SYUKEI-IDX5)
              MOVE  SPACE            TO  RECE65-AUTOKBN(SYUKEI-IDX5)
              MOVE  ZERO             TO  RECE65-INPUTNUM(SYUKEI-IDX5)
              MOVE  WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)
                                     TO  WRK-SRYCD
              MOVE  RECE65-SRYYM     TO  WK-TAIHI-SRYYM
              MOVE  WK-TAIHI-DAY     TO  WK-TAIHI-SRYD
              PERFORM    900-TENSU-TBL-SEC
              MOVE  TNS-TANICD       TO  RECE65-TANICD(SYUKEI-IDX5)
              MOVE  TNS-TANIMOJISU   TO  RECE65-TANIMOJISU(SYUKEI-IDX5)
              MOVE  TNS-TANINAME     TO  RECE65-TANINAME(SYUKEI-IDX5)
              MOVE  TNS-TENSIKIBETU  TO  RECE65-TENSIKIBETU(SYUKEI-IDX5)
              MOVE  TNS-TEN          TO  RECE65-TEN(SYUKEI-IDX5)
              MOVE  TNS-NYUTENTTLKBN TO  RECE65-TENTTLKBN(SYUKEI-IDX5)
              MOVE  TNS-YUKOKETA     TO  RECE65-YUKOKETA(SYUKEI-IDX5)
              MOVE  TNS-DATAKBN      TO  RECE65-DATAKBN (SYUKEI-IDX5)
              MOVE  TNS-HOUKNSKBN    TO  RECE65-HOUKNSKBN(SYUKEI-IDX5)
              MOVE  TNS-KNSJISKBN    TO  RECE65-KNSJISKBN(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-KBN    TO  RECE65-CDKBN-KBN(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-SYO    TO  RECE65-CDKBN-SYO(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-BU     TO  RECE65-CDKBN-BU(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-KBNNUM
                                TO RECE65-CDKBN-KBNNUM(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-KBNNUM-EDA
                                TO RECE65-CDKBN-KBNNUM-EDA(SYUKEI-IDX5)
              MOVE  TNS-CDKBN-KOUBAN
                                TO RECE65-CDKBN-KOUBAN(SYUKEI-IDX5)
              MOVE  TNS-KOUHYOJYUNNUM
                                TO RECE65-KOUHYOJYUNNUM(SYUKEI-IDX5)
      *
              MOVE  TNS-SRYSYUKBN
                                TO RECE65-SRYSYUKBN-X(SYUKEI-IDX5)
              MOVE  TNS-KOKUJISKBKBN1
                                TO RECE65-KOKUJISKBKBN1(SYUKEI-IDX5)
              MOVE  TNS-KOKUJISKBKBN2
                                TO RECE65-KOKUJISKBKBN2(SYUKEI-IDX5)
              MOVE  TNS-TUSOKUGAIKBN
                                TO RECE65-TUSOKUGAIKBN (SYUKEI-IDX5)
              MOVE  TNS-TIMEKSNKBN
                                TO RECE65-TIMEKSNKBN   (SYUKEI-IDX5)
              MOVE  TNS-KZMCOMPSIKIBETU
                                TO RECE65-KZMCOMPSIKIBETU(SYUKEI-IDX5)
              MOVE  TNS-CHUKSNCD
                                TO RECE65-CHUKSNCD(SYUKEI-IDX5)
              MOVE  TNS-CHUKSNTUBAN
                                TO RECE65-CHUKSNTUBAN(SYUKEI-IDX5)
              MOVE  TNS-KENTAICOMMENT
                                TO RECE65-KENTAICOMMENT(SYUKEI-IDX5)
              MOVE  TNS-KNSJISGRPKBN
                                TO RECE65-KNSJISGRPKBN(SYUKEI-IDX5)
              MOVE  TNS-TOKUKIZAISBT1
                                TO RECE65-TOKUKIZAISBT1(SYUKEI-IDX5)
              MOVE  TNS-SANSOKBN
                                TO RECE65-SANSOKBN(SYUKEI-IDX5)
      *
              MOVE  TNS-NAME    TO RECE65-NAME(SYUKEI-IDX5)
            END-IF
      *
           END-IF
      *
           .
       2102111-RECE65-TENSOU2-GAI-EXT.
           EXIT.
      *
      **************************************************************
      *    食事療養費の編集
      **************************************************************
       210212-NYUINACCT-HEN2-SEC           SECTION.
      *
           PERFORM    VARYING  SYUKEI-IDX     FROM    1   BY  1
                  UNTIL  SYUKEI-IDX            >  31
      *
             IF    WRK-SKJ-ZAITEN(SYUKEI-IDX)  NOT =  ZERO
      *
               MOVE     ZERO     TO    FLG-ARI
               PERFORM  VARYING  SYUKEI-IDX2    FROM    1   BY  1
                      UNTIL  SYUKEI-IDX2           > 31
                       OR    WRK-SKJ2-ZAITEN(SYUKEI-IDX2) = ZERO
                       OR    FLG-ARI               = 1
                  IF  ( WRK-SKJ2-ZAITEN   (SYUKEI-IDX2)
                                     =  WRK-SKJ-ZAITEN   (SYUKEI-IDX) )
                  AND ( WRK-SKJ2-SRYCD-T  (SYUKEI-IDX2)
                                     =  WRK-SKJ-SRYCD-T  (SYUKEI-IDX) )
                     ADD   WRK-SKJ-ZAIKAISU(SYUKEI-IDX)  TO  
                                       WRK-SKJ2-ZAIKAISU (SYUKEI-IDX2)
                     MOVE  1  TO  WRK-SKJ2-KAISU(SYUKEI-IDX2 SYUKEI-IDX)
                     MOVE  1  TO   FLG-ARI
                  END-IF
               END-PERFORM  
               IF  FLG-ARI  =  ZERO  
                     MOVE  WRK-SKJ-ZAITEN   (SYUKEI-IDX)  TO  
                                       WRK-SKJ2-ZAITEN   (SYUKEI-IDX2)
                     ADD   WRK-SKJ-ZAIKAISU (SYUKEI-IDX)  TO  
                                       WRK-SKJ2-ZAIKAISU (SYUKEI-IDX2)
                     MOVE  WRK-SKJ-SRYCD-T  (SYUKEI-IDX)  TO  
                                       WRK-SKJ2-SRYCD-T  (SYUKEI-IDX2)
                     PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                            UNTIL  SYUKEI-IDX3     >   5
                        IF  WRK-SKJ-SRYCD(SYUKEI-IDX SYUKEI-IDX3) 
                                             NOT =   ZERO
                           ADD   1  TO  WRK-SKJ2-MEISAISU(SYUKEI-IDX2)
                           ADD   WRK-SKJ-SRYCD(SYUKEI-IDX SYUKEI-IDX3)
                                    TO  WRK-SKJ2-SRYCDTOTAL(SYUKEI-IDX2)
                        END-IF
                     END-PERFORM
                     MOVE  1  TO  WRK-SKJ2-KAISU(SYUKEI-IDX2 SYUKEI-IDX)
               END-IF
      *
             END-IF
      *
           END-PERFORM
      *
           .
      *
       210212-NYUINACCT-HEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210213-RECE64-TENSOU2-SKJ-SEC               SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    NACCT-SRYKBN         TO      RECE64-SRYKBN
           MOVE    NACCT-ZAISKBKBN      TO      RECE64-ZAISKBKBN
           COMPUTE WRK-ZAINUM    =  99999920  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    NACCT-SRYKA          TO      RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI(IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           MOVE    WRK-SKJ2-ZAITEN(SYUKEI-IDX3) 
                                        TO      RECE64-ZAITEN
           MOVE    WRK-SKJ2-MEISAISU(SYUKEI-IDX3)
                                        TO      RECE64-MEISAISU
           MOVE    WRK-SKJ2-ZAIKAISU(SYUKEI-IDX3)
                                        TO      RECE64-ZAIKAISU
           MOVE    WRK-SKJ2-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
           MOVE    WRK-SKJ2-SRYCDTOTAL(SYUKEI-IDX3)
                                        TO      RECE64-SRYCDTOTAL
           MOVE    WRK-SKJ2-MEISAISU(SYUKEI-IDX3)
                                        TO      RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO      RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           MOVE    ZERO                 TO      RECE64-YKZTEN
           MOVE    ZERO                 TO      RECE64-KIZAITEN
           MOVE    NACCT-DRCD           TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-SKJ2-KAISU(SYUKEI-IDX3 IDX2)             
                                        TO   RECE64-KAISU (1 IDX2)
                   IF     (WK-TAIHI-FLG           =   ZERO)
                   AND    (WRK-SKJ2-KAISU(SYUKEI-IDX3 IDX2)             
                                                     NOT =   ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
           END-PERFORM
           .
       210213-RECE64-TENSOU2-SKJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210213-RECE64-TENSOU2-SKJ200604-SEC               SECTION.
      *
           ADD      1   TO   WRK-SKJ200604-MEISAISU(IDX1 SYUKEI-IDX3)
           IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 2)  NOT =  ZERO
              ADD   1   TO   WRK-SKJ200604-MEISAISU(IDX1 SYUKEI-IDX3)
           END-IF
           IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 3)  NOT =  ZERO
              ADD   1   TO   WRK-SKJ200604-MEISAISU(IDX1 SYUKEI-IDX3)
           END-IF
      *
           ADD  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 1)
                     TO   WRK-SKJ200604-SURYOUTOTAL(IDX1 SYUKEI-IDX3)
                          WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3)
           ADD  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 2)
                     TO   WRK-SKJ200604-SURYOUTOTAL(IDX1 SYUKEI-IDX3)
           ADD  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 3)
                     TO   WRK-SKJ200604-SURYOUTOTAL(IDX1 SYUKEI-IDX3)
      *
           IF   WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
             EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
              WHEN      1
                ADD     197001310
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 2)  NOT =  ZERO
                  ADD   197001570
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 3)  NOT =  ZERO
                  ADD   197001670
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
              WHEN      2
                ADD     197001710
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
             END-EVALUATE
           ELSE
             EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
              WHEN      1
                ADD     197000110
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 2)  NOT =  ZERO
                  ADD   197000470
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 3)  NOT =  ZERO
                  ADD   197000570
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
              WHEN      2
                ADD     197000710
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
             END-EVALUATE
           END-IF
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO  RECE64-KOHBUNRI
           MOVE    "97"                 TO  RECE64-SRYKBN
           MOVE    "4"                  TO  RECE64-ZAISKBKBN
           IF   WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
                COMPUTE WRK-ZAINUM  =  99996100  +  SYUKEI-IDX3
                MOVE    WRK-ZAINUM      TO  RECE64-ZAINUM
           ELSE
                COMPUTE WRK-ZAINUM  =  99996000  +  SYUKEI-IDX3
                MOVE    WRK-ZAINUM      TO  RECE64-ZAINUM
           END-IF
      ***  COMPUTE WRK-ZAINUM    =  99999920  +  SYUKEI-IDX3
      ***  MOVE    WRK-ZAINUM           TO  RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO  RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO  RECE64-PTNUM
      *
           MOVE    SPACE                TO  RECE64-SRYKA
           MOVE    WRK-SKJ200604-HKNCOMBI   (IDX1)
                                        TO  RECE64-HKNCOMBI
           MOVE    SPACE                TO  RECE64-JIHOKBN
      *
           MOVE    WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                                        TO  RECE64-SRYCDTOTAL
           MOVE    WRK-SKJ200604-MEISAISU   (IDX1 SYUKEI-IDX3)
                                        TO  RECE64-MEISAISU
           MOVE    1                    TO  RECE64-ZAIKAISU
           MOVE    WRK-SKJ200604-SURYOUTOTAL(IDX1 SYUKEI-IDX3)
                                        TO  RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO  RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO  RECE64-SYUTEN2
           MOVE    ZERO                 TO  RECE64-YKZTEN
           MOVE    ZERO                 TO  RECE64-KIZAITEN
           MOVE    SPACE                TO  RECE64-DRCD
           MOVE    SPACE                TO  RECE64-ZAIREQFLG
           MOVE    ZERO                 TO  RECE64-TEIGENRATE
           MOVE    1                    TO  RECE64-KAISU(1 SYUKEI-IDX3)
           MOVE    SYUKEI-IDX3          TO  WK-TAIHI-DAY
           .
       210213-RECE64-TENSOU2-SKJ200604-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（環境）（Ｆ００４）
      *****************************************************************
       210219-RECE64-TENSOU2-SKJ200610-KAN-SEC               SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO  RECE64-KOHBUNRI
           MOVE    "97"                 TO  RECE64-SRYKBN
           MOVE    "4"                  TO  RECE64-ZAISKBKBN
           COMPUTE WRK-ZAINUM  =  99996300  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO  RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO  RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO  RECE64-PTNUM
      *
           MOVE    SPACE                TO  RECE64-SRYKA
           MOVE    WRK-SKJ200604-HKNCOMBI   (IDX1)
                                        TO  RECE64-HKNCOMBI
           MOVE    SPACE                TO  RECE64-JIHOKBN
      *
           EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
             WHEN      1
                MOVE    197001410       TO  RECE64-SRYCDTOTAL
             WHEN      2
                MOVE    197001810       TO  RECE64-SRYCDTOTAL
           END-EVALUATE
           MOVE    1                    TO  RECE64-MEISAISU
           MOVE    1                    TO  RECE64-ZAIKAISU
           MOVE    1                    TO  RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO  RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO  RECE64-SYUTEN2
           MOVE    ZERO                 TO  RECE64-YKZTEN
           MOVE    ZERO                 TO  RECE64-KIZAITEN
           MOVE    SPACE                TO  RECE64-DRCD
           MOVE    SPACE                TO  RECE64-ZAIREQFLG
           MOVE    ZERO                 TO  RECE64-TEIGENRATE
           MOVE    1                    TO  RECE64-KAISU(1 SYUKEI-IDX3)
           MOVE    SYUKEI-IDX3          TO  WK-TAIHI-DAY
           .
       210219-RECE64-TENSOU2-SKJ200610-KAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（食事負担）（Ｆ００４）
      *****************************************************************
       210221-RECE64-TENSOU2-SKJ200610FTN-SEC               SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO  RECE64-KOHBUNRI
           MOVE    "97"                 TO  RECE64-SRYKBN
           MOVE    "4"                  TO  RECE64-ZAISKBKBN
           EVALUATE  FLG-SKJ200610FTN
             WHEN        1
               COMPUTE WRK-ZAINUM  =  99996200  +  SYUKEI-IDX3
               MOVE    WRK-ZAINUM       TO  RECE64-ZAINUM
             WHEN        2
               COMPUTE WRK-ZAINUM  =  99996400  +  SYUKEI-IDX3
               MOVE    WRK-ZAINUM       TO  RECE64-ZAINUM
           END-EVALUATE
           MOVE    CNT-ZAIREN           TO  RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO  RECE64-PTNUM
      *
           MOVE    SPACE                TO  RECE64-SRYKA
           MOVE    WRK-SKJ200604-HKNCOMBI   (IDX1)
                                        TO  RECE64-HKNCOMBI
           MOVE    SPACE                TO  RECE64-JIHOKBN
      *
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
                MOVE    WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                                        TO  WRK-SRYCD-X
                MOVE    WRK-SRYCD       TO  RECE64-SRYCDTOTAL
             WHEN         2
                MOVE    WRK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                                        TO  WRK-SRYCD-X
                MOVE    WRK-SRYCD       TO  RECE64-SRYCDTOTAL
           END-EVALUATE
           MOVE    1                    TO  RECE64-MEISAISU
           MOVE    1                    TO  RECE64-ZAIKAISU
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
                MOVE    WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3)
                                        TO  RECE64-SURYOUTOTAL
             WHEN         2
                MOVE    1               TO  RECE64-SURYOUTOTAL
           END-EVALUATE
           MOVE    ZERO                 TO  RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO  RECE64-SYUTEN2
           MOVE    ZERO                 TO  RECE64-YKZTEN
           MOVE    ZERO                 TO  RECE64-KIZAITEN
           MOVE    SPACE                TO  RECE64-DRCD
           MOVE    SPACE                TO  RECE64-ZAIREQFLG
           MOVE    ZERO                 TO  RECE64-TEIGENRATE
           MOVE    1                    TO  RECE64-KAISU(1 SYUKEI-IDX3)
           MOVE    SYUKEI-IDX3          TO  WK-TAIHI-DAY
           .
       210221-RECE64-TENSOU2-SKJ200610FTN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210214-RECE65-HENSYU2-SKJ-SEC               SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_nyuinact"     TO   MCP-TABLE
               MOVE    "key9"             TO   MCP-PATHNAME
               PERFORM  900-NYUINACT-READ-SEC
           ELSE
               MOVE     1               TO      FLG-NYUINACT
           END-IF
           IF  FLG-NYUINACT   =   ZERO
               PERFORM   2102141-RECE65-TENSOU2-SKJ-SEC
               PERFORM   RECE65-WRITE-SEC
           END-IF
      *
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210214-RECE65-HENSYU2-SKJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       2102141-RECE65-TENSOU2-SKJ-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
           COMPUTE WRK-ZAINUM    =  99999920  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO      RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    NSRY-RENNUM          TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    NSRY-SRYKA           TO      RECE65-SRYKA
           MOVE    NSRY-SRYKBN          TO      RECE65-SRYKBN
           MOVE    NSRY-SRYSYUKBN       TO      RECE65-SRYSYUKBN
           MOVE    NSRY-JIHIMONEYTOTAL  TO      RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    
      *
              IF   WRK-SKJ2-SRYCD(SYUKEI-IDX3 IDX2)  NOT =   ZERO
      *
                ADD     1                    TO    IDX4  
                MOVE    WRK-SKJ2-SRYCD(SYUKEI-IDX3 IDX2)
                                             TO  RECE65-SRYCD(IDX4)
                MOVE    1                    TO  RECE65-SRYSURYO(IDX4)
                MOVE    ZERO                 TO  RECE65-SRYKAISU(IDX4)
                MOVE    SPACE                TO  RECE65-MEISKYFLG(IDX4)
                MOVE    SPACE                TO  RECE65-AUTOKBN(IDX4)
                MOVE    ZERO                 TO  RECE65-INPUTNUM(IDX4)
                MOVE    WRK-SKJ2-SRYCD(SYUKEI-IDX3 IDX2)
                                             TO  WRK-SRYCD
                MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
                MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
                PERFORM    900-TENSU-TBL-SEC
                MOVE    TNS-TANICD          TO  RECE65-TANICD(IDX4)
                MOVE    TNS-TANIMOJISU      TO  RECE65-TANIMOJISU(IDX4)
                MOVE    TNS-TANINAME        TO  RECE65-TANINAME(IDX4)
                MOVE    TNS-TENSIKIBETU     TO  RECE65-TENSIKIBETU(IDX4)
                MOVE    TNS-TEN             TO  RECE65-TEN(IDX4)
                MOVE    TNS-NYUTENTTLKBN    TO  RECE65-TENTTLKBN(IDX4)
                MOVE    TNS-YUKOKETA        TO  RECE65-YUKOKETA(IDX4)
                MOVE    TNS-DATAKBN         TO  RECE65-DATAKBN (IDX4)
                MOVE    TNS-HOUKNSKBN       TO  RECE65-HOUKNSKBN(IDX4)
                MOVE    TNS-KNSJISKBN       TO  RECE65-KNSJISKBN(IDX4)
                MOVE    TNS-CDKBN-KBN       TO  RECE65-CDKBN-KBN(IDX4)
                MOVE    TNS-CDKBN-SYO       TO  RECE65-CDKBN-SYO(IDX4)
                MOVE    TNS-CDKBN-BU        TO  RECE65-CDKBN-BU(IDX4)
                MOVE    TNS-CDKBN-KBNNUM   
                                      TO RECE65-CDKBN-KBNNUM(IDX4)
                MOVE    TNS-CDKBN-KBNNUM-EDA
                                      TO RECE65-CDKBN-KBNNUM-EDA(IDX4)
                MOVE    TNS-CDKBN-KOUBAN
                                      TO RECE65-CDKBN-KOUBAN(IDX4)
                MOVE    TNS-KOUHYOJYUNNUM  
                                      TO RECE65-KOUHYOJYUNNUM(IDX4)
      *
                MOVE    TNS-SRYSYUKBN TO RECE65-SRYSYUKBN-X(IDX4)
                MOVE    TNS-KOKUJISKBKBN1
                                      TO RECE65-KOKUJISKBKBN1(IDX4)
                MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE65-KOKUJISKBKBN2(IDX4)
                MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE65-TUSOKUGAIKBN (IDX4)
                MOVE    TNS-TIMEKSNKBN
                                      TO RECE65-TIMEKSNKBN   (IDX4)
                MOVE    TNS-KZMCOMPSIKIBETU
                                      TO RECE65-KZMCOMPSIKIBETU(IDX4)
                MOVE    TNS-CHUKSNCD  TO RECE65-CHUKSNCD(IDX4)
                MOVE    TNS-CHUKSNTUBAN
                                      TO RECE65-CHUKSNTUBAN(IDX4)
                MOVE    TNS-KENTAICOMMENT
                                      TO RECE65-KENTAICOMMENT(IDX4)
                MOVE    TNS-KNSJISGRPKBN
                                      TO RECE65-KNSJISGRPKBN(IDX4)
                MOVE    TNS-TOKUKIZAISBT1
                                      TO RECE65-TOKUKIZAISBT1(IDX4)
                MOVE    TNS-SANSOKBN  TO RECE65-SANSOKBN     (IDX4)
      *
                MOVE    TNS-NAME      TO RECE65-NAME(IDX4)
      *
              END-IF
      *
           END-PERFORM
      *
           .
       2102141-RECE65-TENSOU2-SKJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210214-RECE65-HENSYU2-SKJ200604-SEC               SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE65-KOHBUNRI
           IF   WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
                COMPUTE WRK-ZAINUM  =  99996100  +  SYUKEI-IDX3
                MOVE    WRK-ZAINUM      TO   RECE65-ZAINUM
           ELSE
                COMPUTE WRK-ZAINUM  =  99996000  +  SYUKEI-IDX3
                MOVE    WRK-ZAINUM      TO   RECE65-ZAINUM
           END-IF
      ***  COMPUTE WRK-ZAINUM    =  99999920  +  SYUKEI-IDX3
      ***  MOVE    WRK-ZAINUM           TO   RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
           MOVE    1                    TO   RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
           MOVE    SPACE                TO   RECE65-SRYKA
           MOVE    "97"                 TO   RECE65-SRYKBN
           MOVE    "970"                TO   RECE65-SRYSYUKBN
           MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL     IDX2     >     3
      *
             IF  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX2)  NOT =  ZERO
      *
               ADD     1                    TO  IDX4
               IF   WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
                EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
                 WHEN      1
                   EVALUATE    IDX2
                     WHEN       1
                         MOVE  "197001310"  TO  RECE65-SRYCD(IDX4)
                     WHEN       2
                         MOVE  "197001570"  TO  RECE65-SRYCD(IDX4)
                     WHEN       3
                         MOVE  "197001670"  TO  RECE65-SRYCD(IDX4)
                   END-EVALUATE
                 WHEN      2
                         MOVE  "197001710"  TO  RECE65-SRYCD(IDX4)
                END-EVALUATE
               ELSE
                EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
                 WHEN      1
                   EVALUATE    IDX2
                     WHEN       1
                         MOVE  "197000110"  TO  RECE65-SRYCD(IDX4)
                     WHEN       2
                         MOVE  "197000470"  TO  RECE65-SRYCD(IDX4)
                     WHEN       3
                         MOVE  "197000570"  TO  RECE65-SRYCD(IDX4)
                   END-EVALUATE
                 WHEN      2
                         MOVE  "197000710"  TO  RECE65-SRYCD(IDX4)
                END-EVALUATE
               END-IF
               MOVE    WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX2)
                                            TO  RECE65-SRYSURYO(IDX4)
               MOVE    ZERO                 TO  RECE65-SRYKAISU(IDX4)
               MOVE    SPACE                TO  RECE65-MEISKYFLG(IDX4)
               MOVE    SPACE                TO  RECE65-AUTOKBN(IDX4)
               MOVE    ZERO                 TO  RECE65-INPUTNUM(IDX4)
      *
               MOVE    RECE65-SRYCD(IDX4)   TO  WRK-SRYCD
               MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
               MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
               PERFORM 900-TENSU-TBL-SEC
               MOVE    TNS-TANICD           TO  RECE65-TANICD(IDX4)
               MOVE    TNS-TANIMOJISU       TO  RECE65-TANIMOJISU(IDX4)
               MOVE    TNS-TANINAME         TO  RECE65-TANINAME(IDX4)
               MOVE    TNS-TENSIKIBETU      TO  RECE65-TENSIKIBETU(IDX4)
               MOVE    TNS-TEN              TO  RECE65-TEN(IDX4)
               MOVE    TNS-NYUTENTTLKBN     TO  RECE65-TENTTLKBN(IDX4)
               MOVE    TNS-YUKOKETA         TO  RECE65-YUKOKETA(IDX4)
               MOVE    TNS-DATAKBN          TO  RECE65-DATAKBN (IDX4)
               MOVE    TNS-HOUKNSKBN        TO  RECE65-HOUKNSKBN(IDX4)
               MOVE    TNS-KNSJISKBN        TO  RECE65-KNSJISKBN(IDX4)
               MOVE    TNS-CDKBN-KBN        TO  RECE65-CDKBN-KBN(IDX4)
               MOVE    TNS-CDKBN-SYO        TO  RECE65-CDKBN-SYO(IDX4)
               MOVE    TNS-CDKBN-BU         TO  RECE65-CDKBN-BU(IDX4)
               MOVE    TNS-CDKBN-KBNNUM     TO
                                          RECE65-CDKBN-KBNNUM(IDX4)
               MOVE    TNS-CDKBN-KBNNUM-EDA TO
                                          RECE65-CDKBN-KBNNUM-EDA(IDX4)
               MOVE    TNS-CDKBN-KOUBAN     TO
                                          RECE65-CDKBN-KOUBAN(IDX4)
               MOVE    TNS-KOUHYOJYUNNUM    TO
                                          RECE65-KOUHYOJYUNNUM(IDX4)
      *
               MOVE    TNS-SRYSYUKBN  TO  RECE65-SRYSYUKBN-X(IDX4)
               MOVE    TNS-KOKUJISKBKBN1
                                      TO  RECE65-KOKUJISKBKBN1(IDX4)
               MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE65-KOKUJISKBKBN2(IDX4)
               MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE65-TUSOKUGAIKBN (IDX4)
               MOVE    TNS-TIMEKSNKBN TO RECE65-TIMEKSNKBN   (IDX4)
               MOVE    TNS-KZMCOMPSIKIBETU
                                      TO  RECE65-KZMCOMPSIKIBETU(IDX4)
               MOVE    TNS-CHUKSNCD   TO  RECE65-CHUKSNCD(IDX4)
               MOVE    TNS-CHUKSNTUBAN
                                      TO  RECE65-CHUKSNTUBAN(IDX4)
               MOVE    TNS-KENTAICOMMENT
                                      TO  RECE65-KENTAICOMMENT(IDX4)
               MOVE    TNS-KNSJISGRPKBN
                                      TO  RECE65-KNSJISGRPKBN(IDX4)
               MOVE    TNS-TOKUKIZAISBT1
                                      TO  RECE65-TOKUKIZAISBT1(IDX4)
               MOVE    TNS-SANSOKBN   TO  RECE65-SANSOKBN     (IDX4)
      *
               MOVE    TNS-NAME       TO  RECE65-NAME(IDX4)
      *
               COMPUTE RECE64-ZAITEN =
                       RECE64-ZAITEN +
                  (TNS-TEN * WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX2))
               COMPUTE RECE64-SYUTEN1 =
                       RECE64-SYUTEN1 +
                  (TNS-TEN * WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX2))
             END-IF
      *
           END-PERFORM
      *
           .
       210214-RECE65-HENSYU2-SKJ200604-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（環境）（Ｆ００５）
      *****************************************************************
       210220-RECE65-HENSYU2-SKJ200610-KAN-SEC               SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE65-KOHBUNRI
           COMPUTE WRK-ZAINUM   =  99996300  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO   RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
           MOVE    1                    TO   RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
           MOVE    SPACE                TO   RECE65-SRYKA
           MOVE    "97"                 TO   RECE65-SRYKBN
           MOVE    "970"                TO   RECE65-SRYSYUKBN
           MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
      *
           EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
             WHEN      1
                 MOVE  "197001410"      TO  RECE65-SRYCD(1)
             WHEN      2
                 MOVE  "197001810"      TO  RECE65-SRYCD(1)
           END-EVALUATE
           MOVE    1                    TO  RECE65-SRYSURYO(1)
           MOVE    ZERO                 TO  RECE65-SRYKAISU(1)
           MOVE    SPACE                TO  RECE65-MEISKYFLG(1)
           MOVE    SPACE                TO  RECE65-AUTOKBN(1)
           MOVE    ZERO                 TO  RECE65-INPUTNUM(1)
      *
           MOVE    RECE65-SRYCD(1)      TO  WRK-SRYCD
           MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
           PERFORM 900-TENSU-TBL-SEC
           MOVE    TNS-TANICD           TO  RECE65-TANICD(1)
           MOVE    TNS-TANIMOJISU       TO  RECE65-TANIMOJISU(1)
           MOVE    TNS-TANINAME         TO  RECE65-TANINAME(1)
           MOVE    TNS-TENSIKIBETU      TO  RECE65-TENSIKIBETU(1)
           MOVE    TNS-TEN              TO  RECE65-TEN(1)
           MOVE    TNS-NYUTENTTLKBN     TO  RECE65-TENTTLKBN(1)
           MOVE    TNS-YUKOKETA         TO  RECE65-YUKOKETA(1)
           MOVE    TNS-DATAKBN          TO  RECE65-DATAKBN (1)
           MOVE    TNS-HOUKNSKBN        TO  RECE65-HOUKNSKBN(1)
           MOVE    TNS-KNSJISKBN        TO  RECE65-KNSJISKBN(1)
           MOVE    TNS-CDKBN-KBN        TO  RECE65-CDKBN-KBN(1)
           MOVE    TNS-CDKBN-SYO        TO  RECE65-CDKBN-SYO(1)
           MOVE    TNS-CDKBN-BU         TO  RECE65-CDKBN-BU(1)
           MOVE    TNS-CDKBN-KBNNUM     TO  RECE65-CDKBN-KBNNUM(1)
           MOVE    TNS-CDKBN-KBNNUM-EDA TO  RECE65-CDKBN-KBNNUM-EDA(1)
           MOVE    TNS-CDKBN-KOUBAN     TO  RECE65-CDKBN-KOUBAN(1)
           MOVE    TNS-KOUHYOJYUNNUM    TO  RECE65-KOUHYOJYUNNUM(1)
      *
           MOVE    TNS-SRYSYUKBN        TO  RECE65-SRYSYUKBN-X(1)
           MOVE    TNS-KOKUJISKBKBN1    TO  RECE65-KOKUJISKBKBN1(1)
           MOVE    TNS-KOKUJISKBKBN2    TO  RECE65-KOKUJISKBKBN2(1)
           MOVE    TNS-TUSOKUGAIKBN     TO  RECE65-TUSOKUGAIKBN (1)
           MOVE    TNS-TIMEKSNKBN       TO  RECE65-TIMEKSNKBN   (1)
           MOVE    TNS-KZMCOMPSIKIBETU  TO  RECE65-KZMCOMPSIKIBETU(1)
           MOVE    TNS-CHUKSNCD         TO  RECE65-CHUKSNCD(1)
           MOVE    TNS-CHUKSNTUBAN      TO  RECE65-CHUKSNTUBAN(1)
           MOVE    TNS-KENTAICOMMENT    TO  RECE65-KENTAICOMMENT(1)
           MOVE    TNS-KNSJISGRPKBN     TO  RECE65-KNSJISGRPKBN(1)
           MOVE    TNS-TOKUKIZAISBT1    TO  RECE65-TOKUKIZAISBT1(1)
           MOVE    TNS-SANSOKBN         TO  RECE65-SANSOKBN(1)
      *
           MOVE    TNS-NAME             TO  RECE65-NAME(1)
      *
           MOVE    TNS-TEN              TO  RECE64-ZAITEN
           MOVE    TNS-TEN              TO  RECE64-SYUTEN1
      *
           .
       210220-RECE65-HENSYU2-SKJ200610-KAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（食事負担）（Ｆ００５）
      *****************************************************************
       210222-RECE65-HENSYU2-SKJ200610FTN-SEC               SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE65-KOHBUNRI
           EVALUATE  FLG-SKJ200610FTN
             WHEN        1
               COMPUTE WRK-ZAINUM  =  99996200  +  SYUKEI-IDX3
               MOVE    WRK-ZAINUM       TO  RECE65-ZAINUM
             WHEN        2
               COMPUTE WRK-ZAINUM  =  99996400  +  SYUKEI-IDX3
               MOVE    WRK-ZAINUM       TO  RECE65-ZAINUM
           END-EVALUATE
           MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
           MOVE    1                    TO   RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
           MOVE    SPACE                TO   RECE65-SRYKA
           MOVE    "97"                 TO   RECE65-SRYKBN
           MOVE    "970"                TO   RECE65-SRYSYUKBN
           MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
      *
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
                MOVE    WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                                        TO  RECE65-SRYCD(1)
             WHEN         2
                MOVE    WRK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                                        TO  RECE65-SRYCD(1)
           END-EVALUATE
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
                MOVE    WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3)
                                        TO  RECE65-SRYSURYO(1)
             WHEN         2
                MOVE    1               TO  RECE65-SRYSURYO(1)
           END-EVALUATE
           MOVE    ZERO                 TO  RECE65-SRYKAISU(1)
           MOVE    SPACE                TO  RECE65-MEISKYFLG(1)
           MOVE    SPACE                TO  RECE65-AUTOKBN(1)
           MOVE    ZERO                 TO  RECE65-INPUTNUM(1)
      *
           MOVE    RECE65-SRYCD(1)      TO  WRK-SRYCD
           MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
           PERFORM 900-TENSU-TBL-SEC
           MOVE    TNS-TANICD           TO  RECE65-TANICD(1)
           MOVE    TNS-TANIMOJISU       TO  RECE65-TANIMOJISU(1)
           MOVE    TNS-TANINAME         TO  RECE65-TANINAME(1)
           MOVE    TNS-TENSIKIBETU      TO  RECE65-TENSIKIBETU(1)
           MOVE    TNS-TEN              TO  RECE65-TEN(1)
           MOVE    TNS-NYUTENTTLKBN     TO  RECE65-TENTTLKBN(1)
           MOVE    TNS-YUKOKETA         TO  RECE65-YUKOKETA(1)
           MOVE    TNS-DATAKBN          TO  RECE65-DATAKBN (1)
           MOVE    TNS-HOUKNSKBN        TO  RECE65-HOUKNSKBN(1)
           MOVE    TNS-KNSJISKBN        TO  RECE65-KNSJISKBN(1)
           MOVE    TNS-CDKBN-KBN        TO  RECE65-CDKBN-KBN(1)
           MOVE    TNS-CDKBN-SYO        TO  RECE65-CDKBN-SYO(1)
           MOVE    TNS-CDKBN-BU         TO  RECE65-CDKBN-BU(1)
           MOVE    TNS-CDKBN-KBNNUM     TO  RECE65-CDKBN-KBNNUM(1)
           MOVE    TNS-CDKBN-KBNNUM-EDA TO  RECE65-CDKBN-KBNNUM-EDA(1)
           MOVE    TNS-CDKBN-KOUBAN     TO  RECE65-CDKBN-KOUBAN(1)
           MOVE    TNS-KOUHYOJYUNNUM    TO  RECE65-KOUHYOJYUNNUM(1)
      *
           MOVE    TNS-SRYSYUKBN        TO  RECE65-SRYSYUKBN-X(1)
           MOVE    TNS-KOKUJISKBKBN1    TO  RECE65-KOKUJISKBKBN1(1)
           MOVE    TNS-KOKUJISKBKBN2    TO  RECE65-KOKUJISKBKBN2(1)
           MOVE    TNS-TUSOKUGAIKBN     TO  RECE65-TUSOKUGAIKBN (1)
           MOVE    TNS-TIMEKSNKBN       TO  RECE65-TIMEKSNKBN   (1)
           MOVE    TNS-KZMCOMPSIKIBETU  TO  RECE65-KZMCOMPSIKIBETU(1)
           MOVE    TNS-CHUKSNCD         TO  RECE65-CHUKSNCD(1)
           MOVE    TNS-CHUKSNTUBAN      TO  RECE65-CHUKSNTUBAN(1)
           MOVE    TNS-KENTAICOMMENT    TO  RECE65-KENTAICOMMENT(1)
           MOVE    TNS-KNSJISGRPKBN     TO  RECE65-KNSJISGRPKBN(1)
           MOVE    TNS-TOKUKIZAISBT1    TO  RECE65-TOKUKIZAISBT1(1)
           MOVE    TNS-SANSOKBN         TO  RECE65-SANSOKBN(1)
      *
           MOVE    TNS-NAME             TO  RECE65-NAME(1)
      *
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
               COMPUTE RECE64-ZAITEN =
                       RECE64-ZAITEN +
                 (TNS-TEN *
                       WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3))
               COMPUTE RECE64-SYUTEN1 =
                       RECE64-SYUTEN1 +
                 (TNS-TEN *
                       WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3))
             WHEN         2
               MOVE    TNS-TEN         TO  RECE64-ZAITEN
               MOVE    TNS-TEN         TO  RECE64-SYUTEN1
           END-EVALUATE
      *
           .
       210222-RECE65-HENSYU2-SKJ200610FTN-EXT.
           EXIT.
      *
      *****************************************************************
      *    未実施減算額取得
      *****************************************************************
       210215-MIJISI-GET-SEC                 SECTION.
      *
           PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                        UNTIL     GENSAN-IDX   >   4
                MOVE   ZERO   TO  WRK-SYS-MIJISI-ZAITEN(GENSAN-IDX)
           END-PERFORM
      *
           PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                        UNTIL     GENSAN-IDX   >   4
      *
              IF    WRK-SYS-MIJISI(GENSAN-IDX)  =   1    
                 EVALUATE    GENSAN-IDX
                   WHEN   2
      *
      ***            IF    RECE62-RJNHKNNUM    =    SPACE
                       MOVE    "190080570"   TO   WRK-SRYCD-X
      ***            ELSE
      ***              MOVE    "190799770"   TO   WRK-SRYCD-X
      ***            END-IF
                     MOVE    RECE62-SRYYM    TO   WK-TAIHI-SRYYM
                     MOVE    1               TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        MOVE    TNS-TEN   TO   WRK-SYS-MIJISI-ZAITEN
                                                      (GENSAN-IDX)
                     END-IF
      *
                   WHEN   3
      *
      ***            IF    RECE62-RJNHKNNUM    =    SPACE
                       MOVE    "190111690"   TO   WRK-SRYCD-X
      ***            ELSE
      ***              MOVE    "190809090"   TO   WRK-SRYCD-X
      ***            END-IF
                     MOVE    RECE62-SRYYM    TO   WK-TAIHI-SRYYM
                     MOVE    1               TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        MOVE    TNS-TEN   TO   WRK-SYS-MIJISI-ZAITEN
                                                      (GENSAN-IDX)
                     END-IF
      *
                   WHEN   4
      *
      ***            IF    RECE62-RJNHKNNUM    =    SPACE
                       MOVE    "190111790"   TO   WRK-SRYCD-X
      ***            ELSE
      ***              MOVE    "190809190"   TO   WRK-SRYCD-X
      ***            END-IF
                     MOVE    RECE62-SRYYM    TO   WK-TAIHI-SRYYM
                     MOVE    1               TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        MOVE    TNS-TEN   TO   WRK-SYS-MIJISI-ZAITEN
                                                      (GENSAN-IDX)
                     END-IF
      *
                 END-EVALUATE
              END-IF
      *
           END-PERFORM
      *
           .
       210215-MIJISI-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210216-RECE64-TENSOU2-MIJ-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           IF      FLG-MIJISI2   =   1
              MOVE    "90"              TO      RECE64-SRYKBN
           ELSE
              MOVE    "92"              TO      RECE64-SRYKBN
           END-IF 
           MOVE    "6"                  TO      RECE64-ZAISKBKBN
           IF      FLG-MIJISI2   =   1
             COMPUTE WRK-ZAINUM    =  99999960  +  SYUKEI-IDX3
           ELSE
             COMPUTE WRK-ZAINUM    =  99999970  +  SYUKEI-IDX3
           END-IF
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    "00"                 TO      RECE64-SRYKA
           MOVE    WRK-MIJ-HKNCOMBI(IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           EVALUATE   SYUKEI-IDX3
               WHEN  2
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-ZAITEN
                 MOVE    1              TO      RECE64-MEISAISU
                 IF      FLG-MIJISI2   =   1
                    MOVE    WRK-MIJ-CNT90(IDX1 2)
                                        TO      RECE64-ZAIKAISU
                 ELSE
                    MOVE    WRK-MIJ-CNT92(IDX1 2)
                                        TO      RECE64-ZAIKAISU
                 END-IF
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    190080570   TO      RECE64-SRYCDTOTAL
      ***        ELSE
      ***           MOVE    190799770   TO      RECE64-SRYCDTOTAL
      ***        END-IF
               WHEN  3
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-ZAITEN
                 MOVE    1              TO      RECE64-MEISAISU
                 IF      FLG-MIJISI2   =   1
                    MOVE    WRK-MIJ-CNT90(IDX1 3)
                                        TO      RECE64-ZAIKAISU
                 ELSE
                    MOVE    WRK-MIJ-CNT92(IDX1 3)
                                        TO      RECE64-ZAIKAISU
                 END-IF
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    190111690   TO      RECE64-SRYCDTOTAL
      ***        ELSE
      ***           MOVE    190809090   TO      RECE64-SRYCDTOTAL
      ***        END-IF
               WHEN  4
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-ZAITEN
                 MOVE    1              TO      RECE64-MEISAISU
                 IF      FLG-MIJISI2   =   1
                    MOVE    WRK-MIJ-CNT90(IDX1 4)
                                        TO      RECE64-ZAIKAISU
                 ELSE
                    MOVE    WRK-MIJ-CNT92(IDX1 4)
                                        TO      RECE64-ZAIKAISU
                 END-IF
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    190111790   TO      RECE64-SRYCDTOTAL
      ***        ELSE
      ***           MOVE    190809190   TO      RECE64-SRYCDTOTAL
      ***        END-IF
           END-EVALUATE
           MOVE    1                    TO      RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           MOVE    ZERO                 TO      RECE64-YKZTEN
           MOVE    ZERO                 TO      RECE64-KIZAITEN
           MOVE    SPACE                TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           IF      FLG-MIJISI2   =   1
              PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-MIJ-DAY90(IDX1 SYUKEI-IDX3 IDX2)
                                      TO      RECE64-KAISU (1 IDX2)
                   IF     (WK-TAIHI-FLG           =   ZERO)   
                   AND    (WRK-MIJ-DAY90(IDX1 SYUKEI-IDX3 IDX2)
                                              NOT =   ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
              END-PERFORM
           ELSE
              PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-MIJ-DAY92(IDX1 SYUKEI-IDX3 IDX2)
                                      TO      RECE64-KAISU (1 IDX2)
                   IF     (WK-TAIHI-FLG           =   ZERO)   
                   AND    (WRK-MIJ-DAY92(IDX1 SYUKEI-IDX3 IDX2)
                                              NOT =   ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
              END-PERFORM
           END-IF
      *
           .
       210216-RECE64-TENSOU2-MIJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       210217-RECE65-TENSOU2-MIJ-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
           IF      FLG-MIJISI2   =   1
             COMPUTE WRK-ZAINUM    =  99999960  +  SYUKEI-IDX3
           ELSE
             COMPUTE WRK-ZAINUM    =  99999970  +  SYUKEI-IDX3
           END-IF
           MOVE    WRK-ZAINUM           TO      RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    1                    TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    "00"                 TO      RECE65-SRYKA
           IF      FLG-MIJISI2   =   1
              MOVE    "90"              TO      RECE65-SRYKBN
           ELSE
              MOVE    "92"              TO      RECE65-SRYKBN
           END-IF 
           IF      FLG-MIJISI2   =   1
              MOVE    "900"             TO      RECE65-SRYSYUKBN
           ELSE
              MOVE    "920"             TO      RECE65-SRYSYUKBN
           END-IF 
           MOVE    ZERO                 TO      RECE65-JIHIMONEY
      *
           EVALUATE   SYUKEI-IDX3
               WHEN  2
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    "190080570" TO      RECE65-SRYCD(1)
      ***        ELSE
      ***           MOVE    190799770   TO      RECE65-SRYCD(1)
      ***        END-IF
               WHEN  3
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    "190111690" TO      RECE65-SRYCD(1)
      ***        ELSE
      ***           MOVE    190809090   TO      RECE65-SRYCD(1)
      ***        END-IF
               WHEN  4
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    "190111790" TO      RECE65-SRYCD(1)
      ***        ELSE
      ***           MOVE    190809190   TO      RECE65-SRYCD(1)
      ***        END-IF
           END-EVALUATE
      *
           MOVE    1                    TO  RECE65-SRYSURYO(1)
           MOVE    ZERO                 TO  RECE65-SRYKAISU(1)
           MOVE    SPACE                TO  RECE65-MEISKYFLG(1)
           MOVE    SPACE                TO  RECE65-AUTOKBN(1)
           MOVE    ZERO                 TO  RECE65-INPUTNUM(1)
           MOVE    RECE65-SRYCD(1)      TO  WRK-SRYCD
           MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
           PERFORM    900-TENSU-TBL-SEC
           MOVE    TNS-TANICD          TO  RECE65-TANICD(1)
           MOVE    TNS-TANIMOJISU      TO  RECE65-TANIMOJISU(1)
           MOVE    TNS-TANINAME        TO  RECE65-TANINAME(1)
           MOVE    TNS-TENSIKIBETU     TO  RECE65-TENSIKIBETU(1)
           MOVE    TNS-TEN             TO  RECE65-TEN(1)
           MOVE    TNS-NYUTENTTLKBN    TO  RECE65-TENTTLKBN(1)
           MOVE    TNS-YUKOKETA        TO  RECE65-YUKOKETA(1)
           MOVE    TNS-DATAKBN         TO  RECE65-DATAKBN (1)
           MOVE    TNS-HOUKNSKBN       TO  RECE65-HOUKNSKBN(1)
           MOVE    TNS-KNSJISKBN       TO  RECE65-KNSJISKBN(1)
           MOVE    TNS-CDKBN-KBN       TO  RECE65-CDKBN-KBN(1)
           MOVE    TNS-CDKBN-SYO       TO  RECE65-CDKBN-SYO(1)
           MOVE    TNS-CDKBN-BU        TO  RECE65-CDKBN-BU(1)
           MOVE    TNS-CDKBN-KBNNUM   
                                       TO  RECE65-CDKBN-KBNNUM(1)
           MOVE    TNS-CDKBN-KBNNUM-EDA
                                       TO  RECE65-CDKBN-KBNNUM-EDA(1)
           MOVE    TNS-CDKBN-KOUBAN
                                       TO  RECE65-CDKBN-KOUBAN(1)
           MOVE    TNS-KOUHYOJYUNNUM  
                                       TO  RECE65-KOUHYOJYUNNUM(1)
      *
           MOVE    TNS-SRYSYUKBN       TO  RECE65-SRYSYUKBN-X(1)
           MOVE    TNS-KOKUJISKBKBN1   TO  RECE65-KOKUJISKBKBN1(1)
           MOVE    TNS-KOKUJISKBKBN2   TO  RECE65-KOKUJISKBKBN2(1)
           MOVE    TNS-TUSOKUGAIKBN    TO  RECE65-TUSOKUGAIKBN (1)
           MOVE    TNS-TIMEKSNKBN      TO  RECE65-TIMEKSNKBN   (1)
           MOVE    TNS-KZMCOMPSIKIBETU
                                       TO  RECE65-KZMCOMPSIKIBETU(1)
           MOVE    TNS-CHUKSNCD        TO  RECE65-CHUKSNCD(1)
           MOVE    TNS-CHUKSNTUBAN     TO  RECE65-CHUKSNTUBAN(1)
           MOVE    TNS-KENTAICOMMENT   TO  RECE65-KENTAICOMMENT(1)
           MOVE    TNS-KNSJISGRPKBN    TO  RECE65-KNSJISGRPKBN(1)
           MOVE    TNS-TOKUKIZAISBT1   TO  RECE65-TOKUKIZAISBT1(1)
           MOVE    TNS-SANSOKBN        TO  RECE65-SANSOKBN(1)
      *
           MOVE    TNS-NAME            TO  RECE65-NAME(1)
      *
           MOVE    RECE65-SRYCD(1)     TO  WRK-SRYCD
           COMPUTE RECE64-RUIKEITOTAL  =
                   RECE64-RUIKEITOTAL  +   WRK-SRYCD
           MOVE     ZERO    TO    WRK-FUKA-KINGAKU
           PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                     UNTIL   FUKA-IDX   >    9
             MOVE   WRK-SRYCD(FUKA-IDX:1)
                                     TO  WRK-FUKA-VALUE
             IF  WRK-FUKA-VALUE  =  ZERO
               CONTINUE
             ELSE
               COMPUTE  WRK-FUKA-KINGAKU    =
                        WRK-FUKA-KINGAKU    +
                      ((WRK-FUKA-VALUE^5) * FUKA-IDX)
             END-IF
           END-PERFORM
           COMPUTE  RECE64-RUIKEITOTAL  =
                    RECE64-RUIKEITOTAL  +
                    WRK-FUKA-KINGAKU
      *
           .
       210217-RECE65-TENSOU2-MIJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００４）
      *****************************************************************
       2103-RECE64-HENSYU3-SEC                SECTION.
      *
      *    点滴の計算
      *
           MOVE    ZERO                TO  CNT-ZAIREN
      *
           MOVE    RECE62-HOSPNUM      TO  SPA-HOSPNUM
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                           UNTIL   IDX1    >       10
                           OR      RECE62-HKNCOMBI (IDX1)  =   ZERO
      *
              ADD      1                  TO  CNT-ZAIREN
      *
              PERFORM   21031-RECE62-HENSYU3-IDX-SEC
      *
              INITIALIZE                  ORCSTENTEKAREA
              MOVE    "2"                 TO  ORCSTEN-KBN
              MOVE    RECE62-PTID         TO  ORCSTEN-PTID
              MOVE    RECE62-SRYYM        TO  ORCSTEN-SRYYM
              MOVE    RECE62-HKNCOMBI (IDX1)
                                          TO  ORCSTEN-HKNCOMBI
              CALL    "ORCSTENTEK"        USING
                                          SPA-AREA
                                          ORCSTENTEKAREA
      *
      *       IF      ORCSTEN-ERRCD       =   ZERO
      *
      *           薬剤
                  PERFORM  VARYING  IDY    FROM    1   BY  1
                              UNTIL   IDY     >       31
      *
                    MOVE   SPACE  TO   WRK-FORMALNAME
                    MOVE   ZERO   TO   FLG-SETCOM
                    IF  ORCSTEN-ZAITEN(IDY)  NOT =  ZERO
      *
                       MOVE   1      TO   FLG-SIKIBETU
      *
                       INITIALIZE         WRK-ORCSTEN-TABLE
                       MOVE   ZERO   TO   IDX6
                       PERFORM  VARYING  IDX5    FROM    1   BY  1
                              UNTIL   IDX5     >       50
                                OR    ORCSTEN-SRYCD(IDY IDX5)  = SPACE
                          ADD   1   TO   IDX6
                          MOVE  ORCSTEN-SRYCD(IDY IDX5)  TO  
                                      WRK-ORCSTEN-SRYCD(IDX6)
                          MOVE  ORCSTEN-SURYO(IDY IDX5)  TO  
                                      WRK-ORCSTEN-SURYO(IDX6)
                          IF  ORCSTEN-HAIK-SRYCD(IDY IDX5) NOT = SPACE
                             ADD   1   TO   IDX6
                             MOVE  ORCSTEN-HAIK-SRYCD(IDY IDX5)
                                       TO   WRK-ORCSTEN-SRYCD(IDX6)
                             MOVE  ORCSTEN-HAIK-SURYO(IDY IDX5)
                                       TO   WRK-ORCSTEN-SURYO(IDX6)
                          END-IF 
                          PERFORM  VARYING  IDX9    FROM    1   BY  1
                            UNTIL  IDX9     >      5
                              OR   ORCSTEN-COM-SRYCD(IDY IDX5 IDX9)
                                                              = SPACE
                             ADD   1   TO   IDX6
                             MOVE  "810000001"
                                       TO   WRK-ORCSTEN-SRYCD(IDX6)
                             MOVE  1   TO   WRK-ORCSTEN-SURYO(IDX6)
                             MOVE  ORCSTEN-COM-MEI(IDY IDX5 IDX9)
                                       TO   WRK-ORCSTEN-COM-MEI(IDX6)
                          END-PERFORM
                       END-PERFORM
      *
                       PERFORM   21032-RECE64-TENSOU3-SEC
      *
                       MOVE      350  TO   IDX5
                       PERFORM   21033-RECE65-TENSOU3-SEC
                       PERFORM   21034-RECE62-HENSYU3-SEC
      *
                       PERFORM   RECE64-WRITE-SEC
      *
                    END-IF
      *
                  END-PERFORM
      *
      *           器材
                  PERFORM  VARYING  IDY    FROM    1   BY  1
                              UNTIL   IDY     >       50
                                OR    ORCSTEN-KIZ-ZAITEN(IDY)  =  ZERO
      *
                       MOVE   SPACE  TO   WRK-FORMALNAME
                       MOVE   ZERO   TO   FLG-SETCOM
                       MOVE   2      TO   FLG-SIKIBETU
      *
                       INITIALIZE         WRK-ORCSTEN-TABLE
                       MOVE   ZERO   TO   IDX6
                       PERFORM  VARYING  IDX5    FROM    1   BY  1
                              UNTIL   IDX5     >       10
                                OR    ORCSTEN-KIZ-SRYCD(IDY IDX5)
                                                               = SPACE
                          ADD   1   TO   IDX6
                          MOVE  ORCSTEN-KIZ-SRYCD(IDY IDX5)  TO  
                                      WRK-ORCSTEN-SRYCD(IDX6)
                          MOVE  ORCSTEN-KIZ-SURYO(IDY IDX5)  TO  
                                      WRK-ORCSTEN-SURYO(IDX6)
                          PERFORM  VARYING  IDX9    FROM    1   BY  1
                            UNTIL  IDX9     >      5
                              OR   ORCSTEN-KIZ-COM-SRYCD(IDY IDX5 IDX9)
                                                              = SPACE
                             ADD   1   TO   IDX6
                             MOVE  "810000001"
                                       TO   WRK-ORCSTEN-SRYCD(IDX6)
                             MOVE  1   TO   WRK-ORCSTEN-SURYO(IDX6)
                             MOVE  ORCSTEN-KIZ-COM-MEI(IDY IDX5 IDX9)
                                       TO   WRK-ORCSTEN-COM-MEI(IDX6)
                          END-PERFORM
                       END-PERFORM
                       PERFORM  VARYING  IDX5    FROM    1   BY  1
                              UNTIL   IDX5     >       31
                          MOVE  ORCSTEN-KIZ-DAY  (IDY IDX5)  TO  
                                      WRK-ORCSTEN-DAY  (IDX5)
                          ADD   ORCSTEN-KIZ-DAY  (IDY IDX5)  TO
                                      WRK-ORCSTEN-ZAIKAISU
                       END-PERFORM
      *
                       PERFORM   21032-RECE64-TENSOU3-SEC
      *
                       MOVE      60   TO   IDX5
                       PERFORM   21033-RECE65-TENSOU3-SEC
                       PERFORM   21034-RECE62-HENSYU3-SEC
      *
                       PERFORM   RECE64-WRITE-SEC
      *
                  END-PERFORM
      *
      *       END-IF
      *
           END-PERFORM
      *
      ***
      *
      *    点滴手技加算
      *
           MOVE    ZERO                TO  CNT-ZAIREN
      *
           PERFORM  VARYING  IDX1  FROM  1   BY  1
                     UNTIL   IDX1   >   10
      *
             IF   WRK-TENTEKI2-HKNCOMBI(IDX1)  NOT =  ZERO
      *
               ADD       1             TO  CNT-ZAIREN
      *
               PERFORM   21031-RECE62-HENSYU3-IDX-SEC
      *
               IF   WRK-TENTEKI2-T-ERRCD(IDX1)     =  ZERO
                 PERFORM  VARYING  IDY    FROM    1   BY  1
                           UNTIL   IDY     >     31
                    MOVE    ZERO     TO   FLG-SETCOM
                    IF  WRK-TENTEKI2-T-ZAITEN(IDX1 IDY)  NOT =  ZERO
                       MOVE      3   TO   FLG-SIKIBETU
                       PERFORM   21032X-RECE64-TENSOU3-SEC
                       MOVE      WRK-TENTEKI2-T-SRYCD-X(IDX1 IDY)
                                     TO   WRK-TENTEKI2-SRYCD-X
                       PERFORM   21035-RECE65-TENTEKI2-HENSYU-SEC
                       PERFORM   21034-RECE62-HENSYU3-SEC
                       PERFORM   RECE64-WRITE-SEC
                    END-IF
                 END-PERFORM
               END-IF
      *
               IF   WRK-TENTEKI2-C-ERRCD(IDX1)     =  ZERO
                 PERFORM  VARYING  IDY    FROM    1   BY  1
                           UNTIL   IDY     >     31
                    MOVE    ZERO     TO   FLG-SETCOM
                    IF  WRK-TENTEKI2-C-ZAITEN(IDX1 IDY)  NOT =  ZERO
                       MOVE      4   TO   FLG-SIKIBETU
                       PERFORM   21032X-RECE64-TENSOU3-SEC
                       MOVE      WRK-TENTEKI2-C-SRYCD-X(IDX1 IDY)
                                     TO   WRK-TENTEKI2-SRYCD-X
                       PERFORM   21035-RECE65-TENTEKI2-HENSYU-SEC
                       PERFORM   21034-RECE62-HENSYU3-SEC
                       PERFORM   RECE64-WRITE-SEC
                    END-IF
                 END-PERFORM
               END-IF
      *
             END-IF
      *
           END-PERFORM
      *
           .
       2103-RECE64-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       21031-RECE62-HENSYU3-IDX-SEC               SECTION.
      *
      *    公費の分離表示用インデックスの確定
           MOVE          ZERO       TO     BUN-IDX
      ***  IF    (RECE62-HKNNUM          NOT =   SPACE)   OR
           IF    (RECE62-HKNNUMHC(IDX1)  NOT =   SPACE)   OR
                 (RECE62-RJNHKNNUM       NOT =   SPACE)
           MOVE          1          TO     BUN-IDX
           END-IF
      *    インデックス２
           MOVE          ZERO       TO     BUN-IDX2
           IF  RECE62-HENTOTALTEN(2)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(2) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(2)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(1)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(1)
                           MOVE      2       TO     BUN-IDX2
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス３
           MOVE          ZERO       TO     BUN-IDX3
           IF  RECE62-HENTOTALTEN(3)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(3) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(3)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(2)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(2)
                           MOVE      3       TO     BUN-IDX3
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス４
           MOVE          ZERO       TO     BUN-IDX4
           IF  RECE62-HENTOTALTEN(4)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(4) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(4)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(3)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(3)
                           MOVE      4       TO     BUN-IDX4
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *
           .                                           
      *
       21031-RECE62-HENSYU3-IDX-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       21032-RECE64-TENSOU3-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    "33"                 TO      RECE64-SRYKBN
           MOVE    SPACE                TO      RECE64-ZAISKBKBN
           IF    FLG-SIKIBETU  =  1
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99997000
                                   +  (WRK-KEISAN + IDY)
           ELSE
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  50) -  50
             COMPUTE WRK-ZAINUM    =  99997400
                                   +  (WRK-KEISAN + IDY)
           END-IF
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    "00"                 TO      RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI (IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           IF    FLG-SIKIBETU  =  1
             MOVE  ORCSTEN-ZAITEN(IDY)  TO      RECE64-ZAITEN
           ELSE
             MOVE  ORCSTEN-KIZ-ZAITEN(IDY)  
                                        TO      RECE64-ZAITEN
           END-IF
           MOVE    ZERO                 TO      RECE64-SRYCDTOTAL
           MOVE    ZERO                 TO      RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO      RECE64-MEISAISU
           IF    FLG-SIKIBETU  =  1
             MOVE  1                    TO      RECE64-ZAIKAISU
           ELSE
             MOVE  WRK-ORCSTEN-ZAIKAISU TO      RECE64-ZAIKAISU
           END-IF
           MOVE    ZERO                 TO      RECE64-SYUTEN1
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           IF    FLG-SIKIBETU  =  1
             MOVE  ORCSTEN-ZAITEN(IDY)  TO      RECE64-YKZTEN
             MOVE  ZERO                 TO      RECE64-KIZAITEN
           ELSE
             MOVE  ZERO                 TO      RECE64-YKZTEN
             MOVE  ORCSTEN-KIZ-ZAITEN(IDY)
                                        TO      RECE64-KIZAITEN
           END-IF
           MOVE    SPACE                TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
      *
           IF    FLG-SIKIBETU  =  1
             MOVE    1                  TO      RECE64-KAISU (1 IDY)
             MOVE    IDY                TO      WK-TAIHI-DAY
           ELSE
             MOVE        ZERO           TO      WK-TAIHI-DAY
             MOVE        ZERO           TO      WK-TAIHI-FLG
             PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-ORCSTEN-DAY(IDX2)  TO
                                            RECE64-KAISU (1 IDX2)
                   IF     (WK-TAIHI-FLG            =   ZERO)   AND
                          (WRK-ORCSTEN-DAY(IDX2)  NOT =   ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
             END-PERFORM
           END-IF
           .
       21032-RECE64-TENSOU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       21032X-RECE64-TENSOU3-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    "33"                 TO      RECE64-SRYKBN
           MOVE    SPACE                TO      RECE64-ZAISKBKBN
           IF    FLG-SIKIBETU  =  3
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99995000
                                   +  (WRK-KEISAN + IDY)
           ELSE
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99995400
                                   +  (WRK-KEISAN + IDY)
           END-IF
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    "00"                 TO      RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI (IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
      *
           IF    FLG-SIKIBETU  =  3
             MOVE  WRK-TENTEKI2-T-ZAITEN(IDX1 IDY)
                                        TO      RECE64-ZAITEN
                                                RECE64-SYUTEN1
           ELSE
             MOVE  WRK-TENTEKI2-C-ZAITEN(IDX1 IDY)
                                        TO      RECE64-ZAITEN
                                                RECE64-SYUTEN1
           END-IF
           MOVE    1                    TO      RECE64-ZAIKAISU
      *
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           MOVE    ZERO                 TO      RECE64-YKZTEN
           MOVE    ZERO                 TO      RECE64-KIZAITEN
           MOVE    SPACE                TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
      *
           MOVE    1                    TO      RECE64-KAISU (1 IDY)
           MOVE    IDY                  TO      WK-TAIHI-DAY
           .
       21032X-RECE64-TENSOU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       21033-RECE65-TENSOU3-SEC                SECTION.
      *
           MOVE    1                       TO   IDX2
           MOVE    ZERO                    TO   WRK-RENNUM
           MOVE    ZERO                    TO   WRK-TANICD
           MOVE    ZERO                    TO   WRK-TANIMOJISU
           MOVE    SPACE                   TO   WRK-TANINAME
           MOVE    ZERO                    TO   WRK-KZI058-TEN
           MOVE    ZERO                    TO   WRK-KZI058-TANICD
           MOVE    ZERO                    TO   WRK-KZI058-TANIMOJISU
           MOVE    SPACE                   TO   WRK-KZI058-TANINAME
      *
           PERFORM
                  UNTIL     (IDX2      >   IDX5)    OR
                            (WRK-ORCSTEN-SRYCD(IDX2)  =   SPACE)
      *
             PERFORM 500-RECE65-KEY-HENSYU-SEC
              MOVE    ZERO                 TO   RECE65-KOHBUNRI
              IF    FLG-SIKIBETU  =  1
                COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
                COMPUTE WRK-ZAINUM    =  99997000
                                      +  (WRK-KEISAN + IDY)
              ELSE
                COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  50) -  50
                COMPUTE WRK-ZAINUM    =  99997400
                                      +  (WRK-KEISAN + IDY)
              END-IF
              MOVE    WRK-ZAINUM           TO   RECE65-ZAINUM
              MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
              ADD     1                    TO   WRK-RENNUM
              MOVE    WRK-RENNUM           TO   RECE65-RENNUM
              MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
              MOVE    "00"                 TO   RECE65-SRYKA
              MOVE    "33"                 TO   RECE65-SRYKBN
              MOVE    "330"                TO   RECE65-SRYSYUKBN
              MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
              MOVE    ZERO                 TO      IDX4
              PERFORM
                     UNTIL  (IDX4      >=   5  )    OR
                            (IDX2      >   IDX5)    OR
                            (WRK-ORCSTEN-SRYCD(IDX2)  =   SPACE)
      *
                IF   WRK-ORCSTEN-SRYCD(IDX2)(1:1) =   "0" OR  "6" OR  
                                                      "7" OR  "8"
      *
                  ADD   1                   TO  IDX4    
      *
                  MOVE  WRK-ORCSTEN-SRYCD(IDX2) 
                                            TO  RECE65-SRYCD(IDX4)
                  MOVE  WRK-ORCSTEN-SURYO(IDX2) 
                                            TO  RECE65-SRYSURYO(IDX4)
                  MOVE  ZERO                TO  RECE65-SRYKAISU(IDX4)
                  MOVE  SPACE               TO  RECE65-MEISKYFLG(IDX4)
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)  =  CONS-ZANHAIKI)
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "8"    )
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "008"  )
                    MOVE  "2"               TO  RECE65-MEISKYFLG(IDX4)
                  END-IF
                  MOVE  SPACE               TO  RECE65-AUTOKBN(IDX4)
                  MOVE  ZERO                TO  RECE65-INPUTNUM(IDX4)
                  MOVE  WRK-ORCSTEN-SRYCD(IDX2) 
                                            TO  WRK-SRYCD
                  MOVE  RECE65-SRYYM        TO  WK-TAIHI-SRYYM
                  MOVE  WK-TAIHI-DAY        TO  WK-TAIHI-SRYD
                  PERFORM    900-TENSU-TBL-SEC
                  IF  WRK-ORCSTEN-SRYCD(IDX2)  =  CONS-ZANHAIKI
                    IF  RECE65-SRYSURYO(IDX4)  NOT = ZERO
                      MOVE   WRK-TANICD     TO  RECE65-TANICD(IDX4)
                      MOVE   WRK-TANIMOJISU TO  RECE65-TANIMOJISU(IDX4)
                      MOVE   WRK-TANINAME   TO  RECE65-TANINAME(IDX4)
                    ELSE
                      MOVE   "1"            TO  RECE65-RECEDENFLG(IDX4)
                      MOVE   "1"            TO  RECE65-RECEPTFLG(IDX4)
                    END-IF
                  ELSE
                      IF   TNS-TANICD  NOT = SPACE AND "000"
                       MOVE TNS-TANICD      TO  RECE65-TANICD(IDX4)
                                                WRK-TANICD
                      END-IF
                      MOVE  TNS-TANIMOJISU  TO  RECE65-TANIMOJISU(IDX4)
                                                WRK-TANIMOJISU
                      MOVE  TNS-TANINAME    TO  RECE65-TANINAME(IDX4)
                                                WRK-TANINAME
                  END-IF
                  MOVE  TNS-TENSIKIBETU     TO  RECE65-TENSIKIBETU(IDX4)
                  MOVE  TNS-TEN             TO  RECE65-TEN(IDX4)
                  MOVE  TNS-NYUTENTTLKBN    TO  RECE65-TENTTLKBN(IDX4)
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "008")
                     MOVE   ZERO            TO  RECE65-YUKOKETA(IDX4)
                  ELSE
                     MOVE   TNS-YUKOKETA    TO  RECE65-YUKOKETA(IDX4)
                  END-IF
                  MOVE  TNS-DATAKBN         TO  RECE65-DATAKBN (IDX4)
                  MOVE  TNS-HOUKNSKBN       TO  RECE65-HOUKNSKBN(IDX4)
                  MOVE  TNS-KNSJISKBN       TO  RECE65-KNSJISKBN(IDX4)
                  MOVE  TNS-CDKBN-KBN       TO  RECE65-CDKBN-KBN(IDX4)
                  MOVE  TNS-CDKBN-SYO       TO  RECE65-CDKBN-SYO(IDX4)
                  MOVE  TNS-CDKBN-BU        TO  RECE65-CDKBN-BU(IDX4)
                  MOVE  TNS-CDKBN-KBNNUM   
                                      TO RECE65-CDKBN-KBNNUM(IDX4)
                  MOVE  TNS-CDKBN-KBNNUM-EDA
                                      TO RECE65-CDKBN-KBNNUM-EDA(IDX4)
                  MOVE  TNS-CDKBN-KOUBAN
                                      TO RECE65-CDKBN-KOUBAN(IDX4)
                  MOVE  TNS-KOUHYOJYUNNUM  
                                      TO RECE65-KOUHYOJYUNNUM(IDX4)
      *
                  MOVE  TNS-SRYSYUKBN TO RECE65-SRYSYUKBN-X(IDX4)
                  MOVE  TNS-KOKUJISKBKBN1
                                      TO RECE65-KOKUJISKBKBN1(IDX4)
                  MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE65-KOKUJISKBKBN2(IDX4)
                  MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE65-TUSOKUGAIKBN (IDX4)
                  MOVE    TNS-TIMEKSNKBN
                                      TO RECE65-TIMEKSNKBN   (IDX4)
                  MOVE  TNS-KZMCOMPSIKIBETU
                                      TO RECE65-KZMCOMPSIKIBETU(IDX4)
                  MOVE  TNS-CHUKSNCD  TO RECE65-CHUKSNCD(IDX4)
                  MOVE  TNS-CHUKSNTUBAN
                                      TO RECE65-CHUKSNTUBAN(IDX4)
                  MOVE  TNS-KENTAICOMMENT
                                      TO RECE65-KENTAICOMMENT(IDX4)
                  MOVE  TNS-KNSJISGRPKBN
                                      TO RECE65-KNSJISGRPKBN(IDX4)
                  MOVE  TNS-TOKUKIZAISBT1
                                      TO RECE65-TOKUKIZAISBT1(IDX4)
                  MOVE  TNS-SANSOKBN  TO RECE65-SANSOKBN     (IDX4)
                  IF      TNS-SRYCD (1:2)   =   "84"
                      PERFORM VARYING IDYY    FROM    1   BY  1
                              UNTIL   IDYY    >       10
                          MOVE    TNS-SSTKIJUNCD (IDYY)
                                              TO  RECE65-SSTKIJUNCD
                                                   (IDX4 IDYY)
                      END-PERFORM
                  END-IF
      *
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "008")
                     MOVE   WRK-ORCSTEN-COM-MEI(IDX2)
                                      TO RECE65-NAME(IDX4)
                                         RECE65-INPUTCOMENT(IDX4)
                  ELSE
                     MOVE   TNS-NAME  TO RECE65-NAME(IDX4)
                                         RECE65-INPUTCOMENT(IDX4)
                  END-IF
      *
                  IF  WRK-ORCSTEN-SRYCD(IDX2)  =  CONS-ZANHAIKI
                     IF  RECE65-SRYSURYO(IDX4)  NOT = ZERO
                       PERFORM  2101213-RECE65-TENSOU-SURYO-HEN-SEC
      *
                       MOVE    SPACE      TO  RECE65-NAME(IDX4)
                       MOVE    SPACE      TO  RECE65-INPUTCOMENT(IDX4)
                       STRING  TNS-NAME          DELIMITED  BY  " "
      ***                      "  "              DELIMITED  BY  SIZE
                               "　"              DELIMITED  BY  SIZE
                               WRK-SRYSURYOW     DELIMITED  BY  " "
                               RECE65-TANINAME(IDX4)
                                                 DELIMITED  BY  " "
                               INTO              RECE65-NAME(IDX4)
                       END-STRING
                       MOVE  RECE65-NAME(IDX4)
                                          TO  RECE65-INPUTCOMENT(IDX4)
      *
      ***              MOVE  "810000001"  TO  RECE65-SRYCD(IDX4)
                       MOVE  ZERO         TO  RECE65-SRYSURYO(IDX4)
                       MOVE  ZERO         TO  RECE65-TANICD(IDX4)
                       MOVE  ZERO         TO  RECE65-TANIMOJISU(IDX4)
                       MOVE  SPACE        TO  RECE65-TANINAME(IDX4)
                       MOVE  ZERO         TO  RECE65-YUKOKETA(IDX4)
                     END-IF
                  END-IF
      *
                  IF   WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "058"
                    MOVE  TNS-FORMALYUKOKETA TO  RECE65-YUKOKETA(IDX4)
                    MOVE  TNS-FORMALNAME     TO  RECE65-NAME(IDX4)
                                                 WRK-FORMALNAME
                    MOVE  "1"                TO  RECE65-RECEDENFLG(IDX4)
      *
                    MOVE     TNS-TEN         TO  WRK-KZI058-TEN
                    IF   TNS-TANICD  NOT = SPACE AND "000"
                       MOVE  TNS-TANICD      TO  WRK-KZI058-TANICD
                       MOVE  TNS-TANIMOJISU  TO  WRK-KZI058-TANIMOJISU
                       MOVE  TNS-TANINAME    TO  WRK-KZI058-TANINAME
                    END-IF
                    MOVE     ZERO            TO  RECE65-TEN(IDX4)
                    MOVE     ZERO            TO  RECE65-TANICD(IDX4)
                    MOVE     ZERO            TO  RECE65-TANIMOJISU(IDX4)
                    MOVE     SPACE           TO  RECE65-TANINAME(IDX4)
                  END-IF
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "7")
                  AND (WRK-FORMALNAME     NOT =  SPACE      )
                    MOVE  WRK-FORMALNAME  TO  RECE65-RECEDENNAME(IDX4)
                    MOVE  "1"             TO  RECE65-RECEHENFLG(IDX4)
                    MOVE  SPACE           TO  WRK-FORMALNAME
                    IF    WRK-KZI058-TEN  NOT = ZERO
                       MOVE   WRK-KZI058-TEN
                                          TO  RECE65-TEN(IDX4)
                    END-IF
                    IF   (RECE65-TANICD(IDX4)    = ZERO)
                    AND  (WRK-KZI058-TANICD  NOT = ZERO)
                       MOVE   WRK-KZI058-TANICD
                                          TO  RECE65-TANICD(IDX4)
                       MOVE   WRK-KZI058-TANIMOJISU
                                          TO  RECE65-TANIMOJISU(IDX4)
                       MOVE   WRK-KZI058-TANINAME
                                          TO  RECE65-TANINAME(IDX4)
                    END-IF
                  END-IF
      *
                  IF   RECE65-YUKOKETA(IDX4)  =  ZERO
                     PERFORM   VARYING   IDW   FROM   200   BY  -1
                                UNTIL    IDW   <   1
                       IF   RECE65-NAME(IDX4)(IDW:1)  NOT =   SPACE
                           COMPUTE RECE65-YUKOKETA(IDX4)  =
                                   IDW     /   2
                           MOVE    1          TO  IDW
                       END-IF
                     END-PERFORM
                  END-IF
      *
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "008")
                        MOVE     "1"             TO  RECE64-COMCDFLG
                  END-IF
      *
                  MOVE  WRK-ORCSTEN-SRYCD(IDX2)  TO  WRK-SRYCD
                  COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                              +  WRK-SRYCD
                  COMPUTE  RECE64-SURYOUTOTAL =  RECE64-SURYOUTOTAL
                                              +  WRK-ORCSTEN-SURYO(IDX2)
                  COMPUTE  RECE64-MEISAISU    =  RECE64-MEISAISU
                                              +  1
      *
                  MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                  PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                            UNTIL   FUKA-IDX   >    9
                    MOVE   WRK-ORCSTEN-SRYCD(IDX2)(FUKA-IDX:1)
                                            TO  WRK-FUKA-VALUE
                    IF  WRK-FUKA-VALUE  =  ZERO
                      CONTINUE
                    ELSE
                      COMPUTE  RECE64-RUIKEITOTAL  =
                               RECE64-RUIKEITOTAL  +
                             ( WRK-FUKA-VALUE    * WRK-SRYCD)
                      COMPUTE  WRK-FUKA-KINGAKU    =
                               WRK-FUKA-KINGAKU    +
                             ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                   * WRK-ORCSTEN-SURYO(IDX2))
                    END-IF
                  END-PERFORM
                  COMPUTE  RECE64-RUIKEITOTAL  =
                           RECE64-RUIKEITOTAL  +
                           WRK-FUKA-KINGAKU
      *
      *           特定器材の単価編集
                  IF      WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "7"
                    IF  WRK-ORCSTEN-SRYCD(IDX2)       =
                                       CONS-FILM-YOUJI-KASAN  OR
                                       CONS-SANSO             OR
                                       CONS-SANSO2              
                      CONTINUE
                    ELSE
                      IF      TNS-TEN         =   ZERO
                        CONTINUE
                      ELSE
                        PERFORM 2101212-RECE65-TENSOU-TANKA-HEN-SEC
                        COMPUTE IDW =   RECE65-YUKOKETA(IDX4)  *  2
                                    +   3
                        MOVE    WRK-CHAR-N (1:WRK-CHAR-N-CNT)
                                   TO   RECE65-NAME(IDX4)(IDW:)
                        COMPUTE RECE65-YUKOKETA(IDX4)  =
                                RECE65-YUKOKETA(IDX4)  +
                                  1                    +
                               (WRK-CHAR-N-CNT  /  2)
                      END-IF
                    END-IF
                  END-IF
      **
                  IF   RECE65-MEISKYFLG(IDX4)  =  "2"
                     IF   (FLG-SETCOM              =  1   )
                     AND  (RECE65-RECEDENFLG(IDX4) = SPACE)
                        MOVE  "1"            TO  RECE64-SETCOMFLG
                     ELSE
                        MOVE  SPACE          TO  RECE65-MEISKYFLG(IDX4)
                     END-IF
                  ELSE
                     IF   (RECE65-SRYCD(IDX4)(1:1) = "1" OR "6" OR "7")
                     OR   (RECE65-SRYCD(IDX4)(1:3) = "059"            )
                        MOVE   1             TO  FLG-SETCOM
                     END-IF
                  END-IF
      **
                END-IF  
      *
                ADD        1                TO  IDX2
      *
              END-PERFORM
      *
              PERFORM   RECE65-WRITE-SEC
      *
           END-PERFORM
      *
           .
       21033-RECE65-TENSOU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       21035-RECE65-TENTEKI2-HENSYU-SEC                SECTION.
      *
           INITIALIZE             WRK-TENTEKI2-SRYCD2-X
      *
           MOVE      ZERO    TO   IDX4
           PERFORM  VARYING  IDX2   FROM    1    BY   1
                     UNTIL  (IDX2                     >      5  )
                       OR   (WRK-TENTEKI2-SRYCD(IDX2)  =   SPACE)
                       OR   (IDX4                     >=   100  )
               ADD    1      TO   IDX4
               MOVE   WRK-TENTEKI2-SRYCD(IDX2)
                             TO   WRK-TENTEKI2-SRYCD2(IDX4)
               PERFORM  VARYING  IDX5   FROM    1    BY   1
                         UNTIL  (IDX5                       >     5  )
                           OR   (WRK-TENTEKI2-COM-SRYCD(IDX2 IDX5)
                                                             =  SPACE)
                           OR   (IDX4                       >=  100  )
                     ADD    1   TO   IDX4
                     MOVE  "810000001"
                                TO   WRK-TENTEKI2-SRYCD2(IDX4)
                     MOVE  WRK-TENTEKI2-COM-FLG(IDX2 IDX5)
                                TO   WRK-TENTEKI2-COM-FLG2(IDX4)
                     MOVE  WRK-TENTEKI2-COM-MOJI(IDX2 IDX5)
                                TO   WRK-TENTEKI2-COM-MOJI2(IDX4)
               END-PERFORM
           END-PERFORM
      *
           MOVE    1                       TO   IDX2
           MOVE    ZERO                    TO   WRK-RENNUM
      *
           PERFORM   UNTIL  (WRK-TENTEKI2-SRYCD2(IDX2)  =   SPACE)
                      OR    (IDX2                       >   100  )
      *
              PERFORM   21033X-RECE65-TENSOU3-SEC
      *
           END-PERFORM
      *
           .
       21035-RECE65-TENTEKI2-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       21033X-RECE65-TENSOU3-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE65-KOHBUNRI
           IF    FLG-SIKIBETU  =  3
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99995000
                                   +  (WRK-KEISAN + IDY)
           ELSE
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99995400
                                   +  (WRK-KEISAN + IDY)
           END-IF
           MOVE    WRK-ZAINUM           TO   RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
           ADD     1                    TO   WRK-RENNUM
           MOVE    WRK-RENNUM           TO   RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
           MOVE    "00"                 TO   RECE65-SRYKA
           MOVE    "33"                 TO   RECE65-SRYKBN
           IF    FLG-SIKIBETU  =  3
              MOVE    "330"             TO   RECE65-SRYSYUKBN
           ELSE
              MOVE    "340"             TO   RECE65-SRYSYUKBN
           END-IF
           MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO   IDX4
           PERFORM   UNTIL  (WRK-TENTEKI2-SRYCD2(IDX2)  =   SPACE)
                      OR    (IDX4                      >=     5  )
                      OR    (IDX2                      >    100  )
      *
                  ADD   1                   TO  IDX4
      *
                  MOVE  WRK-TENTEKI2-SRYCD2(IDX2)
                                            TO  RECE65-SRYCD(IDX4)
                  MOVE  1                   TO  RECE65-SRYSURYO(IDX4)
                  MOVE  ZERO                TO  RECE65-SRYKAISU(IDX4)
                  MOVE  SPACE               TO  RECE65-MEISKYFLG(IDX4)
                  IF   WRK-TENTEKI2-COM-FLG2(IDX2) = "1"
                    MOVE  "2"               TO  RECE65-MEISKYFLG(IDX4)
                  END-IF
                  MOVE  SPACE               TO  RECE65-AUTOKBN(IDX4)
                  MOVE  ZERO                TO  RECE65-INPUTNUM(IDX4)
                  MOVE  WRK-TENTEKI2-SRYCD2(IDX2)
                                            TO  WRK-SRYCD
                  MOVE  RECE65-SRYYM        TO  WK-TAIHI-SRYYM
                  MOVE  WK-TAIHI-DAY        TO  WK-TAIHI-SRYD
                  PERFORM    900-TENSU-TBL-SEC
                  MOVE  TNS-TANICD          TO  RECE65-TANICD(IDX4)
                  MOVE  TNS-TANIMOJISU      TO  RECE65-TANIMOJISU(IDX4)
                  MOVE  TNS-TANINAME        TO  RECE65-TANINAME(IDX4)
                  MOVE  TNS-TENSIKIBETU     TO  RECE65-TENSIKIBETU(IDX4)
                  MOVE  TNS-TEN             TO  RECE65-TEN(IDX4)
                  MOVE  TNS-NYUTENTTLKBN    TO  RECE65-TENTTLKBN(IDX4)
                  IF  (WRK-TENTEKI2-SRYCD2(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-TENTEKI2-SRYCD2(IDX2)(1:3)  =   "008")
                     MOVE   ZERO            TO  RECE65-YUKOKETA(IDX4)
                  ELSE
                     MOVE   TNS-YUKOKETA    TO  RECE65-YUKOKETA(IDX4)
                  END-IF
                  MOVE  TNS-DATAKBN         TO  RECE65-DATAKBN (IDX4)
                  MOVE  TNS-HOUKNSKBN       TO  RECE65-HOUKNSKBN(IDX4)
                  MOVE  TNS-KNSJISKBN       TO  RECE65-KNSJISKBN(IDX4)
                  MOVE  TNS-CDKBN-KBN       TO  RECE65-CDKBN-KBN(IDX4)
                  MOVE  TNS-CDKBN-SYO       TO  RECE65-CDKBN-SYO(IDX4)
                  MOVE  TNS-CDKBN-BU        TO  RECE65-CDKBN-BU(IDX4)
                  MOVE  TNS-CDKBN-KBNNUM
                                      TO RECE65-CDKBN-KBNNUM(IDX4)
                  MOVE  TNS-CDKBN-KBNNUM-EDA
                                      TO RECE65-CDKBN-KBNNUM-EDA(IDX4)
                  MOVE  TNS-CDKBN-KOUBAN
                                      TO RECE65-CDKBN-KOUBAN(IDX4)
                  MOVE  TNS-KOUHYOJYUNNUM
                                      TO RECE65-KOUHYOJYUNNUM(IDX4)
      *
                  MOVE  TNS-SRYSYUKBN TO RECE65-SRYSYUKBN-X(IDX4)
                  MOVE  TNS-KOKUJISKBKBN1
                                      TO RECE65-KOKUJISKBKBN1(IDX4)
                  MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE65-KOKUJISKBKBN2(IDX4)
                  MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE65-TUSOKUGAIKBN (IDX4)
                  MOVE    TNS-TIMEKSNKBN
                                      TO RECE65-TIMEKSNKBN   (IDX4)
                  MOVE  TNS-KZMCOMPSIKIBETU
                                      TO RECE65-KZMCOMPSIKIBETU(IDX4)
                  MOVE  TNS-CHUKSNCD  TO RECE65-CHUKSNCD(IDX4)
                  MOVE  TNS-CHUKSNTUBAN
                                      TO RECE65-CHUKSNTUBAN(IDX4)
                  MOVE  TNS-KENTAICOMMENT
                                      TO RECE65-KENTAICOMMENT(IDX4)
                  MOVE  TNS-KNSJISGRPKBN
                                      TO RECE65-KNSJISGRPKBN(IDX4)
                  MOVE  TNS-TOKUKIZAISBT1
                                      TO RECE65-TOKUKIZAISBT1(IDX4)
                  MOVE  TNS-SANSOKBN  TO RECE65-SANSOKBN     (IDX4)
                  IF      TNS-SRYCD (1:2)   =   "84"
                      PERFORM VARYING IDYY    FROM    1   BY  1
                              UNTIL   IDYY    >       10
                         MOVE    TNS-SSTKIJUNCD (IDYY)
                                              TO  RECE65-SSTKIJUNCD
                                                   (IDX4 IDYY)
                      END-PERFORM
                  END-IF
      *
                  IF  (WRK-TENTEKI2-SRYCD2(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-TENTEKI2-SRYCD2(IDX2)(1:3)  =   "008")
                     MOVE   WRK-TENTEKI2-COM-MOJI2(IDX2)
                                      TO RECE65-NAME(IDX4)
                                         RECE65-INPUTCOMENT(IDX4)
                  ELSE
                     MOVE   TNS-NAME  TO RECE65-NAME(IDX4)
                                         RECE65-INPUTCOMENT(IDX4)
                  END-IF
      *
                  IF   RECE65-YUKOKETA(IDX4)  =  ZERO
                     PERFORM   VARYING   IDW   FROM   200   BY  -1
                                UNTIL    IDW   <   1
                       IF   RECE65-NAME(IDX4)(IDW:1)  NOT =   SPACE
                           COMPUTE RECE65-YUKOKETA(IDX4)  =
                                   IDW     /   2
                           MOVE    1          TO  IDW
                       END-IF
                     END-PERFORM
                  END-IF
      *
                  IF  (WRK-TENTEKI2-SRYCD2(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-TENTEKI2-SRYCD2(IDX2)(1:3)  =   "008")
                        MOVE     "1"             TO  RECE64-COMCDFLG
                  END-IF
      *
                  MOVE  WRK-TENTEKI2-SRYCD2(IDX2)  TO  WRK-SRYCD
                  COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                              +  WRK-SRYCD
                  COMPUTE  RECE64-SURYOUTOTAL =  RECE64-SURYOUTOTAL
                                              +  1
                  COMPUTE  RECE64-MEISAISU    =  RECE64-MEISAISU
                                              +  1
      *
                  MOVE  ZERO          TO WRK-FUKA-KINGAKU
                  PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                            UNTIL   FUKA-IDX   >    9
                    MOVE   WRK-TENTEKI2-SRYCD2(IDX2)(FUKA-IDX:1)
                                            TO  WRK-FUKA-VALUE
                    IF  WRK-FUKA-VALUE  =  ZERO
                      CONTINUE
                    ELSE
                      COMPUTE  RECE64-RUIKEITOTAL  =
                               RECE64-RUIKEITOTAL  +
                             ( WRK-FUKA-VALUE    * WRK-SRYCD)
                      COMPUTE  WRK-FUKA-KINGAKU    =
                               WRK-FUKA-KINGAKU    +
                             ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                                 * 1)
                    END-IF
                  END-PERFORM
                  COMPUTE  RECE64-RUIKEITOTAL  =
                           RECE64-RUIKEITOTAL  +
                           WRK-FUKA-KINGAKU
      *
                  IF   RECE65-MEISKYFLG(IDX4)  =  "2"
                     IF   (FLG-SETCOM              =  1   )
                     AND  (RECE65-RECEDENFLG(IDX4) = SPACE)
                        MOVE  "1"            TO  RECE64-SETCOMFLG
                     ELSE
                        MOVE  SPACE          TO  RECE65-MEISKYFLG(IDX4)
                     END-IF
                  ELSE
                     IF   (RECE65-SRYCD(IDX4)(1:1) = "1" OR "6" OR "7")
                     OR   (RECE65-SRYCD(IDX4)(1:3) = "059"            )
                        MOVE   1             TO  FLG-SETCOM
                     END-IF
                  END-IF
      *
                  ADD        1               TO  IDX2
      *
           END-PERFORM
      *
           IF     IDX4    NOT =  ZERO
              PERFORM   RECE65-WRITE-SEC
           END-IF
      *
           .
       21033X-RECE65-TENSOU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       21034-RECE62-HENSYU3-SEC               SECTION.
      *
      *    その他注射のレセ点数欄の編集
           ADD   RECE64-ZAIKAISU    TO   RECE62-KAISU(12)
      *
           IF    BUN-IDX        =   1
                 COMPUTE   RECE62-TENSU(12 BUN-IDX)  =
                           RECE62-TENSU(12 BUN-IDX)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
           END-IF
           IF    BUN-IDX2       =   2
                 COMPUTE   RECE62-TENSU(12 BUN-IDX2)  =
                           RECE62-TENSU(12 BUN-IDX2)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
           END-IF
           IF    BUN-IDX3       =   3
                 COMPUTE   RECE62-TENSU(12 BUN-IDX3)  =
                           RECE62-TENSU(12 BUN-IDX3)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
           END-IF
           IF    BUN-IDX4       =   4
                 COMPUTE   RECE62-TENSU(12 BUN-IDX4)  =
                           RECE62-TENSU(12 BUN-IDX4)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
           END-IF
      *
           .                                           
      *
       21034-RECE62-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルへの負担金セット（Ｆ００２）
      *****************************************************************
       2104-FTN-SET-SEC                SECTION.
      *
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN2
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN3
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN4
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN5
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN6
      *
           MOVE    ZERO                 TO      WRK-CHK-ICHIBUGAKU
                                                WRK-CHK-FTNGAKU
                                                WRK-CHK-KOHFTNGAKU
      *
           MOVE    ZERO                 TO      FLG-GENBUTU-TAISYOOK
      *
           MOVE    ZERO                 TO      FLG-GENBUTU70
           MOVE    ZERO                 TO      FLG-KOHYONKAIME
           MOVE    ZERO                 TO      FLG-RJNGENMEN-CHIARI
           INITIALIZE                           WRK-TAIHI-GENKIN-TBL
           MOVE    ZERO                 TO      FLG-ZENKI-TOKUREI
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU2
           MOVE    ZERO                 TO      FLG-KEISAN-TOK1
                                                FLG-KEISAN-TOK2
                                                WRK-KINGAKU-TOK1
           MOVE    ZERO                 TO      FLG-KOUGAKU
      *
           MOVE    ZERO                 TO      FLG-SYUNOU-ARI
      *
           MOVE    ZERO                 TO      FLG-KOUREI-KBN
      *
           MOVE    ZERO                 TO      FLG-WRKFILE-CLEAR
           MOVE    ZERO                 TO      FLG-SKY-TOKKOH
      *
           MOVE    ZERO                 TO      FLG-GENMEN-ARI
           MOVE    ZERO                 TO      FLG-GENMEN-NASI
           MOVE    ZERO                 TO      FLG-GENMEN-ARI2
           MOVE    ZERO                 TO      FLG-GENMEN-NASI2
           MOVE    ZERO                 TO      WRK-GENMEN-NASI-KIN
           MOVE    ZERO                 TO      WRK-GENMEN-NASI-SKJ
           MOVE    ZERO                 TO      WRK-GENMEN-NASI-KIN2
           MOVE    ZERO                 TO      WRK-GENMEN-NASI-SKJ2
      *
           IF  (RECE62-NYUINRYOFLG   =   "1"     )
           AND (RECE62-KOUREI        =   "1"     )
           AND (RECE62-SRYYM        >=   "200904")
             INITIALIZE                        SYUNOU-REC
             MOVE    RECE62-HOSPNUM       TO   SYU-HOSPNUM
             MOVE    RECE62-NYUGAIKBN     TO   SYU-NYUGAIKBN
             MOVE    RECE62-PTID          TO   SYU-PTID
             MOVE    RECE62-SRYYM         TO   SYU-SRYYMD(1:6)
             MOVE    "__"                 TO   SYU-SRYYMD(7:2)
             MOVE    SYUNOU-REC           TO   MCPDATA-REC
             MOVE    "tbl_syunou"         TO   MCP-TABLE
             MOVE    "key17"              TO   MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF      MCP-RC               =    ZERO
               MOVE  "tbl_syunou"         TO   MCP-TABLE
               MOVE  "key17"              TO   MCP-PATHNAME
               PERFORM  900-SYUNOU-READ-SEC
               PERFORM  UNTIL  (FLG-SYUNOU     = 1)
                         OR    (FLG-KOUREI-KBN = 1)
                 PERFORM  VARYING  IDX1  FROM  1  BY  1
                           UNTIL  (IDX1    >  10               )
                            OR    (RECE62-HKNCOMBI(IDX1) = ZERO)
                            OR    (FLG-KOUREI-KBN        =  1  )
                   IF  SYU-HKNCOMBINUM  =  RECE62-HKNCOMBI(IDX1)
                     IF  SYU-DENPJTIKBN  NOT =  "3"
                       IF   SYU-SKJ-FTNGAKU(3)  =  1
                          MOVE   SPACE    TO   RECE62-KOUREI
                          MOVE    1       TO   FLG-KOUREI-KBN
                       END-IF
                     END-IF
                     MOVE    10           TO   IDX1
                   END-IF
                 END-PERFORM
                 MOVE  "tbl_syunou"       TO   MCP-TABLE
                 MOVE  "key17"            TO   MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
               END-PERFORM
             END-IF
             MOVE      "tbl_syunou"       TO   MCP-TABLE
             MOVE      "key17"            TO   MCP-PATHNAME
             PERFORM    900-CLOSE-SEC
           END-IF
      *
           INITIALIZE                   TBL-TOKATUKAI
           PERFORM   VARYING  IDY2    FROM    1   BY   1
                      UNTIL   IDY2      >     4
              IF  ((WRK-PREFNUM          =  "13"    ) AND
                   (RECE62-KOHNUM(IDY2)  =  "151"   ) AND
                   (RECE62-SRYYM        >=  "200905"))
              OR  ((WRK-PREFNUM          =  "23"    ) AND
                   (RECE62-KOHNUM(IDY2)  =  "191"   ) AND
                   (RECE62-SRYYM        >=  "200910"))
                 MOVE     1     TO    TBL-TOKATUKAIFLG(IDY2)
              END-IF
           END-PERFORM
      *
           MOVE    ZERO                 TO      WRK-KOHCNT
           IF      RECE62-SRYYM   >=   "200804"
              PERFORM   VARYING  IDY2    FROM    1   BY   1
                         UNTIL   IDY2      >     4
                 IF   (RECE62-KOHNUM(IDY2)  NOT =  SPACE          )
                 AND  (RECE62-KOHNUM(IDY2)  NOT =  "972" AND "974")
                     ADD       1        TO      WRK-KOHCNT
                 END-IF
              END-PERFORM
      *
              IF   (RECE62-HKNCOMBI(2)   NOT =   ZERO)
              AND  (WRK-KOHCNT               >    1  )
                     MOVE     "1"       TO      RECE62-JSKISAIFLG
              END-IF
           END-IF
      *
           PERFORM         2104E-TOKUSITU-HANTEI-SEC
      *
           IF    RECE62-KOUREI    =    "1"  OR  "2"
              IF    RECE62-KOUREI    =    "1"
                 PERFORM   21048-KEIKASOCHI-HANTEI-SEC
              ELSE
                 PERFORM   21049-GENBUTU70-HANTEI-SEC
              END-IF
           END-IF
      *
           IF    (RECE62-SRYYM   >=  "200804")
           AND   (RECE62-SRYYM   <=  "201203")
             IF  (RECE62-HKNNUM       =   SPACE                      )
             OR  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91"     )
             OR  (RECE62-HKNNUM  =   "068" OR "069" OR "040" OR "039")
             OR  (RECE62-AGE          <    70                        )
      ***    OR  (RECE62-AGE          >    74                        )
             OR  (RECE62-YOBIETC(8)   =     1                        )
               CONTINUE
             ELSE
               IF  RECE62-HOJOKBN     =   "1"  OR  "9"
                  MOVE      1     TO    FLG-ZENKI-TOKUREI
               END-IF
             END-IF
           END-IF
      *
           PERFORM         2104D-TOKU75-HANTEI-SEC
      *
           PERFORM         21041-KOREISYA-KOHI-SEC
           PERFORM         2104C-ZENKOKUKOHI-NISYU-CHECK-SEC
           IF  ( RECE62-KOUREI    =    "1"  OR  "2"    )
           OR  ( FLG-TOKU75       =     1  OR  2  OR 3 )
              PERFORM      21042-KOREISYA-CHECK-SEC
           END-IF
      *
           PERFORM         2104B-TOKUTEISIKKAN-CHECK-SEC
      *
           INITIALIZE                   TBL-HKNFTNDATA
           IF   RECE62-SRYYM    >=  "200804"
      *
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
                IF  (RECE62-KOHNUM(IDY2)  =
                     "015" OR "016" OR "024" OR "079" OR "038" OR
                     "051" OR "052" OR "011" OR "020")
                OR  ((WRK-PREFNUM         =  "13" ) AND
                     (RECE62-KOHNUM(IDY2) =  "151")  )
                OR  ((WRK-PREFNUM         =  "23" ) AND
                     (RECE62-KOHNUM(IDY2) =  "191") AND
                     (RECE62-SRYYM    >=  "200910")  )
                     PERFORM  2104F-JGNCHK-HENSYU-SEC
                END-IF
             END-PERFORM
      *
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
                IF  TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO
                   IF  TBL-HKNFTNDATA-JGN(IDY2)   >
                               TBL-HKNFTNDATA-TAF(IDY2)
                       COMPUTE  TBL-HKNFTNDATA-ZAN(IDY2) =
                                TBL-HKNFTNDATA-JGN(IDY2) -
                                TBL-HKNFTNDATA-TAF(IDY2)
                   ELSE
                       MOVE  ZERO  TO  TBL-HKNFTNDATA-ZAN(IDY2)
                   END-IF
                   IF  TBL-HKNFTNDATA-ZAN(IDY2)   NOT =  ZERO
                     IF  TBL-HKNFTNDATA-ZAN(IDY2) >
                               TBL-HKNFTNDATA-GAIRAI(IDY2)
                       COMPUTE  TBL-HKNFTNDATA-ZAN(IDY2) =
                                TBL-HKNFTNDATA-ZAN(IDY2) -
                                TBL-HKNFTNDATA-GAIRAI(IDY2)
                     ELSE
                       MOVE  ZERO  TO  TBL-HKNFTNDATA-ZAN(IDY2)
                     END-IF
                     IF  TBL-HKNFTNDATA-ZAN(IDY2) NOT =  ZERO
                       PERFORM  2104G-JGNCHK-HENSYU2-SEC
                       IF  TBL-HKNFTNDATA-ZAN(IDY2)  >
                               TBL-HKNFTNDATA-NYUIN(IDY2)
                         COMPUTE  WRK-HKNFTNDATA-RUI          =
                                  TBL-HKNFTNDATA-TAF(IDY2)    +
                                  TBL-HKNFTNDATA-GAIRAI(IDY2) +
                                  TBL-HKNFTNDATA-NYUSKJ(IDY2)
                         IF   TBL-HKNFTNDATA-JGN(IDY2) =
                                              WRK-HKNFTNDATA-RUI
                           MOVE 1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                         END-IF
                       ELSE
                         MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                       END-IF
                     ELSE
                         MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                     END-IF
                   ELSE
                         MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                   END-IF
                   IF   TBL-HKNFTNDATA-FLG(IDY2) = 1
                     IF  ((RECE62-KOHNUM(IDY2)      =  "051"   ) AND
                          (TBL-DOTANDOKU-FLG(IDY2)  =   1      ))
                     OR  ((WRK-PREFNUM              =  "13"    ) AND
                          (RECE62-KOHNUM(IDY2)      =  "151"   ) AND
                          (RECE62-SRYYM             <  "200905"))
                         MOVE   2    TO  TBL-HKNFTNDATA-FLG(IDY2)
                     END-IF
                   END-IF
                   DISPLAY "IDX KOHNUM=" IDY2
                           " "    RECE62-KOHNUM(IDY2)
                   DISPLAY "JGN=" TBL-HKNFTNDATA-JGN(IDY2)
                   DISPLAY "TAF=" TBL-HKNFTNDATA-TAF(IDY2)
                   DISPLAY "GAI=" TBL-HKNFTNDATA-GAIRAI(IDY2)
                   DISPLAY "NYU=" TBL-HKNFTNDATA-NYUIN(IDY2)
                   DISPLAY "SKJ=" TBL-HKNFTNDATA-NYUSKJ(IDY2)
                   DISPLAY "ZAN=" TBL-HKNFTNDATA-ZAN(IDY2)
                   DISPLAY "FLG=" TBL-HKNFTNDATA-FLG(IDY2)
                END-IF
             END-PERFORM
      *
           END-IF
      *
           MOVE    ZERO                 TO      FLG-NYUINRYO
           MOVE    ZERO                 TO      FLG-HOKENICHIBU
           MOVE    ZERO                 TO      FLG-HOKENICHIBU-SYU
           MOVE    ZERO                 TO      FLG-HOKENICHIBU2
           MOVE    ZERO                 TO      FLG-HOKENICHIBU3
           MOVE    ZERO                 TO      FLG-HOKENICHIBU4
           MOVE    ZERO                 TO      FLG-HOKENICHIBU5
           MOVE    ZERO                 TO      FLG-HOKENICHIBU6
           MOVE    ZERO                 TO      WRK-HOKENICHIBUGAK
      *
           MOVE    ZERO                 TO      FLG-JIRITU-CYUKANSOU1
           MOVE    ZERO                 TO      FLG-JIRITU-CYUKANSOU2
           MOVE    ZERO                 TO      WRK-JIRITU-SAIKEI
           MOVE    ZERO                 TO      WRK-JIRITU-SAIKEI2
      *
           INITIALIZE                           WRK-TOKUSYU-SKJFLG-T
      *
           INITIALIZE                           WRK-SKJ-FTN-T
      *
           INITIALIZE                           WRK-KOGAKU-TAISYOGAI-T
      *
           INITIALIZE                           SYUNOU-REC
           MOVE    RECE62-HOSPNUM       TO      SYU-HOSPNUM
           MOVE    RECE62-NYUGAIKBN     TO      SYU-NYUGAIKBN
           MOVE    RECE62-PTID          TO      SYU-PTID
      ***  MOVE    RECE62-SRYKA(IDX)    TO      SYU-SRYKA
           MOVE    RECE62-SRYYM         TO      SYU-SRYYMD(1:6)
           MOVE    "__"                 TO      SYU-SRYYMD(7:2)
           MOVE    SYUNOU-REC           TO      MCPDATA-REC
           MOVE    "tbl_syunou"         TO      MCP-TABLE
           MOVE    "key17"              TO      MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_syunou"     TO      MCP-TABLE
               MOVE    "key17"          TO      MCP-PATHNAME
               PERFORM  900-SYUNOU-READ-SEC
               PERFORM  UNTIL
                  (FLG-SYUNOU             =    1)
                   PERFORM VARYING IDX1    FROM    1   BY  1
                           UNTIL   IDX1    >       10
                           OR      RECE62-HKNCOMBI (IDX1)   =   ZERO 
                       IF      SYU-HKNCOMBINUM   =
                                                RECE62-HKNCOMBI (IDX1)
                           IF  SYU-DENPJTIKBN    NOT =  "3"
                               PERFORM   21044-RECE62-FTN-HENSYU-SEC
                               MOVE   1   TO   FLG-SYUNOU-ARI
                           END-IF
                           MOVE    10              TO  IDX1
                       END-IF
                   END-PERFORM          
                   MOVE    "tbl_syunou"     TO   MCP-TABLE
                   MOVE    "key17"          TO   MCP-PATHNAME
                   PERFORM   900-SYUNOU-READ-SEC
               END-PERFORM
           ELSE
               DISPLAY   "SYUNOU SELECT ERR" 
           END-IF
      *
           MOVE    "tbl_syunou"         TO      MCP-TABLE
           MOVE    "key17"              TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           PERFORM         2104H-WRKFILE-CLEAR-SEC
      *
      *    一部負担金再掲の計算処理
      *
           PERFORM         21046-SAIKEI-KEISAN-SEC
      *
      *    食事負担含む上限額のある公費の一部負担金額編集等
      *
           PERFORM         21045-KOH-FUTAN-SET-SEC
      *
      *    食事略称編集
      *
           IF   RECE62-SRYYM  >= "200604"
           AND  RECE62-SRYYM  <  "200610"
                PERFORM    21047-SKJ-RAYKU-HENSYU-SEC
           END-IF
      *
           IF   FLG-SYUNOU-ARI  =  ZERO
              DISPLAY "<SYUNOU NG STOP>"
              MOVE    "仮収納データがありません"  TO  ERR-ERRMSG
              PERFORM 600-ERRMSG-EDIT-SEC
              MOVE    ERR-HEN-ERRMSG    TO  WRK-RECEERR
              PERFORM 500-ERR-HENSYU-SEC
              MOVE    1                 TO  FLG-RECE62
           END-IF
      *
           .
       2104-FTN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集
      *****************************************************************
       2104F-JGNCHK-HENSYU-SEC      SECTION.
      *
           INITIALIZE                      LNK-ORCSJGNGET-REC
           MOVE   RECE62-HOSPNUM       TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE   RECE62-NYUGAIKBN     TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE   RECE62-PTID          TO  LNK-ORCSJGNGET-PTID
           MOVE   RECE62-KOHNUM(IDY2)  TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE   RECE62-KOHID(IDY2)   TO  LNK-ORCSJGNGET-KOHID
           MOVE   RECE62-SRYYM         TO  LNK-ORCSJGNGET-SRYYM
           MOVE   RECE62-SRYYM         TO  LNK-ORCSJGNGET-SKYEDYMD(1:6)
           MOVE   "31"                 TO  LNK-ORCSJGNGET-SKYEDYMD(7:2)
           CALL    "ORCSJGNGET"        USING
                                       LNK-ORCSJGNGET-REC
                                       SPA-AREA
           IF     LNK-ORCSJGNGET-RC    =   ZERO
              IF    (RECE62-KOHNUM(IDY2) = "015" OR "016"        )
              AND   (LNK-ORCSJGNGET-NYUJGNGAK = 9999999 OR 999999)
                MOVE    ZERO           TO  TBL-HKNFTNDATA-JGN(IDY2)
              ELSE
                MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                       TO  TBL-HKNFTNDATA-JGN(IDY2)
                IF   RECE62-KOHNUM(IDY2) = "015" OR "016" OR "038"
                  MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO  TBL-HKNFTNDATA-TAF(IDY2)
                END-IF
              END-IF
              MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                       TO  TBL-HKNFTNDATA-JGNXXX(IDY2)
           END-IF
      *
           IF   TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO
              INITIALIZE                      ORCSFTNJGNCHKAREA
              MOVE    RECE62-HOSPNUM      TO  LNK-FTNJGNCHK-HOSPNUM
              MOVE    RECE62-PTID         TO  LNK-FTNJGNCHK-PTID
              MOVE    "1"                 TO  LNK-FTNJGNCHK-NYUGAIKBN
              MOVE    RECE62-SRYYM        TO  LNK-FTNJGNCHK-SRYYM
              MOVE    RECE62-KOHNUM(IDY2) TO  LNK-FTNJGNCHK-KOHNUM
              MOVE    RECE62-KOHID(IDY2)  TO  LNK-FTNJGNCHK-KOHID
              MOVE    WRK-PREFNUM         TO  LNK-FTNJGNCHK-PREFNUM
              MOVE    ZERO                TO  LNK-FTNJGNCHK-HKNCOMBINUM
              MOVE    ZERO                TO  LNK-FTNJGNCHK-HKNID
              CALL    "ORCSFTNJGNCHK"     USING
                                          ORCSFTNJGNCHKAREA
                                          SPA-AREA
              MOVE    LNK-FTNJGNCHK-KOHFTN
                                   TO  TBL-HKNFTNDATA-NYUIN(IDY2)
              MOVE    LNK-FTNJGNCHK-KOHFTNSKJ
                                   TO  TBL-HKNFTNDATA-NYUSKJ(IDY2)
      *
              IF  RECE62-KOHNUM(IDY2)  =
                       "015" OR "016" OR "024" OR "079" OR "038"
                INITIALIZE                      ORCSFTNJGNCHKAREA
                MOVE  RECE62-HOSPNUM      TO  LNK-FTNJGNCHK-HOSPNUM
                MOVE  RECE62-PTID         TO  LNK-FTNJGNCHK-PTID
                MOVE  "2"                 TO  LNK-FTNJGNCHK-NYUGAIKBN
                MOVE  RECE62-SRYYM        TO  LNK-FTNJGNCHK-SRYYM
                MOVE  RECE62-KOHNUM(IDY2) TO  LNK-FTNJGNCHK-KOHNUM
                MOVE  RECE62-KOHID(IDY2)  TO  LNK-FTNJGNCHK-KOHID
                MOVE  WRK-PREFNUM         TO  LNK-FTNJGNCHK-PREFNUM
                MOVE  ZERO                TO  LNK-FTNJGNCHK-HKNCOMBINUM
                MOVE  ZERO                TO  LNK-FTNJGNCHK-HKNID
                CALL  "ORCSFTNJGNCHK"     USING
                                          ORCSFTNJGNCHKAREA
                                          SPA-AREA
                MOVE    LNK-FTNJGNCHK-KOHFTN
                                   TO  TBL-HKNFTNDATA-GAIRAI(IDY2)
              END-IF
           END-IF
      *
           .
       2104F-JGNCHK-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（上限置き換え金額編集）
      *****************************************************************
       2104G1-JGNGAK-SET-SEC      SECTION.
      *
           MOVE   44400     TO  WRK-KOH-GENDOGAKU
           IF   RECE62-TEISYOTOKU  NOT =  SPACE
              EVALUATE   RECE62-TEISYOTOKU
                WHEN  "1"
                WHEN  "4"
                   MOVE  15000  TO  WRK-KOH-GENDOGAKU
                WHEN  "2"
                WHEN  "3"
                   MOVE  24600  TO  WRK-KOH-GENDOGAKU
              END-EVALUATE
           END-IF
           IF   ( RECE62-KOHNUM(1)  =   "972" )
           OR   ( RECE62-KOHNUM(2)  =   "972" )
           OR   ( RECE62-KOHNUM(3)  =   "972" )
           OR   ( RECE62-KOHNUM(4)  =   "972" )
              IF   WRK-KOH-GENDOGAKU  >  10000
                  MOVE   10000    TO   WRK-KOH-GENDOGAKU
              END-IF
           END-IF
           IF   ( RECE62-KOHNUM(1)  =   "974" )
           OR   ( RECE62-KOHNUM(2)  =   "974" )
           OR   ( RECE62-KOHNUM(3)  =   "974" )
           OR   ( RECE62-KOHNUM(4)  =   "974" )
              IF   WRK-KOH-GENDOGAKU  >  20000
                  MOVE   20000    TO   WRK-KOH-GENDOGAKU
              END-IF
           END-IF
      *
           MOVE      ZERO         TO   WRK-GEN70-GENDOGAKU
           IF     FLG-GENBUTU70   NOT =  ZERO
              EVALUATE   FLG-GENBUTU70
                WHEN        1
                WHEN        2
                  MOVE     80100  TO   WRK-GEN70-GENDOGAKU
                  IF   TBL-TOKUSITUFLG(IDX10) = 1
                    IF  FLG-TOKUSITU-TASU = 1
                       MOVE  44400  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  ELSE
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  44400  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
                WHEN        3
                  MOVE     35400  TO   WRK-GEN70-GENDOGAKU
                  IF   TBL-TOKUSITUFLG(IDX10) = 1
                    IF  FLG-TOKUSITU-TASU = 1
                       MOVE  24600  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  ELSE
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  24600  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
              END-EVALUATE
              IF   ( RECE62-KOHNUM(1)  =   "972" )
              OR   ( RECE62-KOHNUM(2)  =   "972" )
              OR   ( RECE62-KOHNUM(3)  =   "972" )
              OR   ( RECE62-KOHNUM(4)  =   "972" )
                 IF   WRK-GEN70-GENDOGAKU  >  10000
                     MOVE  10000  TO   WRK-GEN70-GENDOGAKU
                 END-IF
              END-IF
              IF   ( RECE62-KOHNUM(1)  =   "974" )
              OR   ( RECE62-KOHNUM(2)  =   "974" )
              OR   ( RECE62-KOHNUM(3)  =   "974" )
              OR   ( RECE62-KOHNUM(4)  =   "974" )
                 IF   WRK-GEN70-GENDOGAKU  >  20000
                     MOVE  20000  TO   WRK-GEN70-GENDOGAKU
                 END-IF
              END-IF
           END-IF
      *
           MOVE      15000        TO   WRK-SEIHO-GENDO
           IF  FLG-KOHYONKAIME = 1
              MOVE   24600        TO   WRK-SEIHO-GENDO70
           ELSE
              MOVE   35400        TO   WRK-SEIHO-GENDO70
           END-IF
           MOVE      10000        TO   WRK-CYOKI-GENDO
           MOVE      20000        TO   WRK-CYOKI-GENDO2
      *
           IF   FLG-GENGAKU-OKIKAE  =  1
             IF  FLG-TOKU75 = 1 OR 2 OR 3
               COMPUTE  WRK-KOH-GENDOGAKU   = WRK-KOH-GENDOGAKU
                                            / 2
               COMPUTE  WRK-GEN70-GENDOGAKU = WRK-GEN70-GENDOGAKU
                                            / 2
               COMPUTE  WRK-SEIHO-GENDO     = WRK-SEIHO-GENDO
                                            / 2
               COMPUTE  WRK-SEIHO-GENDO70   = WRK-SEIHO-GENDO70
                                            / 2
               COMPUTE  WRK-CYOKI-GENDO     = WRK-CYOKI-GENDO
                                            / 2
               COMPUTE  WRK-CYOKI-GENDO2    = WRK-CYOKI-GENDO2
                                            / 2
             END-IF
           END-IF
      *
           .
       2104G1-JGNGAK-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集２
      *****************************************************************
       2104G-JGNCHK-HENSYU2-SEC      SECTION.
      *
           MOVE      ZERO    TO     FLG-GENGAKU-OKIKAE
           MOVE      IDY2    TO     IDX10
           PERFORM   2104G1-JGNGAK-SET-SEC
      *
           IF  (RECE62-KOUREI    =   "1")
           OR  (FLG-KOUREI-KBN   =    1 )
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-KOH-GENDOGAKU
                 MOVE WRK-KOH-GENDOGAKU   TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
           IF  FLG-GENBUTU70   NOT =   ZERO
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-GEN70-GENDOGAKU
                 MOVE WRK-GEN70-GENDOGAKU TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
           IF   (RECE62-KOHNUM(1) = "972")
           OR   (RECE62-KOHNUM(2) = "972")
           OR   (RECE62-KOHNUM(3) = "972")
           OR   (RECE62-KOHNUM(4) = "972")
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-CYOKI-GENDO
                 MOVE WRK-CYOKI-GENDO     TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
           IF   (RECE62-KOHNUM(1) = "974")
           OR   (RECE62-KOHNUM(2) = "974")
           OR   (RECE62-KOHNUM(3) = "974")
           OR   (RECE62-KOHNUM(4) = "974")
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-CYOKI-GENDO2
                 MOVE WRK-CYOKI-GENDO2    TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
      *
           .
       2104G-JGNCHK-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者の保険組合せに全国公費を含むかチェック
      *****************************************************************
       21041-KOREISYA-KOHI-SEC               SECTION.
      *
           MOVE      ZERO        TO     FLG-ZENKOH-ARI
           PERFORM   VARYING  IDX1    FROM    1   BY  1
                      UNTIL   IDX1    >       10
                       OR     RECE62-HKNCOMBI (IDX1)  =   ZERO
                    IF      RECE62-HKNCOMBIFLG (IDX1)  =  1 OR 2
                       MOVE     1        TO     FLG-ZENKOH-ARI
                       MOVE    10        TO     IDX1
                    END-IF
           END-PERFORM
      *
           MOVE      ZERO        TO     FLG-DOTANDOKU-IGAI
                                        FLG-DOTANDOKU
           IF   ( WRK-PREFNUM         =  "01"     )
           AND  ( RECE62-SRYYM       >=  "200510" )
           AND  ( RECE62-SRYYM       <   "200810" )
             PERFORM   VARYING  IDX1    FROM    1   BY  1
                        UNTIL   IDX1      >     4
               IF RECE62-KOHNUM(IDX1)(1:1) =  "0" OR "9"
                  IF  ( RECE62-KOHNUM(IDX1) =  "051"         )
                  AND ((RECE62-KOHJKYSNUM(IDX1)(1:2) >= "91"
                                                 AND <= "95") OR
                       (RECE62-KOHJKYSNUM(IDX1)(1:2) >= "71"
                                                 AND <= "88"))
                     MOVE    1     TO    FLG-DOTANDOKU
                  ELSE
                     MOVE    1     TO    FLG-DOTANDOKU-IGAI
                  END-IF
               END-IF
             END-PERFORM
             IF   (FLG-DOTANDOKU-IGAI   =   ZERO)
             AND  (FLG-DOTANDOKU        =    1  )
             AND  (FLG-ZENKOH-ARI       =    1  )
                     MOVE   ZERO   TO    FLG-ZENKOH-ARI
             END-IF
           END-IF
      *
           IF   FLG-ZENKOH-ARI  =  ZERO
             IF (TBL-TOKATUKAIFLG(1)  =  1)
             OR (TBL-TOKATUKAIFLG(2)  =  1)
             OR (TBL-TOKATUKAIFLG(3)  =  1)
             OR (TBL-TOKATUKAIFLG(4)  =  1)
                     MOVE     1    TO    FLG-ZENKOH-ARI
             END-IF
           END-IF
      *
           MOVE      ZERO        TO     FLG-TAISYO
           PERFORM   VARYING  IDX1    FROM    1   BY  1
                      UNTIL   IDX1    >       10
                       OR     RECE62-HKNCOMBI (IDX1)  =   ZERO
                 IF      RECE62-HKNCOMBIFLG (IDX1)  =  2
                     IF   FLG-TAISYO  =  ZERO
                        MOVE   1     TO   FLG-TAISYO
                     END-IF
                 ELSE
                     MOVE      9     TO   FLG-TAISYO
                 END-IF
           END-PERFORM
      *
           .
       21041-KOREISYA-KOHI-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者の一部負担金額記載に関するチェック
      *****************************************************************
       21042-KOREISYA-CHECK-SEC               SECTION.
      *
           MOVE    SPACE               TO  WRK-CHK-HKNJANUM
                                           WRK-CHK-HKNNUM
                                           WRK-CHK-HONKZKKBN
           MOVE    ZERO                TO  WRK-CHK-IDOU
                                           WRK-CHK-TAISYO
                                           WRK-CHK-HKNID
                                           WRK-CHK-CNT
                                           WRK-CHK-TAISYO2
                                           WRK-CHK-TOKU75-MAE
                                           FLG-TOKU75-XXX
      *
           INITIALIZE                      RECE69-REC
           MOVE    RECE62-HOSPNUM      TO  RECE69-HOSPNUM
           MOVE    RECE62-SRYYM        TO  RECE69-SRYYM
           MOVE    RECE62-NYUGAIKBN    TO  RECE69-NYUGAIKBN
           MOVE    RECE62-PTID         TO  RECE69-PTID
           MOVE    RECE62-RECEKA       TO  RECE69-RECEKA
      *
           START   RECE69-FILE
               KEY IS    >=   RECE69-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE69
               NOT INVALID
                   PERFORM 900-RECE69-NEXT-SEC
           END-START
           PERFORM UNTIL ( FLG-RECE69           =   1                )
                   OR    ( RECE62-HOSPNUM   NOT =   RECE69-HOSPNUM   )
                   OR    ( RECE62-SRYYM     NOT =   RECE69-SRYYM     )
                   OR    ( RECE62-NYUGAIKBN NOT =   RECE69-NYUGAIKBN )
                   OR    ( RECE62-PTID      NOT =   RECE69-PTID      )
                   OR    ( RECE62-RECEKA    NOT =   RECE69-RECEKA    )
      *
               EVALUATE    RECE69-TEISYUTUSAKI
                   WHEN    "1"
                     EVALUATE    WRK-CHK-IDOU
                       WHEN    ZERO
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE69-HKNJANUM  NOT =  SPACE
                            MOVE    1             TO  WRK-CHK-IDOU
                            MOVE  RECE69-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE69-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE69-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE69-HKNNUM   TO  WRK-CHK-HKNNUM
                            IF  (FLG-TOKU75  =  2 OR 3                 )
                            AND (RECE69-TEKSTYMDX < WRK-TOKU75-BIRTHDAY)
                                 MOVE     1    TO    WRK-CHK-TOKU75-MAE
                            END-IF
                         END-IF
                       WHEN     1
                         ADD     1                TO  WRK-CHK-CNT
                         IF   (RECE62-KOUREI    =   "1")
                         OR   (FLG-TOKU75    =  1 OR 2 )
                          IF  (RECE69-HKNJANUM  NOT = SPACE        ) AND
                              (RECE69-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE69-HKNJANUM  NOT = SPACE         )
                          AND (RECE69-HKNJANUM  =  WRK-CHK-HKNJANUM )
                              IF  (FLG-TOKU75   = 2                  )
                              AND (RECE69-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    1      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         ELSE
                          IF ((RECE69-HKNJANUM  NOT = SPACE        ) AND
                              (RECE69-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM ))
                          OR ( RECE69-HONKZKKBN NOT =
                                                  WRK-CHK-HONKZKKBN )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE69-HKNJANUM  NOT = SPACE         )
                          AND (RECE69-HKNJANUM  =  WRK-CHK-HKNJANUM )
                          AND (RECE69-HONKZKKBN =  WRK-CHK-HONKZKKBN)
                              IF  (FLG-TOKU75   = 3                  )
                              AND (RECE69-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    2      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         END-IF
                       WHEN     2
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                       WHEN     6
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                     END-EVALUATE
                   WHEN    "2"
                     EVALUATE    WRK-CHK-IDOU
                       WHEN    ZERO
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE69-HKNJANUM  NOT =  SPACE
                            MOVE    2             TO  WRK-CHK-IDOU
                            MOVE  RECE69-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE69-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE69-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE69-HKNNUM   TO  WRK-CHK-HKNNUM
                            IF  (FLG-TOKU75  =  2 OR 3                 )
                            AND (RECE69-TEKSTYMDX < WRK-TOKU75-BIRTHDAY)
                                 MOVE     1    TO    WRK-CHK-TOKU75-MAE
                            END-IF
                         END-IF
                       WHEN     1
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                       WHEN     2
                         ADD     1                TO  WRK-CHK-CNT
                         IF   (RECE62-HKNNUM  = "060"  )
                         OR   (RECE62-KOUREI  = "1"    )
                         OR   (FLG-TOKU75     =  1 OR 2)
                          IF  (RECE69-HKNJANUM  NOT = SPACE        ) AND
                              (RECE69-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE69-HKNJANUM  NOT = SPACE         )
                          AND (RECE69-HKNJANUM  =  WRK-CHK-HKNJANUM )
                              IF  (FLG-TOKU75   = 2                  )
                              AND (RECE69-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    1      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         ELSE
                          IF ((RECE69-HKNJANUM  NOT = SPACE        ) AND
                              (RECE69-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM ))
                          OR ( RECE69-HONKZKKBN NOT =
                                                  WRK-CHK-HONKZKKBN )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE69-HKNJANUM  NOT = SPACE         )
                          AND (RECE69-HKNJANUM  =  WRK-CHK-HKNJANUM )
                          AND (RECE69-HONKZKKBN =  WRK-CHK-HONKZKKBN)
                              IF  (FLG-TOKU75   = 3                  )
                              AND (RECE69-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    2      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         END-IF
                       WHEN     6
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                     END-EVALUATE
                   WHEN    "6"
                     EVALUATE    WRK-CHK-IDOU
                       WHEN    ZERO
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE69-HKNJANUM  NOT =  SPACE
                            MOVE    6             TO  WRK-CHK-IDOU
                            MOVE  RECE69-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE69-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE69-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE69-HKNNUM   TO  WRK-CHK-HKNNUM
                         END-IF
                       WHEN     1
                       WHEN     2
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE62-HKNNUM  =  "039"
                          IF  FLG-TOKU75     =   ZERO
                            IF    FLG-TAISYO   =    1
                                MOVE    1         TO  WRK-CHK-TAISYO
                            END-IF
                          ELSE
                            MOVE    1             TO  WRK-CHK-CNT
                            MOVE    6             TO  WRK-CHK-IDOU
                            MOVE  RECE69-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE69-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE69-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE69-HKNNUM   TO  WRK-CHK-HKNNUM
                            MOVE   ZERO           TO  WRK-CHK-TAISYO
                          END-IF
                         END-IF
                       WHEN     6
                         ADD     1                TO  WRK-CHK-CNT
                         IF  (RECE69-HKNJANUM  NOT = SPACE        ) AND
                             (RECE69-HKNJANUM  NOT =
                                                 WRK-CHK-HKNJANUM )
                             MOVE    1            TO  WRK-CHK-TAISYO
                         END-IF
                     END-EVALUATE
               END-EVALUATE
      *
               PERFORM 900-RECE69-NEXT-SEC
           END-PERFORM
      *
           IF   (RECE62-HKNNUM    NOT = "039")
           AND  (FLG-TOKU75       =  2 OR 3  )
           AND  (WRK-CHK-TAISYO2  NOT =  ZERO)
           AND  (WRK-CHK-CNT      =  2       )
              EVALUATE  WRK-CHK-TAISYO2
                WHEN      1
                  IF  (RECE62-HKNJANUM  NOT = SPACE        )
                  AND (RECE62-HKNJANUM  = WRK-CHK-HKNJANUM )
                    MOVE      1     TO    FLG-TOKU75-XXX
                  END-IF
                WHEN      2
                  IF  (RECE62-HKNJANUM  NOT = SPACE        )
                  AND (RECE62-HKNJANUM  = WRK-CHK-HKNJANUM )
                  AND (RECE62-HONKZKKBN = WRK-CHK-HONKZKKBN)
                    MOVE      1     TO    FLG-TOKU75-XXX
                  END-IF
              END-EVALUATE
           END-IF
      *
           IF    RECE62-SRYYM       >=  "200804"
             IF  ((RECE62-KOUREI       =   "1"         ) AND
                  (RECE62-HKNNUM       =   "039"       ) AND
                  (FLG-TAISYO          =    1          ))
             OR  ((RECE62-KOUREI       =   "1"  OR  "2") AND
                  (RECE62-HKNNUM   NOT =   "039"       ) AND
                  (FLG-TAISYO          =    1          ) AND
                  (FLG-TOKU75          =   ZERO        ))
                CONTINUE
             ELSE
                MOVE   ZERO    TO  WRK-CHK-TAISYO
             END-IF
           ELSE
             IF  ( RECE62-KOUREI       =   "1"          )
             OR  ((RECE62-KOUREI       =   "2"         ) AND
                  (FLG-TAISYO          =    1          ))
                CONTINUE
             ELSE
                MOVE   ZERO    TO  WRK-CHK-TAISYO
             END-IF
           END-IF
      *
           IF   WRK-CHK-TAISYO       =  1
           AND  WRK-CHK-CNT          =  2
             IF ((RECE62-HKNJANUM  NOT = SPACE            ) AND
                 (RECE62-HKNJANUM  NOT = WRK-CHK-HKNJANUM ))
             OR ( RECE62-HONKZKKBN NOT = WRK-CHK-HONKZKKBN )
      *
                INITIALIZE                 ORCSKOREIFTNCHKAREA
                MOVE    RECE62-HOSPNUM TO  LNK-KOREIFTNCHK-HOSPNUM
                MOVE    RECE62-PTID    TO  LNK-KOREIFTNCHK-PTID
                MOVE    "1"            TO  LNK-KOREIFTNCHK-NYUGAIKBN
                MOVE    RECE62-SRYYM   TO  LNK-KOREIFTNCHK-SRYYM
                MOVE    WRK-CHK-HKNNUM TO  LNK-KOREIFTNCHK-HKNNUM
                MOVE    WRK-CHK-HKNID  TO  LNK-KOREIFTNCHK-HKNID
                MOVE    RECE62-TEISYOTOKU
                                       TO  LNK-KOREIFTNCHK-TEISYOTOKU
                MOVE    SPACE          TO  LNK-KOREIFTNCHK-RECEKA
                MOVE    RECE62-RJNGENMENKBN
                                       TO  LNK-KOREIFTNCHK-KEIKASOCHI
                MOVE    WK-GENGAKUKBN  TO  LNK-KOREIFTNCHK-GENGAKUKBN
                MOVE    WK-GENGAKU-RITU
                                       TO  LNK-KOREIFTNCHK-GENGAKU-RITU
                MOVE    WK-GENGAKU-KIN TO  LNK-KOREIFTNCHK-GENGAKU-KIN
                MOVE    FLG-KOHYONKAIME
                                       TO  LNK-KOREIFTNCHK-KOHYONKAIME
                MOVE    RECE62-KOUREI  TO  LNK-KOREIFTNCHK-NENREIKBN
                MOVE    RECE62-AGE     TO  LNK-KOREIFTNCHK-AGE
                MOVE    WRK-PREFNUM    TO  LNK-KOREIFTNCHK-PREFNUM
                MOVE    RECE62-SYUGAKUKBN
                                       TO  LNK-KOREIFTNCHK-SYUGAKUKBN
                MOVE    RECE62-KOHID(1)
                                       TO  LNK-KOREIFTNCHK-KOHID-CYOKI
                MOVE    FLG-TOKU75     TO  LNK-KOREIFTNCHK-TOKU75
                IF      RECE62-SRYYM   >=  "200804"
                     MOVE      1       TO  LNK-KOREIFTNCHK-CYOKINOMI
                ELSE
                  IF   (RECE62-KOUREI   =   "2")
                  AND  (FLG-TAISYO      =    1 )
                     MOVE      1       TO  LNK-KOREIFTNCHK-CYOKINOMI
                  END-IF
                END-IF
      *
                CALL    "ORCSKOREIFTNCHK"   USING
                                            ORCSKOREIFTNCHKAREA
                                            SPA-AREA
                IF      LNK-KOREIFTNCHK-RC   =   ZERO
                    MOVE   LNK-KOREIFTNCHK-FTNGAKU
                                       TO  WRK-CHK-FTNGAKU
                    MOVE   LNK-KOREIFTNCHK-KOHFTNGAKU
                                       TO  WRK-CHK-KOHFTNGAKU
                    IF  FLG-ZENKOKUKOHI-NISYU = ZERO
                      MOVE   LNK-KOREIFTNCHK-ICHIBUGAKU
                                       TO  FTN-KOH-XXX
                                           WRK-CHK-ICHIBUGAKU
                    END-IF
                    MOVE   LNK-KOREIFTNCHK-CHIHOUGAKU
                                       TO  WRK-CHIHOU-KIN
                END-IF
      *
             END-IF
           END-IF
      *
           IF   FLG-TOKU75-XXX  =  1
              MOVE    ZERO    TO    FLG-TOKU75
           END-IF
      *
           .
       21042-KOREISYA-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送−負担金（Ｆ００２）
      *****************************************************************
       21044-RECE62-FTN-HENSYU-SEC               SECTION.
      *
           IF    SYU-YKZKENNUM  NOT = ZERO
              MOVE    1     TO   FLG-GENMEN-ARI
           ELSE
              MOVE    1     TO   FLG-GENMEN-NASI
              ADD   SYU-HKNTEKMONEY
                            TO   WRK-GENMEN-NASI-KIN
              ADD   SYU-KOH-FTN
                            TO   WRK-GENMEN-NASI-KIN
              ADD   SYU-SKYMONEY-SKJ
                            TO   WRK-GENMEN-NASI-SKJ
              ADD   SYU-SKYMONEY-LIFE
                            TO   WRK-GENMEN-NASI-SKJ
           END-IF
      *
           IF   (FLG-SAIGAI-TAISYO  =  1    )
           AND  (RECE62-HKNNUM      =  SPACE)
              PERFORM    VARYING   IDX-SAI    FROM   1   BY   1
                          UNTIL    IDX-SAI      >   31
                IF   SYU-DAY(IDX-SAI)   =   "1"  OR  "2"  OR  "9"
                    IF   IDX-SAI  <  WRK-SAIGAI-DD
                       MOVE    1     TO   FLG-GENMEN-NASI2
                    ELSE
                       MOVE    1     TO   FLG-GENMEN-ARI2
                    END-IF
                END-IF
              END-PERFORM
              ADD   SYU-HKNTEKMONEY
                            TO   WRK-GENMEN-NASI-KIN2
              ADD   SYU-KOH-FTN
                            TO   WRK-GENMEN-NASI-KIN2
              ADD   SYU-SKYMONEY-SKJ
                            TO   WRK-GENMEN-NASI-SKJ2
              ADD   SYU-SKYMONEY-LIFE
                            TO   WRK-GENMEN-NASI-SKJ2
           END-IF
      *
      *    請求額収納編集
           PERFORM   210448-SKY-SYUNOU-HENSYU-SEC
      *
      *    収納より総点数を集計
           ADD       SYU-TOTAL-HKNTEN   TO   RECE62-RJNGAIFTN
      *
           IF   RECE62-NYUINRYOFLG       =   "1"
           AND  FLG-NYUINRYO             =   ZERO
               PERFORM         210441-NYUINRYOFLG-SET-SEC
           END-IF
      *
           PERFORM             210445-SKJ-KINGAKU-HENSYU-SEC
      *
           IF      SYU-SYUSKJ-RYOYOHI  NOT =  ZERO
                   ADD   SYU-SYUSKJ-NISSU     TO  
                                       RECE62-SHOKUJINISSU(1)
                   ADD   SYU-SYUSKJ-RYOYOHI   TO
                                       RECE62-SHOKUJIRYOYOHI(1)
                   ADD   SYU-SYUSKJ-FTN-RECE  TO
                                       RECE62-SHOKUJIFTN(1)
                   IF    RECE62-SRYYM      >=  "200604"
                     ADD SYU-SYUSKJ-RYOYOHI   TO
                                       RECE62-HENSHOKUJIRYOYOHI(1)
                   END-IF
           END-IF
           IF      RECE62-RJNHKNNUM    NOT =  SPACE
             IF      SYU-SKJ-RYOYOHI(1)  NOT =  ZERO
                   ADD   SYU-SKJ-NISSU(1)     TO  
                                       RECE62-SHOKUJINISSU(1)
                   ADD   SYU-SKJ-RYOYOHI(1)   TO
                                       RECE62-SHOKUJIRYOYOHI(1)
                   ADD   SYU-SKJ-FTN-RECE(1)  TO
                                       RECE62-SHOKUJIFTN(1)
                   IF    RECE62-SRYYM      >=  "200604"
                     ADD SYU-SKJ-RYOYOHI(1)   TO
                                       RECE62-HENSHOKUJIRYOYOHI(1)
                   END-IF
             END-IF
           END-IF
      *
           IF      RECE62-SRYYM      >=  "200210"
             IF    RECE62-KOUREI   =   "1" OR "2"
               IF  SYU-SYUHKNNUM  NOT = SPACE
                EVALUATE  RECE62-KOUREI
                  WHEN      "1"
                    PERFORM     210442-HOKEN-FUTAN-HENSYU-SEC
                  WHEN      "2"
                    PERFORM     210447-HOKEN-FUTAN-HENSYU2-SEC
                END-EVALUATE
               END-IF
             ELSE                                                       
      *         船員保険（被保険者）＋通勤災害
                IF    RECE62-SENIN-TUUSAI     =    "1"
                   ADD    SYU-SYUCOMPFTN   TO   RECE62-FTNMONEY(1)
                END-IF
                IF  (IDZ                 =     1    )
                AND (RECE62-SRYYM       >=  "201004")
                AND (SYU-SYUHKNNUM   NOT =   SPACE  )
                  IF    RECE62-SENIN-TUUSAI     =    "1"
                    CONTINUE
                  ELSE
                    MOVE    1    TO   FLG-WRKFILE-CLEAR
                    IF  ((RECE62-AGE         >=   70  ) OR
                         (RECE62-HKNNUM       =  "039"))
                    AND ( RECE62-YOBIETC(8)   =  ZERO  )
                      PERFORM   210442-HOKEN-FUTAN-HENSYU-SEC
                    ELSE
                      PERFORM   210447-HOKEN-FUTAN-HENSYU2-SEC
                    END-IF
                  END-IF
                END-IF
             END-IF
           ELSE
             IF    RECE62-RJNHKNNUM    NOT =    SPACE
                ADD    SYU-KOH1COMPFTN  TO   RECE62-FTNMONEY(1)
             END-IF
      *      船員保険（被保険者）＋通勤災害
             IF    RECE62-SENIN-TUUSAI     =    "1"
                ADD    SYU-SYUCOMPFTN   TO   RECE62-FTNMONEY(1)
             END-IF
           END-IF
      *
           MOVE    IDX1            TO  HC-IDX
      *
           MOVE       ZERO              TO   KH-IDX
           PERFORM    VARYING   IDX2    FROM   1   BY   1
             UNTIL    IDX2      >       4
              IF      RECE62-KOHNUMHC(HC-IDX IDX2)  NOT =  SPACE
                 IF   RECE62-KOHNUMHC(HC-IDX IDX2) =  RECE62-KOHNUM(1)
                 AND  RECE62-KOHIDHC(HC-IDX IDX2)  =  RECE62-KOHID(1)
                      MOVE    2          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE62-KOHNUM(1)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE62-KOHNUM(1)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE62-KOHNUM(1)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE62-KOHNUM(1)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210443-KOHJNISSUTBL-SET-SEC
      *
                      PERFORM   210446-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210444-FTNMONEY-FTN-HENSYU-SEC
                 END-IF
                 IF   RECE62-KOHNUMHC(HC-IDX IDX2) =  RECE62-KOHNUM(2)
                 AND  RECE62-KOHIDHC(HC-IDX IDX2)  =  RECE62-KOHID(2)
                      MOVE    3          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE62-KOHNUM(2)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE62-KOHNUM(2)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE62-KOHNUM(2)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE62-KOHNUM(2)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210443-KOHJNISSUTBL-SET-SEC
      *
                      PERFORM   210446-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210444-FTNMONEY-FTN-HENSYU-SEC
                 END-IF
                 IF   RECE62-KOHNUMHC(HC-IDX IDX2) =  RECE62-KOHNUM(3)
                 AND  RECE62-KOHIDHC(HC-IDX IDX2)  =  RECE62-KOHID(3)
                      MOVE    4          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE62-KOHNUM(3)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE62-KOHNUM(3)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE62-KOHNUM(3)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE62-KOHNUM(3)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210443-KOHJNISSUTBL-SET-SEC
      *
                      PERFORM   210446-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210444-FTNMONEY-FTN-HENSYU-SEC
                 END-IF
                 IF   RECE62-KOHNUMHC(HC-IDX IDX2) =  RECE62-KOHNUM(4)
                 AND  RECE62-KOHIDHC(HC-IDX IDX2)  =  RECE62-KOHID(4)
                      MOVE    5          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE62-KOHNUM(4)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE62-KOHNUM(4)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE62-KOHNUM(4)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE62-KOHNUM(4)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210443-KOHJNISSUTBL-SET-SEC
      *
                      PERFORM   210446-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210444-FTNMONEY-FTN-HENSYU-SEC
                 END-IF
              END-IF
           END-PERFORM
           .
       21044-RECE62-FTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    他保険にて入院料を算定している場合の保険決定
      *****************************************************************
       210441-NYUINRYOFLG-SET-SEC               SECTION.
      *
           MOVE     SPACE    TO    RECE62-NYUINRYOFLG
      *
           PERFORM  VARYING  IDY    FROM    1   BY  1
                            UNTIL   IDY     >       31
      *
             IF      SYU-DAY(IDY)    =    "2"
      *
                IF         WRK-DAY5(IDY)      NOT =  ZERO
                AND        WRK-DAY1(IDY)      NOT =  ZERO
                   PERFORM  2104411-NYUINRYOFLG-HENSYU-SEC
                ELSE
                   IF      WRK-DAY5(IDY)              NOT =  ZERO
                   AND     RECE62-NYUINDAY-KBN(IDY)   NOT =  "1"
                     EVALUATE  SYS-200501-COMMENT-NYUINRYO-KSIKBN
                       WHEN     "0"
                          MOVE   SPACE    TO   RECE62-NYUINRYOFLG
                       WHEN     "1"
                          MOVE    "1"     TO   RECE62-NYUINRYOFLG
                       WHEN     "2"
                          MOVE    "6"     TO   RECE62-NYUINRYOFLG
                          IF  (RECE62-SRYYM      >= "200904")
                          AND (RECE62-KOUREI      = "1"     )
                            MOVE  "1"     TO   RECE62-NYUINRYOFLG
                          END-IF
                       WHEN     "3"
                          PERFORM  2104411-NYUINRYOFLG-HENSYU-SEC
                          IF  (RECE62-SRYYM      >= "200904"         )
                          AND (RECE62-KOUREI      = "1"              )
                          AND (RECE62-NYUINRYOFLG = "2" OR "3" OR "7")
                            MOVE  "1"     TO   RECE62-NYUINRYOFLG
                          END-IF
                     END-EVALUATE
                   END-IF
                   IF      WRK-DAY5(IDY)              NOT =  ZERO
                   AND     RECE62-NYUINDAY-KBN(IDY)       =  "1"
                   AND     RECE62-SRYYM                  >=  "200904"
                          PERFORM  2104411-NYUINRYOFLG-HENSYU-SEC
                   END-IF
                END-IF
                IF  RECE62-HKNNUM(1:2)  =  "98"  OR  "90"  OR "91"
                   MOVE   SPACE   TO     RECE62-NYUINRYOFLG
                END-IF
      *
                MOVE      1       TO     FLG-NYUINRYO
                MOVE     31       TO     IDY
      *
             END-IF
      *
           END-PERFORM
      *
           .
       210441-NYUINRYOFLG-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険編集
      *****************************************************************
       2104411-NYUINRYOFLG-HENSYU-SEC               SECTION.
      *
           INITIALIZE                  HKNCOMBI-REC
           MOVE    RECE62-HOSPNUM  TO  COMB-HOSPNUM
           MOVE    RECE62-PTID     TO  COMB-PTID
           MOVE    WRK-DAY5(IDY)   TO  COMB-HKNCOMBINUM
           MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
           PERFORM 900-HKNCOMBI-INV-SEC
           IF      FLG-HKNCOMBI    =   ZERO
              IF   COMB-HKNNUM(1:2)  =  "98"
              OR   COMB-HKNNUM       =  "971"
              OR   COMB-HKNNUM       =  "973"
              OR   COMB-HKNNUM       =  "975"
                IF   COMB-HKNNUM(1:2)  =  "98"
                   MOVE    "1"   TO   RECE62-NYUINRYOFLG
                END-IF
                IF   COMB-HKNNUM       =  "971"
                   MOVE    "2"   TO   RECE62-NYUINRYOFLG
                END-IF
                IF   COMB-HKNNUM       =  "973"
                   MOVE    "3"   TO   RECE62-NYUINRYOFLG
                END-IF
                IF   COMB-HKNNUM       =  "975"
                   MOVE    "7"   TO   RECE62-NYUINRYOFLG
                END-IF
              ELSE
                   CONTINUE
      ***          MOVE    "6"   TO   RECE62-NYUINRYOFLG
              END-IF
           END-IF
      *
           .
       2104411-NYUINRYOFLG-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険分負担金額編集
      *****************************************************************
       210442-HOKEN-FUTAN-HENSYU-SEC               SECTION.
      *
           MOVE     ZERO    TO   FLG-KEISAN
           MOVE     ZERO    TO   FLG-KEISAN2
           MOVE     ZERO    TO   FLG-KEISAN3
      *
           MOVE     ZERO    TO   FLG-KGKIPNTAI
           MOVE     ZERO    TO   FLG-WRKFILE-KGKTAI
           IF    SYU-KOH-HKNNUM(1)(1:1)  >= "1" AND <= "8"
             IF  ((RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1) ) AND
                  (RECE62-HON-NYUKFTNRATE(1) NOT = 100       ))
             OR  ((RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1) ) AND
                  (RECE62-HON-NYUKFTNRATE(2) NOT = 100       ))
             OR  ((RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1) ) AND
                  (RECE62-HON-NYUKFTNRATE(3) NOT = 100       ))
             OR  ((RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(4) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(4)  = RECE62-KOHIDHC(IDX1 1) ) AND
                  (RECE62-HON-NYUKFTNRATE(4) NOT = 100       ))
                 IF   FLG-WRKFILE-CLEAR  =  ZERO
                     MOVE    1    TO   FLG-KGKIPNTAI
                 END-IF
                 IF   FLG-WRKFILE-CLEAR  =  1
                     MOVE    1    TO   FLG-WRKFILE-KGKTAI
                 END-IF
             END-IF
           END-IF
      *
           COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                               * 10
                               * RECE62-KYURATE
                               / 100
           IF   FLG-WRKFILE-CLEAR   =   ZERO
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
           END-IF
      *
           IF   ( SYU-KOH-FTN         =   ZERO   )                 
           AND  ( SYU-KOH-HKNNUM(1)   =   SPACE OR "027"  )        
           AND  ( SYU-KOH-HKNNUM(2)   =   SPACE  )                 
           AND  ( SYU-KOH-HKNNUM(3)   =   SPACE  )                 
           AND  ( SYU-KOH-HKNNUM(4)   =   SPACE  )                 
             IF   FLG-WRKFILE-CLEAR   =   ZERO
               MOVE    1      TO    FLG-HOKENICHIBU-SYU
               IF    RECE62-RJNHKNNUM    NOT =    SPACE            
                 ADD    SYU-KOH1COMPFTN  TO   RECE62-FTNMONEY(1)   
                                              WRK-KOH-GAI          
                                              WRK-KOH-GAI2
               ELSE                                                
                 ADD    SYU-SYUCOMPFTN   TO   RECE62-FTNMONEY(1)   
                                              WRK-KOH-GAI          
                                              WRK-KOH-GAI2
               END-IF                                              
             END-IF
           ELSE
             MOVE      1      TO    FLG-HOKENICHIBU
             IF   ( SYU-KOH-HKNNUM(1)   =   "012" OR "025" )
             OR   ( SYU-KOH-HKNNUM(2)   =   "012" OR "025" )
             OR   ( SYU-KOH-HKNNUM(3)   =   "012" OR "025" )
             OR   ( SYU-KOH-HKNNUM(4)   =   "012" OR "025" )
               IF   SYU-SYUHKNNUM  NOT = SPACE
                 IF  FLG-TOKU75 = 1 OR 2
                   MOVE    7500      TO   WRK-KINGAKU
                 ELSE
                   MOVE    15000     TO   WRK-KINGAKU
                 END-IF
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
             ELSE
               IF   ( SYU-KOH-HKNNUM(1) =   "972" )
               OR   ( SYU-KOH-HKNNUM(2) =   "972" )
               OR   ( SYU-KOH-HKNNUM(3) =   "972" )
               OR   ( SYU-KOH-HKNNUM(4) =   "972" )
                 IF  ( SYU-KOH-HKNNUM(1)(1:1)  = "0")
                 OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0")
                 OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0")
                 OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0")
                 OR  ((WRK-PREFNUM       = "13"    ) AND
                      (SYU-KOH-HKNNUM(1) = "151"   ) AND
                      (RECE62-SRYYM     >= "200905"))
                 OR  ((WRK-PREFNUM       = "23"    ) AND
                      (SYU-KOH-HKNNUM(1) = "191"   ) AND
                      (RECE62-SRYYM     >= "200910"))
                 OR  ((WRK-PREFNUM       = "42"    ) AND
                      (SYU-KOH-HKNNUM(1) = "186"   ) AND
                      (FLG-ZENKOKUKOHI-NISYU  =  4 ))
                   MOVE     1        TO   FLG-KEISAN-TOK1
                   MOVE     3        TO   FLG-KEISAN
                 ELSE
                   MOVE     1        TO   FLG-KEISAN-TOK2
                   MOVE     4        TO   FLG-KEISAN
                 END-IF
                 MOVE      1         TO   FLG-CYOKI
                 IF  FLG-TOKU75 = 1 OR 2
                   MOVE    5000      TO   WRK-KINGAKU
                 ELSE
                   MOVE    10000     TO   WRK-KINGAKU
                 END-IF
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                 PERFORM   210442B-ICHIBUFTN-NISYU-HEN-SEC
               ELSE
                IF  ( SYU-KOH-HKNNUM(1) =   "974" )
                OR  ( SYU-KOH-HKNNUM(2) =   "974" )
                OR  ( SYU-KOH-HKNNUM(3) =   "974" )
                OR  ( SYU-KOH-HKNNUM(4) =   "974" )
                    IF  ( SYU-KOH-HKNNUM(1)(1:1)  = "0")
                    OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0")
                    OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0")
                    OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0")
                    OR  ((WRK-PREFNUM       = "13"    ) AND
                         (SYU-KOH-HKNNUM(1) = "151"   ) AND
                         (RECE62-SRYYM     >= "200905"))
                    OR  ((WRK-PREFNUM       = "23"    ) AND
                         (SYU-KOH-HKNNUM(1) = "191"   ) AND
                         (RECE62-SRYYM     >= "200910"))
                    OR  ((WRK-PREFNUM       = "42"    ) AND
                         (SYU-KOH-HKNNUM(1) = "186"   ) AND
                         (FLG-ZENKOKUKOHI-NISYU  =  4 ))
                      MOVE     1     TO   FLG-KEISAN-TOK1
                      MOVE     3     TO   FLG-KEISAN
                    ELSE
                      MOVE     1     TO   FLG-KEISAN-TOK2
                      MOVE     4     TO   FLG-KEISAN
                    END-IF
                    MOVE      2      TO   FLG-CYOKI
                    IF  FLG-TOKU75 = 1 OR 2
                      MOVE    10000  TO   WRK-KINGAKU
                    ELSE
                      MOVE    20000  TO   WRK-KINGAKU
                    END-IF
                    PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                    PERFORM   210442B-ICHIBUFTN-NISYU-HEN-SEC
                ELSE
                 IF   FLG-ZENKOH-ARI  =   ZERO
                   IF  FLG-WRKFILE-CLEAR  =  ZERO
                   OR  FLG-WRKFILE-KGKTAI =   1
                     IF  FLG-ZENKOKUKOHI-NISYU  =  4
                        IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    1    TO   FLG-KEISAN2
                        END-IF
                        IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    2    TO   FLG-KEISAN2
                        END-IF
                     END-IF
                     PERFORM   2104422-ICHIBUFTN-KOH-HEN1-SEC
                   ELSE
                     ADD    WRK-FTNKEI   TO   RECE62-FTNMONEY(1)
                   END-IF
                 ELSE
                   IF  ((SYU-KOH-HKNNUM(1)     NOT = "027") AND
                        (SYU-KOH-HKNNUM(1)(1:1)    = "0"  ))
                   OR  ( SYU-KOH-HKNNUM(2)(1:1)    = "0"   )
                   OR  ( SYU-KOH-HKNNUM(3)(1:1)    = "0"   )
                   OR  ( SYU-KOH-HKNNUM(4)(1:1)    = "0"   )
                   OR  ((WRK-PREFNUM       = "13"         ) AND
                        (SYU-KOH-HKNNUM(1) = "151"        ) AND
                        (RECE62-SRYYM     >= "200905"     ))
                   OR  ((WRK-PREFNUM       = "23"         ) AND
                        (SYU-KOH-HKNNUM(1) = "191"        ) AND
                        (RECE62-SRYYM     >= "200910"     ))
      *
                      IF  (SYU-KOH-HKNNUM(1)(1:1) >= "1" AND <= "8")
                        IF  ((WRK-PREFNUM       = "13"    ) AND
                             (SYU-KOH-HKNNUM(1) = "151"   ) AND
                             (RECE62-SRYYM     >= "200905"))
                        OR  ((WRK-PREFNUM       = "23"    ) AND
                             (SYU-KOH-HKNNUM(1) = "191"   ) AND
                             (RECE62-SRYYM     >= "200910"))
                           CONTINUE
                        ELSE
                           MOVE    1    TO   FLG-HOKENICHIBU2
                        END-IF
                      END-IF
                      IF  (SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8")
                      OR  (SYU-KOH-HKNNUM(3)(1:1) >= "1" AND <= "8")
                      OR  (SYU-KOH-HKNNUM(4)(1:1) >= "1" AND <= "8")
                           MOVE    1    TO   FLG-HOKENICHIBU2
                      END-IF
      *
                      IF  FLG-ZENKOKUKOHI-NISYU  =  1
                        IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    1    TO   FLG-KEISAN2
                        END-IF
                        IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    2    TO   FLG-KEISAN2
                        END-IF
                      END-IF
                      PERFORM 2104427-TOKUSITU-HENSYU-SEC
                   ELSE
                      MOVE       1    TO   FLG-HOKENICHIBU3
                      IF   RECE62-RJNGENMENKBN  =   "1"
                          MOVE   1    TO   FLG-RJNGENMEN-CHIARI
                      END-IF
                      IF   FLG-ZENKOKUKOHI-NISYU  =  2
                        MOVE     2    TO   FLG-KEISAN
                      ELSE
                        MOVE     1    TO   FLG-KEISAN
                      END-IF
                      IF  FLG-WRKFILE-CLEAR  =  ZERO
                      OR  FLG-WRKFILE-KGKTAI =   1
                        PERFORM   2104422-ICHIBUFTN-KOH-HEN1-SEC
                      ELSE
                        ADD    WRK-FTNKEI   TO   RECE62-FTNMONEY(1)
                      END-IF
                   END-IF
                 END-IF
                END-IF
               END-IF
             END-IF                                              
           END-IF                                                  
      *
           IF   SYU-SYUHKNNUM  NOT = SPACE
              ADD   SYU-KOH-FTN         TO   WRK-KOH-FTN
              ADD   SYU-SKJ-FTNGAKU(1)  TO   WRK-KOH-KOUGAKU
           END-IF
      *
           .
       210442-HOKEN-FUTAN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険分負担金額編集
      *****************************************************************
       210447-HOKEN-FUTAN-HENSYU2-SEC               SECTION.
      *
           MOVE     ZERO    TO   FLG-KEISAN
           MOVE     ZERO    TO   FLG-KEISAN2
           MOVE     ZERO    TO   FLG-KEISAN3
      *
           MOVE     ZERO    TO   WRK-FTNKEI-SAGAKU9
      *
           MOVE     ZERO    TO   FLG-KGKIPNTAI
           MOVE     ZERO    TO   FLG-WRKFILE-KGKTAI
           IF    SYU-KOH-HKNNUM(1)(1:1)  >= "1" AND <= "8"
             IF  ((RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1) ) AND
                  (RECE62-HON-NYUKFTNRATE(1) NOT = 100       ))
             OR  ((RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1) ) AND
                  (RECE62-HON-NYUKFTNRATE(2) NOT = 100       ))
             OR  ((RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1) ) AND
                  (RECE62-HON-NYUKFTNRATE(3) NOT = 100       ))
             OR  ((RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(4) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(4)  = RECE62-KOHIDHC(IDX1 1) ) AND
                  (RECE62-HON-NYUKFTNRATE(4) NOT = 100       ))
                 IF   FLG-WRKFILE-CLEAR  =  ZERO
                     MOVE    1    TO   FLG-KGKIPNTAI
                 END-IF
                 IF   FLG-WRKFILE-CLEAR  =  1
                     MOVE    1    TO   FLG-WRKFILE-KGKTAI
                 END-IF
             END-IF
           END-IF
      *
           COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                               * 10
                               * RECE62-KYURATE
                               / 100
           IF   FLG-WRKFILE-CLEAR   =   ZERO
             MOVE     WRK-FTNKEI   TO  WRK-FTNKEI-OKIKAE
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
           END-IF
      *
      ***  IF     SYU-KOHTAIYKZKBN  =   "9"
      ***        ADD    SYU-TOTAL-HKNTEN TO   WRK-JYOGENKBN-TEN
      ***        ADD    SYU-KOH-FTN      TO   WRK-KOH-FTN-GEN70
      ***  END-IF
      *
           IF   ( SYU-KOH-FTN         =   ZERO   )
           AND  ( SYU-KOH-HKNNUM(1)   =   SPACE  )
           AND  ( SYU-KOH-HKNNUM(2)   =   SPACE  )
           AND  ( SYU-KOH-HKNNUM(3)   =   SPACE  )
           AND  ( SYU-KOH-HKNNUM(4)   =   SPACE  )
             IF   FLG-WRKFILE-CLEAR   =   ZERO
                 MOVE      1             TO   FLG-HOKENICHIBU-SYU
                 ADD    SYU-SYUCOMPFTN   TO   RECE62-FTNMONEY(1)
                                              WRK-KOH-GAI
                                              WRK-KOH-GAI2
                 MOVE   1                TO   FLG-JYOGENKBN
                 IF     SYU-KOHTAIYKZKBN  =   "9"
                     MOVE      1            TO  FLG-GENBUTU-TAISYOOK
                 END-IF
                 ADD    SYU-SYUCOMPFTN      TO  WRK-KOH-GAI-GEN70
                 ADD    SYU-TOTAL-HKNTEN    TO  WRK-JYOGENKBN-TEN
                                                WRK-JYOGENKBN-TEN3
                                                WRK-JYOGENKBN-TEN4
                 ADD    WRK-FTNKEI          TO  WRK-HOKENICHIBUGAK
             END-IF
             ADD        SYU-TOTAL-HKNTEN    TO  WRK-JYOGENKBN-TEN6
           ELSE
             MOVE      1      TO    FLG-HOKENICHIBU
             IF   ( SYU-KOHTAIYKZKBN  = "9"            )
             OR   ((SYU-KOH-HKNNUM(1) = "972" OR "974") AND
                   (SYU-KOH-HKNNUM(2) = SPACE         ) AND
                   (SYU-KOH-HKNNUM(3) = SPACE         ) AND
                   (SYU-KOH-HKNNUM(4) = SPACE         ))
                 ADD    SYU-TOTAL-HKNTEN    TO  WRK-JYOGENKBN-TEN
                 ADD    SYU-KOH-FTN         TO  WRK-KOH-FTN-GEN70
             END-IF
             IF   ( SYU-KOH-HKNNUM(1)   =   "012" OR "025" )
             OR   ( SYU-KOH-HKNNUM(2)   =   "012" OR "025" )
             OR   ( SYU-KOH-HKNNUM(3)   =   "012" OR "025" )
             OR   ( SYU-KOH-HKNNUM(4)   =   "012" OR "025" )
               IF   SYU-SYUHKNNUM  NOT = SPACE
                 MOVE    1         TO   FLG-JYOGENKBN2
                 IF  FLG-KOHYONKAIME = 1
                  IF  FLG-TOKU75 = 3
                    MOVE   12300      TO   WRK-KINGAKU
                  ELSE
                    MOVE   24600      TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF  FLG-TOKU75 = 3
                    MOVE   17700      TO   WRK-KINGAKU
                  ELSE
                    MOVE   35400      TO   WRK-KINGAKU
                  END-IF
                 END-IF
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
             ELSE
               IF   ( SYU-KOH-HKNNUM(1) =   "972" )
               OR   ( SYU-KOH-HKNNUM(2) =   "972" )
               OR   ( SYU-KOH-HKNNUM(3) =   "972" )
               OR   ( SYU-KOH-HKNNUM(4) =   "972" )
                 IF  ( SYU-KOH-HKNNUM(1)(1:1)  = "0")
                 OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0")
                 OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0")
                 OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0")
                 OR  ((WRK-PREFNUM       = "13"    ) AND
                      (SYU-KOH-HKNNUM(1) = "151"   ) AND
                      (RECE62-SRYYM     >= "200905"))
                 OR  ((WRK-PREFNUM       = "23"    ) AND
                      (SYU-KOH-HKNNUM(1) = "191"   ) AND
                      (RECE62-SRYYM     >= "200910"))
                 OR  ((WRK-PREFNUM       = "42"    ) AND
                      (SYU-KOH-HKNNUM(1) = "186"   ) AND
                      (FLG-ZENKOKUKOHI-NISYU  =  4 ))
                   MOVE     1         TO   FLG-KEISAN-TOK1
                   MOVE     3         TO   FLG-KEISAN
                 ELSE
                   MOVE     1         TO   FLG-KEISAN-TOK2
                   MOVE     4         TO   FLG-KEISAN
                 END-IF
                 MOVE      2          TO   FLG-JYOGENKBN2
                 MOVE      1          TO   FLG-CYOKI
                 IF  FLG-TOKU75 = 3
                    MOVE   5000       TO   WRK-KINGAKU
                 ELSE
                    MOVE   10000      TO   WRK-KINGAKU
                 END-IF
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                 PERFORM   210442B-ICHIBUFTN-NISYU-HEN-SEC
               ELSE
                IF  ( SYU-KOH-HKNNUM(1) =   "974")
                OR  ( SYU-KOH-HKNNUM(2) =   "974")
                OR  ( SYU-KOH-HKNNUM(3) =   "974")
                OR  ( SYU-KOH-HKNNUM(4) =   "974")
                    IF  ( SYU-KOH-HKNNUM(1)(1:1)  = "0")
                    OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0")
                    OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0")
                    OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0")
                    OR  ((WRK-PREFNUM       = "13"    ) AND
                         (SYU-KOH-HKNNUM(1) = "151"   ) AND
                         (RECE62-SRYYM     >= "200905"))
                    OR  ((WRK-PREFNUM       = "23"    ) AND
                         (SYU-KOH-HKNNUM(1) = "191"   ) AND
                         (RECE62-SRYYM     >= "200910"))
                    OR  ((WRK-PREFNUM       = "42"    ) AND
                         (SYU-KOH-HKNNUM(1) = "186"   ) AND
                         (FLG-ZENKOKUKOHI-NISYU  =  4 ))
                      MOVE     1      TO   FLG-KEISAN-TOK1
                      MOVE     3      TO   FLG-KEISAN
                    ELSE
                      MOVE     1      TO   FLG-KEISAN-TOK2
                      MOVE     4      TO   FLG-KEISAN
                    END-IF
                    MOVE      3       TO   FLG-JYOGENKBN2
                    MOVE      2       TO   FLG-CYOKI
                    IF  FLG-TOKU75 = 3
                       MOVE   10000   TO   WRK-KINGAKU
                    ELSE
                       MOVE   20000   TO   WRK-KINGAKU
                    END-IF
                    PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                    PERFORM   210442B-ICHIBUFTN-NISYU-HEN-SEC
                ELSE
                 IF   FLG-ZENKOH-ARI    =   ZERO
                   IF  FLG-WRKFILE-CLEAR  =  ZERO
                   OR  FLG-WRKFILE-KGKTAI =   1
                     IF  FLG-ZENKOKUKOHI-NISYU  =  4
                        IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    1    TO   FLG-KEISAN2
                        END-IF
                        IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    2    TO   FLG-KEISAN2
                        END-IF
                     END-IF
                     MOVE        4       TO   FLG-JYOGENKBN2
                     PERFORM   2104424-ICHIBUFTN-KOH-HEN3-SEC
                   ELSE
                     ADD    WRK-FTNKEI   TO   RECE62-FTNMONEY(1)
                   END-IF
                   IF (RECE62-KOHSKY-KOHNUM(1)
                                         = SYU-KOH-HKNNUM(1))
                   OR (RECE62-KOHSKY-KOHNUM(2)
                                         = SYU-KOH-HKNNUM(1))
                   OR (RECE62-KOHSKY-KOHNUM(3)
                                         = SYU-KOH-HKNNUM(1))
                   OR (RECE62-KOHSKY-KOHNUM(4)
                                         = SYU-KOH-HKNNUM(1))
                     ADD  SYU-TOTAL-HKNTEN
                                         TO   WRK-JYOGENKBN-TEN5
                   END-IF
                 ELSE
                   IF  ( SYU-KOH-HKNNUM(1)(1:1)    = "0" )
                   OR  ( SYU-KOH-HKNNUM(2)(1:1)    = "0" )
                   OR  ( SYU-KOH-HKNNUM(3)(1:1)    = "0" )
                   OR  ( SYU-KOH-HKNNUM(4)(1:1)    = "0" )
                   OR  ((WRK-PREFNUM       = "13"       ) AND
                        (SYU-KOH-HKNNUM(1) = "151"      ) AND
                        (RECE62-SRYYM     >= "200905"   ))
                   OR  ((WRK-PREFNUM       = "23"       ) AND
                        (SYU-KOH-HKNNUM(1) = "191"      ) AND
                        (RECE62-SRYYM     >= "200910"   ))
      *
                     IF  (SYU-KOH-HKNNUM(1)(1:1) >= "1" AND <= "8")
                       IF  ((WRK-PREFNUM       = "13"    ) AND
                            (SYU-KOH-HKNNUM(1) = "151"   ) AND
                            (RECE62-SRYYM     >= "200905"))
                       OR  ((WRK-PREFNUM       = "23"    ) AND
                            (SYU-KOH-HKNNUM(1) = "191"   ) AND
                            (RECE62-SRYYM     >= "200910"))
                           CONTINUE
                       ELSE
                           MOVE    1    TO   FLG-HOKENICHIBU2
                       END-IF
                     END-IF
                     IF  (SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8")
                     OR  (SYU-KOH-HKNNUM(3)(1:1) >= "1" AND <= "8")
                     OR  (SYU-KOH-HKNNUM(4)(1:1) >= "1" AND <= "8")
                           MOVE    1    TO   FLG-HOKENICHIBU2
                     END-IF
      *
                     IF  FLG-ZENKOKUKOHI-NISYU  =  1
                        IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    1    TO   FLG-KEISAN2
                           IF   SYU-NYNSHOKAISU  =  1
                             MOVE  1    TO   FLG-JIRITU-CYUKANSOU1
                           END-IF
                        END-IF
                        IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    2    TO   FLG-KEISAN2
                           IF   SYU-NYNSHOKAISU  =  1
                             MOVE  1    TO   FLG-JIRITU-CYUKANSOU2
                           END-IF
                        END-IF
                     END-IF
      ***            IF   (SYU-KOHTAIYKZKBN    NOT =  "9" )
      ***            AND  (FLG-WRKFILE-CLEAR       =  ZERO)
      ***               COMPUTE  WRK-FTNKEI-SAGAKU9 =
      ***                        WRK-FTNKEI         -
      ***                        WRK-FTNKEI-OKIKAE
      ***               MOVE   WRK-FTNKEI-OKIKAE   TO   WRK-FTNKEI
      ***            END-IF
                     PERFORM  2104429-TOKUSITU-HENSYU2-SEC
                     IF  SYU-KOHTAIYKZKBN   = "9"
                      MOVE       1    TO   FLG-HOKENICHIBU5
                      ADD  SYU-TOTAL-HKNTEN
                                      TO   WRK-JYOGENKBN-TEN2
                     END-IF
                   ELSE
                     MOVE        1    TO   FLG-HOKENICHIBU3
                     IF   FLG-ZENKOKUKOHI-NISYU  =  2
                        MOVE     2    TO   FLG-KEISAN
                     ELSE
                        MOVE     1    TO   FLG-KEISAN
                     END-IF
                     IF  FLG-WRKFILE-CLEAR  =  ZERO
                     OR  FLG-WRKFILE-KGKTAI =   1
                       IF  FLG-JYOGENKBN = ZERO
                         MOVE      2       TO   FLG-JYOGENKBN
                       END-IF
                       MOVE        1       TO   FLG-JYOGENKBN3
                       PERFORM   2104424-ICHIBUFTN-KOH-HEN3-SEC
                     ELSE
                       ADD    WRK-FTNKEI   TO   RECE62-FTNMONEY(1)
                     END-IF
                     IF (RECE62-KOHSKY-KOHNUM(1)
                                           = SYU-KOH-HKNNUM(1))
                     OR (RECE62-KOHSKY-KOHNUM(2)
                                           = SYU-KOH-HKNNUM(1))
                     OR (RECE62-KOHSKY-KOHNUM(3)
                                           = SYU-KOH-HKNNUM(1))
                     OR (RECE62-KOHSKY-KOHNUM(4)
                                           = SYU-KOH-HKNNUM(1))
                        MOVE    1    TO   FLG-HOKENICHIBU4
                        COMPUTE WRK-FTNKEI5 = SYU-TOTAL-HKNTEN
                                            * 10
                                            * RECE62-KYURATE
                                            / 100
                        COMPUTE WRK-FTNKEI5 = WRK-FTNKEI5 +  5
                        COMPUTE WRK-FTNKEI5 = WRK-FTNKEI5 / 10
                        COMPUTE WRK-FTNKEI5 = WRK-FTNKEI5 * 10
                        IF    WRK-FTNKEI5 >= 21000
                          MOVE  1    TO   FLG-HOKENICHIBU6
                        END-IF
                        ADD    SYU-TOTAL-HKNTEN
                                     TO   WRK-JYOGENKBN-TEN5
                        ADD    SYU-TOTAL-HKNTEN
                                     TO   WRK-JYOGENKBN-TEN3
                     END-IF
                     ADD    SYU-TOTAL-HKNTEN
                                     TO   WRK-JYOGENKBN-TEN6
                   END-IF
                 END-IF
                END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   SYU-SYUHKNNUM  NOT = SPACE
              ADD   SYU-KOH-FTN         TO   WRK-KOH-FTN
              ADD   SYU-SKJ-FTNGAKU(1)  TO   WRK-KOH-KOUGAKU
           END-IF
      *
           .
       210447-HOKEN-FUTAN-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額セット（公費含む場合）
      *****************************************************************
       2104421-ICHIBUFTN-KOH-SET-SEC               SECTION.
      *
           IF  FLG-KEISAN   NOT =  ZERO
             EVALUATE   FLG-KEISAN
               WHEN         1
                 IF  FTN-KOH-XX2  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX2
                 END-IF
                 COMPUTE  FTN-KOH-YY2  =   WRK-KINGAKU -  FTN-KOH-XX2
                 IF  WRK-FTNKEI   >   FTN-KOH-YY2
                      ADD    FTN-KOH-YY2    TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX2
                                                WRK-KOH-GAI
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX2
                                                WRK-KOH-GAI
                 END-IF
               WHEN         2
                 IF  FTN-KOH-XX4  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX4
                 END-IF
                 COMPUTE  FTN-KOH-YY4  =   WRK-KINGAKU -  FTN-KOH-XX4
                 IF  WRK-FTNKEI   >   FTN-KOH-YY4
                      ADD    FTN-KOH-YY4    TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX4
                                                WRK-KOH-GAI
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX4
                                                WRK-KOH-GAI
                 END-IF
               WHEN         3
                 MOVE        WRK-KINGAKU    TO  WRK-KINGAKU-TOK7
                 IF  FTN-KOH-XXX  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XXX
                 END-IF
                 COMPUTE  FTN-KOH-YYY  =   WRK-KINGAKU -  FTN-KOH-XXX
                 IF  WRK-FTNKEI   >   FTN-KOH-YYY
                      ADD    FTN-KOH-YYY    TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 END-IF
                 IF  WRK-KINGAKU-TOK1  >  WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  WRK-KINGAKU-TOK1
                 END-IF
                 COMPUTE  WRK-KINGAKU-TOK3
                             =   WRK-KINGAKU -  WRK-KINGAKU-TOK1
                 IF  WRK-FTNKEI   >   WRK-KINGAKU-TOK3
                      ADD  WRK-KINGAKU-TOK3 TO  WRK-KINGAKU-TOK1
                 ELSE
                      ADD  WRK-FTNKEI       TO  WRK-KINGAKU-TOK1
                 END-IF
               WHEN         4
                 IF  FTN-KOH-XXX  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XXX
                 END-IF
                 COMPUTE  FTN-KOH-YYY  =   WRK-KINGAKU -  FTN-KOH-XXX
                 IF  WRK-FTNKEI   >   FTN-KOH-YYY
                      ADD    FTN-KOH-YYY    TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 END-IF
                 IF  FTN-KOH-XX7  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX7
                 END-IF
                 COMPUTE  FTN-KOH-YY7  =   WRK-KINGAKU -  FTN-KOH-XX7
                 IF  WRK-FTNKEI   >   FTN-KOH-YY7
                      ADD    FTN-KOH-YY7    TO  FTN-KOH-XX7
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX7
                 END-IF
             END-EVALUATE
           ELSE
             EVALUATE   FLG-KEISAN2
               WHEN        ZERO
               WHEN         1
                 IF  FTN-KOH-XXX  >   WRK-KINGAKU
                      MOVE     WRK-KINGAKU  TO  FTN-KOH-XXX
                 END-IF
                 COMPUTE  FTN-KOH-YYY  =  WRK-KINGAKU  -  FTN-KOH-XXX
                 IF  WRK-FTNKEI   >   FTN-KOH-YYY
                      ADD      FTN-KOH-YYY  TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                      MOVE     ZERO         TO  WRK-FTNKEI-SAGAKU
                 ELSE
                      ADD      WRK-FTNKEI   TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                      COMPUTE  WRK-FTNKEI-SAGAKU  =
                               WRK-FTNKEI-SAGAKU  +
                               WRK-FTNKEI-SAGAKU9
                 END-IF
               WHEN         2
                 IF  FTN-KOH-XX3  >   WRK-KINGAKU
                      MOVE     WRK-KINGAKU  TO  FTN-KOH-XX3
                 END-IF
                 COMPUTE  FTN-KOH-YY3  =  WRK-KINGAKU  -  FTN-KOH-XX3
                 IF  WRK-FTNKEI   >   FTN-KOH-YY3
                      ADD      FTN-KOH-YY3  TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX3
                                                WRK-KOH-GAI
                      MOVE     ZERO         TO  WRK-FTNKEI-SAGAKU2
                 ELSE
                      ADD      WRK-FTNKEI   TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX3
                                                WRK-KOH-GAI
                      COMPUTE  WRK-FTNKEI-SAGAKU2 =
                               WRK-FTNKEI-SAGAKU2 +
                               WRK-FTNKEI-SAGAKU9
                 END-IF
             END-EVALUATE
           END-IF
      *
           .
       2104421-ICHIBUFTN-KOH-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集１
      *****************************************************************
       2104422-ICHIBUFTN-KOH-HEN1-SEC               SECTION.
      *
           IF  ((WRK-PREFNUM        = "42"                     ) AND
                (SYU-KOH-HKNNUM(1)  = "186"                    ))
           OR  ((WRK-PREFNUM        = "13" OR "08" OR "27"
                                                   OR "15"     ) AND
                (SYU-SYUHKNNUM  NOT = "060" AND "067" AND "039") AND
                (SYU-KOH-HKNNUM(1)(1:1)  >=  "1" AND <=  "8"   ) AND
                (IDZ                =  1                       ))
           OR  ((WRK-PREFNUM        = "34"                     ) AND
                (SYU-SYUHKNNUM  NOT = "060" AND "067" AND "039") AND
                (SYU-KOH-HKNNUM(1)(1:1)  >=  "1" AND <=  "8"   ) AND
                (RECE62-SRYYM      >= "201004"                 ) AND
                (IDZ                =  1                       ))
           OR  ((WRK-PREFNUM        = "05"                     ) AND
                (SYU-SYUHKNNUM  NOT = "060" AND "067" AND "039") AND
                (SYU-KOH-HKNNUM(1)(1:1)  >=  "1" AND <=  "8"   ) AND
                (RECE62-SRYYM      >= "201008"                 ) AND
                (IDZ                =  1                       ))
           OR  ((WRK-PREFNUM        = "42"                     ) AND
                (SYU-SYUHKNNUM  NOT = "060" AND "067" AND "039") AND
                (SYU-KOH-HKNNUM(1)(1:1)  >=  "1" AND <=  "8"   ) AND
                (RECE62-SRYYM      >= "201010"                 ) AND
                (IDZ                =  1                       ))
              CONTINUE
           ELSE
              MOVE    ZERO    TO    FLG-KGKIPNTAI
           END-IF
      *
           IF  ( FLG-KGKIPNTAI      =  1 )
           OR  ( FLG-WRKFILE-KGKTAI =  1 )
               IF    RECE62-SRYYM   >=  "200610"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    22200   TO   WRK-KINGAKU
                   ELSE
                     MOVE    44400   TO   WRK-KINGAKU
                   END-IF
                   PERFORM   2104426-ICHIBUFTN-GEN-SEC
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               ELSE
                   MOVE      40200   TO   WRK-KINGAKU
                   PERFORM   2104426-ICHIBUFTN-GEN-SEC
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
           ELSE
            IF   RECE62-TEISYOTOKU  NOT =  SPACE
              EVALUATE   RECE62-TEISYOTOKU
                WHEN  "1"
                WHEN  "4"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    7500    TO   WRK-KINGAKU
                   ELSE
                     MOVE    15000   TO   WRK-KINGAKU
                   END-IF
                   PERFORM   2104426-ICHIBUFTN-GEN-SEC
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                WHEN  "2"
                WHEN  "3"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    12300   TO   WRK-KINGAKU
                   ELSE
                     MOVE    24600   TO   WRK-KINGAKU
                   END-IF
                   PERFORM   2104426-ICHIBUFTN-GEN-SEC
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
              END-EVALUATE
            ELSE
              IF   (  RECE62-KYURATE         =  20 OR 30 )
              AND  (  RECE62-RJNGENMENKBN    =  SPACE    )
              AND  (  FLG-KOHYONKAIME        =  ZERO     )
                IF    RECE62-SRYYM   >=  "200610"
                  COMPUTE   WRK-CHIHOU-KIN  =  WRK-CHIHOU-KIN
                                            + (SYU-TOTAL-HKNTEN * 10)
                  IF  FLG-TOKU75 = 1 OR 2
                   IF   WRK-CHIHOU-KIN  >  133500
                      COMPUTE  WRK-KINGAKU2 =
                            (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                          + 0.5
                      COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                      MOVE     1      TO   FLG-KOUGAKU
                   ELSE
                      MOVE     40050  TO   WRK-KINGAKU
                   END-IF
                  ELSE
                   IF   WRK-CHIHOU-KIN  >  267000
                      COMPUTE  WRK-KINGAKU2 =
                            (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                          + 0.5
                      COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                      MOVE     1      TO   FLG-KOUGAKU
                   ELSE
                      MOVE     80100  TO   WRK-KINGAKU
                   END-IF
                  END-IF
                  PERFORM   2104426-ICHIBUFTN-GEN-SEC
                  PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                ELSE
                  COMPUTE   WRK-CHIHOU-KIN  =  WRK-CHIHOU-KIN
                                            + (SYU-TOTAL-HKNTEN * 10)
                  IF   WRK-CHIHOU-KIN  >  361500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  361500 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  =  72300  +  WRK-KINGAKU2
                  ELSE
                     MOVE     72300  TO   WRK-KINGAKU
                  END-IF
                  PERFORM   2104426-ICHIBUFTN-GEN-SEC
                  PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                END-IF
              ELSE
               IF    RECE62-SRYYM   >=  "200610"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    22200   TO   WRK-KINGAKU
                   ELSE
                     MOVE    44400   TO   WRK-KINGAKU
                   END-IF
                   PERFORM   2104426-ICHIBUFTN-GEN-SEC
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               ELSE
                   MOVE      40200   TO   WRK-KINGAKU
                   PERFORM   2104426-ICHIBUFTN-GEN-SEC
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
              END-IF
            END-IF
           END-IF
      *
           .
       2104422-ICHIBUFTN-KOH-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集２
      *****************************************************************
       2104423-ICHIBUFTN-KOH-HEN2-SEC               SECTION.
      *
           IF    RECE62-SRYYM   >=  "200610"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    22200   TO   WRK-KINGAKU
                   ELSE
                     MOVE    44400   TO   WRK-KINGAKU
                   END-IF
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
           ELSE
                   MOVE      40200   TO   WRK-KINGAKU
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
           END-IF
      *
           .
       2104423-ICHIBUFTN-KOH-HEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集３
      *****************************************************************
       2104424-ICHIBUFTN-KOH-HEN3-SEC               SECTION.
      *
           IF  ((WRK-PREFNUM        = "42"                     ) AND
                (SYU-KOH-HKNNUM(1)  = "186"                    ))
           OR  ((WRK-PREFNUM        = "13" OR "08" OR "27"
                                                   OR "15"     ) AND
                (SYU-SYUHKNNUM  NOT = "060" AND "067"          ) AND
                (SYU-KOH-HKNNUM(1)(1:1)  >=  "1" AND <=  "8"   ) AND
                (IDZ                =  1                       ))
           OR  ((WRK-PREFNUM        = "34"                     ) AND
                (SYU-SYUHKNNUM  NOT = "060" AND "067"          ) AND
                (SYU-KOH-HKNNUM(1)(1:1)  >=  "1" AND <=  "8"   ) AND
                (RECE62-SRYYM      >= "201004"                 ) AND
                (IDZ                =  1                       ))
           OR  ((WRK-PREFNUM        = "05"                     ) AND
                (SYU-SYUHKNNUM  NOT = "060" AND "067"          ) AND
                (SYU-KOH-HKNNUM(1)(1:1)  >=  "1" AND <=  "8"   ) AND
                (RECE62-SRYYM      >= "201008"                 ) AND
                (IDZ                =  1                       ))
           OR  ((WRK-PREFNUM        = "42"                     ) AND
                (SYU-SYUHKNNUM  NOT = "060" AND "067"          ) AND
                (SYU-KOH-HKNNUM(1)(1:1)  >=  "1" AND <=  "8"   ) AND
                (RECE62-SRYYM      >= "201010"                 ) AND
                (IDZ                =  1                       ))
           OR  ((WRK-PREFNUM        = "33"                     ) AND
                (SYU-KOH-HKNNUM(1)(1:1)  >=  "1" AND <=  "8"   ))
           OR  ((WRK-PREFNUM        = "01"                     ) AND
                (SYU-SYUHKNNUM  NOT = "060" AND "067"          ) AND
                (SYU-KOH-HKNNUM(1)  = "141" OR "241"           ) AND
                (IDZ                =  1                       ) AND
                (RECE62-SRYYM      <= "200803"                 ))
              CONTINUE
           ELSE
              MOVE    ZERO    TO    FLG-KGKIPNTAI
           END-IF
      *
           IF  ( FLG-KGKIPNTAI      =  1 )
           OR  ( FLG-WRKFILE-KGKTAI =  1 )
      *
            MOVE     ZERO    TO   FLG-KOHYONKAIME-NO
            IF  (WRK-PREFNUM        = "01"           )
            AND (SYU-SYUHKNNUM  NOT = "060" AND "067")
            AND (SYU-KOH-HKNNUM(1)  = "141" OR "241" )
            AND (IDZ                =  1             )
            AND (RECE62-SRYYM      <= "200803"       )
               CONTINUE
            ELSE
               MOVE   1      TO   FLG-KOHYONKAIME-NO
            END-IF
            IF  (FLG-KOHYONKAIME-NO  =  ZERO)
            AND (FLG-KOHYONKAIME     =   1  )
              IF  FLG-TOKU75 = 3
                 MOVE  22200  TO   WRK-KINGAKU
              ELSE
                 MOVE  44400  TO   WRK-KINGAKU
              END-IF
            ELSE
              COMPUTE   WRK-CHIHOU-KIN  =  WRK-CHIHOU-KIN
                                        + (SYU-TOTAL-HKNTEN * 10)
              IF  FLG-TOKU75 = 3
               IF   WRK-CHIHOU-KIN  >  133500
                  COMPUTE  WRK-KINGAKU2 =
                        (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                      + 0.5
                  COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  MOVE     1      TO   FLG-KOUGAKU
               ELSE
                  MOVE     40050  TO   WRK-KINGAKU
               END-IF
              ELSE
               IF   WRK-CHIHOU-KIN  >  267000
                  COMPUTE  WRK-KINGAKU2 =
                        (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                      + 0.5
                  COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  MOVE     1      TO   FLG-KOUGAKU
               ELSE
                  MOVE     80100  TO   WRK-KINGAKU
               END-IF
              END-IF
            END-IF
            PERFORM   2104426-ICHIBUFTN-GEN-SEC
            IF    FLG-KEISAN2 = 2
              MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
            ELSE
              MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
            END-IF
            PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
           ELSE
            EVALUATE     FLG-GENBUTU70
             WHEN           1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN  =  WRK-CHIHOU-KIN
                                           + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  250000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  = 75000   +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE    75000   TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  500000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  = 150000  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE    150000  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   2104426-ICHIBUFTN-GEN-SEC
               IF    FLG-KEISAN2 = 2
                 MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
               ELSE
                 MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
               END-IF
               PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
             WHEN           2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN  =  WRK-CHIHOU-KIN
                                           + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   2104426-ICHIBUFTN-GEN-SEC
               IF    FLG-KEISAN2 = 2
                 MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
               ELSE
                 MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
               END-IF
               PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
             WHEN           3
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM   2104426-ICHIBUFTN-GEN-SEC
               IF    FLG-KEISAN2 = 2
                 MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
               ELSE
                 MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
               END-IF
               PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
            END-EVALUATE
           END-IF
      *
           .
       2104424-ICHIBUFTN-KOH-HEN3-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集４
      *****************************************************************
       2104425-ICHIBUFTN-KOH-HEN4-SEC               SECTION.
      *
           EVALUATE   FLG-KEISAN2
             WHEN        ZERO
             WHEN         1
      ***>     IF  FLG-KOHYONKAIME = 1
      ***>        MOVE   44400   TO   WRK-KINGAKU
      ***>     ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
      ***>     END-IF
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
               PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
             WHEN         2
      ***>     IF  FLG-KOHYONKAIME = 1
      ***>        MOVE   44400   TO   WRK-KINGAKU
      ***>     ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
      ***>     END-IF
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
               PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
           END-EVALUATE
      *
           .
       2104425-ICHIBUFTN-KOH-HEN4-EXT.
           EXIT.
      *
      *****************************************************************
      *    金額の減額
      *****************************************************************
       2104426-ICHIBUFTN-GEN-SEC               SECTION.
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
      *
              COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                                  * 10
                                  * RECE62-KYURATE
                                  / 100
              EVALUATE   WK-GENGAKUKBN
                WHEN        1
                  IF  WK-GENGAKU-RITU = 100
                      MOVE   ZERO     TO   WRK-FTNKEI
                  ELSE
                      COMPUTE  WK-GENGAKU-RITUX =
                               100 - WK-GENGAKU-RITU
                      IF    WRK-FTNKEI  NOT = ZERO
                        COMPUTE  WRK-FTNKEI         =
                                 WRK-FTNKEI         *
                                 WK-GENGAKU-RITUX   /
                                 100
                      END-IF
                  END-IF
                WHEN        2
                  CONTINUE
                WHEN        3
                WHEN        4
                      MOVE   ZERO     TO   WRK-FTNKEI
              END-EVALUATE
              COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
              COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
              COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
      *
              EVALUATE   WK-GENGAKUKBN
                WHEN        1
                  IF  WK-GENGAKU-RITU = 100
                      MOVE   ZERO     TO   WRK-KINGAKU
                  ELSE
                      COMPUTE  WK-GENGAKU-RITUX =
                               100 - WK-GENGAKU-RITU
                      IF    WRK-KINGAKU  NOT = ZERO
                        COMPUTE  WRK-KINGAKU         =
                                (WRK-KINGAKU         *
                                 WK-GENGAKU-RITUX    /
                                 100) + 0.5
                      END-IF
                  END-IF
                WHEN        2
                  CONTINUE
                WHEN        3
                WHEN        4
                      MOVE   ZERO     TO   WRK-KINGAKU
              END-EVALUATE
      *
           END-IF
      *
           .
       2104426-ICHIBUFTN-GEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集（高齢者）
      *****************************************************************
       2104427-TOKUSITU-HENSYU-SEC               SECTION.
      *
           IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(2)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 2)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 2) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(2)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 2)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 2) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(2)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 2)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 2) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(2)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 2)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 2) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  1                     ))
              PERFORM 2104428-ICHIBUFTN-KOH-HEN5-SEC
           ELSE
              PERFORM 2104423-ICHIBUFTN-KOH-HEN2-SEC
           END-IF
      *
           .
       2104427-TOKUSITU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集５
      *****************************************************************
       2104428-ICHIBUFTN-KOH-HEN5-SEC               SECTION.
      *
           EVALUATE   FLG-TOKUSITU
            WHEN       1
      *
              IF    FLG-TOKUSITU-TASU  =  1
                IF  FLG-TOKU75 = 1 OR 2
                  MOVE    22200   TO   WRK-KINGAKU
                ELSE
                  MOVE    44400   TO   WRK-KINGAKU
                END-IF
                PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
              ELSE
                COMPUTE   WRK-CHIHOU-KIN5  =  WRK-CHIHOU-KIN5
                                           + (SYU-TOTAL-HKNTEN * 10)
                IF  FLG-TOKU75 = 1 OR 2
                 IF   WRK-CHIHOU-KIN5  >  133500
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN5 -  133500 ) * 0.01 )
                                                         + 0.5
                    COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                 ELSE
                    MOVE     40050  TO   WRK-KINGAKU
                 END-IF
                ELSE
                 IF   WRK-CHIHOU-KIN5  >  267000
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN5 -  267000 ) * 0.01 )
                                                         + 0.5
                    COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                 ELSE
                    MOVE     80100  TO   WRK-KINGAKU
                 END-IF
                END-IF
                PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
              END-IF
      *
            WHEN       2
      *
              IF  FLG-TOKU75 = 1 OR 2
                MOVE    22200   TO   WRK-KINGAKU
              ELSE
                MOVE    44400   TO   WRK-KINGAKU
              END-IF
              PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
            WHEN       3
      *
              EVALUATE   RECE62-TEISYOTOKU
                WHEN  "1"
                WHEN  "4"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    7500    TO   WRK-KINGAKU
                   ELSE
                     MOVE    15000   TO   WRK-KINGAKU
                   END-IF
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                WHEN  "2"
                WHEN  "3"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    12300   TO   WRK-KINGAKU
                   ELSE
                     MOVE    24600   TO   WRK-KINGAKU
                   END-IF
                   PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
              END-EVALUATE
      *
           END-EVALUATE
           .
       2104428-ICHIBUFTN-KOH-HEN5-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集（７０歳未満）
      *****************************************************************
       2104429-TOKUSITU-HENSYU2-SEC               SECTION.
      *
           IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(2)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 2)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 2) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(2)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 2)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 2) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(2)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 2)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 2) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(2)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 2)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 2) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  1                     ))
              MOVE      5      TO   FLG-JYOGENKBN2
              PERFORM   210442A-ICHIBUFTN-KOH-HEN6-SEC
           ELSE
              MOVE      5      TO   FLG-JYOGENKBN2
              PERFORM   2104425-ICHIBUFTN-KOH-HEN4-SEC
           END-IF
      *
           .
       2104429-TOKUSITU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集６
      *****************************************************************
       210442A-ICHIBUFTN-KOH-HEN6-SEC               SECTION.
      *
           EVALUATE   FLG-TOKUSITU
            WHEN       1
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
              WHEN         2
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
             END-EVALUATE
      *
            WHEN       2
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
              WHEN         2
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
             END-EVALUATE
      *
            WHEN       3
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
              WHEN         2
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
               END-IF
             END-EVALUATE
      *
           END-EVALUATE
      *
           .
       210442A-ICHIBUFTN-KOH-HEN6-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期＋２種の編集
      *****************************************************************
       210442B-ICHIBUFTN-NISYU-HEN-SEC               SECTION.
      *
           EVALUATE  FLG-ZENKOKUKOHI-NISYU
              WHEN       1
               IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
               AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
               AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                  MOVE    1    TO   FLG-KEISAN3
               END-IF
               IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
               AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
               AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                  MOVE    2    TO   FLG-KEISAN3
               END-IF
               PERFORM   2104421A-ICHIBUFTN-KOH-SET2-SEC
              WHEN       8
               IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
               AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
               AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                  MOVE    1    TO   FLG-KEISAN3
               END-IF
               IF  RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)
               AND RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)
               AND RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1)
                  MOVE    2    TO   FLG-KEISAN3
               END-IF
               PERFORM   2104421A-ICHIBUFTN-KOH-SET2-SEC
              WHEN       9
               IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
               AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
               AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                  MOVE    1    TO   FLG-KEISAN3
               END-IF
               IF  RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)
               AND RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)
               AND RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1)
                  MOVE    2    TO   FLG-KEISAN3
               END-IF
               PERFORM   2104421A-ICHIBUFTN-KOH-SET2-SEC
           END-EVALUATE
      *
           .
       210442B-ICHIBUFTN-NISYU-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額セット（長期＋２種）
      *****************************************************************
       2104421A-ICHIBUFTN-KOH-SET2-SEC               SECTION.
      *
           EVALUATE   FLG-KEISAN3
             WHEN         1
                 IF  FTN-KOH-XX5  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX5
                 END-IF
                 COMPUTE  FTN-KOH-YY5  =   WRK-KINGAKU -  FTN-KOH-XX5
                 IF  WRK-FTNKEI   >   FTN-KOH-YY5
                      ADD    FTN-KOH-YY5    TO  FTN-KOH-XX5
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX5
                 END-IF
             WHEN         2
                 IF  FTN-KOH-XX6  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX6
                 END-IF
                 COMPUTE  FTN-KOH-YY6  =   WRK-KINGAKU -  FTN-KOH-XX6
                 IF  WRK-FTNKEI   >   FTN-KOH-YY6
                      ADD    FTN-KOH-YY6    TO  FTN-KOH-XX6
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX6
                 END-IF
           END-EVALUATE
      *
           .
       2104421A-ICHIBUFTN-KOH-SET2-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費実日数テーブル情報のセット
      *****************************************************************
       210443-KOHJNISSUTBL-SET-SEC               SECTION.
      *
           EVALUATE   WRK-PREFNUM
      *
             WHEN    "38"
      *
               IF   SYU-KOH-HKNNUM(IDX3)(1:1) = "1" OR "2" OR "3" OR
                                                "4" OR "5" OR "6" OR
                                                "7" OR "8"
                  PERFORM    VARYING   IDX7    FROM   1   BY   1
                               UNTIL   IDX7      >      31
                    IF   (SYU-DAY(IDX7)  =   "1"  OR  "2"  OR  "9")
                    AND  (RECE62-JNISSUTBL(IDX7)  =   "1"         )
                       MOVE   "1"   TO   RECE62-KOHJNISSUTBL(IDX7)
                    END-IF
                  END-PERFORM
               END-IF
      *
           END-EVALUATE
      *
           .
       210443-KOHJNISSUTBL-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    負担金額（一部負担額）項目の編集
      *****************************************************************
       210444-FTNMONEY-FTN-HENSYU-SEC               SECTION.
      *
      *    老人保険＋全国公費
           IF   RECE62-SRYYM  >= "200604"
           AND  RECE62-SRYYM  <= "200803"
             IF  (( RECE62-RJNHKNNUM      NOT =    SPACE )  AND
                  ( SYU-KOH-HKNNUM(IDX3)(1:1) =    "0"   ))
      *
                    EVALUATE   IDX3
                      WHEN      2
      ***                  ADD   SYU-KOH-COMPFTN(IDX3 - 1)  TO
      ***                                RECE62-FTNMONEY-FTN(KH-IDX)
                        COMPUTE  WRK-FTNKEI-FTN  =  SYU-TOTAL-HKNTEN
                                                 *  10
                                                 *  RECE62-KYURATE
                                                 /  100
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN +  5
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN / 10
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN * 10
                        ADD      WRK-FTNKEI-FTN  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                      WHEN      3
                      WHEN      4
                        IF    (RECE62-KOUREI        =  "1" OR "2"    )
                        AND   (SYU-KOH-HKNNUM(IDX3 - 1)
                                                    =  "015" OR "016"
                                                    OR "051" OR "021"
                                                    OR "024" OR "079"
                                                    OR "011" OR "012"
                                                    OR "020"         )
                           ADD   SYU-KOH-HKNFTNMONEY(IDX3 - 1)  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                        ELSE
                           ADD   SYU-KOH-COMPFTN(IDX3 - 1)  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                        END-IF
                    END-EVALUATE
      *
                    IF   ( SYU-KOH-HKNNUM(1) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "012" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   15000
                          MOVE   15000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                    ELSE
                     IF  ( SYU-KOH-HKNNUM(1) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "972" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   10000
                          MOVE   10000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                     ELSE
                      IF ( SYU-KOH-HKNNUM(1) =   "974" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "974" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "974" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "974" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   20000
                          MOVE   20000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                      ELSE
                       IF   RECE62-SRYYM  >= "200610"
                         IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   44400
                           MOVE  44400  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                         END-IF
                       ELSE
                         IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   40200
                           MOVE  40200  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                         END-IF
                       END-IF
                      END-IF
                     END-IF
                    END-IF
      *
             END-IF
           ELSE
             IF      RECE62-SRYYM      >=  "200404"
             AND     RECE62-SRYYM      <=  "200603"
              IF  (( RECE62-RJNHKNNUM      NOT =    SPACE )  AND
                   ( SYU-KOH-HKNNUM(IDX3)(1:1) =    "0"   ))
      *
                    EVALUATE   IDX3
                      WHEN      2
      ***                  ADD   SYU-KOH-COMPFTN(IDX3 - 1)  TO
      ***                                RECE62-FTNMONEY-FTN(KH-IDX)
                        COMPUTE  WRK-FTNKEI-FTN  =  SYU-TOTAL-HKNTEN
                                                 *  10
                                                 *  RECE62-KYURATE
                                                 /  100
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN +  5
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN / 10
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN * 10
                        ADD      WRK-FTNKEI-FTN  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                      WHEN      3
                      WHEN      4
                        IF    (RECE62-KOUREI        =  "1" OR "2"    )
                        AND   (SYU-KOH-HKNNUM(IDX3 - 1)
                                                    =  "015" OR "016"
                                                             OR "051")
                           ADD   SYU-KOH-HKNFTNMONEY(IDX3 - 1)  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                        ELSE
                           ADD   SYU-KOH-COMPFTN(IDX3 - 1)  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                        END-IF
                    END-EVALUATE
      *
                    IF   ( SYU-KOH-HKNNUM(1) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "012" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   15000
                          MOVE   15000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                    ELSE
                     IF  ( SYU-KOH-HKNNUM(1) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "972" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   10000
                          MOVE   10000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                     ELSE
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   40200
                          MOVE   40200  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                     END-IF
                    END-IF
      *
              END-IF
             END-IF
           END-IF
      *
           .
       210444-FTNMONEY-FTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事金額編集
      *****************************************************************
       210445-SKJ-KINGAKU-HENSYU-SEC               SECTION.
      *
           IF    RECE62-SRYYM  >= "200610"
      *
             PERFORM  VARYING  ID1    FROM    1   BY  1
                       UNTIL   ID1      >    10
      *
               IF  SYU-SHOKUJI(ID1)   =   ZERO
                   CONTINUE
               ELSE
                   EVALUATE    ID1
                     WHEN       1
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(1)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(1)
                      MOVE  "１"   TO  RECE62-SHOKUJISYUBETU-KHN
                     WHEN       2
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(1)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(1)
                      MOVE  "２"   TO  RECE62-SHOKUJISYUBETU-KHN
                     WHEN       3
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(2)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(2)
                      MOVE  "特別" TO  RECE62-SHOKUJISYUBETU(1)
                     WHEN       4
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(3)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(3)
                      MOVE  "食堂" TO  RECE62-SHOKUJISYUBETU(2)
                     WHEN       5
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-SEI(1)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO-SEI(1)
                      MOVE  "１"   TO  RECE62-SHOKUJISYUBETU-KHNSEI
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                     WHEN       6
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-SEI(1)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO-SEI(1)
                      MOVE  "２"   TO  RECE62-SHOKUJISYUBETU-KHNSEI
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                     WHEN       7
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-SEI(2)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO-SEI(2)
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                     WHEN       8
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(3)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(3)
                      MOVE  "食堂" TO  RECE62-SHOKUJISYUBETU(2)
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                     WHEN       9
                     WHEN      10
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(4)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(4)
                      MOVE  "環境" TO  RECE62-SHOKUJISYUBETU(3)
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                   END-EVALUATE
               END-IF
      *
             END-PERFORM
      *
           ELSE
      *
            IF   RECE62-SRYYM  >= "200604"
      *
             PERFORM  VARYING  ID1    FROM    1   BY  1
                       UNTIL   ID1      >     4
      *
               IF  SYU-SHOKUJI(ID1)   =   ZERO
                   CONTINUE
               ELSE
                   ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(ID1)
                   MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(ID1)
               END-IF
      *
             END-PERFORM
      *
            ELSE
      *
             PERFORM  VARYING  ID1    FROM    1   BY  1
                       UNTIL   ID1      >     5
      *
               IF  SYU-SHOKUJI(ID1)   =   ZERO
                 CONTINUE
               ELSE
                 MOVE     ZERO     TO    FLG-ARI
                 PERFORM  VARYING  ID2    FROM    1   BY  1
                           UNTIL   ID2                       > 2
                             OR    RECE62-SHOKUJIKHNRYO(ID2) = ZERO
                             OR    FLG-ARI                   = 1
                    IF  SYU-SHOKUJI(ID1) = RECE62-SHOKUJIKHNRYO(ID2)
                        ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(ID2)
                        MOVE  1   TO   FLG-ARI
                    END-IF
                 END-PERFORM
                 IF  FLG-ARI  =  ZERO
                 AND ID2     <=   2
                   ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(ID2)
                   MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(ID2)
                 END-IF
      *
                 IF  FLG-ARI  =  ZERO
                 AND ID2      >   2
                   MOVE     ZERO     TO    FLG-ARI2
                   PERFORM  VARYING  ID3    FROM    1   BY  1
                             UNTIL   ID3                        > 3
                              OR  RECE62-SHOKUJIKHNRYO-ETC(ID3) = ZERO
                              OR  FLG-ARI2                      = 1
                      IF  SYU-SHOKUJI(ID1)   =
                                       RECE62-SHOKUJIKHNRYO-ETC(ID3)
                          ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-ETC(ID3)
                          MOVE  1   TO   FLG-ARI2
                      END-IF
                   END-PERFORM
                   IF  FLG-ARI2  =  ZERO
                   AND ID3      <=   3
                     ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-ETC(ID3)
                     MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO-ETC(ID3)
                   END-IF
                 END-IF
      *
               END-IF
      *
             END-PERFORM
      *
             IF      SYU-SHOKUJI(6)  NOT =  ZERO
                ADD   SYU-SHOKUJI-NISSU(6)  TO
                                    RECE62-SHOKUJIKHNNISSU(3)
                MOVE  SYU-SHOKUJI(6)        TO
                                    RECE62-SHOKUJIKHNRYO(3)
             END-IF
             IF      SYU-SHOKUJI(7)  NOT =  ZERO
                ADD   SYU-SHOKUJI-NISSU(7)  TO
                                    RECE62-SHOKUJIKHNNISSU(4)
                MOVE  SYU-SHOKUJI(7)        TO
                                    RECE62-SHOKUJIKHNRYO(4)
             END-IF
      *
            END-IF
      *
           END-IF
      *
           .
       210445-SKJ-KINGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    負担金額（一部負担額）項目の編集
      *****************************************************************
       210446-FTNMONEY-HENSYU-SEC               SECTION.
      *
           IF   RECE62-SRYYM  >= "200604"
                ADD      1    TO   RECE62-KOHKENSU(KH-IDX - 1)
                IF (( RECE62-KOUREI              =  "1" OR "2"     ) AND
                    ((RECE62-KOHNUM(KH-IDX - 1)  =  "015" OR "016"
                                                 OR "051" OR "021"
                                                 OR "024" OR "079"
                                                 OR "052" OR "011"
                                                 OR "025" OR "038"
                                                 OR "012" OR "020") OR
                     (TBL-TOKATUKAIFLG(KH-IDX - 1)   =  1         )))
                OR (  TBL-HKNFTNDATA-FLG(KH-IDX - 1) =  1           )
                  IF  ((RECE62-KOUREI                  =  "2") AND
                       (SYU-KOHTAIYKZKBN           NOT =  "9") AND
                       (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
                                                   NOT = ZERO) AND
                       (TBL-HKNFTNDATA-FLG(KH-IDX - 1) = ZERO))
                  OR  ((RECE62-KOUREI                  =  "2") AND
                       (RECE62-KOHNUM(KH-IDX - 1)
                                          =  "015"  OR  "016") AND
                       (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
                                          = 9999999 OR 999999))
                   ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                   RECE62-FTNMONEY(KH-IDX)
                                   RECE62-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                   WRK-TAIHI-FTNMONEY(KH-IDX)
                                   WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-SKJ-FTN(IDX3)          TO
                                   WRK-SKJ-FTN(KH-IDX)
                   MOVE   1   TO   WRK-KOGAKU-TAISYOGAI(KH-IDX - 1)
                  ELSE
                   ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                   RECE62-FTNMONEY(KH-IDX)
                                   RECE62-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                   WRK-TAIHI-FTNMONEY(KH-IDX)
                                   WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-SKJ-FTN(IDX3)          TO
                                   WRK-SKJ-FTN(KH-IDX)
                  END-IF
                ELSE
                 IF  (RECE62-KOUREI              =  "2"  )
                 AND (RECE62-KOHNUM(KH-IDX - 1)  =  "010")
                 AND (SYU-KOHTAIYKZKBN       NOT =  "9"  )
                   COMPUTE  WRK-KEISAN-ZZZ =
                            SYU-KOH-COMPFTN-ENTANI(IDX3) + 0.5
                   ADD   WRK-KEISAN-ZZZ             TO
                                   RECE62-FTNMONEY(KH-IDX)
                                   RECE62-FTNMONEY-KOJ(KH-IDX)
                   MOVE   1   TO   WRK-KOGAKU-TAISYOGAI(KH-IDX - 1)
                 ELSE
      ***         IF     (RECE62-KOUREI          =  "1" OR "2")
                  IF    ((RECE62-KOUREI          =  "1"       ) AND
                         (RECE62-SRYYM          >=  "200610"  ) AND
                         (WRK-PREFNUM            =   33       ) AND
                         (RECE62-KOHNUM(KH-IDX - 1)(1:1)
                                         >=  "1" AND <=  "8"  ))
                  OR    ((RECE62-KOUREI          =  "1"       ) AND
                         (RECE62-SRYYM          >=  "200804"  ) AND
                         (WRK-PREFNUM            =   27       ) AND
                         (RECE62-KOHNUM(KH-IDX - 1)(1:1)
                                         >=  "1" AND <=  "8"  ) AND
                         (RECE62-KOHNUM(KH-IDX - 1)
                                         NOT = "100" AND "200"))
                  OR    ((RECE62-KOUREI          =  "1" OR "2") AND
                         (WRK-PREFNUM            =   13       ) AND
                         (RECE62-KOHNUM(KH-IDX - 1) =
                           "180" OR "380" OR "181" OR "381"   ))
                  OR    ((WRK-PREFNUM            =   36       ) AND
                         (RECE62-KOHNUM(KH-IDX - 1) =  "245"  ) AND
                         (RECE62-TEISYUTUSAKI    =   2 OR 6   ))
                     ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                   RECE62-FTNMONEY(KH-IDX)
                                   RECE62-FTNMONEY-KOJ(KH-IDX)
                     ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                   WRK-TAIHI-FTNMONEY(KH-IDX)
                                   WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                     ADD   SYU-SKJ-FTN(IDX3)          TO
                                   WRK-SKJ-FTN(KH-IDX)
                  ELSE
                   IF    (RECE62-KOUREI             =   SPACE)
                   AND   (RECE62-KOHNUM(KH-IDX - 1) =  "010" )
                         ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                      RECE62-FTNMONEY-KOJ(KH-IDX)
                   ELSE
                         ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                      RECE62-FTNMONEY(KH-IDX)
                                      RECE62-FTNMONEY-KOJ(KH-IDX)
                         ADD   SYU-SKJ-FTN(IDX3)      TO
                                      WRK-SKJ-FTN(KH-IDX)
                   END-IF
                  END-IF
                 END-IF
                END-IF
      *
                IF   ( RECE62-KOHNUM(KH-IDX - 1) =  "012" OR "025" )
                OR   ((WRK-PREFNUM               =   13           ) AND
                      (RECE62-KOHNUM(KH-IDX - 1) =  "588"         ) AND
                      (RECE62-SRYYM             >=  "200710"      ) AND
                      (RECE62-SRYYM             <=  "200909"      ))
                OR   ((WRK-PREFNUM               =   13           ) AND
                      (RECE62-KOHNUM(KH-IDX - 1) =
                        "180" OR "380" OR "181" OR "381"          ))
                  COMPUTE  WRK-TAIHI-FTNMONEY-EN(KH-IDX)  =
                           WRK-TAIHI-FTNMONEY-EN(KH-IDX)  +
                          (SYU-KOH-COMPFTN-ENTANI(IDX3)   + 0.5)
                  COMPUTE  WRK-TAIHI-FTNMONEY-EN2(KH-IDX) =
                           WRK-TAIHI-FTNMONEY-EN2(KH-IDX) +
                           SYU-KOH-COMPFTN-ENTANI(IDX3)
                END-IF
      *
                IF    (RECE62-KOHNUM(KH-IDX - 1) =
                                       "010" OR "012" OR "015" OR
                                       "016" OR "021" OR "024" OR
                                       "051" OR "052" OR "079" OR
                                       "011" OR "025" OR "038" OR
                                       "020"                     )
                  EVALUATE   RECE62-KOHNUM(KH-IDX - 1)
                    WHEN       "010"
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                              (SYU-TOTAL-HKNTEN  * 10 * 5 / 100) + 0.5
                      ADD      WRK-TAIHI-GENKIN2
                               TO   WRK-TAIHI-GENKIN-EN(KH-IDX - 1)
                      COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                                 * 10
                                                 * 5
                                                 / 100
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                               WRK-TAIHI-GENKIN2 +  5
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                               WRK-TAIHI-GENKIN2 / 10
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                               WRK-TAIHI-GENKIN2 * 10
                      ADD      WRK-TAIHI-GENKIN2
                               TO   WRK-TAIHI-GENKIN(KH-IDX - 1)
                    WHEN       "012"
                    WHEN       "051"
                    WHEN       "052"
                    WHEN       "011"
                    WHEN       "025"
                    WHEN       "038"
                    WHEN       "020"
                      IF  ((FLG-ZENKI-TOKUREI             =   1  ) AND
                           (RECE62-KOHNUM(KH-IDX - 1)     = "051"))
                      OR  ((FLG-ZENKI-TOKUREI             =   1  ) AND
                           (RECE62-KOHNUM(KH-IDX - 1)     = "038"))
                        COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                                   * 10
                                                   * 20
                                                   / 100
                      ELSE
                        COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                                   * 10
                                                   * RECE62-KYURATE
                                                   / 100
                      END-IF
                      ADD      WRK-TAIHI-GENKIN2
                               TO   WRK-TAIHI-GENKIN-EN(KH-IDX - 1)
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                               WRK-TAIHI-GENKIN2 +  5
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                               WRK-TAIHI-GENKIN2 / 10
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                               WRK-TAIHI-GENKIN2 * 10
                      ADD      WRK-TAIHI-GENKIN2
                               TO   WRK-TAIHI-GENKIN(KH-IDX - 1)
                    WHEN       "015"
                    WHEN       "016"
                    WHEN       "021"
                    WHEN       "024"
                    WHEN       "079"
                      COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                                 * 10
                                                 * 10
                                                 / 100
                      ADD      WRK-TAIHI-GENKIN2
                               TO   WRK-TAIHI-GENKIN-EN(KH-IDX - 1)
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                               WRK-TAIHI-GENKIN2 +  5
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                               WRK-TAIHI-GENKIN2 / 10
                      COMPUTE  WRK-TAIHI-GENKIN2 =
                               WRK-TAIHI-GENKIN2 * 10
                      ADD      WRK-TAIHI-GENKIN2
                               TO   WRK-TAIHI-GENKIN(KH-IDX - 1)
                  END-EVALUATE
                END-IF
      *
                IF  ((WRK-PREFNUM               = "13" ) AND
                     (RECE62-KOHNUM(KH-IDX - 1) = "151"))
                OR  ((WRK-PREFNUM               = "23" ) AND
                     (RECE62-KOHNUM(KH-IDX - 1) = "191") AND
                     (RECE62-SRYYM         >=  "200910"))
                    IF    FLG-ZENKI-TOKUREI  =   1
                      COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                                 * 10
                                                 * 20
                                                 / 100
                    ELSE
                      COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                                 * 10
                                                 * RECE62-KYURATE
                                                 / 100
                    END-IF
                    ADD      WRK-TAIHI-GENKIN2
                             TO   WRK-TAIHI-GENKIN-EN(KH-IDX - 1)
                    COMPUTE  WRK-TAIHI-GENKIN2 = WRK-TAIHI-GENKIN2 +  5
                    COMPUTE  WRK-TAIHI-GENKIN2 = WRK-TAIHI-GENKIN2 / 10
                    COMPUTE  WRK-TAIHI-GENKIN2 = WRK-TAIHI-GENKIN2 * 10
                    ADD      WRK-TAIHI-GENKIN2
                             TO   WRK-TAIHI-GENKIN(KH-IDX - 1)
                END-IF
      *
                IF   RECE62-SRYYM    >=  "200610"
                  IF   WRK-TOKUSYU-SKJFLG2(KH-IDX - 1) = ZERO
                    IF    SYU-SKJ-FTNKBN(IDX3)  =  "5" OR "7" OR "8"
                      IF   SYU-SKJ-FTNKBN(IDX3)  =  "8"
                        MOVE     2   TO    FLG-TOKUSYU-SKJ
                      ELSE
                        MOVE     1   TO    FLG-TOKUSYU-SKJ
                      END-IF
                    ELSE
                      MOVE    ZERO   TO    FLG-TOKUSYU-SKJ
                    END-IF
                  ELSE
                      MOVE    WRK-TOKUSYU-SKJFLG2(KH-IDX - 1)
                                     TO    FLG-TOKUSYU-SKJ
                  END-IF
                ELSE
                      MOVE    ZERO   TO    FLG-TOKUSYU-SKJ
                END-IF
      ****
                MOVE          ZERO   TO    FLG-MIYAGI
                IF ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "183" OR "483"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304004" OR "8304009" OR
                                "8304017" OR "8304023" OR
                                "8304026" OR "8304028" OR
                                "8304036" OR "8304041"      ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SRYYM         >=  "200510"      ) AND
                    (RECE62-SRYYM         <   "200610"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "183" OR "483"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304017" OR "8304028" OR
                                "8304079"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SRYYM         >=  "200610"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "583" OR "783"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304017" OR "8304028" OR
                                "8304079"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SRYYM         >=  "201010"      ))
                   MOVE       1      TO    FLG-MIYAGI
                END-IF
      ****
                IF   SYU-SYUHKNNUM    NOT  =   SPACE
                  IF ((SYU-SKJ-FTNKBN(IDX3)  =  "1"              ) AND
                      (SYU-SKJ-FTN(IDX3) = SYU-SKJ-FTN-RECE(IDX3)) AND
                      (FLG-MIYAGI        = ZERO                  ))
                  OR ( SYU-SKJ-FTNKBN(IDX3)  =  "6"            )
      *           OR ( SYU-SKJ-NISSU(IDX3)   =   ZERO          )
                  OR ( SYU-SKJ-RYOYOHI(IDX3) =   ZERO          )
      *              IF   RECE62-SHOKUJINISSU(KH-IDX)  =  ZERO
                     IF   RECE62-SHOKUJIRYOYOHI(KH-IDX) =  ZERO
                         MOVE    "1"      TO
                                 RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                         IF   RECE62-SRYYM    >= "200610"
                         AND  FLG-TOKUSYU-SKJ  =  ZERO
                            MOVE    "1"      TO
                              RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                            MOVE    "1"      TO
                              RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                         END-IF
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
                  ELSE
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                     ADD   SYU-SKJ-FTN-RECE(IDX3) TO
                                   RECE62-SHOKUJIFTN(KH-IDX)
                     MOVE  SPACE                  TO
                                 RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                     IF   RECE62-SRYYM    >=  "200610"
                     AND  FLG-TOKUSYU-SKJ  =   ZERO
                        MOVE  SPACE               TO
                                RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                        MOVE  SPACE               TO
                                RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
                  END-IF
                ELSE
                  IF  ( SYU-SKJ-RYOYOHI(IDX3)   =   ZERO  )
                  OR  ((SYU-KOH1HKNNUM      =  "010"     ) AND
                       (SYU-KOH2HKNNUM(1:1) =  "0"       ) AND
                       (SYU-KOH3HKNNUM      =   SPACE    ) AND
                       (SYU-KOH4HKNNUM      =   SPACE    ) AND
                       (RECE62-KOHNUM(KH-IDX - 1) = "010") AND
                       (KH-IDX              =   2        ))
                     IF   RECE62-SHOKUJIRYOYOHI(KH-IDX) =  ZERO
                         MOVE    "1"      TO
                                 RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                         IF   RECE62-SRYYM    >= "200610"
                         AND  FLG-TOKUSYU-SKJ  =  ZERO
                            MOVE    "1"      TO
                              RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                            MOVE    "1"      TO
                              RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                         END-IF
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
                  ELSE
                   IF   ((SYU-KOH1HKNNUM  NOT =
                          "010" AND "038" AND "024" AND "079" AND
                          "051" AND "052" AND "015" AND "016"   ) AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ))
                   OR   ((SYU-KOH1HKNNUM      =  "024" OR  "079") AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ) AND
                         (SYU-SKJ-FTNKBN(IDX3)  =  "3"          ))
                   OR   ((SYU-KOH1HKNNUM      =  "051" OR  "052"
                                              OR "015" OR  "016") AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ) AND
                         (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
                                                         = ZERO ))
                   OR   ((SYU-KOH1HKNNUM  NOT =   SPACE         ) AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ) AND
                         (RECE62-SRYYM       >=  "201101"       ) AND
                         (RECE62-SRYYM       <=  "201202"       ) AND
                         (WK-GENGAKUKBN       =   3  OR  4      ) AND
                         (FLG-SAIGAI-TAISYO   =   1             ))
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                     MOVE  SPACE                  TO
                                   RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                     IF   RECE62-SRYYM    >=  "200610"
                     AND  FLG-TOKUSYU-SKJ  =   ZERO
                        MOVE  SPACE               TO
                                RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                        MOVE  SPACE               TO
                                RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   WRK-KOHTAN-SHOKUJIRYOYOHI(KH-IDX)
                     IF     RECE62-SEIHOFLG   =  "1"
                        IF  RECE62-YOBIETC(1) =  ZERO
                           EVALUATE  KH-IDX
                             WHEN      2
                                MOVE  2   TO  RECE62-YOBIETC(1)
                             WHEN      3
                                MOVE  3   TO  RECE62-YOBIETC(1)
                             WHEN      4
                                MOVE  4   TO  RECE62-YOBIETC(1)
                             WHEN      5
                                MOVE  5   TO  RECE62-YOBIETC(1)
                           END-EVALUATE
                        END-IF
                     END-IF
                   ELSE
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                     ADD   SYU-SKJ-FTN-RECE(IDX3) TO
                                   RECE62-SHOKUJIFTN(KH-IDX)
                     IF     RECE62-SEIHOFLG   =  "1"
                       IF   RECE62-YOBIETC(2) =  ZERO
                                MOVE  1   TO  RECE62-YOBIETC(2)
                       END-IF
                     ELSE
                       MOVE  SPACE                  TO
                                     RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                       IF   RECE62-SRYYM    >=  "200610"
                       AND  FLG-TOKUSYU-SKJ  =   ZERO
                          MOVE  SPACE               TO
                                  RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                          MOVE  SPACE               TO
                                  RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                       END-IF
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
                   END-IF
                  END-IF
                END-IF
      *
                IF   FLG-TOKUSYU-SKJ  NOT =  ZERO
      *           IF    SYU-SKJ-NISSU(IDX3)  NOT =  ZERO
                  IF    SYU-SKJ-RYOYOHI(IDX3) NOT =  ZERO
                        MOVE    SPACE    TO
                            RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                        EVALUATE  FLG-TOKUSYU-SKJ
      *                   生活療養（食事）（環境）を対象
                          WHEN       1
                            MOVE  "1"  TO
                                  RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
      *                   生活療養（環境）のみを対象
                          WHEN       2
                            MOVE  "2"  TO
                                  RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                        END-EVALUATE
                        MOVE     1       TO
                                  WRK-TOKUSYU-SKJFLG(KH-IDX - 1)
                  ELSE
                    IF  WRK-TOKUSYU-SKJFLG(KH-IDX - 1)  =  ZERO
                        MOVE    "1"      TO
                            RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                        MOVE    "1"      TO
                            RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                    END-IF
                  END-IF
                  MOVE  FLG-TOKUSYU-SKJ  TO
                                 WRK-TOKUSYU-SKJFLG2(KH-IDX - 1)
                END-IF
      *
                IF   RECE62-KOHNUM(KH-IDX - 1) =  "051"
                AND  FLG-KOH      NOT =   2
                      MOVE     1   TO   FLG-KOH
                END-IF
                IF   RECE62-KOHNUM(KH-IDX - 1) =  "010"
                      MOVE     2   TO   FLG-KOH
                END-IF
           ELSE
                ADD      1    TO   RECE62-KOHKENSU(KH-IDX - 1)
                IF   (RECE62-SRYYM              >=  "200404"      )
                AND  (RECE62-KOUREI              =  "1" OR "2"    )
                AND  (RECE62-KOHNUM(KH-IDX - 1)  =  "015" OR "016"
                                                          OR "051")
                   ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                   RECE62-FTNMONEY(KH-IDX)
                                   RECE62-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-SKJ-FTN(IDX3)          TO
                                   WRK-SKJ-FTN(KH-IDX)
                ELSE
                   IF    (RECE62-KOUREI             =   SPACE        )
                   AND   (RECE62-KOHNUM(KH-IDX - 1) =  "010" OR "021")
                         ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                      RECE62-FTNMONEY-KOJ(KH-IDX)
                   ELSE
                         ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                      RECE62-FTNMONEY(KH-IDX)
                                      RECE62-FTNMONEY-KOJ(KH-IDX)
                         ADD   SYU-SKJ-FTN(IDX3)      TO
                                      WRK-SKJ-FTN(KH-IDX)
                   END-IF
                END-IF
      *
                IF ((WRK-PREFNUM           =  "38"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1)(1:1)
                                     >=  "1" AND <=  "8"    ) AND
                    (IDZ                   =   1            ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "183" OR "483"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)  NOT =
                                "8304004" AND "8304009" AND
                                "8304017" AND "8304023" AND
                                "8304026" AND "8304028" AND
                                "8304036" AND "8304041"     ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SRYYM         >=  "200510"      ))
                OR ((WRK-PREFNUM           =  "39"          ) AND
                    (RECE62-KOHHBTNUM(KH-IDX - 1)  =
                              "72" OR "73" OR "74" OR "75"  ) AND
                    (RECE62-SRYYM         >=  "200510"      ))
                   IF  SYU-SKJ-NISSU(IDX3)  NOT =  ZERO
                       MOVE    "1"      TO
                               RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                   END-IF
                ELSE
                  IF    (SYU-SYUHKNNUM       =   SPACE         )
                  AND   (SYU-KOH1HKNNUM      =   "012" OR "019" 
                                              OR "020" OR "053")
                  AND   (SYU-KOH2HKNNUM      =   SPACE         )
                  AND   (SYU-KOH3HKNNUM      =   SPACE         )
                  AND   (SYU-KOH4HKNNUM      =   SPACE         )
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                  ELSE
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                     ADD   SYU-SKJ-FTN-RECE(IDX3) TO
                                   RECE62-SHOKUJIFTN(KH-IDX)
                  END-IF
                END-IF
      *
                IF   RECE62-KOHNUM(KH-IDX - 1) =  "051"
                AND  FLG-KOH      NOT =   2
                      MOVE     1   TO   FLG-KOH
                END-IF
                IF   RECE62-KOHNUM(KH-IDX - 1) =  "010"  OR  "021"
                      MOVE     2   TO   FLG-KOH
                END-IF
           END-IF
      *
           .
       210446-FTNMONEY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       210448-SKY-SYUNOU-HENSYU-SEC               SECTION.
      *
           ADD   SYU-TOTAL-HKNTEN   TO   RECE62-SKYIRYO-TOTALTEN
      *
           IF   SYU-SYUHKNNUM   NOT =  SPACE
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
                                       * (100 - RECE62-KYURATE)
                                       /  100
              ADD      WRK-SKY-KEISAN   TO   RECE62-SKYIRYO-HOKENJA
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-HOKENJA
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
                                       *  RECE62-KYURATE
                                       /  100
      *
      **      IF    WK-GENGAKUKBN   =  3  OR  4
              IF    WK-GENGAKUKBN   NOT =  ZERO
                ADD    WRK-SKY-KEISAN   TO   RECE62-SKYIRYO-HOKENJA
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-HOKENJA
              ELSE
                COMPUTE  WRK-SKY-KEISAN  =   WRK-SKY-KEISAN +  5
                COMPUTE  WRK-SKY-KEISAN  =   WRK-SKY-KEISAN / 10
                COMPUTE  WRK-SKY-KEISAN  =   WRK-SKY-KEISAN * 10
      *
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-ICHIBUFTN
      *
                COMPUTE  WRK-SKY-KEISAN  =   SYU-HKNTEKMONEY
                                         +   SYU-KOH-FTN
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-FTNMONEY
      *
                ADD    SYU-HKNTEKMONEY  TO   RECE62-SKYIRYO-ICHIBUFTN
                ADD    SYU-KOH-FTN      TO   RECE62-SKYIRYO-ICHIBUFTN
              END-IF
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-ZENGAKU
      *
              IF  (SYU-KOH-HKNNUM(1) = SPACE)
              AND (SYU-KOH-HKNNUM(2) = SPACE)
              AND (SYU-KOH-HKNNUM(3) = SPACE)
              AND (SYU-KOH-HKNNUM(4) = SPACE)
                CONTINUE
              ELSE
                COMPUTE   WRK-SKY-KEISAN =  SYU-TOTAL-HKNTEN
                                         *  10
                                         * (100 - RECE62-KYURATE)
                                         /  100
                ADD       WRK-SKY-KEISAN   TO  WRK-SKY-HOKENJA-KOH
      *
                COMPUTE   WRK-SKY-KEISAN =  SYU-TOTAL-HKNTEN
                                         *  10
                ADD       WRK-SKY-KEISAN   TO  WRK-SKY-ZENGAKU-KOH
      *
                ADD       SYU-KOH-FTN-ENTANI
                                           TO  WRK-SKY-FTNMONEY-KOH
      *
                IF ((WRK-PREFNUM          =  "44"          ) AND
                    (SYU-KOH1HKNNUM       =  "183" OR "283") AND
                    (SYU-JYO-COMPFTN  NOT =   ZERO         ) AND
                    (RECE62-SRYYM        >=  "201010"      ))
                OR ((WRK-PREFNUM          =  "04"          ) AND
                    (SYU-KOH1HKNNUM       =  "583" OR "683"
                                                   OR "783") AND
                    (SYU-JYO-COMPFTN  NOT =   ZERO         ) AND
                    (RECE62-SRYYM        >=  "201010"      ))
                OR ((WRK-PREFNUM          =  "04"          ) AND
                    (SYU-KOH1HKNNUM       =  "463" OR "563"
                                          OR "263" OR "363") AND
                    (SYU-JYO-COMPFTN  NOT =   ZERO         ) AND
                    (RECE62-SRYYM        >=  "201201"      ))
                OR ((WRK-PREFNUM          =  "10"          ) AND
                    (SYU-KOH1HKNNUM       =  "145" OR "245"
                                          OR "146" OR "246"
                                          OR "143" OR "243") AND
                    (SYU-JYO-COMPFTN  NOT =   ZERO         ) AND
                    (RECE62-SRYYM        >=  "201104"      ))
                   MOVE     1     TO    FLG-SKY-TOKKOH
                END-IF
              END-IF
           ELSE
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-ZENGAKU2
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-HKNTEKMONEY
                                       +  SYU-KOH-FTN
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-FTNMONEY2
      *
              ADD      SYU-HKNTEKMONEY  TO   RECE62-SKYIRYO-ICHIBUFTN
              ADD      SYU-KOH-FTN      TO   RECE62-SKYIRYO-ICHIBUFTN
           END-IF
      *
      *****
      *
           ADD   SYU-RYOYOHI-SKJ    TO   RECE62-SKYSKJ-RYOYOHI
           ADD   SYU-RYOYOHI-LIFE   TO   RECE62-SKYSKJ-RYOYOHI
      *
           IF   SYU-SYUHKNNUM   NOT =  SPACE
              ADD      SYU-SYUSKJ-NISSU TO   RECE62-SKYSKJ-KAISU
      *
              IF   (WK-GENGAKUKBN      =   3 OR 4)
              AND  (FLG-SAIGAI-TAISYO  =   1     )
              AND  (RECE62-SRYYM      >= "201101")
              AND  (RECE62-SRYYM      <= "201202")
                ADD    SYU-SYUSKJ-RYOYOHI
                                        TO   RECE62-SKYSKJ-HOKENJA
              ELSE
                COMPUTE  WRK-SKY-KEISAN  =   SYU-SYUSKJ-RYOYOHI
                                         -   SYU-SYUSKJ-FTN
                ADD    WRK-SKY-KEISAN   TO   RECE62-SKYSKJ-HOKENJA
      *
                ADD    SYU-SYUSKJ-FTN   TO   WRK-SKY-SKJ-ICHIBUFTN
      *
                COMPUTE  WRK-SKY-KEISAN  =   SYU-SKYMONEY-SKJ
                                         +   SYU-SKYMONEY-LIFE
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-SKJ-FTNMONEY
      *
                ADD    SYU-SKYMONEY-SKJ TO   RECE62-SKYSKJ-ICHIBUFTN
                ADD    SYU-SKYMONEY-LIFE
                                        TO   RECE62-SKYSKJ-ICHIBUFTN
              END-IF
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-RYOYOHI-SKJ
                                       +  SYU-RYOYOHI-LIFE
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-SKJ-ZENGAKU
           ELSE
              ADD      SYU-KOH1SKJ-NISSU
                                        TO   RECE62-SKYSKJ-KAISU
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-RYOYOHI-SKJ
                                       +  SYU-RYOYOHI-LIFE
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-SKJ-ZENGAKU2
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-SKYMONEY-SKJ
                                       +  SYU-SKYMONEY-LIFE
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-SKJ-FTNMONEY2
      *
              ADD      SYU-SKYMONEY-SKJ TO   RECE62-SKYSKJ-ICHIBUFTN
              ADD      SYU-SKYMONEY-LIFE
                                        TO   RECE62-SKYSKJ-ICHIBUFTN
           END-IF
      *
           .
       210448-SKY-SYUNOU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事負担含む上限額のある公費の一部負担金額編集等
      *****************************************************************
       21045-KOH-FUTAN-SET-SEC               SECTION.
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                  UNTIL    KOHFTN-IDX    >    4
      *
             IF   (RECE62-KOHNUM(KOHFTN-IDX) =  "051"   )
             AND  (RECE62-SRYYM              <  "200310")
      *
                COMPUTE  WRK-FTNKEI2 = RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                     + WRK-SKJ-FTN(KOHFTN-IDX + 1)
      *
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI2 +  5
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI4 / 10
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI4 * 10
      *
                MOVE     RECE62-FTNMONEY(KOHFTN-IDX + 1)  
                                   TO  WRK-FTNKEI3
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 +  5
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 / 10
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 * 10
      *
                IF  WRK-FTNKEI3  =  14000
                    MOVE  WRK-FTNKEI3  
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
                IF  WRK-FTNKEI3  <  14000
                AND WRK-FTNKEI4  =  14000
                    MOVE  WRK-FTNKEI4
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
                IF  WRK-FTNKEI3  <  14000
                AND WRK-FTNKEI4  <  14000
                    MOVE  WRK-FTNKEI2
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
      *
             END-IF
      *
             IF  ((RECE62-KOHNUM(KOHFTN-IDX) =  "012" OR "015" 
                                                      OR "016")   AND
                  (RECE62-SRYYM             >=  "200304"      ))
             OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "051"         )   AND
                  (RECE62-SRYYM             >=  "200310"      ))
             OR  ((WRK-PREFNUM               =  "13"          )   AND
                  (RECE62-KOHNUM(KOHFTN-IDX) =  "151" OR "451")   AND
                  (RECE62-SRYYM             >=  "200310"      ))
             OR  ((WRK-PREFNUM               =  "28"          )   AND
                  (RECE62-KOHNUM(KOHFTN-IDX) =  "186"         )   AND
                  (RECE62-SRYYM             >=  "200310"      ))
             OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "052"         )   AND
                  (RECE62-SRYYM             >=  "200504"      ))
             OR  ((WRK-PREFNUM               =  "07"          )   AND
                  (RECE62-KOHNUM(KOHFTN-IDX) =  "281"         )   AND
                  (RECE62-SRYYM             >=  "200702"      ))
             OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "025"         )   AND
                  (RECE62-SRYYM             >=  "200804"      ))
             OR  ((WRK-PREFNUM               =  "01"          )   AND
                  (RECE62-KOHNUM(KOHFTN-IDX) =  "183"         )   AND
                  (RECE62-SRYYM             >=  "200810"      ))
             OR  ((WRK-PREFNUM               =  "23"          )   AND
                  (RECE62-KOHNUM(KOHFTN-IDX) =  "191"         )   AND
                  (RECE62-SRYYM             >=  "200910"      ))
      *
               IF ((RECE62-KOHNUM(KOHFTN-IDX) =  "015" OR "016")  AND
                   (RECE62-SRYYM             >=  "200604"      ))
               OR ((WRK-PREFNUM               =  "01"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "051"         )  AND
                   (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "91"
                                                   AND <= "95" )  AND
                   (RECE62-SRYYM             >=  "200510"      )  AND
                   (RECE62-SRYYM             <   "200810"      ))
               OR ((FLG-ZENKI-TOKUREI         =   1            )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "051"         ))
               OR ((FLG-ZENKI-TOKUREI         =   1            )  AND
                   (WRK-PREFNUM               =  "13"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "151"         ))
               OR ((WRK-PREFNUM               =  "01"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "183"         )  AND
                   (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "91"
                                                   AND <= "95" )  AND
                   (RECE62-SRYYM             >=  "200810"      ))
               OR ((FLG-ZENKI-TOKUREI         =   1            )  AND
                   (WRK-PREFNUM               =  "23"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "191"         )  AND
                   (RECE62-SRYYM             >=  "200910"      )  AND
                   (RECE62-SRYYM             <=  "201108"      ))
               OR ((FLG-ZENKI-TOKUREI         =   1            )  AND
                   (WRK-PREFNUM               =  "23"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "191"         )  AND
                   (RECE62-TEISYUTUSAKI       =   1            )  AND
                   (RECE62-SRYYM             >=  "201109"      ))
                CONTINUE
               ELSE
                COMPUTE  WRK-FTNKEI2 = RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                     + WRK-SKJ-FTN(KOHFTN-IDX + 1)
      *
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI2 +  5
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI4 / 10
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI4 * 10
      *
                MOVE     RECE62-FTNMONEY(KOHFTN-IDX + 1)  
                                   TO  WRK-FTNKEI3
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 +  5
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 / 10
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 * 10
      *
                PERFORM  210451-KOHFTN-KINGAKU-SEC
      *
                IF  RECE62-KOHNUM(KOHFTN-IDX) =  "012" OR "025"
                  IF    RECE62-KOUREI   =  "1" OR "2"
                    CONTINUE
                  ELSE
                    IF  (KOHFTN-IDX       =   2   )
                    AND (RECE62-KOHNUM(1) =  "010")
                    AND (RECE62-KOHNUM(3) =  SPACE)
                    AND (RECE62-KOHNUM(4) =  SPACE)
                      IF  (WRK-NYUJGNGAK  NOT =  ZERO               )
                      AND (WRK-NYUJGNGAK  NOT =
                               WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1))
                        COMPUTE WRK-NYUJGNGAK2 =
                                WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                                0.5
                        MOVE    WRK-NYUJGNGAK2
                                TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                    RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                      END-IF
                    END-IF
                  END-IF
                  IF  (WRK-NYUJGNGAK  NOT =  ZERO               )
                  AND (WRK-NYUJGNGAK  >
                           RECE62-FTNMONEY(KOHFTN-IDX + 1)      )
                  AND (WRK-KOHTAN-SHOKUJIRYOYOHI(KOHFTN-IDX + 1)
                                      NOT =  ZERO               )
                  AND (WK-GENGAKUKBN      =  ZERO               )
                    COMPUTE  WRK-FTNKEI2 =
                             RECE62-FTNMONEY(KOHFTN-IDX + 1)  +
                             WRK-KOHTAN-SHOKUJIRYOYOHI(KOHFTN-IDX + 1)
                    IF  WRK-NYUJGNGAK <= WRK-FTNKEI2
                      MOVE  WRK-NYUJGNGAK
                          TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                              RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                    ELSE
                      MOVE  WRK-FTNKEI2
                          TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                              RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                ELSE
                  IF  WRK-NYUJGNGAK  NOT =  ZERO
                    IF  WRK-FTNKEI3  =  WRK-NYUJGNGAK
                      MOVE  WRK-FTNKEI3  
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                    END-IF
                    IF  WRK-FTNKEI3  <  WRK-NYUJGNGAK
                    AND WRK-FTNKEI4  =  WRK-NYUJGNGAK
                      MOVE  WRK-FTNKEI4
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                    END-IF
                    IF  WRK-FTNKEI3  <  WRK-NYUJGNGAK
                    AND WRK-FTNKEI4  <  WRK-NYUJGNGAK
                      MOVE  WRK-FTNKEI2
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
               END-IF
      *
             END-IF
      *
           END-PERFORM
      *
           EVALUATE   WRK-PREFNUM
      *
             WHEN    "01"
      *
               IF     (RECE62-KOHNUM(1)    =  "051" OR "091")
               AND    (RECE62-KOHHBTNUM(2) =  "41"          )
               AND    (RECE62-SRYYM       <=  "200803"      )
      *
                   MOVE     ZERO     TO   WRK-JYOGEN41
      *
                   COMPUTE  WRK-FTNKEI =  RECE62-TOTALTEN(3)
                                       *  10
                                       *  RECE62-HON-NYUKFTNRATE(2)
                                       /  100
                   IF  RECE62-HON-NYUKFTNRATE(2) = 10
                     EVALUATE    RECE62-TEISYOTOKU2(2)
                       WHEN    SPACE
                        IF  RECE62-SRYYM  >=  "200610"
                            MOVE   44400  TO  WRK-JYOGEN41
                        ELSE
                            MOVE   40200  TO  WRK-JYOGEN41
                        END-IF
                       WHEN    "1"
                       WHEN    "4"
                            MOVE   15000  TO  WRK-JYOGEN41
                       WHEN    "2"
                       WHEN    "3"
                            MOVE   24600  TO  WRK-JYOGEN41
                     END-EVALUATE
                   ELSE
                     IF    RECE62-SRYYM  >=  "200610"
                       COMPUTE   WRK-FTNKEI2  =
                                 RECE62-TOTALTEN(3)   *   10
                       IF   WRK-FTNKEI2  >  267000
                          COMPUTE  WRK-FTNKEI3 =
                         (( WRK-FTNKEI2 -  267000 ) * 0.01 )
                                                    + 0.5
                          COMPUTE  WRK-JYOGEN41  =   80100
                                                 +   WRK-FTNKEI3
                       ELSE
                          MOVE   80100   TO   WRK-JYOGEN41
                       END-IF
                     ELSE
                       COMPUTE   WRK-FTNKEI2  =
                                 RECE62-TOTALTEN(3)   *   10
                       IF   WRK-FTNKEI2  >  361500
                          COMPUTE  WRK-FTNKEI3 =
                         (( WRK-FTNKEI2 -  361500 ) * 0.01 )
                                                    + 0.5
                          COMPUTE  WRK-JYOGEN41  =   72300
                                                 +   WRK-FTNKEI3
                       ELSE
                          MOVE   72300   TO   WRK-JYOGEN41
                       END-IF
                     END-IF
                   END-IF
                   IF  ( WRK-JYOGEN41  NOT =  ZERO  )
                   AND ( WRK-JYOGEN41  >  WRK-FTNKEI)
                       MOVE   WRK-FTNKEI   TO  WRK-FTNKEI4
                   ELSE
                       MOVE   WRK-JYOGEN41 TO  WRK-FTNKEI4
                   END-IF
                   MOVE RECE62-FTNMONEY(3) TO RECE62-KOH-SAIKEI
                   MOVE 1                  TO RECE62-KOH-SAIKEIFLG
                   MOVE WRK-FTNKEI4        TO RECE62-FTNMONEY(3)
                                              RECE62-FTNMONEY-KOJ(3)
      *
               END-IF
      *
             WHEN    "13"
      *
               IF   RECE62-SRYYM   >=  "200710"
               AND  RECE62-SRYYM   <=  "200909"
                 PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >    4
                   IF   RECE62-KOHNUM(KOHFTN-IDX) = "588"
                     COMPUTE  RECE62-FTNMONEY(KOHFTN-IDX + 1)        =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                     COMPUTE  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                   END-IF
                 END-PERFORM
               END-IF
      *
               IF    ((RECE62-KOUREI  =  "1" OR "2") AND
                      (FLG-KOUGAKU    =   1        ))
               OR    ( RECE62-KOUREI  =  "3"        )
               OR    ( RECE62-KOUREI  =  SPACE      )
      *
                 PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >    4
                   IF  (RECE62-KOHNUM(KOHFTN-IDX) = 
                          "180" OR "380" OR "181" OR "381"        )
                   AND (RECE62-HON-NYUMJGNGAK(KOHFTN-IDX)
                                 > RECE62-FTNMONEY(KOHFTN-IDX + 1))
                     COMPUTE  RECE62-FTNMONEY(KOHFTN-IDX + 1)        =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                     COMPUTE  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                   END-IF
                 END-PERFORM
      *
               END-IF
      *
           END-EVALUATE
      *
      *    公費一部負担金レセ記載フラグの編集
      *    公費一部負担金０円記載フラグの編集
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                       UNTIL    KOHFTN-IDX     >    4
      *
              IF   RECE62-KOHNUM(KOHFTN-IDX)(1:1) >=  "1" AND <=  "8"
      *
                MOVE    SPACE   TO   WRK-ZEROKISAIFLG
      *
      *         その他記載フラグ編集
                IF    RECE62-SRYYM        >=  "200804"
                  INITIALIZE                   SYSKANRI-REC
                  MOVE    "2010"           TO  SYS-KANRICD
                  MOVE    RECE62-KOHNUM(KOHFTN-IDX)
                                           TO  SYS-KBNCD
                  MOVE    RECE62-SRYYM     TO  SYS-STYUKYMD (1:6)
                  MOVE    "01"             TO  SYS-STYUKYMD (7:2)
                  MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
                  MOVE    SPA-HOSPNUM      TO  SYS-HOSPNUM
                  MOVE    SYSKANRI-REC     TO  MCPDATA-REC
                  MOVE    "tbl_syskanri"   TO  MCP-TABLE
                  MOVE    "key10"          TO  MCP-PATHNAME
                  PERFORM   900-DBSELECT-SEC
                  IF      MCP-RC           =   ZERO
                    MOVE  "tbl_syskanri"   TO  MCP-TABLE
                    MOVE  "key10"          TO  MCP-PATHNAME
                    PERFORM 960-KANRIMST-READ-SEC
                    IF      FLG-SYSKANRI     =   ZERO
                      MOVE   MCPDATA-REC   TO  SYS-2010-REC
                      PERFORM   210454-ETCKISAIFLGINF-HENSYU-SEC
                    END-IF
                  END-IF
                  MOVE    "tbl_syskanri"   TO  MCP-TABLE
                  MOVE    "key10"          TO  MCP-PATHNAME
                  PERFORM   900-CLOSE-SEC
                END-IF
      *
                IF  (RECE62-HON-NYUDJGNGAK(KOHFTN-IDX)    NOT = ZERO)
                OR  (RECE62-HON-NYUMJGNGAK(KOHFTN-IDX)    NOT = ZERO)
                OR  (RECE62-HON-NYUMJGNCNT(KOHFTN-IDX)    NOT = ZERO)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200404"
                  IF  (WRK-PREFNUM                =   13           )
                  AND (RECE62-KOHNUM(KOHFTN-IDX)  =  "151" OR "451")
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF  (WRK-PREFNUM                =   28           )
                  AND (RECE62-KOHNUM(KOHFTN-IDX)  =  "186"         )
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
      ***           MOVE SPACE  TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF ((WRK-PREFNUM               =   05           ) AND
                      (RECE62-KOHNUM(KOHFTN-IDX) =  "174"         ))
                  OR ((WRK-PREFNUM               =   12           ) AND
                      (RECE62-KOHNUM(KOHFTN-IDX) =  "183"         ))
                  OR ((WRK-PREFNUM               =   34           ) AND
                      (RECE62-KOHNUM(KOHFTN-IDX) =  "391" OR "392"))
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF  (WRK-PREFNUM               =   08            )
                  AND (RECE62-KOHNUM(KOHFTN-IDX)(1:1)
                                                >=  "1" AND <=  "8")
                   IF (RECE62-HON-NYUDJGNGAK(KOHFTN-IDX)    NOT = ZERO)
                   OR (RECE62-HON-NYUMJGNGAK(KOHFTN-IDX)    NOT = ZERO)
                   OR (RECE62-HON-NYUMJGNCNT(KOHFTN-IDX)    NOT = ZERO)
                      MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                   END-IF
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200610"
                  IF  (WRK-PREFNUM               =   25      )
                  AND (RECE62-KOHNUM(KOHFTN-IDX)(1:1)
                                          >=  "1" AND <=  "8")
                    MOVE  "1" TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF  (WRK-PREFNUM               =   33      )
                  AND (RECE62-KOHNUM(KOHFTN-IDX)(1:1)
                                          >=  "1" AND <=  "8")
                    MOVE  "1" TO  RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200702"
                  IF  (WRK-PREFNUM               =   07  )
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =  "281")
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF   (RECE62-SRYYM        >=  "200704")
                AND  (RECE62-SRYYM        <=  "200803")
                  IF  (WRK-PREFNUM               =   01            )
                  AND (RECE62-HKNNUM         NOT =  "060" AND "067")
                  AND (KOHFTN-IDX                =    1            )
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =  "141" OR  "241")
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200810"
                  IF  (WRK-PREFNUM               =   01  )
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =  "183")
                    MOVE "1" TO  RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                    IF  RECE62-KOHFTNJANUM(KOHFTN-IDX)(5:3)  = "602"
                     MOVE  "1"  TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                     MOVE  "1"  TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    ELSE
                     MOVE SPACE TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                     MOVE SPACE TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200904"
                  IF  (WRK-PREFNUM               =   08  )
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =  "152")
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200910"
                  IF  (WRK-PREFNUM               =   23  )
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =  "191")
                    IF  RECE62-KOHFTNJANUM(KOHFTN-IDX)(5:3)  = "602"
                     MOVE  "1"  TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                     MOVE  "1"  TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    ELSE
                     MOVE SPACE TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                     MOVE SPACE TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
      *
                IF   (WRK-ZEROKISAIFLG                    =  "2")
                AND  (RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1) =  "1")
                    MOVE  SPACE TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                END-IF
      *
              ELSE
      *
                IF    RECE62-SRYYM        >=  "200404"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "015" OR "016"
                                                          OR "051"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "012"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE SPACE  TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF  (RECE62-KOHNUM(KOHFTN-IDX) =  "010" OR "021"   )
                   IF ( RECE62-HKNJANUM(1:6)  =
                        "133041" OR "133074" OR "133090" OR "133116" OR
                        "133132" OR "133140" OR "133157" OR "133165" OR
                        "133173" OR "133181" OR "133207" OR "133223" OR
                        "133249" OR "133256" OR "133272" )
                   OR ((RECE62-HKNJANUM(1:6) =  "233064"
                                             OR "133280") AND
                       (RECE62-SRYYM        <=  "201103"))
                   OR ((RECE62-HKNJANUM(1:6) =  "283077") AND
                       (RECE62-SRYYM        <=  "201111"))
      *
                   OR ( RECE62-HKNJANUM(1:6) =  "133033"
                                             OR "133066"
                                             OR "133199" )
      *****        OR ((RECE62-HKNJANUM(1:6) =  "133033"
      *****                                  OR "133066"
      *****                                  OR "133199") AND
      *****            (RECE62-SRYYM        <=  "201203"))
                    IF  ( RECE62-RJNHKNNUM  NOT =  SPACE    )
                    OR  ((WRK-PREFNUM           =  "29"    ) AND
                         (RECE62-HKNJANUM(1:6)  =  "133033"))
                      CONTINUE
                    ELSE
                      MOVE  "1" TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                      MOVE  "1" TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                   END-IF
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200504"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "052"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF   (RECE62-SRYYM        >=  "200510")
                AND  (RECE62-SRYYM        <=  "200809")
                  IF  ( WRK-PREFNUM               =   01   )
                  AND ( RECE62-KOHNUM(KOHFTN-IDX) =  "051" )
                  AND ((RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2)
                                      >= "91" AND <= "95" ) OR
                       (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2)
                                      >= "71" AND <= "88" ))
                    MOVE  "1" TO  RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200604"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "021"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "012"
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    IF   ( KOHFTN-IDX        =     1   )
                    AND  ( RECE62-HKNNUM     =   SPACE )
                    AND  ( RECE62-KOHNUM(2)  =   SPACE )
                    AND  ( RECE62-KOHNUM(3)  =   SPACE )
                    AND  ( RECE62-KOHNUM(4)  =   SPACE )
                     MOVE SPACE TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200610"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "024" OR "079"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200704"
                  IF  (RECE62-KOUREI             =  "1" OR "2")
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =  "010"     )
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "011" OR "020"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE SPACE  TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200804"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "038" OR "025"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "025"
                    IF   ( KOHFTN-IDX        =     1   )
                    AND  ( RECE62-HKNNUM     =   SPACE )
                    AND  ( RECE62-KOHNUM(2)  =   SPACE )
                    AND  ( RECE62-KOHNUM(3)  =   SPACE )
                    AND  ( RECE62-KOHNUM(4)  =   SPACE )
                     MOVE SPACE TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
      *
              END-IF
      *
           END-PERFORM
      *
           IF   IDZ  =  1
            EVALUATE   WRK-PREFNUM
      *
             WHEN    "29"
      *
                IF    RECE62-TEISYUTUSAKI   =   2 OR 6
                   PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                               UNTIL    KOHFTN-IDX     >    4
      *
                     IF   RECE62-KOHHBTNUM(KOHFTN-IDX) =  "71" OR "81"
                                                       OR "91"
                       IF   RECE62-FTNMONEY(KOHFTN-IDX + 1) NOT = ZERO
                        MOVE  ZERO  TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                        MOVE  SPACE TO
                                    RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                       END-IF
                     END-IF
      *
                   END-PERFORM
                END-IF
      *
             WHEN    "32"
      *
                PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                            UNTIL    KOHFTN-IDX     >    4
      *
                  IF ((RECE62-KOHNUM(KOHFTN-IDX)           = "393") AND
                      (RECE62-KOHFTNJANUM(KOHFTN-IDX)(1:7)
                                                       = "9032005") AND
                      (RECE62-SRYYM                   >=  "201007") AND
                      (RECE62-TEISYUTUSAKI             =   2 OR 6 ))
                  OR ((RECE62-KOHNUM(KOHFTN-IDX)           = "493") AND
                      (RECE62-KOHFTNJANUM(KOHFTN-IDX)(1:7)
                                                       = "9032002") AND
                      (RECE62-SRYYM                   >=  "201107") AND
                      (RECE62-TEISYUTUSAKI             =   2 OR 6 ))
                  OR ((RECE62-KOHNUM(KOHFTN-IDX)           = "790") AND
                      (RECE62-SRYYM                   >=  "201107") AND
                      (RECE62-TEISYUTUSAKI             =   2 OR 6 ))
                    IF   RECE62-FTNMONEY(KOHFTN-IDX + 1) NOT = ZERO
                      MOVE  ZERO  TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                      MOVE  SPACE TO
                                  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
      *
                END-PERFORM
      *
             WHEN    "35"
      *
                IF   (RECE62-SRYYM         >=  "201004")
                AND  (RECE62-TEISYUTUSAKI   =   2 OR 6 )
                   PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                               UNTIL    KOHFTN-IDX     >    4
      *
                     IF   RECE62-KOHNUM(KOHFTN-IDX) =  "781"
                       IF   RECE62-FTNMONEY(KOHFTN-IDX + 1) NOT = ZERO
                        MOVE  ZERO  TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                        MOVE  SPACE TO
                                    RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                       END-IF
                     END-IF
      *
                   END-PERFORM
                END-IF
      *
             WHEN    "39"
      *
               IF   (RECE62-SRYYM         >=  "200510")
               AND  (RECE62-TEISYUTUSAKI   =   2 OR 6 )
                  PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                              UNTIL    KOHFTN-IDX     >    4
      *
                    IF   RECE62-KOHHBTNUM(KOHFTN-IDX) =  "72"
                      IF   RECE62-FTNMONEY(KOHFTN-IDX + 1) NOT = ZERO
                       MOVE   ZERO  TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                       MOVE   SPACE TO
                                    RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                      END-IF
                    END-IF
      *
                  END-PERFORM
               END-IF
      *
            END-EVALUATE
           END-IF
      *
      *    一部負担金・食事療養費標準負担額区分の編集
      *
           IF      RECE62-KOUREI       NOT = SPACE
           AND     RECE62-TEISYOTOKU   NOT = SPACE
               EVALUATE    RECE62-TEISYOTOKU
                   WHEN    "1"
                       MOVE    "3"   TO   RECE62-SHOKUJIFTNKBN
                   WHEN    "2"
                       MOVE    "1"   TO   RECE62-SHOKUJIFTNKBN
                       IF   RECE62-TEISYOTOKU3 = "3"
                         MOVE  "2"   TO   RECE62-SHOKUJIFTNKBN
                       END-IF
      **           WHEN    "3"
      **               MOVE    "2"   TO   RECE62-SHOKUJIFTNKBN
                   WHEN    "4"
                       MOVE    "4"   TO   RECE62-SHOKUJIFTNKBN
               END-EVALUATE
           ELSE
               EVALUATE    RECE62-TEISYOTOKU3
                   WHEN    "1"
                       MOVE    "3"   TO   RECE62-SHOKUJIFTNKBN
                   WHEN    "2"
                       MOVE    "1"   TO   RECE62-SHOKUJIFTNKBN
                   WHEN    "3"
                       MOVE    "2"   TO   RECE62-SHOKUJIFTNKBN
                   WHEN    "4"
                       MOVE    "4"   TO   RECE62-SHOKUJIFTNKBN
               END-EVALUATE
           END-IF
           PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                     UNTIL    KOHFTN-IDX     >    4
             EVALUATE  RECE62-TEISYOTOKU2(KOHFTN-IDX)
               WHEN    "1"
                 MOVE   "3"  TO   RECE62-SHOKUJIFTNKBN2(KOHFTN-IDX)
               WHEN    "2"
                 MOVE   "1"  TO   RECE62-SHOKUJIFTNKBN2(KOHFTN-IDX)
      **       WHEN    "3"
      **         MOVE   "2"  TO   RECE62-SHOKUJIFTNKBN2(KOHFTN-IDX)
      **       WHEN    "4"
      **         MOVE   "4"  TO   RECE62-SHOKUJIFTNKBN2(KOHFTN-IDX)
             END-EVALUATE
           END-PERFORM
      *
           EVALUATE   WRK-PREFNUM
      *      群馬県地方公費
             WHEN    "10"
               IF  (RECE62-SRYYM        >=  "200804"    )
               AND (RECE62-TEISYUTUSAKI  =   6          )
                   PERFORM  210453-SEIKYUGAK-SKJ-HENSYU-SEC
               END-IF
           END-EVALUATE
      *
           IF  ( RECE62-HKNNUM          =  SPACE    )
           AND ( RECE62-KOHNUM(1)       =  "079"    )
           AND ( RECE62-KOHNUM(2)       =  "012"    )
           AND ( RECE62-SRYYM          >=  "200804" )
               MOVE     ZERO    TO    RECE62-TOTALTEN(3)
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   30
                 MOVE   ZERO    TO    RECE62-TENSU(KOHFTN-IDX 3)
               END-PERFORM
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   10
                 MOVE   ZERO    TO    RECE62-NYUKHNKEI(KOHFTN-IDX 3)
                                      RECE62-NYUTOKKEI(KOHFTN-IDX 3)
               END-PERFORM
               MOVE     ZERO    TO    RECE62-NYUKHNKEI2(3)
                                      RECE62-NYUTOKKEI2(3)
           END-IF
      *
           IF   ( RECE62-SHOKUJIRYOYOHI(1) = ZERO )
           AND  ( RECE62-SHOKUJIRYOYOHI(2) = ZERO )
           AND  ( RECE62-SHOKUJIRYOYOHI(3) = ZERO )
           AND  ( RECE62-SHOKUJIRYOYOHI(4) = ZERO )
           AND  ( RECE62-SHOKUJIRYOYOHI(5) = ZERO )
              PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                          UNTIL    KOHFTN-IDX     >    4
                MOVE  SPACE  TO  RECE62-FUKUSHIFLG-SKJ(KOHFTN-IDX)
                MOVE  SPACE  TO  RECE62-FUKUSHIFLG-SKJIPA(KOHFTN-IDX)
                MOVE  SPACE  TO  RECE62-FUKUSHIFLG-SKJSEI(KOHFTN-IDX)
              END-PERFORM
           END-IF
      *
           .
       21045-KOH-FUTAN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費負担（金額）取込み処理
      *****************************************************************
       210451-KOHFTN-KINGAKU-SEC               SECTION.
      *
           MOVE      ZERO             TO  WRK-NYUJGNGAK
      *
      *    公費月上限額取得
           INITIALIZE                     LNK-ORCSJGNGET-REC
           MOVE   RECE62-HOSPNUM      TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE   RECE62-NYUGAIKBN    TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE   RECE62-PTID         TO  LNK-ORCSJGNGET-PTID
           MOVE   RECE62-KOHNUM(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE   RECE62-KOHID(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-KOHID
           MOVE   RECE62-SRYYM        TO  LNK-ORCSJGNGET-SRYYM
           MOVE   RECE62-SRYYM        TO  LNK-ORCSJGNGET-SKYEDYMD(1:6)
           MOVE   "31"                TO  LNK-ORCSJGNGET-SKYEDYMD(7:2)
      *
           CALL    "ORCSJGNGET"       USING
                                      LNK-ORCSJGNGET-REC
                                      SPA-AREA
      *
           IF     LNK-ORCSJGNGET-RC   =   ZERO
             MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                      TO  WRK-NYUJGNGAK
           END-IF
      *
           .
       210451-KOHFTN-KINGAKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事請求額等の置き換え
      *****************************************************************
       210453-SEIKYUGAK-SKJ-HENSYU-SEC               SECTION.
      *
           IF  ( RECE62-HKNNUM       NOT = SPACE    )
           AND ( RECE62-KOHNUM(1)(1:1)   =  "0"     )
           AND ( RECE62-KOHNUM(2)(1:1)
                                   >= "1" AND <= "8")
           AND ( RECE62-SHOKUJIRYOYOHI(1) NOT =  ZERO           )
           AND ( RECE62-SHOKUJIRYOYOHI(2) NOT =  ZERO           )
           AND ((RECE62-SHOKUJINISSU(1)
                                 NOT = RECE62-SHOKUJINISSU(2)  ) OR
                (RECE62-SHOKUJIRYOYOHI(1)
                                 NOT = RECE62-SHOKUJIRYOYOHI(2)) OR
                (RECE62-SHOKUJIFTN(1)
                                 NOT = RECE62-SHOKUJIFTN(2)    ))
           AND ((RECE62-SHOKUJINISSU(1)
                                     = RECE62-SHOKUJINISSU(3)  ) AND
                (RECE62-SHOKUJIRYOYOHI(1)
                                     = RECE62-SHOKUJIRYOYOHI(3)) AND
                (RECE62-SHOKUJIFTN(1)
                                     = RECE62-SHOKUJIFTN(3)    ))
              COMPUTE  RECE62-SHOKUJINISSU(3) =
                       RECE62-SHOKUJINISSU(1) -
                       RECE62-SHOKUJINISSU(2)
              COMPUTE  RECE62-SHOKUJIRYOYOHI(3) =
                       RECE62-SHOKUJIRYOYOHI(1) -
                       RECE62-SHOKUJIRYOYOHI(2)
              COMPUTE  RECE62-SHOKUJIFTN(3) =
                       RECE62-SHOKUJIFTN(1) -
                       RECE62-SHOKUJIFTN(2)
           END-IF
      *
           IF  ( RECE62-HKNNUM       NOT = SPACE    )
           AND ( RECE62-KOHNUM(1)(1:1)   =  "0"     )
           AND ( RECE62-KOHNUM(2)(1:1)
                                   >= "1" AND <= "8")
           AND ( RECE62-SHOKUJIRYOYOHI(1) NOT =  ZERO           )
           AND ((RECE62-SHOKUJINISSU(1)
                                     = RECE62-SHOKUJINISSU(2)  ) AND
                (RECE62-SHOKUJIRYOYOHI(1)
                                     = RECE62-SHOKUJIRYOYOHI(2)) AND
                (RECE62-SHOKUJIFTN(1)
                                     = RECE62-SHOKUJIFTN(2)    ))
           AND ((RECE62-SHOKUJINISSU(1)
                                     = RECE62-SHOKUJINISSU(3)  ) AND
                (RECE62-SHOKUJIRYOYOHI(1)
                                     = RECE62-SHOKUJIRYOYOHI(3)) AND
                (RECE62-SHOKUJIFTN(1)
                                     = RECE62-SHOKUJIFTN(3)    ))
              MOVE     ZERO    TO   RECE62-SHOKUJINISSU(3)
              MOVE     ZERO    TO   RECE62-SHOKUJIRYOYOHI(3)
              MOVE     ZERO    TO   RECE62-SHOKUJIFTN(3)
              MOVE     "1"     TO   RECE62-FUKUSHIFLG-SKJ(2)
              MOVE     "1"     TO   RECE62-FUKUSHIFLG-SKJIPA(2)
              MOVE     "1"     TO   RECE62-FUKUSHIFLG-SKJSEI(2)
           END-IF
      *
           IF  ( RECE62-HKNNUM       NOT = SPACE    )
           AND ( RECE62-KOHNUM(1)(1:1)   =  "0"     )
           AND ( RECE62-KOHNUM(2)   = "972" OR "974")
           AND ( RECE62-KOHNUM(3)(1:1)
                                   >= "1" AND <= "8")
           AND ( RECE62-SHOKUJIRYOYOHI(1) NOT =  ZERO           )
           AND ( RECE62-SHOKUJIRYOYOHI(2) NOT =  ZERO           )
           AND ((RECE62-SHOKUJINISSU(1)
                                 NOT = RECE62-SHOKUJINISSU(2)  ) OR
                (RECE62-SHOKUJIRYOYOHI(1)
                                 NOT = RECE62-SHOKUJIRYOYOHI(2)) OR
                (RECE62-SHOKUJIFTN(1)
                                 NOT = RECE62-SHOKUJIFTN(2)    ))
           AND ((RECE62-SHOKUJINISSU(1)
                                     = RECE62-SHOKUJINISSU(4)  ) AND
                (RECE62-SHOKUJIRYOYOHI(1)
                                     = RECE62-SHOKUJIRYOYOHI(4)) AND
                (RECE62-SHOKUJIFTN(1)
                                     = RECE62-SHOKUJIFTN(4)    ))
              COMPUTE  RECE62-SHOKUJINISSU(4) =
                       RECE62-SHOKUJINISSU(1) -
                       RECE62-SHOKUJINISSU(2)
              COMPUTE  RECE62-SHOKUJIRYOYOHI(4) =
                       RECE62-SHOKUJIRYOYOHI(1) -
                       RECE62-SHOKUJIRYOYOHI(2)
              COMPUTE  RECE62-SHOKUJIFTN(4) =
                       RECE62-SHOKUJIFTN(1) -
                       RECE62-SHOKUJIFTN(2)
           END-IF
      *
           IF  ( RECE62-HKNNUM       NOT = SPACE    )
           AND ( RECE62-KOHNUM(1)(1:1)   =  "0"     )
           AND ( RECE62-KOHNUM(2)   = "972" OR "974")
           AND ( RECE62-KOHNUM(3)(1:1)
                                   >= "1" AND <= "8")
           AND ( RECE62-SHOKUJIRYOYOHI(1) NOT =  ZERO           )
           AND ((RECE62-SHOKUJINISSU(1)
                                     = RECE62-SHOKUJINISSU(2)  ) AND
                (RECE62-SHOKUJIRYOYOHI(1)
                                     = RECE62-SHOKUJIRYOYOHI(2)) AND
                (RECE62-SHOKUJIFTN(1)
                                     = RECE62-SHOKUJIFTN(2)    ))
           AND ((RECE62-SHOKUJINISSU(1)
                                     = RECE62-SHOKUJINISSU(4)  ) AND
                (RECE62-SHOKUJIRYOYOHI(1)
                                     = RECE62-SHOKUJIRYOYOHI(4)) AND
                (RECE62-SHOKUJIFTN(1)
                                     = RECE62-SHOKUJIFTN(4)    ))
              MOVE     ZERO    TO   RECE62-SHOKUJINISSU(4)
              MOVE     ZERO    TO   RECE62-SHOKUJIRYOYOHI(4)
              MOVE     ZERO    TO   RECE62-SHOKUJIFTN(4)
              MOVE     "1"     TO   RECE62-FUKUSHIFLG-SKJ(3)
              MOVE     "1"     TO   RECE62-FUKUSHIFLG-SKJIPA(3)
              MOVE     "1"     TO   RECE62-FUKUSHIFLG-SKJSEI(3)
           END-IF
      *
           .
       210453-SEIKYUGAK-SKJ-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    その他記載フラグ編集
      *****************************************************************
       210454-ETCKISAIFLGINF-HENSYU-SEC               SECTION.
      *
           EVALUATE  SYS-2010-JNISSUKBN
             WHEN      "0"
                    MOVE SPACE TO RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-JNISSU-TAIKBN
                 WHEN        "0"
                    MOVE  "1"  TO RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE62-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE62-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE62-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE62-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-TOTALTENKBN
             WHEN      "0"
                    MOVE SPACE TO RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-TOTALTEN-TAIKBN
                 WHEN        "0"
                    MOVE  "1"  TO RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE62-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE62-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE62-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE62-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-FTNMONEYKBN-N
             WHEN      "0"
                    MOVE SPACE TO RECE62-KISAIFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-FTNMONEY-TAIKBN-N
                 WHEN        "0"
                    MOVE  "1"  TO RECE62-KISAIFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE62-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE62-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE62-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE62-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE62-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE62-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE62-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE62-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-FTNZEROKBN-N
             WHEN      "0"
                    MOVE SPACE TO RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-FTNZERO-TAIKBN-N
                 WHEN        "0"
                    MOVE  "1"  TO RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE62-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE62-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE62-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE62-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               MOVE    SPACE   TO RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
               EVALUATE  SYS-2010-FTNZERO-TAIKBN-N
                 WHEN        "0"
                    MOVE  "2"  TO WRK-ZEROKISAIFLG
                 WHEN        "1"
                  IF   RECE62-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO WRK-ZEROKISAIFLG
                  END-IF
                 WHEN        "2"
                  IF   RECE62-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO WRK-ZEROKISAIFLG
                  END-IF
                 WHEN        "3"
                  IF   RECE62-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO WRK-ZEROKISAIFLG
                  END-IF
                 WHEN        "4"
                  IF   RECE62-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO WRK-ZEROKISAIFLG
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-SKJKBN
             WHEN      "0"
                    MOVE SPACE TO RECE62-EKF-SKJFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-SKJ-TAIKBN
                 WHEN        "0"
                    MOVE  "1"  TO RECE62-EKF-SKJFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE62-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE62-EKF-SKJFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE62-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE62-EKF-SKJFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE62-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE62-EKF-SKJFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE62-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE62-EKF-SKJFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-OCRKBN
             WHEN      "0"
                    MOVE SPACE TO RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-OCR-TAIKBN
                 WHEN        "0"
                    MOVE  "1"  TO RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE62-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE62-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE62-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE62-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           .
       210454-ETCKISAIFLGINF-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    一部負担金再掲の計算処理
      *****************************************************************
       21046-SAIKEI-KEISAN-SEC               SECTION.
      *
           IF   FLG-ZENKOKUKOHI-NISYU2  =  1
              MOVE     ZERO     TO    FLG-KEISAN-TOK1
                                      FLG-KEISAN-TOK2
           END-IF
      *
           IF   FLG-KEISAN-TOK1  =  1
           AND  FLG-KEISAN-TOK2  =  1
              MOVE   FTN-KOH-XXX   TO  WRK-KINGAKU-TOK8
              IF     FTN-KOH-XXX    >  WRK-CHK-ICHIBUGAKU
                COMPUTE  WRK-KINGAKU-TOK9 = FTN-KOH-XXX
                                          - WRK-CHK-ICHIBUGAKU
              ELSE
                MOVE      ZERO     TO  WRK-KINGAKU-TOK9
              END-IF
      *
              COMPUTE  WRK-KINGAKU-TOK3 = WRK-CHK-ICHIBUGAKU
                                        + WRK-KINGAKU-TOK1
              IF  WRK-KINGAKU-TOK3  >  WRK-KINGAKU-TOK7
                 MOVE  WRK-KINGAKU-TOK7  TO  FTN-KOH-XXX
                 IF    WRK-KINGAKU-TOK7  >   WRK-CHK-ICHIBUGAKU
                   COMPUTE  WRK-KINGAKU-TOK4 = WRK-KINGAKU-TOK7
                                             - WRK-CHK-ICHIBUGAKU
                 ELSE
                   MOVE   ZERO     TO  WRK-KINGAKU-TOK4
                 END-IF
              ELSE
                 MOVE  WRK-KINGAKU-TOK3  TO  FTN-KOH-XXX
                 MOVE  WRK-KINGAKU-TOK1  TO  WRK-KINGAKU-TOK4
              END-IF
              IF  WRK-KINGAKU-TOK9  >  WRK-KINGAKU-TOK4
                 COMPUTE    WRK-KINGAKU-TOK5 = WRK-KINGAKU-TOK9
                                             - WRK-KINGAKU-TOK4
                 ADD   WRK-KINGAKU-TOK5  TO  WRK-KOH-GAI
              END-IF
           END-IF
      *
           MOVE    ZERO   TO   WRK-KEISAN-YYY
      *
           IF      RECE62-KOUREI  =  "2"
      *
               IF    ( FLG-JYOGENKBN2    =   5 )
               AND   ( FLG-KOHYONKAIME   =   1 )
                  PERFORM   210461-KOHIHEIYO-KEISAN-SEC
               END-IF
               IF      FLG-JYOGENKBN   =   1
                  MOVE     WRK-JYOGENKBN-TEN  TO  WRK-JYOGENKBN-TEN9
                  PERFORM  210468-SYUHKN-JYOHEN-KEISAN-SEC
      *
                  EVALUATE   WK-GENGAKUKBN
                    WHEN        1
                     IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO     TO   WRK-KINGAKU-GENBUTU3
                     ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         IF    WRK-KINGAKU-GENBUTU3  NOT = ZERO
                           COMPUTE  WRK-KINGAKU-GENBUTU3  =
                                   (WRK-KINGAKU-GENBUTU3  *
                                    WK-GENGAKU-RITUX      /
                                    100) + 0.5
                         END-IF
                     END-IF
                    WHEN        2
                     CONTINUE
                    WHEN        3
                    WHEN        4
                         MOVE   ZERO     TO   WRK-KINGAKU-GENBUTU3
                  END-EVALUATE
      *
               END-IF
      *
               MOVE    9999999    TO   WRK-CHK-KINGAKU
               MOVE    9999999    TO   WRK-CHK-KINGAKU2
               MOVE    9999999    TO   WRK-CHK-KINGAKU3
               EVALUATE  FLG-JYOGENKBN  ALSO  FLG-JYOGENKBN2
                 WHEN       1           ALSO     ZERO
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                 WHEN       ANY         ALSO     1
                   IF  FLG-KOHYONKAIME = 1
                    IF  FLG-TOKU75 = 3
                     MOVE  12300                TO  WRK-CHK-KINGAKU2
                    ELSE
                     MOVE  24600                TO  WRK-CHK-KINGAKU2
                    END-IF
                   ELSE
                    IF  FLG-TOKU75 = 3
                     MOVE  17700                TO  WRK-CHK-KINGAKU2
                    ELSE
                     MOVE  35400                TO  WRK-CHK-KINGAKU2
                    END-IF
                   END-IF
                 WHEN       ZERO        ALSO     2
                   IF  FLG-TOKU75 = 3
                     MOVE    5000               TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1           ALSO     2
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    5000               TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     3
                   IF  FLG-TOKU75 = 3
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    20000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1           ALSO     3
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    20000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       1           ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       ZERO        ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                 WHEN       1           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                 WHEN       2           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
               END-EVALUATE
               IF      FTN-KOH-XX3   =   ZERO
                   MOVE    9999999              TO  WRK-CHK-KINGAKU3
               END-IF
      *
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2       = 9999999)
                 MOVE   WRK-CHK-KINGAKU   TO   WRK-CHK-KEIKASOCHI1
                 IF   (FLG-JYOGENKBN        =   1   )
                 AND  (FLG-GENBUTU-TAISYOOK =   ZERO)
                     MOVE   9999999  TO   WRK-CHK-KEIKASOCHI1
                 END-IF
                 IF   WRK-KOH-GAI-GEN70    >=  WRK-CHK-KEIKASOCHI1
                    IF   RECE62-KOHNUM(1)  =  SPACE
                    AND  RECE62-KOHNUM(2)  =  SPACE
                    AND  RECE62-KOHNUM(3)  =  SPACE
                    AND  RECE62-KOHNUM(4)  =  SPACE
                    AND  FLG-HOKENICHIBU   =  ZERO
                    AND  WRK-KOH-GAI-GEN70 =  WRK-HOKENICHIBUGAK
                      MOVE  "3"      TO   RECE62-KOUREI
                    END-IF
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
               END-IF
               IF  (WRK-CHK-KINGAKU        = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                IF   FLG-KEISAN-TOK1  =  1
                AND  FLG-KEISAN-TOK2  =  1
                 IF   WRK-KINGAKU-TOK8     >=  WRK-CHK-KINGAKU2
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
                ELSE
                 IF   FTN-KOH-XXX          >=  WRK-CHK-KINGAKU2
                 OR   FTN-KOH-XX3          >=  WRK-CHK-KINGAKU3
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
                END-IF
               END-IF
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                IF   FLG-JYOGENKBN  =  1
                  MOVE  WRK-CHK-KINGAKU  TO  WRK-CHK-KEIKASOCHI1
                  IF  FLG-GENBUTU-TAISYOOK  =  ZERO
                    MOVE   9999999       TO  WRK-CHK-KEIKASOCHI1
                  END-IF
                  COMPUTE  WRK-CHK-KEIKASOCHIXX  =  WRK-KOH-GAI-GEN70
                                                 +  WRK-KOH-FTN-GEN70
                  IF   (FLG-JYOGENKBN2 = 5 )
                  AND  (FLG-JYOGENKBN3 = 1 )
                    MOVE   WRK-KINGAKU-GENBUTU
                                         TO  WRK-CHK-KINGAKU
                  END-IF
                ELSE
                  MOVE     9999999       TO  WRK-CHK-KEIKASOCHI1
                END-IF
                IF   WRK-JYOGENKBN-TEN5  NOT = ZERO
                  COMPUTE WRK-JYOGENKBN-TEN9 =
                          WRK-JYOGENKBN-TEN4 +
                          WRK-JYOGENKBN-TEN5
                  COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN9
                                      * 10
                                      * RECE62-KYURATE
                                      / 100
                  COMPUTE WRK-FTNKEI6 = WRK-FTNKEI6 +  5
                  COMPUTE WRK-FTNKEI6 = WRK-FTNKEI6 / 10
                  COMPUTE WRK-FTNKEI6 = WRK-FTNKEI6 * 10
                  IF  ( WRK-FTNKEI6        >=  21000 )
                  OR  ((FLG-HOKENICHIBU2  NOT = ZERO) AND
                       (FLG-HOKENICHIBU3  NOT = ZERO))
                    COMPUTE WRK-JYOGENKBN-TEN9 =
                            WRK-JYOGENKBN-TEN4 +
                            WRK-JYOGENKBN-TEN5 +
                            WRK-JYOGENKBN-TEN2
                    PERFORM  210468-SYUHKN-JYOHEN-KEISAN-SEC
                    COMPUTE  WRK-FTNKEI5 = WRK-JYOGENKBN-TEN9
                                         * 10
                                         * RECE62-KYURATE
                                         / 100
                    COMPUTE  WRK-FTNKEI5 = WRK-FTNKEI5 +  5
                    COMPUTE  WRK-FTNKEI5 = WRK-FTNKEI5 / 10
                    COMPUTE  WRK-FTNKEI5 = WRK-FTNKEI5 * 10
                    IF  WRK-KINGAKU-GENBUTU3 < WRK-FTNKEI5
                      IF  WRK-JYOGENKBN-TEN2  NOT = ZERO
                        IF  (((RECE62-KOHNUM(1)(1:1) = "0"   ) AND
                              (RECE62-KOHNUM(1)
                                       NOT = "012" AND "025" ))  OR
                             ( TBL-TOKATUKAIFLG(1)   =  1     ))
                        AND (  RECE62-KOHNUM(2)       = SPACE  )
                        AND (  RECE62-KOHNUM(3)       = SPACE  )
                        AND (  RECE62-KOHNUM(4)       = SPACE  )
                        AND (  RECE62-HKNCOMBI(2) NOT = ZERO   )
                        AND (  RECE62-TOTALTEN(1)
                                       NOT = RECE62-TOTALTEN(2))
                        AND (  FLG-HOKENICHIBU3  NOT = ZERO    )
                          IF WRK-KINGAKU-GENBUTU3 > RECE62-FTNMONEY(2)
                            COMPUTE  WRK-CHK-KOKIGAK9      =
                                     WRK-KINGAKU-GENBUTU3  -
                                     RECE62-FTNMONEY(2)
                          ELSE
                            MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                          END-IF
                          IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                            MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                          END-IF
      ***               ELSE
      ***                 MOVE     ZERO   TO   WRK-CHK-KEIKASOCHI1
                        END-IF
                      ELSE
                        MOVE       ZERO   TO   WRK-CHK-KEIKASOCHI1
                      END-IF
                    END-IF
                  END-IF
                END-IF
      *
                COMPUTE  WRK-CHK-KOKIGAK4 = RECE62-TOTALTEN(2)
                                          + RECE62-HENTOTALTEN(3)
                IF  (((RECE62-KOHNUM(1)(1:1)  = "0"             ) AND
                      (RECE62-KOHNUM(1)   NOT = "012" AND "025" )) OR
                     ( TBL-TOKATUKAIFLG(1)    =  1               ))
                AND (  RECE62-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
                AND (  RECE62-HON-NYUKFTNRATE(2)  =  100          )
                AND (  RECE62-KOHNUM(3)       =  SPACE            )
                AND (  RECE62-KOHNUM(4)       =  SPACE            )
                AND (  RECE62-HKNCOMBI(2) NOT = ZERO              )
                AND (  RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
                AND (( RECE62-TOTALTEN(1) = WRK-CHK-KOKIGAK4     ) OR
                     ( RECE62-TOTALTEN(1) = RECE62-HENTOTALTEN(3)))
                AND (  WRK-JYOGENKBN-TEN2 NOT = ZERO              )
                  COMPUTE WRK-JYOGENKBN-TEN9 =
                          RECE62-TOTALTEN(1) -
                          RECE62-TOTALTEN(2)
                  COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN9
                                      * 10
                                      * RECE62-KYURATE
                                      / 100
                  COMPUTE WRK-FTNKEI6 = WRK-FTNKEI6 +  5
                  COMPUTE WRK-FTNKEI6 = WRK-FTNKEI6 / 10
                  COMPUTE WRK-FTNKEI6 = WRK-FTNKEI6 * 10
                  MOVE  RECE62-TOTALTEN(1) TO  WRK-JYOGENKBN-TEN9
                  PERFORM  210468-SYUHKN-JYOHEN-KEISAN-SEC
                  IF WRK-KINGAKU-GENBUTU3 > RECE62-FTNMONEY(2)
                    COMPUTE  WRK-CHK-KOKIGAK9      =
                             WRK-KINGAKU-GENBUTU3  -
                             RECE62-FTNMONEY(2)
                  ELSE
                    MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                  END-IF
                  IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                    MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                  END-IF
                END-IF
      *
                IF   FLG-KEISAN-TOK1  =  1
                AND  FLG-KEISAN-TOK2  =  1
                 IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                 OR  (WRK-KINGAKU-TOK8      >=  WRK-CHK-KINGAKU2   )
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
                ELSE
                 IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                 OR  (FTN-KOH-XXX           >=  WRK-CHK-KINGAKU2   )
                 OR  (FTN-KOH-XX3           >=  WRK-CHK-KINGAKU3   )
                 OR  (FTN-KOH-XX2           >=  WRK-CHK-KINGAKU    )
                 OR  (FTN-KOH-XX4           >=  WRK-CHK-KINGAKU    )
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
                END-IF
               END-IF
               IF    WRK-PREFNUM       =  19
                IF ( RECE62-KOHHBTNUM(1) =  "41"        )
                OR ((RECE62-KOHNUM(1)  = "051" OR "091") AND
                    (RECE62-KOHHBTNUM(2) =  "41"       ) AND
                    (RECE62-SRYYM       >=  "200804"   ))
                    MOVE    "3"      TO   RECE62-KOUREI
                END-IF
               END-IF
               IF    WRK-PREFNUM       =  34
                IF   RECE62-TEISYUTUSAKI   =   2
                  IF  (RECE62-KOHHBTNUM(1) =  "90" OR "91" OR "92")
                  OR  (RECE62-KOHHBTNUM(2) =  "90" OR "91" OR "92")
                  OR  (RECE62-KOHHBTNUM(3) =  "90" OR "91" OR "92")
                  OR  (RECE62-KOHHBTNUM(4) =  "90" OR "91" OR "92")
                    MOVE    "3"      TO   RECE62-KOUREI
                  END-IF
                END-IF
               END-IF
               IF  (WRK-KEISAN-YYY    NOT =  ZERO)
               AND (RECE62-KOUREI         =  "3" )
                    MOVE    "2"      TO   RECE62-KOUREI
               END-IF
      *
               IF      RECE62-KOUREI  =  "3"
                 MOVE     ZERO    TO    RECE62-FTNMONEY(1)
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                  IF     TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  NOT =  1
                   IF  ( RECE62-KOHNUM(KOHFTN-IDX) =
                              "015" OR "016" OR "051" OR "021" OR
                              "024" OR "079" OR "052" OR "011" OR
                              "025" OR "038" OR "012" OR "020"     )
      ***          OR  ((WRK-PREFNUM             =   33           ) AND
      ***               (RECE62-KOHNUM(KOHFTN-IDX)(1:1)
      ***                                       >= "1" AND <=  "8"))
                   OR  ( TBL-TOKATUKAIFLG(KOHFTN-IDX)   =  1       )
                      MOVE  WRK-TAIHI-FTNMONEY    (KOHFTN-IDX + 1)
                                TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                      MOVE  WRK-TAIHI-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                                TO  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                   END-IF
                   IF    RECE62-KOHNUM(KOHFTN-IDX) = "010"
                      MOVE  ZERO    TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                   END-IF
                  END-IF
                 END-PERFORM
               END-IF
      *
           END-IF
      *
      ************
      *
           IF   FTN-KOH-XXX    >    WRK-CHK-ICHIBUGAKU
                COMPUTE  FTN-KOH-XXX = FTN-KOH-XXX - WRK-CHK-ICHIBUGAKU
           ELSE
                MOVE     ZERO    TO    FTN-KOH-XXX
           END-IF
      ***
      **   IF   RECE62-KOUREI          =  "1"
      **   AND  RECE62-KOHNUM(1)       =  "051"
      **     IF   WRK-KOH-KOUGAKU   NOT =  ZERO
      **       IF   WRK-KOH-KOUGAKU  <   RECE62-FTNMONEY(1)
      **          COMPUTE  RECE62-FTNMONEY(1) =  RECE62-FTNMONEY(1)
      **                                      -  WRK-KOH-KOUGAKU
      **       ELSE
      **          MOVE     ZERO    TO    RECE62-FTNMONEY(1)
      **       END-IF
      **       IF   WRK-KOH-KOUGAKU  <   FTN-KOH-XXX
      **          COMPUTE  FTN-KOH-XXX        =  FTN-KOH-XXX
      **                                      -  WRK-KOH-KOUGAKU
      **       ELSE
      **          MOVE     ZERO    TO    FTN-KOH-XXX
      **       END-IF
      **     END-IF
      **   END-IF
      *
           IF   RECE62-KOUREI          =  "2"
             IF   WRK-KEISAN-YYY    NOT =  ZERO
               IF   WRK-KEISAN-YYY   <   RECE62-FTNMONEY(1)
                  COMPUTE  RECE62-FTNMONEY(1) =  RECE62-FTNMONEY(1)
                                              -  WRK-KEISAN-YYY
               ELSE
                  MOVE     ZERO    TO    RECE62-FTNMONEY(1)
               END-IF
               IF   WRK-KEISAN-YYY   <   FTN-KOH-XXX
                  COMPUTE  FTN-KOH-XXX        =  FTN-KOH-XXX
                                              -  WRK-KEISAN-YYY
               ELSE
                  MOVE     ZERO    TO    FTN-KOH-XXX
               END-IF
             END-IF
           END-IF
      *
           MOVE    999999999   TO   WRK-FTNMONEY-MAE
           PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                     UNTIL   KOHFTN-IDX   >    4
      *          ７０歳代前半軽減特例措置対応
                IF  ((FLG-ZENKI-TOKUREI          =   1  ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "051"))
                OR  ((FLG-ZENKI-TOKUREI          =   1  ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "038"))
                OR  ((FLG-ZENKI-TOKUREI          =   1  ) AND
                     (WRK-PREFNUM                = "13" ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "151"))
                OR  ((FLG-ZENKI-TOKUREI          =   1     ) AND
                     (WRK-PREFNUM                = "23"    ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "191"   ) AND
                     (RECE62-SRYYM              >= "200910") AND
                     (RECE62-SRYYM              <= "201108"))
                OR  ((FLG-ZENKI-TOKUREI          =   1     ) AND
                     (WRK-PREFNUM                = "23"    ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "191"   ) AND
                     (RECE62-TEISYUTUSAKI        =   1     ) AND
                     (RECE62-SRYYM              >= "201109"))
                   IF   KOHFTN-IDX =  1
                     MOVE  RECE62-FTNMONEY(2)  TO  WRK-FTNMONEY-MAE
                   END-IF
                   PERFORM  210463-ZENKI-TOKUREI-OKIKAE-SEC
                ELSE
                   IF   RECE62-KOUREI   =  "1" OR "2"
                     CONTINUE
                   ELSE
                     IF   TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  =  1
                       PERFORM  210465-KOH-ICHIBUFTN-HENSYU-SEC
                     END-IF
                   END-IF
                END-IF
           END-PERFORM
      *
      *    減免公費対応
           IF  (WK-GENGAKUKBN    NOT =   ZERO )
           AND (WK-GENGAKUKBN    NOT = 3 AND 4)
             IF  (RECE62-SRYYM        >= "200709")
             AND (RECE62-HKNNUM    NOT =  SPACE  )
               IF (RECE62-KOHNUM(1) = "010" OR "012" OR "015" OR
                                      "016" OR "021" OR "024" OR
                                      "051" OR "052" OR "079" OR
                                      "025" OR "038" OR "011" OR
                                      "020"                     )
               OR (TBL-TOKATUKAIFLG(1)   =  1                   )
                 IF  RECE62-KOHNUM(1)    = "010"
                   IF   RECE62-KOUREI    = "1" OR "2"
                      PERFORM  210462-GENGAKU-OKIKAE-SEC
                   END-IF
                 ELSE
                   IF  ( WRK-PREFNUM       =  "01"         )
                   AND ( RECE62-KOHNUM(1)  =  "051"        )
                   AND ((RECE62-KOHJKYSNUM(1)(1:2) >= "91"
                                               AND <= "95") OR
                        (RECE62-KOHJKYSNUM(1)(1:2) >= "71"
                                               AND <= "88"))
                   AND ( RECE62-SRYYM      <  "200810"     )
                      CONTINUE
                   ELSE
                      PERFORM  210462-GENGAKU-OKIKAE-SEC
                   END-IF
                 END-IF
      **>      ELSE
      **>        IF  RECE62-KOHNUM(1) = "972" OR "974"
      **>          IF   RECE62-KOUREI    = "1" OR "2"
      **>            IF  RECE62-FTNMONEY(1) >=  FTN-KOH-XXX
      **>              COMPUTE WRK-TAIHI-GENKIN3  =  RECE62-FTNMONEY(1)
      **>                                         -  FTN-KOH-XXX
      **>              COMPUTE RECE62-FTNMONEY(1) =  RECE62-FTNMONEY(2)
      **>                                         +  WRK-TAIHI-GENKIN3
      **>              MOVE    RECE62-FTNMONEY(2) TO FTN-KOH-XXX
      **>            ELSE
      **>              MOVE    RECE62-FTNMONEY(2) TO RECE62-FTNMONEY(1)
      **>                                            FTN-KOH-XXX
      **>            END-IF
      **>          END-IF
      **>        END-IF
               END-IF
             END-IF
           END-IF
      ***
           MOVE     ZERO     TO    FLG-SAIKEI-KISAI
           EVALUATE   WRK-PREFNUM
             WHEN       "01"
               IF  (RECE62-SRYYM   >=  "200510")
               AND (RECE62-SRYYM   <   "200810")
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                   IF  ( RECE62-KOHNUM(KOHFTN-IDX) =  "051"         )
                   AND ((RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "91"
                                                        AND <= "95") OR
                        (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "71"
                                                        AND <= "88"))
                       MOVE     1     TO    FLG-SAIKEI-KISAI
                   END-IF
                 END-PERFORM
               END-IF
               IF  RECE62-SRYYM   >=  "200810"
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                   IF    RECE62-KOHNUM(KOHFTN-IDX) =  "183"
                       MOVE     1     TO    FLG-SAIKEI-KISAI
                   END-IF
                 END-PERFORM
               END-IF
           END-EVALUATE
      *
           IF   RECE62-KOUREI  =  SPACE  OR  "3"
                  MOVE     ZERO         TO  RECE62-KOUREI-SAIKEI
                                            RECE62-KOUREI-SAIKEI2
                                            FLG-ZENKOKUKOHI-NISYU
           ELSE
              IF    FTN-KOH-XXX   =   ZERO
                  MOVE     ZERO         TO  RECE62-KOUREI-SAIKEI
                                            RECE62-KOUREI-SAIKEI2
                                            FLG-ZENKOKUKOHI-NISYU
              ELSE
                  IF  FLG-KOH  =   2
                     ADD   WRK-KOH-GAI  TO  RECE62-FTNMONEY(2)
                                            RECE62-FTNMONEY-KOJ(2)
                  END-IF
                  MOVE     FTN-KOH-XXX  TO  RECE62-KOUREI-SAIKEI
      *
                  IF  RECE62-KOHNUM(1)   =  SPACE
                     MOVE  ZERO         TO  RECE62-KOUREI-SAIKEI
                  ELSE
                    IF  FLG-SAIKEI-KISAI  NOT = ZERO
                    OR  FLG-ZENKOKUKOHI-NISYU =  3
                         CONTINUE
                    ELSE
                      IF  (RECE62-KOHNUM(1)   NOT = "972" AND "974")
                      AND (RECE62-TOTALTEN(1) = RECE62-TOTALTEN(2) )
                      AND (FTN-KOH-XXX        = RECE62-FTNMONEY(1) )
                           MOVE  ZERO     TO  RECE62-KOUREI-SAIKEI
                      END-IF
      *
                      IF  (RECE62-KOHNUM(1)       = "972" OR  "974")
                      AND (RECE62-KOHNUM(2)   NOT = "972" AND "974")
                      AND (RECE62-TOTALTEN(1) = RECE62-TOTALTEN(3) )
                      AND (FTN-KOH-XXX        = RECE62-FTNMONEY(1) )
                           MOVE  ZERO     TO  RECE62-KOUREI-SAIKEI
                      END-IF
      *
                      IF  (RECE62-KOHNUM(1)  = "972" OR "974")
                      AND (RECE62-KOHNUM(2)  = SPACE         )
                           MOVE  ZERO     TO  RECE62-KOUREI-SAIKEI
                      END-IF
                    END-IF
                  END-IF
      *
                  IF  FTN-KOH-XX3   NOT =   ZERO
                    MOVE   FTN-KOH-XX3  TO  RECE62-KOUREI-SAIKEI2
                  ELSE
                   IF FTN-KOH-XX4   NOT =   ZERO
                    MOVE   FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI2
                   ELSE
                    MOVE   ZERO         TO  RECE62-KOUREI-SAIKEI2
                   END-IF
                  END-IF
      *
                  IF  FTN-KOH-XX5   NOT =   ZERO
                  AND FTN-KOH-XX6   NOT =   ZERO
                    MOVE   FTN-KOH-XX5  TO  RECE62-KOUREI-SAIKEI
                    MOVE   FTN-KOH-XX6  TO  RECE62-KOUREI-SAIKEI2
                    IF     FLG-KOH  =   2
                      COMPUTE RECE62-FTNMONEY(2)     =
                              RECE62-FTNMONEY(2)     - WRK-KOH-GAI
                      COMPUTE RECE62-FTNMONEY-KOJ(2) =
                              RECE62-FTNMONEY-KOJ(2) - WRK-KOH-GAI
                      COMPUTE WRK-CYOKI-KEISAN3 = RECE62-FTNMONEY(1)
                                                - FTN-KOH-XX5
                      ADD WRK-CYOKI-KEISAN3 TO RECE62-FTNMONEY(2)
                                               RECE62-FTNMONEY-KOJ(2)
      *
                      COMPUTE WRK-CYOKI-KEISAN  = RECE62-FTNMONEY(1)
                                                - WRK-KOH-GAI2
                      COMPUTE WRK-CYOKI-KEISAN2 = FTN-KOH-XX5
                                                + FTN-KOH-XX6
                      IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                        COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                                  - FTN-KOH-XX5
                        IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX6
                          MOVE  WRK-CYOKI-KEISAN3
                                        TO   RECE62-KOUREI-SAIKEI2
                          IF    WRK-CYOKI-KEISAN3  = ZERO
                             MOVE   1   TO   RECE62-YOBIETC(7)
                          END-IF
                        END-IF
                      END-IF
                    END-IF
                  END-IF
      *
                  IF   (FLG-KEISAN-TOK1        =   1     )
                  AND  (FLG-KEISAN-TOK2        =   1     )
                  AND  (FLG-ZENKOKUKOHI-NISYU  =   2 OR 4)
                      IF  WRK-PREFNUM  =  "27"
                        CONTINUE
                      ELSE
                        MOVE   ZERO      TO  FLG-ZENKOKUKOHI-NISYU
                      END-IF
                      MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI2
                      COMPUTE WRK-CYOKI-KEISAN  = RECE62-FTNMONEY(1)
                                                - WRK-KOH-GAI2
                      COMPUTE WRK-CYOKI-KEISAN2 = FTN-KOH-XXX
                                                + FTN-KOH-XX7
                      IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                        COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                                  - FTN-KOH-XXX
                        IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7
                          MOVE  WRK-CYOKI-KEISAN3
                                        TO   RECE62-KOUREI-SAIKEI2
                          IF    WRK-CYOKI-KEISAN3  = ZERO
                             MOVE   1   TO   RECE62-YOBIETC(7)
                          END-IF
                        END-IF
                      END-IF
                  END-IF
              END-IF
           END-IF
           IF      RECE62-SRYYM          >=  "200804"
             IF    RECE62-KOUREI-SAIKEI   =   ZERO
                  MOVE     999999999    TO  RECE62-KOUREI-SAIKEI
             END-IF
             IF    RECE62-KOUREI-SAIKEI2  =   ZERO
             AND   RECE62-YOBIETC(7)      =   ZERO
                IF   FLG-ZENKOKUKOHI-NISYU =  3
                  MOVE      1           TO  RECE62-YOBIETC(7)
                ELSE
                  MOVE     999999999    TO  RECE62-KOUREI-SAIKEI2
                END-IF
             END-IF
           END-IF
      *
           IF      RECE62-RJNGENMENKBN   =   "1"
      *
               COMPUTE  WRK-CHK-KEISAN1 = WRK-KOH-FTN         +  5
               COMPUTE  WRK-CHK-KEISAN1 = WRK-CHK-KEISAN1     / 10
               COMPUTE  WRK-CHK-KEISAN1 = WRK-CHK-KEISAN1     * 10
      *
               COMPUTE  WRK-CHK-KEISAN2 = WRK-CHK-KOHFTNGAKU  +  5
               COMPUTE  WRK-CHK-KEISAN2 = WRK-CHK-KEISAN2     / 10
               COMPUTE  WRK-CHK-KEISAN2 = WRK-CHK-KEISAN2     * 10
      *
               COMPUTE  WRK-CHK-KEIKASOCHIXX
                                  =   WRK-KOH-GAI2  +  WRK-CHK-KEISAN1
      *
               IF    RECE62-SRYYM  >=  "200610"
                     MOVE    44400    TO    WRK-CHK-KINGAKU
               ELSE
                     MOVE    40200    TO    WRK-CHK-KINGAKU
               END-IF
               EVALUATE   FLG-CYOKI
                 WHEN      ZERO
                   IF    RECE62-SRYYM  >=  "200610"
                     MOVE    44400    TO    WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    40200    TO    WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1
                   MOVE      10000    TO    WRK-CHK-KINGAKU2
                 WHEN       2
                   MOVE      20000    TO    WRK-CHK-KINGAKU2
               END-EVALUATE
               IF    RECE62-SRYYM  >=  "200610"
                     MOVE    44400    TO    WRK-CHK-KINGAKU3
               ELSE
                     MOVE    40200    TO    WRK-CHK-KINGAKU3
               END-IF
      *
               COMPUTE  WRK-CHK-KEIKASOCHI1  =  WRK-CHK-KINGAKU -
                                               (WRK-CHK-FTNGAKU +
                                                WRK-CHK-KEISAN2)
               COMPUTE  WRK-CHK-KEIKASOCHI2  =  WRK-CHK-KINGAKU2 -
                                                WRK-CHK-ICHIBUGAKU
               COMPUTE  WRK-CHK-KEIKASOCHI3  =  WRK-CHK-KINGAKU3 -
                                                WRK-CHK-ICHIBUGAKU
               IF   WRK-CHK-KEIKASOCHI1  <   ZERO
                    MOVE   ZERO    TO   WRK-CHK-KEIKASOCHI1
               END-IF
               IF   WRK-CHK-KEIKASOCHI2  <   ZERO
                    MOVE   ZERO    TO   WRK-CHK-KEIKASOCHI2
               END-IF
               IF   WRK-CHK-KEIKASOCHI3  <   ZERO
                    MOVE   ZERO    TO   WRK-CHK-KEIKASOCHI3
               END-IF
               IF   FLG-ZENKOH-ARI  =  ZERO
                 IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                 OR  (FTN-KOH-XXX           >=  WRK-CHK-KEIKASOCHI3)
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
                 END-IF
               ELSE
                 IF  FLG-RJNGENMEN-CHIARI    =  ZERO
                   IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                   OR  (FTN-KOH-XXX           >=  WRK-CHK-KEIKASOCHI2)
                   OR  (FTN-KOH-XX3           >=  WRK-CHK-KEIKASOCHI2)
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
                   END-IF
                 ELSE
                   MOVE     WRK-CHK-KINGAKU3  TO  WRK-CHK-KEIKASOCHI3
                   IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                   OR  (FTN-KOH-XXX           >=  WRK-CHK-KEIKASOCHI2)
                   OR  (FTN-KOH-XX3           >=  WRK-CHK-KEIKASOCHI2)
                   OR  (FTN-KOH-XX2           >=  WRK-CHK-KEIKASOCHI3)
                   OR  (FTN-KOH-XX4           >=  WRK-CHK-KEIKASOCHI3)
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
                   END-IF
                 END-IF
               END-IF
               IF   WK-GENGAKUKBN    NOT =   ZERO
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
               END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN   =   ZERO
      *
            IF      RECE62-SRYYM      >=  "200210"
             IF  (RECE62-KOUREI        =  "1" OR "2")
             AND (RECE62-KOHNUM(1)     =  SPACE     )
             AND (RECE62-KOHNUM(2)     =  SPACE     )
             AND (RECE62-KOHNUM(3)     =  SPACE     )
             AND (RECE62-KOHNUM(4)     =  SPACE     )
             AND (FLG-HOKENICHIBU  NOT =  ZERO      )
                 MOVE     RECE62-TOTALTEN(1)  TO  WRK-HANTEI-TOTALTEN
                 PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                 IF     RECE62-FTNMONEY(1)   >  WRK-KINGAKU3
                       COMPUTE  WRK-SKY-FTNMONEY-XXX =
                                RECE62-FTNMONEY(1)   -  WRK-KINGAKU3
                       DISPLAY  "1:WRK-SKY-FTNMONEY-XXX="
                                   WRK-SKY-FTNMONEY-XXX
                       MOVE   WRK-KINGAKU3   TO  RECE62-FTNMONEY(1)
                       IF   RECE62-RJNGENMENKBN   =   "1"
                           MOVE    4    TO      FLG-TOKKI
                           PERFORM   21013-TOKKI-HENSYU-SEC
                       END-IF
                 END-IF
             END-IF
      *
             IF  (RECE62-KOUREI          = "1"               )
             AND (RECE62-KYURATE     NOT = 30                )
             AND (((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                   (RECE62-KOHNUM(1)  NOT = "012" AND "025"))  OR
                  ( TBL-TOKATUKAIFLG(1)   =  1              ))
             AND (RECE62-KOHNUM(2)       = SPACE             )
             AND (RECE62-KOHNUM(3)       = SPACE             )
             AND (RECE62-KOHNUM(4)       = SPACE             )
             AND (RECE62-HKNCOMBI(2) NOT = ZERO              )
             AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
             AND ((FLG-HOKENICHIBU2  NOT = ZERO             )  OR
                  (FLG-HOKENICHIBU3  NOT = ZERO             ))
                 MOVE     ZERO    TO   FLG-CHIIKI
                 PERFORM  210466-HOKEN-ICHIBUFTN-CHK-SEC
             END-IF
      *
             COMPUTE  WRK-CHK-KOKIGAK4 = RECE62-TOTALTEN(2)
                                       + RECE62-HENTOTALTEN(3)
             IF  (RECE62-KOUREI          = "1"               )
             AND (RECE62-KYURATE     NOT = 30                )
             AND (((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                   (RECE62-KOHNUM(1)  NOT = "012" AND "025"))  OR
                  ( TBL-TOKATUKAIFLG(1)   =  1              ))
             AND (RECE62-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
             AND (RECE62-HON-NYUKFTNRATE(2)   =  100         )
             AND (RECE62-KOHNUM(3)       = SPACE             )
             AND (RECE62-KOHNUM(4)       = SPACE             )
             AND (RECE62-HKNCOMBI(2) NOT = ZERO              )
             AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
             AND ((RECE62-TOTALTEN(1)  = WRK-CHK-KOKIGAK4  ) OR
                  (RECE62-TOTALTEN(1)  =
                                      RECE62-HENTOTALTEN(3)) )
                 MOVE     ZERO    TO   FLG-CHIIKI
                 PERFORM  210466-HOKEN-ICHIBUFTN-CHK-SEC
             END-IF
      *
             IF  (((RECE62-KOUREI        = "1"             ) AND
                   (RECE62-KYURATE       = 30              ))  OR
                  ( RECE62-KOUREI        = "2"              ))
             AND (((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                   (RECE62-KOHNUM(1)  NOT = "012" AND "025"))  OR
                  ( TBL-TOKATUKAIFLG(1)   =  1              ))
             AND (RECE62-KOHNUM(2)       = SPACE             )
             AND (RECE62-KOHNUM(3)       = SPACE             )
             AND (RECE62-KOHNUM(4)       = SPACE             )
             AND (RECE62-HKNCOMBI(2) NOT = ZERO              )
             AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
             AND ((FLG-HOKENICHIBU2  NOT = ZERO             )  OR
                  (FLG-HOKENICHIBU3  NOT = ZERO             ))
                 MOVE     ZERO    TO   FLG-CHIIKI
                 PERFORM  210467-HOKEN-ICHIBUFTN-CHK2-SEC
             END-IF
      *
             COMPUTE  WRK-CHK-KOKIGAK4 = RECE62-TOTALTEN(2)
                                       + RECE62-HENTOTALTEN(3)
             IF  (((RECE62-KOUREI        = "1"             ) AND
                   (RECE62-KYURATE       = 30              ))  OR
                  ( RECE62-KOUREI        = "2"              ))
             AND (((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                   (RECE62-KOHNUM(1)  NOT = "012" AND "025"))  OR
                  ( TBL-TOKATUKAIFLG(1)   =  1              ))
             AND (RECE62-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
             AND (RECE62-HON-NYUKFTNRATE(2)   =  100         )
             AND (RECE62-KOHNUM(3)       = SPACE             )
             AND (RECE62-KOHNUM(4)       = SPACE             )
             AND (RECE62-HKNCOMBI(2) NOT = ZERO              )
             AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
             AND ((RECE62-TOTALTEN(1)  = WRK-CHK-KOKIGAK4  ) OR
                  (RECE62-TOTALTEN(1)  =
                                      RECE62-HENTOTALTEN(3)) )
                 MOVE     ZERO    TO   FLG-CHIIKI
                 PERFORM  210467-HOKEN-ICHIBUFTN-CHK2-SEC
             END-IF
      *
             COMPUTE  WRK-CHK-KOKIGAK4  = RECE62-TOTALTEN(2)
                                        + RECE62-HENTOTALTEN(3)
             COMPUTE  WRK-CHK-KOKIGAK   = RECE62-TOTALTEN(1)
                                        - WRK-JYOGENKBN-TEN6
             IF  (RECE62-KOUREI          =  "2"              )
             AND (FLG-JIRITU-CYUKANSOU1  =   1               )
             AND (FLG-JIRITU-CYUKANSOU2  =   1               )
             AND (WRK-CHK-KOKIGAK        =   WRK-CHK-KOKIGAK4)
               MOVE   WRK-CHK-KOKIGAK   TO   WRK-HANTEI-TOTALTEN
               PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
               IF     WRK-KINGAKU3  >  RECE62-KOUREI-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK2   =  WRK-KINGAKU3
                                             -  RECE62-KOUREI-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK10  =  RECE62-KOUREI-SAIKEI2
                                             -  WRK-CHK-KOKIGAK2
                 MOVE     WRK-CHK-KOKIGAK2  TO  RECE62-KOUREI-SAIKEI2
                 COMPUTE  RECE62-FTNMONEY(1) =  RECE62-FTNMONEY(1)
                                             -  WRK-CHK-KOKIGAK10
               END-IF
             END-IF
            END-IF
      *
            EVALUATE   WRK-PREFNUM
      *      群馬県地方公費
             WHEN    "10"
               IF  (RECE62-SRYYM        >=  "200804"  )
               AND (RECE62-TEISYUTUSAKI  =   2  OR  6 )
               AND (RECE62-KOUREI        =  "1" OR "2")
                 IF  (RECE62-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (RECE62-KOHNUM(2)       =  SPACE            )
                 AND (RECE62-KOHNUM(3)       =  SPACE            )
                 AND (RECE62-KOHNUM(4)       =  SPACE            )
                 AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
                   MOVE     RECE62-TOTALTEN(1)  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                   IF   RECE62-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE   WRK-SKY-KEISAN3 = WRK-KINGAKU3
                                               / 2
                     COMPUTE   WRK-SKY-KEISAN4 = RECE62-KOUREI-SAIKEI
                                               - WRK-SKY-KEISAN3
                     COMPUTE   WRK-SKY-FTNMONEY-XXX =
                              (RECE62-FTNMONEY(1)   -  WRK-KINGAKU3)
                                                    -  WRK-SKY-KEISAN4
                     DISPLAY   "2:WRK-SKY-FTNMONEY-XXX="
                                  WRK-SKY-FTNMONEY-XXX
                     MOVE   WRK-KINGAKU3   TO  RECE62-FTNMONEY(1)
                     IF   RECE62-RJNGENMENKBN   =   "1"
                       MOVE    4    TO      FLG-TOKKI
                       PERFORM   21013-TOKKI-HENSYU-SEC
                     END-IF
                   END-IF
                   MOVE  999999999  TO   RECE62-KOUREI-SAIKEI
                 END-IF
                 COMPUTE  WRK-CHK-KOKIGAK4 = RECE62-TOTALTEN(2)
                                           + RECE62-HENTOTALTEN(3)
                 IF  (RECE62-KOHNUM(1)(1:1)  = "0"               )
                 AND (RECE62-KOHNUM(1)   NOT =  "012" AND "025"  )
                 AND (RECE62-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
                 AND (RECE62-KOHNUM(3)       = SPACE             )
                 AND (RECE62-KOHNUM(4)       = SPACE             )
                 AND (RECE62-HKNCOMBI(2) NOT = ZERO              )
                 AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
                 AND ((RECE62-TOTALTEN(1)  = WRK-CHK-KOKIGAK4  ) OR
                      (RECE62-TOTALTEN(1)  =
                                          RECE62-HENTOTALTEN(3)) )
                 AND (RECE62-TEISYUTUSAKI  =    6                )
                 AND (RECE62-KOUREI        =   "1"               )
                      IF   RECE62-KYURATE   NOT =    30
                          MOVE     1       TO   FLG-CHIIKI
                          PERFORM  210466-HOKEN-ICHIBUFTN-CHK-SEC
                      ELSE
                          MOVE     1       TO   FLG-CHIIKI
                          PERFORM  210467-HOKEN-ICHIBUFTN-CHK2-SEC
                      END-IF
                 END-IF
               END-IF
      *      愛媛県地方公費
             WHEN    "38"
               IF  (RECE62-SRYYM        >=  "200804"  )
               AND (RECE62-KOUREI        =  "1" OR "2")
                 IF  (RECE62-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (RECE62-KOHNUM(2)       =  SPACE            )
                 AND (RECE62-KOHNUM(3)       =  SPACE            )
                 AND (RECE62-KOHNUM(4)       =  SPACE            )
                 AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
                   MOVE     RECE62-TOTALTEN(1)  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                   IF   RECE62-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE  WRK-CHK-KOKIGAK = RECE62-FTNMONEY(1)
                                              - WRK-KINGAKU3
                     MOVE   WRK-KINGAKU3   TO  RECE62-FTNMONEY(1)
                     IF RECE62-KOUREI-SAIKEI > WRK-CHK-KOKIGAK
                       COMPUTE  RECE62-KOUREI-SAIKEI =
                                RECE62-KOUREI-SAIKEI - WRK-CHK-KOKIGAK
                     ELSE
                       MOVE     ZERO       TO  RECE62-KOUREI-SAIKEI
                       MOVE      1         TO  RECE62-YOBIETC(6)
                     END-IF
                   END-IF
                 END-IF
                 IF  (RECE62-KOHNUM(1)       = "972" OR "974"    )
                 AND (RECE62-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
                 AND (RECE62-KOHNUM(3)       =  SPACE            )
                 AND (RECE62-KOHNUM(4)       =  SPACE            )
                 AND (RECE62-TOTALTEN(1)     = RECE62-TOTALTEN(2))
                 AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(3))
                   MOVE     RECE62-TOTALTEN(1)  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                   EVALUATE   RECE62-KOHNUM(1)
                     WHEN      "972"
                      IF  FLG-TOKU75 = 1 OR 2 OR 3
                       IF   WRK-KINGAKU3  >   5000
                         MOVE   5000   TO  WRK-KINGAKU3
                       END-IF
                      ELSE
                       IF   WRK-KINGAKU3  >   10000
                         MOVE   10000  TO  WRK-KINGAKU3
                       END-IF
                      END-IF
                     WHEN      "974"
                      IF  FLG-TOKU75 = 1 OR 2 OR 3
                       IF   WRK-KINGAKU3  >   10000
                         MOVE   10000   TO  WRK-KINGAKU3
                       END-IF
                      ELSE
                       IF   WRK-KINGAKU3  >   20000
                         MOVE   20000  TO  WRK-KINGAKU3
                       END-IF
                      END-IF
                   END-EVALUATE
                   IF   RECE62-FTNMONEY(1)  =  WRK-KINGAKU3
                     COMPUTE  WRK-CHK-KOKIGAK = 
                          (RECE62-TOTALTEN(1) - RECE62-TOTALTEN(3)) 
                                              * 10
                                              * RECE62-KYURATE
                                              / 100
                     COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KOKIGAK +  5
                     COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KOKIGAK / 10
                     COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KOKIGAK * 10
                     IF  RECE62-KOUREI-SAIKEI > WRK-CHK-KOKIGAK
                       COMPUTE  RECE62-KOUREI-SAIKEI =
                                RECE62-KOUREI-SAIKEI - WRK-CHK-KOKIGAK
                     ELSE
                       MOVE   ZERO            TO  RECE62-KOUREI-SAIKEI
                       MOVE    1              TO  RECE62-YOBIETC(6)
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *      愛知県地方公費
      *      兵庫県地方公費
             WHEN    "23"
             WHEN    "28"
               IF   FLG-ZENKOKUKOHI-NISYU  =  2
                 COMPUTE  WRK-CHK-KOKIGAK4 = RECE62-TOTALTEN(2)
                                           + RECE62-HENTOTALTEN(3)
                 IF  (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
                 AND ((RECE62-TOTALTEN(1)  = WRK-CHK-KOKIGAK4  ) OR
                      (RECE62-TOTALTEN(1)  =
                                          RECE62-HENTOTALTEN(3)) )
                      IF   RECE62-KYURATE   NOT =    30
                          MOVE     2       TO   FLG-CHIIKI
                          PERFORM  210466-HOKEN-ICHIBUFTN-CHK-SEC
                      ELSE
                          MOVE     2       TO   FLG-CHIIKI
                          PERFORM  210467-HOKEN-ICHIBUFTN-CHK2-SEC
                      END-IF
                 END-IF
               END-IF
      *      宮崎県地方公費
             WHEN    "45"
               IF  (RECE62-SRYYM        >=  "200804"  )
               AND (RECE62-TEISYUTUSAKI  =   2  OR  6 )
               AND (RECE62-KOUREI        =  "1" OR "2")
                 COMPUTE  WRK-CHK-KOKIGAK4 = RECE62-TOTALTEN(2)
                                           + RECE62-HENTOTALTEN(3)
                 IF  (RECE62-KOHNUM(1)(1:1)  = "0"               )
                 AND (RECE62-KOHNUM(1)   NOT =  "012" AND "025"  )
                 AND (RECE62-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
                 AND (RECE62-KOHNUM(3)       = SPACE             )
                 AND (RECE62-KOHNUM(4)       = SPACE             )
                 AND (RECE62-HKNCOMBI(2) NOT = ZERO              )
                 AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
                 AND ((RECE62-TOTALTEN(1)  = WRK-CHK-KOKIGAK4  ) OR
                      (RECE62-TOTALTEN(1)  =
                                          RECE62-HENTOTALTEN(3)) )
                 AND (RECE62-TEISYUTUSAKI  =    6                )
                 AND (RECE62-KOUREI        =   "1"               )
                      IF   RECE62-KYURATE   NOT =    30
                          MOVE     1       TO   FLG-CHIIKI
                          PERFORM  210466-HOKEN-ICHIBUFTN-CHK-SEC
                      ELSE
                          MOVE     1       TO   FLG-CHIIKI
                          PERFORM  210467-HOKEN-ICHIBUFTN-CHK2-SEC
                      END-IF
                 END-IF
               END-IF
      *      東京都地方公費
             WHEN    "13"
               IF  (RECE62-SRYYM        >=  "200804" )
               AND (RECE62-TEISYUTUSAKI  =   2  OR  6)
               AND (RECE62-KOUREI        =  "1"      )
                 IF  (RECE62-KOHNUM(1)   =  "282"                )
                 AND (RECE62-KOHNUM(2)   =  SPACE                )
                 AND (RECE62-KOHNUM(3)   =  SPACE                )
                 AND (RECE62-KOHNUM(4)   =  SPACE                )
                 AND (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
                   MOVE     RECE62-TOTALTEN(1)  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                   IF   RECE62-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE  WRK-SKY-FTNMONEY-XXX =
                              RECE62-FTNMONEY(1)   -  WRK-KINGAKU3
                     DISPLAY  "3:WRK-SKY-FTNMONEY-XXX="
                                 WRK-SKY-FTNMONEY-XXX
                     MOVE   WRK-KINGAKU3   TO  RECE62-FTNMONEY(1)
                     IF RECE62-FTNMONEY(1)  >  RECE62-KOUREI-SAIKEI
                        CONTINUE
                     ELSE
                        MOVE   999999999   TO  RECE62-KOUREI-SAIKEI
                     END-IF
                     IF   RECE62-RJNGENMENKBN   =   "1"
                       MOVE    4    TO      FLG-TOKKI
                       PERFORM   21013-TOKKI-HENSYU-SEC
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *      大阪府地方公費
             WHEN    "27"
               IF  (FLG-ZENKOKUKOHI-NISYU  =  2)
               AND (RECE62-TEISYUTUSAKI    =  6)
                 COMPUTE  WRK-CHK-KOKIGAK4 = RECE62-TOTALTEN(2)
                                           + RECE62-HENTOTALTEN(3)
                 IF  (RECE62-TOTALTEN(1) NOT = RECE62-TOTALTEN(2))
                 AND ((RECE62-TOTALTEN(1)  = WRK-CHK-KOKIGAK4  ) OR
                      (RECE62-TOTALTEN(1)  =
                                          RECE62-HENTOTALTEN(3)) )
                      IF   RECE62-KYURATE   NOT =    30
                          MOVE     3       TO   FLG-CHIIKI
                          PERFORM  210466-HOKEN-ICHIBUFTN-CHK-SEC
                      ELSE
                          MOVE     3       TO   FLG-CHIIKI
                          PERFORM  210467-HOKEN-ICHIBUFTN-CHK2-SEC
                      END-IF
                 END-IF
               END-IF
               IF  (FLG-ZENKOKUKOHI-NISYU  =  2 OR 3)
               AND (RECE62-TEISYUTUSAKI    =  2 OR 6)
                 IF  ((RECE62-KOHNUM(1)(1:1)  =  "0"              ) AND
                      (RECE62-KOHNUM(2)(1:1) >=  "1" AND <= "8"   ) AND
                      (RECE62-TOTALTEN(1) =  RECE62-HENTOTALTEN(3)))
                 OR  ((RECE62-KOHNUM(1)(1:1)  =  "0"              ) AND
                      (RECE62-KOHNUM(2)       =  "972" OR "974"   ) AND
                      (RECE62-KOHNUM(3)(1:1) >=  "1" AND <= "8"   ) AND
                      (RECE62-TOTALTEN(1) =  RECE62-HENTOTALTEN(4)))
                   IF   FLG-KOH  =   2
                     COMPUTE  WRK-CHK-KOKIGAK8  =  RECE62-FTNMONEY(2)
                                                -  WRK-KOH-GAI
                   ELSE
                     IF  WRK-FTNMONEY-MAE  NOT = 999999999
                       MOVE  WRK-FTNMONEY-MAE   TO  WRK-CHK-KOKIGAK8
                     ELSE
                       MOVE  RECE62-FTNMONEY(2) TO  WRK-CHK-KOKIGAK8
                     END-IF
                   END-IF
                   COMPUTE  RECE62-KOUREI-SAIKEI2  =
                            RECE62-KOUREI-SAIKEI2  +
                            WRK-CHK-KOKIGAK8
                   IF    RECE62-KOUREI-SAIKEI2   =  ZERO
                      MOVE     1     TO   RECE62-YOBIETC(7)
                   ELSE
                      MOVE    ZERO   TO   RECE62-YOBIETC(7)
                   END-IF
                 END-IF
               END-IF
            END-EVALUATE
      *
           ELSE
      *
            IF   (WK-GENGAKUKBN   =   3  OR  4)
            AND  (RECE62-SRYYM   >=   "201101")
            AND  (IDZ             =   1       )
              IF   RECE62-KOUREI        =  "1" OR "2"
                 MOVE     ZERO        TO   RECE62-FTNMONEY(1)
                 MOVE     999999999   TO   RECE62-KOUREI-SAIKEI
                 MOVE     999999999   TO   RECE62-KOUREI-SAIKEI2
              END-IF
              IF   (FLG-SAIGAI-TAISYO   =   1      )
              AND  (RECE62-SRYYM       <=  "201202")
                 MOVE     ZERO        TO   RECE62-SHOKUJIFTN(1)
              END-IF
            END-IF 
      *
           END-IF
      *
           IF   WK-GENGAKUKBN   =   ZERO
           AND  RECE62-SRYYM   >=  "200210"
      *
             COMPUTE  WRK-CHK-KOKIGAK4  = RECE62-TOTALTEN(2)
                                        + RECE62-HENTOTALTEN(3)
             COMPUTE  WRK-CHK-KOKIGAK   = RECE62-TOTALTEN(1)
                                        - WRK-JYOGENKBN-TEN6
             IF  (RECE62-KOUREI          =  SPACE            )
             AND (FLG-JIRITU-CYUKANSOU1  =   1               )
             AND (FLG-JIRITU-CYUKANSOU2  =   1               )
             AND (WRK-CHK-KOKIGAK        =   WRK-CHK-KOKIGAK4)
               MOVE   WRK-CHK-KOKIGAK   TO   WRK-HANTEI-TOTALTEN
               PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
               IF     WRK-KINGAKU3  >  WRK-JIRITU-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK2     =  WRK-KINGAKU3
                                               -  WRK-JIRITU-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK10    =  WRK-JIRITU-SAIKEI2
                                               -  WRK-CHK-KOKIGAK2
                 COMPUTE  RECE62-FTNMONEY-SKY  =  RECE62-FTNMONEY-SKY
                                               -  WRK-CHK-KOKIGAK10
               END-IF
             END-IF
      *
           END-IF
      *
           IF   (IDZ               =     1      )
           AND  (RECE62-SRYYM     >=  "201004"  )
           AND  (RECE62-KOUREI     =  "1" OR "2")
             MOVE   RECE62-FTNMONEY(1)   TO   RECE62-FTNMONEY-SKY
           END-IF
      *
           .
       21046-SAIKEI-KEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費併用時の計算処理
      *****************************************************************
       210461-KOHIHEIYO-KEISAN-SEC               SECTION.
      *
           EVALUATE   FLG-GENBUTU70
             WHEN        1
             WHEN        2
               IF  FLG-TOKU75 = 3
                MOVE    22200   TO   WRK-KEISAN-XXX
               ELSE
                MOVE    44400   TO   WRK-KEISAN-XXX
               END-IF
             WHEN        3
               IF  FLG-TOKU75 = 3
                MOVE    12300   TO   WRK-KEISAN-XXX
               ELSE
                MOVE    24600   TO   WRK-KEISAN-XXX
               END-IF
           END-EVALUATE
      *
           MOVE     1      TO     KOHFTN-IDX
           MOVE    ZERO    TO     WRK-KEISAN9
      *
      ***  PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
      ***              UNTIL    KOHFTN-IDX     >    4
      *
             IF    RECE62-KOHNUM(KOHFTN-IDX) = "010" OR "015" OR "016"
                                            OR "021" OR "024" OR "079"
                                            OR "038"
               IF  RECE62-FTNMONEY(KOHFTN-IDX + 1)  <  WRK-KEISAN-XXX
                CONTINUE
               ELSE
                EVALUATE  RECE62-KOHNUM(KOHFTN-IDX)
                 WHEN      "010"
                    COMPUTE WRK-KEISAN1 =
                            RECE62-TOTALTEN(KOHFTN-IDX + 1) * 10
                    IF  FLG-TOKU75 = 3
                     IF  WRK-KEISAN1  >  967890
                       COMPUTE WRK-KEISAN2 =
                            (( WRK-KEISAN1 - 133500 ) * 0.01 ) + 0.5
                       COMPUTE WRK-KEISAN3 = 40050 + WRK-KEISAN2
                     ELSE
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.05
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                     END-IF
                    ELSE
                     IF  WRK-KEISAN1  >  1935690
                       COMPUTE WRK-KEISAN2 =
                            (( WRK-KEISAN1 - 267000 ) * 0.01 ) + 0.5
                       COMPUTE WRK-KEISAN3 = 80100 + WRK-KEISAN2
                     ELSE
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.05
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                     END-IF
                    END-IF
                    IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                       COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                           - WRK-KEISAN-XXX
                    ELSE
                       MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD    WRK-KEISAN9  TO   WRK-KEISAN-YYY
                 WHEN      "015"
                 WHEN      "016"
                 WHEN      "021"
                    PERFORM  210451-KOHFTN-KINGAKU-SEC
                    IF   WRK-NYUJGNGAK  =  9999999 OR 999999
                      COMPUTE WRK-KEISAN1 =
                              RECE62-TOTALTEN(KOHFTN-IDX + 1) * 10
                      IF  FLG-TOKU75 = 3
                       IF  WRK-KEISAN1 >  430140
                         COMPUTE WRK-KEISAN2 =
                              (( WRK-KEISAN1 - 133500 ) * 0.01 ) + 0.5
                         COMPUTE WRK-KEISAN3 = 40050 + WRK-KEISAN2
                       ELSE
                         COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.1
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                       END-IF
                      ELSE
                       IF  WRK-KEISAN1 >  860340
                         COMPUTE WRK-KEISAN2 =
                              (( WRK-KEISAN1 - 267000 ) * 0.01 ) + 0.5
                         COMPUTE WRK-KEISAN3 = 80100 + WRK-KEISAN2
                       ELSE
                         COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.1
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                       END-IF
                      END-IF
                      IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                         COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                             - WRK-KEISAN-XXX
                      ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                      END-IF
                    ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD      WRK-KEISAN9  TO   WRK-KEISAN-YYY
                 WHEN      "024"
                 WHEN      "079"
                    PERFORM  210451-KOHFTN-KINGAKU-SEC
                    IF   WRK-NYUJGNGAK  >  WRK-KEISAN-XXX
                      COMPUTE WRK-KEISAN1 =
                              RECE62-TOTALTEN(KOHFTN-IDX + 1) * 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.1
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                      IF      WRK-KEISAN3 > WRK-NYUJGNGAK
                         MOVE  WRK-NYUJGNGAK  TO  WRK-KEISAN3
                      END-IF
                      IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                         COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                             - WRK-KEISAN-XXX
                      ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                      END-IF
                    ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD      WRK-KEISAN9  TO   WRK-KEISAN-YYY
                 WHEN      "038"
                    PERFORM  210451-KOHFTN-KINGAKU-SEC
                    IF   WRK-NYUJGNGAK  >  WRK-KEISAN-XXX
                      COMPUTE WRK-KEISAN1 =
                              RECE62-TOTALTEN(KOHFTN-IDX + 1) * 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * RECE62-KYURATE
                                                        / 100
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                      IF      WRK-KEISAN3 > WRK-NYUJGNGAK
                         MOVE  WRK-NYUJGNGAK  TO  WRK-KEISAN3
                      END-IF
                      IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                         COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                             - WRK-KEISAN-XXX
                      ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                      END-IF
                    ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD      WRK-KEISAN9  TO   WRK-KEISAN-YYY
                END-EVALUATE
               END-IF
             END-IF
      *
      ***  END-PERFORM
      *
           .
       210461-KOHIHEIYO-KEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    減免公費対応
      *****************************************************************
       210462-GENGAKU-OKIKAE-SEC               SECTION.
      *
           MOVE      1       TO     FLG-GENGAKU-OKIKAE
           MOVE      1       TO     IDX10
           PERFORM   2104G1-JGNGAK-SET-SEC
      *
      *    公費上限
           MOVE      ZERO         TO   WRK-JYOGEN-KOH
                                       WRK-JIRITU-TAFTNRUIKEI
                                       WRK-JIRITU-CYUKANSOU
           MOVE      ZERO         TO   FLG-IRYOHI70K
           MOVE      ZERO         TO   FLG-KOUGAKUCYO-GEN70K
      *
           IF    RECE62-KOHNUM(1)    =  "010"
             IF   RECE62-KOUREI    =   "1"
                MOVE   WRK-KOH-GENDOGAKU    TO  WRK-JYOGEN-KOH
             END-IF
             IF  FLG-GENBUTU70   NOT =  ZERO
                MOVE   WRK-GEN70-GENDOGAKU  TO  WRK-JYOGEN-KOH
                EVALUATE  WRK-GEN70-GENDOGAKU
                  WHEN       80100
                  WHEN       40050
                     MOVE  1      TO   FLG-IRYOHI70K
                END-EVALUATE
             END-IF
             IF ( RECE62-HKNJANUM(1:6)  =
                  "133041" OR "133074" OR "133090" OR "133116" OR
                  "133132" OR "133140" OR "133157" OR "133165" OR
                  "133173" OR "133181" OR "133207" OR "133223" OR
                  "133249" OR "133256" OR "133272" )
             OR ((RECE62-HKNJANUM(1:6) =  "233064"
                                       OR "133280") AND
                 (RECE62-SRYYM        <=  "201103"))
             OR ((RECE62-HKNJANUM(1:6) =  "283077") AND
                 (RECE62-SRYYM        <=  "201111"))
      *
             OR ( RECE62-HKNJANUM(1:6) =  "133033"
                                       OR "133066"
                                       OR "133199" )
      *****  OR ((RECE62-HKNJANUM(1:6) =  "133033"
      *****                            OR "133066"
      *****                           OR "133199") AND
      *****      (RECE62-SRYYM        <=  "201203"))
               IF  ( RECE62-RJNHKNNUM  NOT =  SPACE    )
               OR  ((WRK-PREFNUM           =  "29"    ) AND
                    (RECE62-HKNJANUM(1:6)  =  "133033"))
                CONTINUE
               ELSE
                MOVE   ZERO                 TO  WRK-JYOGEN-KOH
                MOVE   ZERO                 TO  FLG-IRYOHI70K
               END-IF
             END-IF
           ELSE
             INITIALIZE                     LNK-ORCSJGNGET-REC
             MOVE   RECE62-HOSPNUM      TO  LNK-ORCSJGNGET-HOSPNUM
             MOVE   RECE62-NYUGAIKBN    TO  LNK-ORCSJGNGET-NYUGAIKBN
             MOVE   RECE62-PTID         TO  LNK-ORCSJGNGET-PTID
             MOVE   RECE62-KOHNUM(1)    TO  LNK-ORCSJGNGET-KOHHKNNUM
             MOVE   RECE62-KOHID(1)     TO  LNK-ORCSJGNGET-KOHID
             MOVE   RECE62-SRYYM        TO  LNK-ORCSJGNGET-SRYYM
             MOVE   RECE62-SRYYM        TO  LNK-ORCSJGNGET-SKYEDYMD(1:6)
             MOVE   "31"                TO  LNK-ORCSJGNGET-SKYEDYMD(7:2)
      *
             CALL    "ORCSJGNGET"       USING
                                        LNK-ORCSJGNGET-REC
                                        SPA-AREA
      *
             IF     LNK-ORCSJGNGET-RC   =   ZERO
               MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                        TO  WRK-JYOGEN-KOH
               MOVE    LNK-ORCSJGNGET-TAFTNRUIKEI
                                        TO  WRK-JIRITU-TAFTNRUIKEI
             END-IF
      *
             IF  (RECE62-KOUREI    =   "1")
             OR  (FLG-KOUREI-KBN   =    1 )
                 IF  RECE62-KOHNUM(1) = "012" OR "025"
                   IF    WRK-JYOGEN-KOH  >  WRK-SEIHO-GENDO
                      MOVE  WRK-SEIHO-GENDO   TO   WRK-JYOGEN-KOH
                   END-IF
                 ELSE
                   IF  RECE62-KOHNUM(1) =  "015" OR "016" OR "021" OR
                                           "024" OR "079" OR "038"
                     CONTINUE
                   ELSE
                     IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                      MOVE  WRK-KOH-GENDOGAKU TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                 END-IF
             END-IF
             IF  FLG-GENBUTU70   NOT =   ZERO
                 IF  RECE62-KOHNUM(1) = "012" OR "025"
                   IF    WRK-JYOGEN-KOH  >  WRK-SEIHO-GENDO70
                      MOVE  WRK-SEIHO-GENDO70    TO   WRK-JYOGEN-KOH
                   END-IF
                 ELSE
                   IF  RECE62-KOHNUM(1) =  "015" OR "016" OR "021" OR
                                           "024" OR "079" OR "038"
                     CONTINUE
                   ELSE
                     IF  WRK-JYOGEN-KOH  >  WRK-GEN70-GENDOGAKU
                      MOVE  WRK-GEN70-GENDOGAKU  TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                 END-IF
             END-IF
             IF  RECE62-KOHNUM(1) =  "015" OR "016" OR "021" OR
                                     "024" OR "079" OR "038" OR
                                     "012" OR "025"
                 CONTINUE
             ELSE
                 IF   (RECE62-KOHNUM(2) = "972")
                 OR   (RECE62-KOHNUM(3) = "972")
                 OR   (RECE62-KOHNUM(4) = "972")
                   IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO
                       MOVE  WRK-CYOKI-GENDO   TO  WRK-JYOGEN-KOH
                   END-IF
                 END-IF
                 IF   (RECE62-KOHNUM(2) = "974")
                 OR   (RECE62-KOHNUM(3) = "974")
                 OR   (RECE62-KOHNUM(4) = "974")
                   IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO2
                       MOVE  WRK-CYOKI-GENDO2  TO  WRK-JYOGEN-KOH
                   END-IF
                 END-IF
             END-IF
             IF  RECE62-KOHNUM(1) = "015" OR "016" OR "021"
                   IF  WRK-JYOGEN-KOH = 9999999 OR 999999
                      MOVE  1     TO  WRK-JIRITU-CYUKANSOU
                   ELSE
                      MOVE  2     TO  WRK-JIRITU-CYUKANSOU
                      IF WRK-JIRITU-TAFTNRUIKEI < WRK-JYOGEN-KOH
                       COMPUTE WRK-JYOGEN-KOH = WRK-JYOGEN-KOH
                                              - WRK-JIRITU-TAFTNRUIKEI
                      ELSE
                       MOVE    ZERO    TO   WRK-JYOGEN-KOH
                      END-IF
      *               <** GAIRAIFTN**>
                   END-IF
                   IF  (RECE62-KOUREI    =   "1")
                   OR  (FLG-KOUREI-KBN   =    1 )
                     IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                        MOVE  WRK-KOH-GENDOGAKU TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF  FLG-GENBUTU70 NOT =   ZERO
                     IF  WRK-JYOGEN-KOH  >  WRK-GEN70-GENDOGAKU
                        MOVE  WRK-GEN70-GENDOGAKU
                                                TO   WRK-JYOGEN-KOH
                        EVALUATE  WRK-GEN70-GENDOGAKU
                          WHEN       80100
                          WHEN       40050
                             MOVE    2          TO   FLG-IRYOHI70K
                        END-EVALUATE
                     END-IF
                   END-IF
                   IF   (RECE62-KOHNUM(2) = "972")
                   OR   (RECE62-KOHNUM(3) = "972")
                   OR   (RECE62-KOHNUM(4) = "972")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO
                         MOVE  WRK-CYOKI-GENDO   TO  WRK-JYOGEN-KOH
                         MOVE  ZERO              TO  FLG-IRYOHI70K
                     END-IF
                   END-IF
                   IF   (RECE62-KOHNUM(2) = "974")
                   OR   (RECE62-KOHNUM(3) = "974")
                   OR   (RECE62-KOHNUM(4) = "974")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO2
                         MOVE  WRK-CYOKI-GENDO2  TO  WRK-JYOGEN-KOH
                         MOVE  ZERO              TO  FLG-IRYOHI70K
                     END-IF
                   END-IF
                   IF    WRK-JYOGEN-KOH = 9999999 OR 999999
                     IF  FLG-TOKU75 = 1 OR 2 OR 3
                         MOVE  40050   TO   WRK-JYOGEN-KOH
                     ELSE
                         MOVE  80100   TO   WRK-JYOGEN-KOH
                     END-IF
                     MOVE    3         TO   FLG-IRYOHI70K
                   END-IF
             END-IF
             IF  RECE62-KOHNUM(1) = "024" OR "079" OR "038"
                   IF   RECE62-KOHNUM(1) =   "038"
                     IF  WRK-JIRITU-TAFTNRUIKEI  <  WRK-JYOGEN-KOH
                        COMPUTE WRK-JYOGEN-KOH = WRK-JYOGEN-KOH
                                               - WRK-JIRITU-TAFTNRUIKEI
                     ELSE
                        MOVE    ZERO    TO   WRK-JYOGEN-KOH
                     END-IF
      *              <** GAIRAIFTN**>
                   END-IF
                   IF  (RECE62-KOUREI    =   "1")
                   OR  (FLG-KOUREI-KBN   =    1 )
                     IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                        MOVE  WRK-KOH-GENDOGAKU TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF  FLG-GENBUTU70 NOT =   ZERO
                     IF  WRK-JYOGEN-KOH  >  WRK-GEN70-GENDOGAKU
                        MOVE  WRK-GEN70-GENDOGAKU
                                                TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF   (RECE62-KOHNUM(2) = "972")
                   OR   (RECE62-KOHNUM(3) = "972")
                   OR   (RECE62-KOHNUM(4) = "972")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO
                         MOVE  WRK-CYOKI-GENDO   TO  WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF   (RECE62-KOHNUM(2) = "974")
                   OR   (RECE62-KOHNUM(3) = "974")
                   OR   (RECE62-KOHNUM(4) = "974")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO2
                         MOVE  WRK-CYOKI-GENDO2  TO  WRK-JYOGEN-KOH
                     END-IF
                   END-IF
             END-IF
           END-IF
      *
      *    公費上限＋＠
           IF     FLG-IRYOHI70K    =  1
              COMPUTE  WRK-KOUREI-IRYOHI70 = RECE62-TOTALTEN(2)
                                           * 10
              IF  FLG-TOKU75 = 1 OR 2 OR 3
                IF  WRK-KOUREI-IRYOHI70 >  133500
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 133500 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >  967890
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              ELSE
                IF  WRK-KOUREI-IRYOHI70 >  267000
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >  1935690
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              END-IF
           END-IF
           IF     FLG-IRYOHI70K    =  2  OR  3
              COMPUTE  WRK-KOUREI-IRYOHI70 = RECE62-TOTALTEN(2)
                                           * 10
              IF  FLG-TOKU75 = 1 OR 2 OR 3
                IF  WRK-KOUREI-IRYOHI70 >  133500
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 133500 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >   430140
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              ELSE
                IF  WRK-KOUREI-IRYOHI70 >  267000
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >   860340
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              END-IF
           END-IF
      *
      *    公費の負担計算
           IF   WRK-JYOGEN-KOH   =    ZERO
               MOVE    ZERO    TO   WRK-FTNKEI-KOH
           ELSE
               IF  (RECE62-KOUREI    =   "1" OR "2")
      ***      OR  (RECE62-KOHNUM(1) =   "012"     )
                 IF   FLG-KOUGAKUCYO-GEN70K  =  1
                    MOVE   WRK-JYOGEN-KOH       TO WRK-FTNKEI-KOH
                 ELSE
                  IF  (RECE62-KOUREI           =   "2")
                  AND (WRK-KOGAKU-TAISYOGAI(1) =    1 )
                    IF     WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-EN(1)
                      MOVE  WRK-JYOGEN-KOH      TO WRK-FTNKEI-KOH
                    ELSE
                      MOVE  WRK-TAIHI-GENKIN-EN(1)
                                                TO WRK-FTNKEI-KOH
                    END-IF
                  ELSE
                    IF     WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN(1)
                      MOVE  WRK-JYOGEN-KOH      TO WRK-FTNKEI-KOH
                    ELSE
                      MOVE  WRK-TAIHI-GENKIN(1) TO WRK-FTNKEI-KOH
                    END-IF
                  END-IF
                 END-IF
               ELSE
                 IF        WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-EN(1)
                      MOVE  WRK-JYOGEN-KOH      TO WRK-FTNKEI-KOH
                 ELSE
                      MOVE  WRK-TAIHI-GENKIN-EN(1)
                                                TO WRK-FTNKEI-KOH
                 END-IF
               END-IF
           END-IF
      *
           IF   RECE62-FTNMONEY(2) = ZERO
            CONTINUE
           ELSE
            IF   RECE62-KOUREI    =   "1" OR "2"
              MOVE   RECE62-FTNMONEY(2)      TO  WRK-TAIHI-GENKIN3
              MOVE   WRK-FTNKEI-KOH          TO  RECE62-FTNMONEY(2)
                                                 RECE62-FTNMONEY-KOJ(2)
              IF    RECE62-FTNMONEY(2)    NOT =  ZERO
              AND   RECE62-KOUREI             =  "1"
                IF   RECE62-FTNMONEY(2)   <   RECE62-FTNMONEY(1)
                  COMPUTE  RECE62-FTNMONEY(1) =  RECE62-FTNMONEY(1)
                                              -  RECE62-FTNMONEY(2)
                ELSE
                  MOVE     ZERO        TO  RECE62-FTNMONEY(1)
                END-IF
                ADD  WRK-TAIHI-GENKIN3 TO  RECE62-FTNMONEY(1)
                IF   RECE62-FTNMONEY(2)   <   FTN-KOH-XXX
                  COMPUTE  FTN-KOH-XXX        =  FTN-KOH-XXX
                                              -  RECE62-FTNMONEY(2)
                ELSE
                  MOVE     ZERO        TO  FTN-KOH-XXX
                END-IF
                ADD  WRK-TAIHI-GENKIN3 TO  FTN-KOH-XXX
              END-IF
            ELSE
              MOVE   WRK-FTNKEI-KOH          TO  RECE62-FTNMONEY(2)
                                                 RECE62-FTNMONEY-KOJ(2)
            END-IF
           END-IF
      *
           .
       210462-GENGAKU-OKIKAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７０歳代前半軽減特例措置対応
      *****************************************************************
       210463-ZENKI-TOKUREI-OKIKAE-SEC               SECTION.
      *
           MOVE      1       TO     FLG-GENGAKU-OKIKAE
           MOVE   KOHFTN-IDX TO     IDX10
           PERFORM   2104G1-JGNGAK-SET-SEC
      *
      *    公費上限
           MOVE   TBL-HKNFTNDATA-JGN(KOHFTN-IDX)
                                          TO   WRK-JYOGEN-KOH
                                               WRK-JYOGEN-KOH2
      ****
           IF    WK-GENGAKUKBN    NOT =  ZERO
            IF  ((RECE62-KOHNUM(KOHFTN-IDX)      = "051") AND
                 (TBL-DOTANDOKU-FLG(KOHFTN-IDX)  =   1  ))
            OR  ((WRK-PREFNUM                    = "13" ) AND
                 (RECE62-KOHNUM(KOHFTN-IDX)      = "151") AND
                 (RECE62-SRYYM               <  "200905"))
             CONTINUE
            ELSE
             IF  WRK-KOH-GENDOGAKU   NOT =  ZERO
                 EVALUATE   WK-GENGAKUKBN
                   WHEN        1
                     IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO     TO   WRK-KOH-GENDOGAKU
                     ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  WRK-KOH-GENDOGAKU   =
                                  WRK-KOH-GENDOGAKU   *
                                  WK-GENGAKU-RITUX    /
                                  100
                     END-IF
                   WHEN        2
                     CONTINUE
                   WHEN        3
                   WHEN        4
                         MOVE   ZERO     TO   WRK-KOH-GENDOGAKU
                 END-EVALUATE
                 COMPUTE  WRK-KOH-GENDOGAKU  =
                          WRK-KOH-GENDOGAKU  +   5
                 COMPUTE  WRK-KOH-GENDOGAKU  =
                          WRK-KOH-GENDOGAKU  /  10
                 COMPUTE  WRK-KOH-GENDOGAKU  =
                          WRK-KOH-GENDOGAKU  *  10
             END-IF
             IF  WRK-JYOGEN-KOH   NOT =  ZERO
                 EVALUATE   WK-GENGAKUKBN
                   WHEN        1
                     IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO     TO   WRK-JYOGEN-KOH
                     ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  WRK-JYOGEN-KOH      =
                                  WRK-JYOGEN-KOH      *
                                  WK-GENGAKU-RITUX    /
                                  100
                     END-IF
                   WHEN        2
                     CONTINUE
                   WHEN        3
                   WHEN        4
                         MOVE   ZERO     TO   WRK-JYOGEN-KOH
                 END-EVALUATE
                 COMPUTE  WRK-JYOGEN-KOH = WRK-JYOGEN-KOH +  5
                 COMPUTE  WRK-JYOGEN-KOH = WRK-JYOGEN-KOH / 10
                 COMPUTE  WRK-JYOGEN-KOH = WRK-JYOGEN-KOH * 10
             END-IF
            END-IF
           END-IF
      *
           IF  RECE62-KOHNUM(KOHFTN-IDX) = "038"
              IF  TBL-HKNFTNDATA-TAF(KOHFTN-IDX)    <  WRK-JYOGEN-KOH
                  COMPUTE  WRK-JYOGEN-KOH =
                           WRK-JYOGEN-KOH -
                           TBL-HKNFTNDATA-TAF(KOHFTN-IDX)
              ELSE
                  MOVE     ZERO          TO   WRK-JYOGEN-KOH
              END-IF
      ***     IF  TBL-HKNFTNDATA-GAIRAI(KOHFTN-IDX) <  WRK-JYOGEN-KOH
      ***         COMPUTE  WRK-JYOGEN-KOH =
      ***                  WRK-JYOGEN-KOH -
      ***                  TBL-HKNFTNDATA-GAIRAI(KOHFTN-IDX)
      ***     ELSE
      ***         MOVE     ZERO          TO   WRK-JYOGEN-KOH
      ***     END-IF
           END-IF
      *
           IF  (  RECE62-KOUREI                 =  SPACE )
           AND (((RECE62-KOHNUM(KOHFTN-IDX)     = "051") AND
                 (TBL-DOTANDOKU-FLG(KOHFTN-IDX) =   1  ))
             OR ((WRK-PREFNUM                   = "13" ) AND
                 (RECE62-KOHNUM(KOHFTN-IDX)     = "151") AND
                 (RECE62-SRYYM              <  "200905")))
             CONTINUE
           ELSE
             IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                MOVE   WRK-KOH-GENDOGAKU  TO   WRK-JYOGEN-KOH
             END-IF
           END-IF
      *
      *    公費の負担計算
           IF  ( RECE62-FTNMONEY(KOHFTN-IDX + 1)   =  ZERO   )
           OR  ( TBL-HKNFTNDATA-FLG(KOHFTN-IDX)    =  1 OR 2 )
            CONTINUE
           ELSE
            IF   WRK-JYOGEN-KOH   =    ZERO
               MOVE    ZERO    TO   WRK-FTNKEI-KOH
            ELSE
             IF  RECE62-KOUREI    =   "1"
               IF   WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN(KOHFTN-IDX)
                  MOVE  WRK-JYOGEN-KOH       TO   WRK-FTNKEI-KOH
               ELSE
                  MOVE  WRK-TAIHI-GENKIN(KOHFTN-IDX)
                                             TO   WRK-FTNKEI-KOH
               END-IF
             ELSE
               IF   WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-EN(KOHFTN-IDX)
                  MOVE  WRK-JYOGEN-KOH       TO   WRK-FTNKEI-KOH
               ELSE
                  MOVE  WRK-TAIHI-GENKIN-EN(KOHFTN-IDX)
                                             TO   WRK-FTNKEI-KOH
               END-IF
             END-IF
            END-IF
            MOVE   WRK-FTNKEI-KOH   TO
                            RECE62-FTNMONEY    (KOHFTN-IDX + 1)
                            RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
           END-IF
      *
           IF   ( RECE62-KOHNUM(KOHFTN-IDX)  = "051"          )
           OR   ((WRK-PREFNUM                = "13"          ) AND
                 (RECE62-KOHNUM(KOHFTN-IDX)  = "151"         ))
           OR   ((WRK-PREFNUM                = "23"          ) AND
                 (RECE62-KOHNUM(KOHFTN-IDX)  = "191"         ) AND
                 (RECE62-SRYYM              >= "200910"      ))
             IF  ((WRK-PREFNUM                 =  "01"           ) AND
                  (RECE62-KOHNUM(KOHFTN-IDX)   =  "051"          ) AND
                  (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2)
                                              >= "91" AND <= "95") AND
                  (RECE62-SRYYM             <  "200810"          ))
              CONTINUE
             ELSE
              COMPUTE  WRK-FTNKEI2 = RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                   + WRK-SKJ-FTN    (KOHFTN-IDX + 1)
              MOVE     RECE62-FTNMONEY(KOHFTN-IDX + 1)
                              TO  WRK-FTNKEI3
      *
              IF  WRK-JYOGEN-KOH2  NOT =  ZERO
                IF   WRK-FTNKEI3  =  WRK-JYOGEN-KOH2
                   MOVE  WRK-FTNKEI3
                              TO  RECE62-FTNMONEY    (KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                ELSE
                   MOVE  WRK-FTNKEI2
                              TO  RECE62-FTNMONEY    (KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
              END-IF
             END-IF
           END-IF
      *
           .
       210463-ZENKI-TOKUREI-OKIKAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集
      *****************************************************************
       210464-JYOGENGAKU-HENSYU-SEC               SECTION.
      *
           EVALUATE   RECE62-KOUREI
            WHEN        "1"
             IF     RECE62-TEISYOTOKU  NOT =  SPACE
                EVALUATE   RECE62-TEISYOTOKU
                    WHEN  "1"
                    WHEN  "4"
                      IF  FLG-TOKU75 = 1 OR 2
                        MOVE  7500   TO   WRK-KINGAKU3
                      ELSE
                        MOVE  15000  TO   WRK-KINGAKU3
                      END-IF
                    WHEN  "2"
                    WHEN  "3"
                      IF  FLG-TOKU75 = 1 OR 2
                        MOVE  12300  TO   WRK-KINGAKU3
                      ELSE
                        MOVE  24600  TO   WRK-KINGAKU3
                      END-IF
                END-EVALUATE
             ELSE
                IF  (RECE62-KYURATE        =    20 OR 30)
                AND (RECE62-RJNGENMENKBN   =    SPACE   )
                AND (FLG-KOHYONKAIME       =    ZERO    )
                 IF    RECE62-SRYYM  >=  "200610"
                  COMPUTE WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                  IF  FLG-TOKU75 = 1 OR 2
                   IF   WRK-CHIHOU-KIN6  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN6 - 133500 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU3 = 40050 + WRK-KINGAKU2
                   ELSE
                     MOVE   40050   TO   WRK-KINGAKU3
                   END-IF
                  ELSE
                   IF   WRK-CHIHOU-KIN6  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN6 - 267000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU3 = 80100 + WRK-KINGAKU2
                   ELSE
                     MOVE   80100   TO   WRK-KINGAKU3
                   END-IF
                  END-IF
                 ELSE
                  COMPUTE WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                  IF   WRK-CHIHOU-KIN6  >  361500
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN6 - 361500 ) * 0.01 )
                                                        + 0.5
                    COMPUTE  WRK-KINGAKU3 = 72300 + WRK-KINGAKU2
                  ELSE
                    MOVE   72300   TO   WRK-KINGAKU3
                  END-IF
                 END-IF
                ELSE
                 IF    RECE62-SRYYM  >=  "200610"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE  22200  TO   WRK-KINGAKU3
                   ELSE
                     MOVE  44400  TO   WRK-KINGAKU3
                   END-IF
                 ELSE
                   MOVE   40200   TO   WRK-KINGAKU3
                 END-IF
                END-IF
             END-IF
            WHEN        "2"
            WHEN        "3"
             EVALUATE     FLG-GENBUTU70
               WHEN           1
                 IF  FLG-KOHYONKAIME = 1
                   IF  FLG-TOKU75 = 3
                    MOVE   41700   TO   WRK-KINGAKU3
                   ELSE
                    MOVE   83400   TO   WRK-KINGAKU3
                   END-IF
                 ELSE
                   COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                   IF  FLG-TOKU75 = 3
                    IF   WRK-CHIHOU-KIN6  >  250000
                      COMPUTE  WRK-KINGAKU2 =
                            (( WRK-CHIHOU-KIN6 - 250000 ) * 0.01 )
                                                          + 0.5
                      COMPUTE  WRK-KINGAKU3 = 75000  + WRK-KINGAKU2
                    ELSE
                      MOVE   75000   TO   WRK-KINGAKU3
                    END-IF
                   ELSE
                    IF   WRK-CHIHOU-KIN6  >  500000
                      COMPUTE  WRK-KINGAKU2 =
                            (( WRK-CHIHOU-KIN6 - 500000 ) * 0.01 )
                                                          + 0.5
                      COMPUTE  WRK-KINGAKU3 = 150000 + WRK-KINGAKU2
                    ELSE
                      MOVE   150000  TO   WRK-KINGAKU3
                    END-IF
                   END-IF
                 END-IF
               WHEN           2
                 IF  FLG-KOHYONKAIME = 1
                   IF  FLG-TOKU75 = 3
                    MOVE   22200   TO   WRK-KINGAKU3
                   ELSE
                    MOVE   44400   TO   WRK-KINGAKU3
                   END-IF
                 ELSE
                   COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                   IF  FLG-TOKU75 = 3
                    IF   WRK-CHIHOU-KIN6  >  133500
                      COMPUTE  WRK-KINGAKU2 =
                            (( WRK-CHIHOU-KIN6 - 135000 ) * 0.01 )
                                                          + 0.5
                      COMPUTE  WRK-KINGAKU3 = 40050  + WRK-KINGAKU2
                    ELSE
                      MOVE   40050   TO   WRK-KINGAKU3
                    END-IF
                   ELSE
                    IF   WRK-CHIHOU-KIN6  >  267000
                      COMPUTE  WRK-KINGAKU2 =
                            (( WRK-CHIHOU-KIN6 - 267000 ) * 0.01 )
                                                          + 0.5
                      COMPUTE  WRK-KINGAKU3 = 80100  + WRK-KINGAKU2
                    ELSE
                      MOVE   80100   TO   WRK-KINGAKU3
                    END-IF
                   END-IF
                 END-IF
               WHEN           3
                 IF  FLG-KOHYONKAIME = 1
                  IF  FLG-TOKU75 = 3
                    MOVE   12300   TO   WRK-KINGAKU3
                  ELSE
                    MOVE   24600   TO   WRK-KINGAKU3
                  END-IF
                 ELSE
                  IF  FLG-TOKU75 = 3
                    MOVE   17700   TO   WRK-KINGAKU3
                  ELSE
                    MOVE   35400   TO   WRK-KINGAKU3
                  END-IF
                 END-IF
             END-EVALUATE
           END-EVALUATE
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
             EVALUATE   WK-GENGAKUKBN
               WHEN        1
                 IF  WK-GENGAKU-RITU = 100
                   MOVE   ZERO   TO   WRK-KINGAKU3
                 ELSE
                   COMPUTE WK-GENGAKU-RITUX = 100 - WK-GENGAKU-RITU
                   IF    WRK-KINGAKU3  NOT = ZERO
                     COMPUTE WRK-KINGAKU3 =
                            (WRK-KINGAKU3 * WK-GENGAKU-RITUX / 100)
                                                             + 0.5
                   END-IF
                 END-IF
               WHEN        2
                 CONTINUE
               WHEN        3
               WHEN        4
                 MOVE   ZERO     TO   WRK-KINGAKU3
             END-EVALUATE
           END-IF
      *
           .
       210464-JYOGENGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集
      *****************************************************************
       210464X-JYOGENGAKU-HENSYU2-SEC               SECTION.
      *
           COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
           IF  FLG-TOKU75 = 3
            IF   WRK-CHIHOU-KIN6  >  133500
              COMPUTE  WRK-KINGAKU2 =
                    (( WRK-CHIHOU-KIN6 - 135000 ) * 0.01 )
                                                  + 0.5
              COMPUTE  WRK-KINGAKU3 = 40050  + WRK-KINGAKU2
            ELSE
              MOVE   40050   TO   WRK-KINGAKU3
            END-IF
           ELSE
            IF   WRK-CHIHOU-KIN6  >  267000
              COMPUTE  WRK-KINGAKU2 =
                    (( WRK-CHIHOU-KIN6 - 267000 ) * 0.01 )
                                                  + 0.5
              COMPUTE  WRK-KINGAKU3 = 80100  + WRK-KINGAKU2
            ELSE
              MOVE   80100   TO   WRK-KINGAKU3
            END-IF
           END-IF
      *
           .
       210464X-JYOGENGAKU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額のある全国公費の一部負担金編集
      *****************************************************************
       210465-KOH-ICHIBUFTN-HENSYU-SEC               SECTION.
      *
           MOVE    ZERO    TO   WRK-KOH-KINGAKU
      *
           IF   RECE62-KOHNUM(KOHFTN-IDX) =
                "015" OR "016" OR "024" OR "079"
             COMPUTE  WRK-KOH-KINGAKU = RECE62-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * 10
                                      / 100
           END-IF
      *
           IF ( RECE62-KOHNUM(KOHFTN-IDX) =
                "038" OR "051" OR "052" OR "011" OR "020" )
           OR ((WRK-PREFNUM               =  "13"        ) AND
               (RECE62-KOHNUM(KOHFTN-IDX) =  "151"       ))
           OR ((WRK-PREFNUM               =  "23"        ) AND
               (RECE62-KOHNUM(KOHFTN-IDX) =  "191"       ) AND
               (RECE62-SRYYM             >=  "200910"    ))
             COMPUTE  WRK-KOH-KINGAKU = RECE62-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * RECE62-KYURATE
                                      / 100
           END-IF
      *
           IF  (WRK-KOH-KINGAKU   NOT = ZERO                     )
           AND (WRK-KOH-KINGAKU < RECE62-FTNMONEY(KOHFTN-IDX + 1))
             MOVE  WRK-KOH-KINGAKU  TO
                                  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
           END-IF
      *
           .
       210465-KOH-ICHIBUFTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄一部負担金チェック
      *****************************************************************
       210466-HOKEN-ICHIBUFTN-CHK-SEC               SECTION.
      *
           COMPUTE  WRK-HANTEI-TOTALTEN = RECE62-TOTALTEN(1)
                                        - RECE62-TOTALTEN(2)
           PERFORM  210464-JYOGENGAKU-HENSYU-SEC
           IF   FLG-KOH  =   2
             COMPUTE  WRK-CHK-KOKIGAK2 = RECE62-FTNMONEY(2)
                                       - WRK-KOH-GAI
           ELSE
             IF  WRK-FTNMONEY-MAE  NOT = 999999999
               MOVE  WRK-FTNMONEY-MAE    TO  WRK-CHK-KOKIGAK2
             ELSE
               MOVE  RECE62-FTNMONEY(2)  TO  WRK-CHK-KOKIGAK2
             END-IF
           END-IF
           COMPUTE  WRK-CHK-KOKIGAK = RECE62-FTNMONEY(1)
                                    - FTN-KOH-XXX
                                    + WRK-CHK-KOKIGAK2
           IF   WRK-CHK-KOKIGAK  >  WRK-KINGAKU3
             IF   WRK-KINGAKU3   >  WRK-CHK-KOKIGAK2
               COMPUTE  WRK-CHK-KOKIGAK3   = WRK-KINGAKU3
                                           - WRK-CHK-KOKIGAK2
             ELSE
               MOVE     ZERO    TO  WRK-CHK-KOKIGAK3
             END-IF
      *
             IF   FLG-CHIIKI    =   ZERO
               IF  (FLG-HOKENICHIBU2  NOT = ZERO)
               AND (FLG-HOKENICHIBU3      = ZERO)
               AND (FLG-HOKENICHIBU-SYU   =  1  )
                  COMPUTE  WRK-SKY-FTNMONEY-XXX =
                           RECE62-FTNMONEY(1)   -
                           (WRK-CHK-KOKIGAK3    +    FTN-KOH-XXX)
                  DISPLAY  "4:WRK-SKY-FTNMONEY-XXX="
                              WRK-SKY-FTNMONEY-XXX
               END-IF
             END-IF
      *
             COMPUTE  RECE62-FTNMONEY(1) = WRK-CHK-KOKIGAK3
                                         + FTN-KOH-XXX
      *
             IF   FLG-CHIIKI    =   2
               MOVE  WRK-CHK-KOKIGAK3  TO  RECE62-KOUREI-SAIKEI2
               IF    RECE62-KOUREI-SAIKEI2  =   ZERO
                  MOVE   999999999     TO  RECE62-KOUREI-SAIKEI2
               END-IF
             END-IF
             IF   FLG-CHIIKI    =   3
               MOVE  WRK-CHK-KOKIGAK3  TO  RECE62-KOUREI-SAIKEI2
               IF    RECE62-KOUREI-SAIKEI2  =   ZERO
                  MOVE       1         TO  RECE62-YOBIETC(7)
               END-IF
             END-IF
      *
             IF   FLG-KOH  =   2
               COMPUTE  RECE62-FTNMONEY(2) = WRK-CHK-KOKIGAK2
                                           + WRK-CHK-KOKIGAK3
             END-IF
      *
             IF   FLG-CHIIKI    =   ZERO
                IF   FLG-HOKENICHIBU-SYU    = ZERO
                AND  FLG-HOKENICHIBU2   NOT = ZERO
                AND  FLG-HOKENICHIBU3   NOT = ZERO
                  MOVE   1    TO   RECE62-RJNNYUKOHFTN(3)
                END-IF
             END-IF
           END-IF
      *
           .
       210466-HOKEN-ICHIBUFTN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄一部負担金チェック２
      *****************************************************************
       210467-HOKEN-ICHIBUFTN-CHK2-SEC               SECTION.
      *
           MOVE     ZERO    TO   FLG-HOKENICHIBU-CHK
           IF  (FLG-CHIIKI            = ZERO)
           AND (RECE62-KOUREI         = "2" )
           AND (FLG-HOKENICHIBU4  NOT = ZERO)
           AND (FLG-HOKENICHIBU5  NOT = ZERO)
           AND (FLG-HOKENICHIBU-SYU   =  1  )
              COMPUTE WRK-FTNKEI5 = WRK-JYOGENKBN-TEN3
                                  * 10
                                  * RECE62-KYURATE
                                  / 100
              COMPUTE WRK-FTNKEI5 = WRK-FTNKEI5 +  5
              COMPUTE WRK-FTNKEI5 = WRK-FTNKEI5 / 10
              COMPUTE WRK-FTNKEI5 = WRK-FTNKEI5 * 10
              IF    WRK-FTNKEI5  >=  21000
                 MOVE     1     TO    FLG-HOKENICHIBU-CHK
              END-IF
           END-IF
           IF  (FLG-CHIIKI            = ZERO)
           AND (RECE62-KOUREI         = "2" )
           AND (FLG-HOKENICHIBU4  NOT = ZERO)
           AND (FLG-HOKENICHIBU6  NOT = ZERO)
           AND (FLG-HOKENICHIBU5  NOT = ZERO)
           AND (FLG-HOKENICHIBU-SYU   = ZERO)
                 MOVE     1     TO    FLG-HOKENICHIBU-CHK
           END-IF
           IF  (FLG-CHIIKI            = ZERO)
           AND (RECE62-KOUREI         = "2" )
           AND (FLG-HOKENICHIBU3      = ZERO)
           AND (FLG-HOKENICHIBU5  NOT = ZERO)
           AND (FLG-HOKENICHIBU-SYU   =  1  )
              COMPUTE WRK-FTNKEI5 = WRK-JYOGENKBN-TEN4
                                  * 10
                                  * RECE62-KYURATE
                                  / 100
              COMPUTE WRK-FTNKEI5 = WRK-FTNKEI5 +  5
              COMPUTE WRK-FTNKEI5 = WRK-FTNKEI5 / 10
              COMPUTE WRK-FTNKEI5 = WRK-FTNKEI5 * 10
              IF    WRK-FTNKEI5  >=  21000
                 MOVE     1     TO    FLG-HOKENICHIBU-CHK
              END-IF
           END-IF
      *
           IF  ((FLG-HOKENICHIBU2  NOT = ZERO) AND
                (FLG-HOKENICHIBU3  NOT = ZERO) AND
                (FLG-HOKENICHIBU-SYU   = ZERO))
           OR  ( FLG-HOKENICHIBU-CHK   =  1   )
             MOVE   RECE62-TOTALTEN(1)  TO  WRK-HANTEI-TOTALTEN
           ELSE
             COMPUTE  WRK-HANTEI-TOTALTEN = RECE62-TOTALTEN(1)
                                          - RECE62-TOTALTEN(2)
           END-IF
           PERFORM  210464-JYOGENGAKU-HENSYU-SEC
           IF   FLG-KOH  =   2
             COMPUTE  WRK-CHK-KOKIGAK2 = RECE62-FTNMONEY(2)
                                       - WRK-KOH-GAI
           ELSE
             IF  WRK-FTNMONEY-MAE  NOT = 999999999
               MOVE  WRK-FTNMONEY-MAE    TO  WRK-CHK-KOKIGAK2
             ELSE
               MOVE  RECE62-FTNMONEY(2)  TO  WRK-CHK-KOKIGAK2
             END-IF
           END-IF
      *
           IF  ( RECE62-KOUREI         = "1"  )
           OR  ( FLG-CHIIKI        NOT = ZERO )
           OR  ((FLG-HOKENICHIBU2  NOT = ZERO) AND
                (FLG-HOKENICHIBU3  NOT = ZERO) AND
                (FLG-HOKENICHIBU-SYU   = ZERO))
           OR  ( FLG-HOKENICHIBU-CHK   =  1   )
             IF   WRK-KINGAKU3  >  WRK-CHK-KOKIGAK2
               COMPUTE  WRK-CHK-KOKIGAK5  =  WRK-KINGAKU3
                                          -  WRK-CHK-KOKIGAK2
             ELSE
               MOVE     ZERO         TO    WRK-CHK-KOKIGAK5
             END-IF
           ELSE
             MOVE     WRK-KINGAKU3   TO    WRK-CHK-KOKIGAK5
           END-IF
      *
           COMPUTE  WRK-HANTEI-TOTALTEN = RECE62-TOTALTEN(1)
                                        - RECE62-TOTALTEN(2)
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-HANTEI-TOTALTEN
                                     * 10
                                     * RECE62-KYURATE
                                     / 100
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-CHK-KOKIGAK6 +  5
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-CHK-KOKIGAK6 / 10
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-CHK-KOKIGAK6 * 10
      *
           IF   WRK-CHK-KOKIGAK5  >  WRK-CHK-KOKIGAK6
             MOVE   WRK-CHK-KOKIGAK6   TO  WRK-CHK-KOKIGAK7
           ELSE
             MOVE   WRK-CHK-KOKIGAK5   TO  WRK-CHK-KOKIGAK7
           END-IF
      *
           COMPUTE  WRK-CHK-KOKIGAK = RECE62-FTNMONEY(1)
                                    - FTN-KOH-XXX
           IF   WRK-CHK-KOKIGAK  NOT =  WRK-CHK-KOKIGAK7
             IF   FLG-CHIIKI    =   ZERO
               IF  (FLG-HOKENICHIBU2  NOT = ZERO)
               AND (FLG-HOKENICHIBU3      = ZERO)
               AND (FLG-HOKENICHIBU-SYU   =  1  )
                  COMPUTE  WRK-SKY-FTNMONEY-XXX =
                           RECE62-FTNMONEY(1)   -
                           (WRK-CHK-KOKIGAK7    +    FTN-KOH-XXX)
                  DISPLAY  "5:WRK-SKY-FTNMONEY-XXX="
                              WRK-SKY-FTNMONEY-XXX
               END-IF
             END-IF
      *
             COMPUTE  RECE62-FTNMONEY(1) = WRK-CHK-KOKIGAK7
                                         + FTN-KOH-XXX
      *
             IF   FLG-CHIIKI    =   2
               MOVE  WRK-CHK-KOKIGAK7  TO  RECE62-KOUREI-SAIKEI2
               IF    RECE62-KOUREI-SAIKEI2  =   ZERO
                  MOVE   999999999     TO  RECE62-KOUREI-SAIKEI2
               END-IF
             END-IF
             IF   FLG-CHIIKI    =   3
               MOVE  WRK-CHK-KOKIGAK7  TO  RECE62-KOUREI-SAIKEI2
               IF    RECE62-KOUREI-SAIKEI2  =   ZERO
                  MOVE       1         TO  RECE62-YOBIETC(7)
               END-IF
             END-IF
      *
             IF   FLG-KOH  =   2
               COMPUTE  RECE62-FTNMONEY(2) = WRK-CHK-KOKIGAK2
                                           + WRK-CHK-KOKIGAK7
             END-IF
      *
             IF   FLG-CHIIKI    =   ZERO
                IF   FLG-HOKENICHIBU-SYU    = ZERO
                AND  FLG-HOKENICHIBU2   NOT = ZERO
                AND  FLG-HOKENICHIBU3   NOT = ZERO
                  MOVE   1    TO   RECE62-RJNNYUKOHFTN(3)
                END-IF
             END-IF
           END-IF
      *
           .
       210467-HOKEN-ICHIBUFTN-CHK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    主保険の上限金額計算
      *****************************************************************
       210468-SYUHKN-JYOHEN-KEISAN-SEC               SECTION.
      *
           MOVE     ZERO     TO   WRK-KINGAKU-GENBUTU3
           MOVE     ZERO     TO   WRK-CHIHOU-KIN3
      *
           EVALUATE   FLG-GENBUTU70
             WHEN       1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   MOVE   41700   TO  WRK-KINGAKU-GENBUTU3
                 ELSE
                   MOVE   83400   TO  WRK-KINGAKU-GENBUTU3
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN3  =
                           WRK-CHIHOU-KIN3  +
                          (WRK-JYOGENKBN-TEN9 * 10)
                 IF  FLG-TOKU75 = 3
                   IF   WRK-CHIHOU-KIN3  >  250000
                       COMPUTE  WRK-KINGAKU2 =
                       (( WRK-CHIHOU-KIN3 -  250000 ) * 0.01 )
                                                      + 0.5
                       COMPUTE WRK-KINGAKU-GENBUTU3 =
                               75000   +   WRK-KINGAKU2
                   ELSE
                       MOVE    75000   TO  WRK-KINGAKU-GENBUTU3
                   END-IF
                 ELSE
                   IF   WRK-CHIHOU-KIN3  >  500000
                       COMPUTE  WRK-KINGAKU2 =
                       (( WRK-CHIHOU-KIN3 -  500000 ) * 0.01 )
                                                      + 0.5
                       COMPUTE WRK-KINGAKU-GENBUTU3 =
                               150000  +   WRK-KINGAKU2
                   ELSE
                       MOVE    150000  TO  WRK-KINGAKU-GENBUTU3
                   END-IF
                 END-IF
               END-IF
             WHEN       2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   MOVE   22200   TO  WRK-KINGAKU-GENBUTU3
                 ELSE
                   MOVE   44400   TO  WRK-KINGAKU-GENBUTU3
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN3  =
                           WRK-CHIHOU-KIN3  +
                          (WRK-JYOGENKBN-TEN9 * 10)
                 IF  FLG-TOKU75 = 3
                   IF   WRK-CHIHOU-KIN3  >  133500
                       COMPUTE  WRK-KINGAKU2 =
                       (( WRK-CHIHOU-KIN3 -  133500 ) * 0.01 )
                                                      + 0.5
                       COMPUTE WRK-KINGAKU-GENBUTU3 =
                               40050   +   WRK-KINGAKU2
                   ELSE
                       MOVE    40050   TO  WRK-KINGAKU-GENBUTU3
                   END-IF
                 ELSE
                   IF   WRK-CHIHOU-KIN3  >  267000
                       COMPUTE  WRK-KINGAKU2 =
                       (( WRK-CHIHOU-KIN3 -  267000 ) * 0.01 )
                                                      + 0.5
                       COMPUTE WRK-KINGAKU-GENBUTU3 =
                               80100   +   WRK-KINGAKU2
                   ELSE
                       MOVE    80100   TO  WRK-KINGAKU-GENBUTU3
                   END-IF
                 END-IF
               END-IF
             WHEN       3
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   MOVE   12300   TO  WRK-KINGAKU-GENBUTU3
                 ELSE
                   MOVE   24600   TO  WRK-KINGAKU-GENBUTU3
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                   MOVE   17700   TO  WRK-KINGAKU-GENBUTU3
                 ELSE
                   MOVE   35400   TO  WRK-KINGAKU-GENBUTU3
                 END-IF
               END-IF
           END-EVALUATE
      *
           .
       210468-SYUHKN-JYOHEN-KEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事略称編集
      *****************************************************************
       21047-SKJ-RAYKU-HENSYU-SEC               SECTION.
      *
           PERFORM  VARYING  ID1    FROM    1   BY  1
                     UNTIL   ID1      >     4
      *
               IF  RECE62-SHOKUJIKHNNISSU(ID1)   =   ZERO
                   CONTINUE
               ELSE
                   EVALUATE   ID1
                     WHEN      1
                       MOVE   "１"    TO   RECE62-SHOKUJISYUBETU(1)
                     WHEN      2
                       MOVE   "２"    TO   RECE62-SHOKUJISYUBETU(1)
                     WHEN      3
                       MOVE   "特別"  TO   RECE62-SHOKUJISYUBETU(2)
                     WHEN      4
                       MOVE   "食堂"  TO   RECE62-SHOKUJISYUBETU(3)
                   END-EVALUATE
               END-IF
      *
           END-PERFORM
      *
           IF    RECE62-SHOKUJIKHNNISSU(1)      =  ZERO
           AND   RECE62-SHOKUJIKHNNISSU(2)  NOT =  ZERO
               MOVE    RECE62-SHOKUJIKHNNISSU(2)
                              TO  RECE62-SHOKUJIKHNNISSU(1)
               MOVE    RECE62-SHOKUJIKHNRYO(2)
                              TO  RECE62-SHOKUJIKHNRYO(1)
      *
               MOVE    ZERO   TO  RECE62-SHOKUJIKHNNISSU(2)
                                  RECE62-SHOKUJIKHNRYO(2)
           END-IF
      *
           .
       21047-SKJ-RAYKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者の経過措置判定
      *****************************************************************
       21048-KEIKASOCHI-HANTEI-SEC      SECTION.
      *
      *    一般経過措置対象者
      *
           IF   (RECE62-SRYYM   >=  "200608")
           AND  (RECE62-SRYYM   <=  "200812")
           AND  (RECE62-KYURATE  =  20 OR 30)
               INITIALIZE                      PTKOHINF-REC
               MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
               MOVE    RECE62-PTID         TO  PTKOH-PTID
               MOVE    "978"               TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC        TO  MCPDATA-REC
               MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
               MOVE    "key4"              TO  MCP-PATHNAME
               PERFORM   900-DBSELECT-SEC
               IF      MCP-RC               =       ZERO
                  MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                  MOVE    "key4"          TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                     IF  (PTKOH-TEKSTYMD(1:6)  <=   RECE62-SRYYM       )
                     AND (RECE62-SRYYM         <=   PTKOH-TEKEDYMD(1:6))
                     AND (PTKOH-SAKJOKBN        =   SPACE              )
                         MOVE    "1"         TO  RECE62-RJNGENMENKBN
                         MOVE     1          TO  FLG-PTKOHINF
                     ELSE
                         MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                         MOVE    "key4"           TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                     END-IF
                  END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
               MOVE    "key4"              TO  MCP-PATHNAME
               PERFORM   900-CLOSE-SEC
           END-IF
      *
      *    高額４回目以降対象者
           IF   (RECE62-KYURATE       =  20 OR 30)
           AND  (RECE62-RJNGENMENKBN  =  SPACE   )
      *
                PERFORM   2104A-KOHYONKAIME-HANTEI-SEC
      *
           END-IF
      *
           .
       21048-KEIKASOCHI-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７０歳未満高額現物給付対象者の判定
      *****************************************************************
       21049-GENBUTU70-HANTEI-SEC      SECTION.
      *
      *    ７０歳未満高額現物給付対象者
           MOVE      RECE62-SRYYM          TO   WRK-GEN70-YM
           IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
              MOVE   RECE62-TEKSTYMD(7:2)  TO   WRK-GEN70-DD
           ELSE
              MOVE   01                    TO   WRK-GEN70-DD
           END-IF
      *
           MOVE      RECE62-SRYYM            TO   WRK-GEN702-YM
           IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
              MOVE   RECE62-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
           ELSE
              MOVE   01                      TO   WRK-GEN702-DD
           END-IF
      *
           PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                      UNTIL   (GEN-IDX    >    TBL-GENBUTU70-MAX)
                        OR    (FLG-GENBUTU70   NOT = ZERO       )
                INITIALIZE                      PTKOHINF-REC
                MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    RECE62-PTID         TO  PTKOH-PTID
                MOVE    TBL-GENBUTU70(GEN-IDX)
                                            TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC        TO  MCPDATA-REC
                MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                MOVE    "key4"              TO  MCP-PATHNAME
                PERFORM   900-DBSELECT-SEC
                IF      MCP-RC               =       ZERO
                  MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
                  MOVE    "key4"            TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                     IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                         (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                         (PTKOH-SAKJOKBN   =   SPACE         ))
                     OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                         (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                         (PTKOH-SAKJOKBN   =   SPACE         ))
                         EVALUATE   GEN-IDX
                           WHEN        1
                             MOVE    1   TO  FLG-GENBUTU70
                           WHEN        2
                             IF  RECE62-TEISYOTOKU  =  SPACE
                               MOVE  2   TO  FLG-GENBUTU70
                             ELSE
                               MOVE  3   TO  FLG-GENBUTU70
                             END-IF
                         END-EVALUATE
                         MOVE     1      TO  FLG-PTKOHINF
                     ELSE
                         MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                         MOVE    "key4"           TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                     END-IF
                  END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                MOVE    "key4"              TO  MCP-PATHNAME
                PERFORM   900-CLOSE-SEC
           END-PERFORM
      *
           IF    FLG-GENBUTU70      =  ZERO
             IF  FLG-TOKUSITU   NOT =  ZERO
                MOVE    FLG-TOKUSITU   TO   FLG-GENBUTU70
             END-IF
           END-IF
      *
           IF    FLG-GENBUTU70  =  ZERO
                MOVE    SPACE    TO     RECE62-KOUREI
           ELSE
      *         高額４回目以降対象者
                INITIALIZE                      PTKOHINF-REC
                MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    RECE62-PTID         TO  PTKOH-PTID
                MOVE    "965"               TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC        TO  MCPDATA-REC
                MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                MOVE    "key4"              TO  MCP-PATHNAME
                PERFORM  900-DBSELECT-SEC
                IF      MCP-RC   =   ZERO
                  MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
                  MOVE    "key4"            TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                     IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                         (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                         (PTKOH-SAKJOKBN   =   SPACE         ))
                     OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                         (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                         (PTKOH-SAKJOKBN   =   SPACE         ))
                         MOVE     1               TO  FLG-KOHYONKAIME
                         MOVE     1               TO  FLG-PTKOHINF
                     ELSE
                         MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                         MOVE    "key4"           TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                     END-IF
                  END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                MOVE    "key4"              TO  MCP-PATHNAME
                PERFORM  900-CLOSE-SEC
      *
                IF  FLG-TOKUSITU    =  ZERO
                   MOVE      5      TO     FLG-TOKKI
                   PERFORM   21013-TOKKI-HENSYU-SEC
                END-IF
           END-IF
      *
           EVALUATE   FLG-GENBUTU70
             WHEN     1
                 MOVE   "17"   TO    RECE62-DISCOUNTTENTNK
             WHEN     2
                 MOVE   "18"   TO    RECE62-DISCOUNTTENTNK
             WHEN     3
                 MOVE   "19"   TO    RECE62-DISCOUNTTENTNK
           END-EVALUATE
      *
           .
       21049-GENBUTU70-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    高額４回目以降対象者の判定
      *****************************************************************
       2104A-KOHYONKAIME-HANTEI-SEC      SECTION.
      *
           MOVE      RECE62-SRYYM          TO   WRK-KOHYONKAIME-YM
           IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
              MOVE   RECE62-TEKSTYMD(7:2)  TO   WRK-KOHYONKAIME-DD
           ELSE
              MOVE   01                    TO   WRK-KOHYONKAIME-DD
           END-IF
      *
           INITIALIZE                      PTKOHINF-REC
           MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
           MOVE    RECE62-PTID         TO  PTKOH-PTID
           MOVE    "965"               TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC        TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
           MOVE    "key4"              TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
               MOVE    "key4"          TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF  (PTKOH-TEKSTYMD      <=   WRK-KOHYONKAIME-YMD)
                  AND (WRK-KOHYONKAIME-YMD <=   PTKOH-TEKEDYMD     )
                  AND (PTKOH-SAKJOKBN       =   SPACE              )
                      MOVE     1          TO  FLG-KOHYONKAIME
                      MOVE     1          TO  FLG-PTKOHINF
                  ELSE
                      MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                      MOVE    "key4"           TO  MCP-PATHNAME
                      PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
           MOVE    "key4"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       2104A-KOHYONKAIME-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患０５１チェック
      *****************************************************************
       2104B-TOKUTEISIKKAN-CHECK-SEC               SECTION.
      *
           INITIALIZE                TBL-DOTANDOKU
      *
           IF   ( WRK-PREFNUM         =  "01"     )
           AND  ( RECE62-SRYYM       >=  "200510" )
           AND  ( RECE62-SRYYM       <   "200810" )
             PERFORM   VARYING  IDX1    FROM    1   BY  1
                        UNTIL   IDX1      >     4
               IF  ( RECE62-KOHNUM(IDX1) =  "051"         )
               AND ((RECE62-KOHJKYSNUM(IDX1)(1:2) >= "91"
                                              AND <= "95") OR
                    (RECE62-KOHJKYSNUM(IDX1)(1:2) >= "71"
                                              AND <= "88"))
                   MOVE    1     TO    TBL-DOTANDOKU-FLG(IDX1)
               END-IF
             END-PERFORM
           END-IF
      *
           .
       2104B-TOKUTEISIKKAN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費２種チェック
      *****************************************************************
       2104C-ZENKOKUKOHI-NISYU-CHECK-SEC               SECTION.
      *
           IF     (RECE62-SRYYM          >=  "200804")
           AND    (RECE62-HKNNUM      NOT =  SPACE   )
      *
      *      主＋全Ａ、主＋全Ｂ
             IF ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(2)    =   1              ))  AND
                 (((RECE62-KOHNUM(3)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(3)    =  ZERO           )) OR
                  ( RECE62-KOHNUM(3)       =  SPACE           ) OR
                  ( RECE62-KOHNUM(3)       =  "972" OR "974"  ))  AND
                 (((RECE62-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
                  ( RECE62-KOHNUM(4)       =  SPACE           )))
      *
             OR ((RECE62-KOHNUM(1)(1:1)  =  "0"                )  AND
                 (RECE62-KOHNUM(1)   NOT =  "012" AND "025"    )  AND
                 (RECE62-KOHNUM(2)       =  "972" OR "974"     )  AND
                 (TBL-TOKATUKAIFLG(3)    =   1                 )  AND
                 (((RECE62-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
                  ( RECE62-KOHNUM(4)       =  SPACE           )))
      *
             OR ((RECE62-KOHNUM(1)(1:1)  =  "0"                )  AND
                 (RECE62-KOHNUM(1)   NOT =  "012" AND "025"    )  AND
                 (RECE62-KOHNUM(2)       =  "972" OR "974"     )  AND
                 (RECE62-KOHNUM(3)(1:1)  =  "0"                )  AND
                 (RECE62-KOHNUM(3)   NOT =  "012" AND "025"    )  AND
                 (((RECE62-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
                  ( RECE62-KOHNUM(4)       =  SPACE           )))
      *
             OR ((RECE62-KOHNUM(1)       =  "972" OR "974"     )  AND
                 (TBL-TOKATUKAIFLG(2)    =   1                 )  AND
                 (TBL-TOKATUKAIFLG(3)    =   1                 )  AND
                 (((RECE62-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
                  ( RECE62-KOHNUM(4)       =  SPACE           )))
      *
               IF  (((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                     (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                    ( TBL-TOKATUKAIFLG(1)    =   1              ))
               AND (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                     (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                    ( TBL-TOKATUKAIFLG(2)    =   1              ))
               AND (((RECE62-KOHNUM(3)(1:1) >= "1" AND <= "8"  ) AND
                     (TBL-TOKATUKAIFLG(3)    =  ZERO           )) OR
                    ( RECE62-KOHNUM(3)       =  SPACE           ) OR
                    ( RECE62-KOHNUM(3)       =  "972" OR "974"  ))
      ***         IF  (RECE62-TOTALTEN(1)  NOT = RECE62-TOTALTEN(2))
      ***         AND (RECE62-TOTALTEN(1)  NOT = RECE62-TOTALTEN(3))
                     MOVE      1       TO     FLG-ZENKOKUKOHI-NISYU
      ***         END-IF
               END-IF
      *
               IF  (RECE62-KOHNUM(1)(1:1)  =  "0"                )
               AND (RECE62-KOHNUM(1)   NOT =  "012" AND "025"    )
               AND (RECE62-KOHNUM(2)       =  "972" OR "974"     )
               AND (TBL-TOKATUKAIFLG(3)    =   1                 )
      ***         IF  (RECE62-TOTALTEN(1)  NOT = RECE62-TOTALTEN(2))
      ***         AND (RECE62-TOTALTEN(1)  NOT = RECE62-TOTALTEN(4))
                     MOVE      8       TO     FLG-ZENKOKUKOHI-NISYU
      ***         END-IF
               END-IF
               IF  (RECE62-KOHNUM(1)(1:1)  =  "0"                )
               AND (RECE62-KOHNUM(1)   NOT =  "012" AND "025"    )
               AND (RECE62-KOHNUM(2)       =  "972" OR "974"     )
               AND (RECE62-KOHNUM(3)(1:1)  =  "0"                )
               AND (RECE62-KOHNUM(3)   NOT =  "012" AND "025"    )
      ***         IF  (RECE62-TOTALTEN(1)  NOT = RECE62-TOTALTEN(2))
      ***         AND (RECE62-TOTALTEN(1)  NOT = RECE62-TOTALTEN(4))
                     MOVE      8       TO     FLG-ZENKOKUKOHI-NISYU
      ***         END-IF
               END-IF
      *
               IF  (RECE62-KOHNUM(1)       =  "972" OR "974"     )
               AND (TBL-TOKATUKAIFLG(2)    =   1                 )
               AND (TBL-TOKATUKAIFLG(3)    =   1                 )
      ***         IF  (RECE62-TOTALTEN(1)  NOT = RECE62-TOTALTEN(3))
      ***         AND (RECE62-TOTALTEN(1)  NOT = RECE62-TOTALTEN(4))
                     MOVE      9       TO     FLG-ZENKOKUKOHI-NISYU
      ***         END-IF
               END-IF
      *
               IF    RECE62-HKNCOMBI(2)   =   ZERO
                     MOVE     ZERO     TO     FLG-ZENKOKUKOHI-NISYU
               END-IF
             END-IF
      *
      ***    IF ((WRK-PREFNUM =  "27") AND (RECE62-KOUREI       = "1"))
      ***    OR ((WRK-PREFNUM =  "28") AND (RECE62-KOUREI       = "1")
      ***                              AND (RECE62-TEISYUTUSAKI =  6 ))
             IF  ((RECE62-AGE       >=  70  ) OR
                  (RECE62-HKNNUM     = "039"))
             AND ( RECE62-YOBIETC(8) =  ZERO )
              IF ( WRK-PREFNUM = "27"                               )
              OR ((WRK-PREFNUM = "28") AND (RECE62-TEISYUTUSAKI = 6))
              OR ((WRK-PREFNUM = "23") AND (RECE62-TEISYUTUSAKI = 6))
               IF ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                     (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                    ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                   (  RECE62-KOHNUM(2)(1:1) >=  "1" AND <= "8"   )  AND
                   (  TBL-TOKATUKAIFLG(2)    =  ZERO             ))
               OR ((  RECE62-KOHNUM(1)(1:1)  =  "0"              )  AND
                   (  RECE62-KOHNUM(1)   NOT =  "012" AND "025"  )  AND
                   (  RECE62-KOHNUM(2)       =  "972" OR "974"   )  AND
                   (  RECE62-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )  AND
                   (  TBL-TOKATUKAIFLG(3)    =  ZERO             ))
               OR ((  RECE62-KOHNUM(1)       =  "972" OR "974"   )  AND
                   (  TBL-TOKATUKAIFLG(2)    =   1               )  AND
                   (  RECE62-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )  AND
                   (  TBL-TOKATUKAIFLG(3)    =  ZERO             ))
      *
                  MOVE      2       TO     FLG-ZENKOKUKOHI-NISYU
      *
                  IF  WRK-PREFNUM =  "27"
                     IF    RECE62-HKNCOMBI(2)   =   ZERO
                       IF  RECE62-TEISYUTUSAKI  =   2 OR 6
                          MOVE    3       TO   FLG-ZENKOKUKOHI-NISYU
                       ELSE
                          MOVE    ZERO    TO   FLG-ZENKOKUKOHI-NISYU
                       END-IF
                     END-IF
                  ELSE
                     IF    RECE62-HKNCOMBI(2)   =   ZERO
                          MOVE    ZERO    TO   FLG-ZENKOKUKOHI-NISYU
                     END-IF
                  END-IF
               END-IF
              END-IF
             END-IF
      *
             IF   WRK-PREFNUM = "42"
               IF  ((RECE62-KOHNUM(1)       =  "186"         ) AND
                    (RECE62-KOHNUM(2)       =  "187" OR "287") AND
                    (RECE62-KOHNUM(3)       =  SPACE         ) AND
                    (RECE62-KOHNUM(4)       =  SPACE         ))
               OR  ((RECE62-KOHNUM(1)       =  "972" OR "974") AND
                    (RECE62-KOHNUM(2)       =  "186"         ) AND
                    (RECE62-KOHNUM(3)       =  "187" OR "287") AND
                    (RECE62-KOHNUM(4)       =  SPACE         ))
      *
                  MOVE        4           TO   FLG-ZENKOKUKOHI-NISYU
      *
                  IF    RECE62-HKNCOMBI(2)   =   ZERO
                     MOVE     ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                  ELSE
                     PERFORM   VARYING  IDX1  FROM  1  BY  1
                                UNTIL  (IDX1                  >  10 )
                                 OR    (RECE62-HKNCOMBI(IDX1) = ZERO)
                        IF   (RECE62-KOHNUMHC(IDX1 1) = "187" OR "287")
                        AND  (RECE62-KOHNUMHC(IDX1 2) = "186"         )
                           MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU
                        END-IF
                     END-PERFORM
                  END-IF
               END-IF
             END-IF
      *
           END-IF
      *
      *    主＋全Ａ、主＋全Ｂ
           IF ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                 (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
               (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                 (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(2)    =   1              )))
      *
           OR ((RECE62-KOHNUM(1)(1:1)  =  "0"                )  AND
               (RECE62-KOHNUM(1)   NOT =  "012" AND "025"    )  AND
               (RECE62-KOHNUM(2)       =  "972" OR "974"     )  AND
               (TBL-TOKATUKAIFLG(3)    =   1                 ))
      *
           OR ((RECE62-KOHNUM(1)       =  "972" OR "974"     )  AND
               (TBL-TOKATUKAIFLG(2)    =   1                 )  AND
               (TBL-TOKATUKAIFLG(3)    =   1                 ))
      *
                  MOVE      1       TO     FLG-ZENKOKUKOHI-NISYU2
      *
           END-IF
      *
           .
       2104C-ZENKOKUKOHI-NISYU-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７５歳到達月の特例判定
      *****************************************************************
       2104D-TOKU75-HANTEI-SEC               SECTION.
      *
           MOVE      ZERO       TO    FLG-TOKU75
                                      FLG-TOKU75-KIZON
           MOVE      SPACE      TO    WRK-TOKU75-BIRTHDAY
           MOVE      ZERO       TO    FLG-SYOGAI75
      *
           IF   (RECE62-SRYYM       >=  "200901")
           AND  (RECE62-HKNNUM   NOT =   SPACE  )
             IF  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
             OR  (RECE62-HKNNUM       =   "068" OR "069" OR "040")
               CONTINUE
             ELSE
               IF  ((RECE62-AGE         >=   70  ) OR
                    (RECE62-HKNNUM       =  "039"))
               AND ( RECE62-YOBIETC(8)   =  ZERO  )
                 MOVE    ZERO                TO  FLG-KOKI-HIGAITO
                 INITIALIZE                      PTKOHINF-REC
                 MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
                 MOVE    RECE62-PTID         TO  PTKOH-PTID
                 MOVE    "977"               TO  PTKOH-KOHNUM
                 MOVE    PTKOHINF-REC        TO  MCPDATA-REC
                 MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                 MOVE    "key4"              TO  MCP-PATHNAME
                 PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD(1:6) <= RECE62-SRYYM       )
                      AND (RECE62-SRYYM        <= PTKOH-TEKEDYMD(1:6))
                      AND (PTKOH-SAKJOKBN       = SPACE              )
                         MOVE     1          TO  FLG-KOKI-HIGAITO
                         MOVE     1          TO  FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                         MOVE    "key4"               TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                      END-IF
                    END-PERFORM
                 END-IF
                 MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                 MOVE    "key4"               TO  MCP-PATHNAME
                 PERFORM 900-CLOSE-SEC
      *
                 INITIALIZE                      ORCSAGECHKAREA
                 MOVE    RECE62-HOSPNUM      TO  AGECHK-HOSPNUM
                 MOVE    RECE62-PTID         TO  AGECHK-PTID
                 MOVE    RECE62-SRYYM        TO  AGECHK-SRYYMD(1:6)
                 MOVE    "01"                TO  AGECHK-SRYYMD(7:2)
                 MOVE    RECE62-BIRTHDAY     TO  AGECHK-BIRTHDAY
                 CALL    "ORCSAGECHK"        USING
                                             ORCSAGECHKAREA
                                             SPA-AREA
                 IF      AGECHK-RC       =   ZERO
                   IF  (AGECHK-NENREI        =  74              )
                   AND (AGECHK-ROUJIN2       =  0               )
                   AND (RECE62-BIRTHDAY(5:2) = RECE62-SRYYM(5:2))
                   AND (RECE62-BIRTHDAY(7:2)  NOT =  "01"       )
                   AND (RECE62-BIRTHDAY(5:4)  NOT =  "0229"     )
                   AND (FLG-KOKI-HIGAITO          =   ZERO      )
                       MOVE   1    TO    FLG-TOKU75
                       MOVE   RECE62-BIRTHDAY
                                   TO    WRK-TOKU75-BIRTHDAY
                   END-IF
                   IF  ( AGECHK-NENREI       >=  75 )
                   OR  ( AGECHK-ROUJIN2       =  1  )
                       MOVE   1    TO    FLG-TOKU75-KIZON
                   END-IF
                   IF  (AGECHK-NENREI        =  74              )
                   AND (AGECHK-ROUJIN2       =  1               )
                   AND (RECE62-BIRTHDAY(5:2) = RECE62-SRYYM(5:2))
                   AND (RECE62-BIRTHDAY(7:2)  NOT =  "01"       )
                   AND (RECE62-BIRTHDAY(5:4)  NOT =  "0229"     )
                       MOVE   1    TO    FLG-SYOGAI75
                   END-IF
                 END-IF
               END-IF
      *
               IF (FLG-TOKU75         =    1)
               OR (FLG-TOKU75-KIZON   =    1)
                 CONTINUE
               ELSE
                 INITIALIZE                   PTKOHINF-REC
                 MOVE    RECE62-HOSPNUM   TO  PTKOH-HOSPNUM
                 MOVE    RECE62-PTID      TO  PTKOH-PTID
                 MOVE    "969"            TO  PTKOH-KOHNUM
                 MOVE    PTKOHINF-REC     TO  MCPDATA-REC
                 MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                 MOVE    "key4"           TO  MCP-PATHNAME
                 PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD(1:6) =  RECE62-SRYYM       )
                      AND (RECE62-SRYYM        =  PTKOH-TEKEDYMD(1:6))
                      AND (PTKOH-SAKJOKBN      =  SPACE              )
                         IF  PTKOH-TEKSTYMD(5:4)   NOT =  "0229"
                           IF  ((RECE62-AGE         >=   70  ) OR
                                (RECE62-HKNNUM       =  "039"))
                           AND ( RECE62-YOBIETC(8)   =  ZERO  )
                              MOVE  2   TO   FLG-TOKU75
                           ELSE
                              MOVE  3   TO   FLG-TOKU75
                           END-IF
                           MOVE  PTKOH-TEKSTYMD
                                        TO   WRK-TOKU75-BIRTHDAY
                         END-IF
                         MOVE    1      TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                         MOVE    "key4"               TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                      END-IF
                    END-PERFORM
                 END-IF
                 MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                 MOVE    "key4"               TO  MCP-PATHNAME
                 PERFORM 900-CLOSE-SEC
               END-IF
             END-IF
           END-IF
      *
           EVALUATE   FLG-TOKU75
             WHEN        1
             WHEN        2
               IF    RECE62-KOUREI   =   "1"
                 CONTINUE
               ELSE
                IF      IDZ   =   1
                 IF (RECE62-KOHNUM(1) = "972" OR "974")
                 OR (RECE62-KOHNUM(2) = "972" OR "974")
                 OR (RECE62-KOHNUM(3) = "972" OR "974")
                 OR (RECE62-KOHNUM(4) = "972" OR "974")
                 OR (RECE62-KOHNUM(1)(1:1) = "0"      )
                 OR (RECE62-KOHNUM(2)(1:1) = "0"      )
                 OR (RECE62-KOHNUM(3)(1:1) = "0"      )
                 OR (RECE62-KOHNUM(4)(1:1) = "0"      )
                 OR (TBL-TOKATUKAIFLG(1)   =  1       )
                 OR (TBL-TOKATUKAIFLG(2)   =  1       )
                 OR (TBL-TOKATUKAIFLG(3)   =  1       )
                 OR (TBL-TOKATUKAIFLG(4)   =  1       )
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                ELSE
                 PERFORM   2104D1-TOKU75-HANTEI-KOHSKY-SEC
                 IF  FLG-TOKU75-KOHSKY = 1
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                END-IF
               END-IF
             WHEN        3
               IF    RECE62-KOUREI   =   "2"
                 CONTINUE
               ELSE
                IF      IDZ   =   1
                 IF (RECE62-KOHNUM(1) = "972" OR "974")
                 OR (RECE62-KOHNUM(2) = "972" OR "974")
                 OR (RECE62-KOHNUM(3) = "972" OR "974")
                 OR (RECE62-KOHNUM(4) = "972" OR "974")
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                ELSE
                 PERFORM   2104D1-TOKU75-HANTEI-KOHSKY-SEC
                 IF  FLG-TOKU75-KOHSKY = 1
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                END-IF
               END-IF
           END-EVALUATE
      *
           IF  FLG-TOKU75    =  2  OR  3
               MOVE      6      TO     FLG-TOKKI
               PERFORM   21013-TOKKI-HENSYU-SEC
           END-IF
      *
           IF  FLG-TOKU75    =  1  OR  2  OR  3
              EVALUATE  FLG-TOKU75
                WHEN       1
                  MOVE   1    TO   RECE62-RJNNYUKOHFTN(1)
                WHEN       2
                  MOVE   2    TO   RECE62-RJNNYUKOHFTN(1)
                WHEN       3
                  MOVE   3    TO   RECE62-RJNNYUKOHFTN(1)
              END-EVALUATE
           END-IF
      *
           IF  FLG-SYOGAI75  =  1
               IF    RECE62-KOUREI       =   "1"
                    MOVE    1    TO    RECE62-RJNGAIKOHFTN(3)
               ELSE
                 IF (RECE62-KOHNUM(1) = "972" OR "974")
                 OR (RECE62-KOHNUM(2) = "972" OR "974")
                 OR (RECE62-KOHNUM(3) = "972" OR "974")
                 OR (RECE62-KOHNUM(4) = "972" OR "974")
                 OR (RECE62-KOHNUM(1)(1:1) = "0"      )
                 OR (RECE62-KOHNUM(2)(1:1) = "0"      )
                 OR (RECE62-KOHNUM(3)(1:1) = "0"      )
                 OR (RECE62-KOHNUM(4)(1:1) = "0"      )
                 OR (TBL-TOKATUKAIFLG(1)   =  1       )
                 OR (TBL-TOKATUKAIFLG(2)   =  1       )
                 OR (TBL-TOKATUKAIFLG(3)   =  1       )
                 OR (TBL-TOKATUKAIFLG(4)   =  1       )
                    MOVE    1    TO    RECE62-RJNGAIKOHFTN(3)
                 END-IF
               END-IF
           END-IF
      *
           .
       2104D-TOKU75-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７５歳到達月の特例判定（公費請求分）
      *****************************************************************
       2104D1-TOKU75-HANTEI-KOHSKY-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-TOKU75-KOHSKY
      *
           PERFORM   VARYING   TOKU75-IDX    FROM    1   BY  1
                      UNTIL   (TOKU75-IDX                   >  10  )
                       OR     (RECE62-HKNCOMBI(TOKU75-IDX)  =  ZERO)
                       OR     (FLG-TOKU75-KOHSKY            =  1   )
      *
             INITIALIZE                  HKNCOMBI-REC
             MOVE    RECE62-HOSPNUM  TO  COMB-HOSPNUM
             MOVE    RECE62-PTID     TO  COMB-PTID
             MOVE    RECE62-HKNCOMBI(TOKU75-IDX)
                                     TO  COMB-HKNCOMBINUM
             MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
             PERFORM 900-HKNCOMBI-INV-SEC
             IF      FLG-HKNCOMBI    =   ZERO
                 PERFORM   VARYING   TOKU75-IDX2   FROM    1   BY  1
                            UNTIL   (TOKU75-IDX2        >  4)
                              OR    (FLG-TOKU75-KOHSKY  =  1)
                   IF ( COMB-KOHHKNNUM(TOKU75-IDX2)
                                              = "972" OR "974" )
                   OR ((FLG-TOKU75  = 1 OR 2                  ) AND
                       (COMB-KOHHKNNUM(TOKU75-IDX2)(1:1) = "0"))
                   OR ((FLG-TOKU75  = 1 OR 2                  ) AND
                       (WRK-PREFNUM                 = "13"    ) AND
                       (COMB-KOHHKNNUM(TOKU75-IDX2) = "151"   ) AND
                       (TOKU75-IDX2                 =  1      ) AND
                       (RECE62-SRYYM               >= "200905"))
                   OR ((FLG-TOKU75  = 1 OR 2                  ) AND
                       (WRK-PREFNUM                 = "23"    ) AND
                       (COMB-KOHHKNNUM(TOKU75-IDX2) = "191"   ) AND
                       (TOKU75-IDX2                 =  1      ) AND
                       (RECE62-SRYYM               >= "200910"))
                     INITIALIZE               ORCSFTNJGNCHKAREA
                     MOVE RECE62-HOSPNUM   TO LNK-FTNJGNCHK-HOSPNUM
                     MOVE RECE62-PTID      TO LNK-FTNJGNCHK-PTID
                     MOVE "1"              TO LNK-FTNJGNCHK-NYUGAIKBN
                     MOVE RECE62-SRYYM     TO LNK-FTNJGNCHK-SRYYM
                     MOVE COMB-KOHHKNNUM(TOKU75-IDX2)
                                           TO LNK-FTNJGNCHK-KOHNUM
                     MOVE COMB-KOHID(TOKU75-IDX2)
                                           TO LNK-FTNJGNCHK-KOHID
                     MOVE WRK-PREFNUM      TO LNK-FTNJGNCHK-PREFNUM
                     MOVE COMB-HKNCOMBINUM TO LNK-FTNJGNCHK-HKNCOMBINUM
                     MOVE COMB-HKNID       TO LNK-FTNJGNCHK-HKNID
                     CALL "ORCSFTNJGNCHK"  USING
                                           ORCSFTNJGNCHKAREA
                                           SPA-AREA
                     IF     LNK-FTNJGNCHK-RC   =   ZERO
                         MOVE    1    TO    FLG-TOKU75-KOHSKY
                     END-IF
                   END-IF
                 END-PERFORM
             END-IF
      *
           END-PERFORM
      *
           .
       2104D1-TOKU75-HANTEI-KOHSKY-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の判定
      *****************************************************************
       2104E-TOKUSITU-HANTEI-SEC               SECTION.
      *
           INITIALIZE               TBL-TOKUSITU
           MOVE     ZERO      TO    FLG-TOKUSITU
           MOVE     ZERO      TO    FLG-TOKUSITU-TASU
           MOVE     ZERO      TO    FLG-KISAIOK
           IF   (RECE62-SRYYM       >=  "200905")
           AND  (RECE62-HKNNUM   NOT =   SPACE  )
             IF  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
             OR  (RECE62-HKNNUM       =   "068" OR "069" OR "040")
               CONTINUE
             ELSE
               IF (((RECE62-KOHNUM(1) =  "051" OR "052" OR "091") OR
                    (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(1)(5:3) = "601" OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(1)(1:2) = "51"  OR "52"  ))
               OR (( RECE62-KOHNUM(1) =  "052"                   ) AND
                   ( RECE62-KOHFTNJANUM(1)(5:2) = "60"           ) AND
                   ( RECE62-KOHFTNJANUM(1)(1:2) = "52"           ))
               OR (((RECE62-KOHNUM(2) =  "051" OR "052" OR "091") OR
                    (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(2)(5:3) = "601" OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(2)(1:2) = "51"  OR "52"  ))
               OR (( RECE62-KOHNUM(2) =  "052"                   ) AND
                   ( RECE62-KOHFTNJANUM(2)(5:2) = "60"           ) AND
                   ( RECE62-KOHFTNJANUM(2)(1:2) = "52"           ))
               OR (((RECE62-KOHNUM(3) =  "051" OR "052" OR "091") OR
                    (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(3)(5:3) = "601" OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(3)(1:2) = "51"  OR "52"  ))
               OR (( RECE62-KOHNUM(3) =  "052"                   ) AND
                   ( RECE62-KOHFTNJANUM(3)(5:2) = "60"           ) AND
                   ( RECE62-KOHFTNJANUM(3)(1:2) = "52"           ))
               OR (((RECE62-KOHNUM(4) =  "051" OR "052" OR "091") OR
                    (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(4)(5:3) = "601" OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(4)(1:2) = "51"  OR "52"  ))
               OR (( RECE62-KOHNUM(4) =  "052"                   ) AND
                   ( RECE62-KOHFTNJANUM(4)(5:2) = "60"           ) AND
                   ( RECE62-KOHFTNJANUM(4)(1:2) = "52"           ))
      *
                 IF (((RECE62-KOHNUM(1) =  "051" OR "052" OR "091") OR
                      (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(1)(5:3) = "601" OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(1)(1:2) = "51"  OR "52"  ))
                 OR (( RECE62-KOHNUM(1) =  "052"                   ) AND
                     ( RECE62-KOHFTNJANUM(1)(5:2) = "60"           ) AND
                     ( RECE62-KOHFTNJANUM(1)(1:2) = "52"           ))
                    MOVE     1     TO    TBL-TOKUSITUFLG(1)
                 END-IF
                 IF (((RECE62-KOHNUM(2) =  "051" OR "052" OR "091") OR
                      (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(2)(5:3) = "601" OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(2)(1:2) = "51"  OR "52"  ))
                 OR (( RECE62-KOHNUM(2) =  "052"                   ) AND
                     ( RECE62-KOHFTNJANUM(2)(5:2) = "60"           ) AND
                     ( RECE62-KOHFTNJANUM(2)(1:2) = "52"           ))
                    MOVE     1     TO    TBL-TOKUSITUFLG(2)
                 END-IF
                 IF (((RECE62-KOHNUM(3) =  "051" OR "052" OR "091") OR
                      (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(3)(5:3) = "601" OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(3)(1:2) = "51"  OR "52"  ))
                 OR (( RECE62-KOHNUM(3) =  "052"                   ) AND
                     ( RECE62-KOHFTNJANUM(3)(5:2) = "60"           ) AND
                     ( RECE62-KOHFTNJANUM(3)(1:2) = "52"           ))
                    MOVE     1     TO    TBL-TOKUSITUFLG(3)
                 END-IF
                 IF (((RECE62-KOHNUM(4) =  "051" OR "052" OR "091") OR
                      (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(4)(5:3) = "601" OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(4)(1:2) = "51"  OR "52"  ))
                 OR (( RECE62-KOHNUM(4) =  "052"                   ) AND
                     ( RECE62-KOHFTNJANUM(4)(5:2) = "60"           ) AND
                     ( RECE62-KOHFTNJANUM(4)(1:2) = "52"           ))
                    MOVE     1     TO    TBL-TOKUSITUFLG(4)
                 END-IF
      *
                 MOVE      RECE62-SRYYM         TO   WRK-GEN70-YM
                 IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                   MOVE    RECE62-TEKSTYMD(7:2) TO   WRK-GEN70-DD
                 ELSE
                   MOVE    01                   TO   WRK-GEN70-DD
                 END-IF
                 IF  ((RECE62-AGE         >=   70  ) OR
                      (RECE62-HKNNUM       =  "039"))
                 AND ( RECE62-YOBIETC(8)   =  ZERO  )
                   IF    RECE62-KYURATE     =   30
                        MOVE    1    TO   FLG-TOKUSITU
                   ELSE
                     IF  RECE62-TEISYOTOKU  =  SPACE
                        MOVE    2    TO   FLG-TOKUSITU
                     ELSE
                        MOVE    3    TO   FLG-TOKUSITU
                     END-IF
                   END-IF
                 ELSE
                   PERFORM   2104E1-TOKUSITU-HANTEI2-SEC
                 END-IF
      *
                 IF     FLG-TOKUSITU   NOT =  ZERO
                   PERFORM   2104E2-TOKUSITU-HANTEI3-SEC
                   IF   FLG-TOKUSITU-TASU  =  1
                      MOVE    8    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
                      EVALUATE  FLG-TOKUSITU
                        WHEN       1
                          MOVE   4    TO   RECE62-RJNNYUKOHFTN(2)
                        WHEN       2
                          MOVE   5    TO   RECE62-RJNNYUKOHFTN(2)
                        WHEN       3
                          MOVE   6    TO   RECE62-RJNNYUKOHFTN(2)
                      END-EVALUATE
                   ELSE
                    IF  ((RECE62-AGE         >=   70  ) OR
                         (RECE62-HKNNUM       =  "039"))
                    AND ( RECE62-YOBIETC(8)   =  ZERO  )
                      IF    RECE62-KYURATE     =   30
                        MOVE     1   TO   FLG-KISAIOK
                      ELSE
                        IF  RECE62-TEISYOTOKU  =  SPACE
                          PERFORM   2104E3-TOKUSITU-HANTEI4-SEC
                        ELSE
                          MOVE   1   TO   FLG-KISAIOK
                        END-IF
                      END-IF
                    ELSE
                      MOVE       1   TO   FLG-KISAIOK
                    END-IF
                    IF   FLG-KISAIOK  =  1
                      MOVE    7    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
                      EVALUATE  FLG-TOKUSITU
                        WHEN       1
                          MOVE   1    TO   RECE62-RJNNYUKOHFTN(2)
                        WHEN       2
                          MOVE   2    TO   RECE62-RJNNYUKOHFTN(2)
                        WHEN       3
                          MOVE   3    TO   RECE62-RJNNYUKOHFTN(2)
                      END-EVALUATE
                    END-IF
                   END-IF
                 ELSE
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(1)
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(2)
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(3)
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(4)
                 END-IF
      *
               ELSE
      *
                 IF      IDZ   =   2
                   MOVE      RECE62-SRYYM         TO   WRK-GEN70-YM
                   IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                     MOVE    RECE62-TEKSTYMD(7:2) TO   WRK-GEN70-DD
                   ELSE
                     MOVE    01                   TO   WRK-GEN70-DD
                   END-IF
                   IF  ((RECE62-AGE         >=   70  ) OR
                        (RECE62-HKNNUM       =  "039"))
                   AND ( RECE62-YOBIETC(8)   =  ZERO  )
                     INITIALIZE                      SSRHKOH-AREA
                     MOVE    RECE62-PTID         TO  SSRHKOH-PTID
                     MOVE    "1"                 TO  SSRHKOH-NYUGAIKBN
                     MOVE    RECE62-SRYYM        TO  SSRHKOH-SRYYM
                     MOVE    RECE62-HKNCOMBI(1)  TO  SSRHKOH-HKNCOMBI
                     CALL    "ORCSSRHKOH"        USING
                                                 SSRHKOH-AREA
                                                 SPA-AREA
                     IF   SSRHKOH-RC  =  1
                        IF    RECE62-KYURATE     =   30
                             MOVE    1    TO   FLG-TOKUSITU
                        ELSE
                          IF  RECE62-TEISYOTOKU  =  SPACE
                             MOVE    2    TO   FLG-TOKUSITU
                          ELSE
                             MOVE    3    TO   FLG-TOKUSITU
                          END-IF
                        END-IF
                     END-IF
                   ELSE
                     INITIALIZE                      SSRHKOH-AREA
                     MOVE    RECE62-PTID         TO  SSRHKOH-PTID
                     MOVE    "1"                 TO  SSRHKOH-NYUGAIKBN
                     MOVE    RECE62-SRYYM        TO  SSRHKOH-SRYYM
                     MOVE    RECE62-HKNCOMBI(1)  TO  SSRHKOH-HKNCOMBI
                     CALL    "ORCSSRHKOH"        USING
                                                 SSRHKOH-AREA
                                                 SPA-AREA
                     IF   SSRHKOH-RC  =  1
                        PERFORM   2104E1-TOKUSITU-HANTEI2-SEC
                     END-IF
                   END-IF
                   IF     FLG-TOKUSITU   NOT =  ZERO
                        PERFORM   2104E2-TOKUSITU-HANTEI3-SEC
                        IF   FLG-TOKUSITU-TASU  =  1
                          EVALUATE  FLG-TOKUSITU
                            WHEN       1
                              MOVE   4    TO   RECE62-RJNNYUKOHFTN(2)
                            WHEN       2
                              MOVE   5    TO   RECE62-RJNNYUKOHFTN(2)
                            WHEN       3
                              MOVE   6    TO   RECE62-RJNNYUKOHFTN(2)
                          END-EVALUATE
                        ELSE
                         IF  ((RECE62-AGE         >=   70  ) OR
                              (RECE62-HKNNUM       =  "039"))
                         AND ( RECE62-YOBIETC(8)   =  ZERO  )
                           IF    RECE62-KYURATE     =   30
                             MOVE     1   TO   FLG-KISAIOK
                           ELSE
                             IF  RECE62-TEISYOTOKU  =  SPACE
                               PERFORM   2104E3-TOKUSITU-HANTEI4-SEC
                             ELSE
                               MOVE   1   TO   FLG-KISAIOK
                             END-IF
                           END-IF
                         ELSE
                           MOVE       1   TO   FLG-KISAIOK
                         END-IF
                         IF   FLG-KISAIOK  =  1
                          EVALUATE  FLG-TOKUSITU
                            WHEN       1
                              MOVE   1    TO   RECE62-RJNNYUKOHFTN(2)
                            WHEN       2
                              MOVE   2    TO   RECE62-RJNNYUKOHFTN(2)
                            WHEN       3
                              MOVE   3    TO   RECE62-RJNNYUKOHFTN(2)
                          END-EVALUATE
                         END-IF
                        END-IF
                   END-IF
                 END-IF
      *
               END-IF
             END-IF
           END-IF
      *
           .
       2104E-TOKUSITU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       2104E1-TOKUSITU-HANTEI2-SEC               SECTION.
      *
           PERFORM  VARYING  GEN-IDX   FROM   1    BY   1
                     UNTIL  (GEN-IDX    >    TBL-TOKUJYOI-MAX)
                       OR   (FLG-TOKUSITU   NOT = ZERO       )
              INITIALIZE                      PTKOHINF-REC
              MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
              MOVE  RECE62-PTID           TO  PTKOH-PTID
              MOVE  TBL-TOKUJYOI(GEN-IDX) TO  PTKOH-KOHNUM
              MOVE  PTKOHINF-REC          TO  MCPDATA-REC
              MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
              MOVE  "key4"                TO  MCP-PATHNAME
              PERFORM 900-DBSELECT-SEC
              IF      MCP-RC               =       ZERO
                MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
                MOVE    "key4"            TO  MCP-PATHNAME
                PERFORM  900-PTKOHINF-READ-SEC
                PERFORM  UNTIL   FLG-PTKOHINF    =   1
                   IF  (PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD )
                   AND (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD)
                   AND (PTKOH-SAKJOKBN   =   SPACE         )
                     MOVE     1      TO  FLG-TOKUSITU
                     MOVE     1      TO  FLG-PTKOHINF
                   ELSE
                     MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                     MOVE    "key4"           TO  MCP-PATHNAME
                     PERFORM  900-PTKOHINF-READ-SEC
                   END-IF
                END-PERFORM
              END-IF
              MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
              MOVE    "key4"               TO  MCP-PATHNAME
              PERFORM 900-CLOSE-SEC
           END-PERFORM
           IF    FLG-TOKUSITU  =  ZERO
             PERFORM  VARYING  GEN-IDX   FROM   1    BY   1
                       UNTIL  (GEN-IDX    >    TBL-TOKUIPAN-MAX)
                         OR   (FLG-TOKUSITU   NOT = ZERO       )
                INITIALIZE                      PTKOHINF-REC
                MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
                MOVE  RECE62-PTID           TO  PTKOH-PTID
                MOVE  TBL-TOKUIPAN(GEN-IDX) TO  PTKOH-KOHNUM
                MOVE  PTKOHINF-REC          TO  MCPDATA-REC
                MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
                MOVE  "key4"                TO  MCP-PATHNAME
                PERFORM 900-DBSELECT-SEC
                IF      MCP-RC               =       ZERO
                  MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
                  MOVE    "key4"            TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                     IF  (PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD )
                     AND (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD)
                     AND (PTKOH-SAKJOKBN   =   SPACE         )
                       IF  RECE62-TEISYOTOKU  =  SPACE
                            MOVE    2    TO   FLG-TOKUSITU
                       ELSE
                            MOVE    3    TO   FLG-TOKUSITU
                       END-IF
                       MOVE         1    TO   FLG-PTKOHINF
                     ELSE
                       MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                       MOVE    "key4"           TO  MCP-PATHNAME
                       PERFORM  900-PTKOHINF-READ-SEC
                     END-IF
                  END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM 900-CLOSE-SEC
             END-PERFORM
           END-IF
      *
           .
       2104E1-TOKUSITU-HANTEI2-EXT.
           EXIT.
      *
      *****************************************************************
      *    多数該当
      *****************************************************************
       2104E2-TOKUSITU-HANTEI3-SEC               SECTION.
      *
           IF  ((RECE62-AGE         >=   70  ) OR
                (RECE62-HKNNUM       =  "039"))
           AND ( RECE62-YOBIETC(8)   =  ZERO  )
           AND ( FLG-TOKUSITU    =   2  OR  3 )
             CONTINUE
           ELSE
             INITIALIZE                      PTKOHINF-REC
             MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE  RECE62-PTID           TO  PTKOH-PTID
             MOVE  "958"                 TO  PTKOH-KOHNUM
             MOVE  PTKOHINF-REC          TO  MCPDATA-REC
             MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
             MOVE  "key4"                TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key4"            TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF  (PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD )
                  AND (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD)
                  AND (PTKOH-SAKJOKBN   =   SPACE         )
                    MOVE     1      TO  FLG-TOKUSITU-TASU
                    MOVE     1      TO  FLG-PTKOHINF
                  ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
           .
       2104E2-TOKUSITU-HANTEI3-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       2104E3-TOKUSITU-HANTEI4-SEC               SECTION.
      *
           INITIALIZE                      PTKOHINF-REC
           MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
           MOVE  RECE62-PTID           TO  PTKOH-PTID
           MOVE  "957"                 TO  PTKOH-KOHNUM
           MOVE  PTKOHINF-REC          TO  MCPDATA-REC
           MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
           MOVE  "key4"                TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
             MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
             MOVE    "key4"            TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF  (PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD )
                AND (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD)
                AND (PTKOH-SAKJOKBN   =   SPACE         )
                  MOVE    1    TO   FLG-KISAIOK
                  MOVE    1    TO   FLG-PTKOHINF
                ELSE
                  MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                  MOVE    "key4"           TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                END-IF
             END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       2104E3-TOKUSITU-HANTEI4-EXT.
           EXIT.
      *
      *****************************************************************
      *    ワークファイルクリア
      *****************************************************************
       2104H-WRKFILE-CLEAR-SEC      SECTION.
      *
           IF  (IDZ                 =     1    )
           AND (RECE62-SRYYM       >=  "201004")
              MOVE   RECE62-FTNMONEY(1)  TO   RECE62-FTNMONEY-SKY
              IF   FLG-WRKFILE-CLEAR   =   1
                MOVE   FTN-KOH-XXX       TO   WRK-JIRITU-SAIKEI
                MOVE   FTN-KOH-XX3       TO   WRK-JIRITU-SAIKEI2
                MOVE   ZERO              TO   RECE62-FTNMONEY(1)
                MOVE   ZERO              TO   FLG-KEISAN-TOK1
                MOVE   ZERO              TO   FLG-KEISAN-TOK2
                MOVE   ZERO              TO   FTN-KOH-XXX
              END-IF
           END-IF
      *
           .
       2104H-WRKFILE-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    包括点数の治験減点分編集
      *****************************************************************
       2113-GENTEN-HENSYU-SEC      SECTION.
      *
      *    指導のレセ点数の編集（減点）
           IF   RECE62-TENSU(2 1)  >=  WRK-RECE62G-TENSU(2 1)
             COMPUTE  RECE62-TENSU(2 1)  =
                      RECE62-TENSU(2 1)  -  WRK-RECE62G-TENSU(2 1)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(2 1)
           END-IF
           IF   RECE62-TENSU(2 2)  >=  WRK-RECE62G-TENSU(2 2)
             COMPUTE  RECE62-TENSU(2 2)  =
                      RECE62-TENSU(2 2)  -  WRK-RECE62G-TENSU(2 2)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(2 2)
           END-IF
           IF   RECE62-TENSU(2 3)  >=  WRK-RECE62G-TENSU(2 3)
             COMPUTE  RECE62-TENSU(2 3)  =
                      RECE62-TENSU(2 3)  -  WRK-RECE62G-TENSU(2 3)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(2 3)
           END-IF
           IF   RECE62-TENSU(2 4)  >=  WRK-RECE62G-TENSU(2 4)
             COMPUTE  RECE62-TENSU(2 4)  =
                      RECE62-TENSU(2 4)  -  WRK-RECE62G-TENSU(2 4)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(2 4)
           END-IF
      *
      *    在宅のレセ点数の編集（減点）
           IF   RECE62-TENSU(3 1)  >=  WRK-RECE62G-TENSU(3 1)
             COMPUTE  RECE62-TENSU(3 1)  =
                      RECE62-TENSU(3 1)  -  WRK-RECE62G-TENSU(3 1)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(3 1)
           END-IF
           IF   RECE62-TENSU(3 2)  >=  WRK-RECE62G-TENSU(3 2)
             COMPUTE  RECE62-TENSU(3 2)  =
                      RECE62-TENSU(3 2)  -  WRK-RECE62G-TENSU(3 2)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(3 2)
           END-IF
           IF   RECE62-TENSU(3 3)  >=  WRK-RECE62G-TENSU(3 3)
             COMPUTE  RECE62-TENSU(3 3)  =
                      RECE62-TENSU(3 3)  -  WRK-RECE62G-TENSU(3 3)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(3 3)
           END-IF
           IF   RECE62-TENSU(3 4)  >=  WRK-RECE62G-TENSU(3 4)
             COMPUTE  RECE62-TENSU(3 4)  =
                      RECE62-TENSU(3 4)  -  WRK-RECE62G-TENSU(3 4)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(3 4)
           END-IF
      *
           .
       2113-GENTEN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    分点編集
      *****************************************************************
       2114-BUNTENSU-HENSYU-SEC               SECTION.
      *
           IF    RECE62-FUKUSHIFLG(3)  =  "2"
              IF  (RECE62-KOHNUM(2)(1:1)  >= "1" AND <= "8"  )
              AND (RECE62-HENTOTALTEN(3) = RECE62-TOTALTEN(3))
                  MOVE   SPACE   TO   RECE62-FUKUSHIFLG(3)
                  MOVE   2       TO   KOHFTN-IDX
                  PERFORM  21141-FTNKBNFLG-CLEAR-SEC
              END-IF
           END-IF
           IF    RECE62-FUKUSHIFLG(4)  =  "2"
              IF  (RECE62-KOHNUM(3)(1:1)  >= "1" AND <= "8"  )
              AND (RECE62-HENTOTALTEN(4) = RECE62-TOTALTEN(4))
                  MOVE   SPACE   TO   RECE62-FUKUSHIFLG(4)
                  MOVE   3       TO   KOHFTN-IDX
                  PERFORM  21141-FTNKBNFLG-CLEAR-SEC
              END-IF
           END-IF
           IF    RECE62-FUKUSHIFLG(5)  =  "2"
              IF  (RECE62-KOHNUM(4)(1:1)  >= "1" AND <= "8"  )
              AND (RECE62-HENTOTALTEN(5) = RECE62-TOTALTEN(5))
                  MOVE   SPACE   TO   RECE62-FUKUSHIFLG(5)
                  MOVE   4       TO   KOHFTN-IDX
                  PERFORM  21141-FTNKBNFLG-CLEAR-SEC
              END-IF
           END-IF
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   3   BY   1
      ***              UNTIL    KOHFTN-IDX     >    5
                       UNTIL    KOHFTN-IDX     >    4
      *
             IF   RECE62-FUKUSHIFLG(KOHFTN-IDX)   NOT =  SPACE
                IF   (RECE62-KOHNUM(1)   = "972" OR "974")
                AND  (KOHFTN-IDX         >   3           )
                    PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                                UNTIL    KOHFTN-IDX2     >   30
                       COMPUTE  RECE62-TENSU(KOHFTN-IDX2 KOHFTN-IDX) =
                                RECE62-TENSU(KOHFTN-IDX2 1)          -
                                RECE62-TENSU(KOHFTN-IDX2 3)
                    END-PERFORM
                    PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                                UNTIL    KOHFTN-IDX2     >   10
                       COMPUTE  RECE62-NYUKHNKEI(KOHFTN-IDX2 KOHFTN-IDX)
                             =  RECE62-NYUKHNKEI(KOHFTN-IDX2 1)
                             -  RECE62-NYUKHNKEI(KOHFTN-IDX2 3)
                       COMPUTE  RECE62-NYUTOKKEI(KOHFTN-IDX2 KOHFTN-IDX)
                             =  RECE62-NYUTOKKEI(KOHFTN-IDX2 1)
                             -  RECE62-NYUTOKKEI(KOHFTN-IDX2 3)
                    END-PERFORM
                    COMPUTE  RECE62-NYUKHNKEI2(KOHFTN-IDX)
                          =  RECE62-NYUKHNKEI2(1)
                          -  RECE62-NYUKHNKEI2(3)
                    COMPUTE  RECE62-NYUTOKKEI2(KOHFTN-IDX)
                          =  RECE62-NYUTOKKEI2(1)
                          -  RECE62-NYUTOKKEI2(3)
                ELSE
                    PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                                UNTIL    KOHFTN-IDX2     >   30
                       COMPUTE  RECE62-TENSU(KOHFTN-IDX2 KOHFTN-IDX) =
                                RECE62-TENSU(KOHFTN-IDX2 1)          -
                                RECE62-TENSU(KOHFTN-IDX2 2)
                    END-PERFORM
                    PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                                UNTIL    KOHFTN-IDX2     >   10
                       COMPUTE  RECE62-NYUKHNKEI(KOHFTN-IDX2 KOHFTN-IDX)
                             =  RECE62-NYUKHNKEI(KOHFTN-IDX2 1)
                             -  RECE62-NYUKHNKEI(KOHFTN-IDX2 2)
                       COMPUTE  RECE62-NYUTOKKEI(KOHFTN-IDX2 KOHFTN-IDX)
                             =  RECE62-NYUTOKKEI(KOHFTN-IDX2 1)
                             -  RECE62-NYUTOKKEI(KOHFTN-IDX2 2)
                    END-PERFORM
                    COMPUTE  RECE62-NYUKHNKEI2(KOHFTN-IDX)
                          =  RECE62-NYUKHNKEI2(1)
                          -  RECE62-NYUKHNKEI2(2)
                    COMPUTE  RECE62-NYUTOKKEI2(KOHFTN-IDX)
                          =  RECE62-NYUTOKKEI2(1)
                          -  RECE62-NYUTOKKEI2(2)
                END-IF
             END-IF
      *
           END-PERFORM
      *
           .
       2114-BUNTENSU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセ電用負担区分編集フラグクリア
      *****************************************************************
       21141-FTNKBNFLG-CLEAR-SEC               SECTION.
      *
           PERFORM  VARYING  IDX13   FROM    1   BY  1
                     UNTIL  (IDX13                   >   10 )
                       OR   (RECE62-HKNCOMBI(IDX13)  =  ZERO)
      *
             IF  (RECE62-KOHNUMHC(IDX13 2) = RECE62-KOHNUM(KOHFTN-IDX))
             AND (RECE62-KOHIDHC(IDX13 2)  = RECE62-KOHID(KOHFTN-IDX) )
               MOVE      ZERO   TO   RECE62-FTNKBNFLG(IDX13 2)
               IF   (WRK-PREFNUM              = "36"    )
               AND  (RECE62-KOHNUMHC(IDX13 2) = "245"   )
               AND  (RECE62-KOHNUMHC(IDX13 3) = "748"   )
               AND  (RECE62-SRYYM            >= "200805")
                  MOVE   ZERO   TO   RECE62-FTNKBNFLG(IDX13 3)
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
       21141-FTNKBNFLG-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    災害該当者の判定
      *****************************************************************
       2115-SAIGAI-TAISYO-HANTEI-SEC      SECTION.
      *
           IF     RECE62-HKNNUM   NOT =   SPACE
             IF  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
               CONTINUE
             ELSE
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU-YM
               IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                  MOVE   RECE62-TEKSTYMD(7:2)
                                            TO   WK-GENGAKU-DD
               ELSE
                  MOVE   01                 TO   WK-GENGAKU-DD
               END-IF
      *
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU2-YM
               IF   RECE62-TEKEDYMD-X(1:6) >  RECE62-SRYYM
                 INITIALIZE                      STS-AREA-DAY
                 INITIALIZE                      LNK-DAY7-AREA
                 MOVE   "71"                TO   LNK-DAY7-IRAI
                 MOVE   RECE62-SRYYM        TO   LNK-DAY7-YM
                 CALL   "ORCSDAY"         USING  STS-AREA-DAY
                                                 LNK-DAY7-AREA
                 MOVE   LNK-DAY7-KOYOMI     TO   WRK-EDYMD
                 MOVE   WRK-EDYMD(7:2)      TO   WK-GENGAKU2-DD
               ELSE
                 MOVE   RECE62-TEKEDYMD-X(7:2)
                                            TO   WK-GENGAKU2-DD
               END-IF
      *
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU3-YM
               IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
                  MOVE   RECE62-TEKSTYMD-X(7:2)
                                            TO   WK-GENGAKU3-DD
               ELSE
                  MOVE   01                 TO   WK-GENGAKU3-DD
               END-IF
      *
               PERFORM  21151-SAIGAI-TAISYO-HENSYU-SEC
             END-IF
           ELSE
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU-YM
               IF   RECE62-KOHTEKSTYMD(1)(1:6)
                                          >=  RECE62-SRYYM
                  MOVE   RECE62-KOHTEKSTYMD(1)(7:2)
                                            TO   WK-GENGAKU-DD
               ELSE
                  MOVE   01                 TO   WK-GENGAKU-DD
               END-IF
      *
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU2-YM
               IF   RECE62-KOHTEKEDYMD(1)(1:6)
                                           >  RECE62-SRYYM
                 INITIALIZE                      STS-AREA-DAY
                 INITIALIZE                      LNK-DAY7-AREA
                 MOVE   "71"                TO   LNK-DAY7-IRAI
                 MOVE   RECE62-SRYYM        TO   LNK-DAY7-YM
                 CALL   "ORCSDAY"         USING  STS-AREA-DAY
                                                 LNK-DAY7-AREA
                 MOVE   LNK-DAY7-KOYOMI     TO   WRK-EDYMD
                 MOVE   WRK-EDYMD(7:2)      TO   WK-GENGAKU2-DD
               ELSE
                 MOVE   RECE62-KOHTEKEDYMD(1)(7:2)
                                            TO   WK-GENGAKU2-DD
               END-IF
      *
               MOVE     "99999999"          TO   WK-GENGAKU3-YMD
      *
               PERFORM  21151-SAIGAI-TAISYO-HENSYU-SEC
           END-IF
      *
           .
       2115-SAIGAI-TAISYO-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    災害該当者の編集
      *****************************************************************
       21151-SAIGAI-TAISYO-HENSYU-SEC      SECTION.
      *
           INITIALIZE                       PTKOHINF-REC
           MOVE    RECE62-HOSPNUM       TO  PTKOH-HOSPNUM
           MOVE    RECE62-PTID          TO  PTKOH-PTID
           MOVE    "959"                TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC         TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =   ZERO
              MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
              MOVE    "key4"             TO  MCP-PATHNAME
              PERFORM  900-PTKOHINF-READ-SEC
              PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF ((PTKOH-TEKSTYMD  <=   WK-GENGAKU-YMD ) AND
                    (WK-GENGAKU-YMD  <=   PTKOH-TEKEDYMD ) AND
                    (PTKOH-SAKJOKBN   =   SPACE          ))
                OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU2-YMD) AND
                    (WK-GENGAKU2-YMD <=   PTKOH-TEKEDYMD ) AND
                    (PTKOH-SAKJOKBN   =   SPACE          ))
                OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU3-YMD) AND
                    (WK-GENGAKU3-YMD <=   PTKOH-TEKEDYMD ) AND
                    (WK-GENGAKU3-YMD NOT = "99999999"    ) AND
                    (PTKOH-SAKJOKBN   =   SPACE          ))
                  MOVE     1             TO  FLG-SAIGAI-TAISYO
                  IF   PTKOH-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                     MOVE   PTKOH-TEKSTYMD(7:2)
                                         TO  WRK-SAIGAI-DD
                  ELSE
                     MOVE   01           TO  WRK-SAIGAI-DD
                  END-IF
                  MOVE     1             TO  FLG-PTKOHINF
                ELSE
                  MOVE    "tbl_ptkohinf" TO  MCP-TABLE
                  MOVE    "key4"         TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                END-IF
              END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       21151-SAIGAI-TAISYO-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額情報編集
      *****************************************************************
       2116-SKY-HENSYU-SEC      SECTION.
      *
           IF   (IDZ             =    1    )
           AND  (RECE62-SRYYM   >= "201004")
      *
      *      ＜医療費＞
      *
             COMPUTE  RECE62-FTNMONEY-SKY =
                      RECE62-FTNMONEY-SKY +
                      (WRK-FTNKEI-SAGAKU  +  WRK-FTNKEI-SAGAKU2)
      *      主保険がある保険組み合わせ
             IF    (WRK-SKY-ZENGAKU      >  ZERO            )
             AND   (WRK-SKY-ICHIBUFTN    >  WRK-SKY-FTNMONEY)
               MOVE    ZERO    TO   FLG-KGK
               IF     RECE62-KOUREI   =  "1" OR "2"
                 COMPUTE      WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU
                                              - WRK-SKY-HOKENJA
                 IF    (WRK-SKY-ICHIBUFTN  >  RECE62-FTNMONEY-SKY)
                 AND   (WRK-SKY-KEISAN     >  RECE62-FTNMONEY-SKY)
                   COMPUTE    WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                              - RECE62-FTNMONEY-SKY
                   ADD    WRK-SKY-KEISAN2  TO  RECE62-SKYIRYO-HOKENJA
                 END-IF
               ELSE
                 IF   RECE62-KOUREI   =  SPACE
                   COMPUTE    WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU-KOH
                                              - WRK-SKY-HOKENJA-KOH
                   IF  (WRK-SKY-KEISAN     >  RECE62-FTNMONEY-SKY)
                     COMPUTE  WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                              - RECE62-FTNMONEY-SKY
                     ADD  WRK-SKY-KEISAN2  TO  RECE62-SKYIRYO-HOKENJA
                     MOVE     1            TO  FLG-KGK
                   END-IF
      *
                   IF  (WK-GENGAKUKBN         =   ZERO)
                   AND (WRK-SKY-ZENGAKU-KOH   =   ZERO)
                     COMPUTE  WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU
                                              - WRK-SKY-HOKENJA
                     IF   WRK-SKY-KEISAN   >  WRK-SKY-FTNMONEY
                      COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                              - WRK-SKY-FTNMONEY
                      ADD  WRK-SKY-KEISAN2 TO  RECE62-SKYIRYO-HOKENJA
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               MOVE WRK-SKY-FTNMONEY    TO  WRK-SKY-FTNMONEY9
               IF   WRK-SKY-FTNMONEY >= WRK-SKY-FTNMONEY-XXX
                 COMPUTE  WRK-SKY-FTNMONEY9         =
                          WRK-SKY-FTNMONEY          -
                          WRK-SKY-FTNMONEY-XXX
                 COMPUTE  RECE62-SKYIRYO-ICHIBUFTN  =
                          RECE62-SKYIRYO-ICHIBUFTN  -
                          WRK-SKY-FTNMONEY-XXX
               END-IF
               COMPUTE    WRK-SKY-FTNMONEY-KOH9     =
                          WRK-SKY-FTNMONEY-KOH      +
                          0.5
      *
               IF   WRK-SKY-ZENGAKU-KOH  >  ZERO
                 IF     RECE62-KOUREI   =  "1" OR "2"
                   IF     RECE62-FTNMONEY-SKY
                                          >  WRK-SKY-FTNMONEY9
                     COMPUTE   WRK-SKY-KEISAN2 = RECE62-FTNMONEY-SKY
                                               - WRK-SKY-FTNMONEY9
                     ADD    WRK-SKY-KEISAN2  TO  RECE62-SKYIRYO-KOHFTN
                   END-IF
                 ELSE
                   IF   FLG-KGK   =   1
                     IF   RECE62-FTNMONEY-SKY
                                          >  WRK-SKY-FTNMONEY-KOH9
                       COMPUTE WRK-SKY-KEISAN2 = RECE62-FTNMONEY-SKY
                                               - WRK-SKY-FTNMONEY-KOH9
                       ADD  WRK-SKY-KEISAN2  TO  RECE62-SKYIRYO-KOHFTN
                     END-IF
                   ELSE
                     COMPUTE   WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU-KOH
                                               - WRK-SKY-HOKENJA-KOH
                     IF   FLG-SKY-TOKKOH   =   1
                       COMPUTE WRK-SKY-KEISAN  = WRK-SKY-KEISAN +  5
                       COMPUTE WRK-SKY-KEISAN  = WRK-SKY-KEISAN / 10
                       COMPUTE WRK-SKY-KEISAN  = WRK-SKY-KEISAN * 10
                     END-IF
                     IF   WRK-SKY-KEISAN  >  WRK-SKY-FTNMONEY-KOH9
                       COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                               - WRK-SKY-FTNMONEY-KOH9
                       ADD  WRK-SKY-KEISAN2  TO  RECE62-SKYIRYO-KOHFTN
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
      *      主保険がない保険組み合わせ
             IF    (WRK-SKY-ZENGAKU2     >  ZERO             )
             AND   (WRK-SKY-ZENGAKU2     >  WRK-SKY-FTNMONEY2)
               COMPUTE    WRK-SKY-KEISAN2  =  WRK-SKY-ZENGAKU2
                                           -  WRK-SKY-FTNMONEY2
               ADD    WRK-SKY-KEISAN2   TO  RECE62-SKYIRYO-KOHFTN
             END-IF
      *
      *      ＜食事＞
      *
      *      主保険がある保険組み合わせ
             IF    (WRK-SKY-SKJ-ZENGAKU      >  ZERO                )
             AND   (WRK-SKY-SKJ-ICHIBUFTN    >  WRK-SKY-SKJ-FTNMONEY)
                 COMPUTE  WRK-SKY-KEISAN2  =  WRK-SKY-SKJ-ICHIBUFTN
                                           -  WRK-SKY-SKJ-FTNMONEY
                 ADD  WRK-SKY-KEISAN2   TO  RECE62-SKYSKJ-KOHFTN
             END-IF
      *      主保険がない保険組み合わせ
             IF    (WRK-SKY-SKJ-ZENGAKU2     >  ZERO                 )
             AND   (WRK-SKY-SKJ-ZENGAKU2     >  WRK-SKY-SKJ-FTNMONEY2)
               COMPUTE    WRK-SKY-KEISAN2  =  WRK-SKY-SKJ-ZENGAKU2
                                           -  WRK-SKY-SKJ-FTNMONEY2
               ADD    WRK-SKY-KEISAN2   TO  RECE62-SKYSKJ-KOHFTN
             END-IF
           ELSE
             INITIALIZE        RECE62-SKYIRYO-INF
             INITIALIZE        RECE62-SKYSKJ-INF
           END-IF
      *
           .
       2116-SKY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト請求区分による公費情報の振り分け処理
      *****************************************************************
       2106-RECESKYKBN-HENSYU-SEC      SECTION.
      *
      *    初期化
           MOVE    RECE62-REC     TO  WRK-RECE62-REC
           INITIALIZE                 RECE62-KOHINF-AREA
                                      RECE62-HKNCOMBIINF-AREA
                                      RECE62-JNISSUINF-AREA
                                      RECE62-TOTALTENINF-AREA
                                      RECE62-FTNMONEYINF-AREA
                                      RECE62-SHOKUJIINF-AREA
                                      RECE62-FUKUSHIFLG-SKJINF-AREA
                                      RECE62-FUKUSHIFLG-SKJIPAINF-AREA
                                      RECE62-FUKUSHIFLG-SKJSEIINF-AREA
                                      RECE62-ETC-KOH-G
                                      RECE62-HENTOTALTENINF-AREA
                                      RECE62-HENSHOKUJIINF-AREA
                                      RECE62-NYUKHNINF2
                                      RECE62-NYUTOKINF2
                                      RECE62-KISAIFLGINF-AREA
                                      RECE62-ZEROKISAIFLGINF-AREA
                                      RECE62-ETCKISAIFLGINF-AREA
                                      RECE62-FUKUSHIFLGINF-AREA
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       30
               INITIALIZE              RECE62-TENSUINF-AREA (IDX)
           END-PERFORM
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       10
               INITIALIZE              RECE62-NYUKHNKEIINF-AREA (IDX)
                                       RECE62-NYUTOKKEIINF-AREA (IDX)
           END-PERFORM
      *
      *    主保険情報のみ編集
           MOVE    WRK-RECE62-JNISSU        (1)
                                       TO  RECE62-JNISSU        (1)
           MOVE    WRK-RECE62-TOTALTEN      (1)
                                       TO  RECE62-TOTALTEN      (1)
           MOVE    WRK-RECE62-FTNMONEY      (1)
                                       TO  RECE62-FTNMONEY      (1)
           MOVE    WRK-RECE62-FTNMONEY-FTN  (1)
                                       TO  RECE62-FTNMONEY-FTN  (1)
           MOVE    WRK-RECE62-FTNMONEY-KOJ  (1)
                                       TO  RECE62-FTNMONEY-KOJ  (1)
           MOVE    WRK-RECE62-HENTOTALTEN   (1)
                                       TO  RECE62-HENTOTALTEN   (1)
           MOVE    WRK-RECE62-HENSHOKUJIRYOYOHI(1)
                                 TO  RECE62-HENSHOKUJIRYOYOHI   (1)
           MOVE    WRK-RECE62-SHOKUJIINF    (1)
                                       TO  RECE62-SHOKUJIINF    (1)
           MOVE    WRK-RECE62-NYUKHNKEI2    (1)
                                       TO  RECE62-NYUKHNKEI2    (1)
           MOVE    WRK-RECE62-NYUTOKKEI2    (1)
                                       TO  RECE62-NYUTOKKEI2    (1)
           MOVE    WRK-RECE62-KISAIFLG      (1)
                                       TO  RECE62-KISAIFLG      (1)
           MOVE    WRK-RECE62-ZEROKISAIFLG  (1)
                                       TO  RECE62-ZEROKISAIFLG  (1)
           MOVE    WRK-RECE62-EKF-JNISSUFLG(1)
                                       TO  RECE62-EKF-JNISSUFLG(1)
           MOVE    WRK-RECE62-EKF-TOTALTENFLG(1)
                                       TO  RECE62-EKF-TOTALTENFLG(1)
           MOVE    WRK-RECE62-EKF-SKJFLG(1)
                                       TO  RECE62-EKF-SKJFLG(1)
           MOVE    WRK-RECE62-EKF-OCRFLG(1)
                                       TO  RECE62-EKF-OCRFLG(1)
           MOVE    WRK-RECE62-FUKUSHIFLG(1)
                                       TO  RECE62-FUKUSHIFLG(1)
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       30
               MOVE    WRK-RECE62-TENSU (IDX 1)
                                           TO  RECE62-TENSU (IDX 1)
           END-PERFORM
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       10
               MOVE    WRK-RECE62-NYUKHNKEIINF (IDX 1)
                                       TO  RECE62-NYUKHNKEIINF (IDX 1)
               MOVE    WRK-RECE62-NYUTOKKEIINF (IDX 1)
                                       TO  RECE62-NYUTOKKEIINF (IDX 1)
           END-PERFORM
      *
      *    レセプト請求区分による公費情報の振り分け
      *    公費情報・実日数・請求点数・負担金額
      *    明細点数・合計点数（ぶん点・公費分離区分編集用）
           MOVE    ZERO                TO  IDY
                                           IDXX
                                           IDZX
           PERFORM VARYING IDX     FROM    1   BY  1
                   UNTIL   IDX     >       4
               IF      WRK-RECE62-KOHNUM (IDX) NOT =   SPACE
                   COMPUTE IDXX    =   IDX +   1
                   EVALUATE    WRK-RECE62-RECESKYKBN (IDX)
                       WHEN    SPACE
                           ADD     1       TO  IDY
                           MOVE    WRK-RECE62-KOHINF (IDX)
                                           TO  RECE62-KOHINF (IDY)
                           MOVE    WRK-RECE62-FUKUSHIFLG-SKJ (IDX)
                                           TO  RECE62-FUKUSHIFLG-SKJ
                                                             (IDY)
                           MOVE    WRK-RECE62-FUKUSHIFLG-SKJIPA (IDX)
                                        TO  RECE62-FUKUSHIFLG-SKJIPA
                                                             (IDY)
                           MOVE    WRK-RECE62-FUKUSHIFLG-SKJSEI (IDX)
                                        TO  RECE62-FUKUSHIFLG-SKJSEI
                                                             (IDY)
                           COMPUTE IDYX    =   IDY +   1
                           MOVE    WRK-RECE62-JNISSU      (IDXX)
                                           TO  RECE62-JNISSU      (IDYX)
                           MOVE    WRK-RECE62-TOTALTEN    (IDXX)
                                           TO  RECE62-TOTALTEN    (IDYX)
                           MOVE    WRK-RECE62-FTNMONEY    (IDXX)
                                           TO  RECE62-FTNMONEY    (IDYX)
                           MOVE    WRK-RECE62-FTNMONEY-FTN(IDXX)
                                           TO  RECE62-FTNMONEY-FTN(IDYX)
                           MOVE    WRK-RECE62-FTNMONEY-KOJ(IDXX)
                                           TO  RECE62-FTNMONEY-KOJ(IDYX)
                           MOVE    WRK-RECE62-SHOKUJIINF  (IDXX)
                                           TO  RECE62-SHOKUJIINF  (IDYX)
                           MOVE    WRK-RECE62-NYUKHNKEI2  (IDXX)
                                           TO  RECE62-NYUKHNKEI2  (IDYX)
                           MOVE    WRK-RECE62-NYUTOKKEI2  (IDXX)
                                           TO  RECE62-NYUTOKKEI2  (IDYX)
                           MOVE    WRK-RECE62-HENTOTALTEN (IDXX)
                                           TO  RECE62-HENTOTALTEN (IDYX)
                           MOVE    WRK-RECE62-HENSHOKUJIRYOYOHI(IDXX)
                                     TO  RECE62-HENSHOKUJIRYOYOHI (IDYX)
                           PERFORM VARYING IDX1    FROM    1   BY  1
                                   UNTIL   IDX1    >       30
                               MOVE    WRK-RECE62-TENSU (IDX1 IDXX)
                                           TO  RECE62-TENSU (IDX1 IDYX)
                           END-PERFORM
                           PERFORM VARYING IDX1    FROM    1   BY  1
                                   UNTIL   IDX1    >       10
                               MOVE
                                   WRK-RECE62-NYUKHNKEIINF (IDX1 IDXX)
                                           TO  RECE62-NYUKHNKEIINF
                                                           (IDX1 IDYX)
                               MOVE
                                   WRK-RECE62-NYUTOKKEIINF (IDX1 IDXX)
                                       TO  RECE62-NYUTOKKEIINF
                                                           (IDX1 IDYX)
                           END-PERFORM
                           MOVE    WRK-RECE62-KISAIFLG (IDXX)
                                           TO  RECE62-KISAIFLG (IDYX)
                           MOVE    WRK-RECE62-ZEROKISAIFLG (IDXX)
                                           TO  RECE62-ZEROKISAIFLG(IDYX)
                           MOVE    WRK-RECE62-EKF-JNISSUFLG(IDXX)
                                        TO  RECE62-EKF-JNISSUFLG(IDYX)
                           MOVE    WRK-RECE62-EKF-TOTALTENFLG(IDXX)
                                        TO  RECE62-EKF-TOTALTENFLG(IDYX)
                           MOVE    WRK-RECE62-EKF-SKJFLG(IDXX)
                                        TO  RECE62-EKF-SKJFLG(IDYX)
                           MOVE    WRK-RECE62-EKF-OCRFLG(IDXX)
                                        TO  RECE62-EKF-OCRFLG(IDYX)
                           MOVE    WRK-RECE62-FUKUSHIFLG(IDXX)
                                        TO  RECE62-FUKUSHIFLG(IDYX)
                       WHEN    "4"
                           ADD     1       TO  IDZX
                           MOVE    WRK-RECE62-KOHNUM (IDX)
                                           TO  RECE62-ETC-KOHNUM (IDZX)
                           MOVE    WRK-RECE62-KOHFTNJANUM (IDX)
                                           TO  RECE62-ETC-KOHFTNJANUM
                                                                 (IDZX)
                           MOVE    WRK-RECE62-JNISSU   (IDXX)
                                           TO  RECE62-ETC-JNISSU (IDZX)
                           MOVE    WRK-RECE62-TOTALTEN (IDXX)
                                           TO RECE62-ETC-TOTALTEN(IDZX)
                           MOVE    WRK-RECE62-FTNMONEY (IDXX)
                                           TO RECE62-ETC-FTNMONEY(IDZX)
                           MOVE    WRK-RECE62-FTNMONEY-FTN (IDXX)
                                       TO RECE62-ETC-FTNMONEY-FTN(IDZX)
                           MOVE    WRK-RECE62-FTNMONEY-KOJ (IDXX)
                                       TO RECE62-ETC-FTNMONEY-KOJ(IDZX)
                           MOVE    WRK-RECE62-SHOKUJINISSU   (IDXX)
                                           TO  RECE62-ETC-SHOKUJINISSU
                                                                 (IDZX)
                           MOVE    WRK-RECE62-SHOKUJIRYOYOHI (IDXX)
                                           TO RECE62-ETC-SHOKUJIRYOYOHI
                                                                 (IDZX)
                           MOVE    WRK-RECE62-SHOKUJIFTN (IDXX)
                                           TO RECE62-ETC-SHOKUJIFTN
                                                                 (IDZX)
                   END-EVALUATE
               END-IF
           END-PERFORM
      *
      *    保険組合せ番号情報
           PERFORM VARYING IDX     FROM    1   BY  1
                   UNTIL   IDX     >       10
               IF     WRK-RECE62-HKNCOMBI (IDX)    NOT =   ZERO
                   MOVE    WRK-RECE62-HKNCOMBI (IDX)
                                           TO  RECE62-HKNCOMBI (IDX)
                   MOVE    WRK-RECE62-HKNNUMHC (IDX)
                                           TO  RECE62-HKNNUMHC (IDX)
                   PERFORM VARYING IDY     FROM    1   BY  1
                           UNTIL   IDY     >       4
                       IF     WRK-RECE62-KOHNUMHC (IDX IDY)
                                           NOT =   SPACE
                           PERFORM VARYING IDXX    FROM    1   BY  1
                                   UNTIL   IDXX    >       4
                               IF   (WRK-RECE62-KOHNUMHC (IDX IDY)   =
                                                  RECE62-KOHNUM (IDXX))
                               AND  (WRK-RECE62-KOHIDHC  (IDX IDY)   =
                                                  RECE62-KOHID  (IDXX))
                                   MOVE    WRK-RECE62-KOHNUMHCINF
                                                         (IDX IDY)
                                                   TO
                                           RECE62-KOHNUMHCINF(IDX IDY)
                               END-IF
                           END-PERFORM
                       END-IF
                   END-PERFORM                 
               END-IF
           END-PERFORM
      *
           .
       2106-RECESKYKBN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトＯＣＲ領域のセット１
      *****************************************************************
       2107-OCR1-HENSYU-SEC                   SECTION.
      *
           INITIALIZE                           OCR1-AREA
      *
      *保険者番号
           IF      WRK-3SYU-KBN           =   ALL "1" AND 
                   RECE62-HKNNUM          =   SPACE            
      *        ３種の場合
               INITIALIZE                           ORCSNUMAREA
               MOVE    RECE62-KOHFTNJANUM(SEIHIDX)
                                            TO      SNUM-INX
               CALL    "ORCSNUM"            USING   ORCSNUMAREA
               IF      SNUM-RC              =       ZERO
                       MOVE   SNUM-OUTNUM   TO      OCR1-HKNJANUM
               ELSE
                       MOVE   ZERO          TO      OCR1-HKNJANUM
               END-IF
           ELSE
               INITIALIZE                           ORCSNUMAREA
               MOVE    RECE62-HKNJANUM      TO      SNUM-INX
               CALL    "ORCSNUM"            USING   ORCSNUMAREA
               IF      SNUM-RC              =       ZERO
                       MOVE   SNUM-OUTNUM   TO      OCR1-HKNJANUM
               ELSE
                       MOVE   ZERO          TO      OCR1-HKNJANUM
               END-IF
           END-IF
      *医療機関コード
           MOVE   SYS-1001-HOSPCD       TO      OCR1-HOSPCD
      *請求点数
           MOVE    RECE62-TOTALTEN(IDX5)
                                        TO      OCR1-SKYTENSU
      *チェックディジット１
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-SKYTENSU        TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT1
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT1
           END-IF
      *薬剤一部負担金
      *    MOVE    ZERO                 TO      OCR1-YKZFTN
      *生月日
           MOVE    "0"                  TO      OCR1-YKZFTN (1:1)
           MOVE    RECE62-BIRTHDAY      TO      WRK-BIRTHDAY
           MOVE    WRK-BIRTHDAY (5:4)   TO      OCR1-YKZFTN (2:4)
      *チェックディジット２
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-YKZFTN          TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT2
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT2
           END-IF
      *一部負担金
           MOVE    RECE62-FTNMONEY(IDX5)
                                        TO      OCR1-FTNMONEY
      *チェックディジット３
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-FTNMONEY        TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT3
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT3
           END-IF
      *チェックディジット４
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(1:35)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT4
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT4
           END-IF
      *診療実日数
           MOVE    RECE62-JNISSU(IDX5)  TO      OCR1-JNISSU
      *診療年月（和暦）
           INITIALIZE                           LNK-DAY1-AREA
           INITIALIZE                           STS-AREA-DAY
           MOVE    "11"                 TO      LNK-DAY1-IRAI
           MOVE    RECE62-SRYYM         TO      LNK-DAY1-YMD(1:6)
           MOVE    "01"                 TO      LNK-DAY1-YMD(7:2)
           CALL    "ORCSDAY"            USING   STS-AREA-DAY
                                                LNK-DAY1-AREA
           IF      STS-DAY-RC1          =       ZERO
                   MOVE  LNK-DAY1-YMD-X(3:4)
                                        TO      OCR1-SRYYM
           ELSE
                   MOVE  ZERO           TO      OCR1-SRYYM
           END-IF
      *チェックディジット５
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(37:6)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT5
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT5
           END-IF
      *市町村番号
           IF      RECE62-RJNFTNJANUM   =       SPACE
               MOVE  ZERO               TO      OCR1-FTNJANUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-RJNFTNJANUM
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR1-FTNJANUM
               ELSE
                       MOVE   ZERO      TO      OCR1-FTNJANUM
               END-IF
           END-IF
      *受給者番号
           IF      RECE62-RJNJKYSNUM    =       SPACE
               MOVE  ZERO               TO      OCR1-JKYSNUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-RJNJKYSNUM
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR1-JKYSNUM
               ELSE
                       MOVE   ZERO      TO      OCR1-JKYSNUM
               END-IF
           END-IF
      *チェックディジット６
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(44:15)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT6
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT6
           END-IF
      *都道府県番号
           MOVE    SYS-1001-PREFNUM     TO      OCR1-PREFNUM
      *点数表
           IF      RECE62-RECESYUBETU   =    6666
               MOVE    RECE62-RECESYUBETU-X(1:1)
                                        TO      OCR1-TENSUHYO
           ELSE
               MOVE    RECE62-RECESYUBETU(1:1)
                                        TO      OCR1-TENSUHYO
           END-IF
      *保険種別１
           IF      RECE62-RECESYUBETU   =    6666
               MOVE    RECE62-RECESYUBETU-X(2:1)
                                        TO      OCR1-HKNSYUBETU1
           ELSE
               MOVE    RECE62-RECESYUBETU(2:1)
                                        TO      OCR1-HKNSYUBETU1
           END-IF
      *保険種別２
           IF      RECE62-RECESYUBETU   =    6666
               MOVE    RECE62-RECESYUBETU-X(3:1)
                                        TO      OCR1-HKNSYUBETU2
           ELSE
               MOVE    RECE62-RECESYUBETU(3:1)
                                        TO      OCR1-HKNSYUBETU2
           END-IF
      *本人・家族・入外
           IF      RECE62-RECESYUBETU   =    6666
               MOVE    RECE62-RECESYUBETU-X(4:1)
                                        TO      OCR1-HONKZKKBN
           ELSE
               MOVE    RECE62-RECESYUBETU(4:1)
                                        TO      OCR1-HONKZKKBN
           END-IF
      *整理番号
           MOVE    1                    TO      OCR1-SEIRINO
      *チェックディジット７
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(60:7)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT7
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT7
           END-IF
      *
           MOVE    OCR1-AREA            TO      RECE62-OCR1           
      *
           .
       2107-OCR1-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトＯＣＲ領域のセット２（Ｆ００２）
      *****************************************************************
       2108-OCR2-HENSYU-SEC                   SECTION.
      *
           INITIALIZE                           OCR2-AREA
      *
      *性別
           MOVE    RECE62-SEX           TO      OCR2-SEX
      *元号・生年
           INITIALIZE                           LNK-DAY1-AREA
           INITIALIZE                           STS-AREA-DAY
           MOVE    "11"                 TO      LNK-DAY1-IRAI
           MOVE    RECE62-BIRTHDAY      TO      LNK-DAY1-YMD
           CALL    "ORCSDAY"            USING   STS-AREA-DAY
                                                LNK-DAY1-AREA
           IF      STS-DAY-RC1          =       ZERO
                   MOVE  LNK-DAY1-YMD-X(2:1)
                                        TO      OCR2-GENGO
                   MOVE  LNK-DAY1-YMD-X(3:2)
                                        TO      OCR2-BIRTHYY
           ELSE
                   MOVE  ZERO           TO      OCR2-GENGO
                   MOVE  ZERO           TO      OCR2-BIRTHYY
           END-IF
      *チェックディジット１
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(1:4)       TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT1
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT1
           END-IF
      *記号・番号
           IF      WRK-3SYU-KBN           =   ALL "1" AND 
                   RECE62-HKNNUM          =   SPACE
      *        ３種の場合（８桁）
               MOVE    RECE62-KOHJKYSNUM (SEIHIDX)
                                           TO  WRK-ZENKAKU
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-NUM-9           TO  OCR2-KIGO
               MOVE    ZERO                TO  OCR2-NUM
           ELSE
               MOVE    RECE62-KIGO         TO  WRK-ZENKAKU
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-NUM-9           TO  OCR2-KIGO
      *
               MOVE    RECE62-NUM          TO  WRK-ZENKAKU
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-NUM-9           TO  OCR2-NUM
           END-IF
      *チェックディジット２
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(6:20)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT2
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT2
           END-IF
      *公費１負担者番号
           IF      RECE62-KOHFTNJANUM(IDA) =      SPACE
               MOVE  ZERO               TO      OCR2-FTNJANUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-KOHFTNJANUM(IDA)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR2-FTNJANUM
               ELSE
                       MOVE   ZERO      TO      OCR2-FTNJANUM
               END-IF
           END-IF
      *公費１受給者番号
           IF      RECE62-KOHJKYSNUM(IDA) =       SPACE
               MOVE  ZERO               TO      OCR2-JKYSNUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-KOHJKYSNUM(IDA)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR2-JKYSNUM
               ELSE
                       MOVE   ZERO      TO      OCR2-JKYSNUM
               END-IF
           END-IF
      *チェックディジット３
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(27:15)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT3
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT3
           END-IF
      *公費１診療実日数・請求点数
           IF      RECE62-JNISSU   (IDX5)  =   RECE62-JNISSU   (IDX6)
           AND     RECE62-TOTALTEN (IDX5)  =   RECE62-TOTALTEN (IDX6)
           AND     RECE62-JSKISAIFLG       =   SPACE
           AND     RECE62-EKF-OCRFLG(IDX6) =   SPACE
               MOVE    ZERO                 TO  OCR2-JNISSU
                                                OCR2-TENSU   
           ELSE    
               MOVE    RECE62-JNISSU  (IDX6)   TO  OCR2-JNISSU
               MOVE    RECE62-TOTALTEN(IDX6)   TO  OCR2-TENSU
           END-IF
      *チェックディジット４
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(45:7)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT4
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT4
           END-IF
      *公費１薬剤一部負担金
           MOVE    ZERO                 TO      OCR2-YKZFTN
      *チェックディジット５
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(53:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT5
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT5
           END-IF
      *公費１患者負担額
           MOVE    RECE62-FTNMONEY(IDX6)
                                        TO      OCR2-FTNMONEY
      *チェックディジット６
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(59:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT6
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT6
           END-IF
      *チェックディジット７
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(43:22)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT7
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT7
           END-IF
      *予備１
           MOVE    SPACE                TO      OCR2-YOBI
      *
           IF      OCR2-AREA-X          =   ALL "0"
               MOVE    SPACE                    TO  OCR2-AREA-X
           END-IF  
           MOVE    OCR2-AREA            TO      RECE62-OCR2
      *
           .
       2108-OCR2-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトＯＣＲ領域のセット３（Ｆ００２）
      *****************************************************************
       2109-OCR3-HENSYU-SEC                   SECTION.
      *
           INITIALIZE                           OCR3-AREA
      *
      *公費２負担者番号
           IF      RECE62-KOHFTNJANUM(IDB) =      SPACE
               MOVE  ZERO               TO      OCR3-FTNJANUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-KOHFTNJANUM(IDB)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR3-FTNJANUM
               ELSE
                       MOVE   ZERO      TO      OCR3-FTNJANUM
               END-IF
           END-IF
      *公費２受給者番号
           IF      RECE62-KOHJKYSNUM(IDB) =       SPACE
               MOVE  ZERO               TO      OCR3-JKYSNUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-KOHJKYSNUM(IDB)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR3-JKYSNUM
               ELSE
                       MOVE   ZERO      TO      OCR3-JKYSNUM
               END-IF
           END-IF
      *チェックディジット１
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(1:15)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT1
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT1
           END-IF
      *公費２診療実日数・請求点数
           IF      RECE62-JNISSU   (IDX6)  =   RECE62-JNISSU   (IDX7)
           AND     RECE62-TOTALTEN (IDX6)  =   RECE62-TOTALTEN (IDX7)
           AND     RECE62-JSKISAIFLG       =   SPACE
           AND     RECE62-EKF-OCRFLG(IDX7) =   SPACE
               MOVE    ZERO                 TO  OCR3-JNISSU
                                                OCR3-TENSU   
           ELSE    
               MOVE    RECE62-JNISSU  (IDX7)   TO  OCR3-JNISSU
               MOVE    RECE62-TOTALTEN(IDX7)   TO  OCR3-TENSU
           END-IF
      *チェックディジット２
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(19:7)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT2
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT2
           END-IF
      *公費２薬剤一部負担金
           MOVE    ZERO                 TO      OCR3-YKZFTN
      *チェックディジット３
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(27:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT3
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT3
           END-IF
      *公費２患者負担額
           MOVE    RECE62-FTNMONEY(IDX7)
                                        TO      OCR3-FTNMONEY
      *チェックディジット４
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(33:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT4
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT4
           END-IF
      *チェックディジット５
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(17:22)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT5
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT5
           END-IF
      *予備２
           MOVE    SPACE                TO      OCR3-YOBI
      *
           IF      OCR3-AREA-X          =   ALL "0"
               MOVE    SPACE                TO  RECE62-OCR3
           ELSE 
               MOVE    OCR3-AREA            TO  RECE62-OCR3
           END-IF
      *
           .
       2109-OCR3-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    全角→数値半角変換処理
      *****************************************************************
       800-NUM-ZENKAKU-HENKAN-SEC    SECTION.
      *
           MOVE    ZERO                TO  WRK-STIDX
                                           WRK-EDIDX 
           MOVE    SPACE               TO  WRK-NUM
           MOVE    ZERO                TO  WRK-NUM-9
      *
      *    空白のときはゼロ 
           IF      WRK-ZENKAKU          =       SPACE
               MOVE    ZERO                TO  WRK-NUM
               MOVE    10                  TO  IDY   
           ELSE
      *
      *        文字の開始桁
               PERFORM VARYING IDX FROM    1   BY  1
                       UNTIL   IDX         >   80
                       OR      WRK-STIDX   >   ZERO
                   IF      WRK-ZENKAKU (IDX:1)  NOT =   SPACE
                       MOVE    IDX                 TO  WRK-STIDX
                   END-IF     
               END-PERFORM
      *        文字の終了桁
               PERFORM VARYING IDX FROM    80  BY  -1
                       UNTIL   IDX         <   1
                       OR      WRK-EDIDX   >   ZERO
                   IF      WRK-ZENKAKU (IDX:1)  NOT =   SPACE
                       MOVE    IDX                 TO  WRK-EDIDX
                   END-IF     
               END-PERFORM
      *
      *        全角数字のとき半角数字に変換（数字以外のときはゼロ）
               IF      WRK-ZENKAKU (WRK-STIDX:1)   >=  X"A1"
                   MOVE    ZERO                TO  IDX3
                   PERFORM VARYING     IDX     FROM    WRK-STIDX  BY  2
                           UNTIL       IDX     >       WRK-EDIDX
                       IF      WRK-ZENKAKU (IDX:2)  >= "０"  AND
                                                   <=  "９"
                           ADD     1               TO  IDX3
                           EVALUATE    WRK-ZENKAKU (IDX:2)
                               WHEN    "０"
                                   MOVE    "0"     TO  WRK-NUM (IDX3:1)
                               WHEN    "１"
                                   MOVE    "1"     TO  WRK-NUM (IDX3:1)
                               WHEN    "２"
                                   MOVE    "2"     TO  WRK-NUM (IDX3:1)
                               WHEN    "３"
                                   MOVE    "3"     TO  WRK-NUM (IDX3:1)
                               WHEN    "４"
                                   MOVE    "4"     TO  WRK-NUM (IDX3:1)
                               WHEN    "５"
                                   MOVE    "5"     TO  WRK-NUM (IDX3:1)
                               WHEN    "６"
                                   MOVE    "6"     TO  WRK-NUM (IDX3:1)
                               WHEN    "７"
                                   MOVE    "7"     TO  WRK-NUM (IDX3:1)
                               WHEN    "８"
                                   MOVE    "8"     TO  WRK-NUM (IDX3:1)
                               WHEN    "９"
                                   MOVE    "9"     TO  WRK-NUM (IDX3:1)
                           END-EVALUATE
      *****************ELSE
      *****************    MOVE    ZERO            TO  WRK-NUM
      *****************    MOVE    WRK-EDIDX       TO  IDX
      *****************    MOVE    10              TO  IDX3
                       END-IF
                   END-PERFORM
                   MOVE    IDX3                TO  IDY     
               ELSE
      *        半角数字に変換（数字以外のときはゼロ）
                   INSPECT WRK-ZENKAKU(WRK-STIDX:)  REPLACING   ALL " "
                                                                BY  "0"
                   IF      WRK-ZENKAKU(WRK-STIDX:)     NOT NUMERIC
                       PERFORM VARYING IDX     FROM    WRK-STIDX  BY  1
                               UNTIL   IDX     >       WRK-EDIDX
                           IF      WRK-ZENKAKU (IDX:1) >=  "0" AND
                                                       <=  "9"
                               ADD     1           TO  IDX3
                               MOVE    WRK-ZENKAKU (IDX:1)
                                                   TO  WRK-NUM (IDX3:1)
                           END-IF
                       END-PERFORM    
                       MOVE    IDX3                TO  IDY     
                   ELSE
                       COMPUTE IDY     =   WRK-EDIDX   -
                                           WRK-STIDX   +   1
                       MOVE    WRK-ZENKAKU (WRK-STIDX:IDY) TO  WRK-NUM
                   END-IF     
               END-IF
           END-IF
      *
           INITIALIZE                      ORCSNUMAREA
           MOVE    WRK-NUM-X           TO  SNUM-INX
           CALL    "ORCSNUM"           USING   ORCSNUMAREA
           IF      SNUM-RC             =   ZERO
               MOVE    SNUM-OUTNUM         TO  WRK-NUM-9
           ELSE
               MOVE    ZERO                TO  WRK-NUM-9 
           END-IF
      *
           .
       800-NUM-ZENKAKU-HENKAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    地方公費の給付外点数の編集
      *****************************************************************
       300-KYUFUGAI-HENSYU-SEC         SECTION.
      *
           MOVE    ZERO                TO  RECE62-KYUFUGAITEN
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL   IDX1    >       10
                   OR      RECE62-HKNCOMBI (IDX1)  =   ZERO
               IF      RECE62-KOHNUMHC (IDX1 1)
                                       NOT =   SPACE
      *            
                   INITIALIZE                  ORCSKOHPLUS-AREA
                   MOVE    RECE62-HOSPNUM  TO  LNK-SKOHPLUS-HOSPNUM
                   MOVE    SYS-1001-PREFNUM
                                           TO  LNK-SKOHPLUS-PREFNUM
                   MOVE    RECE62-PTID     TO  LNK-SKOHPLUS-PTID
                   MOVE    RECE62-HKNCOMBI (IDX1)
                                           TO  LNK-SKOHPLUS-HKNCOMBI
                   MOVE    RECE62-SRYYM    TO  LNK-SKOHPLUS-SRYYMD(1:6)
                   MOVE    "01"            TO  LNK-SKOHPLUS-SRYYMD(7:2)
                   CALL    "ORCSKOHPLUS"   USING
                                           ORCSKOHPLUS-AREA
                                           SPA-AREA
      *           
                   IF    ( LNK-SKOHPLUS-RC     =   ZERO )
                   AND   ( LNK-SKOHPLUS-FTNKBN =   "1"  )
                       IF   RECE62-SRYKA (1)  NOT =  SPACE
                           INITIALIZE                  SYUNOU-REC
                           MOVE    RECE62-HOSPNUM  TO  SYU-HOSPNUM
                           MOVE    RECE62-NYUGAIKBN
                                                   TO  SYU-NYUGAIKBN
                           MOVE    RECE62-PTID     TO  SYU-PTID
                           MOVE    RECE62-SRYYM    TO  SYU-SRYYMD(1:6)
                           MOVE    "__"            TO  SYU-SRYYMD(7:2)
                           MOVE    RECE62-HKNCOMBI (IDX1)
                                                   TO  SYU-HKNCOMBINUM
                           MOVE    SYUNOU-REC      TO  MCPDATA-REC
                           MOVE    "tbl_syunou"    TO  MCP-TABLE
                           MOVE    "key19"         TO  MCP-PATHNAME
                           PERFORM   900-DBSELECT-SEC
                           IF      MCP-RC          =   ZERO
                               MOVE    "tbl_syunou"    TO  MCP-TABLE
                               MOVE    "key19"         TO  MCP-PATHNAME
                               PERFORM 900-SYUNOU-READ-SEC
                               PERFORM UNTIL   FLG-SYUNOU  =    1
                                   ADD     SYU-KYUFUGAI-GOKEI-TEN
                                                TO  RECE62-KYUFUGAITEN
                                   MOVE    "tbl_syunou" TO  MCP-TABLE
                                   MOVE    "key19"      TO  MCP-PATHNAME
                                   PERFORM 900-SYUNOU-READ-SEC
                               END-PERFORM          
                           END-IF
      *
                           MOVE    "tbl_syunou"    TO  MCP-TABLE
                           MOVE    "key19"         TO  MCP-PATHNAME
                           PERFORM 900-CLOSE-SEC
                       END-IF
                   END-IF
               END-IF
           END-PERFORM
      *
           .
       300-KYUFUGAI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＫＥＹ編集処理
      *****************************************************************
       500-RECE64-KEY-HENSYU-SEC       SECTION.
      *
           MOVE    SPACE               TO  RECE64-REC
           INITIALIZE                      RECE64-REC
           MOVE    RECE62-HOSPNUM      TO  RECE64-HOSPNUM
           MOVE    RECE62-SRYYM        TO  RECE64-SRYYM
           MOVE    RECE62-NYUGAIKBN    TO  RECE64-NYUGAIKBN
           MOVE    RECE62-PTID         TO  RECE64-PTID
           MOVE    RECE62-RECEKA       TO  RECE64-RECEKA
           MOVE    RECE62-TEISYUTUSAKI TO  RECE64-TEISYUTUSAKI
           MOVE    RECE62-RECESYUBETU  TO  RECE64-RECESYUBETU
           MOVE    RECE62-HKNJANUM-KEY TO  RECE64-HKNJANUM
           MOVE    RECE62-HOJOKBN-KEY  TO  RECE64-HOJOKBN
           MOVE    RECE62-KOHID-KEY    TO  RECE64-KOHID
           MOVE    RECE62-TEKSTYMD     TO  RECE64-TEKSTYMD
           .
       500-RECE64-KEY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＫＥＹ編集処理
      *****************************************************************
       500-RECE65-KEY-HENSYU-SEC       SECTION.
      *
           MOVE    SPACE               TO  RECE65-REC
           INITIALIZE                      RECE65-REC
           MOVE    RECE62-HOSPNUM      TO  RECE65-HOSPNUM
           MOVE    RECE62-SRYYM        TO  RECE65-SRYYM
           MOVE    RECE62-NYUGAIKBN    TO  RECE65-NYUGAIKBN
           MOVE    RECE62-PTID         TO  RECE65-PTID
           MOVE    RECE62-RECEKA       TO  RECE65-RECEKA
           MOVE    RECE62-TEISYUTUSAKI TO  RECE65-TEISYUTUSAKI
           MOVE    RECE62-RECESYUBETU  TO  RECE65-RECESYUBETU
           MOVE    RECE62-HKNJANUM-KEY TO  RECE65-HKNJANUM
           MOVE    RECE62-HOJOKBN-KEY  TO  RECE65-HOJOKBN
           MOVE    RECE62-KOHID-KEY    TO  RECE65-KOHID
           MOVE    RECE62-TEKSTYMD     TO  RECE65-TEKSTYMD
           .
       500-RECE65-KEY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数テーブルの検索
      *****************************************************************
       900-TENSU-TBL-SEC               SECTION.
      *
           MOVE    ZERO                     TO      FLG-TENSU
           MOVE    WRK-SRYCD                TO      TTNS-CHK-SRYCD
           MOVE    WK-TAIHI-SRYYMD          TO      TTNS-CHK-YMD
      *
      *    点数マスタ退避ワークチェック
           PERFORM 9001-TTNS-CHK-SEC
      *
      *
      *    退避ワークに存在しない場合はＤＢを検索
           IF    ( TTNS-FLG            =   ZERO )
      *
               INITIALIZE                           TNS-TENSU-REC
               MOVE    WRK-SRYCD            TO      TNS-SRYCD
               MOVE    SPA-HOSPNUM          TO      TNS-HOSPNUM
               MOVE    WK-TAIHI-SRYYMD      TO      TNS-YUKOSTYMD
                                                    TNS-YUKOEDYMD
               MOVE    TNS-TENSU-REC        TO      MCPDATA-REC
               MOVE    "tbl_tensu"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               PERFORM   900-DBSELECT-SEC
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_tensu"      TO      MCP-TABLE
                   MOVE    "key"            TO      MCP-PATHNAME
                   PERFORM  910-TENSU-READ-SEC
                   IF       FLG-TENSU       =       1
                       DISPLAY   "TENSU FETCH ERR"  
                   ELSE
      *                点数マスタ退避ワークに編集する
                       PERFORM 9001-TTNS-HEN-SEC
                   END-IF
               ELSE
                   INITIALIZE       TNS-TENSU-REC
                   MOVE    1   TO   FLG-TENSU
                   DISPLAY   "TENSU SELECT ERR" 
               END-IF
      *
               MOVE    "tbl_tensu"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               PERFORM   900-CLOSE-SEC
      *
           END-IF
      *
           .
       900-TENSU-TBL-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ退避ワークチェック処理
      *****************************************************************
       9001-TTNS-CHK-SEC               SECTION.
      *
           MOVE    ZERO                TO  TTNS-FLG
           INITIALIZE                      TNS-TENSU-REC
      *
           PERFORM VARYING TTNS-IDX    FROM    1   BY  1
                   UNTIL ( TTNS-IDX    >   TTNS-MAX )
                    OR   ( TTNS-FLG    =   1 )
               IF    ( TTNS-KEY-SRYCD (TTNS-IDX)
                                       =   TTNS-CHK-SRYCD )
                 AND ( TTNS-KEY-YUKOSTYMD (TTNS-IDX)
                                      <=   TTNS-CHK-YMD )
                 AND ( TTNS-KEY-YUKOEDYMD (TTNS-IDX)
                                      >=   TTNS-CHK-YMD )
                   MOVE    1           TO  TTNS-FLG
                   MOVE    TTNS-DAT (TTNS-IDX)
                                       TO  TNS-TENSU-REC
               END-IF
           END-PERFORM
      *
           .
       9001-TTNS-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ退避ワーク編集処理
      *****************************************************************
       9001-TTNS-HEN-SEC               SECTION.
      *
           IF      TNS-TANIMOJISU    =   ZERO
           AND     TNS-TANINAME  NOT =   SPACE
               PERFORM   VARYING   IDW2   FROM   24   BY  -1
                          UNTIL    IDW2    <      1
                  IF   TNS-TANINAME(IDW2:1)  NOT =   SPACE
                      COMPUTE  TNS-TANIMOJISU   =   IDW2   /   2
                      MOVE    1     TO    IDW2
                  END-IF
               END-PERFORM
           END-IF
      *
           IF    ( TTNS-CONST-MAX  >   TTNS-MAX )
               COMPUTE TTNS-MAX    =   TTNS-MAX    +   1
               MOVE    TNS-SRYCD       TO  TTNS-KEY-SRYCD
                                                   (TTNS-MAX)
               MOVE    TNS-YUKOSTYMD   TO  TTNS-KEY-YUKOSTYMD
                                                   (TTNS-MAX)
               MOVE    TNS-YUKOEDYMD   TO  TTNS-KEY-YUKOEDYMD
                                                   (TTNS-MAX)
               MOVE    TNS-TENSU-REC   TO  TTNS-DAT
                                                   (TTNS-MAX)
           END-IF
      *
           .
       9001-TTNS-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数読込
      *****************************************************************
       910-TENSU-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
               MOVE    ZERO            TO  FLG-TENSU
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1               TO  FLG-TENSU
           END-IF
      *
           .
       910-TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計読込
      *****************************************************************
       900-SRYACCT-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACCT-REC
               MOVE    ZERO            TO  FLG-SRYACCT
           ELSE
               INITIALIZE                  SRYACCT-REC
               MOVE    1               TO  FLG-SRYACCT
           END-IF
      *
           .
       900-SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療行為読込
      *****************************************************************
       900-SRYACT-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       900-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院会計マスター読込
      *****************************************************************
       900-NYUINACCT-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  NYUINACCT-REC
               MOVE    ZERO            TO  FLG-NYUINACCT
           ELSE
               INITIALIZE                  NYUINACCT-REC
               MOVE    1               TO  FLG-NYUINACCT
           END-IF
      *
           .
       900-NYUINACCT-READ-EXT.
           EXIT.
      *
      **************************************************************
      *    入院診療行為マスター読込
      **************************************************************
       900-NYUINACT-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  NYUINACT-REC
               MOVE    ZERO            TO  FLG-NYUINACT
           ELSE
               INITIALIZE                  NYUINACT-REC
               MOVE    1               TO  FLG-NYUINACT
           END-IF
      *
           .
       900-NYUINACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    収納読込
      *****************************************************************
       900-SYUNOU-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYUNOU-REC
               MOVE    ZERO            TO  FLG-SYUNOU
           ELSE
               INITIALIZE                  SYUNOU-REC
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           .
       900-SYUNOU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費情報読込
      *****************************************************************
       900-PTKOHINF-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTKOHINF-REC
               MOVE    ZERO            TO  FLG-PTKOHINF
           ELSE
               INITIALIZE                  PTKOHINF-REC
               MOVE    1               TO  FLG-PTKOHINF
           END-IF
      *
           .
       900-PTKOHINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    選定療養マスター読込
      *****************************************************************
       900-SENTEICDCHG-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SENTEICDCHG-REC
               MOVE    ZERO            TO  FLG-SENTEICDCHG
           ELSE
               INITIALIZE                  SENTEICDCHG-REC
               MOVE    1               TO  FLG-SENTEICDCHG
           END-IF
      *
           .
       900-SENTEICDCHG-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスタ読込
      *****************************************************************
       900-HKNCOMBI-INV-SEC         SECTION.
      *
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hkncombi"      TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM   900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-HKNCOMBI
                   MOVE    MCPDATA-REC         TO  HKNCOMBI-REC
                   IF      COMB-DELKBN         =   "1"
                       MOVE    1               TO  FLG-HKNCOMBI
                   END-IF
               ELSE
                   MOVE    1                   TO  FLG-HKNCOMBI
                   INITIALIZE                      HKNCOMBI-REC
               END-IF
           ELSE
               MOVE    1                       TO  FLG-HKNCOMBI
               INITIALIZE                          HKNCOMBI-REC
           END-IF
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-HKNCOMBI-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    システム管理マスタ読込
      *****************************************************************
       960-KANRIMST-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       960-KANRIMST-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者コメントマスタ読み込み
      *****************************************************************
       950-PTCOM-READ-SEC           SECTION.
      *
           MOVE    PTCOM-REC           TO  MCPDATA-REC
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptcom"     TO  MCP-TABLE
               MOVE    "key"           TO  MCP-PATHNAME
               PERFORM   900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  PTCOM-REC
                   MOVE    ZERO                TO  FLG-PTCOM
               ELSE
                   MOVE    1                   TO  FLG-PTCOM
                   INITIALIZE                  PTCOM-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTCOM
               INITIALIZE                  PTCOM-REC
           END-IF
      *
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       950-PTCOM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスタ付加読み込み
      *****************************************************************
       900-SRYACCTPLUS-READ-SEC           SECTION.
      *
           MOVE    SRYACCTPLUS-REC     TO  MCPDATA-REC
      *
           MOVE    "tbl_sryacctplus"   TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_sryacctplus"   TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  SRYACCTPLUS-REC
                   MOVE    ZERO                TO  FLG-SRYACCTPLUS
               ELSE
                   MOVE    1                   TO  FLG-SRYACCTPLUS
               END-IF
           ELSE
               MOVE    1                   TO  FLG-SRYACCTPLUS
           END-IF
      *
           MOVE    "tbl_sryacctplus"   TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-SRYACCTPLUS-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    中間ファイルＲＥＡＤ処理
      *****************************************************************
       RECE62-READ-SEC            SECTION.
      *
           READ    RECE62-FILE   NEXT
               AT  END
                   MOVE    1     TO    FLG-RECE62
               NOT  AT  END
                   IF      STS-RECE62          =   "00"
                       CONTINUE
                   ELSE
                       MOVE    SPACE               TO  WRK-ERR-AREA
                       INITIALIZE                      WRK-ERR-AREA
                       MOVE    2                   TO  WRK-ERR-FLG
                       MOVE    RECE62PARA          TO  WRK-ERR-FILE-NM
                       MOVE    STS-RECE62          TO  WRK-ERR-FILE-STS
                       PERFORM 500-FILE-ERR-ABORT-SEC
                   END-IF
      *
                   ADD     1     TO    CNT-IN(IDZ)
                   ADD     1     TO    CNT-IN-COMMIT
                                       CNT-IN-CANCEL
      *
                   DISPLAY "RECE62 " IDZ " PTNUM=" RECE62-PTNUM     
                                         " (PTID=" RECE62-PTID ")"
      *
                   PERFORM 910-SYSKANRI-HENSYU-SEC
      *
           END-READ
           .
       RECE62-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    中間ファイルＲＥＡＤ処理
      *****************************************************************
       RECE65-READ-SEC            SECTION.
      *
           READ    RECE65-FILE   NEXT
               AT  END
                   MOVE    1     TO    FLG-RECE65-ZAN
               NOT  AT  END
                   IF      STS-RECE65          =   "00"
                       CONTINUE
                   ELSE
                       MOVE    SPACE               TO  WRK-ERR-AREA
                       INITIALIZE                      WRK-ERR-AREA
                       MOVE    2                   TO  WRK-ERR-FLG
                       MOVE    RECE65PARA          TO  WRK-ERR-FILE-NM
                       MOVE    STS-RECE65          TO  WRK-ERR-FILE-STS
                       PERFORM 500-FILE-ERR-ABORT-SEC
                   END-IF
           END-READ
           .
       RECE65-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *    診療年月の対象となるシス管理を取得（個別処理のみ
      ****************************************************************
       910-SYSKANRI-HENSYU-SEC         SECTION.
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
               CONTINUE
           ELSE
      *        医療機関ＩＤ編集
               MOVE  ZERO           TO  FLG-SET
               MOVE  RECE62-SRYYM   TO  WRK-SYS-SRYYMD(1:6)
               MOVE  "01"           TO  WRK-SYS-SRYYMD(7:2)
               PERFORM  VARYING  SYSKAN-IDX  FROM  1  BY  1
                     UNTIL  ( SYSKAN-IDX              >  100  )
                      OR    ( TBL-SYS1001(SYSKAN-IDX) = SPACE )
                      OR    ( FLG-SET                 =   1   )
      *
                 MOVE  TBL-SYS1001(SYSKAN-IDX)  TO  SYS-1001-REC
                 IF   ( SYS-1001-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                 AND  ( WRK-SYS-SRYYMD     <=  SYS-1001-EDYUKYMD )
                    MOVE     1               TO    FLG-SET
                    MOVE   SYS-1001-PREFNUM  TO    WRK-PREFNUM
                 END-IF
      *
               END-PERFORM
               IF     FLG-SET  =  ZERO
                  STRING
                     "医療機関情報が取得できませんでした。診療年月＝"
                                               DELIMITED  BY  SIZE 
                       RECE62-SRYYM            DELIMITED  BY  SIZE
                                       INTO    WRK-RECEERR
                  END-STRING
                  PERFORM 500-ERR-HENSYU-SEC
                  MOVE    1              TO  FLG-RECE62
                  GO  TO  910-SYSKANRI-HENSYU-EXT
               END-IF
      *
      *        施設基準情報
               MOVE    ZERO         TO  FLG-SET
               PERFORM  VARYING  SYSKAN-IDX2  FROM  1   BY  1
                         UNTIL ( SYSKAN-IDX2               >  100  )
                          OR   ( TBL-SYS10062(SYSKAN-IDX2) = SPACE )
                          OR   ( FLG-SET                   =   1   )
                   MOVE    TBL-SYS10062(SYSKAN-IDX2)  TO  SYS-1006-REC
                   IF   ( SYS-1006-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                   AND  ( WRK-SYS-SRYYMD     <=  SYS-1006-EDYUKYMD )
                       MOVE     1                  TO  FLG-SET
                   END-IF
               END-PERFORM
               IF      FLG-SET    =   ZERO
                   MOVE  ZERO                    TO  WRK-SISETU613
                   MOVE  ZERO                    TO  WRK-SISETU695
               ELSE
                   MOVE  SYS-1006-SSTKIJUN(113)  TO  WRK-SISETU613
                   MOVE  SYS-1006-SSTKIJUN(195)  TO  WRK-SISETU695
               END-IF
      *
               MOVE      RECE62-SRYYM   TO  WRK-SRYYM-5000
               PERFORM   1001-SYS-5000-CHK-SEC
      *        食事・未実施減算情報（システム管理テーブルより）
               INITIALIZE             WRK-SHOKUJIRYOYO-OCC
                                      WRK-TOKUKANRIKASAN-OCC
      *
               INITIALIZE             WRK-SYS-MIJISI-T
      *
               MOVE  ZERO         TO  FLG-SET
               MOVE  RECE62-SRYYM TO  WRK-SYS-SRYYMD(1:6)
               MOVE  "01"         TO  WRK-SYS-SRYYMD(7:2)
               PERFORM  VARYING  SYSKAN-IDX  FROM  1  BY  1
                    UNTIL  ( SYSKAN-IDX              >  100  )
                     OR    ( TBL-SYS5000(SYSKAN-IDX) = SPACE )
                     OR    ( FLG-SET                 =   1   )
      *
                  MOVE  TBL-SYS5000(SYSKAN-IDX)  TO  SYS-5000-REC
                  IF   ( SYS-5000-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                  AND  ( WRK-SYS-SRYYMD     <=  SYS-5000-EDYUKYMD )
                      MOVE     1       TO    FLG-SET
                      PERFORM  1002-SYSKAN-HENSYU-SEC
                      IF        WRK-SYS5000-COUNT    =     ZERO
                          CONTINUE
                      ELSE
                          PERFORM  1003-SYS-5000-GET-SEC
                      END-IF
                  END-IF
      *
               END-PERFORM
               IF     FLG-SET  =  ZERO
                  STRING
              "医療機関情報−入院基本が取得できませんでした。診療年月＝"
                                               DELIMITED  BY  SIZE 
                       RECE62-SRYYM            DELIMITED  BY  SIZE
                                       INTO    WRK-RECEERR
                  END-STRING
                  PERFORM 500-ERR-HENSYU-SEC
                  MOVE    1              TO  FLG-RECE62
                  GO  TO  910-SYSKANRI-HENSYU-EXT
               END-IF
           END-IF
      *
           .
      *
       910-SYSKANRI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ更新処理（Ｆ００２）
      *****************************************************************
       RECE62-REWRITE-SEC                SECTION.
      *
           REWRITE   RECE62-REC
      *
           IF      STS-RECE62          =   "00"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
      *
               MOVE    4                   TO  WRK-ERR-FLG
               MOVE    RECE62PARA          TO  WRK-ERR-FILE-NM
               MOVE    STS-RECE62          TO  WRK-ERR-FILE-STS
               PERFORM 500-FILE-ERR-ABORT-SEC
           END-IF
      *
           ADD     1                   TO  CNT-OUT3 (IDZ)
      *
           .
       RECE62-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理（Ｆ００４）
      *****************************************************************
       RECE64-WRITE-SEC                SECTION.
      *
           IF      IDZ             =   1               
               IF      WRK-PARA-SHELLID
                                   NOT =   "RECEPTX"
      *            診療会計マスタ付加情報設定
                   PERFORM 9001-SRYACCTPLUS-HENSYU-SEC
               END-IF
               WRITE   RECE64-REC
      *
               IF      STS-RECE64          =   "00"
                   CONTINUE
               ELSE
                   MOVE    SPACE               TO  WRK-ERR-AREA
                   INITIALIZE                      WRK-ERR-AREA
      *
                   MOVE    3                   TO  WRK-ERR-FLG
                   MOVE    RECE64PARA          TO  WRK-ERR-FILE-NM
                   MOVE    STS-RECE64          TO  WRK-ERR-FILE-STS
                   PERFORM 500-FILE-ERR-ABORT-SEC
               END-IF
      *
               ADD     1                   TO  CNT-OUT1
           END-IF
      *
           .
       RECE64-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスタ付加情報設定処理
      *****************************************************************
       9001-SRYACCTPLUS-HENSYU-SEC     SECTION.
      *
           IF      RECE64-SRYKBN       =   "13"    OR  "14"
               CONTINUE
           ELSE
               GO  TO  9001-SRYACCTPLUS-HENSYU-EXT
           END-IF
           IF      RECE64-ZAIREQFLG    =   "1"
               CONTINUE
           ELSE
               GO  TO  9001-SRYACCTPLUS-HENSYU-EXT
           END-IF
      *
           MOVE    SPACE               TO  SRYACCTPLUS-REC
           INITIALIZE                      SRYACCTPLUS-REC
           MOVE    RECE64-HOSPNUM      TO  ACCTP-HOSPNUM
           MOVE    RECE64-NYUGAIKBN    TO  ACCTP-NYUGAIKBN
           MOVE    RECE64-PTID         TO  ACCTP-PTID
           MOVE    RECE64-SRYKA        TO  ACCTP-SRYKA
           MOVE    RECE64-SRYYM        TO  ACCTP-SRYYM
           MOVE    RECE64-ZAINUM       TO  ACCTP-ZAINUM
           MOVE    1                   TO  ACCTP-RENNUM
           PERFORM 900-SRYACCTPLUS-READ-SEC
           IF      FLG-SRYACCTPLUS     =   0
               MOVE    ACCTP-SYUGI-TBL-G   TO  RECE64-ACCTP-SYUGI-TBL-G
               MOVE    ACCTP-SANSOTEN      TO  RECE64-ACCTP-SANSOTEN
               MOVE    ACCTP-CHISOTEN      TO  RECE64-ACCTP-CHISOTEN
           ELSE
               STRING  "診療会計マスタ付加情報読み込みエラー KEY="
                                               DELIMITED  BY  SIZE
                       ACCTP-KEY               DELIMITED  BY  SIZE
                                               INTO    WRK-RECEERR
               END-STRING
               PERFORM 500-ERR-HENSYU-SEC
      *
               MOVE    SPACE               TO  WRK-ERRMSG
               STRING  "ORCR0640 "             DELIMITED  BY  SIZE
                       WRK-RECEERR             DELIMITED  BY  SIZE
                       LOW-VALUE               DELIMITED  BY  SIZE
                                               INTO    WRK-ERRMSG
               END-STRING
               PERFORM 500-COBABORT-SEC
           END-IF
      *
           .
       9001-SRYACCTPLUS-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理（Ｆ００５）
      *****************************************************************
       RECE65-WRITE-SEC                SECTION.
      *
           IF      IDZ             =   1               
      *    レセプト処理
               WRITE   RECE65-REC
      *
               IF      STS-RECE65          =   "00"
                   CONTINUE
               ELSE
                   MOVE    SPACE               TO  WRK-ERR-AREA
                   INITIALIZE                      WRK-ERR-AREA
      *
                   MOVE    3                   TO  WRK-ERR-FLG
                   MOVE    RECE65PARA          TO  WRK-ERR-FILE-NM
                   MOVE    STS-RECE65          TO  WRK-ERR-FILE-STS
                   PERFORM 500-FILE-ERR-ABORT-SEC
               END-IF
      *
               ADD     1                   TO  CNT-OUT2
           END-IF 
      *
           .
       RECE65-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理（Ｆ００５）
      *****************************************************************
       RECE65-REWRITE-SEC              SECTION.                        
      *
           IF      IDZ             =   1               
      *    レセプト処理
      *
              MOVE    ZERO                TO  FLG-REWRITE
      *
              INITIALIZE                      RECE65-REC
              MOVE    RECE64-KEY1         TO  RECE65-KEY1
              MOVE    RECE64-ZAINUM       TO  RECE65-ZAINUM
              MOVE    RECE64-ZAIREN       TO  RECE65-ZAIREN
              START   RECE65-FILE
                    KEY IS    >=   RECE65-KEY
                    INVALID
                        MOVE    1         TO  FLG-RECE65-ZAN
                    NOT INVALID
                        MOVE    ZERO      TO  FLG-RECE65-ZAN
                        PERFORM    RECE65-READ-SEC
              END-START
              PERFORM   UNTIL
                  (RECE64-KEY1         NOT =  RECE65-KEY1  )      OR
                  (RECE64-ZAINUM       NOT =  RECE65-ZAINUM)      OR
                  (RECE64-ZAIREN       NOT =  RECE65-ZAIREN)      OR
                  (FLG-RECE65-ZAN            =      1        )    OR
                  (FLG-REWRITE               =      1        )
                   IF ((FLG-ZANHAIKI     =  1          ) AND
                       (RECE65-RENNUM    =  WRK-RENNUM ))
                   OR ((FLG-FORMAL-KISAI =  1          ) AND
                       (RECE65-RENNUM    =  WRK-RENNUM2))
                      MOVE    1              TO  FLG-REWRITE
                      PERFORM  VARYING  IDXB  FROM  5   BY  -1
                                UNTIL   IDXB   <    1
                        IF  RECE65-SRYCD(IDXB)  NOT = SPACE
                          IF   FLG-ZANHAIKI     =  1
                            MOVE   WRK-SRYSURYO3
                                          TO  RECE65-SRYSURYO (IDXB)
                          END-IF
                          IF   FLG-FORMAL-KISAI =  1
                            MOVE   "1"    TO  RECE65-RECEPTFLG(IDXB)
                          END-IF
                          MOVE      1     TO  IDXB
                        END-IF
                      END-PERFORM
                      REWRITE   RECE65-REC
      *
                      IF      STS-RECE65          =   "00"
                          CONTINUE
                      ELSE
                          MOVE    SPACE               TO  WRK-ERR-AREA
                          INITIALIZE                      WRK-ERR-AREA
      *
                          MOVE    4                   TO  WRK-ERR-FLG
                          MOVE    RECE65PARA          TO
                                                      WRK-ERR-FILE-NM
                          MOVE    STS-RECE65          TO
                                                      WRK-ERR-FILE-STS
                          PERFORM 500-FILE-ERR-ABORT-SEC
                      END-IF
                   END-IF
                   PERFORM    RECE65-READ-SEC
              END-PERFORM
      *
           END-IF 
      *
           .
       RECE65-REWRITE-EXT.
           EXIT.                                                       
      *
      ****************************************************************
      *    保険履歴情報データ読み
      ****************************************************************
       900-RECE69-NEXT-SEC           SECTION.
      *
           READ    RECE69-FILE      NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE69
               NOT AT  END
                   IF      STS-RECE69          =   "00"
                       CONTINUE
                   ELSE
                       MOVE    SPACE               TO  WRK-ERR-AREA
                       INITIALIZE                      WRK-ERR-AREA
                       MOVE    2                   TO  WRK-ERR-FLG
                       MOVE    RECE69PARA          TO  WRK-ERR-FILE-NM
                       MOVE    STS-RECE69          TO  WRK-ERR-FILE-STS
                       PERFORM 500-FILE-ERR-ABORT-SEC
                   END-IF
      *
                   MOVE    ZERO      TO  FLG-RECE69
           END-READ
      *
           .
       900-RECE69-NEXT-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラー出力処理
      *****************************************************************
       500-ERR-HENSYU-SEC                SECTION.
      *
           OPEN    INPUT   RECEERR-FILE
           IF      STS-RECEERR         =   ZERO
               CLOSE   RECEERR-FILE
           ELSE
               OPEN    OUTPUT              RECEERR-FILE
      *
               MOVE    WRK-RECEERR         TO  RECEERR-REC
               WRITE   RECEERR-REC
               CLOSE   RECEERR-FILE
      *         
               IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *            ジョブ管理終了処理
                   MOVE    "JBE"           TO  SJOBKANRI-MODE
                   INITIALIZE                  JOBKANRI-REC
                   MOVE    WRK-RECEERR     TO  JOB-YOBI
                   MOVE    "9999"          TO  JOB-ERRCD
                   PERFORM   900-CALL-ORCSJOB-SEC
               END-IF
           END-IF
      *                             
           MOVE    1                   TO  FLG-END
      *
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラー時終了処理
      *****************************************************************
       500-COBABORT-SEC                SECTION.
      *
           CALL    "cobabort"          USING   WRK-ERRMSG
      *
           .
       500-COBABORT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ファイルエラー処理
      *****************************************************************
       500-FILE-ERR-ABORT-SEC           SECTION.
      *
           EVALUATE    WRK-ERR-FLG
               WHEN    1
                   MOVE    "ファイルＯＰＥＮエラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file open err" TO  WRK-ERR-FILE-MSG1
               WHEN    2
                   MOVE    "ファイル読み込みエラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file read err" TO  WRK-ERR-FILE-MSG1
               WHEN    3
                   MOVE    "ファイル書き込みエラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file write err"
                                           TO  WRK-ERR-FILE-MSG1
               WHEN    4
                   MOVE    "ファイル更新エラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file rewrite err"
                                           TO  WRK-ERR-FILE-MSG1
           END-EVALUATE
      *
           STRING  WRK-ERR-FILE-MSG        DELIMITED   BY  SPACE
                   WRK-ERR-FILE-NM-FILE-ID DELIMITED   BY  SIZE
                   " STS="                 DELIMITED   BY  SIZE
                   WRK-ERR-FILE-STS        DELIMITED   BY  SIZE
                                           INTO    WRK-RECEERR
           END-STRING
           PERFORM 500-ERR-HENSYU-SEC
      *
           STRING  "ORCR0640 "             DELIMITED   BY  SIZE
                   WRK-ERR-FILE-MSG1       DELIMITED   BY  SIZE
                   " FILE="                DELIMITED   BY  SIZE
                   WRK-ERR-FILE-NM         DELIMITED   BY  SIZE
                   "  STS="                DELIMITED   BY  SIZE
                   WRK-ERR-FILE-STS        DELIMITED   BY  SIZE
                   LOW-VALUE               DELIMITED   BY  SIZE
                                           INTO    WRK-ERRMSG
           END-STRING
           PERFORM 500-COBABORT-SEC
      *
           .
       500-FILE-ERR-ABORT-EXT.
           EXIT.
      *
      *****************************************************************
      *    処理中止処理
      *****************************************************************
       500-CANCEL-HENSYU-SEC                SECTION.
      *
           IF      WRK-PARA-SHELLID    =   "RECEPTX"
               CONTINUE
           ELSE
               MOVE    "CHK"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               PERFORM   900-CALL-ORCSJOB-SEC
               IF    ( SJOBKANRI-RETURN
                                       =   ZERO )
               AND   ( JOB-STOPFLG     =   1    )
                   MOVE    "処理が中止されました"
                                           TO  WRK-RECEERR
      *
                   OPEN    INPUT   RECEERR-FILE
                   IF      STS-RECEERR         =   ZERO
                       CLOSE   RECEERR-FILE
                   ELSE
                       OPEN    OUTPUT              RECEERR-FILE
      *    
                       MOVE    WRK-RECEERR         TO  RECEERR-REC
                       WRITE   RECEERR-REC
                       CLOSE   RECEERR-FILE
      *         
      *                ジョブ管理終了処理
                       MOVE    "CAN"           TO  SJOBKANRI-MODE
                       INITIALIZE                  JOBKANRI-REC
                       MOVE    WRK-RECEERR     TO  JOB-YOBI
                       MOVE    "8888"          TO  JOB-ERRCD
                       MOVE    2               TO  JOB-STOPFLG
                       PERFORM   900-CALL-ORCSJOB-SEC
                   END-IF
      *                             
                   MOVE    1                   TO  FLG-END
               END-IF
           END-IF
           .
       500-CANCEL-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラーメッセージ編集処理
      *****************************************************************
       600-ERRMSG-EDIT-SEC             SECTION.
      *
           MOVE    SPACE               TO  ERR-HEN-ERRMSG
      *
           MOVE    RECE62-PTNUM        TO  ERR-PTNUM
      *
           MOVE    ZERO                TO  WRK-SHO
                                           WRK-AMARI
           MOVE    1                   TO  WRK-LEN
           MOVE    SPACE               TO  WRK-STR
           STRING  ERR-PTNUM           DELIMITED   BY  SPACE
           INTO    WRK-STR
           WITH  POINTER WRK-LEN
           END-STRING
      *
           COMPUTE WRK-LEN =   WRK-LEN -   1
      *
           DIVIDE  2   INTO    WRK-LEN GIVING  WRK-SHO
           REMAINDER WRK-AMARI
           END-DIVIDE
      *
           IF    ( WRK-AMARI   =   ZERO )
              STRING  ERR-ERRMSG          DELIMITED   BY  SPACE
                      "［患者番号："      DELIMITED   BY  SIZE
                      ERR-PTNUM           DELIMITED   BY  SPACE
                      "］"                DELIMITED   BY  SIZE
              INTO    ERR-HEN-ERRMSG
              END-STRING
           ELSE
              STRING  ERR-ERRMSG          DELIMITED   BY  SPACE
                      "［患者番号:"       DELIMITED   BY  SIZE
                      ERR-PTNUM           DELIMITED   BY  SPACE
                      "］"                DELIMITED   BY  SIZE
              INTO    ERR-HEN-ERRMSG
              END-STRING
           END-IF
      *
           .
       600-ERRMSG-EDIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    終了処理
      *****************************************************************
       300-TERM-SEC                SECTION.
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *        ステップ管理終了処理
               MOVE    "STE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               PERFORM   900-CALL-ORCSJOB-SEC
      *
               PERFORM 900-DBDISCONNECT-SEC
           END-IF
      *
             DISPLAY "RECE62  CNT-IN  :" CNT-IN(1)
             DISPLAY "RECE62X CNT-IN  :" CNT-IN(2)
             DISPLAY "RECE64  CNT-OUT :" CNT-OUT1 
             DISPLAY "RECE65  CNT-OUT :" CNT-OUT2 
             DISPLAY "RECE62  CNT-OUT :" CNT-OUT3(1)
             DISPLAY "RECE62X CNT-OUT :" CNT-OUT3(2)
             DISPLAY "*** ORCR0640 END ***"
           .
       300-TERM-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブルクローズ処理
      *****************************************************************
       900-CLOSE-SEC               SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-CLOSE-EXT.
           EXIT.
      *      
      *
      *****************************************************************
      *    ジョブ管理ＤＢ制御処理
      *****************************************************************
       900-CALL-ORCSJOB-SEC            SECTION.
      *
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
           MOVE    SPA-HOSPNUM     TO  JOB-HOSPNUM
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA 
                                   JOBKANRI-REC
                                   SPA-AREA
           .
       900-CALL-ORCSJOB-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＳＥＬＥＣＴ処理
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           IF      MCP-RC              =   ZERO
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
               MOVE    MCP-RC              TO  WRK-MCP-RC
      *
               STRING  "ＤＢ読み込みエラー　TABLE="
                                           DELIMITED   BY  SIZE
                       MCP-TABLE           DELIMITED   BY  SPACE
                       " RC="              DELIMITED   BY  SIZE
                       WRK-MCP-RC          DELIMITED   BY  SIZE
                                           INTO    WRK-RECEERR
               END-STRING
               PERFORM 500-ERR-HENSYU-SEC
      *
               STRING  "ORCR0640 select err TABLE="
                                           DELIMITED   BY  SIZE
                       MCP-TABLE           DELIMITED   BY  SPACE
                       " PATHNAME="        DELIMITED   BY  SIZE
                       MCP-PATHNAME        DELIMITED   BY  SPACE
                       " RC="              DELIMITED   BY  SIZE
                       WRK-MCP-RC          DELIMITED   BY  SIZE
                       LOW-VALUE           DELIMITED   BY  SIZE
                                           INTO    WRK-ERRMSG
               END-STRING
               PERFORM 500-COBABORT-SEC
           END-IF
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＦＥＴＣＨ処理
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    テーブルアクセス処理
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
           CALL    "ORCDBMAIN"     USING   MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           .
      *
       900-ORCDBMAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢ　オープン処理
      *****************************************************************
       100-DBOPEN-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBOPEN"            TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           .
       100-DBOPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢ　クローズ処理
      *****************************************************************
       900-DBDISCONNECT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBDISCONNECT"      TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBDISCONNECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢ　ＣＯＭＭＩＴ処理
      *****************************************************************
       900-DBCOMMIT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBCOMMIT-EXT.
           EXIT.
      *      
      *****************************************************************
      *    ＤＢ　ＳＴＡＲＴ処理
      *****************************************************************
       900-DBSTART-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBSTART-EXT.
           EXIT.
      *
