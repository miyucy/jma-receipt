      *******************************************************************
      * Project code name "ORCA"
      * ∆¸∞Â…∏Ω‡•Ï•ª•◊•»•Ω•’•»° JMA standard receipt software°À
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCR0435.
      *****************************************************************
      *  •∑•π•∆•‡Ãæ        : £œ£“£√£¡
      *  •µ•÷•∑•π•∆•‡Ãæ    : •Ï•ª•◊•»° œ´∫“°¶º´«Â¿’°À
      *  •≥•Û•›°º•Õ•Û•»Ãæ  : ∑Óº°∂»Ã≥°°œ´∫“º´«Â¿’Ã¿∫ŸΩÒ•’•°•§•Î∫Ó¿Æ
      *                      •≥•·•Û•» ‘Ω∏£≤° œ´∫“°¶º´«Â¿’°À
      *  ¥…Õ˝º‘            : 
      *  ∫Ó¿Æ∆¸…’    ∫Ó∂»º‘        µ≠Ω“
      *  02/07/01    MCC-ÃÁœ∆°°    ø∑µ¨∫Ó¿Æ
      *****************************************************************
      *  •◊•Ì•∞•È•‡Ω§¿µÕ˙ŒÚ
      * Maj/Min/Rev  Ω§¿µº‘       ∆¸…’      ∆‚Õ∆
      *  01.00.01    NACL-ÃÁœ∆    02.09.18  º´«Â¿’¬–±˛
      *  01.00.02    NACL-ÃÁœ∆    04.06.07  •≥•‘°º∂Á£∞£¥£µ —ππ§À»º§¶Ω§¿µ
      *  √ÊªﬂΩËÕ˝ƒ…≤√
      *  01.01.01    NACL-∆£∏∂    04/10/13  √ÊªﬂΩËÕ˝§Œƒ…≤√
      *  01.01.02    NACL-ÃÁœ∆    05/07/15  º´«Â¿’ΩæÕËÕÕº∞¬–±˛
      *  02.09.01    NACL-ÃÁœ∆    06/04/13  £≤£∞£∞£∂«Ø£¥∑Ó≤˛¿µ¬–±˛
      *  02.09.02    NACL-ÃÁœ∆    06/04/26  µﬂµﬁ∞ÂŒ≈¥…Õ˝≤√ªª•≥•·•Û•» ‘Ω∏Ω§¿µ
      *  03.04.01    NACL-ÃÁœ∆    06/12/01  º´«Â¿’∑Ú ›Ω‡µÚ¬–±˛
      *
      *  03.05.01    NACL-ÃÁœ∆    07/05/25  •∞•Î°º•◊ø«Œ≈¬–±˛
      *  03.05.02    NACL-∆£∏∂    07/06/01  realtime preview ΩËÕ˝ƒ…≤√
      *  04.01.01    NACL-ÃÁœ∆    07/10/31  ∏¯Ã≥∫“≥≤¬–±˛
      *  04.01.02    NACL-ÃÁœ∆    07/11/26  ∆√ƒÍ¥Ô∫‡æ¶… Ãæµ≠∫‹¬–±˛
      *  04.03.01    NACL-ÃÁœ∆    08/09/25  º´«Â¿’£∞£π£µ£π£≥§ŒΩ∏∑◊¿Ë¬–±˛
      *  04.05.01    NACL-ÃÁœ∆    12/04/11   ø¿Æ£≤£¥«Ø£¥∑Ó≤˛¿µ
      *                                     •≥•·•Û•»∫ππ˛
      *
      *  04.07.01    NACL-ÃÁœ∆    13/01/21  œ´∫“•Ï•ª≈≈¬–±˛
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
           SELECT  RECE41-FILE     ASSIGN  RECE41PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE41-KEY
                                   FILE    STATUS  IS  STS-RECE41.
      *
           SELECT  RECE44-FILE     ASSIGN  RECE44PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  SEQUENTIAL
                                   RECORD  KEY     IS  RECE44-KEY
                                   FILE    STATUS  IS  STS-RECE44.
      *
           SELECT  RECE45-FILE     ASSIGN  RECE45PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  SEQUENTIAL
                                   RECORD  KEY     IS  RECE45-KEY
                                   FILE    STATUS  IS  STS-RECE45.
      *
           SELECT  RECE441-FILE    ASSIGN  RECE441PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE441-KEY
                                   FILE    STATUS  IS  STS-RECE441.
      *
           SELECT  RECE451-FILE    ASSIGN  RECE451PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE451-KEY
                                   FILE    STATUS  IS  STS-RECE451.
      *
           SELECT  RECE455-FILE    ASSIGN  RECE455PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE455-KEY
                                   FILE    STATUS  IS  STS-RECE455.
      *    •®•È°º•’•°•§•Î
           SELECT  RECEERR-FILE    ASSIGN  RECEERR
                                   FILE    STATUS  IS  STS-RECEERR.
      *
       DATA                    DIVISION.
       FILE                        SECTION.
      *
      *
       FD  RECE41-FILE.
       01  RECE41-REC.
           COPY    "CPRCF041.INC".
      *
      *
       FD  RECE44-FILE.
       01  RECE44-REC.
           COPY    "CPRCF044.INC".
      *
      *
       FD  RECE45-FILE.
       01  RECE45-REC.
           COPY    "CPRCF045.INC".
      *
       FD  RECE441-FILE.
       01  RECE441-REC. 
           COPY    "CPRCF044.INC"  REPLACING   //RECE44//
                                   BY          //RECE441//.
      *
       FD  RECE451-FILE.
       01  RECE451-REC. 
           COPY    "CPRCF045.INC"  REPLACING   //RECE45//
                                   BY          //RECE451//.
      *
       FD  RECE455-FILE.
       01  RECE455-REC. 
           COPY    "CPRCF0455.INC".
      *
      *    •®•È°º•’•°•§•Î
       FD  RECEERR-FILE.
       01  RECEERR-REC             PIC X(200). 
      *
       WORKING-STORAGE             SECTION.
      *     •Ï•ª•◊•»Ã¿∫Ÿ•’•°•§•Î ÃææŒŒŒ∞Ë 
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE41//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE44//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE45//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE441//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE451//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE455//.
      *
      *    •®•È°º•’•°•§•Î ÃææŒŒŒ∞Ë 
           COPY    "CPERRFL.INC"   REPLACING  //ERRFLPARA//
                                   BY         //RECEERR//.
      *
      *    •’•È•∞ŒŒ∞Ë
       01  STS-AREA.
           03  STS-RECE41          PIC X(02).
           03  STS-RECE44          PIC X(02).
           03  STS-RECE441         PIC X(02).
           03  STS-RECE45          PIC X(02).
           03  STS-RECE451         PIC X(02).
           03  STS-RECE455         PIC X(02).
           03  STS-RECEERR         PIC X(02).
      *
      *    •’•È•∞ŒŒ∞Ë
       01  FLG-AREA.
           03  FLG-END             PIC 9(01).
           03  FLG-RECE44          PIC 9(01).
           03  FLG-RECE441         PIC 9(01).
           03  FLG-RECE45          PIC 9(01).
           03  FLG-RECE451         PIC 9(01).
           03  FLG-WRKRECE45       PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
           03  FLG-COMMENT         PIC 9(02).
           03  FLG-SETCOM          PIC 9(01).
           03  FLG-MEISKY-OKIKAE   PIC 9(01).
           03  FLG-SETCOM-OKIKAE   PIC 9(01).
      *    
      *    •´•¶•Û•»ŒŒ∞Ë
       01  CNT-AREA.
           03  CNT-RECE41          PIC 9(06).
           03  CNT-RECE44          PIC 9(06).
           03  CNT-RECE45          PIC 9(06).
           03  CNT-RECE455         PIC 9(06).
           03  CNT-RECE44-RE       PIC 9(06).
           03  CNT-RECE45-RE       PIC 9(06).
           03  CNT-IN-CANCEL       PIC 9(06).
      *
      *    ≈∫ª˙ŒŒ∞Ë
       01  IDX-AREA.
           03  IDX                 PIC 9(04).
           03  IDX2                PIC 9(04).
           03  IDZ                 PIC 9(04).
           03  IDW                 PIC 9(04).
           03  DAY-IDX             PIC 9(02).
           03  IDX-RECE45          PIC 9(04).
      *     
      *    ∞Ïª˛ŒŒ∞Ë
       01  WRK-AREA.
           03  WRK-PARA.
               05  WRK-PARA-SRYYM              PIC  X(06).
               05  WRK-PARA-TERMID             PIC  X(16).
               05  WRK-PARA-SYSYMD             PIC  X(08).
               05  WRK-PARA-RECEKBN            PIC  X(01).
               05  WRK-PARA-JOBID              PIC  9(07).
               05  WRK-PARA-SHELLID            PIC  X(08).
           03  WRK-PARA-JIBAIPRTKBN            PIC  X(01).
           03  WRK-PARA-HOSPNUM                PIC  9(02).
      *
           03  WRK-RECEERR         PIC X(200).
           03  WRK-RENNUM          PIC 9(02).
           03  WRK-CNT-MEISAI      PIC 9(04).
      *
           03  WRK-TAIHI-SRYYMD.
               05  WRK-TAIHI-SRYYM             PIC  9(06).
               05  WRK-TAIHI-SRYD              PIC  9(02).
      *
           03  WRK-HEN-RENNUM                  PIC  9(02).
           03  WRK-HEN-SHORI-RENNUM            PIC  9(01).
           03  WRK-HEN-SEQNO                   PIC  9(02).
      *
           03  WRK-HEN-RENNUM-X                PIC  9(02).
           03  WRK-HEN-SHORI-RENNUM-X          PIC  9(01).
           03  WRK-HEN-SEQNO-X                 PIC  9(02).
      *
           03  WRK-HEN-RENNUM-J                PIC  9(02).
           03  WRK-HEN-SHORI-RENNUM-J          PIC  9(01).
           03  WRK-HEN-SEQNO-J                 PIC  9(02).
      *
       01  WRK-RECE45-REC. 
           COPY    "CPRCF045.INC"  REPLACING   //RECE45//
                                   BY          //WRK-RECE45//.
      *
       01  WRK-RECE45XX-REC.
         02 WRK-RECE45XX-TBL       OCCURS 50.
           COPY    "CPRCF045.INC"  REPLACING   //RECE45//
                                   BY          //WRK-RECE45XX//.
      *
       01  MAX-MEISAISU            PIC 9(07).
      *
       01  WRK-FREE-AREA2.
           03  WRK-FREEINF2                  OCCURS 50.
               05  WK-FREE-YUKOKETA2         PIC  9(03).
               05  WK-FREE-NAME2             PIC  X(200).
               05  WK-FREE-MEISKYFLG2        PIC  X(01).
               05  WK-FREE-SETCOMATFLG2      PIC  9(03).
      *
       01  WRK-JIDO-SETCOM-AREA.
           03  WRK-JIDO-SETCOMATFLG          PIC  9(03).
           03  WRK-JIDO-SETCOMFLG            PIC  X(01).
      *
      *    ∆¸…’¡¥≥— —¥πŒŒ∞Ë
       01  TBL-TUKI-AREA.
           03  FILLER              PIC X(04)  VALUE "°°£±".
           03  FILLER              PIC X(04)  VALUE "°°£≤".
           03  FILLER              PIC X(04)  VALUE "°°£≥".
           03  FILLER              PIC X(04)  VALUE "°°£¥".
           03  FILLER              PIC X(04)  VALUE "°°£µ".
           03  FILLER              PIC X(04)  VALUE "°°£∂".
           03  FILLER              PIC X(04)  VALUE "°°£∑".
           03  FILLER              PIC X(04)  VALUE "°°£∏".
           03  FILLER              PIC X(04)  VALUE "°°£π".
           03  FILLER              PIC X(04)  VALUE "£±£∞".
           03  FILLER              PIC X(04)  VALUE "£±£±".
           03  FILLER              PIC X(04)  VALUE "£±£≤".
       01  TBL-TUKI-AREA-R         REDEFINES   TBL-TUKI-AREA.
           03  TBL-TUKI            PIC X(04)   OCCURS   12.
      *
      *    ∆¸…’¡¥≥— —¥πŒŒ∞Ë
       01  TBL-DAY-AREA.
           03  FILLER              PIC X(04)  VALUE "°°£±".
           03  FILLER              PIC X(04)  VALUE "°°£≤".
           03  FILLER              PIC X(04)  VALUE "°°£≥".
           03  FILLER              PIC X(04)  VALUE "°°£¥".
           03  FILLER              PIC X(04)  VALUE "°°£µ".
           03  FILLER              PIC X(04)  VALUE "°°£∂".
           03  FILLER              PIC X(04)  VALUE "°°£∑".
           03  FILLER              PIC X(04)  VALUE "°°£∏".
           03  FILLER              PIC X(04)  VALUE "°°£π".
           03  FILLER              PIC X(04)  VALUE "£±£∞".
           03  FILLER              PIC X(04)  VALUE "£±£±".
           03  FILLER              PIC X(04)  VALUE "£±£≤".
           03  FILLER              PIC X(04)  VALUE "£±£≥".
           03  FILLER              PIC X(04)  VALUE "£±£¥".
           03  FILLER              PIC X(04)  VALUE "£±£µ".
           03  FILLER              PIC X(04)  VALUE "£±£∂".
           03  FILLER              PIC X(04)  VALUE "£±£∑".
           03  FILLER              PIC X(04)  VALUE "£±£∏".
           03  FILLER              PIC X(04)  VALUE "£±£π".
           03  FILLER              PIC X(04)  VALUE "£≤£∞".
           03  FILLER              PIC X(04)  VALUE "£≤£±".
           03  FILLER              PIC X(04)  VALUE "£≤£≤".
           03  FILLER              PIC X(04)  VALUE "£≤£≥".
           03  FILLER              PIC X(04)  VALUE "£≤£¥".
           03  FILLER              PIC X(04)  VALUE "£≤£µ".
           03  FILLER              PIC X(04)  VALUE "£≤£∂".
           03  FILLER              PIC X(04)  VALUE "£≤£∑".
           03  FILLER              PIC X(04)  VALUE "£≤£∏".
           03  FILLER              PIC X(04)  VALUE "£≤£π".
           03  FILLER              PIC X(04)  VALUE "£≥£∞".
           03  FILLER              PIC X(04)  VALUE "£≥£±".
       01  TBL-DAY-AREA-R          REDEFINES   TBL-DAY-AREA.
           03  TBL-DAY             PIC X(04)   OCCURS   31.
      *
      *    ∏«ƒÍ√Õ
       01  CONST-AREA.
      *    µﬂµﬁ∞ÂŒ≈¥…Õ˝≤√ªª
           03  CONS-KYUKYU1    PIC X(09)   VALUE   "101110020".
           03  CONS-KYUKYU2    PIC X(09)   VALUE   "101110030".
      *
      *
           COPY    "MCPAREA".
      *
           COPY    "COMMON-SPA".
      *
      *****************************************************************
      *    •’•°•§•Î•Ï•§•¢•¶•»
      *****************************************************************
      *
      *    •∏•Á•÷¥…Õ˝•ﬁ•π•ø
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *    •∑•π•∆•‡¥…Õ˝•ﬁ•π•ø
           COPY    "CPSYSKANRI.INC".
      *
      *    ø«Œ≈≤ Ã‹æ Û
           COPY    "CPSK1005.INC".
      *
      *****************************************************************
      *    •µ•÷•◊•ÌÕ—ŒŒ∞Ë
      *****************************************************************
      *   •∏•Á•÷¥…Õ˝£ƒ£¬¿©∏Ê•µ•÷
           COPY    "CPORCSJOBKANRI.INC".
      *     
      *    øÙ√Õ —¥π•µ•÷
           COPY    "CPORCSNUM.INC".
      *
      *    £ƒ£¬∏°∫˜
           COPY    "MCPDATA.INC".
      *
      ****************************************************************
       LINKAGE                 SECTION.
       01  COMMAND-PARAM.
           02  FILLER      PIC X(256).
      ****************************************************************
       PROCEDURE           DIVISION
               USING
           COMMAND-PARAM.
      *
      *****************************************************************
      *    ºÁ°°°°ΩËÕ˝
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC
                   UNTIL   FLG-END  =  1
      *
           PERFORM 300-END-SEC
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               STOP    RUN
           ELSE
               EXIT    PROGRAM
           END-IF 
           .
      *****************************************************************
      *    ΩÈ¥¸°°ΩËÕ˝
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  STS-AREA
           INITIALIZE                  WRK-AREA
           INITIALIZE                  CNT-AREA
           INITIALIZE                  SPA-AREA
      *
      *    •’•°•§•Î£œ£–£≈£ŒΩËÕ˝
      *
           PERFORM 110-FILE-OPEN-SEC
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               PERFORM 120-DBOPEN-SEC
      *
      *        •π•∆•√•◊¥…Õ˝≥´ªœΩËÕ˝
               MOVE    "STS"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               MOVE    "ORCR0435"      TO  JOB-PGID
               MOVE    "•≥•·•Û•» ‘Ω∏£≤° œ´∫“°¶º´«Â¿’°À"
                                       TO  JOB-SHELLMSG
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
      *        ΩËÕ˝√Êªﬂ¿ﬂƒÍΩËÕ˝
               PERFORM 500-CANCEL-HENSYU-SEC
           END-IF
      *
           PERFORM 990-RECE41-READ-SEC
           .
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    •’•°•§•Î£œ£–£≈£ŒΩËÕ˝
      *****************************************************************
       110-FILE-OPEN-SEC          SECTION.
      *
           UNSTRING    COMMAND-PARAM   DELIMITED  BY  ","
                                       INTO    WRK-PARA
                                               WRK-PARA-JIBAIPRTKBN
                                               WRK-PARA-HOSPNUM
                                               RECEERR
           END-UNSTRING
           MOVE    WRK-PARA-HOSPNUM    TO  SPA-HOSPNUM
      *
           MOVE    "RECE410"           TO  RECE41PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE41PARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE41PARA-HOSPNUM
      *
           MOVE    "RECE44X"           TO  RECE44PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE44PARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE44PARA-HOSPNUM
      *
           MOVE    "RECE451"           TO  RECE45PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE45PARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE45PARA-HOSPNUM
      *
           MOVE    "RECE44B"           TO  RECE441PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE441PARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE441PARA-HOSPNUM
      *
           MOVE    "RECE45B"           TO  RECE451PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE451PARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE451PARA-HOSPNUM
      *
           MOVE    "RECE455"           TO  RECE455PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE455PARA-TERMID
           MOVE    WRK-PARA-HOSPNUM    TO  RECE455PARA-HOSPNUM
      *
           OPEN    INPUT               RECE41-FILE
      *
           OPEN    INPUT               RECE44-FILE
      *
           OPEN    INPUT               RECE45-FILE
      *
           OPEN    OUTPUT              RECE441-FILE
           CLOSE                       RECE441-FILE
      *
           OPEN    OUTPUT              RECE451-FILE
           CLOSE                       RECE451-FILE
      *
           OPEN    I-O                 RECE441-FILE
      *
           OPEN    I-O                 RECE451-FILE
      *
           OPEN    I-O                 RECE455-FILE
      *
           .
       110-FILE-OPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÁΩËÕ˝
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
           INITIALIZE                      WRK-JIDO-SETCOM-AREA
      *
           INITIALIZE                      RECE44-REC
           MOVE    RECE41-HOSPNUM      TO  RECE44-HOSPNUM
           MOVE    RECE41-SRYYM        TO  RECE44-SRYYM
           MOVE    RECE41-NYUGAIKBN    TO  RECE44-NYUGAIKBN
           MOVE    RECE41-PTID         TO  RECE44-PTID
           MOVE    RECE41-RECEKA       TO  RECE44-RECEKA
           MOVE    RECE41-HKNID        TO  RECE44-HKNID
           MOVE    RECE41-TEKSTYMD     TO  RECE44-TEKSTYMD
           MOVE    ZERO                TO  RECE44-ZAINUM
      *
           START   RECE44-FILE
               KEY IS    >=   RECE44-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE44
               NOT INVALID
                   PERFORM 990-RECE44-NEXT-SEC
           END-START
           PERFORM
               UNTIL  ( FLG-END              =   1                   )
               OR     ( FLG-RECE44           =   1                   )
               OR     ( RECE41-HOSPNUM   NOT =   RECE44-HOSPNUM      )
               OR     ( RECE41-SRYYM     NOT =   RECE44-SRYYM        )
               OR     ( RECE41-NYUGAIKBN NOT =   RECE44-NYUGAIKBN    )
               OR     ( RECE41-PTID      NOT =   RECE44-PTID         )
               OR     ( RECE41-RECEKA    NOT =   RECE44-RECEKA       )
               OR     ( RECE41-HKNID     NOT =   RECE44-HKNID        )
               OR     ( RECE41-TEKSTYMD  NOT =   RECE44-TEKSTYMD     )
      *
               MOVE          SPACE       TO      RECE441-REC
               INITIALIZE                        RECE441-REC
      *
               EVALUATE   RECE44-SRYKBN
                 WHEN      "11"
                   IF  ((RECE41-HKNKBN   =  "4") AND
                        (RECE41-JIBAIKBN =  "2"))
                   OR  ((RECE41-HKNKBN   =  "5") AND
                        (RECE41-KOMUKBN  =  "2"))
                       MOVE       RECE44-REC    TO   RECE441-REC
                       WRITE      RECE441-REC
                       ADD     1          TO      CNT-RECE44
                       PERFORM    2002-RECE45-TENSOU-SEC
                   ELSE
                     IF    RECE44-FLG-SYODOU-COMMENT   =    "1"
                       PERFORM    2001-SYODOU-COMMENT-SEC
                     ELSE
                       MOVE       RECE44-REC    TO   RECE441-REC
                       WRITE      RECE441-REC
                       ADD     1          TO      CNT-RECE44
                       PERFORM    2002-RECE45-TENSOU-SEC
                     END-IF
                   END-IF
                 WHEN      "12"
                   IF  ((RECE41-HKNKBN   =  "4") AND
                        (RECE41-JIBAIKBN =  "2"))
                   OR  ((RECE41-HKNKBN   =  "5") AND
                        (RECE41-KOMUKBN  =  "2"))
                       MOVE       RECE44-REC    TO   RECE441-REC
                       WRITE      RECE441-REC
                       ADD     1          TO      CNT-RECE44
                       PERFORM    2002-RECE45-TENSOU-SEC
                   ELSE
                     IF    RECE44-FLG-SAIDOU-COMMENT   =    "1"
                       PERFORM    2001-SAIDOU-COMMENT-SEC
                     ELSE
                       MOVE       RECE44-REC    TO   RECE441-REC
                       WRITE      RECE441-REC
                       ADD     1          TO      CNT-RECE44
                       PERFORM    2002-RECE45-TENSOU-SEC
                     END-IF
                   END-IF
                 WHEN      "80"
                   IF (( RECE41-KYUKYU-PRTKBN    =      1         ) AND
                       ( RECE44-SRYCDTOTAL(6:9)  =   CONS-KYUKYU1
                                                OR   CONS-KYUKYU2 ))
                   OR (( RECE44-JIBAISYUKEIKBN   =      4         ) AND
                       ( RECE44-SRYCDTOTAL(6:5)  =   "09593"      ))
                       MOVE    SPACE   TO   WRK-TAIHI-SRYYMD
                       IF  (RECE44-JIBAISYUKEIKBN   =    4   )
                       AND (RECE44-SRYCDTOTAL(6:5)  = "09593")
                         PERFORM  VARYING  IDX2  FROM  1  BY  1
                                   UNTIL   IDX2   >   31
                           IF  RECE44-KAISU(1 IDX2)   NOT =    ZERO
                             MOVE  RECE44-SRYYM  TO  WRK-TAIHI-SRYYM
                             MOVE  IDX2          TO  WRK-TAIHI-SRYD
                             MOVE  31            TO  IDX2
                           END-IF
                         END-PERFORM
                       ELSE
                         MOVE  RECE41-KYUKYUYMD  TO  WRK-TAIHI-SRYYMD
                       END-IF
                       PERFORM    2001-KYUKYU-COMMENT-SEC
                   ELSE
                       MOVE       RECE44-REC    TO   RECE441-REC
                       WRITE      RECE441-REC
                       ADD     1          TO      CNT-RECE44
                       PERFORM    2002-RECE45-TENSOU-SEC
                   END-IF
                 WHEN   OTHER
                       MOVE       RECE44-REC    TO   RECE441-REC
                       WRITE      RECE441-REC
                       ADD     1          TO      CNT-RECE44
                       PERFORM    2002-RECE45-TENSOU-SEC
               END-EVALUATE
      *
               PERFORM 990-RECE44-NEXT-SEC
      *
      *        ΩËÕ˝√Êªﬂ¿ﬂƒÍΩËÕ˝
               IF      CNT-IN-CANCEL   =   50
                   MOVE    ZERO            TO  CNT-IN-CANCEL
                   PERFORM 500-CANCEL-HENSYU-SEC
               END-IF
      *
           END-PERFORM
      *
      *****¥ÿ∑∏•≥•·•Û•» ‘Ω∏****************
           PERFORM     260-SETCOM-HENSYU-SEC
      *
           IF      FLG-END         =   ZERO
               PERFORM 990-RECE41-READ-SEC
      *
      *        ΩËÕ˝√Êªﬂ¿ﬂƒÍΩËÕ˝
               IF      CNT-IN-CANCEL   =   50
                   MOVE    ZERO            TO  CNT-IN-CANCEL
                   PERFORM 500-CANCEL-HENSYU-SEC
               END-IF
           END-IF
      *
           .
       200-MAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    µﬂµﬁ∞ÂŒ≈¥…Õ˝≤√ªª§Œ•≥•·•Û•» ‘Ω∏
      *****************************************************************
       2001-KYUKYU-COMMENT-SEC          SECTION.
      *
           INITIALIZE            WRK-JIDO-SETCOM-AREA
           MOVE      "1"       TO     WRK-JIDO-SETCOMFLG
           MOVE      201       TO     WRK-JIDO-SETCOMATFLG
      *
           MOVE       RECE44-REC    TO   RECE441-REC
           ADD        1             TO   RECE441-MEISAISU
           IF   WRK-JIDO-SETCOMFLG   =  "1"
             MOVE  WRK-JIDO-SETCOMFLG
                                    TO   RECE441-SETCOMFLG
           END-IF
           WRITE      RECE441-REC
           ADD        1             TO   CNT-RECE44
      *
           INITIALIZE                      RECE45-REC
           MOVE    RECE44-HOSPNUM      TO  RECE45-HOSPNUM
           MOVE    RECE44-SRYYM        TO  RECE45-SRYYM
           MOVE    RECE44-NYUGAIKBN    TO  RECE45-NYUGAIKBN
           MOVE    RECE44-PTID         TO  RECE45-PTID
           MOVE    RECE44-RECEKA       TO  RECE45-RECEKA
           MOVE    RECE44-HKNID        TO  RECE45-HKNID
           MOVE    RECE44-TEKSTYMD     TO  RECE45-TEKSTYMD
           MOVE    RECE44-ZAINUM       TO  RECE45-ZAINUM
           START   RECE45-FILE
                 KEY IS    >=   RECE45-KEY
                 INVALID
                     MOVE    1         TO  FLG-RECE45
                 NOT INVALID
                     PERFORM 990-RECE45-NEXT-SEC
           END-START
      *
           MOVE    RECE45-REC           TO  RECE451-REC
           MOVE    RECE45-SRYACT-TBL(1) TO  RECE451-SRYACT-TBL(1)
           MOVE    RECE45-SRYACT-TBL(2) TO  RECE451-SRYACT-TBL(3)
           MOVE    RECE45-SRYACT-TBL(3) TO  RECE451-SRYACT-TBL(4)
           MOVE    RECE45-SRYACT-TBL(4) TO  RECE451-SRYACT-TBL(5)
      *
           MOVE    SPACE                TO  RECE451-SRYACT-TBL(2)
           INITIALIZE                       RECE451-SRYACT-TBL(2)
           MOVE    "810000001"          TO  RECE451-SRYCD(2)
           MOVE    ZERO                 TO  RECE451-SRYSURYO(2)
           MOVE    9                    TO  RECE451-YUKOKETA(2)
      * 
           MOVE    "ªªƒÍ°°°°°°∑Ó°°°°∆¸" TO  RECE451-NAME(2)
      **   MOVE     RECE41-KYUKYUYMD(5:2)
           MOVE     WRK-TAIHI-SRYYMD(5:2)
                                        TO  DAY-IDX
           MOVE     TBL-TUKI(DAY-IDX)   TO  RECE451-NAME(2)(7:4)
      **   MOVE     RECE41-KYUKYUYMD(7:2)
           MOVE     WRK-TAIHI-SRYYMD(7:2)
                                        TO  DAY-IDX
           MOVE     TBL-DAY(DAY-IDX)    TO  RECE451-NAME(2)(13:4)
      *
           IF    WRK-JIDO-SETCOMATFLG  NOT = ZERO
             MOVE  "2"                  TO  RECE451-MEISKYFLG(2)
             MOVE  WRK-JIDO-SETCOMATFLG TO  RECE451-SETCOMATFLG(2)
           END-IF
      *
           MOVE     "2"                 TO  RECE451-SIKFLG(2)
      *
           WRITE    RECE451-REC
           ADD      1                   TO  CNT-RECE45
      *    
           .
       2001-KYUKYU-COMMENT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ΩÈø«° ∆±∆¸ £øÙø«Œ≈≤ °À§Œ•≥•·•Û•» ‘Ω∏
      *****************************************************************
       2001-SYODOU-COMMENT-SEC          SECTION.
      *
           INITIALIZE            WRK-JIDO-SETCOM-AREA
           MOVE      "1"       TO     WRK-JIDO-SETCOMFLG
           MOVE       4        TO     WRK-JIDO-SETCOMATFLG
      *
           MOVE       ZERO       TO   IDZ
           INITIALIZE            WRK-FREE-AREA2
      *
           PERFORM   VARYING   IDX    FROM   1   BY   1
                      UNTIL   (IDX                       >   10  )
                       OR     (RECE44-SYODOU-SRYKA(IDX)  =  SPACE)
      *
             ADD      1                  TO  IDZ
             MOVE    " £ΩÈªªƒÍø«Œ≈≤ °ß"  TO  WK-FREE-NAME2(IDZ)(1:16)
      *      ø«Œ≈≤ §ŒºË∆¿
             INITIALIZE                      SYS-1005-REC
             MOVE    "1005"              TO  SYS-1005-KANRICD
             MOVE    RECE44-SYODOU-SRYKA(IDX)
                                         TO  SYS-1005-KBNCD
             MOVE    RECE41-SRYYM        TO  SYS-1005-STYUKYMD(1:6)
             MOVE    "01"                TO  SYS-1005-STYUKYMD(7:2)
             MOVE    SYS-1005-STYUKYMD   TO  SYS-1005-EDYUKYMD
grpsys       MOVE    SPA-HOSPNUM         TO  SYS-1005-HOSPNUM
             MOVE    SYS-1005-REC        TO  MCPDATA-REC
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key10"             TO  MCP-PATHNAME
grpsys       PERFORM 900-DBSELECT-SEC
             IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"    TO  MCP-TABLE
               MOVE    "key10"           TO  MCP-PATHNAME
               PERFORM  900-SYSKANRI-READ-SEC
               IF      FLG-SYSKANRI      =   ZERO
                  MOVE  SYS-1005-SRYKANAME(1:40)
                                         TO  WK-FREE-NAME2(IDZ)(17:40)
               END-IF
             END-IF
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key10"             TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
      *
             IF    WRK-JIDO-SETCOMATFLG  NOT = ZERO
               MOVE  "2"                   TO  WK-FREE-MEISKYFLG2(IDZ)
               MOVE  WRK-JIDO-SETCOMATFLG  TO  WK-FREE-SETCOMATFLG2(IDZ)
             END-IF
      *
             PERFORM   VARYING   IDW   FROM   200   BY  -1
                        UNTIL    IDW   <   1
                IF   WK-FREE-NAME2(IDZ)(IDW:1)  NOT =  SPACE
                     COMPUTE WK-FREE-YUKOKETA2(IDZ) =  IDW  /   2
                     MOVE    1   TO    IDW
                END-IF
             END-PERFORM
      *
           END-PERFORM
      *
           INITIALIZE                      RECE45-REC
           MOVE    RECE44-HOSPNUM      TO  RECE45-HOSPNUM
           MOVE    RECE44-SRYYM        TO  RECE45-SRYYM
           MOVE    RECE44-NYUGAIKBN    TO  RECE45-NYUGAIKBN
           MOVE    RECE44-PTID         TO  RECE45-PTID
           MOVE    RECE44-RECEKA       TO  RECE45-RECEKA
           MOVE    RECE44-HKNID        TO  RECE45-HKNID
           MOVE    RECE44-TEKSTYMD     TO  RECE45-TEKSTYMD
           MOVE    RECE44-ZAINUM       TO  RECE45-ZAINUM
           START   RECE45-FILE
                 KEY IS    >=   RECE45-KEY
                 INVALID
                     MOVE    1         TO  FLG-RECE45
                 NOT INVALID
                     PERFORM 990-RECE45-NEXT-SEC
                     MOVE  RECE45-REC  TO  WRK-RECE45-REC
           END-START
      *
      *    £“£≈£√£≈£∞£µ•’•°•§•Î§Œ∆‚Õ∆§Ú•∆°º•÷•Î§À¬‡»Ú
           MOVE    ZERO                TO  IDX-RECE45
           MOVE    SPACE               TO  WRK-RECE45XX-REC
           INITIALIZE                      WRK-RECE45XX-REC
      *
           MOVE    RECE44-MEISAISU     TO  MAX-MEISAISU
      *
           PERFORM   VARYING   IDX   FROM    1   BY  1
                         UNTIL   ( IDX                >   50    )
                         OR      ( WK-FREE-NAME2(IDX) =   SPACE )
                COMPUTE  MAX-MEISAISU        =   MAX-MEISAISU  +  1
                MOVE   "810000001"
                             TO  WRK-RECE45XX-SRYCD(MAX-MEISAISU 1)
                MOVE   ZERO  TO  WRK-RECE45XX-SRYSURYO(MAX-MEISAISU 1)
                MOVE   WK-FREE-YUKOKETA2(IDX)
                             TO  WRK-RECE45XX-YUKOKETA(MAX-MEISAISU 1)
                MOVE   WK-FREE-NAME2(IDX)
                             TO  WRK-RECE45XX-NAME(MAX-MEISAISU 1)
                MOVE   WK-FREE-MEISKYFLG2(IDX)
                          TO  WRK-RECE45XX-MEISKYFLG(MAX-MEISAISU 1)
                MOVE   WK-FREE-SETCOMATFLG2(IDX)
                          TO  WRK-RECE45XX-SETCOMATFLG(MAX-MEISAISU 1)
                MOVE    "2"  TO  WRK-RECE45XX-SIKFLG(MAX-MEISAISU 1)
           END-PERFORM
      *
           PERFORM
             UNTIL  ( FLG-RECE45           =   1                   )
             OR     ( RECE44-HOSPNUM   NOT =   RECE45-HOSPNUM      )
             OR     ( RECE44-SRYYM     NOT =   RECE45-SRYYM        )
             OR     ( RECE44-NYUGAIKBN NOT =   RECE45-NYUGAIKBN    )
             OR     ( RECE44-PTID      NOT =   RECE45-PTID         )
             OR     ( RECE44-RECEKA    NOT =   RECE45-RECEKA       )
             OR     ( RECE44-HKNID     NOT =   RECE45-HKNID        )
             OR     ( RECE44-TEKSTYMD  NOT =   RECE45-TEKSTYMD     )
             OR     ( RECE44-ZAINUM    NOT =   RECE45-ZAINUM       )
      *
             PERFORM   VARYING   IDX   FROM    1   BY  1
                       UNTIL   ( IDX               >   5     )
                       OR      ( RECE45-SRYCD(IDX) =   SPACE )
                  ADD    1             TO      IDX-RECE45
                  MOVE   RECE45-SRYACT-TBL(IDX)
                             TO   WRK-RECE45XX-SRYACT-TBL(IDX-RECE45 1)
             END-PERFORM 
      *
             PERFORM 990-RECE45-NEXT-SEC
      *
           END-PERFORM
      *
      *    •≥•·•Û•»§Ú¥ﬁ§Û§¿∆‚Õ∆§«√Ê¥÷•’•°•§•Î§Œ∫∆∫Ó¿Æ
           MOVE       ZERO             TO      FLG-WRKRECE45
           MOVE       ZERO             TO      IDX
           MOVE       ZERO             TO      IDX-RECE45
           MOVE       ZERO             TO      WRK-RENNUM
           MOVE       ZERO             TO      WRK-CNT-MEISAI
           PERFORM    UNTIL     FLG-WRKRECE45  =    1
      *
                  INITIALIZE                        RECE451-REC
                  MOVE    WRK-RECE45-KEY       TO   RECE451-KEY
                  ADD     1                    TO   WRK-RENNUM
                  MOVE    WRK-RENNUM           TO   RECE451-RENNUM
                  MOVE    WRK-RECE45-PTNUM     TO   RECE451-PTNUM
                  MOVE    WRK-RECE45-SRYKA     TO   RECE451-SRYKA
                  MOVE    WRK-RECE45-SRYKBN    TO   RECE451-SRYKBN
                  MOVE    WRK-RECE45-SRYSYUKBN TO   RECE451-SRYSYUKBN
                  MOVE    WRK-RECE45-JIHIMONEY TO   RECE451-JIHIMONEY
                  PERFORM  VARYING   IDX   FROM   1   BY   1
                           UNTIL   (IDX       >    5)   OR
                                   (FLG-WRKRECE45   =   1)
                     ADD         1             TO    IDX-RECE45
                     IF  WRK-RECE45XX-SRYCD(IDX-RECE45 1) = SPACE
                         MOVE    1             TO    FLG-WRKRECE45
                     ELSE
                         MOVE  WRK-RECE45XX-SRYACT-TBL(IDX-RECE45 1)
                                          TO   RECE451-SRYACT-TBL(IDX)
      *
                         IF    WRK-RECE45XX-SIKFLG(IDX-RECE45 1)  =  "2"
                              ADD    1    TO   WRK-CNT-MEISAI
                         END-IF
      *
                     END-IF
                  END-PERFORM
                  IF   RECE451-SRYCD(1)  NOT =  SPACE
                     WRITE   RECE451-REC
                     ADD     1            TO   CNT-RECE45
                  END-IF
           END-PERFORM
      *
           MOVE    RECE44-REC        TO      RECE441-REC
           MOVE    WRK-CNT-MEISAI    TO      RECE441-MEISAISU
           IF   WRK-JIDO-SETCOMFLG   =  "1"
             MOVE  WRK-JIDO-SETCOMFLG
                                     TO      RECE441-SETCOMFLG
           END-IF
           WRITE   RECE441-REC
           ADD     1                 TO      CNT-RECE44
      *
           .
       2001-SYODOU-COMMENT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ∫∆ø«° ∆±∞Ï∆¸£≤≤ Ã‹°À§Œ•≥•·•Û•» ‘Ω∏
      *****************************************************************
       2001-SAIDOU-COMMENT-SEC          SECTION.
      *
           INITIALIZE            WRK-JIDO-SETCOM-AREA
           MOVE      "1"       TO     WRK-JIDO-SETCOMFLG
           MOVE       25       TO     WRK-JIDO-SETCOMATFLG
      *
           MOVE       ZERO       TO   IDZ
           INITIALIZE            WRK-FREE-AREA2
      *
           PERFORM   VARYING   IDX    FROM   1   BY   1
                      UNTIL   (IDX                       >   10  )
                       OR     (RECE44-SAIDOU-SRYKA(IDX)  =  SPACE)
      *
             ADD      1                  TO  IDZ
             MOVE    " £∫∆ªªƒÍø«Œ≈≤ °ß"  TO  WK-FREE-NAME2(IDZ)(1:16)
      *      ø«Œ≈≤ §ŒºË∆¿
             INITIALIZE                      SYS-1005-REC
             MOVE    "1005"              TO  SYS-1005-KANRICD
             MOVE    RECE44-SAIDOU-SRYKA(IDX)
                                         TO  SYS-1005-KBNCD
             MOVE    RECE41-SRYYM        TO  SYS-1005-STYUKYMD(1:6)
             MOVE    "01"                TO  SYS-1005-STYUKYMD(7:2)
             MOVE    SYS-1005-STYUKYMD   TO  SYS-1005-EDYUKYMD
grpsys       MOVE    SPA-HOSPNUM         TO  SYS-1005-HOSPNUM
             MOVE    SYS-1005-REC        TO  MCPDATA-REC
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key10"             TO  MCP-PATHNAME
grpsys       PERFORM 900-DBSELECT-SEC
             IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"    TO  MCP-TABLE
               MOVE    "key10"           TO  MCP-PATHNAME
               PERFORM  900-SYSKANRI-READ-SEC
               IF      FLG-SYSKANRI      =   ZERO
                  MOVE  SYS-1005-SRYKANAME(1:40)
                                         TO  WK-FREE-NAME2(IDZ)(17:40)
               END-IF
             END-IF
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key10"             TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
      *
             IF    WRK-JIDO-SETCOMATFLG  NOT = ZERO
               MOVE  "2"                   TO  WK-FREE-MEISKYFLG2(IDZ)
               MOVE  WRK-JIDO-SETCOMATFLG  TO  WK-FREE-SETCOMATFLG2(IDZ)
             END-IF
      *
             PERFORM   VARYING   IDW   FROM   200   BY  -1
                        UNTIL    IDW   <   1
                IF   WK-FREE-NAME2(IDZ)(IDW:1)  NOT =  SPACE
                     COMPUTE WK-FREE-YUKOKETA2(IDZ) =  IDW  /   2
                     MOVE    1   TO    IDW
                END-IF
             END-PERFORM
      *
           END-PERFORM
      *
           INITIALIZE                      RECE45-REC
           MOVE    RECE44-HOSPNUM      TO  RECE45-HOSPNUM
           MOVE    RECE44-SRYYM        TO  RECE45-SRYYM
           MOVE    RECE44-NYUGAIKBN    TO  RECE45-NYUGAIKBN
           MOVE    RECE44-PTID         TO  RECE45-PTID
           MOVE    RECE44-RECEKA       TO  RECE45-RECEKA
           MOVE    RECE44-HKNID        TO  RECE45-HKNID
           MOVE    RECE44-TEKSTYMD     TO  RECE45-TEKSTYMD
           MOVE    RECE44-ZAINUM       TO  RECE45-ZAINUM
           START   RECE45-FILE
                 KEY IS    >=   RECE45-KEY
                 INVALID
                     MOVE    1         TO  FLG-RECE45
                 NOT INVALID
                     PERFORM 990-RECE45-NEXT-SEC
                     MOVE  RECE45-REC  TO  WRK-RECE45-REC
           END-START
      *
      *    £“£≈£√£≈£∞£µ•’•°•§•Î§Œ∆‚Õ∆§Ú•∆°º•÷•Î§À¬‡»Ú
           MOVE    ZERO                TO  IDX-RECE45
           MOVE    SPACE               TO  WRK-RECE45XX-REC
           INITIALIZE                      WRK-RECE45XX-REC
      *
           MOVE    RECE44-MEISAISU     TO  MAX-MEISAISU
      *
           PERFORM   VARYING   IDX   FROM    1   BY  1
                         UNTIL   ( IDX                >   50    )
                         OR      ( WK-FREE-NAME2(IDX) =   SPACE )
                COMPUTE  MAX-MEISAISU        =   MAX-MEISAISU  +  1
                MOVE   "810000001"
                             TO  WRK-RECE45XX-SRYCD(MAX-MEISAISU 1)
                MOVE   ZERO  TO  WRK-RECE45XX-SRYSURYO(MAX-MEISAISU 1)
                MOVE   WK-FREE-YUKOKETA2(IDX)
                             TO  WRK-RECE45XX-YUKOKETA(MAX-MEISAISU 1)
                MOVE   WK-FREE-NAME2(IDX)
                             TO  WRK-RECE45XX-NAME(MAX-MEISAISU 1)
                MOVE   WK-FREE-MEISKYFLG2(IDX)
                          TO  WRK-RECE45XX-MEISKYFLG(MAX-MEISAISU 1)
                MOVE   WK-FREE-SETCOMATFLG2(IDX)
                          TO  WRK-RECE45XX-SETCOMATFLG(MAX-MEISAISU 1)
                MOVE    "2"  TO  WRK-RECE45XX-SIKFLG(MAX-MEISAISU 1)
           END-PERFORM
      *
           PERFORM
             UNTIL  ( FLG-RECE45           =   1                   )
             OR     ( RECE44-HOSPNUM   NOT =   RECE45-HOSPNUM      )
             OR     ( RECE44-SRYYM     NOT =   RECE45-SRYYM        )
             OR     ( RECE44-NYUGAIKBN NOT =   RECE45-NYUGAIKBN    )
             OR     ( RECE44-PTID      NOT =   RECE45-PTID         )
             OR     ( RECE44-RECEKA    NOT =   RECE45-RECEKA       )
             OR     ( RECE44-HKNID     NOT =   RECE45-HKNID        )
             OR     ( RECE44-TEKSTYMD  NOT =   RECE45-TEKSTYMD     )
             OR     ( RECE44-ZAINUM    NOT =   RECE45-ZAINUM       )
      *
             PERFORM   VARYING   IDX   FROM    1   BY  1
                       UNTIL   ( IDX               >   5     )
                       OR      ( RECE45-SRYCD(IDX) =   SPACE )
                  ADD    1             TO      IDX-RECE45
                  MOVE   RECE45-SRYACT-TBL(IDX)
                             TO   WRK-RECE45XX-SRYACT-TBL(IDX-RECE45 1)
             END-PERFORM 
      *
             PERFORM 990-RECE45-NEXT-SEC
      *
           END-PERFORM
      *
      *    •≥•·•Û•»§Ú¥ﬁ§Û§¿∆‚Õ∆§«√Ê¥÷•’•°•§•Î§Œ∫∆∫Ó¿Æ
           MOVE       ZERO             TO      FLG-WRKRECE45
           MOVE       ZERO             TO      IDX
           MOVE       ZERO             TO      IDX-RECE45
           MOVE       ZERO             TO      WRK-RENNUM
           MOVE       ZERO             TO      WRK-CNT-MEISAI
           PERFORM    UNTIL     FLG-WRKRECE45  =    1
      *
                  INITIALIZE                        RECE451-REC
                  MOVE    WRK-RECE45-KEY       TO   RECE451-KEY
                  ADD     1                    TO   WRK-RENNUM
                  MOVE    WRK-RENNUM           TO   RECE451-RENNUM
                  MOVE    WRK-RECE45-PTNUM     TO   RECE451-PTNUM
                  MOVE    WRK-RECE45-SRYKA     TO   RECE451-SRYKA
                  MOVE    WRK-RECE45-SRYKBN    TO   RECE451-SRYKBN
                  MOVE    WRK-RECE45-SRYSYUKBN TO   RECE451-SRYSYUKBN
                  MOVE    WRK-RECE45-JIHIMONEY TO   RECE451-JIHIMONEY
                  PERFORM  VARYING   IDX   FROM   1   BY   1
                           UNTIL   (IDX       >    5)   OR
                                   (FLG-WRKRECE45   =   1)
                     ADD         1             TO    IDX-RECE45
                     IF  WRK-RECE45XX-SRYCD(IDX-RECE45 1) = SPACE
                         MOVE    1             TO    FLG-WRKRECE45
                     ELSE
                         MOVE  WRK-RECE45XX-SRYACT-TBL(IDX-RECE45 1)
                                          TO   RECE451-SRYACT-TBL(IDX)
      *
                         IF    WRK-RECE45XX-SIKFLG(IDX-RECE45 1)  =  "2"
                              ADD    1    TO   WRK-CNT-MEISAI
                         END-IF
      *
                     END-IF
                  END-PERFORM
                  IF   RECE451-SRYCD(1)  NOT =  SPACE
                     WRITE   RECE451-REC
                     ADD     1            TO   CNT-RECE45
                  END-IF
           END-PERFORM
      *
           MOVE    RECE44-REC        TO      RECE441-REC
           MOVE    WRK-CNT-MEISAI    TO      RECE441-MEISAISU
           IF   WRK-JIDO-SETCOMFLG   =  "1"
             MOVE  WRK-JIDO-SETCOMFLG
                                     TO      RECE441-SETCOMFLG
           END-IF
           WRITE   RECE441-REC
           ADD     1                 TO      CNT-RECE44
      *
           .
       2001-SAIDOU-COMMENT-EXT.
           EXIT.
      *
      *****************************************************************
      *    •Ï•ª•◊•»£∞£µ≈æ¡˜ΩËÕ˝
      *****************************************************************
       2002-RECE45-TENSOU-SEC     SECTION.
      *
           INITIALIZE                      RECE45-REC
           MOVE    RECE44-HOSPNUM      TO  RECE45-HOSPNUM
           MOVE    RECE44-SRYYM        TO  RECE45-SRYYM
           MOVE    RECE44-NYUGAIKBN    TO  RECE45-NYUGAIKBN
           MOVE    RECE44-PTID         TO  RECE45-PTID
           MOVE    RECE44-RECEKA       TO  RECE45-RECEKA
           MOVE    RECE44-HKNID        TO  RECE45-HKNID
           MOVE    RECE44-TEKSTYMD     TO  RECE45-TEKSTYMD
           MOVE    RECE44-ZAINUM       TO  RECE45-ZAINUM
           START   RECE45-FILE
               KEY IS    >=   RECE45-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE45
               NOT INVALID
                   PERFORM 990-RECE45-NEXT-SEC
           END-START
           PERFORM
               UNTIL  ( FLG-RECE45           =   1                   )
               OR     ( RECE44-HOSPNUM   NOT =   RECE45-HOSPNUM      )
               OR     ( RECE44-SRYYM     NOT =   RECE45-SRYYM        )
               OR     ( RECE44-NYUGAIKBN NOT =   RECE45-NYUGAIKBN    )
               OR     ( RECE44-PTID      NOT =   RECE45-PTID         )
               OR     ( RECE44-RECEKA    NOT =   RECE45-RECEKA       )
               OR     ( RECE44-HKNID     NOT =   RECE45-HKNID        )
               OR     ( RECE44-TEKSTYMD  NOT =   RECE45-TEKSTYMD     )
               OR     ( RECE44-ZAINUM    NOT =   RECE45-ZAINUM       )
      *
               MOVE          RECE45-REC       TO      RECE451-REC
               WRITE         RECE451-REC
               ADD           1                TO      CNT-RECE45
      *
               PERFORM 990-RECE45-NEXT-SEC
      *
           END-PERFORM
      *
           .
       2002-RECE45-TENSOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ÿ∑∏•≥•·•Û•» ‘Ω∏
      *****************************************************************
       260-SETCOM-HENSYU-SEC     SECTION.
      *
      *    •—•È•·°º•ø£¥£¥£±•’•°•§•Î§Ë§Í ‘Ω∏
           PERFORM 800-RECE41-SET441-SEC
           MOVE    ZERO                TO  RECE441-ZAINUM
      *
           START   RECE441-FILE
               KEY IS    >=   RECE441-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE441
               NOT INVALID
                   PERFORM 990-RECE441-NEXT-SEC
           END-START
           PERFORM
               UNTIL  ( FLG-RECE441          =   1                 )
               OR     ( RECE41-HOSPNUM   NOT =   RECE441-HOSPNUM   )
               OR     ( RECE41-SRYYM     NOT =   RECE441-SRYYM     )
               OR     ( RECE41-NYUGAIKBN NOT =   RECE441-NYUGAIKBN )
               OR     ( RECE41-PTID      NOT =   RECE441-PTID      )
               OR     ( RECE41-RECEKA    NOT =   RECE441-RECEKA    )
               OR     ( RECE41-HKNID     NOT =   RECE441-HKNID     )
               OR     ( RECE41-TEKSTYMD  NOT =   RECE441-TEKSTYMD  )
      *
               MOVE      ZERO      TO    FLG-SETCOM-OKIKAE
      *
               IF     RECE441-SETCOMFLG   =    "1"
                  PERFORM 2601-SETCOM-HENSYU2-SEC
                  IF   FLG-SETCOM-OKIKAE  =  "1"
                    CONTINUE
                  ELSE
                    MOVE   SPACE   TO   RECE441-SETCOMFLG
                    REWRITE   RECE441-REC
                    ADD     1      TO   CNT-RECE44-RE
                  END-IF
               END-IF
      *
               PERFORM 990-RECE441-NEXT-SEC
      *
           END-PERFORM
      *
           .
       260-SETCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ÿ∑∏•≥•·•Û•» ‘Ω∏£≤
      *****************************************************************
       2601-SETCOM-HENSYU2-SEC     SECTION.
      *
           MOVE    ZERO    TO    FLG-SETCOM
      *
           MOVE    ZERO    TO    WRK-HEN-RENNUM-X
                                 WRK-HEN-SHORI-RENNUM-X
                                 WRK-HEN-SEQNO-X
           MOVE    ZERO    TO    WRK-HEN-RENNUM-J
                                 WRK-HEN-SHORI-RENNUM-J
                                 WRK-HEN-SEQNO-J
      *
           PERFORM 800-RECE441-SET451-SEC
           MOVE    RECE441-ZAINUM      TO  RECE451-ZAINUM
           START   RECE451-FILE
               KEY IS    >=   RECE451-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE451
               NOT INVALID
                   PERFORM 990-RECE451-NEXT-SEC
           END-START
           PERFORM
               UNTIL  ( FLG-RECE451           =   1                 )
               OR     ( RECE441-HOSPNUM   NOT =   RECE451-HOSPNUM   )
               OR     ( RECE441-SRYYM     NOT =   RECE451-SRYYM     )
               OR     ( RECE441-NYUGAIKBN NOT =   RECE451-NYUGAIKBN )
               OR     ( RECE441-PTID      NOT =   RECE451-PTID      )
               OR     ( RECE441-RECEKA    NOT =   RECE451-RECEKA    )
               OR     ( RECE441-HKNID     NOT =   RECE451-HKNID     )
               OR     ( RECE441-TEKSTYMD  NOT =   RECE451-TEKSTYMD  )
               OR     ( RECE441-ZAINUM    NOT =   RECE451-ZAINUM    )
      *
               MOVE      ZERO      TO    FLG-MEISKY-OKIKAE
      *
               PERFORM   VARYING   IDX   FROM    1   BY  1
                         UNTIL   ( IDX                >   5     )
                         OR      ( RECE451-SRYCD(IDX) =   SPACE )
                IF    RECE451-SIKFLG(IDX)     =  "2"
                 IF   RECE451-MEISKYFLG(IDX)  =  "2"
                   IF      RECE451-SRYYM  >=  "201304"
                    IF     RECE451-SETCOMATFLG(IDX) = ZERO
                      IF   (FLG-SETCOM              =  1   )
                      AND  (RECE451-RECEDENFLG(IDX) = SPACE)
                        ADD    1                 TO  WRK-HEN-SEQNO-X
                        IF   WRK-HEN-SEQNO-X  >  3
                          MOVE   SPACE   TO  RECE451-MEISKYFLG(IDX)
                          MOVE   1       TO  FLG-MEISKY-OKIKAE
                        ELSE
                          MOVE   WRK-HEN-RENNUM-X  TO  WRK-HEN-RENNUM
                          MOVE   WRK-HEN-SHORI-RENNUM-X
                                         TO  WRK-HEN-SHORI-RENNUM
                          MOVE   WRK-HEN-SEQNO-X   TO  WRK-HEN-SEQNO
                          PERFORM  26011-SETCOM-HENSYU3-SEC
                        END-IF
                        IF  (WRK-HEN-RENNUM-X = WRK-HEN-RENNUM-J )
                        AND (WRK-HEN-SHORI-RENNUM-X
                                        = WRK-HEN-SHORI-RENNUM-J )
                          ADD  1                 TO  WRK-HEN-SEQNO-J
                        END-IF
                      END-IF
                    ELSE
                      EVALUATE   RECE451-SETCOMATFLG(IDX)
                        WHEN    4
                        WHEN   25
                        WHEN  201
                          ADD  1                 TO  WRK-HEN-SEQNO-J
                          IF   WRK-HEN-SEQNO-J  >  3
                            MOVE   SPACE   TO  RECE451-MEISKYFLG(IDX)
                            MOVE   1       TO  FLG-MEISKY-OKIKAE
                          ELSE
                            MOVE WRK-HEN-RENNUM-J  TO  WRK-HEN-RENNUM
                            MOVE WRK-HEN-SHORI-RENNUM-J
                                         TO  WRK-HEN-SHORI-RENNUM
                            MOVE WRK-HEN-SEQNO-J   TO  WRK-HEN-SEQNO
                            PERFORM  26011-SETCOM-HENSYU3-SEC
                          END-IF
                          IF  (WRK-HEN-RENNUM-X = WRK-HEN-RENNUM-J )
                          AND (WRK-HEN-SHORI-RENNUM-X
                                          = WRK-HEN-SHORI-RENNUM-J )
                            ADD    1             TO  WRK-HEN-SEQNO-X
                          END-IF
                      END-EVALUATE
                    END-IF
                   ELSE
                    MOVE   SPACE   TO  RECE451-MEISKYFLG(IDX)
                    MOVE   1       TO  FLG-MEISKY-OKIKAE
                   END-IF
                 ELSE
                    IF   (RECE451-SRYCD(IDX)(1:1) = "1" OR "6" OR "7")
                    OR   (RECE451-SRYCD(IDX)(1:3) = "059"            )
                      MOVE   1               TO  FLG-SETCOM
                      MOVE   RECE451-RENNUM  TO  WRK-HEN-RENNUM-X
                      MOVE   IDX             TO  WRK-HEN-SHORI-RENNUM-X
                      MOVE   ZERO            TO  WRK-HEN-SEQNO-X
                    END-IF
      *
                    IF   (RECE451-SRYCD(IDX) =
      *4
                          "101110040" OR
      *25
                          "101120040" OR
      *201
                          "101800890"                        )
                    OR   (RECE451-SRYCD(IDX)(1:5)  =  "09593")
      *
                       MOVE   RECE451-RENNUM  TO  WRK-HEN-RENNUM-J
                       MOVE   IDX       TO  WRK-HEN-SHORI-RENNUM-J
                       MOVE   ZERO            TO  WRK-HEN-SEQNO-J
                    END-IF
                 END-IF
                ELSE
                    MOVE   SPACE   TO  RECE451-MEISKYFLG(IDX)
                    MOVE   1       TO  FLG-MEISKY-OKIKAE
                END-IF
               END-PERFORM
      *
               IF    FLG-MEISKY-OKIKAE  =  1
                  REWRITE   RECE451-REC
                  ADD       1        TO   CNT-RECE45-RE
               END-IF
      *
               PERFORM 990-RECE451-NEXT-SEC
      *
           END-PERFORM
      *
           .
       2601-SETCOM-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ÿ∑∏•≥•·•Û•» ‘Ω∏£≥
      *****************************************************************
       26011-SETCOM-HENSYU3-SEC     SECTION.
      *
           MOVE    SPACE                 TO  RECE455-REC
           INITIALIZE                        RECE455-REC
      *
           MOVE    RECE451-KEY           TO  RECE455-KEY
      *
           MOVE    WRK-HEN-RENNUM        TO  RECE455-RENNUM
           MOVE    WRK-HEN-SHORI-RENNUM  TO  RECE455-SHORI-RENNUM
           MOVE    WRK-HEN-SEQNO         TO  RECE455-SEQNO
      *
           MOVE    RECE451-SRYCD(IDX)    TO  RECE455-SRYCD
           MOVE    RECE451-NAME(IDX)     TO  RECE455-NAME
           MOVE    RECE451-INPUTCOMENT(IDX)
                                         TO  RECE455-INPUTCOMENT
      *
           WRITE   RECE455-REC
           ADD     1                     TO  CNT-RECE455
      *
           MOVE    1                     TO  FLG-SETCOM-OKIKAE
      *
           .
       26011-SETCOM-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ω™Œª°°°°ΩËÕ˝
      *****************************************************************
       300-END-SEC                 SECTION.
      *
      *    •’•°•§•Î£√£Ã£œ£”£≈ΩËÕ˝
           PERFORM 310-FILE-CLOSE-SEC
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *    •π•∆•√•◊¥…Õ˝Ω™ŒªΩËÕ˝
               MOVE    "STE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
      *
               PERFORM 900-DBDISCONNECT-SEC
           END-IF
      *
           DISPLAY "RECE41  IN  " CNT-RECE41  
           DISPLAY "RECE44  CNT " CNT-RECE44  
           DISPLAY "RECE45  CNT " CNT-RECE45  
           DISPLAY "RECE44  REWRITE :" CNT-RECE44-RE
           DISPLAY "RECE45  REWRITE :" CNT-RECE45-RE
           DISPLAY "RECE455 CNT-OUT :" CNT-RECE455
           DISPLAY "*** ORCR0435 END ***"
      *
           .
       300-END-EXT.
           EXIT.
      *
      *****************************************************************
      *    •’•°•§•Î£√£Ã£œ£”£≈ΩËÕ˝
      *****************************************************************
       310-FILE-CLOSE-SEC              SECTION.
      *
           CLOSE                       RECE41-FILE
      *
           CLOSE                       RECE44-FILE
      *
           CLOSE                       RECE45-FILE
      *
           CLOSE                       RECE441-FILE
           CLOSE                       RECE451-FILE
      *
           CLOSE                       RECE455-FILE
      *
           .
       310-FILE-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    •®•È°ºΩ–ŒœΩËÕ˝
      *****************************************************************
       500-ERR-HENSYU-SEC                SECTION.
      *
           OPEN    INPUT   RECEERR-FILE
           IF      STS-RECEERR         =   ZERO
               CLOSE   RECEERR-FILE
           ELSE
               OPEN    OUTPUT              RECEERR-FILE
      *
               MOVE    WRK-RECEERR         TO  RECEERR-REC
               WRITE   RECEERR-REC
               CLOSE   RECEERR-FILE
      *         
               IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *            •∏•Á•÷¥…Õ˝≥´ªœΩËÕ˝
                   MOVE    "JBE"           TO  SJOBKANRI-MODE
                   INITIALIZE                  JOBKANRI-REC
                   MOVE    WRK-RECEERR     TO  JOB-YOBI
                   MOVE    "9999"          TO  JOB-ERRCD
grpsys             PERFORM 900-CALL-ORCSJOB-SEC
               END-IF
           END-IF
      *                             
           MOVE    1                   TO  FLG-END
      *
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ΩËÕ˝√ÊªﬂΩËÕ˝
      *****************************************************************
       500-CANCEL-HENSYU-SEC                SECTION.
      *
           IF      WRK-PARA-SHELLID    =   "RECEPTX"
               CONTINUE
           ELSE
               MOVE    "CHK"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
               IF    ( SJOBKANRI-RETURN
                                       =   ZERO )
               AND   ( JOB-STOPFLG     =   1    )
                   MOVE    "ΩËÕ˝§¨√Êªﬂ§µ§Ï§ﬁ§∑§ø"
                                           TO  WRK-RECEERR
      *
                   OPEN    INPUT   RECEERR-FILE
                   IF      STS-RECEERR         =   ZERO
                       CLOSE   RECEERR-FILE
                   ELSE
                       OPEN    OUTPUT              RECEERR-FILE
      *    
                       MOVE    WRK-RECEERR         TO  RECEERR-REC
                       WRITE   RECEERR-REC
                       CLOSE   RECEERR-FILE
      *         
      *                •∏•Á•÷¥…Õ˝Ω™ŒªΩËÕ˝
                       MOVE    "CAN"           TO  SJOBKANRI-MODE
                       INITIALIZE                  JOBKANRI-REC
                       MOVE    WRK-RECEERR     TO  JOB-YOBI
                       MOVE    "8888"          TO  JOB-ERRCD
                       MOVE    2               TO  JOB-STOPFLG
grpsys                 PERFORM 900-CALL-ORCSJOB-SEC
                   END-IF
      *                             
                   MOVE    1                   TO  FLG-END
               END-IF
           END-IF
           .
       500-CANCEL-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    •Ï•ª•◊•»£∞£≤•«°º•øΩÁ∏°∫˜ΩËÕ˝
      *****************************************************************
       990-RECE41-READ-SEC           SECTION.
      *
           READ    RECE41-FILE         NEXT
               AT  END
                   MOVE    1           TO  FLG-END
               NOT AT  END
                   ADD     1           TO  CNT-RECE41
                                           CNT-IN-CANCEL
      *
                   DISPLAY "RECE41  PTNUM=" RECE41-PTNUM
      *
           END-READ
      *
           .
       990-RECE41-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *    •Ï•ª•◊•»£∞£¥•«°º•ø∆…§ﬂ
      ****************************************************************
       990-RECE44-NEXT-SEC           SECTION.
      *
           READ    RECE44-FILE       NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE44
               NOT AT  END
                   MOVE    ZERO      TO  FLG-RECE44
                   ADD     1         TO  CNT-IN-CANCEL
           END-READ
      *
           .
       990-RECE44-NEXT-EXT.
           EXIT.
      *
      ****************************************************************
      *    •Ï•ª•◊•»£¥£¥£±•«°º•ø∆…§ﬂ
      ****************************************************************
       990-RECE441-NEXT-SEC           SECTION.
      *
           READ    RECE441-FILE       NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE441
               NOT AT  END
                   MOVE    ZERO      TO  FLG-RECE441
           END-READ
      *
           .
       990-RECE441-NEXT-EXT.
           EXIT.
      *
      ****************************************************************
      *    •Ï•ª•◊•»£∞£µ•«°º•ø∆…§ﬂ
      ****************************************************************
       990-RECE45-NEXT-SEC           SECTION.
      *
           READ    RECE45-FILE       NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE45
               NOT AT  END
                   MOVE    ZERO      TO  FLG-RECE45
           END-READ
      *
           .
       990-RECE45-NEXT-EXT.
           EXIT.
      *
      ****************************************************************
      *    •Ï•ª•◊•»£¥£µ£±•«°º•ø∆…§ﬂ
      ****************************************************************
       990-RECE451-NEXT-SEC           SECTION.
      *
           READ    RECE451-FILE       NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE451
               NOT AT  END
                   MOVE    ZERO      TO  FLG-RECE451
           END-READ
      *
           .
       990-RECE451-NEXT-EXT.
           EXIT.
      *
      *****************************************************************
      *    •Ï•ª•◊•»£¥£±•«°º•ø ‘Ω∏ΩËÕ˝° £¥£¥£±°À
      *****************************************************************
       800-RECE41-SET441-SEC           SECTION.
      *
           INITIALIZE                      RECE441-REC
           MOVE    RECE41-HOSPNUM      TO  RECE441-HOSPNUM
           MOVE    RECE41-SRYYM        TO  RECE441-SRYYM
           MOVE    RECE41-NYUGAIKBN    TO  RECE441-NYUGAIKBN
           MOVE    RECE41-PTID         TO  RECE441-PTID
           MOVE    RECE41-RECEKA       TO  RECE441-RECEKA
           MOVE    RECE41-HKNID        TO  RECE441-HKNID
           MOVE    RECE41-TEKSTYMD     TO  RECE441-TEKSTYMD
      *
           .
       800-RECE41-SET441-EXT.
           EXIT.
      *
      *****************************************************************
      *    •Ï•ª•◊•»£¥£¥£±•«°º•ø ‘Ω∏ΩËÕ˝° £¥£µ£±°À
      *****************************************************************
       800-RECE441-SET451-SEC           SECTION.
      *
           INITIALIZE                       RECE451-REC
           MOVE    RECE441-HOSPNUM      TO  RECE451-HOSPNUM
           MOVE    RECE441-SRYYM        TO  RECE451-SRYYM
           MOVE    RECE441-NYUGAIKBN    TO  RECE451-NYUGAIKBN
           MOVE    RECE441-PTID         TO  RECE451-PTID
           MOVE    RECE441-RECEKA       TO  RECE451-RECEKA
           MOVE    RECE441-HKNID        TO  RECE451-HKNID
           MOVE    RECE441-TEKSTYMD     TO  RECE451-TEKSTYMD
      *
           .
       800-RECE441-SET451-EXT.
           EXIT.
      *
      *****************************************************************
      *    •∑•π•∆•‡¥…Õ˝•ﬁ•π•ø°º∆…π˛
      *****************************************************************
       900-SYSKANRI-READ-SEC         SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYS-1005-REC
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               INITIALIZE                  SYS-1005-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       900-SYSKANRI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    •∏•Á•÷¥…Õ˝£ƒ£¬¿©∏ÊΩËÕ˝
      *****************************************************************
       900-CALL-ORCSJOB-SEC            SECTION.
      *
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
grpsys     MOVE    SPA-HOSPNUM     TO  JOB-HOSPNUM
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA 
                                   JOBKANRI-REC
                                   SPA-AREA
           .
       900-CALL-ORCSJOB-EXT.
           EXIT.
      *
      *****************************************************************
      *    £ƒ£¬£”£≈£Ã£≈£√£‘ΩËÕ˝
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           IF      MCP-RC              =   ZERO
               CONTINUE
           ELSE
               DISPLAY "SELECT ERR table=" MCP-TABLE
                       " pathname="        MCP-PATHNAME
           END-IF
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    £ƒ£¬£∆£≈£‘£√£»ΩËÕ˝
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    •Ø•Ì°º•∫ΩËÕ˝
      *****************************************************************
       900-CLOSE-SEC                  SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    •∆°º•÷•Î•¢•Ø•ª•πΩËÕ˝
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
      *
       900-ORCDBMAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    £ƒ£¬°°•™°º•◊•ÛΩËÕ˝
      *****************************************************************
       120-DBOPEN-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBOPEN"            TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       120-DBOPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    £ƒ£¬°°•Ø•Ì°º•∫ΩËÕ˝
      *****************************************************************
       900-DBDISCONNECT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBDISCONNECT"      TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBDISCONNECT-EXT.
           EXIT.
      *
