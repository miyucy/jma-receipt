      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCR0090.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ¥ì¥»¥×¥È
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ¥ì¥»¥×¥È¡¡°õºþ
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  00/12/01    MCC-ÂÀÅÄ      ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  01.00.01    MCC-Æ£¸¶     01.06.29  ÊÝ¸±¼ÔÈÖ¹æ¡¦
      *                                     Å¬ÍÑ³«»ÏÇ¯·îÆü¤ÎÄÉ²Ã
      *  01.00.02    MCC-Æ£¸¶     01.07.11  ÌôºÞÎÁÄþ¸º¤ÎÊÔ½¸ÄÉ²Ã
      *  01.00.03    MCC-Æ£¸¶     01.07.12  ÌôºÞ¤Î¤È¤­ÌôºÞÎÁÄþ¸º°Ê³°¤Ï
      *                             ¡ÊRECE06¡Ë¸øÉ½½ç½øÈÖ¹æ¤ÎÊÔ½¸¤ò¤·¤Ê¤¤
      *  01.00.04    MCC-¾®Æ¦Âô   01.09.28  Ãí¼Í¤ÎÌôºÞÅÀ¿ô£²£°ÅÀ°Ê²¼¤Î
      *                                     ¤È¤­Å¦Í×Íó¤ËÆâÌõ¤ò°õºþ¤·¤Ê¤¤
      *  01.00.05    MCC-Æ£¸¶     01.10.03  ¿ÇÎÅ¹Ô°Ù¥³°ì¥É¤¬ÂÐ¾Ý¤Î¥³¥á¥ó
      *                                     ¥È¤Î¤È¤­¿ôÎÌ¡¢²ó¿ô¤ÏÉ½¼¨¤·¤Ê¤¤
      *  01.00.06    MCC-Æ£¸¶     01.10.17  ¸¡ºº¤ÎÅ¬ÍÑ¤ÎÊÔ½¸½¤Àµ
      *  01.00.07    MCC-¾®Æ¦Âô   01.10.24  ½¤ÀµÍúÎò(01-00-04)¤Î½¤Àµ¤«¤é
      *                                     ¤½¤ÎÂ¾Ãí¼Í¤ò³°¤¹
      *  01.00.08    MCC-Æ£¸¶     01.10.30  ½èÊý¤Î¤È¤­´ðËÜÅÀ¿ô¡á¥¼¥í¤Ç
      *                                     ²ó¿ô¡ä£±¤Î¤È¤­Á´¤Æ°õºþ¤¹¤ë
      *  01.00.09    MCC-Æ£¸¶     01.11.28  ¸¡ºº¤Î¤È¤­¥Õ¥ê¡¼¥³¥á¥ó¥È¤Î
      *                                     Ê¸»ú¿ô¤ò·×»»¤·¤ÆÊÔ½¸¤¹¤ë
      *  01.00.10    MCC-¾®Æ¦Âô   02.01.09  ¥Õ¥ê¡¼¥³¥á¥ó¥È¤ÎÈ½ÄêÊ¸¤ò½¤Àµ
      *  01.01.01    MCC-Æ£¸¶     02.02.04  ½èÊý¤Î¤È¤­´ðËÜÅÀ¿ô¡á¥¼¥í¤Ç
      *                                     ºÞ¤Î¿ô¡ä£±¤Î¤È¤­Á´¤Æ°õºþ¤ËÊÑ¹¹
      *  01.01.02    MCC-Æ£¸¶     02.02.04  ÅÀÅ©Ãí¼Í£²£°ÅÀ°Ê²¼¤Î»þ¤ÎÊÔ½¸¤ÎÊÑ¹¹
      *  01.01.03    MCC-Æ£¸¶     02.02.07  ¸¡ºº¤Î¤È¤­¿ôÎÌ¡¦Ã±°Ì¤ò°õºþ
      *                                     ¤¹¤ë¤è¤¦¤Ë½¤Àµ
      *  01.01.04    MCC-Æ£¸¶     02.02.21  ÅÀÅ©Ãí¼Í¡¦¼ê½Ñ¤Î»þ¤ÎÊÔ½¸¤ò
      *                                   ¡¡½¤Àµ
      *  01.01.05    MCC-Æ£¸¶     02.02.25  ¸¡ºº¤ÎÅ¬ÍÑ¤ÎÊÔ½¸¤ò½¤Àµ
      *  01.01.06    MCC-¾®Æ¦Âô   02.03.01  ¥³¥á¥ó¥È¤Î½ÐÎÏ¾ò·ï¤òÊÑ¹¹
      *  01.01.07    MCC-¾®Æ¦Âô   02.03.19  Æ±ÆüºÆ¿Ç¡ÊÆ±ÆüÅÅÏÃºÆ¿Ç¡Ë¤òÅ¦Í×
      *                                     ¤Ë°õ»ú¤¹¤ë¤è¤¦¤Ë½¤Àµ
      *  01.01.08    MCC-Æ£¸¶     02.03.19  ¿ÇÎÅ¶èÊ¬¡á£±£²¤Î¤È¤­·ÑÂ³´ÉÍý²Ã»»¤Î
      *                                     ¥Á¥§¥Ã¥¯¤ò¤ä¤á¤Æ°õºþ¤·¤Ê¤¤ 
      *  01.01.09    MCC-¾®Æ¦Âô   02.03.20  ¿ÇÎÅ¶èÊ¬¡á£±£²¤Î¤È¤­·ÑÂ³´ÉÍý²Ã»»¤ò
      *                                     ºÆÅÙ°õºþ¤¹¤ë¤è¤¦¤Ë¤·¤¿ 
      *  01.01.10    MCC-Æ£¸¶     02.03.25  ¸¡ºº¤Î¤È¤­¥³¥á¥ó¥È¤È¤·¤Æ¹àÌÜ¿ô¤ò
      *                                     ÊÔ½¸¤¹¤ë 
      *  01.01.11    MCC-Æ£¸¶     02.04.16  ¸¡ººÌ¾¾Î¤Î½¤Àµ
      *  £²£°£°£²Ç¯£´·î²þÀµÂÐ±þ
      *  01.02.01    MCC-¾®Æ¦Âô   02.04.20  ºÆ¿ÇÎÁ¤Î°õ»ú½¤Àµ
      *                                     ÆýÍÄ»ù²Ã»»¡¢»þ´Ö³°²Ã»»Åù
      *  01.02.02    MCC-Æ£¸¶     02.04.22  £²£°£µ±ß°Ê²¼¤Î¥ë¡¼¥ëºï½ü
      *                                     ºÆ¿ÇÎÁ¡¢³°Íè´ÉÍý²Ã»»¤ÎÅ¦Í×Íó
      *                                     °õ»ú½¤Àµ
      *  01.02.03    MCC-Æ£¸¶     02.04.22  ÅÀÅ©Ãí¼Í°Ê¹ß¤Î¥³¥á¥ó¥È°õ»ú°ÌÃÖ¤Î
      *                                     ½¤Àµ
      *  01.02.04    MCC-Æ£¸¶     02.04.23  ²èÁü¿ÇÃÇ¤ÎÃ±°Ì¤ÎÊÑ¹¹¡ÊËç¢ª²ó¡Ë
      *                                     Ê¬²è¿ô¤ÎÊÔ½¸¤ÎÄÉ²Ã 
      *  01.02.05    MCC-¾®Æ¦Âô   02.07.08  ¿ÇÎÅ¼ÂÆü¿ô»»ÄêÍÑ¤Î¥·¥¹¥Æ¥àÍ½Ìó
      *                                     ¥³¡¼¥É¤ò°õºþ¤·¤Ê¤¤¤è¤¦ÄÉ²Ã 
      *  01.02.06    NACL-Æ£¸¶    02.08.23  ¸¡ºº¤Ë¥³¥á¥ó¥È¤¬¤¢¤ë¤È¤­¸¡ºº¿ô
      *                                     ¤Ë¥«¥¦¥ó¥È¤·¤Ê¤¤¤è¤¦¤Ë¤¹¤ë
      *  01.02.07    NACL-Æ£¸¶    02.08.26  Èé²¼¶ÚÆùÃí¼Í°Ê³°¤Ï¼êµ»Ì¾¤ò°õºþ
      *                                     ¤¹¤ë¤è¤¦¤Ë¤¹¤ë
      *  01.02.08    NACL-Æ£¸¶    02.09.01  ¸¡ºº¤Î¤È¤­¤ÎÉ½¼¨ÊýË¡¤òÊÑ¹¹
      *  01.02.09    NACL-Æ£¸¶    02.09.06  ½é¿Ç²Ã»»¤Î¤È¤­ÊÔ½¸¤¹¤ë
      *  01.02.10    NACL-Æ£¸¶    02.09.26  Èé²¼¶ÚÆùÃí¼Í°Ê³°¤Ç¼êµ»¤¬¤Ê¤¤¤È¤­
      *                                     ¡ö¤ò°õºþ¤¹¤ë
      *  01.02.11    NACL-Æ£¸¶    02.09.30  ½é¿Ç²Ã»»¤Î¤È¤­ÊÔ½¸¤ò½¤Àµ
      *  01.02.12    NACL-Æ£¸¶    02.10.09  ÅÅÏÃºÆ¿Ç¤ò½ÐÎÏ¤¹¤ë¤è¤¦¤Ë½¤Àµ
      *  01.02.13    NACL-ÌçÏÆ    02.11.26  ¿ÇÎÅ¼ÂÆü¿ô»»ÄêÍÑ¤Î
      *                                     ¥³¡¼¥É¤ò°õºþ¤·¤Ê¤¤¤è¤¦ÄÉ²Ã 
      *                                     ¸¡¿Ç¥³¡¼¥É¤ò°õºþ¤¹¤ë¤è¤¦ÄÉ²Ã
      *  01.02.14    NACL-¾®Æ¦Âô  02.11.28  ½é¿Ç²Ã»»¤Î¤È¤­ÊÔ½¸¤¹¤ë
      *  01.02.15    NACL-Æ£¸¶    02.12.02  »ÀÁÇ¤Î»þÃ±²Á¤òÉ½¼¨¤¹¤ë¤è¤¦¤ËÄÉ²Ã
      *  01.02.16    NACL-Æ£¸¶    03.01.10  ¸¡ºº¤Î²ó¿ô¤ÎÊÔ½¸
      *  01.02.17    NACL-Æ£¸¶    03.01.10  ²èÁü¿ÇÃÇ¤Î¥Õ¥£¥ë¥à¤ò¼êµ»¤ËÉ½¼¨
      *  01.00.18    NACL-Æ£¸¶    03.01.30  ÆýÍÄ»ù²Ã»»¤Î»þ¼êµ»¤ËÉ½¼¨
      *  01.00.09    NACL-Æ£¸¶    03.02.12  Êä½õ¶èÊ¬¤ÎÄÉ²Ã
      *  01.00.10    NACL-ÌçÏÆ    03.03.06  ½éºÆ¿Ç¤Î¥³¥á¥ó¥ÈÊÔ½¸ÂÐ±þ
      *  01.00.11    NACL-ÌçÏÆ    03.03.12  ÀèÆ¬¤Î¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¤ÎÈ½Äê½¤Àµ
      *  01.00.12    NACL-ÌçÏÆ    03.05.08  ÀèÆ¬¤Î¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¤ÎÈ½Äê½¤Àµ
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *    ¥ì¥»¥×¥È£°£²¥Ç¡¼¥¿
           SELECT  RECE02-FILE     ASSIGN  RECE01PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE02-KEY
                                   FILE    STATUS  IS  STS-RECE02.
      *    ¥ì¥»¥×¥È£°£´¥Ç¡¼¥¿
           SELECT  RECE04-FILE     ASSIGN  RECE04PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  SEQUENTIAL
                                   RECORD  KEY     IS  RECE04-KEY
                                   FILE    STATUS  IS  STS-RECE.
      *    ¥ì¥»¥×¥È£°£µ¥Ç¡¼¥¿
           SELECT  RECE05-FILE     ASSIGN  RECE05PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  SEQUENTIAL
                                   RECORD  KEY     IS  RECE05-KEY
                                   FILE    STATUS  IS  STS-RECE.
      *    ¥ì¥»¥×¥È£°£¶¥Ç¡¼¥¿
           SELECT  RECE06-FILE     ASSIGN  RECE06PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE06-KEY
                                   FILE    STATUS  IS  STS-RECE.
      *    ¥ì¥»¥×¥È£°£¶¡­¥Ç¡¼¥¿
           SELECT  RECE066-FILE     ASSIGN  RECE06PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  SEQUENTIAL
                                   RECORD  KEY     IS  RECE066-KEY
                                   FILE    STATUS  IS  STS-RECE.
006900*    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë
           SELECT  RECEERR-FILE    ASSIGN  RECEERR
                                   FILE    STATUS  IS  STS-RECEERR.
      *
       DATA                    DIVISION.
       FILE                        SECTION.
      *
      *    ¥ì¥»¥×¥È£°£²¥Ç¡¼¥¿
       FD  RECE02-FILE.
       01  RECE02-REC.
           COPY    "CPRCF002.INC".
      *
      *    ¥ì¥»¥×¥È£°£´¥Ç¡¼¥¿
       FD  RECE04-FILE.
       01  RECE04-REC.
           COPY    "CPRCF004.INC".
      *
      *    ¥ì¥»¥×¥È£°£µ¥Ç¡¼¥¿
       FD  RECE05-FILE.
       01  RECE05-REC.
           COPY    "CPRCF005.INC".
      *
      *    ¥ì¥»¥×¥È£°£¶¥Ç¡¼¥¿
       FD  RECE06-FILE.
       01  RECE06-REC. 
           COPY    "CPRCF006.INC".
      *
      *    ¥ì¥»¥×¥È£°£¶¡­¥Ç¡¼¥¿
       FD  RECE066-FILE.
       01  RECE066-REC. 
           COPY    "CPRCF006.INC"  REPLACING  //RECE06//
                                   BY         //RECE066//.
006900*    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë
       FD  RECEERR-FILE.
       01  RECEERR-REC             PIC X(200). 
      *
       WORKING-STORAGE             SECTION.
      *
      *     ¥ì¥»¥×¥ÈÌÀºÙ¥Õ¥¡¥¤¥ë Ì¾¾ÎÎÎ°è 
           COPY    "CPCOMMONDAT2.INC".
      *
           COPY    "CPCOMMONDAT2.INC"
                                   REPLACING  //RECE01//
                                   BY         //RECE04//.
      *
           COPY    "CPCOMMONDAT2.INC"
                                   REPLACING  //RECE01//
                                   BY         //RECE05//.
      *
           COPY    "CPCOMMONDAT2.INC"
                                   REPLACING  //RECE01//
                                   BY         //RECE06//.
      *
      *    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë Ì¾¾ÎÎÎ°è 
           COPY    "CPCOMMONDAT2.INC"
                                   REPLACING  //RECE01PARA//
                                   BY         //RECEERR//.
           03  FILLER              PIC X(04)   VALUE   ".dat".
      *     
      *    ¥Õ¥é¥°ÎÎ°è
       01  STS-AREA.
           03  SPA-STS             PIC 9(04).
           03  SPA-ERRCD           PIC X(04).
           03  STS-RECE            PIC X(02).
           03  STS-RECE02          PIC X(02).
           03  STS-PARA            PIC X(02).
           03  STS-RECEERR         PIC X(02).
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-END             PIC 9(01).
           03  FLG-RECE02          PIC 9(01).
           03  FLG-RECE04          PIC 9(01).
           03  FLG-RECE05          PIC 9(01).
           03  FLG-SP              PIC 9(01).
      *     03  FLG-LAST            PIC 9(01).
           03  FLG-NOPRT           PIC 9(01).
           03  FLG-SYOSIN          PIC 9(01).
           03  FLG-KEIKNRKSN       PIC 9(01).
           03  FLG-TENSU           PIC 9(01).
           03  FLG-KENSA           PIC 9(01).
           03  FLG-TEIGEN          PIC 9(01).
           03  FLG-COMMENT         PIC 9(01).
           03  FLG-COMMENT2        PIC 9(01).
           03  FLG-COMMENT3        PIC 9(01).                           
           03  FLG-HIKAKIN         PIC 9(01).
           03  FLG-DSAISHIN        PIC 9(01).
           03  FLG-SRYCD1          PIC 9(01).
           03  FLG-OK              PIC 9(01).
      *
      *    ¥«¥¦¥ó¥ÈÎÎ°è
       01  CNT-AREA.
           03  CNT-RECE02          PIC 9(06).
           03  CNT-RECE04          PIC 9(06).
           03  CNT-RECE05          PIC 9(06).
           03  CNT-RECE06          PIC 9(06).
      *
           03  CNT-SRYKBN60        PIC 9(03).     
      *
           03  CNT-SYOSIN-KASAN    PIC 9(02).                           
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDW                 PIC 9(04). 
           03  IDX                 PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDZ                 PIC 9(04).
      *    ÅÀ¿ô²ó¿ôÊÔ½¸ÍÑ     
           03  IDA                 PIC 9(04).
           03  IDB                 PIC 9(04).
      *    ºÞ¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÊÌÊÔ½¸ÍÑ     
           03  IDX1                PIC 9(04).
           03  IDX2                PIC 9(04).
      *     
           03  WRK-SYU-INDEX       PIC 9(04).
           03  WRK-YKZ-INDEX       PIC 9(04).
           03  WRK-KIZ-INDEX       PIC 9(04).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-PARA.
               05  WRK-PARA-SRYYM              PIC  X(06).
               05  WRK-PARA-TERMID             PIC  X(16).
               05  WRK-PARA-SYSYMD             PIC  X(08).
               05  WRK-PARA-JOBID              PIC  9(07).
               05  WRK-PARA-SHELLID            PIC  X(08).
      *
           03  WRK-RECEERR         PIC X(200).
      *
           03  WRK-LINENUM         PIC 9(05).
      *
           03  WRK-TENSUGOKEI      PIC 9(07).
      *    ºÞ°õ»ú¹Ô¿ô
           03  WRK-TBLMAX          PIC 9(03).
      *    ºÞÌÀºÙÁí¿ô¡Ê¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÊÌ¡Ë
           03  WRK-ZAIWMAX-G.
               05  WRK-ZAIWMAX     PIC 9(03)   OCCURS  6.
      *    ºÞ°õ»úÂÐ¾Ý¿ô
           03  CNT-ZAITAISYO       PIC 9(03).
      * 
           03  WRK-YUKOKETA        PIC  9(02).
           03  WRK-NAME            PIC  X(200).
      *
           03  WRK-RECE05          PIC 9(01).     
      *
      *    ¿ô»úÈ¾³ÑÁ´³ÑÊÑ´¹ÍÑ     
           03  WRK-NUM                         PIC 9(01).
           03  WRK-CHAR-IDX                    PIC 9(02).
           03  WRK-CHAR-HENKAN-AREA.
               05  WRK-CHAR-X                  PIC X(10).
               05  WRK-CHAR-N                  PIC X(20).
               05  WRK-CHAR-CNT                PIC 9(02).
               05  WRK-CHAR-FLG                PIC 9(01). 
               05  WRK-CHAR-N-CNT              PIC 9(02).
      *
           03  WRK-EDIT-AREA.
               05  WRK-CLM                     PIC 9(03).
               05  WRK-WCLM                    PIC 9(03).
      *
           03  WRK-KOUI                        PIC X(210).
      *
           03  WRK-ZAI.
               05  WRK-ZAI-MK                  PIC X(02).
               05  WRK-ZAI-NAME.
                   07  FILLER                  PIC X(28).
                   07  WRK-ZAI-TNSKAI          PIC X(22).
      *
           03  WRK-TNSKAI.
               05  WRK-ZAITEN                  PIC X(14).
               05  WRK-X                       PIC X(02).
               05  WRK-ZAIKAISU                PIC X(06).
      *
           03  WRK-ZAITEN-SYOSIN               PIC 9(08).
           03  WRK-ZAITENX                     PIC ZZZZZZ9.
           03  WRK-ZAIKAISUX                   PIC ZZ9.
           03  WRK-TNSKAI-ST                   PIC 9(02).
           03  WRK-TNSKAI-KETA                 PIC 9(02).
      *
           03  WRK-SRYCD                       PIC X(01).
      *     
           03  WRK-R05IDX                      PIC 9(02).
      *
      *    ¸¡ºº¤Î²ó¿ô
           03  WRK-KENSA-KAISU                 PIC 9(05). 
      *     
           03  WRK-WLINETEK                    PIC 9(03).
           03  WRK-SRYSURYOW                   PIC X(20).
           03  WRK-ZAIIDX                      PIC 9(03).
           03  WRK-NAMEKETA                    PIC 9(03).
           03  WRK-YOHAKU                      PIC 9(03).
           03  WRK-WKETA                       PIC 9(03).
      *    Ê¬²è¿ôÊÔ½¸ÍÑ     
           03  WRK-BUNKAKUKETA                 PIC 9(02).
           03  WRK-BUNKAKU-N                   PIC X(06).
           03  WRK-SRYKAISU-X                  PIC ZZ9.
      *    ¿ôÎÌÊÔ½¸ÍÑ     
           03  WRK-SURYOKETA                   PIC 9(02).
           03  WRK-SURYOKETA1                  PIC 9(02).
           03  WRK-SURYOKETA2                  PIC 9(02).
           03  WRK-SURYOST                     PIC 9(02).
           03  WRK-SURYO                       PIC 9(05)V9(03).
           03  WRK-SURYO-R  REDEFINES  WRK-SURYO.
               05  WRK-SURYO-S1                PIC 9(05).
               05  WRK-SURYO-S2                PIC 9(03).
           03  WRK-SURYO-X.
               05  WRK-SURYO-Z1                PIC ZZZZZ.
               05  WRK-SURYO-Z2                PIC X(01).
               05  WRK-SURYO-Z3                PIC ZZZ.
           03  WRK-SURYO-N.
               05  WRK-SURYO-N1                PIC X(10).
               05  WRK-SURYO-N2                PIC X(02).
               05  WRK-SURYO-N3                PIC X(06).
      *    ºÞ¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÊÌÊÔ½¸ÍÑ     
           03  WRK-WIDX1                       PIC 9(03).
           03  WRK-WIDX2                       PIC 9(03).
      *     
           03  WRK-SRYKBN                      PIC X(02).
           03  WRK-Z9                          PIC ZZZ9.
      *****03  WRK-IN                          PIC X(01).
      *
      *
       01  WRK-HENSYU-AREA.
           03  WRK-HENYMDG         PIC X(22).
           03  WRK-HENYMD.
               05  WRK-HGO         PIC X(01).
               05  WRK-HYY         PIC Z9.
               05  FILLER          PIC X(01)   VALUE  ".".
               05  WRK-HMM         PIC Z9.
               05  FILLER          PIC X(01)   VALUE  ".".
               05  WRK-HDD         PIC Z9.
      *
           03  WRK-HENTIME.
               05  WRK-THH         PIC 99.
               05  FILLER          PIC X(01)   VALUE  ":".
               05  WRK-TMM         PIC 99.
      *
      *    ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë
       01  TBL-ZAI-AREA.
           03  TBL-ZAI      OCCURS 100  PIC X(52).
      *
      *    ¸¡ºº¤ò¤Þ¤È¤á¤ë¥Æ¡¼¥Ö¥ë
       01  WRK-KAISU-G.
           03  WRK-KAKSU-OCC               OCCURS  4.
               05  WRK-KAISU               PIC 9(03).  
           03  WRK-KAISU1                  PIC 9(02).
       01  WRK-HOUKNSKBN                   PIC 9(01).
       01  WRK-KNSJISKBN                   PIC 9(01).
       01  WRK-KOHBUNRI                    PIC 9(01).
      *
       01  WRK-RECE04-ZAITEN               PIC 9(08). 
      *         
       01  WRK-RECE04-MAX                  PIC 9(03).
       01  WRK-SUM-KAISU-TABLE.
           03  WRK-SUM-KAISU               PIC 9(04)
                                                  OCCURS  31.
       01  WRK-RECE04-FLG-TABLE.
           03  WRK-RECE04-FLG              PIC 9(01)
                                                  OCCURS  100.
       01  WRK-RECE04-TABLE.
           03  WRK-RECE04-TBL              OCCURS  100.
               05  WRK-RECE04-HOUKNSKBN           PIC 9(01).
               05  WRK-RECE04-KOHBUNRI            PIC 9(01).
               05  WRK-RECE04-REC                 PIC X(500).
               05  WRK-RECE04-DAY-AREA.
                   07  WRK-RECE04-DAY-TBL         OCCURS  4.
                       09  WRK-RECE04-KAISUINF    OCCURS  31.
                           11  WRK-RECE04-KAISU   PIC  9(03).
      *             
      *    ¸¡ºº¤Î¤È¤­Å¬ÍÑ¤ÎÊÔ½¸¤Ë»ÈÍÑ
       01  WRK-KENSA-MAX                   PIC 9(04).
       01  TBL-NAME-AREA.
           03  TBL-NAME-REC      OCCURS 100.
               05  TBL-SRYCD               PIC  X(09).
               05  TBL-SRYSURYO            PIC  9(05)V9(03).
      *        Ã±°Ì¥³¡¼¥É/Ã±°ÌÌ¾¾ÎÍ­¸ú·å¿ô/Ã±°ÌÌ¾¾Î
               05  TBL-TANICD              PIC  9(03).
               05  TBL-TANIMOJISU          PIC  9(01).
               05  TBL-TANINAME            PIC  X(24).
               05  TBL-NAMEINF.
      *            ´Á»úÍ­¸ú·å¿ô/´Á»úÌ¾¾Î
                   07  TBL-YUKOKETA        PIC  9(02).
                   07  TBL-NAME            PIC  X(200).
      *
      *     ¸¡ºº¤Î¹àÌÜ¿ôÍÑ
        01  WRK-KOUMOKUSU               PIC 9(02). 
        01  WRK-TNS-HOUKNSKBN           PIC 9(02).
        01  WRK-CONS-KENSACOMMENT-AREA.
            03  WRK-CONS-KENSACOMMENT-G.
                05  FILLER                 PIC X(50)   VALUE
                "·ì±Õ²½³Ø¸¡ºº".                        
                05  FILLER                 PIC X(50)   VALUE
                "ÆâÊ¬Èç³ØÅª¸¡ºº".                        
                05  FILLER                 PIC X(50)   VALUE
                "´Î±ê¥¦¥¤¥ë¥¹´ØÏ¢¸¡ºº".                        
                05  FILLER                 PIC X(50)   VALUE
                "¼ðáç¥Þ¡¼¥«¡¼¤Î¤¦¤Á¦Á¡Ý¥Õ¥§¥È¥×¥í¥Æ¥¤¥óÅù".                        
                05  FILLER                 PIC X(50)   VALUE
                "¼ðáç¥Þ¡¼¥«¡¼".                        
                05  FILLER                 PIC X(50)   VALUE
                "½Ð·ì¡¦¶Å¸Ç¸¡ºº".                        
                05  FILLER                 PIC X(50)   VALUE
                "¼«¸Ê¹³ÂÎ¸¡ºº".                        
                05  FILLER                 PIC X(50)   VALUE
                "ÆâÊ¬ÈçÉé²Ù»î¸³".                        
            03  WRK-CONS-KENSACOMMENT-R    REDEFINES
                                           WRK-CONS-KENSACOMMENT-G.
                05  WRK-CONS-KENSACOMMENT  PIC X(50)   OCCURS  8.
      *          
       01  TBL-ZAIW-AREA.
      *    ºÞ¤ÎÀèÆ¬¤Î¿ÇÎÅ¥³¡¼¥É
           03  TBL-ZAIW-SRYCD1             PIC X(09).
      *     
      *    ¿ÇÎÅ¹Ô°ÙÊÌ¥Æ¡¼¥Ö¥ë
      *    £±¡§¥æ¡¼¥¶¡¼¥³¥á¥ó¥È¡¢£²¡§¥³¥á¥ó¥È¡¢
      *    £³¡§¿ÇÎÅ¹Ô°Ù¡¢£´¡§ÌôºÞ¡¢£µ¡§ÆÃÄê´ïºà                     
           03  TBL-ZAIW-OCC                OCCURS 5.  
               05  TBL-ZAIW-REC            OCCURS 100.
                   07  TBL-ZAIW-SRYACTINF.
      *                ¿ÇÎÅ¥³¡¼¥É/¿ôÎÌ/²ó¿ô
                       09  TBL-ZAIW-SRYCD           PIC  X(09).
                       09  TBL-ZAIW-SRYSURYO        PIC  9(05)V9(03).
                       09  TBL-ZAIW-SRYKAISU        PIC  9(03).
      *                Ã±°Ì¥³¡¼¥É/Ã±°ÌÌ¾¾ÎÍ­¸ú·å¿ô/Ã±°ÌÌ¾¾Î
                       09  TBL-ZAIW-TANICD          PIC  9(03).
                       09  TBL-ZAIW-TANIMOJISU      PIC  9(01).
                       09  TBL-ZAIW-TANINAME        PIC  X(24).
      *                ÅÀ¿ô¼±ÊÌ¶èÊ¬/ÅÀ¿ô/ÌÀºÙÀÁµá¥Õ¥é¥°
                       09  TBL-ZAIW-TENSIKIBETU     PIC  9(01).
                       09  TBL-ZAIW-TEN             PIC  9(09)V9(02).
                       09  TBL-ZAIW-MEISKYFLG       PIC  X(01).
      *                ¼«Æ°»»Äê¶èÊ¬/Ì¾¾ÎÆþÎÏÈÖ¹æ/ÅÀ¿ôÍó½¸·×Àè¼±ÊÌ
                       09  TBL-ZAIW-AUTOKBN         PIC  X(01).
                       09  TBL-ZAIW-INPUTNUM        PIC  9(03).
                       09  TBL-ZAIW-TENTTLKBN       PIC  9(03).
                   07  TBL-ZAIW-NAMEINF.
      *                ´Á»úÍ­¸ú·å¿ô/´Á»úÌ¾¾Î
                       09  TBL-ZAIW-YUKOKETA        PIC  9(02).
                       09  TBL-ZAIW-NAME            PIC  X(200).
      *
       01  TBL-ZAI-MAX         PIC  9(03)  VALUE   100.              
      *
      *   ÆüËÜ¸ì¿ô»ú
       01  TBL-SUJI-AREA.
           03  FILLER          PIC X(20)   VALUE
              "£±£²£³£´£µ£¶£·£¸£¹£°".
       01  TBL-SUJI-R          REDEFINES   TBL-SUJI-AREA.
           03  TBL-SUJI        PIC X(02)   OCCURS   10.
      *
      *   °õ»ú¤·¤Ê¤¤¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë
       01  TBL-NOSRYCD-AREA.
      *    ½é¿Ç¡ÊÉÂ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "111000110".
      *    ½é¿Ç¡Ê¿ÇÎÅ½ê¡Ë
           03  FILLER          PIC X(09)   VALUE   "111003610".
      *    ½é¿Ç¡ÊÉÂ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "111700110".
      *    ½é¿Ç¡Ê¿ÇÎÅ½ê¡Ë
           03  FILLER          PIC X(09)   VALUE   "111700210".
      *    ºÆ¿Ç¡ÊÆýÍÄ»ù¡Ë²Ã»»
      ***     03  FILLER          PIC X(09)   VALUE   "112000970".
      *    ºÆ¿Ç¡ÊÍÄ»ù¡Ë²Ã»»
      ***     03  FILLER          PIC X(09)   VALUE   "112001070".
      *    »þ´Ö³°¡ÊºÆ¿Ç¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112001110".
      *    µÙ¿Ç¡ÊºÆ¿Ç¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112001210".
      *    ¿¼Ìë¡ÊºÆ¿Ç¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112001310".
      *    ³°Íè´ÉÍý²Ã»»
      ***     03  FILLER          PIC X(09)   VALUE   "112005610".
      *    ºÆ¿Ç¡ÊÆýÍÄ»ù¡Ë¡Ê»þ´Ö³°Åù¡Ë²Ã»»
      ***     03  FILLER          PIC X(09)   VALUE   "112006970".
      *    ºÆ¿Ç¡ÊÍÄ»ù¡Ë¡Ê»þ´Ö³°Åù¡Ë²Ã»»
      ***     03  FILLER          PIC X(09)   VALUE   "112007070".
      *    ·ÑÂ³´ÉÍý²Ã»»
      **** 03  FILLER          PIC X(09)   VALUE   "112007170".
      *    »þ´Ö³°¡ÊºÆ¿Ç¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112701010".
      *    µÙÆü¡ÊºÆ¿Ç¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112701110".
      *    ¿¼Ìë¡ÊºÆ¿Ç¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112701210".
      *    ·ÑÂ³´ÉÍý²Ã»»
      *    03  FILLER          PIC X(09)   VALUE   "112702270".
      *    ½èÊýÎÁ¡Ê£·¼ïÎà°Ê¾å¡Ë
           03  FILLER          PIC X(09)   VALUE   "120002610".
      *    ½èÊýÎÁ¡Ê¤½¤ÎÂ¾¡Ë
           03  FILLER          PIC X(09)   VALUE   "120001210".
      *    ½èÊýÎÁ¡ÊËã¡¦¸þ¡¦³Ð¡¦ÆÇ¡Ë
           03  FILLER          PIC X(09)   VALUE   "120001310".
      *    Ä´´ð¡Ê¤½¤ÎÂ¾¡Ë
           03  FILLER          PIC X(09)   VALUE   "120001810".
      *    Ä´´ð¡ÊÆþ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "120001710".
      *    Ä´ºÞ¡¦½èÊýÎÁ¡ÊËã¡¦¸þ¡¦³Ð¡¦ÆÇ¡Ë
           03  FILLER          PIC X(09)   VALUE   "120002030".
      *    Ä´ºÞÎÁ¡Ê³°ÍÑÌô¡Ë
           03  FILLER          PIC X(09)   VALUE   "120001010".
      *    Ä´ºÞÎÁ¡ÊÆâÍÑÌô¡¦¿»ÀùÌô¡¦ÆÜÉþÌô¡Ë
           03  FILLER          PIC X(09)   VALUE   "120000710".
      *    Ä´ºÞÎÁ¡ÊÆþ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "120001110".
      *    Ä´ºÞÎÁ¡ÊËã¡¦¸þ¡¦³Ð¡¦ÆÇ¡Ë¡ÊÆþ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "120000410".
      *    Ä´ºÞÎÁ¡ÊËã¡¦¸þ¡¦³Ð¡¦ÆÇ¡Ë¡ÊÆþ±¡³°¡Ë
           03  FILLER          PIC X(09)   VALUE   "120000110".
      *    ºÆ¿Ç¡Ê£±²óÌÜ¡Ë
           03  FILLER          PIC X(09)   VALUE   "112009210".
      *    Æ±ÆüºÆ¿Ç¡Ê£±²óÌÜ¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112010150".
      *    ÅÅÏÃÅùºÆ¿Ç¡Ê£±²óÌÜ¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112009750".
      *    Æ±ÆüÅÅÏÃÅùºÆ¿Ç¡Ê£±²óÌÜ¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112010650".
      *    Ï·¿ÍºÆ¿Ç¡Ê£±²óÌÜ¡Ë
           03  FILLER          PIC X(09)   VALUE   "112703710".
      *    Ï·¿ÍÆ±ÆüºÆ¿Ç¡Ê£±²óÌÜ¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112704450".
      *    Ï·¿ÍÅÅÏÃÅùºÆ¿Ç¡Ê£±²óÌÜ¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112704150".
      *    Ï·¿ÍÆ±ÆüÅÅÏÃÅùºÆ¿Ç¡Ê£±²óÌÜ¡Ë
      ***     03  FILLER          PIC X(09)   VALUE   "112704850".
      *    ³°Íè´ÉÍý²Ã»»¡Ê£³²óÌÜ¤Þ¤Ç¡Ë
           03  FILLER          PIC X(09)   VALUE   "112011010".
      *    Ï·¿Í³°Íè´ÉÍý²Ã»»¡Ê£³²óÌÜ¤Þ¤Ç¡Ë
           03  FILLER          PIC X(09)   VALUE   "112705310".
      *    ¼ÂÆü¿ô»»Äê
           03  FILLER          PIC X(09)   VALUE   "099409901".
      *    ½é¿ÇÎÁ¥À¥ß¡¼
           03  FILLER          PIC X(09)   VALUE   "099110001".
      *    ºÆ¿ÇÎÁ¥À¥ß¡¼
           03  FILLER          PIC X(09)   VALUE   "099120001".
      *    ½é¿ÇÎÁ»»Äê²Ê¡§
           03  FILLER          PIC X(09)   VALUE   "830000020".
      *    ºÆ¿ÇÎÁ»»Äê²Ê¡§
           03  FILLER          PIC X(09)   VALUE   "830000021".
       01  TBL-NOSRYCD-R       REDEFINES   TBL-NOSRYCD-AREA.
            03  TBL-NOSRYCD     PIC X(09)   OCCURS   24.       
      *
       01  TBL-NOSRYCD-MAX     PIC 9(02)   VALUE   24.         
      *
      *    ¸ÇÄêÃÍ
       01  CONST-AREA.
      *    ²èÁü¿ÇÃÇ¤ÎÃ±°Ì¤ÎÊÑ¹¹¡ÊËç¢ª²ó¡Ë
           03  WRK-CONS-TANICD PIC 9(03)   VALUE   006.
           03  WRK-CONS-TANINAME
                               PIC X(02)   VALUE   "²ó".
           03  WRK-CONS-BUNKAKU-MOJISU
                               PIC 9(02)   VALUE   4.                    
           03  WRK-CONS-BUNKAKU
                               PIC X(04)   VALUE   "Ê¬²è".                          
      *    ·ÑÂ³´ÉÍý²Ã»»
           03  CONS-KEIZOKU    PIC X(09)   VALUE   "112007170".
           03  CONS-KEIZOKU1   PIC X(09)   VALUE   "112702270".
      *    ³°Íè´ÉÍý²Ã»»
           03  CONS-GAIRAI     PIC X(09)   VALUE   "112005610".
      *    ÌôºÞÎÁÄþ¸º
           03  CONS-TEIGEN     PIC X(09)   VALUE   "630010002".
      *    ÌôºÞ¡Ê¸º¡Ë
           03  CONS-YKZ20      PIC X(09)   VALUE   "820000047".
      *---- (01.00.05) LINE ADD START --------------------------------
      *¥Õ¥ê¡¼¥³¥á¥ó¥È
      *    ÅÅÏÃºÆ¿Ç¡Ê¡¡²ó¡Ë
           03  CONS-COMMENT1   PIC X(09)   VALUE   "840000001".
      *    Æ±ÆüÊ£¿ôºÆ¿Ç¡Ê¡¡²ó¡Ë 
           03  CONS-COMMENT2   PIC X(09)   VALUE   "840000002".
      *    ¥Õ¥ê¡¼¥³¥á¥ó¥È 
           03  CONS-COMMENT3   PIC X(09)   VALUE   "810000001".
      *    Ê£¿ô¿ÇÎÅ²Ê¼õ¿Ç
           03  CONS-COMMENT4   PIC X(09)   VALUE   "099999901".
      *    ½¸ÃÄ¸¡¿Ç¤«¤é
           03  CONS-COMMENT5   PIC X(09)   VALUE   "820000003".
      *    Ï·¿Í¸¡¿Ç¤«¤é
           03  CONS-COMMENT6   PIC X(09)   VALUE   "820000004".
      *    ³Ø¹»¸¡¿Ç¤«¤é
           03  CONS-COMMENT7   PIC X(09)   VALUE   "820000005".
      *    ·ò¹¯¿ÇÃÇ¤«¤é
           03  CONS-COMMENT8   PIC X(09)   VALUE   "820000006".
      *---- (01.00.05) LINE ADD END   --------------------------------
      *---- (01.01.07) LINE ADD START --------------------------------
      *Æ±ÆüºÆ¿Ç´Ø·¸
      *    ¡ÚÏ·¡ÛÆ±ÆüºÆ¿Ç¡Ê¿ÇÎÅ½ê¡Ë
           03  CONS-DSAISHIN1  PIC X(09)   VALUE   "112700850".
      *    Æ±ÆüºÆ¿Ç¡Ê¿ÇÎÅ½ê¡Ë 
           03  CONS-DSAISHIN2  PIC X(09)   VALUE   "112003350".
      *    ¡ÚÏ·¡ÛÆ±ÆüÅÅÏÃÅùºÆ¿Ç¡Ê¿ÇÎÅ½ê¡Ë
           03  CONS-DSAISHIN3  PIC X(09)   VALUE   "112700950".
      *    Æ±ÆüÅÅÏÃÅùºÆ¿Ç¡Ê¿ÇÎÅ½ê¡Ë
           03  CONS-DSAISHIN4  PIC X(09)   VALUE   "112003150".
      *---- (01.01.07) LINE ADD END   --------------------------------
      *Èé²¼¶ÚÆùÃí¼Í
           03  CONS-HIKAKIN    PIC X(09)   VALUE   "130000510".
      *½é¿Ç²Ã»»     
      *    ½é¿Ç¡Ê¿ÇÎÅ½ê¡Ë¾Ò²ð´µ¼Ô²Ã»»
           03  WRK-CONS-SYOSIN-KASAN1  PIC X(09)   VALUE 
                                                   "111003770".                
      *    Ï·¿Í½é¿Ç¡Ê¿ÇÎÅ½ê¡Ë¾Ò²ð´µ¼Ô²Ã»»
           03  WRK-CONS-SYOSIN-KASAN2  PIC X(09)   VALUE 
                                                   "111700470".
      ***  ½é¿Ç¡ÊÆýÍÄ»ù¡Ë²Ã»»
      ***  03  WRK-CONS-SYOSIN-KASAN3  PIC X(09)   VALUE 
      ***                                          "111000370".
      ***  ½é¿Ç¡Ê°é»ù±ÉÍÜ»ØÆ³¡Ë²Ã»»
      ***  03  WRK-CONS-SYOSIN-KASAN4  PIC X(09)   VALUE 
      ***                                          "111000470".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê½é¿Ç»þ¿ÇÎÅ»þ¤Î¾Ò²ð´µ¼Ô¡Ë²Ã»»
           03  WRK-CONS-SYOSIN-KASAN5  PIC X(09)   VALUE 
                                                   "111010370".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê¾Ò²ð´µ¼Ô²Ã»»£³¡Ë
           03  WRK-CONS-SYOSIN-KASAN6  PIC X(09)   VALUE 
                                                   "111010870".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê¾Ò²ð´µ¼Ô²Ã»»£´¡Ë
           03  WRK-CONS-SYOSIN-KASAN7  PIC X(09)   VALUE 
                                                   "111010970".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê¾Ò²ð´µ¼Ô²Ã»»£µ¡Ë
           03  WRK-CONS-SYOSIN-KASAN8  PIC X(09)   VALUE 
                                                   "111011070".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê¾Ò²ð´µ¼Ô²Ã»»£¶¡Ë
           03  WRK-CONS-SYOSIN-KASAN9  PIC X(09)   VALUE 
                                                   "111011170".
      *    ¾Ò²ð´µ¼Ô²Ã»»£±¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN10 PIC X(09)   VALUE 
                                                   "111011270".
      *    ¾Ò²ð´µ¼Ô²Ã»»£²¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN11 PIC X(09)   VALUE 
                                                   "111011370".
      *    ¾Ò²ð´µ¼Ô²Ã»»£³¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN12 PIC X(09)   VALUE 
                                                   "111009970".
      *    ¾Ò²ð´µ¼Ô²Ã»»£´¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN13 PIC X(09)   VALUE 
                                                   "111010070".
      *    ¾Ò²ð´µ¼Ô²Ã»»£µ¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN14 PIC X(09)   VALUE 
                                                   "111010170".
      *    ¾Ò²ð´µ¼Ô²Ã»»£¶¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN15 PIC X(09)   VALUE 
                                                   "111010270".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£±¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN16 PIC X(09)   VALUE 
                                                   "111702770".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£²¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN17 PIC X(09)   VALUE 
                                                   "111702870".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£³¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN18 PIC X(09)   VALUE 
                                                   "111702370".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£´¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN19 PIC X(09)   VALUE 
                                                   "111702470".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£µ¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN20 PIC X(09)   VALUE 
                                                   "111702570".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£¶¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN-KASAN21 PIC X(09)   VALUE 
                                                   "111702670".
      *
      *    ¸¡ºº¤Î²ó¿ô¤Ë½¸·×¤·¤Ê¤¤¿ÇÎÅ¹Ô°Ù
      *    ºÎ·ì¡Ê£Â¡Ý£Á¡Ë
           03  WRK-CONS-SAIKETSU1      PIC X(09)   VALUE "160101210".
      *    ºÎ·ì¡Ê£Â¡Ý£Ö¡Ë
           03 WRK-CONS-SAIKETSU2       PIC X(09)   VALUE "160095710".
      *    ºÎ·ì¡Ê£Â¡Ý£Ã¡Ë
           03 WRK-CONS-SAIKETSU3       PIC X(09)   VALUE "160095810".
      *
      *    ¥Õ¥£¥ë¥àÎÁ¡ÊÆýÍÄ»ù¡Ë²Ã»»
           03  WRK-CONS-FILM-YOUJI-KASAN
                                       PIC X(09)   VALUE 
                                                   "799990070".
      *    »ÀÁÇÊäÀµÎ¨
           03  WRK-CONS-SANSO          PIC X(09)   VALUE 
                                                   "770020070".
      *    ¹âµ¤°µ»ÀÁÇ²Ã»»
           03  WRK-CONS-SANSO2         PIC X(09)   VALUE 
                                                   "770030070".
      *
      *    ¥Ñ¥¹Ì¾ÎÎ°è
       01  WRK-PATH                        PIC X(64).
      *
           COPY    "MCPAREA".
      *
           COPY    "COMMON-SPA".
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥¸¥ç¥Ö´ÉÍý¥Þ¥¹¥¿
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *    ÅÀ¿ô
           COPY    "CPTENSU.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑÎÎ°è
      *****************************************************************
      *   ¥¸¥ç¥Ö´ÉÍý£Ä£ÂÀ©¸æ¥µ¥Ö
           COPY    "CPORCSJOBKANRI.INC".
      *     
      *    ¿ôÃÍÊÑ´¹¥µ¥Ö
           COPY    "CPORCSNUM.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
           COPY    "CPORCMCP.INC".
      *
      ****************************************************************
       LINKAGE                 SECTION.
       01  COMMAND-PARAM.
           02  FILLER      PIC X(256).
      ****************************************************************
       PROCEDURE           DIVISION
               USING
           COMMAND-PARAM.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC
                   UNTIL       SPA-STS     =   2
      *
           PERFORM 300-END-SEC
      *
           STOP    RUN
           .
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  SPA-AREA
           INITIALIZE                  FLG-AREA
           INITIALIZE                  STS-AREA
           INITIALIZE                  WRK-AREA
           INITIALIZE                  CNT-AREA
           INITIALIZE                  TBL-ZAI-AREA
           INITIALIZE                  TBL-ZAIW-AREA
      *
      *    ¥Õ¥¡¥¤¥ë£Ï£Ð£Å£Î½èÍý
      *
           PERFORM 110-FILE-OPEN-SEC
           PERFORM 120-DBOPEN-SEC
      *
      *    ¥¹¥Æ¥Ã¥×´ÉÍý³«»Ï½èÍý
           MOVE    "STS"           TO  SJOBKANRI-MODE
           INITIALIZE                  JOBKANRI-REC
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
           MOVE    "ORCR0090"      TO  JOB-PGID
           MOVE    "Å¦Í×ÍóÊÔ½¸"    TO  JOB-SHELLMSG
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA  
                                   JOBKANRI-REC
      *
           PERFORM 990-RECE02-READ-SEC
           .
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë£Ï£Ð£Å£Î½èÍý
      *****************************************************************
       110-FILE-OPEN-SEC          SECTION.
      *
           MOVE    COMMAND-PARAM       TO  WRK-PARA
      *
           MOVE    "RECE020"           TO  RECE01PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE01PARA-TERMID
      *
           MOVE    "RECE041"           TO  RECE04PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE04PARA-TERMID
      *
           MOVE    "RECE051"           TO  RECE05PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE05PARA-TERMID
      *
           MOVE    "RECE060"           TO  RECE06PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE06PARA-TERMID
      *
           MOVE    "RECEERR"           TO  RECEERR-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECEERR-TERMID
      *
           OPEN    I-O                 RECE02-FILE
      *
           OPEN    INPUT               RECE04-FILE
      *
           OPEN    INPUT               RECE05-FILE
      *
           OPEN    OUTPUT              RECE066-FILE
           CLOSE                       RECE066-FILE
      *
           OPEN    I-O                 RECE06-FILE
      *
           .
       110-FILE-OPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
      *    ¹Ô¥«¥¦¥ó¥¿½é´ü²½
           MOVE    ZERO                TO  WRK-LINENUM
      *    ¸¡ºº²ó¿ô½é´ü²½
           MOVE    ZERO                TO   WRK-KENSA-KAISU
      *
           MOVE    ZERO                TO  CNT-SRYKBN60   
           INITIALIZE                      WRK-RECE04-TABLE
                                           WRK-RECE04-MAX 
                                           WRK-SUM-KAISU-TABLE
      *
      *    ¥Ñ¥é¥á¡¼¥¿£°£´¥Õ¥¡¥¤¥ë¤è¤êÊÔ½¸
           INITIALIZE                      RECE04-REC
           MOVE    RECE02-HOSPID       TO  RECE04-HOSPID
           MOVE    RECE02-SRYYM        TO  RECE04-SRYYM
           MOVE    RECE02-NYUGAIKBN    TO  RECE04-NYUGAIKBN
           MOVE    RECE02-PTID         TO  RECE04-PTID
           MOVE    RECE02-RECEKA       TO  RECE04-RECEKA
           MOVE    RECE02-TEISYUTUSAKI TO  RECE04-TEISYUTUSAKI
           MOVE    RECE02-RECESYUBETU  TO  RECE04-RECESYUBETU
           MOVE    RECE02-HKNJANUM-KEY TO  RECE04-HKNJANUM
           MOVE    RECE02-HOJOKBN-KEY  TO  RECE04-HOJOKBN
           MOVE    RECE02-TEKSTYMD     TO  RECE04-TEKSTYMD
           MOVE    ZERO                TO  RECE04-ZAINUM
      *
           START   RECE04-FILE
               KEY IS    >=   RECE04-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE04
               NOT INVALID
                   PERFORM 990-RECE04-NEXT-SEC
           END-START
           PERFORM
               UNTIL  ( SPA-STS              =   2                   )
               OR     ( FLG-RECE04           =   1                   )
               OR     ( RECE02-HOSPID    NOT =   RECE04-HOSPID       )
               OR     ( RECE02-SRYYM     NOT =   RECE04-SRYYM        )
               OR     ( RECE02-NYUGAIKBN NOT =   RECE04-NYUGAIKBN    )
               OR     ( RECE02-PTID      NOT =   RECE04-PTID         )
               OR     ( RECE02-RECEKA    NOT =   RECE04-RECEKA       )
               OR     ( RECE02-TEISYUTUSAKI
                                         NOT =   RECE04-TEISYUTUSAKI )
               OR     ( RECE02-RECESYUBETU
                                         NOT =   RECE04-RECESYUBETU  )
               OR     ( RECE02-HKNJANUM-KEY
                                         NOT =   RECE04-HKNJANUM     )
               OR     ( RECE02-HOJOKBN-KEY
                                         NOT =   RECE04-HOJOKBN      )
               OR     ( RECE02-TEKSTYMD  NOT =   RECE04-TEKSTYMD     )
      *
               MOVE    ZERO                  TO  FLG-SRYCD1
      *
               INITIALIZE                      TBL-ZAIW-AREA
               MOVE    ZERO                TO  WRK-ZAIWMAX-G
               MOVE    ZERO                TO  WRK-TBLMAX
               MOVE    ZERO                TO  WRK-TENSUGOKEI
               MOVE    ZERO                TO  FLG-SYOSIN
      *****    MOVE    RECE04-SRYKBN       TO  WRK-SRYKBN
               MOVE    ZERO                TO  FLG-TEIGEN
                                               FLG-COMMENT
                                               FLG-COMMENT2
                                               FLG-COMMENT3             
                                               FLG-HIKAKIN 
               MOVE    ZERO                TO  WRK-RECE05
                                               IDY                           
      *         
               PERFORM 2002-TBLZAIW-TAIHI-SEC
      *
      *        ¥ì¥»¥×¥È£°£´ºÞÊÔ½¸Á°½èÍý
               PERFORM 2001-RECE04-ZAIHEN-MAE-SEC
      *
               IF      SPA-STS          =   ZERO
      * 
      *            ¥ì¥»¥×¥È£°£´¥Õ¥¡¥¤¥ëÊÔ½¸½èÍý
                   EVALUATE    RECE04-SRYKBN
      *                ½é¿Ç
                       WHEN    "11"
                           PERFORM 2003-SRYKBN11-HENSYU-SEC
      *                ºÆ¿Ç
                       WHEN    "12"
                           PERFORM 2004-SRYKBN12-HENSYU-SEC
      *                ¸¡ºº
                       WHEN    "60"
                           PERFORM 2006-SRYKBN60-CHECK-SEC 
      *                ¤½¤ì°Ê³°
                       WHEN    OTHER
                           PERFORM 2005-SRYKBNELSE-HENSYU-SEC
                   END-EVALUATE
      *
                   ADD     1               TO  CNT-RECE04
      *
                   PERFORM 990-RECE04-NEXT-SEC
               END-IF     
           END-PERFORM
      *
      *    ¸¡ºº¤¬¤¢¤ë¤È¤­¤Þ¤È¤á¤ë
           IF      WRK-RECE04-MAX          >   ZERO
               PERFORM 2007-SRYKBN60-HENSYU-SEC
           END-IF         
      *
      *    ¸¡ºº¤Î¤È¤­²ó¿ô¤òÊÔ½¸¤¹¤ë
           IF      WRK-KENSA-KAISU        >   ZERO
               MOVE    WRK-KENSA-KAISU        TO  RECE02-KAISU  (29)
               REWRITE RECE02-REC
           END-IF
      *
           PERFORM 990-RECE02-READ-SEC
      *
           .
       200-MAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È£°£´¤è¤êºÞÊÔ½¸Á°½èÍý
      *****************************************************************
       2001-RECE04-ZAIHEN-MAE-SEC     SECTION.
      *
           MOVE    SPACE               TO  WRK-ZAI
           MOVE    "¡ö"                TO  WRK-ZAI-MK
           MOVE    ZERO                TO  WRK-CLM
      *    ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È
           MOVE    RECE04-ZAITEN       TO  WRK-ZAITENX
           MOVE    RECE04-ZAIKAISU     TO  WRK-ZAIKAISUX
      *    É¬Í×Í­¸ú·å¿ô¡¦³«»Ï°ÌÃÖ¡¦²ó¿ôÊÔ½¸
           PERFORM 810-TENSUKAI-HEN-SEC
      *
           .
       2001-RECE04-ZAIHEN-MAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÞ¡¡ÌÀºÙ¥Æ¡¼¥Ö¥ëÂàÈò½èÍý
      *****************************************************************
       2002-TBLZAIW-TAIHI-SEC    SECTION.
      *
      *    ¥Ñ¥é¥á¡¼¥¿£°£µ¥Õ¥¡¥¤¥ë¤è¤êÊÔ½¸
           INITIALIZE                      RECE05-REC
           MOVE    RECE04-HOSPID       TO  RECE05-HOSPID
           MOVE    RECE04-SRYYM        TO  RECE05-SRYYM
           MOVE    RECE04-NYUGAIKBN    TO  RECE05-NYUGAIKBN
           MOVE    RECE04-PTID         TO  RECE05-PTID
           MOVE    RECE04-RECEKA       TO  RECE05-RECEKA
           MOVE    RECE04-TEISYUTUSAKI TO  RECE05-TEISYUTUSAKI
           MOVE    RECE04-RECESYUBETU  TO  RECE05-RECESYUBETU
           MOVE    RECE04-HKNJANUM     TO  RECE05-HKNJANUM
           MOVE    RECE04-HOJOKBN      TO  RECE05-HOJOKBN
           MOVE    RECE04-TEKSTYMD     TO  RECE05-TEKSTYMD
           MOVE    RECE04-ZAINUM       TO  RECE05-ZAINUM
           START   RECE05-FILE
               KEY IS    >=   RECE05-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE05
               NOT INVALID
                   PERFORM 990-RECE05-NEXT-SEC
           END-START
           PERFORM
               UNTIL  ( SPA-STS              =   2                   )
               OR     ( FLG-RECE05           =   1                   )
               OR     ( RECE04-HOSPID    NOT =   RECE05-HOSPID       )
               OR     ( RECE04-SRYYM     NOT =   RECE05-SRYYM        )
               OR     ( RECE04-NYUGAIKBN NOT =   RECE05-NYUGAIKBN    )
               OR     ( RECE04-PTID      NOT =   RECE05-PTID         )
               OR     ( RECE04-RECEKA    NOT =   RECE05-RECEKA       )
               OR     ( RECE04-TEISYUTUSAKI
                                         NOT =   RECE05-TEISYUTUSAKI )
               OR     ( RECE04-RECESYUBETU
                                         NOT =   RECE05-RECESYUBETU  )
               OR     ( RECE04-HKNJANUM  NOT =   RECE05-HKNJANUM     )
               OR     ( RECE04-HOJOKBN   NOT =   RECE05-HOJOKBN      )
               OR     ( RECE04-TEKSTYMD  NOT =   RECE05-TEKSTYMD     )
               OR     ( RECE04-ZAINUM    NOT =   RECE05-ZAINUM       )
      *
               PERFORM   VARYING   IDX   FROM    1   BY  1
                         UNTIL   ( IDX               >   5     )
                         OR      ( RECE05-SRYCD(IDX) =   SPACE )
                         OR      ( SPA-STS           =   2     ) 
      *
                   IF      RECE05-SRYCD (IDX) (1:1)  =   "1"
                       CONTINUE
                   ELSE
                       MOVE    1                     TO  FLG-SRYCD1
                   END-IF
      *                     
                   IF      RECE04-SRYKBN     <   "31"
                       MOVE    1             TO  IDY
                   ELSE                          
                       EVALUATE    RECE05-SRYCD (IDX) (1:1)
                           WHEN    "0"
                             IF      RECE05-SRYCD (IDX) (1:3) = "059"
                                 IF     ( RECE04-SRYKBN     =   "70" )
                                 AND    ( RECE05-DATAKBN (IDX)
                                                              =   "3")
                                     MOVE    3             TO  IDY
                                 ELSE
                                     MOVE    4             TO  IDY
                                 END-IF
                             ELSE
                                 IF      IDY           =   ZERO
                                     MOVE    1             TO  IDY
                                 END-IF
                           END-IF    
                           WHEN    "8"
                               IF      IDY           =   ZERO
                                   MOVE    2             TO  IDY
                               END-IF    
                           WHEN    "1"
                               MOVE    3             TO  IDY
                           WHEN    "6"
                               MOVE    5             TO  IDY
                           WHEN    "7"
                               IF    ( RECE04-SRYKBN     =   "70" )
                               AND   ( RECE05-DATAKBN (IDX)
                                                         =   "3"  )
                                   MOVE    3                 TO  IDY
                               ELSE
                                   IF      RECE05-SRYCD (IDX)    =
                                             WRK-CONS-FILM-YOUJI-KASAN
                                       MOVE    3             TO  IDY
                                   ELSE
                                       MOVE    4             TO  IDY
                                   END-IF
                               END-IF
                           WHEN    OTHER
                               DISPLAY "ORCR0090 SRYCD="
                                                 RECE05-SRYCD (IDX) 
                               MOVE    "¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¤¬ÈÏ°Ï³°¤Ç¤¹"
                                                 TO  WRK-RECEERR
                               PERFORM 500-ERR-HENSYU-SEC
                               MOVE    2             TO  SPA-STS
                               GO  TO  2002-TBLZAIW-TAIHI-EXT
                       END-EVALUATE
                   END-IF            
                   ADD     1                 TO  WRK-ZAIWMAX (IDY)
                                                 WRK-ZAIWMAX (6)
                   IF      WRK-ZAIWMAX (IDY) >   TBL-ZAI-MAX 
                       MOVE    "¥Æ¡¼¥Ö¥ë¤¬¥ª¡¼¥Ð¡¼¤·¤Þ¤·¤¿"
                                                 TO  WRK-RECEERR
                       PERFORM 500-ERR-HENSYU-SEC
                       MOVE    2                 TO  SPA-STS
                       GO  TO  2002-TBLZAIW-TAIHI-EXT
                   ELSE
      *                ÀèÆ¬¤Î¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÊÔ½¸              
                       IF      WRK-RECE05        =   ZERO
                         IF  RECE05-SRYCD(IDX)(1:1)  =  "8" OR "0"
                           CONTINUE
                         ELSE
                           MOVE    RECE05-SRYCD (IDX)
                                                 TO  TBL-ZAIW-SRYCD1 
                           MOVE    1             TO  WRK-RECE05
                         END-IF
                       END-IF
      *                                                         
                       MOVE    WRK-ZAIWMAX (IDY) TO  IDZ
                       MOVE    RECE05-SRYACTINF (IDX)
                                     TO  TBL-ZAIW-SRYACTINF (IDY IDZ)
                       MOVE    RECE05-NAMEINF   (IDX)
                                     TO  TBL-ZAIW-NAMEINF   (IDY IDZ)
                       IF      RECE05-SRYCD (IDX) (1:1)
                                                 =   "1"
                       AND     RECE04-SRYKBN     =   "70"
                       AND     RECE05-TANICD(IDX)
                                                 =   WRK-CONS-TANICD
                           MOVE    WRK-CONS-TANINAME TO 
                                         TBL-ZAIW-TANINAME  (IDY IDZ) 
                       END-IF                     
      *
                       IF      RECE05-SRYCD (IDX) (1:1)  =  "7"
                          IF    ( RECE04-SRYKBN     =   "70" )
                          AND   ( RECE05-DATAKBN (IDX)
                                                    =   "3"  )
                            IF  TBL-ZAIW-TANINAME  (IDY IDZ)  
                                                    =   SPACE
                                  MOVE    "¡ö"  TO 
                                         TBL-ZAIW-TANINAME  (IDY IDZ) 
                            END-IF
                          ELSE
                            IF      RECE05-SRYCD (IDX)    =
                                     WRK-CONS-FILM-YOUJI-KASAN  OR
                                     WRK-CONS-SANSO             OR
                                     WRK-CONS-SANSO2
                               CONTINUE
                            ELSE
                               IF  TBL-ZAIW-TANINAME  (IDY IDZ)  
                                                    =   SPACE
                                  MOVE    "¡ö"  TO 
                                         TBL-ZAIW-TANINAME  (IDY IDZ) 
                               END-IF
                            END-IF
                          END-IF
                       END-IF
      *
      *---- (01.00.05) LINE ADD START --------------------------------
                       IF      RECE05-SRYCD(IDX) =   CONS-COMMENT1   OR
                                                     CONS-COMMENT2   OR
                                                     CONS-COMMENT3   OR
                                                     CONS-COMMENT4   
                           MOVE    1             TO  FLG-COMMENT
                       END-IF 
                       IF      RECE05-SRYCD(IDX) =   CONS-COMMENT5   OR
                                                     CONS-COMMENT6   OR
                                                     CONS-COMMENT7   OR
                                                     CONS-COMMENT8     
                           MOVE    1             TO  FLG-COMMENT2      
                       END-IF                                          
                       IF      RECE05-SRYCD(IDX)(1:1)   =   "8"         
                           MOVE    1             TO  FLG-COMMENT3       
                       END-IF                                           
      *---- (01.00.05) LINE ADD END --------------------------------
      *
                       IF      RECE05-SRYCD(IDX) =   CONS-TEIGEN
                           MOVE    1             TO  FLG-TEIGEN
                       END-IF
                       IF      RECE04-SRYKBN     =   "31"
                       AND     RECE05-SRYCD(IDX) =   CONS-HIKAKIN
                           MOVE    1             TO  FLG-HIKAKIN
                       END-IF  
                   END-IF
               END-PERFORM
               ADD     1                 TO  CNT-RECE05
      *
               PERFORM 990-RECE05-NEXT-SEC
           END-PERFORM
      *
           .
       2002-TBLZAIW-TAIHI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¶èÊ¬¡Ê£±£±¡ËÊÔ½¸½èÍý
      *****************************************************************
       2003-SRYKBN11-HENSYU-SEC    SECTION.
      *
      *    ºÞ¡¡ÌÀºÙ¥Æ¡¼¥Ö¥ë¥Á¥§¥Ã¥¯
           INITIALIZE                    TBL-ZAI-AREA
           MOVE    ZERO              TO  WRK-TBLMAX
           MOVE    ZERO              TO  WRK-TENSUGOKEI
           MOVE    ZERO              TO  CNT-ZAITAISYO
           MOVE    ZERO              TO  CNT-SYOSIN-KASAN               
           MOVE    ZERO              TO  WRK-ZAITEN-SYOSIN
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL   IDX1    >       1  
               PERFORM VARYING IDX2    FROM    1   BY  1
                         UNTIL IDX2    >   WRK-ZAIWMAX (IDX1)  
                   MOVE    IDX1          TO  WRK-WIDX1
                   MOVE    IDX2          TO  WRK-WIDX2
                   PERFORM 20031-SRYKBN11-CHECK-SEC
                   IF  FLG-NOPRT         =   ZERO
      *            ¥ì¥»¥×¥È£°£µºÞÊÔ½¸½èÍý
                       PERFORM 430-TBLZAI-HEN-SEC
                   END-IF
               END-PERFORM
           END-PERFORM    
      *
           IF  WRK-TBLMAX           >   ZERO
      *********ºÞÌÀºÙ¿ô¤È°õ»úÂÐ¾ÝÌÀºÙ¿ô¤¬°Û¤Ê¤ë¾ì¹ç
      *********IF  WRK-ZAIWMAX(1)   NOT =   RECE04-MEISAISU
      *********    PERFORM 400-TENSU-SAIKEISAN-SEC
      *********END-IF
      *        ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È½èÍý
               MOVE    WRK-TBLMAX       TO  IDY
               PERFORM 440-TNSKAI-SET-SEC
               MOVE    IDY              TO  WRK-TBLMAX
      *        ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë½ÐÎÏ½èÍý
               PERFORM 450-RECE06-OUT-SEC
           END-IF
      *
           .
       2003-SRYKBN11-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙ°õ»ú¥Á¥§¥Ã¥¯ ¿ÇÎÅ¶èÊ¬¡Ê£±£±¡Ë ½èÍý
      *****************************************************************
       20031-SRYKBN11-CHECK-SEC        SECTION.
      * 
           MOVE    ZERO          TO  FLG-NOPRT
      *
      *    ÉþÍÑÊýË¡¤Ç¤Ê¤¤¤³¤È
           IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:3)   =   "001"
               MOVE    1             TO  FLG-NOPRT
           END-IF
      *
      *    ¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤ËÂ¸ºß¤·¤¿¾ì¹ç¡¢°õ»ú¤·¤Ê¤¤¤³¤È
           PERFORM   VARYING   IDY   FROM    1   BY  1
                     UNTIL   ( IDY           >   TBL-NOSRYCD-MAX )
                     OR      ( FLG-NOPRT     =    1              )
      *
               IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
                                             =   TBL-NOSRYCD (IDY)
                   MOVE    1                 TO  FLG-NOPRT
      *            ¡ö½é¿Ç¤Î¾ì¹ç
                   IF  TBL-NOSRYCD (IDY)     =   "111000110"
                                             OR  "111003610"
                                             OR  "111700110"
                                             OR  "111700210"
                       MOVE    1             TO  FLG-SYOSIN
      *                °ì¤Ä¤ÎºÞ¤ËÂ¾¤ÎÌÀºÙ¤âÂ¸ºß¤¹¤ë¾ì¹ç
                       IF  RECE04-MEISAISU       >   1
                           MOVE    ZERO          TO  FLG-NOPRT
                       END-IF
                   END-IF
               END-IF
           END-PERFORM
      *
      *    ½é¿Ç²Ã»»¤Î»þ¤À¤±°õºþ¡Ü¸¡¿Ç
           IF      FLG-NOPRT                 =   ZERO
               IF    (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)              
                                            =   WRK-CONS-SYOSIN-KASAN1
                                            OR  WRK-CONS-SYOSIN-KASAN2
      ***                                   OR  WRK-CONS-SYOSIN-KASAN3
      ***                                   OR  WRK-CONS-SYOSIN-KASAN4
                                            OR  WRK-CONS-SYOSIN-KASAN5
                                            OR  WRK-CONS-SYOSIN-KASAN6
                                            OR  WRK-CONS-SYOSIN-KASAN7
                                            OR  WRK-CONS-SYOSIN-KASAN8
                                            OR  WRK-CONS-SYOSIN-KASAN9
                                            OR  WRK-CONS-SYOSIN-KASAN10
                                            OR  WRK-CONS-SYOSIN-KASAN11
                                            OR  WRK-CONS-SYOSIN-KASAN12
                                            OR  WRK-CONS-SYOSIN-KASAN13
                                            OR  WRK-CONS-SYOSIN-KASAN14
                                            OR  WRK-CONS-SYOSIN-KASAN15
                                            OR  WRK-CONS-SYOSIN-KASAN16
                                            OR  WRK-CONS-SYOSIN-KASAN17
                                            OR  WRK-CONS-SYOSIN-KASAN18
                                            OR  WRK-CONS-SYOSIN-KASAN19
                                            OR  WRK-CONS-SYOSIN-KASAN20
                                            OR  WRK-CONS-SYOSIN-KASAN21
                                            OR  CONS-COMMENT5         
                                            OR  CONS-COMMENT6         
                                            OR  CONS-COMMENT7         
                                            OR  CONS-COMMENT8         ) 
               OR    (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:1)  = "8") 
      *
                   IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)             
                                             =   WRK-CONS-SYOSIN-KASAN1 
                                             OR  WRK-CONS-SYOSIN-KASAN2 
      ***                                    OR  WRK-CONS-SYOSIN-KASAN3 
      ***                                    OR  WRK-CONS-SYOSIN-KASAN4 
                                             OR  WRK-CONS-SYOSIN-KASAN5 
                                             OR  WRK-CONS-SYOSIN-KASAN6 
                                             OR  WRK-CONS-SYOSIN-KASAN7 
                                             OR  WRK-CONS-SYOSIN-KASAN8 
                                             OR  WRK-CONS-SYOSIN-KASAN9 
                                             OR  WRK-CONS-SYOSIN-KASAN10
                                             OR  WRK-CONS-SYOSIN-KASAN11
                                             OR  WRK-CONS-SYOSIN-KASAN12
                                             OR  WRK-CONS-SYOSIN-KASAN13
                                             OR  WRK-CONS-SYOSIN-KASAN14
                                             OR  WRK-CONS-SYOSIN-KASAN15
                                             OR  WRK-CONS-SYOSIN-KASAN16
                                             OR  WRK-CONS-SYOSIN-KASAN17
                                             OR  WRK-CONS-SYOSIN-KASAN18
                                             OR  WRK-CONS-SYOSIN-KASAN19
                                             OR  WRK-CONS-SYOSIN-KASAN20
                                             OR  WRK-CONS-SYOSIN-KASAN21
                        ADD      1           TO  CNT-SYOSIN-KASAN       
                   END-IF                                               
      *
                   MOVE    TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
                                             TO  TNS-SRYCD
                   MOVE    TNS-TENSU-REC     TO  MCPDATA-REC
                   MOVE    RECE04-SRYYM      TO  ORC-DBYMD(1:6)         
                   MOVE    "01"              TO  ORC-DBYMD(7:2)
                   PERFORM 900-TENSU-INV-SEC
      *            ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È
                   IF    TNS-TEN  NOT =  ZERO                           
                     ADD     TNS-TEN           TO  WRK-ZAITEN-SYOSIN
                     MOVE    WRK-ZAITEN-SYOSIN TO  WRK-ZAITENX
      ***************MOVE    TNS-TEN           TO  WRK-ZAITENX
                     MOVE    RECE04-ZAIKAISU   TO  WRK-ZAIKAISUX        
      *              É¬Í×Í­¸ú·å¿ô¡¦³«»Ï°ÌÃÖ¡¦²ó¿ôÊÔ½¸
                     PERFORM 810-TENSUKAI-HEN-SEC                       
                   END-IF                                               
               ELSE    
                   MOVE    1                 TO  FLG-NOPRT
               END-IF
           END-IF                                          
      *
      *    ¼±ÊÌ¤¬ÅÀ¿ô¤Î¾ì¹ç
           IF  FLG-NOPRT                     =   ZERO
               IF      TBL-ZAIW-TENSIKIBETU (WRK-WIDX1 WRK-WIDX2)
                                             =   3
                   ADD     TBL-ZAIW-TEN (WRK-WIDX1 WRK-WIDX2)
                                             TO  WRK-TENSUGOKEI
               END-IF
           END-IF
      *
           .
       20031-SRYKBN11-CHECK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È£°£´¥Õ¥¡¥¤¥ë  ¿ÇÎÅ¶èÊ¬¡Ê£±£²¡ËÊÔ½¸½èÍý
      *****************************************************************
       2004-SRYKBN12-HENSYU-SEC    SECTION.
      *
      *    ºÞ¡¡ÌÀºÙ¥Æ¡¼¥Ö¥ë¥Á¥§¥Ã¥¯
           INITIALIZE                    TBL-ZAI-AREA
           MOVE    ZERO              TO  WRK-TBLMAX
           MOVE    ZERO              TO  WRK-TENSUGOKEI
           MOVE    ZERO              TO  CNT-ZAITAISYO
           MOVE    ZERO              TO  FLG-KEIKNRKSN
           MOVE    ZERO              TO  FLG-DSAISHIN
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL   IDX1    >       1  
                   OR     (FLG-KEIKNRKSN   =   1)
                   PERFORM VARYING IDX2    FROM    1   BY  1
                       UNTIL   IDX2    >   WRK-ZAIWMAX (IDX1)  
                       OR      FLG-KEIKNRKSN   =   1           
                   MOVE    IDX1          TO  WRK-WIDX1
                   MOVE    IDX2          TO  WRK-WIDX2
                   PERFORM 20041-SRYKBN12-CHECK-SEC
                   IF  FLG-NOPRT         =   ZERO
      *                ¥ì¥»¥×¥È£°£µºÞÊÔ½¸½èÍý
                       PERFORM 430-TBLZAI-HEN-SEC
                   END-IF
               END-PERFORM    
           END-PERFORM
      *
      *
      *    ------------------------
      *     ¿ÇÎÅ¶èÊ¬£±£²¡¡Îã³°½èÍý
      *    ------------------------
      *****ÅÀ¿ô¤¬ÉÔÌÀ¤À¤«¤éÌÀºÙ¤Ë°õ»ú¤¹¤ëÉ¬Í×¤¬¤¢¤ë
      *****IF  WRK-TBLMAX           =   ZERO
      ***  ºÆ¿Ç¤Î¤È¤­
           IF  ( RECE02-KHNTEN  (2)      =   ZERO )  AND
               ( RECE02-KAISU   (2)      >   ZERO )
                   CONTINUE
      *            PERFORM 20042-SRYKBN12-REIGAI-SEC
      ***  END-IF
           ELSE
      *        ·ÑÂ³´ÉÍý²Ã»»¤Î¤È¤­
               IF ((FLG-KEIKNRKSN     =   1)  OR
                   (FLG-DSAISHIN      =   1)) AND  
                   (WRK-TBLMAX        >   1) 
                   PERFORM 20042-SRYKBN12-REIGAI-SEC
               END-IF
           END-IF    
      *
           IF  WRK-TBLMAX           >   ZERO
      *        ºÞÌÀºÙ¿ô¤È°õ»úÂÐ¾ÝÌÀºÙ¿ô¤¬°Û¤Ê¤ë¾ì¹ç
               IF  RECE04-MEISAISU   NOT =   CNT-ZAITAISYO
                   PERFORM 400-TENSU-SAIKEISAN-SEC
               END-IF
      *        ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È½èÍý
               MOVE    WRK-TBLMAX       TO  IDY
               PERFORM 440-TNSKAI-SET-SEC
               MOVE    IDY              TO  WRK-TBLMAX
      *        ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë½ÐÎÏ½èÍý
               PERFORM 450-RECE06-OUT-SEC
           END-IF
      *
           .
       2004-SRYKBN12-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙ°õ»ú¥Á¥§¥Ã¥¯ ¿ÇÎÅ¶èÊ¬¡Ê£±£²¡Ë ½èÍý
      *****************************************************************
       20041-SRYKBN12-CHECK-SEC        SECTION.
      * 
           MOVE    ZERO              TO  FLG-NOPRT
      *
      *    ÉþÍÑÊýË¡¤Ç¤Ê¤¤¤³¤È
           IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:3)
                                     =   "001"
               MOVE    1                 TO  FLG-NOPRT
           END-IF
      *
      *    ¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤ËÂ¸ºß¤·¤¿¾ì¹ç¡¢°õ»ú¤·¤Ê¤¤¤³¤È
           PERFORM   VARYING   IDY   FROM    1   BY  1
                     UNTIL   ( IDY           >   TBL-NOSRYCD-MAX )
                     OR      ( FLG-NOPRT     =    1              )
               IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2) 
                                         =   TBL-NOSRYCD (IDY)
                   MOVE    1                 TO  FLG-NOPRT
      *            ¡öºÆ¿Ç¤Î¾ì¹ç
                   IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
                                         =   "112009210"  OR
                                             "112010150"  OR
                                             "112009750"  OR
                                             "112010650"  OR
                                             "112703710"  OR
                                             "112704450"  OR
                                             "112704150"  OR
                                             "112704850"
                     IF  RECE02-SAISHIN-PRTKBN   =   "1"
                         MOVE    ZERO          TO  FLG-NOPRT
                     END-IF
                   END-IF
      *            ¡ö³°Íè´ÉÍý²Ã»»¤Î¾ì¹ç
                   IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
                                         =   "112011010"  OR
                                             "112705310"
                     IF  RECE02-GAIRAIKSN-PRTKBN   =   "1"
                         MOVE    ZERO          TO  FLG-NOPRT
                     END-IF
                   END-IF
      *            °ì¤Ä¤ÎºÞ¤ËÂ¾¤ÎÌÀºÙ¤âÂ¸ºß¤¹¤ë¾ì¹ç
                   IF  RECE04-MEISAISU       >   1
                       MOVE    ZERO          TO  FLG-NOPRT
                   END-IF
      *            ¡öºÆ¿Ç¥À¥ß¡¼¤Î¾ì¹ç
                   IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)           
                                         =   "099120001"              
                       MOVE    1             TO  FLG-NOPRT            
                   END-IF                                             
               END-IF
           END-PERFORM
      *
           IF  FLG-NOPRT             =   ZERO
      *        ¼±ÊÌ¤¬ÅÀ¿ô¤Î¾ì¹ç
               IF  TBL-ZAIW-TENSIKIBETU (WRK-WIDX1 WRK-WIDX2)
                                     =   3
                   ADD     TBL-ZAIW-TEN (WRK-WIDX1 WRK-WIDX2)
                                         TO  WRK-TENSUGOKEI
               END-IF
      *        ·ÑÂ³´ÉÍý²Ã»»
      *********IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
      *                                  =   CONS-KEIZOKU    OR
      *                                      CONS-KEIZOKU1 
      *            MOVE    1                 TO  FLG-KEIKNRKSN
      *********END-IF
      *        Æ±ÆüºÆ¿Ç¡ÊÆ±ÆüÅÅÏÃºÆ¿Ç´Þ¤à¡Ë
               IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
                                         =   CONS-DSAISHIN1  OR
                                             CONS-DSAISHIN2  OR
                                             CONS-DSAISHIN3  OR
                                             CONS-DSAISHIN4
                   MOVE    1                 TO  FLG-DSAISHIN
               END-IF
           END-IF    
      *
           .
       20041-SRYKBN12-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¶èÊ¬£±£²¡¡Îã³°½èÍý
      *****************************************************************
       20042-SRYKBN12-REIGAI-SEC        SECTION.
      *
           MOVE    SPACE               TO  WRK-ZAI
           MOVE    "¡ö"                TO  WRK-ZAI-MK
           INITIALIZE                      TBL-ZAI-AREA
           MOVE    ZERO                TO  WRK-TBLMAX
           MOVE    ZERO                TO  WRK-TENSUGOKEI
           MOVE    ZERO                TO  CNT-ZAITAISYO
      *     
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL   IDX1    >       5  
               PERFORM VARYING IDX2    FROM    1   BY  1
                       UNTIL   IDX2    >   WRK-ZAIWMAX (IDX1)  
                   MOVE    IDX1          TO  WRK-WIDX1
                   MOVE    IDX2          TO  WRK-WIDX2
      *            ³°Íè´ÉÍý²Ã»»°Ê³°¤Ï°õ»ú
                   IF  TBL-ZAIW-SRYCD (IDX1 IDX2)  NOT =   CONS-GAIRAI
      *                ¥ì¥»¥×¥È£°£µºÞÊÔ½¸½èÍý
                       PERFORM 430-TBLZAI-HEN-SEC
                       ADD     TBL-ZAIW-TEN (IDX1 IDX2)
                                           TO  WRK-TENSUGOKEI
                   END-IF
               END-PERFORM
           END-PERFORM    
      *
           .
       20042-SRYKBN12-REIGAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È£°£´¥Õ¥¡¥¤¥ë  ¿ÇÎÅ¶èÊ¬¡Ê¤½¤ÎÂ¾¡ËÊÔ½¸½èÍý
      *****************************************************************
       2005-SRYKBNELSE-HENSYU-SEC    SECTION.
      *    ½èÊý¤Î¤È¤­
           IF  RECE04-SRYKBN         =   "25"
               IF    ( RECE02-KHNTEN  (19)     =   ZERO )  AND
                     ( WRK-ZAIWMAX    (6)      >   1    )
                   PERFORM 20042-SRYKBNELSE-REIGAI-SEC
               ELSE
                   PERFORM 20052-SRYKBNELSE-CHECK-SEC
               END-IF
           ELSE            
      *
      *        ¸¡ºº¤Î¤È¤­ºÞ¤¬°ì¤Ä°Ê¾å¤Ê¤é¡É¡¢¡É¤ÇÊÔ½¸
               IF  RECE04-SRYKBN         =   "60"
      *********AND  WRK-ZAIWMAX (6)      >   1
                   PERFORM 20051-SRYKBNELSE-KENSA-SEC
               ELSE 
                   PERFORM 20052-SRYKBNELSE-CHECK-SEC
               END-IF
           END-IF    
      *
           IF  WRK-TBLMAX           >   ZERO
      ********* --- ÌôºÞÅÀ¿ô20ÅÀ°Ê²¼¤Î¾ì¹ç ---¡ÊÆâÉþ¡Ë
      **       IF      RECE04-SRYKBN     =   "21" 
      **       AND     RECE04-ZAITEN     <=  20
      **           IF      TBL-ZAIW-SRYCD (1 1)
      **                                 NOT = CONS-TEIGEN
      ***              ÌÀºÙ¶õÇò½èÍý
      **               PERFORM 410-MEISAI-SPACE-SEC
      **           END-IF     
      **           IF      TBL-ZAIW-SRYCD1     =   CONS-YKZ20
      **               MOVE    TBL-ZAIW-NAME (1 1) TO  TBL-ZAI (1)(3:)
      **           END-IF    
      **       END-IF
      ***      --- ÌôºÞÅÀ¿ô20ÅÀ°Ê²¼¤Î¾ì¹ç ---¡ÊÆÜÉþ¡¦³°ÍÑ¡Ë
      **       IF  RECE04-SRYKBN         =   "22"  OR  "23"
      **       AND RECE04-ZAITEN         <=  20
      **       AND TBL-ZAIW-SRYCD (1 1)
      **                             NOT =   CONS-TEIGEN
      ***          ÌÀºÙ¶õÇò½èÍý
      **           PERFORM 410-MEISAI-SPACE-SEC
      *********END-IF
      *
               IF      RECE04-SRYKBN      >=  "33"
                   CONTINUE
               ELSE        
                   MOVE    WRK-TBLMAX       TO  IDY
                   PERFORM 440-TNSKAI-SET-SEC
                   MOVE    IDY              TO  WRK-TBLMAX
               END-IF    
      *        ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë½ÐÎÏ½èÍý
               PERFORM 450-RECE06-OUT-SEC
           END-IF
      *
           .
       2005-SRYKBNELSE-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÞ¡¡ÌÀºÙ¥Æ¡¼¥Ö¥ëÊÔ½¸¡¡ ¿ÇÎÅ¶èÊ¬¡Ê¤½¤ÎÂ¾¡Ë¸¡ºº¤Î¤È¤­½èÍý
      *****************************************************************
       20051-SRYKBNELSE-KENSA-SEC      SECTION.
      *
           MOVE    WRK-ZAIWMAX (3)     TO  WRK-KENSA-MAX
           MOVE    ZERO                TO  WRK-TNS-HOUKNSKBN
                                           WRK-KOUMOKUSU
      *     
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       WRK-ZAIWMAX (3)
               MOVE    TBL-ZAIW-NAMEINF (3 IDX)  TO  TBL-NAMEINF (IDX)
               MOVE    TBL-ZAIW-SRYSURYO(3 IDX)  TO  TBL-SRYSURYO(IDX)
               MOVE    TBL-ZAIW-TANICD  (3 IDX)  TO  TBL-TANICD  (IDX)
               MOVE    TBL-ZAIW-TANIMOJISU(3 IDX)
                                             TO  TBL-TANIMOJISU(IDX)
               MOVE    TBL-ZAIW-TANINAME(3 IDX)  TO  TBL-TANINAME(IDX)
               MOVE    TBL-ZAIW-SRYCD   (3 IDX)  TO  TBL-SRYCD   (IDX)
               IF      TBL-YUKOKETA (IDX)      =   ZERO
                   PERFORM VARYING IDZ FROM   200 BY  -1
                           UNTIL   IDZ <      1
                       IF      TBL-NAME (IDX) (IDZ:1)    NOT =   SPACE
                           COMPUTE TBL-YUKOKETA (IDX)    =
                                   IDZ     /   2
                           MOVE    1          TO  IDZ
                       END-IF
                   END-PERFORM
               END-IF             
           END-PERFORM
      ***  MOVE    TBL-ZAIW-SRYCD   (1)  TO  TBL-SRYCD
      *
           COMPUTE WRK-ZAIWMAX (6)   =   WRK-ZAIWMAX  (6)     -   
                                         WRK-ZAIWMAX  (3) 
           INITIALIZE                    TBL-ZAIW-OCC (3)
           MOVE    ZERO              TO  WRK-ZAIWMAX  (3)
      *
      *    ºÞ¤¬°ì¤Ä°Ê¾å¤Î¤È¤­¡Ç¡¢¡Ç¤ÇÌ¾¾Î¤òÊÔ½¸¤¹¤ë
      *
           MOVE    1                 TO  IDX
               
           PERFORM UNTIL   IDX     >       WRK-KENSA-MAX
               MOVE    TBL-SRYCD(IDX)       TO      TNS-SRYCD
               MOVE    TNS-TENSU-REC        TO      MCPDATA-REC
               MOVE    RECE04-SRYYM         TO      ORC-DBYMD(1:6)      
               MOVE    "01"                 TO      ORC-DBYMD(7:2)
               PERFORM 900-TENSU-INV-SEC
               IF      TNS-HOUKNSKBN        =   ZERO
                   ADD     1                        TO  WRK-ZAIWMAX (3)
                   MOVE    WRK-ZAIWMAX (3)          TO  IDZ
                   MOVE    TBL-NAMEINF (IDX)   TO
                                    TBL-ZAIW-NAMEINF (3 IDZ)
                   MOVE    TBL-SRYSURYO(IDX)   TO
                                    TBL-ZAIW-SRYSURYO(3 IDZ)
                   MOVE    TBL-TANICD  (IDX)   TO
                                    TBL-ZAIW-TANICD  (3 IDZ)
                   MOVE    TBL-TANIMOJISU(IDX) TO
                                    TBL-ZAIW-TANIMOJISU(3 IDZ)
                   MOVE    TBL-TANINAME(IDX)   TO
                                    TBL-ZAIW-TANINAME(3 IDZ)
                   MOVE    TBL-SRYCD   (IDX)   TO
                                    TBL-ZAIW-SRYCD   (3 IDZ)
                   ADD     1                   TO  IDX                     
               ELSE
                   IF      IDX             =   1
                       MOVE    TNS-HOUKNSKBN    
                                           TO  WRK-TNS-HOUKNSKBN         
                   END-IF                                
                   MOVE    ZERO            TO  WRK-YUKOKETA
                   MOVE    SPACE           TO  WRK-NAME
                   MOVE    TBL-SRYCD (IDX) TO  WRK-SRYCD
                   PERFORM     UNTIL   IDX >       WRK-KENSA-MAX
                               OR      TBL-SRYCD (IDX) (1:1)
                                           NOT =   WRK-SRYCD
      *                ¼¡¤ÎÌ¾¾Î¤¬¤¢¤ë¤È¤­¡É¡¢¡É¡ÜÌ¾¾Î¤ò¤Ä¤±¤ë
                       IF      WRK-YUKOKETA    >   ZERO
                           STRING  WRK-NAME    DELIMITED  BY  SPACE
                                   "¡¤"        DELIMITED  BY  SIZE
                                   INTO        WRK-NAME
                           END-STRING        
                           ADD     2           TO  WRK-YUKOKETA
      *              
                           COMPUTE IDZ     =   WRK-YUKOKETA        +
                                               TBL-YUKOKETA (IDX)  *  2
                           IF      IDZ             >   38
                               ADD     1               TO
                                                   WRK-ZAIWMAX (3)
                               MOVE    WRK-ZAIWMAX (3) TO  IDZ
                               MOVE    WRK-NAME        TO
                                           TBL-ZAIW-NAME(3 IDZ)
                               COMPUTE TBL-ZAIW-YUKOKETA (3 IDZ) 
                                           =   WRK-YUKOKETA   /   2  
                               MOVE    SPACE           TO  WRK-NAME
                               MOVE    ZERO            TO  WRK-YUKOKETA
                           END-IF
                       END-IF
      *
                       IF      TBL-YUKOKETA (IDX)  >   19
                           ADD     1               TO  WRK-ZAIWMAX (3)
                           MOVE    WRK-ZAIWMAX (3) TO  IDZ
                           MOVE    TBL-NAME (IDX) (1:38)   TO
                                       TBL-ZAIW-NAME    (3 IDZ)
                           MOVE    19                      TO  
                                       TBL-ZAIW-YUKOKETA(3 IDZ)
                           MOVE    TBL-NAME (IDX) (39:)    TO  WRK-NAME
                           COMPUTE WRK-YUKOKETA    =  
                                   ( TBL-YUKOKETA (IDX) -   19 )  *   2                                           
                       ELSE
                           STRING  WRK-NAME        DELIMITED  BY  SPACE
                                   TBL-NAME    (IDX)
                                                   DELIMITED  BY  SPACE
                                   INTO            WRK-NAME
                           END-STRING
                           COMPUTE WRK-YUKOKETA =  WRK-YUKOKETA   +
                                       TBL-YUKOKETA (IDX)  *   2
                       END-IF
      *                 
                       ADD     1           TO  IDX
                       ADD     1           TO  WRK-KOUMOKUSU 
                   END-PERFORM                            
                   ADD     1               TO  WRK-ZAIWMAX (3)
                   MOVE    WRK-ZAIWMAX (3) TO  IDZ
                   MOVE    WRK-NAME    TO  TBL-ZAIW-NAME (3 IDZ)
                   COMPUTE TBL-ZAIW-YUKOKETA (3 IDZ) 
                                       =   WRK-YUKOKETA   /   2
               END-IF                                        
           END-PERFORM
      *
      *    ¸¡ºº¤Î¹àÌÜ¿ô¤ò¥³¥á¥ó¥È¤Ë¥»¥Ã¥È
           IF      WRK-TNS-HOUKNSKBN  >   ZERO
               INITIALIZE                 WRK-CHAR-HENKAN-AREA
               MOVE    1                  TO  WRK-CHAR-FLG
      *********MOVE    WRK-KENSA-MAX      TO  WRK-Z9
               MOVE    WRK-KOUMOKUSU      TO  WRK-Z9
               MOVE    WRK-Z9 (3:2)       TO  WRK-CHAR-X
               MOVE    2                  TO  WRK-CHAR-CNT
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               ADD     1                  TO  WRK-ZAIWMAX (2)
                                              WRK-ZAIWMAX (6)
               MOVE    WRK-ZAIWMAX (2)    TO  IDZ   
               STRING  WRK-CONS-KENSACOMMENT (WRK-TNS-HOUKNSKBN)
                                          DELIMITED  BY  SPACE
                       "¡Ê"               DELIMITED  BY  SIZE
                       WRK-CHAR-N         DELIMITED  BY  SPACE
                       "¹àÌÜ¡Ë"           DELIMITED  BY  SIZE
                                          INTO    TBL-ZAIW-NAME (2 IDZ)
               PERFORM VARYING IDX FROM   200 BY  -1
                       UNTIL   IDX <      1
                   IF      TBL-ZAIW-NAME (2 IDZ) (IDX:1)
                                              NOT =   SPACE
                       COMPUTE TBL-ZAIW-YUKOKETA (2 IDZ)    =
                                                  IDX     /   2
                       MOVE    1          TO  IDX
                   END-IF
               END-PERFORM
               MOVE    "88888888"         TO  TBL-ZAIW-SRYCD(2 IDZ)
           END-IF                                    
      *
           COMPUTE WRK-ZAIWMAX (6)   =   WRK-ZAIWMAX  (6)     +   
                                         WRK-ZAIWMAX  (3) 
           MOVE    TBL-ZAIW-SRYCD1   TO  TBL-ZAIW-SRYCD (3 1) 
      *
           PERFORM 20052-SRYKBNELSE-CHECK-SEC
           .
       20051-SRYKBNELSE-KENSA-EXT.
           EXIT.
      *****************************************************************
      *    ºÞ¡¡ÌÀºÙ¥Æ¡¼¥Ö¥ë¥Á¥§¥Ã¥¯ ¿ÇÎÅ¶èÊ¬¡Ê¤½¤ÎÂ¾¡Ë ½èÍý
      *****************************************************************
       20052-SRYKBNELSE-CHECK-SEC      SECTION.
      *
           INITIALIZE                    TBL-ZAI-AREA
           MOVE    ZERO              TO  WRK-TBLMAX
           MOVE    ZERO              TO  WRK-TENSUGOKEI
           MOVE    ZERO              TO  CNT-ZAITAISYO
           MOVE    SPACE             TO  WRK-ZAI
           MOVE    "¡ö"              TO  WRK-ZAI-MK
      *     
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL   IDX1    >       5
               IF      RECE04-SRYKBN   <=   "33"
                   MOVE    "¡ö"            TO  WRK-ZAI-MK
               END-IF    
      *********IF      RECE04-SRYKBN     =   "31"  OR  "32"  OR  "33"
      **       AND     IDX1              =   5
      **       AND     RECE04-YKZTEN     <=  20
      **           CONTINUE
      *********ELSE    
                   IF   (( RECE04-SRYKBN     =   "31"  AND
                           FLG-HIKAKIN       =   1          )  OR 
                         ( RECE04-SRYKBN     =   "32"       )     )
                   AND  (  IDX1              =   3                )
                       CONTINUE
                   ELSE    
                       IF      RECE04-SRYKBN     =   "31"  AND
                               FLG-HIKAKIN       =   ZERO  AND
                               WRK-ZAIWMAX (3)   >   ZERO  AND
                               IDX1              >   3
                           MOVE    SPACE             TO  WRK-ZAI-MK
                       END-IF            
                       PERFORM VARYING IDX2    FROM    1   BY  1
                               UNTIL   IDX2    >   WRK-ZAIWMAX (IDX1)  
                           MOVE    ZERO          TO  FLG-NOPRT
                           MOVE    IDX1          TO  WRK-WIDX1
                           MOVE    IDX2          TO  WRK-WIDX2
                           PERFORM 200521-SEYKBNELSE-MEISAI-SEC
                           IF  FLG-NOPRT         =   ZERO
      *                        ¥ì¥»¥×¥È£°£µºÞÊÔ½¸½èÍý
                               PERFORM 430-TBLZAI-HEN-SEC
                           END-IF    
                       END-PERFORM
                   END-IF    
      *********END-IF
               IF      WRK-ZAIWMAX (IDX1)    >   ZERO        
                   MOVE    SPACE             TO  WRK-ZAI
               END-IF    
      *             
      *        ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È½èÍý¡Ê¿ÇÎÅ¹Ô°Ù¡Ë
               IF      IDX1              =   3
               AND     WRK-ZAIWMAX(IDX1) >   ZERO
                   IF      RECE04-SRYKBN     >=  "33"       
                       MOVE    RECE04-SYUTEN1    TO  WRK-ZAITENX
                       MOVE    RECE04-ZAIKAISU   TO  WRK-ZAIKAISUX
                       PERFORM 810-TENSUKAI-HEN-SEC
                       MOVE    WRK-TBLMAX        TO  IDY
                       PERFORM 440-TNSKAI-SET-SEC
                       MOVE    IDY               TO  WRK-TBLMAX 
                   END-IF
               END-IF    
      *        ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È½èÍý¡ÊÆÃÄê´ïºà¡Ë
               IF      IDX1              =   4
               AND     WRK-ZAIWMAX(IDX1) >   ZERO
                   IF      RECE04-SRYKBN     >=  "33"   
                       MOVE    RECE04-KIZAITEN   TO  WRK-ZAITENX
                       MOVE    RECE04-ZAIKAISU   TO  WRK-ZAIKAISUX
                       PERFORM 810-TENSUKAI-HEN-SEC
                       MOVE    WRK-TBLMAX        TO  IDY
                       PERFORM 440-TNSKAI-SET-SEC
                       MOVE    IDY               TO  WRK-TBLMAX 
                   END-IF
               END-IF     
      *        ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È½èÍý¡ÊÌôºÞ¡Ë
               IF      IDX1              =   5
               AND     WRK-ZAIWMAX(IDX1) >   ZERO
                   IF      RECE04-SRYKBN     >=  "31"   
      *****************IF      RECE04-SRYKBN     =   "31"    OR  
      **                                             "32"    OR  "33"  
      **               AND     RECE04-YKZTEN     <=  20
      **                   ADD     1                 TO  WRK-TBLMAX
      **                   MOVE    "¡ö"              TO
      **                               TBL-ZAI (WRK-TBLMAX)(1:2)
      *****************END-IF     
      *                ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È
                       IF      RECE04-SRYKBN     >=   "33"
                           MOVE    RECE04-YKZTEN     TO  WRK-ZAITENX
                           MOVE    RECE04-ZAIKAISU   TO  WRK-ZAIKAISUX
                           PERFORM 810-TENSUKAI-HEN-SEC
                           MOVE    WRK-TBLMAX        TO  IDY
                           PERFORM 440-TNSKAI-SET-SEC
                           MOVE    IDY               TO  WRK-TBLMAX 
                       END-IF          
                   END-IF
               END-IF        
           END-PERFORM
      *             
      *    ¸¡ºº¤Î¤È¤­²ó¿ô¤ò½¸·×
           IF      WRK-ZAIWMAX(3)     >   ZERO
           AND     RECE04-SRYKBN      =   "60"
               IF      TBL-ZAIW-SRYCD (3 1)   =   WRK-CONS-SAIKETSU1
                                              OR  WRK-CONS-SAIKETSU2
                                              OR  WRK-CONS-SAIKETSU3 
                   CONTINUE
               ELSE
                   MOVE    TBL-ZAIW-SRYCD (3 1)
                                             TO  TNS-SRYCD
                   MOVE    TNS-TENSU-REC     TO  MCPDATA-REC
                   MOVE    RECE04-SRYYM      TO  ORC-DBYMD(1:6)         
                   MOVE    "01"              TO  ORC-DBYMD(7:2)
                   PERFORM 900-TENSU-INV-SEC
                   IF      TNS-KNSJISKBN     =   "2"
                       CONTINUE
                   ELSE 
                       ADD     RECE04-ZAIKAISU   TO  WRK-KENSA-KAISU
                   END-IF
               END-IF
           END-IF     
      *
           .
       20052-SRYKBNELSE-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙ°õ»ú¥Á¥§¥Ã¥¯ ¿ÇÎÅ¶èÊ¬¡Ê¤½¤ÎÂ¾¡Ë ½èÍý
      *****************************************************************
       200521-SEYKBNELSE-MEISAI-SEC        SECTION.
      *
           MOVE    ZERO          TO  FLG-NOPRT
      *
      *    ÉþÍÑÊýË¡¤Ç¤Ê¤¤¤³¤È
           IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:3)
                                 =   "001"
               MOVE    1             TO  FLG-NOPRT
           END-IF
      *    ¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤ËÂ¸ºß¤·¤¿¾ì¹ç¡¢°õ»ú¤·¤Ê¤¤¤³¤È
           PERFORM   VARYING   IDY   FROM    1   BY  1
                     UNTIL   ( IDY           >   TBL-NOSRYCD-MAX )
                     OR      ( FLG-NOPRT     =    1 )
      *
               IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
                                =   TBL-NOSRYCD (IDY)
                   MOVE    1                 TO  FLG-NOPRT
               END-IF
           END-PERFORM
      *
           .
       200521-SEYKBNELSE-MEISAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¶èÊ¬¡Ê¤½¤ÎÂ¾¡Ë¡¡Îã³°½èÍý
      *****************************************************************
       20042-SRYKBNELSE-REIGAI-SEC        SECTION.
      *
           MOVE    SPACE               TO  WRK-ZAI
           MOVE    "¡ö"                TO  WRK-ZAI-MK
           INITIALIZE                    TBL-ZAI-AREA
           MOVE    ZERO              TO  WRK-TBLMAX
           MOVE    ZERO              TO  WRK-TENSUGOKEI
           MOVE    ZERO              TO  CNT-ZAITAISYO
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL   IDX1    >       5  
               PERFORM VARYING IDX2    FROM    1   BY  1
                       UNTIL   IDX2    >   WRK-ZAIWMAX (IDX1)  
                   MOVE    IDX1          TO  WRK-WIDX1
                   MOVE    IDX2          TO  WRK-WIDX2
      *            ¥ì¥»¥×¥È£°£µºÞÊÔ½¸½èÍý
                   PERFORM 430-TBLZAI-HEN-SEC
                   ADD     TBL-ZAIW-TEN (IDX IDX1) TO  WRK-TENSUGOKEI
               END-PERFORM    
           END-PERFORM
      *
           .
       20042-SRYKBNELSE-REIGAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸¡ºº¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       2006-SRYKBN60-CHECK-SEC         SECTION.
      *
      *    ÌôºÞ¤ä¥³¥á¥ó¥È¤¬¤¢¤ì¤Ð¤Þ¤È¤á¤Ê¤¤
           IF      FLG-SRYCD1          =   1
               PERFORM 2005-SRYKBNELSE-HENSYU-SEC
           ELSE
      *        ºÞ¤ÎÌÀºÙ¿ô¤¬£²°Ê¾å¤Î¤È¤­¤Ï¤Þ¤È¤á¤Ê¤¤
               IF      RECE04-MEISAISU     >   1
                   PERFORM 2005-SRYKBNELSE-HENSYU-SEC
               ELSE    
      *            Êñ³çÂÐ¾Ý¤Ç¤Ê¤¤¤È¤­¤Þ¤È¤á¤Ê¤¤         
                   MOVE    TBL-ZAIW-SRYCD (3 1) TO      TNS-SRYCD
                   MOVE    TNS-TENSU-REC        TO      MCPDATA-REC
                   MOVE    RECE04-SRYYM         TO      ORC-DBYMD(1:6)
                   MOVE    "01"                 TO      ORC-DBYMD(7:2)
                   PERFORM 900-TENSU-INV-SEC
                   IF      TNS-HOUKNSKBN        =   ZERO
                       PERFORM 2005-SRYKBNELSE-HENSYU-SEC
                   ELSE    
                       PERFORM 2006-SRYKBN60-TAIHI-SEC
                   END-IF
               END-IF
           END-IF        
           .
       2006-SRYKBN60-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸¡ºº¤Þ¤È¤áÂÐ¾ÝÂÔÈò½èÍý
      *****************************************************************
       2006-SRYKBN60-TAIHI-SEC         SECTION.
      *
           ADD     1               TO  WRK-RECE04-MAX
           MOVE    RECE04-REC      TO  WRK-RECE04-REC (WRK-RECE04-MAX)
           MOVE    RECE04-DAY-AREA TO  WRK-RECE04-DAY-AREA
                                                      (WRK-RECE04-MAX)
           MOVE    TNS-HOUKNSKBN   TO  WRK-RECE04-HOUKNSKBN
                                                      (WRK-RECE04-MAX)
           MOVE    RECE04-KOHBUNRI TO  WRK-RECE04-KOHBUNRI
                                                      (WRK-RECE04-MAX)
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       31
               ADD      RECE04-KAISU (1 IDX)    TO  WRK-SUM-KAISU (IDX)
           END-PERFORM                                                       
           .
       2006-SRYKBN60-TAIHI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸¡ºº¤Þ¤È¤á½èÍý
      *****************************************************************
       2007-SRYKBN60-HENSYU-SEC         SECTION.
      *
      *    ¸¡ºº¤ÎºÞ¤¬¤Ò¤È¤Ä¤Î¤È¤­¤Þ¤È¤á½èÍý¤Ï¤·¤Ê¤¤
      **      IF      WRK-RECE04-MAX      =   1
      **          MOVE    WRK-RECE04-REC (1)    TO  RECE04-REC
      **          IF      RECE04-ZAIKAISU       =   1
      **              MOVE    ZERO                  TO  FLG-SRYCD1
      *
      **             INITIALIZE                      TBL-ZAIW-AREA
      **             MOVE    ZERO                TO  WRK-ZAIWMAX-G
      **             MOVE    ZERO                TO  WRK-TBLMAX
      **             MOVE    ZERO                TO  WRK-TENSUGOKEI
      **             MOVE    ZERO                TO  FLG-SYOSIN
      *****    MOVE    RECE04-SRYKBN       TO  WRK-SRYKBN
      **             MOVE    ZERO                TO  FLG-TEIGEN
      **                                             FLG-COMMENT
      **                                             FLG-HIKAKIN 
      **             MOVE    ZERO                TO  WRK-RECE05
      **                                             IDY                           
      **             PERFORM 2002-TBLZAIW-TAIHI-SEC
      *            ¥ì¥»¥×¥È£°£´ºÞÊÔ½¸Á°½èÍý
      **             PERFORM 2001-RECE04-ZAIHEN-MAE-SEC
      *
      **             IF      SPA-STS          =   ZERO
      **                 PERFORM 20051-SRYKBNELSE-KENSA-SEC
      *                ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë½ÐÎÏ½èÍý
      **                 PERFORM 450-RECE06-OUT-SEC
      **             END-IF    
      **             GO  TO  2007-SRYKBN60-HENSYU-EXT
      **         END-IF    
      **     END-IF
      *     
      *    ¸¡ºº¤Î¤Þ¤È¤á½èÍý
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       31
               INITIALIZE                  WRK-RECE04-FLG-TABLE
                                           WRK-KAISU-G
                                           WRK-HOUKNSKBN
                                           WRK-KOHBUNRI
      *
               IF      WRK-SUM-KAISU (IDX)   >   ZERO
                   PERFORM VARYING IDY FROM    1   BY  1
                           UNTIL   IDY >       WRK-RECE04-MAX
                       IF      WRK-RECE04-KAISU (IDY 1 IDX)    
                                               >   ZERO
                           IF      WRK-KAISU (1)   =   ZERO
                               MOVE    WRK-RECE04-KAISU (IDY 1 IDX)
                                                   TO  WRK-KAISU (1)
                               MOVE    WRK-RECE04-KAISU (IDY 2 IDX)
                                                   TO  WRK-KAISU (2)
                               MOVE    WRK-RECE04-KAISU (IDY 3 IDX)
                                                   TO  WRK-KAISU (3)
                               MOVE    WRK-RECE04-KAISU (IDY 4 IDX)
                                                   TO  WRK-KAISU (4)
                               MOVE    WRK-RECE04-HOUKNSKBN (IDY)
                                                   TO  WRK-HOUKNSKBN                    
                               MOVE    WRK-RECE04-KOHBUNRI (IDY)
                                                   TO  WRK-KOHBUNRI                  
                           END-IF
                           IF      WRK-RECE04-KAISU (IDY 2 IDX)
                                                   =   WRK-KAISU (2)
                           AND     WRK-RECE04-KAISU (IDY 3 IDX)
                                                   =   WRK-KAISU (3)
                           AND     WRK-RECE04-KAISU (IDY 4 IDX)
                                                   =   WRK-KAISU (4)
                           AND     WRK-RECE04-HOUKNSKBN (IDY)
                                                   =   WRK-HOUKNSKBN
                           AND     WRK-RECE04-KOHBUNRI  (IDY)
                                                   =   WRK-KOHBUNRI
                               MOVE    ZERO        TO
                                           WRK-RECE04-KAISU (IDY 1 IDX)
                               COMPUTE WRK-SUM-KAISU (IDX) 
                                                   =
                                                   WRK-SUM-KAISU (IDX) - 
                                                   WRK-KAISU   (1)                                       
                               MOVE    "1"         TO  WRK-RECE04-FLG 
                                                       (IDY)
                           END-IF
                       END-IF
                   END-PERFORM
                   IF      WRK-KAISU (1)      >   ZERO
                       ADD     1                  TO  WRK-KAISU1
                   END-IF
      *
      *            Æ±¤¸¸¡ºº¤¬·î¤Ë²¿Æü¤¢¤ë¤«
                   COMPUTE IDX1    =   IDX     +   1
                   PERFORM VARYING IDZ FROM    IDX1    BY  1
                           UNTIL   IDZ >       31
                       MOVE    ZERO                TO  FLG-OK                            
                       PERFORM VARYING IDW FROM    1   BY  1
                               UNTIL   IDW >       WRK-RECE04-MAX
                               OR      FLG-OK      =   1
                           IF      WRK-RECE04-FLG   (IDW)  =   "1"
                               IF      WRK-RECE04-KAISU (IDW 2 IDZ)
                                                   =   WRK-KAISU (2)
                               AND     WRK-RECE04-KAISU (IDW 3 IDZ)
                                                   =   WRK-KAISU (3)
                               AND     WRK-RECE04-KAISU (IDW 4 IDZ)
                                                   =   WRK-KAISU (4)                  
                                   MOVE    2               TO  FLG-OK                                    
                               ELSE                    
                                   MOVE    1               TO  FLG-OK                                    
                               END-IF
                           END-IF
                       END-PERFORM
      *                Æ±¤¸¸¡ºº¤¬Æ±¤¸²ó¿ô¤ÇÁ´¤Æ¤¢¤ë¤È¤­                 
                       IF      FLG-OK          =   2
                           PERFORM VARYING IDW FROM    1   BY  1
                                   UNTIL   IDW >       WRK-RECE04-MAX
                               IF      WRK-RECE04-FLG   (IDW)  =   "1"
                                   MOVE    ZERO    TO  WRK-RECE04-KAISU
                                                      (IDW 1 IDZ)
                                   COMPUTE WRK-SUM-KAISU (IDZ) 
                                                   =
                                                   WRK-SUM-KAISU (IDZ) - 
                                                   WRK-KAISU   (1)                                       
                               END-IF
                           END-PERFORM
                           ADD     1              TO  WRK-KAISU1                                                               
                       END-IF  
                   END-PERFORM
      *
      *            Æ±¤¸¸¡ºº¤ò¤Þ¤È¤á¤Æ½ÐÎÏ¤¹¤ë
                   MOVE    ZERO                  TO  FLG-SRYCD1
      *
                   INITIALIZE                      TBL-ZAIW-AREA
                   MOVE    ZERO                TO  WRK-ZAIWMAX-G
                   MOVE    ZERO                TO  WRK-TBLMAX
                   MOVE    ZERO                TO  WRK-TENSUGOKEI
                   MOVE    ZERO                TO  FLG-SYOSIN
      *****        MOVE    RECE04-SRYKBN       TO  WRK-SRYKBN
                   MOVE    ZERO                TO  FLG-TEIGEN
                                                   FLG-COMMENT
                                                   FLG-COMMENT2
                                                   FLG-COMMENT3         
                                                   FLG-HIKAKIN 
                   MOVE    ZERO                TO  WRK-RECE05
                                                   IDY
      *                                             
                   MOVE    SPACE               TO  RECE04-REC
                   INITIALIZE                      RECE04-REC
                   MOVE    ZERO                TO  WRK-RECE04-ZAITEN
                   PERFORM VARYING IDW FROM    1   BY  1
                           UNTIL   IDW >       WRK-RECE04-MAX
                       IF      WRK-RECE04-FLG   (IDW)  =   "1"
                           MOVE    WRK-RECE04-REC    (IDW) 
                                               TO  RECE04-REC
                           ADD     RECE04-ZAITEN 
                                               TO  WRK-RECE04-ZAITEN
                           PERFORM 2002-TBLZAIW-TAIHI-SEC
                       END-IF
                   END-PERFORM    
                   COMPUTE RECE04-ZAIKAISU     =
                               WRK-KAISU (1)   *   WRK-KAISU1                
                   MOVE    WRK-RECE04-ZAITEN       TO  RECE04-SYUTEN1
                                                       RECE04-ZAITEN                                                        
      *
      *            ¥ì¥»¥×¥È£°£´ºÞÊÔ½¸Á°½èÍý
                   PERFORM 2001-RECE04-ZAIHEN-MAE-SEC
      *
                   IF      SPA-STS          =   ZERO
                       PERFORM 20051-SRYKBNELSE-KENSA-SEC
      *                ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë½ÐÎÏ½èÍý
                       PERFORM 450-RECE06-OUT-SEC
                   END-IF    
               END-IF
           END-PERFORM                        
           .
       2007-SRYKBN60-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ôºÆ·×»»½èÍý
      *****************************************************************
       400-TENSU-SAIKEISAN-SEC    SECTION.
      *
           MOVE    SPACE               TO  WRK-ZAI
           MOVE    "¡ö"                TO  WRK-ZAI-MK
      *    ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È
           MOVE    WRK-TENSUGOKEI      TO  WRK-ZAITENX
           MOVE    RECE04-ZAIKAISU     TO  WRK-ZAIKAISUX
      *    É¬Í×Í­¸ú·å¿ô¡¦³«»Ï°ÌÃÖ¡¦²ó¿ôÊÔ½¸
           PERFORM 810-TENSUKAI-HEN-SEC
      *
           .
       400-TENSU-SAIKEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙ¶õÇò½èÍý
      *****************************************************************
       410-MEISAI-SPACE-SEC   SECTION.
      *
           PERFORM   VARYING   IDY   FROM    1   BY  1
                     UNTIL     IDY   >       WRK-TBLMAX
               IF  IDY                   =   1
                   MOVE    SPACE         TO  TBL-ZAI (IDY)(3:)
               ELSE
                   INITIALIZE                TBL-ZAI (IDY)
               END-IF
           END-PERFORM
           MOVE    1                 TO  WRK-TBLMAX
      *
           .
       410-MEISAI-SPACE-EXT.
           EXIT.
      *****************************************************************
      *    ºÞ¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
      *****************************************************************
       430-TBLZAI-HEN-SEC     SECTION.
      *
      *    ¿ôÎÌÊÔ½¸
           PERFORM 4301-SURYO-HEN1-SEC
      *
      *    Ê¬²è¿ôÊÔ½¸
           PERFORM 4301-BUNKAKU-HEN1-SEC
      *
      *    ÌÀºÙÊÔ½¸¡¦ÌÀºÙ·å¿ô·×»»
           PERFORM 4302-MEISAI-KETA-HEN1-SEC
      *
      *    ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
           PERFORM 4303-ZAITBL-TENSO-SEC
      *    
      *    ÌÀºÙ¤¬£±¹Ô¤Ë¼ý¤Þ¤ê¤­¤é¤Ê¤¤¾ì¹ç
           IF  WRK-WCLM            >   50
               MOVE    SPACE             TO  WRK-ZAI-NAME
               MOVE    WRK-KOUI (51:)    TO  WRK-ZAI-NAME
               PERFORM 4303-ZAITBL-TENSO-SEC
           END-IF
      *
           ADD     1               TO  CNT-ZAITAISYO
      *
           .
       430-TBLZAI-HEN-EXT.
           EXIT.
      *     
      *****************************************************************
      *    ¿ôÎÌÊÔ½¸½èÍý
      *****************************************************************
       4301-SURYO-HEN1-SEC        SECTION.
      *
           MOVE    SPACE           TO  WRK-SURYO-X
           MOVE    ZERO            TO  WRK-SURYOST
           MOVE    ZERO            TO  WRK-SURYOKETA
           MOVE    ZERO            TO  WRK-SURYOKETA1
           MOVE    ZERO            TO  WRK-SURYOKETA2
           MOVE    SPACE           TO  WRK-SURYO-N
           MOVE    SPACE           TO  WRK-SRYSURYOW
      *
           IF      TBL-ZAIW-SRYSURYO (WRK-WIDX1 WRK-WIDX2)
                                   =   ZERO
               GO  TO  4301-SURYO-HEN1-EXT  
           END-IF
      * 
      *    ¿ô»úÉ½¼¨ÍÑÊÔ½¸¡ÊÈ¾³Ñ¡Ë
           MOVE    TBL-ZAIW-SRYSURYO (WRK-WIDX1 WRK-WIDX2)
                                   TO  WRK-SURYO
           MOVE    WRK-SURYO-S1    TO  WRK-SURYO-Z1
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDY   FROM    3   BY  -1
                     UNTIL     IDY           =   ZERO
             IF  WRK-SURYO-S2(IDY:1) NOT =   ZERO
                 MOVE    1               TO  FLG-SP
             END-IF
             IF  FLG-SP                  =   1
                 MOVE    WRK-SURYO-S2(IDY:1)
                                         TO  WRK-SURYO-Z3(IDY:1)
             END-IF
           END-PERFORM
           IF  WRK-SURYO-Z3          NOT =   SPACE
               MOVE    "."               TO  WRK-SURYO-Z2
           END-IF
      *    É½¼¨Ê¸»ú¿ô¥«¥¦¥ó¥È
           PERFORM   VARYING   IDY   FROM    1   BY  1
                     UNTIL     IDY           >   9
             IF  WRK-SURYO-X (IDY:1)   NOT =   SPACE
                 IF  WRK-SURYOST           =   ZERO
                     MOVE    IDY           TO  WRK-SURYOST
                 END-IF
      *          ¿ôÎÌ·å¿ô¥«¥¦¥ó¥È(£¶·åÌÜ¡§¥Ô¥ê¥ª¥É)
                 ADD     1                 TO  WRK-SURYOKETA
                 IF  IDY                   <   6
                     ADD     1             TO  WRK-SURYOKETA1
                 END-IF
                 IF  IDY                   >   6
                     ADD     1             TO  WRK-SURYOKETA2
                 END-IF
             END-IF
           END-PERFORM
           IF  WRK-SURYOST             =   6
               MOVE    "0"             TO  WRK-SURYO-Z1(5:1)
               MOVE    5               TO  WRK-SURYOST
               MOVE    1               TO  WRK-SURYOKETA1
               ADD     1               TO  WRK-SURYOKETA
           END-IF
      *    Á´³ÑÊÑ´¹
           IF  WRK-SURYOKETA1          >   ZERO
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z1 (WRK-SURYOST:WRK-SURYOKETA1)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA1  TO  WRK-CHAR-CNT
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N1
           END-IF
           IF  WRK-SURYOKETA2          >   ZERO
               MOVE    "¡¥"            TO  WRK-SURYO-N2
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z3 (1:WRK-SURYOKETA2)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA2  TO  WRK-CHAR-CNT
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N3
           END-IF
           STRING      WRK-SURYO-N1    DELIMITED   BY  " "
                       WRK-SURYO-N2    DELIMITED   BY  " "
                       WRK-SURYO-N3    DELIMITED   BY  " "
                       INTO            WRK-SRYSURYOW
           END-STRING
      *
           .
       4301-SURYO-HEN1-EXT.
           EXIT.
      *     
      *****************************************************************
      *    Ê¬²è¿ôÊÔ½¸½èÍý
      *****************************************************************
       4301-BUNKAKU-HEN1-SEC        SECTION.
      *
           MOVE    ZERO            TO  WRK-BUNKAKUKETA
           MOVE    SPACE           TO  WRK-BUNKAKU-N
      *
           IF      TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2) (1:1)
                                   =   "7"
           AND     TBL-ZAIW-TANICD(WRK-WIDX1 WRK-WIDX2)
                                   =   WRK-CONS-TANICD 
           AND     TBL-ZAIW-SRYKAISU(WRK-WIDX1 WRK-WIDX2)
                                   >   1
               CONTINUE
           ELSE                            
               GO  TO  4301-BUNKAKU-HEN1-EXT  
           END-IF
      * 
      *    É½¼¨ÍÑÊÔ½¸¡ÊÈ¾³Ñ¡Ë
           MOVE    TBL-ZAIW-SRYKAISU (WRK-WIDX1 WRK-WIDX2)
                                   TO  WRK-SRYKAISU-X
      *    Á´³ÑÊÑ´¹
           INITIALIZE              WRK-CHAR-HENKAN-AREA
           MOVE    WRK-SRYKAISU-X  TO  WRK-CHAR-X
           MOVE    3               TO  WRK-CHAR-CNT
           MOVE    1               TO  WRK-CHAR-FLG
           PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
           STRING  WRK-CHAR-N      DELIMITED BY  SPACE
                   "Ê¬²è"          DELIMITED  BY  SIZE
                                   INTO  WRK-BUNKAKU-N
           COMPUTE WRK-BUNKAKUKETA =   WRK-CHAR-N-CNT  +  4
      *
           .
       4301-BUNKAKU-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙ¡¦ÌÀºÙ·å¡¡ÊÔ½¸½èÍý
      *****************************************************************
       4302-MEISAI-KETA-HEN1-SEC    SECTION.
      *
           MOVE    SPACE           TO  WRK-KOUI
      *
           IF  TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)
                                   =   SPACE
      *        < Ì¾¾Î >
               MOVE    TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
                                   TO  WRK-KOUI
      *        < Ì¾¾Î*2 >
               COMPUTE WRK-WCLM  =
                       TBL-ZAIW-YUKOKETA (WRK-WIDX1 WRK-WIDX2) *  2
           ELSE
      *
               IF   TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)(1:2)
                                            =  "¡ö"
                   MOVE    SPACE   TO  
                              TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)
               END-IF
      *        Ì¾¾Î¤ÎÄ¹¤µ
               COMPUTE   WRK-NAMEKETA  =
                         TBL-ZAIW-YUKOKETA (WRK-WIDX1 WRK-WIDX2)
                         *   2
      *        -----------------------------------
      *        £±ÌÀºÙ¤Ë¿ôÎÌÃ±°Ì¤Þ¤Ç¼ý¤Þ¤ë¤«¤É¤¦¤«
      *        -----------------------------------
               EVALUATE    TRUE
               WHEN    WRK-NAMEKETA    >   50
      *            ÌÀºÙ¹Ô
                   MOVE    TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
                                       TO  WRK-KOUI
                   MOVE    WRK-KOUI    TO  WRK-ZAI-NAME
                   PERFORM 4303-ZAITBL-TENSO-SEC
      *
                   MOVE    SPACE       TO  WRK-KOUI
                   MOVE    SPACE       TO  WRK-ZAI-NAME
                   COMPUTE WRK-NAMEKETA    =   WRK-NAMEKETA  -  50
      *   ¡¡       < Ì¾¾Î¸åÈ¾ + ¶õÇò + ¿ôÎÌ + Ã±°Ì + Ê¬²è¿ô>
                   STRING  TBL-ZAIW-NAME     (WRK-WIDX1 WRK-WIDX2)
                                             (51:WRK-NAMEKETA)
                                              DELIMITED  BY  SIZE
                           "  "               DELIMITED  BY  SIZE
                           WRK-SRYSURYOW      DELIMITED  BY  " "
                           TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)
                                              DELIMITED  BY  " "
                           "  "               DELIMITED  BY  SIZE
                           WRK-BUNKAKU-N      DELIMITED  BY  " "
                           INTO               WRK-KOUI
                   END-STRING
                   COMPUTE   WRK-WCLM
                         =   ( WRK-SURYOKETA                  *   2 )
                         +   ( TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)
                                                              *   2 )
                         +   WRK-NAMEKETA  +  2
                   IF      WRK-BUNKAKUKETA        >   ZERO
                       COMPUTE   WRK-WCLM    =   WRK-WCLM         +
                                                 WRK-BUNKAKUKETA  +
                                                 2
                   END-IF                                             
      *
               WHEN    WRK-NAMEKETA    =   50
      *            ¿ôÎÌ¡¦Ã±°Ì¡¡¼¡¹Ô°õ»ú½èÍý
                   PERFORM 43021-SURYO-NEXTPRT-SEC
      *
               WHEN    WRK-NAMEKETA    <   50
      *            ´Ö¤Î¶õÇòÊ¬¤òÂ­¤·¹þ¤à
                   COMPUTE   WRK-NAMEKETA  =   WRK-NAMEKETA   +   2
                   IF  WRK-NAMEKETA    <   50
      *                Í¾Çò
                       COMPUTE   WRK-YOHAKU  =   50  -   WRK-NAMEKETA
      *                ¿ôÎÌ¡¦Ê¬²è¿ô·å¿ô
                       COMPUTE   WRK-WKETA   =
                         ( WRK-SURYOKETA                  * 2 )
                             +
                         ( TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)
                                                          * 2 )
                       IF      WRK-BUNKAKUKETA   >   ZERO
                           COMPUTE   WRK-WKETA   =   WRK-WKETA        +
                                                     WRK-BUNKAKUKETA  +
                                                     2
                       END-IF                                             
      *
                       IF  WRK-YOHAKU        >=  WRK-WKETA
      *                    < Ì¾¾Î + ¶õÇò + ¿ôÎÌ + Ã±°Ì + ¶õÇò + Ê¬²è¿ô>
      ********************STRING  TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
      ********************                        DELIMITED  BY  " "
      ********************         "  "           DELIMITED  BY  SIZE
                          STRING  TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
                                                (1:WRK-NAMEKETA)
                                                  DELIMITED  BY  SIZE
                                   WRK-SRYSURYOW  DELIMITED  BY  " "
                                   TBL-ZAIW-TANINAME
                                                 (WRK-WIDX1 WRK-WIDX2)
                                                  DELIMITED  BY  " "
                                   "  "           DELIMITED  BY  SIZE
                                   WRK-BUNKAKU-N  DELIMITED  BY  " "
                                   INTO           WRK-KOUI
                           END-STRING
      *                    < Ì¾¾Î*2 + ¶õÇò*2 + ¿ôÎÌ + Ã±°Ì*2 + ¶õÇò + Ê¬²è¿ô>
                           COMPUTE   WRK-WCLM     =
                               ( TBL-ZAIW-YUKOKETA 
                                         (WRK-WIDX1 WRK-WIDX2)  * 2 )
                             + ( WRK-SURYOKETA                  * 2 )
                             + ( TBL-ZAIW-TANIMOJISU 
                                         (WRK-WIDX1 WRK-WIDX2)  * 2 )
                             +  2
                           IF      WRK-BUNKAKUKETA   >   ZERO
                               COMPUTE   WRK-WCLM   =   WRK-WCLM      +
                                                     WRK-BUNKAKUKETA  +
                                                     2
                           END-IF                                             
                       ELSE
      *                    ¿ôÎÌ¡¦Ã±°Ì¡¡¼¡¹Ô°õ»ú½èÍý
                           PERFORM 43021-SURYO-NEXTPRT-SEC
                       END-IF
                   ELSE
      *                ¿ôÎÌ¡¦Ã±°Ì¡¡¼¡¹Ô°õ»ú½èÍý
                       PERFORM 43021-SURYO-NEXTPRT-SEC
                   END-IF
               END-EVALUATE
           END-IF
           MOVE    WRK-KOUI        TO  WRK-ZAI-NAME
      *
           .
       4302-MEISAI-KETA-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ôÎÌ¡¦Ã±°Ì¡¡¼¡¹ÔÊÔ½¸½èÍý
      *****************************************************************
       43021-SURYO-NEXTPRT-SEC    SECTION.
      *
      *    < Ì¾¾Î >
           MOVE    TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
                                      TO  WRK-KOUI
           MOVE    WRK-KOUI           TO  WRK-ZAI-NAME
           PERFORM 4303-ZAITBL-TENSO-SEC
      *
           MOVE    SPACE              TO  WRK-KOUI
           MOVE    SPACE              TO  WRK-ZAI-NAME
      *    < ¶õÇò + ¿ôÎÌ + Ã±°Ì + ¶õÇò + Ê¬²è¿ô>
           STRING  "    "             DELIMITED  BY  SIZE
                   WRK-SRYSURYOW      DELIMITED  BY  " "
                   TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)
                                      DELIMITED  BY  " "
                   "  "               DELIMITED  BY  SIZE
                   WRK-BUNKAKU-N      DELIMITED  BY  " "
                   INTO               WRK-KOUI
           END-STRING
           COMPUTE   WRK-WCLM
                 =   ( WRK-SURYOKETA                  *   2 )
                 +   ( TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)
                                                      *   2 )
                 +   4
           IF      WRK-BUNKAKUKETA   >   ZERO
               COMPUTE   WRK-WCLM   =   WRK-WCLM         +
                                        WRK-BUNKAKUKETA  +
                                        2
           END-IF                                             
      *
           .
       43021-SURYO-NEXTPRT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
      *****************************************************************
       4303-ZAITBL-TENSO-SEC    SECTION.
      *
           ADD     1                 TO  WRK-TBLMAX
           IF  WRK-TBLMAX           >   100
               DISPLAY "*** ORCR0090 TBL-ZAI INDEX[100] OVER  ***"
      *         ACCEPT   WRK-IN       FROM    CONSOLE
           END-IF
           MOVE    WRK-ZAI           TO  TBL-ZAI (WRK-TBLMAX)
           MOVE    SPACE             TO  WRK-ZAI
      *
           .
       4303-ZAITBL-TENSO-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô²ó¿ô¥»¥Ã¥È½èÍý
      *****************************************************************
       440-TNSKAI-SET-SEC          SECTION.
      *
      *---- (01.00.05) LINE ADD START --------------------------------
           IF     (FLG-COMMENT        =   1)     AND
                  (RECE04-SRYKBN      =   "99")
               GO  TO  440-TNSKAI-SET-EXT
           END-IF
           IF     (FLG-COMMENT2       =   1)     AND                    
                  (RECE04-SRYKBN      =   "11" OR "12" OR "99")         
               GO  TO  440-TNSKAI-SET-EXT                              
           END-IF                                                      
           IF     (FLG-COMMENT3       =    1  )   AND                   
                  (RECE04-SRYKBN      =   "11")   AND                   
                  (CNT-SYOSIN-KASAN   =   ZERO)                         
               GO  TO  440-TNSKAI-SET-EXT                               
           END-IF                                                       
           IF     (FLG-COMMENT3       =    1  )   AND                   
                  (RECE04-SRYKBN      =   "12")   AND                   
                  (RECE04-ZAITEN      =   ZERO)                         
               GO  TO  440-TNSKAI-SET-EXT                               
           END-IF                                                       
      *---- (01.00.05) LINE ADD END   --------------------------------
      *         
           MOVE    WRK-TNSKAI-ST     TO  IDA
           COMPUTE   IDA             =   IDA     -   2
           MOVE    WRK-TNSKAI-KETA   TO  IDB
      *****MOVE    WRK-TBLMAX       TO  IDY
      *
      *    ºÇ½ªÌÀºÙ¤ËÅÀ¿ô¡¦²ó¿ô¤ò°õ»ú¤¹¤ë¥¹¥Ú¡¼¥¹Í­¤ê
           MOVE    TBL-ZAI (IDY)(3:)     TO  WRK-ZAI-NAME
           IF  WRK-ZAI-NAME (IDA:)       =   SPACE
               COMPUTE   WRK-TNSKAI-ST   =   22
                                         -   WRK-TNSKAI-KETA
               ADD     1                 TO  WRK-TNSKAI-ST
               MOVE    WRK-TNSKAI (WRK-TNSKAI-ST:IDB)
                                         TO  WRK-ZAI-TNSKAI
                                                    (WRK-TNSKAI-ST:)
               MOVE    WRK-ZAI-NAME      TO  TBL-ZAI (IDY)(3:)
           ELSE
      *    ºÇ½ªÌÀºÙ¤ËÅÀ¿ô¡¦²ó¿ô¤ò°õ»ú¤¹¤ë¥¹¥Ú¡¼¥¹Ìµ¤·
               ADD     1                 TO  IDY
               IF  IDY                   >   100
                   DISPLAY "*** ORCR0090 TBL-ZAI INDEX[100] OVER  ***"
      *             ACCEPT   WRK-IN       FROM    CONSOLE
               END-IF
               MOVE    SPACE             TO  WRK-ZAI
               MOVE    WRK-TNSKAI        TO  WRK-ZAI-TNSKAI
               MOVE    WRK-ZAI           TO  TBL-ZAI (IDY)
               MOVE    SPACE             TO  WRK-ZAI
           END-IF
      *
           .
       440-TNSKAI-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È£°£¶½ÐÎÏ½èÍý
      *****************************************************************
       450-RECE06-OUT-SEC    SECTION.
      *
           PERFORM   VARYING   IDY   FROM    1   BY  1
                     UNTIL     IDY   >   WRK-TBLMAX
      *
               ADD     1                 TO  WRK-LINENUM
               MOVE    SPACE             TO  RECE06-REC
               INITIALIZE                    RECE06-REC
               MOVE    RECE02-KEY        TO  RECE06-KEY
               MOVE    RECE04-KOHBUNRI   TO  RECE06-KOHBUNRI
               MOVE    RECE04-ZAINUM     TO  RECE06-ZAINUM
               MOVE    WRK-LINENUM       TO  RECE06-LINENUM
               MOVE    WRK-TBLMAX       TO  RECE06-ZAIMEISAISU
               MOVE    RECE04-PTNUM      TO  RECE06-PTNUM
               MOVE    RECE04-SRYKA      TO  RECE06-SRYKA
               MOVE    RECE04-SRYKBN     TO  RECE06-SRYKBN
               MOVE    TBL-ZAI (IDY)     TO  RECE06-TEKIYO-INF
      *
               IF    ( FLG-COMMENT2     =   1           )               
               AND   ( RECE04-SRYKBN    =  "11" OR "12" )               
                   MOVE  SPACE           TO  RECE06-SRYKBN              
               END-IF                                                   
      *---------Å¬ÍÑÍóÊÂ¤ÓÂØ¤¨ÍÑ¤ÎÊÔ½¸¡ÊÉ½ÍÑÈÖ¹æÅù¡Ë-----------------
               IF      IDY               =   1
      *
                 INITIALIZE                           TNS-TENSU-REC
                 IF        TBL-ZAIW-SRYCD1(1:1)  =   "6"  OR  "7"
                     MOVE    ALL "9"            TO
                                            TNS-CDKBN-KBN
                                            TNS-CDKBN-SYO 
                                            TNS-CDKBN-BU
                                            TNS-CDKBN-KBNNUM
                                            TNS-CDKBN-KBNNUM-EDA
                                            TNS-CDKBN-KOUBAN 
                                            TNS-KOUHYOJYUNNUM
                 ELSE  
                     MOVE    TBL-ZAIW-SRYCD1   TO  TNS-SRYCD
                     MOVE    TNS-TENSU-REC     TO  MCPDATA-REC
                     MOVE    RECE04-SRYYM      TO  ORC-DBYMD(1:6)
                     MOVE    "01"              TO  ORC-DBYMD(7:2)
                     PERFORM 900-TENSU-INV-SEC
                     IF      FLG-TENSU            =       1
                         INITIALIZE               TNS-TENSU-REC
                     END-IF
                 END-IF
               END-IF
               MOVE    TNS-CDKBN-SYO       TO  RECE06-CDKBN-SYO
               MOVE    TNS-CDKBN-BU        TO  RECE06-CDKBN-BU
               MOVE    TNS-CDKBN-KBN       TO  RECE06-CDKBN-KBN
               MOVE    TNS-CDKBN-KBNNUM    TO  RECE06-CDKBN-KBNNUM
               MOVE    TNS-CDKBN-KBNNUM-EDA
                                           TO  RECE06-CDKBN-KBNNUM-EDA
               MOVE    TNS-CDKBN-KOUBAN    TO  RECE06-CDKBN-KOUBAN
               IF      RECE04-SRYKBN           =   "21"
               AND     TBL-ZAIW-SRYCD1     NOT =   CONS-TEIGEN
                   CONTINUE
               ELSE
                   MOVE    TNS-KOUHYOJYUNNUM
                                           TO  RECE06-KOUHYOJUNNUM
               END-IF
      *
      *--------------------------------------------------------------
               MOVE    RECE04-ZAITEN     TO  RECE06-ZAITEN
      *
               IF      TNS-SRYKBN        =   "60"
                       MOVE   TNS-KNSJISKBN  TO  RECE06-KNSJISKBN
               ELSE
                       MOVE   ZERO           TO  RECE06-KNSJISKBN
               END-IF
      *
               WRITE   RECE06-REC
      *         
               IF  STS-RECE          NOT =   ZERO
                   DISPLAY "*** ORCR0090 RECE06 WRITE ERR  ***"
                   MOVE   WRK-TBLMAX     TO  IDY
      *********    MOVE    2             TO  SPA-STS                       
               ELSE
                   ADD     1             TO  CNT-RECE06
               END-IF    
           END-PERFORM
      *     
           INITIALIZE                    TBL-ZAI-AREA
      *
           .
       450-RECE06-OUT-EXT.
           EXIT.
057400*
      *****************************************************************
      *    ¥¨¥é¡¼½ÐÎÏ½èÍý
      *****************************************************************
       500-ERR-HENSYU-SEC                SECTION.
      *
           OPEN    INPUT   RECEERR-FILE
           IF      STS-RECEERR         =   ZERO
               CLOSE   RECEERR-FILE
           ELSE
               OPEN    OUTPUT              RECEERR-FILE
      *
               MOVE    WRK-RECEERR         TO  RECEERR-REC
               WRITE   RECEERR-REC
               CLOSE   RECEERR-FILE
      *         
      *        ¥¸¥ç¥Ö´ÉÍý³«»Ï½èÍý
               MOVE    "JBE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
               MOVE    WRK-PARA-SHELLID
                                       TO  JOB-SHELLID
               MOVE    WRK-RECEERR     TO  JOB-YOBI
               MOVE    "9999"          TO  JOB-ERRCD
               CALL    "ORCSJOB"       USING
                                       ORCSJOBKANRIAREA  
                                       JOBKANRI-REC
           END-IF
      *                             
           MOVE    1                   TO  FLG-END
      *
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½ªÎ»¡¡¡¡½èÍý
      *****************************************************************
       300-END-SEC                 SECTION.
      *
      *    ¥Õ¥¡¥¤¥ë£Ã£Ì£Ï£Ó£Å½èÍý
           PERFORM 310-FILE-CLOSE-SEC
      *
      *    ¥¹¥Æ¥Ã¥×´ÉÍý½ªÎ»½èÍý
           MOVE    "STE"           TO  SJOBKANRI-MODE
           INITIALIZE                  JOBKANRI-REC
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA  
                                   JOBKANRI-REC
      *
           PERFORM 900-DBDISCONNECT-SEC
      *
           DISPLAY "RECE02  IN  " CNT-RECE02   
           DISPLAY "RECE06  CNT " CNT-RECE06 
           DISPLAY "*** ORCR0090 END ***"
      ***     ACCEPT  WRK-IN FROM CONSOLE 
      *
           .
       300-END-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë£Ã£Ì£Ï£Ó£Å½èÍý
      *****************************************************************
       310-FILE-CLOSE-SEC              SECTION.
      *
           CLOSE                       RECE02-FILE
      *
           CLOSE                       RECE04-FILE
      *
           CLOSE                       RECE05-FILE
      *
           CLOSE                       RECE06-FILE     
      *
           .
       310-FILE-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ôÃÍÈ¾³Ñ¢ªÁ´³ÑÊÑ´¹½èÍý
      *****************************************************************
       800-NUM-ZENKAKU-HENKAN-SEC    SECTION.
      *
      *    FLG=1¤Î¤È¤­¶õÇò¤ÏÊÔ½¸¤·¤Ê¤¤
      *
           MOVE    1                   TO  WRK-CHAR-IDX
           MOVE    ZERO                TO  WRK-CHAR-N-CNT
      *     
           PERFORM VARYING     IDZ     FROM    1   BY  1
                   UNTIL       IDZ     >   WRK-CHAR-CNT
               IF      WRK-CHAR-FLG        =   1
               AND     WRK-CHAR-X (IDZ:1)  =   SPACE
                   CONTINUE
               ELSE        
                   IF    WRK-CHAR-X (IDZ:1)  IS  NUMERIC
                       IF      WRK-CHAR-X (IDZ:1)  =   "0"
                           MOVE    TBL-SUJI (10)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE
                           MOVE    WRK-CHAR-X (IDZ:1)  TO  WRK-NUM
                           MOVE    TBL-SUJI (WRK-NUM)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF                    
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
                                           WRK-CHAR-N-CNT
               END-IF    
           END-PERFORM
      *
           .
       800-NUM-ZENKAKU-HENKAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô¡¦²ó¿ôÊÔ½¸½èÍý
      *****************************************************************
       810-TENSUKAI-HEN-SEC    SECTION.
      *    ÅÀ¿ôÊÔ½¸
           INITIALIZE                      WRK-CHAR-HENKAN-AREA
           MOVE    WRK-ZAITENX         TO  WRK-CHAR-X
           MOVE    7                   TO  WRK-CHAR-CNT
           PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
           MOVE    WRK-CHAR-N          TO  WRK-ZAITEN
      *    ²ó¿ôÊÔ½¸
           INITIALIZE                      WRK-CHAR-HENKAN-AREA
           MOVE    WRK-ZAIKAISUX       TO  WRK-CHAR-X
           MOVE    3                   TO  WRK-CHAR-CNT
           PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
           MOVE    WRK-CHAR-N          TO  WRK-ZAIKAISU
           MOVE    "¡ß"                TO  WRK-X
      *
      *    ÌôºÞÎÁÄþ¸º¤Î¤È¤­ÅÀ¿ô¤Î¤Þ¤¨¤Ë¢¥¤òÉ½¼¨
           IF      FLG-TEIGEN          =   1
               PERFORM VARYING IDZ FROM    13  BY  -2
                       UNTIL   IDZ <       3
                   IF      WRK-ZAITEN (IDZ:2)  =   SPACE
                       MOVE    "¢¥"        TO  WRK-ZAITEN (IDZ:2)
                       MOVE    1           TO  IDZ
                   END-IF
               END-PERFORM
           END-IF
      *
      *
      *    É¬Í×Í­¸ú·å¿ô¡ÊÅÀ¿ôZZZZZZZ X ¿ôÎÌZZZ ¤ÎÁ´³Ñ¤Î·å¿ô¡Ë
           MOVE    ZERO                TO  WRK-TNSKAI-KETA
           PERFORM VARYING   IDZ     FROM    1   BY  1
                   UNTIL     IDZ     >       22
               IF      WRK-TNSKAI (IDZ:1)      NOT =   SPACE
                   COMPUTE WRK-TNSKAI-KETA   =   22  -  IDZ     +   1
                   MOVE    22                  TO  IDZ
               END-IF 
           END-PERFORM
      *    ³«»Ï°ÌÃÖ¤ò¼èÆÀ
           COMPUTE   WRK-TNSKAI-ST     =   ( 50  -  WRK-TNSKAI-KETA )
                                       +   1
      *
           .
       810-TENSUKAI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È£°£²¥Ç¡¼¥¿½ç¸¡º÷½èÍý
      *****************************************************************
       990-RECE02-READ-SEC           SECTION.
      *
           READ    RECE02-FILE         NEXT
               AT  END
                   MOVE    1           TO  FLG-END
                   MOVE    2           TO  SPA-STS
               NOT AT  END
                   ADD     1           TO  CNT-RECE02
                   MOVE    ZERO        TO  FLG-END
           END-READ
      *
           .
       990-RECE02-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¥ì¥»¥×¥È£°£´¥Ç¡¼¥¿ÆÉ¤ß
      ****************************************************************
       990-RECE04-NEXT-SEC           SECTION.
      *
           READ    RECE04-FILE       NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE04
               NOT AT  END
                   MOVE    ZERO      TO  FLG-RECE04
           END-READ
      *
           .
       990-RECE04-NEXT-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¥ì¥»¥×¥È£°£µ¥Ç¡¼¥¿ÆÉ¤ß
      ****************************************************************
       990-RECE05-NEXT-SEC           SECTION.
      *
           READ    RECE05-FILE       NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE05
               NOT AT  END
                   MOVE    ZERO      TO  FLG-RECE05
           END-READ
      *
           .
       990-RECE05-NEXT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¡¼ÆÉ¹þ¡Ê¥­¡¼¡Ë
      *****************************************************************
       900-TENSU-INV-SEC         SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           MOVE    "TENSU-KEY"         TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           IF      MCP-RC              =   ZERO
               MOVE    "DBFETCH"           TO  MCP-FUNC
               MOVE    "TENSU-KEY"         TO  ORC-DBPATH
               CALL    "ORCMCPSUB"          USING
                                            MCPAREA
                                            ORCMCPAREA
                                            MCPDATA-REC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-TENSU
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
               ELSE
                   INITIALIZE                  TNS-TENSU-REC
                   MOVE    1                   TO  FLG-TENSU
               END-IF
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1                   TO  FLG-TENSU
           END-IF
      *
           MOVE    "DBCLOSE"           TO  MCP-FUNC
           MOVE    "TENSU-KEY"         TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
      *
           .
       900-TENSU-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ôÆÉ¹þ
      *****************************************************************
       TENSU-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
      
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
               MOVE    ZERO            TO  FLG-TENSU
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1               TO  FLG-TENSU
           END-IF
      *
           .
       TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥«¡¼¥½¥ë¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       CSR-CLOSE-SEC            SECTION.
      *
           INITIALIZE                  MCPAREA
           MOVE    "DBCLOSE"           TO  MCP-FUNC
           MOVE    WRK-PATH            TO  ORC-DBPATH
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC
           .
       CSR-CLOSE-EXT.
           EXIT.
      *      
      *****************************************************************
      *    £Ä£Â¡¡¥ª¡¼¥×¥ó½èÍý
      *****************************************************************
       120-DBOPEN-SEC                SECTION.
      *
           MOVE    "DBOPEN"            TO  MCP-FUNC.
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC.
      *
           MOVE    "DBSTART"           TO  MCP-FUNC.
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC.
           .
       100-DBOPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¡¡¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       900-DBDISCONNECT-SEC            SECTION.
      *
           MOVE    "DBCOMMIT"          TO  MCP-FUNC.
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC.
      *
           MOVE    "DBDISCONNECT"      TO  MCP-FUNC.
           CALL    "ORCMCPSUB"          USING
                                        MCPAREA
                                        ORCMCPAREA
                                        MCPDATA-REC.
           .
       900-DBCLOSE-EXT.
           EXIT.
