      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCR0420.
      *****************************************************************
      *  システム名        : ＯＲＣＡ
      *  サブシステム名    : レセプト（労災・自賠責）
      *  コンポーネント名  : 月次業務　労災自賠責明細書ファイル作成
      *                      診療区分別点数集計（労災・自賠責）
      *  管理者            : 
      *  作成日付    作業者        記述
      *  02/06/18    MCC−門脇　   新規作成
      *****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  01.00.01    NACL-門脇    02.09.12  自賠責対応　　　　
      *  01.00.02    NACL-藤原    02.09.20  検査の編集のために回数を
      *                                     全て編集する
      *  01.00.03    NACL-門脇    02.10.02  摘要出力項目変更の為の編集
      *  01.00.04    NACL-門脇    02.11.06  約束処方時の点数欄表示修正
      *  01.00.05    NACL-門脇    02.11.21  自賠責（ポリネック等の対応）
      *  01.00.06    NACL-門脇    02.11.26  検診コードを編集できるよう修正
      *  01.00.07    NACL-藤原    02.12.02  酸素の時単価を表示するように追加
      *  01.00.08    NACL-藤原    03.01.22  データ区分の追加
      *  01.00.09    NACL-門脇    03.02.06  コメントカウントフラグの編集追加
      *  01.00.10    NACL-門脇    03.03.10  診療科１０から２０へ
      *  01.00.11    NACL-藤原    03.04.09  特定器材（画像診断のフィルム以外）
      *                                     の単価を表示するように修正
      *  01.00.12    NACL-門脇    03.04.14  自賠責の小数点以下金額計算
      *                                     四捨五入に変更
      *  01.00.13    NACL-門脇    03.05.08  名称有効桁のセット
      *  01.00.14    NACL-門脇    03.05.13  自賠責：腰部固定帯加算対応
      *  01.00.15    NACL-門脇    03.05.20  自賠責：療養担当手当て対応
      *  01.00.16    NACL-門脇    03.05.22  残量廃棄の数量セット
      *  01.00.17    NACL-門脇    03.06.03  外来診療料対応
      *                                     （平成１５年６月以降）
      *  01.00.18    NACL-門脇    03.09.24  コメント編集フラグのセット
      *  01.00.19    NACL-門脇    03.09.29  包括対象検査情報のセット
      *                                     検査等実施判断情報のセット
      *                                     各種番号等情報のセット
      *  01.00.20    NACL-門脇    03.10.06  点数マスタを読み込まないよう
      *                                     修正
      *  01.00.21    NACL-門脇    04.01.06  診療行為コードの１桁目の判定
      *                                     修正
      *  01.00.22    NACL-門脇    04.01.21  労災の特定器材(09593)対応
      *  01.00.23    NACL-門脇    04.02.05  診療コード＊数量の累計編集
      *  ２００４年４月改正対応
      *  01.01.01    NACL-門脇    04.04.01  長期投薬加算（処方料、処方せん
      *                                     料）追加対応
      *  01.01.02    NACL-門脇    04.04.01  リハ言語聴覚療法（３）追加対応
      *  01.01.03    NACL-門脇    04.04.05  在宅血液透析頻回指導管理料の
      *                                     コメント対応
      *  01.01.04    NACL-門脇    04.04.10  在宅患者訪問点滴注射管理指導料
      *                                     算定時の点滴注射のコメント対応
      *  01.01.05    NACL-門脇    04.04.26  ユーザーコメント追加対応
      *  01.01.06    NACL-小豆沢  04.06.08  ＣＴ・ＭＲＩ（２回目以降）の
      *                                     摘要欄記載順修正
      *  01.01.07    NACL-門脇    04.06.11  皮下筋肉注射で、薬剤点・器材点
      *                                     が無いの場合の摘要欄記載対応
      *  01.01.08    NACL-門脇    04.07.28  投薬料の器材点の集計修正
      *  01.01.09    NACL-門脇    04.07.28  休業証明フラグ、休業期間終了月
      *                                     日の編集
      *  01.01.10    NACL-門脇    04.10.15  自賠責特定器材等消費税対応
      *  中止処理追加
      *  01.02.01    NACL-藤原    04/10/13  中止処理の追加
      *  01.02.02    NACL-門脇    04/12/17  胸部固定帯加算、創外固定器
      *                                     使用加算を薬剤等へ
      *  01.02.03    NACL-門脇    05/01/18  酸素計算式コメント対応
      *  01.02.04    NACL-門脇    05/01/26  システム管理４００１に関する修正
      *  01.02.05    NACL-門脇    05/01/27  腰・胸部固定帯加算、創外固定器
      *                                     使用加算の技術・薬剤等の選択対応
      *  01.02.06    NACL-門脇    05/01/28  文書料のコメント対応
      *  01.02.07    NACL-門脇    05/02/28  （サ）記載対応
      *  01.02.08    NACL-門脇    05/03/03  特記事項の編集修正
      *  01.02.09    NACL-門脇    05/04/20  内服薬剤逓減編集対応
      *  01.02.10    NACL-門脇    05/05/19  点数マスタの単位文字数がゼロ
      *                                     の場合の編集
      *  01.02.11    NACL-門脇    05/07/15  自賠責従来様式対応
      *  01.02.12    NACL-門脇    05/08/22  リハビリ実施回数差し込み修正対応
      *  01.02.13    NACL-藤原    05/08/22  検体検査コメントの追加
      *  01.02.14    NACL-門脇    05/08/29  ０９５９３のコメント対応
      *  01.02.15    NACL-門脇    05/10/06  診区９５９６対応
      *  01.02.16    NACL-小豆沢  05/10/28  特記事項　先進、制超　対応
      *  01.02.17    NACL-門脇    05/11/01  （検選）等コメント対応
      *  01.02.18    NACL-門脇    05/11/11  コメントがある場合の編集修正
      *  01.02.19    NACL-門脇    05/11/15  傷病手当金、療養費同意書の自動
      *                                     記載フラグ編集修正
      *  01.02.20    NACL-門脇    06/01/05  アフターケア在宅料対応
      *  01.02.21    NACL-門脇    06/02/01  ０９９２０００で始まる投薬用
      *                                     コメントの編集対応
      *
      *  ２００６年４月改正対応
      *  02.09.01    NACL-門脇    06/04/05  累計トータル編集修正
      *  02.09.02    NACL-門脇    06/04/13  ２００６年４月改正対応
      *  02.09.03    NACL-藤原    06/04/14  きざみ値計算識別の追加
      *  02.09.04    NACL-門脇    06/04/20  外来迅速検体検査加算編集
      *  02.09.05    NACL-門脇    06/04/28  在宅編集修正
      *  02.09.06    NACL-門脇    06/06/09  労災（加算なし）を剤に含む
      *                                     場合の編集修正（自賠責）
      *  03.00.01    NACL-門脇    06/06/22  往診、在宅患者訪問診療料の
      *                                     コメント自動記載対応
      *  03.01.01    NACL-門脇    06/07/10  在支援コメント自動記載対応
      *  03.01.02    NACL-門脇    06/07/14  診療区分置き換えフラグの編集
      *  03.02.01    NACL-門脇    06/08/10  高齢者上限額経過措置対応
      *  03.02.02    NACL-門脇    06/09/08  フイルムの単価編集修正
      *  03.03.01    NACL-門脇    06/09/27  特記事項１６長２対応
      *  03.03.02    NACL-門脇    06/11/10  往診のコメント自動記載条件修正
      *  03.04.01    NACL-門脇    06/12/01  自賠責健保準拠対応
      *  03.04.02    NACL-門脇    07/01/23  注射加算の名称編集修正
      *  03.04.03    NACL-門脇    07/03/12  包括診療対応
      *  03.04.04    NACL-門脇    07/04/01  現物給付対応
      *  03.04.05    NACL-門脇    07/04/13  リハビリ対応
      *  03.04.06    NACL-門脇    07/05/11  労災・自賠責単価１０円未満対応
      *
      *  03.05.01    NACL-門脇    07/05/25  グループ診療対応
      *  03.05.02    NACL-藤原    07/06/01  realtime preview 処理追加
      *  03.05.03    NACL-門脇    07/06/26  自賠責平成１９年４月改正様式対応
      *  03.05.04    NACL-門脇    07/07/17  個別時のシステム管理編集修正
      *  03.05.05    NACL-門脇    07/07/26  レセに記載しないコメント対応
      *  03.05.06    NACL-門脇    07/09/13  皮下筋肉、静脈注射の記載変更対応
      *  03.05.07    NACL-門脇    07/09/18  画像診断の加算（データ区分：手技）
      *                                     の記載順変更対応
      *  03.01.01    NACL-門脇    07/10/24  自賠責特定器材等消費税対象外設定
      *                                     項目数拡張対応
      *  04.01.02    NACL-門脇    07/10/31  公務災害対応
      *  04.01.03    NACL-門脇    07/11/26  特定器材商品名記載対応
      *  04.01.04    NACL-門脇    07/11/30  他保険にて診察料算定済の名称置換
      *  04.01.05    NACL-門脇    08/02/12  処方料等カウント修正
      *  04.02.01    NACL-門脇    08/03/24  平成２０年４月改正対応
      *                                     （特記事項追加対応：２０）
      *                                     （脳血管リハ（３）コード追加）
      *                                     （介達牽引発症日記載廃止）
      *                                     （初診（夜間・早朝等）加算追加）
      *                                     （診療区分６４：病理診断対応）
      *                                     （再就労：円変更対応）
      *                                     （リハ：専用コード追加）
      *                                     （在宅コード追加）
      *                                     （剤支援記載対象コード修正）
      *                                     （小児特定疾患カウンセリング料
      *                                       の自動記載対応）
      *                                     （在支病自動記載対応）
      *  04.02.02    NACL-門脇    08/06/20  在宅編集修正
      *  04.02.03    NACL-門脇    08/11/06  皮下筋肉、静脈注射の記載変更対応
      *
      *  04.03.01    NACL-門脇    08/07/08  診区１４のコメントのみの剤
      *                                     編集対応
      *  04.03.02    NACL-門脇    08/07/11  診断書明細書料の摘要欄記載対応
      *  04.03.03    NACL-門脇    08/07/14  仮レセ作成（院外処方含む）対応
      *                                     投薬剤点０（院外等）記載
      *  04.03.04    NACL-門脇    08/09/25  自賠責０９５９３の集計先対応
      *  04.03.05    NACL-門脇    08/12/01  在宅（院外分）編集修正
      *  04.03.06    NACL-門脇    08/12/16  平成２１年１月改正対応
      *  04.03.07    NACL-門脇    09/01/16  処方欄金額編集修正
      *
      *  04.04.01    NACL-門脇    08/12/25  包括対応
      *  04.04.02    NACL-門脇    09/02/04  検査のコメント自動記載対応
      *  04.04.03    NACL-門脇    09/04/13  平成２１年５月改正対応
      *  04.04.04    NACL-門脇    09/11/19  自賠責健保準拠療養担当手当対応
      *  04.04.05    NACL-門脇    09/12/04  剤まとめ項目値の計算修正
      *  04.04.06    NACL-門脇    09/12/09  出来高算定（剤）の対応
      *  04.04.07    NACL-門脇    10/01/13  剤まとめ項目値の計算修正
      *  04.04.08    NACL-門脇    10/01/29  内服薬剤逓減編集対応
      *  04.04.09    NACL-門脇    10/03/12  内服薬剤逓減編集対応
      *  04.04.10    NACL-門脇    10/03/23  同日電話再診の回数記載対応
      *  04.04.11    NACL-門脇    10/03/25  改正対応
      *                                     （地域医療貢献加算記載編集）
      *                                     （明細書発行体制等加算記載編集）
      *  04.04.12    NACL-門脇    10/03/25  改正対応
      *                                     （予約コード読み飛ばし編集）
      *  04.04.13    NACL-門脇    10/03/29  改正対応
      *                                     （画像診断２回目以降減算編集）
      *                                     （抗悪性腫瘍剤処方管理加算編集）
      *                                     （コード追加）
      *  04.04.14    NACL-門脇    10/03/31  改正対応
      *                                     （頸部固定帯加算の対応）
      *  04.04.15    NACL-門脇    10/04/06  改正対応
      *                                     （コメント自動記載）
      *  04.04.16    NACL-門脇    10/08/06  アフターケア再診欄回数記載修正
      *  04.04.17    NACL-門脇    10/12/10  剤まとめ項目値の計算修正
      *
      *  04.05.01    NACL-門脇    09/06/29  療養期間記載方法選択機能
      *                                     （休業証明請求時）
      *  04.05.02    NACL-藤原    09/07/14  小数点以下５桁対応
      *  04.05.03    NACL-門脇    09/08/17  小数点以下５桁対応
      *  04.05.04    NACL-門脇    09/09/24  レセプト記載しないコメント対応
      *  04.05.05    NACL-門脇    09/11/19  薬剤算定なし時の摘要欄同一剤
      *                                     まとめ記載対応
      *  04.05.06    NACL-門脇    10/01/21  治験対応
      *  04.05.07    NACL-門脇    11/06/21  画像診断・電子画像管理加算の
      *                                     表用番号編集
      *  04.05.08    NACL-門脇    11/12/16  器材の金額と単位の対応
      *  04.05.09    NACL-門脇    12/02/13  回数欄編集修正（処方、麻毒、調基）
      *  04.05.10    NACL-門脇    12/04/02  平成２４年４月改正
      *                                     「再診」の対応
      *                                     「在宅」の対応
      *                                     「処置」の対応
      *                                     「画像診断」の対応
      *                                     「その他」の対応
      *                                     労災再診（同一日２科目）対応
      *                                     コメント差込
      *  04.05.11    NACL-門脇    12/05/01  平成２４年４月改正
      *                                     自賠責
      *                                     再診の点数集計と回数編集対応
      *  04.05.12    NACL-門脇    12/05/23  再就労療養指導管理料の集計先変更
      *  04.05.13    NACL-門脇    12/05/23  保険欄−一部負担金未記載対応
      *  04.05.14    NACL-門脇    12/08/10  ８０その他欄の点数集計修正
      *  04.05.15    NACL-門脇    12/09/19  保険欄−一部負担金欄金額置換対応
      *  04.05.16    NACL-門脇    12/11/08  公費欄−一部負担金欄金額置換対応
      *
      *  04.06.01    NACL-門脇    10/07/01  自賠責文書料レセプト摘要欄記載
      *                                     （１通時）対応
      *  04.06.02    NACL-門脇    10/07/02  小児特定疾患カウンセリング料の
      *                                     レセプトコメント自動記載（重複時）
      *                                     対応
      *  04.06.03    NACL-門脇    10/12/06  労災・自賠責の金額フリー入力
      *                                     コード対応
      *  04.06.04    NACL-門脇    12/10/15  診療行為入力したコメントのみの剤の
      *                                     レセプト記載対応
      *  04.06.05    NACL-門脇    13/02/18  労災レセ電対応
      *                                     （新診療行為コード対応）
      *  04.06.06    NACL-門脇    13/02/27  平成２５年４月改正対応
      *  04.06.07    NACL-門脇    13/05/31  平成２５年７月診療分以降の
      *                                     休業証明のみの対応
      *  04.06.08    NACL-門脇    13/06/27  平成２５年７月診療分以降の再診時
      *                                     療養指導管理料のコメント記載修正
      *  04.06.09    NACL-門脇    13/07/26  金額欄集計分のコメント編集修正
      *  04.06.10    NACL-門脇    13/09/25  労災マスタ追加対応
      *                                     （電話再診料　等）
      *  04.06.11    NACL-門脇    13/11/07  公務災害（労災準拠）の地公災特別
      *                                     加算対応（京都府）
      *
      *  04.07.01    NACL-門脇    12/09/25  コメント差込対応（在宅持続陽圧）
      *  04.07.02    NACL-門脇    12/09/25  コメント差込取り止め（在宅持続陽圧）
      *  04.07.03    NACL-門脇    13/01/21  労災レセ電対応
      *  04.07.04    NACL-門脇    13/08/20  ０９５９３で始まるコードの有無区分
      *                                     編集
      *  04.07.05    NACL-門脇    13/10/02  自賠責（第三者行為）対応
      *  04.07.06    NACL-門脇    13/12/03  自賠責（労災準拠）のレセプト様式
      *                                     追加対応
      *  04.07.07    NACL-門脇    14/02/13  労災・自賠責の施術加算対応
      *  04.07.08    NACL-門脇    14/02/19  自賠責（第三者行為）対応
      *                                     （負担金額１０円未満四捨五入）
      *  04.07.09    NACL-門脇    14/03/01  労災マスタ追加対応
      *  04.07.10    NACL-門脇    14/03/04  平成２６年４月改正対応
      *  04.07.11    NACL-門脇    14/03/28  平成２６年４月改正対応
      *  04.07.12    NACL-門脇    14/04/28  運動器・脳血管リハの診療コード
      *                                     追加対応
      *  04.07.13    NACL-門脇    14/05/07  在宅の回数記載対応
      *  04.07.14    NACL-門脇    14/05/22  公務災害（労災準拠）の地公災特別
      *                                     加算対応（京都府）（コード追加分）
      *  04.07.15    NACL-門脇    14/05/23  「精神科を初めて受診した日」コメント
      *                                     の自動記載に関する修正
      *  04.07.16    NACL-門脇    14/07/31  第三者行為の現物給付対応
      *  04.07.17    NACL-藤原    14/08/19  患者コメントの入力コメントの
      *                                     改行コードチェック
      *                                     エラー時処理終了
      *  04.07.18    NACL-門脇    14/09/01  訪問診療にかかる記録書コメント対応
      *  04.07.19    NACL-門脇    14/09/01  平成２６年１０月改正対応
      *  04.07.20    NACL-門脇    14/09/11  摘要欄に印字しない診療行為コードの
      *                                     データ区分２、かつ、診療区分が点数
      *                                     マスタの診療区分と異なる場合の対応
      *  04.07.21    NACL-門脇    14/12/15  平成２７年１月改正対応
      *                                     （初再診料・低妥結率対応）
      *  04.07.22    NACL-門脇    15/01/15  外来管理加算（読み替え加算）チェッ
      *                                     ク
      *  04.07.23    NACL-門脇    15/03/09  訪問診療にかかる記録書コメント対応
      *  04.07.24    NACL-門脇    15/03/16  平成２７年４月改正対応
      *  04.07.25    NACL-門脇    15/09/08  自賠責（新様式）（ＯＣＲ様式）
      *                                     受領金額欄記載対応
      *
      *  04.08.01    NACL-門脇    13/01/22  日数回数テーブル１０回対応
      *  04.08.02    NACL-門脇    13/01/25  包括診療分の点検用レセプト記載対応
      *  04.08.03    NACL-藤原    14/07/07  一時ディレクトリ対応
      *  04.08.04    NACL-門脇    14/07/23  ３２文字以上の文字列修正
      *                                     （コンパイル時のワーニング修正）
      *  04.08.05    NACL-門脇    15/08/27  自賠責レセプトの請求金額欄端数処理
      *                                     対応
      *  04.08.06    NACL-門脇    15/10/19  労災レセプト回数１回目の
      *                                     「継続請求分」対応
      *  04.08.07    NACL-門脇    15/12/24  器材の単価編集修正
      *  04.08.08    NACL-門脇    16/01/12  点検用レセプト院外処方一般名記載対応
      *  04.08.09    NACL-門脇    16/03/28  平成２８年４月改正対応
      *  04.08.10    NACL-門脇    16/05/20  標準負担額経過措置（精神）入院年月日
      *                                     のコメント対応
      *  04.08.11    NACL-門脇    16/09/15  リハビリマスタ追加対応
      *  04.08.12    NACL-門脇    16/09/20  １５円以下薬剤の提出用レセプト記載
      *                                     （記録）対応
      *  04.08.13    NACL-門脇    16/09/27  在宅患者訪問リハビリテーション指導
      *                                     管理料の算定日コメント対応
      *  04.08.14    NACL-門脇    16/11/07  １５円以下薬剤の提出用レセプト記載
      *                                     （記録）対応修正
      *  04.08.15    NACL-門脇    16/12/07  遠隔モニタリング加算の前回算定年月
      *                                     コメント記載修正
      *  04.08.16    NACL-門脇    17/02/24  未コード化特定器材コードを使用した
      *                                     レセ電請求が不可となる事に伴う対応
      *  04.08.17    NACL-門脇    17/03/27  請求金額０円レセプト作成対応
      *  04.08.18    NACL-門脇    17/06/01  湿布薬用法レセプト記載修正
      *  04.08.19    NACL-門脇    17/10/18  入院料と異なる保険組み合わせ
      *                                     での食事算定対応
      *  04.08.20    NACL-門脇    17/12/15  第三者行為現物給付に関わる
      *                                     負担金計算対応
      *  04.08.21    NACL-門脇    18/03/27  平成３０年４月改正対応
      *  04.08.22    NACL-門脇    18/05/02  残量廃棄コメントの記載内容修正
      *  04.08.23    NACL-門脇    18/05/07  平成３０年４月改正対応
      *  04.08.24    NACL-門脇    18/06/11  逓減点数集計に関する修正
      *  04.08.25    NACL-門脇    18/06/25  電子画像管理加算の記載順修正
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION           SECTION.
       INPUT-OUTPUT            SECTION.
       FILE-CONTROL.
           SELECT  RECE41-FILE     ASSIGN  RECE41PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE41-KEY
                                   FILE    STATUS  IS  STS-RECE41.
           SELECT  RECE44-FILE     ASSIGN  RECE44PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE44-KEY
                                   FILE    STATUS  IS  STS-RECE44.
           SELECT  RECE4A-FILE     ASSIGN  RECE4APARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE4A-KEY
                                   FILE    STATUS  IS  STS-RECE4A.
           SELECT  RECE45-FILE     ASSIGN  RECE45PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE45-KEY
                                   FILE    STATUS  IS  STS-RECE45.
           SELECT  RECE4B-FILE     ASSIGN  RECE4BPARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE4B-KEY
                                   FILE    STATUS  IS  STS-RECE4B.
      *    レセ電用
           SELECT  RECE44C-FILE    ASSIGN  RECE44CPARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE44C-KEY
                                   FILE    STATUS  IS  STS-RECE44C.
           SELECT  RECE45C-FILE    ASSIGN  RECE45CPARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE45C-KEY
                                   FILE    STATUS  IS  STS-RECE45C.
      *    エラーファイル
           SELECT  RECEERR-FILE    ASSIGN  RECEERR
                                   FILE    STATUS  IS  STS-RECEERR.
      *
       DATA                    DIVISION.
       FILE                    SECTION.
      *
       FD  RECE41-FILE.
       01  RECE41-REC. 
           COPY    "CPRCF041.INC".
      *
       FD  RECE44-FILE.
       01  RECE44-REC. 
           COPY    "CPRCF044.INC".
      *
       FD  RECE4A-FILE.
       01  RECE4A-REC. 
           COPY    "CPRCF044.INC"  REPLACING  //RECE44//
                                   BY         //RECE4A//.
      *
       FD  RECE45-FILE.
       01  RECE45-REC. 
           COPY    "CPRCF045.INC".
      *
       FD  RECE4B-FILE.
       01  RECE4B-REC. 
           COPY    "CPRCF045.INC"  REPLACING  //RECE45//
                                   BY         //RECE4B//.
      *
      *    レセ電用
       FD  RECE44C-FILE.
       01  RECE44C-REC. 
           COPY    "CPRCF044.INC"  REPLACING  //RECE44//
                                   BY         //RECE44C//.
      *
       FD  RECE45C-FILE.
       01  RECE45C-REC. 
           COPY    "CPRCF045.INC"  REPLACING  //RECE45//
                                   BY         //RECE45C//.
      *
      *    エラーファイル
       FD  RECEERR-FILE.
       01  RECEERR-REC             PIC X(200). 
      *
       WORKING-STORAGE             SECTION.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE41//.
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE44//.
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE4A//.
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE45//.
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE4B//.
      *    レセ電用
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE44C//.
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE45C//.
      *    エラーファイル 名称領域 
           COPY    "CPERRFL.INC"   REPLACING  //ERRFLPARA//
                                   BY         //RECEERR//.
      *
      *    フラグ領域
       01  STS-AREA.
           03  STS-RECE41                              PIC X(02).
           03  STS-RECE44                              PIC X(02).
           03  STS-RECE45                              PIC X(02).
           03  STS-RECE4A                              PIC X(02).
           03  STS-RECE4B                              PIC X(02).
           03  STS-RECE44C                             PIC X(02).
           03  STS-RECE45C                             PIC X(02).
           03  STS-RECEERR                             PIC X(02).
      *
       01  FLG-AREA.
           03  FLG-END                                 PIC 9(01).
           03  FLG-SRYACCT                             PIC 9(01).
           03  FLG-SRYACT                              PIC 9(01).
           03  FLG-TENSU                               PIC 9(01).
           03  FLG-ZAITAKU                             PIC 9(01).
           03  FLG-OSINKBN                             PIC 9(01).
           03  FLG-PTCOM                               PIC 9(01).
           03  FLG-SYSKANRI                            PIC 9(01).
           03  FLG-DAY                                 PIC 9(01).
           03  FLG-SP                                  PIC 9(01). 
           03  FLG-ZANHAIKI                            PIC 9(01).
           03  FLG-FORMAL-KISAI                        PIC 9(01).
           03  FLG-RECE45                              PIC 9(01).
           03  FLG-REWRITE                             PIC 9(01).
           03  FLG-SET                                 PIC 9(01).
           03  FLG-HOUSIJI-COM                         PIC 9(01).
           03  FLG-OSIN-COM                            PIC 9(01).
           03  FLG-ZAIHOU-COM                          PIC 9(01).
           03  FLG-SYOUNI-COM                          PIC 9(01).
           03  FLG-HOUTEN-COM                          PIC 9(01).
           03  FLG-SYOBYO-COM                          PIC 9(01).
           03  FLG-RYOYO-COM                           PIC 9(01).
           03  FLG-SYODOU-COM                          PIC 9(01).
           03  FLG-SAIDOU-COM                          PIC 9(01).
           03  FLG-NIKOCHIN-COM                        PIC 9(01).
           03  FLG-ZAIKYO-COM                          PIC 9(01).
           03  FLG-BOKOHO-COM                          PIC 9(01).
           03  FLG-IZONSYO-COM                         PIC 9(01).
           03  FLG-NINRYO-COM                          PIC 9(01).
           03  FLG-ZENSOKU-COM                         PIC 9(01).
           03  FLG-KENSA-COM                           PIC 9(01).
           03  FLG-ZAIRIHA-COM                         PIC 9(01).
           03  FLG-NYUSEN-COM                          PIC 9(01).
           03  FLG-KIATU-COM                           PIC 9(01).
           03  FLG-TAIGAI                              PIC 9(01).
           03  FLG-RINYAK                              PIC 9(01).
           03  FLG-TAISYO                              PIC 9(01).
           03  FLG-SRYACCTPLUS                         PIC 9(01).
           03  FLG-WRITE45                             PIC 9(01).
           03  FLG-WRITE45X                            PIC 9(01).
           03  FLG-TAHOKEN                             PIC 9(01).
           03  FLG-SRYKBN-HEN                          PIC 9(01).
           03  FLG-COUNT-ARI                           PIC 9(01).
           03  FLG-HENSYU-NG                           PIC 9(01).
           03  FLG-SETCOM                              PIC 9(01).
           03  FLG-SYUNOU                              PIC 9(01).
           03  FLG-ZAITAKU-CHECK                       PIC 9(01).
           03  FLG-DAISAN-GENBUTU                      PIC 9(01).
           03  FLG-KIN-OKIKAE                          PIC 9(01).
           03  FLG-KIN-OKIKAE2                         PIC 9(01).
           03  FLG-IRYORENKEI                          PIC 9(01).
           03  FLG-SIPPU-COM                           PIC 9(01).
           03  FLG-SIPPU-ARI                           PIC 9(01).
           03  FLG-YKZ-PRTKBN                          PIC 9(01).
      *
      *    基本点数の非表示判定用フラグ
       01  FLG-KHNTEN-AREA.
           03  FLG-KHNTEN2                             PIC 9(01).
           03  FLG-KHNTEN3                             PIC 9(01).
           03  FLG-KHNTEN4                             PIC 9(01).
           03  FLG-KHNTEN5                             PIC 9(01).
           03  FLG-KHNTEN6                             PIC 9(01).
           03  FLG-KHNTEN15                            PIC 9(01).
           03  FLG-KHNTEN18                            PIC 9(01).
           03  FLG-KHNTEN19                            PIC 9(01).
      *
      *    基本点数の非表示判定用フラグ（自賠責用）
       01  FLG-KHNTEN-JI-AREA.                                          
           03  FLG-KHNTEN10-JI                         PIC 9(01).       
           03  FLG-KHNTEN13-JI                         PIC 9(01).       
           03  FLG-KHNTEN14-JI                         PIC 9(01).       
      *
      *    基本点数の非表示判定用フラグ（自賠責用：従来様式用）
       01  FLG-KHNTEN-JI2-AREA.                                          
           03  FLG-KHNTEN2-JI2                         PIC 9(01).
           03  FLG-KHNTEN3-JI2                         PIC 9(01).
           03  FLG-KHNTEN4-JI2                         PIC 9(01).
           03  FLG-KHNTEN5-JI2                         PIC 9(01).
           03  FLG-KHNTEN6-JI2                         PIC 9(01).
           03  FLG-KHNTEN11-JI2                        PIC 9(01).       
           03  FLG-KHNTEN14-JI2                        PIC 9(01).       
           03  FLG-KHNTEN15-JI2                        PIC 9(01).       
      *
      *    基本点数の非表示判定用フラグ（公務災害）
       01  FLG-KHNTEN-KO-AREA.
           03  FLG-KHNTEN2-KO                          PIC 9(01).
           03  FLG-KHNTEN3-KO                          PIC 9(01).
           03  FLG-KHNTEN4-KO                          PIC 9(01).
           03  FLG-KHNTEN5-KO                          PIC 9(01).
           03  FLG-KHNTEN6-KO                          PIC 9(01).
           03  FLG-KHNTEN7-KO                          PIC 9(01).
           03  FLG-KHNTEN8-KO                          PIC 9(01).
           03  FLG-KHNTEN17-KO                         PIC 9(01).
           03  FLG-KHNTEN19-KO                         PIC 9(01).
           03  FLG-KHNTEN21-KO                         PIC 9(01).
           03  FLG-KHNTEN22-KO                         PIC 9(01).
      *
      *    再診料基本点に関するフラグ
       01  FLG-SAISIN-AREA.
           03  FLG-SAISIN-ARI                          PIC 9(01).
           03  FLG-SAISIN-GAI-ARI                      PIC 9(01).
           03  FLG-JIKANTAI1-ARI                       PIC 9(01).
           03  FLG-JIKANTAI2-ARI                       PIC 9(01).
           03  FLG-JIKANTAI3-ARI                       PIC 9(01).
           03  FLG-MESAIKSN-ARI                        PIC 9(01).
           03  FLG-CHIHOKATU-ARI                       PIC 9(01).
           03  FLG-CHIHOKAT2-ARI                       PIC 9(01).
           03  FLG-SAITOKKSN-ARI                       PIC 9(01).
           03  FLG-SAITOKKSN-ARI2                      PIC 9(01).
           03  FLG-CHIHOKAT3-ARI                       PIC 9(01).
           03  FLG-CHIHOKAT4-ARI                       PIC 9(01).
           03  FLG-YAKRENKEI-ARI                       PIC 9(01).
           03  FLG-NINPU-ARI                           PIC 9(01).
           03  FLG-NINPU2-ARI                          PIC 9(01).
      *
      *    再診料基本点に関するカウント
       01  CNT-SAISIN-AREA.
           03  CNT-JIKANTAI1                           PIC 9(02).
           03  CNT-JIKANTAI2                           PIC 9(02).
           03  CNT-JIKANTAI3                           PIC 9(02).
           03  CNT-MESAIKSN                            PIC 9(02).
           03  CNT-CHIHOKATU                           PIC 9(02).
           03  CNT-CHIHOKAT2                           PIC 9(02).
           03  CNT-SAITOKKSN                           PIC 9(02).
           03  CNT-SAITOKKSN2                          PIC 9(02).
           03  CNT-NYUYOJI2                            PIC 9(02).
           03  CNT-CHIHOKAT3                           PIC 9(02).
           03  CNT-CHIHOKAT4                           PIC 9(02).
           03  CNT-YAKRENKEI                           PIC 9(02).
           03  CNT-NINPU                               PIC 9(02).
           03  CNT-NINPU2                              PIC 9(02).
           03  CNT-SAISIN-DOUJITU                      PIC 9(02).
           03  CNT-SAISIN-GAI-DOUJITU                  PIC 9(02).
           03  CNT-SAISIN-ONLINE                       PIC 9(02).
           03  CNT-SAISIN-ETC                          PIC 9(02).
           03  CNT-SAISIN-GAI-ETC                      PIC 9(02).
      *
      *    カウント領域
       01  CNT-AREA.
           03  CNT-IN                                  PIC 9(06).
           03  CNT-IN-COMMIT                           PIC 9(06).
           03  CNT-IN-CANCEL                           PIC 9(06).
           03  CNT-OUT1                                PIC 9(06).
           03  CNT-OUT2                                PIC 9(06).
           03  CNT-OUT3                                PIC 9(06).
           03  CNT-OUT4                                PIC 9(06).
           03  CNT-OUT5                                PIC 9(06).
           03  CNT-OUT6                                PIC 9(06).
           03  CNT-OUT7                                PIC 9(06).
      *
      *    添字領域
       01  IDX-AREA.
           03  IDX                                     PIC 9(03).
           03  IDX2                                    PIC 9(03).
           03  IDX3                                    PIC 9(03).
           03  IDX4                                    PIC 9(03).
           03  IDX5                                    PIC 9(03).
           03  IDX15                                   PIC 9(03).
           03  IDX17                                   PIC 9(03).
           03  IDX19                                   PIC 9(03).
           03  IDX20                                   PIC 9(03).
           03  IDX21                                   PIC 9(03).
           03  IDX22                                   PIC 9(02).
           03  IDX33                                   PIC 9(03).
           03  IDX34                                   PIC 9(03).
           03  IDXA                                    PIC 9(01).
           03  IDXB                                    PIC 9(03).
           03  IDXX                                    PIC 9(02).
           03  IDY                                     PIC 9(03).
           03  IDYY                                    PIC 9(02).
           03  IDW                                     PIC 9(03).
           03  IDW3                                    PIC 9(03).
           03  IDW4                                    PIC 9(03).
           03  IDW5                                    PIC 9(03).
           03  IDW6                                    PIC 9(03).
           03  IDW7                                    PIC 9(03).
           03  IDW8                                    PIC 9(03).
           03  ID1                                     PIC 9(03). 
           03  IDV                                     PIC 9(03).
           03  IDU                                     PIC 9(03).
           03  IDZ1                                    PIC 9(02).
           03  IDZ2                                    PIC 9(02).
           03  NUM-IDX                                 PIC 9(01).
           03  SYSKAN-IDX                              PIC 9(03).
           03  SYSKAN-IDX2                             PIC 9(03).
           03  FUKA-IDX                                PIC 9(03).
      *
      *    剤情報退避領域
       01  WK-ZAIKAISU                                 PIC S9(07).
       01  WK-ZAITEN                                   PIC S9(08).
       01  WK-SYUTEN                                   PIC S9(08).
       01  WK-KIZAITEN                                 PIC S9(08).
       01  WK-YKZTEN                                   PIC S9(08).
      *
      *    医療機関（基本情報）退避用領域
       01  TBL-SYS1001-T.
           03  TBL-SYS1001-OCC                         OCCURS  100.
               05  TBL-SYS1001                         PIC X(610).
      *    施設基準情報退避用領域
       01  TBL-SYS1006-T.
           03  TBL-SYS1006-OCC                         OCCURS  100.
               05  TBL-SYS10062                        PIC X(610).
               05  TBL-SYS10067                        PIC X(610).
      *    帳票編集区分情報退避用領域
       01  TBL-SYS1030-T.
           03  TBL-SYS1030-OCC                         OCCURS  100.
               05  TBL-SYS1030                         PIC X(610).
      *
      *    点数テーブル検索用対象日領域
       01  WK-TAIHI-AREA.
           03  WK-TAIHI-DAY                            PIC 9(02).
           03  WK-TAIHI-FLG                            PIC 9(01).
           03  WK-TAIHI-SRYYMD.
               05  WK-TAIHI-SRYYM                      PIC 9(06).
               05  WK-TAIHI-SRYD                       PIC 9(02).
      *
      *    点数マスタ情報退避領域
       01  WRK-TNS-TAIHI-AREA.
           03  WRK-TNS-TAIHI-TABLE                     OCCURS  5.
               05  WRK-TNS-CHUKSNTUBAN                 PIC X(01).
               05  WRK-TNS-DATAKBN                     PIC 9(01).
               05  WRK-TNS-TIMEKSNKBN                  PIC 9(01).
               05  WRK-TNS-TEN                         PIC 9(09)V99.    
               05  WRK-TNS-GAITENTTLKBN                PIC 9(03).
               05  WRK-TNS-OSINKBN                     PIC 9(01).
               05  WRK-TNS-KNSJISKBN                   PIC 9(01).
               05  WRK-TNS-SRYCD                       PIC X(09).
               05  WRK-TNS-JIBAISYUKEIKBN              PIC 9(01).
      *
      *    院外処方一般名編集情報退避領域
       01  WRK-ORCSGETGE-OUT-AREA.
           03  WRK-ORCSGETGE-OUT-TABLE                 OCCURS  50.
               05  WRK-ORCSGETGE-YAKKAKJNCD            PIC X(12).
               05  WRK-ORCSGETGE-GENERIC-KBN           PIC X(01).
               05  WRK-ORCSGETGE-GENERICNAME           PIC X(200).
      *
      *    手技点・薬剤等点数用領域
       01  TBL-TENSUG-JI.
           03  TBL-TENSU-JI                            OCCURS   50.
               05  TBL-SYUTEN-JI                       PIC  9(09).
               05  TBL-YKZTEN-JI                       PIC S9(09).
      *
       01  TBL-ZAITAKU-KAISU-XXX.
           03  TBL-ZAITAKU-KAISU-XXX2                  OCCURS   6.
             05  TBL-ZAITAKU-KAISU-XXX3                OCCURS   9.
               07  TBL-ZAITAKU-KAISU-XXX4              OCCURS  31.
                 09  TBL-ZAITAKU-KAISU                 PIC 9(03).
      *
      *    一時領域
       01  WRK-AREA.
           03  WRK-PARA.
               05  WRK-PARA-SRYYM                      PIC X(06).
               05  WRK-PARA-TERMID                     PIC X(16).
               05  WRK-PARA-SYSYMD                     PIC X(08).
               05  WRK-PARA-RECEKBN                    PIC X(01).
               05  WRK-PARA-JOBID                      PIC 9(07).
               05  WRK-PARA-SHELLID                    PIC X(08).
           03  WRK-PARA-JIBAIPRTKBN                    PIC X(01).
           03  WRK-PARA-PRTKBN                         PIC X(01).
           03  WRK-PARA-HOSPNUM                        PIC 9(02).
      *
           03  WRK-SYS-SRYYMD                          PIC X(08).
      *
           03  WRK-KEISAN                              PIC 9(09).
           03  WRK-KEISAN-KG                           PIC 9(09).
           03  WRK-KEISAN-KG2                          PIC 9(09).
           03  WRK-TEN                                 PIC 9(09).
           03  WRK-TEN-KG                              PIC 9(09).
           03  WRK-TEN-KG2                             PIC 9(09).
           03  WRK-MEISAI-CNT                          PIC 9(04).
           03  WRK-SRYCDTOTAL                          PIC 9(14).
           03  WRK-SURYOUTOTAL                         PIC 9(07)V9(05).
           03  WRK-KSNRATE                             PIC 9V99.    
           03  WRK-SRYCD                               PIC 9(09).   
           03  WRK-YOUBUKASAN                          PIC 9(07).
           03  WRK-KYOBUKASAN                          PIC 9(07).
           03  WRK-KEIBUKASAN                          PIC 9(07).
           03  WRK-SOGAIKASAN                          PIC 9(07).
           03  WRK-RYOYOTEATE                          PIC 9(07).
           03  WRK-RYOYOTEATE2                         PIC 9(07).
           03  WRK-ZAI-KINGAKU                         PIC 9(09).
      *
           03  WRK-KYUGYOFLG                           PIC X(01).
      *
           03  WRK-DAY                                 PIC 9(02).
      *
           03  WRK-ZAIKAISU-XXX                        PIC 9(03).
      *
           03  WRK-TANICD                              PIC 9(03).
           03  WRK-TANIMOJISU                          PIC 9(01).
           03  WRK-TANINAME                            PIC X(24).
           03  WRK-SRYSURYO                            PIC 9(05)V9(05).
           03  WRK-SRYSURYO2                           PIC 9(05).
           03  WRK-SRYSURYO3                           PIC 9(05).
           03  WRK-KZI058-TEN                          PIC 9(09)V99.
           03  WRK-KZI058-TANICD                       PIC 9(03).
           03  WRK-KZI058-TANIMOJISU                   PIC 9(01).
           03  WRK-KZI058-TANINAME                     PIC X(24).
           03  WRK-RENNUM                              PIC 9(02).
           03  WRK-RENNUM2                             PIC 9(02).
      *
           03  WRK-TEN-KZI                             PIC 9(09).
           03  WRK-TEN-BUN                             PIC 9(09).
      *
           03  WRK-SYUTEN-JI                           PIC 9(09).
           03  WRK-YKZTEN-JI                           PIC 9(09).
           03  WRK-KINGAKU-JI                          PIC 9(09).
      *
      *    消費税端数区分
           03  WRK-TAX1001-KBN                         PIC X(01).
           03  WRK-HASU1001-JIBAI                      PIC X(01).
           03  WRK-HASU1001-DAISAN                     PIC X(01).
      *
           03  WRK-SISETU613                           PIC 9(01).
           03  WRK-SISETU695                           PIC 9(01).
           03  WRK-SISETU3055                          PIC 9(01).
           03  WRK-SISETU3056                          PIC 9(01).
           03  WRK-SISETU3057                          PIC 9(01).
           03  WRK-SISETU3058                          PIC 9(01).
           03  WRK-SISETU3168                          PIC 9(01).
           03  WRK-SISETU3169                          PIC 9(01).
      *
      *    数字半角全角変換用     
           03  WRK-CHAR-IDX                    PIC 9(02).
           03  WRK-CHAR-HENKAN-AREA.
               05  WRK-CHAR-X                  PIC X(20).
               05  WRK-CHAR-N                  PIC X(40).
               05  WRK-CHAR-CNT                PIC 9(02).
               05  WRK-CHAR-N-CNT              PIC 9(02).
      *     
      *    単価編集用     
           03  WRK-TANKA-9                     PIC 9(09)V9(02).
           03  WRK-TANKA-R  REDEFINES  WRK-TANKA-9.
               05  WRK-TANKA-S1                PIC 9(09).
               05  WRK-TANKA-S2                PIC 9(02).
           03  WRK-TANKA-X.
               05  WRK-TANKA-Z1                PIC ZZZZZZZZ9.
               05  WRK-TANKA-Z2                PIC X(01).
               05  WRK-TANKA-Z3                PIC ZZ.
      *
      ***  03  WRK-FUKA-KINGAKU                PIC 9(09).
           03  WRK-FUKA-KINGAKU                PIC 9(13)V9(05).
           03  WRK-FUKA-VALUE                  PIC 9(01).
      *
           03  WRK-ZAITENNASHI                 PIC 9(09).
      *
           03  WRK-SURYOU-COUNT                PIC 9(09).
      *
      *    数量編集用
           03  WRK-SURYOKETA                   PIC 9(02).
           03  WRK-SURYOKETA1                  PIC 9(02).
           03  WRK-SURYOKETA2                  PIC 9(02).
           03  WRK-SURYOST                     PIC 9(02).
           03  WRK-SURYO                       PIC 9(05)V9(05).
           03  WRK-SURYO-R  REDEFINES  WRK-SURYO.
               05  WRK-SURYO-S1                PIC 9(05).
               05  WRK-SURYO-S2                PIC 9(05).
           03  WRK-SURYO-X.
               05  WRK-SURYO-Z1                PIC ZZZZZ.
               05  WRK-SURYO-Z2                PIC X(01).
               05  WRK-SURYO-Z3                PIC ZZZZZ.
           03  WRK-SURYO-N.
               05  WRK-SURYO-N1                PIC X(10).
               05  WRK-SURYO-N2                PIC X(02).
               05  WRK-SURYO-N3                PIC X(10).
           03  WRK-SRYSURYOW                   PIC X(24).
      *
           03  WRK-FORMALNAME                  PIC X(300).
      *
           03  WRK-SETCOM-JIDO                 PIC 9(03).
           03  WRK-SETCOM-JIDO2                PIC 9(03).
      *
           03  WRK-CHECK-SRYCD                 PIC X(09).
      *
           03  WRK-FUTANWARI                   PIC 9V99.
      *
           03  WRK-DAISAN-FTNMONEY             PIC 9(08).
           03  WRK-DAISAN-FTNMONEY2            PIC 9(08).
           03  WRK-DAISAN-DAISANKBN            PIC X(01).
           03  WRK-DAISAN-TOTALTEN-SYUNOU      PIC 9(08).
           03  WRK-DAISAN-ACCT-UPDKBN          PIC X(01).
           03  WRK-DAISAN-TOTALTEN             PIC 9(08).
      *
           03  WRK-S1                          PIC 9(03).
           03  WRK-S2                          PIC 9(03).
           03  WRK-S3                          PIC 9V99999.
           03  WRK-S4                          PIC 9V99.
           03  WRK-S5                          PIC 9V99.
      *
           03  WRK-COL                         PIC 9(03).
      *
           03  WRK-TAIHI-ZAINUM                PIC 9(08).
           03  WRK-TAIHI-ZAINUM2               PIC 9(08).
      *
           03  WRK-INPUTCOMENT                 PIC X(80).
           03  WRK-INPUTCOMENT2                PIC X(14).
           03  WRK-INPUTCOMENT3                PIC X(30).
           03  WRK-INPUTCOMENT-KIN-T.
               05  WRK-INPUTCOMENT-KIN         PIC 9(07).
           03  WRK-INPUTCOMENT-KIN2-T.
               05  WRK-INPUTCOMENT-KIN2        PIC X(07).
      *
           03  WRK-JIBAI-SKYKIN-A              PIC 9(09).
           03  WRK-JIBAI-SKYKIN-B              PIC 9(09).
      *
           03  WRK-1030-KOUHATUKA              PIC X(01).
      *
      *---------------------------------------------------------------
      *  回数減算用退避領域
      *    処方減回数
           03  WRK-SYOHOU-KAISU                PIC 9(03).
      *    処方せん減回数
           03  WRK-SYOSEN-KAISU                PIC 9(03).
      *    処方料（麻・向・毒・覚）
           03  WRK-MADOKU-SHOHO                PIC 9(03).
      *---------------------------------------------------------------
      *
      *    固定値
       01  CONST-AREA.
      *    継続管理加算
           03  CONS-KEIZOKU1   PIC X(09)     VALUE "112007170".
           03  CONS-KEIZOKU2   PIC X(09)     VALUE "112702270".
      *    外来診療料（１回目）
           03  CONS-GAIRAIRYO1 PIC X(09)     VALUE "112011310".
           03  CONS-GAIRAIRYO2 PIC X(09)     VALUE "112705510".
           03  CONS-GAIRAIRYO3 PIC X(09)     VALUE "112011710".
           03  CONS-GAIRAIRYO4 PIC X(09)     VALUE "112016310".
           03  CONS-GAIRAIRYO5 PIC X(09)     VALUE "112016550".
           03  CONS-GAIRAIRYO6 PIC X(09)     VALUE "112017310".
           03  CONS-GAIRAIRYO7 PIC X(09)     VALUE "112017450".
      *    処方せん料
           03  CONS-SHOHOSEN1 PIC X(09)      VALUE "120002710".
           03  CONS-SHOHOSEN2 PIC X(09)      VALUE "120002810".
           03  CONS-SHOHOSEN3 PIC X(09)      VALUE "120002910".
           03  CONS-SHOHOSEN4 PIC X(09)      VALUE "120003010".
           03  CONS-SHOHOSEN5 PIC X(09)      VALUE "120003710".
      *    処方せん料加算
           03  CONS-SHOHOKSN1  PIC X(09)     VALUE "120002470".
           03  CONS-SHOHOKSN2  PIC X(09)     VALUE "120002570".
           03  CONS-SHOHOKSN3  PIC X(09)     VALUE "120003270".
           03  CONS-SHOHOKSN4  PIC X(09)     VALUE "120003470".
           03  CONS-SHOHOKSN5  PIC X(09)     VALUE "120003570".
           03  CONS-SHOHOKSN6  PIC X(09)     VALUE "120003970".
           03  CONS-SHOHOKSN7  PIC X(09)     VALUE "120004270".
           03  CONS-SHOHOKSN8  PIC X(09)     VALUE "120004570".
      *    薬剤料逓減（９０／１００）（内服薬）
           03  CONS-YAKTEIGEN  PIC X(09)     VALUE "630010002".
      *    薬剤料逓減（８０／１００）（向精神薬多剤投与）
           03  CONS-YAKTEIGEN2 PIC X(09)     VALUE "630010005".
      *    薬剤料逓減（６０／１００）（紹介率が低い大病院３０日以上投薬）
           03  CONS-YAKTEIGEN3 PIC X(09)     VALUE "630010006".
      *    薬剤料減点（湿布薬薬剤料上限超）
           03  CONS-YAKTEIGEN4 PIC X(09)     VALUE "630010007".
      *    （減）
           03  CONS-GEN        PIC X(09)     VALUE "820000047".
      *    （精減）
           03  CONS-GEN2       PIC X(09)     VALUE "820000166".
      *    粉砕（コメント）
           03  CONS-FUNSAI-COMMENT PIC X(09) VALUE "099209901".
      *    採血（Ｂ−Ａ）
           03  CONS-SAIKETSU1      PIC X(09) VALUE "160101210".
      *    採血（Ｂ−Ｖ）
           03  CONS-SAIKETSU2      PIC X(09) VALUE "160095710".
      *    採血（Ｂ−Ｃ）
           03  CONS-SAIKETSU3      PIC X(09) VALUE "160095810".
      *    乳幼児加算
           03  CONS-NYUKSN1        PIC X(09) VALUE "111000370".         
           03  CONS-NYUKSN2        PIC X(09) VALUE "111011470".
           03  CONS-NYUKSN3        PIC X(09) VALUE "111011970".
           03  CONS-NYUKSN4        PIC X(09) VALUE "111012070".
           03  CONS-NYUKSN5        PIC X(09) VALUE "111012170".
           03  CONS-NYUKSN6        PIC X(09) VALUE "111012270".
           03  CONS-NYUKSN7        PIC X(09) VALUE "111011570".
           03  CONS-NYUKSN8        PIC X(09) VALUE "111011670".
           03  CONS-NYUKSN9        PIC X(09) VALUE "111011770".
      *    再診（３月超）（５回超）など
      *    （４６５に関係あり）
           03  CONS-SAISHIN-A1     PIC X(09) VALUE "101120060".
      *    外来管理加算（３月超）（５回超）
      *    （４６０に関係あり）
           03  CONS-GAIRAI         PIC X(09) VALUE "101120090".
      *    労災自賠責関係
           03  CONS-ROUSAI1    PIC X(09)   VALUE   "101110010".
           03  CONS-ROUSAI3    PIC X(09)   VALUE   "101110030".
           03  CONS-ROUSAI4    PIC X(09)   VALUE   "101120030".
           03  CONS-ROUSAI5    PIC X(09)   VALUE   "101120040".
           03  CONS-ROUSAI6    PIC X(09)   VALUE   "101120050".
           03  CONS-ROUSAI7    PIC X(09)   VALUE   "101120060".
           03  CONS-ROUSAI8    PIC X(09)   VALUE   "101130010".
           03  CONS-ROUSAI9    PIC X(09)   VALUE   "101130020".
           03  CONS-ROUSAI10   PIC X(09)   VALUE   "101130030".
           03  CONS-ROUSAI11   PIC X(09)   VALUE   "101130040".
           03  CONS-ROUSAI12   PIC X(09)   VALUE   "101130050".
           03  CONS-ROUSAI13   PIC X(09)   VALUE   "101130060".
           03  CONS-ROUSAI14   PIC X(09)   VALUE   "101130070".
           03  CONS-ROUSAI15   PIC X(09)   VALUE   "101130080".
           03  CONS-ROUSAI16   PIC X(09)   VALUE   "101130090".
           03  CONS-ROUSAI17   PIC X(09)   VALUE   "101130100".
           03  CONS-ROUSAI18   PIC X(09)   VALUE   "101110040".
           03  CONS-ROUSAI19   PIC X(09)   VALUE   "101120100".
      *
           03  CONS-ROUSAI20   PIC X(09)   VALUE   "101800870".
           03  CONS-ROUSAI21   PIC X(09)   VALUE   "101800470".
           03  CONS-ROUSAI22   PIC X(09)   VALUE   "101800480".
           03  CONS-ROUSAI23   PIC X(09)   VALUE   "101800490".
           03  CONS-ROUSAI24   PIC X(09)   VALUE   "101800500".
           03  CONS-ROUSAI25   PIC X(09)   VALUE   "101800510".
           03  CONS-ROUSAI26   PIC X(09)   VALUE   "101800520".
           03  CONS-ROUSAI27   PIC X(09)   VALUE   "101800530".
           03  CONS-ROUSAI28   PIC X(09)   VALUE   "101800540".
           03  CONS-ROUSAI29   PIC X(09)   VALUE   "101800960".
           03  CONS-ROUSAI30   PIC X(09)   VALUE   "101800970".
           03  CONS-ROUSAI31   PIC X(09)   VALUE   "101800980".
      *
           03  CONS-ROUSAI32   PIC X(09)   VALUE   "101800890".
           03  CONS-ROUSAI33   PIC X(09)   VALUE   "101130190".
           03  CONS-ROUSAI34   PIC X(09)   VALUE   "101120010".
      *
           03  CONS-ROUSAI35   PIC X(09)   VALUE   "101120050".
           03  CONS-ROUSAI36   PIC X(09)   VALUE   "101120060".
           03  CONS-ROUSAI37   PIC X(09)   VALUE   "101120070".
           03  CONS-ROUSAI38   PIC X(09)   VALUE   "101120080".
      *
           03  CONS-ROUSAI39   PIC X(09)   VALUE   "101801040".
      *
           03  CONS-ROUCOM1    PIC X(09)   VALUE   "840800001".
           03  CONS-ROUCOM2    PIC X(09)   VALUE   "840800002". 
      *
      *    腰部固定帯加算
           03  CONS-YOUBUKASAN PIC X(09)   VALUE   "140037490".
      *    胸部固定帯加算
           03  CONS-KYOBUKASAN PIC X(09)   VALUE   "140040110".
      *    頸部固定帯加算
           03  CONS-KEIBUKASAN PIC X(09)   VALUE   "140052610".
      *    創外固定器使用加算
           03  CONS-SOGAIKASAN PIC X(09)   VALUE   "150266970".
      *    療養担当手当て
           03  CONS-RYOYOTEATE PIC X(09)   VALUE   "199000610".
      *
      *    フィルム料（乳幼児）加算
           03  CONS-FILM-YOUJI-KASAN  
                               PIC X(09)   VALUE   "799990070".
      *    酸素補正率
           03  CONS-SANSO      PIC X(09)   VALUE   "770020070".
      *    高気圧酸素加算
           03  CONS-SANSO2     PIC X(09)   VALUE   "770030070".
      *    残量廃棄
           03  CONS-ZANHAIKI   PIC X(09)   VALUE   "099309901".
      *
      *    慢性とう痛疾患
           03  CONS-MANSEI           PIC X(09)  VALUE  "113006510".
      *    傷病手当金意見書交付料
           03  CONS-SYOBYO-COMMENT   PIC X(09)  VALUE  "180000710".
      *    傷病手当金意見書交付年月日
           03  CONS-SYOBYO2-COMMENT  PIC X(09)  VALUE  "840000011".
      *    （相続）傷病手当金意見書交付年月日
           03  CONS-SYOBYO3-COMMENT  PIC X(09)  VALUE  "840000012".
      *    療養費同意書交付料
           03  CONS-RYOYO-COMMENT    PIC X(09)  VALUE  "113004310".
      *    療養費同意書交付年月日
           03  CONS-RYOYO2-COMMENT   PIC X(09)  VALUE  "840000078".
      *    訪問看護指示料
           03  CONS-HOUSIJI-COMMENT  PIC X(09)  VALUE  "114008010".
      *    訪問看護指示料算定日
           03  CONS-HOUSIJI2-COMMENT PIC X(09)  VALUE  "840000073".
      *    手術日コメント
           03  CONS-SHUJUTU-COMMENT  PIC X(09)  VALUE  "840000042".
      *    頭部単純ＣＴ撮影
           03  CONS-CTMRI-COMMENT1   PIC X(09)  VALUE  "170011710".
      *    躯幹単純ＣＴ撮影
           03  CONS-CTMRI-COMMENT2   PIC X(09)  VALUE  "170011810".
      *    四肢単純ＣＴ撮影
           03  CONS-CTMRI-COMMENT3   PIC X(09)  VALUE  "170011910".
      *    脳槽ＣＴ造影
           03  CONS-CTMRI-COMMENT4   PIC X(09)  VALUE  "170012110".
      *    頸部単純ＣＴ撮影
           03  CONS-CTMRI-COMMENT5   PIC X(09)  VALUE  "170015550".
      *    頭部単純ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT6   PIC X(09)  VALUE  "170015210".
      *    躯幹単純ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT7   PIC X(09)  VALUE  "170020110".
      *    四肢単純ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT8   PIC X(09)  VALUE  "170022110".
      *    ＣＴ、ＭＲＩ（頭部）（２回目以降）
           03  CONS-CTMRI-COMMENT9   PIC X(09)  VALUE  "170022290".
      *    ＣＴ、ＭＲＩ（躯幹）（２回目以降）
           03  CONS-CTMRI-COMMENT10  PIC X(09)  VALUE  "170022390".
      *    ＣＴ、ＭＲＩ（四肢）（２回目以降）
           03  CONS-CTMRI-COMMENT11  PIC X(09)  VALUE  "170022490".
      *    頭部特殊ＣＴ撮影
           03  CONS-CTMRI-COMMENT12  PIC X(09)  VALUE  "170023010".
      *    躯幹特殊ＣＴ撮影
           03  CONS-CTMRI-COMMENT13  PIC X(09)  VALUE  "170023110".
      *    四肢特殊ＣＴ撮影
           03  CONS-CTMRI-COMMENT14  PIC X(09)  VALUE  "170023210".
      *    頭部特殊ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT15  PIC X(09)  VALUE  "170023310".
      *    躯幹特殊ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT16  PIC X(09)  VALUE  "170023410".
      *    四肢特殊ＭＲＩ撮影
           03  CONS-CTMRI-COMMENT17  PIC X(09)  VALUE  "170023510".
      *    ＣＴ撮影（１６列未満マルチスライス型機器）
           03  CONS-CTMRI-COMMENT18  PIC X(09)  VALUE  "170028610".
      *    ＣＴ撮影（６４列以上マルチスライス型機器）
           03  CONS-CTMRI-COMMENT19  PIC X(09)  VALUE  "170033410".
      *    ＭＲＩ撮影（３テスラ以上の機器）
           03  CONS-CTMRI-COMMENT20  PIC X(09)  VALUE  "170033510".
      *    ＣＴ撮影（６４列以上マルチスライス型機器）（共同利用施設）
           03  CONS-CTMRI-COMMENT21  PIC X(09)  VALUE  "170034910".
      *    ＭＲＩ撮影（３テスラ以上の機器）（共同利用施設）
           03  CONS-CTMRI-COMMENT22  PIC X(09)  VALUE  "170035010".
      *    在宅血液透析頻回指導管理料
           03  CONS-HINKAI-COMMENT   PIC X(09)  VALUE  "114009410".
      *    初診（同日複数診療科）
           03  CONS-SYODOU-COMMENT   PIC X(09)  VALUE  "111011810".
      *    複初算定診療科：
           03  CONS-SYODOU2-COMMENT  PIC X(09)  VALUE  "830000024".
      *    初診料（同一日２科目：紹介状なし）
           03  CONS-SYODOU3-COMMENT  PIC X(09)  VALUE  "111012610".
      *    初診（同一日複数科受診時の２科目・妥結率５割以下）
           03  CONS-SYODOU4-COMMENT  PIC X(09)  VALUE  "111012810".
      *    ニコチン依存症管理料（初回）
           03  CONS-NIKOCHIN-COMMENT PIC X(09)  VALUE  "113008310".
      *    ニコチン依存症管理料（２回目から４回目まで）
           03  CONS-NIKOCHIN2-COMMENT PIC X(09) VALUE  "113008410".
      *    ニコチン依存症管理料（５回目）
           03  CONS-NIKOCHIN3-COMMENT PIC X(09) VALUE  "113008510".
      *    初回算定　　月　日
           03  CONS-NIKOCHIN4-COMMENT PIC X(09) VALUE  "840000097".
      *    重度喘息患者治療管理加算（１月目）
           03  CONS-ZENSOKU-COMMENT  PIC X(09)  VALUE  "113008070".
      *    重度喘息患者治療管理加算（２月目以降６月目まで）
           03  CONS-ZENSOKU2-COMMENT PIC X(09)  VALUE  "113008170".
      *    第１回目治療管理　　月　日
           03  CONS-ZENSOKU3-COMMENT PIC X(09)  VALUE  "840000098".
      *    心大血管疾患リハビリテーション料（１）
           03  CONS-SINDAI1-COMMENT  PIC X(09)  VALUE  "180027410".
      *    心大血管疾患リハビリテーション料（２）
           03  CONS-SINDAI2-COMMENT  PIC X(09)  VALUE  "180027510".
      **   心大血管疾患リハビリテーション料（１）（１２０日超）
           03  CONS-SINDAI3-COMMENT  PIC X(09)  VALUE  "180029110".
      **   心大血管疾患リハビリテーション料（２）（１２０日超）
           03  CONS-SINDAI4-COMMENT  PIC X(09)  VALUE  "180029210".
      **   心大血管疾患リハビリテーション医学管理料（１）
           03  CONS-SINDAI5-COMMENT  PIC X(09)  VALUE  "180029910".
      **   心大血管疾患リハビリテーション医学管理料（２）
           03  CONS-SINDAI6-COMMENT  PIC X(09)  VALUE  "180030010".
      *!   心大血管疾患リハビリテーション料（１）
           03  CONS-SINDAI7-COMMENT  PIC X(09)  VALUE  "101800080".
      *!   心大血管疾患リハビリテーション料（２）
           03  CONS-SINDAI8-COMMENT  PIC X(09)  VALUE  "101800090".
      *#   心大血管疾患リハビリテーション料（１）
           03  CONS-SINDAI9-COMMENT  PIC X(09)  VALUE  "101800230".
      *#   心大血管疾患リハビリテーション料（２）
           03  CONS-SINDAI10-COMMENT PIC X(09)  VALUE  "101800240".
      *    呼吸器リハビリテーション料（１）
           03  CONS-KOKYUKI1-COMMENT PIC X(09)  VALUE  "180028010".
      *    呼吸器リハビリテーション料（２）
           03  CONS-KOKYUKI2-COMMENT PIC X(09)  VALUE  "180028110".
      **   呼吸器リハビリテーション料（１）（８０日超）
           03  CONS-KOKYUKI3-COMMENT PIC X(09)  VALUE  "180029710".
      **   呼吸器リハビリテーション料（２）（８０日超）
           03  CONS-KOKYUKI4-COMMENT PIC X(09)  VALUE  "180029810".
      **   呼吸器リハビリテーション医学管理料（１）
           03  CONS-KOKYUKI5-COMMENT PIC X(09)  VALUE  "180030510".
      **   呼吸器リハビリテーション医学管理料（２）
           03  CONS-KOKYUKI6-COMMENT PIC X(09)  VALUE  "180030610".
      *!   呼吸器リハビリテーション料（１）
           03  CONS-KOKYUKI7-COMMENT PIC X(09)  VALUE  "101800150".
      *!   呼吸器リハビリテーション料（２）
           03  CONS-KOKYUKI8-COMMENT PIC X(09)  VALUE  "101800160".
      *#   呼吸器リハビリテーション料（１）
           03  CONS-KOKYUKI9-COMMENT PIC X(09)  VALUE  "101800340".
      *#   呼吸器リハビリテーション料（２）
           03  CONS-KOKYUKI10-COMMENT PIC X(09) VALUE  "101800350".
      *    脳血管疾患等リハビリテーション料（１）
           03  CONS-NOUKE1-COMMENT   PIC X(09)  VALUE  "180027610".
      *    脳血管疾患等リハビリテーション料（２）
           03  CONS-NOUKE2-COMMENT   PIC X(09)  VALUE  "180027710".
      **   脳血管疾患等リハビリテーション料（１）（１４０日超）
           03  CONS-NOUKE3-COMMENT   PIC X(09)  VALUE  "180029310".
      **   脳血管疾患等リハビリテーション料（２）（１４０日超）
           03  CONS-NOUKE4-COMMENT   PIC X(09)  VALUE  "180029410".
      **   脳血管疾患等リハビリテーション医学管理料（１）
           03  CONS-NOUKE5-COMMENT   PIC X(09)  VALUE  "180030110".
      **   脳血管疾患等リハビリテーション医学管理料（２）
           03  CONS-NOUKE6-COMMENT   PIC X(09)  VALUE  "180030210".
      *    脳血管疾患等リハビリテーション料（３）
           03  CONS-NOUKE7-COMMENT   PIC X(09)  VALUE  "180030810".
      *!   脳血管疾患等リハビリテーション料（１）
           03  CONS-NOUKE8-COMMENT   PIC X(09)  VALUE  "101800100".
      *!   脳血管疾患等リハビリテーション料（２）
           03  CONS-NOUKE9-COMMENT   PIC X(09)  VALUE  "101800110".
      *!   脳血管疾患等リハビリテーション料（３）
           03  CONS-NOUKE10-COMMENT  PIC X(09)  VALUE  "101800120".
      *    脳血管疾患等リハビリテーション料（１）（廃用症候群）
           03  CONS-NOUKE11-COMMENT  PIC X(09)  VALUE  "180032410".
      *    脳血管疾患等リハビリテーション料（２）（廃用症候群）
           03  CONS-NOUKE12-COMMENT  PIC X(09)  VALUE  "180032510".
      *    脳血管疾患等リハビリテーション料（３）（廃用症候群）
           03  CONS-NOUKE13-COMMENT  PIC X(09)  VALUE  "180032610".
      *    脳血管疾患等リハビリテーション料（１）（要介護・廃用症候群以外）
           03  CONS-NOUKE14-COMMENT  PIC X(09)  VALUE  "180033910".
      *    脳血管疾患等リハビリテーション料（１）（要介護・廃用症候群）
           03  CONS-NOUKE15-COMMENT  PIC X(09)  VALUE  "180034010".
      *    脳血管疾患等リハビリテーション料（２）（要介護・廃用症候群以外）
           03  CONS-NOUKE16-COMMENT  PIC X(09)  VALUE  "180034110".
      *    脳血管疾患等リハビリテーション料（２）（要介護・廃用症候群）
           03  CONS-NOUKE17-COMMENT  PIC X(09)  VALUE  "180034210".
      *    脳血管疾患等リハビリテーション料（３）（要介護・廃用症候群以外）
           03  CONS-NOUKE18-COMMENT  PIC X(09)  VALUE  "180034310".
      *    脳血管疾患等リハビリテーション料（３）（要介護・廃用症候群）
           03  CONS-NOUKE19-COMMENT  PIC X(09)  VALUE  "180034410".
      *#   脳血管疾患等リハビリテーション料（１）
           03  CONS-NOUKE20-COMMENT  PIC X(09)  VALUE  "101800250".
      *#   脳血管疾患等リハビリテーション料（２）
           03  CONS-NOUKE21-COMMENT  PIC X(09)  VALUE  "101800260".
      *#   脳血管疾患等リハビリテーション料（３）
           03  CONS-NOUKE22-COMMENT  PIC X(09)  VALUE  "101800270".
      *    脳血管疾患等リハビリテーション料１（要介・廃用症以外）基準不適合
           03  CONS-NOUKE23-COMMENT  PIC X(09)  VALUE  "180043430".
      *    脳血管疾患等リハビリテーション料１（要介・廃用症）基準不適合
           03  CONS-NOUKE24-COMMENT  PIC X(09)  VALUE  "180043530".
      *    脳血管疾患等リハビリテーション料２（要介・廃用症以外）基準不適合
           03  CONS-NOUKE25-COMMENT  PIC X(09)  VALUE  "180043630".
      *    脳血管疾患等リハビリテーション料２（要介・廃用症）基準不適合
           03  CONS-NOUKE26-COMMENT  PIC X(09)  VALUE  "180043730".
      *    脳血管疾患等リハビリテーション料３（要介・廃用症以外）基準不適合
           03  CONS-NOUKE27-COMMENT  PIC X(09)  VALUE  "180043830".
      *    脳血管疾患等リハビリテーション料３（要介・廃用症）基準不適合
           03  CONS-NOUKE28-COMMENT  PIC X(09)  VALUE  "180043930".
      *
      *    脳血管疾患等リハビリテーション料（１）（リ減）
           03  CONS-NOUKE29-COMMENT  PIC X(09)  VALUE  "180050330".
      *    脳血管疾患等リハビリテーション料（２）（リ減）
           03  CONS-NOUKE30-COMMENT  PIC X(09)  VALUE  "180050430".
      *    脳血管疾患等リハビリテーション料（３）（リ減）
           03  CONS-NOUKE31-COMMENT  PIC X(09)  VALUE  "180050530".
      *    脳血管疾患等リハビリテーション料（１）（要介護・入院外）（リ減）
           03  CONS-NOUKE32-COMMENT  PIC X(09)  VALUE  "180050730".
      *    脳血管疾患等リハビリテーション料（２）（要介護・入院外）（リ減）
           03  CONS-NOUKE33-COMMENT  PIC X(09)  VALUE  "180050930".
      *    脳血管疾患等リハビリテーション料（３）（要介護・入院外）（リ減）
           03  CONS-NOUKE34-COMMENT  PIC X(09)  VALUE  "180051130".
      *    脳血管疾患等リハビリテーション料（１）（要介護）基準不適合・リ減
           03  CONS-NOUKE35-COMMENT  PIC X(09)  VALUE  "180051230".
      *    脳血管疾患等リハビリテーション料（２）（要介護）基準不適合・リ減
           03  CONS-NOUKE36-COMMENT  PIC X(09)  VALUE  "180051330".
      *    脳血管疾患等リハビリテーション料（３）（要介護）基準不適合・リ減
           03  CONS-NOUKE37-COMMENT  PIC X(09)  VALUE  "180051430".
      *
      *    運動器リハビリテーション料（１）
           03  CONS-UNDOKI1-COMMENT  PIC X(09)  VALUE  "180027810".
      *    運動器リハビリテーション料（２）
           03  CONS-UNDOKI2-COMMENT  PIC X(09)  VALUE  "180027910".
      **   運動器リハビリテーション料（１）（１２０日超）
           03  CONS-UNDOKI3-COMMENT  PIC X(09)  VALUE  "180029510".
      **   運動器リハビリテーション料（２）（１２０日超）
           03  CONS-UNDOKI4-COMMENT  PIC X(09)  VALUE  "180029610".
      **   運動器リハビリテーション医学管理料（１）
           03  CONS-UNDOKI5-COMMENT  PIC X(09)  VALUE  "180030310".
      **   運動器リハビリテーション医学管理料（２）
           03  CONS-UNDOKI6-COMMENT  PIC X(09)  VALUE  "180030410".
      *!   運動器リハビリテーション料（１）
           03  CONS-UNDOKI7-COMMENT  PIC X(09)  VALUE  "101800130".
      *!   運動器リハビリテーション料（２）
           03  CONS-UNDOKI8-COMMENT  PIC X(09)  VALUE  "101800140".
      *    運動器リハビリテーション料（１）
           03  CONS-UNDOKI9-COMMENT  PIC X(09)  VALUE  "180032710".
      *!   運動器リハビリテーション料（１）
           03  CONS-UNDOKI10-COMMENT PIC X(09)  VALUE  "101800125".
      *    運動器リハビリテーション料（１）（要介護）
           03  CONS-UNDOKI11-COMMENT PIC X(09)  VALUE  "180034510".
      *    運動器リハビリテーション料（２）（要介護）
           03  CONS-UNDOKI12-COMMENT PIC X(09)  VALUE  "180034610".
      *    運動器リハビリテーション料（３）（要介護）
           03  CONS-UNDOKI13-COMMENT PIC X(09)  VALUE  "180034710".
      *#   運動器リハビリテーション料（１）
           03  CONS-UNDOKI14-COMMENT PIC X(09)  VALUE  "101800280".
      *#   運動器リハビリテーション料（２）
           03  CONS-UNDOKI15-COMMENT PIC X(09)  VALUE  "101800290".
      *#   運動器リハビリテーション料（３）
           03  CONS-UNDOKI16-COMMENT PIC X(09)  VALUE  "101800330".
      *    運動器リハビリテーション料（１）（要介護）（施設基準不適合）
           03  CONS-UNDOKI17-COMMENT PIC X(09)  VALUE  "180044030".
      *    運動器リハビリテーション料（２）（要介護）（施設基準不適合）
           03  CONS-UNDOKI18-COMMENT PIC X(09)  VALUE  "180044130".
      *    運動器リハビリテーション料（３）（要介護）（施設基準不適合）
           03  CONS-UNDOKI19-COMMENT PIC X(09)  VALUE  "180044230".
      *#   運動器リハビリテーション料（１）（１．５倍）
           03  CONS-UNDOKI20-COMMENT PIC X(09)  VALUE  "101801070".
      *#   運動器リハビリテーション料（３）（１．５倍）
           03  CONS-UNDOKI21-COMMENT PIC X(09)  VALUE  "101801080".
      *
      *    運動器リハビリテーション料（１）（リ減）
           03  CONS-UNDOKI22-COMMENT PIC X(09)  VALUE  "180052730".
      *    運動器リハビリテーション料（２）（リ減）
           03  CONS-UNDOKI23-COMMENT PIC X(09)  VALUE  "180052830".
      *    運動器リハビリテーション料（３）（リ減）
           03  CONS-UNDOKI24-COMMENT PIC X(09)  VALUE  "180052930".
      *    運動器リハビリテーション料（１）（要介護・入院外）（リ減）
           03  CONS-UNDOKI25-COMMENT PIC X(09)  VALUE  "180053130".
      *    運動器リハビリテーション料（２）（要介護・入院外）（リ減）
           03  CONS-UNDOKI26-COMMENT PIC X(09)  VALUE  "180053330".
      *    運動器リハビリテーション料（３）（要介護・入院外）（リ減）
           03  CONS-UNDOKI27-COMMENT PIC X(09)  VALUE  "180053530".
      *    運動器リハビリテーション料（１）（要介護）基準不適合・リ減
           03  CONS-UNDOKI28-COMMENT PIC X(09)  VALUE  "180053630".
      *    運動器リハビリテーション料（２）（要介護）基準不適合・リ減
           03  CONS-UNDOKI29-COMMENT PIC X(09)  VALUE  "180053730".
      *    運動器リハビリテーション料（３）（要介護）基準不適合・リ減
           03  CONS-UNDOKI30-COMMENT PIC X(09)  VALUE  "180053830".
      *
      *    難病患者リハビリテーション料
           03  CONS-NANBYO-COMMENT   PIC X(09)  VALUE  "180017910".
      *    障害児（者）リハビリテーション料（６歳未満）
           03  CONS-SYOGAI1-COMMENT  PIC X(09)  VALUE  "180028210".
      *    障害児（者）リハビリテーション料（６歳以上１８歳未満）
           03  CONS-SYOGAI2-COMMENT  PIC X(09)  VALUE  "180028310".
      *    障害児（者）リハビリテーション料（１８歳以上）
           03  CONS-SYOGAI3-COMMENT  PIC X(09)  VALUE  "180028410".
      *    摂食機能療法
           03  CONS-SESYOKU-COMMENT  PIC X(09)  VALUE  "180016610".
      *    摂食機能療法（３０分未満）
           03  CONS-SESYOKU2-COMMENT PIC X(09)  VALUE  "180054310".
      *    廃用症候群リハビリテーション料（１）（１単位）
           03  CONS-HAIYO1-COMMENT   PIC X(09)  VALUE  "180044610".
      *    廃用症候群リハビリテーション料（２）（１単位）
           03  CONS-HAIYO2-COMMENT   PIC X(09)  VALUE  "180044710".
      *    廃用症候群リハビリテーション料（３）（１単位）
           03  CONS-HAIYO3-COMMENT   PIC X(09)  VALUE  "180044810".
      *    廃用症候群リハビリテーション料（１）（要介護・入院外）
           03  CONS-HAIYO4-COMMENT   PIC X(09)  VALUE  "180045010".
      *    廃用症候群リハビリテーション料（２）（要介護・入院外）
           03  CONS-HAIYO5-COMMENT   PIC X(09)  VALUE  "180045210".
      *    廃用症候群リハビリテーション料（３）（要介護・入院外）
           03  CONS-HAIYO6-COMMENT   PIC X(09)  VALUE  "180045410".
      *    廃用症候群リハビリテーション料１（要介護）基準不適合
           03  CONS-HAIYO7-COMMENT   PIC X(09)  VALUE  "180045530".
      *    廃用症候群リハビリテーション料２（要介護）基準不適合
           03  CONS-HAIYO8-COMMENT   PIC X(09)  VALUE  "180045630".
      *    廃用症候群リハビリテーション料３（要介護）基準不適合
           03  CONS-HAIYO9-COMMENT   PIC X(09)  VALUE  "180045730".
      *#   廃用症候群リハビリテーション料（１）（１単位）
           03  CONS-HAIYO10-COMMENT  PIC X(09)  VALUE  "101801110".
      *#   廃用症候群リハビリテーション料（２）（１単位）
           03  CONS-HAIYO11-COMMENT  PIC X(09)  VALUE  "101801120".
      *#   廃用症候群リハビリテーション料（３）（１単位）
           03  CONS-HAIYO12-COMMENT  PIC X(09)  VALUE  "101801130".
      *
      *    廃用症候群リハビリテーション料（１）（リ減）
           03  CONS-HAIYO13-COMMENT  PIC X(09)  VALUE  "180051530".
      *    廃用症候群リハビリテーション料（２）（リ減）
           03  CONS-HAIYO14-COMMENT  PIC X(09)  VALUE  "180051630".
      *    廃用症候群リハビリテーション料（３）（リ減）
           03  CONS-HAIYO15-COMMENT  PIC X(09)  VALUE  "180051730".
      *    廃用症候群リハビリテーション料（１）（要介護・入院外）（リ減）
           03  CONS-HAIYO16-COMMENT  PIC X(09)  VALUE  "180051930".
      *    廃用症候群リハビリテーション料（２）（要介護・入院外）（リ減）
           03  CONS-HAIYO17-COMMENT  PIC X(09)  VALUE  "180052130".
      *    廃用症候群リハビリテーション料（３）（要介護・入院外）（リ減）
           03  CONS-HAIYO18-COMMENT  PIC X(09)  VALUE  "180052330".
      *    廃用症候群リハビリテーション料（１）（要介護）基準不適合・リ減
           03  CONS-HAIYO19-COMMENT  PIC X(09)  VALUE  "180052430".
      *    廃用症候群リハビリテーション料（２）（要介護）基準不適合・リ減
           03  CONS-HAIYO20-COMMENT  PIC X(09)  VALUE  "180052530".
      *    廃用症候群リハビリテーション料（３）（要介護）基準不適合・リ減
           03  CONS-HAIYO21-COMMENT  PIC X(09)  VALUE  "180052630".
      *
      *    初期加算（リハビリテーション料）
           03  CONS-RIHAKSN1-COMMENT PIC X(09)  VALUE  "180033870".
      *    早期リハビリテーション加算
           03  CONS-RIHAKSN2-COMMENT PIC X(09)  VALUE  "180030770".
      *
      *    がん患者リハビリテーション料
           03  CONS-GANKNJ-COMMENT   PIC X(09)  VALUE  "180033110".
      *    介達牽引
           03  CONS-KAITATU-COMMENT  PIC X(09)  VALUE  "140048010".
      *    往診
           03  CONS-OSIN-COMMENT     PIC X(09)  VALUE  "114000110".
      *    特別往診
           03  CONS-OSIN2-COMMENT    PIC X(09)  VALUE  "114001610".
      *    往診日コメント
           03  CONS-OSIN3-COMMENT    PIC X(09)  VALUE  "840000039".
      *    在宅患者訪問診療料
           03  CONS-ZAIHOU-COMMENT   PIC X(09)  VALUE  "114001110".
      *    訪問診療日コメント
           03  CONS-ZAIHOU2-COMMENT  PIC X(09)  VALUE  "840000066".
      *    在宅患者訪問診療料（居住系）
           03  CONS-ZAIHOU3-COMMENT  PIC X(09)  VALUE  "114012910".
      *    在宅患者訪問診療料（同一建物居住者）（特定施設等入居者）
           03  CONS-ZAIHOU4-COMMENT  PIC X(09)  VALUE  "114018010".
      *    在宅患者訪問診療料（同一建物居住者）
           03  CONS-ZAIHOU5-COMMENT  PIC X(09)  VALUE  "114030310".
      *    在宅患者訪問診療料（１）２（同一建物居住者以外）
           03  CONS-ZAIHOU6-COMMENT  PIC X(09)  VALUE  "114042110".
      *    在宅患者訪問診療料（１）２（同一建物居住者）
           03  CONS-ZAIHOU7-COMMENT  PIC X(09)  VALUE  "114042210".
      *    在宅患者訪問診療料（２）イ
           03  CONS-ZAIHOU8-COMMENT  PIC X(09)  VALUE  "114042810".
      *    在宅患者訪問診療料（２）ロ
           03  CONS-ZAIHOU9-COMMENT  PIC X(09)  VALUE  "114046310".
      *
      *    在宅時医学総合管理料１（院外処方せん）
           03  CONS-ZAIIKAN1-COMMENT PIC X(09)  VALUE  "114012210".
      *    在宅時医学総合管理料１（院内処方せん）
           03  CONS-ZAIIKAN2-COMMENT PIC X(09)  VALUE  "114012310".
      *    在宅時医学総合管理料２（院内処方せん）
           03  CONS-ZAIIKAN3-COMMENT PIC X(09)  VALUE  "114012410".
      *    在宅時医学総合管理料２（院外処方せん）
           03  CONS-ZAIIKAN4-COMMENT PIC X(09)  VALUE  "114007510".
      *    特定施設入居時等医学総合管理料１（処方せんを交付）
           03  CONS-ZAIIKAN5-COMMENT PIC X(09)  VALUE  "114013010".
      *    特定施設入居時等医学総合管理料１（処方せんを交付しない）
           03  CONS-ZAIIKAN6-COMMENT PIC X(09)  VALUE  "114013110".
      *    特定施設入居時等医学総合管理料２（処方せんを交付）
           03  CONS-ZAIIKAN7-COMMENT PIC X(09)  VALUE  "114013210".
      *    特定施設入居時等医学総合管理料２（処方せんを交付しない）
           03  CONS-ZAIIKAN8-COMMENT PIC X(09)  VALUE  "114013310".
      *    在医総管（機能強化した在支診等）（病床あり）（処方せん）
           03  CONS-ZAIIKAN9-COMMENT  PIC X(09) VALUE  "114018710".
      *    在医総管（機能強化した在支診等）（病床あり）（処方せんなし）
           03  CONS-ZAIIKAN10-COMMENT PIC X(09) VALUE  "114018810".
      *    在医総管（機能強化した在支診等）（病床なし）（処方せん）
           03  CONS-ZAIIKAN11-COMMENT PIC X(09) VALUE  "114018910".
      *    在医総管（機能強化した在支診等）（病床なし）（処方せんなし）
           03  CONS-ZAIIKAN12-COMMENT PIC X(09) VALUE  "114019010".
      *    特医総管（機能強化した在支診等）（病床あり）（処方せん）
           03  CONS-ZAIIKAN13-COMMENT PIC X(09) VALUE  "114019110".
      *    特医総管（機能強化した在支診等）（病床あり）（処方せんなし）
           03  CONS-ZAIIKAN14-COMMENT PIC X(09) VALUE  "114019210".
      *    特医総管（機能強化した在支診等）（病床なし）（処方せん）
           03  CONS-ZAIIKAN15-COMMENT PIC X(09) VALUE  "114019310".
      *    特医総管（機能強化した在支診等）（病床なし）（処方せんなし）
           03  CONS-ZAIIKAN16-COMMENT PIC X(09) VALUE  "114019410".
      *
      *    在医総管（機能強化在支診等）（病床有・処方せん有・同一建物以外）
           03  CONS-ZAIIKAN17-COMMENT PIC X(09) VALUE  "114023110".
      *    在医総管（機能強化在支診等）（病床有・処方せん有・同一建物居住）
           03  CONS-ZAIIKAN18-COMMENT PIC X(09) VALUE  "114023210".
      *    在医総管（機能強化在支診等）（病床有・処方せん無・同一建物以外）
           03  CONS-ZAIIKAN19-COMMENT PIC X(09) VALUE  "114023310".
      *    在医総管（機能強化在支診等）（病床有・処方せん無・同一建物居住）
           03  CONS-ZAIIKAN20-COMMENT PIC X(09) VALUE  "114023410".
      *    在医総管（機能強化在支診等）（病床無・処方せん有・同一建物以外）
           03  CONS-ZAIIKAN21-COMMENT PIC X(09) VALUE  "114023510".
      *    在医総管（機能強化在支診等）（病床無・処方せん有・同一建物居住）
           03  CONS-ZAIIKAN22-COMMENT PIC X(09) VALUE  "114023610".
      *    在医総管（機能強化在支診等）（病床無・処方せん無・同一建物以外）
           03  CONS-ZAIIKAN23-COMMENT PIC X(09) VALUE  "114023710".
      *    在医総管（機能強化在支診等）（病床無・処方せん無・同一建物居住）
           03  CONS-ZAIIKAN24-COMMENT PIC X(09) VALUE  "114023810".
      *    在医総管（在支診等）（処方せんあり・同一建物居住者以外）
           03  CONS-ZAIIKAN25-COMMENT PIC X(09) VALUE  "114023910".
      *    在医総管（在支診等）（処方せんあり・同一建物居住者）
           03  CONS-ZAIIKAN26-COMMENT PIC X(09) VALUE  "114024010".
      *    在医総管（在支診等）（処方せんなし・同一建物居住者以外）
           03  CONS-ZAIIKAN27-COMMENT PIC X(09) VALUE  "114024110".
      *    在医総管（在支診等）（処方せんなし・同一建物居住者）
           03  CONS-ZAIIKAN28-COMMENT PIC X(09) VALUE  "114024210".
      *    在医総管（在支診等以外）（処方せんあり・同一建物居住者以外）
           03  CONS-ZAIIKAN29-COMMENT PIC X(09) VALUE  "114024310".
      *    在医総管（在支診等以外）（処方せんあり・同一建物居住者）
           03  CONS-ZAIIKAN30-COMMENT PIC X(09) VALUE  "114024410".
      *    在医総管（在支診等以外）（処方せんなし・同一建物居住者以外）
           03  CONS-ZAIIKAN31-COMMENT PIC X(09) VALUE  "114024510".
      *    在医総管（在支診等以外）（処方せんなし・同一建物居住者）
           03  CONS-ZAIIKAN32-COMMENT PIC X(09) VALUE  "114024610".
      *
      *    特医総管（機能強化在支診等）（病床有・処方せん有・同一建物以外）
           03  CONS-ZAIIKAN33-COMMENT PIC X(09) VALUE  "114024910".
      *    特医総管（機能強化在支診等）（病床有・処方せん有・同一建物居住）
           03  CONS-ZAIIKAN34-COMMENT PIC X(09) VALUE  "114025010".
      *    特医総管（機能強化在支診等）（病床有・処方せん無・同一建物以外）
           03  CONS-ZAIIKAN35-COMMENT PIC X(09) VALUE  "114025110".
      *    特医総管（機能強化在支診等）（病床有・処方せん無・同一建物居住）
           03  CONS-ZAIIKAN36-COMMENT PIC X(09) VALUE  "114025210".
      *    特医総管（機能強化在支診等）（病床無・処方せん有・同一建物以外）
           03  CONS-ZAIIKAN37-COMMENT PIC X(09) VALUE  "114025310".
      *    特医総管（機能強化在支診等）（病床無・処方せん有・同一建物居住）
           03  CONS-ZAIIKAN38-COMMENT PIC X(09) VALUE  "114025410".
      *    特医総管（機能強化在支診等）（病床無・処方せん無・同一建物以外）
           03  CONS-ZAIIKAN39-COMMENT PIC X(09) VALUE  "114025510".
      *    特医総管（機能強化在支診等）（病床無・処方せん無・同一建物居住）
           03  CONS-ZAIIKAN40-COMMENT PIC X(09) VALUE  "114025610".
      *    特医総管（在支診等）（処方せんあり・同一建物居住者以外）
           03  CONS-ZAIIKAN41-COMMENT PIC X(09) VALUE  "114025710".
      *    特医総管（在支診等）（処方せんあり・同一建物居住者）
           03  CONS-ZAIIKAN42-COMMENT PIC X(09) VALUE  "114025810".
      *    特医総管（在支診等）（処方せんなし・同一建物居住者以外）
           03  CONS-ZAIIKAN43-COMMENT PIC X(09) VALUE  "114025910".
      *    特医総管（在支診等）（処方せんなし・同一建物居住者）
           03  CONS-ZAIIKAN44-COMMENT PIC X(09) VALUE  "114026010".
      *    特医総管（在支診等以外）（処方せんあり・同一建物居住者以外）
           03  CONS-ZAIIKAN45-COMMENT PIC X(09) VALUE  "114026110".
      *    特医総管（在支診等以外）（処方せんあり・同一建物居住者）
           03  CONS-ZAIIKAN46-COMMENT PIC X(09) VALUE  "114026210".
      *    特医総管（在支診等以外）（処方せんなし・同一建物居住者以外）
           03  CONS-ZAIIKAN47-COMMENT PIC X(09) VALUE  "114026310".
      *    特医総管（在支診等以外）（処方せんなし・同一建物居住者）
           03  CONS-ZAIIKAN48-COMMENT PIC X(09) VALUE  "114026410".
      *
      *    在医総管（機能強化在支診等・病床有・難病等月２回以上・１人）
           03  CONS-ZAIIKAN49-COMMENT PIC X(09) VALUE  "114030710".
      *    在医総管（機能強化在支診等・病床有・難病等月２回以上・２〜９人）
           03  CONS-ZAIIKAN50-COMMENT PIC X(09) VALUE  "114030810".
      *    在医総管（機能強化在支診等・病床有・難病等月２回以上・１０人〜）
           03  CONS-ZAIIKAN51-COMMENT PIC X(09) VALUE  "114030910".
      *    在医総管（機能強化在支診等・病床有・月２回以上・１人）
           03  CONS-ZAIIKAN52-COMMENT PIC X(09) VALUE  "114031010".
      *    在医総管（機能強化在支診等・病床有・月２回以上・２〜９人）
           03  CONS-ZAIIKAN53-COMMENT PIC X(09) VALUE  "114031110".
      *    在医総管（機能強化在支診等・病床有・月２回以上・１０人〜）
           03  CONS-ZAIIKAN54-COMMENT PIC X(09) VALUE  "114031210".
      *    在医総管（機能強化在支診等・病床有・月１回・１人）
           03  CONS-ZAIIKAN55-COMMENT PIC X(09) VALUE  "114031310".
      *    在医総管（機能強化在支診等・病床有・月１回・２〜９人）
           03  CONS-ZAIIKAN56-COMMENT PIC X(09) VALUE  "114031410".
      *    在医総管（機能強化在支診等・病床有・月１回・１０人〜）
           03  CONS-ZAIIKAN57-COMMENT PIC X(09) VALUE  "114031510".
      *    在医総管（機能強化在支診等・病床無・難病等月２回以上・１人）
           03  CONS-ZAIIKAN58-COMMENT PIC X(09) VALUE  "114031610".
      *    在医総管（機能強化在支診等・病床無・難病等月２回以上・２〜９人）
           03  CONS-ZAIIKAN59-COMMENT PIC X(09) VALUE  "114031710".
      *    在医総管（機能強化在支診等・病床無・難病等月２回以上・１０人〜）
           03  CONS-ZAIIKAN60-COMMENT PIC X(09) VALUE  "114031810".
      *    在医総管（機能強化在支診等・病床無・月２回以上・１人）
           03  CONS-ZAIIKAN61-COMMENT PIC X(09) VALUE  "114031910".
      *    在医総管（機能強化在支診等・病床無・月２回以上・２〜９人）
           03  CONS-ZAIIKAN62-COMMENT PIC X(09) VALUE  "114032010".
      *    在医総管（機能強化在支診等・病床無・月２回以上・１０人〜）
           03  CONS-ZAIIKAN63-COMMENT PIC X(09) VALUE  "114032110".
      *    在医総管（機能強化在支診等・病床無・月１回・１人）
           03  CONS-ZAIIKAN64-COMMENT PIC X(09) VALUE  "114032210".
      *    在医総管（機能強化在支診等・病床無・月１回・２〜９人）
           03  CONS-ZAIIKAN65-COMMENT PIC X(09) VALUE  "114032310".
      *    在医総管（機能強化在支診等・病床無・月１回・１０人〜）
           03  CONS-ZAIIKAN66-COMMENT PIC X(09) VALUE  "114032410".
      *    在医総管（在支診等・難病等月２回以上・１人）
           03  CONS-ZAIIKAN67-COMMENT PIC X(09) VALUE  "114032510".
      *    在医総管（在支診等・難病等月２回以上・２〜９人）
           03  CONS-ZAIIKAN68-COMMENT PIC X(09) VALUE  "114032610".
      *    在医総管（在支診等・難病等月２回以上・１０人〜）
           03  CONS-ZAIIKAN69-COMMENT PIC X(09) VALUE  "114032710".
      *    在医総管（在支診等・月２回以上・１人）
           03  CONS-ZAIIKAN70-COMMENT PIC X(09) VALUE  "114032810".
      *    在医総管（在支診等・月２回以上・２〜９人）
           03  CONS-ZAIIKAN71-COMMENT PIC X(09) VALUE  "114032910".
      *    在医総管（在支診等・月２回以上・１０人〜）
           03  CONS-ZAIIKAN72-COMMENT PIC X(09) VALUE  "114033010".
      *    在医総管（在支診等・月１回・１人）
           03  CONS-ZAIIKAN73-COMMENT PIC X(09) VALUE  "114033110".
      *    在医総管（在支診等・月１回・２〜９人）
           03  CONS-ZAIIKAN74-COMMENT PIC X(09) VALUE  "114033210".
      *    在医総管（在支診等・月１回・１０人〜）
           03  CONS-ZAIIKAN75-COMMENT PIC X(09) VALUE  "114033310".
      *    在医総管（在支診等以外・難病等月２回以上・１人）
           03  CONS-ZAIIKAN76-COMMENT PIC X(09) VALUE  "114033410".
      *    在医総管（在支診等以外・難病等月２回以上・２〜９人）
           03  CONS-ZAIIKAN77-COMMENT PIC X(09) VALUE  "114033510".
      *    在医総管（在支診等以外・難病等月２回以上・１０人〜）
           03  CONS-ZAIIKAN78-COMMENT PIC X(09) VALUE  "114033610".
      *    在医総管（在支診等以外・月２回以上・１人）
           03  CONS-ZAIIKAN79-COMMENT PIC X(09) VALUE  "114033710".
      *    在医総管（在支診等以外・月２回以上・２〜９人）
           03  CONS-ZAIIKAN80-COMMENT PIC X(09) VALUE  "114033810".
      *    在医総管（在支診等以外・月２回以上・１０人〜）
           03  CONS-ZAIIKAN81-COMMENT PIC X(09) VALUE  "114033910".
      *    在医総管（在支診等以外・月１回・１人）
           03  CONS-ZAIIKAN82-COMMENT PIC X(09) VALUE  "114034010".
      *    在医総管（在支診等以外・月１回・２〜９人）
           03  CONS-ZAIIKAN83-COMMENT PIC X(09) VALUE  "114034110".
      *    在医総管（在支診等以外・月１回・１０人〜）
           03  CONS-ZAIIKAN84-COMMENT PIC X(09) VALUE  "114034210".
      *
      *    施医総管（機能強化在支診等・病床有・難病等月２回以上・１人）
           03  CONS-SHIIKAN1-COMMENT  PIC X(09) VALUE  "114035510".
      *    施医総管（機能強化在支診等・病床有・難病等月２回以上・２〜９人）
           03  CONS-SHIIKAN2-COMMENT  PIC X(09) VALUE  "114035610".
      *    施医総管（機能強化在支診等・病床有・難病等月２回以上・１０人〜）
           03  CONS-SHIIKAN3-COMMENT  PIC X(09) VALUE  "114035710".
      *    施医総管（機能強化在支診等・病床有・月２回以上・１人）
           03  CONS-SHIIKAN4-COMMENT  PIC X(09) VALUE  "114035810".
      *    施医総管（機能強化在支診等・病床有・月２回以上・２〜９人）
           03  CONS-SHIIKAN5-COMMENT  PIC X(09) VALUE  "114035910".
      *    施医総管（機能強化在支診等・病床有・月２回以上・１０人〜）
           03  CONS-SHIIKAN6-COMMENT  PIC X(09) VALUE  "114036010".
      *    施医総管（機能強化在支診等・病床有・月１回・１人）
           03  CONS-SHIIKAN7-COMMENT  PIC X(09) VALUE  "114036110".
      *    施医総管（機能強化在支診等・病床有・月１回・２〜９人）
           03  CONS-SHIIKAN8-COMMENT  PIC X(09) VALUE  "114036210".
      *    施医総管（機能強化在支診等・病床有・月１回・１０人〜）
           03  CONS-SHIIKAN9-COMMENT  PIC X(09) VALUE  "114036310".
      *    施医総管（機能強化在支診等・病床無・難病等月２回以上・１人）
           03  CONS-SHIIKAN10-COMMENT PIC X(09) VALUE  "114036410".
      *    施医総管（機能強化在支診等・病床無・難病等月２回以上・２〜９人）
           03  CONS-SHIIKAN11-COMMENT PIC X(09) VALUE  "114036510".
      *    施医総管（機能強化在支診等・病床無・難病等月２回以上・１０人〜）
           03  CONS-SHIIKAN12-COMMENT PIC X(09) VALUE  "114036610".
      *    施医総管（機能強化在支診等・病床無・月２回以上・１人）
           03  CONS-SHIIKAN13-COMMENT PIC X(09) VALUE  "114036710".
      *    施医総管（機能強化在支診等・病床無・月２回以上・２〜９人）
           03  CONS-SHIIKAN14-COMMENT PIC X(09) VALUE  "114036810".
      *    施医総管（機能強化在支診等・病床無・月２回以上・１０人〜）
           03  CONS-SHIIKAN15-COMMENT PIC X(09) VALUE  "114036910".
      *    施医総管（機能強化在支診等・病床無・月１回・１人）
           03  CONS-SHIIKAN16-COMMENT PIC X(09) VALUE  "114037010".
      *    施医総管（機能強化在支診等・病床無・月１回・２〜９人）
           03  CONS-SHIIKAN17-COMMENT PIC X(09) VALUE  "114037110".
      *    施医総管（機能強化在支診等・病床無・月１回・１０人〜）
           03  CONS-SHIIKAN18-COMMENT PIC X(09) VALUE  "114037210".
      *    施医総管（在支診等・難病等月２回以上・１人）
           03  CONS-SHIIKAN19-COMMENT PIC X(09) VALUE  "114037310".
      *    施医総管（在支診等・難病等月２回以上・２〜９人）
           03  CONS-SHIIKAN20-COMMENT PIC X(09) VALUE  "114037410".
      *    施医総管（在支診等・難病等月２回以上・１０人〜）
           03  CONS-SHIIKAN21-COMMENT PIC X(09) VALUE  "114037510".
      *    施医総管（在支診等・月２回以上・１人）
           03  CONS-SHIIKAN22-COMMENT PIC X(09) VALUE  "114037610".
      *    施医総管（在支診等・月２回以上・２〜９人）
           03  CONS-SHIIKAN23-COMMENT PIC X(09) VALUE  "114037710".
      *    施医総管（在支診等・月２回以上・１０人〜）
           03  CONS-SHIIKAN24-COMMENT PIC X(09) VALUE  "114037810".
      *    施医総管（在支診等・月１回・１人）
           03  CONS-SHIIKAN25-COMMENT PIC X(09) VALUE  "114037910".
      *    施医総管（在支診等・月１回・２〜９人）
           03  CONS-SHIIKAN26-COMMENT PIC X(09) VALUE  "114038010".
      *    施医総管（在支診等・月１回・１０人〜）
           03  CONS-SHIIKAN27-COMMENT PIC X(09) VALUE  "114038110".
      *    施医総管（在支診等以外・難病等月２回以上・１人）
           03  CONS-SHIIKAN28-COMMENT PIC X(09) VALUE  "114038210".
      *    施医総管（在支診等以外・難病等月２回以上・２〜９人）
           03  CONS-SHIIKAN29-COMMENT PIC X(09) VALUE  "114038310".
      *    施医総管（在支診等以外・難病等月２回以上・１０人〜）
           03  CONS-SHIIKAN30-COMMENT PIC X(09) VALUE  "114038410".
      *    施医総管（在支診等以外・月２回以上・１人）
           03  CONS-SHIIKAN31-COMMENT PIC X(09) VALUE  "114038510".
      *    施医総管（在支診等以外・月２回以上・２〜９人）
           03  CONS-SHIIKAN32-COMMENT PIC X(09) VALUE  "114038610".
      *    施医総管（在支診等以外・月２回以上・１０人〜）
           03  CONS-SHIIKAN33-COMMENT PIC X(09) VALUE  "114038710".
      *    施医総管（在支診等以外・月１回・１人）
           03  CONS-SHIIKAN34-COMMENT PIC X(09) VALUE  "114038810".
      *    施医総管（在支診等以外・月１回・２〜９人）
           03  CONS-SHIIKAN35-COMMENT PIC X(09) VALUE  "114038910".
      *    施医総管（在支診等以外・月１回・１０人〜）
           03  CONS-SHIIKAN36-COMMENT PIC X(09) VALUE  "114039010".
      *
      *    小児特定疾患カウンセリング料（１回目）
           03  CONS-SYOUNI1-COMMENT  PIC X(09)  VALUE  "113000810".
      *    小児特定疾患カウンセリング料（２回目）
           03  CONS-SYOUNI2-COMMENT  PIC X(09)  VALUE  "113009910".
      *    小児特定第１回目カウンセリングコメント
           03  CONS-SYOUNI3-COMMENT  PIC X(09)  VALUE  "840000104".
      *
      *    ＢＮＰ精密
           03  CONS-KENSA1-COMMENT   PIC X(09)  VALUE  "160162350".
      *    ＮＴ−ｐｒｏＢＮＰ精密
           03  CONS-KENSA2-COMMENT   PIC X(09)  VALUE  "160181250".
      *    ＨＡＮＰ精密
           03  CONS-KENSA3-COMMENT   PIC X(09)  VALUE  "160116310".
      *
      *    心臓ペースメーカー指導管理料（遠隔モニタリング）
           03  CONS-SINPESU-COMMENT  PIC X(09)  VALUE  "113001510".
      *    遠隔モニタリング加算
           03  CONS-SINPESU2-COMMENT PIC X(09)  VALUE  "113018070".
      *    集団栄養食事指導料
           03  CONS-SYUEIYO-COMMENT  PIC X(09)  VALUE  "113003410".
      *    人工腎臓（その他）
           03  CONS-JINZOU1-COMMENT  PIC X(09)  VALUE  "140007710".
      *    人工腎臓（慢性維持透析）（４時間未満）
           03  CONS-JINZOU2-COMMENT  PIC X(09)  VALUE  "140036710".
      *    人工腎臓（慢性維持透析）（４時間以上５時間未満）
           03  CONS-JINZOU3-COMMENT  PIC X(09)  VALUE  "140051010".
      *    人工腎臓（慢性維持透析）（５時間以上）
           03  CONS-JINZOU4-COMMENT  PIC X(09)  VALUE  "140051110".
      *    連続携行式腹膜かん流
           03  CONS-JINZOU5-COMMENT  PIC X(09)  VALUE  "140008510".
      *    持続緩徐式血液濾過
           03  CONS-JINZOU6-COMMENT  PIC X(09)  VALUE  "140029850".
      *    血漿交換療法
           03  CONS-JINZOU7-COMMENT  PIC X(09)  VALUE  "140008210".
      *    血球成分除去療法
           03  CONS-JINZOU8-COMMENT  PIC X(09)  VALUE  "140039210".
      *    人工腎臓（慢性維持透析濾過）（複雑）
           03  CONS-JINZOU9-COMMENT  PIC X(09)  VALUE  "140052810".
      *    人工腎臓（慢性維持透析１）（４時間未満）
           03  CONS-JINZOU10-COMMENT PIC X(09)  VALUE  "140057810".
      *    人工腎臓（慢性維持透析１）（４時間以上５時間未満）
           03  CONS-JINZOU11-COMMENT PIC X(09)  VALUE  "140057910".
      *    人工腎臓（慢性維持透析１）（５時間以上）
           03  CONS-JINZOU12-COMMENT PIC X(09)  VALUE  "140058010".
      *    人工腎臓（慢性維持透析２）（４時間未満）
           03  CONS-JINZOU13-COMMENT PIC X(09)  VALUE  "140058110".
      *    人工腎臓（慢性維持透析２）（４時間以上５時間未満）
           03  CONS-JINZOU14-COMMENT PIC X(09)  VALUE  "140058210".
      *    人工腎臓（慢性維持透析２）（５時間以上）
           03  CONS-JINZOU15-COMMENT PIC X(09)  VALUE  "140058310".
      *    人工腎臓（慢性維持透析３）（４時間未満）
           03  CONS-JINZOU16-COMMENT PIC X(09)  VALUE  "140058410".
      *    人工腎臓（慢性維持透析３）（４時間以上５時間未満）
           03  CONS-JINZOU17-COMMENT PIC X(09)  VALUE  "140058510".
      *    人工腎臓（慢性維持透析３）（５時間以上）
           03  CONS-JINZOU18-COMMENT PIC X(09)  VALUE  "140058610".
      *    人工腎臓（慢性維持透析１）（４時間未満）（経過措置）
           03  CONS-JINZOU19-COMMENT PIC X(09)  VALUE  "140059310".
      *    人工腎臓（慢性維持透析１）（４時間以上５時間未満）（経過措置）
           03  CONS-JINZOU20-COMMENT PIC X(09)  VALUE  "140059410".
      *    人工腎臓（慢性維持透析１）（５時間以上）（経過措置）
           03  CONS-JINZOU21-COMMENT PIC X(09)  VALUE  "140059510".
      *    局所陰圧閉鎖処置（その他）
           03  CONS-KYOKUIN1-COMMENT PIC X(09)  VALUE  "140052410".
      *    局所陰圧閉鎖処置（被覆材貼付）（１００ｃｍ２未満）
           03  CONS-KYOKUIN2-COMMENT PIC X(09)  VALUE  "140051810".
      *    局所陰圧閉鎖処置（被覆材貼付）（１００ｃｍ２〜２００ｃｍ２未満）
           03  CONS-KYOKUIN3-COMMENT PIC X(09)  VALUE  "140051910".
      *    局所陰圧閉鎖処置（被覆材貼付）（２００ｃｍ２以上）
           03  CONS-KYOKUIN4-COMMENT PIC X(09)  VALUE  "140052010".
      *    局所陰圧閉鎖処置初回加算（１００ｃｍ２未満）
           03  CONS-KYOKUIN5-COMMENT PIC X(09)  VALUE  "140052170".
      *    局所陰圧閉鎖処置初回加算（１００ｃｍ２以上２００ｃｍ２未満）
           03  CONS-KYOKUIN6-COMMENT PIC X(09)  VALUE  "140052270".
      *    局所陰圧閉鎖処置初回加算（２００ｃｍ２以上）
           03  CONS-KYOKUIN7-COMMENT PIC X(09)  VALUE  "140052370".
      *    局所陰圧閉鎖処置初回加算（入院外）（１００ｃｍ２未満）
           03  CONS-KYOKUIN8-COMMENT  PIC X(09) VALUE  "140054270".
      *    局所陰圧閉鎖処置初回加算（入院外）（１００ｃｍ２以上）
           03  CONS-KYOKUIN9-COMMENT  PIC X(09) VALUE  "140054370".
      *    局所陰圧閉鎖処置初回加算（入院外）（２００ｃｍ２以上）
           03  CONS-KYOKUIN10-COMMENT PIC X(09) VALUE  "140054470".
      *
      *    認知療法・認知行動療法
           03  CONS-NINRYO-COMMENT   PIC X(09)  VALUE  "180033210".
      *    認知療法・認知行動療法（精神科救急体制の精神保健指定医）
           03  CONS-NINRYO2-COMMENT  PIC X(09)  VALUE  "180035910".
      *    認知療法・認知行動療法（精神保健指定医と看護師が共同で行う場合）
           03  CONS-NINRYO5-COMMENT  PIC X(09)  VALUE  "180047810".
      *    初回算定　　　月　　日
           03  CONS-NINRYO6-COMMENT  PIC X(09)  VALUE  "840000097".
      *    認知療法・認知行動療法（医師）
           03  CONS-NINRYO8-COMMENT  PIC X(09)  VALUE  "180056410".
      *
      *    精神科在宅患者支援管理料１（集中的支援必要）（単一建物１人）
           03  CONS-SEIZAI-COMMENT   PIC X(09)  VALUE  "180057210".
      *    精神科在宅患者支援管理料１（集中的支援必要）（単一建物２人以上）
           03  CONS-SEIZAI2-COMMENT  PIC X(09)  VALUE  "180057310".
      *    精神科在宅患者支援管理料１（重度精神障害者）（単一建物１人）
           03  CONS-SEIZAI3-COMMENT  PIC X(09)  VALUE  "180057410".
      *    精神科在宅患者支援管理料１（重度精神障害者）（単一建物２人以上）
           03  CONS-SEIZAI4-COMMENT  PIC X(09)  VALUE  "180057510".
      *    精神科在宅患者支援管理料１（イ及びロ以外）（単一建物１人）
           03  CONS-SEIZAI5-COMMENT  PIC X(09)  VALUE  "180057610".
      *    精神科在宅患者支援管理料１（イ及びロ以外）（単一建物２人以上）
           03  CONS-SEIZAI6-COMMENT  PIC X(09)  VALUE  "180057710".
      *    精神科在宅患者支援管理料２（集中的支援必要）（単一建物１人）
           03  CONS-SEIZAI7-COMMENT  PIC X(09)  VALUE  "180057810".
      *    精神科在宅患者支援管理料２（集中的支援必要）（単一建物２人以上）
           03  CONS-SEIZAI8-COMMENT  PIC X(09)  VALUE  "180057910".
      *    精神科在宅患者支援管理料２（重度精神障害者）（単一建物１人）
           03  CONS-SEIZAI9-COMMENT  PIC X(09)  VALUE  "180058010".
      *    精神科在宅患者支援管理料２（重度精神障害者）（単一建物２人以上）
           03  CONS-SEIZAI10-COMMENT PIC X(09)  VALUE  "180058110".
      *
      *    精神科重症患者早期集中支援管理料１（単一建物１人）
           03  CONS-SEIJYU-COMMENT   PIC X(09)  VALUE  "180042110".
      *    精神科重症患者早期集中支援管理料２（単一建物１人）
           03  CONS-SEIJYU2-COMMENT  PIC X(09)  VALUE  "180042410".
      *    精神科重症患者早期集中支援管理料１（単一建物２人以上）
           03  CONS-SEIJYU3-COMMENT  PIC X(09)  VALUE  "180048710".
      *    精神科重症患者早期集中支援管理料２（単一建物２人以上）
           03  CONS-SEIJYU4-COMMENT  PIC X(09)  VALUE  "180048810".
      *
      *    在宅半固形栄養経管栄養法指導管理料
           03  CONS-ZAIHANKO-COMMENT PIC X(09)  VALUE  "114045510".
      *
      *    認知症専門診断管理料２
           03  CONS-NINSEN-COMMENT   PIC X(09)  VALUE  "113014610".
      *    小児運動器疾患指導管理料
           03  CONS-SYOUNDO-COMMENT  PIC X(09)  VALUE  "113024310".
      *    療養・就労両立支援指導料
           03  CONS-RYOSYU-COMMENT   PIC X(09)  VALUE  "113027910".
      *    認知症サポート指導料
           03  CONS-NINSAPO-COMMENT  PIC X(09)  VALUE  "113028310".
      *
      *    退院時共同指導料１（１以外）
           03  CONS-TAKYO-COMMENT    PIC X(09)  VALUE  "113008710".
      *    退院時共同指導料特別管理指導加算
           03  CONS-TAKYOKSN-COMMENT PIC X(09)  VALUE  "113014370".
      *    外来リハビリテーション診療料１
           03  CONS-GAIRIHA1-COMMENT PIC X(09)  VALUE  "113013910".
      *    外来リハビリテーション診療料２
           03  CONS-GAIRIHA2-COMMENT PIC X(09)  VALUE  "113014010".
      *    外来放射線照射診療料
           03  CONS-GAIHOU-COMMENT   PIC X(09)  VALUE  "113014110".
      *    介護職員等喀痰吸引等指示料
           03  CONS-KAISYOKU-COMMENT PIC X(09)  VALUE  "114020910".
      *
      *    在宅持続陽圧呼吸療法指導管理料
           03  CONS-YOUATU-COMMENT   PIC X(09)  VALUE  "114009710".
      *
      *    在宅患者共同診療料（往診）
           03  CONS-ZAIKYO1-COMMENT  PIC X(09)  VALUE  "114027610".
      *    在宅患者共同診療料（訪問診療）（同一建物居住者以外）
           03  CONS-ZAIKYO2-COMMENT  PIC X(09)  VALUE  "114027710".
      *    在宅患者共同診療料（訪問診療）（同一建物居住者・特定施設等）
           03  CONS-ZAIKYO3-COMMENT  PIC X(09)  VALUE  "114027810".
      *    在宅患者共同診療料（訪問診療）（同一建物居住者・特定施設等以外）
           03  CONS-ZAIKYO4-COMMENT  PIC X(09)  VALUE  "114027910".
      *    初回算定　　　月　　日
           03  CONS-ZAIKYO5-COMMENT  PIC X(09)  VALUE  "840000097".
      *    通算実施回数（　　回）
           03  CONS-ZAIKYO6-COMMENT  PIC X(09)  VALUE  "840000086".
      *
      *    在宅患者訪問リハビリテーション指導管理料（同一建物住居者以外）
           03  CONS-ZAIRIHA1-COMMENT PIC X(09)  VALUE  "114006410".
      *    在宅患者訪問リハビリテーション指導管理料（同一建物住居者）
           03  CONS-ZAIRIHA2-COMMENT PIC X(09)  VALUE  "114015010".
      *
      *    心臓ペースメーカー指導管理料（着用型自動除細動器）
           03  CONS-SINPESUR1-COMMENT PIC X(09) VALUE  "113015010".
      *    心臓ペースメーカー指導管理料（ロ・植込型除細動器移行期加算含む）
           03  CONS-SINPESUR2-COMMENT PIC X(09) VALUE  "113015130".
      *    心臓ペースメーカー指導管理料（イ以外）
           03  CONS-SINPESUR3-COMMENT PIC X(09) VALUE  "113001610".
      *
      *    がん患者指導管理料（医師・看護師が心理的不安軽減のため面接）
           03  CONS-GANSIDO1-COMMENT PIC X(09)  VALUE  "113015310".
      *    がん患者指導管理料（医師等が坑悪性腫瘍剤の必要性等を文書説明）
           03  CONS-GANSIDO2-COMMENT PIC X(09)  VALUE  "113015410".
      *
      *    磁気による膀胱等刺激法
           03  CONS-BOKOHO1-COMMENT  PIC X(09)  VALUE  "140055110".
      *    初回実施　　　月　　日
           03  CONS-BOKOHO2-COMMENT  PIC X(09)  VALUE  "840000085".
      *
      *    通院・在宅精神療法（２０歳未満）加算
           03  CONS-TUINZAI-COMMENT  PIC X(09)  VALUE  "180020570".
      *    児童思春期精神科専門管理加算（１６歳未満）
           03  CONS-TUINZAI2-COMMENT PIC X(09)  VALUE  "180047270".
      *    児童思春期精神科専門管理加算（２０歳未満）
           03  CONS-TUINZAI3-COMMENT PIC X(09)  VALUE  "180047370".
      *
      *    依存症集団療法
           03  CONS-IZONSYO-COMMENT  PIC X(09)  VALUE  "180047910".
      *    治療開始日　　　月　　日
           03  CONS-IZONSYO2-COMMENT PIC X(09)  VALUE  "840000076".
      *
      *    疾患別等専門プログラム加算（精神科ショート・ケア、小規模なもの）
           03  CONS-SCPRO-COMMENT    PIC X(09)  VALUE  "180056570".
      *
      *    在宅患者訪問薬剤管理指導料（単一建物診療患者が１人）
           03  CONS-ZAIYAK-COMMENT   PIC X(09)  VALUE  "114044710".
      *    在宅患者訪問薬剤管理指導料（単一建物診療患者が２人〜９人）
           03  CONS-ZAIYAK2-COMMENT  PIC X(09)  VALUE  "114044810".
      *    在宅患者訪問薬剤管理指導料（単一建物診療患者が１０人〜）
           03  CONS-ZAIYAK3-COMMENT  PIC X(09)  VALUE  "114044910".
      *
      *    乳腺炎重症化予防ケア・指導料（２回目から４回目まで）
           03  CONS-NYUSEN-COMMENT   PIC X(09)  VALUE  "113024510".
      *    通算実施回数（　　回）
           03  CONS-NYUSEN2-COMMENT  PIC X(09)  VALUE  "840000086".
      *    乳腺炎重症化予防ケア・指導料（初回）
           03  CONS-NYUSEN3-COMMENT  PIC X(09)  VALUE  "113024410".
      *
      *    遠隔モニタリング加算（在宅酸素療法指導管理料（その他））
           03  CONS-ZAIMONI-COMMENT  PIC X(09)  VALUE  "114045470".
      *    遠隔モニタリング加算（在宅持続陽圧呼吸療法指導管理料２）
           03  CONS-ZAIMONI2-COMMENT PIC X(09)  VALUE  "114045670".
      *    在宅酸素療法指導管理料（その他）
           03  CONS-ZAISAN-COMMENT   PIC X(09)  VALUE  "114003710".
      *    在宅持続陽圧呼吸療法指導管理料２
           03  CONS-YOUATU2-COMMENT  PIC X(09)  VALUE  "114040810".
      *
      *    高気圧酸素治療（減圧症又は空気塞栓）
           03  CONS-KIATU-COMMENT    PIC X(09)  VALUE  "140057510".
      *    高気圧酸素治療（その他のもの）
           03  CONS-KIATU2-COMMENT   PIC X(09)  VALUE  "140057610".
      *    初回実施　　　月　　日
           03  CONS-KIATU3-COMMENT   PIC X(09)  VALUE  "840000085".
      *    通算実施回数（　　回）
           03  CONS-KIATU4-COMMENT   PIC X(09)  VALUE  "840000086".
      *    発症　　　月　　日
           03  CONS-KIATU5-COMMENT   PIC X(09)  VALUE  "840000045".
      *
      *    オンライン診療料
           03  CONS-ONLINE-COMMENT   PIC X(09)  VALUE  "112023210".
      *    オンライン医学管理料
           03  CONS-ONLINE2-COMMENT  PIC X(09)  VALUE  "113023890".
      *    オンライン在宅管理料（在医総管（月１回訪問診療））
           03  CONS-ONLINE3-COMMENT  PIC X(09)  VALUE  "114043970".
      *    精神科オンライン在宅管理料
           03  CONS-ONLINE4-COMMENT  PIC X(09)  VALUE  "180058270".
      *
      *    特定疾患療養管理料算定患者
           03  CONS-ONLINE11-COMMENT PIC X(09)  VALUE  "820100006".
      *    小児科療養指導料算定患者
           03  CONS-ONLINE12-COMMENT PIC X(09)  VALUE  "820100007".
      *    てんかん指導料算定患者
           03  CONS-ONLINE13-COMMENT PIC X(09)  VALUE  "820100008".
      *    難病外来指導管理料算定患者
           03  CONS-ONLINE14-COMMENT PIC X(09)  VALUE  "820100009".
      *    糖尿病透析予防指導管理料算定患者
           03  CONS-ONLINE15-COMMENT PIC X(09)  VALUE  "820100010".
      *    地域包括診療料算定患者
           03  CONS-ONLINE16-COMMENT PIC X(09)  VALUE  "820100011".
      *    認知症地域包括診療料算定患者
           03  CONS-ONLINE17-COMMENT PIC X(09)  VALUE  "820100012".
      *    生活習慣病管理料算定患者
           03  CONS-ONLINE18-COMMENT PIC X(09)  VALUE  "820100013".
      *    在宅時医学総合管理料算定患者
           03  CONS-ONLINE19-COMMENT PIC X(09)  VALUE  "820100014".
      *    精神科在宅患者支援管理料算定患者
           03  CONS-ONLINE20-COMMENT PIC X(09)  VALUE  "820100015".
      *
      *    妊婦時間外加算（初診）
           03  CONS-NINPU-COMMENT    PIC X(09)  VALUE  "111012970".
      *    妊婦休日加算（初診）
           03  CONS-NINPU2-COMMENT   PIC X(09)  VALUE  "111013070".
      *    妊婦深夜加算（初診）
           03  CONS-NINPU3-COMMENT   PIC X(09)  VALUE  "111013170".
      *    妊婦時間外特例医療機関加算（初診）
           03  CONS-NINPU4-COMMENT   PIC X(09)  VALUE  "111013270".
      *    妊婦加算（初診）
           03  CONS-NINPU5-COMMENT   PIC X(09)  VALUE  "111013370".
      *    妊婦夜間加算（産科又は産婦人科初診）
           03  CONS-NINPU6-COMMENT   PIC X(09)  VALUE  "111013470".
      *    妊婦休日加算（産科又は産婦人科初診）
           03  CONS-NINPU7-COMMENT   PIC X(09)  VALUE  "111013570".
      *    妊婦深夜加算（産科又は産婦人科初診）
           03  CONS-NINPU8-COMMENT   PIC X(09)  VALUE  "111013670".
      *    妊婦時間外加算（再診）（入院外）
           03  CONS-NINPU9-COMMENT   PIC X(09)  VALUE  "112021370".
      *    妊婦休日加算（再診）（入院外）
           03  CONS-NINPU10-COMMENT  PIC X(09)  VALUE  "112021470".
      *    妊婦深夜加算（再診）（入院外）
           03  CONS-NINPU11-COMMENT  PIC X(09)  VALUE  "112021570".
      *    妊婦時間外特例医療機関加算（再診）（入院外）
           03  CONS-NINPU12-COMMENT  PIC X(09)  VALUE  "112021670".
      *    妊婦加算（再診）
           03  CONS-NINPU13-COMMENT  PIC X(09)  VALUE  "112022070".
      *    妊婦夜間加算（産科又は産婦人科再診）（入院外）
           03  CONS-NINPU14-COMMENT  PIC X(09)  VALUE  "112022170".
      *    妊婦休日加算（産科又は産婦人科再診）（入院外）
           03  CONS-NINPU15-COMMENT  PIC X(09)  VALUE  "112022270".
      *    妊婦深夜加算（産科又は産婦人科再診）（入院外）
           03  CONS-NINPU16-COMMENT  PIC X(09)  VALUE  "112022370".
      *    妊婦加算（外来診療料）
           03  CONS-NINPU17-COMMENT  PIC X(09)  VALUE  "112022870".
      *    妊婦時間外加算（外来診療料）（入院外）
           03  CONS-NINPU18-COMMENT  PIC X(09)  VALUE  "112022470".
      *    妊婦休日加算（外来診療料）（入院外）
           03  CONS-NINPU19-COMMENT  PIC X(09)  VALUE  "112022570".
      *    妊婦深夜加算（外来診療料）（入院外）
           03  CONS-NINPU20-COMMENT  PIC X(09)  VALUE  "112022670".
      *    妊婦時間外特例医療機関加算（外来診療料）（入院外）
           03  CONS-NINPU21-COMMENT  PIC X(09)  VALUE  "112022770".
      *    妊婦夜間加算（産科又は産婦人科外来診療料）（入院外）
           03  CONS-NINPU22-COMMENT  PIC X(09)  VALUE  "112022970".
      *    妊婦休日加算（産科又は産婦人科外来診療料）（入院外）
           03  CONS-NINPU23-COMMENT  PIC X(09)  VALUE  "112023070".
      *    妊婦深夜加算（産科又は産婦人科外来診療料）（入院外）
           03  CONS-NINPU24-COMMENT  PIC X(09)  VALUE  "112023170".
      *    妊婦時間外加算（再診）（地域包括診療料）
           03  CONS-NINPU25-COMMENT  PIC X(09)  VALUE  "113024970".
      *    妊婦休日加算（再診）（地域包括診療料）
           03  CONS-NINPU26-COMMENT  PIC X(09)  VALUE  "113025070".
      *    妊婦深夜加算（再診）（地域包括診療料）
           03  CONS-NINPU27-COMMENT  PIC X(09)  VALUE  "113025170".
      *    妊婦時間外特例医療機関加算（再診）（地域包括診療料）
           03  CONS-NINPU28-COMMENT  PIC X(09)  VALUE  "113025270".
      *    妊婦夜間加算（産科又は産婦人科再診）（地域包括診療料）
           03  CONS-NINPU29-COMMENT  PIC X(09)  VALUE  "113025370".
      *    妊婦休日加算（産科又は産婦人科再診）（地域包括診療料）
           03  CONS-NINPU30-COMMENT  PIC X(09)  VALUE  "113025470".
      *    妊婦深夜加算（産科又は産婦人科再診）（地域包括診療料）
           03  CONS-NINPU31-COMMENT  PIC X(09)  VALUE  "113025570".
      *    妊婦時間外加算（再診）（認知症地域包括診療料）
           03  CONS-NINPU32-COMMENT  PIC X(09)  VALUE  "113025870".
      *    妊婦休日加算（再診）（認知症地域包括診療料）
           03  CONS-NINPU33-COMMENT  PIC X(09)  VALUE  "113025970".
      *    妊婦深夜加算（再診）（認知症地域包括診療料）
           03  CONS-NINPU34-COMMENT  PIC X(09)  VALUE  "113026070".
      *    妊婦時間外特例医療機関加算（再診）（認知症地域包括診療料）
           03  CONS-NINPU35-COMMENT  PIC X(09)  VALUE  "113026170".
      *    妊婦夜間加算（産科又は産婦人科再診）（認知症地域包括診療料）
           03  CONS-NINPU36-COMMENT  PIC X(09)  VALUE  "113026270".
      *    妊婦休日加算（産科又は産婦人科再診）（認知症地域包括診療料）
           03  CONS-NINPU37-COMMENT  PIC X(09)  VALUE  "113026370".
      *    妊婦深夜加算（産科又は産婦人科再診）（認知症地域包括診療料）
           03  CONS-NINPU38-COMMENT  PIC X(09)  VALUE  "113026470".
      *    妊婦
           03  CONS-NINPU39-COMMENT  PIC X(09)  VALUE  "820100348".
      *
      *    外来迅速検体検査加算
           03  CONS-GAIJINKEN        PIC X(09)  VALUE  "160177770".
      *
      *    皮下筋肉注射
           03  CONS-HIKAKIN          PIC X(09)  VALUE  "130000510".
      *    生物学的製剤注射
           03  CONS-SEIBUTU          PIC X(09)  VALUE  "130000110".
      *    麻薬注射
           03  CONS-MAYAKU           PIC X(09)  VALUE  "130000310".
      *    静脈内注射
           03  CONS-JYOMYAKU         PIC X(09)  VALUE  "130003510".
      *    静脈内注射（乳幼児）加算
           03  CONS-JYOMYAKUKASAN    PIC X(09)  VALUE  "130003670".
      *
      *    病床数編集フラグ編集の為のコード（特定疾患療養指導料等）
           03  CONS-SIDORYO1         PIC X(09)  VALUE  "113001810".
           03  CONS-SIDORYO2         PIC X(09)  VALUE  "113001910".
           03  CONS-SIDORYO3         PIC X(09)  VALUE  "113002010".
           03  CONS-SIDORYO4         PIC X(09)  VALUE  "113700610".
           03  CONS-SIDORYO5         PIC X(09)  VALUE  "113700710".
           03  CONS-SIDORYO6         PIC X(09)  VALUE  "113700810".
      *
      *    在支援フラグ編集の為のコード
           03  CONS-ZAISIEN1         PIC X(09)  VALUE  "114011570".
           03  CONS-ZAISIEN2         PIC X(09)  VALUE  "114011670".
           03  CONS-ZAISIEN3         PIC X(09)  VALUE  "114011770".
      *
      *    再診料（同一日２科目）
           03  CONS-DOUJITU-SAI      PIC X(09)  VALUE  "112015810".
      *    再診料（同一日２科目・減点規定該当の場合）
           03  CONS-DOUJITU-SAI2     PIC X(09)  VALUE  "112017010".
      *    電話等再診（同一日２科目）
           03  CONS-DOUJITU-DEN      PIC X(09)  VALUE  "112015950".
      *    電話等再診（同一日２科目・減点規定該当の場合）
           03  CONS-DOUJITU-DEN2     PIC X(09)  VALUE  "112017150".
      *    電話等再診料（同一日複数科受診時の２科目）（３０年３月以前継続）
           03  CONS-DOUJITU-DEN3     PIC X(09)  VALUE  "112023550".
      *    電話等特定妥結率再診料（同一日複数科２科目・３０年３月以前継続）
           03  CONS-DOUJITU-DEN4     PIC X(09)  VALUE  "112023850".
      *    外来診療料（同一日２科目）
           03  CONS-DOUJITU-GAI      PIC X(09)  VALUE  "112016210".
      *    外来診療料（同一日２科目：紹介する旨申し出）
           03  CONS-DOUJITU2-GAI     PIC X(09)  VALUE  "112016410".
      *    外来診療料（同一日複数科受診時の２科目・妥結率５割以下）
           03  CONS-DOUJITU3-GAI     PIC X(09)  VALUE  "112017610".
      *
      *    複再算定診療科：
           03  CONS-DOUJITU-COMMENT  PIC X(09)  VALUE  "830000051".
      *
      *    時間外対応加算１
           03  CONS-JIKANTAI1        PIC X(09)  VALUE  "112016070".
      *    時間外対応加算２
           03  CONS-JIKANTAI2        PIC X(09)  VALUE  "112015670".
      *    時間外対応加算３
           03  CONS-JIKANTAI3        PIC X(09)  VALUE  "112016170".
      *    明細書発行体制等加算
           03  CONS-MESAIKSN         PIC X(09)  VALUE  "112015770".
      *    地域包括診療加算
           03  CONS-CHIHOKATU        PIC X(09)  VALUE  "112017270".
      *    認知症地域包括診療加算
           03  CONS-CHIHOKAT2        PIC X(09)  VALUE  "112017570".
      *    地域包括診療加算１
           03  CONS-CHIHOKAT3        PIC X(09) VALUE   "112021770".
      *    認知症地域包括診療加算１
           03  CONS-CHIHOKAT4        PIC X(09) VALUE   "112021870".
      *    薬剤適正使用連携加算（再診）
           03  CONS-YAKRENKEI        PIC X(09) VALUE   "112021970".
      *
      *    剤の診療内容チェックテーブル
       01  TBL-ZAICHECK-AREA.
      *    （サ）
           03  FILLER          PIC X(09)   VALUE    "820000046".
      *    （検選）
           03  FILLER          PIC X(09)   VALUE    "820000053".
      *    （リハ選）
           03  FILLER          PIC X(09)   VALUE    "820000054".
      *    （精選）
           03  FILLER          PIC X(09)   VALUE    "820000055".
      *
       01  TBL-ZAICHECK-R      REDEFINES   TBL-ZAICHECK-AREA.
           03  TBL-ZAICHECK    PIC X(09)   OCCURS    4.
      *
       01  TBL-ZAICHECK-MAX    PIC 9(02)   VALUE     4.
      *
      *    酸素 
           COPY    "CMSANSOTBL.INC".
      *
      *   日本語数字
       01  TBL-SUJI-AREA.
           03  FILLER          PIC X(20)   VALUE
              "１２３４５６７８９０".
       01  TBL-SUJI-R          REDEFINES   TBL-SUJI-AREA.
           03  TBL-SUJI        PIC X(02)   OCCURS   10.
      *
      *    改行コード
       01  WRK-CONS-RETURN     PIC X(01)   VALUE   X"0A".
      *
           COPY    "MCPAREA".
      *
           COPY    "COMMON-SPA".
      *
      *    ＲＥＣＥ４１のワークレコード
       01  WRK-RECE4G-REC. 
           COPY    "CPRCF041.INC"  REPLACING  //RECE41//
                                   BY         //WRK-RECE4G//.
      *
       01  WRK-ERR-AREA.
           03  WRK-RECEERR                         PIC X(200).
           03  WRK-ERRMSG                          PIC X(300).
           03  WRK-MCP-RC                          PIC 9(9).
           03  WRK-ERR-FILE-STS                    PIC X(02).
           03  WRK-ERR-FILE-MSG                    PIC X(100).
           03  WRK-ERR-FILE-MSG1                   PIC X(17).
           03  WRK-ERR-FLG                         PIC 9(01).
      *    エラーファイル名称領域 
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //WRK-ERR-FILE-NM//.
      *
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    ジョブ管理マスタ
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *    診療会計
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    診療会計付加情報マスタ−
       01  SRYACCTPLUS-REC.
           COPY    "CPSRYACCTPLUS.INC".
      *
      *    診療行為
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    点数
           COPY    "CPTENSU.INC".
      *
      *    患者コメント
       01  PTCOM-REC.
       COPY    "CPPTCOM.INC".
      *
      *    収納
       01  SYUNOU-REC.
           COPY    "CPSYUNOU.INC".
      *
      *    システム管理マスタ
           COPY    "CPSYSKANRI.INC".
      *    医療機関情報−基本
           COPY    "CPSK1001.INC".
           COPY    "CPSK1006.INC".
      *
           COPY    "CPSK4003.INC".
      *
           COPY    "CPSK200501.INC".
      *
           COPY    "CPSK1030.INC".
      *
      *****************************************************************
      *    サブプロ用領域
      *****************************************************************
      *
      *    半角チェックサブ
           COPY    "CPORCSKANACHK.INC".
      *
      *   日付変換サブ
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    患者番号変換サブ
           COPY    "CPORCSPTID.INC".
      *    数値変換サブ
           COPY    "CPORCSNUM.INC".
      *    チェックディジット（モジュラス１１用）算出サブ
           COPY    "CPORCCHKDGT11.INC".
      *   ジョブ管理ＤＢ制御サブ
           COPY    "CPORCSJOBKANRI.INC".
      *
           COPY    "CPORCSGETTEMP.INC".
      *    院外処方一般名編集サブ
           COPY    "CPORCSGETGENERIC.INC".
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      *
      ****************************************************************
       LINKAGE                 SECTION.
       01  COMMAND-PARAM.
           02  FILLER      PIC X(256).
      ****************************************************************
       PROCEDURE           DIVISION
               USING
           COMMAND-PARAM.
      *
      *****************************************************************
      *    主処理
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC    UNTIL   FLG-END =   1 
      *
           PERFORM 300-TERM-SEC
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               STOP    RUN
           ELSE
               EXIT    PROGRAM
           END-IF 
           .
      *****************************************************************
      *    初期　処理
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  CNT-AREA
                                       WRK-AREA
                                       FLG-AREA
                                       SPA-AREA
                                       RECEERR
      *
           UNSTRING    COMMAND-PARAM   DELIMITED  BY  ","
                                       INTO    WRK-PARA
                                               WRK-PARA-JIBAIPRTKBN
                                               WRK-PARA-PRTKBN
                                               WRK-PARA-HOSPNUM
                                               RECEERR
           END-UNSTRING
           MOVE    WRK-PARA-HOSPNUM    TO  SPA-HOSPNUM
      *
           MOVE    SPACE               TO  RECE41PARA
           INITIALIZE                      RECE41PARA
           MOVE    "RECE410"           TO  RECE41PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE41PARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE41PARA-HOSPNUM
      *
           MOVE    SPACE               TO  RECE44PARA
           INITIALIZE                      RECE44PARA
           MOVE    "RECE440"           TO  RECE44PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE44PARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE44PARA-HOSPNUM
           MOVE    SPACE               TO  RECE45PARA
           INITIALIZE                      RECE45PARA
           MOVE    "RECE450"           TO  RECE45PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE45PARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE45PARA-HOSPNUM
      *
           MOVE    SPACE               TO  RECE4APARA
           INITIALIZE                      RECE4APARA
           MOVE    "RECE441"           TO  RECE4APARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE4APARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE4APARA-HOSPNUM
           MOVE    SPACE               TO  RECE4BPARA
           INITIALIZE                      RECE4BPARA
           MOVE    "RECE451"           TO  RECE4BPARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE4BPARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE4BPARA-HOSPNUM
      *
           MOVE    SPACE               TO  RECE44CPARA
           INITIALIZE                      RECE44CPARA
           MOVE    "RECE44C"           TO  RECE44CPARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE44CPARA-TERMID
           MOVE    WRK-PARA-HOSPNUM    TO  RECE44CPARA-HOSPNUM
           MOVE    SPACE               TO  RECE45CPARA
           INITIALIZE                      RECE45CPARA
           MOVE    "RECE45C"           TO  RECE45CPARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE45CPARA-TERMID
           MOVE    WRK-PARA-HOSPNUM    TO  RECE45CPARA-HOSPNUM
      *
           INITIALIZE                      SGETTEMP-AREA
           MOVE    RECEERR             TO  SGETTEMP-BASENAMES  (1)
           MOVE    RECE41PARA-BASENAME TO  SGETTEMP-BASENAMES  (2)
           MOVE    RECE44PARA-BASENAME TO  SGETTEMP-BASENAMES  (3)
           MOVE    RECE45PARA-BASENAME TO  SGETTEMP-BASENAMES  (4)
           MOVE    RECE4APARA-BASENAME TO  SGETTEMP-BASENAMES  (5)
           MOVE    RECE4BPARA-BASENAME TO  SGETTEMP-BASENAMES  (6)
           MOVE    RECE44CPARA-BASENAME
                                       TO  SGETTEMP-BASENAMES  (7)
           MOVE    RECE45CPARA-BASENAME
                                       TO  SGETTEMP-BASENAMES  (8)
           CALL    "ORCSGETTEMP"       USING   SGETTEMP-AREA
           MOVE    SGETTEMP-FULLNAMES (1)
                                       TO  RECEERR
           MOVE    SGETTEMP-FULLNAMES (2)
                                       TO  RECE41PARA
           MOVE    SGETTEMP-FULLNAMES (3)
                                       TO  RECE44PARA
           MOVE    SGETTEMP-FULLNAMES (4)
                                       TO  RECE45PARA
           MOVE    SGETTEMP-FULLNAMES (5)
                                       TO  RECE4APARA
           MOVE    SGETTEMP-FULLNAMES (6)
                                       TO  RECE4BPARA
           MOVE    SGETTEMP-FULLNAMES (7)
                                       TO  RECE44CPARA
           MOVE    SGETTEMP-FULLNAMES (8)
                                       TO  RECE45CPARA
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               PERFORM 100-DBOPEN-SEC
      *
      *        ステップ管理開始処理
               MOVE    "STS"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               MOVE    "ORCR0420"      TO  JOB-PGID
               MOVE    "診療区分別点数集計（労災・自賠責）"
                                       TO  JOB-SHELLMSG
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
      *        処理中止設定処理
               PERFORM 500-CANCEL-HENSYU-SEC
           END-IF
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
      *       医療機関情報−基本
              INITIALIZE                      SYS-1001-REC
              MOVE    "1001"              TO  SYS-1001-KANRICD
              MOVE    "*"                 TO  SYS-1001-KBNCD
              MOVE    WRK-PARA-SRYYM      TO  SYS-1001-STYUKYMD (1:6)
              MOVE    "01"                TO  SYS-1001-STYUKYMD (7:2)
              MOVE    SYS-1001-STYUKYMD   TO  SYS-1001-EDYUKYMD 
grpsys        MOVE    SPA-HOSPNUM         TO  SYS-1001-HOSPNUM
              MOVE    SYS-1001-REC        TO  MCPDATA-REC
              PERFORM 800-SYSKANRI-READ-SEC
              IF      FLG-SYSKANRI        =   ZERO
                  MOVE    MCPDATA-REC     TO  SYS-1001-REC
                  MOVE    SYS-1001-TAX-HASU-KBN
                                          TO  WRK-TAX1001-KBN
                  IF   WRK-TAX1001-KBN = SPACE
                     MOVE   "2"           TO  WRK-TAX1001-KBN
                  END-IF
                  MOVE    SYS-1001-DAISANKBN
                                          TO  WRK-DAISAN-DAISANKBN
                  IF  WRK-DAISAN-DAISANKBN = SPACE
                    MOVE  "2"             TO  WRK-DAISAN-DAISANKBN
                  END-IF
                  MOVE    SYS-1001-DISCOUNT-HASU-KBN4
                                          TO  WRK-HASU1001-JIBAI
                  IF  WRK-HASU1001-JIBAI = SPACE
                    MOVE  "4"             TO  WRK-HASU1001-JIBAI
                  END-IF
                  MOVE    SYS-1001-DISCOUNT-HASU-KBN6
                                          TO  WRK-HASU1001-DAISAN
                  IF  WRK-HASU1001-DAISAN = SPACE
                    MOVE  WRK-HASU1001-JIBAI
                                          TO  WRK-HASU1001-DAISAN
                  END-IF
              ELSE
                  MOVE    "医療機関情報が取得できませんでした。"
                                              TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
                  MOVE    1                   TO  FLG-END
              END-IF
      *       施設基準情報
              MOVE     ZERO     TO     WRK-SISETU613
              MOVE     ZERO     TO     WRK-SISETU695
              MOVE     ZERO     TO     WRK-SISETU3055
              MOVE     ZERO     TO     WRK-SISETU3056
              MOVE     ZERO     TO     WRK-SISETU3057
              MOVE     ZERO     TO     WRK-SISETU3058
              MOVE     ZERO     TO     WRK-SISETU3168
              MOVE     ZERO     TO     WRK-SISETU3169
              PERFORM  VARYING  IDXA   FROM   1   BY  1
                        UNTIL   IDXA     >    7
               IF   IDXA  =  1 OR 3 OR 4 OR 5 OR 6
                 CONTINUE
               ELSE
                 INITIALIZE                    SYS-1006-REC
                 MOVE    "1006"            TO  SYS-1006-KANRICD
                 MOVE    IDXA              TO  SYS-1006-KBNCD
                 MOVE    WRK-PARA-SRYYM    TO  SYS-1006-STYUKYMD(1:6)
                 MOVE    "01"              TO  SYS-1006-STYUKYMD(7:2)
                 MOVE    SYS-1006-STYUKYMD TO  SYS-1006-EDYUKYMD
grpsys           MOVE    SPA-HOSPNUM       TO  SYS-1006-HOSPNUM
                 MOVE    SYS-1006-REC      TO  MCPDATA-REC
                 PERFORM 800-SYSKANRI-READ-SEC
                 IF      FLG-SYSKANRI     =   ZERO
                   MOVE    MCPDATA-REC     TO  SYS-1006-REC
                   EVALUATE  IDXA
                     WHEN     2
                       MOVE  SYS-1006-SSTKIJUN(113)  TO  WRK-SISETU613
                       MOVE  SYS-1006-SSTKIJUN(195)  TO  WRK-SISETU695
                     WHEN     7
                       MOVE  SYS-1006-SSTKIJUN(55)   TO  WRK-SISETU3055
                       MOVE  SYS-1006-SSTKIJUN(56)   TO  WRK-SISETU3056
                       MOVE  SYS-1006-SSTKIJUN(57)   TO  WRK-SISETU3057
                       MOVE  SYS-1006-SSTKIJUN(58)   TO  WRK-SISETU3058
                       MOVE  SYS-1006-SSTKIJUN(168)  TO  WRK-SISETU3168
                       MOVE  SYS-1006-SSTKIJUN(169)  TO  WRK-SISETU3169
                   END-EVALUATE
                 END-IF
               END-IF
              END-PERFORM
      *       帳票編集区分情報
              MOVE    SPACE               TO  WRK-1030-KOUHATUKA
      **>     IF      WRK-PARA-PRTKBN = "2" OR "3" OR "4" OR "5"
                INITIALIZE                      SYS-1030-REC
                MOVE    "1030"              TO  SYS-1030-KANRICD
                MOVE    "*"                 TO  SYS-1030-KBNCD
                MOVE    WRK-PARA-SRYYM      TO  SYS-1030-STYUKYMD(1:6)
                MOVE    "01"                TO  SYS-1030-STYUKYMD(7:2)
                MOVE    SYS-1030-STYUKYMD   TO  SYS-1030-EDYUKYMD
                MOVE    SPA-HOSPNUM         TO  SYS-1030-HOSPNUM
                MOVE    SYS-1030-REC        TO  MCPDATA-REC
                PERFORM 800-SYSKANRI-READ-SEC
                IF      FLG-SYSKANRI     =   ZERO
                  MOVE  MCPDATA-REC         TO  SYS-1030-REC
                  MOVE  SYS-1030-KOUHATUKA  TO  WRK-1030-KOUHATUKA
                END-IF
      **>     END-IF
           ELSE
              MOVE     ZERO               TO  SYSKAN-IDX
              MOVE     SPACE              TO  TBL-SYS1001-T
              INITIALIZE                      TBL-SYS1001-T
      *
              INITIALIZE                      SYS-1001-REC
              MOVE    "1001"              TO  SYS-1001-KANRICD
              MOVE    "*"                 TO  SYS-1001-KBNCD
grpsys        MOVE    SPA-HOSPNUM         TO  SYS-1001-HOSPNUM
              MOVE    SYS-1001-REC        TO  MCPDATA-REC
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
grpsys        PERFORM 900-DBSELECT-SEC
              IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"  TO  MCP-TABLE
                  MOVE    "key8"          TO  MCP-PATHNAME
                  PERFORM 810-SYSKANRI-READ-SEC
                  PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                            OR    (SYSKAN-IDX   >=  100)
      *
                    MOVE    MCPDATA-REC   TO  SYS-1001-REC
                    ADD     1             TO  SYSKAN-IDX
                    MOVE    SYS-1001-REC  TO  TBL-SYS1001(SYSKAN-IDX)
      *
                    MOVE    "tbl_syskanri"  TO  MCP-TABLE
                    MOVE    "key8"          TO  MCP-PATHNAME
                    PERFORM 810-SYSKANRI-READ-SEC
                  END-PERFORM
              ELSE
                  MOVE    "医療機関情報が取得できませんでした。"
                                          TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
                  MOVE    1               TO  FLG-END
              END-IF
      *
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
              PERFORM 900-CLOSE-SEC
      *
              MOVE     SPACE              TO  TBL-SYS1006-T
              INITIALIZE                      TBL-SYS1006-T
      *
              PERFORM  VARYING  IDXA   FROM   1   BY  1
                        UNTIL   IDXA     >    7
               IF   IDXA  =  1 OR 3 OR 4 OR 5 OR 6
                 CONTINUE
               ELSE
                 MOVE     ZERO            TO  SYSKAN-IDX2
                 INITIALIZE                   SYS-1006-REC
                 MOVE    "1006"           TO  SYS-1006-KANRICD
                 MOVE    IDXA             TO  SYS-1006-KBNCD
grpsys           MOVE    SPA-HOSPNUM      TO  SYS-1006-HOSPNUM
                 MOVE    SYS-1006-REC     TO  MCPDATA-REC
                 MOVE    "tbl_syskanri"   TO  MCP-TABLE
                 MOVE    "key8"           TO  MCP-PATHNAME
grpsys           PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC           =   ZERO
                     MOVE    "tbl_syskanri"   TO  MCP-TABLE
                     MOVE    "key8"           TO  MCP-PATHNAME
                     PERFORM 810-SYSKANRI-READ-SEC
                     PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                               OR    (SYSKAN-IDX2  >=  100)
      *
                       MOVE    MCPDATA-REC    TO  SYS-1006-REC
                       EVALUATE  IDXA
                         WHEN     2
                           ADD     1     TO  SYSKAN-IDX2
                           MOVE    SYS-1006-REC
                                         TO  TBL-SYS10062(SYSKAN-IDX2)
                         WHEN     7
                           ADD     1     TO  SYSKAN-IDX2
                           MOVE    SYS-1006-REC
                                         TO  TBL-SYS10067(SYSKAN-IDX2)
                       END-EVALUATE
      *
                       MOVE    "tbl_syskanri"   TO  MCP-TABLE
                       MOVE    "key8"           TO  MCP-PATHNAME
                       PERFORM 810-SYSKANRI-READ-SEC
                     END-PERFORM
                 END-IF
                 MOVE    "tbl_syskanri"      TO  MCP-TABLE
                 MOVE    "key8"              TO  MCP-PATHNAME
                 PERFORM 900-CLOSE-SEC
               END-IF
              END-PERFORM
      *
              MOVE     ZERO               TO  SYSKAN-IDX
              MOVE     SPACE              TO  TBL-SYS1030-T
              INITIALIZE                      TBL-SYS1030-T
      **>     IF      WRK-PARA-PRTKBN = "2" OR "3" OR "4" OR "5"
                INITIALIZE                      SYS-1030-REC
                MOVE    "1030"              TO  SYS-1030-KANRICD
                MOVE    "*"                 TO  SYS-1030-KBNCD
                MOVE    SPA-HOSPNUM         TO  SYS-1030-HOSPNUM
                MOVE    SYS-1030-REC        TO  MCPDATA-REC
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key8"              TO  MCP-PATHNAME
                PERFORM 900-DBSELECT-SEC
                IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"    TO  MCP-TABLE
                  MOVE    "key8"            TO  MCP-PATHNAME
                  PERFORM 810-SYSKANRI-READ-SEC
                  PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                            OR    (SYSKAN-IDX   >=  100)
      *
                    MOVE    MCPDATA-REC     TO  SYS-1030-REC
                    ADD     1               TO  SYSKAN-IDX
                    MOVE    SYS-1030-REC    TO  TBL-SYS1030(SYSKAN-IDX)
      *
                    MOVE    "tbl_syskanri"  TO  MCP-TABLE
                    MOVE    "key8"          TO  MCP-PATHNAME
                    PERFORM 810-SYSKANRI-READ-SEC
                  END-PERFORM
                END-IF
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key8"              TO  MCP-PATHNAME
                PERFORM 900-CLOSE-SEC
      **>     END-IF
           END-IF
      *
           INITIALIZE                      SYS-200501-REC
           MOVE    "2005"              TO  SYS-200501-KANRICD
           MOVE    "01"                TO  SYS-200501-KBNCD
           MOVE    WRK-PARA-SRYYM      TO  SYS-200501-STYUKYMD (1:6)
           MOVE    "01"                TO  SYS-200501-STYUKYMD (7:2)
           MOVE    SYS-200501-STYUKYMD TO  SYS-200501-EDYUKYMD
           MOVE    SPA-HOSPNUM         TO  SYS-200501-HOSPNUM
           MOVE    SYS-200501-REC      TO  MCPDATA-REC
           PERFORM 800-SYSKANRI-READ-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC     TO  SYS-200501-REC
           ELSE
               INITIALIZE                  SYS-200501-REC
           END-IF
           IF      SYS-200501-ROURECEKBN  =   SPACE
               MOVE    "0"             TO  SYS-200501-ROURECEKBN
           END-IF
           IF      SYS-200501-JIBAI-FRACTION-KBN(1)  =   SPACE
               MOVE    "0"   TO  SYS-200501-JIBAI-FRACTION-KBN(1)
           END-IF
           IF      SYS-200501-JIBAI-FRACTION-KBN(2)  =   SPACE
               MOVE    "0"   TO  SYS-200501-JIBAI-FRACTION-KBN(2)
           END-IF
           IF      SYS-200501-INSPECT-GENERAL-KBN   =   SPACE
               MOVE    "0"   TO  SYS-200501-INSPECT-GENERAL-KBN
           END-IF
           IF      SYS-200501-COMPRESS-KBN          =   SPACE
               MOVE    "0"   TO  SYS-200501-COMPRESS-KBN
           END-IF
           IF      SYS-200501-15-YKZ-PRTKBN         =   SPACE
               MOVE    "0"   TO  SYS-200501-15-YKZ-PRTKBN
           END-IF
      *                             
      *    レセプト処理
      *
           OPEN    OUTPUT              RECE44-FILE
           CLOSE                       RECE44-FILE
      *
           OPEN    OUTPUT              RECE45-FILE
           CLOSE                       RECE45-FILE
      *
           OPEN    OUTPUT              RECE4A-FILE
           CLOSE                       RECE4A-FILE
      *
           OPEN    OUTPUT              RECE4B-FILE
           CLOSE                       RECE4B-FILE
      *
           OPEN    OUTPUT              RECE44C-FILE
           CLOSE                       RECE44C-FILE
      *
           OPEN    OUTPUT              RECE45C-FILE
           CLOSE                       RECE45C-FILE
      *
           OPEN    OUTPUT              RECE44-FILE
      ***                              RECE45-FILE
           OPEN    I-O                 RECE45-FILE
      *
           OPEN    OUTPUT              RECE4A-FILE
                                       RECE4B-FILE
      *
           OPEN    OUTPUT              RECE44C-FILE
           OPEN    I-O                 RECE45C-FILE
      *
           OPEN    I-O                 RECE41-FILE
      *
           PERFORM     900-RECE41-READ-SEC
      *
           .
       100-INIT-EXT.
           EXIT.
      * 
      *****************************************************************
      *    主処理
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
           PERFORM     210-HENSYU-SEC
      *      
           PERFORM     900-RECE41-READ-SEC
           IF      CNT-IN-COMMIT   =   300
               MOVE  ZERO          TO      CNT-IN-COMMIT
               PERFORM 900-DBCOMMIT-SEC
               PERFORM 900-DBSTART-SEC
           END-IF
      *
      *    処理中止設定処理
           IF      CNT-IN-CANCEL       =   50
               MOVE    ZERO                TO  CNT-IN-CANCEL
               PERFORM 500-CANCEL-HENSYU-SEC
           END-IF
      *
           .
       200-MAIN-EXT.
           EXIT.
      * 
      *****************************************************************
      *    編集処理
      *****************************************************************
       210-HENSYU-SEC                   SECTION.
      *
      *    消費税計算の係数設定
           IF  RECE41-SRYYM >= "201404"
               MOVE       8      TO  WRK-S1
               MOVE     108      TO  WRK-S2
               MOVE     0.08     TO  WRK-S4
               MOVE     1.08     TO  WRK-S5
           ELSE
               MOVE       5      TO  WRK-S1
               MOVE     105      TO  WRK-S2
               MOVE     0.05     TO  WRK-S4
               MOVE     1.05     TO  WRK-S5
           END-IF
           EVALUATE  WRK-TAX1001-KBN
               WHEN      "1"
                 MOVE   0.50000  TO  WRK-S3
               WHEN      "2"
                 MOVE   0.00000  TO  WRK-S3
               WHEN      "3"
                 MOVE   0.99999  TO  WRK-S3
           END-EVALUATE
      *
           INITIALIZE                   WRK-RECE4G-REC
      *
           MOVE       ZERO       TO     WRK-ZAITENNASHI
      *
           MOVE       ZERO       TO     WRK-SURYOU-COUNT
      *
           INITIALIZE                   FLG-SAISIN-AREA
           INITIALIZE                   CNT-SAISIN-AREA
      *
           INITIALIZE                   TBL-ZAITAKU-KAISU-XXX
      *
           MOVE       ZERO       TO     WRK-TAIHI-ZAINUM
           MOVE       ZERO       TO     WRK-TAIHI-ZAINUM2
      *
           IF      RECE41-HKNKBN   NOT  =   "3"
      *
              INITIALIZE                   FLG-KHNTEN-AREA
              INITIALIZE                   FLG-KHNTEN-JI-AREA           
              INITIALIZE                   FLG-KHNTEN-JI2-AREA
              INITIALIZE                   FLG-KHNTEN-KO-AREA
              INITIALIZE                   TBL-TENSUG-JI
      *
              MOVE       ZERO       TO     WRK-KINGAKU-JI
      *
              PERFORM    VARYING    IDX    FROM   1   BY   1
                         UNTIL     (IDX      >   20)  OR
                                   (RECE41-SRYKA(IDX)   =   SPACE)
                  PERFORM     2101-RECE44-HENSYU-SEC
              END-PERFORM
      *
              EVALUATE   RECE41-HKNKBN
                WHEN       "1"
                WHEN       "2"
                  PERFORM     2102-KHNTEN-CLEAR-SEC
                WHEN       "4"
                WHEN       "6"
                  PERFORM     2103-KHNTEN-JI-CLEAR-SEC                       
                WHEN       "5"
                  PERFORM     2106-KHNTEN-KO-CLEAR-SEC
              END-EVALUATE
      *
           ELSE
      *
              PERFORM    VARYING    IDX    FROM   1   BY   1
                         UNTIL     (IDX      >   20)  OR
                                   (RECE41-SRYKA(IDX)   =   SPACE)
                  PERFORM     2104-RECE44-HENSYU2-SEC
              END-PERFORM
      *
           END-IF
      *
           PERFORM     2107-GENTEN-HENSYU-SEC
      *
      *    在宅回数の再編集
           PERFORM     2108-ZAITAKU-KAISU-HENSYU-SEC
      *
      *    自賠責・請求金額欄端数処理区分編集
           PERFORM     2109-JIBAI-HASUKBN-HENSYU-SEC
      *
           PERFORM     2105-RECE41-REWRITE-SEC
           .
       210-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成
      *****************************************************************
       2101-RECE44-HENSYU-SEC                SECTION.
      *
           INITIALIZE                           SRYACCT-REC
           MOVE    RECE41-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    RECE41-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    RECE41-PTID          TO      ACCT-PTID
           MOVE    RECE41-SRYKA(IDX)    TO      ACCT-SRYKA
           MOVE    RECE41-SRYYM         TO      ACCT-SRYYM
           MOVE    RECE41-HKNCOMBI      TO      ACCT-HKNCOMBI
           MOVE    SRYACCT-REC          TO      MCPDATA-REC
           MOVE    "tbl_sryacct"        TO      MCP-TABLE
           MOVE    "key24"              TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryacct"    TO      MCP-TABLE
               MOVE    "key24"          TO      MCP-PATHNAME
               PERFORM  800-SRYACCT-READ-SEC
               PERFORM  UNTIL     FLG-SRYACCT   =   1 
      *
                 MOVE   ZERO          TO  FLG-RINYAK
      *
                 IF    ACCT-SRYKBN       =  "95"  OR  "96"
                   CONTINUE
                 ELSE
      *
                   MOVE     ZERO    TO    FLG-TAISYO
                   IF   (ACCT-SRYKBN         =   "80" )
                   AND  (ACCT-ZAITEN         =   ZERO )
                   AND  (ACCT-ZAIKAISU   NOT =   ZERO )
                   AND  (ACCT-JIHOKBN        =   SPACE)
                     PERFORM  21015-SRYACCTPLUS-KENSAKU-SEC
                   END-IF
      *
                   IF  ((ACCT-ZAITEN    NOT =    ZERO ) AND
                        (ACCT-ZAIKAISU  NOT =    ZERO ) AND
                        (WRK-PARA-PRTKBN    =
                                    "1" OR "2" OR "3" ) AND
                        (ACCT-JIHOKBN       =    SPACE))
                   OR  ((ACCT-ZAITEN    NOT =    ZERO ) AND
                        (ACCT-ZAIKAISU  NOT =    ZERO ) AND
                        (WRK-PARA-PRTKBN    =
                                           "4" OR "5" ))
                   OR  ( FLG-TAISYO         =      1   )
                               MOVE    ZERO    TO      WRK-TEN
                                                       WRK-MEISAI-CNT
                                                       WRK-SRYCDTOTAL
                                                       WRK-SURYOUTOTAL
                                                       WRK-YOUBUKASAN
                                                       WRK-KYOBUKASAN
                                                       WRK-KEIBUKASAN
                                                       WRK-SOGAIKASAN
                                                       WRK-RYOYOTEATE
                                                       WRK-ZAI-KINGAKU
      *
                               MOVE    ZERO    TO      WRK-SRYSURYO
                                                       WRK-SRYSURYO2
                                                       WRK-SRYSURYO3
                                                       WRK-TANICD
                                                       WRK-TANIMOJISU
                               MOVE    SPACE   TO      WRK-TANINAME
                               MOVE    ZERO    TO      FLG-HOUSIJI-COM
                                                       FLG-HOUTEN-COM
                                                       FLG-SYOBYO-COM
                                                       FLG-RYOYO-COM
                                                       FLG-SYODOU-COM
                                                       FLG-SAIDOU-COM
                                                       FLG-NIKOCHIN-COM
                                                       FLG-ZENSOKU-COM
                                                       FLG-OSIN-COM
                                                       FLG-ZAIHOU-COM
                                                       FLG-TAHOKEN
                                                       FLG-SYOUNI-COM
                                                       FLG-SRYKBN-HEN
                                                       FLG-KENSA-COM
                                                       FLG-ZAIRIHA-COM
                                                       FLG-ZAIKYO-COM
                                                       FLG-BOKOHO-COM
                                                       FLG-IZONSYO-COM
                                                       FLG-NINRYO-COM
                                                       FLG-NYUSEN-COM
                                                       FLG-KIATU-COM
      *
                               MOVE    SPACE   TO      WRK-KYUGYOFLG
                               MOVE    ZERO    TO      FLG-COUNT-ARI
      *
                               MOVE    SPACE   TO      WRK-FORMALNAME
                               MOVE    ZERO    TO
                                               WRK-KZI058-TEN
                                               WRK-KZI058-TANICD
                                               WRK-KZI058-TANIMOJISU
                               MOVE    SPACE   TO
                                               WRK-KZI058-TANINAME
      *
                               MOVE    ZERO    TO      FLG-WRITE45
                               MOVE    ZERO    TO      FLG-HENSYU-NG
                               MOVE    ZERO    TO      FLG-SETCOM
                               MOVE    ZERO    TO      WRK-SETCOM-JIDO
                               MOVE    ZERO    TO      WRK-SETCOM-JIDO2
                               MOVE    ZERO    TO      FLG-ZAITAKU-CHECK
                               MOVE    ZERO    TO      FLG-KIN-OKIKAE
                               MOVE    ZERO    TO      FLG-KIN-OKIKAE2
                               MOVE    ZERO    TO      FLG-SIPPU-COM
                               MOVE    ZERO    TO      FLG-SIPPU-ARI
                               MOVE    ZERO    TO      FLG-YKZ-PRTKBN
                               PERFORM   21011-RECE44-TENSOU-SEC
                               PERFORM   21012-RECE45-HENSYU-SEC
                               IF    FLG-WRITE45  =   1
                                 PERFORM 21013-RECE44-WRITE-SEC
                               END-IF
                   ELSE
                             IF    ACCT-ZAIKAISU  NOT =    ZERO
                             AND   ACCT-JIHOKBN       =    SPACE
      **>                    IF  ((ACCT-ZAIKAISU  NOT =    ZERO ) AND
      **>                         (WRK-PARA-PRTKBN    =
      **>                                     "1" OR "2" OR "3" ) AND
      **>                         (ACCT-JIHOKBN       =    SPACE))
      **>                    OR  ((ACCT-ZAIKAISU  NOT =    ZERO ) AND
      **>                         (WRK-PARA-PRTKBN    =
      **>                                            "4" OR "5" ))
                               IF ( ACCT-SRYKBN  NOT =
                                    "24" AND "90" AND "92" AND
                                    "93" AND "97"                 )
                               OR ( ACCT-ZAIKBN  =   1            )
                                 IF  (ACCT-SRYCDTOTAL(1:12)  =
                                                    "000000999901")
                                 AND (ACCT-MEISAISU      =   1    )
                                      CONTINUE
                                 ELSE
                                      MOVE  ZERO  TO  WRK-TEN
                                                      WRK-MEISAI-CNT
                                                      WRK-SRYCDTOTAL
                                                      WRK-SURYOUTOTAL
                                                      WRK-YOUBUKASAN
                                                      WRK-KYOBUKASAN
                                                      WRK-KEIBUKASAN
                                                      WRK-SOGAIKASAN
                                                      WRK-RYOYOTEATE
                                                      WRK-ZAI-KINGAKU
      *
                                      MOVE  ZERO  TO  WRK-SRYSURYO
                                                      WRK-SRYSURYO2
                                                      WRK-SRYSURYO3
                                                      WRK-TANICD
                                                      WRK-TANIMOJISU
                                      MOVE  SPACE TO  WRK-TANINAME
                                      MOVE  ZERO  TO  FLG-HOUSIJI-COM
                                                      FLG-HOUTEN-COM
                                                      FLG-SYOBYO-COM
                                                      FLG-RYOYO-COM
                                                      FLG-SYODOU-COM
                                                      FLG-SAIDOU-COM
                                                      FLG-NIKOCHIN-COM
                                                      FLG-ZENSOKU-COM
                                                      FLG-OSIN-COM
                                                      FLG-ZAIHOU-COM
                                                      FLG-TAHOKEN
                                                      FLG-SYOUNI-COM
                                                      FLG-SRYKBN-HEN
                                                      FLG-KENSA-COM
                                                      FLG-ZAIRIHA-COM
                                                      FLG-ZAIKYO-COM
                                                      FLG-BOKOHO-COM
                                                      FLG-IZONSYO-COM
                                                      FLG-NINRYO-COM
                                                      FLG-NYUSEN-COM
                                                      FLG-KIATU-COM
      *
                                      MOVE  SPACE TO  WRK-KYUGYOFLG
                                      MOVE  ZERO  TO  FLG-COUNT-ARI
      *
                                      MOVE  SPACE TO  WRK-FORMALNAME
                                      MOVE  ZERO  TO
                                                  WRK-KZI058-TEN
                                                  WRK-KZI058-TANICD
                                                  WRK-KZI058-TANIMOJISU
                                      MOVE  SPACE TO
                                                  WRK-KZI058-TANINAME
      *
                                      MOVE  ZERO  TO  FLG-WRITE45
                                      MOVE  ZERO  TO  FLG-HENSYU-NG
                                      MOVE  ZERO  TO  FLG-SETCOM
                                      MOVE  ZERO  TO  WRK-SETCOM-JIDO
                                      MOVE  ZERO  TO  WRK-SETCOM-JIDO2
                                      MOVE  ZERO  TO  FLG-ZAITAKU-CHECK
                                      MOVE  ZERO  TO  FLG-KIN-OKIKAE
                                      MOVE  ZERO  TO  FLG-KIN-OKIKAE2
                                      MOVE  ZERO  TO  FLG-SIPPU-COM
                                      MOVE  ZERO  TO  FLG-SIPPU-ARI
                                      MOVE  ZERO  TO  FLG-YKZ-PRTKBN
                                      IF    ACCT-SRYKBN  =
                                            "60" OR "64" OR "80"
                                        PERFORM 21014-SINRYO-CHECK-SEC
                                      END-IF
                                      PERFORM   21011-RECE44-TENSOU-SEC
                                      PERFORM   21012-RECE45-HENSYU-SEC
                                      IF    FLG-WRITE45  =   1
                                        PERFORM 21013-RECE44-WRITE-SEC
                                      END-IF
                                 END-IF
                               END-IF
                             END-IF
                   END-IF
                 END-IF
      *
                 MOVE    "tbl_sryacct"    TO      MCP-TABLE
                 MOVE    "key24"          TO      MCP-PATHNAME
                 PERFORM   800-SRYACCT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryacct"       TO  MCP-TABLE
           MOVE    "key24"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       2101-RECE44-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送
      *****************************************************************
       21011-RECE44-TENSOU-SEC                SECTION.
      *
           MOVE    SPACE                TO      RECE44-REC
           INITIALIZE                           RECE44-REC
           MOVE    RECE41-HOSPNUM       TO      RECE44-HOSPNUM
           MOVE    RECE41-SRYYM         TO      RECE44-SRYYM
           MOVE    RECE41-NYUGAIKBN     TO      RECE44-NYUGAIKBN
           MOVE    RECE41-PTID          TO      RECE44-PTID
           MOVE    RECE41-RECEKA        TO      RECE44-RECEKA
           MOVE    RECE41-HKNID         TO      RECE44-HKNID
           MOVE    RECE41-TEKSTYMD      TO      RECE44-TEKSTYMD
           MOVE    RECE41-PTNUM         TO      RECE44-PTNUM 
           MOVE    ACCT-ZAINUM          TO      RECE44-ZAINUM
           MOVE    ACCT-SRYKBN          TO      RECE44-SRYKBN
           MOVE    ACCT-SRYKA           TO      RECE44-SRYKA
           MOVE    ACCT-HKNCOMBI        TO      RECE44-HKNCOMBI
           MOVE    ACCT-JIHOKBN         TO      RECE44-JIHOKBN
           MOVE    ACCT-ZAITEN          TO      RECE44-ZAITEN
           MOVE    ACCT-SRYCDTOTAL      TO      RECE44-SRYCDTOTAL
           MOVE    ACCT-SURYOUTOTAL     TO      RECE44-SURYOUTOTAL
           MOVE    ACCT-MEISAISU        TO      RECE44-MEISAISU
           IF      RECE41-HKNKBN   NOT  =   "3"
              MOVE    ACCT-ZAIKAISU     TO      RECE44-ZAIKAISU
           ELSE
              MOVE    WRK-ZAIKAISU-XXX  TO      RECE44-ZAIKAISU
           END-IF
           MOVE    ACCT-SYUTEN1         TO      RECE44-SYUTEN1
           MOVE    ACCT-SYUTEN2         TO      RECE44-SYUTEN2
           MOVE    ACCT-YKZTEN          TO      RECE44-YKZTEN
           MOVE    ACCT-KIZAITEN        TO      RECE44-KIZAITEN
           IF   RECE41-HKNKBN     =  "4" OR "6"
              IF  ACCT-SRYKBN     =  "70"
                  COMPUTE  RECE44-SYUTEN1   =  RECE44-SYUTEN1
                                            -  RECE44-SYUTEN2
                  COMPUTE  RECE44-KIZAITEN  =  RECE44-KIZAITEN
                                            +  RECE44-SYUTEN2
              END-IF
           END-IF
           MOVE    ACCT-DRCD            TO      RECE44-DRCD
           MOVE    ACCT-ZAIREQFLG       TO      RECE44-ZAIREQFLG
           MOVE    ACCT-TEIGENRATE      TO      RECE44-TEIGENRATE
      *
           IF      RECE41-HKNKBN   NOT  =   "3"
               MOVE        ZERO             TO      WK-TAIHI-DAY
               MOVE        ZERO             TO      WK-TAIHI-FLG
               PERFORM     VARYING   IDX3   FROM    1    BY   1
                           UNTIL     IDX3   >      10
                   PERFORM     VARYING   IDX2   FROM    1    BY   1
                               UNTIL     IDX2   >       31
                       MOVE    ACCT-DAY(IDX3 IDX2)  TO
                                            RECE44-KAISU (IDX3 IDX2)
                       IF    (WK-TAIHI-FLG               =  ZERO)
                       AND   (RECE44-KAISU(1 IDX2)   NOT =  ZERO)
                           MOVE     IDX2    TO      WK-TAIHI-DAY
                           MOVE     1       TO      WK-TAIHI-FLG
                       END-IF    
                   END-PERFORM
               END-PERFORM
           ELSE
               PERFORM     VARYING   IDX3   FROM    1    BY   1
                           UNTIL     IDX3   >      10
                  MOVE    ACCT-DAY(IDX3 WRK-DAY)  
                                       TO    RECE44-KAISU(IDX3 WRK-DAY)
              END-PERFORM                         
              MOVE    WRK-DAY          TO    WK-TAIHI-DAY
           END-IF
      *
           IF    FLG-RINYAK    NOT =    ZERO
                MOVE    FLG-RINYAK     TO    RECE44-SAFLG
           END-IF
      *
           MOVE    RECE41-RECESYUBETU  TO  RECE44-RECESYUBETU
      *
           .
       21011-RECE44-TENSOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成
      *****************************************************************
       21012-RECE45-HENSYU-SEC               SECTION.
      *
           IF    (RECE41-SRYYM            >=  "201604")
           AND   (ACCT-SRYKBN              =  "23"    )
           AND   (ACCT-JIHOKBN             =   SPACE  )
             PERFORM 210126-SIPPU-CHECK-SEC
           END-IF
      *
           INITIALIZE     WRK-ORCSGETGE-OUT-AREA
           MOVE    ZERO                 TO      FLG-IRYORENKEI
           IF    ((WRK-PARA-PRTKBN  =  "2" OR "3" OR "4" OR "5") AND
                  (SYS-200501-INSPECT-GENERAL-KBN  =   "1"     ) AND
                  (RECE41-SRYYM         >=   "201204"          ))
           OR    ( FLG-SIPPU-ARI         =     1                )
             PERFORM 210125-IRYORENKEI-HENSYU-SEC
           END-IF
           MOVE    ZERO                 TO      IDX17
      *
           MOVE    SPACE                TO      WRK-CHECK-SRYCD
      *
           INITIALIZE                           SRYACT-REC
           MOVE    ACCT-HOSPNUM         TO      SRY-HOSPNUM
           MOVE    ACCT-NYUGAIKBN       TO      SRY-NYUGAIKBN
           MOVE    ACCT-PTID            TO      SRY-PTID
           MOVE    ACCT-SRYKA           TO      SRY-SRYKA
           MOVE    ACCT-SRYYM           TO      SRY-SRYYM
           MOVE    ACCT-ZAINUM          TO      SRY-ZAINUM
           MOVE    SRYACT-REC           TO      MCPDATA-REC
           MOVE    "tbl_sryact"         TO      MCP-TABLE
           MOVE    "key2"               TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key2"           TO      MCP-PATHNAME
               PERFORM  800-SRYACT-READ-SEC
      *
               IF    WRK-CHECK-SRYCD  =  SPACE
                 MOVE   SRY-SRYCD(1)    TO      WRK-CHECK-SRYCD
               END-IF
      *
               PERFORM  UNTIL  FLG-SRYACT    =    1
                   MOVE   ZERO   TO  FLG-ZANHAIKI
                                     FLG-FORMAL-KISAI
                   MOVE   ZERO   TO  WRK-RENNUM
                                     WRK-RENNUM2
                   MOVE   ZERO   TO  FLG-WRITE45X
                   PERFORM   210121-RECE45-TENSOU-SEC
                   IF  ACCT-JIHOKBN  =  SPACE
                     PERFORM 210122-RECE41-HENSYU-SEC
                   END-IF
                   IF  FLG-WRITE45X  =  1
                      PERFORM  210123-RECE45-WRITE-SEC
                      MOVE  1    TO  FLG-WRITE45
                   END-IF
                   IF  FLG-ZANHAIKI  =  1
                      PERFORM  210124-RECE45-REWRITE-SEC
                   END-IF
                   IF  FLG-FORMAL-KISAI  =  1
                      PERFORM  210124-RECE45-REWRITE2-SEC
                   END-IF
                   MOVE     "tbl_sryact"   TO   MCP-TABLE
                   MOVE     "key2"         TO   MCP-PATHNAME
                   PERFORM   800-SRYACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryact"     TO      MCP-TABLE
           MOVE    "key2"           TO      MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       21012-RECE45-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送
      *****************************************************************
       210121-RECE45-TENSOU-SEC                SECTION.
      *
           INITIALIZE                   WRK-TNS-TAIHI-AREA
      *
           MOVE    SPACE                TO      RECE45-REC
           INITIALIZE                           RECE45-REC
           MOVE    RECE41-HOSPNUM       TO      RECE45-HOSPNUM
           MOVE    RECE41-SRYYM         TO      RECE45-SRYYM
           MOVE    RECE41-NYUGAIKBN     TO      RECE45-NYUGAIKBN
           MOVE    RECE41-PTID          TO      RECE45-PTID
           MOVE    RECE41-RECEKA        TO      RECE45-RECEKA
           MOVE    RECE41-HKNID         TO      RECE45-HKNID
           MOVE    RECE41-TEKSTYMD      TO      RECE45-TEKSTYMD
           MOVE    RECE41-PTNUM         TO      RECE45-PTNUM
           MOVE    SRY-ZAINUM           TO      RECE45-ZAINUM
           MOVE    SRY-RENNUM           TO      RECE45-RENNUM
           MOVE    SRY-SRYKA            TO      RECE45-SRYKA
           MOVE    SRY-SRYKBN           TO      RECE45-SRYKBN
           MOVE    SRY-SRYSYUKBN        TO      RECE45-SRYSYUKBN
                                                RECE44-SRYSYUKBN
           MOVE    SRY-JIHIMONEYTOTAL   TO      RECE45-JIHIMONEY
      * 
           MOVE    ZERO                 TO      FLG-OSINKBN
                                                IDX4
      *
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    OR
                                (SRY-SRYCD(IDX2)  =   SPACE)
      *
             ADD     1                  TO  IDX17
      *
      *      外来管理加算（読み替え加算）の未訂正分がある場合の特例措置
      *      （外来管理加算があれば、外来管理加算（読み替え加算）へ）
             IF      RECE41-YOBIETC(1)  =  1
               IF    SRY-SRYCD(IDX2)  =  "112011010"
                  MOVE   "101120020"    TO  SRY-SRYCD(IDX2)
                  COMPUTE   RECE44-SRYCDTOTAL  =  RECE44-SRYCDTOTAL
                                               -  112011010
                                               +  101120020
               END-IF
             END-IF
      *
             PERFORM    800-TENSU-TBL-SEC
      **     点数マスタ情報退避
             MOVE    TNS-CHUKSNTUBAN    TO  WRK-TNS-CHUKSNTUBAN(IDX2)
             MOVE    TNS-DATAKBN        TO  WRK-TNS-DATAKBN(IDX2)
             MOVE    TNS-TIMEKSNKBN     TO  WRK-TNS-TIMEKSNKBN(IDX2)
      *
             IF     (RECE41-HKNKBN        =  "4" OR "6"        )
             AND    (ACCT-SRYKBN          =  "80"              )
             AND    (SRY-SRYCD(IDX2)(1:5) =  "09591" OR "09592"
                                                     OR "09593")
               IF    SRY-SRYCD(IDX2)(1:5) =  "09593"
                 PERFORM   2101213-JIBAI-KIZAI-TENHEN-SEC
                 MOVE   WRK-TEN-KZI     TO  WRK-TNS-TEN(IDX2)
               ELSE
                 PERFORM   2101214-JIBAI-BUNSYO-TENHEN-SEC
                 MOVE   WRK-TEN-BUN     TO  WRK-TNS-TEN(IDX2)
               END-IF
             ELSE
               IF   (ACCT-SRYKBN          =  "80"              )
               AND  (SRY-SRYCD(IDX2)(1:5) =  "09591" OR "09592"
                                                     OR "09593")
                 IF  SRY-SRYSYUKBN = "809"
                   MOVE SRY-JIHIMONEY(IDX2)
                                        TO  WRK-TNS-TEN(IDX2)
                 ELSE
                   MOVE TNS-TEN         TO  WRK-TNS-TEN(IDX2)
                 END-IF
               ELSE
                 MOVE   TNS-TEN         TO  WRK-TNS-TEN(IDX2)
               END-IF
             END-IF
      *
             MOVE    TNS-GAITENTTLKBN   TO  WRK-TNS-GAITENTTLKBN(IDX2)
             MOVE    TNS-OSINKBN        TO  WRK-TNS-OSINKBN(IDX2)
             MOVE    TNS-KNSJISKBN      TO  WRK-TNS-KNSJISKBN(IDX2)
             MOVE    TNS-SRYCD          TO  WRK-TNS-SRYCD(IDX2)
      *
             IF     ( SRY-SRYCD(IDX2)(1:1)  =  "S"   )
                  COMPUTE   RECE44-MEISAISU  =  RECE44-MEISAISU
                                             -  1
             END-IF
      *
             IF       SRY-SRYCD(IDX2)  =  "099999909" OR "099999910" OR
                                          "099999921" OR "099999925" OR
                                          "099999929" OR "099999931"
                  MOVE    1     TO    FLG-HENSYU-NG
             END-IF
      *
             IF       SRY-SRYCD(IDX2)  =  "099999922"
               IF    (ACCT-JIHOKBN     =   SPACE)
               AND   (RECE41-HKNKBN    =   "6"  )
                  MOVE    1     TO    FLG-KIN-OKIKAE
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
             END-IF
      *
             IF       SRY-SRYCD(IDX2)  =  "099999923"
               IF    (ACCT-JIHOKBN          =  SPACE)
               AND   (RECE41-HKNKBN         =  "4"  )
               AND   (WRK-PARA-RECEKBN      =  "4"  )
               AND   (WRK-PARA-JIBAIPRTKBN  =  "2"  )
                  MOVE    1     TO    FLG-KIN-OKIKAE2
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
             END-IF
      *
             IF       SRY-SRYCD(IDX2)  =  "099999924"
               IF    (ACCT-JIHOKBN          =  SPACE       )
               AND   (RECE41-HKNKBN         =  "1"  OR  "2")
               AND   (RECE41-SYOKAIFLG      =  "1"         )
                  MOVE   SPACE  TO    RECE41-SYOKAIFLG
               END-IF
               MOVE       1     TO    FLG-HENSYU-NG
             END-IF
      *
             IF       SRY-SRYCD(IDX2)(1:5)  =
                      "09960" OR "09970" OR "09980" OR "09983"
                  MOVE    1     TO    FLG-HENSYU-NG
             END-IF
             IF       SRY-SRYCD(IDX2)  =  "099140004" OR
                                          "099400001" OR "099400002"
                  MOVE    1     TO    FLG-HENSYU-NG
             END-IF
             IF      (SRY-SRYCD(IDX2)  =  "099140011" OR "099140012")
             AND     (RECE41-SRYYM    >=  "201804"                  )
                  MOVE    1     TO    FLG-HENSYU-NG
             END-IF
      *
             IF     ACCT-SRYKBN      =  "98"
               IF  (SRY-RENNUM       =   1         )
               AND (IDX2             =   1         )
               AND (SRY-SRYCD(IDX2)  =  "830000052")
                  MOVE    1     TO    FLG-SIPPU-COM
               ELSE
                 IF  FLG-SIPPU-COM   =   1
                  CONTINUE
                 ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
                 END-IF
               END-IF
               IF  (SRY-RENNUM       =   1         )
               AND (IDX2             =   1         )
               AND (SRY-SRYCD(IDX2)  =  "830000052"
                                    OR  "099200201")
                 PERFORM  VARYING  IDX33  FROM  1  BY  1
                           UNTIL   IDX33   >   10
                   PERFORM  VARYING  IDX34  FROM  1  BY  1
                             UNTIL   IDX34   >   31
                     IF   ACCT-DAY(IDX33 IDX34)  NOT =  ZERO
                       MOVE    1    TO   RECE41-SIPPUCHKFLG
                       MOVE    1    TO   RECE41-SIPPUCHK(IDX33 IDX34)
                     END-IF
                   END-PERFORM
                 END-PERFORM
               END-IF
             END-IF
      *
             IF     ( SRY-SRYCD(IDX2)(1:7)  =  "0999901"    )
             OR     ((SRY-SRYCD(IDX2)(1:3)  =  "001") AND
                     (FLG-SIPPU-ARI         =  ZERO )       )
             OR     ((SRY-SRYCD(IDX2)(1:3)  =  "001") AND
                     (FLG-SIPPU-ARI         =   1   ) AND
                     (SYS-200501-COMPRESS-KBN
                                        NOT =  "1"  )       )
             OR     ((SRY-SRYCD(IDX2)(1:3)  =  "059") AND
                     (TNS-TEN               =  ZERO )       )
             OR     ( SRY-SRYCD(IDX2)(1:7)  =  "0992000"    )
             OR     ( SRY-SRYCD(IDX2)(1:4)  =  "0085"
                                            OR "0086"       )
             OR     ( FLG-KIN-OKIKAE    NOT =  ZERO         )
             OR     ( FLG-KIN-OKIKAE2   NOT =  ZERO         )
             OR     ( FLG-HENSYU-NG     NOT =  ZERO         )
             OR     ( SRY-SRYCD(IDX2)       =
                      "099209902" OR "099209903" OR
                      "099209904" OR "099209905" OR
                      "099209906" OR "099209907" OR
                      "099209908" OR
                      "099999903" OR "099999904" OR
                      "099999905" OR "099999906" OR
                      "099999907" OR "099999908" OR
                      "099200101" OR "099999926" OR
                      "099999927" OR "099999928" OR
                      "099208101" OR
                      "840000136" OR "840000140"            )
             OR     ( SRY-SRYCD(IDX2)       =  "099509901"  )
      *
                  PERFORM   2101219-MEISAISU-HENSYU-SEC
      *
             END-IF
      *
             IF      SRY-SRYCD(IDX2)(1:1)     =   "0" OR  "1" OR
                                                  "6" OR  "7" OR
                                                  "8"
      *
              IF     ( SRY-SRYCD(IDX2)(1:7)  =  "0999901"    )
              OR     ((SRY-SRYCD(IDX2)(1:3)  =  "001") AND
                      (FLG-SIPPU-ARI         =  ZERO )       )
              OR     ((SRY-SRYCD(IDX2)(1:3)  =  "001") AND
                      (FLG-SIPPU-ARI         =   1   ) AND
                      (SYS-200501-COMPRESS-KBN
                                         NOT =  "1"  )       )
              OR     ((SRY-SRYCD(IDX2)(1:3)  =  "059") AND
                      (TNS-TEN               =  ZERO )       )
              OR     ( SRY-SRYCD(IDX2)(1:7)  =  "0992000"    )
              OR     ( SRY-SRYCD(IDX2)(1:4)  =  "0085"
                                             OR "0086"       )
              OR     ( FLG-KIN-OKIKAE    NOT =  ZERO         )
              OR     ( FLG-KIN-OKIKAE2   NOT =  ZERO         )
              OR     ( FLG-HENSYU-NG     NOT =  ZERO         )
              OR     ( SRY-SRYCD(IDX2)       =
                       "099209902" OR "099209903" OR
                       "099209904" OR "099209905" OR
                       "099209906" OR "099209907" OR
                       "099209908" OR
                       "099999903" OR "099999904" OR
                       "099999905" OR "099999906" OR
                       "099999907" OR "099999908" OR
                       "099200101" OR "099999926" OR
                       "099999927" OR "099999928" OR
                       "099208101" OR
                       "840000136" OR "840000140"            )
              OR     ( SRY-SRYCD(IDX2)       =  "099509901"  )
      *
               IF   FLG-KIN-OKIKAE   NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM  =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM
                   IF  SRY-SRYCD(IDX2) = "099999922"
                     CONTINUE
                   ELSE
                     PERFORM   2101217-ICHIBUCOM-HENSYU-SEC
                   END-IF
                 END-IF
               END-IF
      *
               IF   FLG-KIN-OKIKAE2  NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM2 =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM2
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM2
                   IF  SRY-SRYCD(IDX2) = "099999923"
                     CONTINUE
                   ELSE
                     PERFORM   2101218-ICHIBUCOM-HENSYU2-SEC
                   END-IF
                 END-IF
               END-IF
      *
              ELSE
      *
               ADD     1                  TO    IDX4
               MOVE    SRY-SRYCD(IDX2)    TO    RECE45-SRYCD(IDX4)
      *
               IF    ((SRY-SRYCD(IDX2)    =     CONS-ROUSAI10) AND
                      (RECE41-SRYYM      <=     "201306"     ))
               OR    ((SRY-SRYCD(IDX2)    =     CONS-ROUSAI21) AND
                      (RECE41-SRYYM      >=     "201307"     ))
                        MOVE   "1"        TO    RECE41-KYUGYOFLG
                                                WRK-KYUGYOFLG
               END-IF
      *
               IF      SRY-SRYKBN         =     "12"
               AND     ACCT-JIHOKBN       =     SPACE
                   IF   SRY-SRYCD(IDX2)   =     CONS-KEIZOKU1    OR
                                                CONS-KEIZOKU2
                        MOVE   "1"      TO    RECE41-KEIZOKU-PRTKBN
                   END-IF
                   IF   SRY-SRYCD(IDX2)   =     CONS-GAIRAIRYO1  OR
                                                CONS-GAIRAIRYO2  OR
                                                CONS-GAIRAIRYO3  OR
                                                CONS-GAIRAIRYO4  OR
                                                CONS-GAIRAIRYO5  OR
                                                CONS-GAIRAIRYO6  OR
                                                CONS-GAIRAIRYO7  OR
                                                CONS-DOUJITU-GAI OR
                                                CONS-DOUJITU2-GAI OR
                                                CONS-DOUJITU3-GAI
                        MOVE   "2"      TO    RECE41-KEIZOKU-PRTKBN
                   END-IF
                   IF  (SRY-SRYCD(IDX2)   =     CONS-SAISHIN-A1)
                   AND (RECE41-SRYYM     <=     "201306"       )
                        MOVE   "1"      TO    RECE41-SAISHIN-PRTKBN2
                   END-IF
                   IF  (SRY-SRYCD(IDX2)   =     CONS-GAIRAI    )
                   AND (RECE41-SRYYM     <=     "201306"       )
                        MOVE   "1"      TO    RECE41-GAIRAIKSN-PRTKBN
                   END-IF
               END-IF
      *
               IF      SRY-SRYKBN         =     "13"
               AND     ACCT-JIHOKBN       =     SPACE
                   IF   SRY-SRYCD(IDX2)   =     CONS-SIDORYO1    OR
                                                CONS-SIDORYO2    OR
                                                CONS-SIDORYO3    OR
                                                CONS-SIDORYO4    OR
                                                CONS-SIDORYO5    OR
                                                CONS-SIDORYO6
                        MOVE   "1"        TO    RECE41-BEDSUFLG
                   END-IF
               END-IF
      *
               IF     SRY-SRYCD(IDX2)      =    CONS-GAIJINKEN
                  MOVE   "1"              TO    RECE41-KENTAIKASANFLG
                  MOVE   99               TO    RECE44-KNSJISGRPKBN
               END-IF
               IF     RECE44-KNSJISGRPKBN  =    ZERO
                 IF    TNS-KNSJISGRPKBN = 1 OR 2 OR 3 OR 4 OR 5 OR 6
                  MOVE  TNS-KNSJISGRPKBN  TO    RECE44-KNSJISGRPKBN
                 END-IF
               END-IF
      *
               IF    ( SRY-SRYKBN         =     "60" OR "64" )
               AND   ( TNS-KNSJISKBN      =      2           )
                  MOVE  TNS-KNSJISKBN     TO    RECE44-KNSJISKBN
               END-IF
      *
               IF    ( SRY-SRYKBN   =  "14" OR "21" OR "22" OR "23" )
               AND   ( RECE44-ZAITEN     =     ZERO                 )
               AND   ( RECE44-SAFLG      =     SPACE                )
               AND   ( ACCT-ZAIKBN   NOT =     1                    )
                  IF   SRY-SRYCD(IDX2)   =     "820000046"
                     MOVE     "1"         TO    RECE44-SAFLG
                  END-IF
               END-IF
      *
               IF      ACCT-JIHOKBN  NOT =     SPACE
                  IF     RECE44-SAFLG   NOT =  SPACE
                        MOVE    "3"       TO    RECE44-TOYAKUFLG
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   RECE44-TOYAKUFLG = SPACE
                          MOVE  "4"       TO    RECE44-TOYAKUFLG
                        END-IF
                    ELSE
                        MOVE    "3"       TO    RECE44-TOYAKUFLG
                    END-IF
                  END-IF
               END-IF
      *
               IF    ( SRY-SRYKBN   =  "21" OR "22" OR "23" )
               AND   ( RECE44-ZAITEN     =     ZERO         )
               AND   ( ACCT-ZAIKBN   NOT =     1            )
               AND   ( ACCT-JIHOKBN      =     SPACE        )
                IF   ACCT-SRYCDTOTAL(6:9) = CONS-YAKTEIGEN
                                         OR CONS-YAKTEIGEN2
                                         OR CONS-YAKTEIGEN3
                                         OR CONS-YAKTEIGEN4
                  CONTINUE
                ELSE
                  IF     RECE44-SAFLG   NOT =  SPACE
                        MOVE   SPACE      TO    RECE44-TOYAKUFLG
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   SRY-SRYSYUKBN  =  "212" OR "292" OR
                                               "222" OR "232" OR
                                               "295"
                          IF   RECE44-TOYAKUFLG = SPACE
                            MOVE   "2"    TO    RECE44-TOYAKUFLG
                          END-IF
                        END-IF
                    ELSE
                        MOVE    "1"       TO    RECE44-TOYAKUFLG
                        IF   (RECE45-SRYCD(IDX4)(1:1) = "6"   )
                        AND  (WRK-ORCSGETGE-GENERICNAME(IDX17)
                                                  NOT =  SPACE)
                          IF  (WRK-PARA-PRTKBN  =
                                           "2" OR "3" OR "4" OR "5")
                          AND (SYS-200501-INSPECT-GENERAL-KBN = "1")
                             MOVE  "1"  TO  RECE45-INGAIFLG-RECE(IDX4)
                          END-IF
                          IF   FLG-SIPPU-ARI    =  1
                             MOVE  "1"  TO  RECE45-INGAIFLG-SIPPU(IDX4)
                          END-IF
                          MOVE  WRK-ORCSGETGE-YAKKAKJNCD(IDX17)
                                          TO    RECE45-YAKKAKJNCD(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERIC-KBN(IDX17)
                                          TO    RECE45-GENERIC-KBN(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERICNAME(IDX17)
                                          TO    RECE45-GENERICNAME(IDX4)
                          PERFORM  VARYING  IDX15  FROM  200  BY  -1
                                    UNTIL   IDX15   <     1
                            IF  RECE45-GENERICNAME(IDX4)(IDX15:1)
                                                        NOT =   SPACE
                               COMPUTE RECE45-GENERICYUKOKETA(IDX4) =
                                       IDX15  /  2
                               MOVE    1   TO  IDX15
                            END-IF
                          END-PERFORM
                        END-IF
                    END-IF
                  END-IF
                END-IF
               END-IF
      *
               IF     FLG-SIPPU-ARI  =  1
      **********  １：院外分　２：院内分
                  IF   RECE44-ZAITEN  =   ZERO
                      MOVE  "1"         TO    RECE44-SIPPUFLG
                  ELSE
                      MOVE  "2"         TO    RECE44-SIPPUFLG
                  END-IF
                  IF  (SRY-SRYCD(IDX2)(1:1)  =  "6")
                  AND (TNS-MEIUSESKB         =   1 )
                      MOVE  "1"         TO    RECE45-SIPPUFLG(IDX4)
                  END-IF
                  IF   SRY-SRYCD(IDX2)(1:3)  =  "001"
                      MOVE  "810000001" TO    RECE45-SRYCD(IDX4)
                  END-IF
               END-IF
      *
               IF    ( SRY-SRYKBN        =     "14"  )
               AND   ( RECE44-ZAITEN     =     ZERO  )
               AND   ( ACCT-ZAIKBN   NOT =     1     )
               AND   ( ACCT-JIHOKBN      =     SPACE )
                  IF     RECE44-SAFLG   NOT =  SPACE
                        MOVE   SPACE      TO    RECE44-TOYAKUFLG
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   SRY-SRYSYUKBN  =  "148" OR "149"
                          IF   RECE44-TOYAKUFLG = SPACE
                            MOVE   "2"    TO    RECE44-TOYAKUFLG
                          END-IF
                        END-IF
                    ELSE
                        MOVE    "1"       TO    RECE44-TOYAKUFLG
                        IF   (RECE45-SRYCD(IDX4)(1:1) = "6"   )
                        AND  (WRK-ORCSGETGE-GENERICNAME(IDX17)
                                                  NOT =  SPACE)
                          MOVE    "1"  TO  RECE45-INGAIFLG-RECE(IDX4)
                          MOVE  WRK-ORCSGETGE-YAKKAKJNCD(IDX17)
                                          TO    RECE45-YAKKAKJNCD(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERIC-KBN(IDX17)
                                          TO    RECE45-GENERIC-KBN(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERICNAME(IDX17)
                                          TO    RECE45-GENERICNAME(IDX4)
                          PERFORM  VARYING  IDX15  FROM  200  BY  -1
                                    UNTIL   IDX15   <     1
                            IF  RECE45-GENERICNAME(IDX4)(IDX15:1)
                                                        NOT =   SPACE
                               COMPUTE RECE45-GENERICYUKOKETA(IDX4) =
                                       IDX15  /  2
                               MOVE    1   TO  IDX15
                            END-IF
                          END-PERFORM
                        END-IF
                    END-IF
                  END-IF
               END-IF
      *
               IF      SRY-SRYKBN   =   "99"
                  IF      SRY-SRYCD(IDX2)     =   "099140011"
                      MOVE     "1"        TO    RECE44-HOMONCOMFLG
                      MOVE  "810000001"   TO    RECE45-SRYCD(IDX4)
                  END-IF
                  IF      SRY-SRYCD(IDX2)     =   "099140012"
                      MOVE     "2"        TO    RECE44-HOMONCOMFLG
                      MOVE  "810000001"   TO    RECE45-SRYCD(IDX4)
                  END-IF
                  IF      RECE44-HOMONCOMFLG  =   "2"
                      MOVE     "1"        TO    RECE41-COMCNTFLG
                      MOVE     "1"        TO    RECE45-RECEDENFLG(IDX4)
                      MOVE     "1"        TO    RECE45-RECEPTFLG(IDX4)
                  END-IF
               END-IF
      *
               IF   (ACCT-SRYKBN = "40" OR "50" OR "54" OR "60" OR
                                   "64" OR "70" OR "80"           )
               AND  (ACCT-YKZTEN =  ZERO                          )
                 IF  ( SYS-200501-15-YKZ-PRTKBN  =  "0" )
                 OR  ((SYS-200501-15-YKZ-PRTKBN  =  "1") AND
                      (RECE41-SRYYM  <  "201204"       ))
                   IF    SRY-SRYCD(IDX2)(1:1)  =  "6"
                         MOVE   "1"    TO  RECE45-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE45-RECEPTFLG(IDX4)
                         MOVE    1     TO  FLG-YKZ-PRTKBN
                         PERFORM   2101219-MEISAISU-HENSYU-SEC
                   ELSE
                     IF  FLG-YKZ-PRTKBN  =  1
                       IF  ( ACCT-ZAITEN           =  ZERO  )
                       AND ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                            (SRY-SRYCD(IDX2)(1:3)  =  "008"))
                         MOVE   "1"    TO  RECE45-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE45-RECEPTFLG(IDX4)
                         PERFORM   2101219-MEISAISU-HENSYU-SEC
                       ELSE
                         MOVE   ZERO   TO  FLG-YKZ-PRTKBN
                       END-IF
                     END-IF
                   END-IF
                 ELSE
                   IF    SRY-SRYCD(IDX2)(1:1)  =  "6"
                         MOVE   "1"    TO  RECE44-YKZKISAIFLG
                   END-IF
                 END-IF
               END-IF
      *
               IF     SRY-SRYCD(IDX2)  IS  NUMERIC
               AND    FLG-YKZ-PRTKBN   =   ZERO
      *          IF  SRY-SRYCD(IDX2)(1:3) NOT = "001"
                   MOVE    SRY-SRYCD(IDX2)   TO  WRK-SRYCD
      *
                   MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                   PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                             UNTIL   FUKA-IDX   >    9
                     MOVE   SRY-SRYCD(IDX2)(FUKA-IDX:1)
                                             TO  WRK-FUKA-VALUE
                     IF  WRK-FUKA-VALUE  =  ZERO
                       CONTINUE
                     ELSE
                       COMPUTE  RECE44-RUIKEITOTAL  =
                                RECE44-RUIKEITOTAL  +
                              ( WRK-FUKA-VALUE    * WRK-SRYCD)
                       IF  (ACCT-SRYKBN          =  "80" )
                       AND (SRY-SRYCD(IDX2)(1:5) =
                            "09591" OR "09592" OR "09593")
                       AND (SRY-SRYSYUKBN        =  "809")
                        COMPUTE WRK-FUKA-KINGAKU  =
                                WRK-FUKA-KINGAKU  +
                              ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                                  * SRY-JIHIMONEY(IDX2))
                       ELSE
                        COMPUTE WRK-FUKA-KINGAKU  =
                                WRK-FUKA-KINGAKU  +
                              ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                                  * SRY-SRYSURYO(IDX2))
                       END-IF
                     END-IF
                   END-PERFORM
                   COMPUTE  RECE44-RUIKEITOTAL  =
                            RECE44-RUIKEITOTAL  +
                            WRK-FUKA-KINGAKU
      *
                   MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                   PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                             UNTIL   FUKA-IDX   >   10
                     MOVE   SRY-SRYSURYO(IDX2)(FUKA-IDX:1)
                                             TO  WRK-FUKA-VALUE
                     IF  WRK-FUKA-VALUE  =  ZERO
                       CONTINUE
                     ELSE
                       COMPUTE  WRK-FUKA-KINGAKU  =
                                WRK-FUKA-KINGAKU  +
                              ((WRK-FUKA-VALUE^4) * FUKA-IDX)
                     END-IF
                   END-PERFORM
                   COMPUTE  RECE44-RUIKEITOTAL  =
                            RECE44-RUIKEITOTAL  +
                            WRK-FUKA-KINGAKU
      *          END-IF
               END-IF
      *
               MOVE    SRY-SRYSURYO(IDX2) TO    RECE45-SRYSURYO(IDX4)
               MOVE    SRY-SRYKAISU(IDX2) TO    RECE45-SRYKAISU(IDX4)
               MOVE    SRY-MEISKYFLG(IDX2) TO   RECE45-MEISKYFLG(IDX4)
               MOVE    SRY-AUTOKBN(IDX2)  TO    RECE45-AUTOKBN(IDX4)
               MOVE    SRY-INPUTNUM(IDX2) TO    RECE45-INPUTNUM(IDX4)
      **
               IF   RECE41-HKNKBN    NOT  =  "4" AND "6"
                  IF ((SRY-SRYCD(IDX2)  =  CONS-ROUSAI8    ) AND
                      (RECE41-SRYYM     <  "200804"        ))
                  OR ((SRY-SRYCD(IDX2)  =
                       CONS-ROUSAI3  OR CONS-ROUSAI4  OR
                       CONS-ROUSAI9  OR CONS-ROUSAI10 OR
                       CONS-ROUSAI11 OR CONS-ROUSAI12 OR
                       CONS-ROUSAI13 OR CONS-ROUSAI14 OR
                       CONS-ROUSAI15 OR CONS-ROUSAI16 OR
                       CONS-ROUSAI17                       ) AND
                      (RECE41-SRYYM    <=  "201306"        ))
                  OR ((SRY-SRYCD(IDX2)  =
                       CONS-ROUSAI32 OR CONS-ROUSAI33 OR
                       CONS-ROUSAI20 OR CONS-ROUSAI21 OR
                       CONS-ROUSAI22 OR CONS-ROUSAI23 OR
                       CONS-ROUSAI24 OR CONS-ROUSAI25 OR
                       CONS-ROUSAI26 OR CONS-ROUSAI27 OR
                       CONS-ROUSAI28 OR CONS-ROUSAI29 OR
                       CONS-ROUSAI30 OR CONS-ROUSAI31 OR
                       CONS-ROUSAI39                       ) AND
                      (RECE41-SRYYM    >=  "201307"        ))
                    IF   ((SRY-SRYCD(IDX2)  =   CONS-ROUSAI4 ) AND
                          (RECE41-SRYYM    <=   "201306"     ))
                    OR   ((SRY-SRYCD(IDX2)  =   CONS-ROUSAI33) AND
                          (RECE41-SRYYM    >=   "201307"     ))
                          MOVE   "13"        TO    RECE44-SRYKBN
                                                   RECE45-SRYKBN
                    ELSE
                          MOVE   "80"        TO    RECE44-SRYKBN
                                                   RECE45-SRYKBN
                    END-IF
                  ELSE
                    IF      TNS-SRYKBN         =     "80"
                    OR      RECE44-SRYKBN      =     "80"
                      IF  TNS-GAITENTTLKBN   =     130
                          MOVE   "13"        TO    RECE44-SRYKBN
                                                   RECE45-SRYKBN
                      END-IF
                    END-IF
                  END-IF
               ELSE                                                     
                  IF      SRY-SRYCD(IDX2)    =     CONS-YOUBUKASAN
                   IF   RECE41-KOTEIKBN  =  SPACE  OR  "2"
                    COMPUTE  WRK-YOUBUKASAN   =  WRK-YOUBUKASAN
                                              +  TNS-TEN
                    COMPUTE  RECE44-SYUTEN1   =  RECE44-SYUTEN1
                                              -  TNS-TEN
                    COMPUTE  RECE44-KIZAITEN  =  RECE44-KIZAITEN
                                              +  TNS-TEN
                   END-IF
                  END-IF
                  IF      SRY-SRYCD(IDX2)    =     CONS-KYOBUKASAN
                   IF   RECE41-KOTEIKBN  =  SPACE  OR  "2"
                    COMPUTE  WRK-KYOBUKASAN   =  WRK-KYOBUKASAN
                                              +  TNS-TEN
                    COMPUTE  RECE44-SYUTEN1   =  RECE44-SYUTEN1
                                              -  TNS-TEN
                    COMPUTE  RECE44-KIZAITEN  =  RECE44-KIZAITEN
                                              +  TNS-TEN
                   END-IF
                  END-IF
                  IF      SRY-SRYCD(IDX2)    =     CONS-KEIBUKASAN
                   IF   RECE41-KOTEIKBN  =  SPACE  OR  "2"
                    COMPUTE  WRK-KEIBUKASAN   =  WRK-KEIBUKASAN
                                              +  TNS-TEN
                    COMPUTE  RECE44-SYUTEN1   =  RECE44-SYUTEN1
                                              -  TNS-TEN
                    COMPUTE  RECE44-KIZAITEN  =  RECE44-KIZAITEN
                                              +  TNS-TEN
                   END-IF
                  END-IF
                  IF      SRY-SRYCD(IDX2)    =     CONS-SOGAIKASAN
                   IF   RECE41-KOTEIKBN  =  SPACE  OR  "2"
                    COMPUTE  WRK-SOGAIKASAN   =  WRK-SOGAIKASAN
                                              +  TNS-TEN
                    COMPUTE  RECE44-SYUTEN1   =  RECE44-SYUTEN1
                                              -  TNS-TEN
                    COMPUTE  RECE44-KIZAITEN  =  RECE44-KIZAITEN
                                              +  TNS-TEN
                   END-IF
                  END-IF
      *           自賠責・療養担当手当用特例処理
      *           （自賠責の場合、７点を８４円に読み替える）
      *           （療養担当手当：１月１回の算定）
                  IF      SRY-SRYCD(IDX2)    =     CONS-RYOYOTEATE
                    IF   (RECE41-HKNKBN    =  "4")
                    AND  (RECE41-JIBAIKBN  =  "1")
                        MOVE     84     TO     WRK-RYOYOTEATE2
                        COMPUTE  WRK-RYOYOTEATE   =
                                 WRK-RYOYOTEATE   +
                                 WRK-RYOYOTEATE2
                    ELSE
                        COMPUTE  WRK-RYOYOTEATE   =  WRK-RYOYOTEATE
                                                  +  TNS-TEN
                        COMPUTE  RECE44-SYUTEN1   =  RECE44-SYUTEN1
                                                  -  TNS-TEN
                        COMPUTE  RECE44-KIZAITEN  =  RECE44-KIZAITEN
                                                  +  TNS-TEN
                    END-IF
                  END-IF
      *
                  IF ( ACCT-SRYKBN          =  "80"               ) AND
                     ( SRY-SRYCD(IDX2)(1:5) =  "09591" OR "09592" )
      ***            EVALUATE  SRY-SRYCD(IDX2)(1:5)
      ***             WHEN      "09591"
      ***               IF  RECE41-SINDAN-TUU < 2
      ***                 MOVE   "95"   TO    RECE44-SRYKBN
      ***                                     RECE45-SRYKBN
      ***               END-IF
      ***             WHEN      "09592"
      ***               IF  RECE41-MEISAI-TUU < 2
      ***                 MOVE   "95"   TO    RECE44-SRYKBN
      ***                                     RECE45-SRYKBN
      ***               END-IF
      ***            END-EVALUATE
                     MOVE    1          TO    FLG-SRYKBN-HEN
                  ELSE
                   IF ( SRY-SRYCD(IDX2)(1:5) = "09593"       )
                   OR ((SRY-SRYCD(IDX2)  =  CONS-ROUSAI8    ) AND
                       (RECE41-SRYYM     <  "200804"        ))
                   OR ((RECE41-HKNKBN    =  "4"             ) AND
                       (RECE41-JIBAIKBN  =  "1"             ) AND
                       (SRY-SRYCD(IDX2)  =  CONS-RYOYOTEATE ))
                   OR ((SRY-SRYCD(IDX2)  =
                        CONS-ROUSAI3  OR CONS-ROUSAI4  OR
                        CONS-ROUSAI9  OR CONS-ROUSAI10 OR
                        CONS-ROUSAI11 OR CONS-ROUSAI12 OR
                        CONS-ROUSAI13 OR CONS-ROUSAI14 OR
                        CONS-ROUSAI15 OR CONS-ROUSAI16 OR
                        CONS-ROUSAI17                       ) AND
                       (RECE41-SRYYM    <=  "201306"        ))
                   OR ((SRY-SRYCD(IDX2)  =
                        CONS-ROUSAI32 OR CONS-ROUSAI33 OR
                        CONS-ROUSAI20 OR CONS-ROUSAI21 OR
                        CONS-ROUSAI22 OR CONS-ROUSAI23 OR
                        CONS-ROUSAI24 OR CONS-ROUSAI25 OR
                        CONS-ROUSAI26 OR CONS-ROUSAI27 OR
                        CONS-ROUSAI28 OR CONS-ROUSAI29 OR
                        CONS-ROUSAI30 OR CONS-ROUSAI31 OR
                        CONS-ROUSAI39                       ) AND
                       (RECE41-SRYYM    >=  "201307"        ))
                   OR ((SRY-SRYCD(IDX2)  >= "101801010" AND
                                         <= "101801020"     ) AND
                       (RECE41-SRYYM    >=  "201307"        ))
                   OR ((SRY-SRYCD(IDX2)   = "101801030"     ) AND
                       (RECE41-SRYYM    >=  "201307"        ))
                     IF  SRY-SRYCD(IDX2)(1:5) = "09593"
                       MOVE  TNS-NAMECHGKBN
                                      TO  WRK-TNS-JIBAISYUKEIKBN(IDX2)
                                          RECE44-JIBAISYUKEIKBN
                       EVALUATE  TNS-NAMECHGKBN
                         WHEN      0
                         WHEN      4
                         WHEN      5
                            MOVE   "80"   TO    RECE44-SRYKBN
                                                RECE45-SRYKBN
                         WHEN      1
                            MOVE   "11"   TO    RECE44-SRYKBN
                                                RECE45-SRYKBN
                         WHEN      2
                            MOVE   "12"   TO    RECE44-SRYKBN
                                                RECE45-SRYKBN
                         WHEN      3
                            MOVE   "13"   TO    RECE44-SRYKBN
                                                RECE45-SRYKBN
                       END-EVALUATE
                     ELSE
                       IF   ((SRY-SRYCD(IDX2)  =   CONS-ROUSAI4 ) AND
                             (RECE41-SRYYM    <=   "201306"     ))
                       OR   ((SRY-SRYCD(IDX2)  =   CONS-ROUSAI33) AND
                             (RECE41-SRYYM    >=   "201307"     ))
                            MOVE   "13"   TO    RECE44-SRYKBN
                                                RECE45-SRYKBN
                       ELSE
                            MOVE   "80"   TO    RECE44-SRYKBN
                                                RECE45-SRYKBN
                       END-IF
                     END-IF
                     MOVE    1          TO    FLG-SRYKBN-HEN
                   ELSE                                                 
                     IF      TNS-SRYKBN         =   "80"
                     OR      RECE44-SRYKBN      =   "80"
                         IF  TNS-GAITENTTLKBN   =   130
                             MOVE   "13"    TO  RECE44-SRYKBN
                                                RECE45-SRYKBN
                         END-IF
                     END-IF
                     IF  (WRK-PARA-JIBAIPRTKBN =  "0" )
                     AND (FLG-SRYKBN-HEN       =  ZERO)
                      IF (( RECE44-SRYKBN     =  "80" ) AND
                          ( RECE44-OKIKAEFLG  =  SPACE))
                      OR (  RECE44-OKIKAEFLG  =  "1"   )
                       IF   SRY-SRYCD(IDX2)   =     CONS-SHOHOSEN1 OR   
                                                    CONS-SHOHOSEN2 OR   
                                                    CONS-SHOHOSEN3 OR   
                                                    CONS-SHOHOSEN4 OR   
                                                    CONS-SHOHOSEN5 OR
                                                    CONS-SHOHOKSN1 OR   
                                                    CONS-SHOHOKSN2 OR   
                                                    CONS-SHOHOKSN3 OR
                                                    CONS-SHOHOKSN4 OR
                                                    CONS-SHOHOKSN5 OR
                                                    CONS-SHOHOKSN6 OR
                                                    CONS-SHOHOKSN7 OR
                                                    CONS-SHOHOKSN8 OR
                                                    CONS-RYOYOTEATE
                              CONTINUE                                  
                       ELSE                                             
                              MOVE   "1"    TO  RECE44-OKIKAEFLG
                              MOVE   "40"   TO  RECE44-SRYKBN
                                                RECE45-SRYKBN
                       END-IF                                           
                      END-IF
                     END-IF
                   END-IF                                               
                  END-IF                                                
      *
               END-IF                                                   
      *
               IF      FLG-SIPPU-COM      =     1
                       MOVE   "1"         TO    RECE44-SIPPUCOMFLG
                       MOVE   "80"        TO    RECE44-SRYKBN
                                                RECE45-SRYKBN
                       MOVE   "800"       TO    RECE44-SRYSYUKBN
                                                RECE45-SRYSYUKBN
               END-IF
      *
               IF      ACCT-JIHOKBN       =     SPACE
                  PERFORM  2101211-RECE45-COMCNT-HEN-SEC
               ELSE
                  IF   RECE44-SRYKBN      =     "50"
                     MOVE   "1"   TO    RECE44-FLG-SHUJUTU-COMMENT
                  END-IF
                  IF   RECE44-SRYKBN      =     "54"
                     MOVE   "1"   TO    RECE44-FLG-MASUI-COMMENT
                  END-IF
               END-IF
      *
               IF  SRY-SRYCD(IDX2)        =     CONS-ZANHAIKI           
                IF   ACCT-ZAIKBN  =  1
                  MOVE    "1"             TO  RECE45-RECEDENFLG(IDX4)
                  MOVE    "1"             TO  RECE45-RECEPTFLG(IDX4)
                  MOVE    ZERO            TO  RECE45-SRYSURYO(IDX4)
                ELSE
                  COMPUTE WRK-SRYSURYO2   =     WRK-SRYSURYO            
                                          +     0.99999                   
                  COMPUTE RECE45-SRYSURYO(IDX4)                         
                                          =     WRK-SRYSURYO2           
                                          -     WRK-SRYSURYO            
                  IF  RECE45-SRYSURYO(IDX4)  NOT = ZERO                 
                    MOVE  WRK-TANICD      TO    RECE45-TANICD(IDX4)     
                    MOVE  WRK-TANIMOJISU  TO    RECE45-TANIMOJISU(IDX4) 
                    MOVE  WRK-TANINAME    TO    RECE45-TANINAME(IDX4)   
                    IF    RECE45-RENNUM  >  1                           
                    AND   IDX4           =  1                           
                      MOVE    1           TO    FLG-ZANHAIKI            
                      COMPUTE  WRK-RENNUM  =  RECE45-RENNUM  -  1       
                      MOVE WRK-SRYSURYO2  TO  WRK-SRYSURYO3             
                    ELSE                                                
                      MOVE WRK-SRYSURYO2  TO  RECE45-SRYSURYO(IDX4 - 1) 
                    END-IF
                  ELSE
                    MOVE  "1"             TO  RECE45-RECEDENFLG(IDX4)
                    MOVE  "1"             TO  RECE45-RECEPTFLG(IDX4)
                  END-IF                                                
                END-IF
               ELSE                                                     
                  IF      TNS-TANIMOJISU    =   ZERO
                  AND     TNS-TANINAME  NOT =   SPACE
                     PERFORM   VARYING   IDW   FROM   24   BY  -1
                                UNTIL    IDW    <      1
                        IF   TNS-TANINAME(IDW:1)  NOT =   SPACE
                            COMPUTE  TNS-TANIMOJISU   =   IDW   /   2
                            MOVE    1     TO    IDW
                        END-IF
                     END-PERFORM
                  END-IF
                  MOVE    SRY-SRYSURYO(IDX2)                            
                                          TO    WRK-SRYSURYO            
                  IF   TNS-TANICD  NOT = SPACE AND "000"
                    MOVE  TNS-TANICD      TO    RECE45-TANICD(IDX4)
                                                WRK-TANICD
                  END-IF
                  MOVE    TNS-TANIMOJISU  TO    RECE45-TANIMOJISU(IDX4)
                                                WRK-TANIMOJISU          
                  MOVE    TNS-TANINAME    TO    RECE45-TANINAME(IDX4)
                                                WRK-TANINAME            
               END-IF                                                   
               IF ( ACCT-SRYKBN          =  "80"              ) AND     
                  ( SRY-SRYCD(IDX2)(1:5) =  "09591" OR "09592"
                                                    OR "09593")         
                    MOVE  1               TO  RECE45-TENSIKIBETU(IDX4)  
      ***>          MOVE  TNS-TEN         TO  RECE45-TEN(IDX4)          
                    MOVE  WRK-TNS-TEN(IDX2)  TO  RECE45-TEN(IDX4)
               ELSE                                                     
                 IF   RECE41-HKNKBN     =  "4"
                 AND  RECE41-JIBAIKBN   =  "1"
                 AND  SRY-SRYCD(IDX2)   =  CONS-RYOYOTEATE
                    MOVE  1               TO  RECE45-TENSIKIBETU(IDX4)  
                    MOVE  WRK-RYOYOTEATE2 TO  RECE45-TEN(IDX4)
                 ELSE
                    MOVE  TNS-TENSIKIBETU TO  RECE45-TENSIKIBETU(IDX4)
                    MOVE  TNS-TEN         TO  RECE45-TEN(IDX4)
                 END-IF
               END-IF                                                   
               IF      RECE41-NYUGAIKBN   =     "1"
                   MOVE  TNS-NYUTENTTLKBN TO    RECE45-TENTTLKBN(IDX4)
               ELSE
                   MOVE  TNS-GAITENTTLKBN TO    RECE45-TENTTLKBN(IDX4)
               END-IF
               IF     (SRY-SRYCD    (IDX2)(1:1)     =   "8"  )
               OR     (SRY-SRYCD    (IDX2)(1:3)     =   "008")
                  MOVE ZERO               TO    RECE45-YUKOKETA(IDX4)
               ELSE
                  MOVE TNS-YUKOKETA       TO    RECE45-YUKOKETA(IDX4)
               END-IF
               MOVE    TNS-DATAKBN        TO    RECE45-DATAKBN (IDX4)
               MOVE    TNS-HOUKNSKBN      TO    RECE45-HOUKNSKBN(IDX4)
               MOVE    TNS-KNSJISKBN      TO    RECE45-KNSJISKBN(IDX4)
               MOVE    TNS-CDKBN-KBN      TO    RECE45-CDKBN-KBN(IDX4)
               MOVE    TNS-CDKBN-SYO      TO    RECE45-CDKBN-SYO(IDX4)
               MOVE    TNS-CDKBN-BU       TO    RECE45-CDKBN-BU(IDX4)
               MOVE    TNS-CDKBN-KBNNUM   
                                      TO RECE45-CDKBN-KBNNUM(IDX4)
               MOVE    TNS-CDKBN-KBNNUM-EDA
                                      TO RECE45-CDKBN-KBNNUM-EDA(IDX4)
               MOVE    TNS-CDKBN-KOUBAN
                                      TO RECE45-CDKBN-KOUBAN(IDX4)
               MOVE    TNS-KOUHYOJYUNNUM  
                                      TO RECE45-KOUHYOJYUNNUM(IDX4)
               MOVE    TNS-SRYSYUKBN  TO RECE45-SRYSYUKBN-X  (IDX4)
               MOVE    TNS-KZMCOMPSIKIBETU
                                      TO RECE45-KZMCOMPSIKIBETU(IDX4)
               MOVE    TNS-KNSJISGRPKBN
                                      TO RECE45-KNSJISGRPKBN   (IDX4)
               MOVE    TNS-KENTAICOMMENT
                                      TO RECE45-KENTAICOMMENT  (IDX4)
               MOVE    TNS-KOKUJISKBKBN1
                                      TO RECE45-KOKUJISKBKBN1  (IDX4)
               MOVE    TNS-KOKUJISKBKBN2
                                      TO RECE45-KOKUJISKBKBN2  (IDX4)
               MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE45-TUSOKUGAIKBN   (IDX4)
               MOVE    TNS-TIMEKSNKBN TO RECE45-TIMEKSNKBN     (IDX4)
               MOVE    TNS-CHUKSNCD   TO RECE45-CHUKSNCD       (IDX4)
               MOVE    TNS-CHUKSNTUBAN
                                      TO RECE45-CHUKSNTUBAN    (IDX4)
               MOVE    TNS-TOKUKIZAISBT1
                                      TO RECE45-TOKUKIZAISBT1  (IDX4)
               MOVE    TNS-SANSOKBN   TO RECE45-SANSOKBN       (IDX4)
               IF      TNS-SRYCD (1:2)   =   "84"
                   PERFORM VARYING IDYY    FROM    1   BY  1
                           UNTIL   IDYY    >       10
                       MOVE    TNS-SSTKIJUNCD (IDYY)
                                      TO RECE45-SSTKIJUNCD(IDX4 IDYY)
                   END-PERFORM
               END-IF
      *
               IF    (TNS-SRYCD       =  "170022290"  OR
                                         "170022390"  OR
                                         "170022490")
               AND   (RECE41-SRYYM   <=  "201003"   )
                      MOVE   202      TO  RECE45-CDKBN-KBNNUM(IDX4)
                      MOVE   99       TO  RECE45-CDKBN-KOUBAN(IDX4)
               END-IF
               IF     TNS-SRYCD       =  "170016010"  OR
                                         "170020270"  OR  "170024470" OR
                                         "170024910"  OR  "170025010" OR
                                         "170025210"  OR  "170025310" OR
                                         "170025410"  OR  "170025510" OR
                                         "170025610"  OR  "170025710" OR
                                         "170025810"  OR  "170025910" OR
                                         "170026010"  OR  "170026110" OR
                                         "170026210"  OR  "170026310" OR
                                         "170026810"  OR
                                         "170000210"  OR  "170016910" OR
                                         "170017010"  OR  "170026710" OR
                                         "170028810"  OR
                                         "170035710"  OR  "170035810" OR
                                         "170035910"  OR  "170036010"
                      MOVE   203      TO  RECE45-CDKBN-KBNNUM(IDX4)
                      MOVE   99       TO  RECE45-CDKBN-KOUBAN(IDX4)
               END-IF
      *
               MOVE   TNS-SRYKBN      TO  RECE45-TNSSRYKBN(IDX4)
      *
               IF    (TNS-SRYCD       =  "170022290")
               AND   (RECE41-SRYYM   >=  "201004"   )
                      MOVE   "1"      TO  RECE44-GAZOGEN
               END-IF
      *
               IF   (((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                      (SRY-SRYCD    (IDX2)(1:3)     =   "008")) AND
                     ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  ))
               OR   (( FLG-SIPPU-ARI                =    1    ) AND
                     ( SRY-SRYCD    (IDX2)(1:3)     =   "001" ) AND
                     ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  ))
                   MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
                   MOVE    SRY-PTID             TO  PTCOM-PTID
                   MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
                   MOVE    SRY-SRYCD (IDX2)     TO  PTCOM-SRYCD
                   MOVE    SRY-INPUTNUM(IDX2)   TO  PTCOM-RENNUM
                   PERFORM 800-PTCOM-READ-SEC
                   MOVE    PTCOM-INPUTCOMENT
                                           TO  RECE45-NAME(IDX4)
                                               RECE45-INPUTCOMENT(IDX4)
      *
                   IF      SRY-SRYCD (IDX2)(1:1)   =   "8"
                       IF    ( PTCOM-INPUTCHI1     =   SPACE  )
                       OR    ( SRY-SRYCD (IDX2)(1:2)
                                               NOT =   "84"   )
                           INITIALIZE                  ORCSKANACHKAREA
                           MOVE    "2"             TO  KANACHK-SYORI 
                           MOVE    TNS-NAME        TO  KANACHK-MAE-INPUT
                           CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                           IF    ( KANACHK-RC      =   ZERO )
                           AND   ( KANACHK-MAX     >   ZERO )
                               COMPUTE IDXX    =   KANACHK-MAX +   1
                               MOVE    PTCOM-INPUTCOMENT (IDXX:)
                                                       TO
                                           RECE45-INPUTCOMENT   (IDX4)
                           ELSE
                               MOVE    PTCOM-INPUTCOMENT
                                                       TO
                                           RECE45-INPUTCOMENT   (IDX4)
                           END-IF
                       ELSE
                           INITIALIZE              ORCSKANACHKAREA
                           MOVE    "2"             TO  KANACHK-SYORI 
                           STRING  PTCOM-INPUTCHI1 DELIMITED  BY  SPACE
                                   PTCOM-INPUTCHI2 DELIMITED  BY  SPACE
                                   PTCOM-INPUTCHI3 DELIMITED  BY  SPACE
                                   PTCOM-INPUTCHI4 DELIMITED  BY  SPACE
                                   INTO   KANACHK-MAE-INPUT
                           END-STRING
                           CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                           IF      KANACHK-RC      =   ZERO
                               MOVE    KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                                   TO
                                           RECE45-INPUTCOMENT   (IDX4)
                           END-IF
                       END-IF
                   END-IF
      *
      ***          IF    RECE44-COMCDFLG   NOT =   "3"
      ***             MOVE   "1"           TO    RECE44-COMCDFLG
      ***          END-IF
      *
                   IF      WRK-KYUGYOFLG   =   "1"
                   AND     SRY-SRYCD(IDX2) = CONS-ROUCOM1
                        MOVE   PTCOM-INPUTCHI1(1:2)
                                            TO  RECE41-KYUGYO-STR(1:2)
                        MOVE   PTCOM-INPUTCHI2(1:2)
                                            TO  RECE41-KYUGYO-STR(3:2)
                        MOVE   PTCOM-INPUTCHI3(1:2)
                                            TO  RECE41-KYUGYO-END(1:2)
                        MOVE   PTCOM-INPUTCHI4(1:2)
                                            TO  RECE41-KYUGYO-END(3:2)
                        MOVE   SPACE        TO  WRK-KYUGYOFLG
                   END-IF
      *
               ELSE
                   MOVE    TNS-NAME        TO  RECE45-NAME(IDX4)
                                               RECE45-INPUTCOMENT(IDX4)
               END-IF
      *
               IF  SRY-SRYCD(IDX2)        =     CONS-ZANHAIKI
                  IF  RECE45-SRYSURYO(IDX4)  NOT = ZERO
                    PERFORM  2101215-RECE45-SURYO-HEN-SEC
      *
                    MOVE    SPACE      TO  RECE45-NAME(IDX4)
                    MOVE    SPACE      TO  RECE45-INPUTCOMENT(IDX4)
      ***           STRING  TNS-NAME          DELIMITED  BY  " "
      ***                   "　"              DELIMITED  BY  SIZE
      ***                   WRK-SRYSURYOW     DELIMITED  BY  " "
      ***                   RECE45-TANINAME(IDX4)
      ***                                     DELIMITED  BY  " "
      ***                   INTO              RECE45-NAME(IDX4)
      ***           END-STRING
                    STRING  "（使用量　"      DELIMITED  BY  SIZE
                            WRK-SRYSURYOW     DELIMITED  BY  " "
                            RECE45-TANINAME(IDX4)
                                              DELIMITED  BY  " "
                            "　残量廃棄）"    DELIMITED  BY  SIZE
                            INTO              RECE45-NAME(IDX4)
                    END-STRING
                    MOVE  RECE45-NAME(IDX4)
                                       TO  RECE45-INPUTCOMENT(IDX4)
      *
      ***           MOVE  "810000001"  TO  RECE45-SRYCD(IDX4)
                    MOVE  ZERO         TO  RECE45-SRYSURYO(IDX4)
                    MOVE  ZERO         TO  RECE45-TANICD(IDX4)
                    MOVE  ZERO         TO  RECE45-TANIMOJISU(IDX4)
                    MOVE  SPACE        TO  RECE45-TANINAME(IDX4)
                    MOVE  ZERO         TO  RECE45-YUKOKETA(IDX4)
                    MOVE  "2"          TO  RECE45-MEISKYFLG(IDX4)
                  END-IF
               END-IF
      *
               IF          SRY-SRYKBN       =  "21" OR "22" OR "23"
                    IF    SRY-SRYCD(IDX2)  =  CONS-YAKTEIGEN
                                           OR CONS-YAKTEIGEN2
                                           OR CONS-YAKTEIGEN3
                                           OR CONS-YAKTEIGEN4
                                           OR CONS-GEN
                                           OR CONS-GEN2
                        MOVE     "3"       TO    RECE44-COMCDFLG
                    END-IF
               END-IF
               IF   ( SRY-SRYCD(IDX2)(1:1)  =   "8"   )
               OR   ( SRY-SRYCD(IDX2)(1:3)  =   "008" )
               OR   ((FLG-SIPPU-ARI         =    1   ) AND
                     (SRY-SRYCD(IDX2)(1:3)  =   "001"))
                    IF    RECE44-COMCDFLG   NOT =   "3"
                        MOVE     "1"       TO    RECE44-COMCDFLG
                    END-IF
               END-IF
      *
      ***      IF    RECE44-COMCDFLG       =   "3"
      ***        IF    SRY-SRYCD(IDX2)  =  CONS-YAKTEIGEN
      ***                               OR CONS-YAKTEIGEN2
      ***                               OR CONS-YAKTEIGEN3
      ***                               OR CONS-YAKTEIGEN4
      ***                               OR CONS-GEN
      ***                               OR CONS-GEN2
      ***          CONTINUE
      ***        ELSE
      ***          ADD   999               TO  WRK-SURYOU-COUNT
      ***          ADD   WRK-SURYOU-COUNT  TO  RECE44-SURYOUTOTAL
      ***        END-IF
      ***      END-IF
      *
               IF   (SRY-SRYKBN       =  "31" OR "32")
               AND  (ACCT-JIHOKBN     =  SPACE       )
                IF  (RECE41-HKNKBN         =  "4")
                AND (WRK-PARA-RECEKBN      =  "4")
                AND (WRK-PARA-JIBAIPRTKBN  =  "2")
                 CONTINUE
                ELSE
                 IF        SRY-SRYCD(IDX2)  =    CONS-HIKAKIN
      ***                                  OR    CONS-SEIBUTU
      ***                                  OR    CONS-MAYAKU
                                           OR    CONS-JYOMYAKU
      ***                                  OR    CONS-JYOMYAKUKASAN
                   MOVE    SPACE           TO    RECE45-NAME(IDX4)
                 END-IF
                END-IF
               END-IF
               IF  ( SRY-SRYSYUKBN         =  "334"       )
               AND ((SRY-SRYCD(IDX2)       =  "810000001") OR
                    (SRY-SRYCD(IDX2)(1:3)  =  "008"      ))
               AND ( FLG-HOUTEN-COM        =   ZERO       )
                    PERFORM  VARYING  IDV  FROM  1  BY  2
                            UNTIL  (IDV            >   200 )
                             OR    (FLG-HOUTEN-COM =     1 )
                      IF   RECE45-NAME(IDX4)(IDV:2)   =   "訪"
                         MOVE   SPACE  TO    RECE44-FLG-HOUTEN-COMMENT
                         MOVE    1     TO    FLG-HOUTEN-COM
                      END-IF
                    END-PERFORM
               END-IF
      *
               IF  ( SRY-SRYKBN     =  "60" OR "64" )
               AND ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                    (SRY-SRYCD(IDX2)(1:3)  =  "008"))
               AND ( FLG-KENSA-COM  =   ZERO        )
                 IF  SRY-SRYCD(IDX2) = "840000085" OR "840000087"
                    CONTINUE
                 ELSE
                    PERFORM  VARYING  IDV  FROM  1  BY  2
                              UNTIL  (IDV            >   200)
                               OR    (FLG-KENSA-COM  =    1 )
                      IF  RECE45-NAME(IDX4)(IDV:2)   =  "日"
                        MOVE   SPACE  TO  RECE44-FLG-KENSA-COMMENT
                        MOVE     1    TO  FLG-KENSA-COM
                      END-IF
                    END-PERFORM
                 END-IF
               END-IF
      *
               IF  ( SRY-SRYKBN       =  "14"       )
               AND ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                    (SRY-SRYCD(IDX2)(1:3)  =  "008"))
               AND ( FLG-ZAIRIHA-COM  =   ZERO      )
                    PERFORM  VARYING  IDV  FROM  1  BY  2
                              UNTIL  (IDV              >   200)
                               OR    (FLG-ZAIRIHA-COM  =    1 )
                      IF  RECE45-NAME(IDX4)(IDV:2)   =  "日"
                        MOVE   SPACE  TO  RECE44-FLG-ZAIRIHA-COMMENT
                        MOVE     1    TO  FLG-ZAIRIHA-COM
                      END-IF
                    END-PERFORM
               END-IF
      *
               IF  ( SRY-SRYKBN = "12" OR "13" OR
                                  "14" OR "80"      )
               AND ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                    (SRY-SRYCD(IDX2)(1:3)  =  "008"))
                 IF (RECE45-NAME(IDX4)(1:20) = "管理料等算定開始年月")
                 OR (RECE45-NAME(IDX4)(1:18) = "管理料算定開始年月"  )
                   MOVE   "1"   TO   RECE44-FLG-ONLINE3-COMMENT
                 END-IF
               END-IF
      *
               IF  SRY-SRYCD(IDX2)(1:3)     =   "058"
                 MOVE  TNS-FORMALYUKOKETA TO  RECE45-YUKOKETA(IDX4)
                 MOVE  TNS-FORMALNAME     TO  RECE45-NAME(IDX4)
                                              WRK-FORMALNAME
                 MOVE  "1"                TO  RECE45-RECEDENFLG(IDX4)
      *
                 MOVE     TNS-TEN         TO  WRK-KZI058-TEN
                 IF   TNS-TANICD  NOT = SPACE AND "000"
                    MOVE  TNS-TANICD      TO  WRK-KZI058-TANICD
                    MOVE  TNS-TANIMOJISU  TO  WRK-KZI058-TANIMOJISU
                    MOVE  TNS-TANINAME    TO  WRK-KZI058-TANINAME
                 END-IF
                 MOVE     ZERO            TO  RECE45-TEN(IDX4)
                 MOVE     ZERO            TO  RECE45-TANICD(IDX4)
                 MOVE     ZERO            TO  RECE45-TANIMOJISU(IDX4)
                 MOVE     SPACE           TO  RECE45-TANINAME(IDX4)
               END-IF
               IF  (SRY-SRYCD(IDX2)(1:1)    =   "7")
               AND (SRY-MEISKYFLG(IDX2)     =   "1")
                 IF   (SRY-SRYKBN  =   "70")
                 AND  (TNS-DATAKBN =   "3" )
                    IF    RECE45-RENNUM  >  1
                    AND   IDX4           =  1
                      MOVE    1           TO  FLG-FORMAL-KISAI
                      COMPUTE  WRK-RENNUM2 =  RECE45-RENNUM  -  1
                    ELSE
                      MOVE  "1"           TO  RECE45-RECEPTFLG(IDX4 - 1)
                    END-IF
                 ELSE
                    MOVE  WRK-FORMALNAME  TO  RECE45-RECEDENNAME(IDX4)
                    MOVE  "1"             TO  RECE45-RECEHENFLG(IDX4)
                    IF    WRK-KZI058-TEN  NOT = ZERO
                       MOVE   WRK-KZI058-TEN
                                          TO  RECE45-TEN(IDX4)
                    END-IF
                    IF   (RECE45-TANICD(IDX4)    = ZERO)
                    AND  (WRK-KZI058-TANICD  NOT = ZERO)
                       MOVE   WRK-KZI058-TANICD
                                          TO  RECE45-TANICD(IDX4)
                       MOVE   WRK-KZI058-TANIMOJISU
                                          TO  RECE45-TANIMOJISU(IDX4)
                       MOVE   WRK-KZI058-TANINAME
                                          TO  RECE45-TANINAME(IDX4)
                    END-IF
                 END-IF
               END-IF
      *
               IF  (SRY-SRYKBN         =  "99"       )
               AND (SRY-RENNUM         =   1         )
               AND (IDX2               =   1         )
               AND (SRY-SRYCD(IDX2)    =  "099999902")
                    MOVE      1         TO  FLG-TAHOKEN
               END-IF
               IF  (FLG-TAHOKEN           =   1              )
               AND (SRY-RENNUM            =   1              )
               AND (IDX2                  =   2              )
               AND (SRY-SRYCD(IDX2)(1:4)  =  "0082"          )
               AND (TNS-NAME(1:14)        =  "保険名称変更：")
                  MOVE     "1"          TO  RECE45-RECEPTFLG(IDX4)
                  MOVE     "1"          TO  RECE45-RECEDENFLG(IDX4)
      *
                  MOVE      ZERO        TO  IDW3
                  PERFORM   VARYING   IDW   FROM   200   BY  -1
                             UNTIL    IDW     <    15
                       IF   TNS-NAME(IDW:1)  NOT =   SPACE
                           COMPUTE IDW6       =  (IDW / 2) - 7
                           MOVE    IDW        TO  IDW3
                           MOVE    1          TO  IDW
                       END-IF
                  END-PERFORM
                  IF     IDW3    NOT =  ZERO
                    MOVE  SPACE TO RECE45-NAME(IDX4 - 1)
                    COMPUTE   IDW4  =  IDW3  -  14
                    MOVE  TNS-NAME(15:IDW4)
                                TO RECE45-NAME(IDX4 - 1)(1:IDW4)
                    COMPUTE   IDW5  =  IDW4  +   1
                    MOVE  "にて診察料算定済"
                                TO RECE45-NAME(IDX4 - 1)(IDW5:16)
                    COMPUTE   RECE45-YUKOKETA(IDX4 - 1) =
                              RECE45-YUKOKETA(IDX4 - 1) -
                              3                         +
                              IDW6
                  END-IF
               END-IF
      *
               IF  RECE45-YUKOKETA(IDX4)  =  ZERO
                   PERFORM   VARYING   IDW   FROM   200   BY  -1
                           UNTIL   IDW   <   1
                       IF   RECE45-NAME(IDX4)(IDW:1)  NOT =   SPACE
                           COMPUTE RECE45-YUKOKETA(IDX4)  =
                                   IDW     /   2
                           MOVE    1          TO  IDW
                       END-IF
                   END-PERFORM
               END-IF
      *
               IF (  SRY-SRYCD(IDX2) = CONS-ROUSAI1  OR
                                       CONS-ROUSAI18   )
               OR (( ACCT-SRYKBN          =  "80"     )   AND           
                   ( SRY-SRYCD(IDX2)(1:5) =  "09591"
                                          OR "09592"
                                          OR "09593"  ))                
               OR (( SRY-SRYCD(IDX2) = CONS-ROUSAI8   )   AND
                   ( RECE41-SRYYM    < "200804"       ))
               OR (( SRY-SRYCD(IDX2) =
                     CONS-ROUSAI3  OR CONS-ROUSAI4  OR
                     CONS-ROUSAI5  OR CONS-ROUSAI6  OR
                     CONS-ROUSAI7  OR CONS-ROUSAI19 OR
                     CONS-ROUSAI9  OR CONS-ROUSAI10 OR
                     CONS-ROUSAI11 OR CONS-ROUSAI12 OR
                     CONS-ROUSAI13 OR CONS-ROUSAI14 OR
                     CONS-ROUSAI15 OR CONS-ROUSAI16 OR
                     CONS-ROUSAI17                    )   AND
                   ( RECE41-SRYYM   <= "201306"       ))
               OR (( SRY-SRYCD(IDX2)  =
                     CONS-ROUSAI32 OR CONS-ROUSAI33 OR
                     CONS-ROUSAI34 OR CONS-ROUSAI5  OR
                     CONS-ROUSAI20 OR CONS-ROUSAI21 OR
                     CONS-ROUSAI22 OR CONS-ROUSAI23 OR
                     CONS-ROUSAI24 OR CONS-ROUSAI25 OR
                     CONS-ROUSAI26 OR CONS-ROUSAI27 OR
                     CONS-ROUSAI28 OR CONS-ROUSAI29 OR
                     CONS-ROUSAI30 OR CONS-ROUSAI31 OR
                     CONS-ROUSAI35 OR CONS-ROUSAI36 OR
                     CONS-ROUSAI37 OR CONS-ROUSAI38 OR
                     CONS-ROUSAI39                    )   AND
                   ( RECE41-SRYYM   >= "201307"       ))
               OR (( SRY-SRYCD(IDX2) >= "101801010" AND
                                     <= "101801020"   )   AND
                   ( RECE41-SRYYM   >=  "201307"      ))
               OR (( SRY-SRYCD(IDX2)  = "101801030"   )   AND
                   ( RECE41-SRYYM   >=  "201307"      ))
      *
      *           IF     TNS-TENSIKIBETU   =   1
                     ADD      1          TO  WRK-MEISAI-CNT
                     IF  SRY-SRYSYUKBN = "809"
                        COMPUTE  WRK-TEN = WRK-TEN +
                                          (SRY-JIHIMONEY(IDX2) / 10)
                     ELSE
                      IF   SRY-SRYCD(IDX2)  =  "101801030"
                        COMPUTE  WRK-FUTANWARI  = TNS-TEN / 100
                        COMPUTE  WRK-KEISAN-KG  =
                                (WRK-TEN-KG  * WRK-FUTANWARI) + 0.5
                        COMPUTE  WRK-TEN = WRK-TEN + WRK-KEISAN-KG
                        COMPUTE  WRK-KEISAN-KG2 =
                                (WRK-TEN-KG2 * WRK-FUTANWARI)
                      ELSE
                        COMPUTE  WRK-TEN = WRK-TEN +
                                          (TNS-TEN / 10)
                        COMPUTE  WRK-TEN-KG  = TNS-TEN / 10
                        COMPUTE  WRK-TEN-KG2 = TNS-TEN
                      END-IF
                     END-IF
      *
                     ADD      1          TO  WRK-SURYOUTOTAL
                     MOVE  SRY-SRYCD(IDX2) 
                                         TO  WRK-SRYCD
                     ADD   WRK-SRYCD     TO  WRK-SRYCDTOTAL
      *           END-IF
      *
                  MOVE     "2"     TO    RECE45-SIKFLG(IDX4)
      *
                  IF  (ACCT-SRYKBN          = "80"   )
                  AND (SRY-SRYCD(IDX2)(1:5) =
                        "09591" OR "09592" OR "09593")
                        COMPUTE  WRK-ZAI-KINGAKU = WRK-ZAI-KINGAKU
                                                 + WRK-TNS-TEN(IDX2)
                  ELSE
                      IF  SRY-SRYCD(IDX2)  =  "101801030"
                        COMPUTE  WRK-ZAI-KINGAKU = WRK-ZAI-KINGAKU
                                                 + WRK-KEISAN-KG2
                        MOVE     WRK-KEISAN-KG2  TO  RECE45-TEN(IDX4)
                      ELSE
                        COMPUTE  WRK-ZAI-KINGAKU = WRK-ZAI-KINGAKU
                                                 + TNS-TEN
                      END-IF
                  END-IF
      *
               ELSE
      *
                  IF   RECE41-HKNKBN     =  "4"
                  AND  RECE41-JIBAIKBN   =  "1"
                  AND  SRY-SRYCD(IDX2)   =  CONS-RYOYOTEATE
      *
                     ADD      1          TO  WRK-MEISAI-CNT
                     COMPUTE  WRK-TEN    =   WRK-TEN   +
                                             TNS-TEN
      *
                     COMPUTE  WRK-ZAI-KINGAKU = WRK-ZAI-KINGAKU
                                              + WRK-RYOYOTEATE2
      *
                     ADD      1          TO  WRK-SURYOUTOTAL
                     MOVE  SRY-SRYCD(IDX2) 
                                         TO  WRK-SRYCD
                     ADD   WRK-SRYCD     TO  WRK-SRYCDTOTAL
      *
                     MOVE     "2"        TO  RECE45-SIKFLG(IDX4)
      *
                  ELSE
      *
                    IF  ((RECE41-HKNKBN      =   "4") AND
                         (RECE41-JIBAIKBN    =   "2"))
                    OR  ((RECE41-HKNKBN      =   "5") AND
                         (RECE41-KOMUKBN     =   "2"))
                    OR  ( RECE41-HKNKBN      =   "6" )
                      IF (( ACCT-SRYKBN            =  "80"      ) AND
                          ( WRK-CHECK-SRYCD(1:5)   =  "09591"
                                                   OR "09592"
                                                   OR "09593"   ) AND
                          ( SRY-SRYCD(IDX2)(1:1)   =   "8"      ))
                      OR (( ACCT-SRYKBN            =  "80"      ) AND
                          ( WRK-CHECK-SRYCD(1:5)   =  "09591"
                                                   OR "09592"
                                                   OR "09593"   ) AND
                          ( SRY-SRYCD(IDX2)(1:3)   =   "008"    ))
      *
                         ADD    1      TO    WRK-MEISAI-CNT             
                         MOVE  "2"     TO    RECE45-SIKFLG(IDX4)
      *
                         ADD    1      TO    WRK-SURYOUTOTAL
                         MOVE  SRY-SRYCD(IDX2) 
                                       TO    WRK-SRYCD
                         ADD   WRK-SRYCD 
                                       TO    WRK-SRYCDTOTAL
                         IF  ( RECE44-COMCDFLG       =   "1"   )
                         AND ((SRY-SRYCD(IDX2)(1:1)  =   "8"  ) OR
                              (SRY-SRYCD(IDX2)(1:3)  =   "008"))
                            MOVE  "2"  TO    RECE44-COMCDFLG
                         END-IF
                      ELSE
                         MOVE  "1"     TO    RECE45-SIKFLG(IDX4)
                      END-IF
                    ELSE
                      IF (  SRY-SRYCD(IDX2) = CONS-ROUCOM1  OR
                                              CONS-ROUCOM2       )
                      OR (( ACCT-SRYKBN     = "11"              ) AND
                          ((SRY-SRYCD(IDX2)(1:3)   =   "008") OR
                           (SRY-SRYCD(IDX2)(1:1)   =   "8"  )   ) AND
                          ( SRY-SRYCD(IDX2) NOT = "830000020"   ) AND
                          ( ACCT-ZAIKBN     NOT =  1 AND 2      ))
                      OR (( ACCT-SRYKBN     = "12"              ) AND
                          ((SRY-SRYCD(IDX2)(1:3)   =   "008") OR
                           (SRY-SRYCD(IDX2)(1:1)   =   "8"  )   ) AND
                          ( SRY-SRYCD(IDX2) NOT = "830000021"   ) AND
                          ( ACCT-ZAIKBN     NOT =  1 AND 2      ))
                      OR (( ACCT-SRYKBN     = "13"              ) AND
                          ( WRK-CHECK-SRYCD =  CONS-ROUSAI8     ) AND
                          ((SRY-SRYCD(IDX2)(1:3)   =   "008") OR
                           (SRY-SRYCD(IDX2)(1:1)   =   "8"  )   ) AND
                          ( RECE41-SRYYM    <  "200804"         ))
                      OR (( ACCT-SRYKBN            =  "80"      ) AND
                          ( WRK-CHECK-SRYCD(1:5)   =  "09591"
                                                   OR "09592"
                                                   OR "09593"   ) AND
                          ((SRY-SRYCD(IDX2)(1:3)   =   "008") OR
                           (SRY-SRYCD(IDX2)(1:1)   =   "8"  )   ))
                      OR (( WRK-CHECK-SRYCD =  CONS-ROUSAI3     ) AND
                          ( RECE41-SRYYM   <=  "201306"         ))
                      OR (( ACCT-SRYKBN     = "13"              ) AND
                          ( WRK-CHECK-SRYCD =
                            CONS-ROUSAI9  OR  CONS-ROUSAI10 OR
                            CONS-ROUSAI11 OR  CONS-ROUSAI12 OR
                            CONS-ROUSAI13 OR  CONS-ROUSAI14 OR
                            CONS-ROUSAI15 OR  CONS-ROUSAI16 OR
                            CONS-ROUSAI17                       ) AND
                          ((SRY-SRYCD(IDX2)(1:3)   =   "008") OR
                           (SRY-SRYCD(IDX2)(1:1)   =   "8"  )   ) AND
                          ( RECE41-SRYYM   <=  "201306"         ))
                      OR (( WRK-CHECK-SRYCD =  CONS-ROUSAI32    ) AND
                          ( RECE41-SRYYM   >=  "201307"         ))
                      OR (( ACCT-SRYKBN     = "80"              ) AND
                          ( WRK-CHECK-SRYCD =
                            CONS-ROUSAI20 OR  CONS-ROUSAI21 OR
                            CONS-ROUSAI22 OR  CONS-ROUSAI23 OR
                            CONS-ROUSAI24 OR  CONS-ROUSAI25 OR
                            CONS-ROUSAI26 OR  CONS-ROUSAI27 OR
                            CONS-ROUSAI28 OR  CONS-ROUSAI29 OR
                            CONS-ROUSAI30 OR  CONS-ROUSAI31 OR
                            CONS-ROUSAI39                       ) AND
                          ((SRY-SRYCD(IDX2)(1:3)   =   "008") OR
                           (SRY-SRYCD(IDX2)(1:1)   =   "8"  )   ) AND
                          ( RECE41-SRYYM   >=  "201307"         ))
                      OR (( WRK-CHECK-SRYCD =  CONS-ROUSAI33    ) AND
                          ( RECE41-SRYYM   >=  "201307"         ))
                      OR (( ACCT-SRYKBN     = "80"              ) AND
                          ( WRK-CHECK-SRYCD >= "101801010" AND
                                            <= "101801020"      ) AND
                          ((SRY-SRYCD(IDX2)(1:3)   =   "008") OR
                           (SRY-SRYCD(IDX2)(1:1)   =   "8"  )   ) AND
                          ( RECE41-SRYYM   >=  "201307"         ))
                       IF  (WRK-CHECK-SRYCD(1:6) = "101989"   )
                       OR  (WRK-CHECK-SRYCD      = "112023210")
                         MOVE  "1"     TO    RECE45-SIKFLG(IDX4)
                       ELSE
                         ADD    1      TO    WRK-MEISAI-CNT             
                         MOVE  "2"     TO    RECE45-SIKFLG(IDX4)
      *
                         ADD    1      TO    WRK-SURYOUTOTAL
                         MOVE  SRY-SRYCD(IDX2) 
                                       TO    WRK-SRYCD
                         ADD   WRK-SRYCD 
                                       TO    WRK-SRYCDTOTAL
                         IF  ( RECE44-COMCDFLG       =   "1"   )
                         AND ((SRY-SRYCD(IDX2)(1:1)  =   "8"  ) OR
                              (SRY-SRYCD(IDX2)(1:3)  =   "008"))
                            MOVE  "2"  TO    RECE44-COMCDFLG
                         END-IF
                       END-IF
                      ELSE
                         MOVE  "1"     TO    RECE45-SIKFLG(IDX4)
                      END-IF
                    END-IF
      *
                  END-IF
      *
               END-IF
      *
      *        特定器材（画像診断のフィルム以外）のとき単価を編集
               IF      SRY-SRYCD (IDX2) (1:1)  =   "7"
                   IF   (  SRY-SRYCD (IDX2)         =
                                    CONS-FILM-YOUJI-KASAN  OR  
                                    CONS-SANSO             OR
                                    CONS-SANSO2               )
      ***          OR   (  TNS-DATAKBN              =   "3"   )
                       CONTINUE
                   ELSE
      **               SET     TBL-SANSO           TO  1
      **               SEARCH      TBL-SANSO-OCC   VARYING   TBL-SANSO
      **                   AT  END
      **                       MOVE    ZERO            TO  FLG-SANSO-OK
      **                   WHEN    SRY-SRYCD (IDX2)    =   TBL-SANSO-SRYCD
      **                                                        (TBL-SANSO)
      **                       MOVE    1               TO  FLG-SANSO-OK
      **               END-SEARCH
      **               IF      FLG-SANSO-OK        =   "1"
                     IF      RECE45-TEN(IDX4)  =   ZERO
                       CONTINUE
                     ELSE
                       PERFORM 2101212-RECE45-TANKA-HEN-SEC
                       COMPUTE IDW =   RECE45-YUKOKETA(IDX4)  *  2 
                                                   +   3                    
                       MOVE    WRK-CHAR-N (1:WRK-CHAR-N-CNT)
                                                   TO
                                               RECE45-NAME(IDX4)(IDW:)   
                       COMPUTE RECE45-YUKOKETA(IDX4)
                                               =   RECE45-YUKOKETA(IDX4)
                                                   +   1   
                                                   +
                                                  (WRK-CHAR-N-CNT  /  2)
                     END-IF
                   END-IF
               END-IF        
      *       
      *----------------------------------------------------------------
      *        在宅部分のレセプト編集用に往診（特別往診）・夜間・
      *        深夜・緊急の剤判定を追加
      *----------------------------------------------------------------
               IF    SRY-SRYKBN     =  "14"
      *
                 IF  SRY-SRYCD(IDX2) =  CONS-ZAIHOU-COMMENT
                                    OR  CONS-ZAIHOU3-COMMENT
                                    OR  CONS-ZAIHOU4-COMMENT
                                    OR  CONS-ZAIHOU5-COMMENT
                                    OR  CONS-ZAIHOU6-COMMENT
                                    OR  CONS-ZAIHOU7-COMMENT
                                    OR  CONS-ZAIHOU8-COMMENT
                                    OR  CONS-ZAIHOU9-COMMENT
                                    OR  "114001470"
                    MOVE        9         TO    FLG-OSINKBN
                 END-IF
      *
                 EVALUATE    SRY-SRYCD(IDX2)
      *往診（特別往診）
                   WHEN    "114000110"
                   WHEN    "114001610"
                   WHEN    "114000970"
                   WHEN    "114002470"
      ***          WHEN    "114002970"
                   IF  FLG-OSINKBN        NOT = 2  AND  3  AND  9
                       MOVE     1         TO    FLG-OSINKBN
                   END-IF
      *夜間
                   WHEN    "114000470"
                   WHEN    "114001970"
                   WHEN    "114011670"
                   WHEN    "114011970"
                   WHEN    "114017570"
                   WHEN    "114017870"
      *
                   WHEN    "114029270"
                   WHEN    "114029370"
                   WHEN    "114029470"
                   WHEN    "114029570"
                   WHEN    "114029970"
                   WHEN    "114030070"
                   WHEN    "114030170"
                   WHEN    "114030270"
                   IF  FLG-OSINKBN        NOT = 9
                       MOVE     2         TO    FLG-OSINKBN
                   END-IF
      *深夜・緊急
                   WHEN    "114000370"
                   WHEN    "114000570"
                   WHEN    "114001870"
                   WHEN    "114002070"
                   WHEN    "114011570"
                   WHEN    "114011770"
                   WHEN    "114011870"
                   WHEN    "114012070"
                   WHEN    "114017470"
                   WHEN    "114017770"
                   WHEN    "114017670"
                   WHEN    "114017970"
                   IF  FLG-OSINKBN        NOT = 9
                       MOVE     3         TO    FLG-OSINKBN
                   END-IF
                 END-EVALUATE
      *
                 IF    RECE41-SRYYM   >=  "201404"
                  EVALUATE    SRY-SRYCD(IDX2)
      *            往診
                   WHEN    "114000110"
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(1 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                     MOVE  1  TO  FLG-ZAITAKU-CHECK
      *            患家診療時間加算（往診）
                   WHEN    "114000970"
                    IF  FLG-ZAITAKU-CHECK = ZERO
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(2 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                    END-IF
      *            特別往診
                   WHEN    "114001610"
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(3 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                     MOVE  1  TO  FLG-ZAITAKU-CHECK
      *            患家診療時間加算（特別往診）
                   WHEN    "114002470"
                    IF  FLG-ZAITAKU-CHECK = ZERO
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(4 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                    END-IF
      *            在宅患者訪問診療料
                   WHEN    "114001110"
                   WHEN    "114012910"
                   WHEN    "114018010"
                   WHEN    "114030310"
                   WHEN    "114042110"
                   WHEN    "114042210"
                   WHEN    "114042810"
                   WHEN    "114046310"
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(5 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                     MOVE  1  TO  FLG-ZAITAKU-CHECK
      *            患家診療時間加算（在宅患者訪問診療料）
                   WHEN    "114001470"
                    IF  FLG-ZAITAKU-CHECK = ZERO
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(6 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                    END-IF
                  END-EVALUATE
                 END-IF
      *
               END-IF
      *
               MOVE    ACCT-ZAIKBN  TO  RECE44-ZAIKBN
      *
               IF      ACCT-ZAIKBN       =     1
                 MOVE   ZERO        TO  RECE45-SRYSURYO(IDX4)
                 MOVE   ZERO        TO  RECE45-TANICD(IDX4)
                 MOVE   ZERO        TO  RECE45-TANIMOJISU(IDX4)
                 MOVE   SPACE       TO  RECE45-TANINAME(IDX4)
                 IF  (SRY-SRYCD(IDX2)(1:1) = "6" OR "7")
                 OR  (SRY-SRYCD(IDX2)(1:3) = "059"     )
                 OR  (SRY-SRYCD(IDX2)(1:2) = "63"      )
                     MOVE  "1"          TO  RECE44-COMCDFLG
                     MOVE  "810000001"  TO  RECE45-SRYCD(IDX4)
                 END-IF
               END-IF
               IF      ACCT-ZAIKBN       =     2
                 MOVE   ZERO        TO  RECE45-SRYSURYO(IDX4)
                 MOVE   ZERO        TO  RECE45-TANICD(IDX4)
                 MOVE   ZERO        TO  RECE45-TANIMOJISU(IDX4)
                 MOVE   SPACE       TO  RECE45-TANINAME(IDX4)
               END-IF
      *
               PERFORM  2101216-SETCOM-HENSYU-SEC
      *
      *        ０９５９３で始まるコードがある場合、労災レセ電の作成対象外
               IF    (RECE41-HKNKBN           =   "1" OR "2")
               AND   (RECE41-SRYYM           >=   "201307"  )
               AND   (RECE41-RSIIRYOKBN   NOT =   "0"       )
               AND   (SYS-200501-ROURECEKBN   =   "1" OR "3")
                 IF  (ACCT-SRYKBN          =  "80"   )
                 AND (SRY-SRYCD(IDX2)(1:5) =  "09593")
                    MOVE     1      TO  RECE41-ORIGINALCDKBN
                 END-IF
               END-IF
      *
               IF    (RECE41-SRYYM         >=  "201704")
               AND   (SRY-SRYCD(IDX2)(1:3)  =  "059"   )
                 IF   (RECE41-HKNKBN   NOT =  "1" AND "2" )
                 OR   (RECE41-RECESYUBETU  =  "0000"      )
                 OR   (RECE41-ERR-ERRKBN   >   ZERO       )
                 OR   (SRY-SRYKBN          =  "95" OR "96")
      ***        OR   ((WRK-PARA-PRTKBN    =  "1"   ) AND
      ***              (ACCT-ZAITEN        =   ZERO )     )
                   CONTINUE
                 ELSE
                   MOVE     15      TO  RECE41-ERR-ERRKBN
                   DISPLAY "059 ERR:SRYCD=" SRY-SRYCD(IDX2)
                 END-IF
               END-IF
      *
              END-IF
             END-IF  
           END-PERFORM
      *
           IF    IDX4    NOT =   ZERO
               MOVE    1     TO    FLG-WRITE45X
           END-IF
      *
           .
       210121-RECE45-TENSOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトコメントフラグ編集処理
      *****************************************************************
       2101211-RECE45-COMCNT-HEN-SEC               SECTION.
      *
           IF      RECE44-SRYKBN      =     "11" OR "12" OR "13"
              IF   SRY-SRYCD(IDX2)    =     CONS-NINPU-COMMENT
                                     OR     CONS-NINPU2-COMMENT
                                     OR     CONS-NINPU3-COMMENT
                                     OR     CONS-NINPU4-COMMENT
                                     OR     CONS-NINPU5-COMMENT
                                     OR     CONS-NINPU6-COMMENT
                                     OR     CONS-NINPU7-COMMENT
                                     OR     CONS-NINPU8-COMMENT
                                     OR     CONS-NINPU9-COMMENT
                                     OR     CONS-NINPU10-COMMENT
                                     OR     CONS-NINPU11-COMMENT
                                     OR     CONS-NINPU12-COMMENT
                                     OR     CONS-NINPU13-COMMENT
                                     OR     CONS-NINPU14-COMMENT
                                     OR     CONS-NINPU15-COMMENT
                                     OR     CONS-NINPU16-COMMENT
                                     OR     CONS-NINPU17-COMMENT
                                     OR     CONS-NINPU18-COMMENT
                                     OR     CONS-NINPU19-COMMENT
                                     OR     CONS-NINPU20-COMMENT
                                     OR     CONS-NINPU21-COMMENT
                                     OR     CONS-NINPU22-COMMENT
                                     OR     CONS-NINPU23-COMMENT
                                     OR     CONS-NINPU24-COMMENT
                                     OR     CONS-NINPU25-COMMENT
                                     OR     CONS-NINPU26-COMMENT
                                     OR     CONS-NINPU27-COMMENT
                                     OR     CONS-NINPU28-COMMENT
                                     OR     CONS-NINPU29-COMMENT
                                     OR     CONS-NINPU30-COMMENT
                                     OR     CONS-NINPU31-COMMENT
                                     OR     CONS-NINPU32-COMMENT
                                     OR     CONS-NINPU33-COMMENT
                                     OR     CONS-NINPU34-COMMENT
                                     OR     CONS-NINPU35-COMMENT
                                     OR     CONS-NINPU36-COMMENT
                                     OR     CONS-NINPU37-COMMENT
                                     OR     CONS-NINPU38-COMMENT
                 EVALUATE   RECE41-NINPUFLG
                    WHEN        0
                            MOVE    1    TO    RECE41-NINPUFLG
                    WHEN        2
                            MOVE    3    TO    RECE41-NINPUFLG
                 END-EVALUATE
              END-IF
           END-IF
           IF      RECE44-SRYKBN      =     "99"
              IF   SRY-SRYCD(IDX2)    =     CONS-NINPU39-COMMENT
                 EVALUATE   RECE41-NINPUFLG
                    WHEN        0
                            MOVE    2    TO    RECE41-NINPUFLG
                    WHEN        1
                            MOVE    3    TO    RECE41-NINPUFLG
                 END-EVALUATE
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN      =     "11"
      *       初診料算定科：
              IF ( SRY-SRYCD(IDX2)    =     "830000020"          )
              OR ((SRY-SRYCD(IDX2)    =     CONS-SYODOU-COMMENT ) AND
                  (RECE41-SRYYM      >=     "201204"            ))
              OR ((SRY-SRYCD(IDX2)    =     CONS-ROUSAI18       ) AND
                  (RECE41-SRYYM      >=     "201204"            ))
              OR ( SRY-SRYCD(IDX2)    =     CONS-SYODOU3-COMMENT
                                     OR     CONS-SYODOU4-COMMENT )
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-SYOSANTEIKA-COMMENT
              END-IF
      *       初診（同日複数診療科）
              IF  (SRY-SRYCD(IDX2)    =     CONS-SYODOU-COMMENT
                                      OR    CONS-ROUSAI18
                                      OR    CONS-SYODOU3-COMMENT
                                      OR    CONS-SYODOU4-COMMENT)
              AND (FLG-SYODOU-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE44-FLG-SYODOU-COMMENT
                   MOVE   SRY-SRYKA   TO    RECE44-SYODOU-SRYKA(1)
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-SYODOU2-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-SYODOU-COMMENT
                   MOVE  SPACE  TO    RECE44-SYODOU-SRYKA(1)
                   MOVE    1    TO    FLG-SYODOU-COM
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN      =     "12"
      *       再診料算定科：
              IF ( SRY-SRYCD(IDX2)    =     "830000021"
                                      OR    CONS-DOUJITU-SAI
                                      OR    CONS-DOUJITU-SAI2
                                      OR    CONS-DOUJITU-DEN
                                      OR    CONS-DOUJITU-DEN2
                                      OR    CONS-DOUJITU-DEN3
                                      OR    CONS-DOUJITU-DEN4
                                      OR    CONS-DOUJITU-GAI
                                      OR    CONS-DOUJITU2-GAI
                                      OR    CONS-DOUJITU3-GAI)
              OR ((SRY-SRYCD(IDX2)    =     CONS-ROUSAI19   ) AND
                  (RECE41-SRYYM      <=     "201306"        ))
              OR ((SRY-SRYCD(IDX2)    =     CONS-ROUSAI5
                                      OR    CONS-ROUSAI38   ) AND
                  (RECE41-SRYYM      >=     "201307"        ))
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-SAISANTEIKA-COMMENT
              END-IF
      *       電話再診
              IF  (SRY-SRYCD(IDX2)    =     "112009750"   OR
                                            "112009850"   OR
                                            "112009950"   OR
                                            "112010050"   OR
                                            "112012750"   OR
                                            "112704150"   OR
                                            "112704250"   OR
                                            "112704350"   OR
                                            "112706750"   OR
                                            "112010650"   OR
                                            "112010750"   OR
                                            "112010850"   OR
                                            "112010950"   OR
                                            "112012850"   OR
                                            "112704850"   OR
                                            "112704950"   OR
                                            "112705050"   OR
                                            "112706850"   OR
                                            "112007950"   OR
                                            "112008050"   OR
                                            "112008150"   OR
                                            "112008250"   OR
                                            "112012450"   OR
                                            "112702750"   OR
                                            "112702850"   OR
                                            "112702950"   OR
                                            "112706450"   OR
                                            "112008850"   OR
                                            "112008950"   OR
                                            "112009050"   OR
                                            "112009150"   OR
                                            "112012550"   OR
                                            "112703450"   OR
                                            "112703550"   OR
                                            "112703650"   OR
                                            "112706550"     )
              AND (RECE41-SRYYM       <     "201004"        )
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-DENWASAI-COMMENT
              END-IF
              IF  ((SRY-SRYCD(IDX2)   =     "112007950"    ) AND
                   (RECE41-SRYYM      >=    "201004"       ))
              OR  ((SRY-SRYCD(IDX2)   =     "101120050"    ) AND
                   (RECE41-SRYYM      >=    "201307"       ))
              OR  ((SRY-SRYCD(IDX2)   =     "112016750"    ) AND
                   (RECE41-SRYYM      >=    "201501"       ))
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-DENWASAI-COMMENT
              END-IF
              IF    SRY-SRYCD(IDX2)   =     "112023350"
                                         OR "112023650"
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-DENWASAI2-COMMENT
              END-IF
      *       同日再診
              IF  (SRY-SRYCD(IDX2)    =     "112010150"   OR
                                            "112010250"   OR
                                            "112010350"   OR
                                            "112010450"   OR
                                            "112010550"   OR
                                            "112704450"   OR
                                            "112704550"   OR
                                            "112704650"   OR
                                            "112704750"   OR
                                            "112010650"   OR
                                            "112010750"   OR
                                            "112010850"   OR
                                            "112010950"   OR
                                            "112012850"   OR
                                            "112704850"   OR
                                            "112704950"   OR
                                            "112705050"   OR
                                            "112706850"   OR
                                            "112008850"   OR
                                            "112008950"   OR
                                            "112009050"   OR
                                            "112009150"   OR
                                            "112012550"   OR
                                            "112703450"   OR
                                            "112703550"   OR
                                            "112703650"   OR
                                            "112706550"   OR
                                            "112008350"   OR
                                            "112008450"   OR
                                            "112008550"   OR
                                            "112008650"   OR
                                            "112008750"   OR
                                            "112703050"   OR
                                            "112703150"   OR
                                            "112703250"   OR
                                            "112703350"   OR
      *
                                            "112011710"   OR
                                            "112705850"     )
              AND (RECE41-SRYYM       <     "201004"        )
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-DOUJITUSAI-COMMENT
              END-IF
              IF  ((SRY-SRYCD(IDX2)   =     "112008350"   OR
                                            "112011710"   OR
                                            "112016550"    ) AND
                   (RECE41-SRYYM      >=    "201004"       ))
              OR  ((SRY-SRYCD(IDX2)   =     "101120060"    ) AND
                   (RECE41-SRYYM      >=    "201307"       ))
              OR  ((SRY-SRYCD(IDX2)   =     "112016850"    ) AND
                   (RECE41-SRYYM      >=    "201501"       ))
              OR  ((SRY-SRYCD(IDX2)   =     "112017450"    ) AND
                   (RECE41-SRYYM      >=    "201501"       ))
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-DOUJITUSAI-COMMENT
              END-IF
      *       同日電話再診
              IF  ((SRY-SRYCD(IDX2)   =     "112008850"    ) AND
                   (RECE41-SRYYM      >=    "201004"       ))
              OR  ((SRY-SRYCD(IDX2)   =     "101120070"    ) AND
                   (RECE41-SRYYM      >=    "201307"       ))
              OR  ((SRY-SRYCD(IDX2)   =     "112016950"    ) AND
                   (RECE41-SRYYM      >=    "201501"       ))
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-DOUDENSAI-COMMENT
              END-IF
              IF    SRY-SRYCD(IDX2)   =     "112023450"
                                         OR "112023750"
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-DOUDENSAI2-COMMENT
              END-IF
      *
      *       再診（同一日２科目）
              IF ( SRY-SRYCD(IDX2)    =     CONS-DOUJITU-SAI
                                      OR    CONS-DOUJITU-SAI2
                                      OR    CONS-DOUJITU-DEN
                                      OR    CONS-DOUJITU-DEN2
                                      OR    CONS-DOUJITU-DEN3
                                      OR    CONS-DOUJITU-DEN4
                                      OR    CONS-DOUJITU-GAI
                                      OR    CONS-DOUJITU2-GAI
                                      OR    CONS-DOUJITU3-GAI)
              OR ((SRY-SRYCD(IDX2)    =     CONS-ROUSAI19   ) AND
                  (RECE41-SRYYM      <=     "201306"        ))
              OR ((SRY-SRYCD(IDX2)    =     CONS-ROUSAI5
                                      OR    CONS-ROUSAI38   ) AND
                  (RECE41-SRYYM      >=     "201307"        ))
               IF   FLG-SAIDOU-COM   =     ZERO
                 MOVE   "1"        TO   RECE44-FLG-SAIDOU-COMMENT
                 MOVE   SRY-SRYKA  TO   RECE44-SAIDOU-SRYKA(1)
               END-IF
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-DOUJITU-COMMENT
                 MOVE   SPACE      TO   RECE44-FLG-SAIDOU-COMMENT
                 MOVE   SPACE      TO   RECE44-SAIDOU-SRYKA(1)
                 MOVE    1         TO   FLG-SAIDOU-COM
              END-IF
      *
      *       オンライン診療料
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE-COMMENT
                 MOVE   "1"        TO   RECE44-FLG-ONLINE-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE11-COMMENT
                 MOVE    1         TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE12-COMMENT
                 MOVE    2         TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE13-COMMENT
                 MOVE    3         TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE14-COMMENT
                 MOVE    4         TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE15-COMMENT
                 MOVE    5         TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE16-COMMENT
                 MOVE    6         TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE17-COMMENT
                 MOVE    7         TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE18-COMMENT
                 MOVE    8         TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE19-COMMENT
                 MOVE    9         TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE20-COMMENT
                 MOVE    10        TO   RECE44-FLG-ONLINE2-COMMENT
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN      =     "40"
      *       介達牽引（発症日記載）
              IF   RECE41-SRYYM      >=    "200604"
              AND  RECE41-SRYYM      <=    "200803"
                IF   SRY-SRYCD(IDX2)  =     CONS-KAITATU-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-KAITATU-COMMENT
                END-IF
              END-IF
      *
              IF   RECE41-SRYYM      >=    "201004"
      *         人工腎臓等
                IF   SRY-SRYCD(IDX2)  =     CONS-JINZOU1-COMMENT
                                        OR  CONS-JINZOU2-COMMENT
                                        OR  CONS-JINZOU3-COMMENT
                                        OR  CONS-JINZOU4-COMMENT
                                        OR  CONS-JINZOU5-COMMENT
                                        OR  CONS-JINZOU6-COMMENT
                                        OR  CONS-JINZOU7-COMMENT
                                        OR  CONS-JINZOU8-COMMENT
                                        OR  CONS-JINZOU9-COMMENT
                                        OR  CONS-JINZOU10-COMMENT
                                        OR  CONS-JINZOU11-COMMENT
                                        OR  CONS-JINZOU12-COMMENT
                                        OR  CONS-JINZOU13-COMMENT
                                        OR  CONS-JINZOU14-COMMENT
                                        OR  CONS-JINZOU15-COMMENT
                                        OR  CONS-JINZOU16-COMMENT
                                        OR  CONS-JINZOU17-COMMENT
                                        OR  CONS-JINZOU18-COMMENT
                                        OR  CONS-JINZOU19-COMMENT
                                        OR  CONS-JINZOU20-COMMENT
                                        OR  CONS-JINZOU21-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-JINZOU-COMMENT
                END-IF
      *         局所陰圧閉鎖処置
                IF    RECE41-SRYYM      >=    "201404"
                  IF   SRY-SRYCD(IDX2)  =     CONS-KYOKUIN8-COMMENT
                                          OR  CONS-KYOKUIN9-COMMENT
                                          OR  CONS-KYOKUIN10-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-KYOKUIN-COMMENT
                  END-IF
                ELSE
                 IF   RECE41-SRYYM      >=    "201204"
                  IF   SRY-SRYCD(IDX2)  =     CONS-KYOKUIN5-COMMENT
                                          OR  CONS-KYOKUIN6-COMMENT
                                          OR  CONS-KYOKUIN7-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-KYOKUIN-COMMENT
                  END-IF
                 ELSE
                  IF   SRY-SRYCD(IDX2)  =     CONS-KYOKUIN1-COMMENT
                                          OR  CONS-KYOKUIN2-COMMENT
                                          OR  CONS-KYOKUIN3-COMMENT
                                          OR  CONS-KYOKUIN4-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-KYOKUIN-COMMENT
                  END-IF
                 END-IF
                END-IF
              END-IF
      *       磁気による膀胱等刺激法
              IF   RECE41-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2)    =     CONS-BOKOHO1-COMMENT)
                AND (FLG-BOKOHO-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE44-FLG-BOKOHO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)    =     CONS-BOKOHO2-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-BOKOHO-COMMENT
                   MOVE    1    TO    FLG-BOKOHO-COM
                END-IF
              END-IF
      *       高気圧酸素治療
              IF  (SRY-SRYCD(IDX2)    =     CONS-KIATU-COMMENT )
              AND (FLG-KIATU-COM      =     ZERO               )
                   MOVE   "1"   TO    RECE44-FLG-KIATU-COMMENT
              END-IF
              IF  (SRY-SRYCD(IDX2)    =     CONS-KIATU2-COMMENT)
              AND (FLG-KIATU-COM      =     ZERO               )
                   MOVE   "2"   TO    RECE44-FLG-KIATU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-KIATU3-COMMENT
                                      OR    CONS-KIATU4-COMMENT
                                      OR    CONS-KIATU5-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-KIATU-COMMENT
                   MOVE    1    TO    FLG-KIATU-COM
              END-IF
           END-IF
      *
           IF    ((RECE41-HKNKBN    NOT  =  "4" AND "6" ) AND
                  (RECE44-SRYKBN         =  "80"        ))
           OR    ((RECE41-HKNKBN         =  "4"  OR "6" ) AND
                  (RECE44-SRYKBN         =  "40" OR "80"))
      *       リハビリ
              IF   SRY-SRYCD(IDX2)    =     "180706910"   OR
                                            "180022210"   OR
                                            "180706810"   OR
                                            "180022110"   OR
                                            "180707110"   OR
                                            "180022410"   OR
                                            "180707010"   OR
                                            "180022310"   OR
                                            "180707310"   OR
                                            "180022610"   OR
                                            "180707210"   OR
                                            "180022510"   OR
                                            "180707510"   OR
                                            "180022810"   OR
                                            "180707410"   OR
                                            "180022710"   OR
                                            "180708210"   OR
                                            "180023710"   OR
                                            "180708410"   OR
                                            "180023910"   OR
                                            "180708110"   OR
                                            "180023610"   OR
                                            "180708310"   OR
                                            "180023810"   OR
                                            "180024910"   OR
                                            "180024810"   OR
                                            "180025110"   OR
                                            "180025010"   OR
                                            "180025510"   OR
                                            "180025410"
      *****             MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-RIHABIRI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-SINDAI1-COMMENT  OR
                                            CONS-SINDAI2-COMMENT  OR
                                            CONS-SINDAI3-COMMENT  OR
                                            CONS-SINDAI4-COMMENT  OR
                                            CONS-KOKYUKI1-COMMENT OR
                                            CONS-KOKYUKI2-COMMENT OR
                                            CONS-KOKYUKI3-COMMENT OR
                                            CONS-KOKYUKI4-COMMENT OR
                                            CONS-NOUKE1-COMMENT   OR
                                            CONS-NOUKE2-COMMENT   OR
                                            CONS-NOUKE3-COMMENT   OR
                                            CONS-NOUKE4-COMMENT   OR
                                            CONS-NOUKE7-COMMENT   OR
                                            CONS-NOUKE11-COMMENT  OR
                                            CONS-NOUKE12-COMMENT  OR
                                            CONS-NOUKE13-COMMENT  OR
                                            CONS-NOUKE14-COMMENT  OR
                                            CONS-NOUKE15-COMMENT  OR
                                            CONS-NOUKE16-COMMENT  OR
                                            CONS-NOUKE17-COMMENT  OR
                                            CONS-NOUKE18-COMMENT  OR
                                            CONS-NOUKE19-COMMENT  OR
                                            CONS-NOUKE23-COMMENT  OR
                                            CONS-NOUKE24-COMMENT  OR
                                            CONS-NOUKE25-COMMENT  OR
                                            CONS-NOUKE26-COMMENT  OR
                                            CONS-NOUKE27-COMMENT  OR
                                            CONS-NOUKE28-COMMENT  OR
                                            CONS-NOUKE29-COMMENT  OR
                                            CONS-NOUKE30-COMMENT  OR
                                            CONS-NOUKE31-COMMENT  OR
                                            CONS-NOUKE32-COMMENT  OR
                                            CONS-NOUKE33-COMMENT  OR
                                            CONS-NOUKE34-COMMENT  OR
                                            CONS-NOUKE35-COMMENT  OR
                                            CONS-NOUKE36-COMMENT  OR
                                            CONS-NOUKE37-COMMENT  OR
                                            CONS-UNDOKI1-COMMENT  OR
                                            CONS-UNDOKI2-COMMENT  OR
                                            CONS-UNDOKI3-COMMENT  OR
                                            CONS-UNDOKI4-COMMENT  OR
                                            CONS-UNDOKI9-COMMENT  OR
                                            CONS-UNDOKI11-COMMENT OR
                                            CONS-UNDOKI12-COMMENT OR
                                            CONS-UNDOKI13-COMMENT OR
                                            CONS-UNDOKI17-COMMENT OR
                                            CONS-UNDOKI18-COMMENT OR
                                            CONS-UNDOKI19-COMMENT OR
                                            CONS-UNDOKI22-COMMENT OR
                                            CONS-UNDOKI23-COMMENT OR
                                            CONS-UNDOKI24-COMMENT OR
                                            CONS-UNDOKI25-COMMENT OR
                                            CONS-UNDOKI26-COMMENT OR
                                            CONS-UNDOKI27-COMMENT OR
                                            CONS-UNDOKI28-COMMENT OR
                                            CONS-UNDOKI29-COMMENT OR
                                            CONS-UNDOKI30-COMMENT OR
                                            CONS-SYOGAI1-COMMENT  OR
                                            CONS-SYOGAI2-COMMENT  OR
                                            CONS-SYOGAI3-COMMENT  OR
                                            CONS-HAIYO1-COMMENT   OR
                                            CONS-HAIYO2-COMMENT   OR
                                            CONS-HAIYO3-COMMENT   OR
                                            CONS-HAIYO4-COMMENT   OR
                                            CONS-HAIYO5-COMMENT   OR
                                            CONS-HAIYO6-COMMENT   OR
                                            CONS-HAIYO7-COMMENT   OR
                                            CONS-HAIYO8-COMMENT   OR
                                            CONS-HAIYO9-COMMENT   OR
                                            CONS-HAIYO10-COMMENT  OR
                                            CONS-HAIYO11-COMMENT  OR
                                            CONS-HAIYO12-COMMENT  OR
                                            CONS-HAIYO13-COMMENT  OR
                                            CONS-HAIYO14-COMMENT  OR
                                            CONS-HAIYO15-COMMENT  OR
                                            CONS-HAIYO16-COMMENT  OR
                                            CONS-HAIYO17-COMMENT  OR
                                            CONS-HAIYO18-COMMENT  OR
                                            CONS-HAIYO19-COMMENT  OR
                                            CONS-HAIYO20-COMMENT  OR
                                            CONS-HAIYO21-COMMENT  OR
                                            CONS-GANKNJ-COMMENT
      *****             MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-RIHABIRI-COMMENT
              END-IF
              IF   RECE41-SRYYM      >=    "201307"
                IF   SRY-SRYCD(IDX2)  =     CONS-SINDAI9-COMMENT   OR
                                            CONS-SINDAI10-COMMENT  OR
                                            CONS-KOKYUKI9-COMMENT  OR
                                            CONS-KOKYUKI10-COMMENT OR
                                            CONS-NOUKE20-COMMENT   OR
                                            CONS-NOUKE21-COMMENT   OR
                                            CONS-NOUKE22-COMMENT   OR
                                            CONS-UNDOKI14-COMMENT  OR
                                            CONS-UNDOKI15-COMMENT  OR
                                            CONS-UNDOKI16-COMMENT  OR
                                            CONS-UNDOKI20-COMMENT  OR
                                            CONS-UNDOKI21-COMMENT
      *****             MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-RIHABIRI-COMMENT
                END-IF
              ELSE
                IF   SRY-SRYCD(IDX2)  =     CONS-SINDAI7-COMMENT   OR
                                            CONS-SINDAI8-COMMENT   OR
                                            CONS-KOKYUKI7-COMMENT  OR
                                            CONS-KOKYUKI8-COMMENT  OR
                                            CONS-NOUKE8-COMMENT    OR
                                            CONS-NOUKE9-COMMENT    OR
                                            CONS-NOUKE10-COMMENT   OR
                                            CONS-UNDOKI7-COMMENT   OR
                                            CONS-UNDOKI8-COMMENT   OR
                                            CONS-UNDOKI10-COMMENT
      *****             MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-RIHABIRI-COMMENT
                END-IF
              END-IF
              EVALUATE      SRY-SRYCD(IDX2)
                WHEN     CONS-SINDAI5-COMMENT
                        MOVE   "2"    TO    RECE44-RIHABIRI-COMMENT
                WHEN     CONS-SINDAI6-COMMENT
                        MOVE   "3"    TO    RECE44-RIHABIRI-COMMENT
                WHEN     CONS-KOKYUKI5-COMMENT
                        MOVE   "4"    TO    RECE44-RIHABIRI-COMMENT
                WHEN     CONS-KOKYUKI6-COMMENT
                        MOVE   "5"    TO    RECE44-RIHABIRI-COMMENT
                WHEN     CONS-NOUKE5-COMMENT
                        MOVE   "6"    TO    RECE44-RIHABIRI-COMMENT
                WHEN     CONS-NOUKE6-COMMENT
                        MOVE   "7"    TO    RECE44-RIHABIRI-COMMENT
                WHEN     CONS-UNDOKI5-COMMENT
                        MOVE   "8"    TO    RECE44-RIHABIRI-COMMENT
                WHEN     CONS-UNDOKI6-COMMENT
                        MOVE   "9"    TO    RECE44-RIHABIRI-COMMENT
              END-EVALUATE
      *       リハビリ（発症日記載）
              IF   RECE41-SRYYM      >=    "200604"
                IF   SRY-SRYCD(IDX2)  =     CONS-SINDAI1-COMMENT
                                      OR    CONS-SINDAI2-COMMENT
                                      OR    CONS-SINDAI3-COMMENT
                                      OR    CONS-SINDAI4-COMMENT
                                      OR    CONS-SINDAI5-COMMENT
                                      OR    CONS-SINDAI6-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-SINDAI-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-KOKYUKI1-COMMENT
                                      OR    CONS-KOKYUKI2-COMMENT
                                      OR    CONS-KOKYUKI3-COMMENT
                                      OR    CONS-KOKYUKI4-COMMENT
                                      OR    CONS-KOKYUKI5-COMMENT
                                      OR    CONS-KOKYUKI6-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-KOKYUKI-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-NOUKE1-COMMENT
                                      OR    CONS-NOUKE2-COMMENT
                                      OR    CONS-NOUKE3-COMMENT
                                      OR    CONS-NOUKE4-COMMENT
                                      OR    CONS-NOUKE5-COMMENT
                                      OR    CONS-NOUKE6-COMMENT
                                      OR    CONS-NOUKE7-COMMENT
                                      OR    CONS-NOUKE11-COMMENT
                                      OR    CONS-NOUKE12-COMMENT
                                      OR    CONS-NOUKE13-COMMENT
                                      OR    CONS-NOUKE14-COMMENT
                                      OR    CONS-NOUKE15-COMMENT
                                      OR    CONS-NOUKE16-COMMENT
                                      OR    CONS-NOUKE17-COMMENT
                                      OR    CONS-NOUKE18-COMMENT
                                      OR    CONS-NOUKE19-COMMENT
                                      OR    CONS-NOUKE23-COMMENT
                                      OR    CONS-NOUKE24-COMMENT
                                      OR    CONS-NOUKE25-COMMENT
                                      OR    CONS-NOUKE26-COMMENT
                                      OR    CONS-NOUKE27-COMMENT
                                      OR    CONS-NOUKE28-COMMENT
                                      OR    CONS-NOUKE29-COMMENT
                                      OR    CONS-NOUKE30-COMMENT
                                      OR    CONS-NOUKE31-COMMENT
                                      OR    CONS-NOUKE32-COMMENT
                                      OR    CONS-NOUKE33-COMMENT
                                      OR    CONS-NOUKE34-COMMENT
                                      OR    CONS-NOUKE35-COMMENT
                                      OR    CONS-NOUKE36-COMMENT
                                      OR    CONS-NOUKE37-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-NOUKE-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-UNDOKI1-COMMENT
                                      OR    CONS-UNDOKI2-COMMENT
                                      OR    CONS-UNDOKI3-COMMENT
                                      OR    CONS-UNDOKI4-COMMENT
                                      OR    CONS-UNDOKI5-COMMENT
                                      OR    CONS-UNDOKI6-COMMENT
                                      OR    CONS-UNDOKI9-COMMENT
                                      OR    CONS-UNDOKI11-COMMENT
                                      OR    CONS-UNDOKI12-COMMENT
                                      OR    CONS-UNDOKI13-COMMENT
                                      OR    CONS-UNDOKI17-COMMENT
                                      OR    CONS-UNDOKI18-COMMENT
                                      OR    CONS-UNDOKI19-COMMENT
                                      OR    CONS-UNDOKI22-COMMENT
                                      OR    CONS-UNDOKI23-COMMENT
                                      OR    CONS-UNDOKI24-COMMENT
                                      OR    CONS-UNDOKI25-COMMENT
                                      OR    CONS-UNDOKI26-COMMENT
                                      OR    CONS-UNDOKI27-COMMENT
                                      OR    CONS-UNDOKI28-COMMENT
                                      OR    CONS-UNDOKI29-COMMENT
                                      OR    CONS-UNDOKI30-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-UNDOKI-COMMENT
                END-IF
                IF   RECE41-SRYYM      >=    "201307"
                  IF   SRY-SRYCD(IDX2)  =   CONS-SINDAI9-COMMENT
                                      OR    CONS-SINDAI10-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-SINDAI-COMMENT
                  END-IF
                  IF   SRY-SRYCD(IDX2)  =   CONS-KOKYUKI9-COMMENT
                                      OR    CONS-KOKYUKI10-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-KOKYUKI-COMMENT
                  END-IF
                  IF   SRY-SRYCD(IDX2)  =   CONS-NOUKE20-COMMENT
                                      OR    CONS-NOUKE21-COMMENT
                                      OR    CONS-NOUKE22-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-NOUKE-COMMENT
                  END-IF
                  IF   SRY-SRYCD(IDX2)  =   CONS-UNDOKI14-COMMENT
                                      OR    CONS-UNDOKI15-COMMENT
                                      OR    CONS-UNDOKI16-COMMENT
                                      OR    CONS-UNDOKI20-COMMENT
                                      OR    CONS-UNDOKI21-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-UNDOKI-COMMENT
                  END-IF
                ELSE
                  IF   SRY-SRYCD(IDX2)  =   CONS-SINDAI7-COMMENT
                                      OR    CONS-SINDAI8-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-SINDAI-COMMENT
                  END-IF
                  IF   SRY-SRYCD(IDX2)  =   CONS-KOKYUKI7-COMMENT
                                      OR    CONS-KOKYUKI8-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-KOKYUKI-COMMENT
                  END-IF
                  IF   SRY-SRYCD(IDX2)  =   CONS-NOUKE8-COMMENT
                                      OR    CONS-NOUKE9-COMMENT
                                      OR    CONS-NOUKE10-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-NOUKE-COMMENT
                  END-IF
                  IF   SRY-SRYCD(IDX2)  =   CONS-UNDOKI7-COMMENT
                                      OR    CONS-UNDOKI8-COMMENT
                                      OR    CONS-UNDOKI10-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-UNDOKI-COMMENT
                  END-IF
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-NANBYO-COMMENT)
                AND (RECE41-SRYYM    <=     "201803"           )
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-NANBYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-SYOGAI1-COMMENT
                                      OR    CONS-SYOGAI2-COMMENT
                                      OR    CONS-SYOGAI3-COMMENT)
                AND (RECE41-SRYYM    <=     "201803"            )
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-SYOGAI-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-SESYOKU-COMMENT
                                      OR    CONS-SESYOKU2-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-SESSYOKU-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-HAIYO1-COMMENT
                                      OR    CONS-HAIYO2-COMMENT
                                      OR    CONS-HAIYO3-COMMENT
                                      OR    CONS-HAIYO4-COMMENT
                                      OR    CONS-HAIYO5-COMMENT
                                      OR    CONS-HAIYO6-COMMENT
                                      OR    CONS-HAIYO7-COMMENT
                                      OR    CONS-HAIYO8-COMMENT
                                      OR    CONS-HAIYO9-COMMENT
                                      OR    CONS-HAIYO10-COMMENT
                                      OR    CONS-HAIYO11-COMMENT
                                      OR    CONS-HAIYO12-COMMENT
                                      OR    CONS-HAIYO13-COMMENT
                                      OR    CONS-HAIYO14-COMMENT
                                      OR    CONS-HAIYO15-COMMENT
                                      OR    CONS-HAIYO16-COMMENT
                                      OR    CONS-HAIYO17-COMMENT
                                      OR    CONS-HAIYO18-COMMENT
                                      OR    CONS-HAIYO19-COMMENT
                                      OR    CONS-HAIYO20-COMMENT
                                      OR    CONS-HAIYO21-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-HAIYO-COMMENT
                END-IF
              END-IF
      *
              IF   (RECE41-SRYYM    >=   "201604"             )
              AND  (SRY-SRYCD(IDX2)  =   CONS-RIHAKSN1-COMMENT
                                     OR  CONS-RIHAKSN2-COMMENT)
                IF   RECE44-SINDAI-COMMENT = "1"
                    MOVE   "1"    TO    RECE44-SINDAI9-COMMENT
                END-IF
                IF   RECE44-KOKYUKI-COMMENT = "1"
                    MOVE   "1"    TO    RECE44-KOKYUKI9-COMMENT
                END-IF
                IF   RECE44-HAIYO-COMMENT = "1"
                    MOVE   "1"    TO    RECE44-HAIYO9-COMMENT
                END-IF
              END-IF
      *
      *       認知療法・認知行動療法
              IF   RECE41-SRYYM      >=    "201004"
                IF  (SRY-SRYCD(IDX2)  =     CONS-NINRYO-COMMENT )
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "1"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-NINRYO2-COMMENT)
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "2"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-NINRYO5-COMMENT)
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "5"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-NINRYO8-COMMENT)
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "8"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
              END-IF
      *       精神科重症患者早期集中支援管理料
      *       精神科在宅患者支援管理料
              IF   RECE41-SRYYM      >=    "201604"
                IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI-COMMENT  )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "A"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI2-COMMENT )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "B"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
      ***       IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI3-COMMENT )
      ***       AND (FLG-NINRYO-COM   =     ZERO                 )
      ***               MOVE   "C"    TO    RECE44-FLG-NINRYO-COMMENT
      ***       END-IF
      ***       IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI4-COMMENT )
      ***       AND (FLG-NINRYO-COM   =     ZERO                 )
      ***               MOVE   "D"    TO    RECE44-FLG-NINRYO-COMMENT
      ***       END-IF
      ***       IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI5-COMMENT )
      ***       AND (FLG-NINRYO-COM   =     ZERO                 )
      ***               MOVE   "E"    TO    RECE44-FLG-NINRYO-COMMENT
      ***       END-IF
      ***       IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI6-COMMENT )
      ***       AND (FLG-NINRYO-COM   =     ZERO                 )
      ***               MOVE   "F"    TO    RECE44-FLG-NINRYO-COMMENT
      ***       END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI7-COMMENT )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "G"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI8-COMMENT )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "H"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
      ***       IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI9-COMMENT )
      ***       AND (FLG-NINRYO-COM   =     ZERO                 )
      ***               MOVE   "I"    TO    RECE44-FLG-NINRYO-COMMENT
      ***       END-IF
      ***       IF  (SRY-SRYCD(IDX2)  =     CONS-SEIZAI10-COMMENT)
      ***       AND (FLG-NINRYO-COM   =     ZERO                 )
      ***               MOVE   "J"    TO    RECE44-FLG-NINRYO-COMMENT
      ***       END-IF
      *
                IF  (SRY-SRYCD(IDX2)  =     CONS-SEIJYU-COMMENT )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "K"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-SEIJYU2-COMMENT)
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "L"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-SEIJYU3-COMMENT)
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "M"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-SEIJYU4-COMMENT)
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "N"    TO    RECE44-FLG-NINRYO-COMMENT
                END-IF
              END-IF
              IF     SRY-SRYCD(IDX2)  =     CONS-NINRYO6-COMMENT
                        MOVE  SPACE   TO    RECE44-FLG-NINRYO-COMMENT
                        MOVE    1     TO    FLG-NINRYO-COM
              END-IF
      *
      *       通院・在宅精神療法（２０歳未満）加算
              IF   RECE41-SRYYM      >=    "201404"
      ***       IF   SRY-SRYCD(IDX2)  =     CONS-TUINZAI-COMMENT
                IF    (TNS-DATAKBN             =    1 )
                AND   (TNS-CDKBN-KBN           =   "I")
                AND   (TNS-CDKBN-KBNNUM        =    2 )
                AND   (TNS-CDKBN-KBNNUM-EDA    =    0 )
                AND   (RECE41-AGE              <    20)
                  IF    (RECE41-AGE           =      19           )
                  AND   (RECE41-BIRTHDAY(5:2) =  RECE41-SRYYM(5:2))
                  AND   (RECE41-BIRTHDAY(7:2) NOT = "01"          )
                    PERFORM VARYING IDX22 FROM 1 BY 1
                             UNTIL (IDX22                      >  31)
                              OR   (RECE44-FLG-TUINZAI-COMMENT = "1")
                      IF   ACCT-DAY(1 IDX22)  NOT = ZERO
                        IF   IDX22 < RECE41-BIRTHDAY(7:2)
                          MOVE "1"    TO    RECE44-FLG-TUINZAI-COMMENT
                        END-IF
                      END-IF
                    END-PERFORM
                  ELSE
                        MOVE   "1"    TO    RECE44-FLG-TUINZAI-COMMENT
                  END-IF
                END-IF
              END-IF
              IF   RECE41-SRYYM      >=    "201604"
                IF   SRY-SRYCD(IDX2)  =     CONS-TUINZAI-COMMENT
                                      OR    CONS-TUINZAI2-COMMENT
                                      OR    CONS-TUINZAI3-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-TUINZAI2-COMMENT
                END-IF
              END-IF
      *       依存症集団療法
      *       疾患別等専門プログラム加算
              IF   RECE41-SRYYM      >=    "201604"
                IF  (SRY-SRYCD(IDX2)  =     CONS-IZONSYO-COMMENT)
                AND (FLG-IZONSYO-COM  =     ZERO                )
                        MOVE   "1"    TO    RECE44-FLG-IZONSYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     CONS-SCPRO-COMMENT)
                AND (FLG-IZONSYO-COM  =     ZERO              )
                        MOVE   "2"    TO    RECE44-FLG-IZONSYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-IZONSYO2-COMMENT
                        MOVE  SPACE   TO    RECE44-FLG-IZONSYO-COMMENT
                        MOVE    1     TO    FLG-IZONSYO-COM
                END-IF
              END-IF
      *
      *       精神科オンライン在宅管理料
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE4-COMMENT
                 MOVE   "4"        TO   RECE44-FLG-ONLINE-COMMENT
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN      =     "13"
              IF   SRY-SRYCD(IDX2)    =     CONS-MANSEI
                   MOVE   "1"   TO    RECE44-FLG-SHIDOU-COMMENT
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     CONS-SYOBYO-COMMENT
              AND  FLG-SYOBYO-COM     =     ZERO
                   MOVE   "1"   TO    RECE44-FLG-SYOBYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-SYOBYO2-COMMENT
                                      OR    CONS-SYOBYO3-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-SYOBYO-COMMENT
                   MOVE    1    TO    FLG-SYOBYO-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     CONS-RYOYO-COMMENT
              AND  FLG-RYOYO-COM      =     ZERO
                   MOVE   "1"   TO    RECE44-FLG-RYOYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-RYOYO2-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-RYOYO-COMMENT
                   MOVE    1    TO    FLG-RYOYO-COM
              END-IF
      *
              IF  (SRY-SRYCD(IDX2)    =     CONS-NIKOCHIN-COMMENT
                                      OR    CONS-NIKOCHIN2-COMMENT
                                      OR    CONS-NIKOCHIN3-COMMENT)
              AND (FLG-NIKOCHIN-COM   =     ZERO                  )
                   MOVE   "1"   TO    RECE44-FLG-NIKOCHIN-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-NIKOCHIN4-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-NIKOCHIN-COMMENT
                   MOVE    1    TO    FLG-NIKOCHIN-COM
              END-IF
      *
              IF  (SRY-SRYCD(IDX2)    =     CONS-ZENSOKU-COMMENT
                                      OR    CONS-ZENSOKU2-COMMENT)
              AND (FLG-ZENSOKU-COM    =     ZERO                 )
                   MOVE   "1"   TO    RECE44-FLG-ZENSOKU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ZENSOKU3-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-ZENSOKU-COMMENT
                   MOVE    1    TO    FLG-ZENSOKU-COM
              END-IF
      *
              IF   RECE41-SRYYM    >=     "200804"
                IF   (SRY-SRYCD(IDX2)   =     CONS-SYOUNI1-COMMENT)
                AND  (FLG-SYOUNI-COM    =     ZERO                )
                   MOVE   "1"   TO    RECE44-FLG-SYOUNI-COMMENT
                   MOVE   "1"   TO    RECE41-SYOUNIFLG
                END-IF
                IF   (SRY-SRYCD(IDX2)   =     CONS-SYOUNI2-COMMENT)
                AND  (FLG-SYOUNI-COM    =     ZERO                )
                   MOVE   "2"   TO    RECE44-FLG-SYOUNI-COMMENT
                END-IF
                IF    SRY-SRYCD(IDX2)   =     CONS-SYOUNI3-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-SYOUNI-COMMENT
                   MOVE    1    TO    FLG-SYOUNI-COM
                END-IF
              END-IF
      *
              IF   RECE41-SRYYM      >=    "201004"
                IF   RECE41-SRYYM    >=    "201604"
      *           遠隔モニタリング加算
                  IF   SRY-SRYCD(IDX2) =  CONS-SINPESU2-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-SINPESU-COMMENT
                  END-IF
                ELSE
      *           心臓ペースメーカー指導管理料（遠隔モニタリング）
                  IF   SRY-SRYCD(IDX2) =  CONS-SINPESU-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-SINPESU-COMMENT
                  END-IF
                END-IF
              END-IF
              IF   RECE41-SRYYM      >=    "201004"
              AND  RECE41-SRYYM      <=    "201803"
      *         集団栄養食事指導料
                IF   SRY-SRYCD(IDX2)  =     CONS-SYUEIYO-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-SYUEIYO-COMMENT
                END-IF
              END-IF
      *
              IF   RECE41-SRYYM      >=    "201204"
                IF   SRY-SRYCD(IDX2)  =     CONS-NINSEN-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-NINSEN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-SYOUNDO-COMMENT
                        MOVE   "2"    TO    RECE44-FLG-NINSEN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-RYOSYU-COMMENT
                        MOVE   "3"    TO    RECE44-FLG-NINSEN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-NINSAPO-COMMENT
                        MOVE   "4"    TO    RECE44-FLG-NINSEN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-TAKYO-COMMENT
                        MOVE   "1"    TO    RECE41-COMCNTFLG
                        MOVE   "1"    TO    RECE44-FLG-TAKYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-TAKYOKSN-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-TAKYOKSN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     CONS-GAIRIHA1-COMMENT
                                      OR    CONS-GAIRIHA2-COMMENT
                                      OR    CONS-GAIHOU-COMMENT
                        MOVE   "1"    TO    RECE44-FLG-GAIRIHA-COMMENT
                END-IF
              END-IF
      *       心臓ペースメーカー指導管理料（着用型自動除細動器）
      *       心臓ペースメーカー指導管理料（ロ・植込型除細動器移行期加算含む）
      *       がん患者指導管理料２・３
              IF   RECE41-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2) =  CONS-SINPESUR1-COMMENT)
                AND (RECE41-SRYYM   <=  "201803"              )
                   MOVE   "1"   TO    RECE44-FLG-SINPESUR-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  CONS-SINPESUR2-COMMENT
                   MOVE   "2"   TO    RECE44-FLG-SINPESUR-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  CONS-GANSIDO1-COMMENT
                   MOVE   "1"   TO    RECE44-FLG-GANSIDO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  CONS-GANSIDO2-COMMENT
                   MOVE   "2"   TO    RECE44-FLG-GANSIDO-COMMENT
                END-IF
              END-IF
              IF   RECE41-SRYYM    >=     "201604"
                IF   SRY-SRYCD(IDX2) =  CONS-SINPESUR3-COMMENT
                   MOVE   "3"   TO    RECE44-FLG-SINPESUR-COMMENT
                END-IF
              END-IF
      *       乳腺炎重症化予防ケア・指導料（初回）
      *       乳腺炎重症化予防ケア・指導料（２回目から４回目まで）
              IF   SRY-SRYCD(IDX2)    =     CONS-NYUSEN3-COMMENT
              AND  FLG-NYUSEN-COM     =     ZERO
                   MOVE   "1"   TO    RECE44-FLG-NYUSEN-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-NYUSEN-COMMENT
              AND  FLG-NYUSEN-COM     =     ZERO
                   MOVE   "2"   TO    RECE44-FLG-NYUSEN-COMMENT
                   MOVE   "1"   TO    RECE41-NYUSENFLG
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-NYUSEN2-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-NYUSEN-COMMENT
                   MOVE    1    TO    FLG-NYUSEN-COM
              END-IF
      *
      *       オンライン医学管理料
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE2-COMMENT
                 MOVE   "2"        TO   RECE44-FLG-ONLINE-COMMENT
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN      =     "14"
              IF   SRY-SRYCD(IDX2)    =     CONS-HOUSIJI-COMMENT
              AND  FLG-HOUSIJI-COM    =     ZERO
                   MOVE   "1"   TO    RECE44-FLG-HOUSIJI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-HOUSIJI2-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-HOUSIJI-COMMENT
                   MOVE    1    TO    FLG-HOUSIJI-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     CONS-HINKAI-COMMENT
                   MOVE   "1"   TO    RECE44-FLG-HINKAI-COMMENT
              END-IF
      *
              IF  (SRY-SRYCD(IDX2)    =     CONS-OSIN-COMMENT
                                      OR    CONS-OSIN2-COMMENT)
              AND (FLG-OSIN-COM       =     ZERO              )
                   MOVE   "1"   TO    RECE44-FLG-OSIN-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-OSIN3-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-OSIN-COMMENT
                   MOVE    1    TO    FLG-OSIN-COM
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ZAIIKAN1-COMMENT
                                      OR    CONS-ZAIIKAN2-COMMENT
                                      OR    CONS-ZAIIKAN3-COMMENT
                                      OR    CONS-ZAIIKAN4-COMMENT
                                      OR    CONS-ZAIIKAN5-COMMENT
                                      OR    CONS-ZAIIKAN6-COMMENT
                                      OR    CONS-ZAIIKAN7-COMMENT
                                      OR    CONS-ZAIIKAN8-COMMENT
                                      OR    CONS-ZAIIKAN9-COMMENT
                                      OR    CONS-ZAIIKAN10-COMMENT
                                      OR    CONS-ZAIIKAN11-COMMENT
                                      OR    CONS-ZAIIKAN12-COMMENT
                                      OR    CONS-ZAIIKAN13-COMMENT
                                      OR    CONS-ZAIIKAN14-COMMENT
                                      OR    CONS-ZAIIKAN15-COMMENT
                                      OR    CONS-ZAIIKAN16-COMMENT
                                      OR    CONS-ZAIIKAN17-COMMENT
                                      OR    CONS-ZAIIKAN18-COMMENT
                                      OR    CONS-ZAIIKAN19-COMMENT
                                      OR    CONS-ZAIIKAN20-COMMENT
                                      OR    CONS-ZAIIKAN21-COMMENT
                                      OR    CONS-ZAIIKAN22-COMMENT
                                      OR    CONS-ZAIIKAN23-COMMENT
                                      OR    CONS-ZAIIKAN24-COMMENT
                                      OR    CONS-ZAIIKAN25-COMMENT
                                      OR    CONS-ZAIIKAN26-COMMENT
                                      OR    CONS-ZAIIKAN27-COMMENT
                                      OR    CONS-ZAIIKAN28-COMMENT
                                      OR    CONS-ZAIIKAN29-COMMENT
                                      OR    CONS-ZAIIKAN30-COMMENT
                                      OR    CONS-ZAIIKAN31-COMMENT
                                      OR    CONS-ZAIIKAN32-COMMENT
                                      OR    CONS-ZAIIKAN33-COMMENT
                                      OR    CONS-ZAIIKAN34-COMMENT
                                      OR    CONS-ZAIIKAN35-COMMENT
                                      OR    CONS-ZAIIKAN36-COMMENT
                                      OR    CONS-ZAIIKAN37-COMMENT
                                      OR    CONS-ZAIIKAN38-COMMENT
                                      OR    CONS-ZAIIKAN39-COMMENT
                                      OR    CONS-ZAIIKAN40-COMMENT
                                      OR    CONS-ZAIIKAN41-COMMENT
                                      OR    CONS-ZAIIKAN42-COMMENT
                                      OR    CONS-ZAIIKAN43-COMMENT
                                      OR    CONS-ZAIIKAN44-COMMENT
                                      OR    CONS-ZAIIKAN45-COMMENT
                                      OR    CONS-ZAIIKAN46-COMMENT
                                      OR    CONS-ZAIIKAN47-COMMENT
                                      OR    CONS-ZAIIKAN48-COMMENT
                                      OR    CONS-ZAIIKAN49-COMMENT
                                      OR    CONS-ZAIIKAN50-COMMENT
                                      OR    CONS-ZAIIKAN51-COMMENT
                                      OR    CONS-ZAIIKAN52-COMMENT
                                      OR    CONS-ZAIIKAN53-COMMENT
                                      OR    CONS-ZAIIKAN54-COMMENT
                                      OR    CONS-ZAIIKAN55-COMMENT
                                      OR    CONS-ZAIIKAN56-COMMENT
                                      OR    CONS-ZAIIKAN57-COMMENT
                                      OR    CONS-ZAIIKAN58-COMMENT
                                      OR    CONS-ZAIIKAN59-COMMENT
                                      OR    CONS-ZAIIKAN60-COMMENT
                                      OR    CONS-ZAIIKAN61-COMMENT
                                      OR    CONS-ZAIIKAN62-COMMENT
                                      OR    CONS-ZAIIKAN63-COMMENT
                                      OR    CONS-ZAIIKAN64-COMMENT
                                      OR    CONS-ZAIIKAN65-COMMENT
                                      OR    CONS-ZAIIKAN66-COMMENT
                                      OR    CONS-ZAIIKAN67-COMMENT
                                      OR    CONS-ZAIIKAN68-COMMENT
                                      OR    CONS-ZAIIKAN69-COMMENT
                                      OR    CONS-ZAIIKAN70-COMMENT
                                      OR    CONS-ZAIIKAN71-COMMENT
                                      OR    CONS-ZAIIKAN72-COMMENT
                                      OR    CONS-ZAIIKAN73-COMMENT
                                      OR    CONS-ZAIIKAN74-COMMENT
                                      OR    CONS-ZAIIKAN75-COMMENT
                                      OR    CONS-ZAIIKAN76-COMMENT
                                      OR    CONS-ZAIIKAN77-COMMENT
                                      OR    CONS-ZAIIKAN78-COMMENT
                                      OR    CONS-ZAIIKAN79-COMMENT
                                      OR    CONS-ZAIIKAN80-COMMENT
                                      OR    CONS-ZAIIKAN81-COMMENT
                                      OR    CONS-ZAIIKAN82-COMMENT
                                      OR    CONS-ZAIIKAN83-COMMENT
                                      OR    CONS-ZAIIKAN84-COMMENT
                                      OR    CONS-SHIIKAN1-COMMENT
                                      OR    CONS-SHIIKAN2-COMMENT
                                      OR    CONS-SHIIKAN3-COMMENT
                                      OR    CONS-SHIIKAN4-COMMENT
                                      OR    CONS-SHIIKAN5-COMMENT
                                      OR    CONS-SHIIKAN6-COMMENT
                                      OR    CONS-SHIIKAN7-COMMENT
                                      OR    CONS-SHIIKAN8-COMMENT
                                      OR    CONS-SHIIKAN9-COMMENT
                                      OR    CONS-SHIIKAN10-COMMENT
                                      OR    CONS-SHIIKAN11-COMMENT
                                      OR    CONS-SHIIKAN12-COMMENT
                                      OR    CONS-SHIIKAN13-COMMENT
                                      OR    CONS-SHIIKAN14-COMMENT
                                      OR    CONS-SHIIKAN15-COMMENT
                                      OR    CONS-SHIIKAN16-COMMENT
                                      OR    CONS-SHIIKAN17-COMMENT
                                      OR    CONS-SHIIKAN18-COMMENT
                                      OR    CONS-SHIIKAN19-COMMENT
                                      OR    CONS-SHIIKAN20-COMMENT
                                      OR    CONS-SHIIKAN21-COMMENT
                                      OR    CONS-SHIIKAN22-COMMENT
                                      OR    CONS-SHIIKAN23-COMMENT
                                      OR    CONS-SHIIKAN24-COMMENT
                                      OR    CONS-SHIIKAN25-COMMENT
                                      OR    CONS-SHIIKAN26-COMMENT
                                      OR    CONS-SHIIKAN27-COMMENT
                                      OR    CONS-SHIIKAN28-COMMENT
                                      OR    CONS-SHIIKAN29-COMMENT
                                      OR    CONS-SHIIKAN30-COMMENT
                                      OR    CONS-SHIIKAN31-COMMENT
                                      OR    CONS-SHIIKAN32-COMMENT
                                      OR    CONS-SHIIKAN33-COMMENT
                                      OR    CONS-SHIIKAN34-COMMENT
                                      OR    CONS-SHIIKAN35-COMMENT
                                      OR    CONS-SHIIKAN36-COMMENT
                                      OR    CONS-ZAIHOU-COMMENT
                                      OR    CONS-ZAIHOU3-COMMENT
                                      OR    CONS-ZAIHOU4-COMMENT
                                      OR    CONS-ZAIHOU5-COMMENT
                                      OR    CONS-ZAIHOU6-COMMENT
                                      OR    CONS-ZAIHOU7-COMMENT
                                      OR    CONS-ZAIHOU8-COMMENT
                                      OR    CONS-ZAIHOU9-COMMENT
                   MOVE   "1"   TO    RECE41-COMCNTFLG
                   MOVE   "2"   TO    RECE44-FLG-OSIN-COMMENT
              END-IF
      *
              IF   (SRY-SRYCD(IDX2)   =     CONS-ZAIHOU-COMMENT
                                      OR    CONS-ZAIHOU3-COMMENT
                                      OR    CONS-ZAIHOU4-COMMENT
                                      OR    CONS-ZAIHOU5-COMMENT
                                      OR    CONS-ZAIHOU6-COMMENT
                                      OR    CONS-ZAIHOU7-COMMENT
                                      OR    CONS-ZAIHOU8-COMMENT
                                      OR    CONS-ZAIHOU9-COMMENT)
              AND  (FLG-ZAIHOU-COM    =     ZERO                )
                   MOVE   "1"   TO    RECE44-FLG-ZAIHOU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ZAIHOU2-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-ZAIHOU-COMMENT
                   MOVE    1    TO    FLG-ZAIHOU-COM
              END-IF
      *
              IF   RECE41-SRYYM    >=     "201204"
                IF   SRY-SRYCD(IDX2) =  CONS-OSIN-COMMENT
                                    OR  CONS-OSIN2-COMMENT
                   IF    (WRK-SISETU3168  =  1)
                   OR    (WRK-SISETU3055  =  1)
                   OR    (WRK-SISETU3056  =  1)
                       MOVE   "1"   TO    RECE41-COMCNTFLG
                       MOVE   "1"   TO    RECE44-FLG-ZAISIEN-COMMENT
                   END-IF
                   IF  RECE44-FLG-ZAISIEN-COMMENT = SPACE
                     IF  (WRK-SISETU3169  =  1)
                     OR  (WRK-SISETU3057  =  1)
                     OR  (WRK-SISETU3058  =  1)
                       MOVE   "1"   TO    RECE41-COMCNTFLG
                       MOVE   "2"   TO    RECE44-FLG-ZAISIEN-COMMENT
                     END-IF
                   END-IF
                END-IF
              ELSE
                IF   WRK-SISETU613   =  1
                  IF   RECE41-SRYYM   >=  "200604"
                  AND  RECE41-SRYYM   <=  "200803"
                      IF SRY-SRYCD(IDX2) =  CONS-ZAIHOU-COMMENT OR
                                            CONS-ZAISIEN1       OR
                                            CONS-ZAISIEN2       OR
                                            CONS-ZAISIEN3
                        MOVE   "1"   TO    RECE41-COMCNTFLG
                        MOVE   "1"   TO    RECE44-FLG-ZAISIEN-COMMENT
                      END-IF
                  END-IF
                  IF   RECE41-SRYYM   >=  "200804"
                      IF SRY-SRYCD(IDX2) =  CONS-ZAISIEN1       OR
                                            CONS-ZAISIEN2       OR
                                            CONS-ZAISIEN3
                        MOVE   "1"   TO    RECE41-COMCNTFLG
                        MOVE   "1"   TO    RECE44-FLG-ZAISIEN-COMMENT
                      END-IF
                  END-IF
                ELSE
                  IF   WRK-SISETU695   =  1
                    IF   RECE41-SRYYM   >=  "200804"
                      IF SRY-SRYCD(IDX2) =  CONS-ZAISIEN1       OR
                                            CONS-ZAISIEN2       OR
                                            CONS-ZAISIEN3
                        MOVE   "1"   TO    RECE41-COMCNTFLG
                        MOVE   "2"   TO    RECE44-FLG-ZAISIEN-COMMENT
                      END-IF
                    END-IF
                  END-IF
                END-IF
              END-IF
      *
              IF   RECE41-SRYYM    >=     "201204"
                IF   SRY-SRYCD(IDX2) =  CONS-KAISYOKU-COMMENT
                   MOVE   "1"   TO    RECE44-FLG-KAISYOKU-COMMENT
                END-IF
      ***       IF   SRY-SRYCD(IDX2) =  CONS-YOUATU-COMMENT
      ***          MOVE   "1"   TO    RECE44-FLG-YOUATU-COMMENT
      ***       END-IF
              END-IF
      *       在宅患者共同診療料
              IF   RECE41-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2)    =     CONS-ZAIKYO1-COMMENT
                                        OR    CONS-ZAIKYO2-COMMENT
                                        OR    CONS-ZAIKYO3-COMMENT
                                        OR    CONS-ZAIKYO4-COMMENT)
                AND (FLG-ZAIKYO-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE44-FLG-ZAIKYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)    =     CONS-ZAIKYO5-COMMENT
                                        OR    CONS-ZAIKYO6-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-ZAIKYO-COMMENT
                   MOVE    1    TO    FLG-ZAIKYO-COM
                END-IF
              END-IF
      *       在宅患者訪問リハビリテーション指導管理料
              IF   RECE41-SRYYM    >=     "201611"
                IF  (SRY-SRYCD(IDX2)    =     CONS-ZAIRIHA1-COMMENT
                                        OR    CONS-ZAIRIHA2-COMMENT)
                AND (FLG-ZAIRIHA-COM    =     ZERO                 )
                   MOVE   "1"   TO    RECE44-FLG-ZAIRIHA-COMMENT
                END-IF
              END-IF
      *       在宅患者訪問薬剤管理指導料
              IF   SRY-SRYCD(IDX2)    =     CONS-ZAIYAK-COMMENT
                                      OR    CONS-ZAIYAK2-COMMENT
                                      OR    CONS-ZAIYAK3-COMMENT
                   MOVE   "1"   TO    RECE44-FLG-ZAIYAK-COMMENT
              END-IF
      *       遠隔モニタリング加算（在宅酸素療法指導管理料（その他））
      *       遠隔モニタリング加算（在宅持続陽圧呼吸療法指導管理料２）
              IF   SRY-SRYCD(IDX2)    =     CONS-ZAIMONI-COMMENT
                   MOVE   "A"   TO    RECE44-FLG-SINPESU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-ZAIMONI2-COMMENT
                   MOVE   "B"   TO    RECE44-FLG-SINPESU-COMMENT
              END-IF
      *       在宅酸素療法指導管理料（その他）
      *       在宅持続陽圧呼吸療法指導管理料２
              IF   SRY-SRYCD(IDX2)    =     CONS-ZAISAN-COMMENT
                   MOVE   "A"   TO    RECE44-FLG-SINPESUR-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-YOUATU2-COMMENT
                   MOVE   "B"   TO    RECE44-FLG-SINPESUR-COMMENT
              END-IF
      *       在宅半固形栄養経管栄養法指導管理料
              IF  (SRY-SRYCD(IDX2)    =     CONS-ZAIHANKO-COMMENT)
              AND (FLG-NINRYO-COM     =     ZERO                 )
                   MOVE   "9"   TO    RECE44-FLG-NINRYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-NINRYO6-COMMENT
                   MOVE  SPACE  TO    RECE44-FLG-NINRYO-COMMENT
                   MOVE    1    TO    FLG-NINRYO-COM
              END-IF
      *
      *       オンライン在宅管理料（在医総管（月１回訪問診療））
              IF   SRY-SRYCD(IDX2)    =     CONS-ONLINE3-COMMENT
                 MOVE   "3"        TO   RECE44-FLG-ONLINE-COMMENT
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN      =     "33"
              IF   SRY-SRYSYUKBN      =     "334"
              AND  FLG-HOUTEN-COM     =     ZERO
                   MOVE   "1"   TO    RECE44-FLG-HOUTEN-COMMENT
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN      =     "50"
              IF   RECE44-SYUTEN1     =     ZERO
                   MOVE   "1"   TO    RECE44-FLG-SHUJUTU-COMMENT
              END-IF
              IF   SRY-SRYSYUKBN      =     "510"
                   MOVE   "1"   TO    RECE44-FLG-SHUJUTU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     CONS-SHUJUTU-COMMENT
                   MOVE   "1"   TO    RECE44-FLG-SHUJUTU-COMMENT
              END-IF
           END-IF
      *
           IF   RECE41-SRYYM      >=    "201004"
            IF     RECE44-SRYKBN      =     "54"
              IF   RECE44-SYUTEN1     =     ZERO
                   MOVE   "1"   TO    RECE44-FLG-MASUI-COMMENT
              END-IF
            END-IF
           END-IF
      *
           IF      RECE44-SRYKBN      =     "70"
              IF  (SRY-SRYCD(IDX2)    =     CONS-CTMRI-COMMENT1  OR
                                            CONS-CTMRI-COMMENT2  OR
                                            CONS-CTMRI-COMMENT3  OR
                                            CONS-CTMRI-COMMENT4  OR
                                            CONS-CTMRI-COMMENT5  OR
                                            CONS-CTMRI-COMMENT6  OR
                                            CONS-CTMRI-COMMENT7  OR
                                            CONS-CTMRI-COMMENT8  OR
                                            CONS-CTMRI-COMMENT9  OR
                                            CONS-CTMRI-COMMENT10 OR
                                            CONS-CTMRI-COMMENT11 OR
                                            CONS-CTMRI-COMMENT12 OR
                                            CONS-CTMRI-COMMENT13 OR
                                            CONS-CTMRI-COMMENT14 OR
                                            CONS-CTMRI-COMMENT15 OR
                                            CONS-CTMRI-COMMENT16 OR
                                            CONS-CTMRI-COMMENT17)
              AND (RECE41-SRYYM       <     "201004"            )
                   MOVE   "1"   TO    RECE44-FLG-CTMRI-COMMENT
              END-IF
              IF  (SRY-SRYCD(IDX2)    =     CONS-CTMRI-COMMENT1  OR
                                            CONS-CTMRI-COMMENT2  OR
                                            CONS-CTMRI-COMMENT4  OR
                                            CONS-CTMRI-COMMENT6  OR
                                            CONS-CTMRI-COMMENT7  OR
                                            CONS-CTMRI-COMMENT18 OR
                                            CONS-CTMRI-COMMENT19 OR
                                            CONS-CTMRI-COMMENT20 OR
                                            CONS-CTMRI-COMMENT21 OR
                                            CONS-CTMRI-COMMENT22)
              AND (RECE41-SRYYM       >=    "201004"            )
                   MOVE   "1"   TO    RECE44-FLG-CTMRI-COMMENT
              END-IF
      *
              IF    SRY-SRYCD(IDX2)  =
                    "700010000" OR "700030000" OR "700050000" OR
                    "700080000" OR "700110000" OR "700140000" OR
                    "700290000" OR "700310000" OR "700330000" OR
                    "700710000" OR "700730000" OR "700750000" OR
                    "700780000" OR "700810000" OR "700840000" OR
                    "700870000" OR "700160000" OR "700180000" OR
                    "700190000" OR "700200000" OR "700210000" OR
                    "700220000" OR "700230000" OR "700240000" OR
                    "700250000" OR "700260000" OR "700270000" OR
                    "700280000" OR "700590000" OR "700600000" OR
                    "700630000" OR "700640000" OR "700650000" OR
                    "700680000" OR "729780000"
                IF    SRY-SRYKAISU(IDX2)  >   1
                   MOVE   "1"   TO    RECE44-FLG-FILM-COMMENT
                END-IF
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN      =     "60" OR "64"
              IF   (SRY-SRYCD(IDX2)   =     CONS-KENSA1-COMMENT
                                      OR    CONS-KENSA2-COMMENT
                                      OR    CONS-KENSA3-COMMENT)
              AND  (FLG-KENSA-COM     =     ZERO               )
                   MOVE   "1"   TO    RECE44-FLG-KENSA-COMMENT
              END-IF
              IF    SRY-SRYCD(IDX2)   =     CONS-KENSA1-COMMENT
                   MOVE    1    TO    RECE41-KENSA-BNPFLG
              END-IF
              IF    SRY-SRYCD(IDX2)   =     CONS-KENSA2-COMMENT
                   MOVE    1    TO    RECE41-KENSA-NTPROFLG
              END-IF
              IF    SRY-SRYCD(IDX2)   =     CONS-KENSA3-COMMENT
                   MOVE    1    TO    RECE41-KENSA-ANPFLG
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN   =  "14" OR "40" OR "50" OR "54"
                                   OR "60" OR "70" OR "80" OR "64"
              SET     TBL-SANSO    TO      1
              SEARCH      TBL-SANSO-OCC   VARYING   TBL-SANSO
                   AT  END
                       MOVE    ZERO            TO  FLG-SANSO-OK
                   WHEN    SRY-SRYCD (IDX2)    =   TBL-SANSO-SRYCD
                                                        (TBL-SANSO)
                       MOVE    1               TO  FLG-SANSO-OK
              END-SEARCH
              IF      FLG-SANSO-OK        =    1
                   MOVE   "1"   TO    RECE44-FLG-SANSO-COMMENT
              END-IF
           END-IF
      *
           IF      RECE44-SRYKBN   =  "40" OR "54" OR "60" OR "80"
              IF      SRY-MEISKYFLG(IDX2)   =   "R"
                   MOVE   "1"   TO    RECE44-FLG-GAIKAN-COMMENT
              END-IF
           END-IF
      *
           .
       2101211-RECE45-COMCNT-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    酸素の単価編集処理
      *****************************************************************
       2101212-RECE45-TANKA-HEN-SEC     SECTION.
      *
           MOVE    SPACE           TO  WRK-TANKA-X
      * 
      *    数字表示用編集（半角）
           MOVE    RECE45-TEN(IDX4)
                                   TO  WRK-TANKA-9
           MOVE    WRK-TANKA-S1    TO  WRK-TANKA-Z1
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDY   FROM    2   BY  -1
                     UNTIL     IDY           =   ZERO
             IF  WRK-TANKA-S2(IDY:1) NOT =   ZERO
                 MOVE    1               TO  FLG-SP
             END-IF
             IF  FLG-SP                  =   1
                 MOVE    WRK-TANKA-S2(IDY:1)
                                         TO  WRK-TANKA-Z3(IDY:1)
             END-IF
           END-PERFORM
           IF  WRK-TANKA-Z3          NOT =   SPACE
               MOVE    "."               TO  WRK-TANKA-Z2
           END-IF
      *        
           INITIALIZE                      WRK-CHAR-HENKAN-AREA
           MOVE    WRK-TANKA-X         TO  WRK-CHAR-X
           MOVE    12                  TO  WRK-CHAR-CNT
           MOVE    1                   TO  WRK-CHAR-IDX
           MOVE    ZERO                TO  WRK-CHAR-N-CNT
      *     
           PERFORM VARYING     IDW     FROM    1   BY  1
                   UNTIL       IDW     >   WRK-CHAR-CNT
               IF      WRK-CHAR-X (IDW:1)  =   SPACE
                   CONTINUE
               ELSE        
                   IF    WRK-CHAR-X (IDW:1)  IS  NUMERIC
                       IF      WRK-CHAR-X (IDW:1)  =   "0"
                           MOVE    TBL-SUJI (10)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE
                           MOVE    WRK-CHAR-X (IDW:1)  TO  NUM-IDX
                           MOVE    TBL-SUJI (NUM-IDX)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF                    
                   ELSE
                       IF    WRK-CHAR-X (IDW:1)  =   "."
                           MOVE    "．"   TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE    
                           MOVE    "  "   TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF
                   END-IF    
                   ADD     2           TO  WRK-CHAR-IDX
                                           WRK-CHAR-N-CNT
               END-IF    
           END-PERFORM
      *
           IF      WRK-CHAR-N-CNT      >   ZERO
                   MOVE    "円"        TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                   ADD     2           TO  WRK-CHAR-N-CNT
           END-IF                             
      *
           .
       2101212-RECE45-TANKA-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    自賠責特定器材点数編集処理
      *****************************************************************
       2101213-JIBAI-KIZAI-TENHEN-SEC     SECTION.
      *
           MOVE     ZERO                   TO    WRK-TEN-KZI
           MOVE     ZERO                   TO    FLG-TAIGAI
      *
           IF   RECE41-TAXKBN-KZI   =   "2"
      *
      *       システム管理マスタ（４００３）にて消費税対象外コードか判別
              INITIALIZE                      SYS-4003-REC
              MOVE    "4003"              TO  SYS-4003-KANRICD
              MOVE    "*"                 TO  SYS-4003-KBNCD
              MOVE    RECE41-SRYYM        TO  SYS-4003-STYUKYMD(1:6)
              MOVE    "01"                TO  SYS-4003-STYUKYMD(7:2)
              MOVE    SYS-4003-STYUKYMD   TO  SYS-4003-EDYUKYMD
grpsys        MOVE    SPA-HOSPNUM         TO  SYS-4003-HOSPNUM
              MOVE    SYS-4003-REC        TO  MCPDATA-REC
              PERFORM 800-SYSKANRI-READ-SEC
              IF      FLG-SYSKANRI        =   ZERO
                  MOVE    MCPDATA-REC     TO  SYS-4003-REC
                  PERFORM   VARYING   IDX5    FROM   1   BY   1
                             UNTIL   (IDX5                 >    50 )
                               OR    (SYS-4003-SRYCD(IDX5) =  SPACE)
                               OR    (FLG-TAIGAI           =     1 )
                      IF   SYS-4003-SRYCD(IDX5)  =  SRY-SRYCD(IDX2)
                          MOVE     1       TO    FLG-TAIGAI
                      END-IF
                  END-PERFORM
              END-IF
              IF      TNS-NAMECHGKBN  =  ZERO OR 5
                  CONTINUE
              ELSE
                  MOVE     1       TO    FLG-TAIGAI
              END-IF
      *
      *       特定器材等消費税計算
              IF   FLG-TAIGAI  =  ZERO
                   IF  SRY-SRYSYUKBN = "809"
                     COMPUTE  WRK-TEN-KZI  =
                             (SRY-JIHIMONEY(IDX2)
                                       * WRK-S5) + WRK-S3
                   ELSE
                     COMPUTE  WRK-TEN-KZI  =
                             (TNS-TEN  * WRK-S5) + WRK-S3
                   END-IF
              ELSE
                   IF  SRY-SRYSYUKBN = "809"
                      MOVE  SRY-JIHIMONEY(IDX2)  TO   WRK-TEN-KZI
                   ELSE
                      MOVE  TNS-TEN              TO   WRK-TEN-KZI
                   END-IF
              END-IF
           ELSE
              IF  SRY-SRYSYUKBN = "809"
                      MOVE  SRY-JIHIMONEY(IDX2)  TO   WRK-TEN-KZI
              ELSE
                      MOVE  TNS-TEN              TO   WRK-TEN-KZI
              END-IF
           END-IF
      *
           .
       2101213-JIBAI-KIZAI-TENHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    自賠責文書料点数編集処理
      *****************************************************************
       2101214-JIBAI-BUNSYO-TENHEN-SEC     SECTION.
      *
           MOVE        ZERO          TO    WRK-TEN-BUN
      *
           IF   RECE41-TAXKBN   =   "2"
               IF  SRY-SRYSYUKBN = "809"
                  COMPUTE  WRK-TEN-BUN  =
                          (SRY-JIHIMONEY(IDX2)
                                    * WRK-S5) + WRK-S3
               ELSE
                  COMPUTE  WRK-TEN-BUN  =
                          (TNS-TEN  * WRK-S5) + WRK-S3
               END-IF
           ELSE
               IF  SRY-SRYSYUKBN = "809"
                  MOVE  SRY-JIHIMONEY(IDX2)  TO   WRK-TEN-BUN
               ELSE
                  MOVE  TNS-TEN              TO   WRK-TEN-BUN
               END-IF
           END-IF
      *
           .
       2101214-JIBAI-BUNSYO-TENHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    残量廃棄の数量編集処理
      *****************************************************************
       2101215-RECE45-SURYO-HEN-SEC     SECTION.
      *
           MOVE    SPACE           TO  WRK-SURYO-X
           MOVE    ZERO            TO  WRK-SURYOST
           MOVE    ZERO            TO  WRK-SURYOKETA
           MOVE    ZERO            TO  WRK-SURYOKETA1
           MOVE    ZERO            TO  WRK-SURYOKETA2
           MOVE    SPACE           TO  WRK-SURYO-N
           MOVE    SPACE           TO  WRK-SRYSURYOW
      *
      *    数字表示用編集（半角）
      ***  MOVE    RECE45-SRYSURYO(IDX4)  TO  WRK-SURYO
           MOVE    WRK-SRYSURYO           TO  WRK-SURYO
           MOVE    WRK-SURYO-S1           TO  WRK-SURYO-Z1
      *
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDW   FROM    5   BY  -1
                      UNTIL    IDW   =   ZERO
             IF  WRK-SURYO-S2(IDW:1) NOT =   ZERO
                 MOVE    1         TO  FLG-SP
             END-IF
             IF  FLG-SP  =   1
                 MOVE    WRK-SURYO-S2(IDW:1)
                                   TO  WRK-SURYO-Z3(IDW:1)
             END-IF
           END-PERFORM
           IF  WRK-SURYO-Z3   NOT =  SPACE
               MOVE    "."         TO  WRK-SURYO-Z2
           END-IF
      *    表示文字数カウント
           PERFORM   VARYING   IDW   FROM    1   BY  1
                      UNTIL    IDW     >    11
             IF  WRK-SURYO-X(IDW:1)  NOT =  SPACE
                 IF  WRK-SURYOST           =   ZERO
                     MOVE    IDW   TO  WRK-SURYOST
                 END-IF
      *          数量桁数カウント(６桁目：ピリオド)
                 ADD     1         TO  WRK-SURYOKETA
                 IF  IDW    <   6
                     ADD     1     TO  WRK-SURYOKETA1
                 END-IF
                 IF  IDW    >   6
                     ADD     1     TO  WRK-SURYOKETA2
                 END-IF
             END-IF
           END-PERFORM
           IF  WRK-SURYOST  =   6
               MOVE   "0"          TO  WRK-SURYO-Z1(5:1)
               MOVE    5           TO  WRK-SURYOST
               MOVE    1           TO  WRK-SURYOKETA1
               ADD     1           TO  WRK-SURYOKETA
           END-IF
      *    全角変換
           IF  WRK-SURYOKETA1   >   ZERO
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z1(WRK-SURYOST:WRK-SURYOKETA1)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA1  TO  WRK-CHAR-CNT
      *
               MOVE    1               TO  WRK-CHAR-IDX
               PERFORM  VARYING  IDW   FROM    1   BY  1
                         UNTIL   IDW     >   WRK-CHAR-CNT
                   IF    WRK-CHAR-X(IDW:1)  IS  NUMERIC
                     IF    WRK-CHAR-X(IDW:1)  =   "0"
                        MOVE  TBL-SUJI(10)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     ELSE
                        MOVE  WRK-CHAR-X(IDW:1)  TO  NUM-IDX
                        MOVE  TBL-SUJI(NUM-IDX)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     END-IF
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
               END-PERFORM
      *
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N1
           END-IF
           IF  WRK-SURYOKETA2   >   ZERO
               MOVE    "．"            TO  WRK-SURYO-N2
      *
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z3(1:WRK-SURYOKETA2)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA2  TO  WRK-CHAR-CNT
      *
               MOVE    1               TO  WRK-CHAR-IDX
               PERFORM  VARYING  IDW   FROM    1   BY  1
                         UNTIL   IDW     >   WRK-CHAR-CNT
                   IF    WRK-CHAR-X(IDW:1)  IS  NUMERIC
                     IF    WRK-CHAR-X(IDW:1)  =   "0"
                        MOVE  TBL-SUJI(10)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     ELSE
                        MOVE  WRK-CHAR-X(IDW:1)  TO  NUM-IDX
                        MOVE  TBL-SUJI(NUM-IDX)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     END-IF
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
               END-PERFORM
      *
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N3
           END-IF
      *
           STRING      WRK-SURYO-N1    DELIMITED   BY  " "
                       WRK-SURYO-N2    DELIMITED   BY  " "
                       WRK-SURYO-N3    DELIMITED   BY  " "
                       INTO            WRK-SRYSURYOW
           END-STRING
      *
           .
       2101215-RECE45-SURYO-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    関係コメント編集
      *****************************************************************
       2101216-SETCOM-HENSYU-SEC     SECTION.
      *
           IF   RECE45-MEISKYFLG(IDX4)  =  "2"
              IF   (FLG-SETCOM              =  1   )
              AND  (RECE45-RECEDENFLG(IDX4) = SPACE)
                 MOVE  "1"            TO  RECE44-SETCOMFLG
              ELSE
                 MOVE  SPACE          TO  RECE45-MEISKYFLG(IDX4)
              END-IF
           ELSE
              IF   (RECE45-SRYCD(IDX4)(1:1) = "1" OR "6" OR "7")
              OR   (RECE45-SRYCD(IDX4)(1:3) = "059"            )
                IF  RECE45-SRYCD(IDX4)(1:2) = "63"
                 CONTINUE
                ELSE
                 MOVE   1             TO  FLG-SETCOM
                END-IF
              END-IF
           END-IF
      *
      *****
      *
      *    特定薬剤治療管理料
           IF    RECE45-SRYCD(IDX4)   = "113000410" OR "113000510" OR
                                        "180000110" OR "180000210" OR
                                        "113023910"
                 MOVE   1             TO  WRK-SETCOM-JIDO
           END-IF
      *    特定薬剤治療管理加算（臓器移植月から３月）
           IF    RECE45-SRYCD(IDX4)   = "113000670"
                 MOVE   1             TO  WRK-SETCOM-JIDO2
           END-IF
      *    悪性腫瘍特異物質治療管理料
           IF    RECE45-SRYCD(IDX4)   = "113001210" OR "113001310" OR
                                        "113002110"
                 MOVE   3             TO  WRK-SETCOM-JIDO
           END-IF
      *
      *    初診（同日複数診療科）
           IF    RECE45-SRYCD(IDX4)   = CONS-SYODOU-COMMENT
                                     OR CONS-SYODOU3-COMMENT
                                     OR CONS-SYODOU4-COMMENT
                 MOVE   4             TO  WRK-SETCOM-JIDO
           END-IF
           IF    RECE45-SRYCD(IDX4)   = CONS-ROUSAI18
                 MOVE   204           TO  WRK-SETCOM-JIDO
           END-IF
      *    傷病手当金意見書交付料
           IF    RECE45-SRYCD(IDX4)   = CONS-SYOBYO-COMMENT
                 MOVE   6             TO  WRK-SETCOM-JIDO
           END-IF
      *    療養費同意書交付料
           IF    RECE45-SRYCD(IDX4)   = CONS-RYOYO-COMMENT
                 MOVE   7             TO  WRK-SETCOM-JIDO
           END-IF
      *    ニコチン依存症管理料（初回）
      *    ニコチン依存症管理料（２回目から４回目まで）
      *    ニコチン依存症管理料（５回目）
           IF    RECE45-SRYCD(IDX4)   = CONS-NIKOCHIN-COMMENT
                                     OR CONS-NIKOCHIN2-COMMENT
                                     OR CONS-NIKOCHIN3-COMMENT
                 MOVE   8             TO  WRK-SETCOM-JIDO
           END-IF
      *    重度喘息患者治療管理加算（１月目）
      *    重度喘息患者治療管理加算（２月目以降６月目まで）
           IF    RECE45-SRYCD(IDX4)   = CONS-ZENSOKU-COMMENT
                                     OR CONS-ZENSOKU2-COMMENT
                 MOVE   9             TO  WRK-SETCOM-JIDO
           END-IF
      *    小児特定疾患カウンセリング料（１回目）
      *    小児特定疾患カウンセリング料（２回目）
           IF    RECE45-SRYCD(IDX4)   = CONS-SYOUNI1-COMMENT
                                     OR CONS-SYOUNI2-COMMENT
                 MOVE   10            TO  WRK-SETCOM-JIDO
           END-IF
      *    訪問看護指示料
           IF    RECE45-SRYCD(IDX4)   = CONS-HOUSIJI-COMMENT
                 MOVE   11            TO  WRK-SETCOM-JIDO
           END-IF
      *    往診
      *    特別往診
           IF    RECE45-SRYCD(IDX4)   = CONS-OSIN-COMMENT
                                     OR CONS-OSIN2-COMMENT
                 MOVE   13            TO  WRK-SETCOM-JIDO
           END-IF
      *    在宅患者訪問診療料
      *    在宅患者訪問診療料（居住系）
      *    在宅患者訪問診療料（同一建物居住者）（特定施設等入居者）
           IF    RECE45-SRYCD(IDX4)   = CONS-ZAIHOU-COMMENT
                                     OR CONS-ZAIHOU3-COMMENT
                                     OR CONS-ZAIHOU4-COMMENT
                                     OR CONS-ZAIHOU5-COMMENT
                                     OR CONS-ZAIHOU6-COMMENT
                                     OR CONS-ZAIHOU7-COMMENT
                                     OR CONS-ZAIHOU8-COMMENT
                                     OR CONS-ZAIHOU9-COMMENT
                 MOVE   14            TO  WRK-SETCOM-JIDO
           END-IF
      *    認知療法・認知行動療法
      *    精神科重症患者早期集中支援管理料
      *    精神科在宅患者支援管理料
      *    在宅半固形栄養経管栄養法指導管理料
           IF    RECE45-SRYCD(IDX4)   = CONS-NINRYO-COMMENT
                                     OR CONS-NINRYO2-COMMENT
                                     OR CONS-NINRYO5-COMMENT
                                     OR CONS-NINRYO8-COMMENT
                                     OR CONS-SEIJYU-COMMENT
                                     OR CONS-SEIJYU2-COMMENT
                                     OR CONS-SEIJYU3-COMMENT
                                     OR CONS-SEIJYU4-COMMENT
                                     OR CONS-SEIZAI-COMMENT
                                     OR CONS-SEIZAI2-COMMENT
      ***                            OR CONS-SEIZAI3-COMMENT
      ***                            OR CONS-SEIZAI4-COMMENT
      ***                            OR CONS-SEIZAI5-COMMENT
      ***                            OR CONS-SEIZAI6-COMMENT
                                     OR CONS-SEIZAI7-COMMENT
                                     OR CONS-SEIZAI8-COMMENT
      ***                            OR CONS-SEIZAI9-COMMENT
      ***                            OR CONS-SEIZAI10-COMMENT
                                     OR CONS-ZAIHANKO-COMMENT
                 MOVE   19            TO  WRK-SETCOM-JIDO
           END-IF
      *    再診（同一日２科目）
           IF    RECE45-SRYCD(IDX4)   = CONS-DOUJITU-SAI
                                     OR CONS-DOUJITU-SAI2
                                     OR CONS-DOUJITU-DEN
                                     OR CONS-DOUJITU-DEN2
                                     OR CONS-DOUJITU-DEN3
                                     OR CONS-DOUJITU-DEN4
                                     OR CONS-DOUJITU-GAI
                                     OR CONS-DOUJITU2-GAI
                                     OR CONS-DOUJITU3-GAI
                 MOVE   25            TO  WRK-SETCOM-JIDO
           END-IF
      *    在宅患者共同診療料
           IF    RECE45-SRYCD(IDX4)   = CONS-ZAIKYO1-COMMENT
                                     OR CONS-ZAIKYO2-COMMENT
                                     OR CONS-ZAIKYO3-COMMENT
                                     OR CONS-ZAIKYO4-COMMENT
                 MOVE   29            TO  WRK-SETCOM-JIDO
           END-IF
      *    依存症集団療法
           IF    RECE45-SRYCD(IDX4)   = CONS-IZONSYO-COMMENT
                 MOVE   33            TO  WRK-SETCOM-JIDO
           END-IF
      *    高気圧酸素治療
           IF    RECE45-SRYCD(IDX4)   = CONS-KIATU-COMMENT
                                     OR CONS-KIATU2-COMMENT
                 MOVE   35            TO  WRK-SETCOM-JIDO
           END-IF
      *    乳腺炎重症化予防ケア・指導料（２回目から４回目まで）
           IF    RECE45-SRYCD(IDX4)   = CONS-NYUSEN-COMMENT
                                     OR CONS-NYUSEN3-COMMENT
                 MOVE   37            TO  WRK-SETCOM-JIDO
           END-IF
      *    オンライン診療料
           IF    RECE45-SRYCD(IDX4)   = CONS-ONLINE-COMMENT
                 MOVE   38            TO  WRK-SETCOM-JIDO
           END-IF
      *    疾患別等専門プログラム加算
           IF    RECE45-SRYCD(IDX4)   = CONS-SCPRO-COMMENT
                 MOVE   107           TO  WRK-SETCOM-JIDO2
           END-IF
           IF  ((RECE45-SRYCD(IDX4)   = CONS-ROUSAI19) AND
                (RECE41-SRYYM        <= "201306"     ))
           OR  ((RECE45-SRYCD(IDX4)   = CONS-ROUSAI5
                                     OR CONS-ROUSAI38) AND
                (RECE41-SRYYM        >= "201307"     ))
                 MOVE   225           TO  WRK-SETCOM-JIDO
           END-IF
      *
           IF  ((WRK-SETCOM-JIDO    =  1                        ) AND
                (RECE45-SRYCD(IDX4) = "830000014" OR "840000038"))
           OR  ((WRK-SETCOM-JIDO2   =  1                        ) AND
                (RECE45-SRYCD(IDX4) = "840000077"               ))
           OR  ((WRK-SETCOM-JIDO    =  3                        ) AND
                (RECE45-SRYCD(IDX4) = "830000015"               ))
           OR  ((WRK-SETCOM-JIDO    =  4                        ) AND
                (RECE45-SRYCD(IDX4) = CONS-SYODOU2-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  6                        ) AND
                (RECE45-SRYCD(IDX4) = CONS-SYOBYO2-COMMENT
                                   OR CONS-SYOBYO3-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  7                        ) AND
                (RECE45-SRYCD(IDX4) = CONS-RYOYO2-COMMENT       ))
           OR  ((WRK-SETCOM-JIDO    =  8                        ) AND
                (RECE45-SRYCD(IDX4) = CONS-NIKOCHIN4-COMMENT    ))
           OR  ((WRK-SETCOM-JIDO    =  9                        ) AND
                (RECE45-SRYCD(IDX4) = CONS-ZENSOKU3-COMMENT     ))
           OR  ((WRK-SETCOM-JIDO    =  10                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-SYOUNI3-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  11                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-HOUSIJI2-COMMENT     ))
           OR  ((WRK-SETCOM-JIDO    =  13                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-OSIN3-COMMENT        ))
           OR  ((WRK-SETCOM-JIDO    =  14                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-ZAIHOU2-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  19                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-NINRYO6-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  25                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-DOUJITU-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  29                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-ZAIKYO5-COMMENT
                                   OR CONS-ZAIKYO6-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  33                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-IZONSYO2-COMMENT     ))
           OR  ((WRK-SETCOM-JIDO    =  35                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-KIATU3-COMMENT
                                   OR CONS-KIATU4-COMMENT
                                   OR CONS-KIATU5-COMMENT       ))
           OR  ((WRK-SETCOM-JIDO    =  37                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-NYUSEN2-COMMENT      ))
           OR  ((WRK-SETCOM-JIDO    =  38                       ) AND
                (RECE45-SRYCD(IDX4) = CONS-ONLINE11-COMMENT
                                   OR CONS-ONLINE12-COMMENT
                                   OR CONS-ONLINE13-COMMENT
                                   OR CONS-ONLINE14-COMMENT
                                   OR CONS-ONLINE15-COMMENT
                                   OR CONS-ONLINE16-COMMENT
                                   OR CONS-ONLINE17-COMMENT
                                   OR CONS-ONLINE18-COMMENT
                                   OR CONS-ONLINE19-COMMENT
                                   OR CONS-ONLINE20-COMMENT     ))
           OR  ((WRK-SETCOM-JIDO2   =  107                      ) AND
                (RECE45-SRYCD(IDX4) = CONS-IZONSYO2-COMMENT     ))
           OR  ((WRK-SETCOM-JIDO    =  225                      ) AND
                (RECE45-SRYCD(IDX4) = CONS-DOUJITU-COMMENT      ))
      *
                 MOVE  "1"              TO  RECE44-SETCOMFLG
                 MOVE  "2"              TO  RECE45-MEISKYFLG(IDX4)
                 MOVE  WRK-SETCOM-JIDO  TO  RECE45-SETCOMATFLG(IDX4)
                 IF  (WRK-SETCOM-JIDO2   =  1         )
                 AND (RECE45-SRYCD(IDX4) = "840000077")
                   MOVE    2            TO  RECE45-SETCOMATFLG(IDX4)
                 END-IF
                 IF  (WRK-SETCOM-JIDO2   =  107                 )
                 AND (RECE45-SRYCD(IDX4) = CONS-IZONSYO2-COMMENT)
                   MOVE    108          TO  RECE45-SETCOMATFLG(IDX4)
                 END-IF
      *
           END-IF
      *
           .
       2101216-SETCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    【レセプト】（第三者行為）一部負担金金額置換コメント編集
      *****************************************************************
       2101217-ICHIBUCOM-HENSYU-SEC     SECTION.
      *
           MOVE    SPACE                  TO  WRK-INPUTCOMENT
           MOVE    SPACE                  TO  WRK-INPUTCOMENT2
           MOVE    ZERO                   TO  WRK-INPUTCOMENT-KIN
           MOVE    SPACE                  TO  WRK-INPUTCOMENT-KIN2
      *
           IF    ((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                  (SRY-SRYCD    (IDX2)(1:3)     =   "008"))
           AND   ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  )
      *
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             PERFORM 800-PTCOM-READ-SEC
             MOVE    PTCOM-INPUTCOMENT    TO  WRK-INPUTCOMENT
      *
             IF  WRK-INPUTCOMENT(1:12)  =  "一部負担額："
               MOVE  WRK-INPUTCOMENT(13:14)
                                          TO  WRK-INPUTCOMENT2
               IF  WRK-INPUTCOMENT2 = "　　　　　　　" OR SPACE
                 CONTINUE
               ELSE
                 PERFORM VARYING IDW7 FROM  1  BY  2
                          UNTIL  IDW7   >  14
                   COMPUTE  IDW8 = (IDW7 + 1) / 2
                   EVALUATE  WRK-INPUTCOMENT2(IDW7:2)
                     WHEN     "０"
                        MOVE   "0"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "１"
                        MOVE   "1"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "２"
                        MOVE   "2"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "３"
                        MOVE   "3"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "４"
                        MOVE   "4"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "５"
                        MOVE   "5"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "６"
                        MOVE   "6"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "７"
                        MOVE   "7"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "８"
                        MOVE   "8"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "９"
                        MOVE   "9"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     OTHER
                        MOVE    14  TO  IDW7
                   END-EVALUATE
                 END-PERFORM
                 IF  WRK-INPUTCOMENT-KIN2-T NOT = SPACE
                   MOVE    8    TO   IDW8
                   PERFORM VARYING IDW7 FROM  7  BY -1
                            UNTIL  IDW7   <   1
                     IF  WRK-INPUTCOMENT-KIN2-T(IDW7:1) = SPACE
                        CONTINUE
                     ELSE
                        COMPUTE  IDW8 = IDW8 - 1
                        MOVE  WRK-INPUTCOMENT-KIN2-T(IDW7:1)
                                TO   WRK-INPUTCOMENT-KIN-T(IDW8:1)
                     END-IF
                   END-PERFORM
                   MOVE    1    TO   RECE41-DAISAN-CHIKAN
                   MOVE  WRK-INPUTCOMENT-KIN
                                TO   RECE41-FTNMONEY
                 END-IF
               END-IF
             END-IF
      *
           END-IF
      *
           .
       2101217-ICHIBUCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    【レセプト】（自賠責）受領金額欄置換コメント編集
      *****************************************************************
       2101218-ICHIBUCOM-HENSYU2-SEC     SECTION.
      *
           MOVE    SPACE                  TO  WRK-INPUTCOMENT
           MOVE    SPACE                  TO  WRK-INPUTCOMENT2
           MOVE    SPACE                  TO  WRK-INPUTCOMENT3
           MOVE    ZERO                   TO  WRK-INPUTCOMENT-KIN
           MOVE    SPACE                  TO  WRK-INPUTCOMENT-KIN2
      *
           IF    ((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                  (SRY-SRYCD    (IDX2)(1:3)     =   "008"))
           AND   ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  )
      *
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             PERFORM 800-PTCOM-READ-SEC
             MOVE    PTCOM-INPUTCOMENT    TO  WRK-INPUTCOMENT
      *
             IF  WRK-INPUTCOMENT(1:10)  =  "受領金額："
               MOVE  WRK-INPUTCOMENT(11:14)
                                          TO  WRK-INPUTCOMENT2
               IF  WRK-INPUTCOMENT2 = "　　　　　　　" OR SPACE
                 CONTINUE
               ELSE
                 PERFORM VARYING IDW7 FROM  1  BY  2
                          UNTIL  IDW7   >  14
                   COMPUTE  IDW8 = (IDW7 + 1) / 2
                   EVALUATE  WRK-INPUTCOMENT2(IDW7:2)
                     WHEN     "０"
                        MOVE   "0"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "１"
                        MOVE   "1"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "２"
                        MOVE   "2"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "３"
                        MOVE   "3"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "４"
                        MOVE   "4"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "５"
                        MOVE   "5"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "６"
                        MOVE   "6"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "７"
                        MOVE   "7"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "８"
                        MOVE   "8"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "９"
                        MOVE   "9"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     OTHER
                        MOVE    14  TO  IDW7
                   END-EVALUATE
                 END-PERFORM
                 IF  WRK-INPUTCOMENT-KIN2-T NOT = SPACE
                   MOVE    8    TO   IDW8
                   PERFORM VARYING IDW7 FROM  7  BY -1
                            UNTIL  IDW7   <   1
                     IF  WRK-INPUTCOMENT-KIN2-T(IDW7:1) = SPACE
                        CONTINUE
                     ELSE
                        COMPUTE  IDW8 = IDW8 - 1
                        MOVE  WRK-INPUTCOMENT-KIN2-T(IDW7:1)
                                TO   WRK-INPUTCOMENT-KIN-T(IDW8:1)
                     END-IF
                   END-PERFORM
                   MOVE    1    TO   RECE41-JIBAI-CHIKANKINFLG
                   MOVE  WRK-INPUTCOMENT-KIN
                                TO   RECE41-JIBAI-CHIKANKIN
                 END-IF
               END-IF
             END-IF
      *
             IF  WRK-INPUTCOMENT(1:8)  =  "支払元："
               MOVE  WRK-INPUTCOMENT(9:30)
                                          TO  WRK-INPUTCOMENT3
               IF  WRK-INPUTCOMENT3 =
                   "　　　　　　　　　　　　　　　" OR SPACE
                 CONTINUE
               ELSE
                 MOVE    1      TO   RECE41-JIBAI-CHIKANNAMEFLG
                 MOVE  WRK-INPUTCOMENT3
                                TO   RECE41-JIBAI-CHIKANNAME
               END-IF
             END-IF
      *
           END-IF
      *
           .
       2101218-ICHIBUCOM-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    明細数等の編集
      *****************************************************************
       2101219-MEISAISU-HENSYU-SEC                 SECTION.
      *
           COMPUTE   RECE44-MEISAISU    =  RECE44-MEISAISU
                                        -  1
           MOVE      SRY-SRYCD(IDX2)   TO  WRK-SRYCD
           COMPUTE   RECE44-SRYCDTOTAL  =  RECE44-SRYCDTOTAL
                                        -  WRK-SRYCD
           IF   (ACCT-SRYKBN = "40" OR "50" OR "54" OR "60" OR
                               "64" OR "70" OR "80"           )
           AND  (ACCT-YKZTEN =  ZERO                          )
           AND  (SRY-SRYCD(IDX2)(1:1)  =  "6"                 )
              COMPUTE   RECE44-SURYOUTOTAL =  RECE44-SURYOUTOTAL
                                           -  SRY-SRYSURYO(IDX2)
           ELSE
              COMPUTE   RECE44-SURYOUTOTAL =  RECE44-SURYOUTOTAL
                                           -  1
           END-IF
      *
           .
       2101219-MEISAISU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送
      *****************************************************************
       210122-RECE41-HENSYU-SEC               SECTION.
      *
      *    処方減回数の初期化
           MOVE   ZERO              TO   WRK-SYOHOU-KAISU
      *    処方せん減回数の初期化
           MOVE   ZERO              TO   WRK-SYOSEN-KAISU
      *    処方料（麻・向・毒・覚）の算定回数減算用領域の初期化
           MOVE   ZERO              TO   WRK-MADOKU-SHOHO
      *
           MOVE   ZERO              TO   WK-ZAIKAISU
           MOVE   ZERO              TO   WK-ZAITEN
           MOVE   ZERO              TO   WK-SYUTEN
           MOVE   ZERO              TO   WK-KIZAITEN
           MOVE   ZERO              TO   WK-YKZTEN
      *
           PERFORM   VARYING  IDX3   FROM   1   BY   1
                     UNTIL    (IDX3         >     5)        OR
                              (SRY-SRYCD(IDX3)   =   SPACE)
               IF    SRY-RENNUM     =     1
                   IF  IDX3         =     1
                       IF      RECE41-HKNKBN   NOT  =   "3"
                          MOVE  ACCT-ZAIKAISU     TO   WK-ZAIKAISU
                       ELSE
                          MOVE  WRK-ZAIKAISU-XXX  TO   WK-ZAIKAISU
                       END-IF 
                       MOVE  ACCT-ZAITEN       TO   WK-ZAITEN
                       IF   RECE41-HKNKBN    NOT  =  "4" AND "6"
                         IF    SRY-SRYKBN  =  "31" OR "32" OR "33" OR
                                              "40" OR "50" OR "54" OR
                                              "60" OR "70" OR "80" OR
                                              "64"
                                  MOVE   ACCT-SYUTEN1   TO   WK-SYUTEN
                                  COMPUTE   WK-YKZTEN =
                                                      ACCT-KIZAITEN  +
                                                      ACCT-YKZTEN
                         END-IF
                       ELSE                                             
                         IF    SRY-SRYKBN  =  "31" OR "32" OR "33" OR
                                              "40" OR "50" OR "54" OR
                                              "60" OR "70" OR "80" OR
                                              "64"
                                  MOVE   ACCT-SYUTEN1   TO   WK-SYUTEN  
                                  COMPUTE   WK-YKZTEN =                 
                                                      ACCT-KIZAITEN  +  
                                                      ACCT-YKZTEN       
                                  IF  SRY-SRYKBN  =  "70"
                                     COMPUTE  WK-SYUTEN  =  WK-SYUTEN
                                                         -  ACCT-SYUTEN2
                                     COMPUTE  WK-YKZTEN  =  WK-YKZTEN
                                                         +  ACCT-SYUTEN2
                                  END-IF
                                  IF  WRK-YOUBUKASAN  NOT =  ZERO
                                   COMPUTE  WK-SYUTEN  = WK-SYUTEN
                                                       - WRK-YOUBUKASAN
                                   COMPUTE  WK-YKZTEN  = WK-YKZTEN
                                                       + WRK-YOUBUKASAN
                                  END-IF
                                  IF  WRK-KYOBUKASAN  NOT =  ZERO
                                   COMPUTE  WK-SYUTEN  = WK-SYUTEN
                                                       - WRK-KYOBUKASAN
                                   COMPUTE  WK-YKZTEN  = WK-YKZTEN
                                                       + WRK-KYOBUKASAN
                                  END-IF
                                  IF  WRK-KEIBUKASAN  NOT =  ZERO
                                   COMPUTE  WK-SYUTEN  = WK-SYUTEN
                                                       - WRK-KEIBUKASAN
                                   COMPUTE  WK-YKZTEN  = WK-YKZTEN
                                                       + WRK-KEIBUKASAN
                                  END-IF
                                  IF  WRK-SOGAIKASAN  NOT =  ZERO
                                   COMPUTE  WK-SYUTEN  = WK-SYUTEN
                                                       - WRK-SOGAIKASAN
                                   COMPUTE  WK-YKZTEN  = WK-YKZTEN
                                                       + WRK-SOGAIKASAN
                                  END-IF
                                  IF  WRK-RYOYOTEATE  NOT =  ZERO
                                   IF ((RECE41-HKNKBN     =  "4") AND
                                       (RECE41-JIBAIKBN   =  "2"))
                                   OR ( RECE41-HKNKBN     =  "6" )
                                    COMPUTE WK-SYUTEN  = WK-SYUTEN
                                                       - WRK-RYOYOTEATE
                                    COMPUTE WK-YKZTEN  = WK-YKZTEN
                                                       + WRK-RYOYOTEATE
                                   END-IF
                                  END-IF
                         END-IF
                       END-IF                                           
                       IF    SRY-SRYKBN     =  "14"
                           MOVE    ACCT-SYUTEN1   TO   WK-SYUTEN
                           MOVE    ACCT-KIZAITEN  TO   WK-KIZAITEN
                           MOVE    ACCT-YKZTEN    TO   WK-YKZTEN
                           IF   RECE41-HKNKBN   =  "4" OR "6"
                             IF  WRK-YOUBUKASAN  NOT =  ZERO
                                COMPUTE  WK-SYUTEN   =  WK-SYUTEN
                                                     -  WRK-YOUBUKASAN
                                COMPUTE  WK-KIZAITEN =  WK-KIZAITEN
                                                     +  WRK-YOUBUKASAN
                             END-IF
                             IF  WRK-KYOBUKASAN  NOT =  ZERO
                                COMPUTE  WK-SYUTEN   =  WK-SYUTEN
                                                     -  WRK-KYOBUKASAN
                                COMPUTE  WK-KIZAITEN =  WK-KIZAITEN
                                                     +  WRK-KYOBUKASAN
                             END-IF
                             IF  WRK-KEIBUKASAN  NOT =  ZERO
                                COMPUTE  WK-SYUTEN   =  WK-SYUTEN
                                                     -  WRK-KEIBUKASAN
                                COMPUTE  WK-KIZAITEN =  WK-KIZAITEN
                                                     +  WRK-KEIBUKASAN
                             END-IF
                             IF  WRK-SOGAIKASAN  NOT =  ZERO
                                COMPUTE  WK-SYUTEN   =  WK-SYUTEN
                                                     -  WRK-SOGAIKASAN
                                COMPUTE  WK-KIZAITEN =  WK-KIZAITEN
                                                     +  WRK-SOGAIKASAN
                             END-IF
                           END-IF
                       END-IF
                   ELSE
                       IF ( SRY-SRYKBN   =  "21"  OR  "22"  OR  "23" OR
                                            "31"  OR  "32"  OR  "33" OR
                                            "40"  OR  "50"  OR  "54" OR
                                            "60"  OR  "70"  OR  "80" OR
                                            "13"  OR  "14"  OR  "64" OR
                                            "25"                     )
                       OR ((ACCT-ZAIKBN  =   2  ) AND
                           (SRY-SRYKBN   =  "12"))
                           MOVE  ZERO          TO   WK-ZAIKAISU
                           MOVE  ZERO          TO   WK-ZAITEN
                           MOVE  ZERO          TO   WK-SYUTEN
                           MOVE  ZERO          TO   WK-KIZAITEN
                           MOVE  ZERO          TO   WK-YKZTEN
                           MOVE  ZERO          TO   FLG-OSINKBN
                       END-IF
                   END-IF
               ELSE
                     MOVE    ZERO     TO    WK-ZAIKAISU
                     MOVE    ZERO     TO    WK-ZAITEN
                     MOVE    ZERO     TO    WK-SYUTEN
                     MOVE    ZERO     TO    WK-KIZAITEN
                     MOVE    ZERO     TO    WK-YKZTEN
                     MOVE    ZERO     TO    FLG-OSINKBN
               END-IF
               IF  ((ACCT-ZAITEN    NOT =    ZERO) AND
                    (ACCT-ZAIKAISU  NOT =    ZERO))
               OR  ( FLG-TAISYO         =     1   )
                  EVALUATE   RECE41-HKNKBN
                    WHEN       "1"
                    WHEN       "2"
                        PERFORM   2101221-RECE-LEFT-SET-SEC
                    WHEN       "3"
                        PERFORM   2101222-RECE-LEFT-SET2-SEC
                    WHEN       "4"
                        EVALUATE  WRK-PARA-RECEKBN
                          WHEN      "4"
      ********************* （新様式）
                            PERFORM   2101223-RECE-LEFT-SET3-SEC
                          WHEN      "5"
      ********************* （従来様式）
                            PERFORM   2101224-RECE-LEFT-SET4-SEC
                        END-EVALUATE
                    WHEN       "5"
                        PERFORM   2101225-RECE-LEFT-SET5-SEC
                    WHEN       "6"
                        PERFORM   2101224-RECE-LEFT-SET4-SEC
                  END-EVALUATE
               END-IF
               IF  ( SRY-SRYKBN   =  "21"   OR   "22"   OR   "23"   OR
                                     "31"   OR   "32"   OR   "33"   OR
                                     "40"   OR   "50"   OR   "54"   OR
                                     "60"   OR   "70"   OR   "14"   OR
                                     "64"          )
               OR  ((ACCT-ZAIKBN  =    2          ) AND
                    (SRY-SRYKBN   =   "12" OR "13"))
                     MOVE    6      TO    IDX3
               END-IF
           END-PERFORM
      *
           EVALUATE   RECE41-HKNKBN
             WHEN       "1"
             WHEN       "2"
      *         処方の算定回数から減算
                COMPUTE    RECE41-KAISU(19)   =    RECE41-KAISU(19)
                                              -    WRK-SYOHOU-KAISU
      *         処方せんの算定回数から減算
                COMPUTE    RECE41-KAISU(33)   =    RECE41-KAISU(33)
                                              -    WRK-SYOSEN-KAISU
      *         麻毒の算定回数から処方料（麻・向・毒・覚）の減算
                COMPUTE    RECE41-KAISU(20)   =    RECE41-KAISU(20)
                                              -    WRK-MADOKU-SHOHO
             WHEN       "3"
      *         処方の算定回数から減算
                COMPUTE    RECE41-KAISU(12)   =    RECE41-KAISU(12)
                                              -    WRK-SYOHOU-KAISU
      *         処方せんの算定回数から減算
                COMPUTE    RECE41-KAISU(30)   =    RECE41-KAISU(30)
                                              -    WRK-SYOSEN-KAISU
      *         麻毒の算定回数から処方料（麻・向・毒・覚）の減算
                COMPUTE    RECE41-KAISU(13)   =    RECE41-KAISU(13)
                                              -    WRK-MADOKU-SHOHO
             WHEN       "4"
                EVALUATE  WRK-PARA-RECEKBN
                  WHEN      "4"
      **************（新様式）
                   IF   WRK-PARA-JIBAIPRTKBN  =  "2"
      *             処方の算定回数から減算
                    COMPUTE    RECE41-KAISU(14)  =  RECE41-KAISU(14)
                                                 -  WRK-SYOHOU-KAISU
      *             処方せんの算定回数から減算
                    COMPUTE    RECE41-KAISU(31)  =  RECE41-KAISU(31)
                                                 -  WRK-SYOSEN-KAISU
      *             麻毒の算定回数から処方料（麻・向・毒・覚）の減算
                    COMPUTE    RECE41-KAISU(15)  =  RECE41-KAISU(15)
                                                 -  WRK-MADOKU-SHOHO
                   ELSE
      *             処方の算定回数から減算
                    COMPUTE    RECE41-KAISU(14)  =  RECE41-KAISU(14)
                                                 -  WRK-SYOHOU-KAISU
      *             処方せんの算定回数から減算
                    COMPUTE    RECE41-KAISU(33)  =  RECE41-KAISU(33)
                                                 -  WRK-SYOSEN-KAISU
      *             麻毒の算定回数から処方料（麻・向・毒・覚）の減算
                    COMPUTE    RECE41-KAISU(15)  =  RECE41-KAISU(15)
                                                 -  WRK-MADOKU-SHOHO
                   END-IF
                  WHEN      "5"
      **************（従来様式）
      *             処方の算定回数から減算
                    COMPUTE    RECE41-KAISU(15)  =  RECE41-KAISU(15)
                                                 -  WRK-SYOHOU-KAISU
      *             処方せんの算定回数から減算
                    COMPUTE    RECE41-KAISU(35)  =  RECE41-KAISU(35)
                                                 -  WRK-SYOSEN-KAISU
      *             麻毒の算定回数から処方料（麻・向・毒・覚）の減算
                    COMPUTE    RECE41-KAISU(16)  =  RECE41-KAISU(16)
                                                 -  WRK-MADOKU-SHOHO
                END-EVALUATE
             WHEN       "5"
      *         処方の算定回数から減算
                COMPUTE    RECE41-KAISU(22)   =    RECE41-KAISU(22)
                                              -    WRK-SYOHOU-KAISU
      *         処方せんの算定回数から減算
                COMPUTE    RECE41-KAISU(36)   =    RECE41-KAISU(36)
                                              -    WRK-SYOSEN-KAISU
      *         麻毒の算定回数から処方料（麻・向・毒・覚）の減算
                COMPUTE    RECE41-KAISU(23)   =    RECE41-KAISU(23)
                                              -    WRK-MADOKU-SHOHO
             WHEN       "6"
      *         処方の算定回数から減算
                COMPUTE    RECE41-KAISU(15)   =    RECE41-KAISU(15)
                                              -    WRK-SYOHOU-KAISU
      *         処方せんの算定回数から減算
                COMPUTE    RECE41-KAISU(35)   =    RECE41-KAISU(35)
                                              -    WRK-SYOSEN-KAISU
      *         麻毒の算定回数から処方料（麻・向・毒・覚）の減算
                COMPUTE    RECE41-KAISU(16)   =    RECE41-KAISU(16)
                                              -    WRK-MADOKU-SHOHO
           END-EVALUATE
      *
           .
      *
       210122-RECE41-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送
      *****************************************************************
       2101221-RECE-LEFT-SET-SEC               SECTION.
      *
           EVALUATE    SRY-SRYKBN
      *    初診のレセ点数欄の編集
               WHEN    "11"
                   IF   WRK-TNS-DATAKBN(IDX3)  =   2
                     EVALUATE    WRK-TNS-TIMEKSNKBN(IDX3)
                         WHEN    1
                         WHEN    5
                         WHEN    6
                             MOVE  "1"     TO   RECE41-SHOSHINTIME
                         WHEN    3
                             MOVE  "2"     TO   RECE41-SHOSHINTIME
                         WHEN    4
                             MOVE  "3"     TO   RECE41-SHOSHINTIME
                     END-EVALUATE
                     COMPUTE    RECE41-TENSU(1)  =
                                RECE41-TENSU(1)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF
                   IF   SRY-SRYCD(IDX3) = CONS-ROUSAI1 OR
                                          CONS-ROUSAI18
                        COMPUTE    RECE41-KINGAKU2(1)  =
                                   RECE41-KINGAKU2(1)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF  
                   IF  (SRY-SRYCD(IDX3) = CONS-ROUSAI3)
                   AND (RECE41-SRYYM   <=   "201306"  )
                        COMPUTE    RECE41-KINGAKU2(4)  =
                                   RECE41-KINGAKU2(4)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF  
      *    再診のレセ点数欄の編集（集計方法変更後）
               WHEN    "12"
                 EVALUATE  WRK-TNS-GAITENTTLKBN(IDX3)
      *      （基本手技）
                   WHEN  120
                     IF ((SRY-SRYCD(IDX3) =  CONS-ROUSAI5  OR
                                             CONS-ROUSAI6  OR
                                             CONS-ROUSAI7  OR
                                             CONS-ROUSAI19) AND
                         (RECE41-SRYYM   <=    "201306"   ))
                     OR ((SRY-SRYCD(IDX3) =  CONS-ROUSAI34 OR
                                             CONS-ROUSAI35 OR
                                             CONS-ROUSAI36 OR
                                             CONS-ROUSAI37 OR
                                             CONS-ROUSAI38 OR
                                             CONS-ROUSAI5 ) AND
                         (RECE41-SRYYM   >=    "201307"   ))
                         ADD   WK-ZAIKAISU      TO   RECE41-KAISU2(2)
                         COMPUTE    RECE41-KINGAKU2(2)  =
                                    RECE41-KINGAKU2(2)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     ELSE
                       IF     RECE41-SRYYM  >=  "201804"
                         IF    RECE41-KHNTEN(2) = ZERO
                           MOVE  WRK-TNS-TEN(IDX3) TO  RECE41-KHNTEN(2)
                         ELSE
                           IF  RECE41-KHNTEN(2) NOT = WRK-TNS-TEN(IDX3)
                             MOVE   ZERO     TO  RECE41-KHNTEN(2)
                             MOVE   1        TO  FLG-KHNTEN2
                           END-IF
                         END-IF
                       ELSE
                         IF  (SRY-SRYCD(IDX3) =  CONS-JIKANTAI1  OR
                                                 CONS-JIKANTAI2  OR
                                                 CONS-JIKANTAI3  OR
                                                 CONS-MESAIKSN   OR
                                                 CONS-CHIHOKATU  OR
                                                 CONS-CHIHOKAT2    )
                         AND (RECE41-SRYYM   >=  "201004"          )
                           IF  SRY-SRYCD(IDX3)  =  CONS-JIKANTAI1
                             COMPUTE  CNT-JIKANTAI1 = CNT-JIKANTAI1
                                                    + WK-ZAIKAISU
                             IF   FLG-JIKANTAI1-ARI  =  ZERO
                                ADD  WRK-TNS-TEN(IDX3)
                                               TO  RECE41-KHNTEN(2)
                                MOVE     1     TO  FLG-JIKANTAI1-ARI
                             END-IF
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  CONS-JIKANTAI2
                             COMPUTE  CNT-JIKANTAI2 = CNT-JIKANTAI2
                                                    + WK-ZAIKAISU
                             IF   FLG-JIKANTAI2-ARI   =  ZERO
                                ADD  WRK-TNS-TEN(IDX3)
                                               TO  RECE41-KHNTEN(2)
                                MOVE     1     TO  FLG-JIKANTAI2-ARI
                             END-IF
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  CONS-JIKANTAI3
                             COMPUTE  CNT-JIKANTAI3 = CNT-JIKANTAI3
                                                    + WK-ZAIKAISU
                             IF   FLG-JIKANTAI3-ARI  =  ZERO
                                ADD  WRK-TNS-TEN(IDX3)
                                               TO  RECE41-KHNTEN(2)
                                MOVE     1     TO  FLG-JIKANTAI3-ARI
                             END-IF
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  CONS-MESAIKSN
                             COMPUTE  CNT-MESAIKSN =  CNT-MESAIKSN
                                                   +  WK-ZAIKAISU
                             IF   FLG-MESAIKSN-ARI   =  ZERO
                                ADD  WRK-TNS-TEN(IDX3)
                                               TO  RECE41-KHNTEN(2)
                                MOVE     1     TO  FLG-MESAIKSN-ARI
                             END-IF
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  CONS-CHIHOKATU
                             COMPUTE  CNT-CHIHOKATU = CNT-CHIHOKATU
                                                    + WK-ZAIKAISU
                             IF   FLG-CHIHOKATU-ARI  =  ZERO
                                ADD  WRK-TNS-TEN(IDX3)
                                               TO  RECE41-KHNTEN(2)
                                MOVE     1     TO  FLG-CHIHOKATU-ARI
                             END-IF
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  CONS-CHIHOKAT2
                             COMPUTE  CNT-CHIHOKAT2 = CNT-CHIHOKAT2
                                                    + WK-ZAIKAISU
                             IF   FLG-CHIHOKAT2-ARI  =  ZERO
                                ADD  WRK-TNS-TEN(IDX3)
                                               TO  RECE41-KHNTEN(2)
                                MOVE     1     TO  FLG-CHIHOKAT2-ARI
                             END-IF
                           END-IF
                         ELSE
                           IF   FLG-SAISIN-ARI   =  ZERO
                                ADD  WRK-TNS-TEN(IDX3)
                                               TO  RECE41-KHNTEN(2)
                                MOVE     1     TO  FLG-SAISIN-ARI
                           END-IF
                         END-IF
                       END-IF
                       IF   FLG-COUNT-ARI  =  ZERO
                         ADD    WK-ZAIKAISU   TO   RECE41-KAISU(2)
                         MOVE   1             TO   FLG-COUNT-ARI
                       END-IF
                       COMPUTE    RECE41-TENSU(2)  =
                                  RECE41-TENSU(2)  +
                                 (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     END-IF
      *
      *      （外来管理加算）
                   WHEN  122
                        IF    RECE41-KHNTEN(3)   =   ZERO
                           MOVE  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(3)
                        ELSE
                           IF RECE41-KHNTEN(3) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO  RECE41-KHNTEN(3)
                              MOVE   1    TO  FLG-KHNTEN3
                           END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(3)
                        COMPUTE    RECE41-TENSU(3)  =
                                   RECE41-TENSU(3)  +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （時間外）
                   WHEN  123
                        IF    RECE41-KHNTEN(4)   =   ZERO
                           MOVE  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(4)
                        ELSE
                           IF RECE41-KHNTEN(4) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO
                                            RECE41-KHNTEN(4)
                              MOVE   1    TO  FLG-KHNTEN4
                           END-IF
                        END-IF
                        ADD   WK-ZAIKAISU  TO
                                            RECE41-KAISU(4)
                        COMPUTE RECE41-TENSU(4) =
                                RECE41-TENSU(4) +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （休日）
                   WHEN  124
                        IF    RECE41-KHNTEN(5)   =   ZERO
                           MOVE  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(5)
                        ELSE
                           IF RECE41-KHNTEN(5) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO
                                            RECE41-KHNTEN(5)
                              MOVE   1     TO   FLG-KHNTEN5
                           END-IF
                        END-IF
                        ADD   WK-ZAIKAISU   TO
                                              RECE41-KAISU(5)
                        COMPUTE  RECE41-TENSU(5) =
                                 RECE41-TENSU(5) +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *       （深夜）
                   WHEN  125
                        IF    RECE41-KHNTEN(6)   =   ZERO
                           MOVE  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(6)
                        ELSE
                           IF RECE41-KHNTEN(6) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO
                                            RECE41-KHNTEN(6)
                              MOVE   1       TO   FLG-KHNTEN6
                           END-IF
                        END-IF
                        ADD   WK-ZAIKAISU  TO
                                            RECE41-KAISU(6)
                        COMPUTE  RECE41-TENSU(6) =
                                 RECE41-TENSU(6) +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *       （その他）
                   WHEN  OTHER 
                        IF  (SRY-SRYCD(IDX3) =  CONS-ROUSAI4)
                        AND (RECE41-SRYYM   <=  "201306"    )
                           ADD   WK-ZAIKAISU   TO   RECE41-KAISU2(3)
                           COMPUTE    RECE41-KINGAKU2(3)  =
                                      RECE41-KINGAKU2(3)  +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        END-IF
                        IF   ACCT-ZAIKBN     =  2
                           MOVE   ZERO         TO   RECE41-KHNTEN(2)
                           MOVE   1            TO   FLG-KHNTEN2
                           COMPUTE    WRK-RECE4G-TENSU(2)  =
                                      WRK-RECE4G-TENSU(2)  +
                                     (WK-ZAITEN   *   WK-ZAIKAISU)
                        END-IF
                 END-EVALUATE
      *    指導のレセ点数欄の編集
               WHEN    "13"
                 IF   (SRY-SRYCD(IDX3) =  CONS-ROUSAI33)
                 AND  (RECE41-SRYYM   >=  "201307"     )
                         ADD   WK-ZAIKAISU   TO   RECE41-KAISU2(3)
                         COMPUTE    RECE41-KINGAKU2(3)  =
                                    RECE41-KINGAKU2(3)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                 ELSE
                   IF ((SRY-SRYCD(IDX3) =
                        CONS-ROUSAI9  OR  CONS-ROUSAI10 OR
                        CONS-ROUSAI11 OR  CONS-ROUSAI12 OR
                        CONS-ROUSAI13 OR  CONS-ROUSAI14 OR
                        CONS-ROUSAI15 OR  CONS-ROUSAI16 OR
                        CONS-ROUSAI17                       ) AND
                       (RECE41-SRYYM    <=  "201306"        ))
                   OR ((SRY-SRYCD(IDX3)  =  CONS-ROUSAI8    ) AND
                       (RECE41-SRYYM     <  "200804"        ))
                         COMPUTE    RECE41-KINGAKU2(4)  =
                                    RECE41-KINGAKU2(4)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   ELSE
                     IF   ACCT-ZAIKBN     =  2
                         COMPUTE    WRK-RECE4G-TENSU(7)  =
                                    WRK-RECE4G-TENSU(7)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                         COMPUTE    RECE41-TENSU(7)  =
                                    RECE41-TENSU(7)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF                   
                 END-IF
      *
      *    在宅のレセ点数欄の編集
               WHEN    "14"
                 IF  ACCT-ZAIKBN   =    2
                   COMPUTE    WRK-RECE4G-TENSU(12)  =
                              WRK-RECE4G-TENSU(12)  +
                             (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   MOVE      ZERO            TO   FLG-ZAITAKU
      *            往診・特別往診（時間加算）
                   IF    FLG-OSINKBN         =   1
                       MOVE         1        TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(8)
                       COMPUTE   RECE41-TENSU(8)  =
                                 RECE41-TENSU(8)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            夜間
                   IF    FLG-OSINKBN         =    2
                       MOVE   1              TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(9)
                       COMPUTE   RECE41-TENSU(9)  =
                                 RECE41-TENSU(9)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            深夜・緊急
                   IF    FLG-OSINKBN         =    3
                       MOVE   1              TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(10)
                       COMPUTE   RECE41-TENSU(10)  =
                                 RECE41-TENSU(10)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            在宅患者訪問診療
                   IF (( WRK-TNS-OSINKBN(IDX3) =     1          )  AND
                       ((SRY-SRYCD(IDX3)   NOT =    "114000110")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001610")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114012070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029270")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030170")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030270")))
                   OR (  FLG-OSINKBN           =     9           )
                       MOVE   1              TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(11)
                       COMPUTE   RECE41-TENSU(11)  =
                                 RECE41-TENSU(11)  +
                                (WK-SYUTEN         * WK-ZAIKAISU)
                   END-IF
      *            その他
                   IF    FLG-ZAITAKU    =   ZERO
                       COMPUTE   RECE41-TENSU(12)  =
                                 RECE41-TENSU(12)  +
                                (WK-SYUTEN     *   WK-ZAIKAISU)
                   END-IF
      *            薬剤
                   COMPUTE   RECE41-TENSU(13)  =
                             RECE41-TENSU(13)  +
                             (WK-KIZAITEN *   WK-ZAIKAISU)  +
                             (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    投薬のレセ点数欄の編集
               WHEN    "21"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN
                                            OR CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU(14)  =
                                 RECE41-TENSU(14)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(14)
                       COMPUTE   RECE41-TENSU(14)  =
                                 RECE41-TENSU(14)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                     IF   SRY-SRYCD(IDX3)   =    CONS-FUNSAI-COMMENT
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(14)
                       COMPUTE   RECE41-TENSU(14)  =
                                 RECE41-TENSU(14)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE   
                       IF    RECE41-KHNTEN(15)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3)  TO  RECE41-KHNTEN(15)
                       ELSE
                          IF   RECE41-KHNTEN(15) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE41-KHNTEN(15)
                               MOVE   1       TO    FLG-KHNTEN15
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(15)
                       COMPUTE   RECE41-TENSU(15)  =
                                 RECE41-TENSU(15)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     END-IF   
                   END-IF
               WHEN    "22"
                 IF    SRY-SRYCD(IDX3)      =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                   COMPUTE   RECE41-TENSU(16)  =
                             RECE41-TENSU(16)  -
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU    TO   RECE41-KAISU(16)
                   COMPUTE   RECE41-TENSU(16)  =
                             RECE41-TENSU(16)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 END-IF
               WHEN    "23"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU(17)  =
                                 RECE41-TENSU(17)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(17)
                       COMPUTE   RECE41-TENSU(17)  =
                                 RECE41-TENSU(17)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                       IF    RECE41-KHNTEN(18)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3)  TO  RECE41-KHNTEN(18)
                       ELSE
                          IF   RECE41-KHNTEN(18) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE41-KHNTEN(18)
                               MOVE   1       TO    FLG-KHNTEN18
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(18)
                       COMPUTE   RECE41-TENSU(18)  =
                                 RECE41-TENSU(18)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF
      *    処方のレセ点数欄の編集
               WHEN    "25"
                   IF  SRY-SRYCD(IDX3) = "120002170" OR "120002270" OR
                                         "120003170" OR "120003370" OR
                                         "120003870" OR
                                         "120004070" OR "120004170" OR
                                         "120004370" OR "120004470"
                      COMPUTE  WRK-SYOHOU-KAISU  =  WRK-SYOHOU-KAISU
                                                 +  ACCT-ZAIKAISU
                   END-IF
                   IF    WK-ZAITEN   NOT =  ZERO
                     IF    RECE41-KHNTEN(19)     = ZERO
                      MOVE  WK-ZAITEN     TO   RECE41-KHNTEN(19)
                     ELSE
                      IF   RECE41-KHNTEN(19) NOT = WK-ZAITEN
                            MOVE   ZERO   TO   RECE41-KHNTEN(19)
                            MOVE   1      TO   FLG-KHNTEN19
                      END-IF
                     END-IF
                   END-IF
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    ACCT-ZAIKAISU   TO    RECE41-KAISU(19)
                   END-IF
                   COMPUTE   RECE41-TENSU(19)  =
                             RECE41-TENSU(19)  +
                            (WK-ZAITEN   *   ACCT-ZAIKAISU)
      *    麻毒のレセ点数欄の編集
               WHEN    "26"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE41-KAISU(20)
                   END-IF
                   IF SRY-SRYCD(IDX3)      =    "120001310"
                    COMPUTE WRK-MADOKU-SHOHO = WRK-MADOKU-SHOHO +
                                               WK-ZAIKAISU 
                   END-IF
                   COMPUTE   RECE41-TENSU(20)  =
                             RECE41-TENSU(20)  +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *    調基のレセ点数欄の編集
               WHEN    "27"
                   COMPUTE   RECE41-TENSU(21)  =
                             RECE41-TENSU(21)  +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *    皮下筋肉内注射のレセ点数欄の編集
               WHEN    "31"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(22)
                   COMPUTE   RECE41-TENSU(22)  =
                             RECE41-TENSU(22)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
      *    静脈内注射のレセ点数欄の編集
               WHEN    "32"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(23)
                   COMPUTE   RECE41-TENSU(23)  =
                             RECE41-TENSU(23)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
      *    その他注射のレセ点数欄の編集
               WHEN    "33"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(24)
                   COMPUTE   RECE41-TENSU(24)  =
                             RECE41-TENSU(24)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
      *    処置のレセ点数欄の編集
               WHEN    "40"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(25)
                   END-IF
                   COMPUTE   RECE41-TENSU(25)  =
                             RECE41-TENSU(25)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(26)  =
                             RECE41-TENSU(26)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    手術のレセ点数欄の編集
               WHEN    "50"
               WHEN    "54"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(27)
                   END-IF
                   COMPUTE   RECE41-TENSU(27)  =
                             RECE41-TENSU(27)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(28)  =
                             RECE41-TENSU(28)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    検査のレセ点数欄の編集
               WHEN    "60"
               WHEN    "64"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(29)
                   END-IF
                   COMPUTE   RECE41-TENSU(29)  =
                             RECE41-TENSU(29)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    WRK-TNS-KNSJISKBN(IDX3)    =   2
                         COMPUTE   RECE41-KAISU(29)  =
                                   RECE41-KAISU(29)  -  
                                   WK-ZAIKAISU
                   END-IF
                   IF    WRK-TNS-SRYCD(IDX3)  =   CONS-SAIKETSU1  OR
                                                  CONS-SAIKETSU2  OR
                                                  CONS-SAIKETSU3
                         IF   RECE41-KAISU(29)  NOT =  ZERO
                              COMPUTE   RECE41-KAISU(29)  =
                                        RECE41-KAISU(29)  -   
                                        WK-ZAIKAISU
                         END-IF
                   END-IF
                   COMPUTE   RECE41-TENSU(30)  =
                             RECE41-TENSU(30)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    画像診断のレセ点数欄の編集
               WHEN    "70"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(31)
                   END-IF
                   COMPUTE   RECE41-TENSU(31)  =
                             RECE41-TENSU(31)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(32)  =
                             RECE41-TENSU(32)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    その他のレセ点数欄の編集
               WHEN    "80"
                 IF   ((SRY-SRYCD(IDX3) =
                        CONS-ROUSAI32 OR
                        CONS-ROUSAI20 OR  CONS-ROUSAI21 OR
                        CONS-ROUSAI22 OR  CONS-ROUSAI23 OR
                        CONS-ROUSAI24 OR  CONS-ROUSAI25 OR
                        CONS-ROUSAI26 OR  CONS-ROUSAI27 OR
                        CONS-ROUSAI28 OR  CONS-ROUSAI29 OR
                        CONS-ROUSAI30 OR  CONS-ROUSAI31 OR
                        CONS-ROUSAI39                       ) AND
                       (RECE41-SRYYM    >=  "201307"        ))
                       COMPUTE    RECE41-KINGAKU2(4)  =
                                  RECE41-KINGAKU2(4)  +
                                 (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                 ELSE
                   IF ((ACCT-SRYKBN          =  "80"    )  AND
                       (SRY-SRYCD(IDX3)(1:5) =  "09593" ))
                   OR ((SRY-SRYCD(IDX3) >= "101801010" AND
                                        <= "101801020"  )  AND
                       (RECE41-SRYYM    >= "201307"     ))
                   OR ((SRY-SRYCD(IDX3)  = "101801030"  )  AND
                       (RECE41-SRYYM    >= "201307"     ))
                     IF   SRY-SRYCD(IDX3)(1:5) = "09593"
                       COMPUTE    RECE41-KINGAKU2(4)  =                 
                                  RECE41-KINGAKU2(4)  +                 
                                 (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)  
                       IF   FLG-TAISYO   =   1
                          COMPUTE WRK-ZAITENNASHI  =
                                  WRK-ZAITENNASHI  +
                                 (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       END-IF
                     ELSE
                       IF  SRY-SRYCD(IDX3)  =  "101801030"
                         COMPUTE  WRK-FUTANWARI  =
                                  WRK-TNS-TEN(IDX3) / 100
                         COMPUTE  WRK-KEISAN-KG2 =
                                 (WRK-TEN-KG2       * WRK-FUTANWARI)
                         COMPUTE  RECE41-KINGAKU2(4)  =
                                  RECE41-KINGAKU2(4)  +
                                 (WRK-KEISAN-KG2    * ACCT-ZAIKAISU)
                       ELSE
                         COMPUTE  RECE41-KINGAKU2(4)  =
                                  RECE41-KINGAKU2(4)  +
                                 (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                         COMPUTE  WRK-TEN-KG2 = WRK-TNS-TEN(IDX3)
                       END-IF
                     END-IF
                   ELSE               
                    IF  SRY-SRYCD(IDX3) =  CONS-SHOHOKSN1
                                        OR CONS-SHOHOKSN2
                                        OR CONS-SHOHOKSN3
                                        OR CONS-SHOHOKSN4
                                        OR CONS-SHOHOKSN5
                                        OR CONS-SHOHOKSN6
                                        OR CONS-SHOHOKSN7
                                        OR CONS-SHOHOKSN8
                       COMPUTE  WRK-SYOSEN-KAISU  =  WRK-SYOSEN-KAISU
                                                  +  ACCT-ZAIKAISU
                    END-IF
                    IF   SRY-SRYCD(IDX3)   =  CONS-SHOHOSEN1 OR
                                              CONS-SHOHOSEN2 OR
                                              CONS-SHOHOSEN3 OR
                                              CONS-SHOHOSEN4 OR
                                              CONS-SHOHOSEN5 OR
                                              CONS-SHOHOKSN1 OR
                                              CONS-SHOHOKSN2 OR
                                              CONS-SHOHOKSN3 OR
                                              CONS-SHOHOKSN4 OR
                                              CONS-SHOHOKSN5 OR
                                              CONS-SHOHOKSN6 OR
                                              CONS-SHOHOKSN7 OR
                                              CONS-SHOHOKSN8
                         ADD  ACCT-ZAIKAISU  TO  RECE41-KAISU(33)
                         COMPUTE   RECE41-TENSU(33)  =
                                   RECE41-TENSU(33)  +
                                  (WK-ZAITEN  *   ACCT-ZAIKAISU)
                    ELSE
                         COMPUTE   RECE41-TENSU(34)  =
                                   RECE41-TENSU(34)  +
                                  (WK-SYUTEN  *   ACCT-ZAIKAISU)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE41-TENSU(7)  =
                                     RECE41-TENSU(7)  +
                                    (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                           COMPUTE   RECE41-TENSU(34) =
                                     RECE41-TENSU(34) -
                                    (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                         END-IF
                    END-IF
                    COMPUTE   RECE41-TENSU(35)  =
                              RECE41-TENSU(35)  +
                             (WK-YKZTEN   *   ACCT-ZAIKAISU)
                   END-IF
                 END-IF
           END-EVALUATE
      *
           .
      *
       2101221-RECE-LEFT-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送
      *****************************************************************
       2101222-RECE-LEFT-SET2-SEC               SECTION.
      *
           EVALUATE    SRY-SRYKBN
      *    初診のレセ点数欄の編集
               WHEN    "11"
                   IF   WRK-TNS-DATAKBN(IDX3)  =   2
                     EVALUATE    WRK-TNS-TIMEKSNKBN(IDX3)
                         WHEN    1
                         WHEN    5
                         WHEN    6
                             MOVE  "1"     TO   RECE41-SHOSHINTIME
                         WHEN    3
                             MOVE  "2"     TO   RECE41-SHOSHINTIME
                         WHEN    4
                             MOVE  "3"     TO   RECE41-SHOSHINTIME
                     END-EVALUATE
                     IF   SRY-SRYCD(IDX3) = "111012370"
                       CONTINUE
                     ELSE
                       ADD   WK-ZAIKAISU   TO   RECE41-KAISU(1)
                     END-IF
                     COMPUTE    RECE41-TENSU(1)  =
                                RECE41-TENSU(1)  +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                   END-IF
                   IF   SRY-SRYCD(IDX3) = CONS-ROUSAI1 OR
                                          CONS-ROUSAI18
                        COMPUTE    RECE41-KINGAKU2(1)  =
                                   RECE41-KINGAKU2(1)  +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                        MOVE    RECE41-TEKSTYMD    
                                           TO   RECE41-SYOSAIYMD2(1)
                   END-IF  
      *    再診のレセ点数欄の編集（集計方法変更後）
               WHEN    "12"
                 EVALUATE  WRK-TNS-GAITENTTLKBN(IDX3)
      *      （基本手技）
                   WHEN  120
                     IF ((SRY-SRYCD(IDX3) =  CONS-ROUSAI5  OR
                                             CONS-ROUSAI6  OR
                                             CONS-ROUSAI7  OR
                                             CONS-ROUSAI19) AND
                         (RECE41-SRYYM   <=    "201306"   ))
                     OR ((SRY-SRYCD(IDX3) =  CONS-ROUSAI34 OR
                                             CONS-ROUSAI35 OR
                                             CONS-ROUSAI36 OR
                                             CONS-ROUSAI37 OR
                                             CONS-ROUSAI38 OR
                                             CONS-ROUSAI5 ) AND
                         (RECE41-SRYYM   >=    "201307"   ))
                         COMPUTE    RECE41-KINGAKU2(2)  =
                                    RECE41-KINGAKU2(2)  +
                                 (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                         MOVE    RECE41-TEKSTYMD    
                                           TO   RECE41-SYOSAIYMD2(2)
                     ELSE
                         IF      RECE41-KEIZOKU-PRTKBN     =   "2"
                            COMPUTE    RECE41-TENSU(3)  =
                                       RECE41-TENSU(3)  +
                                 (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                         ELSE
                            IF   FLG-COUNT-ARI  =  ZERO
                              ADD   WK-ZAIKAISU  TO  RECE41-KAISU(2)
                              MOVE  1            TO  FLG-COUNT-ARI
                            END-IF
                            COMPUTE    RECE41-TENSU(2)  =
                                       RECE41-TENSU(2)  +
                                 (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                         END-IF
                     END-IF
      *      （時間外）
                   WHEN  123
                     IF      RECE41-KEIZOKU-PRTKBN     =   "2"
                        MOVE  "1"     TO   RECE41-SAISHINTIME 
                        IF   FLG-COUNT-ARI  =  ZERO
                              ADD   WK-ZAIKAISU  TO  RECE41-KAISU(4)
                              MOVE  1            TO  FLG-COUNT-ARI
                        END-IF
                        COMPUTE RECE41-TENSU(4) =
                                RECE41-TENSU(4) +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                     ELSE
                        MOVE  "1"     TO   RECE41-SAISHINTIME 
                        IF   FLG-COUNT-ARI  =  ZERO
                              ADD   WK-ZAIKAISU  TO  RECE41-KAISU(2)
                              MOVE  1            TO  FLG-COUNT-ARI
                        END-IF
                        COMPUTE RECE41-TENSU(2) =
                                RECE41-TENSU(2) +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                     END-IF
      *      （休日）
                   WHEN  124
                     IF      RECE41-KEIZOKU-PRTKBN     =   "2"
                        MOVE  "2"     TO   RECE41-SAISHINTIME 
                        IF   FLG-COUNT-ARI  =  ZERO
                              ADD   WK-ZAIKAISU  TO  RECE41-KAISU(4)
                              MOVE  1            TO  FLG-COUNT-ARI
                        END-IF
                        COMPUTE RECE41-TENSU(4) =
                                RECE41-TENSU(4) +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                     ELSE
                        MOVE  "2"     TO   RECE41-SAISHINTIME 
                        IF   FLG-COUNT-ARI  =  ZERO
                              ADD   WK-ZAIKAISU  TO  RECE41-KAISU(2)
                              MOVE  1            TO  FLG-COUNT-ARI
                        END-IF
                        COMPUTE RECE41-TENSU(2) =
                                RECE41-TENSU(2) +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                     END-IF
      *      （深夜）
                   WHEN  125
                     IF      RECE41-KEIZOKU-PRTKBN     =   "2"
                        MOVE  "3"     TO   RECE41-SAISHINTIME 
                        IF   FLG-COUNT-ARI  =  ZERO
                              ADD   WK-ZAIKAISU  TO  RECE41-KAISU(4)
                              MOVE  1            TO  FLG-COUNT-ARI
                        END-IF
                        COMPUTE RECE41-TENSU(4) =
                                RECE41-TENSU(4) +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                     ELSE
                        MOVE  "3"     TO   RECE41-SAISHINTIME 
                        IF   FLG-COUNT-ARI  =  ZERO
                              ADD   WK-ZAIKAISU  TO  RECE41-KAISU(2)
                              MOVE  1            TO  FLG-COUNT-ARI
                        END-IF
                        COMPUTE RECE41-TENSU(2) =
                                RECE41-TENSU(2) +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                     END-IF
      *      （その他）
                   WHEN  OTHER 
                     IF   ACCT-ZAIKBN     =  2
                        COMPUTE WRK-RECE4G-TENSU(3)  =
                                WRK-RECE4G-TENSU(3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                 END-EVALUATE
      *    指導のレセ点数欄の編集
               WHEN    "13"
                   IF   ACCT-ZAIKBN     =  2
                         COMPUTE    WRK-RECE4G-TENSU(5)  =
                                    WRK-RECE4G-TENSU(5)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                   ELSE
                         COMPUTE    RECE41-TENSU(5)  =
                                    RECE41-TENSU(5)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
      *
      *    在宅のレセ点数欄の編集
               WHEN    "14"
                 IF  ACCT-ZAIKBN   =    2
                   COMPUTE    WRK-RECE4G-TENSU(6)  =
                              WRK-RECE4G-TENSU(6)  +
                             (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   MOVE      ZERO            TO   FLG-ZAITAKU
      *            往診・特別往診（時間加算）
                   IF    FLG-OSINKBN         =   1
                       MOVE         1        TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(6)  =
                                 RECE41-TENSU(6)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            夜間
                   IF    FLG-OSINKBN         =    2
                       MOVE   1              TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(6)  =
                                 RECE41-TENSU(6)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            深夜・緊急
                   IF    FLG-OSINKBN         =    3
                       MOVE   1              TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(6)  =
                                 RECE41-TENSU(6)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            在宅患者訪問診療
                   IF (( WRK-TNS-OSINKBN(IDX3) =     1          )  AND
                       ((SRY-SRYCD(IDX3)   NOT =    "114000110")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001610")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114012070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029270")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030170")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030270")))
                   OR (  FLG-OSINKBN           =     9           )
                       MOVE   1              TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(6)  =
                                 RECE41-TENSU(6)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            その他
                   IF    FLG-ZAITAKU    =   ZERO
                       COMPUTE   RECE41-TENSU(6)  =
                                 RECE41-TENSU(6)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            薬剤
                   COMPUTE   RECE41-TENSU(6)  =
                             RECE41-TENSU(6)  +
                             (WK-KIZAITEN *   WK-ZAIKAISU)  +
                             (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    投薬のレセ点数欄の編集
               WHEN    "21"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN
                                            OR CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU(7)  =
                                 RECE41-TENSU(7)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(7)
                       COMPUTE   RECE41-TENSU(7)  =
                                 RECE41-TENSU(7)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                     IF   SRY-SRYCD(IDX3)   =    CONS-FUNSAI-COMMENT
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(7)
                       COMPUTE   RECE41-TENSU(7)  =
                                 RECE41-TENSU(7)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE   
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(8)
                       COMPUTE   RECE41-TENSU(8)  =
                                 RECE41-TENSU(8)  +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                     END-IF   
                   END-IF
               WHEN    "22"
                 IF    SRY-SRYCD(IDX3)      =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                   COMPUTE   RECE41-TENSU(9)  =
                             RECE41-TENSU(9)  -
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU    TO   RECE41-KAISU(9)
                   COMPUTE   RECE41-TENSU(9)  =
                             RECE41-TENSU(9)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 END-IF
               WHEN    "23"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU(10)  =
                                 RECE41-TENSU(10)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(10)
                       COMPUTE   RECE41-TENSU(10)  =
                                 RECE41-TENSU(10)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(11)
                       COMPUTE   RECE41-TENSU(11)  =
                                 RECE41-TENSU(11)  +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                   END-IF
      *    処方のレセ点数欄の編集
               WHEN    "25"
                   IF  SRY-SRYCD(IDX3) = "120002170" OR "120002270" OR
                                         "120003170" OR "120003370" OR
                                         "120003870" OR
                                         "120004070" OR "120004170" OR
                                         "120004370" OR "120004470"
                      COMPUTE  WRK-SYOHOU-KAISU  =  WRK-SYOHOU-KAISU
                                                 +  ACCT-ZAIKAISU
                   END-IF
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WRK-ZAIKAISU-XXX   TO   RECE41-KAISU(12)
                   END-IF
                   COMPUTE   RECE41-TENSU(12)  =
                             RECE41-TENSU(12)  +
                            (WK-ZAITEN   *   WRK-ZAIKAISU-XXX)
      *    麻毒のレセ点数欄の編集
               WHEN    "26"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE41-KAISU(13)
                   END-IF
                   IF SRY-SRYCD(IDX3)      =    "120001310"
                    COMPUTE WRK-MADOKU-SHOHO = WRK-MADOKU-SHOHO +
                                               WK-ZAIKAISU 
                   END-IF
                   COMPUTE   RECE41-TENSU(13)  =
                             RECE41-TENSU(13)  +
                            (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
      *    調基のレセ点数欄の編集
               WHEN    "27"
                   COMPUTE   RECE41-TENSU(14)  =
                             RECE41-TENSU(14)  +
                            (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
      *    皮下筋肉内注射のレセ点数欄の編集
               WHEN    "31"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(15)
                   COMPUTE   RECE41-TENSU(15)  =
                             RECE41-TENSU(15)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
      *    静脈内注射のレセ点数欄の編集
               WHEN    "32"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(16)
                   COMPUTE   RECE41-TENSU(16)  =
                             RECE41-TENSU(16)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
      *    その他注射のレセ点数欄の編集
               WHEN    "33"
                   COMPUTE   RECE41-TENSU(17)  =
                             RECE41-TENSU(17)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
      *    処置のレセ点数欄の編集
               WHEN    "40"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(18)
                   END-IF
                   COMPUTE   RECE41-TENSU(18)  =
                             RECE41-TENSU(18)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(20)  =
                             RECE41-TENSU(20)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    手術のレセ点数欄の編集
               WHEN    "50"
               WHEN    "54"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(21)
                   END-IF
                   COMPUTE   RECE41-TENSU(21)  =
                             RECE41-TENSU(21)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(23)  =
                             RECE41-TENSU(23)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    検査のレセ点数欄の編集
               WHEN    "60"
               WHEN    "64"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(24)
                   END-IF
                   COMPUTE   RECE41-TENSU(24)  =
                             RECE41-TENSU(24)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    WRK-TNS-KNSJISKBN(IDX3)    =   2
                         COMPUTE   RECE41-KAISU(24)  =
                                   RECE41-KAISU(24)  -  
                                   WK-ZAIKAISU
                   END-IF
                   IF    WRK-TNS-SRYCD(IDX3)  =   CONS-SAIKETSU1  OR
                                                  CONS-SAIKETSU2  OR
                                                  CONS-SAIKETSU3
                         IF   RECE41-KAISU(24)  NOT =  ZERO
                              COMPUTE   RECE41-KAISU(24)  =
                                        RECE41-KAISU(24)  -   
                                        WK-ZAIKAISU
                         END-IF
                   END-IF
                   COMPUTE   RECE41-TENSU(26)  =
                             RECE41-TENSU(26)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    画像診断のレセ点数欄の編集
               WHEN    "70"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(27)
                   END-IF
                   COMPUTE   RECE41-TENSU(27)  =
                             RECE41-TENSU(27)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(29)  =
                             RECE41-TENSU(29)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    その他のレセ点数欄の編集
               WHEN    "80"
                   IF ((ACCT-SRYKBN          =  "80"    )  AND
                       (SRY-SRYCD(IDX3)(1:5) =  "09593" ))
                   OR ((SRY-SRYCD(IDX3) >= "101801010" AND
                                        <= "101801020"  )  AND
                       (RECE41-SRYYM    >= "201307"     ))
                   OR ((SRY-SRYCD(IDX3)  = "101801030"  )  AND
                       (RECE41-SRYYM    >= "201307"     ))
      ***              CONTINUE
                       IF   (FLG-TAISYO           =   1     )
                       AND  (SRY-SRYCD(IDX3)(1:5) =  "09593")
                          COMPUTE  WRK-ZAITENNASHI  =
                                   WRK-ZAITENNASHI  +
                                  (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                       END-IF
                   ELSE               
                    IF   SRY-SRYCD(IDX3)   =      CONS-SHOHOSEN1 OR
                                                  CONS-SHOHOSEN2 OR
                                                  CONS-SHOHOSEN3 OR
                                                  CONS-SHOHOSEN4 OR
                                                  CONS-SHOHOSEN5 OR
                                                  CONS-SHOHOKSN1 OR
                                                  CONS-SHOHOKSN2 OR
                                                  CONS-SHOHOKSN3 OR
                                                  CONS-SHOHOKSN4 OR
                                                  CONS-SHOHOKSN5 OR
                                                  CONS-SHOHOKSN6 OR
                                                  CONS-SHOHOKSN7 OR
                                                  CONS-SHOHOKSN8
                         COMPUTE   RECE41-TENSU(30)  =
                                   RECE41-TENSU(30)  +
                                  (WK-ZAITEN  *   WRK-ZAIKAISU-XXX)
                    ELSE
                         COMPUTE   RECE41-TENSU(31)  =
                                   RECE41-TENSU(31)  +
                                  (WK-SYUTEN  *   WRK-ZAIKAISU-XXX)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE41-TENSU(5)  =
                                     RECE41-TENSU(5)  +
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                           COMPUTE   RECE41-TENSU(31) =
                                     RECE41-TENSU(31) -
                                (WRK-TNS-TEN(IDX3) * WRK-ZAIKAISU-XXX)
                         END-IF
                    END-IF
                    COMPUTE   RECE41-TENSU(32)  =
                              RECE41-TENSU(32)  +
                             (WK-YKZTEN   *   WRK-ZAIKAISU-XXX)
                   END-IF
           END-EVALUATE
      *
           .
      *
       2101222-RECE-LEFT-SET2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送
      *****************************************************************
       2101223-RECE-LEFT-SET3-SEC               SECTION.
      *
           EVALUATE    SRY-SRYKBN
      *    初診のレセ点数欄の編集
               WHEN    "11"
                   IF   WRK-TNS-DATAKBN(IDX3)  =   2
                     EVALUATE    WRK-TNS-TIMEKSNKBN(IDX3)
                         WHEN    1
                         WHEN    5
                         WHEN    6
                             MOVE  "1"     TO   RECE41-SHOSHINTIME
                         WHEN    3
                             MOVE  "2"     TO   RECE41-SHOSHINTIME
                         WHEN    4
                             MOVE  "3"     TO   RECE41-SHOSHINTIME
                     END-EVALUATE
                     COMPUTE    RECE41-TENSU(1)  =
                                RECE41-TENSU(1)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     IF  SRY-SRYCD(IDX3)  =  CONS-NYUKSN1  OR
                                             CONS-NYUKSN2  OR
                                             CONS-NYUKSN3  OR
                                             CONS-NYUKSN4  OR
                                             CONS-NYUKSN5  OR
                                             CONS-NYUKSN6  OR
                                             CONS-NYUKSN7  OR
                                             CONS-NYUKSN8  OR
                                             CONS-NYUKSN9
                             MOVE  "1"     TO   RECE41-SHOSHIN-NYU
                     END-IF
                   END-IF
                   IF   SRY-SRYCD(IDX3) = CONS-ROUSAI1 OR
                                          CONS-ROUSAI18
                        COMPUTE    RECE41-KINGAKU2(1)  =
                                   RECE41-KINGAKU2(1)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF  
                   IF  (SRY-SRYCD(IDX3) = CONS-ROUSAI3)
                   AND (RECE41-SRYYM   <=   "201306"  )
                        COMPUTE    RECE41-KINGAKU2(4)  =
                                   RECE41-KINGAKU2(4)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF  
      *    再診のレセ点数欄の編集（集計方法変更後）
               WHEN    "12"
                 EVALUATE  WRK-TNS-GAITENTTLKBN(IDX3)
      *      （基本手技）
                   WHEN  120
                     IF ((SRY-SRYCD(IDX3) =  CONS-ROUSAI5  OR
                                             CONS-ROUSAI6  OR
                                             CONS-ROUSAI7  OR
                                             CONS-ROUSAI19) AND
                         (RECE41-SRYYM   <=    "201306"   ))
                     OR ((SRY-SRYCD(IDX3) =  CONS-ROUSAI34 OR
                                             CONS-ROUSAI35 OR
                                             CONS-ROUSAI36 OR
                                             CONS-ROUSAI37 OR
                                             CONS-ROUSAI38 OR
                                             CONS-ROUSAI5 ) AND
                         (RECE41-SRYYM   >=    "201307"   ))
                         IF ((SRY-SRYCD(IDX3) =  CONS-ROUSAI19) AND
                             (RECE41-SRYYM   <=  "201306"     ))
                         OR ((SRY-SRYCD(IDX3) =  CONS-ROUSAI5
                                              OR CONS-ROUSAI38) AND
                             (RECE41-SRYYM   >=  "201307"     ))
                           CONTINUE
                         ELSE
                           ADD    WK-ZAIKAISU   TO   RECE41-KAISU2(2)
                         END-IF
                         COMPUTE    RECE41-KINGAKU2(2)  =
                                    RECE41-KINGAKU2(2)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     ELSE
                         COMPUTE    RECE41-TENSU(7)  =
                                    RECE41-TENSU(7)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     END-IF
      *
      *      （外来管理加算）
                   WHEN  122
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(2)
                        COMPUTE    RECE41-TENSU(2)  =
                                   RECE41-TENSU(2)  +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （時間外）
                   WHEN  123
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(3)
                        COMPUTE RECE41-TENSU(3) =
                                RECE41-TENSU(3) +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （休日）
                   WHEN  124
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(4)
                        COMPUTE  RECE41-TENSU(4) =
                                 RECE41-TENSU(4) +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *       （深夜）
                   WHEN  125
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(5)
                        COMPUTE  RECE41-TENSU(5) =
                                 RECE41-TENSU(5) +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *       （その他）
                   WHEN  OTHER 
                        IF  (SRY-SRYCD(IDX3) =  CONS-ROUSAI4)
                        AND (RECE41-SRYYM   <=  "201306"    )
                           ADD   WK-ZAIKAISU TO   RECE41-KAISU2(3)
                           COMPUTE    RECE41-KINGAKU2(3)  =
                                      RECE41-KINGAKU2(3)  +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        END-IF
                        IF   ACCT-ZAIKBN     =  2
                           COMPUTE    WRK-RECE4G-TENSU(7)  =
                                      WRK-RECE4G-TENSU(7)  +
                                     (WK-ZAITEN   *   WK-ZAIKAISU)
                        END-IF
                 END-EVALUATE
      *    指導のレセ点数欄の編集
               WHEN    "13"
                 IF   (SRY-SRYCD(IDX3) =  CONS-ROUSAI33)
                 AND  (RECE41-SRYYM   >=  "201307"     )
                         ADD   WK-ZAIKAISU   TO   RECE41-KAISU2(3)
                         COMPUTE    RECE41-KINGAKU2(3)  =
                                    RECE41-KINGAKU2(3)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                 ELSE
                   IF ((SRY-SRYCD(IDX3) =
                        CONS-ROUSAI9  OR  CONS-ROUSAI10 OR
                        CONS-ROUSAI11 OR  CONS-ROUSAI12 OR
                        CONS-ROUSAI13 OR  CONS-ROUSAI14 OR
                        CONS-ROUSAI15 OR  CONS-ROUSAI16 OR
                        CONS-ROUSAI17                       ) AND
                       (RECE41-SRYYM    <=  "201306"        ))
                   OR ((SRY-SRYCD(IDX3)  =  CONS-ROUSAI8    ) AND
                       (RECE41-SRYYM     <  "200804"        ))
                         COMPUTE    RECE41-KINGAKU2(6)  =
                                    RECE41-KINGAKU2(6)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   ELSE
                     IF   ACCT-ZAIKBN     =  2
                         COMPUTE    WRK-RECE4G-TENSU(6)  =
                                    WRK-RECE4G-TENSU(6)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                         COMPUTE    RECE41-TENSU(6)  =
                                    RECE41-TENSU(6)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF                   
                 END-IF
      *
      *    在宅のレセ点数欄の編集
               WHEN    "14"
                 IF  ACCT-ZAIKBN   =    2
                   COMPUTE    WRK-RECE4G-TENSU(7)  =
                              WRK-RECE4G-TENSU(7)  +
                             (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   MOVE      ZERO            TO   FLG-ZAITAKU
      *            往診・特別往診（時間加算）
                   IF    FLG-OSINKBN         =   1
                       MOVE         1        TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(7)  =
                                 RECE41-TENSU(7)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            夜間
                   IF    FLG-OSINKBN         =    2
                       MOVE   1              TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(7)  =
                                 RECE41-TENSU(7)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            深夜・緊急
                   IF    FLG-OSINKBN         =    3
                       MOVE   1              TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(7)  =
                                 RECE41-TENSU(7)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            在宅患者訪問診療
                   IF (( WRK-TNS-OSINKBN(IDX3) =     1          )  AND
                       ((SRY-SRYCD(IDX3)   NOT =    "114000110")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001610")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114012070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029270")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030170")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030270")))
                   OR (  FLG-OSINKBN           =     9           )
                       MOVE   1              TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(7)  =
                                 RECE41-TENSU(7)  +
                                (WK-SYUTEN         * WK-ZAIKAISU)
                   END-IF
      *            その他
                   IF    FLG-ZAITAKU    =   ZERO
                       COMPUTE   RECE41-TENSU(7)  =
                                 RECE41-TENSU(7)  +
                                (WK-SYUTEN     *   WK-ZAIKAISU)
                   END-IF
      *            薬剤
                   COMPUTE   RECE41-TENSU-YAK(7)  =
                             RECE41-TENSU-YAK(7)  +
                             (WK-KIZAITEN *   WK-ZAIKAISU)  +
                             (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    投薬のレセ点数欄の編集
               WHEN    "21"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN
                                            OR CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU-YAK(9)  =
                                 RECE41-TENSU-YAK(9)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(9)
                       COMPUTE   RECE41-TENSU-YAK(9)  =
                                 RECE41-TENSU-YAK(9)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                     IF   SRY-SRYCD(IDX3)   =    CONS-FUNSAI-COMMENT
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(9)
                       COMPUTE   RECE41-TENSU-YAK(9)  =
                                 RECE41-TENSU-YAK(9)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE   
                       IF    RECE41-KHNTEN(10)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3)  TO  RECE41-KHNTEN(10)
                       ELSE
                          IF   RECE41-KHNTEN(10) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE41-KHNTEN(10)
                               MOVE   1       TO    FLG-KHNTEN10-JI
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(10)
                       COMPUTE   RECE41-TENSU(10)  =
                                 RECE41-TENSU(10)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     END-IF   
                   END-IF
               WHEN    "22"
                 IF    SRY-SRYCD(IDX3)      =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                   COMPUTE   RECE41-TENSU-YAK(11)  =
                             RECE41-TENSU-YAK(11)  -
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU    TO   RECE41-KAISU(11)
                   COMPUTE   RECE41-TENSU-YAK(11)  =
                             RECE41-TENSU-YAK(11)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 END-IF
               WHEN    "23"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU-YAK(12)  =
                                 RECE41-TENSU-YAK(12)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(12)
                       COMPUTE   RECE41-TENSU-YAK(12)  =
                                 RECE41-TENSU-YAK(12)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                       IF    RECE41-KHNTEN(13)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3)  TO  RECE41-KHNTEN(13)
                       ELSE
                          IF   RECE41-KHNTEN(13) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE41-KHNTEN(13)
                               MOVE   1       TO    FLG-KHNTEN13-JI
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(13)
                       COMPUTE   RECE41-TENSU(13)  =
                                 RECE41-TENSU(13)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF
      *    処方のレセ点数欄の編集
               WHEN    "25"
                   IF  SRY-SRYCD(IDX3) = "120002170" OR "120002270" OR
                                         "120003170" OR "120003370" OR
                                         "120003870" OR
                                         "120004070" OR "120004170" OR
                                         "120004370" OR "120004470"
                      COMPUTE  WRK-SYOHOU-KAISU  =  WRK-SYOHOU-KAISU
                                                 +  ACCT-ZAIKAISU
                   END-IF
                   IF    WK-ZAITEN   NOT =  ZERO
                     IF    RECE41-KHNTEN(14)     = ZERO
                      MOVE  WK-ZAITEN     TO   RECE41-KHNTEN(14)
                     ELSE
                      IF   RECE41-KHNTEN(14) NOT = WK-ZAITEN
                            MOVE   ZERO   TO   RECE41-KHNTEN(14)
                            MOVE   1      TO   FLG-KHNTEN14-JI
                      END-IF
                     END-IF
                   END-IF
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    ACCT-ZAIKAISU   TO    RECE41-KAISU(14)
                   END-IF
                   COMPUTE   RECE41-TENSU(14)  =
                             RECE41-TENSU(14)  +
                            (WK-ZAITEN   *   ACCT-ZAIKAISU)
      *    麻毒のレセ点数欄の編集
               WHEN    "26"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE41-KAISU(15)
                   END-IF
                   IF SRY-SRYCD(IDX3)      =    "120001310"
                    COMPUTE WRK-MADOKU-SHOHO = WRK-MADOKU-SHOHO +
                                               WK-ZAIKAISU 
                   END-IF
                   COMPUTE   RECE41-TENSU(15)  =
                             RECE41-TENSU(15)  +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *    調基のレセ点数欄の編集
               WHEN    "27"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE41-KAISU(16)
                   END-IF
                   COMPUTE   RECE41-TENSU(16)  =
                             RECE41-TENSU(16)  +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *    皮下筋肉内注射のレセ点数欄の編集
               WHEN    "31"
                 IF   WRK-PARA-JIBAIPRTKBN  =  "2"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(18)
                   COMPUTE   RECE41-TENSU(18)  =
                             RECE41-TENSU(18)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(21)  =
                             RECE41-TENSU-YAK(21)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(19)
                   COMPUTE   RECE41-TENSU(19)  =
                             RECE41-TENSU(19)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(22)  =
                             RECE41-TENSU-YAK(22)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    静脈内注射のレセ点数欄の編集
               WHEN    "32"
                 IF   WRK-PARA-JIBAIPRTKBN  =  "2"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(19)
                   COMPUTE   RECE41-TENSU(19)  =
                             RECE41-TENSU(19)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(21)  =
                             RECE41-TENSU-YAK(21)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(20)
                   COMPUTE   RECE41-TENSU(20)  =
                             RECE41-TENSU(20)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(22)  =
                             RECE41-TENSU-YAK(22)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    その他注射のレセ点数欄の編集
               WHEN    "33"
                 IF   WRK-PARA-JIBAIPRTKBN  =  "2"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(20)
                   COMPUTE   RECE41-TENSU(20)  =
                             RECE41-TENSU(20)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(21)  =
                             RECE41-TENSU-YAK(21)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(21)
                   COMPUTE   RECE41-TENSU(21)  =
                             RECE41-TENSU(21)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(22)  =
                             RECE41-TENSU-YAK(22)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    処置のレセ点数欄の編集
               WHEN    "40"
                 IF   WRK-PARA-JIBAIPRTKBN  =  "2"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(23)
                   END-IF
                   COMPUTE   RECE41-TENSU(23)  =
                             RECE41-TENSU(23)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(24)  =
                             RECE41-TENSU-YAK(24)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 ELSE
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(25)
                   END-IF
                   COMPUTE   RECE41-TENSU(25)  =
                             RECE41-TENSU(25)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(26)  =
                             RECE41-TENSU-YAK(26)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    手術のレセ点数欄の編集
               WHEN    "50"
               WHEN    "54"
                 IF   WRK-PARA-JIBAIPRTKBN  =  "2"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(25)
                   END-IF
                   COMPUTE   RECE41-TENSU(25)  =
                             RECE41-TENSU(25)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(26)  =
                             RECE41-TENSU-YAK(26)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 ELSE
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(27)
                   END-IF
                   COMPUTE   RECE41-TENSU(27)  =
                             RECE41-TENSU(27)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(28)  =
                             RECE41-TENSU-YAK(28)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    検査のレセ点数欄の編集
               WHEN    "60"
               WHEN    "64"
                 IF   WRK-PARA-JIBAIPRTKBN  =  "2"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(27)
                   END-IF
                   COMPUTE   RECE41-TENSU(27)  =
                             RECE41-TENSU(27)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    WRK-TNS-KNSJISKBN(IDX3)    =   2
                         COMPUTE   RECE41-KAISU(27)  =
                                   RECE41-KAISU(27)  -  
                                   WK-ZAIKAISU
                   END-IF
                   IF    WRK-TNS-SRYCD(IDX3)  =   CONS-SAIKETSU1  OR
                                                  CONS-SAIKETSU2  OR
                                                  CONS-SAIKETSU3
                         IF   RECE41-KAISU(27)  NOT =  ZERO
                              COMPUTE   RECE41-KAISU(27)  =
                                        RECE41-KAISU(27)  -   
                                        WK-ZAIKAISU
                         END-IF
                   END-IF
                   COMPUTE   RECE41-TENSU-YAK(28)  =
                             RECE41-TENSU-YAK(28)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 ELSE
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(29)
                   END-IF
                   COMPUTE   RECE41-TENSU(29)  =
                             RECE41-TENSU(29)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    WRK-TNS-KNSJISKBN(IDX3)    =   2
                         COMPUTE   RECE41-KAISU(29)  =
                                   RECE41-KAISU(29)  -  
                                   WK-ZAIKAISU
                   END-IF
                   IF    WRK-TNS-SRYCD(IDX3)  =   CONS-SAIKETSU1  OR
                                                  CONS-SAIKETSU2  OR
                                                  CONS-SAIKETSU3
                         IF   RECE41-KAISU(29)  NOT =  ZERO
                              COMPUTE   RECE41-KAISU(29)  =
                                        RECE41-KAISU(29)  -   
                                        WK-ZAIKAISU
                         END-IF
                   END-IF
                   COMPUTE   RECE41-TENSU-YAK(30)  =
                             RECE41-TENSU-YAK(30)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    画像診断のレセ点数欄の編集
               WHEN    "70"
                 IF   WRK-PARA-JIBAIPRTKBN  =  "2"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(29)
                   END-IF
                   COMPUTE   RECE41-TENSU(29)  =
                             RECE41-TENSU(29)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(30)  =
                             RECE41-TENSU-YAK(30)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 ELSE
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(31)
                   END-IF
                   COMPUTE   RECE41-TENSU(31)  =
                             RECE41-TENSU(31)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU-YAK(32)  =
                             RECE41-TENSU-YAK(32)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    その他のレセ点数欄の編集
               WHEN    "80"
                IF   WRK-PARA-JIBAIPRTKBN  =  "2"
                 IF   ((SRY-SRYCD(IDX3) =
                        CONS-ROUSAI32 OR
                        CONS-ROUSAI20 OR  CONS-ROUSAI21 OR
                        CONS-ROUSAI22 OR  CONS-ROUSAI23 OR
                        CONS-ROUSAI24 OR  CONS-ROUSAI25 OR
                        CONS-ROUSAI26 OR  CONS-ROUSAI27 OR
                        CONS-ROUSAI28 OR  CONS-ROUSAI29 OR
                        CONS-ROUSAI30 OR  CONS-ROUSAI31 OR
                        CONS-ROUSAI39                       ) AND
                       (RECE41-SRYYM    >=  "201307"        ))
                   IF   SRY-SRYCD(IDX3) = CONS-ROUSAI32
                        COMPUTE     RECE41-KINGAKU2(4)  =
                                    RECE41-KINGAKU2(4)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   ELSE
                         COMPUTE    RECE41-KINGAKU2(6)  =
                                    RECE41-KINGAKU2(6)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF
                 ELSE
                   IF ( ACCT-SRYKBN          =  "80"    )   AND
                      ( SRY-SRYCD(IDX3)(1:5) =  "09591" OR
                                                "09592" )
                        CONTINUE
                   ELSE
                    IF ((ACCT-SRYKBN          =  "80"    )  AND
                        (SRY-SRYCD(IDX3)(1:5) =  "09593" ))
                    OR ((SRY-SRYCD(IDX3) >= "101801010" AND
                                         <= "101801020"  )  AND
                        (RECE41-SRYYM    >= "201307"     ))
                    OR ((SRY-SRYCD(IDX3)  = "101801030"  )  AND
                        (RECE41-SRYYM    >= "201307"     ))
                     IF   SRY-SRYCD(IDX3)(1:5) = "09593"
                      EVALUATE  WRK-TNS-JIBAISYUKEIKBN(IDX3)
                       WHEN       0
                       WHEN       5
                         COMPUTE    RECE41-KINGAKU2(6)  =
                                    RECE41-KINGAKU2(6)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       WHEN       1
                         COMPUTE    RECE41-KINGAKU2(1)  =
                                    RECE41-KINGAKU2(1)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       WHEN       2
                         COMPUTE    RECE41-KINGAKU2(2)  =
                                    RECE41-KINGAKU2(2)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       WHEN       3
                         ADD    WK-ZAIKAISU   TO   RECE41-KAISU2(3)
                         COMPUTE    RECE41-KINGAKU2(3)  =
                                    RECE41-KINGAKU2(3)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       WHEN       4
                         COMPUTE    RECE41-KINGAKU2(4)  =
                                    RECE41-KINGAKU2(4)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                      END-EVALUATE
                     ELSE
                      IF  SRY-SRYCD(IDX3)  =  "101801030"
                         COMPUTE    WRK-FUTANWARI  =
                                    WRK-TNS-TEN(IDX3) / 100
                         COMPUTE    WRK-KEISAN-KG2 =
                                   (WRK-TEN-KG2       * WRK-FUTANWARI)
                         COMPUTE    RECE41-KINGAKU2(6)  =
                                    RECE41-KINGAKU2(6)  +
                                   (WRK-KEISAN-KG2    * ACCT-ZAIKAISU)
                      ELSE
                         COMPUTE    RECE41-KINGAKU2(6)  =
                                    RECE41-KINGAKU2(6)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                         COMPUTE    WRK-TEN-KG2 = WRK-TNS-TEN(IDX3)
                      END-IF
                     END-IF
                    ELSE
                     IF  SRY-SRYCD(IDX3)      =    CONS-RYOYOTEATE
                       COMPUTE    RECE41-KINGAKU2(6)  =
                                  RECE41-KINGAKU2(6)  +
                                 (WRK-RYOYOTEATE  *   ACCT-ZAIKAISU)
                     ELSE
                      IF  SRY-SRYCD(IDX3) =  CONS-SHOHOKSN1
                                          OR CONS-SHOHOKSN2
                                          OR CONS-SHOHOKSN3
                                          OR CONS-SHOHOKSN4
                                          OR CONS-SHOHOKSN5
                                          OR CONS-SHOHOKSN6
                                          OR CONS-SHOHOKSN7
                                          OR CONS-SHOHOKSN8
                         COMPUTE  WRK-SYOSEN-KAISU  =  WRK-SYOSEN-KAISU
                                                    +  ACCT-ZAIKAISU
                      END-IF
                      IF   SRY-SRYCD(IDX3)    =    CONS-SHOHOSEN1 OR
                                                   CONS-SHOHOSEN2 OR
                                                   CONS-SHOHOSEN3 OR
                                                   CONS-SHOHOSEN4 OR
                                                   CONS-SHOHOSEN5 OR
                                                   CONS-SHOHOKSN1 OR
                                                   CONS-SHOHOKSN2 OR
                                                   CONS-SHOHOKSN3 OR
                                                   CONS-SHOHOKSN4 OR
                                                   CONS-SHOHOKSN5 OR
                                                   CONS-SHOHOKSN6 OR
                                                   CONS-SHOHOKSN7 OR
                                                   CONS-SHOHOKSN8
                          ADD  ACCT-ZAIKAISU  TO  RECE41-KAISU(31)
                          COMPUTE   RECE41-TENSU(31)  =
                                    RECE41-TENSU(31)  +
                                   (WK-ZAITEN  *   ACCT-ZAIKAISU)
                      ELSE
                          COMPUTE   RECE41-TENSU(32)  =
                                    RECE41-TENSU(32)  +
                                   (WK-SYUTEN  *   ACCT-ZAIKAISU)
                          IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                            COMPUTE   RECE41-TENSU(6)  =
                                      RECE41-TENSU(6)  +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                            COMPUTE   RECE41-TENSU(32)  =
                                      RECE41-TENSU(32)  -
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                          END-IF
                      END-IF
                      COMPUTE   RECE41-TENSU-YAK(33)  =
                                RECE41-TENSU-YAK(33)  +
                               (WK-YKZTEN   *   ACCT-ZAIKAISU)
                     END-IF
                    END-IF
                   END-IF
                 END-IF
                ELSE
                 IF   ((SRY-SRYCD(IDX3) =
                        CONS-ROUSAI32 OR
                        CONS-ROUSAI20 OR  CONS-ROUSAI21 OR
                        CONS-ROUSAI22 OR  CONS-ROUSAI23 OR
                        CONS-ROUSAI24 OR  CONS-ROUSAI25 OR
                        CONS-ROUSAI26 OR  CONS-ROUSAI27 OR
                        CONS-ROUSAI28 OR  CONS-ROUSAI29 OR
                        CONS-ROUSAI30 OR  CONS-ROUSAI31 OR
                        CONS-ROUSAI39                       ) AND
                       (RECE41-SRYYM    >=  "201307"        ))
                   IF   SRY-SRYCD(IDX3) = CONS-ROUSAI32
                        COMPUTE     RECE41-KINGAKU2(4)  =
                                    RECE41-KINGAKU2(4)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   ELSE
                         COMPUTE    RECE41-KINGAKU2(6)  =
                                    RECE41-KINGAKU2(6)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF
                 ELSE
                   IF ( ACCT-SRYKBN          =  "80"    )   AND
                      ( SRY-SRYCD(IDX3)(1:5) =  "09591" OR 
                                                "09592" )
                        CONTINUE
                   ELSE
                    IF ((ACCT-SRYKBN          =  "80"    )  AND
                        (SRY-SRYCD(IDX3)(1:5) =  "09593" ))
                    OR ((SRY-SRYCD(IDX3) >= "101801010" AND
                                         <= "101801020"  )  AND
                        (RECE41-SRYYM    >= "201307"     ))
                    OR ((SRY-SRYCD(IDX3)  = "101801030"  )  AND
                        (RECE41-SRYYM    >= "201307"     ))
                     IF   SRY-SRYCD(IDX3)(1:5) = "09593"
                      EVALUATE  WRK-TNS-JIBAISYUKEIKBN(IDX3)
                       WHEN       0
                       WHEN       5
                         COMPUTE    RECE41-KINGAKU2(6)  =
                                    RECE41-KINGAKU2(6)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       WHEN       1
                         COMPUTE    RECE41-KINGAKU2(1)  =
                                    RECE41-KINGAKU2(1)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       WHEN       2
                         COMPUTE    RECE41-KINGAKU2(2)  =
                                    RECE41-KINGAKU2(2)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       WHEN       3
                         ADD    WK-ZAIKAISU   TO   RECE41-KAISU2(3)
                         COMPUTE    RECE41-KINGAKU2(3)  =
                                    RECE41-KINGAKU2(3)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       WHEN       4
                         COMPUTE    RECE41-KINGAKU2(4)  =
                                    RECE41-KINGAKU2(4)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                      END-EVALUATE
                     ELSE
                      IF  SRY-SRYCD(IDX3)  =  "101801030"
                         COMPUTE    WRK-FUTANWARI  =
                                    WRK-TNS-TEN(IDX3) / 100
                         COMPUTE    WRK-KEISAN-KG2 =
                                   (WRK-TEN-KG2       * WRK-FUTANWARI)
                         COMPUTE    RECE41-KINGAKU2(6)  =
                                    RECE41-KINGAKU2(6)  +
                                   (WRK-KEISAN-KG2    * ACCT-ZAIKAISU)
                      ELSE
                         COMPUTE    RECE41-KINGAKU2(6)  =
                                    RECE41-KINGAKU2(6)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                         COMPUTE    WRK-TEN-KG2 = WRK-TNS-TEN(IDX3)
                      END-IF
                     END-IF
                    ELSE                                                
                     IF  SRY-SRYCD(IDX3)      =    CONS-RYOYOTEATE
                       COMPUTE    RECE41-KINGAKU2(6)  =                 
                                  RECE41-KINGAKU2(6)  +                 
                                 (WRK-RYOYOTEATE  *   ACCT-ZAIKAISU)    
                     ELSE
                      IF  SRY-SRYCD(IDX3) =  CONS-SHOHOKSN1
                                          OR CONS-SHOHOKSN2
                                          OR CONS-SHOHOKSN3
                                          OR CONS-SHOHOKSN4
                                          OR CONS-SHOHOKSN5
                                          OR CONS-SHOHOKSN6
                                          OR CONS-SHOHOKSN7
                                          OR CONS-SHOHOKSN8
                         COMPUTE  WRK-SYOSEN-KAISU  =  WRK-SYOSEN-KAISU
                                                    +  ACCT-ZAIKAISU
                      END-IF
                      IF   SRY-SRYCD(IDX3)    =    CONS-SHOHOSEN1 OR
                                                   CONS-SHOHOSEN2 OR
                                                   CONS-SHOHOSEN3 OR
                                                   CONS-SHOHOSEN4 OR
                                                   CONS-SHOHOSEN5 OR
                                                   CONS-SHOHOKSN1 OR
                                                   CONS-SHOHOKSN2 OR
                                                   CONS-SHOHOKSN3 OR
                                                   CONS-SHOHOKSN4 OR
                                                   CONS-SHOHOKSN5 OR
                                                   CONS-SHOHOKSN6 OR
                                                   CONS-SHOHOKSN7 OR
                                                   CONS-SHOHOKSN8
                          ADD  ACCT-ZAIKAISU  TO  RECE41-KAISU(33)
                          COMPUTE   RECE41-TENSU(33)  =
                                    RECE41-TENSU(33)  +
                                   (WK-ZAITEN  *   ACCT-ZAIKAISU)
                      ELSE
                          EVALUATE   WRK-PARA-JIBAIPRTKBN
                            WHEN      "0"
                             COMPUTE   RECE41-TENSU(25)  =
                                       RECE41-TENSU(25)  +
                                      (WK-SYUTEN   *   ACCT-ZAIKAISU)
                            WHEN      "1"
                             COMPUTE   RECE41-TENSU(34)  =
                                       RECE41-TENSU(34)  +
                                      (WK-SYUTEN   *   ACCT-ZAIKAISU)
                          END-EVALUATE
                          IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                            COMPUTE   RECE41-TENSU(6)  =
                                      RECE41-TENSU(6)  +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                            EVALUATE  WRK-PARA-JIBAIPRTKBN
                             WHEN      "0"
                              COMPUTE   RECE41-TENSU(25)  =
                                        RECE41-TENSU(25)  -
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                             WHEN      "1"
                              COMPUTE   RECE41-TENSU(34)  =
                                        RECE41-TENSU(34)  -
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                            END-EVALUATE
                          END-IF
                      END-IF
                      EVALUATE  WRK-PARA-JIBAIPRTKBN
                       WHEN      "0"
                          COMPUTE   RECE41-TENSU-YAK(26)  =
                                    RECE41-TENSU-YAK(26)  +
                                   (WK-YKZTEN   *   ACCT-ZAIKAISU)
                       WHEN      "1"
                          COMPUTE   RECE41-TENSU-YAK(35)  =
                                    RECE41-TENSU-YAK(35)  +
                                   (WK-YKZTEN   *   ACCT-ZAIKAISU)
                      END-EVALUATE
                     END-IF
                    END-IF                                              
                   END-IF
                 END-IF
                END-IF
           END-EVALUATE
      *
           .
      *
       2101223-RECE-LEFT-SET3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送
      *****************************************************************
       2101224-RECE-LEFT-SET4-SEC               SECTION.
      *
           EVALUATE    SRY-SRYKBN
      *    初診のレセ点数欄の編集
               WHEN    "11"
                 IF   (RECE41-HKNKBN    =  "4")
                 AND  (RECE41-JIBAIKBN  =  "1")
                   IF   WRK-TNS-DATAKBN(IDX3)  =   2
                     EVALUATE    WRK-TNS-TIMEKSNKBN(IDX3)
                         WHEN    1
                         WHEN    5
                         WHEN    6
                             MOVE  "1"     TO   RECE41-SHOSHINTIME
                         WHEN    3
                             MOVE  "2"     TO   RECE41-SHOSHINTIME
                         WHEN    4
                             MOVE  "3"     TO   RECE41-SHOSHINTIME
                     END-EVALUATE
                     COMPUTE    RECE41-TENSU(1)    =
                                RECE41-TENSU(1)    +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     COMPUTE    TBL-SYUTEN-JI(1)   =
                                TBL-SYUTEN-JI(1)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     IF  SRY-SRYCD(IDX3)  =  CONS-NYUKSN1  OR
                                             CONS-NYUKSN2  OR
                                             CONS-NYUKSN3  OR
                                             CONS-NYUKSN4  OR
                                             CONS-NYUKSN5  OR
                                             CONS-NYUKSN6  OR
                                             CONS-NYUKSN7  OR
                                             CONS-NYUKSN8  OR
                                             CONS-NYUKSN9
                             MOVE  "1"     TO   RECE41-SHOSHIN-NYU
                     END-IF
                   END-IF
                   IF   SRY-SRYCD(IDX3) = CONS-ROUSAI1 OR
                                          CONS-ROUSAI18
      ****              COMPUTE    RECE41-SONOTAKIN-JYU  =
      ****                         RECE41-SONOTAKIN-JYU  +
      ****                     (WRK-TNS-TEN(IDX3)   * ACCT-ZAIKAISU)
                        COMPUTE    WRK-KINGAKU-JI   =
                                   WRK-KINGAKU-JI   +
                               (WRK-TNS-TEN(IDX3)   * ACCT-ZAIKAISU)
                   END-IF
                   IF  (SRY-SRYCD(IDX3) = CONS-ROUSAI3)
                   AND (RECE41-SRYYM   <=   "201306"  )
      ****              COMPUTE    RECE41-SONOTAKIN-JYU  =
      ****                         RECE41-SONOTAKIN-JYU  +
      ****                     (WRK-TNS-TEN(IDX3)   * ACCT-ZAIKAISU)
                        COMPUTE    WRK-KINGAKU-JI   =
                                   WRK-KINGAKU-JI   +
                               (WRK-TNS-TEN(IDX3)   * ACCT-ZAIKAISU)
                   END-IF
                 ELSE
                   IF   WRK-TNS-DATAKBN(IDX3)  =   2
                     EVALUATE    WRK-TNS-TIMEKSNKBN(IDX3)
                         WHEN    1
                         WHEN    5
                         WHEN    6
                             MOVE  "1"     TO   RECE41-SHOSHINTIME
                         WHEN    3
                             MOVE  "2"     TO   RECE41-SHOSHINTIME
                         WHEN    4
                             MOVE  "3"     TO   RECE41-SHOSHINTIME
                     END-EVALUATE
                     IF  SRY-SRYCD(IDX3)  =  CONS-NYUKSN1  OR
                                             CONS-NYUKSN2  OR
                                             CONS-NYUKSN3  OR
                                             CONS-NYUKSN4  OR
                                             CONS-NYUKSN5  OR
                                             CONS-NYUKSN6  OR
                                             CONS-NYUKSN7  OR
                                             CONS-NYUKSN8  OR
                                             CONS-NYUKSN9
                             MOVE  "1"     TO   RECE41-SHOSHIN-NYU
                     END-IF
                   END-IF
                   COMPUTE    RECE41-TENSU(1)    =
                              RECE41-TENSU(1)    +
                              (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   COMPUTE    TBL-SYUTEN-JI(1)   =
                              TBL-SYUTEN-JI(1)   +
                              (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                 END-IF
      *    再診のレセ点数欄の編集（集計方法変更後）
               WHEN    "12"
                 IF   (RECE41-HKNKBN    =  "4")
                 AND  (RECE41-JIBAIKBN  =  "1")
                   EVALUATE  WRK-TNS-GAITENTTLKBN(IDX3)
      *      （基本手技）
                    WHEN  120
                     IF ((SRY-SRYCD(IDX3) =  CONS-ROUSAI5  OR
                                             CONS-ROUSAI6  OR
                                             CONS-ROUSAI7  OR
                                             CONS-ROUSAI19) AND
                         (RECE41-SRYYM   <=    "201306"   ))
                     OR ((SRY-SRYCD(IDX3) =  CONS-ROUSAI34 OR
                                             CONS-ROUSAI35 OR
                                             CONS-ROUSAI36 OR
                                             CONS-ROUSAI37 OR
                                             CONS-ROUSAI38 OR
                                             CONS-ROUSAI5 ) AND
                         (RECE41-SRYYM   >=    "201307"   ))
      ****               ADD   WK-ZAIKAISU      TO   RECE41-KAISU(2)
      ****               COMPUTE    RECE41-SONOTAKIN-JYU  =
      ****                          RECE41-SONOTAKIN-JYU  +
      ****                     (WRK-TNS-TEN(IDX3)    * ACCT-ZAIKAISU)
                         COMPUTE    WRK-KINGAKU-JI   =
                                    WRK-KINGAKU-JI   +
                               (WRK-TNS-TEN(IDX3)    * ACCT-ZAIKAISU)
                     ELSE
                      IF  (SRY-SRYCD(IDX3) =  CONS-JIKANTAI1
                                           OR CONS-JIKANTAI2
                                           OR CONS-JIKANTAI3
                                           OR CONS-MESAIKSN
                                           OR CONS-CHIHOKATU
                                           OR CONS-CHIHOKAT2
                                           OR CONS-CHIHOKAT3
                                           OR CONS-CHIHOKAT4
                                           OR CONS-YAKRENKEI
                                           OR CONS-NINPU13-COMMENT
                                           OR CONS-NINPU17-COMMENT)
                      AND (RECE41-SRYYM   >=  "201204"            )
                         COMPUTE    RECE41-TENSU(8)   =
                                    RECE41-TENSU(8)   +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                         COMPUTE    TBL-SYUTEN-JI(8)  =
                                    TBL-SYUTEN-JI(8)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                      ELSE
      **                 IF ( SRY-SRYCD(IDX3)     =   CONS-KEIZOKU1  OR
      **                                              CONS-KEIZOKU2 )
      **                 OR ( WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0"  )
      **                 OR ( SRY-SRYCD(IDX3)(1:1)       NOT = "1"  )
      **                 OR ( SRY-SRYCD(IDX3) = CONS-YAKRENKEI      )
      **                     CONTINUE
      **                 ELSE
                             IF   FLG-COUNT-ARI  =  ZERO
                               ADD   WK-ZAIKAISU  TO  RECE41-KAISU(2)
                               MOVE  1            TO  FLG-COUNT-ARI
                             END-IF
      **                 END-IF
                         IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(2)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                          ELSE
                            IF RECE41-KHNTEN(2) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(2)
                              MOVE   1       TO    FLG-KHNTEN2-JI2
                            END-IF
                          END-IF
                         END-IF
                         COMPUTE    RECE41-TENSU(2)   =
                                    RECE41-TENSU(2)   +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                         COMPUTE    TBL-SYUTEN-JI(2)  =
                                    TBL-SYUTEN-JI(2)  +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                      END-IF
                     END-IF
      *      （外来管理加算）
                    WHEN  122
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(3)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(3)
                          ELSE
                            IF RECE41-KHNTEN(3) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(3)
                              MOVE   1       TO    FLG-KHNTEN3-JI2
                            END-IF
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(3)
                        COMPUTE  RECE41-TENSU(3)   =
                                 RECE41-TENSU(3)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE  TBL-SYUTEN-JI(3)  =
                                 TBL-SYUTEN-JI(3)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （時間外）
                    WHEN  123
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(4)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(4)
                          ELSE
                            IF RECE41-KHNTEN(4) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(4)
                              MOVE   1       TO    FLG-KHNTEN4-JI2
                            END-IF
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(4)
                        COMPUTE  RECE41-TENSU(4)   =
                                 RECE41-TENSU(4)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE  TBL-SYUTEN-JI(4)  =
                                 TBL-SYUTEN-JI(4)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （休日）
                    WHEN  124
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(5)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(5)
                          ELSE
                            IF RECE41-KHNTEN(5) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(5)
                              MOVE   1       TO    FLG-KHNTEN5-JI2
                            END-IF
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(5)
                        COMPUTE  RECE41-TENSU(5)   =
                                 RECE41-TENSU(5)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE  TBL-SYUTEN-JI(5)  =
                                 TBL-SYUTEN-JI(5)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （深夜）
                    WHEN  125
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(6)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(6)
                          ELSE
                            IF RECE41-KHNTEN(6) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(6)
                              MOVE   1       TO    FLG-KHNTEN6-JI2
                            END-IF
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(6)
                        COMPUTE  RECE41-TENSU(6)   =
                                 RECE41-TENSU(6)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE  TBL-SYUTEN-JI(6)  =
                                 TBL-SYUTEN-JI(6)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （その他）
                    WHEN  OTHER
                        IF  (SRY-SRYCD(IDX3) =  CONS-ROUSAI4)
                        AND (RECE41-SRYYM   <=  "201306"    )
      ****                 COMPUTE    RECE41-SONOTAKIN-JYU  =
      ****                            RECE41-SONOTAKIN-JYU  +
      ****                       (WRK-TNS-TEN(IDX3)   *  ACCT-ZAIKAISU)
                           COMPUTE    WRK-KINGAKU-JI  =
                                      WRK-KINGAKU-JI  +
                                 (WRK-TNS-TEN(IDX3)   *  ACCT-ZAIKAISU)
                        END-IF
                        IF   ACCT-ZAIKBN     =  2
                           IF  WRK-PARA-JIBAIPRTKBN = "1"
                              MOVE   ZERO    TO    RECE41-KHNTEN(2)
                              MOVE   1       TO    FLG-KHNTEN2-JI2
                           END-IF
                           COMPUTE    WRK-RECE4G-TENSU(2)  =
                                      WRK-RECE4G-TENSU(2)  +
                                     (WK-ZAITEN   *   WK-ZAIKAISU)
                        END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  WRK-TNS-GAITENTTLKBN(IDX3)
      *      （基本手技）
                    WHEN  120
                      IF    SRY-SRYCD(IDX3) =  CONS-DOUJITU-SAI   OR
                                               CONS-DOUJITU-SAI2  OR
                                               CONS-DOUJITU-DEN   OR
                                               CONS-DOUJITU-DEN2  OR
                                               CONS-DOUJITU-DEN3  OR
                                               CONS-DOUJITU-DEN4  OR
                                               CONS-DOUJITU-GAI   OR
                                               CONS-DOUJITU2-GAI  OR
                                               CONS-DOUJITU3-GAI
                        IF ( WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0" )
                        OR ( SRY-SRYCD(IDX3)(1:1)       NOT = "1" )
                        OR ( SRY-SRYCD(IDX3) = CONS-YAKRENKEI     )
                            CONTINUE
                        ELSE
                            ADD   WK-ZAIKAISU  TO   RECE41-KAISU(2)
                        END-IF
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(2)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                          ELSE
                            IF RECE41-KHNTEN(2) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(2)
                              MOVE   1       TO    FLG-KHNTEN2-JI2
                            END-IF
                          END-IF
                        END-IF
                        COMPUTE    RECE41-TENSU(2)   =
                                   RECE41-TENSU(2)   +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE    TBL-SYUTEN-JI(2)  =
                                   TBL-SYUTEN-JI(2)  +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                      ELSE
                       IF  (SRY-SRYCD(IDX3) =  CONS-JIKANTAI1
                                            OR CONS-JIKANTAI2
                                            OR CONS-JIKANTAI3
                                            OR CONS-MESAIKSN
                                            OR CONS-CHIHOKATU
                                            OR CONS-CHIHOKAT2
                                            OR CONS-CHIHOKAT3
                                            OR CONS-CHIHOKAT4
                                            OR CONS-YAKRENKEI
                                            OR CONS-NINPU13-COMMENT
                                            OR CONS-NINPU17-COMMENT)
                       AND (RECE41-SRYYM   >=  "201204"            )
                        COMPUTE    RECE41-TENSU(8)   =
                                   RECE41-TENSU(8)   +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE    TBL-SYUTEN-JI(8)  =
                                   TBL-SYUTEN-JI(8)  +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       ELSE
                        IF   RECE41-SRYYM  >= "200604"
                          IF  SRY-SRYCD(IDX3)  =  "112000970" OR
                                                  "112006270"
                            COMPUTE  CNT-NYUYOJI2 =  CNT-NYUYOJI2
                                                  +  WK-ZAIKAISU
                          END-IF
                        END-IF
                        IF ( SRY-SRYCD(IDX3)     =   CONS-KEIZOKU1  OR
                                                     CONS-KEIZOKU2 )
                        OR ( WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0"  )
                        OR ( SRY-SRYCD(IDX3)(1:1)       NOT = "1"  )
                        OR ( SRY-SRYCD(IDX3) = CONS-YAKRENKEI      )
                            CONTINUE
                        ELSE
                            ADD   WK-ZAIKAISU  TO   RECE41-KAISU(2)
                            ADD   WK-ZAIKAISU  TO   CNT-SAISIN-ETC
                        END-IF
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(2)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                          ELSE
                            IF RECE41-KHNTEN(2) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(2)
                              MOVE   1       TO    FLG-KHNTEN2-JI2
                            END-IF
                          END-IF
                        END-IF
                        COMPUTE    RECE41-TENSU(2)   =
                                   RECE41-TENSU(2)   +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE    TBL-SYUTEN-JI(2)  =
                                   TBL-SYUTEN-JI(2)  +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       END-IF
                      END-IF
      *      （外来管理加算）
                    WHEN  122
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(3)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(3)
                          ELSE
                            IF RECE41-KHNTEN(3) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(3)
                              MOVE   1       TO    FLG-KHNTEN3-JI2
                            END-IF
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(3)
                        COMPUTE  RECE41-TENSU(3)   =
                                 RECE41-TENSU(3)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE  TBL-SYUTEN-JI(3)  =
                                 TBL-SYUTEN-JI(3)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （時間外）
                    WHEN  123
                        PERFORM   21012241-NYUYOJI-COUNT-SEC
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(4)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(4)
                          ELSE
                            IF RECE41-KHNTEN(4) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(4)
                              MOVE   1       TO    FLG-KHNTEN4-JI2
                            END-IF
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(4)
                        COMPUTE  RECE41-TENSU(4)   =
                                 RECE41-TENSU(4)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE  TBL-SYUTEN-JI(4)  =
                                 TBL-SYUTEN-JI(4)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （休日）
                    WHEN  124
                        PERFORM   21012241-NYUYOJI-COUNT-SEC
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(5)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(5)
                          ELSE
                            IF RECE41-KHNTEN(5) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(5)
                              MOVE   1       TO    FLG-KHNTEN5-JI2
                            END-IF
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(5)
                        COMPUTE  RECE41-TENSU(5)   =
                                 RECE41-TENSU(5)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE  TBL-SYUTEN-JI(5)  =
                                 TBL-SYUTEN-JI(5)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （深夜）
                    WHEN  125
                        PERFORM   21012241-NYUYOJI-COUNT-SEC
                        IF  WRK-PARA-JIBAIPRTKBN = "1"
                          IF    RECE41-KHNTEN(6)   =   ZERO
                            MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(6)
                          ELSE
                            IF RECE41-KHNTEN(6) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO    RECE41-KHNTEN(6)
                              MOVE   1       TO    FLG-KHNTEN6-JI2
                            END-IF
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(6)
                        COMPUTE  RECE41-TENSU(6)   =
                                 RECE41-TENSU(6)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        COMPUTE  TBL-SYUTEN-JI(6)  =
                                 TBL-SYUTEN-JI(6)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （その他）
                    WHEN  OTHER
                        IF   ACCT-ZAIKBN     =  2
                           IF  WRK-PARA-JIBAIPRTKBN = "1"
                              MOVE   ZERO    TO    RECE41-KHNTEN(2)
                              MOVE   1       TO    FLG-KHNTEN2-JI2
                           END-IF
                           COMPUTE    WRK-RECE4G-TENSU(2)  =
                                      WRK-RECE4G-TENSU(2)  +
                                     (WK-ZAITEN   *   WK-ZAIKAISU)
                        END-IF
                   END-EVALUATE
                 END-IF
      *    指導のレセ点数欄の編集
               WHEN    "13"
                 IF   (RECE41-HKNKBN    =  "4")
                 AND  (RECE41-JIBAIKBN  =  "1")
                     IF   (SRY-SRYCD(IDX3) =  CONS-ROUSAI33)
                     AND  (RECE41-SRYYM   >=  "201307"     )
                             COMPUTE    WRK-KINGAKU-JI  =
                                        WRK-KINGAKU-JI  +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     ELSE
                       IF ((SRY-SRYCD(IDX3) =
                            CONS-ROUSAI9  OR  CONS-ROUSAI10 OR
                            CONS-ROUSAI11 OR  CONS-ROUSAI12 OR
                            CONS-ROUSAI13 OR  CONS-ROUSAI14 OR
                            CONS-ROUSAI15 OR  CONS-ROUSAI16 OR
                            CONS-ROUSAI17                       ) AND
                           (RECE41-SRYYM    <=  "201306"        ))
                       OR ((SRY-SRYCD(IDX3)  =  CONS-ROUSAI8    ) AND
                           (RECE41-SRYYM     <  "200804"        ))
                             COMPUTE    RECE41-SONOTAKIN-JYU  =
                                        RECE41-SONOTAKIN-JYU  +
                                  (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       ELSE
                         IF   ACCT-ZAIKBN     =  2
                             COMPUTE    WRK-RECE4G-TENSU(7)  =
                                        WRK-RECE4G-TENSU(7)  +
                                       (WK-ZAITEN   *   WK-ZAIKAISU)
                         ELSE
                             COMPUTE    RECE41-TENSU(7)   =
                                        RECE41-TENSU(7)   +
                                       (WK-ZAITEN   *   WK-ZAIKAISU)
                             COMPUTE    TBL-SYUTEN-JI(7)  =
                                        TBL-SYUTEN-JI(7)  +
                                       (WK-ZAITEN   *   WK-ZAIKAISU)
                         END-IF
                       END-IF
                     END-IF
                 ELSE
                     IF   ACCT-ZAIKBN     =  2
                         COMPUTE    WRK-RECE4G-TENSU(7)  =
                                    WRK-RECE4G-TENSU(7)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                         COMPUTE    RECE41-TENSU(7)   =
                                    RECE41-TENSU(7)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                         COMPUTE    TBL-SYUTEN-JI(7)  =
                                    TBL-SYUTEN-JI(7)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                 END-IF
      *    在宅のレセ点数欄の編集
               WHEN    "14"
                 IF  ACCT-ZAIKBN   =    2
                   COMPUTE    WRK-RECE4G-TENSU(8)  =
                              WRK-RECE4G-TENSU(8)  +
                             (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   MOVE      ZERO            TO   FLG-ZAITAKU
      *            往診・特別往診（時間加算）
                   IF    FLG-OSINKBN         =   1
                       MOVE         1        TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(8)   =
                                 RECE41-TENSU(8)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                       COMPUTE   TBL-SYUTEN-JI(8)  =
                                 TBL-SYUTEN-JI(8)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            夜間
                   IF    FLG-OSINKBN         =    2
                       MOVE   1              TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(8)   =
                                 RECE41-TENSU(8)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                       COMPUTE   TBL-SYUTEN-JI(8)  =
                                 TBL-SYUTEN-JI(8)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            深夜・緊急
                   IF    FLG-OSINKBN         =    3
                       MOVE   1              TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(8)   =
                                 RECE41-TENSU(8)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                       COMPUTE   TBL-SYUTEN-JI(8)  =
                                 TBL-SYUTEN-JI(8)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            在宅患者訪問診療
                   IF (( WRK-TNS-OSINKBN(IDX3) =     1          )  AND
                       ((SRY-SRYCD(IDX3)   NOT =    "114000110")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001610")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114012070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029270")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030170")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030270")))
                   OR (  FLG-OSINKBN           =     9           )
                       MOVE   1              TO   FLG-ZAITAKU
                       COMPUTE   RECE41-TENSU(8)   =
                                 RECE41-TENSU(8)   +
                                (WK-SYUTEN         * WK-ZAIKAISU)
                       COMPUTE   TBL-SYUTEN-JI(8)  =
                                 TBL-SYUTEN-JI(8)  +
                                (WK-SYUTEN         * WK-ZAIKAISU)
                   END-IF
      *            その他
                   IF    FLG-ZAITAKU    =   ZERO
                       COMPUTE   RECE41-TENSU(8)   =
                                 RECE41-TENSU(8)   +
                                (WK-SYUTEN     *   WK-ZAIKAISU)
                       COMPUTE   TBL-SYUTEN-JI(8)  =
                                 TBL-SYUTEN-JI(8)  +
                                (WK-SYUTEN     *   WK-ZAIKAISU)
                   END-IF
      *            薬剤
                   COMPUTE   RECE41-TENSU(8)   =
                             RECE41-TENSU(8)   +
                             (WK-KIZAITEN *   WK-ZAIKAISU)  +
                             (WK-YKZTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(8)  =
                             TBL-YKZTEN-JI(8)  +
                             (WK-KIZAITEN *   WK-ZAIKAISU)  +
                             (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    投薬のレセ点数欄の編集
               WHEN    "21"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN
                                            OR CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU(10)   =
                                 RECE41-TENSU(10)   -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   TBL-YKZTEN-JI(10)  =
                                 TBL-YKZTEN-JI(10)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(10)
                       COMPUTE   RECE41-TENSU(10)   =
                                 RECE41-TENSU(10)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   TBL-YKZTEN-JI(10)  =
                                 TBL-YKZTEN-JI(10)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                     IF   SRY-SRYCD(IDX3)   =    CONS-FUNSAI-COMMENT
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(10)
                       COMPUTE   RECE41-TENSU(10)   =
                                 RECE41-TENSU(10)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   TBL-YKZTEN-JI(10)  =
                                 TBL-YKZTEN-JI(10)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE   
                       IF    RECE41-KHNTEN(11)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3)  TO  RECE41-KHNTEN(11)
                       ELSE
                          IF   RECE41-KHNTEN(11) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE41-KHNTEN(11)
                               MOVE   1       TO    FLG-KHNTEN11-JI2
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(11)
                       COMPUTE   RECE41-TENSU(11)   =
                                 RECE41-TENSU(11)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       COMPUTE   TBL-SYUTEN-JI(11)  =
                                 TBL-SYUTEN-JI(11)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     END-IF   
                   END-IF
               WHEN    "22"
                 IF    SRY-SRYCD(IDX3)      =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                   COMPUTE   RECE41-TENSU(12)   =
                             RECE41-TENSU(12)   -
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(12)  =
                             TBL-YKZTEN-JI(12)  -
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU    TO   RECE41-KAISU(12)
                   COMPUTE   RECE41-TENSU(12)   =
                             RECE41-TENSU(12)   +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(12)  =
                             TBL-YKZTEN-JI(12)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 END-IF
               WHEN    "23"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU(13)   =
                                 RECE41-TENSU(13)   -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   TBL-YKZTEN-JI(13)  =
                                 TBL-YKZTEN-JI(13)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(13)
                       COMPUTE   RECE41-TENSU(13)   =
                                 RECE41-TENSU(13)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   TBL-YKZTEN-JI(13)  =
                                 TBL-YKZTEN-JI(13)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                       IF    RECE41-KHNTEN(14)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3)  TO  RECE41-KHNTEN(14)
                       ELSE
                          IF   RECE41-KHNTEN(14) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE41-KHNTEN(14)
                               MOVE   1       TO    FLG-KHNTEN14-JI2
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(14)
                       COMPUTE   RECE41-TENSU(14)   =
                                 RECE41-TENSU(14)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       COMPUTE   TBL-SYUTEN-JI(14)  =
                                 TBL-SYUTEN-JI(14)  +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF
      *    処方のレセ点数欄の編集
               WHEN    "25"
                   IF  SRY-SRYCD(IDX3) = "120002170" OR "120002270" OR
                                         "120003170" OR "120003370" OR
                                         "120003870" OR
                                         "120004070" OR "120004170" OR
                                         "120004370" OR "120004470"
                      COMPUTE  WRK-SYOHOU-KAISU  =  WRK-SYOHOU-KAISU
                                                 +  ACCT-ZAIKAISU
                   END-IF
                   IF    WK-ZAITEN   NOT =  ZERO
                     IF    RECE41-KHNTEN(15)     = ZERO
                      MOVE  WK-ZAITEN     TO   RECE41-KHNTEN(15)
                     ELSE
                      IF   RECE41-KHNTEN(15) NOT = WK-ZAITEN
                            MOVE   ZERO   TO   RECE41-KHNTEN(15)
                            MOVE   1      TO   FLG-KHNTEN15-JI2
                      END-IF
                     END-IF
                   END-IF
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    ACCT-ZAIKAISU   TO    RECE41-KAISU(15)
                   END-IF
                   COMPUTE   RECE41-TENSU(15)   =
                             RECE41-TENSU(15)   +
                            (WK-ZAITEN   *   ACCT-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(15)  =
                             TBL-SYUTEN-JI(15)  +
                            (WK-ZAITEN   *   ACCT-ZAIKAISU)
      *    麻毒のレセ点数欄の編集
               WHEN    "26"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE41-KAISU(16)
                   END-IF
                   IF SRY-SRYCD(IDX3)      =    "120001310"
                    COMPUTE WRK-MADOKU-SHOHO = WRK-MADOKU-SHOHO +
                                               WK-ZAIKAISU 
                   END-IF
                   COMPUTE   RECE41-TENSU(16)   =
                             RECE41-TENSU(16)   +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(16)  =
                             TBL-SYUTEN-JI(16)  +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *    調基のレセ点数欄の編集
               WHEN    "27"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE41-KAISU(17)
                   END-IF
                   COMPUTE   RECE41-TENSU(17)   =
                             RECE41-TENSU(17)   +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(17)  =
                             TBL-SYUTEN-JI(17)  +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *    皮下筋肉内注射のレセ点数欄の編集
               WHEN    "31"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(19)
                   COMPUTE   RECE41-TENSU(19)   =
                             RECE41-TENSU(19)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(19)  =
                             TBL-SYUTEN-JI(19)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(19)   =
                             RECE41-TENSU(19)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(19)  =
                             TBL-YKZTEN-JI(19)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    静脈内注射のレセ点数欄の編集
               WHEN    "32"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(20)
                   COMPUTE   RECE41-TENSU(20)   =
                             RECE41-TENSU(20)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(20)  =
                             TBL-SYUTEN-JI(20)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(20)   =
                             RECE41-TENSU(20)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(20)  =
                             TBL-YKZTEN-JI(20)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    その他注射のレセ点数欄の編集
               WHEN    "33"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(21)
                   COMPUTE   RECE41-TENSU(21)   =
                             RECE41-TENSU(21)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(21)  =
                             TBL-SYUTEN-JI(21)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(21)   =
                             RECE41-TENSU(21)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(21)  =
                             TBL-YKZTEN-JI(21)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    処置のレセ点数欄の編集
               WHEN    "40"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(23)
                   END-IF
                   COMPUTE   RECE41-TENSU(23)   =
                             RECE41-TENSU(23)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(23)  =
                             TBL-SYUTEN-JI(23)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(24)   =
                             RECE41-TENSU(24)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(24)  =
                             TBL-YKZTEN-JI(24)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    手術のレセ点数欄の編集
               WHEN    "50"
               WHEN    "54"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(26)
                   END-IF
                   COMPUTE   RECE41-TENSU(26)   =
                             RECE41-TENSU(26)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(26)  =
                             TBL-SYUTEN-JI(26)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(27)   =
                             RECE41-TENSU(27)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(27)  =
                             TBL-YKZTEN-JI(27)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    検査のレセ点数欄の編集
               WHEN    "60"
               WHEN    "64"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(29)
                   END-IF
                   COMPUTE   RECE41-TENSU(29)   =
                             RECE41-TENSU(29)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(29)  =
                             TBL-SYUTEN-JI(29)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    WRK-TNS-KNSJISKBN(IDX3)    =   2
                         COMPUTE   RECE41-KAISU(29)  =
                                   RECE41-KAISU(29)  -  
                                   WK-ZAIKAISU
                   END-IF
                   IF    WRK-TNS-SRYCD(IDX3)  =   CONS-SAIKETSU1  OR
                                                  CONS-SAIKETSU2  OR
                                                  CONS-SAIKETSU3
                         IF   RECE41-KAISU(29)  NOT =  ZERO
                              COMPUTE   RECE41-KAISU(29)  =
                                        RECE41-KAISU(29)  -   
                                        WK-ZAIKAISU
                         END-IF
                   END-IF
                   COMPUTE   RECE41-TENSU(30)   =
                             RECE41-TENSU(30)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(30)  =
                             TBL-YKZTEN-JI(30)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    画像診断のレセ点数欄の編集
               WHEN    "70"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(32)
                   END-IF
                   COMPUTE   RECE41-TENSU(32)   =
                             RECE41-TENSU(32)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-SYUTEN-JI(32)  =
                             TBL-SYUTEN-JI(32)  +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(33)   =
                             RECE41-TENSU(33)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
                   COMPUTE   TBL-YKZTEN-JI(33)  =
                             TBL-YKZTEN-JI(33)  +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    その他のレセ点数欄の編集
               WHEN    "80"
                 IF   ((SRY-SRYCD(IDX3) =
                        CONS-ROUSAI32 OR
                        CONS-ROUSAI20 OR  CONS-ROUSAI21 OR
                        CONS-ROUSAI22 OR  CONS-ROUSAI23 OR
                        CONS-ROUSAI24 OR  CONS-ROUSAI25 OR
                        CONS-ROUSAI26 OR  CONS-ROUSAI27 OR
                        CONS-ROUSAI28 OR  CONS-ROUSAI29 OR
                        CONS-ROUSAI30 OR  CONS-ROUSAI31 OR
                        CONS-ROUSAI39                       ) AND
                       (RECE41-SRYYM    >=  "201307"        ))
                   IF   SRY-SRYCD(IDX3) = CONS-ROUSAI32
                             COMPUTE  WRK-KINGAKU-JI   =
                                      WRK-KINGAKU-JI   +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   ELSE
                             COMPUTE  RECE41-SONOTAKIN-JYU  =
                                      RECE41-SONOTAKIN-JYU  +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF
                 ELSE
                   IF ( ACCT-SRYKBN          =  "80"    )   AND
                      ( SRY-SRYCD(IDX3)(1:5) =  "09591" OR 
                                                "09592" )
                        CONTINUE
                   ELSE
                    IF ((ACCT-SRYKBN          =  "80"    )  AND
                        (SRY-SRYCD(IDX3)(1:5) =  "09593" ))
                    OR ((SRY-SRYCD(IDX3) >= "101801010" AND
                                         <= "101801020"  )  AND
                        (RECE41-SRYYM    >= "201307"     ))
                    OR ((SRY-SRYCD(IDX3)  = "101801030"  )  AND
                        (RECE41-SRYYM    >= "201307"     ))
                     IF   SRY-SRYCD(IDX3)(1:5) = "09593"
                       IF   (RECE41-HKNKBN    =  "4")
                       AND  (RECE41-JIBAIKBN  =  "1")
                         EVALUATE  WRK-TNS-JIBAISYUKEIKBN(IDX3)
                           WHEN       0
                           WHEN       5
                             COMPUTE  RECE41-SONOTAKIN-JYU  =
                                      RECE41-SONOTAKIN-JYU  +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                           WHEN       1
                           WHEN       2
                           WHEN       3
                           WHEN       4
                             COMPUTE  WRK-KINGAKU-JI   =
                                      WRK-KINGAKU-JI   +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                         END-EVALUATE
                       ELSE
                             COMPUTE  RECE41-SONOTAKIN-JYU  =
                                      RECE41-SONOTAKIN-JYU  +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       END-IF
                     ELSE
                       IF  SRY-SRYCD(IDX3)  =  "101801030"
                             COMPUTE  WRK-FUTANWARI  =
                                      WRK-TNS-TEN(IDX3) / 100
                             COMPUTE  WRK-KEISAN-KG2 =
                                     (WRK-TEN-KG2       * WRK-FUTANWARI)
                             COMPUTE  RECE41-SONOTAKIN-JYU  =
                                      RECE41-SONOTAKIN-JYU  +
                                     (WRK-KEISAN-KG2    * ACCT-ZAIKAISU)
                       ELSE
                             COMPUTE  RECE41-SONOTAKIN-JYU  =
                                      RECE41-SONOTAKIN-JYU  +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                             COMPUTE  WRK-TEN-KG2 = WRK-TNS-TEN(IDX3)
                       END-IF
                     END-IF
                    ELSE                                                
                     IF  RECE41-HKNKBN        =    "4"
                     AND RECE41-JIBAIKBN      =    "1"
                     AND SRY-SRYCD(IDX3)      =    CONS-RYOYOTEATE
                       COMPUTE    RECE41-SONOTAKIN-JYU  =               
                                  RECE41-SONOTAKIN-JYU  +               
                                 (WRK-RYOYOTEATE  *   ACCT-ZAIKAISU)    
                     ELSE
                      IF  SRY-SRYCD(IDX3) =  CONS-SHOHOKSN1
                                          OR CONS-SHOHOKSN2
                                          OR CONS-SHOHOKSN3
                                          OR CONS-SHOHOKSN4
                                          OR CONS-SHOHOKSN5
                                          OR CONS-SHOHOKSN6
                                          OR CONS-SHOHOKSN7
                                          OR CONS-SHOHOKSN8
                         COMPUTE  WRK-SYOSEN-KAISU  =  WRK-SYOSEN-KAISU
                                                    +  ACCT-ZAIKAISU
                      END-IF
                      IF   SRY-SRYCD(IDX3)    =    CONS-SHOHOSEN1 OR
                                                   CONS-SHOHOSEN2 OR
                                                   CONS-SHOHOSEN3 OR
                                                   CONS-SHOHOSEN4 OR
                                                   CONS-SHOHOSEN5 OR
                                                   CONS-SHOHOKSN1 OR
                                                   CONS-SHOHOKSN2 OR
                                                   CONS-SHOHOKSN3 OR
                                                   CONS-SHOHOKSN4 OR
                                                   CONS-SHOHOKSN5 OR
                                                   CONS-SHOHOKSN6 OR
                                                   CONS-SHOHOKSN7 OR
                                                   CONS-SHOHOKSN8
                          ADD  ACCT-ZAIKAISU  TO  RECE41-KAISU(35)
                          COMPUTE   RECE41-TENSU(35)   =
                                    RECE41-TENSU(35)   +
                                   (WK-ZAITEN  *   ACCT-ZAIKAISU)
                          COMPUTE   TBL-SYUTEN-JI(35)  =
                                    TBL-SYUTEN-JI(35)  +
                                   (WK-ZAITEN  *   ACCT-ZAIKAISU)
                      ELSE
                          EVALUATE   WRK-PARA-JIBAIPRTKBN
                           WHEN      "0"
                             COMPUTE   RECE41-TENSU(23)   =
                                       RECE41-TENSU(23)   +
                                      (WK-SYUTEN  *   ACCT-ZAIKAISU)
                             COMPUTE   TBL-SYUTEN-JI(23)  =
                                       TBL-SYUTEN-JI(23)  +
                                      (WK-SYUTEN  *   ACCT-ZAIKAISU)
                           WHEN      "1"
                             COMPUTE   RECE41-TENSU(36)   =
                                       RECE41-TENSU(36)   +
                                      (WK-SYUTEN  *   ACCT-ZAIKAISU)
                             COMPUTE   TBL-SYUTEN-JI(36)  =
                                       TBL-SYUTEN-JI(36)  +
                                      (WK-SYUTEN  *   ACCT-ZAIKAISU)
                          END-EVALUATE
                          IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                            COMPUTE   RECE41-TENSU(7)   =
                                      RECE41-TENSU(7)   +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                            COMPUTE   TBL-SYUTEN-JI(7)  =
                                      TBL-SYUTEN-JI(7)  +
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                            EVALUATE  WRK-PARA-JIBAIPRTKBN
                             WHEN      "0"
                              COMPUTE   RECE41-TENSU(23)   =
                                        RECE41-TENSU(23)   -
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                              COMPUTE   TBL-SYUTEN-JI(23)  =
                                        TBL-SYUTEN-JI(23)  -
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                             WHEN      "1"
                              COMPUTE   RECE41-TENSU(36)   =
                                        RECE41-TENSU(36)   -
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                              COMPUTE   TBL-SYUTEN-JI(36)  =
                                        TBL-SYUTEN-JI(36)  -
                                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                            END-EVALUATE
                          END-IF
                      END-IF
                      EVALUATE  WRK-PARA-JIBAIPRTKBN
                       WHEN      "0"
                        IF  SRY-SRYCD(IDX3) = CONS-RYOYOTEATE
                         COMPUTE   RECE41-TENSU(37)   =
                                   RECE41-TENSU(37)   +
                                  (WK-YKZTEN   *   ACCT-ZAIKAISU)
                         COMPUTE   TBL-YKZTEN-JI(37)  =
                                   TBL-YKZTEN-JI(37)  +
                                  (WK-YKZTEN   *   ACCT-ZAIKAISU)
                        ELSE
                         COMPUTE   RECE41-TENSU(24)   =
                                   RECE41-TENSU(24)   +
                                  (WK-YKZTEN   *   ACCT-ZAIKAISU)
                         COMPUTE   TBL-YKZTEN-JI(24)  =
                                   TBL-YKZTEN-JI(24)  +
                                  (WK-YKZTEN   *   ACCT-ZAIKAISU)
                        END-IF
                       WHEN      "1"
                         COMPUTE   RECE41-TENSU(37)   =
                                   RECE41-TENSU(37)   +
                                  (WK-YKZTEN   *   ACCT-ZAIKAISU)
                         COMPUTE   TBL-YKZTEN-JI(37)  =
                                   TBL-YKZTEN-JI(37)  +
                                  (WK-YKZTEN   *   ACCT-ZAIKAISU)
                      END-EVALUATE
                     END-IF
                    END-IF                                              
                   END-IF
                 END-IF
           END-EVALUATE
      *
           .
      *
       2101224-RECE-LEFT-SET4-EXT.
           EXIT.
      *
      *****************************************************************
      *    乳幼児加算のカウント
      *****************************************************************
       21012241-NYUYOJI-COUNT-SEC               SECTION.
      *
           IF   RECE41-SRYYM  >= "200604"
              IF  SRY-SRYCD(IDX3) = "112015170" OR
                                    "112015270" OR
                                    "112015370" OR
                                    "112015470" OR
                                    "112014470" OR
                                    "112014570" OR
                                    "112014670" OR
                                    "112014770" OR
                                    "112014870" OR
                                    "112014970" OR
                                    "112015070" OR
                                    "112014170" OR
                                    "112014270" OR
                                    "112014370"
                     COMPUTE  CNT-NYUYOJI2  =  CNT-NYUYOJI2
                                            +  WK-ZAIKAISU
              END-IF
           END-IF
           .
      *
       21012241-NYUYOJI-COUNT-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送
      *****************************************************************
       2101225-RECE-LEFT-SET5-SEC               SECTION.
      *
           EVALUATE    SRY-SRYKBN
      *    初診のレセ点数欄の編集
               WHEN    "11"
                   IF ( SRY-SRYCD(IDX3) = CONS-ROUSAI1  OR
                                          CONS-ROUSAI18 )
                   OR ((SRY-SRYCD(IDX3) = CONS-ROUSAI3 ) AND
                       (RECE41-SRYYM   <=   "201306"   ))
                      CONTINUE
                   ELSE
                      IF   WRK-TNS-DATAKBN(IDX3)  =   2
                        EVALUATE  WRK-TNS-TIMEKSNKBN(IDX3)
                          WHEN    1
                          WHEN    5
                          WHEN    6
                              MOVE  "1"     TO   RECE41-SHOSHINTIME
                          WHEN    3
                              MOVE  "2"     TO   RECE41-SHOSHINTIME
                          WHEN    4
                              MOVE  "3"     TO   RECE41-SHOSHINTIME
                        END-EVALUATE
                      END-IF
                      IF    RECE41-KOMUKBN  =   "2"
                        IF  WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0"
                        OR  SRY-SRYCD(IDX3)(1:1)       NOT = "1"
                            CONTINUE
                        ELSE
                            ADD   WK-ZAIKAISU  TO   RECE41-KAISU(1)
                        END-IF
                      ELSE
                        IF  WRK-TNS-DATAKBN(IDX3)  =   2
                          IF   SRY-SRYCD(IDX3) = "111012370"
                            CONTINUE
                          ELSE
                            ADD   WK-ZAIKAISU  TO   RECE41-KAISU(1)
                          END-IF
                        END-IF
                      END-IF
                      COMPUTE    RECE41-TENSU(1)    =
                                 RECE41-TENSU(1)    +
                                 (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF
      *    再診のレセ点数欄の編集（集計方法変更後）
               WHEN    "12"
                   EVALUATE  WRK-TNS-GAITENTTLKBN(IDX3)
      *      （基本手技）
                    WHEN  120
                     IF ((SRY-SRYCD(IDX3) =  CONS-ROUSAI5  OR
                                             CONS-ROUSAI6  OR
                                             CONS-ROUSAI7  OR
                                             CONS-ROUSAI19) AND
                         (RECE41-SRYYM   <=    "201306"   ))
                     OR ((SRY-SRYCD(IDX3) =  CONS-ROUSAI34 OR
                                             CONS-ROUSAI35 OR
                                             CONS-ROUSAI36 OR
                                             CONS-ROUSAI37 OR
                                             CONS-ROUSAI38 OR
                                             CONS-ROUSAI5 ) AND
                         (RECE41-SRYYM   >=    "201307"   ))
                         CONTINUE
                     ELSE
                       IF SRY-SRYCD(IDX3) =  CONS-GAIRAIRYO1
                                          OR CONS-GAIRAIRYO3
                                          OR CONS-GAIRAIRYO4
                                          OR CONS-GAIRAIRYO5
                                          OR CONS-GAIRAIRYO6
                                          OR CONS-GAIRAIRYO7
                                          OR CONS-DOUJITU-GAI
                                          OR CONS-DOUJITU2-GAI
                                          OR CONS-DOUJITU3-GAI
                                          OR CONS-NINPU17-COMMENT
                        IF    RECE41-SRYYM  >= "201804"
                           PERFORM  21012251-RECE-LEFT12-HEN1-SEC
                        ELSE
                         IF    RECE41-KHNTEN(3)   =   ZERO
                           MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(3)
                         ELSE
                           IF RECE41-KHNTEN(3) NOT = WRK-TNS-TEN(IDX3)
                             MOVE   ZERO    TO    RECE41-KHNTEN(3)
                             MOVE   1       TO    FLG-KHNTEN3-KO
                           END-IF
                         END-IF
                         IF  WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0"
                         OR  SRY-SRYCD(IDX3)(1:1)       NOT = "1"
                             CONTINUE
                         ELSE
                             ADD   WK-ZAIKAISU  TO   RECE41-KAISU(3)
                         END-IF
                         COMPUTE    RECE41-TENSU(3)   =
                                    RECE41-TENSU(3)   +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        END-IF
                       ELSE
                        IF    RECE41-SRYYM  >= "201804"
                           PERFORM  21012251-RECE-LEFT12-HEN2-SEC
                        ELSE
                         IF     RECE41-KOMUKBN  =   "2"
                           IF ( SRY-SRYCD(IDX3)   =   CONS-KEIZOKU1  OR
                                                      CONS-KEIZOKU2  )
                           OR ( WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0" )
                           OR ( SRY-SRYCD(IDX3)(1:1)       NOT = "1" )
                             CONTINUE
                           ELSE
                             ADD    WK-ZAIKAISU  TO  RECE41-KAISU(2)
                             IF  SRY-SRYCD(IDX3)  =  CONS-DOUJITU-SAI
                                                 OR  CONS-DOUJITU-SAI2
                                                 OR  CONS-DOUJITU-DEN
                                                 OR  CONS-DOUJITU-DEN2
                               ADD  WK-ZAIKAISU  TO  CNT-SAISIN-DOUJITU
                             ELSE
                               ADD  WK-ZAIKAISU  TO  CNT-SAISIN-ETC
                             END-IF
                           END-IF
                         ELSE
                           IF   FLG-COUNT-ARI  =  ZERO
                             ADD    WK-ZAIKAISU  TO  RECE41-KAISU(2)
                             MOVE   1            TO  FLG-COUNT-ARI
                           END-IF
                         END-IF
                         IF ( SRY-SRYCD(IDX3)     =   CONS-KEIZOKU1  OR
                                                      CONS-KEIZOKU2 )
                           MOVE   ZERO    TO    RECE41-KHNTEN(2)
                           MOVE   1       TO    FLG-KHNTEN2-KO
                         ELSE
                           IF  (SRY-SRYCD(IDX3) =  CONS-JIKANTAI1  OR
                                                   CONS-JIKANTAI2  OR
                                                   CONS-JIKANTAI3  OR
                                                   CONS-MESAIKSN   OR
                                                   CONS-CHIHOKATU  OR
                                                   CONS-CHIHOKAT2  OR
                                                   "101989030"     OR
                                                   "101989070"       )
                           AND (RECE41-SRYYM   >=  "201004"          )
                             IF  SRY-SRYCD(IDX3)  =  CONS-JIKANTAI1
                               COMPUTE  CNT-JIKANTAI1 = CNT-JIKANTAI1
                                                      + WK-ZAIKAISU
                               IF   FLG-JIKANTAI1-ARI  =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                 TO  RECE41-KHNTEN(2)
                                  MOVE     1     TO  FLG-JIKANTAI1-ARI
                               END-IF
                             END-IF
                             IF  SRY-SRYCD(IDX3)  =  CONS-JIKANTAI2
                               COMPUTE  CNT-JIKANTAI2 = CNT-JIKANTAI2
                                                      + WK-ZAIKAISU
                               IF   FLG-JIKANTAI2-ARI   =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                 TO  RECE41-KHNTEN(2)
                                  MOVE     1     TO  FLG-JIKANTAI2-ARI
                               END-IF
                             END-IF
                             IF  SRY-SRYCD(IDX3)  =  CONS-JIKANTAI3
                               COMPUTE  CNT-JIKANTAI3 = CNT-JIKANTAI3
                                                      + WK-ZAIKAISU
                               IF   FLG-JIKANTAI3-ARI  =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                 TO  RECE41-KHNTEN(2)
                                  MOVE     1     TO  FLG-JIKANTAI3-ARI
                               END-IF
                             END-IF
                             IF  SRY-SRYCD(IDX3)  =  CONS-MESAIKSN
                               COMPUTE  CNT-MESAIKSN =  CNT-MESAIKSN
                                                     +  WK-ZAIKAISU
                               IF   FLG-MESAIKSN-ARI   =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                 TO  RECE41-KHNTEN(2)
                                  MOVE     1     TO  FLG-MESAIKSN-ARI
                               END-IF
                             END-IF
                             IF  SRY-SRYCD(IDX3)  =  CONS-CHIHOKATU
                               COMPUTE  CNT-CHIHOKATU = CNT-CHIHOKATU
                                                      + WK-ZAIKAISU
                               IF   FLG-CHIHOKATU-ARI  =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                 TO  RECE41-KHNTEN(2)
                                  MOVE     1     TO  FLG-CHIHOKATU-ARI
                               END-IF
                             END-IF
                             IF  SRY-SRYCD(IDX3)  =  CONS-CHIHOKAT2
                               COMPUTE  CNT-CHIHOKAT2 = CNT-CHIHOKAT2
                                                      + WK-ZAIKAISU
                               IF   FLG-CHIHOKAT2-ARI  =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                 TO  RECE41-KHNTEN(2)
                                  MOVE     1     TO  FLG-CHIHOKAT2-ARI
                               END-IF
                             END-IF
                             IF  SRY-SRYCD(IDX3)  =  "101989030"
                               COMPUTE  CNT-SAITOKKSN = CNT-SAITOKKSN
                                                      + WK-ZAIKAISU
                               IF   FLG-SAITOKKSN-ARI  =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                 TO  RECE41-KHNTEN(2)
                                  MOVE     1     TO  FLG-SAITOKKSN-ARI
                               END-IF
                             END-IF
                             IF  SRY-SRYCD(IDX3)  =  "101989070"
                               COMPUTE  CNT-SAITOKKSN2
                                                      = CNT-SAITOKKSN2
                                                      + WK-ZAIKAISU
                               IF   FLG-SAITOKKSN-ARI2 =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                 TO  RECE41-KHNTEN(2)
                                  MOVE     1     TO  FLG-SAITOKKSN-ARI2
                               END-IF
                             END-IF
                           ELSE
                             IF   FLG-SAISIN-ARI   =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                 TO  RECE41-KHNTEN(2)
                                  MOVE     1     TO  FLG-SAISIN-ARI
                             END-IF
                           END-IF
                         END-IF
                         COMPUTE    RECE41-TENSU(2)   =
                                    RECE41-TENSU(2)   +
                                   (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                        END-IF
                       END-IF
                     END-IF
      *      （外来管理加算）
                    WHEN  122
                        IF    RECE41-KHNTEN(5)   =   ZERO
                          MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(5)
                        ELSE
                          IF RECE41-KHNTEN(5) NOT = WRK-TNS-TEN(IDX3)
                            MOVE   ZERO    TO    RECE41-KHNTEN(5)
                            MOVE   1       TO    FLG-KHNTEN5-KO
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(5)
                        COMPUTE  RECE41-TENSU(5)   =
                                 RECE41-TENSU(5)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （時間外）
                    WHEN  123
                        IF    RECE41-KHNTEN(6)   =   ZERO
                          MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(6)
                        ELSE
                          IF RECE41-KHNTEN(6) NOT = WRK-TNS-TEN(IDX3)
                            MOVE   ZERO    TO    RECE41-KHNTEN(6)
                            MOVE   1       TO    FLG-KHNTEN6-KO
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(6)
                        COMPUTE  RECE41-TENSU(6)   =
                                 RECE41-TENSU(6)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （休日）
                    WHEN  124
                        IF    RECE41-KHNTEN(7)   =   ZERO
                          MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(7)
                        ELSE
                          IF RECE41-KHNTEN(7) NOT = WRK-TNS-TEN(IDX3)
                            MOVE   ZERO    TO    RECE41-KHNTEN(7)
                            MOVE   1       TO    FLG-KHNTEN7-KO
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(7)
                        COMPUTE  RECE41-TENSU(7)   =
                                 RECE41-TENSU(7)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （深夜）
                    WHEN  125
                        IF    RECE41-KHNTEN(8)   =   ZERO
                          MOVE WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(8)
                        ELSE
                          IF RECE41-KHNTEN(8) NOT = WRK-TNS-TEN(IDX3)
                            MOVE   ZERO    TO    RECE41-KHNTEN(8)
                            MOVE   1       TO    FLG-KHNTEN8-KO
                          END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE41-KAISU(8)
                        COMPUTE  RECE41-TENSU(8)   =
                                 RECE41-TENSU(8)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *      （その他）
                    WHEN  OTHER 
                        IF   ACCT-ZAIKBN     =  2
                           MOVE   ZERO    TO    RECE41-KHNTEN(3)
                           MOVE   1       TO    FLG-KHNTEN3-KO
                           COMPUTE    WRK-RECE4G-TENSU(3)  =
                                      WRK-RECE4G-TENSU(3)  +
                                     (WK-ZAITEN   *   WK-ZAIKAISU)
                        END-IF
                   END-EVALUATE
      *    指導のレセ点数欄の編集
               WHEN    "13"
                   IF ((SRY-SRYCD(IDX3) =
                        CONS-ROUSAI9  OR  CONS-ROUSAI10 OR
                        CONS-ROUSAI11 OR  CONS-ROUSAI12 OR
                        CONS-ROUSAI13 OR  CONS-ROUSAI14 OR
                        CONS-ROUSAI15 OR  CONS-ROUSAI16 OR
                        CONS-ROUSAI17                       ) AND
                       (RECE41-SRYYM    <=  "201306"        ))
                   OR ((SRY-SRYCD(IDX3)  =  CONS-ROUSAI8    ) AND
                       (RECE41-SRYYM     <  "200804"        ))
                   OR ((SRY-SRYCD(IDX3)  =  CONS-ROUSAI33   ) AND
                       (RECE41-SRYYM    >=  "201307"        ))
                         CONTINUE
                   ELSE
                     IF   ACCT-ZAIKBN     =  2
                         COMPUTE    WRK-RECE4G-TENSU(9)  =
                                    WRK-RECE4G-TENSU(9)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                         COMPUTE    RECE41-TENSU(9)   =
                                    RECE41-TENSU(9)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF                   
      *    在宅のレセ点数欄の編集
               WHEN    "14"
                 IF  ACCT-ZAIKBN   =    2
                   COMPUTE    WRK-RECE4G-TENSU(14)  =
                              WRK-RECE4G-TENSU(14)  +
                             (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   MOVE      ZERO            TO   FLG-ZAITAKU
      *            往診・特別往診（時間加算）
                   IF    FLG-OSINKBN         =   1
                       MOVE         1        TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(10)
                       COMPUTE   RECE41-TENSU(10)   =
                                 RECE41-TENSU(10)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            夜間
                   IF    FLG-OSINKBN         =    2
                       MOVE   1              TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(11)
                       COMPUTE   RECE41-TENSU(11)   =
                                 RECE41-TENSU(11)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            深夜・緊急
                   IF    FLG-OSINKBN         =    3
                       MOVE   1              TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(12)
                       COMPUTE   RECE41-TENSU(12)   =
                                 RECE41-TENSU(12)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            在宅患者訪問診療
                   IF (( WRK-TNS-OSINKBN(IDX3) =     1          )  AND
                       ((SRY-SRYCD(IDX3)   NOT =    "114000110")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001610")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114000370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114001870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114002070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114011870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114012070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017670")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017770")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017870")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114017970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029270")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029370")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029470")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029570")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114029970")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030070")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030170")   AND
                        (SRY-SRYCD(IDX3)   NOT =    "114030270")))
                   OR (  FLG-OSINKBN           =     9           )
                       MOVE   1              TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(13)
                       COMPUTE   RECE41-TENSU(13)   =
                                 RECE41-TENSU(13)   +
                                (WK-SYUTEN         * WK-ZAIKAISU)
                   END-IF
      *            その他
                   IF    FLG-ZAITAKU    =   ZERO
                       COMPUTE   RECE41-TENSU(14)   =
                                 RECE41-TENSU(14)   +
                                (WK-SYUTEN     *   WK-ZAIKAISU)
                   END-IF
      *            薬剤
                   COMPUTE   RECE41-TENSU(15)   =
                             RECE41-TENSU(15)   +
                             (WK-KIZAITEN *   WK-ZAIKAISU)  +
                             (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    投薬のレセ点数欄の編集
               WHEN    "21"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN
                                            OR CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU(16)   =
                                 RECE41-TENSU(16)   -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(16)
                       COMPUTE   RECE41-TENSU(16)   =
                                 RECE41-TENSU(16)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                     IF   SRY-SRYCD(IDX3)   =    CONS-FUNSAI-COMMENT
                       ADD   WK-ZAIKAISU       TO   RECE41-KAISU(16)
                       COMPUTE   RECE41-TENSU(16)   =
                                 RECE41-TENSU(16)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE   
                       IF    RECE41-KHNTEN(17)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3)  TO  RECE41-KHNTEN(17)
                       ELSE
                          IF   RECE41-KHNTEN(17) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE41-KHNTEN(17)
                               MOVE   1       TO    FLG-KHNTEN17-KO
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(17)
                       COMPUTE   RECE41-TENSU(17)   =
                                 RECE41-TENSU(17)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                     END-IF   
                   END-IF
               WHEN    "22"
                 IF    SRY-SRYCD(IDX3)      =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                   COMPUTE   RECE41-TENSU(18)   =
                             RECE41-TENSU(18)   -
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU    TO   RECE41-KAISU(18)
                   COMPUTE   RECE41-TENSU(18)   =
                             RECE41-TENSU(18)   +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
                 END-IF
               WHEN    "23"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  CONS-YAKTEIGEN2
                                            OR CONS-YAKTEIGEN3
                                            OR CONS-YAKTEIGEN4
                       COMPUTE   RECE41-TENSU(20)   =
                                 RECE41-TENSU(20)   -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(20)
                       COMPUTE   RECE41-TENSU(20)   =
                                 RECE41-TENSU(20)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                       IF    RECE41-KHNTEN(21)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3)  TO  RECE41-KHNTEN(21)
                       ELSE
                          IF   RECE41-KHNTEN(21) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE41-KHNTEN(21)
                               MOVE   1       TO    FLG-KHNTEN21-KO
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(21)
                       COMPUTE   RECE41-TENSU(21)   =
                                 RECE41-TENSU(21)   +
                                (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                   END-IF
      *    処方のレセ点数欄の編集
               WHEN    "25"
                   IF  SRY-SRYCD(IDX3) = "120002170" OR "120002270" OR
                                         "120003170" OR "120003370" OR
                                         "120003870" OR
                                         "120004070" OR "120004170" OR
                                         "120004370" OR "120004470"
                      COMPUTE  WRK-SYOHOU-KAISU  =  WRK-SYOHOU-KAISU
                                                 +  ACCT-ZAIKAISU
                   END-IF
                   IF    WK-ZAITEN   NOT =  ZERO
                     IF    RECE41-KHNTEN(22)     = ZERO
                      MOVE  WK-ZAITEN     TO   RECE41-KHNTEN(22)
                     ELSE
                      IF   RECE41-KHNTEN(22) NOT = WK-ZAITEN
                            MOVE   ZERO   TO   RECE41-KHNTEN(22)
                            MOVE   1      TO   FLG-KHNTEN22-KO
                      END-IF
                     END-IF
                   END-IF
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    ACCT-ZAIKAISU   TO    RECE41-KAISU(22)
                   END-IF
                   COMPUTE   RECE41-TENSU(22)   =
                             RECE41-TENSU(22)   +
                            (WK-ZAITEN   *   ACCT-ZAIKAISU)
      *    麻毒のレセ点数欄の編集
               WHEN    "26"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE41-KAISU(23)
                   END-IF
                   IF SRY-SRYCD(IDX3)      =    "120001310"
                    COMPUTE WRK-MADOKU-SHOHO = WRK-MADOKU-SHOHO +
                                               WK-ZAIKAISU 
                   END-IF
                   COMPUTE   RECE41-TENSU(23)   =
                             RECE41-TENSU(23)   +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *    調基のレセ点数欄の編集
               WHEN    "27"
                   COMPUTE   RECE41-TENSU(24)   =
                             RECE41-TENSU(24)   +
                            (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *    皮下筋肉内注射のレセ点数欄の編集
               WHEN    "31"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(25)
                   COMPUTE   RECE41-TENSU(25)  =
                             RECE41-TENSU(25)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
      *    静脈内注射のレセ点数欄の編集
               WHEN    "32"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(26)
                   COMPUTE   RECE41-TENSU(26)  =
                             RECE41-TENSU(26)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
      *    その他注射のレセ点数欄の編集
               WHEN    "33"
                   ADD    WK-ZAIKAISU     TO   RECE41-KAISU(27)
                   COMPUTE   RECE41-TENSU(27)  =
                             RECE41-TENSU(27)  +
                            (WK-ZAITEN   *   WK-ZAIKAISU)
      *    処置のレセ点数欄の編集
               WHEN    "40"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(28)
                   END-IF
                   COMPUTE   RECE41-TENSU(28)   =
                             RECE41-TENSU(28)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(29)   =
                             RECE41-TENSU(29)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    手術のレセ点数欄の編集
               WHEN    "50"
               WHEN    "54"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(30)
                   END-IF
                   COMPUTE   RECE41-TENSU(30)   =
                             RECE41-TENSU(30)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(31)   =
                             RECE41-TENSU(31)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    検査のレセ点数欄の編集
               WHEN    "60"
               WHEN    "64"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(32)
                   END-IF
                   COMPUTE   RECE41-TENSU(32)   =
                             RECE41-TENSU(32)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    WRK-TNS-KNSJISKBN(IDX3)    =   2
                         COMPUTE   RECE41-KAISU(32)  =
                                   RECE41-KAISU(32)  -  
                                   WK-ZAIKAISU
                   END-IF
                   IF    WRK-TNS-SRYCD(IDX3)  =   CONS-SAIKETSU1  OR
                                                  CONS-SAIKETSU2  OR
                                                  CONS-SAIKETSU3
                         IF   RECE41-KAISU(32)  NOT =  ZERO
                              COMPUTE   RECE41-KAISU(32)  =
                                        RECE41-KAISU(32)  -   
                                        WK-ZAIKAISU
                         END-IF
                   END-IF
                   COMPUTE   RECE41-TENSU(33)   =
                             RECE41-TENSU(33)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    画像診断のレセ点数欄の編集
               WHEN    "70"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE41-KAISU(34)
                   END-IF
                   COMPUTE   RECE41-TENSU(34)   =
                             RECE41-TENSU(34)   +
                            (WK-SYUTEN   *   WK-ZAIKAISU)
                   COMPUTE   RECE41-TENSU(35)   =
                             RECE41-TENSU(35)   +
                            (WK-YKZTEN   *   WK-ZAIKAISU)
      *    その他のレセ点数欄の編集
               WHEN    "80"
                 IF   ((SRY-SRYCD(IDX3) =
                        CONS-ROUSAI32 OR
                        CONS-ROUSAI20 OR  CONS-ROUSAI21 OR
                        CONS-ROUSAI22 OR  CONS-ROUSAI23 OR
                        CONS-ROUSAI24 OR  CONS-ROUSAI25 OR
                        CONS-ROUSAI26 OR  CONS-ROUSAI27 OR
                        CONS-ROUSAI28 OR  CONS-ROUSAI29 OR
                        CONS-ROUSAI30 OR  CONS-ROUSAI31 OR
                        CONS-ROUSAI39                       ) AND
                       (RECE41-SRYYM    >=  "201307"        ))
                       CONTINUE
                 ELSE
                   IF ((ACCT-SRYKBN          =  "80"    )  AND
                       (SRY-SRYCD(IDX3)(1:5) =  "09593" ))
                   OR ((SRY-SRYCD(IDX3) >= "101801010" AND
                                        <= "101801020"  )  AND
                       (RECE41-SRYYM    >= "201307"     ))
                   OR ((SRY-SRYCD(IDX3)  = "101801030"  )  AND
                       (RECE41-SRYYM    >= "201307"     ))
                       IF   (FLG-TAISYO           =   1     )
                       AND  (SRY-SRYCD(IDX3)(1:5) =  "09593")
                          COMPUTE WRK-ZAITENNASHI  =
                                  WRK-ZAITENNASHI  +
                                 (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                       END-IF
                   ELSE               
                    IF  SRY-SRYCD(IDX3) =  CONS-SHOHOKSN1
                                        OR CONS-SHOHOKSN2
                                        OR CONS-SHOHOKSN3
                                        OR CONS-SHOHOKSN4
                                        OR CONS-SHOHOKSN5
                                        OR CONS-SHOHOKSN6
                                        OR CONS-SHOHOKSN7
                                        OR CONS-SHOHOKSN8
                       COMPUTE  WRK-SYOSEN-KAISU  =  WRK-SYOSEN-KAISU
                                                  +  ACCT-ZAIKAISU
                    END-IF
                    IF   SRY-SRYCD(IDX3)   =  CONS-SHOHOSEN1 OR
                                              CONS-SHOHOSEN2 OR
                                              CONS-SHOHOSEN3 OR
                                              CONS-SHOHOSEN4 OR
                                              CONS-SHOHOSEN5 OR
                                              CONS-SHOHOKSN1 OR
                                              CONS-SHOHOKSN2 OR
                                              CONS-SHOHOKSN3 OR
                                              CONS-SHOHOKSN4 OR
                                              CONS-SHOHOKSN5 OR
                                              CONS-SHOHOKSN6 OR
                                              CONS-SHOHOKSN7 OR
                                              CONS-SHOHOKSN8
                         ADD  ACCT-ZAIKAISU  TO  RECE41-KAISU(36)
                         COMPUTE   RECE41-TENSU(36)  =
                                   RECE41-TENSU(36)  +
                                  (WK-ZAITEN  *   ACCT-ZAIKAISU)
                    ELSE
                         COMPUTE   RECE41-TENSU(37)  =
                                   RECE41-TENSU(37)  +
                                  (WK-SYUTEN  *   ACCT-ZAIKAISU)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE41-TENSU(9)  =
                                     RECE41-TENSU(9)  +
                                    (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                           COMPUTE   RECE41-TENSU(37) =
                                     RECE41-TENSU(37) -
                                    (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
                         END-IF
                    END-IF
                    COMPUTE   RECE41-TENSU(38)  =
                              RECE41-TENSU(38)  +
                             (WK-YKZTEN   *   ACCT-ZAIKAISU)
                   END-IF
                 END-IF
           END-EVALUATE
      *
           .
      *
       2101225-RECE-LEFT-SET5-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       21012251-RECE-LEFT12-HEN1-SEC               SECTION.
      *
             IF ( WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0" )
             OR ( SRY-SRYCD(IDX3)(1:1)       NOT = "1" )
             OR ( SRY-SRYCD(IDX3) = CONS-YAKRENKEI     )
               CONTINUE
             ELSE
               ADD   WK-ZAIKAISU   TO  RECE41-KAISU(3)
               IF    SRY-SRYCD(IDX3)  =  CONS-DOUJITU-GAI
                                     OR  CONS-DOUJITU2-GAI
                                     OR  CONS-DOUJITU3-GAI
                 ADD  WK-ZAIKAISU  TO  CNT-SAISIN-GAI-DOUJITU
               ELSE
                 ADD  WK-ZAIKAISU  TO  CNT-SAISIN-GAI-ETC
               END-IF
             END-IF
      *
             IF   SRY-SRYCD(IDX3)  =  CONS-NINPU17-COMMENT
               COMPUTE  CNT-NINPU2    =  CNT-NINPU2
                                      +  WK-ZAIKAISU
             END-IF
      *
             IF   SRY-SRYCD(IDX3)  =  CONS-NINPU17-COMMENT
                IF   FLG-NINPU2-ARI  =  ZERO
                  ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(3)
                  MOVE     1             TO FLG-NINPU2-ARI
                END-IF
             ELSE
                IF   FLG-SAISIN-GAI-ARI   =  ZERO
                  ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(3)
                  MOVE     1             TO FLG-SAISIN-GAI-ARI
                END-IF
             END-IF
      *
             COMPUTE    RECE41-TENSU(3)   =
                        RECE41-TENSU(3)   +
                       (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *
           .
      *
       21012251-RECE-LEFT12-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       21012251-RECE-LEFT12-HEN2-SEC               SECTION.
      *
           IF     RECE41-KOMUKBN  =   "2"
             IF ( WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0" )
             OR ( SRY-SRYCD(IDX3)(1:1)       NOT = "1" )
             OR ( SRY-SRYCD(IDX3) = CONS-YAKRENKEI     )
               CONTINUE
             ELSE
               ADD   WK-ZAIKAISU     TO  RECE41-KAISU(2)
               IF    SRY-SRYCD(IDX3)  =  CONS-DOUJITU-SAI
                                     OR  CONS-DOUJITU-SAI2
                                     OR  CONS-DOUJITU-DEN
                                     OR  CONS-DOUJITU-DEN2
                                     OR  CONS-DOUJITU-DEN3
                                     OR  CONS-DOUJITU-DEN4
                   ADD  WK-ZAIKAISU  TO  CNT-SAISIN-DOUJITU
               ELSE
                 IF  SRY-SRYCD(IDX3)  =  CONS-ONLINE-COMMENT
                   ADD  WK-ZAIKAISU  TO  CNT-SAISIN-ONLINE
                 ELSE
                   ADD  WK-ZAIKAISU  TO  CNT-SAISIN-ETC
                 END-IF
               END-IF
             END-IF
      *
             IF   SRY-SRYCD(IDX3)  =  CONS-JIKANTAI1
               COMPUTE  CNT-JIKANTAI1 =  CNT-JIKANTAI1
                                      +  WK-ZAIKAISU
             END-IF
             IF   SRY-SRYCD(IDX3)  =  CONS-JIKANTAI2
               COMPUTE  CNT-JIKANTAI2 =  CNT-JIKANTAI2
                                      +  WK-ZAIKAISU
             END-IF
             IF   SRY-SRYCD(IDX3)  =  CONS-JIKANTAI3
               COMPUTE  CNT-JIKANTAI3 =  CNT-JIKANTAI3
                                      +  WK-ZAIKAISU
             END-IF
             IF   SRY-SRYCD(IDX3)  =  CONS-MESAIKSN
               COMPUTE  CNT-MESAIKSN  =  CNT-MESAIKSN
                                      +  WK-ZAIKAISU
             END-IF
             IF   SRY-SRYCD(IDX3)  =  CONS-CHIHOKATU
               COMPUTE  CNT-CHIHOKATU =  CNT-CHIHOKATU
                                      +  WK-ZAIKAISU
             END-IF
             IF   SRY-SRYCD(IDX3)  =  CONS-CHIHOKAT2
               COMPUTE  CNT-CHIHOKAT2 =  CNT-CHIHOKAT2
                                      +  WK-ZAIKAISU
             END-IF
             IF   SRY-SRYCD(IDX3)  =  CONS-CHIHOKAT3
               COMPUTE  CNT-CHIHOKAT3 =  CNT-CHIHOKAT3
                                      +  WK-ZAIKAISU
             END-IF
             IF   SRY-SRYCD(IDX3)  =  CONS-CHIHOKAT4
               COMPUTE  CNT-CHIHOKAT4 =  CNT-CHIHOKAT4
                                      +  WK-ZAIKAISU
             END-IF
             IF   SRY-SRYCD(IDX3)  =  CONS-YAKRENKEI
               COMPUTE  CNT-YAKRENKEI =  CNT-YAKRENKEI
                                      +  WK-ZAIKAISU
             END-IF
             IF   SRY-SRYCD(IDX3)  =  CONS-NINPU13-COMMENT
               COMPUTE  CNT-NINPU     =  CNT-NINPU
                                      +  WK-ZAIKAISU
             END-IF
      *
             IF   SRY-SRYCD(IDX3)  =  CONS-JIKANTAI1
                                  OR  CONS-JIKANTAI2
                                  OR  CONS-JIKANTAI3
                                  OR  CONS-MESAIKSN
                                  OR  CONS-CHIHOKATU
                                  OR  CONS-CHIHOKAT2
                                  OR  CONS-CHIHOKAT3
                                  OR  CONS-CHIHOKAT4
                                  OR  CONS-YAKRENKEI
                                  OR  CONS-NINPU13-COMMENT
                EVALUATE  SRY-SRYCD(IDX3)
                  WHEN     CONS-JIKANTAI1
                    IF   FLG-JIKANTAI1-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-JIKANTAI1-ARI
                    END-IF
                  WHEN     CONS-JIKANTAI2
                    IF   FLG-JIKANTAI2-ARI   =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-JIKANTAI2-ARI
                    END-IF
                  WHEN     CONS-JIKANTAI3
                    IF   FLG-JIKANTAI3-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-JIKANTAI3-ARI
                    END-IF
                  WHEN     CONS-MESAIKSN
                    IF   FLG-MESAIKSN-ARI   =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-MESAIKSN-ARI
                    END-IF
                  WHEN     CONS-CHIHOKATU
                    IF   FLG-CHIHOKATU-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-CHIHOKATU-ARI
                    END-IF
                  WHEN     CONS-CHIHOKAT2
                    IF   FLG-CHIHOKAT2-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-CHIHOKAT2-ARI
                    END-IF
                  WHEN     CONS-CHIHOKAT3
                    IF   FLG-CHIHOKAT3-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-CHIHOKAT3-ARI
                    END-IF
                  WHEN     CONS-CHIHOKAT4
                    IF   FLG-CHIHOKAT4-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-CHIHOKAT4-ARI
                    END-IF
                  WHEN     CONS-YAKRENKEI
                    IF   FLG-YAKRENKEI-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-YAKRENKEI-ARI
                    END-IF
                  WHEN     CONS-NINPU13-COMMENT
                    IF   FLG-NINPU-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-NINPU-ARI
                    END-IF
                END-EVALUATE
             ELSE
                IF   FLG-SAISIN-ARI   =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE41-KHNTEN(2)
                      MOVE     1             TO FLG-SAISIN-ARI
                END-IF
             END-IF
           ELSE
             IF   FLG-COUNT-ARI  =  ZERO
               ADD    WK-ZAIKAISU       TO  RECE41-KAISU(2)
               MOVE   1                 TO  FLG-COUNT-ARI
             END-IF
      *
             IF    RECE41-KHNTEN(2) = ZERO
               MOVE   WRK-TNS-TEN(IDX3) TO  RECE41-KHNTEN(2)
             ELSE
               IF  RECE41-KHNTEN(2) NOT = WRK-TNS-TEN(IDX3)
                 MOVE   ZERO     TO  RECE41-KHNTEN(2)
                 MOVE   1        TO  FLG-KHNTEN2-KO
               END-IF
             END-IF
           END-IF
           COMPUTE    RECE41-TENSU(2)   =
                      RECE41-TENSU(2)   +
                     (WRK-TNS-TEN(IDX3) * ACCT-ZAIKAISU)
      *
           .
      *
       21012251-RECE-LEFT12-HEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理
      *****************************************************************
       210123-RECE45-WRITE-SEC                SECTION.
      *
           MOVE    RECE45-REC          TO   RECE4B-REC      
           MOVE    RECE45-REC          TO   RECE45C-REC
      *
           WRITE   RECE45-REC
           ADD     1                   TO   CNT-OUT2
      *
           WRITE   RECE4B-REC
           ADD     1                   TO   CNT-OUT5
      *
           IF  (RECE41-SRYYM        <   201307              )
           OR  (RECE41-PTNUM        =   SPACE               )
           OR  (RECE41-TSTPTNUMKBN  =   "1"                 )
           OR  (RECE41-RECESYUBETU  =   ZERO OR 7021 OR 7051)
           OR  (RECE41-RSIIRYOKBN   =   "0"                 )
             CONTINUE
           ELSE
             WRITE RECE45C-REC
             ADD   1                   TO   CNT-OUT7
           END-IF
      *
           .
       210123-RECE45-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理
      *****************************************************************
       210124-RECE45-REWRITE-SEC              SECTION.                        
      *
           MOVE    ZERO                TO  FLG-REWRITE
      *
           INITIALIZE                      RECE45-REC
           MOVE    RECE44-HOSPNUM      TO  RECE45-HOSPNUM
           MOVE    RECE44-SRYYM        TO  RECE45-SRYYM
           MOVE    RECE44-NYUGAIKBN    TO  RECE45-NYUGAIKBN
           MOVE    RECE44-PTID         TO  RECE45-PTID
           MOVE    RECE44-RECEKA       TO  RECE45-RECEKA
           MOVE    RECE44-HKNID        TO  RECE45-HKNID
           MOVE    RECE44-TEKSTYMD     TO  RECE45-TEKSTYMD
           MOVE    RECE44-ZAINUM       TO  RECE45-ZAINUM
           START   RECE45-FILE
                 KEY IS    >=   RECE45-KEY
                 INVALID
                     MOVE    1         TO  FLG-RECE45
                 NOT INVALID
                     MOVE    ZERO      TO  FLG-RECE45
                     READ    RECE45-FILE   NEXT
                       AT  END
                         MOVE    1     TO  FLG-RECE45
                     END-READ
           END-START
           PERFORM   UNTIL
               (RECE44-HOSPNUM      NOT =  RECE45-HOSPNUM)     OR
               (RECE44-SRYYM        NOT =  RECE45-SRYYM)       OR
               (RECE44-NYUGAIKBN    NOT =  RECE45-NYUGAIKBN)   OR
               (RECE44-PTID         NOT =  RECE45-PTID)        OR
               (RECE44-RECEKA       NOT =  RECE45-RECEKA)      OR
               (RECE44-HKNID        NOT =  RECE45-HKNID)       OR
               (RECE44-TEKSTYMD     NOT =  RECE45-TEKSTYMD)    OR
               (RECE44-ZAINUM       NOT =  RECE45-ZAINUM)      OR
               (FLG-RECE45                =      1        )    OR
               (FLG-REWRITE               =      1        )
                IF    RECE45-RENNUM   =   WRK-RENNUM
                   MOVE    1              TO  FLG-REWRITE
                   PERFORM  VARYING  IDXB  FROM  5   BY  -1
                             UNTIL   IDXB   <    1
                     IF  RECE45-SRYCD(IDXB)  NOT = SPACE
                       MOVE WRK-SRYSURYO3 TO RECE45-SRYSURYO(IDXB)
                       MOVE 1             TO IDXB
                     END-IF
                   END-PERFORM
                   REWRITE   RECE45-REC
                END-IF
                READ    RECE45-FILE   NEXT
                  AT  END
                    MOVE    1     TO  FLG-RECE45
                END-READ
           END-PERFORM
      *
      *****
      *
           IF  (RECE41-SRYYM        <   201307              )
           OR  (RECE41-PTNUM        =   SPACE               )
           OR  (RECE41-TSTPTNUMKBN  =   "1"                 )
           OR  (RECE41-RECESYUBETU  =   ZERO OR 7021 OR 7051)
           OR  (RECE41-RSIIRYOKBN   =   "0"                 )
             CONTINUE
           ELSE
      *
             MOVE    ZERO                TO  FLG-REWRITE
      *
             INITIALIZE                      RECE45C-REC
             MOVE    RECE44-HOSPNUM      TO  RECE45C-HOSPNUM
             MOVE    RECE44-SRYYM        TO  RECE45C-SRYYM
             MOVE    RECE44-NYUGAIKBN    TO  RECE45C-NYUGAIKBN
             MOVE    RECE44-PTID         TO  RECE45C-PTID
             MOVE    RECE44-RECEKA       TO  RECE45C-RECEKA
             MOVE    RECE44-HKNID        TO  RECE45C-HKNID
             MOVE    RECE44-TEKSTYMD     TO  RECE45C-TEKSTYMD
             MOVE    RECE44-ZAINUM       TO  RECE45C-ZAINUM
             START   RECE45C-FILE
                 KEY IS    >=   RECE45C-KEY
                 INVALID
                     MOVE    1         TO  FLG-RECE45
                 NOT INVALID
                     MOVE    ZERO      TO  FLG-RECE45
                     READ    RECE45C-FILE   NEXT
                       AT  END
                         MOVE    1     TO  FLG-RECE45
                     END-READ
             END-START
             PERFORM   UNTIL
               (RECE44-HOSPNUM      NOT =  RECE45C-HOSPNUM)     OR
               (RECE44-SRYYM        NOT =  RECE45C-SRYYM)       OR
               (RECE44-NYUGAIKBN    NOT =  RECE45C-NYUGAIKBN)   OR
               (RECE44-PTID         NOT =  RECE45C-PTID)        OR
               (RECE44-RECEKA       NOT =  RECE45C-RECEKA)      OR
               (RECE44-HKNID        NOT =  RECE45C-HKNID)       OR
               (RECE44-TEKSTYMD     NOT =  RECE45C-TEKSTYMD)    OR
               (RECE44-ZAINUM       NOT =  RECE45C-ZAINUM)      OR
               (FLG-RECE45                =      1        )    OR
               (FLG-REWRITE               =      1        )
                IF    RECE45C-RENNUM   =   WRK-RENNUM
                   MOVE    1              TO  FLG-REWRITE
                   PERFORM  VARYING  IDXB  FROM  5   BY  -1
                             UNTIL   IDXB   <    1
                     IF  RECE45C-SRYCD(IDXB)  NOT = SPACE
                       MOVE WRK-SRYSURYO3 TO RECE45C-SRYSURYO(IDXB)
                       MOVE 1             TO IDXB
                     END-IF
                   END-PERFORM
                   REWRITE   RECE45C-REC
                END-IF
                READ    RECE45C-FILE   NEXT
                  AT  END
                    MOVE    1     TO  FLG-RECE45
                END-READ
             END-PERFORM
      *
           END-IF
      *
           .
       210124-RECE45-REWRITE-EXT.
           EXIT.                                                       
      *
      *****************************************************************
      *    データ出力処理
      *****************************************************************
       210124-RECE45-REWRITE2-SEC              SECTION.
      *
           MOVE    ZERO                TO  FLG-REWRITE
      *
           INITIALIZE                      RECE45-REC
           MOVE    RECE44-HOSPNUM      TO  RECE45-HOSPNUM
           MOVE    RECE44-SRYYM        TO  RECE45-SRYYM
           MOVE    RECE44-NYUGAIKBN    TO  RECE45-NYUGAIKBN
           MOVE    RECE44-PTID         TO  RECE45-PTID
           MOVE    RECE44-RECEKA       TO  RECE45-RECEKA
           MOVE    RECE44-HKNID        TO  RECE45-HKNID
           MOVE    RECE44-TEKSTYMD     TO  RECE45-TEKSTYMD
           MOVE    RECE44-ZAINUM       TO  RECE45-ZAINUM
           START   RECE45-FILE
                 KEY IS    >=   RECE45-KEY
                 INVALID
                     MOVE    1         TO  FLG-RECE45
                 NOT INVALID
                     MOVE    ZERO      TO  FLG-RECE45
                     READ    RECE45-FILE   NEXT
                       AT  END
                         MOVE    1     TO  FLG-RECE45
                     END-READ
           END-START
           PERFORM   UNTIL
               (RECE44-HOSPNUM      NOT =  RECE45-HOSPNUM)     OR
               (RECE44-SRYYM        NOT =  RECE45-SRYYM)       OR
               (RECE44-NYUGAIKBN    NOT =  RECE45-NYUGAIKBN)   OR
               (RECE44-PTID         NOT =  RECE45-PTID)        OR
               (RECE44-RECEKA       NOT =  RECE45-RECEKA)      OR
               (RECE44-HKNID        NOT =  RECE45-HKNID)       OR
               (RECE44-TEKSTYMD     NOT =  RECE45-TEKSTYMD)    OR
               (RECE44-ZAINUM       NOT =  RECE45-ZAINUM)      OR
               (FLG-RECE45                =      1        )    OR
               (FLG-REWRITE               =      1        )
                IF    RECE45-RENNUM   =   WRK-RENNUM2
                   MOVE    1              TO  FLG-REWRITE
                   PERFORM  VARYING  IDXB  FROM  5   BY  -1
                             UNTIL   IDXB   <    1
                     IF  RECE45-SRYCD(IDXB)  NOT = SPACE
                       MOVE   "1"  TO   RECE45-RECEPTFLG(IDXB)
                       MOVE    1   TO   IDXB
                     END-IF
                   END-PERFORM
                   REWRITE   RECE45-REC
                END-IF
                READ    RECE45-FILE   NEXT
                  AT  END
                    MOVE    1     TO  FLG-RECE45
                END-READ
           END-PERFORM
      *
      *****
      *
           IF  (RECE41-SRYYM        <   201307              )
           OR  (RECE41-PTNUM        =   SPACE               )
           OR  (RECE41-TSTPTNUMKBN  =   "1"                 )
           OR  (RECE41-RECESYUBETU  =   ZERO OR 7021 OR 7051)
           OR  (RECE41-RSIIRYOKBN   =   "0"                 )
             CONTINUE
           ELSE
      *
             MOVE    ZERO                TO  FLG-REWRITE
      *
             INITIALIZE                      RECE45C-REC
             MOVE    RECE44-HOSPNUM      TO  RECE45C-HOSPNUM
             MOVE    RECE44-SRYYM        TO  RECE45C-SRYYM
             MOVE    RECE44-NYUGAIKBN    TO  RECE45C-NYUGAIKBN
             MOVE    RECE44-PTID         TO  RECE45C-PTID
             MOVE    RECE44-RECEKA       TO  RECE45C-RECEKA
             MOVE    RECE44-HKNID        TO  RECE45C-HKNID
             MOVE    RECE44-TEKSTYMD     TO  RECE45C-TEKSTYMD
             MOVE    RECE44-ZAINUM       TO  RECE45C-ZAINUM
             START   RECE45C-FILE
                 KEY IS    >=   RECE45C-KEY
                 INVALID
                     MOVE    1         TO  FLG-RECE45
                 NOT INVALID
                     MOVE    ZERO      TO  FLG-RECE45
                     READ    RECE45C-FILE   NEXT
                       AT  END
                         MOVE    1     TO  FLG-RECE45
                     END-READ
             END-START
             PERFORM   UNTIL
               (RECE44-HOSPNUM      NOT =  RECE45C-HOSPNUM)     OR
               (RECE44-SRYYM        NOT =  RECE45C-SRYYM)       OR
               (RECE44-NYUGAIKBN    NOT =  RECE45C-NYUGAIKBN)   OR
               (RECE44-PTID         NOT =  RECE45C-PTID)        OR
               (RECE44-RECEKA       NOT =  RECE45C-RECEKA)      OR
               (RECE44-HKNID        NOT =  RECE45C-HKNID)       OR
               (RECE44-TEKSTYMD     NOT =  RECE45C-TEKSTYMD)    OR
               (RECE44-ZAINUM       NOT =  RECE45C-ZAINUM)      OR
               (FLG-RECE45                =      1        )    OR
               (FLG-REWRITE               =      1        )
                IF    RECE45C-RENNUM   =   WRK-RENNUM2
                   MOVE    1              TO  FLG-REWRITE
                   PERFORM  VARYING  IDXB  FROM  5   BY  -1
                             UNTIL   IDXB   <    1
                     IF  RECE45C-SRYCD(IDXB)  NOT = SPACE
                       MOVE   "1"  TO   RECE45C-RECEPTFLG(IDXB)
                       MOVE    1   TO   IDXB
                     END-IF
                   END-PERFORM
                   REWRITE   RECE45C-REC
                END-IF
                READ    RECE45C-FILE   NEXT
                  AT  END
                    MOVE    1     TO  FLG-RECE45
                END-READ
             END-PERFORM
      *
           END-IF
      *
           .
       210124-RECE45-REWRITE2-EXT.
           EXIT.                                                       
      *
      *****************************************************************
      *    医療情報連携編集
      *****************************************************************
       210125-IRYORENKEI-HENSYU-SEC               SECTION.
      *
           IF   (ACCT-SRYKBN       =  "14" OR "21" OR "22" OR "23")
           AND  (ACCT-ZAITEN       =  ZERO                        )
           AND  (ACCT-ZAIKBN   NOT =   1                          )
           AND  (ACCT-JIHOKBN      =  SPACE                       )
      *
             INITIALIZE                   SRYACT-REC
             MOVE    ACCT-HOSPNUM     TO  SRY-HOSPNUM
             MOVE    ACCT-NYUGAIKBN   TO  SRY-NYUGAIKBN
             MOVE    ACCT-PTID        TO  SRY-PTID
             MOVE    ACCT-SRYYM       TO  SRY-SRYYM
             MOVE    ACCT-ZAINUM      TO  SRY-ZAINUM
             MOVE    "820000046"      TO  SRY-SRYCD(1)
             MOVE    "820000046"      TO  SRY-SRYCD(2)
             MOVE    "820000046"      TO  SRY-SRYCD(3)
             MOVE    "820000046"      TO  SRY-SRYCD(4)
             MOVE    "820000046"      TO  SRY-SRYCD(5)
             MOVE    SRYACT-REC       TO  MCPDATA-REC
             MOVE    "tbl_sryact"     TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC   =   ZERO
               MOVE    "tbl_sryact"   TO  MCP-TABLE
               MOVE    "key8"         TO  MCP-PATHNAME
               PERFORM  800-SRYACT-READ-SEC
               IF   FLG-SRYACT  =  ZERO
                 CONTINUE
               ELSE
                 MOVE    1            TO  FLG-IRYORENKEI
               END-IF
             END-IF
             MOVE    "tbl_sryact"     TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
      *
           END-IF
      *
           IF    FLG-IRYORENKEI   =   1
      *
             INITIALIZE                      ORCSGETGENERICAREA
             MOVE    RECE41-HOSPNUM      TO  ORCSGETGE-HOSPNUM
             MOVE    RECE41-PTID         TO  ORCSGETGE-PTID
             MOVE    RECE41-SRYYM        TO  ORCSGETGE-SRYYM
             MOVE    "2"                 TO  ORCSGETGE-NYUGAIKBN
             MOVE    ACCT-ZAINUM         TO  ORCSGETGE-ZAINUM
             MOVE    WRK-1030-KOUHATUKA  TO  ORCSGETGE-KOUHATUKA
             CALL    "ORCSGETGENERIC"    USING
                                         ORCSGETGENERICAREA
                                         SPA-AREA
             IF      ORCSGETGE-ERRCD     =   ZERO
               PERFORM   VARYING  IDX15    FROM    1   BY  1
                          UNTIL   IDX15     >     50
                 MOVE  ORCSGETGE-YAKKAKJNCD(IDX15)
                            TO  WRK-ORCSGETGE-YAKKAKJNCD(IDX15)
                 MOVE  ORCSGETGE-GENERIC-KBN(IDX15)
                            TO  WRK-ORCSGETGE-GENERIC-KBN(IDX15)
                 MOVE  ORCSGETGE-GENERICNAME(IDX15)
                            TO  WRK-ORCSGETGE-GENERICNAME(IDX15)
               END-PERFORM
             END-IF
      *
           END-IF
      *
           .
      *
       210125-IRYORENKEI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    湿布薬チェック
      *****************************************************************
       210126-SIPPU-CHECK-SEC               SECTION.
      *
           INITIALIZE                     SRYACT-REC
           MOVE    ACCT-HOSPNUM       TO  SRY-HOSPNUM
           MOVE    ACCT-NYUGAIKBN     TO  SRY-NYUGAIKBN
           MOVE    ACCT-PTID          TO  SRY-PTID
           MOVE    ACCT-SRYKA         TO  SRY-SRYKA
           MOVE    ACCT-SRYYM         TO  SRY-SRYYM
           MOVE    ACCT-ZAINUM        TO  SRY-ZAINUM
           MOVE    SRYACT-REC         TO  MCPDATA-REC
           MOVE    "tbl_sryact"       TO  MCP-TABLE
           MOVE    "key2"             TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_sryact"     TO  MCP-TABLE
             MOVE    "key2"           TO  MCP-PATHNAME
             PERFORM  800-SRYACT-READ-SEC
             PERFORM  UNTIL (FLG-SRYACT     =  1)
                       OR   (FLG-SIPPU-ARI  =  1)
      *
               PERFORM  VARYING  IDX2  FROM  1  BY  1
                         UNTIL  (IDX2            >   5   )
                          OR    (SRY-SRYCD(IDX2) =  SPACE)
                          OR    (FLG-SIPPU-ARI   =   1   )
                  PERFORM    800-TENSU-TBL-SEC
                  IF  (SRY-SRYCD(IDX2)(1:1)  =  "6")
                  AND (TNS-MEIUSESKB         =   1 )
                     MOVE    1        TO  FLG-SIPPU-ARI
                  END-IF
               END-PERFORM
      *
               MOVE    "tbl_sryact"   TO  MCP-TABLE
               MOVE    "key2"         TO  MCP-PATHNAME
               PERFORM   800-SRYACT-READ-SEC
             END-PERFORM
           END-IF
           MOVE    "tbl_sryact"       TO  MCP-TABLE
           MOVE    "key2"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
      *
       210126-SIPPU-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理
      *****************************************************************
       21013-RECE44-WRITE-SEC                SECTION.
      *
           MOVE    RECE44-REC          TO  RECE4A-REC
           MOVE    RECE44-REC          TO  RECE44C-REC
      *
           COMPUTE  RECE44-ZAITEN      =  RECE44-ZAITEN     -  
                                          WRK-TEN
           COMPUTE  RECE44-MEISAISU    =  RECE44-MEISAISU   -
                                          WRK-MEISAI-CNT
           COMPUTE  RECE44-SYUTEN1     =  RECE44-SYUTEN1    -
                                          WRK-TEN
           COMPUTE  RECE44-SRYCDTOTAL  =  RECE44-SRYCDTOTAL -
                                          WRK-SRYCDTOTAL
           COMPUTE  RECE44-SURYOUTOTAL =  RECE44-SURYOUTOTAL -
                                          WRK-SURYOUTOTAL     
      *
           MOVE     WRK-TEN         TO  RECE4A-ZAITEN
           MOVE     WRK-MEISAI-CNT  TO  RECE4A-MEISAISU
           MOVE     WRK-TEN         TO  RECE4A-SYUTEN1  
           MOVE     WRK-SRYCDTOTAL  TO  RECE4A-SRYCDTOTAL
           MOVE     WRK-SURYOUTOTAL TO  RECE4A-SURYOUTOTAL
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *      診療会計マスタ付加情報設定
             PERFORM   920-SRYACCTPLUS-HENSYU-SEC
           END-IF
      *
           MOVE    RECE44-ZAITEN    TO  RECE44-HOKATU-ZAITEN
           MOVE    RECE44-SYUTEN1   TO  RECE44-HOKATU-SYUTEN1
           MOVE    RECE44-SYUTEN2   TO  RECE44-HOKATU-SYUTEN2
           MOVE    RECE44-YKZTEN    TO  RECE44-HOKATU-YKZTEN
           MOVE    RECE44-KIZAITEN  TO  RECE44-HOKATU-KIZAITEN
      *
           MOVE    RECE4A-ZAITEN    TO  RECE4A-HOKATU-ZAITEN
           MOVE    RECE4A-SYUTEN1   TO  RECE4A-HOKATU-SYUTEN1
           MOVE    RECE4A-SYUTEN2   TO  RECE4A-HOKATU-SYUTEN2
           MOVE    RECE4A-YKZTEN    TO  RECE4A-HOKATU-YKZTEN
           MOVE    RECE4A-KIZAITEN  TO  RECE4A-HOKATU-KIZAITEN
      *
           WRITE   RECE44-REC
           ADD     1                TO  CNT-OUT1
      *
           WRITE   RECE4A-REC
           ADD     1                TO  CNT-OUT4
      *
           IF  (RECE41-SRYYM        <   201307              )
           OR  (RECE41-PTNUM        =   SPACE               )
           OR  (RECE41-TSTPTNUMKBN  =   "1"                 )
           OR  (RECE41-RECESYUBETU  =   ZERO OR 7021 OR 7051)
           OR  (RECE41-RSIIRYOKBN   =   "0"                 )
             CONTINUE
           ELSE
      *
             COMPUTE  RECE44C-ZAI-TENSU  =  RECE44C-ZAITEN
                                         -  WRK-TEN
             MOVE  WRK-ZAI-KINGAKU  TO  RECE44C-ZAI-KINGAKU
      *
             COMPUTE  RECE44C-ZAITEN     =  RECE44C-ZAITEN
                                         -  WRK-TEN
             COMPUTE  RECE44C-SYUTEN1    =  RECE44C-SYUTEN1
                                         -  WRK-TEN
      *
             MOVE  RECE44C-ZAITEN   TO  RECE44C-HOKATU-ZAITEN
             MOVE  RECE44C-SYUTEN1  TO  RECE44C-HOKATU-SYUTEN1
             MOVE  RECE44C-SYUTEN2  TO  RECE44C-HOKATU-SYUTEN2
             MOVE  RECE44C-YKZTEN   TO  RECE44C-HOKATU-YKZTEN
             MOVE  RECE44C-KIZAITEN TO  RECE44C-HOKATU-KIZAITEN
      *
             WRITE RECE44C-REC
             ADD   1                TO  CNT-OUT6
      *
           END-IF
      *
           .
       21013-RECE44-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    剤の診療内容チェック
      *****************************************************************
       21014-SINRYO-CHECK-SEC                 SECTION.
      *
      ***  PERFORM   VARYING   IDU   FROM   1   BY   1
           PERFORM   VARYING   IDU   FROM   2   BY   1
                      UNTIL  ( IDU   >   TBL-ZAICHECK-MAX )
                       OR    ( FLG-RINYAK  NOT =  ZERO    )
      *
              IF  ( IDU  =  1                                  )
              OR  ((IDU  =  2) AND (ACCT-SRYKBN = "60" OR "64"))
              OR  ((IDU  =  3) AND (ACCT-SRYKBN = "80"        ))
              OR  ((IDU  =  4) AND (ACCT-SRYKBN = "80"        ))
      *
                 INITIALIZE                  SRYACT-REC
                 MOVE RECE41-HOSPNUM     TO  SRY-HOSPNUM
                 MOVE RECE41-NYUGAIKBN   TO  SRY-NYUGAIKBN
                 MOVE RECE41-PTID        TO  SRY-PTID
                 MOVE RECE41-SRYYM       TO  SRY-SRYYM
                 MOVE ACCT-ZAINUM        TO  SRY-ZAINUM
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(1)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(2)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(3)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(4)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(5)
                 MOVE SRYACT-REC         TO  MCPDATA-REC
                 MOVE "tbl_sryact"       TO  MCP-TABLE
                 MOVE "key8"             TO  MCP-PATHNAME
grpsys           PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC        =  ZERO
                     MOVE "tbl_sryact"   TO  MCP-TABLE
                     MOVE "key8"         TO  MCP-PATHNAME
                     PERFORM   800-SRYACT-READ-SEC
                     IF     FLG-SRYACT   =  ZERO
                         EVALUATE   IDU
                           WHEN      1
                             MOVE   1   TO  FLG-RINYAK
                           WHEN      2
                           WHEN      3
                           WHEN      4
                             MOVE   2   TO  FLG-RINYAK
                         END-EVALUATE
                     END-IF
                 END-IF
                 MOVE "tbl_sryact"   TO  MCP-TABLE
                 MOVE "key8"         TO  MCP-PATHNAME
                 PERFORM 900-CLOSE-SEC
      *
              END-IF
      *
           END-PERFORM
      *
           .
       21014-SINRYO-CHECK-EXT.
           EXIT.
      *
      **************************************************************
      *    診療会計付加情報検索
      **************************************************************
       21015-SRYACCTPLUS-KENSAKU-SEC           SECTION.
      *
           INITIALIZE                      SRYACCTPLUS-REC
           MOVE    ACCT-HOSPNUM       TO   ACCTP-HOSPNUM
           MOVE    ACCT-NYUGAIKBN     TO   ACCTP-NYUGAIKBN
           MOVE    ACCT-PTID          TO   ACCTP-PTID
           MOVE    ACCT-SRYKA         TO   ACCTP-SRYKA
           MOVE    ACCT-SRYYM         TO   ACCTP-SRYYM
           MOVE    ACCT-ZAINUM        TO   ACCTP-ZAINUM
           MOVE    1                  TO   ACCTP-RENNUM
           MOVE    SRYACCTPLUS-REC    TO   MCPDATA-REC
           MOVE    "tbl_sryacctplus"  TO   MCP-TABLE
           MOVE    "key"              TO   MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_sryacctplus"  TO   MCP-TABLE
               MOVE    "key"              TO   MCP-PATHNAME
               PERFORM  800-SRYACCTPLUS-READ-SEC
               IF        FLG-SRYACCTPLUS   =   ZERO
                 IF   ACCTP-RSIKINGAKU  NOT = ZERO
                    MOVE    1   TO   FLG-TAISYO
                 END-IF
               END-IF
           END-IF
      *
           MOVE    "tbl_sryacctplus"  TO   MCP-TABLE
           MOVE    "key"              TO   MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
      *
       21015-SRYACCTPLUS-KENSAKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの基本点数部分のクリア処理
      *****************************************************************
       2102-KHNTEN-CLEAR-SEC               SECTION.
      *
           IF        FLG-KHNTEN2        =    1
               MOVE    ZERO             TO   RECE41-KHNTEN(2)
           END-IF
           IF        FLG-KHNTEN3        =    1
               MOVE    ZERO             TO   RECE41-KHNTEN(3)
           END-IF
           IF        FLG-KHNTEN4        =    1
               MOVE    ZERO             TO   RECE41-KHNTEN(4)
           END-IF
           IF        FLG-KHNTEN5        =    1
               MOVE    ZERO             TO   RECE41-KHNTEN(5)
           END-IF
           IF        FLG-KHNTEN6        =    1
               MOVE    ZERO             TO   RECE41-KHNTEN(6)
           END-IF
           IF        FLG-KHNTEN15        =    1
               MOVE    ZERO             TO   RECE41-KHNTEN(15)
           END-IF
           IF        FLG-KHNTEN18        =    1
               MOVE    ZERO             TO   RECE41-KHNTEN(18)
           END-IF
           IF        FLG-KHNTEN19        =    1
               MOVE    ZERO             TO   RECE41-KHNTEN(19)
           END-IF
      *
           IF   RECE41-SRYYM   >=  "201004"
           AND  RECE41-SRYYM   <=  "201803"
             IF  CNT-JIKANTAI1     NOT = ZERO
               IF   CNT-JIKANTAI2  NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT =  CNT-JIKANTAI2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-JIKANTAI3  NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT =  CNT-JIKANTAI3
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-MESAIKSN   NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT =  CNT-MESAIKSN
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKATU  NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT =  CNT-CHIHOKATU
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKAT2  NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT =  CNT-CHIHOKAT2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
             END-IF
             IF  CNT-JIKANTAI2     NOT = ZERO
               IF   CNT-JIKANTAI1  NOT = ZERO
                 IF   CNT-JIKANTAI2  NOT =  CNT-JIKANTAI1
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-JIKANTAI3  NOT = ZERO
                 IF   CNT-JIKANTAI2  NOT =  CNT-JIKANTAI3
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-MESAIKSN   NOT = ZERO
                 IF   CNT-JIKANTAI2  NOT =  CNT-MESAIKSN
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKATU  NOT = ZERO
                 IF   CNT-JIKANTAI2  NOT =  CNT-CHIHOKATU
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKAT2  NOT = ZERO
                 IF   CNT-JIKANTAI2  NOT =  CNT-CHIHOKAT2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
             END-IF
             IF  CNT-JIKANTAI3     NOT = ZERO
               IF   CNT-JIKANTAI2  NOT = ZERO
                 IF   CNT-JIKANTAI3  NOT =  CNT-JIKANTAI2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-JIKANTAI3  NOT = ZERO
                 IF   CNT-JIKANTAI3  NOT =  CNT-JIKANTAI3
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-MESAIKSN   NOT = ZERO
                 IF   CNT-JIKANTAI3  NOT =  CNT-MESAIKSN
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKATU  NOT = ZERO
                 IF   CNT-JIKANTAI3  NOT =  CNT-CHIHOKATU
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKAT2  NOT = ZERO
                 IF   CNT-JIKANTAI3  NOT =  CNT-CHIHOKAT2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
             END-IF
             IF  CNT-MESAIKSN      NOT = ZERO
               IF   CNT-JIKANTAI1  NOT = ZERO
                 IF   CNT-MESAIKSN   NOT =  CNT-JIKANTAI1
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-JIKANTAI2  NOT = ZERO
                 IF   CNT-MESAIKSN   NOT =  CNT-JIKANTAI2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-JIKANTAI3  NOT = ZERO
                 IF   CNT-MESAIKSN   NOT =  CNT-JIKANTAI3
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKATU  NOT = ZERO
                 IF   CNT-MESAIKSN   NOT =  CNT-CHIHOKATU
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKAT2  NOT = ZERO
                 IF   CNT-MESAIKSN   NOT =  CNT-CHIHOKAT2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
             END-IF
             IF  CNT-CHIHOKATU     NOT = ZERO
               IF   CNT-JIKANTAI1  NOT = ZERO
                 IF   CNT-CHIHOKATU  NOT =  CNT-JIKANTAI1
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-JIKANTAI2  NOT = ZERO
                 IF   CNT-CHIHOKATU  NOT =  CNT-JIKANTAI2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-JIKANTAI3  NOT = ZERO
                 IF   CNT-CHIHOKATU  NOT =  CNT-JIKANTAI3
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-MESAIKSN   NOT = ZERO
                 IF   CNT-CHIHOKATU  NOT =  CNT-MESAIKSN
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKAT2  NOT = ZERO
                 IF   CNT-CHIHOKATU  NOT =  CNT-CHIHOKAT2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
             END-IF
             IF  CNT-CHIHOKAT2     NOT = ZERO
               IF   CNT-JIKANTAI1  NOT = ZERO
                 IF   CNT-CHIHOKAT2  NOT =  CNT-JIKANTAI1
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-JIKANTAI2  NOT = ZERO
                 IF   CNT-CHIHOKAT2  NOT =  CNT-JIKANTAI2
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-JIKANTAI3  NOT = ZERO
                 IF   CNT-CHIHOKAT2  NOT =  CNT-JIKANTAI3
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-MESAIKSN   NOT = ZERO
                 IF   CNT-CHIHOKAT2  NOT =  CNT-MESAIKSN
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
               IF   CNT-CHIHOKATU  NOT = ZERO
                 IF   CNT-CHIHOKAT2  NOT =  CNT-CHIHOKATU
                   MOVE   ZERO         TO   RECE41-KHNTEN(2)
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
       2102-KHNTEN-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの基本点数部分のクリア処理（自賠責）
      *****************************************************************
       2103-KHNTEN-JI-CLEAR-SEC               SECTION.
      *
           IF     RECE41-HKNKBN   =   "4"
            EVALUATE  WRK-PARA-RECEKBN
              WHEN      "4"
      **********（新様式）
                IF        FLG-KHNTEN10-JI    =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(10)
                END-IF
                IF        FLG-KHNTEN13-JI    =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(13)
                END-IF
                IF        FLG-KHNTEN14-JI    =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(14)
                END-IF
              WHEN      "5"
      **********（従来様式）
                IF        FLG-KHNTEN2-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(2)
                END-IF
                IF        FLG-KHNTEN3-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(3)
                END-IF
                IF        FLG-KHNTEN4-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(4)
                END-IF
                IF        FLG-KHNTEN5-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(5)
                END-IF
                IF        FLG-KHNTEN6-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(6)
                END-IF
                IF        FLG-KHNTEN11-JI2   =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(11)
                END-IF
                IF        FLG-KHNTEN14-JI2   =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(14)
                END-IF
                IF        FLG-KHNTEN15-JI2   =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(15)
                END-IF
      *
                IF    (RECE41-JIBAIKBN      =  "2"         )
                AND   (CNT-NYUYOJI2     NOT =  ZERO        )
                AND   (CNT-SAISIN-ETC   NOT =  CNT-NYUYOJI2)
                AND   (RECE41-SRYYM        >=  "200604"    )
                  MOVE    "1"              TO   RECE41-NYUYOJIFLG
                END-IF
            END-EVALUATE
           END-IF
      *
           IF     RECE41-HKNKBN   =   "6"
                IF        FLG-KHNTEN2-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(2)
                END-IF
                IF        FLG-KHNTEN3-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(3)
                END-IF
                IF        FLG-KHNTEN4-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(4)
                END-IF
                IF        FLG-KHNTEN5-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(5)
                END-IF
                IF        FLG-KHNTEN6-JI2  =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(6)
                END-IF
                IF        FLG-KHNTEN11-JI2   =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(11)
                END-IF
                IF        FLG-KHNTEN14-JI2   =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(14)
                END-IF
                IF        FLG-KHNTEN15-JI2   =    1
                  MOVE    ZERO             TO   RECE41-KHNTEN(15)
                END-IF
      *
                IF    (CNT-NYUYOJI2     NOT =  ZERO        )
                AND   (CNT-SAISIN-ETC   NOT =  CNT-NYUYOJI2)
                AND   (RECE41-SRYYM        >=  "200604"    )
                  MOVE    "1"              TO   RECE41-NYUYOJIFLG
                END-IF
           END-IF
      *
           .
       2103-KHNTEN-JI-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成
      *****************************************************************
       2104-RECE44-HENSYU2-SEC                SECTION.
      *
           INITIALIZE                           SRYACCT-REC
           MOVE    RECE41-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    RECE41-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    RECE41-PTID          TO      ACCT-PTID
           MOVE    RECE41-SRYKA(IDX)    TO      ACCT-SRYKA
           MOVE    RECE41-SRYYM         TO      ACCT-SRYYM
           MOVE    RECE41-HKNCOMBI      TO      ACCT-HKNCOMBI
           MOVE    SRYACCT-REC          TO      MCPDATA-REC
           MOVE    "tbl_sryacct"        TO      MCP-TABLE
           MOVE    "key24"              TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryacct"    TO      MCP-TABLE
               MOVE    "key24"          TO      MCP-PATHNAME
               PERFORM  800-SRYACCT-READ-SEC
               PERFORM  UNTIL     FLG-SRYACCT   =   1 
      *
                 MOVE   ZERO          TO  FLG-RINYAK
      *
                 IF    ACCT-SRYKBN       =  "95"  OR  "96"
                   CONTINUE
                 ELSE
      *
                   MOVE     ZERO    TO    FLG-TAISYO
                   IF   (ACCT-SRYKBN         =   "80" )
                   AND  (ACCT-ZAITEN         =   ZERO )
                   AND  (ACCT-ZAIKAISU   NOT =   ZERO )
                   AND  (ACCT-JIHOKBN        =   SPACE)
                     PERFORM  21015-SRYACCTPLUS-KENSAKU-SEC
                   END-IF
      *
                   MOVE   RECE41-TEKSTYMD(7:2)   TO   WRK-DAY
                   IF  ACCT-DAY(1 WRK-DAY)   NOT =    ZERO
                        MOVE    1       TO   FLG-DAY
                   ELSE
                        MOVE    ZERO    TO   FLG-DAY  
                   END-IF
      *
                   IF      FLG-DAY         =   1
                           IF  ((ACCT-ZAITEN    NOT =    ZERO ) AND
                                (ACCT-ZAIKAISU  NOT =    ZERO ) AND
                                (WRK-PARA-PRTKBN    =
                                            "1" OR "2" OR "3" ) AND
                                (ACCT-JIHOKBN       =    SPACE))
                           OR  ((ACCT-ZAITEN    NOT =    ZERO ) AND
                                (ACCT-ZAIKAISU  NOT =    ZERO ) AND
                                (WRK-PARA-PRTKBN    =
                                                   "4" OR "5" ))
                           OR  ( FLG-TAISYO         =      1   )
                               MOVE  ACCT-DAY(1 WRK-DAY)  
                                               TO    WRK-ZAIKAISU-XXX
                               MOVE    ZERO    TO    WRK-TEN
                                                     WRK-MEISAI-CNT
                                                     WRK-SRYCDTOTAL
                                                     WRK-SURYOUTOTAL
                                                     WRK-YOUBUKASAN
                                                     WRK-KYOBUKASAN
                                                     WRK-KEIBUKASAN
                                                     WRK-SOGAIKASAN
                                                     WRK-RYOYOTEATE
                                                     WRK-ZAI-KINGAKU
      *
                               MOVE    ZERO    TO    WRK-SRYSURYO
                                                     WRK-SRYSURYO2
                                                     WRK-SRYSURYO3
                                                     WRK-TANICD
                                                     WRK-TANIMOJISU
                               MOVE    SPACE   TO    WRK-TANINAME
                               MOVE    ZERO    TO    FLG-HOUSIJI-COM
                                                     FLG-HOUTEN-COM
                                                     FLG-SYOBYO-COM
                                                     FLG-RYOYO-COM
                                                     FLG-SYODOU-COM
                                                     FLG-SAIDOU-COM
                                                     FLG-NIKOCHIN-COM
                                                     FLG-ZENSOKU-COM
                                                     FLG-OSIN-COM
                                                     FLG-ZAIHOU-COM
                                                     FLG-TAHOKEN
                                                     FLG-SYOUNI-COM
                                                     FLG-SRYKBN-HEN
                                                     FLG-KENSA-COM
                                                     FLG-ZAIRIHA-COM
                                                     FLG-ZAIKYO-COM
                                                     FLG-BOKOHO-COM
                                                     FLG-IZONSYO-COM
                                                     FLG-NINRYO-COM
                                                     FLG-NYUSEN-COM
                                                     FLG-KIATU-COM
      *
                               MOVE    SPACE   TO    WRK-KYUGYOFLG
                               MOVE    ZERO    TO    FLG-COUNT-ARI
      *
                               MOVE    SPACE   TO    WRK-FORMALNAME
                               MOVE    ZERO    TO
                                               WRK-KZI058-TEN
                                               WRK-KZI058-TANICD
                                               WRK-KZI058-TANIMOJISU
                               MOVE    SPACE   TO
                                               WRK-KZI058-TANINAME
      *
                               MOVE    ZERO    TO    FLG-WRITE45
                               MOVE    ZERO    TO    FLG-HENSYU-NG
                               MOVE    ZERO    TO    FLG-SETCOM
                               MOVE    ZERO    TO    WRK-SETCOM-JIDO
                               MOVE    ZERO    TO    WRK-SETCOM-JIDO2
                               MOVE    ZERO    TO    FLG-ZAITAKU-CHECK
                               MOVE    ZERO    TO    FLG-KIN-OKIKAE
                               MOVE    ZERO    TO    FLG-KIN-OKIKAE2
                               MOVE    ZERO    TO    FLG-SIPPU-COM
                               MOVE    ZERO    TO    FLG-SIPPU-ARI
                               MOVE    ZERO    TO    FLG-YKZ-PRTKBN
                               PERFORM   21011-RECE44-TENSOU-SEC
                               PERFORM   21012-RECE45-HENSYU-SEC
                               IF    FLG-WRITE45  =   1
                                 PERFORM 21013-RECE44-WRITE-SEC
                               END-IF
                           ELSE
                             IF    ACCT-ZAIKAISU  NOT =    ZERO
                             AND   ACCT-JIHOKBN       =    SPACE
      **>                    IF  ((ACCT-ZAIKAISU  NOT =    ZERO ) AND
      **>                         (WRK-PARA-PRTKBN    =
      **>                                     "1" OR "2" OR "3" ) AND
      **>                         (ACCT-JIHOKBN       =    SPACE))
      **>                    OR  ((ACCT-ZAIKAISU  NOT =    ZERO ) AND
      **>                         (WRK-PARA-PRTKBN    =
      **>                                            "4" OR "5" ))
                               IF ( ACCT-SRYKBN  NOT =
                                    "24" AND "90" AND "92" AND
                                    "93" AND "97"                 )
                               OR ( ACCT-ZAIKBN  =   1            )
                                 IF  (ACCT-SRYCDTOTAL(1:12)  =
                                                    "000000999901")
                                 AND (ACCT-MEISAISU      =   1    )
                                      CONTINUE
                                 ELSE
                                      MOVE  ACCT-DAY(1 WRK-DAY)  
                                                  TO  WRK-ZAIKAISU-XXX
                                      MOVE  ZERO  TO  WRK-TEN
                                                      WRK-MEISAI-CNT
                                                      WRK-SRYCDTOTAL
                                                      WRK-SURYOUTOTAL
                                                      WRK-YOUBUKASAN
                                                      WRK-KYOBUKASAN
                                                      WRK-KEIBUKASAN
                                                      WRK-SOGAIKASAN
                                                      WRK-RYOYOTEATE
                                                      WRK-ZAI-KINGAKU
      *
                                      MOVE  ZERO  TO  WRK-SRYSURYO
                                                      WRK-SRYSURYO2
                                                      WRK-SRYSURYO3
                                                      WRK-TANICD
                                                      WRK-TANIMOJISU
                                      MOVE  SPACE TO  WRK-TANINAME
                                      MOVE  ZERO  TO  FLG-HOUSIJI-COM
                                                      FLG-HOUTEN-COM
                                                      FLG-SYOBYO-COM
                                                      FLG-RYOYO-COM
                                                      FLG-SYODOU-COM
                                                      FLG-SAIDOU-COM
                                                      FLG-NIKOCHIN-COM
                                                      FLG-ZENSOKU-COM
                                                      FLG-OSIN-COM
                                                      FLG-ZAIHOU-COM
                                                      FLG-TAHOKEN
                                                      FLG-SYOUNI-COM
                                                      FLG-SRYKBN-HEN
                                                      FLG-KENSA-COM
                                                      FLG-ZAIRIHA-COM
                                                      FLG-ZAIKYO-COM
                                                      FLG-BOKOHO-COM
                                                      FLG-IZONSYO-COM
                                                      FLG-NINRYO-COM
                                                      FLG-NYUSEN-COM
                                                      FLG-KIATU-COM
      *
                                      MOVE  SPACE TO  WRK-KYUGYOFLG
                                      MOVE  ZERO  TO  FLG-COUNT-ARI
      *
                                      MOVE  SPACE TO  WRK-FORMALNAME
                                      MOVE  ZERO  TO
                                                  WRK-KZI058-TEN
                                                  WRK-KZI058-TANICD
                                                  WRK-KZI058-TANIMOJISU
                                      MOVE  SPACE TO
                                                  WRK-KZI058-TANINAME
      *
                                      MOVE  ZERO  TO  FLG-WRITE45
                                      MOVE  ZERO  TO  FLG-HENSYU-NG
                                      MOVE  ZERO  TO  FLG-SETCOM
                                      MOVE  ZERO  TO  WRK-SETCOM-JIDO
                                      MOVE  ZERO  TO  WRK-SETCOM-JIDO2
                                      MOVE  ZERO  TO  FLG-ZAITAKU-CHECK
                                      MOVE  ZERO  TO  FLG-KIN-OKIKAE
                                      MOVE  ZERO  TO  FLG-KIN-OKIKAE2
                                      MOVE  ZERO  TO  FLG-SIPPU-COM
                                      MOVE  ZERO  TO  FLG-SIPPU-ARI
                                      MOVE  ZERO  TO  FLG-YKZ-PRTKBN
                                      IF    ACCT-SRYKBN  =
                                            "60" OR "64" OR "80"
                                        PERFORM 21014-SINRYO-CHECK-SEC
                                      END-IF
                                      PERFORM   21011-RECE44-TENSOU-SEC
                                      PERFORM   21012-RECE45-HENSYU-SEC
                                      IF    FLG-WRITE45  =   1
                                        PERFORM 21013-RECE44-WRITE-SEC
                                      END-IF
                                 END-IF
                               END-IF
                             END-IF
                           END-IF
                   END-IF
                 END-IF
                 MOVE     "tbl_sryacct"    TO      MCP-TABLE
                 MOVE     "key24"          TO      MCP-PATHNAME
                 PERFORM   800-SRYACCT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryacct"       TO  MCP-TABLE
           MOVE    "key24"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       2104-RECE44-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ更新処理
      *****************************************************************
       2105-RECE41-REWRITE-SEC                SECTION.
      *
           IF   RECE41-HKNKBN     NOT  =   "4" AND "6"
             COMPUTE  RECE41-TOTALKIN2  =  RECE41-TOTALKIN2
                                        +  WRK-ZAITENNASHI
             IF    RECE41-HKNKBN   =   "5"
             AND   RECE41-KOMUKBN  =   "2"
               COMPUTE  RECE41-TOTALKIN   =   RECE41-TOTALTEN   *
                                              RECE41-KOMUTENTANKA
             ELSE
               COMPUTE  RECE41-TOTALKIN   =   RECE41-TOTALTEN   *
                                              RECE41-TANKA
             END-IF
           END-IF
      *
           IF   RECE41-HKNKBN     =   "4"                               
      *
             EVALUATE  WRK-PARA-RECEKBN
              WHEN      "4"
      ********（新様式）
               IF   WRK-PARA-JIBAIPRTKBN  =  "2"
                 COMPUTE   RECE41-TENSU(8)    =  RECE41-TENSU(1)
                                              +  RECE41-TENSU(2)
                                              +  RECE41-TENSU(3)
                                              +  RECE41-TENSU(4)
                                              +  RECE41-TENSU(5)
                                              +  RECE41-TENSU(6)
                                              +  RECE41-TENSU(7)
      *
                 COMPUTE   RECE41-TENSU-YAK(8)  =  RECE41-TENSU-YAK(7)
      *
                 COMPUTE   RECE41-TENSU(17)   =  RECE41-TENSU(10)
                                              +  RECE41-TENSU(13)
                                              +  RECE41-TENSU(14)
                                              +  RECE41-TENSU(15)
                                              +  RECE41-TENSU(16)
      *
                 COMPUTE   RECE41-TENSU-YAK(17) =  RECE41-TENSU-YAK(9)
                                                +  RECE41-TENSU-YAK(11)
                                                +  RECE41-TENSU-YAK(12)
      *
                 COMPUTE   RECE41-TENSU(22)     =  RECE41-TENSU(18)
                                                +  RECE41-TENSU(19)
                                                +  RECE41-TENSU(20)
      *
                 COMPUTE   RECE41-TENSU-YAK(22) =  RECE41-TENSU-YAK(21)
      *
                 COMPUTE   WRK-KSNRATE          =  RECE41-KSNRATE / 100
      *
                 PERFORM    VARYING    ID1    FROM    1   BY   1
                             UNTIL     ID1     >     31
      *
                   ADD   RECE41-SYUTEN-JI(ID1)  TO  RECE41-TOTALTEN
                   ADD   RECE41-YKZTEN-JI(ID1)  TO  RECE41-TOTALTEN-YAK
      *
                 END-PERFORM
      *
      *          減点編集
                 COMPUTE   RECE41-TOTALTEN  =  RECE41-TOTALTEN
                                            -  WRK-RECE4G-TENSU(2)
                                            -  WRK-RECE4G-TENSU(3)
                                            -  WRK-RECE4G-TENSU(5)
                                            -  WRK-RECE4G-TENSU(6)
                                            -  WRK-RECE4G-TENSU(7)
                                            -  WRK-RECE4G-TENSU(8)
                                            -  WRK-RECE4G-TENSU(9)
                                            -  WRK-RECE4G-TENSU(12)
                                            -  WRK-RECE4G-TENSU(14)
      *
                 COMPUTE   RECE41-TOTALKIN   =
                    (RECE41-TOTALTEN  *  RECE41-TANKA  *  WRK-KSNRATE)
                                                       +  0.5
      *
                 COMPUTE   RECE41-TOTALKIN-YAK =
                    (RECE41-TOTALTEN-YAK  *  RECE41-TANKA)  +  0.5
      *
                 COMPUTE   RECE41-KINGAKU2(5)   =  RECE41-KINGAKU2(1)
                                                +  RECE41-KINGAKU2(2)
                                                +  RECE41-KINGAKU2(3)
                                                +  RECE41-KINGAKU2(4)
      *
      ***        COMPUTE   RECE41-TOTALKIN2     =  RECE41-KINGAKU2(5)
      ***                                       *  WRK-KSNRATE
      *
                 COMPUTE   RECE41-TOTALKIN2     =
                    (RECE41-KINGAKU2(5)  *  WRK-KSNRATE)  +  0.5
      *
                 COMPUTE   RECE41-TOTALKIN2-ETC =  RECE41-KINGAKU2(6)
                                                +  RECE41-SINDAN-KIN
                                                +  RECE41-MEISAI-KIN
      *
                 PERFORM   21054-JIBAI-KINGAKU-HENSYU-SEC
               ELSE
                 COMPUTE   RECE41-TENSU(8)    =  RECE41-TENSU(1)
                                              +  RECE41-TENSU(2)
                                              +  RECE41-TENSU(3)
                                              +  RECE41-TENSU(4)
                                              +  RECE41-TENSU(5)
                                              +  RECE41-TENSU(6)
                                              +  RECE41-TENSU(7)
      *
                 COMPUTE   RECE41-TENSU-YAK(8)  =  RECE41-TENSU-YAK(7)
      *
                 COMPUTE   RECE41-TENSU(17)   =  RECE41-TENSU(10)
                                              +  RECE41-TENSU(13)
                                              +  RECE41-TENSU(14)
                                              +  RECE41-TENSU(15)
                                              +  RECE41-TENSU(16)
      *
                 COMPUTE   RECE41-TENSU-YAK(18) =  RECE41-TENSU-YAK(9)
                                                +  RECE41-TENSU-YAK(11)
                                                +  RECE41-TENSU-YAK(12)
      *
                 COMPUTE   RECE41-TENSU(23)     =  RECE41-TENSU(19)
                                                +  RECE41-TENSU(20)
                                                +  RECE41-TENSU(21)
      *
                 COMPUTE   RECE41-TENSU-YAK(24) =  RECE41-TENSU-YAK(22)
      *
                 COMPUTE   WRK-KSNRATE          =  RECE41-KSNRATE / 100
      *
                 PERFORM    VARYING    ID1    FROM    1   BY   1
                             UNTIL     ID1     >     31
      *
                   ADD   RECE41-SYUTEN-JI(ID1)  TO  RECE41-TOTALTEN
                   ADD   RECE41-YKZTEN-JI(ID1)  TO  RECE41-TOTALTEN-YAK
      *
                 END-PERFORM
      *
      *          減点編集
                 COMPUTE   RECE41-TOTALTEN  =  RECE41-TOTALTEN
                                            -  WRK-RECE4G-TENSU(2)
                                            -  WRK-RECE4G-TENSU(3)
                                            -  WRK-RECE4G-TENSU(5)
                                            -  WRK-RECE4G-TENSU(6)
                                            -  WRK-RECE4G-TENSU(7)
                                            -  WRK-RECE4G-TENSU(8)
                                            -  WRK-RECE4G-TENSU(9)
                                            -  WRK-RECE4G-TENSU(12)
                                            -  WRK-RECE4G-TENSU(14)
      *
                 COMPUTE   RECE41-TOTALKIN   =
                    (RECE41-TOTALTEN  *  RECE41-TANKA  *  WRK-KSNRATE)
                                                       +  0.5
      *
                 COMPUTE   RECE41-TOTALKIN-YAK =
                    (RECE41-TOTALTEN-YAK  *  RECE41-TANKA)  +  0.5
      *
                 COMPUTE   RECE41-KINGAKU2(5)   =  RECE41-KINGAKU2(1)
                                                +  RECE41-KINGAKU2(2)
                                                +  RECE41-KINGAKU2(3)
                                                +  RECE41-KINGAKU2(4)
      *
      ***        COMPUTE   RECE41-TOTALKIN2     =  RECE41-KINGAKU2(5)
      ***                                       *  WRK-KSNRATE
      *
                 COMPUTE   RECE41-TOTALKIN2     =
                    (RECE41-KINGAKU2(5)  *  WRK-KSNRATE)  +  0.5
      *
                 COMPUTE   RECE41-TOTALKIN2-ETC =  RECE41-KINGAKU2(6)
                                                +  RECE41-SINDAN-KIN
                                                +  RECE41-MEISAI-KIN
               END-IF
      *
              WHEN      "5"
      ********（従来様式）
      *
               COMPUTE   RECE41-TENSU(9)      =  RECE41-TENSU(1)
                                              +  RECE41-TENSU(2)
                                              +  RECE41-TENSU(3)
                                              +  RECE41-TENSU(4)
                                              +  RECE41-TENSU(5)
                                              +  RECE41-TENSU(6)
                                              +  RECE41-TENSU(7)
                                              +  RECE41-TENSU(8)
      *
               COMPUTE   RECE41-TENSU(18)     =  RECE41-TENSU(10)
                                              +  RECE41-TENSU(11)
                                              +  RECE41-TENSU(12)
                                              +  RECE41-TENSU(13)
                                              +  RECE41-TENSU(14)
                                              +  RECE41-TENSU(15)
                                              +  RECE41-TENSU(16)
                                              +  RECE41-TENSU(17)
      *
               COMPUTE   RECE41-TENSU(22)     =  RECE41-TENSU(19)
                                              +  RECE41-TENSU(20)
                                              +  RECE41-TENSU(21)
      *
               COMPUTE   RECE41-TENSU(25)     =  RECE41-TENSU(23)
                                              +  RECE41-TENSU(24)
      *
               COMPUTE   RECE41-TENSU(28)     =  RECE41-TENSU(26)
                                              +  RECE41-TENSU(27)
      *
               COMPUTE   RECE41-TENSU(31)     =  RECE41-TENSU(29)
                                              +  RECE41-TENSU(30)
      *
               COMPUTE   RECE41-TENSU(34)     =  RECE41-TENSU(32)
                                              +  RECE41-TENSU(33)
      *
               COMPUTE   RECE41-TENSU(38)     =  RECE41-TENSU(35)
                                              +  RECE41-TENSU(36)
                                              +  RECE41-TENSU(37)
      *
      ***      COMPUTE   RECE41-TOTALTEN      =  RECE41-TENSU(9)
      ***                                     +  RECE41-TENSU(18)
      ***                                     +  RECE41-TENSU(22)
      ***                                     +  RECE41-TENSU(25)
      ***                                     +  RECE41-TENSU(28)
      ***                                     +  RECE41-TENSU(31)
      ***                                     +  RECE41-TENSU(34)
      ***                                     +  RECE41-TENSU(38)
      *
               MOVE       ZERO         TO        WRK-SYUTEN-JI
                                                 WRK-YKZTEN-JI
               PERFORM    VARYING    ID1    FROM    1   BY   1
                           UNTIL     ID1     >     31
                  ADD   RECE41-SYUTEN-JI(ID1)  TO  RECE41-TOTALTEN
                                                   WRK-SYUTEN-JI
                  ADD   RECE41-YKZTEN-JI(ID1)  TO  RECE41-TOTALTEN
                                                   WRK-YKZTEN-JI
               END-PERFORM
      *        減点編集
               COMPUTE   RECE41-TOTALTEN  =  RECE41-TOTALTEN
                                          -  WRK-RECE4G-TENSU(2)
                                          -  WRK-RECE4G-TENSU(3)
                                          -  WRK-RECE4G-TENSU(5)
                                          -  WRK-RECE4G-TENSU(6)
                                          -  WRK-RECE4G-TENSU(7)
                                          -  WRK-RECE4G-TENSU(8)
                                          -  WRK-RECE4G-TENSU(9)
                                          -  WRK-RECE4G-TENSU(12)
                                          -  WRK-RECE4G-TENSU(14)
               COMPUTE   WRK-SYUTEN-JI    =  WRK-SYUTEN-JI
                                          -  WRK-RECE4G-TENSU(2)
                                          -  WRK-RECE4G-TENSU(3)
                                          -  WRK-RECE4G-TENSU(5)
                                          -  WRK-RECE4G-TENSU(6)
                                          -  WRK-RECE4G-TENSU(7)
                                          -  WRK-RECE4G-TENSU(8)
                                          -  WRK-RECE4G-TENSU(9)
                                          -  WRK-RECE4G-TENSU(12)
                                          -  WRK-RECE4G-TENSU(14)
      *
               IF   TBL-SYUTEN-JI(2)  >=  WRK-RECE4G-TENSU(2)
                 COMPUTE  TBL-SYUTEN-JI(2) =
                          TBL-SYUTEN-JI(2) -  WRK-RECE4G-TENSU(2)
               ELSE
                 MOVE     ZERO    TO   TBL-SYUTEN-JI(2)
               END-IF
               IF   TBL-SYUTEN-JI(7)  >=  WRK-RECE4G-TENSU(7)
                 COMPUTE  TBL-SYUTEN-JI(7) =
                          TBL-SYUTEN-JI(7) -  WRK-RECE4G-TENSU(7)
               ELSE
                 MOVE     ZERO    TO   TBL-SYUTEN-JI(7)
               END-IF
               IF   TBL-SYUTEN-JI(8)  >=  WRK-RECE4G-TENSU(8)
                 COMPUTE  TBL-SYUTEN-JI(8) =
                          TBL-SYUTEN-JI(8) -  WRK-RECE4G-TENSU(8)
               ELSE
                 MOVE     ZERO    TO   TBL-SYUTEN-JI(8)
               END-IF
      *
               EVALUATE   RECE41-JIBAIKBN
      *
                 WHEN       "1"
      *
                   COMPUTE   WRK-KSNRATE   =  RECE41-KSNRATE / 100
      *
                   COMPUTE  RECE41-TOTALKIN-JYU   =
                            RECE41-TOTALKIN-JYU   +
                      (WRK-SYUTEN-JI  *  RECE41-TANKA  *  WRK-KSNRATE)
                                                       +  0.5
                   COMPUTE  RECE41-TOTALKIN-JYU   =
                            RECE41-TOTALKIN-JYU   +
                      (WRK-YKZTEN-JI  *  RECE41-TANKA) +  0.5
      *
                   COMPUTE  RECE41-SONOTAKIN-JYU  =
                            RECE41-SONOTAKIN-JYU  +
                      (WRK-KINGAKU-JI *  WRK-KSNRATE)  +  0.5
      ***
                   PERFORM    VARYING    ID1    FROM    1   BY   1
                               UNTIL     ID1     >     38
                     IF   ID1  =   9  OR  18  OR  22  OR  25  OR
                                  28  OR  31  OR  34  OR  38
                        CONTINUE
                     ELSE
                        COMPUTE  RECE41-KINGAKU-JYU(ID1) =
                                 RECE41-KINGAKU-JYU(ID1) +
                        (TBL-SYUTEN-JI(ID1) * RECE41-TANKA
                                            * WRK-KSNRATE )
                                                           + 0.5
                        COMPUTE  RECE41-KINGAKU-JYU(ID1) =
                                 RECE41-KINGAKU-JYU(ID1) +
                        (TBL-YKZTEN-JI(ID1) * RECE41-TANKA)
                                                           + 0.5
                     END-IF
                   END-PERFORM
      *
                 WHEN       "2"
      *
                   COMPUTE  RECE41-TOTALKIN-JYU   =
                            RECE41-TOTALKIN-JYU   +
                      (WRK-SYUTEN-JI  *  RECE41-SYUTENTANKA)
                   COMPUTE  RECE41-TOTALKIN-JYU   =
                            RECE41-TOTALKIN-JYU   +
                      (WRK-YKZTEN-JI  *  RECE41-YKZTENTANKA)
      ***
                   PERFORM    VARYING    ID1    FROM    1   BY   1
                               UNTIL     ID1     >     38
                     IF   ID1  =   9  OR  18  OR  22  OR  25  OR
                                  28  OR  31  OR  34  OR  38
                        CONTINUE
                     ELSE
                        COMPUTE  RECE41-KINGAKU-JYU(ID1) =
                                 RECE41-KINGAKU-JYU(ID1) +
                        (TBL-SYUTEN-JI(ID1) * RECE41-SYUTENTANKA)
                        COMPUTE  RECE41-KINGAKU-JYU(ID1) =
                                 RECE41-KINGAKU-JYU(ID1) +
                        (TBL-YKZTEN-JI(ID1) * RECE41-YKZTENTANKA)
                     END-IF
                   END-PERFORM
      *
               END-EVALUATE
      *
               COMPUTE   RECE41-KINGAKU-JYU(9)  =
                         RECE41-KINGAKU-JYU(1)  +
                         RECE41-KINGAKU-JYU(2)  +
                         RECE41-KINGAKU-JYU(3)  +
                         RECE41-KINGAKU-JYU(4)  +
                         RECE41-KINGAKU-JYU(5)  +
                         RECE41-KINGAKU-JYU(6)  +
                         RECE41-KINGAKU-JYU(7)  +
                         RECE41-KINGAKU-JYU(8)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(18)  =
                         RECE41-KINGAKU-JYU(10)  +
                         RECE41-KINGAKU-JYU(11)  +
                         RECE41-KINGAKU-JYU(12)  +
                         RECE41-KINGAKU-JYU(13)  +
                         RECE41-KINGAKU-JYU(14)  +
                         RECE41-KINGAKU-JYU(15)  +
                         RECE41-KINGAKU-JYU(16)  +
                         RECE41-KINGAKU-JYU(17)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(22)  =
                         RECE41-KINGAKU-JYU(19)  +
                         RECE41-KINGAKU-JYU(20)  +
                         RECE41-KINGAKU-JYU(21)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(25)  =
                         RECE41-KINGAKU-JYU(23)  +
                         RECE41-KINGAKU-JYU(24)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(28)  =
                         RECE41-KINGAKU-JYU(26)  +
                         RECE41-KINGAKU-JYU(27)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(31)  =
                         RECE41-KINGAKU-JYU(29)  +
                         RECE41-KINGAKU-JYU(30)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(34)  =
                         RECE41-KINGAKU-JYU(32)  +
                         RECE41-KINGAKU-JYU(33)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(38)  =
                         RECE41-KINGAKU-JYU(35)  +
                         RECE41-KINGAKU-JYU(36)  +
                         RECE41-KINGAKU-JYU(37)   
      *
             END-EVALUATE
      *
           END-IF                                                       
      *
           IF   RECE41-HKNKBN     =   "6"
      *
               COMPUTE   RECE41-TENSU(9)      =  RECE41-TENSU(1)
                                              +  RECE41-TENSU(2)
                                              +  RECE41-TENSU(3)
                                              +  RECE41-TENSU(4)
                                              +  RECE41-TENSU(5)
                                              +  RECE41-TENSU(6)
                                              +  RECE41-TENSU(7)
                                              +  RECE41-TENSU(8)
      *
               COMPUTE   RECE41-TENSU(18)     =  RECE41-TENSU(10)
                                              +  RECE41-TENSU(11)
                                              +  RECE41-TENSU(12)
                                              +  RECE41-TENSU(13)
                                              +  RECE41-TENSU(14)
                                              +  RECE41-TENSU(15)
                                              +  RECE41-TENSU(16)
                                              +  RECE41-TENSU(17)
      *
               COMPUTE   RECE41-TENSU(22)     =  RECE41-TENSU(19)
                                              +  RECE41-TENSU(20)
                                              +  RECE41-TENSU(21)
      *
               COMPUTE   RECE41-TENSU(25)     =  RECE41-TENSU(23)
                                              +  RECE41-TENSU(24)
      *
               COMPUTE   RECE41-TENSU(28)     =  RECE41-TENSU(26)
                                              +  RECE41-TENSU(27)
      *
               COMPUTE   RECE41-TENSU(31)     =  RECE41-TENSU(29)
                                              +  RECE41-TENSU(30)
      *
               COMPUTE   RECE41-TENSU(34)     =  RECE41-TENSU(32)
                                              +  RECE41-TENSU(33)
      *
               COMPUTE   RECE41-TENSU(38)     =  RECE41-TENSU(35)
                                              +  RECE41-TENSU(36)
                                              +  RECE41-TENSU(37)
      *
               MOVE       ZERO         TO        WRK-SYUTEN-JI
                                                 WRK-YKZTEN-JI
               PERFORM    VARYING    ID1    FROM    1   BY   1
                           UNTIL     ID1     >     31
                  ADD   RECE41-SYUTEN-JI(ID1)  TO  RECE41-TOTALTEN
                                                   WRK-SYUTEN-JI
                  ADD   RECE41-YKZTEN-JI(ID1)  TO  RECE41-TOTALTEN
                                                   WRK-YKZTEN-JI
               END-PERFORM
      *        減点編集
               COMPUTE   RECE41-TOTALTEN  =  RECE41-TOTALTEN
                                          -  WRK-RECE4G-TENSU(2)
                                          -  WRK-RECE4G-TENSU(3)
                                          -  WRK-RECE4G-TENSU(5)
                                          -  WRK-RECE4G-TENSU(6)
                                          -  WRK-RECE4G-TENSU(7)
                                          -  WRK-RECE4G-TENSU(8)
                                          -  WRK-RECE4G-TENSU(9)
                                          -  WRK-RECE4G-TENSU(12)
                                          -  WRK-RECE4G-TENSU(14)
               COMPUTE   WRK-SYUTEN-JI    =  WRK-SYUTEN-JI
                                          -  WRK-RECE4G-TENSU(2)
                                          -  WRK-RECE4G-TENSU(3)
                                          -  WRK-RECE4G-TENSU(5)
                                          -  WRK-RECE4G-TENSU(6)
                                          -  WRK-RECE4G-TENSU(7)
                                          -  WRK-RECE4G-TENSU(8)
                                          -  WRK-RECE4G-TENSU(9)
                                          -  WRK-RECE4G-TENSU(12)
                                          -  WRK-RECE4G-TENSU(14)
      *
               IF   TBL-SYUTEN-JI(2)  >=  WRK-RECE4G-TENSU(2)
                 COMPUTE  TBL-SYUTEN-JI(2) =
                          TBL-SYUTEN-JI(2) -  WRK-RECE4G-TENSU(2)
               ELSE
                 MOVE     ZERO    TO   TBL-SYUTEN-JI(2)
               END-IF
               IF   TBL-SYUTEN-JI(7)  >=  WRK-RECE4G-TENSU(7)
                 COMPUTE  TBL-SYUTEN-JI(7) =
                          TBL-SYUTEN-JI(7) -  WRK-RECE4G-TENSU(7)
               ELSE
                 MOVE     ZERO    TO   TBL-SYUTEN-JI(7)
               END-IF
               IF   TBL-SYUTEN-JI(8)  >=  WRK-RECE4G-TENSU(8)
                 COMPUTE  TBL-SYUTEN-JI(8) =
                          TBL-SYUTEN-JI(8) -  WRK-RECE4G-TENSU(8)
               ELSE
                 MOVE     ZERO    TO   TBL-SYUTEN-JI(8)
               END-IF
      *
               COMPUTE  RECE41-TOTALKIN-JYU   =
                        RECE41-TOTALKIN-JYU   +
                       (WRK-SYUTEN-JI  *  RECE41-SYUTENTANKA)
               COMPUTE  RECE41-TOTALKIN-JYU   =
                        RECE41-TOTALKIN-JYU   +
                       (WRK-YKZTEN-JI  *  RECE41-YKZTENTANKA)
      ***
               PERFORM    VARYING    ID1    FROM    1   BY   1
                           UNTIL     ID1     >     38
                 IF   ID1  =   9  OR  18  OR  22  OR  25  OR
                              28  OR  31  OR  34  OR  38
                    CONTINUE
                 ELSE
                    COMPUTE  RECE41-KINGAKU-JYU(ID1) =
                             RECE41-KINGAKU-JYU(ID1) +
                            (TBL-SYUTEN-JI(ID1) * RECE41-SYUTENTANKA)
                    COMPUTE  RECE41-KINGAKU-JYU(ID1) =
                             RECE41-KINGAKU-JYU(ID1) +
                            (TBL-YKZTEN-JI(ID1) * RECE41-YKZTENTANKA)
                 END-IF
               END-PERFORM
      *
               COMPUTE   RECE41-KINGAKU-JYU(9)  =
                         RECE41-KINGAKU-JYU(1)  +
                         RECE41-KINGAKU-JYU(2)  +
                         RECE41-KINGAKU-JYU(3)  +
                         RECE41-KINGAKU-JYU(4)  +
                         RECE41-KINGAKU-JYU(5)  +
                         RECE41-KINGAKU-JYU(6)  +
                         RECE41-KINGAKU-JYU(7)  +
                         RECE41-KINGAKU-JYU(8)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(18)  =
                         RECE41-KINGAKU-JYU(10)  +
                         RECE41-KINGAKU-JYU(11)  +
                         RECE41-KINGAKU-JYU(12)  +
                         RECE41-KINGAKU-JYU(13)  +
                         RECE41-KINGAKU-JYU(14)  +
                         RECE41-KINGAKU-JYU(15)  +
                         RECE41-KINGAKU-JYU(16)  +
                         RECE41-KINGAKU-JYU(17)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(22)  =
                         RECE41-KINGAKU-JYU(19)  +
                         RECE41-KINGAKU-JYU(20)  +
                         RECE41-KINGAKU-JYU(21)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(25)  =
                         RECE41-KINGAKU-JYU(23)  +
                         RECE41-KINGAKU-JYU(24)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(28)  =
                         RECE41-KINGAKU-JYU(26)  +
                         RECE41-KINGAKU-JYU(27)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(31)  =
                         RECE41-KINGAKU-JYU(29)  +
                         RECE41-KINGAKU-JYU(30)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(34)  =
                         RECE41-KINGAKU-JYU(32)  +
                         RECE41-KINGAKU-JYU(33)   
      *
               COMPUTE   RECE41-KINGAKU-JYU(38)  =
                         RECE41-KINGAKU-JYU(35)  +
                         RECE41-KINGAKU-JYU(36)  +
                         RECE41-KINGAKU-JYU(37)   
      *
               IF    RECE41-DAISAN-CHIKAN   =   1
                 IF  RECE41-TOTALKIN-JYU < RECE41-FTNMONEY
                   MOVE   RECE41-TOTALKIN-JYU   TO
                                           RECE41-FTNMONEY
                 END-IF
               END-IF
      *
      *        第三者行為の現物給付判定
               PERFORM   21053-DAISAN-GENBUTU-HANTEI-SEC
      *
               EVALUATE  RECE41-DAISAN-GENBUTU-GAITO
                 WHEN      ZERO
                   IF    RECE41-DAISAN-CHIKAN   =  ZERO
                     IF   WRK-DAISAN-DAISANKBN  =  "1"
                       PERFORM   21051-DAISAN-CHECK-SEC
                       MOVE  WRK-DAISAN-FTNMONEY   TO  RECE41-FTNMONEY
                     ELSE
                       IF   RECE41-TOTALKIN-JYU  NOT =  ZERO
                       AND  RECE41-FTNRATE       NOT =  ZERO
                         COMPUTE RECE41-FTNMONEY = RECE41-TOTALKIN-JYU
                                                 * RECE41-FTNRATE
                                                 / 100
                       END-IF
                     END-IF
                   END-IF
                 WHEN       1
                   IF    RECE41-DAISAN-CHIKAN   =  ZERO
                     PERFORM     21052-DAISAN-CHECK2-SEC
                     MOVE    WRK-DAISAN-FTNMONEY   TO  RECE41-FTNMONEY
                   END-IF
               END-EVALUATE
               COMPUTE   RECE41-SKYMONEY = RECE41-TOTALKIN-JYU
                                         - RECE41-FTNMONEY
      *
           END-IF                                                       
      *
           REWRITE   RECE41-REC
      *
           ADD     1                   TO  CNT-OUT3
      *
           .
       2105-RECE41-REWRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の一部負担金計算（１０円未満四捨五入の場合）
      *****************************************************************
       21051-DAISAN-CHECK-SEC      SECTION.
      *
           MOVE     ZERO     TO    WRK-DAISAN-TOTALTEN-SYUNOU
           MOVE     ZERO     TO    WRK-DAISAN-FTNMONEY
           MOVE     SPACE    TO    WRK-DAISAN-ACCT-UPDKBN
      *
           INITIALIZE                       SYUNOU-REC
           MOVE  RECE41-HOSPNUM         TO  SYU-HOSPNUM
           MOVE  RECE41-NYUGAIKBN       TO  SYU-NYUGAIKBN
           MOVE  RECE41-PTID            TO  SYU-PTID
           MOVE  RECE41-SRYYM           TO  SYU-SRYYMD(1:6)
           MOVE  "__"                   TO  SYU-SRYYMD(7:2)
           MOVE  RECE41-HKNCOMBI        TO  SYU-HKNCOMBINUM
           MOVE  SYUNOU-REC             TO  MCPDATA-REC
           MOVE  "tbl_syunou"           TO  MCP-TABLE
           MOVE  "key41"                TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF    MCP-RC   =   ZERO
             MOVE    "tbl_syunou"       TO  MCP-TABLE
             MOVE    "key41"            TO  MCP-PATHNAME
             PERFORM  800-SYUNOU-READ-SEC
             PERFORM  UNTIL  (FLG-SYUNOU  =  1)
               IF    SYU-DENPJTIKBN    NOT =  "3"
                 IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                   ADD  SYU-TOTAL-HKNTEN
                              TO  WRK-DAISAN-TOTALTEN-SYUNOU
                   COMPUTE  WRK-DAISAN-FTNMONEY2 = SYU-TOTAL-HKNTEN
                                                 * 10
                                                 * RECE41-FTNRATE
                                                 / 100
                   COMPUTE  WRK-DAISAN-FTNMONEY2 =
                            WRK-DAISAN-FTNMONEY2 +  5
                   COMPUTE  WRK-DAISAN-FTNMONEY2 =
                            WRK-DAISAN-FTNMONEY2 /  10
                   COMPUTE  WRK-DAISAN-FTNMONEY2 =
                            WRK-DAISAN-FTNMONEY2 *  10
      *
                   COMPUTE  WRK-DAISAN-FTNMONEY  =
                            WRK-DAISAN-FTNMONEY  +
                            WRK-DAISAN-FTNMONEY2
                 END-IF
                 IF  SYU-ACCT-UPDKBN  NOT =  SPACE
                   MOVE  "1"  TO  WRK-DAISAN-ACCT-UPDKBN
                 END-IF
               END-IF
               MOVE    "tbl_syunou"     TO  MCP-TABLE
               MOVE    "key41"          TO  MCP-PATHNAME
               PERFORM  800-SYUNOU-READ-SEC
             END-PERFORM
           END-IF
           MOVE      "tbl_syunou"       TO  MCP-TABLE
           MOVE      "key41"            TO  MCP-PATHNAME
           PERFORM    900-CLOSE-SEC
      *
      *    リアルタイムプレビュー時
           IF   (WRK-PARA-SHELLID        =   "RECEPTX")
           AND  (WRK-DAISAN-ACCT-UPDKBN  =    SPACE   )
      *
             COMPUTE WRK-DAISAN-TOTALTEN = RECE41-TOTALKIN-JYU
                                         / 10
             IF   WRK-DAISAN-TOTALTEN  >  WRK-DAISAN-TOTALTEN-SYUNOU
               COMPUTE  WRK-DAISAN-FTNMONEY2 =
                  (WRK-DAISAN-TOTALTEN - WRK-DAISAN-TOTALTEN-SYUNOU)
                                             * 10
                                             * RECE41-FTNRATE
                                             / 100
               COMPUTE  WRK-DAISAN-FTNMONEY2 =
                        WRK-DAISAN-FTNMONEY2 +  5
               COMPUTE  WRK-DAISAN-FTNMONEY2 =
                        WRK-DAISAN-FTNMONEY2 /  10
               COMPUTE  WRK-DAISAN-FTNMONEY2 =
                        WRK-DAISAN-FTNMONEY2 *  10
      *
               COMPUTE  WRK-DAISAN-FTNMONEY  =
                        WRK-DAISAN-FTNMONEY  +
                        WRK-DAISAN-FTNMONEY2
             END-IF
      *
           END-IF
      *
           .
       21051-DAISAN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の一部負担金計算＜現物給付＞
      *****************************************************************
       21052-DAISAN-CHECK2-SEC      SECTION.
      *
           MOVE     ZERO     TO    WRK-DAISAN-TOTALTEN-SYUNOU
           MOVE     ZERO     TO    WRK-DAISAN-FTNMONEY
           MOVE     SPACE    TO    WRK-DAISAN-ACCT-UPDKBN
      *
           INITIALIZE                       SYUNOU-REC
           MOVE  RECE41-HOSPNUM         TO  SYU-HOSPNUM
           MOVE  RECE41-NYUGAIKBN       TO  SYU-NYUGAIKBN
           MOVE  RECE41-PTID            TO  SYU-PTID
           MOVE  RECE41-SRYYM           TO  SYU-SRYYMD(1:6)
           MOVE  "__"                   TO  SYU-SRYYMD(7:2)
           MOVE  RECE41-HKNCOMBI        TO  SYU-HKNCOMBINUM
           MOVE  SYUNOU-REC             TO  MCPDATA-REC
           MOVE  "tbl_syunou"           TO  MCP-TABLE
           MOVE  "key41"                TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF    MCP-RC   =   ZERO
             MOVE    "tbl_syunou"       TO  MCP-TABLE
             MOVE    "key41"            TO  MCP-PATHNAME
             PERFORM  800-SYUNOU-READ-SEC
             PERFORM  UNTIL  (FLG-SYUNOU  =  1)
               IF    SYU-DENPJTIKBN    NOT =  "3"
                 IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                   ADD  SYU-TOTAL-HKNTEN
                              TO  WRK-DAISAN-TOTALTEN-SYUNOU
      *
                   COMPUTE  WRK-DAISAN-FTNMONEY  =
                            WRK-DAISAN-FTNMONEY  +
                            SYU-SYUCOMPFTN
                 END-IF
                 IF  SYU-ACCT-UPDKBN  NOT =  SPACE
                   MOVE  "1"  TO  WRK-DAISAN-ACCT-UPDKBN
                 END-IF
               END-IF
               MOVE    "tbl_syunou"     TO  MCP-TABLE
               MOVE    "key41"          TO  MCP-PATHNAME
               PERFORM  800-SYUNOU-READ-SEC
             END-PERFORM
           END-IF
           MOVE      "tbl_syunou"       TO  MCP-TABLE
           MOVE      "key41"            TO  MCP-PATHNAME
           PERFORM    900-CLOSE-SEC
      *
      *    リアルタイムプレビュー時
      ***  IF   (WRK-PARA-SHELLID        =   "RECEPTX")
      ***  AND  (WRK-DAISAN-ACCT-UPDKBN  =    SPACE   )
      *
      ***    COMPUTE WRK-DAISAN-TOTALTEN = RECE41-TOTALKIN-JYU
      ***                                / 10
      ***    IF   WRK-DAISAN-TOTALTEN  >  WRK-DAISAN-TOTALTEN-SYUNOU
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***         (WRK-DAISAN-TOTALTEN - WRK-DAISAN-TOTALTEN-SYUNOU)
      ***                                    * 10
      ***                                    * RECE41-FTNRATE
      ***                                    / 100
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***               WRK-DAISAN-FTNMONEY2 +  5
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***               WRK-DAISAN-FTNMONEY2 /  10
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***               WRK-DAISAN-FTNMONEY2 *  10
      *
      ***      COMPUTE  WRK-DAISAN-FTNMONEY  =
      ***               WRK-DAISAN-FTNMONEY  +
      ***               WRK-DAISAN-FTNMONEY2
      ***    END-IF
      *
      ***  END-IF
      *
           .
       21052-DAISAN-CHECK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の現物給付判定
      *****************************************************************
       21053-DAISAN-GENBUTU-HANTEI-SEC      SECTION.
      *
      *    現物給付計算対象かチェック
      *    全ての収納が現物給付計算されているかチェック
           MOVE     ZERO       TO     FLG-DAISAN-GENBUTU
           IF    RECE41-DAISAN-GENBUTU-GAITO   =   1
      *
             INITIALIZE                       SYUNOU-REC
             MOVE  RECE41-HOSPNUM         TO  SYU-HOSPNUM
             MOVE  RECE41-NYUGAIKBN       TO  SYU-NYUGAIKBN
             MOVE  RECE41-PTID            TO  SYU-PTID
             MOVE  RECE41-SRYYM           TO  SYU-SRYYMD(1:6)
             MOVE  "__"                   TO  SYU-SRYYMD(7:2)
             MOVE  RECE41-HKNCOMBI        TO  SYU-HKNCOMBINUM
             MOVE  SYUNOU-REC             TO  MCPDATA-REC
             MOVE  "tbl_syunou"           TO  MCP-TABLE
             MOVE  "key41"                TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF    MCP-RC   =   ZERO
               MOVE    "tbl_syunou"       TO  MCP-TABLE
               MOVE    "key41"            TO  MCP-PATHNAME
               PERFORM  800-SYUNOU-READ-SEC
               PERFORM  UNTIL  (FLG-SYUNOU  =  1)
                 IF    SYU-DENPJTIKBN    NOT =  "3"
                   IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                   AND SYU-SKJ-FTNGAKU(2)    = ZERO
                     MOVE     1           TO  FLG-DAISAN-GENBUTU
                   END-IF
                 END-IF
                 MOVE    "tbl_syunou"     TO  MCP-TABLE
                 MOVE    "key41"          TO  MCP-PATHNAME
                 PERFORM  800-SYUNOU-READ-SEC
               END-PERFORM
             END-IF
             MOVE      "tbl_syunou"       TO  MCP-TABLE
             MOVE      "key41"            TO  MCP-PATHNAME
             PERFORM    900-CLOSE-SEC
      *
             IF   FLG-DAISAN-GENBUTU    =   1
               MOVE     ZERO       TO     RECE41-DAISAN-GENBUTU-GAITO
             END-IF
      *
           END-IF
      *
           .
       21053-DAISAN-GENBUTU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    自賠責（新様式）（ＯＣＲ様式）の金額編集
      *****************************************************************
       21054-JIBAI-KINGAKU-HENSYU-SEC      SECTION.
      *
           COMPUTE  WRK-JIBAI-SKYKIN-A   =  RECE41-TOTALKIN
                                         +  RECE41-TOTALKIN-YAK
                                         +  RECE41-TOTALKIN2
                                         +  RECE41-TOTALKIN2-ETC
      *
           MOVE     WRK-JIBAI-SKYKIN-A  TO  RECE41-JIBAI-GOKEI-BE
                                            RECE41-JIBAI-GOKEI-AF
      *
           IF       WRK-JIBAI-SKYKIN-A   >  ZERO
             EVALUATE   RECE41-JIBAI-HASUKBN
               WHEN       "1"
                  COMPUTE  WRK-JIBAI-SKYKIN-A  =
                           WRK-JIBAI-SKYKIN-A  +   5
                  COMPUTE  WRK-JIBAI-SKYKIN-A  =
                           WRK-JIBAI-SKYKIN-A  /  10
                  COMPUTE  WRK-JIBAI-SKYKIN-A  =
                           WRK-JIBAI-SKYKIN-A  *  10
               WHEN       "2"
                  COMPUTE  WRK-JIBAI-SKYKIN-A  =
                           WRK-JIBAI-SKYKIN-A  /  10
                  COMPUTE  WRK-JIBAI-SKYKIN-A  =
                           WRK-JIBAI-SKYKIN-A  *  10
               WHEN       "3"
                  COMPUTE  WRK-JIBAI-SKYKIN-A  =
                           WRK-JIBAI-SKYKIN-A  +   9
                  COMPUTE  WRK-JIBAI-SKYKIN-A  =
                           WRK-JIBAI-SKYKIN-A  /  10
                  COMPUTE  WRK-JIBAI-SKYKIN-A  =
                           WRK-JIBAI-SKYKIN-A  *  10
             END-EVALUATE
             IF   RECE41-SEIKYUKBN    =  "1"
               MOVE  1                   TO  RECE41-JIBAI-JYUKINFLG
               MOVE  WRK-JIBAI-SKYKIN-A  TO  RECE41-JIBAI-JYUKIN
             ELSE
               MOVE  1                   TO  RECE41-JIBAI-SKYKINFLG
               MOVE  WRK-JIBAI-SKYKIN-A  TO  RECE41-JIBAI-SKYKIN
             END-IF
             MOVE    WRK-JIBAI-SKYKIN-A  TO  RECE41-JIBAI-GOKEI-AF
           END-IF
      *
           IF       RECE41-JIBAI-CHIKANKINFLG  =  1
             IF  WRK-JIBAI-SKYKIN-A  >  ZERO
               IF   WRK-JIBAI-SKYKIN-A  <  RECE41-JIBAI-CHIKANKIN
                 MOVE    WRK-JIBAI-SKYKIN-A  TO  RECE41-JIBAI-CHIKANKIN
               END-IF
               IF   RECE41-JIBAI-CHIKANKIN  >  ZERO
                 MOVE    1                   TO  RECE41-JIBAI-JYUKINFLG
                 MOVE    RECE41-JIBAI-CHIKANKIN
                                             TO  RECE41-JIBAI-JYUKIN
                 COMPUTE WRK-JIBAI-SKYKIN-B = WRK-JIBAI-SKYKIN-A
                                            - RECE41-JIBAI-CHIKANKIN
                 IF    WRK-JIBAI-SKYKIN-B  >  ZERO
                   MOVE  1                   TO  RECE41-JIBAI-SKYKINFLG
                   MOVE  WRK-JIBAI-SKYKIN-B  TO  RECE41-JIBAI-SKYKIN
                 ELSE
                   MOVE  ZERO                TO  RECE41-JIBAI-SKYKINFLG
                   MOVE  ZERO                TO  RECE41-JIBAI-SKYKIN
                 END-IF
               ELSE
                 MOVE    ZERO                TO  RECE41-JIBAI-JYUKINFLG
                 MOVE    ZERO                TO  RECE41-JIBAI-JYUKIN
                 MOVE    1                   TO  RECE41-JIBAI-SKYKINFLG
                 MOVE    WRK-JIBAI-SKYKIN-A  TO  RECE41-JIBAI-SKYKIN
               END-IF
             ELSE
               MOVE      2        TO  RECE41-JIBAI-CHIKANKINFLG
             END-IF
           END-IF
      *
           IF       RECE41-JIBAI-CHIKANNAMEFLG  =  1
             IF  WRK-JIBAI-SKYKIN-A  >  ZERO
               IF     RECE41-JIBAI-JYUKINFLG      =  1
                 MOVE    1        TO  RECE41-JIBAI-JYUNAMEFLG
                 MOVE    RECE41-JIBAI-CHIKANNAME
                                  TO  RECE41-JIBAI-JYUNAME
               ELSE
                 MOVE    2        TO  RECE41-JIBAI-CHIKANNAMEFLG
               END-IF
             ELSE
                 MOVE    2        TO  RECE41-JIBAI-CHIKANNAMEFLG
             END-IF
           END-IF
      *
           .
       21054-JIBAI-KINGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの基本点数部分のクリア処理（公務災害）
      *****************************************************************
       2106-KHNTEN-KO-CLEAR-SEC               SECTION.
      *
           IF        FLG-KHNTEN2-KO  =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(2)
           END-IF
           IF        FLG-KHNTEN3-KO  =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(3)
           END-IF
           IF        FLG-KHNTEN4-KO  =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(4)
           END-IF
           IF        FLG-KHNTEN5-KO  =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(5)
           END-IF
           IF        FLG-KHNTEN6-KO  =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(6)
           END-IF
           IF        FLG-KHNTEN7-KO  =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(7)
           END-IF
           IF        FLG-KHNTEN8-KO  =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(8)
           END-IF
           IF        FLG-KHNTEN17-KO =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(17)
           END-IF
           IF        FLG-KHNTEN19-KO =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(19)
           END-IF
           IF        FLG-KHNTEN21-KO =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(21)
           END-IF
           IF        FLG-KHNTEN22-KO =    1
             MOVE    ZERO             TO   RECE41-KHNTEN(22)
           END-IF
      *
           IF     RECE41-KOMUKBN  =   "2"
             IF   ((CNT-SAISIN-ETC      NOT =  ZERO) AND
                   (CNT-SAISIN-DOUJITU  NOT =  ZERO))
             OR   ((CNT-SAISIN-ETC      NOT =  ZERO) AND
                   (CNT-SAISIN-ONLINE   NOT =  ZERO))
             OR   ((CNT-SAISIN-DOUJITU  NOT =  ZERO) AND
                   (CNT-SAISIN-ONLINE   NOT =  ZERO))
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
             END-IF
             IF   RECE41-SRYYM   >=  "201004"
               IF    (CNT-JIKANTAI1    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-JIKANTAI1)
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
               IF    (CNT-JIKANTAI2    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-JIKANTAI2)
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
               IF    (CNT-JIKANTAI3    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-JIKANTAI3)
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
               IF    (CNT-MESAIKSN     NOT =  ZERO        )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-MESAIKSN)
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
               IF    (CNT-CHIHOKATU    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-CHIHOKATU)
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
               IF    (CNT-CHIHOKAT2    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-CHIHOKAT2)
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
               IF    (CNT-CHIHOKAT3    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-CHIHOKAT3)
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
               IF    (CNT-CHIHOKAT4    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-CHIHOKAT4)
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
               IF    (CNT-YAKRENKEI    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-YAKRENKEI)
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
               IF    (CNT-NINPU        NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-NINPU    )
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
               END-IF
             END-IF
           ELSE
             IF   RECE41-SRYYM   >=  "201004"
             AND  RECE41-SRYYM   <=  "201803"
               IF  CNT-JIKANTAI1     NOT = ZERO
                 IF   CNT-JIKANTAI2  NOT = ZERO
                   IF   CNT-JIKANTAI1  NOT =  CNT-JIKANTAI2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI3  NOT = ZERO
                   IF   CNT-JIKANTAI1  NOT =  CNT-JIKANTAI3
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-MESAIKSN   NOT = ZERO
                   IF   CNT-JIKANTAI1  NOT =  CNT-MESAIKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKATU  NOT = ZERO
                   IF   CNT-JIKANTAI1  NOT =  CNT-CHIHOKATU
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKAT2  NOT = ZERO
                   IF   CNT-JIKANTAI1  NOT =  CNT-CHIHOKAT2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN  NOT = ZERO
                   IF   CNT-JIKANTAI1  NOT =  CNT-SAITOKKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN2 NOT = ZERO
                   IF   CNT-JIKANTAI1  NOT =  CNT-SAITOKKSN2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
               END-IF
               IF  CNT-JIKANTAI2     NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT = ZERO
                   IF   CNT-JIKANTAI2  NOT =  CNT-JIKANTAI1
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI3  NOT = ZERO
                   IF   CNT-JIKANTAI2  NOT =  CNT-JIKANTAI3
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-MESAIKSN   NOT = ZERO
                   IF   CNT-JIKANTAI2  NOT =  CNT-MESAIKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKATU  NOT = ZERO
                   IF   CNT-JIKANTAI2  NOT =  CNT-CHIHOKATU
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKAT2  NOT = ZERO
                   IF   CNT-JIKANTAI2  NOT =  CNT-CHIHOKAT2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN  NOT = ZERO
                   IF   CNT-JIKANTAI2  NOT =  CNT-SAITOKKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN2 NOT = ZERO
                   IF   CNT-JIKANTAI2  NOT =  CNT-SAITOKKSN2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
               END-IF
               IF  CNT-JIKANTAI3     NOT = ZERO
                 IF   CNT-JIKANTAI2  NOT = ZERO
                   IF   CNT-JIKANTAI3  NOT =  CNT-JIKANTAI2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI3  NOT = ZERO
                   IF   CNT-JIKANTAI3  NOT =  CNT-JIKANTAI3
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-MESAIKSN   NOT = ZERO
                   IF   CNT-JIKANTAI3  NOT =  CNT-MESAIKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKATU  NOT = ZERO
                   IF   CNT-JIKANTAI3  NOT =  CNT-CHIHOKATU
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKAT2  NOT = ZERO
                   IF   CNT-JIKANTAI3  NOT =  CNT-CHIHOKAT2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN  NOT = ZERO
                   IF   CNT-JIKANTAI3  NOT =  CNT-SAITOKKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN2 NOT = ZERO
                   IF   CNT-JIKANTAI3  NOT =  CNT-SAITOKKSN2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
               END-IF
               IF  CNT-MESAIKSN      NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT = ZERO
                   IF   CNT-MESAIKSN   NOT =  CNT-JIKANTAI1
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI2  NOT = ZERO
                   IF   CNT-MESAIKSN   NOT =  CNT-JIKANTAI2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI3  NOT = ZERO
                   IF   CNT-MESAIKSN   NOT =  CNT-JIKANTAI3
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKATU  NOT = ZERO
                   IF   CNT-MESAIKSN   NOT =  CNT-CHIHOKATU
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKAT2  NOT = ZERO
                   IF   CNT-MESAIKSN   NOT =  CNT-CHIHOKAT2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN  NOT = ZERO
                   IF   CNT-MESAIKSN   NOT =  CNT-SAITOKKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN2 NOT = ZERO
                   IF   CNT-MESAIKSN   NOT =  CNT-SAITOKKSN2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
               END-IF
               IF  CNT-CHIHOKATU     NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT = ZERO
                   IF   CNT-CHIHOKATU  NOT =  CNT-JIKANTAI1
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI2  NOT = ZERO
                   IF   CNT-CHIHOKATU  NOT =  CNT-JIKANTAI2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI3  NOT = ZERO
                   IF   CNT-CHIHOKATU  NOT =  CNT-JIKANTAI3
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-MESAIKSN   NOT = ZERO
                   IF   CNT-CHIHOKATU  NOT =  CNT-MESAIKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKAT2  NOT = ZERO
                   IF   CNT-CHIHOKATU  NOT =  CNT-CHIHOKAT2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN  NOT = ZERO
                   IF   CNT-CHIHOKATU  NOT =  CNT-SAITOKKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN2 NOT = ZERO
                   IF   CNT-CHIHOKATU  NOT =  CNT-SAITOKKSN2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
               END-IF
               IF  CNT-CHIHOKAT2     NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT = ZERO
                   IF   CNT-CHIHOKAT2  NOT =  CNT-JIKANTAI1
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI2  NOT = ZERO
                   IF   CNT-CHIHOKAT2  NOT =  CNT-JIKANTAI2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI3  NOT = ZERO
                   IF   CNT-CHIHOKAT2  NOT =  CNT-JIKANTAI3
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-MESAIKSN   NOT = ZERO
                   IF   CNT-CHIHOKAT2  NOT =  CNT-MESAIKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKATU  NOT = ZERO
                   IF   CNT-CHIHOKAT2  NOT =  CNT-CHIHOKATU
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN  NOT = ZERO
                   IF   CNT-CHIHOKAT2  NOT =  CNT-SAITOKKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN2 NOT = ZERO
                   IF   CNT-CHIHOKAT2  NOT =  CNT-SAITOKKSN2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
               END-IF
               IF  CNT-SAITOKKSN     NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT = ZERO
                   IF   CNT-SAITOKKSN  NOT =  CNT-JIKANTAI1
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI2  NOT = ZERO
                   IF   CNT-SAITOKKSN  NOT =  CNT-JIKANTAI2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI3  NOT = ZERO
                   IF   CNT-SAITOKKSN  NOT =  CNT-JIKANTAI3
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-MESAIKSN   NOT = ZERO
                   IF   CNT-SAITOKKSN  NOT =  CNT-MESAIKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKATU  NOT = ZERO
                   IF   CNT-SAITOKKSN  NOT =  CNT-CHIHOKATU
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKAT2  NOT = ZERO
                   IF   CNT-SAITOKKSN  NOT =  CNT-CHIHOKAT2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN2 NOT = ZERO
                   IF   CNT-SAITOKKSN  NOT =  CNT-SAITOKKSN2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
               END-IF
               IF  CNT-SAITOKKSN2    NOT = ZERO
                 IF   CNT-JIKANTAI1  NOT = ZERO
                   IF   CNT-SAITOKKSN2 NOT =  CNT-JIKANTAI1
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI2  NOT = ZERO
                   IF   CNT-SAITOKKSN2 NOT =  CNT-JIKANTAI2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-JIKANTAI3  NOT = ZERO
                   IF   CNT-SAITOKKSN2 NOT =  CNT-JIKANTAI3
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-MESAIKSN   NOT = ZERO
                   IF   CNT-SAITOKKSN2 NOT =  CNT-MESAIKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKATU  NOT = ZERO
                   IF   CNT-SAITOKKSN2 NOT =  CNT-CHIHOKATU
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-CHIHOKAT2  NOT = ZERO
                   IF   CNT-SAITOKKSN2 NOT =  CNT-CHIHOKAT2
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
                 IF   CNT-SAITOKKSN  NOT = ZERO
                   IF   CNT-SAITOKKSN2 NOT =  CNT-SAITOKKSN
                     MOVE   ZERO         TO   RECE41-KHNTEN(2)
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF    (CNT-SAISIN-GAI-ETC      NOT =  ZERO)
           AND   (CNT-SAISIN-GAI-DOUJITU  NOT =  ZERO)
                   MOVE   ZERO         TO   RECE41-KHNTEN(3)
           END-IF
           IF    (CNT-NINPU2           NOT =  ZERO      )
           AND   (CNT-SAISIN-GAI-ETC   NOT =  CNT-NINPU2)
                   MOVE   ZERO         TO   RECE41-KHNTEN(3)
           END-IF
      *
           .
       2106-KHNTEN-KO-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    包括点数の治験減点分編集
      *****************************************************************
       2107-GENTEN-HENSYU-SEC      SECTION.
      *
           IF   RECE41-TENSU(2)  >=  WRK-RECE4G-TENSU(2)
             COMPUTE  RECE41-TENSU(2)  =
                      RECE41-TENSU(2)  -  WRK-RECE4G-TENSU(2)
           ELSE
             MOVE     ZERO    TO   RECE41-TENSU(2)
           END-IF
           IF   RECE41-TENSU(3)  >=  WRK-RECE4G-TENSU(3)
             COMPUTE  RECE41-TENSU(3)  =
                      RECE41-TENSU(3)  -  WRK-RECE4G-TENSU(3)
           ELSE
             MOVE     ZERO    TO   RECE41-TENSU(3)
           END-IF
           IF   RECE41-TENSU(5)  >=  WRK-RECE4G-TENSU(5)
             COMPUTE  RECE41-TENSU(5)  =
                      RECE41-TENSU(5)  -  WRK-RECE4G-TENSU(5)
           ELSE
             MOVE     ZERO    TO   RECE41-TENSU(5)
           END-IF
           IF   RECE41-TENSU(6)  >=  WRK-RECE4G-TENSU(6)
             COMPUTE  RECE41-TENSU(6)  =
                      RECE41-TENSU(6)  -  WRK-RECE4G-TENSU(6)
           ELSE
             MOVE     ZERO    TO   RECE41-TENSU(6)
           END-IF
           IF   RECE41-TENSU(7)  >=  WRK-RECE4G-TENSU(7)
             COMPUTE  RECE41-TENSU(7)  =
                      RECE41-TENSU(7)  -  WRK-RECE4G-TENSU(7)
           ELSE
             MOVE     ZERO    TO   RECE41-TENSU(7)
           END-IF
           IF   RECE41-TENSU(8)  >=  WRK-RECE4G-TENSU(8)
             COMPUTE  RECE41-TENSU(8)  =
                      RECE41-TENSU(8)  -  WRK-RECE4G-TENSU(8)
           ELSE
             MOVE     ZERO    TO   RECE41-TENSU(8)
           END-IF
           IF   RECE41-TENSU(9)  >=  WRK-RECE4G-TENSU(9)
             COMPUTE  RECE41-TENSU(9)  =
                      RECE41-TENSU(9)  -  WRK-RECE4G-TENSU(9)
           ELSE
             MOVE     ZERO    TO   RECE41-TENSU(9)
           END-IF
           IF   RECE41-TENSU(12) >=  WRK-RECE4G-TENSU(12)
             COMPUTE  RECE41-TENSU(12) =
                      RECE41-TENSU(12) -  WRK-RECE4G-TENSU(12)
           ELSE
             MOVE     ZERO    TO   RECE41-TENSU(12)
           END-IF
           IF   RECE41-TENSU(14) >=  WRK-RECE4G-TENSU(14)
             COMPUTE  RECE41-TENSU(14) =
                      RECE41-TENSU(14) -  WRK-RECE4G-TENSU(14)
           ELSE
             MOVE     ZERO    TO   RECE41-TENSU(14)
           END-IF
      *
      *    合計点数の編集
           IF   RECE41-HKNKBN     NOT  =   "4" AND "6"
              COMPUTE  RECE41-TOTALTEN  =  RECE41-TOTALTEN
                                        -  WRK-RECE4G-TENSU(2)
                                        -  WRK-RECE4G-TENSU(3)
                                        -  WRK-RECE4G-TENSU(5)
                                        -  WRK-RECE4G-TENSU(6)
                                        -  WRK-RECE4G-TENSU(7)
                                        -  WRK-RECE4G-TENSU(8)
                                        -  WRK-RECE4G-TENSU(9)
                                        -  WRK-RECE4G-TENSU(12)
                                        -  WRK-RECE4G-TENSU(14)
           END-IF
      *
           .
       2107-GENTEN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    在宅回数の再編集
      *****************************************************************
       2108-ZAITAKU-KAISU-HENSYU-SEC               SECTION.
      *
           IF    RECE41-SRYYM   >=  "201404"
             EVALUATE   RECE41-HKNKBN
               WHEN      "1"
               WHEN      "2"
      *          患家診療時間加算（往診）に関する回数の再編集
                 PERFORM  VARYING  IDX19  FROM  1  BY  1
                           UNTIL   IDX19   >    9
                   PERFORM  VARYING  IDX20  FROM  1  BY  1
                             UNTIL   IDX20   >   31
                     IF  TBL-ZAITAKU-KAISU(1 IDX19 IDX20) NOT = ZERO
                     AND TBL-ZAITAKU-KAISU(2 IDX19 IDX20) NOT = ZERO
                       COMPUTE  RECE41-KAISU(8) =
                                RECE41-KAISU(8) -
                                TBL-ZAITAKU-KAISU(2 IDX19 IDX20)
                     END-IF
                   END-PERFORM
                 END-PERFORM
      *          患家診療時間加算（特別往診）に関する回数の再編集
                 PERFORM  VARYING  IDX19  FROM  1  BY  1
                           UNTIL   IDX19   >    9
                   PERFORM  VARYING  IDX20  FROM  1  BY  1
                             UNTIL   IDX20   >   31
                     IF  TBL-ZAITAKU-KAISU(3 IDX19 IDX20) NOT = ZERO
                     AND TBL-ZAITAKU-KAISU(4 IDX19 IDX20) NOT = ZERO
                       COMPUTE  RECE41-KAISU(8) =
                                RECE41-KAISU(8) -
                                TBL-ZAITAKU-KAISU(4 IDX19 IDX20)
                     END-IF
                   END-PERFORM
                 END-PERFORM
      *          患家診療時間加算（在宅患者訪問診療料）に関する回数の再編集
                 PERFORM  VARYING  IDX19  FROM  1  BY  1
                           UNTIL   IDX19   >    9
                   PERFORM  VARYING  IDX20  FROM  1  BY  1
                             UNTIL   IDX20   >   31
                     IF  TBL-ZAITAKU-KAISU(5 IDX19 IDX20) NOT = ZERO
                     AND TBL-ZAITAKU-KAISU(6 IDX19 IDX20) NOT = ZERO
                       COMPUTE  RECE41-KAISU(11) =
                                RECE41-KAISU(11) -
                                TBL-ZAITAKU-KAISU(6 IDX19 IDX20)
                     END-IF
                   END-PERFORM
                 END-PERFORM
               WHEN      "5"
      *          患家診療時間加算（往診）に関する回数の再編集
                 PERFORM  VARYING  IDX19  FROM  1  BY  1
                           UNTIL   IDX19   >    9
                   PERFORM  VARYING  IDX20  FROM  1  BY  1
                             UNTIL   IDX20   >   31
                     IF  TBL-ZAITAKU-KAISU(1 IDX19 IDX20) NOT = ZERO
                     AND TBL-ZAITAKU-KAISU(2 IDX19 IDX20) NOT = ZERO
                       COMPUTE  RECE41-KAISU(10) =
                                RECE41-KAISU(10) -
                                TBL-ZAITAKU-KAISU(2 IDX19 IDX20)
                     END-IF
                   END-PERFORM
                 END-PERFORM
      *          患家診療時間加算（特別往診）に関する回数の再編集
                 PERFORM  VARYING  IDX19  FROM  1  BY  1
                           UNTIL   IDX19   >    9
                   PERFORM  VARYING  IDX20  FROM  1  BY  1
                             UNTIL   IDX20   >   31
                     IF  TBL-ZAITAKU-KAISU(3 IDX19 IDX20) NOT = ZERO
                     AND TBL-ZAITAKU-KAISU(4 IDX19 IDX20) NOT = ZERO
                       COMPUTE  RECE41-KAISU(10) =
                                RECE41-KAISU(10) -
                                TBL-ZAITAKU-KAISU(4 IDX19 IDX20)
                     END-IF
                   END-PERFORM
                 END-PERFORM
      *          患家診療時間加算（在宅患者訪問診療料）に関する回数の再編集
                 PERFORM  VARYING  IDX19  FROM  1  BY  1
                           UNTIL   IDX19   >    9
                   PERFORM  VARYING  IDX20  FROM  1  BY  1
                             UNTIL   IDX20   >   31
                     IF  TBL-ZAITAKU-KAISU(5 IDX19 IDX20) NOT = ZERO
                     AND TBL-ZAITAKU-KAISU(6 IDX19 IDX20) NOT = ZERO
                       COMPUTE  RECE41-KAISU(13) =
                                RECE41-KAISU(13) -
                                TBL-ZAITAKU-KAISU(6 IDX19 IDX20)
                     END-IF
                   END-PERFORM
                 END-PERFORM
             END-EVALUATE
           END-IF
      *
           .
       2108-ZAITAKU-KAISU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    自賠責・請求金額欄端数処理区分編集
      *****************************************************************
       2109-JIBAI-HASUKBN-HENSYU-SEC               SECTION.
      *
           EVALUATE   RECE41-HKNKBN
             WHEN       "4"
               EVALUATE   SYS-200501-JIBAI-FRACTION-KBN(1)
                 WHEN      "1"
                   IF   WRK-HASU1001-JIBAI   NOT = "4"
                     MOVE  WRK-HASU1001-JIBAI   TO  RECE41-JIBAI-HASUKBN
                   END-IF
                 WHEN      "2"
                   IF   RECE41-SEIKYUKBN         = "1"
                   AND  WRK-HASU1001-JIBAI   NOT = "4"
                     MOVE  WRK-HASU1001-JIBAI   TO  RECE41-JIBAI-HASUKBN
                   END-IF
               END-EVALUATE
             WHEN       "6"
               EVALUATE   SYS-200501-JIBAI-FRACTION-KBN(2)
                 WHEN      "1"
                   IF   WRK-HASU1001-DAISAN  NOT = "4"
                     MOVE  WRK-HASU1001-DAISAN  TO  RECE41-JIBAI-HASUKBN
                   END-IF
                 WHEN      "2"
                   IF   RECE41-SEIKYUKBN         = "1"
                   AND  WRK-HASU1001-DAISAN  NOT = "4"
                     MOVE  WRK-HASU1001-DAISAN  TO  RECE41-JIBAI-HASUKBN
                   END-IF
               END-EVALUATE
           END-EVALUATE
      *
           .
       2109-JIBAI-HASUKBN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    終了処理
      *****************************************************************
       300-TERM-SEC                SECTION.
      *
           CLOSE   RECE41-FILE
                   RECE44-FILE
                   RECE45-FILE
                   RECE4A-FILE
                   RECE4B-FILE
                   RECE44C-FILE
                   RECE45C-FILE
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *    ステップ管理終了処理
               MOVE    "STE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
      *
               PERFORM 900-DBDISCONNECT-SEC
           END-IF
      *
           DISPLAY "RECE41-IN  :" CNT-IN   
           DISPLAY "RECE41-MOD :" CNT-OUT3  
           DISPLAY "RECE44-OUT :" CNT-OUT1 
           DISPLAY "RECE45-OUT :" CNT-OUT2  
           DISPLAY "RECE4A-OUT :" CNT-OUT4 
           DISPLAY "RECE4B-OUT :" CNT-OUT5  
           DISPLAY "RECE44C-OUT :" CNT-OUT6 
           DISPLAY "RECE45C-OUT :" CNT-OUT7  
           DISPLAY "*** ORCR0420 END ***"
      * 
           .
       300-TERM-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラー出力処理
      *****************************************************************
       500-ERR-HENSYU-SEC                SECTION.
      *
           OPEN    INPUT   RECEERR-FILE
           IF      STS-RECEERR         =   ZERO
               CLOSE   RECEERR-FILE
           ELSE
               OPEN    OUTPUT              RECEERR-FILE
      *
               MOVE    WRK-RECEERR         TO  RECEERR-REC
               WRITE   RECEERR-REC
               CLOSE   RECEERR-FILE
      *
               IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *            ジョブ管理開始処理
                   MOVE    "JBE"           TO  SJOBKANRI-MODE
                   INITIALIZE                  JOBKANRI-REC
                   MOVE    WRK-RECEERR     TO  JOB-YOBI
                   MOVE    "9999"          TO  JOB-ERRCD
grpsys             PERFORM 900-CALL-ORCSJOB-SEC
               END-IF
           END-IF
      *                             
           MOVE    1                   TO  FLG-END
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラー時終了処理
      *****************************************************************
       500-COBABORT-SEC                SECTION.
      *
           CALL    "cobabort"          USING   WRK-ERRMSG
      *
           .
       500-COBABORT-EXT.
           EXIT.
      *
      *****************************************************************
      *    処理中止処理
      *****************************************************************
       500-CANCEL-HENSYU-SEC                SECTION.
      *
           IF      WRK-PARA-SHELLID    =   "RECEPTX"
               CONTINUE
           ELSE
               MOVE    "CHK"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
               IF    ( SJOBKANRI-RETURN
                                       =   ZERO )
               AND   ( JOB-STOPFLG     =   1    )
                   MOVE    "処理が中止されました"
                                           TO  WRK-RECEERR
      *
                   OPEN    INPUT   RECEERR-FILE
                   IF      STS-RECEERR         =   ZERO
                       CLOSE   RECEERR-FILE
                   ELSE
                       OPEN    OUTPUT              RECEERR-FILE
      *    
                       MOVE    WRK-RECEERR         TO  RECEERR-REC
                       WRITE   RECEERR-REC
                       CLOSE   RECEERR-FILE
      *         
      *                ジョブ管理終了処理
                       MOVE    "CAN"           TO  SJOBKANRI-MODE
                       INITIALIZE                  JOBKANRI-REC
                       MOVE    WRK-RECEERR     TO  JOB-YOBI
                       MOVE    "8888"          TO  JOB-ERRCD
                       MOVE    2               TO  JOB-STOPFLG
grpsys                 PERFORM 900-CALL-ORCSJOB-SEC
                   END-IF
      *                             
                   MOVE    1                   TO  FLG-END
               END-IF
           END-IF
           .
       500-CANCEL-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    管理マスタ読み込み
      *****************************************************************
       800-SYSKANRI-READ-SEC           SECTION.
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-SYSKANRI
               ELSE
                   MOVE    1                   TO  FLG-SYSKANRI
               END-IF
           ELSE
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       800-SYSKANRI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    管理マスタ読み込み
      *****************************************************************
       810-SYSKANRI-READ-SEC         SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       810-SYSKANRI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計読込
      *****************************************************************
       800-SRYACCT-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SRYACCT-REC
               MOVE    ZERO                TO  FLG-SRYACCT
           ELSE
               INITIALIZE                      SRYACCT-REC
               MOVE    1                   TO  FLG-SRYACCT
           END-IF
      *
           .
       800-SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療行為読込
      *****************************************************************
       800-SRYACT-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SRYACT-REC
               MOVE    ZERO                TO  FLG-SRYACT
           ELSE
               INITIALIZE                      SRYACT-REC
               MOVE    1                   TO  FLG-SRYACT
           END-IF
      *
           .
       800-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計付加情報読込
      *****************************************************************
       800-SRYACCTPLUS-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SRYACCTPLUS-REC
               MOVE    ZERO                TO  FLG-SRYACCTPLUS
           ELSE
               INITIALIZE                      SRYACCTPLUS-REC
               MOVE    1                   TO  FLG-SRYACCTPLUS
           END-IF
      *
           .
       800-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数テーブルの検索
      *****************************************************************
       800-TENSU-TBL-SEC               SECTION.
      *
           INITIALIZE                           TNS-TENSU-REC
grpsys     MOVE    SRY-HOSPNUM          TO      TNS-HOSPNUM
           MOVE    SRY-SRYCD(IDX2)      TO      TNS-SRYCD
           MOVE    SRY-SRYYM            TO      WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY         TO      WK-TAIHI-SRYD
           MOVE    WK-TAIHI-SRYYMD      TO      TNS-YUKOSTYMD
                                                TNS-YUKOEDYMD
           MOVE    TNS-TENSU-REC        TO      MCPDATA-REC
           MOVE    "tbl_tensu"          TO      MCP-TABLE
           MOVE    "key"                TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_tensu"      TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE   MCPDATA-REC   TO  TNS-TENSU-REC
                   MOVE   ZERO          TO  FLG-TENSU
               ELSE
                   INITIALIZE               TNS-TENSU-REC
                   MOVE    1            TO  FLG-TENSU
               END-IF
           ELSE
               INITIALIZE                   TNS-TENSU-REC
               MOVE    1                TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"          TO  MCP-TABLE
           MOVE    "key"                TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       800-TENSU-TBL-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者コメントマスタ読み込み
      *****************************************************************
       800-PTCOM-READ-SEC           SECTION.
      *
           MOVE    PTCOM-REC           TO  MCPDATA-REC
      *
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptcom"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC     TO  PTCOM-REC
                   MOVE    ZERO            TO  FLG-PTCOM
               ELSE
                   MOVE    1               TO  FLG-PTCOM
                   INITIALIZE                  PTCOM-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTCOM
               INITIALIZE                      PTCOM-REC
           END-IF
      *
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           IF      FLG-PTCOM           =   ZERO
               IF      PTCOM-INPUTCOMENT   NOT =   SPACE
                   MOVE    ZERO            TO  WRK-COL
                                               IDZ1
                                               IDZ2 
                   INSPECT PTCOM-INPUTCOMENT   TALLYING    WRK-COL
                                               FOR ALL WRK-CONS-RETURN
                   IF      WRK-COL         >   ZERO
                       DISPLAY "PTCOM=" PTCOM-KEY
                       PERFORM VARYING IDZ1    FROM    1   BY  1
                               UNTIL   IDZ1    >       80
                           IF      PTCOM-INPUTCOMENT(IDZ1:1)
                                               =   WRK-CONS-RETURN
                               COMPUTE IDZ2    =   IDZ1    -   1
                               MOVE    80      TO  IDZ1
                           END-IF
                       END-PERFORM
      *
                       CALL    "coblog" USING   "ptcom returncd err"
                       MOVE    SPACE               TO  WRK-RECEERR
                       MOVE    SPACE               TO  WRK-ERRMSG
                       STRING
                        "コメント文字コード不正　患者番号="
                                                   DELIMITED  BY  SIZE
                               RECE41-PTNUM        DELIMITED  BY  SPACE
                               "　診療区分="       DELIMITED  BY  SIZE
                               SRY-SRYKBN          DELIMITED  BY  SPACE
                                                   INTO    WRK-ERRMSG
                       END-STRING
                       IF      IDZ2        >   1    
                           STRING   WRK-ERRMSG     DELIMITED  BY  SPACE
                                   "　コメント="   DELIMITED  BY  SIZE
                                   PTCOM-INPUTCOMENT(1:IDZ2)
                                                   DELIMITED  BY  SPACE
                                                   INTO    WRK-RECEERR
                           END-STRING
                       ELSE
                           STRING   WRK-ERRMSG     DELIMITED  BY  SPACE
                                    "　コメント="  DELIMITED  BY  SIZE
                                    PTCOM-SRYCD    DELIMITED  BY  SPACE
                                                   INTO    WRK-RECEERR
                           END-STRING
                       END-IF
                       PERFORM 500-ERR-HENSYU-SEC
      *
                       MOVE    SPACE               TO  WRK-ERRMSG
                       STRING  "ORCR0420 "         DELIMITED  BY  SIZE
                               WRK-RECEERR         DELIMITED  BY  SIZE
                               LOW-VALUE           DELIMITED  BY  SIZE
                                                   INTO    WRK-ERRMSG
                       END-STRING
                       PERFORM 500-COBABORT-SEC
                   END-IF
               END-IF
           END-IF
      *
           .
       800-PTCOM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    収納読込
      *****************************************************************
       800-SYUNOU-READ-SEC           SECTION.
      *
           PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYUNOU-REC
               MOVE    ZERO            TO  FLG-SYUNOU
           ELSE
               INITIALIZE                  SYUNOU-REC
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           .
       800-SYUNOU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    中間ファイルＲＥＡＤ処理
      *****************************************************************
       900-RECE41-READ-SEC            SECTION.
      *
           READ    RECE41-FILE   NEXT
               AT  END
                   MOVE    1     TO    FLG-END
               NOT  AT  END
                   ADD     1     TO    CNT-IN
                   ADD     1     TO    CNT-IN-COMMIT
                                       CNT-IN-CANCEL
      *
                   DISPLAY "RECE41  PTNUM=" RECE41-PTNUM
      *
                   MOVE  RECE41-SRYYM   TO  WRK-SYS-SRYYMD(1:6)
                   MOVE  "01"           TO  WRK-SYS-SRYYMD(7:2)
                   PERFORM 910-SYSKANRI-HENSYU-SEC
      *
           END-READ
           .
       900-RECE41-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *    診療年月の対象となるシス管理を取得（個別処理のみ
      ****************************************************************
       910-SYSKANRI-HENSYU-SEC         SECTION.
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
             CONTINUE
           ELSE
      *      医療機関ＩＤ編集
             MOVE  ZERO           TO  FLG-SET
             PERFORM  VARYING  SYSKAN-IDX  FROM  1  BY  1
                   UNTIL  ( SYSKAN-IDX              >  100  )
                    OR    ( TBL-SYS1001(SYSKAN-IDX) = SPACE )
                    OR    ( FLG-SET                 =   1   )
      *
                MOVE  TBL-SYS1001(SYSKAN-IDX)  TO  SYS-1001-REC
                IF   ( SYS-1001-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                AND  ( WRK-SYS-SRYYMD     <=  SYS-1001-EDYUKYMD )
                   MOVE     1       TO    FLG-SET
                   MOVE    SYS-1001-TAX-HASU-KBN
                                    TO    WRK-TAX1001-KBN
                   IF   WRK-TAX1001-KBN = SPACE
                      MOVE   "2"    TO    WRK-TAX1001-KBN
                   END-IF
                   MOVE    SYS-1001-DAISANKBN
                                    TO    WRK-DAISAN-DAISANKBN
                   IF  WRK-DAISAN-DAISANKBN = SPACE
                     MOVE  "2"      TO    WRK-DAISAN-DAISANKBN
                   END-IF
                   MOVE    SYS-1001-DISCOUNT-HASU-KBN4
                                    TO    WRK-HASU1001-JIBAI
                   IF  WRK-HASU1001-JIBAI = SPACE
                     MOVE  "4"      TO    WRK-HASU1001-JIBAI
                   END-IF
                   MOVE    SYS-1001-DISCOUNT-HASU-KBN6
                                    TO    WRK-HASU1001-DAISAN
                   IF  WRK-HASU1001-DAISAN = SPACE
                     MOVE  WRK-HASU1001-JIBAI
                                    TO    WRK-HASU1001-DAISAN
                   END-IF
                END-IF
      *
             END-PERFORM
             IF     FLG-SET  =  ZERO
      *
               STRING "医療機関情報が取得できませんでした。診療年月＝"
                                          DELIMITED  BY  SIZE 
                       RECE41-SRYYM       DELIMITED  BY  SIZE
                                      INTO    WRK-RECEERR
               END-STRING
      *
               PERFORM 500-ERR-HENSYU-SEC
               MOVE    1               TO  FLG-END
               GO  TO  910-SYSKANRI-HENSYU-EXT
             END-IF
      *
      *      施設基準情報
             MOVE    ZERO                TO  FLG-SET
      *
             PERFORM  VARYING  SYSKAN-IDX2  FROM  1   BY  1
                       UNTIL ( SYSKAN-IDX2               >  100  )
                        OR   ( TBL-SYS10062(SYSKAN-IDX2) = SPACE )
                        OR   ( FLG-SET                   =   1   )
                 MOVE    TBL-SYS10062(SYSKAN-IDX2)  TO  SYS-1006-REC
                 IF   ( SYS-1006-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                 AND  ( WRK-SYS-SRYYMD     <=  SYS-1006-EDYUKYMD )
                     MOVE     1                  TO  FLG-SET
                 END-IF
             END-PERFORM
             IF      FLG-SET    =   ZERO
                 MOVE  ZERO                    TO  WRK-SISETU613
                 MOVE  ZERO                    TO  WRK-SISETU695
             ELSE
                 MOVE  SYS-1006-SSTKIJUN(113)  TO  WRK-SISETU613
                 MOVE  SYS-1006-SSTKIJUN(195)  TO  WRK-SISETU695
             END-IF
      *
             MOVE    ZERO                TO  FLG-SET
      *
             PERFORM  VARYING  SYSKAN-IDX2  FROM  1   BY  1
                       UNTIL ( SYSKAN-IDX2               >  100  )
                        OR   ( TBL-SYS10067(SYSKAN-IDX2) = SPACE )
                        OR   ( FLG-SET                   =   1   )
                 MOVE    TBL-SYS10067(SYSKAN-IDX2)  TO  SYS-1006-REC
                 IF   ( SYS-1006-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                 AND  ( WRK-SYS-SRYYMD     <=  SYS-1006-EDYUKYMD )
                     MOVE     1                  TO  FLG-SET
                 END-IF
             END-PERFORM
             IF      FLG-SET    =   ZERO
                 MOVE  ZERO                    TO  WRK-SISETU3055
                 MOVE  ZERO                    TO  WRK-SISETU3056
                 MOVE  ZERO                    TO  WRK-SISETU3057
                 MOVE  ZERO                    TO  WRK-SISETU3058
                 MOVE  ZERO                    TO  WRK-SISETU3168
                 MOVE  ZERO                    TO  WRK-SISETU3169
             ELSE
                 MOVE  SYS-1006-SSTKIJUN(55)   TO  WRK-SISETU3055
                 MOVE  SYS-1006-SSTKIJUN(56)   TO  WRK-SISETU3056
                 MOVE  SYS-1006-SSTKIJUN(57)   TO  WRK-SISETU3057
                 MOVE  SYS-1006-SSTKIJUN(58)   TO  WRK-SISETU3058
                 MOVE  SYS-1006-SSTKIJUN(168)  TO  WRK-SISETU3168
                 MOVE  SYS-1006-SSTKIJUN(169)  TO  WRK-SISETU3169
             END-IF
      *
      *      帳票編集区分情報
             MOVE    ZERO                TO  FLG-SET
             MOVE    SPACE               TO  WRK-1030-KOUHATUKA
      *
      **>    IF      WRK-PARA-PRTKBN = "2" OR "3" OR "4" OR "5"
               PERFORM VARYING SYSKAN-IDX  FROM    1   BY  1
                       UNTIL ( SYSKAN-IDX              >  100  )
                       OR    ( TBL-SYS1030(SYSKAN-IDX) = SPACE )
                       OR    ( FLG-SET                 =   1   )
                 MOVE    TBL-SYS1030(SYSKAN-IDX) TO  SYS-1030-REC
                 IF    ( SYS-1030-STYUKYMD       <= WRK-SYS-SRYYMD    )
                 AND   ( WRK-SYS-SRYYMD          <= SYS-1030-EDYUKYMD )
                     MOVE     1            TO  FLG-SET
                     MOVE    SYS-1030-KOUHATUKA
                                           TO  WRK-1030-KOUHATUKA
                 END-IF
               END-PERFORM
      **>    END-IF
      *
           END-IF
      *
           .
      *
       910-SYSKANRI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスタ付加情報設定処理
      *****************************************************************
       920-SRYACCTPLUS-HENSYU-SEC     SECTION.
      *
           IF  RECE44-SRYKBN  =  "11" OR "12" OR "13" OR "14"
             CONTINUE
           ELSE
             GO  TO  920-SRYACCTPLUS-HENSYU-EXT
           END-IF
           IF  RECE44-ZAIREQFLG  =  "1"
             CONTINUE
           ELSE
             GO  TO  920-SRYACCTPLUS-HENSYU-EXT
           END-IF
      *
           INITIALIZE                      SRYACCTPLUS-REC
           MOVE    RECE44-HOSPNUM     TO   ACCTP-HOSPNUM
           MOVE    RECE44-NYUGAIKBN   TO   ACCTP-NYUGAIKBN
           MOVE    RECE44-PTID        TO   ACCTP-PTID
           MOVE    RECE44-SRYKA       TO   ACCTP-SRYKA
           MOVE    RECE44-SRYYM       TO   ACCTP-SRYYM
           MOVE    RECE44-ZAINUM      TO   ACCTP-ZAINUM
           MOVE    1                  TO   ACCTP-RENNUM
           MOVE    SRYACCTPLUS-REC    TO   MCPDATA-REC
           MOVE    "tbl_sryacctplus"  TO   MCP-TABLE
           MOVE    "key"              TO   MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
             MOVE    "tbl_sryacctplus"  TO   MCP-TABLE
             MOVE    "key"              TO   MCP-PATHNAME
             PERFORM  800-SRYACCTPLUS-READ-SEC
             IF        FLG-SRYACCTPLUS   =   ZERO
               MOVE   ACCTP-SYUGI-TBL-G
                                      TO   RECE44-ACCTP-SYUGI-TBL-G
               MOVE   ACCTP-SANSOTEN  TO   RECE44-ACCTP-SANSOTEN
               MOVE   ACCTP-CHISOTEN  TO   RECE44-ACCTP-CHISOTEN
      *
               MOVE   ACCTP-SYUGI-TBL-G
                                      TO   RECE4A-ACCTP-SYUGI-TBL-G
               MOVE   ACCTP-SANSOTEN  TO   RECE4A-ACCTP-SANSOTEN
               MOVE   ACCTP-CHISOTEN  TO   RECE4A-ACCTP-CHISOTEN
      *
               MOVE   ACCTP-SYUGI-TBL-G
                                      TO   RECE44C-ACCTP-SYUGI-TBL-G
               MOVE   ACCTP-SANSOTEN  TO   RECE44C-ACCTP-SANSOTEN
               MOVE   ACCTP-CHISOTEN  TO   RECE44C-ACCTP-CHISOTEN
             END-IF
           END-IF
      *
           MOVE    "tbl_sryacctplus"  TO   MCP-TABLE
           MOVE    "key"              TO   MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       920-SRYACCTPLUS-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ジョブ管理ＤＢ制御処理
      *****************************************************************
       900-CALL-ORCSJOB-SEC            SECTION.
      *
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
grpsys     MOVE    SPA-HOSPNUM     TO  JOB-HOSPNUM
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA 
                                   JOBKANRI-REC
                                   SPA-AREA
           .
       900-CALL-ORCSJOB-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＳＥＬＥＣＴ処理
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           IF      MCP-RC              =   ZERO
               CONTINUE
           ELSE
               DISPLAY "SELECT ERR table=" MCP-TABLE
                       " pathname="        MCP-PATHNAME
           END-IF
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＦＥＴＣＨ処理
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    クローズ処理
      *****************************************************************
       900-CLOSE-SEC                  SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブルアクセス処理
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
      *
       900-ORCDBMAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢオープン処理
      *****************************************************************
       100-DBOPEN-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBOPEN"            TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       100-DBOPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢクローズ処理
      *****************************************************************
       900-DBDISCONNECT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBDISCONNECT"      TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBDISCONNECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢ　ＣＯＭＭＩＴ処理
      *****************************************************************
       900-DBCOMMIT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBCOMMIT-EXT.
           EXIT.
      *      
      *****************************************************************
      *    ＤＢ　ＳＴＡＲＴ処理
      *****************************************************************
       900-DBSTART-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBSTART-EXT.
           EXIT.
      *
