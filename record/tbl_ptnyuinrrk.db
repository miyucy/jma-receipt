tbl_ptnyuinrrk	{
	HOSPID			char(24);
	PTID			number(10,0);
	RRKNUM			number(3,0);
	RRKEDANUM		number(3,0);
	BTUNUM			char(2);
	BTUNAME			varchar(20);
	BRMNUM			char(8);
	NYUINKA			char(2);
	HKNCOMBINUM		char(4);
	NYUINYMD		char(8);
	TAIINYMD		char(8);
	TOKUTEI_KBN	char(1);
	TOKUTEI_NYUIN	char(2);
	RM_SAGAKU		char(2);
	TEIKI_SEIKYUKBN	char(1);
	KENSAKU_DISPKBN	char(1);
	SHOKAIKBN		char(1);
	SHONUM			number(3,0);
	DRCD1			char(5);
	DRCD2			char(5);
	DRCD3			char(5);
	JTIKBN			char(1);
	SANTEI_BTUNUM		char(2);
	SANTEI_BRMNUM		char(8);
	TENNYUYMD		char(8);
	TENSTUYMD		char(8);
	TAISYONISSU		number(5,0);
	TUSANNISSU1		number(5,0);
	TUSANNISSU2		number(5,0);
	NYUINCHUKBN		char(1);
	TERMID		varchar(16);
	OPID		varchar(16);
	CREYMD		char(8);
	UPYMD		char(8);
	UPHMS		char(6);
};

primary	{
	HOSPID,PTID,RRKNUM,RRKEDANUM;
};

path	key		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE   HOSPID        =   :HOSPID 
			AND		PTID          =   :PTID
			AND		RRKNUM        =   :RRKNUM
			AND		RRKEDANUM     =   :RRKEDANUM
		;
	};
};

path	key2		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key2_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE   HOSPID      =   :HOSPID 
			AND		PTID          =   :PTID
			AND		RRKEDANUM     =   1
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC
		;
	};
};

path	key3		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key3_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key4		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key4_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		RRKNUM        =   :RRKNUM
			ORDER BY RRKEDANUM DESC
		;
	};
};

path	key5		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key5_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		RRKNUM      =   :RRKNUM
			ORDER BY RRKEDANUM ASC
		;
	};
};
path	key6		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key6_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		SHOKAIKBN   =   '1'
			ORDER BY SHONUM DESC
		;
	};
};

path	key7		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key7_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		RRKNUM      <>  :RRKNUM
			AND		NYUINYMD   <=   :TAIINYMD
			AND		TAIINYMD   >=   :NYUINYMD
		;
	};
};


path	key8		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key8_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND	PTID        =   :PTID
			ORDER BY RRKNUM,
                                 RRKEDANUM
		;
	};
};

path	key9		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key9_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			ORDER BY RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key10		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key10_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		NYUINYMD	<=	:NYUINYMD
			AND		TAIINYMD	>	:TAIINYMD
			AND		JTIKBN		<>	'5'
			AND		JTIKBN		<>	'6'
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key11		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key11_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		NYUINYMD	<=	:NYUINYMD
			AND		TAIINYMD	>=	:TAIINYMD
			AND		JTIKBN		<>	'5'
			AND		JTIKBN		<>	'6'
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key12		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key12_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		NYUINYMD	<=	:NYUINYMD
			AND		JTIKBN		<>	'5'
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key13		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key13_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		NYUINYMD	<=	:NYUINYMD
			AND		SHONUM  	=	:SHONUM
			AND		JTIKBN		<>	'5'
			ORDER BY NYUINYMD,TAIINYMD,RRKNUM,RRKEDANUM
		;
	};
};

path	key14		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key14_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID
			AND		RRKEDANUM	=	1
			AND		NYUINYMD	<=	:NYUINYMD
			AND		TAIINYMD	>	:TAIINYMD
			AND		JTIKBN		<>	'5'
			AND		JTIKBN		<>	'6'
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};


path	key15		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key15_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID
			AND		BRMNUM      =   :BRMNUM
			AND		NYUINYMD	<=	:NYUINYMD
			AND		TAIINYMD	>=	:TAIINYMD
			AND		JTIKBN		<>	'5'
			AND		JTIKBN		<>	'6'
		;
	};
};

path	key16		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key16_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID
			AND		PTID        =   :PTID
			AND		RRKEDANUM	=	1
			AND		NYUINYMD	<	:NYUINYMD
			AND		SHONUM  	=	:SHONUM
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key17		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key17_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID
			AND		PTID        =   :PTID
			AND		RRKEDANUM	=	1
			AND		NYUINYMD	<=	:NYUINYMD
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key18		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key18_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID
			AND		PTID        =   :PTID
			AND		NYUINKA	        =	:NYUINKA
			AND		TENNYUYMD	<=	:TENNYUYMD
			AND		TENSTUYMD	>=	:TENSTUYMD
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		; 
	};
};

path	key19		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key19_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID
			AND		PTID        =   :PTID
			AND		TENNYUYMD	<=	:TENNYUYMD
			AND		TENSTUYMD	>=	:TENSTUYMD
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key20		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key20_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID
			AND		PTID        =   :PTID
			AND		RRKEDANUM	=	1
			AND		NYUINYMD	>	:NYUINYMD
			AND		SHONUM  	=	:SHONUM
			ORDER BY NYUINYMD ,TAIINYMD, RRKNUM ,RRKEDANUM 
		;
	};
};

path	key21		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key21_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND	PTID        =   :PTID
			AND	NYUINYMD   <=	:NYUINYMD
                        AND     JTIKBN	   <>	'5'
	    AND	(   (NYUINYMD   <=	:NYUINYMD  AND
                     NYUINYMD   >=	:TAIINYMD      )
                OR  (TAIINYMD   >=  :TAIINYMD      ) )
            AND     HKNCOMBINUM =   :HKNCOMBINUM
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key22		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key22_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	    HOSPID      =   :HOSPID 
			AND	    PTID        =   :PTID
			AND	    NYUINYMD   <=   :NYUINYMD
			AND	    SHONUM      =   :SHONUM
                        AND         JTIKBN     <>   '5'
			ORDER BY NYUINYMD,TAIINYMD,RRKNUM,RRKEDANUM
		;
	};
};

path	key23		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key23_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	        HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		NYUINYMD   <=	:NYUINYMD
                        AND             JTIKBN	   <>	'5'
            AND	(   (NYUINYMD	<=	:NYUINYMD  AND
                     NYUINYMD	>=	:TAIINYMD      )
                 OR (TAIINYMD   >=  :TAIINYMD      ) )
            ORDER BY NYUINYMD DESC,TAIINYMD DESC,TENNYUYMD DESC,TENSTUYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key24		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key24_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID
			AND	PTID        =   :PTID
			AND	RRKEDANUM	=	1
			AND	NYUINYMD	<=	:NYUINYMD
			AND	TAIINYMD	>=	:TAIINYMD
			AND	JTIKBN		<>	'5'
			AND	JTIKBN		<>	'6'
			ORDER BY NYUINYMD ,TAIINYMD, RRKNUM
		;
	};
};

path	key25		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key25_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE   HOSPID      =   :HOSPID 
			AND	PTID          =   :PTID
			AND	RRKEDANUM     =   1
			AND	NYUINYMD	<=	:NYUINYMD
			AND	JTIKBN		<>	'5'
			ORDER BY NYUINYMD ,TAIINYMD ,RRKNUM
		;
	};
};

path	key26		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key26_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID
			AND	RRKEDANUM	=	1
			AND	NYUINYMD	<=	:NYUINYMD
			AND	TAIINYMD	>=	:TAIINYMD
			AND	JTIKBN		<>	'5'
			AND	JTIKBN		<>	'6'
			ORDER BY PTID,NYUINYMD ,TAIINYMD, RRKNUM
		;
	};
};

path	all	{
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_all_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
      		;
	};
};

path	del1	{
	DBDELETE	{
		DELETE
		FROM tbl_ptnyuinrrk
			WHERE   HOSPID        =   :HOSPID 
			AND		PTID          =   :PTID
			AND		RRKNUM        =   :RRKNUM
		;
	};
};

path	del2	{
	DBDELETE	{
		DELETE
		FROM tbl_ptnyuinrrk
			WHERE   HOSPID        =   :HOSPID 
			AND		PTID          =   :PTID
		;
	};
};

path	key27	{
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key27_csr CURSOR FOR
		SELECT A.* 
		FROM TBL_PTNYUINRRK A 
		JOIN TBL_PTINF B USING (HOSPID,PTID)
		JOIN TBL_PTNUM C USING (HOSPID,PTID) 
			WHERE A.HOSPID    = :HOSPID
			AND   A.RRKNUM    = B.RRKNUM
			AND   A.RRKEDANUM = B.RRKEDANUM
			AND   A.NYUINYMD <= :NYUINYMD
			AND   A.TAIINYMD  =  '99999999'
			AND   B.RRKNUM    <> 0 
			AND   B.RRKEDANUM <> 0
			ORDER 	BY A.BRMNUM,C.PTNUM
		;
	};
};

path	key28	{
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key28_csr CURSOR FOR
		SELECT A.* 
		FROM TBL_PTNYUINRRK A 
		JOIN TBL_PTINF B USING (HOSPID,PTID)
		JOIN TBL_PTNUM C USING (HOSPID,PTID) 
			WHERE A.HOSPID    = :HOSPID
			AND   A.RRKNUM    = B.RRKNUM
			AND   A.RRKEDANUM = B.RRKEDANUM
			AND   A.NYUINYMD <= :NYUINYMD
			AND   A.TAIINYMD  =  '99999999'
			AND   B.RRKNUM    <> 0 
			AND   B.RRKEDANUM <> 0
			ORDER 	BY A.BRMNUM,A.NYUINKA,C.PTNUM
		;
	};
};

path	key29		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key29_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		JTIKBN		<>	'5'
			AND		JTIKBN		<>	'6'
			ORDER BY NYUINYMD DESC,TAIINYMD DESC,RRKNUM DESC,RRKEDANUM DESC
		;
	};
};

path	key30		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key30_csr CURSOR FOR
		SELECT *
		FROM tbl_ptnyuinrrk
			WHERE	HOSPID      =   :HOSPID 
			AND		PTID        =   :PTID
			AND		RRKEDANUM   =   1
			AND		SHOKAIKBN   =   '1'
			AND		SHONUM      =   :SHONUM
		;
	};
};

path	key31		{ 	
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key31_csr CURSOR FOR
		SELECT * FROM TBL_PTNYUINRRK a,
		( SELECT SHONUM FROM TBL_PTNYUINRRK 
			WHERE HOSPID    = :HOSPID
			AND   PTID      = :PTID
			AND   RRKEDANUM = 1
			AND   NYUINYMD  < :NYUINYMD
			AND   SHOKAIKBN = '1'  ) b
		WHERE a.HOSPID    = :HOSPID
		AND   a.PTID      = :PTID
		AND   a.RRKEDANUM = 1
		AND   a.NYUINYMD  < :NYUINYMD
		AND   a.SHONUM    = b.SHONUM
		ORDER BY a.SHONUM,a.NYUINYMD
		;
	};
};


path	key32	{
	DBSELECT	{
		DECLARE tbl_ptnyuinrrk_key32_csr CURSOR FOR
		SELECT A.* 
		FROM TBL_PTNYUINRRK A,
			( SELECT HOSPID ,PTID,RRKNUM,MAX(RRKEDANUM) AS RRKEDANUM 
			  FROM TBL_PTNYUINRRK 
			  WHERE HOSPID    = :HOSPID
			  AND   NYUINYMD <= :NYUINYMD
			  AND   TAIINYMD >= :TAIINYMD
			  AND   JTIKBN    <> '5'
			  AND   JTIKBN    <> '6' 
			  GROUP BY HOSPID ,PTID,RRKNUM ) B,
			 TBL_PTNUM C
		WHERE A.HOSPID    = B.HOSPID
		AND   A.PTID      = B.PTID
		AND   A.RRKNUM    = B.RRKNUM
		AND   A.RRKEDANUM = B.RRKEDANUM
		AND   A.HOSPID    = C.HOSPID
		AND   A.PTID      = C.PTID
		ORDER 	BY A.BRMNUM,A.NYUINKA,C.PTNUM
		;
	};
};

