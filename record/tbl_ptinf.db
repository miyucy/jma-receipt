tbl_ptinf {
	HOSPID				char(24);
	PTID				number(10,0);
	KANANAME			varchar(100);
	NAME 				varchar(100);
	NICKNAME			varchar(100);
	SEX        			char(1);
	BIRTHDAY 			char(8);
	DEATHKBN			char(1);
	HOME_POST			varchar(7);
	HOME_ADRS			varchar(200);
	HOME_BANTI 			varchar(200);
	HOME_TEL1 			varchar(15);
	HOME_TEL2 			varchar(15);
	SETAINUSI			varchar(100);
	ZOKUGARA			varchar(60);
	JOB 		        varchar(40);
	KEITAI_TEL			varchar(15);
	FAX				varchar(15);
	EMAIL				varchar(50);
	DISCOUNT			char(2);
	DISCOUNT_RATE			char(2);
	CONDITION_1			char(2);
	CONDITION_2			char(2);
	CONDITION_3			char(2);
	COMMENT_1			varchar(200);
	COMMENT_2			varchar(200);
	TABOO_1				varchar(200);
	TABOO_2				varchar(200);
	ALLERGY_1			varchar(200);
	ALLERGY_2			varchar(200);
	KANSENSYO_1			varchar(200);
	KANSENSYO_2			varchar(200);
	RENRAKU_NAME			varchar(100);
	RENRAKU_ZOKUGARA		varchar(60);
	RENRAKU_POST 			varchar(7);
	RENRAKU_ADRS			varchar(200);
	RENRAKU_BANTI			varchar(200);
	RENRAKU_TEL1			varchar(15);
	RENRAKU_TEL2			varchar(15);
	OFFICE_NAME 			varchar(100);
	OFFICE_POST			varchar(7);
	OFFICE_ADRS 			varchar(200);
	OFFICE_BANTI			varchar(200);
	OFFICE_TEL 			varchar(15);
	KISEI_NAME 			varchar(100);
	KISEI_POST 			varchar(7);
	KISEI_ADRS 			varchar(200);
	KISEI_BANTI			varchar(200);
	KISEI_TEL  			varchar(15);
	TSTPTNUMKBN			char(1);
	NYUKIN_HOHO			char(2);
	MAXZAINUM   			number(8,0);
	RRKNUM					number(3,0);
	RRKEDANUM				number(3,0);
	TERMID   			varchar(16);
	OPID     			varchar(16);
	CREYMD   			char(8);
	UPYMD    			char(8);
	UPHMS				char(6);
#-----> virtual¹àÌÜ
	ST_SRYYMD			char(8),virtual;
	ED_SRYYMD			char(8),virtual;
	NYUGAIKBN			char(1),virtual;
	HKNKBN				char(1),virtual;
	SRYYMD				char(8),virtual;
	SRYYM				char(6),virtual;
};

primary	{
	HOSPID,PTID;
};

path	key		{ 	
	DBSELECT	{
		DECLARE tbl_ptinf_key_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
			WHERE   HOSPID      =   :HOSPID  AND
					PTID  		=   :PTID
		;
	};
};

path	key2	{
	DBSELECT	{
		DECLARE tbl_ptinf_key2_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
			WHERE  (HOSPID    = :HOSPID) AND
					NAME   LIKE :NAME
			ORDER BY NAME
		;
	};
};
path	key3	{
	DBSELECT	{
		DECLARE tbl_ptinf_key3_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
			WHERE  (HOSPID    = :HOSPID) AND
			(KANANAME  LIKE :KANANAME)
			ORDER BY   KANANAME
		;
	};
};
path	key4	{
	DBSELECT	{
		DECLARE tbl_ptinf_key4_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
			WHERE   HOSPID    =   :HOSPID
		;
	};
};
path	key5	{
	DBSELECT	{
		DECLARE tbl_ptinf_key5_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
			WHERE ( HOSPID    =   :HOSPID )  AND
			((NAME   LIKE :NAME  ) OR
			(KANANAME  LIKE :KANANAME))
			ORDER BY   KANANAME
		;
	};
};
path	all	{
	DBSELECT	{
		DECLARE tbl_ptinf_all_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
 		;
	};
};
path	key6	{
	DBSELECT	{
		DECLARE tbl_ptinf_key6_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
			WHERE ( HOSPID    =   :HOSPID )  AND
                              ( SEX       =   :SEX    )  AND
                              ( BIRTHDAY  LIKE  :BIRTHDAY )  AND
			((NAME   LIKE :NAME  ) OR
			(KANANAME  LIKE :KANANAME))
			ORDER BY   BIRTHDAY,
                                   KANANAME
		;
	};
};
path	key7	{
	DBSELECT	{
		DECLARE tbl_ptinf_key7_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
			WHERE ( HOSPID    =   :HOSPID )  AND
                              ( SEX       =   :SEX    )  AND
                              ( BIRTHDAY  LIKE  :BIRTHDAY )
			ORDER BY   BIRTHDAY,
                                   KANANAME
		;
	};
};
path	key8	{
	DBSELECT	{
		DECLARE tbl_ptinf_key8_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
			WHERE ( HOSPID    =   :HOSPID )  AND
                              ( SEX       =   :SEX    )
			ORDER BY  KANANAME
		;
	};
};
path	key9	{
	DBSELECT	{
		DECLARE tbl_ptinf_key9_csr CURSOR FOR
		SELECT *
		FROM tbl_ptinf
			WHERE ( HOSPID    =   :HOSPID )  AND
                              ( BIRTHDAY  LIKE  :BIRTHDAY )
			ORDER BY   BIRTHDAY,
                                   KANANAME
		;
	};
};
path	key10	{
	DBSELECT	{
		DECLARE tbl_ptinf_key10_csr CURSOR FOR
		SELECT distinct a.*,b.ptnum
		FROM tbl_jyurrk c,tbl_ptinf a,tbl_ptnum b
			WHERE     c.HOSPID     =   :HOSPID
               AND    c.SRYYMD    >=  :UPYMD
               AND    c.SRYYMD    <=  :CREYMD
               AND    a.HOSPID    =   :HOSPID
               AND    a.PTID      =   c.PTID
               AND    b.HOSPID    =   :HOSPID
               AND    b.PTID      =   c.PTID
			ORDER BY  b.PTNUM
		;
	};
};
path	key11	{
	DBSELECT	{
		DECLARE tbl_ptinf_key11_csr CURSOR FOR
		SELECT a.ptid from tbl_ptinf a, 
		(SELECT distinct ptid from tbl_jyurrk 
		WHERE hospid	=	:HOSPID 
		AND (sryymd 	<=	:ED_SRYYMD 
		AND sryymd 	>=	:ST_SRYYMD) 
		AND nyugaikbn	=	:NYUGAIKBN 
		AND hknkbn	=	:HKNKBN 
		group by ptid) b 
		WHERE a.hospid	=	:HOSPID 
		AND a.ptid	=	b.ptid 
		AND a.tstptnumkbn	<>	'1'
		;
	};
};
path	key12	{
	DBSELECT	{
		DECLARE tbl_ptinf_key12_csr CURSOR FOR
		SELECT a.* from tbl_ptinf a, 
		(SELECT distinct ptid from tbl_jyurrk 
		WHERE hospid	=	:HOSPID 
		AND (sryymd 	<=	:ED_SRYYMD 
		AND sryymd 	>=	:ST_SRYYMD) 
		AND nyugaikbn	=	:NYUGAIKBN 
		AND hknkbn	=	:HKNKBN 
		group by ptid) b 
		WHERE a.hospid	=	:HOSPID 
		AND a.ptid	=	b.ptid 
		AND a.tstptnumkbn	<>	'1'
		;
	};
};
path	key13	{
	DBSELECT	{
		DECLARE tbl_ptinf_key13_csr CURSOR FOR
		SELECT a.ptid from tbl_ptinf a, 
		(SELECT distinct ptid from tbl_jyurrk 
		WHERE hospid	=	:HOSPID 
		AND sryymd	LIKE	:SRYYMD
		AND (upymd 	<=	:ED_SRYYMD 
		AND upymd 	>=	:ST_SRYYMD) 
		AND nyugaikbn	=	:NYUGAIKBN 
		AND hknkbn	=	:HKNKBN 
		group by ptid 
		UNION
		SELECT distinct ptid from tbl_receupd
		WHERE hospid	=	:HOSPID 
		AND sryym 	=	:SRYYM 
		AND nyugaikbn	=	:NYUGAIKBN 
                AND (upymd      <=      :ED_SRYYMD
                AND upymd       >=      :ST_SRYYMD)
		AND hknkbn	=	:HKNKBN 
		group by ptid) b
		WHERE a.hospid	=	:HOSPID 
		AND a.ptid	=	b.ptid 
		AND a.tstptnumkbn	<>	'1'
		;
	};
};
path	key14	{
	DBSELECT	{
		DECLARE tbl_ptinf_key14_csr CURSOR FOR
		SELECT a.* from tbl_ptinf a, 
		(SELECT distinct ptid from tbl_jyurrk 
		WHERE hospid	=	:HOSPID 
		AND sryymd	LIKE	:SRYYMD
		AND (upymd 	<=	:ED_SRYYMD 
		AND upymd 	>=	:ST_SRYYMD) 
		AND nyugaikbn	=	:NYUGAIKBN 
		AND hknkbn	=	:HKNKBN 
		group by ptid 
		UNION
		SELECT distinct ptid from tbl_receupd
		WHERE hospid	=	:HOSPID 
		AND sryym 	=	:SRYYM 
		AND nyugaikbn	=	:NYUGAIKBN 
                AND (upymd      <=      :ED_SRYYMD
                AND upymd       >=      :ST_SRYYMD)
		AND hknkbn	=	:HKNKBN 
		group by ptid) b
		WHERE a.hospid	=	:HOSPID 
		AND a.ptid	=	b.ptid 
		AND a.tstptnumkbn	<>	'1'
		;
	};
};
path	key15	{
	DBSELECT	{
		DECLARE tbl_ptinf_key15_csr CURSOR FOR
		SELECT distinct a.*,b.ptnum
		FROM tbl_ptnyuinrrk c,tbl_ptinf a,tbl_ptnum b
			WHERE     c.HOSPID     =   :HOSPID
               AND    c.TAIINYMD  >=  :UPYMD
               AND    a.HOSPID    =   :HOSPID
               AND    a.PTID      =   c.PTID
               AND    b.HOSPID    =   :HOSPID
               AND    b.PTID      =   c.PTID
			ORDER BY  b.PTNUM
		;
	};
};

path	upd1	{
	DBUPDATE	{
		UPDATE	tbl_ptinf
		SET		RRKNUM			= :RRKNUM,
				RRKEDANUM		= :RRKEDANUM,
				OPID	   		= :OPID,
				UPYMD    		= :UPYMD,
				UPHMS			= :UPHMS
		WHERE   HOSPID      =   :HOSPID
		AND		PTID  		=   :PTID
		;
	};
};

path	st_key1	{
	DBSELECT	{
		DECLARE tbl_ptinf_st_key1_csr CURSOR FOR
		SELECT A.*
		FROM TBL_PTINF A JOIN  TBL_PTNUM B USING (HOSPID,PTID)
		WHERE  A.HOSPID  = :HOSPID
		AND    A.CREYMD  = :CREYMD
		AND    A.TSTPTNUMKBN    <>      '1'
		ORDER BY  B.PTNUM
        ;
	};
};
