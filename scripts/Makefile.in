top_srcdir = @top_srcdir@
include $(top_srcdir)/Makefile.directories

INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_SCRIPT = @INSTALL_SCRIPT@
INSTALL_DATA = @INSTALL_DATA@

noinst_shell_sources = \
	sample.sh.in \

shell_sources = \
	allways/site-upgrade.sh.in \
	allways/ORCBQ01.sh.in \
	allways/master_upgrade.sh.in \
	allways/orcbsd01.sh.in \
	allways/orcbse01.sh.in \
	allways/orcbsf01.sh.in \
	allways/orcbsf02.sh.in \
	allways/orcbsf03.sh.in \
	allways/orhcml09.sh.in \
	allways/print.sh.in \
	allways/tensu.sh.in \
	daily/HCALL.sh.in \
	daily/execoprg.sh.in \
	daily/HC01.sh.in \
	daily/HCALL2.sh.in \
	monthly/recept1.sh.in \
	monthly/recept2.sh.in \
	monthly/recept3.sh.in \
	monthly/recept4.sh.in \
	monthly/recept5.sh.in \
	monthly/recept6.sh.in \
	monthly/recept7.sh.in \
	monthly/recept8.sh.in \
	monthly/recept9.sh.in \
	monthly/sokatsu.sh.in \
	monthly/teiki1.sh.in \
	monthly/teiki2.sh.in \
	claim/HL01.sh.in \
	claim/HL02.sh.in \
	claim/HL03.sh.in \
	claim/ORC_CLAIM_SERVER.sh.in

ruby_scripts = \
	daily/print-data.rb \
	daily/print_parent2.rb \
	daily/print_parent.rb

claim_scripts = \
	claim/rb/clm_rcv.rb \
	claim/rb/clm_snd.rb \
	claim/rb/decode_xml.rb \
	claim/rb/orca_jcnv.rb \
	claim/rb/orca_lib.rb \
	claim/rb/orca_lib_v100.rb \
	claim/rb/orca_make_xml.rb \
	claim/rb/orca_send.rb \
	claim/rb/orca_send_xml.rb \
	claim/rb/send_xml_main.rb \
	claim/rb/xml_jcnv.rb \
	claim/rb/xml_valid.rb \

claim_data = \
	claim/def/orca_layout_accounting.def \
	claim/def/orca_layout_decode.def \
	claim/def/orca_layout_front.def \
	claim/dtd/MML1014_euc.dtd \
	claim/link/link_decode.def \
	claim/rb/claim_empty_elem.list \
	claim/template/orca_base_accounting.xml \
	claim/template/orca_base_front.xml 

shell_scripts = $(shell_sources:.sh.in=.sh) 

noinst_shell_scripts = $(noinst_shell_sources:.sh.in=.sh)

.SUFFIXES: .sh.in .sh .rb.in .rb

.sh.in.sh: 
	sed -e 's,\@jma-receipt-env\@,$(sysconfdir)\/jma-receipt\.env,g' \
	$< > $@
	chmod +x $@

all:   $(noinst_shell_scripts) $(shell_scripts)

filecheck:
	@(for i in $(noinst_shell_sources) \
		  $(shell_sources) $(ruby_scripts) $(claim_scripts) $(claim_data) \
			;do echo "make	`basename $${i}`"; done ; \
	find . \
	-name "." -o \
	-name "CVS" -prune -o \
	-name "Makefile*" -o \
	-name ".cvsignore" -o \
	-name "*.bak" -o \
	-name "build-stamp" -o \
	-name "allways" -o \
	-name "daily" -o \
	-name "monthly" -o \
	-name "claim" -o \
	-name "def" -o \
	-name "dtd" -o \
	-name "link" -o \
	-name "rb" -o \
	-name "template" -o \
	-name "HC01.sh" -o \
	-name "HCALL.sh" -o \
	-name "HCALL2.sh" -o \
	-name "HL01.sh" -o \
	-name "HL02.sh" -o \
	-name "HL03.sh" -o \
	-name "ORCBQ01.sh" -o \
	-name "ORC_CLAIM_SERVER.sh" -o \
	-name "execoprg.sh" -o \
	-name "master_upgrade.sh"  -o \
	-name "orcbsd01.sh" -o \
	-name "orcbse01.sh" -o \
	-name "orcbsf01.sh" -o \
	-name "orcbsf02.sh" -o \
	-name "orcbsf03.sh" -o \
	-name "orhcml09.sh" -o \
	-name "print.sh" -o \
	-name "recept1.sh" -o \
	-name "recept2.sh" -o \
	-name "recept3.sh" -o \
	-name "recept4.sh" -o \
	-name "recept5.sh" -o \
	-name "recept6.sh" -o \
	-name "recept7.sh" -o \
	-name "recept8.sh" -o \
	-name "recept9.sh" -o \
	-name "sample.sh" -o \
	-name "site-upgrade.sh"  -o \
	-name "sokatsu.sh" -o \
	-name "teiki1.sh" -o \
	-name "teiki2.sh" -o \
	-name "tensu.sh" -o \
	-printf "file\t%f\n") \
	|sort +1 |uniq -u -f1

clean: 
	-rm -f $(noinst_shell_scripts)
	-rm -f $(shell_scripts)

distclean: clean
	-rm -f Makefile

install: all
	$(INSTALL) -d $(scriptsdir)
	$(INSTALL) -d $(scriptsdir)/allways
	$(INSTALL) -d $(scriptsdir)/daily
	$(INSTALL) -d $(scriptsdir)/monthly
	$(INSTALL) -d $(scriptsdir)/claim
	$(INSTALL) -d $(scriptsdir)/claim/def
	$(INSTALL) -d $(scriptsdir)/claim/dtd
	$(INSTALL) -d $(scriptsdir)/claim/rb
	$(INSTALL) -d $(scriptsdir)/claim/link
	$(INSTALL) -d $(scriptsdir)/claim/template
	for file in $(shell_scripts) $(ruby_scripts) $(claim_scripts); do \
	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
	  $(INSTALL) $$file $(scriptsdir)/$$dir; \
	done
	for file in $(claim_data); do \
	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
	  $(INSTALL_DATA) $$file $(scriptsdir)/$$dir; \
	done
