#!/bin/bash

if test -z "$JMARECEIPT_ENV" ; then
    JMARECEIPT_ENV="@jma-receipt-env@"
fi
if ! test -f "$JMARECEIPT_ENV"; then
    exit 0
fi

. $JMARECEIPT_ENV


RENNUM=0
#-------------------------------------------#
#    Ï«ºÒ¿ÇÎÅÊó½·ÀÁµá½ñºîÀ®
#        $1-${11} °õºþ£Ä£ÂÍÑ¸ÇÄê°ú¿ô
#        ${12} ¥¸¥ç¥Ö£É£Ä
#        ${13} ¥·¥§¥ë£É£Ä
#        ${14} HOSPNUM
#        ${15} ¥¨¥é¡¼¥Õ¥¡¥¤¥ëÌ¾ 
#        ${16} ÍÍ¼°¶èÊ¬
#           0:£Ï£Ã£ÒÍÍ¼°  1:³ÎÇ§ÍÍ¼°
#        ${17} ÏÈµ­ºÜ¶èÊ¬¡Ê£Ï£Ã£ÒÍÍ¼°¤Î¤ß¡Ë
#           0:ÏÈ¤Ê¤·  2:ÏÈ¤¢¤ê
#-------------------------------------------#

        LOG_FILE="/var/log/jma-receipt/${14}recept17.log"

        echo "arg5   = [" ${5}   "]" > $LOG_FILE
        echo "arg15  = [" ${15}  "]" >> $LOG_FILE
        echo "arg16  = [" ${16}  "]" >> $LOG_FILE
        echo "arg17  = [" ${17}  "]" >> $LOG_FILE

##      ¥¨¥é¡¼¥Õ¥¡¥¤¥ëºï½ü
	echo "errfile = [" ${MCP_TEMPDIR}/${15}  "]" >> $LOG_FILE
        rm  -f ${MCP_TEMPDIR}/${15}

        if [ ${16} -eq  '0' ]; then
            $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCBM043 -parameter $1,$2,$3,$RENNUM,$5,$6,$7,$8,$9,${10},${11},${12},${13},${14},${17},${15} >> $LOG_FILE 2>&1
        else
            $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCBM042 -parameter $1,$2,$3,$RENNUM,$5,$6,$7,$8,$9,${10},${11},${12},${13},${14},${15} >> $LOG_FILE 2>&1
        fi
        if  [ -e ${MCP_TEMPDIR}/${15} ]; then
            exit 
        else
            $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCBJOB -parameter JBE${12}${13},${14} >> $LOG_FILE 2>&1
        fi
	
        exit 
