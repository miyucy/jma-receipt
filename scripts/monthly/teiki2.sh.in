#!/bin/bash

if test -z "$JMARECEIPT_ENV" ; then
    JMARECEIPT_ENV="@jma-receipt-env@"
fi
if ! test -f "$JMARECEIPT_ENV"; then
    exit 0
fi

. $JMARECEIPT_ENV

#-------------------------------------------#
#    定期請求データ作成
#		$1-${10}	印刷ＤＢ用固定引数
#		${11}		0:全件印刷／1:指定印刷
#		${12}		出力順
#		${13}		システム日付
#		${14}		端末ＩＤ
#		${15}		ジョブＩＤ
#		${16}		シェルＩＤ
#		${17}		医療機関番号
#		${18}		スタッフコード
#		${19}		エラーファイル名
#		${20}		請求書出力区分（最新分／期間指定）
#		${21}		印刷区分
#		${22}		診療年月
#		${23}		期別
#		${24}		印刷確認フラグ
#		${25}		集計区分
#-------------------------------------------#
##      エラーファイル削除

ERR_FILE_BASE=$(basename ${19})
ERR_FILE_FULL=${MCP_TEMPDIR}/${ERR_FILE_BASE}

	echo $#

[ -e ${ERR_FILE_FULL} ] && rm  ${ERR_FILE_FULL} 

##   -- ORCT0020 START --  
	$DBSTUB -dir $LDDIRECTORY -bd orcabt ORCT0020 -parameter "$1,$2,$3,$4,$5,$6,$7,$8,$9,${10},${11},${12},${13},${14},${15},${16},${17},${18},${19},${20},${21},${22},${23},${24},${25},"
        if  [ -e $ERR_FILE_FULL ]; then
            exit  
        fi 

	    $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCBJOB -parameter JBE${15}${16},${17}
        
		exit

